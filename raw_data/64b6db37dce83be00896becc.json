{
    "url": "http://localhost:9999/RaYell/openui5-sdk/test-resources/testsuite/testframe.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>document.location.href</b> and written to <b>window.open()</b> via the following statements:<ul><li>var url = window.frames['sap-ui-ContentWindow'].document.location.href.replace(/&amp;?sap-ui-theme=[^&amp;#]+/g, \"\");</li><li>window.open(url + \"sap-ui-theme=\" + testfwk.getTheme(), '_blank');</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/RaYell/openui5-sdk/test-resources/testsuite/testframe.html",
                "path": "/RaYell/openui5-sdk/test-resources/testsuite/testframe.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9SYVllbGwvb3BlbnVpNS1zZGsvdGVzdC1yZXNvdXJjZXMvdGVzdHN1aXRlL3Rlc3RmcmFtZS5odG1sIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTA2OTkNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAyMToyNzoxMCBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMjE6MjY6NDggR01UDQoNCjwhRE9DVFlQRSBIVE1MPgo8aHRtbD4KCTxoZWFkPgoJCTxtZXRhIGh0dHAtZXF1aXY9IlgtVUEtQ29tcGF0aWJsZSIgY29udGVudD0iSUU9ZWRnZSIgLz4KCQk8bWV0YSBjaGFyc2V0PSJVVEYtOCIgLz4KCQk8dGl0bGU+U0FQVUk1IFRlc3RzdWl0ZTwvdGl0bGU+CgkJPHNjcmlwdCBpZD0ic2FwLXVpLWJvb3RzdHJhcCIKCQkJCXNyYz0iLi4vLi4vcmVzb3VyY2VzL3NhcC11aS1jb3JlLmpzIgoJCQkJZGF0YS1zYXAtdWktbGlicz0iIgoJCQkJZGF0YS1zYXAtdWktdGhlbWU9InNhcF9wbGF0aW51bSI+CgkJPC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL3Rlc3Rmd2suanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQ+CgoJCQl3aW5kb3cucmVzaXplID0gb25SZXNpemVQYWdlOwoKCQkJdmFyIHRlc3Rmd2sgPSBzYXAudWkudGVzdGZ3ay5UZXN0RldLOwoJCQoJCQl2YXIgYkNvbW1vbnNBdmFpbGFibGUgPSBmYWxzZTsKCQkJaWYgKCAhZ3VwKCJzYXAtdWktcHJvdGVjdGVkTW9kZSIpICkgewoJCQkJYkNvbW1vbnNBdmFpbGFibGUgPSBqUXVlcnkuc2FwLnN5bmNIZWFkKCIuLi8uLi9yZXNvdXJjZXMvc2FwL3VpL2NvbW1vbnMvbGlicmFyeS5qcyIpOwoJCQl9CgoJCQl2YXIgc2V0dGluZ3NVUkwgPSAic2V0dGluZ3MuaHRtbCI7CgkJCXZhciB0cmFjZVVSTCA9ICJ0cmFjZS5odG1sIjsKCQkJaWYgKCBiQ29tbW9uc0F2YWlsYWJsZSApIHsKCQkJCXNldHRpbmdzVVJMID0gInNhcHVpNS8iICsgc2V0dGluZ3NVUkw7CgkJCQkvLyB0cmFjZVVSTCA9ICJzYXB1aTUvIiArIHRyYWNlVVJMOwoJCQl9CgkJCQkJCQoJCQlmdW5jdGlvbiBfb25sb2FkKCkgewoKCQkJCXZhciBvU2V0dGluZ3NXaW5kb3cgPSB0b3AuZnJhbWVzWydzYXAtdWktU2V0dGluZ3NXaW5kb3cnXSwKCQkJCSAgICBvQ29udGVudFdpbmRvdyA9IHRvcC5mcmFtZXNbJ3NhcC11aS1Db250ZW50V2luZG93J10sCgkJCQkJb1RyYWNlV2luZG93ID0gd2luZG93LnRvcC5mcmFtZXNbJ3NhcC11aS1UcmFjZVdpbmRvdyddOwoKCQkJCW9TZXR0aW5nc1dpbmRvdy5sb2NhdGlvbi5ocmVmID0gc2V0dGluZ3NVUkw7CgkJCQlvVHJhY2VXaW5kb3cubG9jYXRpb24uaHJlZiA9IHRyYWNlVVJMOwoKCQkJCXRlc3Rmd2suaW5pdChvQ29udGVudFdpbmRvdyk7CgkJCQkKCQkJCWlmICggdG9wLmxvY2F0aW9uLmhhc2ggKSB7IC8vIGxvYWQgYSBzcGVjaWZpYyBwYWdlIGluaXRpYWxseQoJCQkJCXZhciBzVVJMID0gdG9wLmxvY2F0aW9uLmhhc2g7CgkJCQkJaWYgKCBzVVJMLmluZGV4T2YoIiMiKSA9PT0gMCApIHsKCQkJCQkJc1VSTCA9IHNVUkwuc3Vic3RyaW5nKDEpOwoJCQkJCX0KCQkJCQkKCQkJCQkvLyB0cnkgdG8gZmluZCBvdXQgd2hpY2ggbGlicmFyeSB0aGUgcGFnZSBiZWxvbmdzIHRvLCBpbiBvcmRlciB0byBhbGxvdyBhbmQgc2V0IHRoZSBhcHByb3ByaWF0ZSB0aGVtZXMKCQkJCQl2YXIgdGhlbWVDb25zdHJhaW50cyA9IG51bGw7CgkJCQkJdmFyIG0gPSBzVVJMLm1hdGNoKC8uKlwvdGVzdC1yZXNvdXJjZXNcLyguKilcL1teXC9dKy5odG1sLyk7CgkJCQkJaWYgKG0gJiYgKG0ubGVuZ3RoID4gMSkpIHsKCQkJCQkJdmFyIGxpYk5hbWUgPSBtWzFdLnJlcGxhY2UoL1wvL2csIi4iKTsKCQkJCQkJdmFyIHRoZW1lcyA9IHRlc3Rmd2suTElCUkFSWV9USEVNRVNbbGliTmFtZV07IC8vIHRyeSB0byBnZXQgdGhlbWUgaW5mb3JtYXRpb24gZm9yIHRoZSBjdXJyZW50IGxpYnJhcnkKCQkJCQkJdGhlbWVDb25zdHJhaW50cyA9IHRoZW1lcyB8fCB0ZXN0ZndrLkxJQlJBUllfVEhFTUVTWyJhbGwiXTsgLy8gdXNlIHRoZSBmb3VuZCBjb25maWcgLSBvciAiYWxsIHRoZW1lcyIgaWYgbm90aGluZyB3YXMgZm91bmQKCQkJCQl9CgkJCQkJdGVzdGZ3ay5zZXRDb250ZW50VVJMKHNVUkwsIHRoZW1lQ29uc3RyYWludHMpOwoJCQkJCQoJCQkJCS8vIFRoZSBUaGVtZSBDb21ib0JveCBzaG91bGQgYmUgdXBkYXRlZCBhY2NvcmRpbmdseSwgYnV0IGlzIHVzdWFsbHkgbm90IGluc3RhbnRpYXRlZCB5ZXQuLi4ganVzdCB1c2UgYSB0aW1lb3V0IHRvIG1ha2UgaXQgd29yayBpbiBtb3N0IGNhc2VzCgkJCQkJaWYgKHRlc3Rmd2subVRoZW1lQ29uZmlnTGlzdGVuZXJzLmxlbmd0aCA9PT0gMCkgeyAvLyBDb21ib0JveCBkb2VzIG5vdCBsaXN0ZW4geWV0CgkJCQkJCXdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CgkJCQkJCQl0ZXN0ZndrLmZpcmVUaGVtZUNvbmZpZ3VyYXRpb25DaGFuZ2VkLmFwcGx5KHRlc3Rmd2spOwoJCQkJCQl9LCAyMDAwKQoJCQkJCX0KCQkJCQkKCQkJCX0gZWxzZSB7IC8vIGxvYWQgdGhlIHdlbGNvbWUgcGFnZSBpbml0aWFsbHkKCQkJCQl2YXIgc1VSTCA9ICJ3ZWxjb21lLmh0bWwiOwoJCQkJCXZhciBsb2MgPSB0b3AubG9jYXRpb24ucGF0aG5hbWU7CgkJCQkJdmFyIGluZGV4ID0gbG9jLmluZGV4T2YoInRlc3RmcmFtZS5odG1sIik7CgkJCQkJaWYgKGluZGV4ID4gLTEpIHsgLy8gdHJ5IHRvIGJ1aWxkIGFuIGFic29sdXRlIFVSTCwgc28gc2V0dGluZ3MgY2hhbmdlcyBkbyBub3QgbGVhZCB0byBhIDQwNCBvbiB0aGUgaW5pdGlhbCBzY3JlZW4KCQkJCQkJc1VSTCA9IGxvYy5zdWJzdHIoMCwgaW5kZXgpICsgIndlbGNvbWUuaHRtbCI7CgkJCQkJfQoJCQkJCXRlc3Rmd2suc2V0Q29udGVudFVSTChzVVJMLCBudWxsKTsgLy8gbm8gdGhlbWUgY29uc3RyYWludHMKCQkJCX0KCQkJCQoJCQkJc2V0VGltZW91dChvblJlc2l6ZVBhZ2UsIDEwKTsKCQkJfQoKCQkJZnVuY3Rpb24gb25SZXNpemVQYWdlKCkgewoJCQkJdmFyIG9UaXRsZVdpbmRvdyA9IHRvcC5mcmFtZXNbJ3NhcC11aS1UaXRsZVdpbmRvdyddLAoJCQkJCW9TYW1wbGVXaW5kb3cgPSB0b3AuZnJhbWVzWydzYXAtdWktU2FtcGxlV2luZG93J10sCgkJCQkJb1NldHRpbmdzV2luZG93ID0gdG9wLmZyYW1lc1snc2FwLXVpLVNldHRpbmdzV2luZG93J10sCgkJCQkJb0NvbnRlbnRXaW5kb3cgPSB0b3AuZnJhbWVzWydzYXAtdWktQ29udGVudFdpbmRvdyddLAoJCQkJCW9UcmFjZVdpbmRvdyA9IHRvcC5mcmFtZXNbJ3NhcC11aS1UcmFjZVdpbmRvdyddLAoJCQkJCW9Db250cm9sVHJlZVdpbmRvdyA9IHRvcC5mcmFtZXNbJ3NhcC11aS1Db250cm9sVHJlZVdpbmRvdyddLAoJCQkJCW9Qcm9wZXJ0eUxpc3RXaW5kb3cgPSB0b3AuZnJhbWVzWydzYXAtdWktUHJvcGVydHlMaXN0V2luZG93J107CgkKCQkJCWlmIChvU2FtcGxlV2luZG93ICYmIG9UcmFjZVdpbmRvdyAmJiBvQ29udHJvbFRyZWVXaW5kb3cgJiYgb1Byb3BlcnR5TGlzdFdpbmRvdykgewoJCQkJCXZhciBtaWRkbGVYMCA9IG9TYW1wbGVXaW5kb3cuZnJhbWVFbGVtZW50ID8gKG9TYW1wbGVXaW5kb3cuZnJhbWVFbGVtZW50Lm9mZnNldFdpZHRoKzIpIDogb1NhbXBsZVdpbmRvdy5pbm5lcldpZHRoOwoJCQkJCXZhciByaWdodFgwID0gbWlkZGxlWDAgKyBvVHJhY2VXaW5kb3cuZnJhbWVFbGVtZW50ID8gKG9UcmFjZVdpbmRvdy5mcmFtZUVsZW1lbnQub2Zmc2V0V2lkdGgrMikgOiBvVHJhY2VXaW5kb3cuaW5uZXJXaWR0aDsKCQoJCQkJCW9UcmFjZVdpbmRvdy5kb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9ICctJyArIG1pZGRsZVgwICsgJ3B4IDBweCc7CgkJCQkJb0NvbnRyb2xUcmVlV2luZG93LmRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gJy0nICsgcmlnaHRYMCArICdweCAwcHgnOwoJCQkJCW9Qcm9wZXJ0eUxpc3RXaW5kb3cuZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPSAnLScgKyByaWdodFgwICsgJ3B4IDBweCc7CgkJCQl9CgkJCX07CgkJCgkJCWZ1bmN0aW9uIGd1cCggbmFtZSApIHsgIAoJCQkJbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xbXS8sIlxcXFsiKS5yZXBsYWNlKC9bXF1dLywiXFxcXSIpOyAgCgkJCQl2YXIgcmVnZXhTID0gIltcXD8mXSIrbmFtZSsiPShbXiYjXSopIjsgIAoJCQkJdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCggcmVnZXhTICk7ICAKCQkJCXZhciByZXN1bHRzID0gcmVnZXguZXhlYyggd2luZG93LmxvY2F0aW9uLmhyZWYgKTsgIAoJCQkJaWYoIHJlc3VsdHMgPT0gbnVsbCApICAgIAoJCQkJCXJldHVybiBudWxsOyAgCgkJCQllbHNlICAgIAoJCQkJCXJldHVybiByZXN1bHRzWzFdOwoJCQl9CgoJCQlmdW5jdGlvbiBzZXRGcmFtZUxheW91dChsYXlvdXQpIHsKCQkJCXZhciBvT3V0ZXJGcmFtZXNldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXAtdWktdGVzdHN1aXRlLW91dGVyJyk7CgkJCQl2YXIgb01pZGRsZUZyYW1lc2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhcC11aS10ZXN0c3VpdGUtbWlkZGxlJyk7CgkJCQlmcmFtZUxheW91dCA9IGxheW91dDsKCQkJCXN3aXRjaCAobGF5b3V0KSB7CgkJCQkJY2FzZSAibmV3d2luZG93IjoKCQkJCQkJLy8gdGhlbWUgaXMgbm90IHNldCB2aWEgVVJMIHBhcmFtZXRlciBhbmQgcmVsb2FkLCBidXQgZGlyZWN0bHkgdmlhIEpTIEFQSSwgc28gdGhlIFVSTCB0byBvcGVuIG5vdyBuZWVkcyB0byBiZSBhZGFwdGVkCgkJCQkJCXZhciB1cmwgPSB3aW5kb3cuZnJhbWVzWydzYXAtdWktQ29udGVudFdpbmRvdyddLmRvY3VtZW50LmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvJj9zYXAtdWktdGhlbWU9W14mI10rL2csICIiKTsgLy8gcmVtb3ZlIG9sZCB0aGVtZQoJCQkJCQlpZiAodXJsLmluZGV4T2YoIj8iKSA+IC0xKSB7CgkJCQkJCQl1cmwgKz0gIiYiOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJdXJsICs9ICI/IjsKCQkJCQkJfQoJCQkJCQl3aW5kb3cub3Blbih1cmwgKyAic2FwLXVpLXRoZW1lPSIgKyB0ZXN0ZndrLmdldFRoZW1lKCksICdfYmxhbmsnKTsKCQkJCQkJYnJlYWs7CgkJCQkJY2FzZSAic2FtcGxlb25seSI6CgkJCQkJCW9PdXRlckZyYW1lc2V0LmNvbHMgPSAiMCwqLDAiOwoJCQkJCQlvTWlkZGxlRnJhbWVzZXQucm93cyA9ICIqLDAiOwoJCQkJCQlicmVhazsKCQkJCQljYXNlICJzYW1wbGV0cmVlIjoKCQkJCQkJb091dGVyRnJhbWVzZXQuY29scyA9ICIyNTAsKiwwIjsKCQkJCQkJb01pZGRsZUZyYW1lc2V0LnJvd3MgPSAiKiwwIjsKCQkJCQkJYnJlYWs7CQkJCQkKCQkJCQljYXNlICJjb250cm9sdHJlZSI6CgkJCQkJCW9PdXRlckZyYW1lc2V0LmNvbHMgPSAiMCwqLDIyMCI7CgkJCQkJCW9NaWRkbGVGcmFtZXNldC5yb3dzID0gIiosMCI7CgkJCQkJCWJyZWFrOwkJCQkJCgkJCQkJY2FzZSAiZnVsbCI6CgkJCQkJCW9PdXRlckZyYW1lc2V0LmNvbHMgPSAiMjUwLCosMjIwIjsKCQkJCQkJb01pZGRsZUZyYW1lc2V0LnJvd3MgPSAiKiwyNTAiOwoJCQkJCQlicmVhazsJCQoJCQkJfQkJCgkJCQkKCQkJCW9uUmVzaXplUGFnZSgpOwoJCQkJLy8gU2FmYXJpIDQgYnVnOiBkb2Vzbid0IHVwZGF0ZS9yZWZyZXNoIHRoZSBmcmFtZXNldCAtLT4gZG8gYSByZXNpemUuIFRpbWVvdXQgaXMgbmVjZXNzYXJ5IG90aGVyd2lzZSBTYWZhcmkgZGlkbid0IHJlZnJlc2ggdGhlIHdpbmRvdwoJCQkJaWYgKGpRdWVyeS5icm93c2VyLndlYmtpdCAmJiAoalF1ZXJ5LmJyb3dzZXIudmVyc2lvbi5pbmRleE9mKCI0IikgPT0gMCkpIHsgLy8gb25seSBpbiBTYWZhcmkgNAoJCQkJCXdpbmRvdy5yZXNpemVCeSgtMSwgMCk7IAoJCQkJCXdpbmRvdy5zZXRUaW1lb3V0KCJ3aW5kb3cucmVzaXplQnkoMSwgMCkiLCAxKTsKCQkJCX0KCQkJfQoKCQkJZnVuY3Rpb24gY3JlYXRlRnJhbWVzZXQoKSB7CgkJCQl2YXIgb3V0PVtdOwoJCQkJb3V0LnB1c2goJzxmcmFtZXNldCByb3dzPSIzMCwqIiBzdHlsZT0iYm9yZGVyOm5vbmUiIG9ubG9hZD0iX29ubG9hZCgpOyIgZnJhbWVib3JkZXI9IjAiIGZyYW1lc3BhY2luZz0iMCIgYm9yZGVyPSIwIj4nKTsKCQkJCQlvdXQucHVzaCgnPGZyYW1lIHNyYz0idGl0bGUuaHRtbCIgc2Nyb2xsaW5nPSJubyIgbmFtZT0ic2FwLXVpLVRpdGxlV2luZG93IiBub3Jlc2l6ZT0ibm9yZXNpemUiIGZyYW1lYm9yZGVyPSIwIiBib3JkZXI9IjAiLz4nKTsKCQkJCQlvdXQucHVzaCgnPGZyYW1lc2V0IGlkPSJzYXAtdWktdGVzdHN1aXRlLW91dGVyIiBjb2xzPSIyNTAsKiwyMjAiIGZyYW1lYm9yZGVyPSIwIiBmcmFtZXNwYWNpbmc9IjAiIGJvcmRlcj0iMCIgbmFtZT0iT3V0ZXJGcmFtZXNldCIgPicpOwoJCQkJCQlvdXQucHVzaCgnPGZyYW1lc2V0IGlkPSJzYXAtdWktdGVzdHN1aXRlLWxlZnQiIHJvd3M9IiosMzYwIiBzdHlsZT0iYm9yZGVyOjFweCBzb2xpZCAjYzBjMGMwIiBmcmFtZWJvcmRlcj0iMCIgZnJhbWVzcGFjaW5nPSIwIiBib3JkZXI9IjAiPicpOwoJCQkJCQkJb3V0LnB1c2goJzxmcmFtZSBzcmM9InNhbXBsZXMuaHRtbCIgc2Nyb2xsaW5nPSJubyIgZnJhbWVib3JkZXI9IjAiIG5hbWU9InNhcC11aS1TYW1wbGVXaW5kb3ciIC8+Jyk7CgkJCQkgICAgICAgICAgICBvdXQucHVzaCgnPGZyYW1lIHNjcm9sbGluZz0ibm8iIHNyYz0iJywgc2V0dGluZ3NVUkwsICciIGZyYW1lYm9yZGVyPSIwIiBuYW1lPSJzYXAtdWktU2V0dGluZ3NXaW5kb3ciIC8+Jyk7CgkJCQkgICAgICAgIG91dC5wdXNoKCc8L2ZyYW1lc2V0PicpOwoJCQkJICAgICAgICBvdXQucHVzaCgnPGZyYW1lc2V0IGlkPSJzYXAtdWktdGVzdHN1aXRlLW1pZGRsZSIgbmFtZT0iQ29udGVudCIgcm93cz0iKiwyNTAiIHN0eWxlPSJib3JkZXI6MXB4IHNvbGlkICNjMGMwYzAiIGZyYW1lYm9yZGVyPSIwIiBmcmFtZXNwYWNpbmc9IjAiIGJvcmRlcj0iMCI+Jyk7CgkJCQkgICAgICAgICAgICBvdXQucHVzaCgnPGZyYW1lIG5hbWU9InNhcC11aS1Db250ZW50V2luZG93IiBmcmFtZWJvcmRlcj0iMCIgc2Nyb2xsaW5nPSJhdXRvIiBvbmxvYWQ9InRlc3Rmd2sub25Db250ZW50TG9hZCgpOyIgLz4nKTsKCQkJCSAgICAgICAgICAgIG91dC5wdXNoKCc8ZnJhbWUgbmFtZT0ic2FwLXVpLVRyYWNlV2luZG93IiBzcmM9IicsIHRyYWNlVVJMLCAnIiBmcmFtZWJvcmRlcj0iMCIgc2Nyb2xsaW5nPSJubyIgLz4nKTsKCQkJCSAgICAgICAgb3V0LnB1c2goJzwvZnJhbWVzZXQ+Jyk7IAoJCQkJICAgICAgICBvdXQucHVzaCgnPGZyYW1lc2V0IGlkPSJzYXAtdWktdGVzdHN1aXRlLXJpZ2h0IiByb3dzPSI1MCUsKiIgc3R5bGU9ImJvcmRlcjoxcHggc29saWQgI2MwYzBjMCIgZnJhbWVib3JkZXI9IjAiIGZyYW1lc3BhY2luZz0iMCIgYm9yZGVyPSIwIj4nKTsKCQkJCSAgICAgICAgICAgIG91dC5wdXNoKCc8ZnJhbWUgc3JjPSJjb250cm9sdHJlZS5odG1sIiBuYW1lPSJzYXAtdWktQ29udHJvbFRyZWVXaW5kb3ciIGZyYW1lYm9yZGVyPSIwIiBzY3JvbGxpbmc9Im5vIiAvPicpOwoJCQkJICAgICAgICAgICAgb3V0LnB1c2goJzxmcmFtZSBzcmM9InByb3BlcnRpZXMuaHRtbCIgbmFtZT0ic2FwLXVpLVByb3BlcnR5TGlzdFdpbmRvdyIgZnJhbWVib3JkZXI9IjAiIHNjcm9sbGluZz0ibm8iLz4nKTsKCQkJCSAgICAgICAgb3V0LnB1c2goJzwvZnJhbWVzZXQ+Jyk7CgkJCQkJb3V0LnB1c2goJzwvZnJhbWVzZXQ+Jyk7CgkJCQlvdXQucHVzaCgnPC9mcmFtZXNldD4nKTsKCgkJCQl2YXIgc0hUTUwgPSBvdXQuam9pbigiXG4iKTsKCQkJCXZhciBvT2xkRWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07CgkJCQl2YXIgb1RlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKCQkJCW9UZW1wLmlubmVySFRNTCA9IHNIVE1MOwoJCQkJdmFyIG9OZXdSZWYgPSBvVGVtcC5jaGlsZE5vZGVzWzBdOwoJCQkJdmFyIG9QYXJlbnRSZWYgPSBvT2xkRWxlbS5wYXJlbnROb2RlOwoJCQkJb1BhcmVudFJlZi5yZXBsYWNlQ2hpbGQob05ld1JlZiwgb09sZEVsZW0pOwoJCQl9CgkJCQoJCQlmdW5jdGlvbiBlZGl0SW5TbmlwcGl4KCkgewoJCQkJdmFyIHNuaXBwaXhCYXNlVXJsID0gImh0dHA6Ly92ZXVpNWluZnJhOjgwODAvc25pcHBpeC8iOyAvKiBhbHdheXMgdXNlIHRoZSBjZW50cmFsIHNuaXBwaXggdG8gYXZvaWQgc3ByZWFkaW5nIHNuaXBwZXRzIGFjcm9zcyBtdWx0aXBsZSBzZXJ2ZXJzICovCgkJCQl2YXIgdXJsID0gd2luZG93LmZyYW1lc1snc2FwLXVpLUNvbnRlbnRXaW5kb3cnXS5kb2N1bWVudC5sb2NhdGlvbi5ocmVmOwoJCQkJdXJsID0gdXJsLnJlcGxhY2UoLyUvZywgIiUyNSIpLnJlcGxhY2UoL1w/L2csICIlM0YiKS5yZXBsYWNlKC8mL2csICIlMjYiKS5yZXBsYWNlKC8jL2csICIlMjMiKTsgLy8gZXNjYXBlIHNwZWNpYWwgY2hhcmFjdGVycyBpbiBVUkwKCQkJCXdpbmRvdy5vcGVuKHNuaXBwaXhCYXNlVXJsICsgIj91cmw9IiArIHVybCwgJ19ibGFuaycpOwoJCQl9CgkJCQoJCQlmdW5jdGlvbiBvcGVuSW5EZXZpY2VTaW11bGF0b3IoKSB7CgkJCQl2YXIgYmFzZVVybCA9ICJEZXZpY2VSZXNvbHV0aW9uRW11bGF0b3IuaHRtbCI7CgkJCQlpZiAoalF1ZXJ5LnNhcC5zeW5jSGVhZCgiLi4vLi4vRGV2aWNlU2ltdWxhdG9yLmh0bWwiKSkgewoJCQkJCWJhc2VVcmwgPSAiLi4vLi4vRGV2aWNlU2ltdWxhdG9yLmh0bWwiOwoJCQkJfQoJCQkJdmFyIHVybCA9IHdpbmRvdy5mcmFtZXNbJ3NhcC11aS1Db250ZW50V2luZG93J10uZG9jdW1lbnQubG9jYXRpb24uaHJlZjsKCQkJCXVybCA9IHVybC5yZXBsYWNlKC8lL2csICIlMjUiKS5yZXBsYWNlKC9cPy9nLCAiJTNGIikucmVwbGFjZSgvJi9nLCAiJTI2IikucmVwbGFjZSgvIy9nLCAiJTIzIik7IC8vIGVzY2FwZSBzcGVjaWFsIGNoYXJhY3RlcnMgaW4gVVJMCgkJCQl3aW5kb3cub3BlbihiYXNlVXJsICsgIj91cmw9IiArIHVybCwgJ19ibGFuaycpOwoJCQl9CgkJCQoJCQlmdW5jdGlvbiByZWRpcmVjdFRvVGVzdHJ1bm5lcigpIHsKCQkJCQoJCQkJdmFyIHNDb250ZW50VXJsID0gc2FwLnVpLnRlc3Rmd2suVGVzdEZXSy5nZXRDb250ZW50VVJMKCksCgkJCQkgICAgYU1hdGNoZXMgPSAvLipcL3Rlc3QtcmVzb3VyY2VzXC8oLipcLnF1bml0XC5odG1sKSQvaS5leGVjKHNDb250ZW50VXJsKQoJCQkJICAgIHNUZXN0UGFnZSA9IGFNYXRjaGVzICYmIGFNYXRjaGVzWzBdLAoJCQkJICAgIHNUZXN0cnVubmVyVXJsID0gIi4uL3NhcC91aS9xdW5pdC90ZXN0cnVubmVyLmh0bWwiICsgKHNUZXN0UGFnZSA/ICI/dGVzdHBhZ2U9IiArIGVuY29kZVVSSUNvbXBvbmVudChzVGVzdFBhZ2UpIDogIiIpLAoJCQkJCgkJCQl3aW5kb3cub3BlbihzVGVzdHJ1bm5lclVybCk7CgkJCQkKCQkJfQoJCQkKCQk8L3NjcmlwdD4KCTwvaGVhZD4KCgk8IS0tIHJlcGxhY2VkIGJ5IHRoZSBkeW5hbWljYWxseSBjcmVhdGVkIGZyYW1lc2V0IGFib3ZlIC0tPiAgCQoJPGZyYW1lc2V0IHJvd3M9IjM1LCoiIHN0eWxlPSJib3JkZXI6bm9uZSIgb25sb2FkPSJfb25sb2FkKCk7IiBmcmFtZWJvcmRlcj0iMCIgZnJhbWVzcGFjaW5nPSIwIiBib3JkZXI9IjAiPgoJCTxmcmFtZSBzcmM9InRpdGxlLmh0bWwiIHNjcm9sbGluZz0ibm8iIG5hbWU9InNhcC11aS1UaXRsZVdpbmRvdyIgbm9yZXNpemU9Im5vcmVzaXplIiBmcmFtZWJvcmRlcj0iMCIgYm9yZGVyPSIwIi8+CgkJPGZyYW1lc2V0IGlkPSJzYXAtdWktdGVzdHN1aXRlLW91dGVyIiBjb2xzPSIyNTAsKiwyMjAiIGZyYW1lYm9yZGVyPSIwIiBmcmFtZXNwYWNpbmc9IjAiIGJvcmRlcj0iMCIgbmFtZT0iT3V0ZXJGcmFtZXNldCIgPgoJCQk8ZnJhbWVzZXQgaWQ9InNhcC11aS10ZXN0c3VpdGUtbGVmdCIgcm93cz0iKiwzNjAiIHN0eWxlPSJib3JkZXI6MXB4IHNvbGlkICNjMGMwYzAiIGZyYW1lYm9yZGVyPSIwIiBmcmFtZXNwYWNpbmc9IjAiIGJvcmRlcj0iMCI+CgkJCQk8ZnJhbWUgc3JjPSJzYW1wbGVzLmh0bWwiIHNjcm9sbGluZz0iYXV0byIgZnJhbWVib3JkZXI9IjAiIG5hbWU9InNhcC11aS1TYW1wbGVXaW5kb3ciIC8+CgkgICAgICAgICAgICA8ZnJhbWUgc2Nyb2xsaW5nPSJubyIgZnJhbWVib3JkZXI9IjAiIG5hbWU9InNhcC11aS1TZXR0aW5nc1dpbmRvdyIgc3JjPSJlbXB0eS5odG1sIiAvPgoJICAgICAgICA8L2ZyYW1lc2V0PgoJICAgICAgICA8ZnJhbWVzZXQgaWQ9InNhcC11aS10ZXN0c3VpdGUtbWlkZGxlIiBuYW1lPSJDb250ZW50IiByb3dzPSIqLDI1MCIgc3R5bGU9ImJvcmRlcjoxcHggc29saWQgI2MwYzBjMCIgZnJhbWVib3JkZXI9IjAiIGZyYW1lc3BhY2luZz0iMCIgYm9yZGVyPSIwIj4KCSAgICAgICAgICAgIDxmcmFtZSBuYW1lPSJzYXAtdWktQ29udGVudFdpbmRvdyIgZnJhbWVib3JkZXI9IjAiIHNjcm9sbGluZz0iYXV0byIgb25sb2FkPSJ0ZXN0ZndrLm9uQ29udGVudExvYWQoKTsiIC8+CgkgICAgICAgICAgICA8ZnJhbWUgbmFtZT0ic2FwLXVpLVRyYWNlV2luZG93IiBzcmM9ImVtcHR5Lmh0bWwiIGZyYW1lYm9yZGVyPSIwIiBzY3JvbGxpbmc9Im5vIiAvPgoJICAgICAgICA8L2ZyYW1lc2V0PiAKCSAgICAgICAgPGZyYW1lc2V0IGlkPSJzYXAtdWktdGVzdHN1aXRlLXJpZ2h0IiByb3dzPSI1MCUsKiIgc3R5bGU9ImJvcmRlcjoxcHggc29saWQgI2MwYzBjMCIgZnJhbWVib3JkZXI9IjAiIGZyYW1lc3BhY2luZz0iMCIgYm9yZGVyPSIwIj4KCSAgICAgICAgICAgIDxmcmFtZSBzcmM9ImNvbnRyb2x0cmVlLmh0bWwiIG5hbWU9InNhcC11aS1Db250cm9sVHJlZVdpbmRvdyIgZnJhbWVib3JkZXI9IjAiIHNjcm9sbGluZz0ibm8iIC8+CgkgICAgICAgICAgICA8ZnJhbWUgc3JjPSJwcm9wZXJ0aWVzLmh0bWwiIG5hbWU9InNhcC11aS1Qcm9wZXJ0eUxpc3RXaW5kb3ciIGZyYW1lYm9yZGVyPSIwIiBzY3JvbGxpbmc9Im5vIi8+CgkgICAgICAgIDwvZnJhbWVzZXQ+CgkJPC9mcmFtZXNldD4KCTwvZnJhbWVzZXQ+Cgk8IS0tIC0tPgoJCjwvaHRtbD4=",
                "body": "PCFET0NUWVBFIEhUTUw+CjxodG1sPgoJPGhlYWQ+CgkJPG1ldGEgaHR0cC1lcXVpdj0iWC1VQS1Db21wYXRpYmxlIiBjb250ZW50PSJJRT1lZGdlIiAvPgoJCTxtZXRhIGNoYXJzZXQ9IlVURi04IiAvPgoJCTx0aXRsZT5TQVBVSTUgVGVzdHN1aXRlPC90aXRsZT4KCQk8c2NyaXB0IGlkPSJzYXAtdWktYm9vdHN0cmFwIgoJCQkJc3JjPSIuLi8uLi9yZXNvdXJjZXMvc2FwLXVpLWNvcmUuanMiCgkJCQlkYXRhLXNhcC11aS1saWJzPSIiCgkJCQlkYXRhLXNhcC11aS10aGVtZT0ic2FwX3BsYXRpbnVtIj4KCQk8L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0ianMvdGVzdGZ3ay5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdD4KCgkJCXdpbmRvdy5yZXNpemUgPSBvblJlc2l6ZVBhZ2U7CgoJCQl2YXIgdGVzdGZ3ayA9IHNhcC51aS50ZXN0ZndrLlRlc3RGV0s7CgkJCgkJCXZhciBiQ29tbW9uc0F2YWlsYWJsZSA9IGZhbHNlOwoJCQlpZiAoICFndXAoInNhcC11aS1wcm90ZWN0ZWRNb2RlIikgKSB7CgkJCQliQ29tbW9uc0F2YWlsYWJsZSA9IGpRdWVyeS5zYXAuc3luY0hlYWQoIi4uLy4uL3Jlc291cmNlcy9zYXAvdWkvY29tbW9ucy9saWJyYXJ5LmpzIik7CgkJCX0KCgkJCXZhciBzZXR0aW5nc1VSTCA9ICJzZXR0aW5ncy5odG1sIjsKCQkJdmFyIHRyYWNlVVJMID0gInRyYWNlLmh0bWwiOwoJCQlpZiAoIGJDb21tb25zQXZhaWxhYmxlICkgewoJCQkJc2V0dGluZ3NVUkwgPSAic2FwdWk1LyIgKyBzZXR0aW5nc1VSTDsKCQkJCS8vIHRyYWNlVVJMID0gInNhcHVpNS8iICsgdHJhY2VVUkw7CgkJCX0KCQkJCQkJCgkJCWZ1bmN0aW9uIF9vbmxvYWQoKSB7CgoJCQkJdmFyIG9TZXR0aW5nc1dpbmRvdyA9IHRvcC5mcmFtZXNbJ3NhcC11aS1TZXR0aW5nc1dpbmRvdyddLAoJCQkJICAgIG9Db250ZW50V2luZG93ID0gdG9wLmZyYW1lc1snc2FwLXVpLUNvbnRlbnRXaW5kb3cnXSwKCQkJCQlvVHJhY2VXaW5kb3cgPSB3aW5kb3cudG9wLmZyYW1lc1snc2FwLXVpLVRyYWNlV2luZG93J107CgoJCQkJb1NldHRpbmdzV2luZG93LmxvY2F0aW9uLmhyZWYgPSBzZXR0aW5nc1VSTDsKCQkJCW9UcmFjZVdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdHJhY2VVUkw7CgoJCQkJdGVzdGZ3ay5pbml0KG9Db250ZW50V2luZG93KTsKCQkJCQoJCQkJaWYgKCB0b3AubG9jYXRpb24uaGFzaCApIHsgLy8gbG9hZCBhIHNwZWNpZmljIHBhZ2UgaW5pdGlhbGx5CgkJCQkJdmFyIHNVUkwgPSB0b3AubG9jYXRpb24uaGFzaDsKCQkJCQlpZiAoIHNVUkwuaW5kZXhPZigiIyIpID09PSAwICkgewoJCQkJCQlzVVJMID0gc1VSTC5zdWJzdHJpbmcoMSk7CgkJCQkJfQoJCQkJCQoJCQkJCS8vIHRyeSB0byBmaW5kIG91dCB3aGljaCBsaWJyYXJ5IHRoZSBwYWdlIGJlbG9uZ3MgdG8sIGluIG9yZGVyIHRvIGFsbG93IGFuZCBzZXQgdGhlIGFwcHJvcHJpYXRlIHRoZW1lcwoJCQkJCXZhciB0aGVtZUNvbnN0cmFpbnRzID0gbnVsbDsKCQkJCQl2YXIgbSA9IHNVUkwubWF0Y2goLy4qXC90ZXN0LXJlc291cmNlc1wvKC4qKVwvW15cL10rLmh0bWwvKTsKCQkJCQlpZiAobSAmJiAobS5sZW5ndGggPiAxKSkgewoJCQkJCQl2YXIgbGliTmFtZSA9IG1bMV0ucmVwbGFjZSgvXC8vZywiLiIpOwoJCQkJCQl2YXIgdGhlbWVzID0gdGVzdGZ3ay5MSUJSQVJZX1RIRU1FU1tsaWJOYW1lXTsgLy8gdHJ5IHRvIGdldCB0aGVtZSBpbmZvcm1hdGlvbiBmb3IgdGhlIGN1cnJlbnQgbGlicmFyeQoJCQkJCQl0aGVtZUNvbnN0cmFpbnRzID0gdGhlbWVzIHx8IHRlc3Rmd2suTElCUkFSWV9USEVNRVNbImFsbCJdOyAvLyB1c2UgdGhlIGZvdW5kIGNvbmZpZyAtIG9yICJhbGwgdGhlbWVzIiBpZiBub3RoaW5nIHdhcyBmb3VuZAoJCQkJCX0KCQkJCQl0ZXN0ZndrLnNldENvbnRlbnRVUkwoc1VSTCwgdGhlbWVDb25zdHJhaW50cyk7CgkJCQkJCgkJCQkJLy8gVGhlIFRoZW1lIENvbWJvQm94IHNob3VsZCBiZSB1cGRhdGVkIGFjY29yZGluZ2x5LCBidXQgaXMgdXN1YWxseSBub3QgaW5zdGFudGlhdGVkIHlldC4uLiBqdXN0IHVzZSBhIHRpbWVvdXQgdG8gbWFrZSBpdCB3b3JrIGluIG1vc3QgY2FzZXMKCQkJCQlpZiAodGVzdGZ3ay5tVGhlbWVDb25maWdMaXN0ZW5lcnMubGVuZ3RoID09PSAwKSB7IC8vIENvbWJvQm94IGRvZXMgbm90IGxpc3RlbiB5ZXQKCQkJCQkJd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXsKCQkJCQkJCXRlc3Rmd2suZmlyZVRoZW1lQ29uZmlndXJhdGlvbkNoYW5nZWQuYXBwbHkodGVzdGZ3ayk7CgkJCQkJCX0sIDIwMDApCgkJCQkJfQoJCQkJCQoJCQkJfSBlbHNlIHsgLy8gbG9hZCB0aGUgd2VsY29tZSBwYWdlIGluaXRpYWxseQoJCQkJCXZhciBzVVJMID0gIndlbGNvbWUuaHRtbCI7CgkJCQkJdmFyIGxvYyA9IHRvcC5sb2NhdGlvbi5wYXRobmFtZTsKCQkJCQl2YXIgaW5kZXggPSBsb2MuaW5kZXhPZigidGVzdGZyYW1lLmh0bWwiKTsKCQkJCQlpZiAoaW5kZXggPiAtMSkgeyAvLyB0cnkgdG8gYnVpbGQgYW4gYWJzb2x1dGUgVVJMLCBzbyBzZXR0aW5ncyBjaGFuZ2VzIGRvIG5vdCBsZWFkIHRvIGEgNDA0IG9uIHRoZSBpbml0aWFsIHNjcmVlbgoJCQkJCQlzVVJMID0gbG9jLnN1YnN0cigwLCBpbmRleCkgKyAid2VsY29tZS5odG1sIjsKCQkJCQl9CgkJCQkJdGVzdGZ3ay5zZXRDb250ZW50VVJMKHNVUkwsIG51bGwpOyAvLyBubyB0aGVtZSBjb25zdHJhaW50cwoJCQkJfQoJCQkJCgkJCQlzZXRUaW1lb3V0KG9uUmVzaXplUGFnZSwgMTApOwoJCQl9CgoJCQlmdW5jdGlvbiBvblJlc2l6ZVBhZ2UoKSB7CgkJCQl2YXIgb1RpdGxlV2luZG93ID0gdG9wLmZyYW1lc1snc2FwLXVpLVRpdGxlV2luZG93J10sCgkJCQkJb1NhbXBsZVdpbmRvdyA9IHRvcC5mcmFtZXNbJ3NhcC11aS1TYW1wbGVXaW5kb3cnXSwKCQkJCQlvU2V0dGluZ3NXaW5kb3cgPSB0b3AuZnJhbWVzWydzYXAtdWktU2V0dGluZ3NXaW5kb3cnXSwKCQkJCQlvQ29udGVudFdpbmRvdyA9IHRvcC5mcmFtZXNbJ3NhcC11aS1Db250ZW50V2luZG93J10sCgkJCQkJb1RyYWNlV2luZG93ID0gdG9wLmZyYW1lc1snc2FwLXVpLVRyYWNlV2luZG93J10sCgkJCQkJb0NvbnRyb2xUcmVlV2luZG93ID0gdG9wLmZyYW1lc1snc2FwLXVpLUNvbnRyb2xUcmVlV2luZG93J10sCgkJCQkJb1Byb3BlcnR5TGlzdFdpbmRvdyA9IHRvcC5mcmFtZXNbJ3NhcC11aS1Qcm9wZXJ0eUxpc3RXaW5kb3cnXTsKCQoJCQkJaWYgKG9TYW1wbGVXaW5kb3cgJiYgb1RyYWNlV2luZG93ICYmIG9Db250cm9sVHJlZVdpbmRvdyAmJiBvUHJvcGVydHlMaXN0V2luZG93KSB7CgkJCQkJdmFyIG1pZGRsZVgwID0gb1NhbXBsZVdpbmRvdy5mcmFtZUVsZW1lbnQgPyAob1NhbXBsZVdpbmRvdy5mcmFtZUVsZW1lbnQub2Zmc2V0V2lkdGgrMikgOiBvU2FtcGxlV2luZG93LmlubmVyV2lkdGg7CgkJCQkJdmFyIHJpZ2h0WDAgPSBtaWRkbGVYMCArIG9UcmFjZVdpbmRvdy5mcmFtZUVsZW1lbnQgPyAob1RyYWNlV2luZG93LmZyYW1lRWxlbWVudC5vZmZzZXRXaWR0aCsyKSA6IG9UcmFjZVdpbmRvdy5pbm5lcldpZHRoOwoJCgkJCQkJb1RyYWNlV2luZG93LmRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gJy0nICsgbWlkZGxlWDAgKyAncHggMHB4JzsKCQkJCQlvQ29udHJvbFRyZWVXaW5kb3cuZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPSAnLScgKyByaWdodFgwICsgJ3B4IDBweCc7CgkJCQkJb1Byb3BlcnR5TGlzdFdpbmRvdy5kb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9ICctJyArIHJpZ2h0WDAgKyAncHggMHB4JzsKCQkJCX0KCQkJfTsKCQkKCQkJZnVuY3Rpb24gZ3VwKCBuYW1lICkgeyAgCgkJCQluYW1lID0gbmFtZS5yZXBsYWNlKC9bXFtdLywiXFxcWyIpLnJlcGxhY2UoL1tcXV0vLCJcXFxdIik7ICAKCQkJCXZhciByZWdleFMgPSAiW1xcPyZdIituYW1lKyI9KFteJiNdKikiOyAgCgkJCQl2YXIgcmVnZXggPSBuZXcgUmVnRXhwKCByZWdleFMgKTsgIAoJCQkJdmFyIHJlc3VsdHMgPSByZWdleC5leGVjKCB3aW5kb3cubG9jYXRpb24uaHJlZiApOyAgCgkJCQlpZiggcmVzdWx0cyA9PSBudWxsICkgICAgCgkJCQkJcmV0dXJuIG51bGw7ICAKCQkJCWVsc2UgICAgCgkJCQkJcmV0dXJuIHJlc3VsdHNbMV07CgkJCX0KCgkJCWZ1bmN0aW9uIHNldEZyYW1lTGF5b3V0KGxheW91dCkgewoJCQkJdmFyIG9PdXRlckZyYW1lc2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhcC11aS10ZXN0c3VpdGUtb3V0ZXInKTsKCQkJCXZhciBvTWlkZGxlRnJhbWVzZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2FwLXVpLXRlc3RzdWl0ZS1taWRkbGUnKTsKCQkJCWZyYW1lTGF5b3V0ID0gbGF5b3V0OwoJCQkJc3dpdGNoIChsYXlvdXQpIHsKCQkJCQljYXNlICJuZXd3aW5kb3ciOgoJCQkJCQkvLyB0aGVtZSBpcyBub3Qgc2V0IHZpYSBVUkwgcGFyYW1ldGVyIGFuZCByZWxvYWQsIGJ1dCBkaXJlY3RseSB2aWEgSlMgQVBJLCBzbyB0aGUgVVJMIHRvIG9wZW4gbm93IG5lZWRzIHRvIGJlIGFkYXB0ZWQKCQkJCQkJdmFyIHVybCA9IHdpbmRvdy5mcmFtZXNbJ3NhcC11aS1Db250ZW50V2luZG93J10uZG9jdW1lbnQubG9jYXRpb24uaHJlZi5yZXBsYWNlKC8mP3NhcC11aS10aGVtZT1bXiYjXSsvZywgIiIpOyAvLyByZW1vdmUgb2xkIHRoZW1lCgkJCQkJCWlmICh1cmwuaW5kZXhPZigiPyIpID4gLTEpIHsKCQkJCQkJCXVybCArPSAiJiI7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQl1cmwgKz0gIj8iOwoJCQkJCQl9CgkJCQkJCXdpbmRvdy5vcGVuKHVybCArICJzYXAtdWktdGhlbWU9IiArIHRlc3Rmd2suZ2V0VGhlbWUoKSwgJ19ibGFuaycpOwoJCQkJCQlicmVhazsKCQkJCQljYXNlICJzYW1wbGVvbmx5IjoKCQkJCQkJb091dGVyRnJhbWVzZXQuY29scyA9ICIwLCosMCI7CgkJCQkJCW9NaWRkbGVGcmFtZXNldC5yb3dzID0gIiosMCI7CgkJCQkJCWJyZWFrOwoJCQkJCWNhc2UgInNhbXBsZXRyZWUiOgoJCQkJCQlvT3V0ZXJGcmFtZXNldC5jb2xzID0gIjI1MCwqLDAiOwoJCQkJCQlvTWlkZGxlRnJhbWVzZXQucm93cyA9ICIqLDAiOwoJCQkJCQlicmVhazsJCQkJCQoJCQkJCWNhc2UgImNvbnRyb2x0cmVlIjoKCQkJCQkJb091dGVyRnJhbWVzZXQuY29scyA9ICIwLCosMjIwIjsKCQkJCQkJb01pZGRsZUZyYW1lc2V0LnJvd3MgPSAiKiwwIjsKCQkJCQkJYnJlYWs7CQkJCQkKCQkJCQljYXNlICJmdWxsIjoKCQkJCQkJb091dGVyRnJhbWVzZXQuY29scyA9ICIyNTAsKiwyMjAiOwoJCQkJCQlvTWlkZGxlRnJhbWVzZXQucm93cyA9ICIqLDI1MCI7CgkJCQkJCWJyZWFrOwkJCgkJCQl9CQkKCQkJCQoJCQkJb25SZXNpemVQYWdlKCk7CgkJCQkvLyBTYWZhcmkgNCBidWc6IGRvZXNuJ3QgdXBkYXRlL3JlZnJlc2ggdGhlIGZyYW1lc2V0IC0tPiBkbyBhIHJlc2l6ZS4gVGltZW91dCBpcyBuZWNlc3Nhcnkgb3RoZXJ3aXNlIFNhZmFyaSBkaWRuJ3QgcmVmcmVzaCB0aGUgd2luZG93CgkJCQlpZiAoalF1ZXJ5LmJyb3dzZXIud2Via2l0ICYmIChqUXVlcnkuYnJvd3Nlci52ZXJzaW9uLmluZGV4T2YoIjQiKSA9PSAwKSkgeyAvLyBvbmx5IGluIFNhZmFyaSA0CgkJCQkJd2luZG93LnJlc2l6ZUJ5KC0xLCAwKTsgCgkJCQkJd2luZG93LnNldFRpbWVvdXQoIndpbmRvdy5yZXNpemVCeSgxLCAwKSIsIDEpOwoJCQkJfQoJCQl9CgoJCQlmdW5jdGlvbiBjcmVhdGVGcmFtZXNldCgpIHsKCQkJCXZhciBvdXQ9W107CgkJCQlvdXQucHVzaCgnPGZyYW1lc2V0IHJvd3M9IjMwLCoiIHN0eWxlPSJib3JkZXI6bm9uZSIgb25sb2FkPSJfb25sb2FkKCk7IiBmcmFtZWJvcmRlcj0iMCIgZnJhbWVzcGFjaW5nPSIwIiBib3JkZXI9IjAiPicpOwoJCQkJCW91dC5wdXNoKCc8ZnJhbWUgc3JjPSJ0aXRsZS5odG1sIiBzY3JvbGxpbmc9Im5vIiBuYW1lPSJzYXAtdWktVGl0bGVXaW5kb3ciIG5vcmVzaXplPSJub3Jlc2l6ZSIgZnJhbWVib3JkZXI9IjAiIGJvcmRlcj0iMCIvPicpOwoJCQkJCW91dC5wdXNoKCc8ZnJhbWVzZXQgaWQ9InNhcC11aS10ZXN0c3VpdGUtb3V0ZXIiIGNvbHM9IjI1MCwqLDIyMCIgZnJhbWVib3JkZXI9IjAiIGZyYW1lc3BhY2luZz0iMCIgYm9yZGVyPSIwIiBuYW1lPSJPdXRlckZyYW1lc2V0IiA+Jyk7CgkJCQkJCW91dC5wdXNoKCc8ZnJhbWVzZXQgaWQ9InNhcC11aS10ZXN0c3VpdGUtbGVmdCIgcm93cz0iKiwzNjAiIHN0eWxlPSJib3JkZXI6MXB4IHNvbGlkICNjMGMwYzAiIGZyYW1lYm9yZGVyPSIwIiBmcmFtZXNwYWNpbmc9IjAiIGJvcmRlcj0iMCI+Jyk7CgkJCQkJCQlvdXQucHVzaCgnPGZyYW1lIHNyYz0ic2FtcGxlcy5odG1sIiBzY3JvbGxpbmc9Im5vIiBmcmFtZWJvcmRlcj0iMCIgbmFtZT0ic2FwLXVpLVNhbXBsZVdpbmRvdyIgLz4nKTsKCQkJCSAgICAgICAgICAgIG91dC5wdXNoKCc8ZnJhbWUgc2Nyb2xsaW5nPSJubyIgc3JjPSInLCBzZXR0aW5nc1VSTCwgJyIgZnJhbWVib3JkZXI9IjAiIG5hbWU9InNhcC11aS1TZXR0aW5nc1dpbmRvdyIgLz4nKTsKCQkJCSAgICAgICAgb3V0LnB1c2goJzwvZnJhbWVzZXQ+Jyk7CgkJCQkgICAgICAgIG91dC5wdXNoKCc8ZnJhbWVzZXQgaWQ9InNhcC11aS10ZXN0c3VpdGUtbWlkZGxlIiBuYW1lPSJDb250ZW50IiByb3dzPSIqLDI1MCIgc3R5bGU9ImJvcmRlcjoxcHggc29saWQgI2MwYzBjMCIgZnJhbWVib3JkZXI9IjAiIGZyYW1lc3BhY2luZz0iMCIgYm9yZGVyPSIwIj4nKTsKCQkJCSAgICAgICAgICAgIG91dC5wdXNoKCc8ZnJhbWUgbmFtZT0ic2FwLXVpLUNvbnRlbnRXaW5kb3ciIGZyYW1lYm9yZGVyPSIwIiBzY3JvbGxpbmc9ImF1dG8iIG9ubG9hZD0idGVzdGZ3ay5vbkNvbnRlbnRMb2FkKCk7IiAvPicpOwoJCQkJICAgICAgICAgICAgb3V0LnB1c2goJzxmcmFtZSBuYW1lPSJzYXAtdWktVHJhY2VXaW5kb3ciIHNyYz0iJywgdHJhY2VVUkwsICciIGZyYW1lYm9yZGVyPSIwIiBzY3JvbGxpbmc9Im5vIiAvPicpOwoJCQkJICAgICAgICBvdXQucHVzaCgnPC9mcmFtZXNldD4nKTsgCgkJCQkgICAgICAgIG91dC5wdXNoKCc8ZnJhbWVzZXQgaWQ9InNhcC11aS10ZXN0c3VpdGUtcmlnaHQiIHJvd3M9IjUwJSwqIiBzdHlsZT0iYm9yZGVyOjFweCBzb2xpZCAjYzBjMGMwIiBmcmFtZWJvcmRlcj0iMCIgZnJhbWVzcGFjaW5nPSIwIiBib3JkZXI9IjAiPicpOwoJCQkJICAgICAgICAgICAgb3V0LnB1c2goJzxmcmFtZSBzcmM9ImNvbnRyb2x0cmVlLmh0bWwiIG5hbWU9InNhcC11aS1Db250cm9sVHJlZVdpbmRvdyIgZnJhbWVib3JkZXI9IjAiIHNjcm9sbGluZz0ibm8iIC8+Jyk7CgkJCQkgICAgICAgICAgICBvdXQucHVzaCgnPGZyYW1lIHNyYz0icHJvcGVydGllcy5odG1sIiBuYW1lPSJzYXAtdWktUHJvcGVydHlMaXN0V2luZG93IiBmcmFtZWJvcmRlcj0iMCIgc2Nyb2xsaW5nPSJubyIvPicpOwoJCQkJICAgICAgICBvdXQucHVzaCgnPC9mcmFtZXNldD4nKTsKCQkJCQlvdXQucHVzaCgnPC9mcmFtZXNldD4nKTsKCQkJCW91dC5wdXNoKCc8L2ZyYW1lc2V0PicpOwoKCQkJCXZhciBzSFRNTCA9IG91dC5qb2luKCJcbiIpOwoJCQkJdmFyIG9PbGRFbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImJvZHkiKVswXTsKCQkJCXZhciBvVGVtcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwoJCQkJb1RlbXAuaW5uZXJIVE1MID0gc0hUTUw7CgkJCQl2YXIgb05ld1JlZiA9IG9UZW1wLmNoaWxkTm9kZXNbMF07CgkJCQl2YXIgb1BhcmVudFJlZiA9IG9PbGRFbGVtLnBhcmVudE5vZGU7CgkJCQlvUGFyZW50UmVmLnJlcGxhY2VDaGlsZChvTmV3UmVmLCBvT2xkRWxlbSk7CgkJCX0KCQkJCgkJCWZ1bmN0aW9uIGVkaXRJblNuaXBwaXgoKSB7CgkJCQl2YXIgc25pcHBpeEJhc2VVcmwgPSAiaHR0cDovL3ZldWk1aW5mcmE6ODA4MC9zbmlwcGl4LyI7IC8qIGFsd2F5cyB1c2UgdGhlIGNlbnRyYWwgc25pcHBpeCB0byBhdm9pZCBzcHJlYWRpbmcgc25pcHBldHMgYWNyb3NzIG11bHRpcGxlIHNlcnZlcnMgKi8KCQkJCXZhciB1cmwgPSB3aW5kb3cuZnJhbWVzWydzYXAtdWktQ29udGVudFdpbmRvdyddLmRvY3VtZW50LmxvY2F0aW9uLmhyZWY7CgkJCQl1cmwgPSB1cmwucmVwbGFjZSgvJS9nLCAiJTI1IikucmVwbGFjZSgvXD8vZywgIiUzRiIpLnJlcGxhY2UoLyYvZywgIiUyNiIpLnJlcGxhY2UoLyMvZywgIiUyMyIpOyAvLyBlc2NhcGUgc3BlY2lhbCBjaGFyYWN0ZXJzIGluIFVSTAoJCQkJd2luZG93Lm9wZW4oc25pcHBpeEJhc2VVcmwgKyAiP3VybD0iICsgdXJsLCAnX2JsYW5rJyk7CgkJCX0KCQkJCgkJCWZ1bmN0aW9uIG9wZW5JbkRldmljZVNpbXVsYXRvcigpIHsKCQkJCXZhciBiYXNlVXJsID0gIkRldmljZVJlc29sdXRpb25FbXVsYXRvci5odG1sIjsKCQkJCWlmIChqUXVlcnkuc2FwLnN5bmNIZWFkKCIuLi8uLi9EZXZpY2VTaW11bGF0b3IuaHRtbCIpKSB7CgkJCQkJYmFzZVVybCA9ICIuLi8uLi9EZXZpY2VTaW11bGF0b3IuaHRtbCI7CgkJCQl9CgkJCQl2YXIgdXJsID0gd2luZG93LmZyYW1lc1snc2FwLXVpLUNvbnRlbnRXaW5kb3cnXS5kb2N1bWVudC5sb2NhdGlvbi5ocmVmOwoJCQkJdXJsID0gdXJsLnJlcGxhY2UoLyUvZywgIiUyNSIpLnJlcGxhY2UoL1w/L2csICIlM0YiKS5yZXBsYWNlKC8mL2csICIlMjYiKS5yZXBsYWNlKC8jL2csICIlMjMiKTsgLy8gZXNjYXBlIHNwZWNpYWwgY2hhcmFjdGVycyBpbiBVUkwKCQkJCXdpbmRvdy5vcGVuKGJhc2VVcmwgKyAiP3VybD0iICsgdXJsLCAnX2JsYW5rJyk7CgkJCX0KCQkJCgkJCWZ1bmN0aW9uIHJlZGlyZWN0VG9UZXN0cnVubmVyKCkgewoJCQkJCgkJCQl2YXIgc0NvbnRlbnRVcmwgPSBzYXAudWkudGVzdGZ3ay5UZXN0RldLLmdldENvbnRlbnRVUkwoKSwKCQkJCSAgICBhTWF0Y2hlcyA9IC8uKlwvdGVzdC1yZXNvdXJjZXNcLyguKlwucXVuaXRcLmh0bWwpJC9pLmV4ZWMoc0NvbnRlbnRVcmwpCgkJCQkgICAgc1Rlc3RQYWdlID0gYU1hdGNoZXMgJiYgYU1hdGNoZXNbMF0sCgkJCQkgICAgc1Rlc3RydW5uZXJVcmwgPSAiLi4vc2FwL3VpL3F1bml0L3Rlc3RydW5uZXIuaHRtbCIgKyAoc1Rlc3RQYWdlID8gIj90ZXN0cGFnZT0iICsgZW5jb2RlVVJJQ29tcG9uZW50KHNUZXN0UGFnZSkgOiAiIiksCgkJCQkKCQkJCXdpbmRvdy5vcGVuKHNUZXN0cnVubmVyVXJsKTsKCQkJCQoJCQl9CgkJCQoJCTwvc2NyaXB0PgoJPC9oZWFkPgoKCTwhLS0gcmVwbGFjZWQgYnkgdGhlIGR5bmFtaWNhbGx5IGNyZWF0ZWQgZnJhbWVzZXQgYWJvdmUgLS0+ICAJCgk8ZnJhbWVzZXQgcm93cz0iMzUsKiIgc3R5bGU9ImJvcmRlcjpub25lIiBvbmxvYWQ9Il9vbmxvYWQoKTsiIGZyYW1lYm9yZGVyPSIwIiBmcmFtZXNwYWNpbmc9IjAiIGJvcmRlcj0iMCI+CgkJPGZyYW1lIHNyYz0idGl0bGUuaHRtbCIgc2Nyb2xsaW5nPSJubyIgbmFtZT0ic2FwLXVpLVRpdGxlV2luZG93IiBub3Jlc2l6ZT0ibm9yZXNpemUiIGZyYW1lYm9yZGVyPSIwIiBib3JkZXI9IjAiLz4KCQk8ZnJhbWVzZXQgaWQ9InNhcC11aS10ZXN0c3VpdGUtb3V0ZXIiIGNvbHM9IjI1MCwqLDIyMCIgZnJhbWVib3JkZXI9IjAiIGZyYW1lc3BhY2luZz0iMCIgYm9yZGVyPSIwIiBuYW1lPSJPdXRlckZyYW1lc2V0IiA+CgkJCTxmcmFtZXNldCBpZD0ic2FwLXVpLXRlc3RzdWl0ZS1sZWZ0IiByb3dzPSIqLDM2MCIgc3R5bGU9ImJvcmRlcjoxcHggc29saWQgI2MwYzBjMCIgZnJhbWVib3JkZXI9IjAiIGZyYW1lc3BhY2luZz0iMCIgYm9yZGVyPSIwIj4KCQkJCTxmcmFtZSBzcmM9InNhbXBsZXMuaHRtbCIgc2Nyb2xsaW5nPSJhdXRvIiBmcmFtZWJvcmRlcj0iMCIgbmFtZT0ic2FwLXVpLVNhbXBsZVdpbmRvdyIgLz4KCSAgICAgICAgICAgIDxmcmFtZSBzY3JvbGxpbmc9Im5vIiBmcmFtZWJvcmRlcj0iMCIgbmFtZT0ic2FwLXVpLVNldHRpbmdzV2luZG93IiBzcmM9ImVtcHR5Lmh0bWwiIC8+CgkgICAgICAgIDwvZnJhbWVzZXQ+CgkgICAgICAgIDxmcmFtZXNldCBpZD0ic2FwLXVpLXRlc3RzdWl0ZS1taWRkbGUiIG5hbWU9IkNvbnRlbnQiIHJvd3M9IiosMjUwIiBzdHlsZT0iYm9yZGVyOjFweCBzb2xpZCAjYzBjMGMwIiBmcmFtZWJvcmRlcj0iMCIgZnJhbWVzcGFjaW5nPSIwIiBib3JkZXI9IjAiPgoJICAgICAgICAgICAgPGZyYW1lIG5hbWU9InNhcC11aS1Db250ZW50V2luZG93IiBmcmFtZWJvcmRlcj0iMCIgc2Nyb2xsaW5nPSJhdXRvIiBvbmxvYWQ9InRlc3Rmd2sub25Db250ZW50TG9hZCgpOyIgLz4KCSAgICAgICAgICAgIDxmcmFtZSBuYW1lPSJzYXAtdWktVHJhY2VXaW5kb3ciIHNyYz0iZW1wdHkuaHRtbCIgZnJhbWVib3JkZXI9IjAiIHNjcm9sbGluZz0ibm8iIC8+CgkgICAgICAgIDwvZnJhbWVzZXQ+IAoJICAgICAgICA8ZnJhbWVzZXQgaWQ9InNhcC11aS10ZXN0c3VpdGUtcmlnaHQiIHJvd3M9IjUwJSwqIiBzdHlsZT0iYm9yZGVyOjFweCBzb2xpZCAjYzBjMGMwIiBmcmFtZWJvcmRlcj0iMCIgZnJhbWVzcGFjaW5nPSIwIiBib3JkZXI9IjAiPgoJICAgICAgICAgICAgPGZyYW1lIHNyYz0iY29udHJvbHRyZWUuaHRtbCIgbmFtZT0ic2FwLXVpLUNvbnRyb2xUcmVlV2luZG93IiBmcmFtZWJvcmRlcj0iMCIgc2Nyb2xsaW5nPSJubyIgLz4KCSAgICAgICAgICAgIDxmcmFtZSBzcmM9InByb3BlcnRpZXMuaHRtbCIgbmFtZT0ic2FwLXVpLVByb3BlcnR5TGlzdFdpbmRvdyIgZnJhbWVib3JkZXI9IjAiIHNjcm9sbGluZz0ibm8iLz4KCSAgICAgICAgPC9mcmFtZXNldD4KCQk8L2ZyYW1lc2V0PgoJPC9mcmFtZXNldD4KCTwhLS0gLS0+CgkKPC9odG1sPg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 21:26:48 GMT",
                    "Content-Length": "10699",
                    "Date": "Fri, 07 Nov 2014 21:27:10 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}