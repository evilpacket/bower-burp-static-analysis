{
    "url": "http://localhost:9999/lhorie/mithril.js/archive/v0.1.12/mithril.min.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>location.pathname</b> and written to <b>the 'href' property of a DOM element</b> via the following statement:<ul><li>g.href= location.pathname+ K[c.route.mode] + g.pathname</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/lhorie/mithril.js/archive/v0.1.12/mithril.min.js",
                "path": "/lhorie/mithril.js/archive/v0.1.12/mithril.min.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9saG9yaWUvbWl0aHJpbC5qcy9hcmNoaXZlL3YwLjEuMTIvbWl0aHJpbC5taW4uanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogOTI1OA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAxNjoxMjoxOCBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMTY6MTI6MTcgR01UDQoNCi8qCk1pdGhyaWwgdjAuMS4xMgpodHRwOi8vZ2l0aHViLmNvbS9saG9yaWUvbWl0aHJpbC5qcwooYykgTGVvIEhvcmllCkxpY2Vuc2U6IE1JVAoqLwpNaXRocmlsPW09bmV3IGZ1bmN0aW9uIGEoYil7ZnVuY3Rpb24gYygpe3ZhciBhPWFyZ3VtZW50cyxiPSJbb2JqZWN0IE9iamVjdF0iPT12LmNhbGwoYVsxXSksYz1iP2FbMV06e30sZD0iY2xhc3MiaW4gYz8iY2xhc3MiOiJjbGFzc05hbWUiLGU9dVthWzBdXTtpZih2b2lkIDA9PT1lKXt1W2FbMF1dPWU9e3RhZzoiZGl2IixhdHRyczp7fX07Zm9yKHZhciBmLGc9W107Zj13LmV4ZWMoYVswXSk7KWlmKCIiPT1mWzFdKWUudGFnPWZbMl07ZWxzZSBpZigiIyI9PWZbMV0pZS5hdHRycy5pZD1mWzJdO2Vsc2UgaWYoIi4iPT1mWzFdKWcucHVzaChmWzJdKTtlbHNlIGlmKCJbIj09ZlszXVswXSl7dmFyIGk9eC5leGVjKGZbM10pO2UuYXR0cnNbaVsxXV09aVszXXx8ITB9Zy5sZW5ndGg+MCYmKGUuYXR0cnNbZF09Zy5qb2luKCIgIikpfWU9aChlKSxlLmF0dHJzPWgoZS5hdHRycyksZS5jaGlsZHJlbj1iP2FbMl06YVsxXTtmb3IodmFyIGogaW4gYyllLmF0dHJzW2pdPWo9PWQ/KGUuYXR0cnNbal18fCIiKSsiICIrY1tqXTpjW2pdO3JldHVybiBlfWZ1bmN0aW9uIGQoYSxjLGgsaSxqLGssbCxtKXtpZigobnVsbD09PWh8fHZvaWQgMD09PWgpJiYoaD0iIiksInJldGFpbiIhPT1oLnN1YnRyZWUpe3ZhciBuPXYuY2FsbChpKSxvPXYuY2FsbChoKTtpZihuIT1vJiYobnVsbCE9PWkmJnZvaWQgMCE9PWkmJmYoaS5ub2RlcyksaT1uZXcgaC5jb25zdHJ1Y3RvcixpLm5vZGVzPVtdKSwiW29iamVjdCBBcnJheV0iPT1vKXtmb3IodmFyIHA9W10scT1pLmxlbmd0aD09PWgubGVuZ3RoLHI9MCxzPTAsdD0wO3M8aC5sZW5ndGg7cysrKXt2YXIgdT1kKGEsbnVsbCxoW3NdLGlbdF0saixrK3J8fHIsbCxtKTt2b2lkIDAhPT11JiYodS5ub2Rlcy5pbnRhY3R8fChxPSExKSxyKz11IGluc3RhbmNlb2YgQXJyYXk/dS5sZW5ndGg6MSxpW3QrK109dSl9aWYoIXEpe2Zvcih2YXIgcz0wO3M8aC5sZW5ndGg7cysrKXZvaWQgMCE9PWlbc10mJihwPXAuY29uY2F0KGlbc10ubm9kZXMpKTtmb3IodmFyIHcscz1wLmxlbmd0aDt3PWkubm9kZXNbc107cysrKW51bGwhPT13LnBhcmVudE5vZGUmJncucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh3KTtmb3IodmFyIHcscz1pLm5vZGVzLmxlbmd0aDt3PXBbc107cysrKW51bGw9PT13LnBhcmVudE5vZGUmJmEuYXBwZW5kQ2hpbGQodyk7aC5sZW5ndGg8aS5sZW5ndGgmJihpLmxlbmd0aD1oLmxlbmd0aCksaS5ub2Rlcz1wfX1lbHNlIGlmKCJbb2JqZWN0IE9iamVjdF0iPT1vKXtpZigoaC50YWchPWkudGFnfHxPYmplY3Qua2V5cyhoLmF0dHJzKS5qb2luKCkhPU9iamVjdC5rZXlzKGkuYXR0cnMpLmpvaW4oKXx8aC5hdHRycy5pZCE9aS5hdHRycy5pZCkmJmYoaS5ub2RlcyksInN0cmluZyIhPXR5cGVvZiBoLnRhZylyZXR1cm47dmFyIHcseD0wPT09aS5ub2Rlcy5sZW5ndGg7InN2ZyI9PT1oLnRhZyYmKG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIikseD8odz12b2lkIDA9PT1tP2IuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChoLnRhZyk6Yi5kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMobSxoLnRhZyksaT17dGFnOmgudGFnLGF0dHJzOmUodyxoLnRhZyxoLmF0dHJzLHt9LG0pLGNoaWxkcmVuOmQodyxoLnRhZyxoLmNoaWxkcmVuLGkuY2hpbGRyZW4sITAsMCxoLmF0dHJzLmNvbnRlbnRlZGl0YWJsZT93OmwsbSksbm9kZXM6W3ddfSxhLmluc2VydEJlZm9yZSh3LGEuY2hpbGROb2Rlc1trXXx8bnVsbCkpOih3PWkubm9kZXNbMF0sZSh3LGgudGFnLGguYXR0cnMsaS5hdHRycyxtKSxpLmNoaWxkcmVuPWQodyxoLnRhZyxoLmNoaWxkcmVuLGkuY2hpbGRyZW4sITEsMCxoLmF0dHJzLmNvbnRlbnRlZGl0YWJsZT93OmwsbSksaS5ub2Rlcy5pbnRhY3Q9ITAsaj09PSEwJiZhLmluc2VydEJlZm9yZSh3LGEuY2hpbGROb2Rlc1trXXx8bnVsbCkpLCJbb2JqZWN0IEZ1bmN0aW9uXSI9PXYuY2FsbChoLmF0dHJzLmNvbmZpZykmJmguYXR0cnMuY29uZmlnKHcsIXgpfWVsc2V7dmFyIHc7aWYoMD09PWkubm9kZXMubGVuZ3RoKWguJHRydXN0ZWQ/dz1nKGEsayxoKToodz1iLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGgpLGEuaW5zZXJ0QmVmb3JlKHcsYS5jaGlsZE5vZGVzW2tdfHxudWxsKSksaT0ic3RyaW5nIG51bWJlciBib29sZWFuIi5pbmRleE9mKHR5cGVvZiBoKT4tMT9uZXcgaC5jb25zdHJ1Y3RvcihoKTpoLGkubm9kZXM9W3ddO2Vsc2UgaWYoaS52YWx1ZU9mKCkhPT1oLnZhbHVlT2YoKXx8aj09PSEwKXtpZighbHx8bCE9PWIuZG9jdW1lbnQuYWN0aXZlRWxlbWVudClpZihoLiR0cnVzdGVkKXt2YXIgeT1pLm5vZGVzWzBdLHA9W3ldO2lmKHkpe2Zvcig7eT15Lm5leHRTaWJsaW5nOylwLnB1c2goeSk7ZihwKSx3PWcoYSxrLGgpfWVsc2UgYS5pbm5lckhUTUw9aH1lbHNlIHc9aS5ub2Rlc1swXSwidGV4dGFyZWEiPT09Yz9hLnZhbHVlPWg6bD9sLmlubmVySFRNTD1oOihhLmluc2VydEJlZm9yZSh3LGEuY2hpbGROb2Rlc1trXXx8bnVsbCksdy5ub2RlVmFsdWU9aCk7aT1uZXcgaC5jb25zdHJ1Y3RvcihoKSxpLm5vZGVzPVt3XX1lbHNlIGkubm9kZXMuaW50YWN0PSEwfXJldHVybiBpfX1mdW5jdGlvbiBlKGEsYyxkLGUsZil7Zm9yKHZhciBnIGluIGQpe3ZhciBoPWRbZ10saj1lW2ddO2lmKCEoZyBpbiBlKXx8aiE9PWh8fGE9PT1iLmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpe2lmKGVbZ109aCwiY29uZmlnIj09PWcpY29udGludWU7aWYoImZ1bmN0aW9uIj09dHlwZW9mIGgmJjA9PWcuaW5kZXhPZigib24iKSlhW2ddPWkoaCxhKTtlbHNlIGlmKCJzdHlsZSI9PT1nKWZvcih2YXIgayBpbiBoKSh2b2lkIDA9PT1qfHxqW2tdIT09aFtrXSkmJihhLnN0eWxlW2tdPWhba10pO2Vsc2Ugdm9pZCAwIT09Zj8iaHJlZiI9PT1nP2Euc2V0QXR0cmlidXRlTlMoImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiLCJocmVmIixoKToiY2xhc3NOYW1lIj09PWc/YS5zZXRBdHRyaWJ1dGUoImNsYXNzIixoKTphLnNldEF0dHJpYnV0ZShnLGgpOiJ2YWx1ZSI9PT1nJiYiaW5wdXQiPT09Yz9hLnZhbHVlIT09aCYmKGEudmFsdWU9aCk6ZyBpbiBhJiYibGlzdCIhPWc/YVtnXT1oOmEuc2V0QXR0cmlidXRlKGcsaCl9fXJldHVybiBlfWZ1bmN0aW9uIGYoYSl7Zm9yKHZhciBiPWEubGVuZ3RoLTE7Yj4tMTtiLS0pYVtiXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGFbYl0pO2EubGVuZ3RoPTB9ZnVuY3Rpb24gZyhhLGIsYyl7dmFyIGQ9YS5jaGlsZE5vZGVzW2JdO3JldHVybiBkP2QuaW5zZXJ0QWRqYWNlbnRIVE1MKCJiZWZvcmViZWdpbiIsYyk6YS5pbnNlcnRBZGphY2VudEhUTUwoImJlZm9yZWVuZCIsYyksZD9kLnByZXZpb3VzU2libGluZzphLmZpcnN0Q2hpbGR9ZnVuY3Rpb24gaChhKXt2YXIgYj17fTtmb3IodmFyIGMgaW4gYSliW2NdPWFbY107cmV0dXJuIGJ9ZnVuY3Rpb24gaShhLGIpe3JldHVybiBmdW5jdGlvbihkKXtjLnN0YXJ0Q29tcHV0YXRpb24oKTt0cnl7cmV0dXJuIGEuY2FsbChiLGQpfWZpbmFsbHl7Yy5lbmRDb21wdXRhdGlvbigpfX19ZnVuY3Rpb24gaigpe2Zvcih2YXIgYT0wO2E8Qi5sZW5ndGg7YSsrKWMucmVuZGVyKEJbYV0sQ1thXS52aWV3KERbYV0pKTtIJiYoSCgpLEg9bnVsbCksRj1FfWZ1bmN0aW9uIGsoYSxiLGQpe009e307Zm9yKHZhciBlIGluIGIpe2lmKGU9PWQpcmV0dXJuIXZvaWQgYy5tb2R1bGUoYSxiW2VdKTt2YXIgZj1uZXcgUmVnRXhwKCJeIitlLnJlcGxhY2UoLzpbXlwvXSs/XC57M30vZywiKC4qPykiKS5yZXBsYWNlKC86W15cL10rL2csIihbXlxcL10rKSIpKyIkIik7aWYoZi50ZXN0KGQpKXJldHVybiF2b2lkIGQucmVwbGFjZShmLGZ1bmN0aW9uKCl7Zm9yKHZhciBkPWUubWF0Y2goLzpbXlwvXSsvZyksZj1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxLC0yKSxnPTA7ZzxkLmxlbmd0aDtnKyspTVtkW2ddLnJlcGxhY2UoLzp8XC4vZywiIildPWRlY29kZVVSSUNvbXBvbmVudChmW2ddKTtjLm1vZHVsZShhLGJbZV0pfSl9fWZ1bmN0aW9uIGwoYSl7YS5jdHJsS2V5fHxhLm1ldGFLZXl8fDI9PWEud2hpY2h8fChhLnByZXZlbnREZWZhdWx0KCksYy5yb3V0ZShhLmN1cnJlbnRUYXJnZXRbYy5yb3V0ZS5tb2RlXS5zbGljZShLW2Mucm91dGUubW9kZV0ubGVuZ3RoKSkpfWZ1bmN0aW9uIG0oKXsiaGFzaCIhPWMucm91dGUubW9kZSYmYi5sb2NhdGlvbi5oYXNoJiYoYi5sb2NhdGlvbi5oYXNoPWIubG9jYXRpb24uaGFzaCl9ZnVuY3Rpb24gbihhKXtyZXR1cm4gYX1mdW5jdGlvbiBvKGEpe3ZhciBjPWIuWERvbWFpblJlcXVlc3Q/bmV3IGIuWERvbWFpblJlcXVlc3Q6bmV3IGIuWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIGMub3BlbihhLm1ldGhvZCxhLnVybCwhMCxhLnVzZXIsYS5wYXNzd29yZCksYy5vbmxvYWQ9ImZ1bmN0aW9uIj09dHlwZW9mIGEub25sb2FkP2Eub25sb2FkOmZ1bmN0aW9uKCl7fSxjLm9uZXJyb3I9ImZ1bmN0aW9uIj09dHlwZW9mIGEub25lcnJvcj9hLm9uZXJyb3I6ZnVuY3Rpb24oKXt9LGMub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PWMucmVhZHlTdGF0ZSYmMD09PWMuc3RhdHVzJiZjLm9uZXJyb3Ioe3R5cGU6ImVycm9yIix0YXJnZXQ6Y30pfSwiZnVuY3Rpb24iPT10eXBlb2YgYS5jb25maWcmJmEuY29uZmlnKGMsYSksYy5zZW5kKGEuZGF0YSksY31mdW5jdGlvbiBwKGEsYil7dmFyIGM9W107Zm9yKHZhciBkIGluIGEpe3ZhciBlPWI/YisiWyIrZCsiXSI6ZCxmPWFbZF07Yy5wdXNoKCJvYmplY3QiPT10eXBlb2YgZj9wKGYsZSk6ZW5jb2RlVVJJQ29tcG9uZW50KGUpKyI9IitlbmNvZGVVUklDb21wb25lbnQoZikpfXJldHVybiBjLmpvaW4oIiYiKX1mdW5jdGlvbiBxKGEsYixjKXtyZXR1cm4gYiYmT2JqZWN0LmtleXMoYikubGVuZ3RoPjAmJigiR0VUIj09YS5tZXRob2Q/YS51cmw9YS51cmwrKGEudXJsLmluZGV4T2YoIj8iKTwwPyI/IjoiJiIpK3AoYik6YS5kYXRhPWMoYikpLGF9ZnVuY3Rpb24gcihhLGIpe3ZhciBjPWEubWF0Y2goLzpbYS16XVx3Ky9naSk7aWYoYyYmYilmb3IodmFyIGQ9MDtkPGMubGVuZ3RoO2QrKyl7dmFyIGU9Y1tkXS5zbGljZSgxKTthPWEucmVwbGFjZShjW2RdLGJbZV0pLGRlbGV0ZSBiW2VdfXJldHVybiBhfWZ1bmN0aW9uIHMoYSl7dmFyIGI9YS50aGVuO3JldHVybiBmdW5jdGlvbihhLGMpe3ZhciBkPWIoZnVuY3Rpb24oYil7cmV0dXJuIGQoYShiKSl9LGZ1bmN0aW9uKGEpe3JldHVybiBkKGMoYSkpfSk7cmV0dXJuIGQudGhlbj1zKGQpLGR9fXZhciB0LHU9e30sdj17fS50b1N0cmluZyx3PS8oPzooXnwjfFwuKShbXiNcLlxbXF1dKykpfChcWy4rP1xdKS9nLHg9L1xbKC4rPykoPzo9KCJ8J3wpKC4rPylcMik/XF0vLHk9e2luc2VydEFkamFjZW50SFRNTDpmdW5jdGlvbihhLGMpe2IuZG9jdW1lbnQud3JpdGUoYyksYi5kb2N1bWVudC5jbG9zZSgpfSxhcHBlbmRDaGlsZDpmdW5jdGlvbihhKXt2b2lkIDA9PT10JiYodD1iLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImh0bWwiKSksIkhUTUwiPT1hLm5vZGVOYW1lP3Q9YTp0LmFwcGVuZENoaWxkKGEpLGIuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IT09dCYmYi5kb2N1bWVudC5yZXBsYWNlQ2hpbGQodCxiLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCl9LGluc2VydEJlZm9yZTpmdW5jdGlvbihhKXt0aGlzLmFwcGVuZENoaWxkKGEpfSxjaGlsZE5vZGVzOltdfSx6PVtdLEE9e307Yy5yZW5kZXI9ZnVuY3Rpb24oYSxjKXt2YXIgZT16LmluZGV4T2YoYSksZj0wPmU/ei5wdXNoKGEpLTE6ZSxnPWE9PWIuZG9jdW1lbnR8fGE9PWIuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50P3k6YTtBW2ZdPWQoZyxudWxsLGMsQVtmXSwhMSwwLG51bGwsdm9pZCAwKX0sYy50cnVzdD1mdW5jdGlvbihhKXtyZXR1cm4gYT1uZXcgU3RyaW5nKGEpLGEuJHRydXN0ZWQ9ITAsYX07dmFyIEI9W10sQz1bXSxEPVtdLEU9MCxGPTAsRz0wLEg9bnVsbDtjLm1vZHVsZT1mdW5jdGlvbihhLGIpe2Muc3RhcnRDb21wdXRhdGlvbigpO3ZhciBkPUIuaW5kZXhPZihhKTswPmQmJihkPUIubGVuZ3RoKSxCW2RdPWEsQ1tkXT1iLERbZF09bmV3IGIuY29udHJvbGxlcixjLmVuZENvbXB1dGF0aW9uKCl9LGMucmVkcmF3PWZ1bmN0aW9uKCl7aWYoRT1iLnBlcmZvcm1hbmNlJiZiLnBlcmZvcm1hbmNlLm5vdz9iLnBlcmZvcm1hbmNlLm5vdygpOihuZXcgYi5EYXRlKS5nZXRUaW1lKCksRS1GPjE2KWooKTtlbHNle3ZhciBhPWIuY2FuY2VsQW5pbWF0aW9uRnJhbWV8fGIuY2xlYXJUaW1lb3V0LGM9Yi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGIuc2V0VGltZW91dDthKEcpLEc9YyhqLDApfX07dmFyIEk9MDtjLnN0YXJ0Q29tcHV0YXRpb249ZnVuY3Rpb24oKXtJKyt9LGMuZW5kQ29tcHV0YXRpb249ZnVuY3Rpb24oKXtJPU1hdGgubWF4KEktMSwwKSwwPT1JJiZjLnJlZHJhdygpfSxjLndpdGhBdHRyPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGZ1bmN0aW9uKGMpe2IoYSBpbiBjLmN1cnJlbnRUYXJnZXQ/Yy5jdXJyZW50VGFyZ2V0W2FdOmMuY3VycmVudFRhcmdldC5nZXRBdHRyaWJ1dGUoYSkpfX07dmFyIEosSz17cGF0aG5hbWU6IiIsaGFzaDoiIyIsc2VhcmNoOiI/In0sTD1mdW5jdGlvbigpe30sTT17fTtyZXR1cm4gYy5yb3V0ZT1mdW5jdGlvbigpe2lmKDA9PT1hcmd1bWVudHMubGVuZ3RoKXJldHVybiBKO2lmKDM9PT1hcmd1bWVudHMubGVuZ3RoKXtKPWIubG9jYXRpb25bYy5yb3V0ZS5tb2RlXS5zbGljZShLW2Mucm91dGUubW9kZV0ubGVuZ3RoKTt2YXIgYT1hcmd1bWVudHNbMF0sZD1hcmd1bWVudHNbMV0sZT1hcmd1bWVudHNbMl07TD1mdW5jdGlvbihiKXt2YXIgZj1iLnNsaWNlKEtbYy5yb3V0ZS5tb2RlXS5sZW5ndGgpO2soYSxlLGYpfHxjLnJvdXRlKGQsITApfTt2YXIgZj0iaGFzaCI9PWMucm91dGUubW9kZT8ib25oYXNoY2hhbmdlIjoib25wb3BzdGF0ZSI7YltmXT1mdW5jdGlvbigpe0woYi5sb2NhdGlvbltjLnJvdXRlLm1vZGVdKX0sSD1tLGJbZl0oKX1lbHNlIGlmKGFyZ3VtZW50c1swXS5hZGRFdmVudExpc3RlbmVyKXt2YXIgZz1hcmd1bWVudHNbMF0saD1hcmd1bWVudHNbMV07Zy5ocmVmLmluZGV4T2YoS1tjLnJvdXRlLm1vZGVdKTwwJiYoZy5ocmVmPWxvY2F0aW9uLnBhdGhuYW1lK0tbYy5yb3V0ZS5tb2RlXStnLnBhdGhuYW1lKSxofHwoZy5yZW1vdmVFdmVudExpc3RlbmVyKCJjbGljayIsbCksZy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsbCkpfWVsc2UgaWYoInN0cmluZyI9PXR5cGVvZiBhcmd1bWVudHNbMF0pe0o9YXJndW1lbnRzWzBdO3ZhciBpPWFyZ3VtZW50c1sxXT09PSEwO2IuaGlzdG9yeS5wdXNoU3RhdGU/KEg9ZnVuY3Rpb24oKXtiLmhpc3RvcnlbaT8icmVwbGFjZVN0YXRlIjoicHVzaFN0YXRlIl0obnVsbCxiLmRvY3VtZW50LnRpdGxlLEtbYy5yb3V0ZS5tb2RlXStKKSxtKCl9LEwoS1tjLnJvdXRlLm1vZGVdK0opKTpiLmxvY2F0aW9uW2Mucm91dGUubW9kZV09Sn19LGMucm91dGUucGFyYW09ZnVuY3Rpb24oYSl7cmV0dXJuIE1bYV19LGMucm91dGUubW9kZT0ic2VhcmNoIixjLnByb3A9ZnVuY3Rpb24oYSl7dmFyIGI9ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCYmKGE9YXJndW1lbnRzWzBdKSxhfTtyZXR1cm4gYi50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gYX0sYn0sYy5kZWZlcnJlZD1mdW5jdGlvbigpe3ZhciBhPVtdLGI9W10sZD17cmVzb2x2ZTpmdW5jdGlvbihiKXtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKylhW2NdKGIpfSxyZWplY3Q6ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPTA7YzxiLmxlbmd0aDtjKyspYltjXShhKX0scHJvbWlzZTpjLnByb3AoKX07cmV0dXJuIGQucHJvbWlzZS5yZXNvbHZlcnM9YSxkLnByb21pc2UudGhlbj1mdW5jdGlvbihkLGUpe2Z1bmN0aW9uIGYoYSxiLGMpe2EucHVzaChmdW5jdGlvbihhKXt0cnl7dmFyIGQ9YyhhKTtkJiYiZnVuY3Rpb24iPT10eXBlb2YgZC50aGVuP2QudGhlbihnW2JdLGUpOmdbYl0odm9pZCAwIT09ZD9kOmEpfWNhdGNoKGYpe2lmKGYgaW5zdGFuY2VvZiBFcnJvciYmZi5jb25zdHJ1Y3RvciE9PUVycm9yKXRocm93IGY7Zy5yZWplY3QoZil9fSl9dmFyIGc9Yy5kZWZlcnJlZCgpO3JldHVybiBkfHwoZD1uKSxlfHwoZT1uKSxmKGEsInJlc29sdmUiLGQpLGYoYiwicmVqZWN0IixlKSxnLnByb21pc2V9LGR9LGMuc3luYz1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGIpe3JldHVybiBmdW5jdGlvbihjKXtyZXR1cm4gZi5wdXNoKGMpLGJ8fChkPSJyZWplY3QiKSxmLmxlbmd0aD09YS5sZW5ndGgmJihlLnByb21pc2UoZiksZVtkXShmKSksY319Zm9yKHZhciBkPSJyZXNvbHZlIixlPWMuZGVmZXJyZWQoKSxmPVtdLGc9MDtnPGEubGVuZ3RoO2crKylhW2ddLnRoZW4oYighMCksYighMSkpO3JldHVybiBlLnByb21pc2V9LGMucmVxdWVzdD1mdW5jdGlvbihhKXthLmJhY2tncm91bmQhPT0hMCYmYy5zdGFydENvbXB1dGF0aW9uKCk7dmFyIGI9Yy5kZWZlcnJlZCgpLGQ9YS5zZXJpYWxpemV8fEpTT04uc3RyaW5naWZ5LGU9YS5kZXNlcmlhbGl6ZXx8SlNPTi5wYXJzZSxmPWEuZXh0cmFjdHx8ZnVuY3Rpb24oYSl7cmV0dXJuIDA9PT1hLnJlc3BvbnNlVGV4dC5sZW5ndGgmJmU9PT1KU09OLnBhcnNlP251bGw6YS5yZXNwb25zZVRleHR9O3JldHVybiBhLnVybD1yKGEudXJsLGEuZGF0YSksYT1xKGEsYS5kYXRhLGQpLGEub25sb2FkPWEub25lcnJvcj1mdW5jdGlvbihkKXt2YXIgZz0oImxvYWQiPT1kLnR5cGU/YS51bndyYXBTdWNjZXNzOmEudW53cmFwRXJyb3IpfHxuLGg9ZyhlKGYoZC50YXJnZXQsYSkpKTtpZihoIGluc3RhbmNlb2YgQXJyYXkmJmEudHlwZSlmb3IodmFyIGk9MDtpPGgubGVuZ3RoO2krKyloW2ldPW5ldyBhLnR5cGUoaFtpXSk7ZWxzZSBhLnR5cGUmJihoPW5ldyBhLnR5cGUoaCkpO2IucHJvbWlzZShoKSxiWyJsb2FkIj09ZC50eXBlPyJyZXNvbHZlIjoicmVqZWN0Il0oaCksYS5iYWNrZ3JvdW5kIT09ITAmJmMuZW5kQ29tcHV0YXRpb24oKX0sbyhhKSxiLnByb21pc2UudGhlbj1zKGIucHJvbWlzZSksYi5wcm9taXNlfSxjLmRlcHM9ZnVuY3Rpb24oYSl7cmV0dXJuIGI9YX0sYy5kZXBzLmZhY3Rvcnk9YSxjfSh0aGlzKSwidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZSYmbnVsbCE9PW1vZHVsZSYmKG1vZHVsZS5leHBvcnRzPW0pLCJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZShmdW5jdGlvbigpe3JldHVybiBtfSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pdGhyaWwubWluLm1hcA==",
                "body": "LyoKTWl0aHJpbCB2MC4xLjEyCmh0dHA6Ly9naXRodWIuY29tL2xob3JpZS9taXRocmlsLmpzCihjKSBMZW8gSG9yaWUKTGljZW5zZTogTUlUCiovCk1pdGhyaWw9bT1uZXcgZnVuY3Rpb24gYShiKXtmdW5jdGlvbiBjKCl7dmFyIGE9YXJndW1lbnRzLGI9IltvYmplY3QgT2JqZWN0XSI9PXYuY2FsbChhWzFdKSxjPWI/YVsxXTp7fSxkPSJjbGFzcyJpbiBjPyJjbGFzcyI6ImNsYXNzTmFtZSIsZT11W2FbMF1dO2lmKHZvaWQgMD09PWUpe3VbYVswXV09ZT17dGFnOiJkaXYiLGF0dHJzOnt9fTtmb3IodmFyIGYsZz1bXTtmPXcuZXhlYyhhWzBdKTspaWYoIiI9PWZbMV0pZS50YWc9ZlsyXTtlbHNlIGlmKCIjIj09ZlsxXSllLmF0dHJzLmlkPWZbMl07ZWxzZSBpZigiLiI9PWZbMV0pZy5wdXNoKGZbMl0pO2Vsc2UgaWYoIlsiPT1mWzNdWzBdKXt2YXIgaT14LmV4ZWMoZlszXSk7ZS5hdHRyc1tpWzFdXT1pWzNdfHwhMH1nLmxlbmd0aD4wJiYoZS5hdHRyc1tkXT1nLmpvaW4oIiAiKSl9ZT1oKGUpLGUuYXR0cnM9aChlLmF0dHJzKSxlLmNoaWxkcmVuPWI/YVsyXTphWzFdO2Zvcih2YXIgaiBpbiBjKWUuYXR0cnNbal09aj09ZD8oZS5hdHRyc1tqXXx8IiIpKyIgIitjW2pdOmNbal07cmV0dXJuIGV9ZnVuY3Rpb24gZChhLGMsaCxpLGosayxsLG0pe2lmKChudWxsPT09aHx8dm9pZCAwPT09aCkmJihoPSIiKSwicmV0YWluIiE9PWguc3VidHJlZSl7dmFyIG49di5jYWxsKGkpLG89di5jYWxsKGgpO2lmKG4hPW8mJihudWxsIT09aSYmdm9pZCAwIT09aSYmZihpLm5vZGVzKSxpPW5ldyBoLmNvbnN0cnVjdG9yLGkubm9kZXM9W10pLCJbb2JqZWN0IEFycmF5XSI9PW8pe2Zvcih2YXIgcD1bXSxxPWkubGVuZ3RoPT09aC5sZW5ndGgscj0wLHM9MCx0PTA7czxoLmxlbmd0aDtzKyspe3ZhciB1PWQoYSxudWxsLGhbc10saVt0XSxqLGsrcnx8cixsLG0pO3ZvaWQgMCE9PXUmJih1Lm5vZGVzLmludGFjdHx8KHE9ITEpLHIrPXUgaW5zdGFuY2VvZiBBcnJheT91Lmxlbmd0aDoxLGlbdCsrXT11KX1pZighcSl7Zm9yKHZhciBzPTA7czxoLmxlbmd0aDtzKyspdm9pZCAwIT09aVtzXSYmKHA9cC5jb25jYXQoaVtzXS5ub2RlcykpO2Zvcih2YXIgdyxzPXAubGVuZ3RoO3c9aS5ub2Rlc1tzXTtzKyspbnVsbCE9PXcucGFyZW50Tm9kZSYmdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHcpO2Zvcih2YXIgdyxzPWkubm9kZXMubGVuZ3RoO3c9cFtzXTtzKyspbnVsbD09PXcucGFyZW50Tm9kZSYmYS5hcHBlbmRDaGlsZCh3KTtoLmxlbmd0aDxpLmxlbmd0aCYmKGkubGVuZ3RoPWgubGVuZ3RoKSxpLm5vZGVzPXB9fWVsc2UgaWYoIltvYmplY3QgT2JqZWN0XSI9PW8pe2lmKChoLnRhZyE9aS50YWd8fE9iamVjdC5rZXlzKGguYXR0cnMpLmpvaW4oKSE9T2JqZWN0LmtleXMoaS5hdHRycykuam9pbigpfHxoLmF0dHJzLmlkIT1pLmF0dHJzLmlkKSYmZihpLm5vZGVzKSwic3RyaW5nIiE9dHlwZW9mIGgudGFnKXJldHVybjt2YXIgdyx4PTA9PT1pLm5vZGVzLmxlbmd0aDsic3ZnIj09PWgudGFnJiYobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciKSx4Pyh3PXZvaWQgMD09PW0/Yi5kb2N1bWVudC5jcmVhdGVFbGVtZW50KGgudGFnKTpiLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhtLGgudGFnKSxpPXt0YWc6aC50YWcsYXR0cnM6ZSh3LGgudGFnLGguYXR0cnMse30sbSksY2hpbGRyZW46ZCh3LGgudGFnLGguY2hpbGRyZW4saS5jaGlsZHJlbiwhMCwwLGguYXR0cnMuY29udGVudGVkaXRhYmxlP3c6bCxtKSxub2Rlczpbd119LGEuaW5zZXJ0QmVmb3JlKHcsYS5jaGlsZE5vZGVzW2tdfHxudWxsKSk6KHc9aS5ub2Rlc1swXSxlKHcsaC50YWcsaC5hdHRycyxpLmF0dHJzLG0pLGkuY2hpbGRyZW49ZCh3LGgudGFnLGguY2hpbGRyZW4saS5jaGlsZHJlbiwhMSwwLGguYXR0cnMuY29udGVudGVkaXRhYmxlP3c6bCxtKSxpLm5vZGVzLmludGFjdD0hMCxqPT09ITAmJmEuaW5zZXJ0QmVmb3JlKHcsYS5jaGlsZE5vZGVzW2tdfHxudWxsKSksIltvYmplY3QgRnVuY3Rpb25dIj09di5jYWxsKGguYXR0cnMuY29uZmlnKSYmaC5hdHRycy5jb25maWcodywheCl9ZWxzZXt2YXIgdztpZigwPT09aS5ub2Rlcy5sZW5ndGgpaC4kdHJ1c3RlZD93PWcoYSxrLGgpOih3PWIuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoaCksYS5pbnNlcnRCZWZvcmUodyxhLmNoaWxkTm9kZXNba118fG51bGwpKSxpPSJzdHJpbmcgbnVtYmVyIGJvb2xlYW4iLmluZGV4T2YodHlwZW9mIGgpPi0xP25ldyBoLmNvbnN0cnVjdG9yKGgpOmgsaS5ub2Rlcz1bd107ZWxzZSBpZihpLnZhbHVlT2YoKSE9PWgudmFsdWVPZigpfHxqPT09ITApe2lmKCFsfHxsIT09Yi5kb2N1bWVudC5hY3RpdmVFbGVtZW50KWlmKGguJHRydXN0ZWQpe3ZhciB5PWkubm9kZXNbMF0scD1beV07aWYoeSl7Zm9yKDt5PXkubmV4dFNpYmxpbmc7KXAucHVzaCh5KTtmKHApLHc9ZyhhLGssaCl9ZWxzZSBhLmlubmVySFRNTD1ofWVsc2Ugdz1pLm5vZGVzWzBdLCJ0ZXh0YXJlYSI9PT1jP2EudmFsdWU9aDpsP2wuaW5uZXJIVE1MPWg6KGEuaW5zZXJ0QmVmb3JlKHcsYS5jaGlsZE5vZGVzW2tdfHxudWxsKSx3Lm5vZGVWYWx1ZT1oKTtpPW5ldyBoLmNvbnN0cnVjdG9yKGgpLGkubm9kZXM9W3ddfWVsc2UgaS5ub2Rlcy5pbnRhY3Q9ITB9cmV0dXJuIGl9fWZ1bmN0aW9uIGUoYSxjLGQsZSxmKXtmb3IodmFyIGcgaW4gZCl7dmFyIGg9ZFtnXSxqPWVbZ107aWYoIShnIGluIGUpfHxqIT09aHx8YT09PWIuZG9jdW1lbnQuYWN0aXZlRWxlbWVudCl7aWYoZVtnXT1oLCJjb25maWciPT09Zyljb250aW51ZTtpZigiZnVuY3Rpb24iPT10eXBlb2YgaCYmMD09Zy5pbmRleE9mKCJvbiIpKWFbZ109aShoLGEpO2Vsc2UgaWYoInN0eWxlIj09PWcpZm9yKHZhciBrIGluIGgpKHZvaWQgMD09PWp8fGpba10hPT1oW2tdKSYmKGEuc3R5bGVba109aFtrXSk7ZWxzZSB2b2lkIDAhPT1mPyJocmVmIj09PWc/YS5zZXRBdHRyaWJ1dGVOUygiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIsImhyZWYiLGgpOiJjbGFzc05hbWUiPT09Zz9hLnNldEF0dHJpYnV0ZSgiY2xhc3MiLGgpOmEuc2V0QXR0cmlidXRlKGcsaCk6InZhbHVlIj09PWcmJiJpbnB1dCI9PT1jP2EudmFsdWUhPT1oJiYoYS52YWx1ZT1oKTpnIGluIGEmJiJsaXN0IiE9Zz9hW2ddPWg6YS5zZXRBdHRyaWJ1dGUoZyxoKX19cmV0dXJuIGV9ZnVuY3Rpb24gZihhKXtmb3IodmFyIGI9YS5sZW5ndGgtMTtiPi0xO2ItLSlhW2JdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYVtiXSk7YS5sZW5ndGg9MH1mdW5jdGlvbiBnKGEsYixjKXt2YXIgZD1hLmNoaWxkTm9kZXNbYl07cmV0dXJuIGQ/ZC5pbnNlcnRBZGphY2VudEhUTUwoImJlZm9yZWJlZ2luIixjKTphLmluc2VydEFkamFjZW50SFRNTCgiYmVmb3JlZW5kIixjKSxkP2QucHJldmlvdXNTaWJsaW5nOmEuZmlyc3RDaGlsZH1mdW5jdGlvbiBoKGEpe3ZhciBiPXt9O2Zvcih2YXIgYyBpbiBhKWJbY109YVtjXTtyZXR1cm4gYn1mdW5jdGlvbiBpKGEsYil7cmV0dXJuIGZ1bmN0aW9uKGQpe2Muc3RhcnRDb21wdXRhdGlvbigpO3RyeXtyZXR1cm4gYS5jYWxsKGIsZCl9ZmluYWxseXtjLmVuZENvbXB1dGF0aW9uKCl9fX1mdW5jdGlvbiBqKCl7Zm9yKHZhciBhPTA7YTxCLmxlbmd0aDthKyspYy5yZW5kZXIoQlthXSxDW2FdLnZpZXcoRFthXSkpO0gmJihIKCksSD1udWxsKSxGPUV9ZnVuY3Rpb24gayhhLGIsZCl7TT17fTtmb3IodmFyIGUgaW4gYil7aWYoZT09ZClyZXR1cm4hdm9pZCBjLm1vZHVsZShhLGJbZV0pO3ZhciBmPW5ldyBSZWdFeHAoIl4iK2UucmVwbGFjZSgvOlteXC9dKz9cLnszfS9nLCIoLio/KSIpLnJlcGxhY2UoLzpbXlwvXSsvZywiKFteXFwvXSspIikrIiQiKTtpZihmLnRlc3QoZCkpcmV0dXJuIXZvaWQgZC5yZXBsYWNlKGYsZnVuY3Rpb24oKXtmb3IodmFyIGQ9ZS5tYXRjaCgvOlteXC9dKy9nKSxmPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEsLTIpLGc9MDtnPGQubGVuZ3RoO2crKylNW2RbZ10ucmVwbGFjZSgvOnxcLi9nLCIiKV09ZGVjb2RlVVJJQ29tcG9uZW50KGZbZ10pO2MubW9kdWxlKGEsYltlXSl9KX19ZnVuY3Rpb24gbChhKXthLmN0cmxLZXl8fGEubWV0YUtleXx8Mj09YS53aGljaHx8KGEucHJldmVudERlZmF1bHQoKSxjLnJvdXRlKGEuY3VycmVudFRhcmdldFtjLnJvdXRlLm1vZGVdLnNsaWNlKEtbYy5yb3V0ZS5tb2RlXS5sZW5ndGgpKSl9ZnVuY3Rpb24gbSgpeyJoYXNoIiE9Yy5yb3V0ZS5tb2RlJiZiLmxvY2F0aW9uLmhhc2gmJihiLmxvY2F0aW9uLmhhc2g9Yi5sb2NhdGlvbi5oYXNoKX1mdW5jdGlvbiBuKGEpe3JldHVybiBhfWZ1bmN0aW9uIG8oYSl7dmFyIGM9Yi5YRG9tYWluUmVxdWVzdD9uZXcgYi5YRG9tYWluUmVxdWVzdDpuZXcgYi5YTUxIdHRwUmVxdWVzdDtyZXR1cm4gYy5vcGVuKGEubWV0aG9kLGEudXJsLCEwLGEudXNlcixhLnBhc3N3b3JkKSxjLm9ubG9hZD0iZnVuY3Rpb24iPT10eXBlb2YgYS5vbmxvYWQ/YS5vbmxvYWQ6ZnVuY3Rpb24oKXt9LGMub25lcnJvcj0iZnVuY3Rpb24iPT10eXBlb2YgYS5vbmVycm9yP2Eub25lcnJvcjpmdW5jdGlvbigpe30sYy5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXs0PT09Yy5yZWFkeVN0YXRlJiYwPT09Yy5zdGF0dXMmJmMub25lcnJvcih7dHlwZToiZXJyb3IiLHRhcmdldDpjfSl9LCJmdW5jdGlvbiI9PXR5cGVvZiBhLmNvbmZpZyYmYS5jb25maWcoYyxhKSxjLnNlbmQoYS5kYXRhKSxjfWZ1bmN0aW9uIHAoYSxiKXt2YXIgYz1bXTtmb3IodmFyIGQgaW4gYSl7dmFyIGU9Yj9iKyJbIitkKyJdIjpkLGY9YVtkXTtjLnB1c2goIm9iamVjdCI9PXR5cGVvZiBmP3AoZixlKTplbmNvZGVVUklDb21wb25lbnQoZSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChmKSl9cmV0dXJuIGMuam9pbigiJiIpfWZ1bmN0aW9uIHEoYSxiLGMpe3JldHVybiBiJiZPYmplY3Qua2V5cyhiKS5sZW5ndGg+MCYmKCJHRVQiPT1hLm1ldGhvZD9hLnVybD1hLnVybCsoYS51cmwuaW5kZXhPZigiPyIpPDA/Ij8iOiImIikrcChiKTphLmRhdGE9YyhiKSksYX1mdW5jdGlvbiByKGEsYil7dmFyIGM9YS5tYXRjaCgvOlthLXpdXHcrL2dpKTtpZihjJiZiKWZvcih2YXIgZD0wO2Q8Yy5sZW5ndGg7ZCsrKXt2YXIgZT1jW2RdLnNsaWNlKDEpO2E9YS5yZXBsYWNlKGNbZF0sYltlXSksZGVsZXRlIGJbZV19cmV0dXJuIGF9ZnVuY3Rpb24gcyhhKXt2YXIgYj1hLnRoZW47cmV0dXJuIGZ1bmN0aW9uKGEsYyl7dmFyIGQ9YihmdW5jdGlvbihiKXtyZXR1cm4gZChhKGIpKX0sZnVuY3Rpb24oYSl7cmV0dXJuIGQoYyhhKSl9KTtyZXR1cm4gZC50aGVuPXMoZCksZH19dmFyIHQsdT17fSx2PXt9LnRvU3RyaW5nLHc9Lyg/OihefCN8XC4pKFteI1wuXFtcXV0rKSl8KFxbLis/XF0pL2cseD0vXFsoLis/KSg/Oj0oInwnfCkoLis/KVwyKT9cXS8seT17aW5zZXJ0QWRqYWNlbnRIVE1MOmZ1bmN0aW9uKGEsYyl7Yi5kb2N1bWVudC53cml0ZShjKSxiLmRvY3VtZW50LmNsb3NlKCl9LGFwcGVuZENoaWxkOmZ1bmN0aW9uKGEpe3ZvaWQgMD09PXQmJih0PWIuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaHRtbCIpKSwiSFRNTCI9PWEubm9kZU5hbWU/dD1hOnQuYXBwZW5kQ2hpbGQoYSksYi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQhPT10JiZiLmRvY3VtZW50LnJlcGxhY2VDaGlsZCh0LGIuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KX0saW5zZXJ0QmVmb3JlOmZ1bmN0aW9uKGEpe3RoaXMuYXBwZW5kQ2hpbGQoYSl9LGNoaWxkTm9kZXM6W119LHo9W10sQT17fTtjLnJlbmRlcj1mdW5jdGlvbihhLGMpe3ZhciBlPXouaW5kZXhPZihhKSxmPTA+ZT96LnB1c2goYSktMTplLGc9YT09Yi5kb2N1bWVudHx8YT09Yi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ/eTphO0FbZl09ZChnLG51bGwsYyxBW2ZdLCExLDAsbnVsbCx2b2lkIDApfSxjLnRydXN0PWZ1bmN0aW9uKGEpe3JldHVybiBhPW5ldyBTdHJpbmcoYSksYS4kdHJ1c3RlZD0hMCxhfTt2YXIgQj1bXSxDPVtdLEQ9W10sRT0wLEY9MCxHPTAsSD1udWxsO2MubW9kdWxlPWZ1bmN0aW9uKGEsYil7Yy5zdGFydENvbXB1dGF0aW9uKCk7dmFyIGQ9Qi5pbmRleE9mKGEpOzA+ZCYmKGQ9Qi5sZW5ndGgpLEJbZF09YSxDW2RdPWIsRFtkXT1uZXcgYi5jb250cm9sbGVyLGMuZW5kQ29tcHV0YXRpb24oKX0sYy5yZWRyYXc9ZnVuY3Rpb24oKXtpZihFPWIucGVyZm9ybWFuY2UmJmIucGVyZm9ybWFuY2Uubm93P2IucGVyZm9ybWFuY2Uubm93KCk6KG5ldyBiLkRhdGUpLmdldFRpbWUoKSxFLUY+MTYpaigpO2Vsc2V7dmFyIGE9Yi5jYW5jZWxBbmltYXRpb25GcmFtZXx8Yi5jbGVhclRpbWVvdXQsYz1iLnJlcXVlc3RBbmltYXRpb25GcmFtZXx8Yi5zZXRUaW1lb3V0O2EoRyksRz1jKGosMCl9fTt2YXIgST0wO2Muc3RhcnRDb21wdXRhdGlvbj1mdW5jdGlvbigpe0krK30sYy5lbmRDb21wdXRhdGlvbj1mdW5jdGlvbigpe0k9TWF0aC5tYXgoSS0xLDApLDA9PUkmJmMucmVkcmF3KCl9LGMud2l0aEF0dHI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZnVuY3Rpb24oYyl7YihhIGluIGMuY3VycmVudFRhcmdldD9jLmN1cnJlbnRUYXJnZXRbYV06Yy5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZShhKSl9fTt2YXIgSixLPXtwYXRobmFtZToiIixoYXNoOiIjIixzZWFyY2g6Ij8ifSxMPWZ1bmN0aW9uKCl7fSxNPXt9O3JldHVybiBjLnJvdXRlPWZ1bmN0aW9uKCl7aWYoMD09PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIEo7aWYoMz09PWFyZ3VtZW50cy5sZW5ndGgpe0o9Yi5sb2NhdGlvbltjLnJvdXRlLm1vZGVdLnNsaWNlKEtbYy5yb3V0ZS5tb2RlXS5sZW5ndGgpO3ZhciBhPWFyZ3VtZW50c1swXSxkPWFyZ3VtZW50c1sxXSxlPWFyZ3VtZW50c1syXTtMPWZ1bmN0aW9uKGIpe3ZhciBmPWIuc2xpY2UoS1tjLnJvdXRlLm1vZGVdLmxlbmd0aCk7ayhhLGUsZil8fGMucm91dGUoZCwhMCl9O3ZhciBmPSJoYXNoIj09Yy5yb3V0ZS5tb2RlPyJvbmhhc2hjaGFuZ2UiOiJvbnBvcHN0YXRlIjtiW2ZdPWZ1bmN0aW9uKCl7TChiLmxvY2F0aW9uW2Mucm91dGUubW9kZV0pfSxIPW0sYltmXSgpfWVsc2UgaWYoYXJndW1lbnRzWzBdLmFkZEV2ZW50TGlzdGVuZXIpe3ZhciBnPWFyZ3VtZW50c1swXSxoPWFyZ3VtZW50c1sxXTtnLmhyZWYuaW5kZXhPZihLW2Mucm91dGUubW9kZV0pPDAmJihnLmhyZWY9bG9jYXRpb24ucGF0aG5hbWUrS1tjLnJvdXRlLm1vZGVdK2cucGF0aG5hbWUpLGh8fChnLnJlbW92ZUV2ZW50TGlzdGVuZXIoImNsaWNrIixsKSxnLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIixsKSl9ZWxzZSBpZigic3RyaW5nIj09dHlwZW9mIGFyZ3VtZW50c1swXSl7Sj1hcmd1bWVudHNbMF07dmFyIGk9YXJndW1lbnRzWzFdPT09ITA7Yi5oaXN0b3J5LnB1c2hTdGF0ZT8oSD1mdW5jdGlvbigpe2IuaGlzdG9yeVtpPyJyZXBsYWNlU3RhdGUiOiJwdXNoU3RhdGUiXShudWxsLGIuZG9jdW1lbnQudGl0bGUsS1tjLnJvdXRlLm1vZGVdK0opLG0oKX0sTChLW2Mucm91dGUubW9kZV0rSikpOmIubG9jYXRpb25bYy5yb3V0ZS5tb2RlXT1KfX0sYy5yb3V0ZS5wYXJhbT1mdW5jdGlvbihhKXtyZXR1cm4gTVthXX0sYy5yb3V0ZS5tb2RlPSJzZWFyY2giLGMucHJvcD1mdW5jdGlvbihhKXt2YXIgYj1mdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoJiYoYT1hcmd1bWVudHNbMF0pLGF9O3JldHVybiBiLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiBhfSxifSxjLmRlZmVycmVkPWZ1bmN0aW9uKCl7dmFyIGE9W10sYj1bXSxkPXtyZXNvbHZlOmZ1bmN0aW9uKGIpe2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKWFbY10oYil9LHJlamVjdDpmdW5jdGlvbihhKXtmb3IodmFyIGM9MDtjPGIubGVuZ3RoO2MrKyliW2NdKGEpfSxwcm9taXNlOmMucHJvcCgpfTtyZXR1cm4gZC5wcm9taXNlLnJlc29sdmVycz1hLGQucHJvbWlzZS50aGVuPWZ1bmN0aW9uKGQsZSl7ZnVuY3Rpb24gZihhLGIsYyl7YS5wdXNoKGZ1bmN0aW9uKGEpe3RyeXt2YXIgZD1jKGEpO2QmJiJmdW5jdGlvbiI9PXR5cGVvZiBkLnRoZW4/ZC50aGVuKGdbYl0sZSk6Z1tiXSh2b2lkIDAhPT1kP2Q6YSl9Y2F0Y2goZil7aWYoZiBpbnN0YW5jZW9mIEVycm9yJiZmLmNvbnN0cnVjdG9yIT09RXJyb3IpdGhyb3cgZjtnLnJlamVjdChmKX19KX12YXIgZz1jLmRlZmVycmVkKCk7cmV0dXJuIGR8fChkPW4pLGV8fChlPW4pLGYoYSwicmVzb2x2ZSIsZCksZihiLCJyZWplY3QiLGUpLGcucHJvbWlzZX0sZH0sYy5zeW5jPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYil7cmV0dXJuIGZ1bmN0aW9uKGMpe3JldHVybiBmLnB1c2goYyksYnx8KGQ9InJlamVjdCIpLGYubGVuZ3RoPT1hLmxlbmd0aCYmKGUucHJvbWlzZShmKSxlW2RdKGYpKSxjfX1mb3IodmFyIGQ9InJlc29sdmUiLGU9Yy5kZWZlcnJlZCgpLGY9W10sZz0wO2c8YS5sZW5ndGg7ZysrKWFbZ10udGhlbihiKCEwKSxiKCExKSk7cmV0dXJuIGUucHJvbWlzZX0sYy5yZXF1ZXN0PWZ1bmN0aW9uKGEpe2EuYmFja2dyb3VuZCE9PSEwJiZjLnN0YXJ0Q29tcHV0YXRpb24oKTt2YXIgYj1jLmRlZmVycmVkKCksZD1hLnNlcmlhbGl6ZXx8SlNPTi5zdHJpbmdpZnksZT1hLmRlc2VyaWFsaXplfHxKU09OLnBhcnNlLGY9YS5leHRyYWN0fHxmdW5jdGlvbihhKXtyZXR1cm4gMD09PWEucmVzcG9uc2VUZXh0Lmxlbmd0aCYmZT09PUpTT04ucGFyc2U/bnVsbDphLnJlc3BvbnNlVGV4dH07cmV0dXJuIGEudXJsPXIoYS51cmwsYS5kYXRhKSxhPXEoYSxhLmRhdGEsZCksYS5vbmxvYWQ9YS5vbmVycm9yPWZ1bmN0aW9uKGQpe3ZhciBnPSgibG9hZCI9PWQudHlwZT9hLnVud3JhcFN1Y2Nlc3M6YS51bndyYXBFcnJvcil8fG4saD1nKGUoZihkLnRhcmdldCxhKSkpO2lmKGggaW5zdGFuY2VvZiBBcnJheSYmYS50eXBlKWZvcih2YXIgaT0wO2k8aC5sZW5ndGg7aSsrKWhbaV09bmV3IGEudHlwZShoW2ldKTtlbHNlIGEudHlwZSYmKGg9bmV3IGEudHlwZShoKSk7Yi5wcm9taXNlKGgpLGJbImxvYWQiPT1kLnR5cGU/InJlc29sdmUiOiJyZWplY3QiXShoKSxhLmJhY2tncm91bmQhPT0hMCYmYy5lbmRDb21wdXRhdGlvbigpfSxvKGEpLGIucHJvbWlzZS50aGVuPXMoYi5wcm9taXNlKSxiLnByb21pc2V9LGMuZGVwcz1mdW5jdGlvbihhKXtyZXR1cm4gYj1hfSxjLmRlcHMuZmFjdG9yeT1hLGN9KHRoaXMpLCJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlJiZudWxsIT09bW9kdWxlJiYobW9kdWxlLmV4cG9ydHM9bSksImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCYmZGVmaW5lKGZ1bmN0aW9uKCl7cmV0dXJuIG19KTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWl0aHJpbC5taW4ubWFw",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 16:12:17 GMT",
                    "Content-Length": "9258",
                    "Date": "Fri, 07 Nov 2014 16:12:18 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}