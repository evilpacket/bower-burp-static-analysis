{
    "url": "http://localhost:9999/mootools/mootools-core/Source/Request/Request.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>document.location.pathname</b> and written to <b>the 'open()' function of an XMLHttpRequest object</b> via the following statements:<ul><li>url = document.location.pathname;</li><li>url = url.substr(0, trimPosition);</li><li>xhr.open(method.toUpperCase(), url, this.options.async, this.options.user, this.options.password);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/mootools/mootools-core/Source/Request/Request.js",
                "path": "/mootools/mootools-core/Source/Request/Request.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9tb290b29scy9tb290b29scy1jb3JlL1NvdXJjZS9SZXF1ZXN0L1JlcXVlc3QuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNzA2MQ0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAxNjoyOTowOCBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMTY6Mjk6MDggR01UDQoNCi8qCi0tLQoKbmFtZTogUmVxdWVzdAoKZGVzY3JpcHRpb246IFBvd2VyZnVsIGFsbCBwdXJwb3NlIFJlcXVlc3QgQ2xhc3MuIFVzZXMgWE1MSFRUUFJlcXVlc3QuCgpsaWNlbnNlOiBNSVQtc3R5bGUgbGljZW5zZS4KCnJlcXVpcmVzOiBbT2JqZWN0LCBFbGVtZW50LCBDaGFpbiwgRXZlbnRzLCBPcHRpb25zLCBCcm93c2VyXQoKcHJvdmlkZXM6IFJlcXVlc3QKCi4uLgoqLwoKKGZ1bmN0aW9uKCl7Cgp2YXIgZW1wdHkgPSBmdW5jdGlvbigpe30sCglwcm9ncmVzc1N1cHBvcnQgPSAoJ29ucHJvZ3Jlc3MnIGluIG5ldyBCcm93c2VyLlJlcXVlc3QpOwoKdmFyIFJlcXVlc3QgPSB0aGlzLlJlcXVlc3QgPSBuZXcgQ2xhc3MoewoKCUltcGxlbWVudHM6IFtDaGFpbiwgRXZlbnRzLCBPcHRpb25zXSwKCglvcHRpb25zOiB7LyoKCQlvblJlcXVlc3Q6IGZ1bmN0aW9uKCl7fSwKCQlvbkxvYWRzdGFydDogZnVuY3Rpb24oZXZlbnQsIHhocil7fSwKCQlvblByb2dyZXNzOiBmdW5jdGlvbihldmVudCwgeGhyKXt9LAoJCW9uQ29tcGxldGU6IGZ1bmN0aW9uKCl7fSwKCQlvbkNhbmNlbDogZnVuY3Rpb24oKXt9LAoJCW9uU3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2VUZXh0LCByZXNwb25zZVhNTCl7fSwKCQlvbkZhaWx1cmU6IGZ1bmN0aW9uKHhocil7fSwKCQlvbkV4Y2VwdGlvbjogZnVuY3Rpb24oaGVhZGVyTmFtZSwgdmFsdWUpe30sCgkJb25UaW1lb3V0OiBmdW5jdGlvbigpe30sCgkJdXNlcjogJycsCgkJcGFzc3dvcmQ6ICcnLAoJCXdpdGhDcmVkZW50aWFsczogZmFsc2UsKi8KCQl1cmw6ICcnLAoJCWRhdGE6ICcnLAoJCWhlYWRlcnM6IHsKCQkJJ1gtUmVxdWVzdGVkLVdpdGgnOiAnWE1MSHR0cFJlcXVlc3QnLAoJCQknQWNjZXB0JzogJ3RleHQvamF2YXNjcmlwdCwgdGV4dC9odG1sLCBhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sLCAqLyonCgkJfSwKCQlhc3luYzogdHJ1ZSwKCQlmb3JtYXQ6IGZhbHNlLAoJCW1ldGhvZDogJ3Bvc3QnLAoJCWxpbms6ICdpZ25vcmUnLAoJCWlzU3VjY2VzczogbnVsbCwKCQllbXVsYXRpb246IHRydWUsCgkJdXJsRW5jb2RlZDogdHJ1ZSwKCQllbmNvZGluZzogJ3V0Zi04JywKCQlldmFsU2NyaXB0czogZmFsc2UsCgkJZXZhbFJlc3BvbnNlOiBmYWxzZSwKCQl0aW1lb3V0OiAwLAoJCW5vQ2FjaGU6IGZhbHNlCgl9LAoKCWluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpewoJCXRoaXMueGhyID0gbmV3IEJyb3dzZXIuUmVxdWVzdCgpOwoJCXRoaXMuc2V0T3B0aW9ucyhvcHRpb25zKTsKCQl0aGlzLmhlYWRlcnMgPSB0aGlzLm9wdGlvbnMuaGVhZGVyczsKCX0sCgoJb25TdGF0ZUNoYW5nZTogZnVuY3Rpb24oKXsKCQl2YXIgeGhyID0gdGhpcy54aHI7CgkJaWYgKHhoci5yZWFkeVN0YXRlICE9IDQgfHwgIXRoaXMucnVubmluZykgcmV0dXJuOwoJCXRoaXMucnVubmluZyA9IGZhbHNlOwoJCXRoaXMuc3RhdHVzID0gMDsKCQlGdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7CgkJCXZhciBzdGF0dXMgPSB4aHIuc3RhdHVzOwoJCQl0aGlzLnN0YXR1cyA9IChzdGF0dXMgPT0gMTIyMykgPyAyMDQgOiBzdGF0dXM7CgkJfS5iaW5kKHRoaXMpKTsKCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZW1wdHk7CgkJaWYgKHByb2dyZXNzU3VwcG9ydCkgeGhyLm9ucHJvZ3Jlc3MgPSB4aHIub25sb2Fkc3RhcnQgPSBlbXB0eTsKCQlpZiAodGhpcy50aW1lcil7CgkJCWNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTsKCQkJZGVsZXRlIHRoaXMudGltZXI7CgkJfQoKCQl0aGlzLnJlc3BvbnNlID0ge3RleHQ6IHRoaXMueGhyLnJlc3BvbnNlVGV4dCB8fCAnJywgeG1sOiB0aGlzLnhoci5yZXNwb25zZVhNTH07CgkJaWYgKHRoaXMub3B0aW9ucy5pc1N1Y2Nlc3MuY2FsbCh0aGlzLCB0aGlzLnN0YXR1cykpCgkJCXRoaXMuc3VjY2Vzcyh0aGlzLnJlc3BvbnNlLnRleHQsIHRoaXMucmVzcG9uc2UueG1sKTsKCQllbHNlCgkJCXRoaXMuZmFpbHVyZSgpOwoJfSwKCglpc1N1Y2Nlc3M6IGZ1bmN0aW9uKCl7CgkJdmFyIHN0YXR1cyA9IHRoaXMuc3RhdHVzOwoJCXJldHVybiAoc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDApOwoJfSwKCglpc1J1bm5pbmc6IGZ1bmN0aW9uKCl7CgkJcmV0dXJuICEhdGhpcy5ydW5uaW5nOwoJfSwKCglwcm9jZXNzU2NyaXB0czogZnVuY3Rpb24odGV4dCl7CgkJaWYgKHRoaXMub3B0aW9ucy5ldmFsUmVzcG9uc2UgfHwgKC8oZWNtYXxqYXZhKXNjcmlwdC8pLnRlc3QodGhpcy5nZXRIZWFkZXIoJ0NvbnRlbnQtdHlwZScpKSkgcmV0dXJuIEJyb3dzZXIuZXhlYyh0ZXh0KTsKCQlyZXR1cm4gdGV4dC5zdHJpcFNjcmlwdHModGhpcy5vcHRpb25zLmV2YWxTY3JpcHRzKTsKCX0sCgoJc3VjY2VzczogZnVuY3Rpb24odGV4dCwgeG1sKXsKCQl0aGlzLm9uU3VjY2Vzcyh0aGlzLnByb2Nlc3NTY3JpcHRzKHRleHQpLCB4bWwpOwoJfSwKCglvblN1Y2Nlc3M6IGZ1bmN0aW9uKCl7CgkJdGhpcy5maXJlRXZlbnQoJ2NvbXBsZXRlJywgYXJndW1lbnRzKS5maXJlRXZlbnQoJ3N1Y2Nlc3MnLCBhcmd1bWVudHMpLmNhbGxDaGFpbigpOwoJfSwKCglmYWlsdXJlOiBmdW5jdGlvbigpewoJCXRoaXMub25GYWlsdXJlKCk7Cgl9LAoKCW9uRmFpbHVyZTogZnVuY3Rpb24oKXsKCQl0aGlzLmZpcmVFdmVudCgnY29tcGxldGUnKS5maXJlRXZlbnQoJ2ZhaWx1cmUnLCB0aGlzLnhocik7Cgl9LAoKCWxvYWRzdGFydDogZnVuY3Rpb24oZXZlbnQpewoJCXRoaXMuZmlyZUV2ZW50KCdsb2Fkc3RhcnQnLCBbZXZlbnQsIHRoaXMueGhyXSk7Cgl9LAoKCXByb2dyZXNzOiBmdW5jdGlvbihldmVudCl7CgkJdGhpcy5maXJlRXZlbnQoJ3Byb2dyZXNzJywgW2V2ZW50LCB0aGlzLnhocl0pOwoJfSwKCgl0aW1lb3V0OiBmdW5jdGlvbigpewoJCXRoaXMuZmlyZUV2ZW50KCd0aW1lb3V0JywgdGhpcy54aHIpOwoJfSwKCglzZXRIZWFkZXI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKXsKCQl0aGlzLmhlYWRlcnNbbmFtZV0gPSB2YWx1ZTsKCQlyZXR1cm4gdGhpczsKCX0sCgoJZ2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lKXsKCQlyZXR1cm4gRnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpewoJCQlyZXR1cm4gdGhpcy54aHIuZ2V0UmVzcG9uc2VIZWFkZXIobmFtZSk7CgkJfS5iaW5kKHRoaXMpKTsKCX0sCgoJY2hlY2s6IGZ1bmN0aW9uKCl7CgkJaWYgKCF0aGlzLnJ1bm5pbmcpIHJldHVybiB0cnVlOwoJCXN3aXRjaCAodGhpcy5vcHRpb25zLmxpbmspewoJCQljYXNlICdjYW5jZWwnOiB0aGlzLmNhbmNlbCgpOyByZXR1cm4gdHJ1ZTsKCQkJY2FzZSAnY2hhaW4nOiB0aGlzLmNoYWluKHRoaXMuY2FsbGVyLnBhc3MoYXJndW1lbnRzLCB0aGlzKSk7IHJldHVybiBmYWxzZTsKCQl9CgkJcmV0dXJuIGZhbHNlOwoJfSwKCglzZW5kOiBmdW5jdGlvbihvcHRpb25zKXsKCQlpZiAoIXRoaXMuY2hlY2sob3B0aW9ucykpIHJldHVybiB0aGlzOwoKCQl0aGlzLm9wdGlvbnMuaXNTdWNjZXNzID0gdGhpcy5vcHRpb25zLmlzU3VjY2VzcyB8fCB0aGlzLmlzU3VjY2VzczsKCQl0aGlzLnJ1bm5pbmcgPSB0cnVlOwoKCQl2YXIgdHlwZSA9IHR5cGVPZihvcHRpb25zKTsKCQlpZiAodHlwZSA9PSAnc3RyaW5nJyB8fCB0eXBlID09ICdlbGVtZW50Jykgb3B0aW9ucyA9IHtkYXRhOiBvcHRpb25zfTsKCgkJdmFyIG9sZCA9IHRoaXMub3B0aW9uczsKCQlvcHRpb25zID0gT2JqZWN0LmFwcGVuZCh7ZGF0YTogb2xkLmRhdGEsIHVybDogb2xkLnVybCwgbWV0aG9kOiBvbGQubWV0aG9kfSwgb3B0aW9ucyk7CgkJdmFyIGRhdGEgPSBvcHRpb25zLmRhdGEsIHVybCA9IFN0cmluZyhvcHRpb25zLnVybCksIG1ldGhvZCA9IG9wdGlvbnMubWV0aG9kLnRvTG93ZXJDYXNlKCk7CgoJCXN3aXRjaCAodHlwZU9mKGRhdGEpKXsKCQkJY2FzZSAnZWxlbWVudCc6IGRhdGEgPSBkb2N1bWVudC5pZChkYXRhKS50b1F1ZXJ5U3RyaW5nKCk7IGJyZWFrOwoJCQljYXNlICdvYmplY3QnOiBjYXNlICdoYXNoJzogZGF0YSA9IE9iamVjdC50b1F1ZXJ5U3RyaW5nKGRhdGEpOwoJCX0KCgkJaWYgKHRoaXMub3B0aW9ucy5mb3JtYXQpewoJCQl2YXIgZm9ybWF0ID0gJ2Zvcm1hdD0nICsgdGhpcy5vcHRpb25zLmZvcm1hdDsKCQkJZGF0YSA9IChkYXRhKSA/IGZvcm1hdCArICcmJyArIGRhdGEgOiBmb3JtYXQ7CgkJfQoKCQlpZiAodGhpcy5vcHRpb25zLmVtdWxhdGlvbiAmJiAhWydnZXQnLCAncG9zdCddLmNvbnRhaW5zKG1ldGhvZCkpewoJCQl2YXIgX21ldGhvZCA9ICdfbWV0aG9kPScgKyBtZXRob2Q7CgkJCWRhdGEgPSAoZGF0YSkgPyBfbWV0aG9kICsgJyYnICsgZGF0YSA6IF9tZXRob2Q7CgkJCW1ldGhvZCA9ICdwb3N0JzsKCQl9CgoJCWlmICh0aGlzLm9wdGlvbnMudXJsRW5jb2RlZCAmJiBbJ3Bvc3QnLCAncHV0J10uY29udGFpbnMobWV0aG9kKSl7CgkJCXZhciBlbmNvZGluZyA9ICh0aGlzLm9wdGlvbnMuZW5jb2RpbmcpID8gJzsgY2hhcnNldD0nICsgdGhpcy5vcHRpb25zLmVuY29kaW5nIDogJyc7CgkJCXRoaXMuaGVhZGVyc1snQ29udGVudC10eXBlJ10gPSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyArIGVuY29kaW5nOwoJCX0KCgkJaWYgKCF1cmwpIHVybCA9IGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lOwoKCQl2YXIgdHJpbVBvc2l0aW9uID0gdXJsLmxhc3RJbmRleE9mKCcvJyk7CgkJaWYgKHRyaW1Qb3NpdGlvbiA+IC0xICYmICh0cmltUG9zaXRpb24gPSB1cmwuaW5kZXhPZignIycpKSA+IC0xKSB1cmwgPSB1cmwuc3Vic3RyKDAsIHRyaW1Qb3NpdGlvbik7CgoJCWlmICh0aGlzLm9wdGlvbnMubm9DYWNoZSkKCQkJdXJsICs9ICh1cmwuaW5kZXhPZignPycpID4gLTEgPyAnJicgOiAnPycpICsgU3RyaW5nLnVuaXF1ZUlEKCk7CgoJCWlmIChkYXRhICYmIChtZXRob2QgPT0gJ2dldCcgfHwgbWV0aG9kID09ICdkZWxldGUnKSl7CgkJCXVybCArPSAodXJsLmluZGV4T2YoJz8nKSA+IC0xID8gJyYnIDogJz8nKSArIGRhdGE7CgkJCWRhdGEgPSBudWxsOwoJCX0KCgkJdmFyIHhociA9IHRoaXMueGhyOwoJCWlmIChwcm9ncmVzc1N1cHBvcnQpewoJCQl4aHIub25sb2Fkc3RhcnQgPSB0aGlzLmxvYWRzdGFydC5iaW5kKHRoaXMpOwoJCQl4aHIub25wcm9ncmVzcyA9IHRoaXMucHJvZ3Jlc3MuYmluZCh0aGlzKTsKCQl9CgoJCXhoci5vcGVuKG1ldGhvZC50b1VwcGVyQ2FzZSgpLCB1cmwsIHRoaXMub3B0aW9ucy5hc3luYywgdGhpcy5vcHRpb25zLnVzZXIsIHRoaXMub3B0aW9ucy5wYXNzd29yZCk7CgkJaWYgKCgvKjwxLjRjb21wYXQ+Ki90aGlzLm9wdGlvbnMudXNlciB8fCAvKjwvMS40Y29tcGF0PiovdGhpcy5vcHRpb25zLndpdGhDcmVkZW50aWFscykgJiYgJ3dpdGhDcmVkZW50aWFscycgaW4geGhyKSB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTsKCgkJeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHRoaXMub25TdGF0ZUNoYW5nZS5iaW5kKHRoaXMpOwoKCQlPYmplY3QuZWFjaCh0aGlzLmhlYWRlcnMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpewoJCQl0cnkgewoJCQkJeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCB2YWx1ZSk7CgkJCX0gY2F0Y2ggKGUpewoJCQkJdGhpcy5maXJlRXZlbnQoJ2V4Y2VwdGlvbicsIFtrZXksIHZhbHVlXSk7CgkJCX0KCQl9LCB0aGlzKTsKCgkJdGhpcy5maXJlRXZlbnQoJ3JlcXVlc3QnKTsKCQl4aHIuc2VuZChkYXRhKTsKCQlpZiAoIXRoaXMub3B0aW9ucy5hc3luYykgdGhpcy5vblN0YXRlQ2hhbmdlKCk7CgkJZWxzZSBpZiAodGhpcy5vcHRpb25zLnRpbWVvdXQpIHRoaXMudGltZXIgPSB0aGlzLnRpbWVvdXQuZGVsYXkodGhpcy5vcHRpb25zLnRpbWVvdXQsIHRoaXMpOwoJCXJldHVybiB0aGlzOwoJfSwKCgljYW5jZWw6IGZ1bmN0aW9uKCl7CgkJaWYgKCF0aGlzLnJ1bm5pbmcpIHJldHVybiB0aGlzOwoJCXRoaXMucnVubmluZyA9IGZhbHNlOwoJCXZhciB4aHIgPSB0aGlzLnhocjsKCQl4aHIuYWJvcnQoKTsKCQlpZiAodGhpcy50aW1lcil7CgkJCWNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTsKCQkJZGVsZXRlIHRoaXMudGltZXI7CgkJfQoJCXhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBlbXB0eTsKCQlpZiAocHJvZ3Jlc3NTdXBwb3J0KSB4aHIub25wcm9ncmVzcyA9IHhoci5vbmxvYWRzdGFydCA9IGVtcHR5OwoJCXRoaXMueGhyID0gbmV3IEJyb3dzZXIuUmVxdWVzdCgpOwoJCXRoaXMuZmlyZUV2ZW50KCdjYW5jZWwnKTsKCQlyZXR1cm4gdGhpczsKCX0KCn0pOwoKdmFyIG1ldGhvZHMgPSB7fTsKWydnZXQnLCAncG9zdCcsICdwdXQnLCAnZGVsZXRlJywgJ3BhdGNoJywgJ2hlYWQnLCAnR0VUJywgJ1BPU1QnLCAnUFVUJywgJ0RFTEVURScsICdQQVRDSCcsICdIRUFEJ10uZWFjaChmdW5jdGlvbihtZXRob2QpewoJbWV0aG9kc1ttZXRob2RdID0gZnVuY3Rpb24oZGF0YSl7CgkJdmFyIG9iamVjdCA9IHsKCQkJbWV0aG9kOiBtZXRob2QKCQl9OwoJCWlmIChkYXRhICE9IG51bGwpIG9iamVjdC5kYXRhID0gZGF0YTsKCQlyZXR1cm4gdGhpcy5zZW5kKG9iamVjdCk7Cgl9Owp9KTsKClJlcXVlc3QuaW1wbGVtZW50KG1ldGhvZHMpOwoKRWxlbWVudC5Qcm9wZXJ0aWVzLnNlbmQgPSB7CgoJc2V0OiBmdW5jdGlvbihvcHRpb25zKXsKCQl2YXIgc2VuZCA9IHRoaXMuZ2V0KCdzZW5kJykuY2FuY2VsKCk7CgkJc2VuZC5zZXRPcHRpb25zKG9wdGlvbnMpOwoJCXJldHVybiB0aGlzOwoJfSwKCglnZXQ6IGZ1bmN0aW9uKCl7CgkJdmFyIHNlbmQgPSB0aGlzLnJldHJpZXZlKCdzZW5kJyk7CgkJaWYgKCFzZW5kKXsKCQkJc2VuZCA9IG5ldyBSZXF1ZXN0KHsKCQkJCWRhdGE6IHRoaXMsIGxpbms6ICdjYW5jZWwnLCBtZXRob2Q6IHRoaXMuZ2V0KCdtZXRob2QnKSB8fCAncG9zdCcsIHVybDogdGhpcy5nZXQoJ2FjdGlvbicpCgkJCX0pOwoJCQl0aGlzLnN0b3JlKCdzZW5kJywgc2VuZCk7CgkJfQoJCXJldHVybiBzZW5kOwoJfQoKfTsKCkVsZW1lbnQuaW1wbGVtZW50KHsKCglzZW5kOiBmdW5jdGlvbih1cmwpewoJCXZhciBzZW5kZXIgPSB0aGlzLmdldCgnc2VuZCcpOwoJCXNlbmRlci5zZW5kKHtkYXRhOiB0aGlzLCB1cmw6IHVybCB8fCBzZW5kZXIub3B0aW9ucy51cmx9KTsKCQlyZXR1cm4gdGhpczsKCX0KCn0pOwoKfSkoKTsK",
                "body": "LyoKLS0tCgpuYW1lOiBSZXF1ZXN0CgpkZXNjcmlwdGlvbjogUG93ZXJmdWwgYWxsIHB1cnBvc2UgUmVxdWVzdCBDbGFzcy4gVXNlcyBYTUxIVFRQUmVxdWVzdC4KCmxpY2Vuc2U6IE1JVC1zdHlsZSBsaWNlbnNlLgoKcmVxdWlyZXM6IFtPYmplY3QsIEVsZW1lbnQsIENoYWluLCBFdmVudHMsIE9wdGlvbnMsIEJyb3dzZXJdCgpwcm92aWRlczogUmVxdWVzdAoKLi4uCiovCgooZnVuY3Rpb24oKXsKCnZhciBlbXB0eSA9IGZ1bmN0aW9uKCl7fSwKCXByb2dyZXNzU3VwcG9ydCA9ICgnb25wcm9ncmVzcycgaW4gbmV3IEJyb3dzZXIuUmVxdWVzdCk7Cgp2YXIgUmVxdWVzdCA9IHRoaXMuUmVxdWVzdCA9IG5ldyBDbGFzcyh7CgoJSW1wbGVtZW50czogW0NoYWluLCBFdmVudHMsIE9wdGlvbnNdLAoKCW9wdGlvbnM6IHsvKgoJCW9uUmVxdWVzdDogZnVuY3Rpb24oKXt9LAoJCW9uTG9hZHN0YXJ0OiBmdW5jdGlvbihldmVudCwgeGhyKXt9LAoJCW9uUHJvZ3Jlc3M6IGZ1bmN0aW9uKGV2ZW50LCB4aHIpe30sCgkJb25Db21wbGV0ZTogZnVuY3Rpb24oKXt9LAoJCW9uQ2FuY2VsOiBmdW5jdGlvbigpe30sCgkJb25TdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZVRleHQsIHJlc3BvbnNlWE1MKXt9LAoJCW9uRmFpbHVyZTogZnVuY3Rpb24oeGhyKXt9LAoJCW9uRXhjZXB0aW9uOiBmdW5jdGlvbihoZWFkZXJOYW1lLCB2YWx1ZSl7fSwKCQlvblRpbWVvdXQ6IGZ1bmN0aW9uKCl7fSwKCQl1c2VyOiAnJywKCQlwYXNzd29yZDogJycsCgkJd2l0aENyZWRlbnRpYWxzOiBmYWxzZSwqLwoJCXVybDogJycsCgkJZGF0YTogJycsCgkJaGVhZGVyczogewoJCQknWC1SZXF1ZXN0ZWQtV2l0aCc6ICdYTUxIdHRwUmVxdWVzdCcsCgkJCSdBY2NlcHQnOiAndGV4dC9qYXZhc2NyaXB0LCB0ZXh0L2h0bWwsIGFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwsICovKicKCQl9LAoJCWFzeW5jOiB0cnVlLAoJCWZvcm1hdDogZmFsc2UsCgkJbWV0aG9kOiAncG9zdCcsCgkJbGluazogJ2lnbm9yZScsCgkJaXNTdWNjZXNzOiBudWxsLAoJCWVtdWxhdGlvbjogdHJ1ZSwKCQl1cmxFbmNvZGVkOiB0cnVlLAoJCWVuY29kaW5nOiAndXRmLTgnLAoJCWV2YWxTY3JpcHRzOiBmYWxzZSwKCQlldmFsUmVzcG9uc2U6IGZhbHNlLAoJCXRpbWVvdXQ6IDAsCgkJbm9DYWNoZTogZmFsc2UKCX0sCgoJaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucyl7CgkJdGhpcy54aHIgPSBuZXcgQnJvd3Nlci5SZXF1ZXN0KCk7CgkJdGhpcy5zZXRPcHRpb25zKG9wdGlvbnMpOwoJCXRoaXMuaGVhZGVycyA9IHRoaXMub3B0aW9ucy5oZWFkZXJzOwoJfSwKCglvblN0YXRlQ2hhbmdlOiBmdW5jdGlvbigpewoJCXZhciB4aHIgPSB0aGlzLnhocjsKCQlpZiAoeGhyLnJlYWR5U3RhdGUgIT0gNCB8fCAhdGhpcy5ydW5uaW5nKSByZXR1cm47CgkJdGhpcy5ydW5uaW5nID0gZmFsc2U7CgkJdGhpcy5zdGF0dXMgPSAwOwoJCUZ1bmN0aW9uLmF0dGVtcHQoZnVuY3Rpb24oKXsKCQkJdmFyIHN0YXR1cyA9IHhoci5zdGF0dXM7CgkJCXRoaXMuc3RhdHVzID0gKHN0YXR1cyA9PSAxMjIzKSA/IDIwNCA6IHN0YXR1czsKCQl9LmJpbmQodGhpcykpOwoJCXhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBlbXB0eTsKCQlpZiAocHJvZ3Jlc3NTdXBwb3J0KSB4aHIub25wcm9ncmVzcyA9IHhoci5vbmxvYWRzdGFydCA9IGVtcHR5OwoJCWlmICh0aGlzLnRpbWVyKXsKCQkJY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpOwoJCQlkZWxldGUgdGhpcy50aW1lcjsKCQl9CgoJCXRoaXMucmVzcG9uc2UgPSB7dGV4dDogdGhpcy54aHIucmVzcG9uc2VUZXh0IHx8ICcnLCB4bWw6IHRoaXMueGhyLnJlc3BvbnNlWE1MfTsKCQlpZiAodGhpcy5vcHRpb25zLmlzU3VjY2Vzcy5jYWxsKHRoaXMsIHRoaXMuc3RhdHVzKSkKCQkJdGhpcy5zdWNjZXNzKHRoaXMucmVzcG9uc2UudGV4dCwgdGhpcy5yZXNwb25zZS54bWwpOwoJCWVsc2UKCQkJdGhpcy5mYWlsdXJlKCk7Cgl9LAoKCWlzU3VjY2VzczogZnVuY3Rpb24oKXsKCQl2YXIgc3RhdHVzID0gdGhpcy5zdGF0dXM7CgkJcmV0dXJuIChzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCk7Cgl9LAoKCWlzUnVubmluZzogZnVuY3Rpb24oKXsKCQlyZXR1cm4gISF0aGlzLnJ1bm5pbmc7Cgl9LAoKCXByb2Nlc3NTY3JpcHRzOiBmdW5jdGlvbih0ZXh0KXsKCQlpZiAodGhpcy5vcHRpb25zLmV2YWxSZXNwb25zZSB8fCAoLyhlY21hfGphdmEpc2NyaXB0LykudGVzdCh0aGlzLmdldEhlYWRlcignQ29udGVudC10eXBlJykpKSByZXR1cm4gQnJvd3Nlci5leGVjKHRleHQpOwoJCXJldHVybiB0ZXh0LnN0cmlwU2NyaXB0cyh0aGlzLm9wdGlvbnMuZXZhbFNjcmlwdHMpOwoJfSwKCglzdWNjZXNzOiBmdW5jdGlvbih0ZXh0LCB4bWwpewoJCXRoaXMub25TdWNjZXNzKHRoaXMucHJvY2Vzc1NjcmlwdHModGV4dCksIHhtbCk7Cgl9LAoKCW9uU3VjY2VzczogZnVuY3Rpb24oKXsKCQl0aGlzLmZpcmVFdmVudCgnY29tcGxldGUnLCBhcmd1bWVudHMpLmZpcmVFdmVudCgnc3VjY2VzcycsIGFyZ3VtZW50cykuY2FsbENoYWluKCk7Cgl9LAoKCWZhaWx1cmU6IGZ1bmN0aW9uKCl7CgkJdGhpcy5vbkZhaWx1cmUoKTsKCX0sCgoJb25GYWlsdXJlOiBmdW5jdGlvbigpewoJCXRoaXMuZmlyZUV2ZW50KCdjb21wbGV0ZScpLmZpcmVFdmVudCgnZmFpbHVyZScsIHRoaXMueGhyKTsKCX0sCgoJbG9hZHN0YXJ0OiBmdW5jdGlvbihldmVudCl7CgkJdGhpcy5maXJlRXZlbnQoJ2xvYWRzdGFydCcsIFtldmVudCwgdGhpcy54aHJdKTsKCX0sCgoJcHJvZ3Jlc3M6IGZ1bmN0aW9uKGV2ZW50KXsKCQl0aGlzLmZpcmVFdmVudCgncHJvZ3Jlc3MnLCBbZXZlbnQsIHRoaXMueGhyXSk7Cgl9LAoKCXRpbWVvdXQ6IGZ1bmN0aW9uKCl7CgkJdGhpcy5maXJlRXZlbnQoJ3RpbWVvdXQnLCB0aGlzLnhocik7Cgl9LAoKCXNldEhlYWRlcjogZnVuY3Rpb24obmFtZSwgdmFsdWUpewoJCXRoaXMuaGVhZGVyc1tuYW1lXSA9IHZhbHVlOwoJCXJldHVybiB0aGlzOwoJfSwKCglnZXRIZWFkZXI6IGZ1bmN0aW9uKG5hbWUpewoJCXJldHVybiBGdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7CgkJCXJldHVybiB0aGlzLnhoci5nZXRSZXNwb25zZUhlYWRlcihuYW1lKTsKCQl9LmJpbmQodGhpcykpOwoJfSwKCgljaGVjazogZnVuY3Rpb24oKXsKCQlpZiAoIXRoaXMucnVubmluZykgcmV0dXJuIHRydWU7CgkJc3dpdGNoICh0aGlzLm9wdGlvbnMubGluayl7CgkJCWNhc2UgJ2NhbmNlbCc6IHRoaXMuY2FuY2VsKCk7IHJldHVybiB0cnVlOwoJCQljYXNlICdjaGFpbic6IHRoaXMuY2hhaW4odGhpcy5jYWxsZXIucGFzcyhhcmd1bWVudHMsIHRoaXMpKTsgcmV0dXJuIGZhbHNlOwoJCX0KCQlyZXR1cm4gZmFsc2U7Cgl9LAoKCXNlbmQ6IGZ1bmN0aW9uKG9wdGlvbnMpewoJCWlmICghdGhpcy5jaGVjayhvcHRpb25zKSkgcmV0dXJuIHRoaXM7CgoJCXRoaXMub3B0aW9ucy5pc1N1Y2Nlc3MgPSB0aGlzLm9wdGlvbnMuaXNTdWNjZXNzIHx8IHRoaXMuaXNTdWNjZXNzOwoJCXRoaXMucnVubmluZyA9IHRydWU7CgoJCXZhciB0eXBlID0gdHlwZU9mKG9wdGlvbnMpOwoJCWlmICh0eXBlID09ICdzdHJpbmcnIHx8IHR5cGUgPT0gJ2VsZW1lbnQnKSBvcHRpb25zID0ge2RhdGE6IG9wdGlvbnN9OwoKCQl2YXIgb2xkID0gdGhpcy5vcHRpb25zOwoJCW9wdGlvbnMgPSBPYmplY3QuYXBwZW5kKHtkYXRhOiBvbGQuZGF0YSwgdXJsOiBvbGQudXJsLCBtZXRob2Q6IG9sZC5tZXRob2R9LCBvcHRpb25zKTsKCQl2YXIgZGF0YSA9IG9wdGlvbnMuZGF0YSwgdXJsID0gU3RyaW5nKG9wdGlvbnMudXJsKSwgbWV0aG9kID0gb3B0aW9ucy5tZXRob2QudG9Mb3dlckNhc2UoKTsKCgkJc3dpdGNoICh0eXBlT2YoZGF0YSkpewoJCQljYXNlICdlbGVtZW50JzogZGF0YSA9IGRvY3VtZW50LmlkKGRhdGEpLnRvUXVlcnlTdHJpbmcoKTsgYnJlYWs7CgkJCWNhc2UgJ29iamVjdCc6IGNhc2UgJ2hhc2gnOiBkYXRhID0gT2JqZWN0LnRvUXVlcnlTdHJpbmcoZGF0YSk7CgkJfQoKCQlpZiAodGhpcy5vcHRpb25zLmZvcm1hdCl7CgkJCXZhciBmb3JtYXQgPSAnZm9ybWF0PScgKyB0aGlzLm9wdGlvbnMuZm9ybWF0OwoJCQlkYXRhID0gKGRhdGEpID8gZm9ybWF0ICsgJyYnICsgZGF0YSA6IGZvcm1hdDsKCQl9CgoJCWlmICh0aGlzLm9wdGlvbnMuZW11bGF0aW9uICYmICFbJ2dldCcsICdwb3N0J10uY29udGFpbnMobWV0aG9kKSl7CgkJCXZhciBfbWV0aG9kID0gJ19tZXRob2Q9JyArIG1ldGhvZDsKCQkJZGF0YSA9IChkYXRhKSA/IF9tZXRob2QgKyAnJicgKyBkYXRhIDogX21ldGhvZDsKCQkJbWV0aG9kID0gJ3Bvc3QnOwoJCX0KCgkJaWYgKHRoaXMub3B0aW9ucy51cmxFbmNvZGVkICYmIFsncG9zdCcsICdwdXQnXS5jb250YWlucyhtZXRob2QpKXsKCQkJdmFyIGVuY29kaW5nID0gKHRoaXMub3B0aW9ucy5lbmNvZGluZykgPyAnOyBjaGFyc2V0PScgKyB0aGlzLm9wdGlvbnMuZW5jb2RpbmcgOiAnJzsKCQkJdGhpcy5oZWFkZXJzWydDb250ZW50LXR5cGUnXSA9ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnICsgZW5jb2Rpbmc7CgkJfQoKCQlpZiAoIXVybCkgdXJsID0gZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWU7CgoJCXZhciB0cmltUG9zaXRpb24gPSB1cmwubGFzdEluZGV4T2YoJy8nKTsKCQlpZiAodHJpbVBvc2l0aW9uID4gLTEgJiYgKHRyaW1Qb3NpdGlvbiA9IHVybC5pbmRleE9mKCcjJykpID4gLTEpIHVybCA9IHVybC5zdWJzdHIoMCwgdHJpbVBvc2l0aW9uKTsKCgkJaWYgKHRoaXMub3B0aW9ucy5ub0NhY2hlKQoJCQl1cmwgKz0gKHVybC5pbmRleE9mKCc/JykgPiAtMSA/ICcmJyA6ICc/JykgKyBTdHJpbmcudW5pcXVlSUQoKTsKCgkJaWYgKGRhdGEgJiYgKG1ldGhvZCA9PSAnZ2V0JyB8fCBtZXRob2QgPT0gJ2RlbGV0ZScpKXsKCQkJdXJsICs9ICh1cmwuaW5kZXhPZignPycpID4gLTEgPyAnJicgOiAnPycpICsgZGF0YTsKCQkJZGF0YSA9IG51bGw7CgkJfQoKCQl2YXIgeGhyID0gdGhpcy54aHI7CgkJaWYgKHByb2dyZXNzU3VwcG9ydCl7CgkJCXhoci5vbmxvYWRzdGFydCA9IHRoaXMubG9hZHN0YXJ0LmJpbmQodGhpcyk7CgkJCXhoci5vbnByb2dyZXNzID0gdGhpcy5wcm9ncmVzcy5iaW5kKHRoaXMpOwoJCX0KCgkJeGhyLm9wZW4obWV0aG9kLnRvVXBwZXJDYXNlKCksIHVybCwgdGhpcy5vcHRpb25zLmFzeW5jLCB0aGlzLm9wdGlvbnMudXNlciwgdGhpcy5vcHRpb25zLnBhc3N3b3JkKTsKCQlpZiAoKC8qPDEuNGNvbXBhdD4qL3RoaXMub3B0aW9ucy51c2VyIHx8IC8qPC8xLjRjb21wYXQ+Ki90aGlzLm9wdGlvbnMud2l0aENyZWRlbnRpYWxzKSAmJiAnd2l0aENyZWRlbnRpYWxzJyBpbiB4aHIpIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlOwoKCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gdGhpcy5vblN0YXRlQ2hhbmdlLmJpbmQodGhpcyk7CgoJCU9iamVjdC5lYWNoKHRoaXMuaGVhZGVycywgZnVuY3Rpb24odmFsdWUsIGtleSl7CgkJCXRyeSB7CgkJCQl4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbHVlKTsKCQkJfSBjYXRjaCAoZSl7CgkJCQl0aGlzLmZpcmVFdmVudCgnZXhjZXB0aW9uJywgW2tleSwgdmFsdWVdKTsKCQkJfQoJCX0sIHRoaXMpOwoKCQl0aGlzLmZpcmVFdmVudCgncmVxdWVzdCcpOwoJCXhoci5zZW5kKGRhdGEpOwoJCWlmICghdGhpcy5vcHRpb25zLmFzeW5jKSB0aGlzLm9uU3RhdGVDaGFuZ2UoKTsKCQllbHNlIGlmICh0aGlzLm9wdGlvbnMudGltZW91dCkgdGhpcy50aW1lciA9IHRoaXMudGltZW91dC5kZWxheSh0aGlzLm9wdGlvbnMudGltZW91dCwgdGhpcyk7CgkJcmV0dXJuIHRoaXM7Cgl9LAoKCWNhbmNlbDogZnVuY3Rpb24oKXsKCQlpZiAoIXRoaXMucnVubmluZykgcmV0dXJuIHRoaXM7CgkJdGhpcy5ydW5uaW5nID0gZmFsc2U7CgkJdmFyIHhociA9IHRoaXMueGhyOwoJCXhoci5hYm9ydCgpOwoJCWlmICh0aGlzLnRpbWVyKXsKCQkJY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpOwoJCQlkZWxldGUgdGhpcy50aW1lcjsKCQl9CgkJeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGVtcHR5OwoJCWlmIChwcm9ncmVzc1N1cHBvcnQpIHhoci5vbnByb2dyZXNzID0geGhyLm9ubG9hZHN0YXJ0ID0gZW1wdHk7CgkJdGhpcy54aHIgPSBuZXcgQnJvd3Nlci5SZXF1ZXN0KCk7CgkJdGhpcy5maXJlRXZlbnQoJ2NhbmNlbCcpOwoJCXJldHVybiB0aGlzOwoJfQoKfSk7Cgp2YXIgbWV0aG9kcyA9IHt9OwpbJ2dldCcsICdwb3N0JywgJ3B1dCcsICdkZWxldGUnLCAncGF0Y2gnLCAnaGVhZCcsICdHRVQnLCAnUE9TVCcsICdQVVQnLCAnREVMRVRFJywgJ1BBVENIJywgJ0hFQUQnXS5lYWNoKGZ1bmN0aW9uKG1ldGhvZCl7CgltZXRob2RzW21ldGhvZF0gPSBmdW5jdGlvbihkYXRhKXsKCQl2YXIgb2JqZWN0ID0gewoJCQltZXRob2Q6IG1ldGhvZAoJCX07CgkJaWYgKGRhdGEgIT0gbnVsbCkgb2JqZWN0LmRhdGEgPSBkYXRhOwoJCXJldHVybiB0aGlzLnNlbmQob2JqZWN0KTsKCX07Cn0pOwoKUmVxdWVzdC5pbXBsZW1lbnQobWV0aG9kcyk7CgpFbGVtZW50LlByb3BlcnRpZXMuc2VuZCA9IHsKCglzZXQ6IGZ1bmN0aW9uKG9wdGlvbnMpewoJCXZhciBzZW5kID0gdGhpcy5nZXQoJ3NlbmQnKS5jYW5jZWwoKTsKCQlzZW5kLnNldE9wdGlvbnMob3B0aW9ucyk7CgkJcmV0dXJuIHRoaXM7Cgl9LAoKCWdldDogZnVuY3Rpb24oKXsKCQl2YXIgc2VuZCA9IHRoaXMucmV0cmlldmUoJ3NlbmQnKTsKCQlpZiAoIXNlbmQpewoJCQlzZW5kID0gbmV3IFJlcXVlc3QoewoJCQkJZGF0YTogdGhpcywgbGluazogJ2NhbmNlbCcsIG1ldGhvZDogdGhpcy5nZXQoJ21ldGhvZCcpIHx8ICdwb3N0JywgdXJsOiB0aGlzLmdldCgnYWN0aW9uJykKCQkJfSk7CgkJCXRoaXMuc3RvcmUoJ3NlbmQnLCBzZW5kKTsKCQl9CgkJcmV0dXJuIHNlbmQ7Cgl9Cgp9OwoKRWxlbWVudC5pbXBsZW1lbnQoewoKCXNlbmQ6IGZ1bmN0aW9uKHVybCl7CgkJdmFyIHNlbmRlciA9IHRoaXMuZ2V0KCdzZW5kJyk7CgkJc2VuZGVyLnNlbmQoe2RhdGE6IHRoaXMsIHVybDogdXJsIHx8IHNlbmRlci5vcHRpb25zLnVybH0pOwoJCXJldHVybiB0aGlzOwoJfQoKfSk7Cgp9KSgpOwo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 16:29:08 GMT",
                    "Content-Length": "7061",
                    "Date": "Fri, 07 Nov 2014 16:29:08 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}