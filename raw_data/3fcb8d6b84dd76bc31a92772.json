{
    "url": "http://localhost:9999/oieduardorabelo/sawpf/src/js/mootools/1.4.5/mootools-core-full-nocompat-yc.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>document.location.pathname</b> and written to <b>the 'open()' function of an XMLHttpRequest object</b> via the following statements:<ul><li>f=document.location.pathname;</li><li>f=f.substr(0,i);</li><li>n.open(e.toUpperCase(),f,this.options.async,this.options.user,this.options.password);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/oieduardorabelo/sawpf/src/js/mootools/1.4.5/mootools-core-full-nocompat-yc.js",
                "path": "/oieduardorabelo/sawpf/src/js/mootools/1.4.5/mootools-core-full-nocompat-yc.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9vaWVkdWFyZG9yYWJlbG8vc2F3cGYvc3JjL2pzL21vb3Rvb2xzLzEuNC41L21vb3Rvb2xzLWNvcmUtZnVsbC1ub2NvbXBhdC15Yy5qcyBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogOTAxMDkNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkRhdGU6IFNhdCwgMDggTm92IDIwMTQgMDM6NTU6MjQgR01UDQpMYXN0LU1vZGlmaWVkOiBTYXQsIDA4IE5vdiAyMDE0IDAzOjU0OjU3IEdNVA0KDQovKgotLS0KTW9vVG9vbHM6IHRoZSBqYXZhc2NyaXB0IGZyYW1ld29yawoKd2ViIGJ1aWxkOgogLSBodHRwOi8vbW9vdG9vbHMubmV0L2NvcmUvNzZiZjQ3MDYyZDZjMTk4M2Q2NmNlNDdhZDY2YWEwZTAKCnBhY2thZ2VyIGJ1aWxkOgogLSBwYWNrYWdlciBidWlsZCBDb3JlL0NvcmUgQ29yZS9BcnJheSBDb3JlL1N0cmluZyBDb3JlL051bWJlciBDb3JlL0Z1bmN0aW9uIENvcmUvT2JqZWN0IENvcmUvRXZlbnQgQ29yZS9Ccm93c2VyIENvcmUvQ2xhc3MgQ29yZS9DbGFzcy5FeHRyYXMgQ29yZS9TbGljay5QYXJzZXIgQ29yZS9TbGljay5GaW5kZXIgQ29yZS9FbGVtZW50IENvcmUvRWxlbWVudC5TdHlsZSBDb3JlL0VsZW1lbnQuRXZlbnQgQ29yZS9FbGVtZW50LkRlbGVnYXRpb24gQ29yZS9FbGVtZW50LkRpbWVuc2lvbnMgQ29yZS9GeCBDb3JlL0Z4LkNTUyBDb3JlL0Z4LlR3ZWVuIENvcmUvRnguTW9ycGggQ29yZS9GeC5UcmFuc2l0aW9ucyBDb3JlL1JlcXVlc3QgQ29yZS9SZXF1ZXN0LkhUTUwgQ29yZS9SZXF1ZXN0LkpTT04gQ29yZS9Db29raWUgQ29yZS9KU09OIENvcmUvRE9NUmVhZHkgQ29yZS9Td2lmZgoKY29weXJpZ2h0czoKICAtIFtNb29Ub29sc10oaHR0cDovL21vb3Rvb2xzLm5ldCkKCmxpY2Vuc2VzOgogIC0gW01JVCBMaWNlbnNlXShodHRwOi8vbW9vdG9vbHMubmV0L2xpY2Vuc2UudHh0KQouLi4KKi8KCihmdW5jdGlvbigpe3RoaXMuTW9vVG9vbHM9e3ZlcnNpb246IjEuNC41IixidWlsZDoiYWI4ZWE4ODI0ZGMzYjI0YjY2NjY4NjdhMmM0ZWQ1OGViYjc2MmNmMCJ9O3ZhciBvPXRoaXMudHlwZU9mPWZ1bmN0aW9uKGkpe2lmKGk9PW51bGwpe3JldHVybiJudWxsIjt9aWYoaS4kZmFtaWx5IT1udWxsKXtyZXR1cm4gaS4kZmFtaWx5KCk7Cn1pZihpLm5vZGVOYW1lKXtpZihpLm5vZGVUeXBlPT0xKXtyZXR1cm4iZWxlbWVudCI7fWlmKGkubm9kZVR5cGU9PTMpe3JldHVybigvXFMvKS50ZXN0KGkubm9kZVZhbHVlKT8idGV4dG5vZGUiOiJ3aGl0ZXNwYWNlIjt9fWVsc2V7aWYodHlwZW9mIGkubGVuZ3RoPT0ibnVtYmVyIil7aWYoaS5jYWxsZWUpe3JldHVybiJhcmd1bWVudHMiOwp9aWYoIml0ZW0iIGluIGkpe3JldHVybiJjb2xsZWN0aW9uIjt9fX1yZXR1cm4gdHlwZW9mIGk7fTt2YXIgaj10aGlzLmluc3RhbmNlT2Y9ZnVuY3Rpb24odCxpKXtpZih0PT1udWxsKXtyZXR1cm4gZmFsc2U7fXZhciBzPXQuJGNvbnN0cnVjdG9yfHx0LmNvbnN0cnVjdG9yOwp3aGlsZShzKXtpZihzPT09aSl7cmV0dXJuIHRydWU7fXM9cy5wYXJlbnQ7fWlmKCF0Lmhhc093blByb3BlcnR5KXtyZXR1cm4gZmFsc2U7fXJldHVybiB0IGluc3RhbmNlb2YgaTt9O3ZhciBmPXRoaXMuRnVuY3Rpb247dmFyIHA9dHJ1ZTtmb3IodmFyIGsgaW4ge3RvU3RyaW5nOjF9KXtwPW51bGw7Cn1pZihwKXtwPVsiaGFzT3duUHJvcGVydHkiLCJ2YWx1ZU9mIiwiaXNQcm90b3R5cGVPZiIsInByb3BlcnR5SXNFbnVtZXJhYmxlIiwidG9Mb2NhbGVTdHJpbmciLCJ0b1N0cmluZyIsImNvbnN0cnVjdG9yIl07fWYucHJvdG90eXBlLm92ZXJsb2FkU2V0dGVyPWZ1bmN0aW9uKHMpe3ZhciBpPXRoaXM7CnJldHVybiBmdW5jdGlvbih1LHQpe2lmKHU9PW51bGwpe3JldHVybiB0aGlzO31pZihzfHx0eXBlb2YgdSE9InN0cmluZyIpe2Zvcih2YXIgdiBpbiB1KXtpLmNhbGwodGhpcyx2LHVbdl0pO31pZihwKXtmb3IodmFyIHc9cC5sZW5ndGg7dy0tOyl7dj1wW3ddO2lmKHUuaGFzT3duUHJvcGVydHkodikpe2kuY2FsbCh0aGlzLHYsdVt2XSk7Cn19fX1lbHNle2kuY2FsbCh0aGlzLHUsdCk7fXJldHVybiB0aGlzO307fTtmLnByb3RvdHlwZS5vdmVybG9hZEdldHRlcj1mdW5jdGlvbihzKXt2YXIgaT10aGlzO3JldHVybiBmdW5jdGlvbih1KXt2YXIgdix0O2lmKHR5cGVvZiB1IT0ic3RyaW5nIil7dj11O31lbHNle2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7dj1hcmd1bWVudHM7Cn1lbHNle2lmKHMpe3Y9W3VdO319fWlmKHYpe3Q9e307Zm9yKHZhciB3PTA7dzx2Lmxlbmd0aDt3Kyspe3Rbdlt3XV09aS5jYWxsKHRoaXMsdlt3XSk7fX1lbHNle3Q9aS5jYWxsKHRoaXMsdSk7fXJldHVybiB0O307fTtmLnByb3RvdHlwZS5leHRlbmQ9ZnVuY3Rpb24oaSxzKXt0aGlzW2ldPXM7Cn0ub3ZlcmxvYWRTZXR0ZXIoKTtmLnByb3RvdHlwZS5pbXBsZW1lbnQ9ZnVuY3Rpb24oaSxzKXt0aGlzLnByb3RvdHlwZVtpXT1zO30ub3ZlcmxvYWRTZXR0ZXIoKTt2YXIgbj1BcnJheS5wcm90b3R5cGUuc2xpY2U7Zi5mcm9tPWZ1bmN0aW9uKGkpe3JldHVybihvKGkpPT0iZnVuY3Rpb24iKT9pOmZ1bmN0aW9uKCl7cmV0dXJuIGk7Cn07fTtBcnJheS5mcm9tPWZ1bmN0aW9uKGkpe2lmKGk9PW51bGwpe3JldHVybltdO31yZXR1cm4oYS5pc0VudW1lcmFibGUoaSkmJnR5cGVvZiBpIT0ic3RyaW5nIik/KG8oaSk9PSJhcnJheSIpP2k6bi5jYWxsKGkpOltpXTt9O051bWJlci5mcm9tPWZ1bmN0aW9uKHMpe3ZhciBpPXBhcnNlRmxvYXQocyk7CnJldHVybiBpc0Zpbml0ZShpKT9pOm51bGw7fTtTdHJpbmcuZnJvbT1mdW5jdGlvbihpKXtyZXR1cm4gaSsiIjt9O2YuaW1wbGVtZW50KHtoaWRlOmZ1bmN0aW9uKCl7dGhpcy4kaGlkZGVuPXRydWU7cmV0dXJuIHRoaXM7fSxwcm90ZWN0OmZ1bmN0aW9uKCl7dGhpcy4kcHJvdGVjdGVkPXRydWU7CnJldHVybiB0aGlzO319KTt2YXIgYT10aGlzLlR5cGU9ZnVuY3Rpb24odSx0KXtpZih1KXt2YXIgcz11LnRvTG93ZXJDYXNlKCk7dmFyIGk9ZnVuY3Rpb24odil7cmV0dXJuKG8odik9PXMpO307YVsiaXMiK3VdPWk7aWYodCE9bnVsbCl7dC5wcm90b3R5cGUuJGZhbWlseT0oZnVuY3Rpb24oKXtyZXR1cm4gczsKfSkuaGlkZSgpO319aWYodD09bnVsbCl7cmV0dXJuIG51bGw7fXQuZXh0ZW5kKHRoaXMpO3QuJGNvbnN0cnVjdG9yPWE7dC5wcm90b3R5cGUuJGNvbnN0cnVjdG9yPXQ7cmV0dXJuIHQ7fTt2YXIgZT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO2EuaXNFbnVtZXJhYmxlPWZ1bmN0aW9uKGkpe3JldHVybihpIT1udWxsJiZ0eXBlb2YgaS5sZW5ndGg9PSJudW1iZXIiJiZlLmNhbGwoaSkhPSJbb2JqZWN0IEZ1bmN0aW9uXSIpOwp9O3ZhciBxPXt9O3ZhciByPWZ1bmN0aW9uKGkpe3ZhciBzPW8oaS5wcm90b3R5cGUpO3JldHVybiBxW3NdfHwocVtzXT1bXSk7fTt2YXIgYj1mdW5jdGlvbih0LHgpe2lmKHgmJnguJGhpZGRlbil7cmV0dXJuO312YXIgcz1yKHRoaXMpO2Zvcih2YXIgdT0wO3U8cy5sZW5ndGg7CnUrKyl7dmFyIHc9c1t1XTtpZihvKHcpPT0idHlwZSIpe2IuY2FsbCh3LHQseCk7fWVsc2V7dy5jYWxsKHRoaXMsdCx4KTt9fXZhciB2PXRoaXMucHJvdG90eXBlW3RdO2lmKHY9PW51bGx8fCF2LiRwcm90ZWN0ZWQpe3RoaXMucHJvdG90eXBlW3RdPXg7fWlmKHRoaXNbdF09PW51bGwmJm8oeCk9PSJmdW5jdGlvbiIpe20uY2FsbCh0aGlzLHQsZnVuY3Rpb24oaSl7cmV0dXJuIHguYXBwbHkoaSxuLmNhbGwoYXJndW1lbnRzLDEpKTsKfSk7fX07dmFyIG09ZnVuY3Rpb24oaSx0KXtpZih0JiZ0LiRoaWRkZW4pe3JldHVybjt9dmFyIHM9dGhpc1tpXTtpZihzPT1udWxsfHwhcy4kcHJvdGVjdGVkKXt0aGlzW2ldPXQ7fX07YS5pbXBsZW1lbnQoe2ltcGxlbWVudDpiLm92ZXJsb2FkU2V0dGVyKCksZXh0ZW5kOm0ub3ZlcmxvYWRTZXR0ZXIoKSxhbGlhczpmdW5jdGlvbihpLHMpe2IuY2FsbCh0aGlzLGksdGhpcy5wcm90b3R5cGVbc10pOwp9Lm92ZXJsb2FkU2V0dGVyKCksbWlycm9yOmZ1bmN0aW9uKGkpe3IodGhpcykucHVzaChpKTtyZXR1cm4gdGhpczt9fSk7bmV3IGEoIlR5cGUiLGEpO3ZhciBkPWZ1bmN0aW9uKHMseCx2KXt2YXIgdT0oeCE9T2JqZWN0KSxCPXgucHJvdG90eXBlO2lmKHUpe3g9bmV3IGEocyx4KTsKfWZvcih2YXIgeT0wLHc9di5sZW5ndGg7eTx3O3krKyl7dmFyIEM9dlt5XSxBPXhbQ10sej1CW0NdO2lmKEEpe0EucHJvdGVjdCgpO31pZih1JiZ6KXt4LmltcGxlbWVudChDLHoucHJvdGVjdCgpKTt9fWlmKHUpe3ZhciB0PUIucHJvcGVydHlJc0VudW1lcmFibGUodlswXSk7CnguZm9yRWFjaE1ldGhvZD1mdW5jdGlvbihHKXtpZighdCl7Zm9yKHZhciBGPTAsRD12Lmxlbmd0aDtGPEQ7RisrKXtHLmNhbGwoQixCW3ZbRl1dLHZbRl0pO319Zm9yKHZhciBFIGluIEIpe0cuY2FsbChCLEJbRV0sRSk7fX07fXJldHVybiBkO307ZCgiU3RyaW5nIixTdHJpbmcsWyJjaGFyQXQiLCJjaGFyQ29kZUF0IiwiY29uY2F0IiwiaW5kZXhPZiIsImxhc3RJbmRleE9mIiwibWF0Y2giLCJxdW90ZSIsInJlcGxhY2UiLCJzZWFyY2giLCJzbGljZSIsInNwbGl0Iiwic3Vic3RyIiwic3Vic3RyaW5nIiwidHJpbSIsInRvTG93ZXJDYXNlIiwidG9VcHBlckNhc2UiXSkoIkFycmF5IixBcnJheSxbInBvcCIsInB1c2giLCJyZXZlcnNlIiwic2hpZnQiLCJzb3J0Iiwic3BsaWNlIiwidW5zaGlmdCIsImNvbmNhdCIsImpvaW4iLCJzbGljZSIsImluZGV4T2YiLCJsYXN0SW5kZXhPZiIsImZpbHRlciIsImZvckVhY2giLCJldmVyeSIsIm1hcCIsInNvbWUiLCJyZWR1Y2UiLCJyZWR1Y2VSaWdodCJdKSgiTnVtYmVyIixOdW1iZXIsWyJ0b0V4cG9uZW50aWFsIiwidG9GaXhlZCIsInRvTG9jYWxlU3RyaW5nIiwidG9QcmVjaXNpb24iXSkoIkZ1bmN0aW9uIixmLFsiYXBwbHkiLCJjYWxsIiwiYmluZCJdKSgiUmVnRXhwIixSZWdFeHAsWyJleGVjIiwidGVzdCJdKSgiT2JqZWN0IixPYmplY3QsWyJjcmVhdGUiLCJkZWZpbmVQcm9wZXJ0eSIsImRlZmluZVByb3BlcnRpZXMiLCJrZXlzIiwiZ2V0UHJvdG90eXBlT2YiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwicHJldmVudEV4dGVuc2lvbnMiLCJpc0V4dGVuc2libGUiLCJzZWFsIiwiaXNTZWFsZWQiLCJmcmVlemUiLCJpc0Zyb3plbiJdKSgiRGF0ZSIsRGF0ZSxbIm5vdyJdKTsKT2JqZWN0LmV4dGVuZD1tLm92ZXJsb2FkU2V0dGVyKCk7RGF0ZS5leHRlbmQoIm5vdyIsZnVuY3Rpb24oKXtyZXR1cm4gKyhuZXcgRGF0ZSk7fSk7bmV3IGEoIkJvb2xlYW4iLEJvb2xlYW4pO051bWJlci5wcm90b3R5cGUuJGZhbWlseT1mdW5jdGlvbigpe3JldHVybiBpc0Zpbml0ZSh0aGlzKT8ibnVtYmVyIjoibnVsbCI7Cn0uaGlkZSgpO051bWJlci5leHRlbmQoInJhbmRvbSIsZnVuY3Rpb24ocyxpKXtyZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihpLXMrMSkrcyk7fSk7dmFyIGc9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtPYmplY3QuZXh0ZW5kKCJmb3JFYWNoIixmdW5jdGlvbihpLHQsdSl7Zm9yKHZhciBzIGluIGkpe2lmKGcuY2FsbChpLHMpKXt0LmNhbGwodSxpW3NdLHMsaSk7Cn19fSk7T2JqZWN0LmVhY2g9T2JqZWN0LmZvckVhY2g7QXJyYXkuaW1wbGVtZW50KHtmb3JFYWNoOmZ1bmN0aW9uKHUsdil7Zm9yKHZhciB0PTAscz10aGlzLmxlbmd0aDt0PHM7dCsrKXtpZih0IGluIHRoaXMpe3UuY2FsbCh2LHRoaXNbdF0sdCx0aGlzKTt9fX0sZWFjaDpmdW5jdGlvbihpLHMpe0FycmF5LmZvckVhY2godGhpcyxpLHMpOwpyZXR1cm4gdGhpczt9fSk7dmFyIGw9ZnVuY3Rpb24oaSl7c3dpdGNoKG8oaSkpe2Nhc2UiYXJyYXkiOnJldHVybiBpLmNsb25lKCk7Y2FzZSJvYmplY3QiOnJldHVybiBPYmplY3QuY2xvbmUoaSk7ZGVmYXVsdDpyZXR1cm4gaTt9fTtBcnJheS5pbXBsZW1lbnQoImNsb25lIixmdW5jdGlvbigpe3ZhciBzPXRoaXMubGVuZ3RoLHQ9bmV3IEFycmF5KHMpOwp3aGlsZShzLS0pe3Rbc109bCh0aGlzW3NdKTt9cmV0dXJuIHQ7fSk7dmFyIGg9ZnVuY3Rpb24ocyxpLHQpe3N3aXRjaChvKHQpKXtjYXNlIm9iamVjdCI6aWYobyhzW2ldKT09Im9iamVjdCIpe09iamVjdC5tZXJnZShzW2ldLHQpO31lbHNle3NbaV09T2JqZWN0LmNsb25lKHQpOwp9YnJlYWs7Y2FzZSJhcnJheSI6c1tpXT10LmNsb25lKCk7YnJlYWs7ZGVmYXVsdDpzW2ldPXQ7fXJldHVybiBzO307T2JqZWN0LmV4dGVuZCh7bWVyZ2U6ZnVuY3Rpb24oeix1LHQpe2lmKG8odSk9PSJzdHJpbmciKXtyZXR1cm4gaCh6LHUsdCk7fWZvcih2YXIgeT0xLHM9YXJndW1lbnRzLmxlbmd0aDsKeTxzO3krKyl7dmFyIHc9YXJndW1lbnRzW3ldO2Zvcih2YXIgeCBpbiB3KXtoKHoseCx3W3hdKTt9fXJldHVybiB6O30sY2xvbmU6ZnVuY3Rpb24oaSl7dmFyIHQ9e307Zm9yKHZhciBzIGluIGkpe3Rbc109bChpW3NdKTt9cmV0dXJuIHQ7fSxhcHBlbmQ6ZnVuY3Rpb24odyl7Zm9yKHZhciB2PTEsdD1hcmd1bWVudHMubGVuZ3RoOwp2PHQ7disrKXt2YXIgcz1hcmd1bWVudHNbdl18fHt9O2Zvcih2YXIgdSBpbiBzKXt3W3VdPXNbdV07fX1yZXR1cm4gdzt9fSk7WyJPYmplY3QiLCJXaGl0ZVNwYWNlIiwiVGV4dE5vZGUiLCJDb2xsZWN0aW9uIiwiQXJndW1lbnRzIl0uZWFjaChmdW5jdGlvbihpKXtuZXcgYShpKTsKfSk7dmFyIGM9RGF0ZS5ub3coKTtTdHJpbmcuZXh0ZW5kKCJ1bmlxdWVJRCIsZnVuY3Rpb24oKXtyZXR1cm4oYysrKS50b1N0cmluZygzNik7fSk7fSkoKTtBcnJheS5pbXBsZW1lbnQoe2V2ZXJ5OmZ1bmN0aW9uKGMsZCl7Zm9yKHZhciBiPTAsYT10aGlzLmxlbmd0aD4+PjA7CmI8YTtiKyspe2lmKChiIGluIHRoaXMpJiYhYy5jYWxsKGQsdGhpc1tiXSxiLHRoaXMpKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTt9LGZpbHRlcjpmdW5jdGlvbihkLGYpe3ZhciBjPVtdO2Zvcih2YXIgZSxiPTAsYT10aGlzLmxlbmd0aD4+PjA7YjxhO2IrKyl7aWYoYiBpbiB0aGlzKXtlPXRoaXNbYl07CmlmKGQuY2FsbChmLGUsYix0aGlzKSl7Yy5wdXNoKGUpO319fXJldHVybiBjO30saW5kZXhPZjpmdW5jdGlvbihjLGQpe3ZhciBiPXRoaXMubGVuZ3RoPj4+MDtmb3IodmFyIGE9KGQ8MCk/TWF0aC5tYXgoMCxiK2QpOmR8fDA7YTxiO2ErKyl7aWYodGhpc1thXT09PWMpe3JldHVybiBhOwp9fXJldHVybiAtMTt9LG1hcDpmdW5jdGlvbihjLGUpe3ZhciBkPXRoaXMubGVuZ3RoPj4+MCxiPUFycmF5KGQpO2Zvcih2YXIgYT0wO2E8ZDthKyspe2lmKGEgaW4gdGhpcyl7YlthXT1jLmNhbGwoZSx0aGlzW2FdLGEsdGhpcyk7fX1yZXR1cm4gYjt9LHNvbWU6ZnVuY3Rpb24oYyxkKXtmb3IodmFyIGI9MCxhPXRoaXMubGVuZ3RoPj4+MDsKYjxhO2IrKyl7aWYoKGIgaW4gdGhpcykmJmMuY2FsbChkLHRoaXNbYl0sYix0aGlzKSl7cmV0dXJuIHRydWU7fX1yZXR1cm4gZmFsc2U7fSxjbGVhbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbihhKXtyZXR1cm4gYSE9bnVsbDt9KTt9LGludm9rZTpmdW5jdGlvbihhKXt2YXIgYj1BcnJheS5zbGljZShhcmd1bWVudHMsMSk7CnJldHVybiB0aGlzLm1hcChmdW5jdGlvbihjKXtyZXR1cm4gY1thXS5hcHBseShjLGIpO30pO30sYXNzb2NpYXRlOmZ1bmN0aW9uKGMpe3ZhciBkPXt9LGI9TWF0aC5taW4odGhpcy5sZW5ndGgsYy5sZW5ndGgpO2Zvcih2YXIgYT0wO2E8YjthKyspe2RbY1thXV09dGhpc1thXTsKfXJldHVybiBkO30sbGluazpmdW5jdGlvbihjKXt2YXIgYT17fTtmb3IodmFyIGU9MCxiPXRoaXMubGVuZ3RoO2U8YjtlKyspe2Zvcih2YXIgZCBpbiBjKXtpZihjW2RdKHRoaXNbZV0pKXthW2RdPXRoaXNbZV07ZGVsZXRlIGNbZF07YnJlYWs7fX19cmV0dXJuIGE7fSxjb250YWluczpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmluZGV4T2YoYSxiKSE9LTE7Cn0sYXBwZW5kOmZ1bmN0aW9uKGEpe3RoaXMucHVzaC5hcHBseSh0aGlzLGEpO3JldHVybiB0aGlzO30sZ2V0TGFzdDpmdW5jdGlvbigpe3JldHVybih0aGlzLmxlbmd0aCk/dGhpc1t0aGlzLmxlbmd0aC0xXTpudWxsO30sZ2V0UmFuZG9tOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMubGVuZ3RoKT90aGlzW051bWJlci5yYW5kb20oMCx0aGlzLmxlbmd0aC0xKV06bnVsbDsKfSxpbmNsdWRlOmZ1bmN0aW9uKGEpe2lmKCF0aGlzLmNvbnRhaW5zKGEpKXt0aGlzLnB1c2goYSk7fXJldHVybiB0aGlzO30sY29tYmluZTpmdW5jdGlvbihjKXtmb3IodmFyIGI9MCxhPWMubGVuZ3RoO2I8YTtiKyspe3RoaXMuaW5jbHVkZShjW2JdKTt9cmV0dXJuIHRoaXM7Cn0sZXJhc2U6ZnVuY3Rpb24oYil7Zm9yKHZhciBhPXRoaXMubGVuZ3RoO2EtLTspe2lmKHRoaXNbYV09PT1iKXt0aGlzLnNwbGljZShhLDEpO319cmV0dXJuIHRoaXM7fSxlbXB0eTpmdW5jdGlvbigpe3RoaXMubGVuZ3RoPTA7cmV0dXJuIHRoaXM7fSxmbGF0dGVuOmZ1bmN0aW9uKCl7dmFyIGQ9W107CmZvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7dmFyIGM9dHlwZU9mKHRoaXNbYl0pO2lmKGM9PSJudWxsIil7Y29udGludWU7fWQ9ZC5jb25jYXQoKGM9PSJhcnJheSJ8fGM9PSJjb2xsZWN0aW9uInx8Yz09ImFyZ3VtZW50cyJ8fGluc3RhbmNlT2YodGhpc1tiXSxBcnJheSkpP0FycmF5LmZsYXR0ZW4odGhpc1tiXSk6dGhpc1tiXSk7Cn1yZXR1cm4gZDt9LHBpY2s6ZnVuY3Rpb24oKXtmb3IodmFyIGI9MCxhPXRoaXMubGVuZ3RoO2I8YTtiKyspe2lmKHRoaXNbYl0hPW51bGwpe3JldHVybiB0aGlzW2JdO319cmV0dXJuIG51bGw7fSxoZXhUb1JnYjpmdW5jdGlvbihiKXtpZih0aGlzLmxlbmd0aCE9Myl7cmV0dXJuIG51bGw7Cn12YXIgYT10aGlzLm1hcChmdW5jdGlvbihjKXtpZihjLmxlbmd0aD09MSl7Yys9Yzt9cmV0dXJuIGMudG9JbnQoMTYpO30pO3JldHVybihiKT9hOiJyZ2IoIithKyIpIjt9LHJnYlRvSGV4OmZ1bmN0aW9uKGQpe2lmKHRoaXMubGVuZ3RoPDMpe3JldHVybiBudWxsO31pZih0aGlzLmxlbmd0aD09NCYmdGhpc1szXT09MCYmIWQpe3JldHVybiJ0cmFuc3BhcmVudCI7Cn12YXIgYj1bXTtmb3IodmFyIGE9MDthPDM7YSsrKXt2YXIgYz0odGhpc1thXS0wKS50b1N0cmluZygxNik7Yi5wdXNoKChjLmxlbmd0aD09MSk/IjAiK2M6Yyk7fXJldHVybihkKT9iOiIjIitiLmpvaW4oIiIpO319KTtTdHJpbmcuaW1wbGVtZW50KHt0ZXN0OmZ1bmN0aW9uKGEsYil7cmV0dXJuKCh0eXBlT2YoYSk9PSJyZWdleHAiKT9hOm5ldyBSZWdFeHAoIiIrYSxiKSkudGVzdCh0aGlzKTsKfSxjb250YWluczpmdW5jdGlvbihhLGIpe3JldHVybihiKT8oYit0aGlzK2IpLmluZGV4T2YoYithK2IpPi0xOlN0cmluZyh0aGlzKS5pbmRleE9mKGEpPi0xO30sdHJpbTpmdW5jdGlvbigpe3JldHVybiBTdHJpbmcodGhpcykucmVwbGFjZSgvXlxzK3xccyskL2csIiIpOwp9LGNsZWFuOmZ1bmN0aW9uKCl7cmV0dXJuIFN0cmluZyh0aGlzKS5yZXBsYWNlKC9ccysvZywiICIpLnRyaW0oKTt9LGNhbWVsQ2FzZTpmdW5jdGlvbigpe3JldHVybiBTdHJpbmcodGhpcykucmVwbGFjZSgvLVxEL2csZnVuY3Rpb24oYSl7cmV0dXJuIGEuY2hhckF0KDEpLnRvVXBwZXJDYXNlKCk7Cn0pO30saHlwaGVuYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIFN0cmluZyh0aGlzKS5yZXBsYWNlKC9bQS1aXS9nLGZ1bmN0aW9uKGEpe3JldHVybigiLSIrYS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSk7fSk7fSxjYXBpdGFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIFN0cmluZyh0aGlzKS5yZXBsYWNlKC9cYlthLXpdL2csZnVuY3Rpb24oYSl7cmV0dXJuIGEudG9VcHBlckNhc2UoKTsKfSk7fSxlc2NhcGVSZWdFeHA6ZnVuY3Rpb24oKXtyZXR1cm4gU3RyaW5nKHRoaXMpLnJlcGxhY2UoLyhbLS4qKz9eJHt9KCl8W1xdXC9cXF0pL2csIlxcJDEiKTt9LHRvSW50OmZ1bmN0aW9uKGEpe3JldHVybiBwYXJzZUludCh0aGlzLGF8fDEwKTt9LHRvRmxvYXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcGFyc2VGbG9hdCh0aGlzKTsKfSxoZXhUb1JnYjpmdW5jdGlvbihiKXt2YXIgYT1TdHJpbmcodGhpcykubWF0Y2goL14jPyhcd3sxLDJ9KShcd3sxLDJ9KShcd3sxLDJ9KSQvKTtyZXR1cm4oYSk/YS5zbGljZSgxKS5oZXhUb1JnYihiKTpudWxsO30scmdiVG9IZXg6ZnVuY3Rpb24oYil7dmFyIGE9U3RyaW5nKHRoaXMpLm1hdGNoKC9cZHsxLDN9L2cpOwpyZXR1cm4oYSk/YS5yZ2JUb0hleChiKTpudWxsO30sc3Vic3RpdHV0ZTpmdW5jdGlvbihhLGIpe3JldHVybiBTdHJpbmcodGhpcykucmVwbGFjZShifHwoL1xcP1x7KFtee31dKylcfS9nKSxmdW5jdGlvbihkLGMpe2lmKGQuY2hhckF0KDApPT0iXFwiKXtyZXR1cm4gZC5zbGljZSgxKTsKfXJldHVybihhW2NdIT1udWxsKT9hW2NdOiIiO30pO319KTtOdW1iZXIuaW1wbGVtZW50KHtsaW1pdDpmdW5jdGlvbihiLGEpe3JldHVybiBNYXRoLm1pbihhLE1hdGgubWF4KGIsdGhpcykpO30scm91bmQ6ZnVuY3Rpb24oYSl7YT1NYXRoLnBvdygxMCxhfHwwKS50b0ZpeGVkKGE8MD8tYTowKTsKcmV0dXJuIE1hdGgucm91bmQodGhpcyphKS9hO30sdGltZXM6ZnVuY3Rpb24oYixjKXtmb3IodmFyIGE9MDthPHRoaXM7YSsrKXtiLmNhbGwoYyxhLHRoaXMpO319LHRvRmxvYXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcGFyc2VGbG9hdCh0aGlzKTt9LHRvSW50OmZ1bmN0aW9uKGEpe3JldHVybiBwYXJzZUludCh0aGlzLGF8fDEwKTsKfX0pO051bWJlci5hbGlhcygiZWFjaCIsInRpbWVzIik7KGZ1bmN0aW9uKGIpe3ZhciBhPXt9O2IuZWFjaChmdW5jdGlvbihjKXtpZighTnVtYmVyW2NdKXthW2NdPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGhbY10uYXBwbHkobnVsbCxbdGhpc10uY29uY2F0KEFycmF5LmZyb20oYXJndW1lbnRzKSkpOwp9O319KTtOdW1iZXIuaW1wbGVtZW50KGEpO30pKFsiYWJzIiwiYWNvcyIsImFzaW4iLCJhdGFuIiwiYXRhbjIiLCJjZWlsIiwiY29zIiwiZXhwIiwiZmxvb3IiLCJsb2ciLCJtYXgiLCJtaW4iLCJwb3ciLCJzaW4iLCJzcXJ0IiwidGFuIl0pO0Z1bmN0aW9uLmV4dGVuZCh7YXR0ZW1wdDpmdW5jdGlvbigpe2Zvcih2YXIgYj0wLGE9YXJndW1lbnRzLmxlbmd0aDsKYjxhO2IrKyl7dHJ5e3JldHVybiBhcmd1bWVudHNbYl0oKTt9Y2F0Y2goYyl7fX1yZXR1cm4gbnVsbDt9fSk7RnVuY3Rpb24uaW1wbGVtZW50KHthdHRlbXB0OmZ1bmN0aW9uKGEsYyl7dHJ5e3JldHVybiB0aGlzLmFwcGx5KGMsQXJyYXkuZnJvbShhKSk7fWNhdGNoKGIpe31yZXR1cm4gbnVsbDsKfSxiaW5kOmZ1bmN0aW9uKGUpe3ZhciBhPXRoaXMsYj1hcmd1bWVudHMubGVuZ3RoPjE/QXJyYXkuc2xpY2UoYXJndW1lbnRzLDEpOm51bGwsZD1mdW5jdGlvbigpe307dmFyIGM9ZnVuY3Rpb24oKXt2YXIgZz1lLGg9YXJndW1lbnRzLmxlbmd0aDtpZih0aGlzIGluc3RhbmNlb2YgYyl7ZC5wcm90b3R5cGU9YS5wcm90b3R5cGU7Cmc9bmV3IGQ7fXZhciBmPSghYiYmIWgpP2EuY2FsbChnKTphLmFwcGx5KGcsYiYmaD9iLmNvbmNhdChBcnJheS5zbGljZShhcmd1bWVudHMpKTpifHxhcmd1bWVudHMpO3JldHVybiBnPT1lP2Y6Zzt9O3JldHVybiBjO30scGFzczpmdW5jdGlvbihiLGMpe3ZhciBhPXRoaXM7CmlmKGIhPW51bGwpe2I9QXJyYXkuZnJvbShiKTt9cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYyxifHxhcmd1bWVudHMpO307fSxkZWxheTpmdW5jdGlvbihiLGMsYSl7cmV0dXJuIHNldFRpbWVvdXQodGhpcy5wYXNzKChhPT1udWxsP1tdOmEpLGMpLGIpOwp9LHBlcmlvZGljYWw6ZnVuY3Rpb24oYyxiLGEpe3JldHVybiBzZXRJbnRlcnZhbCh0aGlzLnBhc3MoKGE9PW51bGw/W106YSksYiksYyk7fX0pOyhmdW5jdGlvbigpe3ZhciBhPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7T2JqZWN0LmV4dGVuZCh7c3Vic2V0OmZ1bmN0aW9uKGQsZyl7dmFyIGY9e307CmZvcih2YXIgZT0wLGI9Zy5sZW5ndGg7ZTxiO2UrKyl7dmFyIGM9Z1tlXTtpZihjIGluIGQpe2ZbY109ZFtjXTt9fXJldHVybiBmO30sbWFwOmZ1bmN0aW9uKGIsZSxmKXt2YXIgZD17fTtmb3IodmFyIGMgaW4gYil7aWYoYS5jYWxsKGIsYykpe2RbY109ZS5jYWxsKGYsYltjXSxjLGIpOwp9fXJldHVybiBkO30sZmlsdGVyOmZ1bmN0aW9uKGIsZSxnKXt2YXIgZD17fTtmb3IodmFyIGMgaW4gYil7dmFyIGY9YltjXTtpZihhLmNhbGwoYixjKSYmZS5jYWxsKGcsZixjLGIpKXtkW2NdPWY7fX1yZXR1cm4gZDt9LGV2ZXJ5OmZ1bmN0aW9uKGIsZCxlKXtmb3IodmFyIGMgaW4gYil7aWYoYS5jYWxsKGIsYykmJiFkLmNhbGwoZSxiW2NdLGMpKXtyZXR1cm4gZmFsc2U7Cn19cmV0dXJuIHRydWU7fSxzb21lOmZ1bmN0aW9uKGIsZCxlKXtmb3IodmFyIGMgaW4gYil7aWYoYS5jYWxsKGIsYykmJmQuY2FsbChlLGJbY10sYykpe3JldHVybiB0cnVlO319cmV0dXJuIGZhbHNlO30sa2V5czpmdW5jdGlvbihiKXt2YXIgZD1bXTtmb3IodmFyIGMgaW4gYil7aWYoYS5jYWxsKGIsYykpe2QucHVzaChjKTsKfX1yZXR1cm4gZDt9LHZhbHVlczpmdW5jdGlvbihjKXt2YXIgYj1bXTtmb3IodmFyIGQgaW4gYyl7aWYoYS5jYWxsKGMsZCkpe2IucHVzaChjW2RdKTt9fXJldHVybiBiO30sZ2V0TGVuZ3RoOmZ1bmN0aW9uKGIpe3JldHVybiBPYmplY3Qua2V5cyhiKS5sZW5ndGg7fSxrZXlPZjpmdW5jdGlvbihiLGQpe2Zvcih2YXIgYyBpbiBiKXtpZihhLmNhbGwoYixjKSYmYltjXT09PWQpe3JldHVybiBjOwp9fXJldHVybiBudWxsO30sY29udGFpbnM6ZnVuY3Rpb24oYixjKXtyZXR1cm4gT2JqZWN0LmtleU9mKGIsYykhPW51bGw7fSx0b1F1ZXJ5U3RyaW5nOmZ1bmN0aW9uKGIsYyl7dmFyIGQ9W107T2JqZWN0LmVhY2goYixmdW5jdGlvbihoLGcpe2lmKGMpe2c9YysiWyIrZysiXSI7Cn12YXIgZjtzd2l0Y2godHlwZU9mKGgpKXtjYXNlIm9iamVjdCI6Zj1PYmplY3QudG9RdWVyeVN0cmluZyhoLGcpO2JyZWFrO2Nhc2UiYXJyYXkiOnZhciBlPXt9O2guZWFjaChmdW5jdGlvbihrLGope2Vbal09azt9KTtmPU9iamVjdC50b1F1ZXJ5U3RyaW5nKGUsZyk7CmJyZWFrO2RlZmF1bHQ6Zj1nKyI9IitlbmNvZGVVUklDb21wb25lbnQoaCk7fWlmKGghPW51bGwpe2QucHVzaChmKTt9fSk7cmV0dXJuIGQuam9pbigiJiIpO319KTt9KSgpOyhmdW5jdGlvbigpe3ZhciBqPXRoaXMuZG9jdW1lbnQ7dmFyIGc9ai53aW5kb3c9dGhpczsKdmFyIGE9bmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLGI9bmF2aWdhdG9yLnBsYXRmb3JtLnRvTG93ZXJDYXNlKCksaD1hLm1hdGNoKC8ob3BlcmF8aWV8ZmlyZWZveHxjaHJvbWV8dmVyc2lvbilbXHNcLzpdKFtcd1xkXC5dKyk/Lio/KHNhZmFyaXx2ZXJzaW9uW1xzXC86XShbXHdcZFwuXSspfCQpLyl8fFtudWxsLCJ1bmtub3duIiwwXSxkPWhbMV09PSJpZSImJmouZG9jdW1lbnRNb2RlOwp2YXIgbj10aGlzLkJyb3dzZXI9e2V4dGVuZDpGdW5jdGlvbi5wcm90b3R5cGUuZXh0ZW5kLG5hbWU6KGhbMV09PSJ2ZXJzaW9uIik/aFszXTpoWzFdLHZlcnNpb246ZHx8cGFyc2VGbG9hdCgoaFsxXT09Im9wZXJhIiYmaFs0XSk/aFs0XTpoWzJdKSxQbGF0Zm9ybTp7bmFtZTphLm1hdGNoKC9pcCg/OmFkfG9kfGhvbmUpLyk/ImlvcyI6KGEubWF0Y2goLyg/OndlYm9zfGFuZHJvaWQpLyl8fGIubWF0Y2goL21hY3x3aW58bGludXgvKXx8WyJvdGhlciJdKVswXX0sRmVhdHVyZXM6e3hwYXRoOiEhKGouZXZhbHVhdGUpLGFpcjohIShnLnJ1bnRpbWUpLHF1ZXJ5OiEhKGoucXVlcnlTZWxlY3RvciksanNvbjohIShnLkpTT04pfSxQbHVnaW5zOnt9fTsKbltuLm5hbWVdPXRydWU7bltuLm5hbWUrcGFyc2VJbnQobi52ZXJzaW9uLDEwKV09dHJ1ZTtuLlBsYXRmb3JtW24uUGxhdGZvcm0ubmFtZV09dHJ1ZTtuLlJlcXVlc3Q9KGZ1bmN0aW9uKCl7dmFyIHA9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7Cn07dmFyIG89ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1TWE1MMi5YTUxIVFRQIik7fTt2YXIgZT1mdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKTt9O3JldHVybiBGdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7cCgpOwpyZXR1cm4gcDt9LGZ1bmN0aW9uKCl7bygpO3JldHVybiBvO30sZnVuY3Rpb24oKXtlKCk7cmV0dXJuIGU7fSk7fSkoKTtuLkZlYXR1cmVzLnhocj0hIShuLlJlcXVlc3QpO3ZhciBpPShGdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7cmV0dXJuIG5hdmlnYXRvci5wbHVnaW5zWyJTaG9ja3dhdmUgRmxhc2giXS5kZXNjcmlwdGlvbjsKfSxmdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdCgiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2giKS5HZXRWYXJpYWJsZSgiJHZlcnNpb24iKTt9KXx8IjAgcjAiKS5tYXRjaCgvXGQrL2cpO24uUGx1Z2lucy5GbGFzaD17dmVyc2lvbjpOdW1iZXIoaVswXXx8IjAuIitpWzFdKXx8MCxidWlsZDpOdW1iZXIoaVsyXSl8fDB9OwpuLmV4ZWM9ZnVuY3Rpb24obyl7aWYoIW8pe3JldHVybiBvO31pZihnLmV4ZWNTY3JpcHQpe2cuZXhlY1NjcmlwdChvKTt9ZWxzZXt2YXIgZT1qLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO2Uuc2V0QXR0cmlidXRlKCJ0eXBlIiwidGV4dC9qYXZhc2NyaXB0Iik7ZS50ZXh0PW87CmouaGVhZC5hcHBlbmRDaGlsZChlKTtqLmhlYWQucmVtb3ZlQ2hpbGQoZSk7fXJldHVybiBvO307U3RyaW5nLmltcGxlbWVudCgic3RyaXBTY3JpcHRzIixmdW5jdGlvbihvKXt2YXIgZT0iIjt2YXIgcD10aGlzLnJlcGxhY2UoLzxzY3JpcHRbXj5dKj4oW1xzXFNdKj8pPFwvc2NyaXB0Pi9naSxmdW5jdGlvbihxLHIpe2UrPXIrIlxuIjsKcmV0dXJuIiI7fSk7aWYobz09PXRydWUpe24uZXhlYyhlKTt9ZWxzZXtpZih0eXBlT2Yobyk9PSJmdW5jdGlvbiIpe28oZSxwKTt9fXJldHVybiBwO30pO24uZXh0ZW5kKHtEb2N1bWVudDp0aGlzLkRvY3VtZW50LFdpbmRvdzp0aGlzLldpbmRvdyxFbGVtZW50OnRoaXMuRWxlbWVudCxFdmVudDp0aGlzLkV2ZW50fSk7CnRoaXMuV2luZG93PXRoaXMuJGNvbnN0cnVjdG9yPW5ldyBUeXBlKCJXaW5kb3ciLGZ1bmN0aW9uKCl7fSk7dGhpcy4kZmFtaWx5PUZ1bmN0aW9uLmZyb20oIndpbmRvdyIpLmhpZGUoKTtXaW5kb3cubWlycm9yKGZ1bmN0aW9uKGUsbyl7Z1tlXT1vO30pO3RoaXMuRG9jdW1lbnQ9ai4kY29uc3RydWN0b3I9bmV3IFR5cGUoIkRvY3VtZW50IixmdW5jdGlvbigpe30pOwpqLiRmYW1pbHk9RnVuY3Rpb24uZnJvbSgiZG9jdW1lbnQiKS5oaWRlKCk7RG9jdW1lbnQubWlycm9yKGZ1bmN0aW9uKGUsbyl7altlXT1vO30pO2ouaHRtbD1qLmRvY3VtZW50RWxlbWVudDtpZighai5oZWFkKXtqLmhlYWQ9ai5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdOwp9aWYoai5leGVjQ29tbWFuZCl7dHJ5e2ouZXhlY0NvbW1hbmQoIkJhY2tncm91bmRJbWFnZUNhY2hlIixmYWxzZSx0cnVlKTt9Y2F0Y2goZil7fX1pZih0aGlzLmF0dGFjaEV2ZW50JiYhdGhpcy5hZGRFdmVudExpc3RlbmVyKXt2YXIgYz1mdW5jdGlvbigpe3RoaXMuZGV0YWNoRXZlbnQoIm9udW5sb2FkIixjKTsKai5oZWFkPWouaHRtbD1qLndpbmRvdz1udWxsO307dGhpcy5hdHRhY2hFdmVudCgib251bmxvYWQiLGMpO312YXIgbD1BcnJheS5mcm9tO3RyeXtsKGouaHRtbC5jaGlsZE5vZGVzKTt9Y2F0Y2goZil7QXJyYXkuZnJvbT1mdW5jdGlvbihvKXtpZih0eXBlb2YgbyE9InN0cmluZyImJlR5cGUuaXNFbnVtZXJhYmxlKG8pJiZ0eXBlT2YobykhPSJhcnJheSIpe3ZhciBlPW8ubGVuZ3RoLHA9bmV3IEFycmF5KGUpOwp3aGlsZShlLS0pe3BbZV09b1tlXTt9cmV0dXJuIHA7fXJldHVybiBsKG8pO307dmFyIGs9QXJyYXkucHJvdG90eXBlLG09ay5zbGljZTtbInBvcCIsInB1c2giLCJyZXZlcnNlIiwic2hpZnQiLCJzb3J0Iiwic3BsaWNlIiwidW5zaGlmdCIsImNvbmNhdCIsImpvaW4iLCJzbGljZSJdLmVhY2goZnVuY3Rpb24oZSl7dmFyIG89a1tlXTsKQXJyYXlbZV09ZnVuY3Rpb24ocCl7cmV0dXJuIG8uYXBwbHkoQXJyYXkuZnJvbShwKSxtLmNhbGwoYXJndW1lbnRzLDEpKTt9O30pO319KSgpOyhmdW5jdGlvbigpe3ZhciBiPXt9O3ZhciBhPXRoaXMuRE9NRXZlbnQ9bmV3IFR5cGUoIkRPTUV2ZW50IixmdW5jdGlvbihjLGcpe2lmKCFnKXtnPXdpbmRvdzsKfWM9Y3x8Zy5ldmVudDtpZihjLiRleHRlbmRlZCl7cmV0dXJuIGM7fXRoaXMuZXZlbnQ9Yzt0aGlzLiRleHRlbmRlZD10cnVlO3RoaXMuc2hpZnQ9Yy5zaGlmdEtleTt0aGlzLmNvbnRyb2w9Yy5jdHJsS2V5O3RoaXMuYWx0PWMuYWx0S2V5O3RoaXMubWV0YT1jLm1ldGFLZXk7CnZhciBpPXRoaXMudHlwZT1jLnR5cGU7dmFyIGg9Yy50YXJnZXR8fGMuc3JjRWxlbWVudDt3aGlsZShoJiZoLm5vZGVUeXBlPT0zKXtoPWgucGFyZW50Tm9kZTt9dGhpcy50YXJnZXQ9ZG9jdW1lbnQuaWQoaCk7aWYoaS5pbmRleE9mKCJrZXkiKT09MCl7dmFyIGQ9dGhpcy5jb2RlPShjLndoaWNofHxjLmtleUNvZGUpOwp0aGlzLmtleT1iW2RdO2lmKGk9PSJrZXlkb3duIil7aWYoZD4xMTEmJmQ8MTI0KXt0aGlzLmtleT0iZiIrKGQtMTExKTt9ZWxzZXtpZihkPjk1JiZkPDEwNil7dGhpcy5rZXk9ZC05Njt9fX1pZih0aGlzLmtleT09bnVsbCl7dGhpcy5rZXk9U3RyaW5nLmZyb21DaGFyQ29kZShkKS50b0xvd2VyQ2FzZSgpOwp9fWVsc2V7aWYoaT09ImNsaWNrInx8aT09ImRibGNsaWNrInx8aT09ImNvbnRleHRtZW51Inx8aT09IkRPTU1vdXNlU2Nyb2xsInx8aS5pbmRleE9mKCJtb3VzZSIpPT0wKXt2YXIgaj1nLmRvY3VtZW50O2o9KCFqLmNvbXBhdE1vZGV8fGouY29tcGF0TW9kZT09IkNTUzFDb21wYXQiKT9qLmh0bWw6ai5ib2R5Owp0aGlzLnBhZ2U9e3g6KGMucGFnZVghPW51bGwpP2MucGFnZVg6Yy5jbGllbnRYK2ouc2Nyb2xsTGVmdCx5OihjLnBhZ2VZIT1udWxsKT9jLnBhZ2VZOmMuY2xpZW50WStqLnNjcm9sbFRvcH07dGhpcy5jbGllbnQ9e3g6KGMucGFnZVghPW51bGwpP2MucGFnZVgtZy5wYWdlWE9mZnNldDpjLmNsaWVudFgseTooYy5wYWdlWSE9bnVsbCk/Yy5wYWdlWS1nLnBhZ2VZT2Zmc2V0OmMuY2xpZW50WX07CmlmKGk9PSJET01Nb3VzZVNjcm9sbCJ8fGk9PSJtb3VzZXdoZWVsIil7dGhpcy53aGVlbD0oYy53aGVlbERlbHRhKT9jLndoZWVsRGVsdGEvMTIwOi0oYy5kZXRhaWx8fDApLzM7fXRoaXMucmlnaHRDbGljaz0oYy53aGljaD09M3x8Yy5idXR0b249PTIpO2lmKGk9PSJtb3VzZW92ZXIifHxpPT0ibW91c2VvdXQiKXt2YXIgaz1jLnJlbGF0ZWRUYXJnZXR8fGNbKGk9PSJtb3VzZW92ZXIiPyJmcm9tIjoidG8iKSsiRWxlbWVudCJdOwp3aGlsZShrJiZrLm5vZGVUeXBlPT0zKXtrPWsucGFyZW50Tm9kZTt9dGhpcy5yZWxhdGVkVGFyZ2V0PWRvY3VtZW50LmlkKGspO319ZWxzZXtpZihpLmluZGV4T2YoInRvdWNoIik9PTB8fGkuaW5kZXhPZigiZ2VzdHVyZSIpPT0wKXt0aGlzLnJvdGF0aW9uPWMucm90YXRpb247CnRoaXMuc2NhbGU9Yy5zY2FsZTt0aGlzLnRhcmdldFRvdWNoZXM9Yy50YXJnZXRUb3VjaGVzO3RoaXMuY2hhbmdlZFRvdWNoZXM9Yy5jaGFuZ2VkVG91Y2hlczt2YXIgZj10aGlzLnRvdWNoZXM9Yy50b3VjaGVzO2lmKGYmJmZbMF0pe3ZhciBlPWZbMF07dGhpcy5wYWdlPXt4OmUucGFnZVgseTplLnBhZ2VZfTsKdGhpcy5jbGllbnQ9e3g6ZS5jbGllbnRYLHk6ZS5jbGllbnRZfTt9fX19aWYoIXRoaXMuY2xpZW50KXt0aGlzLmNsaWVudD17fTt9aWYoIXRoaXMucGFnZSl7dGhpcy5wYWdlPXt9O319KTthLmltcGxlbWVudCh7c3RvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXZlbnREZWZhdWx0KCkuc3RvcFByb3BhZ2F0aW9uKCk7Cn0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7aWYodGhpcy5ldmVudC5zdG9wUHJvcGFnYXRpb24pe3RoaXMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7fWVsc2V7dGhpcy5ldmVudC5jYW5jZWxCdWJibGU9dHJ1ZTt9cmV0dXJuIHRoaXM7fSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe2lmKHRoaXMuZXZlbnQucHJldmVudERlZmF1bHQpe3RoaXMuZXZlbnQucHJldmVudERlZmF1bHQoKTsKfWVsc2V7dGhpcy5ldmVudC5yZXR1cm5WYWx1ZT1mYWxzZTt9cmV0dXJuIHRoaXM7fX0pO2EuZGVmaW5lS2V5PWZ1bmN0aW9uKGQsYyl7YltkXT1jO3JldHVybiB0aGlzO307YS5kZWZpbmVLZXlzPWEuZGVmaW5lS2V5Lm92ZXJsb2FkU2V0dGVyKHRydWUpO2EuZGVmaW5lS2V5cyh7IjM4IjoidXAiLCI0MCI6ImRvd24iLCIzNyI6ImxlZnQiLCIzOSI6InJpZ2h0IiwiMjciOiJlc2MiLCIzMiI6InNwYWNlIiwiOCI6ImJhY2tzcGFjZSIsIjkiOiJ0YWIiLCI0NiI6ImRlbGV0ZSIsIjEzIjoiZW50ZXIifSk7Cn0pKCk7KGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5DbGFzcz1uZXcgVHlwZSgiQ2xhc3MiLGZ1bmN0aW9uKGgpe2lmKGluc3RhbmNlT2YoaCxGdW5jdGlvbikpe2g9e2luaXRpYWxpemU6aH07fXZhciBnPWZ1bmN0aW9uKCl7ZSh0aGlzKTtpZihnLiRwcm90b3R5cGluZyl7cmV0dXJuIHRoaXM7Cn10aGlzLiRjYWxsZXI9bnVsbDt2YXIgaT0odGhpcy5pbml0aWFsaXplKT90aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpOnRoaXM7dGhpcy4kY2FsbGVyPXRoaXMuY2FsbGVyPW51bGw7cmV0dXJuIGk7fS5leHRlbmQodGhpcykuaW1wbGVtZW50KGgpOwpnLiRjb25zdHJ1Y3Rvcj1hO2cucHJvdG90eXBlLiRjb25zdHJ1Y3Rvcj1nO2cucHJvdG90eXBlLnBhcmVudD1jO3JldHVybiBnO30pO3ZhciBjPWZ1bmN0aW9uKCl7aWYoIXRoaXMuJGNhbGxlcil7dGhyb3cgbmV3IEVycm9yKCdUaGUgbWV0aG9kICJwYXJlbnQiIGNhbm5vdCBiZSBjYWxsZWQuJyk7Cn12YXIgZz10aGlzLiRjYWxsZXIuJG5hbWUsaD10aGlzLiRjYWxsZXIuJG93bmVyLnBhcmVudCxpPShoKT9oLnByb3RvdHlwZVtnXTpudWxsO2lmKCFpKXt0aHJvdyBuZXcgRXJyb3IoJ1RoZSBtZXRob2QgIicrZysnIiBoYXMgbm8gcGFyZW50LicpO31yZXR1cm4gaS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7Cn07dmFyIGU9ZnVuY3Rpb24oZyl7Zm9yKHZhciBoIGluIGcpe3ZhciBqPWdbaF07c3dpdGNoKHR5cGVPZihqKSl7Y2FzZSJvYmplY3QiOnZhciBpPWZ1bmN0aW9uKCl7fTtpLnByb3RvdHlwZT1qO2dbaF09ZShuZXcgaSk7YnJlYWs7Y2FzZSJhcnJheSI6Z1toXT1qLmNsb25lKCk7CmJyZWFrO319cmV0dXJuIGc7fTt2YXIgYj1mdW5jdGlvbihnLGgsail7aWYoai4kb3JpZ2luKXtqPWouJG9yaWdpbjt9dmFyIGk9ZnVuY3Rpb24oKXtpZihqLiRwcm90ZWN0ZWQmJnRoaXMuJGNhbGxlcj09bnVsbCl7dGhyb3cgbmV3IEVycm9yKCdUaGUgbWV0aG9kICInK2grJyIgY2Fubm90IGJlIGNhbGxlZC4nKTsKfXZhciBsPXRoaXMuY2FsbGVyLG09dGhpcy4kY2FsbGVyO3RoaXMuY2FsbGVyPW07dGhpcy4kY2FsbGVyPWk7dmFyIGs9ai5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy4kY2FsbGVyPW07dGhpcy5jYWxsZXI9bDtyZXR1cm4gazt9LmV4dGVuZCh7JG93bmVyOmcsJG9yaWdpbjpqLCRuYW1lOmh9KTsKcmV0dXJuIGk7fTt2YXIgZj1mdW5jdGlvbihoLGksZyl7aWYoYS5NdXRhdG9ycy5oYXNPd25Qcm9wZXJ0eShoKSl7aT1hLk11dGF0b3JzW2hdLmNhbGwodGhpcyxpKTtpZihpPT1udWxsKXtyZXR1cm4gdGhpczt9fWlmKHR5cGVPZihpKT09ImZ1bmN0aW9uIil7aWYoaS4kaGlkZGVuKXtyZXR1cm4gdGhpczsKfXRoaXMucHJvdG90eXBlW2hdPShnKT9pOmIodGhpcyxoLGkpO31lbHNle09iamVjdC5tZXJnZSh0aGlzLnByb3RvdHlwZSxoLGkpO31yZXR1cm4gdGhpczt9O3ZhciBkPWZ1bmN0aW9uKGcpe2cuJHByb3RvdHlwaW5nPXRydWU7dmFyIGg9bmV3IGc7ZGVsZXRlIGcuJHByb3RvdHlwaW5nOwpyZXR1cm4gaDt9O2EuaW1wbGVtZW50KCJpbXBsZW1lbnQiLGYub3ZlcmxvYWRTZXR0ZXIoKSk7YS5NdXRhdG9ycz17RXh0ZW5kczpmdW5jdGlvbihnKXt0aGlzLnBhcmVudD1nO3RoaXMucHJvdG90eXBlPWQoZyk7fSxJbXBsZW1lbnRzOmZ1bmN0aW9uKGcpe0FycmF5LmZyb20oZykuZWFjaChmdW5jdGlvbihqKXt2YXIgaD1uZXcgajsKZm9yKHZhciBpIGluIGgpe2YuY2FsbCh0aGlzLGksaFtpXSx0cnVlKTt9fSx0aGlzKTt9fTt9KSgpOyhmdW5jdGlvbigpe3RoaXMuQ2hhaW49bmV3IENsYXNzKHskY2hhaW46W10sY2hhaW46ZnVuY3Rpb24oKXt0aGlzLiRjaGFpbi5hcHBlbmQoQXJyYXkuZmxhdHRlbihhcmd1bWVudHMpKTsKcmV0dXJuIHRoaXM7fSxjYWxsQ2hhaW46ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy4kY2hhaW4ubGVuZ3RoKT90aGlzLiRjaGFpbi5zaGlmdCgpLmFwcGx5KHRoaXMsYXJndW1lbnRzKTpmYWxzZTt9LGNsZWFyQ2hhaW46ZnVuY3Rpb24oKXt0aGlzLiRjaGFpbi5lbXB0eSgpOwpyZXR1cm4gdGhpczt9fSk7dmFyIGE9ZnVuY3Rpb24oYil7cmV0dXJuIGIucmVwbGFjZSgvXm9uKFtBLVpdKS8sZnVuY3Rpb24oYyxkKXtyZXR1cm4gZC50b0xvd2VyQ2FzZSgpO30pO307dGhpcy5FdmVudHM9bmV3IENsYXNzKHskZXZlbnRzOnt9LGFkZEV2ZW50OmZ1bmN0aW9uKGQsYyxiKXtkPWEoZCk7CnRoaXMuJGV2ZW50c1tkXT0odGhpcy4kZXZlbnRzW2RdfHxbXSkuaW5jbHVkZShjKTtpZihiKXtjLmludGVybmFsPXRydWU7fXJldHVybiB0aGlzO30sYWRkRXZlbnRzOmZ1bmN0aW9uKGIpe2Zvcih2YXIgYyBpbiBiKXt0aGlzLmFkZEV2ZW50KGMsYltjXSk7fXJldHVybiB0aGlzOwp9LGZpcmVFdmVudDpmdW5jdGlvbihlLGMsYil7ZT1hKGUpO3ZhciBkPXRoaXMuJGV2ZW50c1tlXTtpZighZCl7cmV0dXJuIHRoaXM7fWM9QXJyYXkuZnJvbShjKTtkLmVhY2goZnVuY3Rpb24oZil7aWYoYil7Zi5kZWxheShiLHRoaXMsYyk7fWVsc2V7Zi5hcHBseSh0aGlzLGMpOwp9fSx0aGlzKTtyZXR1cm4gdGhpczt9LHJlbW92ZUV2ZW50OmZ1bmN0aW9uKGUsZCl7ZT1hKGUpO3ZhciBjPXRoaXMuJGV2ZW50c1tlXTtpZihjJiYhZC5pbnRlcm5hbCl7dmFyIGI9Yy5pbmRleE9mKGQpO2lmKGIhPS0xKXtkZWxldGUgY1tiXTt9fXJldHVybiB0aGlzOwp9LHJlbW92ZUV2ZW50czpmdW5jdGlvbihkKXt2YXIgZTtpZih0eXBlT2YoZCk9PSJvYmplY3QiKXtmb3IoZSBpbiBkKXt0aGlzLnJlbW92ZUV2ZW50KGUsZFtlXSk7fXJldHVybiB0aGlzO31pZihkKXtkPWEoZCk7fWZvcihlIGluIHRoaXMuJGV2ZW50cyl7aWYoZCYmZCE9ZSl7Y29udGludWU7Cn12YXIgYz10aGlzLiRldmVudHNbZV07Zm9yKHZhciBiPWMubGVuZ3RoO2ItLTspe2lmKGIgaW4gYyl7dGhpcy5yZW1vdmVFdmVudChlLGNbYl0pO319fXJldHVybiB0aGlzO319KTt0aGlzLk9wdGlvbnM9bmV3IENsYXNzKHtzZXRPcHRpb25zOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5vcHRpb25zPU9iamVjdC5tZXJnZS5hcHBseShudWxsLFt7fSx0aGlzLm9wdGlvbnNdLmFwcGVuZChhcmd1bWVudHMpKTsKaWYodGhpcy5hZGRFdmVudCl7Zm9yKHZhciBjIGluIGIpe2lmKHR5cGVPZihiW2NdKSE9ImZ1bmN0aW9uInx8ISgvXm9uW0EtWl0vKS50ZXN0KGMpKXtjb250aW51ZTt9dGhpcy5hZGRFdmVudChjLGJbY10pO2RlbGV0ZSBiW2NdO319cmV0dXJuIHRoaXM7fX0pO30pKCk7CihmdW5jdGlvbigpe3ZhciBrLG4sbCxnLGE9e30sYz17fSxtPS9cXC9nO3ZhciBlPWZ1bmN0aW9uKHEscCl7aWYocT09bnVsbCl7cmV0dXJuIG51bGw7fWlmKHEuU2xpY2s9PT10cnVlKXtyZXR1cm4gcTt9cT0oIiIrcSkucmVwbGFjZSgvXlxzK3xccyskL2csIiIpO2c9ISFwOwp2YXIgbz0oZyk/YzphO2lmKG9bcV0pe3JldHVybiBvW3FdO31rPXtTbGljazp0cnVlLGV4cHJlc3Npb25zOltdLHJhdzpxLHJldmVyc2U6ZnVuY3Rpb24oKXtyZXR1cm4gZSh0aGlzLnJhdyx0cnVlKTt9fTtuPS0xO3doaWxlKHEhPShxPXEucmVwbGFjZShqLGIpKSl7fWsubGVuZ3RoPWsuZXhwcmVzc2lvbnMubGVuZ3RoOwpyZXR1cm4gb1trLnJhd109KGcpP2goayk6azt9O3ZhciBpPWZ1bmN0aW9uKG8pe2lmKG89PT0iISIpe3JldHVybiIgIjt9ZWxzZXtpZihvPT09IiAiKXtyZXR1cm4iISI7fWVsc2V7aWYoKC9eIS8pLnRlc3Qobykpe3JldHVybiBvLnJlcGxhY2UoL14hLywiIik7fWVsc2V7cmV0dXJuIiEiK287Cn19fX07dmFyIGg9ZnVuY3Rpb24odSl7dmFyIHI9dS5leHByZXNzaW9ucztmb3IodmFyIHA9MDtwPHIubGVuZ3RoO3ArKyl7dmFyIHQ9cltwXTt2YXIgcT17cGFydHM6W10sdGFnOiIqIixjb21iaW5hdG9yOmkodFswXS5jb21iaW5hdG9yKX07Zm9yKHZhciBvPTA7bzx0Lmxlbmd0aDsKbysrKXt2YXIgcz10W29dO2lmKCFzLnJldmVyc2VDb21iaW5hdG9yKXtzLnJldmVyc2VDb21iaW5hdG9yPSIgIjt9cy5jb21iaW5hdG9yPXMucmV2ZXJzZUNvbWJpbmF0b3I7ZGVsZXRlIHMucmV2ZXJzZUNvbWJpbmF0b3I7fXQucmV2ZXJzZSgpLnB1c2gocSk7fXJldHVybiB1Owp9O3ZhciBmPWZ1bmN0aW9uKG8pe3JldHVybiBvLnJlcGxhY2UoL1stW1xde30oKSorPy5cXF4kfCwjXHNdL2csZnVuY3Rpb24ocCl7cmV0dXJuIlxcIitwO30pO307dmFyIGo9bmV3IFJlZ0V4cCgiXig/OlxccyooLClcXHMqfFxccyooPGNvbWJpbmF0b3I+KylcXHMqfChcXHMrKXwoPHVuaWNvZGU+K3xcXCopfFxcIyg8dW5pY29kZT4rKXxcXC4oPHVuaWNvZGU+Kyl8XFxbXFxzKig8dW5pY29kZTE+KykoPzpcXHMqKFsqXiQhfnxdPz0pKD86XFxzKig/OihbXCInXT8pKC4qPylcXDkpKSk/XFxzKlxcXSg/IVxcXSl8KDorKSg8dW5pY29kZT4rKSg/OlxcKCg/Oig/OihbXCInXSkoW15cXDEzXSopXFwxMyl8KCg/OlxcKFteKV0rXFwpfFteKCldKikrKSlcXCkpPykiLnJlcGxhY2UoLzxjb21iaW5hdG9yPi8sIlsiK2YoIj4rfmAhQCQlXiY9e31cXDs8LyIpKyJdIikucmVwbGFjZSgvPHVuaWNvZGU+L2csIig/OltcXHdcXHUwMGExLVxcdUZGRkYtXXxcXFxcW15cXHMwLTlhLWZdKSIpLnJlcGxhY2UoLzx1bmljb2RlMT4vZywiKD86WzpcXHdcXHUwMGExLVxcdUZGRkYtXXxcXFxcW15cXHMwLTlhLWZdKSIpKTsKZnVuY3Rpb24gYih4LHMsRCx6LHIsQyxxLEIsQSx5LHUsRixHLHYscCx3KXtpZihzfHxuPT09LTEpe2suZXhwcmVzc2lvbnNbKytuXT1bXTtsPS0xO2lmKHMpe3JldHVybiIiO319aWYoRHx8enx8bD09PS0xKXtEPUR8fCIgIjt2YXIgdD1rLmV4cHJlc3Npb25zW25dOwppZihnJiZ0W2xdKXt0W2xdLnJldmVyc2VDb21iaW5hdG9yPWkoRCk7fXRbKytsXT17Y29tYmluYXRvcjpELHRhZzoiKiJ9O312YXIgbz1rLmV4cHJlc3Npb25zW25dW2xdO2lmKHIpe28udGFnPXIucmVwbGFjZShtLCIiKTt9ZWxzZXtpZihDKXtvLmlkPUMucmVwbGFjZShtLCIiKTsKfWVsc2V7aWYocSl7cT1xLnJlcGxhY2UobSwiIik7aWYoIW8uY2xhc3NMaXN0KXtvLmNsYXNzTGlzdD1bXTt9aWYoIW8uY2xhc3Nlcyl7by5jbGFzc2VzPVtdO31vLmNsYXNzTGlzdC5wdXNoKHEpO28uY2xhc3Nlcy5wdXNoKHt2YWx1ZTpxLHJlZ2V4cDpuZXcgUmVnRXhwKCIoXnxcXHMpIitmKHEpKyIoXFxzfCQpIil9KTsKfWVsc2V7aWYoRyl7dz13fHxwO3c9dz93LnJlcGxhY2UobSwiIik6bnVsbDtpZighby5wc2V1ZG9zKXtvLnBzZXVkb3M9W107fW8ucHNldWRvcy5wdXNoKHtrZXk6Ry5yZXBsYWNlKG0sIiIpLHZhbHVlOncsdHlwZTpGLmxlbmd0aD09MT8iY2xhc3MiOiJlbGVtZW50In0pOwp9ZWxzZXtpZihCKXtCPUIucmVwbGFjZShtLCIiKTt1PSh1fHwiIikucmVwbGFjZShtLCIiKTt2YXIgRSxIO3N3aXRjaChBKXtjYXNlIl49IjpIPW5ldyBSZWdFeHAoIl4iK2YodSkpO2JyZWFrO2Nhc2UiJD0iOkg9bmV3IFJlZ0V4cChmKHUpKyIkIik7YnJlYWs7Y2FzZSJ+PSI6SD1uZXcgUmVnRXhwKCIoXnxcXHMpIitmKHUpKyIoXFxzfCQpIik7CmJyZWFrO2Nhc2UifD0iOkg9bmV3IFJlZ0V4cCgiXiIrZih1KSsiKC18JCkiKTticmVhaztjYXNlIj0iOkU9ZnVuY3Rpb24oSSl7cmV0dXJuIHU9PUk7fTticmVhaztjYXNlIio9IjpFPWZ1bmN0aW9uKEkpe3JldHVybiBJJiZJLmluZGV4T2YodSk+LTE7fTticmVhazsKY2FzZSIhPSI6RT1mdW5jdGlvbihJKXtyZXR1cm4gdSE9STt9O2JyZWFrO2RlZmF1bHQ6RT1mdW5jdGlvbihJKXtyZXR1cm4gISFJO307fWlmKHU9PSIiJiYoL15bKiReXT0kLykudGVzdChBKSl7RT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O31pZighRSl7RT1mdW5jdGlvbihJKXtyZXR1cm4gSSYmSC50ZXN0KEkpOwp9O31pZighby5hdHRyaWJ1dGVzKXtvLmF0dHJpYnV0ZXM9W107fW8uYXR0cmlidXRlcy5wdXNoKHtrZXk6QixvcGVyYXRvcjpBLHZhbHVlOnUsdGVzdDpFfSk7fX19fX1yZXR1cm4iIjt9dmFyIGQ9KHRoaXMuU2xpY2t8fHt9KTtkLnBhcnNlPWZ1bmN0aW9uKG8pe3JldHVybiBlKG8pOwp9O2QuZXNjYXBlUmVnRXhwPWY7aWYoIXRoaXMuU2xpY2spe3RoaXMuU2xpY2s9ZDt9fSkuYXBwbHkoKHR5cGVvZiBleHBvcnRzIT0idW5kZWZpbmVkIik/ZXhwb3J0czp0aGlzKTsoZnVuY3Rpb24oKXt2YXIgaz17fSxtPXt9LGQ9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKay5pc05hdGl2ZUNvZGU9ZnVuY3Rpb24oYyl7cmV0dXJuKC9ce1xzKlxbbmF0aXZlIGNvZGVcXVxzKlx9LykudGVzdCgiIitjKTt9O2suaXNYTUw9ZnVuY3Rpb24oYyl7cmV0dXJuKCEhYy54bWxWZXJzaW9uKXx8KCEhYy54bWwpfHwoZC5jYWxsKGMpPT0iW29iamVjdCBYTUxEb2N1bWVudF0iKXx8KGMubm9kZVR5cGU9PTkmJmMuZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lIT0iSFRNTCIpOwp9O2suc2V0RG9jdW1lbnQ9ZnVuY3Rpb24odyl7dmFyIHA9dy5ub2RlVHlwZTtpZihwPT05KXt9ZWxzZXtpZihwKXt3PXcub3duZXJEb2N1bWVudDt9ZWxzZXtpZih3Lm5hdmlnYXRvcil7dz13LmRvY3VtZW50O31lbHNle3JldHVybjt9fX1pZih0aGlzLmRvY3VtZW50PT09dyl7cmV0dXJuOwp9dGhpcy5kb2N1bWVudD13O3ZhciBBPXcuZG9jdW1lbnRFbGVtZW50LG89dGhpcy5nZXRVSURYTUwoQSkscz1tW29dLHI7aWYocyl7Zm9yKHIgaW4gcyl7dGhpc1tyXT1zW3JdO31yZXR1cm47fXM9bVtvXT17fTtzLnJvb3Q9QTtzLmlzWE1MRG9jdW1lbnQ9dGhpcy5pc1hNTCh3KTsKcy5icm9rZW5TdGFyR0VCVE49cy5zdGFyU2VsZWN0c0Nsb3NlZFFTQT1zLmlkR2V0c05hbWU9cy5icm9rZW5NaXhlZENhc2VRU0E9cy5icm9rZW5HRUJDTj1zLmJyb2tlbkNoZWNrZWRRU0E9cy5icm9rZW5FbXB0eUF0dHJpYnV0ZVFTQT1zLmlzSFRNTERvY3VtZW50PXMubmF0aXZlTWF0Y2hlc1NlbGVjdG9yPWZhbHNlOwp2YXIgcSx1LHkseix0O3ZhciB4LHY9InNsaWNrX3VuaXF1ZWlkIjt2YXIgYz13LmNyZWF0ZUVsZW1lbnQoImRpdiIpO3ZhciBuPXcuYm9keXx8dy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdfHxBO24uYXBwZW5kQ2hpbGQoYyk7dHJ5e2MuaW5uZXJIVE1MPSc8YSBpZD0iJyt2KyciPjwvYT4nOwpzLmlzSFRNTERvY3VtZW50PSEhdy5nZXRFbGVtZW50QnlJZCh2KTt9Y2F0Y2goQyl7fWlmKHMuaXNIVE1MRG9jdW1lbnQpe2Muc3R5bGUuZGlzcGxheT0ibm9uZSI7Yy5hcHBlbmRDaGlsZCh3LmNyZWF0ZUNvbW1lbnQoIiIpKTt1PShjLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RoPjEpOwp0cnl7Yy5pbm5lckhUTUw9ImZvbzwvZm9vPiI7eD1jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIik7cT0oeCYmISF4Lmxlbmd0aCYmeFswXS5ub2RlTmFtZS5jaGFyQXQoMCk9PSIvIik7fWNhdGNoKEMpe31zLmJyb2tlblN0YXJHRUJUTj11fHxxO3RyeXtjLmlubmVySFRNTD0nPGEgbmFtZT0iJyt2KyciPjwvYT48YiBpZD0iJyt2KyciPjwvYj4nOwpzLmlkR2V0c05hbWU9dy5nZXRFbGVtZW50QnlJZCh2KT09PWMuZmlyc3RDaGlsZDt9Y2F0Y2goQyl7fWlmKGMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSl7dHJ5e2MuaW5uZXJIVE1MPSc8YSBjbGFzcz0iZiI+PC9hPjxhIGNsYXNzPSJiIj48L2E+JztjLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImIiKS5sZW5ndGg7CmMuZmlyc3RDaGlsZC5jbGFzc05hbWU9ImIiO3o9KGMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiYiIpLmxlbmd0aCE9Mik7fWNhdGNoKEMpe310cnl7Yy5pbm5lckhUTUw9JzxhIGNsYXNzPSJhIj48L2E+PGEgY2xhc3M9ImYgYiBhIj48L2E+Jzt5PShjLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImEiKS5sZW5ndGghPTIpOwp9Y2F0Y2goQyl7fXMuYnJva2VuR0VCQ049enx8eTt9aWYoYy5xdWVyeVNlbGVjdG9yQWxsKXt0cnl7Yy5pbm5lckhUTUw9ImZvbzwvZm9vPiI7eD1jLnF1ZXJ5U2VsZWN0b3JBbGwoIioiKTtzLnN0YXJTZWxlY3RzQ2xvc2VkUVNBPSh4JiYhIXgubGVuZ3RoJiZ4WzBdLm5vZGVOYW1lLmNoYXJBdCgwKT09Ii8iKTsKfWNhdGNoKEMpe310cnl7Yy5pbm5lckhUTUw9JzxhIGNsYXNzPSJNaVgiPjwvYT4nO3MuYnJva2VuTWl4ZWRDYXNlUVNBPSFjLnF1ZXJ5U2VsZWN0b3JBbGwoIi5NaVgiKS5sZW5ndGg7fWNhdGNoKEMpe310cnl7Yy5pbm5lckhUTUw9JzxzZWxlY3Q+PG9wdGlvbiBzZWxlY3RlZD0ic2VsZWN0ZWQiPmE8L29wdGlvbj48L3NlbGVjdD4nOwpzLmJyb2tlbkNoZWNrZWRRU0E9KGMucXVlcnlTZWxlY3RvckFsbCgiOmNoZWNrZWQiKS5sZW5ndGg9PTApO31jYXRjaChDKXt9dHJ5e2MuaW5uZXJIVE1MPSc8YSBjbGFzcz0iIj48L2E+JztzLmJyb2tlbkVtcHR5QXR0cmlidXRlUVNBPShjLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tjbGFzcyo9IiJdJykubGVuZ3RoIT0wKTsKfWNhdGNoKEMpe319dHJ5e2MuaW5uZXJIVE1MPSc8Zm9ybSBhY3Rpb249InMiPjxpbnB1dCBpZD0iYWN0aW9uIi8+PC9mb3JtPic7dD0oYy5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiYWN0aW9uIikhPSJzIik7fWNhdGNoKEMpe31zLm5hdGl2ZU1hdGNoZXNTZWxlY3Rvcj1BLm1hdGNoZXNTZWxlY3Rvcnx8QS5tb3pNYXRjaGVzU2VsZWN0b3J8fEEud2Via2l0TWF0Y2hlc1NlbGVjdG9yOwppZihzLm5hdGl2ZU1hdGNoZXNTZWxlY3Rvcil7dHJ5e3MubmF0aXZlTWF0Y2hlc1NlbGVjdG9yLmNhbGwoQSwiOnNsaWNrIik7cy5uYXRpdmVNYXRjaGVzU2VsZWN0b3I9bnVsbDt9Y2F0Y2goQyl7fX19dHJ5e0Euc2xpY2tfZXhwYW5kbz0xO2RlbGV0ZSBBLnNsaWNrX2V4cGFuZG87CnMuZ2V0VUlEPXRoaXMuZ2V0VUlESFRNTDt9Y2F0Y2goQyl7cy5nZXRVSUQ9dGhpcy5nZXRVSURYTUw7fW4ucmVtb3ZlQ2hpbGQoYyk7Yz14PW49bnVsbDtzLmdldEF0dHJpYnV0ZT0ocy5pc0hUTUxEb2N1bWVudCYmdCk/ZnVuY3Rpb24oRyxFKXt2YXIgSD10aGlzLmF0dHJpYnV0ZUdldHRlcnNbRV07CmlmKEgpe3JldHVybiBILmNhbGwoRyk7fXZhciBGPUcuZ2V0QXR0cmlidXRlTm9kZShFKTtyZXR1cm4oRik/Ri5ub2RlVmFsdWU6bnVsbDt9OmZ1bmN0aW9uKEYsRSl7dmFyIEc9dGhpcy5hdHRyaWJ1dGVHZXR0ZXJzW0VdO3JldHVybihHKT9HLmNhbGwoRik6Ri5nZXRBdHRyaWJ1dGUoRSk7Cn07cy5oYXNBdHRyaWJ1dGU9KEEmJnRoaXMuaXNOYXRpdmVDb2RlKEEuaGFzQXR0cmlidXRlKSk/ZnVuY3Rpb24oRixFKXtyZXR1cm4gRi5oYXNBdHRyaWJ1dGUoRSk7fTpmdW5jdGlvbihGLEUpe0Y9Ri5nZXRBdHRyaWJ1dGVOb2RlKEUpO3JldHVybiAhIShGJiYoRi5zcGVjaWZpZWR8fEYubm9kZVZhbHVlKSk7Cn07dmFyIEQ9QSYmdGhpcy5pc05hdGl2ZUNvZGUoQS5jb250YWlucyksQj13JiZ0aGlzLmlzTmF0aXZlQ29kZSh3LmNvbnRhaW5zKTtzLmNvbnRhaW5zPShEJiZCKT9mdW5jdGlvbihFLEYpe3JldHVybiBFLmNvbnRhaW5zKEYpO306KEQmJiFCKT9mdW5jdGlvbihFLEYpe3JldHVybiBFPT09Rnx8KChFPT09dyk/dy5kb2N1bWVudEVsZW1lbnQ6RSkuY29udGFpbnMoRik7Cn06KEEmJkEuY29tcGFyZURvY3VtZW50UG9zaXRpb24pP2Z1bmN0aW9uKEUsRil7cmV0dXJuIEU9PT1GfHwhIShFLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKEYpJjE2KTt9OmZ1bmN0aW9uKEUsRil7aWYoRil7ZG97aWYoRj09PUUpe3JldHVybiB0cnVlO319d2hpbGUoKEY9Ri5wYXJlbnROb2RlKSk7Cn1yZXR1cm4gZmFsc2U7fTtzLmRvY3VtZW50U29ydGVyPShBLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKT9mdW5jdGlvbihGLEUpe2lmKCFGLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9ufHwhRS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbil7cmV0dXJuIDA7fXJldHVybiBGLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKEUpJjQ/LTE6Rj09PUU/MDoxOwp9Oigic291cmNlSW5kZXgiIGluIEEpP2Z1bmN0aW9uKEYsRSl7aWYoIUYuc291cmNlSW5kZXh8fCFFLnNvdXJjZUluZGV4KXtyZXR1cm4gMDt9cmV0dXJuIEYuc291cmNlSW5kZXgtRS5zb3VyY2VJbmRleDt9Oih3LmNyZWF0ZVJhbmdlKT9mdW5jdGlvbihILEYpe2lmKCFILm93bmVyRG9jdW1lbnR8fCFGLm93bmVyRG9jdW1lbnQpe3JldHVybiAwOwp9dmFyIEc9SC5vd25lckRvY3VtZW50LmNyZWF0ZVJhbmdlKCksRT1GLm93bmVyRG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtHLnNldFN0YXJ0KEgsMCk7Ry5zZXRFbmQoSCwwKTtFLnNldFN0YXJ0KEYsMCk7RS5zZXRFbmQoRiwwKTtyZXR1cm4gRy5jb21wYXJlQm91bmRhcnlQb2ludHMoUmFuZ2UuU1RBUlRfVE9fRU5ELEUpOwp9Om51bGw7QT1udWxsO2ZvcihyIGluIHMpe3RoaXNbcl09c1tyXTt9fTt2YXIgZj0vXihbIy5dPykoKD86W1x3LV0rfFwqKSkkLyxoPS9cWy4rWyokXl09KD86IiJ8JycpP1xdLyxnPXt9O2suc2VhcmNoPWZ1bmN0aW9uKFUseixILHMpe3ZhciBwPXRoaXMuZm91bmQ9KHMpP251bGw6KEh8fFtdKTsKaWYoIVUpe3JldHVybiBwO31lbHNle2lmKFUubmF2aWdhdG9yKXtVPVUuZG9jdW1lbnQ7fWVsc2V7aWYoIVUubm9kZVR5cGUpe3JldHVybiBwO319fXZhciBGLE8sVj10aGlzLnVuaXF1ZXM9e30sST0hIShIJiZILmxlbmd0aCkseT0oVS5ub2RlVHlwZT09OSk7aWYodGhpcy5kb2N1bWVudCE9PSh5P1U6VS5vd25lckRvY3VtZW50KSl7dGhpcy5zZXREb2N1bWVudChVKTsKfWlmKEkpe2ZvcihPPXAubGVuZ3RoO08tLTspe1ZbdGhpcy5nZXRVSUQocFtPXSldPXRydWU7fX1pZih0eXBlb2Ygej09InN0cmluZyIpe3ZhciByPXoubWF0Y2goZik7c2ltcGxlU2VsZWN0b3JzOmlmKHIpe3ZhciB1PXJbMV0sdj1yWzJdLEEsRTtpZighdSl7aWYodj09IioiJiZ0aGlzLmJyb2tlblN0YXJHRUJUTil7YnJlYWsgc2ltcGxlU2VsZWN0b3JzOwp9RT1VLmdldEVsZW1lbnRzQnlUYWdOYW1lKHYpO2lmKHMpe3JldHVybiBFWzBdfHxudWxsO31mb3IoTz0wO0E9RVtPKytdOyl7aWYoIShJJiZWW3RoaXMuZ2V0VUlEKEEpXSkpe3AucHVzaChBKTt9fX1lbHNle2lmKHU9PSIjIil7aWYoIXRoaXMuaXNIVE1MRG9jdW1lbnR8fCF5KXticmVhayBzaW1wbGVTZWxlY3RvcnM7Cn1BPVUuZ2V0RWxlbWVudEJ5SWQodik7aWYoIUEpe3JldHVybiBwO31pZih0aGlzLmlkR2V0c05hbWUmJkEuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS5ub2RlVmFsdWUhPXYpe2JyZWFrIHNpbXBsZVNlbGVjdG9yczt9aWYocyl7cmV0dXJuIEF8fG51bGw7fWlmKCEoSSYmVlt0aGlzLmdldFVJRChBKV0pKXtwLnB1c2goQSk7Cn19ZWxzZXtpZih1PT0iLiIpe2lmKCF0aGlzLmlzSFRNTERvY3VtZW50fHwoKCFVLmdldEVsZW1lbnRzQnlDbGFzc05hbWV8fHRoaXMuYnJva2VuR0VCQ04pJiZVLnF1ZXJ5U2VsZWN0b3JBbGwpKXticmVhayBzaW1wbGVTZWxlY3RvcnM7fWlmKFUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmIXRoaXMuYnJva2VuR0VCQ04pe0U9VS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHYpOwppZihzKXtyZXR1cm4gRVswXXx8bnVsbDt9Zm9yKE89MDtBPUVbTysrXTspe2lmKCEoSSYmVlt0aGlzLmdldFVJRChBKV0pKXtwLnB1c2goQSk7fX19ZWxzZXt2YXIgVD1uZXcgUmVnRXhwKCIoXnxcXHMpIitlLmVzY2FwZVJlZ0V4cCh2KSsiKFxcc3wkKSIpO0U9VS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpOwpmb3IoTz0wO0E9RVtPKytdOyl7Y2xhc3NOYW1lPUEuY2xhc3NOYW1lO2lmKCEoY2xhc3NOYW1lJiZULnRlc3QoY2xhc3NOYW1lKSkpe2NvbnRpbnVlO31pZihzKXtyZXR1cm4gQTt9aWYoIShJJiZWW3RoaXMuZ2V0VUlEKEEpXSkpe3AucHVzaChBKTt9fX19fX1pZihJKXt0aGlzLnNvcnQocCk7Cn1yZXR1cm4ocyk/bnVsbDpwO31xdWVyeVNlbGVjdG9yOmlmKFUucXVlcnlTZWxlY3RvckFsbCl7aWYoIXRoaXMuaXNIVE1MRG9jdW1lbnR8fGdbel18fHRoaXMuYnJva2VuTWl4ZWRDYXNlUVNBfHwodGhpcy5icm9rZW5DaGVja2VkUVNBJiZ6LmluZGV4T2YoIjpjaGVja2VkIik+LTEpfHwodGhpcy5icm9rZW5FbXB0eUF0dHJpYnV0ZVFTQSYmaC50ZXN0KHopKXx8KCF5JiZ6LmluZGV4T2YoIiwiKT4tMSl8fGUuZGlzYWJsZVFTQSl7YnJlYWsgcXVlcnlTZWxlY3RvcjsKfXZhciBTPXoseD1VO2lmKCF5KXt2YXIgQz14LmdldEF0dHJpYnV0ZSgiaWQiKSx0PSJzbGlja2lkX18iO3guc2V0QXR0cmlidXRlKCJpZCIsdCk7Uz0iIyIrdCsiICIrUztVPXgucGFyZW50Tm9kZTt9dHJ5e2lmKHMpe3JldHVybiBVLnF1ZXJ5U2VsZWN0b3IoUyl8fG51bGw7Cn1lbHNle0U9VS5xdWVyeVNlbGVjdG9yQWxsKFMpO319Y2F0Y2goUSl7Z1t6XT0xO2JyZWFrIHF1ZXJ5U2VsZWN0b3I7fWZpbmFsbHl7aWYoIXkpe2lmKEMpe3guc2V0QXR0cmlidXRlKCJpZCIsQyk7fWVsc2V7eC5yZW1vdmVBdHRyaWJ1dGUoImlkIik7fVU9eDt9fWlmKHRoaXMuc3RhclNlbGVjdHNDbG9zZWRRU0Epe2ZvcihPPTA7CkE9RVtPKytdOyl7aWYoQS5ub2RlTmFtZT4iQCImJiEoSSYmVlt0aGlzLmdldFVJRChBKV0pKXtwLnB1c2goQSk7fX19ZWxzZXtmb3IoTz0wO0E9RVtPKytdOyl7aWYoIShJJiZWW3RoaXMuZ2V0VUlEKEEpXSkpe3AucHVzaChBKTt9fX1pZihJKXt0aGlzLnNvcnQocCk7Cn1yZXR1cm4gcDt9Rj10aGlzLlNsaWNrLnBhcnNlKHopO2lmKCFGLmxlbmd0aCl7cmV0dXJuIHA7fX1lbHNle2lmKHo9PW51bGwpe3JldHVybiBwO31lbHNle2lmKHouU2xpY2spe0Y9ejt9ZWxzZXtpZih0aGlzLmNvbnRhaW5zKFUuZG9jdW1lbnRFbGVtZW50fHxVLHopKXsocCk/cC5wdXNoKHopOnA9ejsKcmV0dXJuIHA7fWVsc2V7cmV0dXJuIHA7fX19fXRoaXMucG9zTlRIPXt9O3RoaXMucG9zTlRITGFzdD17fTt0aGlzLnBvc05USFR5cGU9e307dGhpcy5wb3NOVEhUeXBlTGFzdD17fTt0aGlzLnB1c2g9KCFJJiYoc3x8KEYubGVuZ3RoPT0xJiZGLmV4cHJlc3Npb25zWzBdLmxlbmd0aD09MSkpKT90aGlzLnB1c2hBcnJheTp0aGlzLnB1c2hVSUQ7CmlmKHA9PW51bGwpe3A9W107fXZhciBNLEwsSzt2YXIgQixKLEQsYyxxLEcsVzt2YXIgTixQLG8sdyxSPUYuZXhwcmVzc2lvbnM7c2VhcmNoOmZvcihPPTA7KFA9UltPXSk7TysrKXtmb3IoTT0wOyhvPVBbTV0pO00rKyl7Qj0iY29tYmluYXRvcjoiK28uY29tYmluYXRvcjsKaWYoIXRoaXNbQl0pe2NvbnRpbnVlIHNlYXJjaDt9Sj0odGhpcy5pc1hNTERvY3VtZW50KT9vLnRhZzpvLnRhZy50b1VwcGVyQ2FzZSgpO0Q9by5pZDtjPW8uY2xhc3NMaXN0O3E9by5jbGFzc2VzO0c9by5hdHRyaWJ1dGVzO1c9by5wc2V1ZG9zO3c9KE09PT0oUC5sZW5ndGgtMSkpOwp0aGlzLmJpdFVuaXF1ZXM9e307aWYodyl7dGhpcy51bmlxdWVzPVY7dGhpcy5mb3VuZD1wO31lbHNle3RoaXMudW5pcXVlcz17fTt0aGlzLmZvdW5kPVtdO31pZihNPT09MCl7dGhpc1tCXShVLEosRCxxLEcsVyxjKTtpZihzJiZ3JiZwLmxlbmd0aCl7YnJlYWsgc2VhcmNoOwp9fWVsc2V7aWYocyYmdyl7Zm9yKEw9MCxLPU4ubGVuZ3RoO0w8SztMKyspe3RoaXNbQl0oTltMXSxKLEQscSxHLFcsYyk7aWYocC5sZW5ndGgpe2JyZWFrIHNlYXJjaDt9fX1lbHNle2ZvcihMPTAsSz1OLmxlbmd0aDtMPEs7TCsrKXt0aGlzW0JdKE5bTF0sSixELHEsRyxXLGMpOwp9fX1OPXRoaXMuZm91bmQ7fX1pZihJfHwoRi5leHByZXNzaW9ucy5sZW5ndGg+MSkpe3RoaXMuc29ydChwKTt9cmV0dXJuKHMpPyhwWzBdfHxudWxsKTpwO307ay51aWR4PTE7ay51aWRrPSJzbGljay11bmlxdWVpZCI7ay5nZXRVSURYTUw9ZnVuY3Rpb24obil7dmFyIGM9bi5nZXRBdHRyaWJ1dGUodGhpcy51aWRrKTsKaWYoIWMpe2M9dGhpcy51aWR4Kys7bi5zZXRBdHRyaWJ1dGUodGhpcy51aWRrLGMpO31yZXR1cm4gYzt9O2suZ2V0VUlESFRNTD1mdW5jdGlvbihjKXtyZXR1cm4gYy51bmlxdWVOdW1iZXJ8fChjLnVuaXF1ZU51bWJlcj10aGlzLnVpZHgrKyk7fTtrLnNvcnQ9ZnVuY3Rpb24oYyl7aWYoIXRoaXMuZG9jdW1lbnRTb3J0ZXIpe3JldHVybiBjOwp9Yy5zb3J0KHRoaXMuZG9jdW1lbnRTb3J0ZXIpO3JldHVybiBjO307ay5jYWNoZU5USD17fTtrLm1hdGNoTlRIPS9eKFsrLV0/XGQqKT8oW2Etel0rKT8oWystXVxkKyk/JC87ay5wYXJzZU5USEFyZ3VtZW50PWZ1bmN0aW9uKHEpe3ZhciBvPXEubWF0Y2godGhpcy5tYXRjaE5USCk7CmlmKCFvKXtyZXR1cm4gZmFsc2U7fXZhciBwPW9bMl18fGZhbHNlO3ZhciBuPW9bMV18fDE7aWYobj09Ii0iKXtuPS0xO312YXIgYz0rb1szXXx8MDtvPShwPT0ibiIpP3thOm4sYjpjfToocD09Im9kZCIpP3thOjIsYjoxfToocD09ImV2ZW4iKT97YToyLGI6MH06e2E6MCxiOm59OwpyZXR1cm4odGhpcy5jYWNoZU5USFtxXT1vKTt9O2suY3JlYXRlTlRIUHNldWRvPWZ1bmN0aW9uKHAsbixjLG8pe3JldHVybiBmdW5jdGlvbihzLHEpe3ZhciB1PXRoaXMuZ2V0VUlEKHMpO2lmKCF0aGlzW2NdW3VdKXt2YXIgQT1zLnBhcmVudE5vZGU7aWYoIUEpe3JldHVybiBmYWxzZTsKfXZhciByPUFbcF0sdD0xO2lmKG8pe3ZhciB6PXMubm9kZU5hbWU7ZG97aWYoci5ub2RlTmFtZSE9eil7Y29udGludWU7fXRoaXNbY11bdGhpcy5nZXRVSUQocildPXQrKzt9d2hpbGUoKHI9cltuXSkpO31lbHNle2Rve2lmKHIubm9kZVR5cGUhPTEpe2NvbnRpbnVlOwp9dGhpc1tjXVt0aGlzLmdldFVJRChyKV09dCsrO313aGlsZSgocj1yW25dKSk7fX1xPXF8fCJuIjt2YXIgdj10aGlzLmNhY2hlTlRIW3FdfHx0aGlzLnBhcnNlTlRIQXJndW1lbnQocSk7aWYoIXYpe3JldHVybiBmYWxzZTt9dmFyIHk9di5hLHg9di5iLHc9dGhpc1tjXVt1XTsKaWYoeT09MCl7cmV0dXJuIHg9PXc7fWlmKHk+MCl7aWYodzx4KXtyZXR1cm4gZmFsc2U7fX1lbHNle2lmKHg8dyl7cmV0dXJuIGZhbHNlO319cmV0dXJuKCh3LXgpJXkpPT0wO307fTtrLnB1c2hBcnJheT1mdW5jdGlvbihwLGMscixvLG4scSl7aWYodGhpcy5tYXRjaFNlbGVjdG9yKHAsYyxyLG8sbixxKSl7dGhpcy5mb3VuZC5wdXNoKHApOwp9fTtrLnB1c2hVSUQ9ZnVuY3Rpb24ocSxjLHMscCxuLHIpe3ZhciBvPXRoaXMuZ2V0VUlEKHEpO2lmKCF0aGlzLnVuaXF1ZXNbb10mJnRoaXMubWF0Y2hTZWxlY3RvcihxLGMscyxwLG4scikpe3RoaXMudW5pcXVlc1tvXT10cnVlO3RoaXMuZm91bmQucHVzaChxKTt9fTsKay5tYXRjaE5vZGU9ZnVuY3Rpb24obixvKXtpZih0aGlzLmlzSFRNTERvY3VtZW50JiZ0aGlzLm5hdGl2ZU1hdGNoZXNTZWxlY3Rvcil7dHJ5e3JldHVybiB0aGlzLm5hdGl2ZU1hdGNoZXNTZWxlY3Rvci5jYWxsKG4sby5yZXBsYWNlKC9cWyhbXj1dKyk9XHMqKFteJyJcXV0rPylccypcXS9nLCdbJDE9IiQyIl0nKSk7Cn1jYXRjaCh1KXt9fXZhciB0PXRoaXMuU2xpY2sucGFyc2Uobyk7aWYoIXQpe3JldHVybiB0cnVlO312YXIgcj10LmV4cHJlc3Npb25zLHM9MCxxO2ZvcihxPTA7KGN1cnJlbnRFeHByZXNzaW9uPXJbcV0pO3ErKyl7aWYoY3VycmVudEV4cHJlc3Npb24ubGVuZ3RoPT0xKXt2YXIgcD1jdXJyZW50RXhwcmVzc2lvblswXTsKaWYodGhpcy5tYXRjaFNlbGVjdG9yKG4sKHRoaXMuaXNYTUxEb2N1bWVudCk/cC50YWc6cC50YWcudG9VcHBlckNhc2UoKSxwLmlkLHAuY2xhc3NlcyxwLmF0dHJpYnV0ZXMscC5wc2V1ZG9zKSl7cmV0dXJuIHRydWU7fXMrKzt9fWlmKHM9PXQubGVuZ3RoKXtyZXR1cm4gZmFsc2U7Cn12YXIgYz10aGlzLnNlYXJjaCh0aGlzLmRvY3VtZW50LHQpLHY7Zm9yKHE9MDt2PWNbcSsrXTspe2lmKHY9PT1uKXtyZXR1cm4gdHJ1ZTt9fXJldHVybiBmYWxzZTt9O2subWF0Y2hQc2V1ZG89ZnVuY3Rpb24ocSxjLHApe3ZhciBuPSJwc2V1ZG86IitjO2lmKHRoaXNbbl0pe3JldHVybiB0aGlzW25dKHEscCk7Cn12YXIgbz10aGlzLmdldEF0dHJpYnV0ZShxLGMpO3JldHVybihwKT9wPT1vOiEhbzt9O2subWF0Y2hTZWxlY3Rvcj1mdW5jdGlvbihvLHYsYyxwLHEscyl7aWYodil7dmFyIHQ9KHRoaXMuaXNYTUxEb2N1bWVudCk/by5ub2RlTmFtZTpvLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCk7CmlmKHY9PSIqIil7aWYodDwiQCIpe3JldHVybiBmYWxzZTt9fWVsc2V7aWYodCE9dil7cmV0dXJuIGZhbHNlO319fWlmKGMmJm8uZ2V0QXR0cmlidXRlKCJpZCIpIT1jKXtyZXR1cm4gZmFsc2U7fXZhciByLG4sdTtpZihwKXtmb3Iocj1wLmxlbmd0aDtyLS07KXt1PXRoaXMuZ2V0QXR0cmlidXRlKG8sImNsYXNzIik7CmlmKCEodSYmcFtyXS5yZWdleHAudGVzdCh1KSkpe3JldHVybiBmYWxzZTt9fX1pZihxKXtmb3Iocj1xLmxlbmd0aDtyLS07KXtuPXFbcl07aWYobi5vcGVyYXRvcj8hbi50ZXN0KHRoaXMuZ2V0QXR0cmlidXRlKG8sbi5rZXkpKTohdGhpcy5oYXNBdHRyaWJ1dGUobyxuLmtleSkpe3JldHVybiBmYWxzZTsKfX19aWYocyl7Zm9yKHI9cy5sZW5ndGg7ci0tOyl7bj1zW3JdO2lmKCF0aGlzLm1hdGNoUHNldWRvKG8sbi5rZXksbi52YWx1ZSkpe3JldHVybiBmYWxzZTt9fX1yZXR1cm4gdHJ1ZTt9O3ZhciBqPXsiICI6ZnVuY3Rpb24ocSx3LG4scixzLHUscCl7dmFyIHQsdixvOwppZih0aGlzLmlzSFRNTERvY3VtZW50KXtnZXRCeUlkOmlmKG4pe3Y9dGhpcy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChuKTtpZigoIXYmJnEuYWxsKXx8KHRoaXMuaWRHZXRzTmFtZSYmdiYmdi5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpLm5vZGVWYWx1ZSE9bikpe289cS5hbGxbbl07CmlmKCFvKXtyZXR1cm47fWlmKCFvWzBdKXtvPVtvXTt9Zm9yKHQ9MDt2PW9bdCsrXTspe3ZhciBjPXYuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTtpZihjJiZjLm5vZGVWYWx1ZT09bil7dGhpcy5wdXNoKHYsdyxudWxsLHIscyx1KTticmVhazt9fXJldHVybjt9aWYoIXYpe2lmKHRoaXMuY29udGFpbnModGhpcy5yb290LHEpKXtyZXR1cm47Cn1lbHNle2JyZWFrIGdldEJ5SWQ7fX1lbHNle2lmKHRoaXMuZG9jdW1lbnQhPT1xJiYhdGhpcy5jb250YWlucyhxLHYpKXtyZXR1cm47fX10aGlzLnB1c2godix3LG51bGwscixzLHUpO3JldHVybjt9Z2V0QnlDbGFzczppZihyJiZxLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJiF0aGlzLmJyb2tlbkdFQkNOKXtvPXEuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShwLmpvaW4oIiAiKSk7CmlmKCEobyYmby5sZW5ndGgpKXticmVhayBnZXRCeUNsYXNzO31mb3IodD0wO3Y9b1t0KytdOyl7dGhpcy5wdXNoKHYsdyxuLG51bGwscyx1KTt9cmV0dXJuO319Z2V0QnlUYWc6e289cS5nZXRFbGVtZW50c0J5VGFnTmFtZSh3KTtpZighKG8mJm8ubGVuZ3RoKSl7YnJlYWsgZ2V0QnlUYWc7Cn1pZighdGhpcy5icm9rZW5TdGFyR0VCVE4pe3c9bnVsbDt9Zm9yKHQ9MDt2PW9bdCsrXTspe3RoaXMucHVzaCh2LHcsbixyLHMsdSk7fX19LCI+IjpmdW5jdGlvbihwLGMscixvLG4scSl7aWYoKHA9cC5maXJzdENoaWxkKSl7ZG97aWYocC5ub2RlVHlwZT09MSl7dGhpcy5wdXNoKHAsYyxyLG8sbixxKTsKfX13aGlsZSgocD1wLm5leHRTaWJsaW5nKSk7fX0sIisiOmZ1bmN0aW9uKHAsYyxyLG8sbixxKXt3aGlsZSgocD1wLm5leHRTaWJsaW5nKSl7aWYocC5ub2RlVHlwZT09MSl7dGhpcy5wdXNoKHAsYyxyLG8sbixxKTticmVhazt9fX0sIl4iOmZ1bmN0aW9uKHAsYyxyLG8sbixxKXtwPXAuZmlyc3RDaGlsZDsKaWYocCl7aWYocC5ub2RlVHlwZT09MSl7dGhpcy5wdXNoKHAsYyxyLG8sbixxKTt9ZWxzZXt0aGlzWyJjb21iaW5hdG9yOisiXShwLGMscixvLG4scSk7fX19LCJ+IjpmdW5jdGlvbihxLGMscyxwLG4scil7d2hpbGUoKHE9cS5uZXh0U2libGluZykpe2lmKHEubm9kZVR5cGUhPTEpe2NvbnRpbnVlOwp9dmFyIG89dGhpcy5nZXRVSUQocSk7aWYodGhpcy5iaXRVbmlxdWVzW29dKXticmVhazt9dGhpcy5iaXRVbmlxdWVzW29dPXRydWU7dGhpcy5wdXNoKHEsYyxzLHAsbixyKTt9fSwiKysiOmZ1bmN0aW9uKHAsYyxyLG8sbixxKXt0aGlzWyJjb21iaW5hdG9yOisiXShwLGMscixvLG4scSk7CnRoaXNbImNvbWJpbmF0b3I6ISsiXShwLGMscixvLG4scSk7fSwifn4iOmZ1bmN0aW9uKHAsYyxyLG8sbixxKXt0aGlzWyJjb21iaW5hdG9yOn4iXShwLGMscixvLG4scSk7dGhpc1siY29tYmluYXRvcjohfiJdKHAsYyxyLG8sbixxKTt9LCIhIjpmdW5jdGlvbihwLGMscixvLG4scSl7d2hpbGUoKHA9cC5wYXJlbnROb2RlKSl7aWYocCE9PXRoaXMuZG9jdW1lbnQpe3RoaXMucHVzaChwLGMscixvLG4scSk7Cn19fSwiIT4iOmZ1bmN0aW9uKHAsYyxyLG8sbixxKXtwPXAucGFyZW50Tm9kZTtpZihwIT09dGhpcy5kb2N1bWVudCl7dGhpcy5wdXNoKHAsYyxyLG8sbixxKTt9fSwiISsiOmZ1bmN0aW9uKHAsYyxyLG8sbixxKXt3aGlsZSgocD1wLnByZXZpb3VzU2libGluZykpe2lmKHAubm9kZVR5cGU9PTEpe3RoaXMucHVzaChwLGMscixvLG4scSk7CmJyZWFrO319fSwiIV4iOmZ1bmN0aW9uKHAsYyxyLG8sbixxKXtwPXAubGFzdENoaWxkO2lmKHApe2lmKHAubm9kZVR5cGU9PTEpe3RoaXMucHVzaChwLGMscixvLG4scSk7fWVsc2V7dGhpc1siY29tYmluYXRvcjohKyJdKHAsYyxyLG8sbixxKTt9fX0sIiF+IjpmdW5jdGlvbihxLGMscyxwLG4scil7d2hpbGUoKHE9cS5wcmV2aW91c1NpYmxpbmcpKXtpZihxLm5vZGVUeXBlIT0xKXtjb250aW51ZTsKfXZhciBvPXRoaXMuZ2V0VUlEKHEpO2lmKHRoaXMuYml0VW5pcXVlc1tvXSl7YnJlYWs7fXRoaXMuYml0VW5pcXVlc1tvXT10cnVlO3RoaXMucHVzaChxLGMscyxwLG4scik7fX19O2Zvcih2YXIgaSBpbiBqKXtrWyJjb21iaW5hdG9yOiIraV09altpXTt9dmFyIGw9e2VtcHR5OmZ1bmN0aW9uKGMpe3ZhciBuPWMuZmlyc3RDaGlsZDsKcmV0dXJuICEobiYmbi5ub2RlVHlwZT09MSkmJiEoYy5pbm5lclRleHR8fGMudGV4dENvbnRlbnR8fCIiKS5sZW5ndGg7fSxub3Q6ZnVuY3Rpb24oYyxuKXtyZXR1cm4gIXRoaXMubWF0Y2hOb2RlKGMsbik7fSxjb250YWluczpmdW5jdGlvbihjLG4pe3JldHVybihjLmlubmVyVGV4dHx8Yy50ZXh0Q29udGVudHx8IiIpLmluZGV4T2Yobik+LTE7Cn0sImZpcnN0LWNoaWxkIjpmdW5jdGlvbihjKXt3aGlsZSgoYz1jLnByZXZpb3VzU2libGluZykpe2lmKGMubm9kZVR5cGU9PTEpe3JldHVybiBmYWxzZTt9fXJldHVybiB0cnVlO30sImxhc3QtY2hpbGQiOmZ1bmN0aW9uKGMpe3doaWxlKChjPWMubmV4dFNpYmxpbmcpKXtpZihjLm5vZGVUeXBlPT0xKXtyZXR1cm4gZmFsc2U7Cn19cmV0dXJuIHRydWU7fSwib25seS1jaGlsZCI6ZnVuY3Rpb24obyl7dmFyIG49bzt3aGlsZSgobj1uLnByZXZpb3VzU2libGluZykpe2lmKG4ubm9kZVR5cGU9PTEpe3JldHVybiBmYWxzZTt9fXZhciBjPW87d2hpbGUoKGM9Yy5uZXh0U2libGluZykpe2lmKGMubm9kZVR5cGU9PTEpe3JldHVybiBmYWxzZTsKfX1yZXR1cm4gdHJ1ZTt9LCJudGgtY2hpbGQiOmsuY3JlYXRlTlRIUHNldWRvKCJmaXJzdENoaWxkIiwibmV4dFNpYmxpbmciLCJwb3NOVEgiKSwibnRoLWxhc3QtY2hpbGQiOmsuY3JlYXRlTlRIUHNldWRvKCJsYXN0Q2hpbGQiLCJwcmV2aW91c1NpYmxpbmciLCJwb3NOVEhMYXN0IiksIm50aC1vZi10eXBlIjprLmNyZWF0ZU5USFBzZXVkbygiZmlyc3RDaGlsZCIsIm5leHRTaWJsaW5nIiwicG9zTlRIVHlwZSIsdHJ1ZSksIm50aC1sYXN0LW9mLXR5cGUiOmsuY3JlYXRlTlRIUHNldWRvKCJsYXN0Q2hpbGQiLCJwcmV2aW91c1NpYmxpbmciLCJwb3NOVEhUeXBlTGFzdCIsdHJ1ZSksaW5kZXg6ZnVuY3Rpb24obixjKXtyZXR1cm4gdGhpc1sicHNldWRvOm50aC1jaGlsZCJdKG4sIiIrKGMrMSkpOwp9LGV2ZW46ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXNbInBzZXVkbzpudGgtY2hpbGQiXShjLCIybiIpO30sb2RkOmZ1bmN0aW9uKGMpe3JldHVybiB0aGlzWyJwc2V1ZG86bnRoLWNoaWxkIl0oYywiMm4rMSIpO30sImZpcnN0LW9mLXR5cGUiOmZ1bmN0aW9uKGMpe3ZhciBuPWMubm9kZU5hbWU7CndoaWxlKChjPWMucHJldmlvdXNTaWJsaW5nKSl7aWYoYy5ub2RlTmFtZT09bil7cmV0dXJuIGZhbHNlO319cmV0dXJuIHRydWU7fSwibGFzdC1vZi10eXBlIjpmdW5jdGlvbihjKXt2YXIgbj1jLm5vZGVOYW1lO3doaWxlKChjPWMubmV4dFNpYmxpbmcpKXtpZihjLm5vZGVOYW1lPT1uKXtyZXR1cm4gZmFsc2U7Cn19cmV0dXJuIHRydWU7fSwib25seS1vZi10eXBlIjpmdW5jdGlvbihvKXt2YXIgbj1vLHA9by5ub2RlTmFtZTt3aGlsZSgobj1uLnByZXZpb3VzU2libGluZykpe2lmKG4ubm9kZU5hbWU9PXApe3JldHVybiBmYWxzZTt9fXZhciBjPW87d2hpbGUoKGM9Yy5uZXh0U2libGluZykpe2lmKGMubm9kZU5hbWU9PXApe3JldHVybiBmYWxzZTsKfX1yZXR1cm4gdHJ1ZTt9LGVuYWJsZWQ6ZnVuY3Rpb24oYyl7cmV0dXJuICFjLmRpc2FibGVkO30sZGlzYWJsZWQ6ZnVuY3Rpb24oYyl7cmV0dXJuIGMuZGlzYWJsZWQ7fSxjaGVja2VkOmZ1bmN0aW9uKGMpe3JldHVybiBjLmNoZWNrZWR8fGMuc2VsZWN0ZWQ7fSxmb2N1czpmdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5pc0hUTUxEb2N1bWVudCYmdGhpcy5kb2N1bWVudC5hY3RpdmVFbGVtZW50PT09YyYmKGMuaHJlZnx8Yy50eXBlfHx0aGlzLmhhc0F0dHJpYnV0ZShjLCJ0YWJpbmRleCIpKTsKfSxyb290OmZ1bmN0aW9uKGMpe3JldHVybihjPT09dGhpcy5yb290KTt9LHNlbGVjdGVkOmZ1bmN0aW9uKGMpe3JldHVybiBjLnNlbGVjdGVkO319O2Zvcih2YXIgYiBpbiBsKXtrWyJwc2V1ZG86IitiXT1sW2JdO312YXIgYT1rLmF0dHJpYnV0ZUdldHRlcnM9eyJmb3IiOmZ1bmN0aW9uKCl7cmV0dXJuKCJodG1sRm9yIiBpbiB0aGlzKT90aGlzLmh0bWxGb3I6dGhpcy5nZXRBdHRyaWJ1dGUoImZvciIpOwp9LGhyZWY6ZnVuY3Rpb24oKXtyZXR1cm4oImhyZWYiIGluIHRoaXMpP3RoaXMuZ2V0QXR0cmlidXRlKCJocmVmIiwyKTp0aGlzLmdldEF0dHJpYnV0ZSgiaHJlZiIpO30sc3R5bGU6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5zdHlsZSk/dGhpcy5zdHlsZS5jc3NUZXh0OnRoaXMuZ2V0QXR0cmlidXRlKCJzdHlsZSIpOwp9LHRhYmluZGV4OmZ1bmN0aW9uKCl7dmFyIGM9dGhpcy5nZXRBdHRyaWJ1dGVOb2RlKCJ0YWJpbmRleCIpO3JldHVybihjJiZjLnNwZWNpZmllZCk/Yy5ub2RlVmFsdWU6bnVsbDt9LHR5cGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoInR5cGUiKTsKfSxtYXhsZW5ndGg6ZnVuY3Rpb24oKXt2YXIgYz10aGlzLmdldEF0dHJpYnV0ZU5vZGUoIm1heExlbmd0aCIpO3JldHVybihjJiZjLnNwZWNpZmllZCk/Yy5ub2RlVmFsdWU6bnVsbDt9fTthLk1BWExFTkdUSD1hLm1heExlbmd0aD1hLm1heGxlbmd0aDt2YXIgZT1rLlNsaWNrPSh0aGlzLlNsaWNrfHx7fSk7CmUudmVyc2lvbj0iMS4xLjciO2Uuc2VhcmNoPWZ1bmN0aW9uKG4sbyxjKXtyZXR1cm4gay5zZWFyY2gobixvLGMpO307ZS5maW5kPWZ1bmN0aW9uKGMsbil7cmV0dXJuIGsuc2VhcmNoKGMsbixudWxsLHRydWUpO307ZS5jb250YWlucz1mdW5jdGlvbihjLG4pe2suc2V0RG9jdW1lbnQoYyk7CnJldHVybiBrLmNvbnRhaW5zKGMsbik7fTtlLmdldEF0dHJpYnV0ZT1mdW5jdGlvbihuLGMpe2suc2V0RG9jdW1lbnQobik7cmV0dXJuIGsuZ2V0QXR0cmlidXRlKG4sYyk7fTtlLmhhc0F0dHJpYnV0ZT1mdW5jdGlvbihuLGMpe2suc2V0RG9jdW1lbnQobik7cmV0dXJuIGsuaGFzQXR0cmlidXRlKG4sYyk7Cn07ZS5tYXRjaD1mdW5jdGlvbihuLGMpe2lmKCEobiYmYykpe3JldHVybiBmYWxzZTt9aWYoIWN8fGM9PT1uKXtyZXR1cm4gdHJ1ZTt9ay5zZXREb2N1bWVudChuKTtyZXR1cm4gay5tYXRjaE5vZGUobixjKTt9O2UuZGVmaW5lQXR0cmlidXRlR2V0dGVyPWZ1bmN0aW9uKGMsbil7ay5hdHRyaWJ1dGVHZXR0ZXJzW2NdPW47CnJldHVybiB0aGlzO307ZS5sb29rdXBBdHRyaWJ1dGVHZXR0ZXI9ZnVuY3Rpb24oYyl7cmV0dXJuIGsuYXR0cmlidXRlR2V0dGVyc1tjXTt9O2UuZGVmaW5lUHNldWRvPWZ1bmN0aW9uKGMsbil7a1sicHNldWRvOiIrY109ZnVuY3Rpb24ocCxvKXtyZXR1cm4gbi5jYWxsKHAsbyk7Cn07cmV0dXJuIHRoaXM7fTtlLmxvb2t1cFBzZXVkbz1mdW5jdGlvbihjKXt2YXIgbj1rWyJwc2V1ZG86IitjXTtpZihuKXtyZXR1cm4gZnVuY3Rpb24obyl7cmV0dXJuIG4uY2FsbCh0aGlzLG8pO307fXJldHVybiBudWxsO307ZS5vdmVycmlkZT1mdW5jdGlvbihuLGMpe2sub3ZlcnJpZGUobixjKTsKcmV0dXJuIHRoaXM7fTtlLmlzWE1MPWsuaXNYTUw7ZS51aWRPZj1mdW5jdGlvbihjKXtyZXR1cm4gay5nZXRVSURIVE1MKGMpO307aWYoIXRoaXMuU2xpY2spe3RoaXMuU2xpY2s9ZTt9fSkuYXBwbHkoKHR5cGVvZiBleHBvcnRzIT0idW5kZWZpbmVkIik/ZXhwb3J0czp0aGlzKTsKdmFyIEVsZW1lbnQ9ZnVuY3Rpb24oYixnKXt2YXIgaD1FbGVtZW50LkNvbnN0cnVjdG9yc1tiXTtpZihoKXtyZXR1cm4gaChnKTt9aWYodHlwZW9mIGIhPSJzdHJpbmciKXtyZXR1cm4gZG9jdW1lbnQuaWQoYikuc2V0KGcpO31pZighZyl7Zz17fTt9aWYoISgvXltcdy1dKyQvKS50ZXN0KGIpKXt2YXIgZT1TbGljay5wYXJzZShiKS5leHByZXNzaW9uc1swXVswXTsKYj0oZS50YWc9PSIqIik/ImRpdiI6ZS50YWc7aWYoZS5pZCYmZy5pZD09bnVsbCl7Zy5pZD1lLmlkO312YXIgZD1lLmF0dHJpYnV0ZXM7aWYoZCl7Zm9yKHZhciBhLGY9MCxjPWQubGVuZ3RoO2Y8YztmKyspe2E9ZFtmXTtpZihnW2Eua2V5XSE9bnVsbCl7Y29udGludWU7Cn1pZihhLnZhbHVlIT1udWxsJiZhLm9wZXJhdG9yPT0iPSIpe2dbYS5rZXldPWEudmFsdWU7fWVsc2V7aWYoIWEudmFsdWUmJiFhLm9wZXJhdG9yKXtnW2Eua2V5XT10cnVlO319fX1pZihlLmNsYXNzTGlzdCYmZ1siY2xhc3MiXT09bnVsbCl7Z1siY2xhc3MiXT1lLmNsYXNzTGlzdC5qb2luKCIgIik7Cn19cmV0dXJuIGRvY3VtZW50Lm5ld0VsZW1lbnQoYixnKTt9O2lmKEJyb3dzZXIuRWxlbWVudCl7RWxlbWVudC5wcm90b3R5cGU9QnJvd3Nlci5FbGVtZW50LnByb3RvdHlwZTtFbGVtZW50LnByb3RvdHlwZS5fZmlyZUV2ZW50PShmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixjKXtyZXR1cm4gYS5jYWxsKHRoaXMsYixjKTsKfTt9KShFbGVtZW50LnByb3RvdHlwZS5maXJlRXZlbnQpO31uZXcgVHlwZSgiRWxlbWVudCIsRWxlbWVudCkubWlycm9yKGZ1bmN0aW9uKGEpe2lmKEFycmF5LnByb3RvdHlwZVthXSl7cmV0dXJuO312YXIgYj17fTtiW2FdPWZ1bmN0aW9uKCl7dmFyIGg9W10sZT1hcmd1bWVudHMsaj10cnVlOwpmb3IodmFyIGc9MCxkPXRoaXMubGVuZ3RoO2c8ZDtnKyspe3ZhciBmPXRoaXNbZ10sYz1oW2ddPWZbYV0uYXBwbHkoZixlKTtqPShqJiZ0eXBlT2YoYyk9PSJlbGVtZW50Iik7fXJldHVybihqKT9uZXcgRWxlbWVudHMoaCk6aDt9O0VsZW1lbnRzLmltcGxlbWVudChiKTsKfSk7aWYoIUJyb3dzZXIuRWxlbWVudCl7RWxlbWVudC5wYXJlbnQ9T2JqZWN0O0VsZW1lbnQuUHJvdG90eXBlPXsiJGNvbnN0cnVjdG9yIjpFbGVtZW50LCIkZmFtaWx5IjpGdW5jdGlvbi5mcm9tKCJlbGVtZW50IikuaGlkZSgpfTtFbGVtZW50Lm1pcnJvcihmdW5jdGlvbihhLGIpe0VsZW1lbnQuUHJvdG90eXBlW2FdPWI7Cn0pO31FbGVtZW50LkNvbnN0cnVjdG9ycz17fTt2YXIgSUZyYW1lPW5ldyBUeXBlKCJJRnJhbWUiLGZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkubGluayhhcmd1bWVudHMse3Byb3BlcnRpZXM6VHlwZS5pc09iamVjdCxpZnJhbWU6ZnVuY3Rpb24oZil7cmV0dXJuKGYhPW51bGwpOwp9fSk7dmFyIGM9ZS5wcm9wZXJ0aWVzfHx7fSxiO2lmKGUuaWZyYW1lKXtiPWRvY3VtZW50LmlkKGUuaWZyYW1lKTt9dmFyIGQ9Yy5vbmxvYWR8fGZ1bmN0aW9uKCl7fTtkZWxldGUgYy5vbmxvYWQ7Yy5pZD1jLm5hbWU9W2MuaWQsYy5uYW1lLGI/KGIuaWR8fGIubmFtZSk6IklGcmFtZV8iK1N0cmluZy51bmlxdWVJRCgpXS5waWNrKCk7CmI9bmV3IEVsZW1lbnQoYnx8ImlmcmFtZSIsYyk7dmFyIGE9ZnVuY3Rpb24oKXtkLmNhbGwoYi5jb250ZW50V2luZG93KTt9O2lmKHdpbmRvdy5mcmFtZXNbYy5pZF0pe2EoKTt9ZWxzZXtiLmFkZExpc3RlbmVyKCJsb2FkIixhKTt9cmV0dXJuIGI7fSk7dmFyIEVsZW1lbnRzPXRoaXMuRWxlbWVudHM9ZnVuY3Rpb24oYSl7aWYoYSYmYS5sZW5ndGgpe3ZhciBlPXt9LGQ7CmZvcih2YXIgYz0wO2Q9YVtjKytdOyl7dmFyIGI9U2xpY2sudWlkT2YoZCk7aWYoIWVbYl0pe2VbYl09dHJ1ZTt0aGlzLnB1c2goZCk7fX19fTtFbGVtZW50cy5wcm90b3R5cGU9e2xlbmd0aDowfTtFbGVtZW50cy5wYXJlbnQ9QXJyYXk7bmV3IFR5cGUoIkVsZW1lbnRzIixFbGVtZW50cykuaW1wbGVtZW50KHtmaWx0ZXI6ZnVuY3Rpb24oYSxiKXtpZighYSl7cmV0dXJuIHRoaXM7Cn1yZXR1cm4gbmV3IEVsZW1lbnRzKEFycmF5LmZpbHRlcih0aGlzLCh0eXBlT2YoYSk9PSJzdHJpbmciKT9mdW5jdGlvbihjKXtyZXR1cm4gYy5tYXRjaChhKTt9OmEsYikpO30ucHJvdGVjdCgpLHB1c2g6ZnVuY3Rpb24oKXt2YXIgZD10aGlzLmxlbmd0aDtmb3IodmFyIGI9MCxhPWFyZ3VtZW50cy5sZW5ndGg7CmI8YTtiKyspe3ZhciBjPWRvY3VtZW50LmlkKGFyZ3VtZW50c1tiXSk7aWYoYyl7dGhpc1tkKytdPWM7fX1yZXR1cm4odGhpcy5sZW5ndGg9ZCk7fS5wcm90ZWN0KCksdW5zaGlmdDpmdW5jdGlvbigpe3ZhciBiPVtdO2Zvcih2YXIgYz0wLGE9YXJndW1lbnRzLmxlbmd0aDsKYzxhO2MrKyl7dmFyIGQ9ZG9jdW1lbnQuaWQoYXJndW1lbnRzW2NdKTtpZihkKXtiLnB1c2goZCk7fX1yZXR1cm4gQXJyYXkucHJvdG90eXBlLnVuc2hpZnQuYXBwbHkodGhpcyxiKTt9LnByb3RlY3QoKSxjb25jYXQ6ZnVuY3Rpb24oKXt2YXIgYj1uZXcgRWxlbWVudHModGhpcyk7CmZvcih2YXIgYz0wLGE9YXJndW1lbnRzLmxlbmd0aDtjPGE7YysrKXt2YXIgZD1hcmd1bWVudHNbY107aWYoVHlwZS5pc0VudW1lcmFibGUoZCkpe2IuYXBwZW5kKGQpO31lbHNle2IucHVzaChkKTt9fXJldHVybiBiO30ucHJvdGVjdCgpLGFwcGVuZDpmdW5jdGlvbihjKXtmb3IodmFyIGI9MCxhPWMubGVuZ3RoOwpiPGE7YisrKXt0aGlzLnB1c2goY1tiXSk7fXJldHVybiB0aGlzO30ucHJvdGVjdCgpLGVtcHR5OmZ1bmN0aW9uKCl7d2hpbGUodGhpcy5sZW5ndGgpe2RlbGV0ZSB0aGlzWy0tdGhpcy5sZW5ndGhdO31yZXR1cm4gdGhpczt9LnByb3RlY3QoKX0pOyhmdW5jdGlvbigpe3ZhciBmPUFycmF5LnByb3RvdHlwZS5zcGxpY2UsYT17IjAiOjAsIjEiOjEsbGVuZ3RoOjJ9OwpmLmNhbGwoYSwxLDEpO2lmKGFbMV09PTEpe0VsZW1lbnRzLmltcGxlbWVudCgic3BsaWNlIixmdW5jdGlvbigpe3ZhciBnPXRoaXMubGVuZ3RoO3ZhciBlPWYuYXBwbHkodGhpcyxhcmd1bWVudHMpO3doaWxlKGc+PXRoaXMubGVuZ3RoKXtkZWxldGUgdGhpc1tnLS1dOwp9cmV0dXJuIGU7fS5wcm90ZWN0KCkpO31BcnJheS5mb3JFYWNoTWV0aG9kKGZ1bmN0aW9uKGcsZSl7RWxlbWVudHMuaW1wbGVtZW50KGUsZyk7fSk7QXJyYXkubWlycm9yKEVsZW1lbnRzKTt2YXIgZDt0cnl7ZD0oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiPGlucHV0IG5hbWU9eD4iKS5uYW1lPT0ieCIpOwp9Y2F0Y2goYil7fXZhciBjPWZ1bmN0aW9uKGUpe3JldHVybigiIitlKS5yZXBsYWNlKC8mL2csIiZhbXA7IikucmVwbGFjZSgvIi9nLCImcXVvdDsiKTt9O0RvY3VtZW50LmltcGxlbWVudCh7bmV3RWxlbWVudDpmdW5jdGlvbihlLGcpe2lmKGcmJmcuY2hlY2tlZCE9bnVsbCl7Zy5kZWZhdWx0Q2hlY2tlZD1nLmNoZWNrZWQ7Cn1pZihkJiZnKXtlPSI8IitlO2lmKGcubmFtZSl7ZSs9JyBuYW1lPSInK2MoZy5uYW1lKSsnIic7fWlmKGcudHlwZSl7ZSs9JyB0eXBlPSInK2MoZy50eXBlKSsnIic7fWUrPSI+IjtkZWxldGUgZy5uYW1lO2RlbGV0ZSBnLnR5cGU7fXJldHVybiB0aGlzLmlkKHRoaXMuY3JlYXRlRWxlbWVudChlKSkuc2V0KGcpOwp9fSk7fSkoKTsoZnVuY3Rpb24oKXtTbGljay51aWRPZih3aW5kb3cpO1NsaWNrLnVpZE9mKGRvY3VtZW50KTtEb2N1bWVudC5pbXBsZW1lbnQoe25ld1RleHROb2RlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmNyZWF0ZVRleHROb2RlKGUpO30sZ2V0RG9jdW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpczsKfSxnZXRXaW5kb3c6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53aW5kb3c7fSxpZDooZnVuY3Rpb24oKXt2YXIgZT17c3RyaW5nOmZ1bmN0aW9uKEUsRCxsKXtFPVNsaWNrLmZpbmQobCwiIyIrRS5yZXBsYWNlKC8oXFcpL2csIlxcJDEiKSk7cmV0dXJuKEUpP2UuZWxlbWVudChFLEQpOm51bGw7Cn0sZWxlbWVudDpmdW5jdGlvbihELEUpe1NsaWNrLnVpZE9mKEQpO2lmKCFFJiYhRC4kZmFtaWx5JiYhKC9eKD86b2JqZWN0fGVtYmVkKSQvaSkudGVzdChELnRhZ05hbWUpKXt2YXIgbD1ELmZpcmVFdmVudDtELl9maXJlRXZlbnQ9ZnVuY3Rpb24oRixHKXtyZXR1cm4gbChGLEcpOwp9O09iamVjdC5hcHBlbmQoRCxFbGVtZW50LlByb3RvdHlwZSk7fXJldHVybiBEO30sb2JqZWN0OmZ1bmN0aW9uKEQsRSxsKXtpZihELnRvRWxlbWVudCl7cmV0dXJuIGUuZWxlbWVudChELnRvRWxlbWVudChsKSxFKTt9cmV0dXJuIG51bGw7fX07ZS50ZXh0bm9kZT1lLndoaXRlc3BhY2U9ZS53aW5kb3c9ZS5kb2N1bWVudD1mdW5jdGlvbihsKXtyZXR1cm4gbDsKfTtyZXR1cm4gZnVuY3Rpb24oRCxGLEUpe2lmKEQmJkQuJGZhbWlseSYmRC51bmlxdWVOdW1iZXIpe3JldHVybiBEO312YXIgbD10eXBlT2YoRCk7cmV0dXJuKGVbbF0pP2VbbF0oRCxGLEV8fGRvY3VtZW50KTpudWxsO307fSkoKX0pO2lmKHdpbmRvdy4kPT1udWxsKXtXaW5kb3cuaW1wbGVtZW50KCIkIixmdW5jdGlvbihlLGwpe3JldHVybiBkb2N1bWVudC5pZChlLGwsdGhpcy5kb2N1bWVudCk7Cn0pO31XaW5kb3cuaW1wbGVtZW50KHtnZXREb2N1bWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvY3VtZW50O30sZ2V0V2luZG93OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7fX0pO1tEb2N1bWVudCxFbGVtZW50XS5pbnZva2UoImltcGxlbWVudCIse2dldEVsZW1lbnRzOmZ1bmN0aW9uKGUpe3JldHVybiBTbGljay5zZWFyY2godGhpcyxlLG5ldyBFbGVtZW50cyk7Cn0sZ2V0RWxlbWVudDpmdW5jdGlvbihlKXtyZXR1cm4gZG9jdW1lbnQuaWQoU2xpY2suZmluZCh0aGlzLGUpKTt9fSk7dmFyIG09e2NvbnRhaW5zOmZ1bmN0aW9uKGUpe3JldHVybiBTbGljay5jb250YWlucyh0aGlzLGUpO319O2lmKCFkb2N1bWVudC5jb250YWlucyl7RG9jdW1lbnQuaW1wbGVtZW50KG0pOwp9aWYoIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLmNvbnRhaW5zKXtFbGVtZW50LmltcGxlbWVudChtKTt9dmFyIHI9ZnVuY3Rpb24oRSxEKXtpZighRSl7cmV0dXJuIEQ7fUU9T2JqZWN0LmNsb25lKFNsaWNrLnBhcnNlKEUpKTt2YXIgbD1FLmV4cHJlc3Npb25zOwpmb3IodmFyIGU9bC5sZW5ndGg7ZS0tOyl7bFtlXVswXS5jb21iaW5hdG9yPUQ7fXJldHVybiBFO307T2JqZWN0LmZvckVhY2goe2dldE5leHQ6In4iLGdldFByZXZpb3VzOiIhfiIsZ2V0UGFyZW50OiIhIn0sZnVuY3Rpb24oZSxsKXtFbGVtZW50LmltcGxlbWVudChsLGZ1bmN0aW9uKEQpe3JldHVybiB0aGlzLmdldEVsZW1lbnQocihELGUpKTsKfSk7fSk7T2JqZWN0LmZvckVhY2goe2dldEFsbE5leHQ6In4iLGdldEFsbFByZXZpb3VzOiIhfiIsZ2V0U2libGluZ3M6In5+IixnZXRDaGlsZHJlbjoiPiIsZ2V0UGFyZW50czoiISJ9LGZ1bmN0aW9uKGUsbCl7RWxlbWVudC5pbXBsZW1lbnQobCxmdW5jdGlvbihEKXtyZXR1cm4gdGhpcy5nZXRFbGVtZW50cyhyKEQsZSkpOwp9KTt9KTtFbGVtZW50LmltcGxlbWVudCh7Z2V0Rmlyc3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIGRvY3VtZW50LmlkKFNsaWNrLnNlYXJjaCh0aGlzLHIoZSwiPiIpKVswXSk7fSxnZXRMYXN0OmZ1bmN0aW9uKGUpe3JldHVybiBkb2N1bWVudC5pZChTbGljay5zZWFyY2godGhpcyxyKGUsIj4iKSkuZ2V0TGFzdCgpKTsKfSxnZXRXaW5kb3c6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vd25lckRvY3VtZW50LndpbmRvdzt9LGdldERvY3VtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3duZXJEb2N1bWVudDt9LGdldEVsZW1lbnRCeUlkOmZ1bmN0aW9uKGUpe3JldHVybiBkb2N1bWVudC5pZChTbGljay5maW5kKHRoaXMsIiMiKygiIitlKS5yZXBsYWNlKC8oXFcpL2csIlxcJDEiKSkpOwp9LG1hdGNoOmZ1bmN0aW9uKGUpe3JldHVybiAhZXx8U2xpY2subWF0Y2godGhpcyxlKTt9fSk7aWYod2luZG93LiQkPT1udWxsKXtXaW5kb3cuaW1wbGVtZW50KCIkJCIsZnVuY3Rpb24oZSl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7aWYodHlwZW9mIGU9PSJzdHJpbmciKXtyZXR1cm4gU2xpY2suc2VhcmNoKHRoaXMuZG9jdW1lbnQsZSxuZXcgRWxlbWVudHMpOwp9ZWxzZXtpZihUeXBlLmlzRW51bWVyYWJsZShlKSl7cmV0dXJuIG5ldyBFbGVtZW50cyhlKTt9fX1yZXR1cm4gbmV3IEVsZW1lbnRzKGFyZ3VtZW50cyk7fSk7fXZhciB3PXtiZWZvcmU6ZnVuY3Rpb24obCxlKXt2YXIgRD1lLnBhcmVudE5vZGU7aWYoRCl7RC5pbnNlcnRCZWZvcmUobCxlKTsKfX0sYWZ0ZXI6ZnVuY3Rpb24obCxlKXt2YXIgRD1lLnBhcmVudE5vZGU7aWYoRCl7RC5pbnNlcnRCZWZvcmUobCxlLm5leHRTaWJsaW5nKTt9fSxib3R0b206ZnVuY3Rpb24obCxlKXtlLmFwcGVuZENoaWxkKGwpO30sdG9wOmZ1bmN0aW9uKGwsZSl7ZS5pbnNlcnRCZWZvcmUobCxlLmZpcnN0Q2hpbGQpOwp9fTt3Lmluc2lkZT13LmJvdHRvbTt2YXIgaj17fSxkPXt9O3ZhciBrPXt9O0FycmF5LmZvckVhY2goWyJ0eXBlIiwidmFsdWUiLCJkZWZhdWx0VmFsdWUiLCJhY2Nlc3NLZXkiLCJjZWxsUGFkZGluZyIsImNlbGxTcGFjaW5nIiwiY29sU3BhbiIsImZyYW1lQm9yZGVyIiwicm93U3BhbiIsInRhYkluZGV4IiwidXNlTWFwIl0sZnVuY3Rpb24oZSl7a1tlLnRvTG93ZXJDYXNlKCldPWU7Cn0pO2suaHRtbD0iaW5uZXJIVE1MIjtrLnRleHQ9KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLnRleHRDb250ZW50PT1udWxsKT8iaW5uZXJUZXh0IjoidGV4dENvbnRlbnQiO09iamVjdC5mb3JFYWNoKGssZnVuY3Rpb24obCxlKXtkW2VdPWZ1bmN0aW9uKEQsRSl7RFtsXT1FOwp9O2pbZV09ZnVuY3Rpb24oRCl7cmV0dXJuIERbbF07fTt9KTt2YXIgeD1bImNvbXBhY3QiLCJub3dyYXAiLCJpc21hcCIsImRlY2xhcmUiLCJub3NoYWRlIiwiY2hlY2tlZCIsImRpc2FibGVkIiwicmVhZE9ubHkiLCJtdWx0aXBsZSIsInNlbGVjdGVkIiwibm9yZXNpemUiLCJkZWZlciIsImRlZmF1bHRDaGVja2VkIiwiYXV0b2ZvY3VzIiwiY29udHJvbHMiLCJhdXRvcGxheSIsImxvb3AiXTsKdmFyIGg9e307QXJyYXkuZm9yRWFjaCh4LGZ1bmN0aW9uKGUpe3ZhciBsPWUudG9Mb3dlckNhc2UoKTtoW2xdPWU7ZFtsXT1mdW5jdGlvbihELEUpe0RbZV09ISFFO307altsXT1mdW5jdGlvbihEKXtyZXR1cm4gISFEW2VdO307fSk7T2JqZWN0LmFwcGVuZChkLHsiY2xhc3MiOmZ1bmN0aW9uKGUsbCl7KCJjbGFzc05hbWUiIGluIGUpP2UuY2xhc3NOYW1lPShsfHwiIik6ZS5zZXRBdHRyaWJ1dGUoImNsYXNzIixsKTsKfSwiZm9yIjpmdW5jdGlvbihlLGwpeygiaHRtbEZvciIgaW4gZSk/ZS5odG1sRm9yPWw6ZS5zZXRBdHRyaWJ1dGUoImZvciIsbCk7fSxzdHlsZTpmdW5jdGlvbihlLGwpeyhlLnN0eWxlKT9lLnN0eWxlLmNzc1RleHQ9bDplLnNldEF0dHJpYnV0ZSgic3R5bGUiLGwpOwp9LHZhbHVlOmZ1bmN0aW9uKGUsbCl7ZS52YWx1ZT0obCE9bnVsbCk/bDoiIjt9fSk7alsiY2xhc3MiXT1mdW5jdGlvbihlKXtyZXR1cm4oImNsYXNzTmFtZSIgaW4gZSk/ZS5jbGFzc05hbWV8fG51bGw6ZS5nZXRBdHRyaWJ1dGUoImNsYXNzIik7fTt2YXIgZj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKdHJ5e2YudHlwZT0iYnV0dG9uIjt9Y2F0Y2goeil7fWlmKGYudHlwZSE9ImJ1dHRvbiIpe2QudHlwZT1mdW5jdGlvbihlLGwpe2Uuc2V0QXR0cmlidXRlKCJ0eXBlIixsKTt9O31mPW51bGw7dmFyIHA9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTtwLnZhbHVlPSJ0IjsKcC50eXBlPSJzdWJtaXQiO2lmKHAudmFsdWUhPSJ0Iil7ZC50eXBlPWZ1bmN0aW9uKGwsZSl7dmFyIEQ9bC52YWx1ZTtsLnR5cGU9ZTtsLnZhbHVlPUQ7fTt9cD1udWxsO3ZhciBxPShmdW5jdGlvbihlKXtlLnJhbmRvbT0iYXR0cmlidXRlIjtyZXR1cm4oZS5nZXRBdHRyaWJ1dGUoInJhbmRvbSIpPT0iYXR0cmlidXRlIik7Cn0pKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpKTtFbGVtZW50LmltcGxlbWVudCh7c2V0UHJvcGVydHk6ZnVuY3Rpb24obCxEKXt2YXIgRT1kW2wudG9Mb3dlckNhc2UoKV07aWYoRSl7RSh0aGlzLEQpO31lbHNle2lmKHEpe3ZhciBlPXRoaXMucmV0cmlldmUoIiRhdHRyaWJ1dGVXaGl0ZUxpc3QiLHt9KTsKfWlmKEQ9PW51bGwpe3RoaXMucmVtb3ZlQXR0cmlidXRlKGwpO2lmKHEpe2RlbGV0ZSBlW2xdO319ZWxzZXt0aGlzLnNldEF0dHJpYnV0ZShsLCIiK0QpO2lmKHEpe2VbbF09dHJ1ZTt9fX1yZXR1cm4gdGhpczt9LHNldFByb3BlcnRpZXM6ZnVuY3Rpb24oZSl7Zm9yKHZhciBsIGluIGUpe3RoaXMuc2V0UHJvcGVydHkobCxlW2xdKTsKfXJldHVybiB0aGlzO30sZ2V0UHJvcGVydHk6ZnVuY3Rpb24oRil7dmFyIEQ9altGLnRvTG93ZXJDYXNlKCldO2lmKEQpe3JldHVybiBEKHRoaXMpO31pZihxKXt2YXIgbD10aGlzLmdldEF0dHJpYnV0ZU5vZGUoRiksRT10aGlzLnJldHJpZXZlKCIkYXR0cmlidXRlV2hpdGVMaXN0Iix7fSk7CmlmKCFsKXtyZXR1cm4gbnVsbDt9aWYobC5leHBhbmRvJiYhRVtGXSl7dmFyIEc9dGhpcy5vdXRlckhUTUw7aWYoRy5zdWJzdHIoMCxHLnNlYXJjaCgvXC8/WyciXT8+KD8hW148XSo8WyciXSkvKSkuaW5kZXhPZihGKTwwKXtyZXR1cm4gbnVsbDt9RVtGXT10cnVlO319dmFyIGU9U2xpY2suZ2V0QXR0cmlidXRlKHRoaXMsRik7CnJldHVybighZSYmIVNsaWNrLmhhc0F0dHJpYnV0ZSh0aGlzLEYpKT9udWxsOmU7fSxnZXRQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkuZnJvbShhcmd1bWVudHMpO3JldHVybiBlLm1hcCh0aGlzLmdldFByb3BlcnR5LHRoaXMpLmFzc29jaWF0ZShlKTsKfSxyZW1vdmVQcm9wZXJ0eTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5zZXRQcm9wZXJ0eShlLG51bGwpO30scmVtb3ZlUHJvcGVydGllczpmdW5jdGlvbigpe0FycmF5LmVhY2goYXJndW1lbnRzLHRoaXMucmVtb3ZlUHJvcGVydHksdGhpcyk7cmV0dXJuIHRoaXM7fSxzZXQ6ZnVuY3Rpb24oRCxsKXt2YXIgZT1FbGVtZW50LlByb3BlcnRpZXNbRF07CihlJiZlLnNldCk/ZS5zZXQuY2FsbCh0aGlzLGwpOnRoaXMuc2V0UHJvcGVydHkoRCxsKTt9Lm92ZXJsb2FkU2V0dGVyKCksZ2V0OmZ1bmN0aW9uKGwpe3ZhciBlPUVsZW1lbnQuUHJvcGVydGllc1tsXTtyZXR1cm4oZSYmZS5nZXQpP2UuZ2V0LmFwcGx5KHRoaXMpOnRoaXMuZ2V0UHJvcGVydHkobCk7Cn0ub3ZlcmxvYWRHZXR0ZXIoKSxlcmFzZTpmdW5jdGlvbihsKXt2YXIgZT1FbGVtZW50LlByb3BlcnRpZXNbbF07KGUmJmUuZXJhc2UpP2UuZXJhc2UuYXBwbHkodGhpcyk6dGhpcy5yZW1vdmVQcm9wZXJ0eShsKTtyZXR1cm4gdGhpczt9LGhhc0NsYXNzOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmNsYXNzTmFtZS5jbGVhbigpLmNvbnRhaW5zKGUsIiAiKTsKfSxhZGRDbGFzczpmdW5jdGlvbihlKXtpZighdGhpcy5oYXNDbGFzcyhlKSl7dGhpcy5jbGFzc05hbWU9KHRoaXMuY2xhc3NOYW1lKyIgIitlKS5jbGVhbigpO31yZXR1cm4gdGhpczt9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGUpe3RoaXMuY2xhc3NOYW1lPXRoaXMuY2xhc3NOYW1lLnJlcGxhY2UobmV3IFJlZ0V4cCgiKF58XFxzKSIrZSsiKD86XFxzfCQpIiksIiQxIik7CnJldHVybiB0aGlzO30sdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oZSxsKXtpZihsPT1udWxsKXtsPSF0aGlzLmhhc0NsYXNzKGUpO31yZXR1cm4obCk/dGhpcy5hZGRDbGFzcyhlKTp0aGlzLnJlbW92ZUNsYXNzKGUpO30sYWRvcHQ6ZnVuY3Rpb24oKXt2YXIgRT10aGlzLGUsRz1BcnJheS5mbGF0dGVuKGFyZ3VtZW50cyksRj1HLmxlbmd0aDsKaWYoRj4xKXtFPWU9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO31mb3IodmFyIEQ9MDtEPEY7RCsrKXt2YXIgbD1kb2N1bWVudC5pZChHW0RdLHRydWUpO2lmKGwpe0UuYXBwZW5kQ2hpbGQobCk7fX1pZihlKXt0aGlzLmFwcGVuZENoaWxkKGUpO31yZXR1cm4gdGhpczsKfSxhcHBlbmRUZXh0OmZ1bmN0aW9uKGwsZSl7cmV0dXJuIHRoaXMuZ3JhYih0aGlzLmdldERvY3VtZW50KCkubmV3VGV4dE5vZGUobCksZSk7fSxncmFiOmZ1bmN0aW9uKGwsZSl7d1tlfHwiYm90dG9tIl0oZG9jdW1lbnQuaWQobCx0cnVlKSx0aGlzKTtyZXR1cm4gdGhpczsKfSxpbmplY3Q6ZnVuY3Rpb24obCxlKXt3W2V8fCJib3R0b20iXSh0aGlzLGRvY3VtZW50LmlkKGwsdHJ1ZSkpO3JldHVybiB0aGlzO30scmVwbGFjZXM6ZnVuY3Rpb24oZSl7ZT1kb2N1bWVudC5pZChlLHRydWUpO2UucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodGhpcyxlKTsKcmV0dXJuIHRoaXM7fSx3cmFwczpmdW5jdGlvbihsLGUpe2w9ZG9jdW1lbnQuaWQobCx0cnVlKTtyZXR1cm4gdGhpcy5yZXBsYWNlcyhsKS5ncmFiKGwsZSk7fSxnZXRTZWxlY3RlZDpmdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWRJbmRleDtyZXR1cm4gbmV3IEVsZW1lbnRzKEFycmF5LmZyb20odGhpcy5vcHRpb25zKS5maWx0ZXIoZnVuY3Rpb24oZSl7cmV0dXJuIGUuc2VsZWN0ZWQ7Cn0pKTt9LHRvUXVlcnlTdHJpbmc6ZnVuY3Rpb24oKXt2YXIgZT1bXTt0aGlzLmdldEVsZW1lbnRzKCJpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSIpLmVhY2goZnVuY3Rpb24oRCl7dmFyIGw9RC50eXBlO2lmKCFELm5hbWV8fEQuZGlzYWJsZWR8fGw9PSJzdWJtaXQifHxsPT0icmVzZXQifHxsPT0iZmlsZSJ8fGw9PSJpbWFnZSIpe3JldHVybjsKfXZhciBFPShELmdldCgidGFnIik9PSJzZWxlY3QiKT9ELmdldFNlbGVjdGVkKCkubWFwKGZ1bmN0aW9uKEYpe3JldHVybiBkb2N1bWVudC5pZChGKS5nZXQoInZhbHVlIik7fSk6KChsPT0icmFkaW8ifHxsPT0iY2hlY2tib3giKSYmIUQuY2hlY2tlZCk/bnVsbDpELmdldCgidmFsdWUiKTsKQXJyYXkuZnJvbShFKS5lYWNoKGZ1bmN0aW9uKEYpe2lmKHR5cGVvZiBGIT0idW5kZWZpbmVkIil7ZS5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChELm5hbWUpKyI9IitlbmNvZGVVUklDb21wb25lbnQoRikpO319KTt9KTtyZXR1cm4gZS5qb2luKCImIik7fX0pO3ZhciBpPXt9LEE9e307CnZhciBCPWZ1bmN0aW9uKGUpe3JldHVybihBW2VdfHwoQVtlXT17fSkpO307dmFyIHY9ZnVuY3Rpb24obCl7dmFyIGU9bC51bmlxdWVOdW1iZXI7aWYobC5yZW1vdmVFdmVudHMpe2wucmVtb3ZlRXZlbnRzKCk7fWlmKGwuY2xlYXJBdHRyaWJ1dGVzKXtsLmNsZWFyQXR0cmlidXRlcygpOwp9aWYoZSE9bnVsbCl7ZGVsZXRlIGlbZV07ZGVsZXRlIEFbZV07fXJldHVybiBsO307dmFyIEM9e2lucHV0OiJjaGVja2VkIixvcHRpb246InNlbGVjdGVkIix0ZXh0YXJlYToidmFsdWUifTtFbGVtZW50LmltcGxlbWVudCh7ZGVzdHJveTpmdW5jdGlvbigpe3ZhciBlPXYodGhpcykuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKTsKQXJyYXkuZWFjaChlLHYpO0VsZW1lbnQuZGlzcG9zZSh0aGlzKTtyZXR1cm4gbnVsbDt9LGVtcHR5OmZ1bmN0aW9uKCl7QXJyYXkuZnJvbSh0aGlzLmNoaWxkTm9kZXMpLmVhY2goRWxlbWVudC5kaXNwb3NlKTtyZXR1cm4gdGhpczt9LGRpc3Bvc2U6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5wYXJlbnROb2RlKT90aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcyk6dGhpczsKfSxjbG9uZTpmdW5jdGlvbihHLEUpe0c9RyE9PWZhbHNlO3ZhciBMPXRoaXMuY2xvbmVOb2RlKEcpLEQ9W0xdLEY9W3RoaXNdLEo7aWYoRyl7RC5hcHBlbmQoQXJyYXkuZnJvbShMLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpKTtGLmFwcGVuZChBcnJheS5mcm9tKHRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSkpOwp9Zm9yKEo9RC5sZW5ndGg7Si0tOyl7dmFyIEg9RFtKXSxLPUZbSl07aWYoIUUpe0gucmVtb3ZlQXR0cmlidXRlKCJpZCIpO31pZihILmNsZWFyQXR0cmlidXRlcyl7SC5jbGVhckF0dHJpYnV0ZXMoKTtILm1lcmdlQXR0cmlidXRlcyhLKTtILnJlbW92ZUF0dHJpYnV0ZSgidW5pcXVlTnVtYmVyIik7CmlmKEgub3B0aW9ucyl7dmFyIE89SC5vcHRpb25zLGU9Sy5vcHRpb25zO2Zvcih2YXIgST1PLmxlbmd0aDtJLS07KXtPW0ldLnNlbGVjdGVkPWVbSV0uc2VsZWN0ZWQ7fX19dmFyIGw9Q1tLLnRhZ05hbWUudG9Mb3dlckNhc2UoKV07aWYobCYmS1tsXSl7SFtsXT1LW2xdOwp9fWlmKEJyb3dzZXIuaWUpe3ZhciBNPUwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm9iamVjdCIpLE49dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgib2JqZWN0Iik7Zm9yKEo9TS5sZW5ndGg7Si0tOyl7TVtKXS5vdXRlckhUTUw9TltKXS5vdXRlckhUTUw7fX1yZXR1cm4gZG9jdW1lbnQuaWQoTCk7Cn19KTtbRWxlbWVudCxXaW5kb3csRG9jdW1lbnRdLmludm9rZSgiaW1wbGVtZW50Iix7YWRkTGlzdGVuZXI6ZnVuY3Rpb24oRSxEKXtpZihFPT0idW5sb2FkIil7dmFyIGU9RCxsPXRoaXM7RD1mdW5jdGlvbigpe2wucmVtb3ZlTGlzdGVuZXIoInVubG9hZCIsRCk7ZSgpOwp9O31lbHNle2lbU2xpY2sudWlkT2YodGhpcyldPXRoaXM7fWlmKHRoaXMuYWRkRXZlbnRMaXN0ZW5lcil7dGhpcy5hZGRFdmVudExpc3RlbmVyKEUsRCwhIWFyZ3VtZW50c1syXSk7fWVsc2V7dGhpcy5hdHRhY2hFdmVudCgib24iK0UsRCk7fXJldHVybiB0aGlzO30scmVtb3ZlTGlzdGVuZXI6ZnVuY3Rpb24obCxlKXtpZih0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIpe3RoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihsLGUsISFhcmd1bWVudHNbMl0pOwp9ZWxzZXt0aGlzLmRldGFjaEV2ZW50KCJvbiIrbCxlKTt9cmV0dXJuIHRoaXM7fSxyZXRyaWV2ZTpmdW5jdGlvbihsLGUpe3ZhciBFPUIoU2xpY2sudWlkT2YodGhpcykpLEQ9RVtsXTtpZihlIT1udWxsJiZEPT1udWxsKXtEPUVbbF09ZTt9cmV0dXJuIEQhPW51bGw/RDpudWxsOwp9LHN0b3JlOmZ1bmN0aW9uKGwsZSl7dmFyIEQ9QihTbGljay51aWRPZih0aGlzKSk7RFtsXT1lO3JldHVybiB0aGlzO30sZWxpbWluYXRlOmZ1bmN0aW9uKGUpe3ZhciBsPUIoU2xpY2sudWlkT2YodGhpcykpO2RlbGV0ZSBsW2VdO3JldHVybiB0aGlzO319KTtpZih3aW5kb3cuYXR0YWNoRXZlbnQmJiF3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcil7d2luZG93LmFkZExpc3RlbmVyKCJ1bmxvYWQiLGZ1bmN0aW9uKCl7T2JqZWN0LmVhY2goaSx2KTsKaWYod2luZG93LkNvbGxlY3RHYXJiYWdlKXtDb2xsZWN0R2FyYmFnZSgpO319KTt9RWxlbWVudC5Qcm9wZXJ0aWVzPXt9O0VsZW1lbnQuUHJvcGVydGllcy5zdHlsZT17c2V0OmZ1bmN0aW9uKGUpe3RoaXMuc3R5bGUuY3NzVGV4dD1lO30sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3R5bGUuY3NzVGV4dDsKfSxlcmFzZTpmdW5jdGlvbigpe3RoaXMuc3R5bGUuY3NzVGV4dD0iIjt9fTtFbGVtZW50LlByb3BlcnRpZXMudGFnPXtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50YWdOYW1lLnRvTG93ZXJDYXNlKCk7fX07RWxlbWVudC5Qcm9wZXJ0aWVzLmh0bWw9e3NldDpmdW5jdGlvbihlKXtpZihlPT1udWxsKXtlPSIiOwp9ZWxzZXtpZih0eXBlT2YoZSk9PSJhcnJheSIpe2U9ZS5qb2luKCIiKTt9fXRoaXMuaW5uZXJIVE1MPWU7fSxlcmFzZTpmdW5jdGlvbigpe3RoaXMuaW5uZXJIVE1MPSIiO319O3ZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO3QuaW5uZXJIVE1MPSI8bmF2PjwvbmF2PiI7CnZhciBhPSh0LmNoaWxkTm9kZXMubGVuZ3RoPT0xKTtpZighYSl7dmFyIHM9ImFiYnIgYXJ0aWNsZSBhc2lkZSBhdWRpbyBjYW52YXMgZGF0YWxpc3QgZGV0YWlscyBmaWdjYXB0aW9uIGZpZ3VyZSBmb290ZXIgaGVhZGVyIGhncm91cCBtYXJrIG1ldGVyIG5hdiBvdXRwdXQgcHJvZ3Jlc3Mgc2VjdGlvbiBzdW1tYXJ5IHRpbWUgdmlkZW8iLnNwbGl0KCIgIiksYj1kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksdT1zLmxlbmd0aDsKd2hpbGUodS0tKXtiLmNyZWF0ZUVsZW1lbnQoc1t1XSk7fX10PW51bGw7dmFyIGc9RnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRhYmxlIik7ZS5pbm5lckhUTUw9Ijx0cj48dGQ+PC90ZD48L3RyPiI7cmV0dXJuIHRydWU7Cn0pO3ZhciBjPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRyIiksbz0iPHRkPjwvdGQ+IjtjLmlubmVySFRNTD1vO3ZhciB5PShjLmlubmVySFRNTD09byk7Yz1udWxsO2lmKCFnfHwheXx8IWEpe0VsZW1lbnQuUHJvcGVydGllcy5odG1sLnNldD0oZnVuY3Rpb24obCl7dmFyIGU9e3RhYmxlOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSxzZWxlY3Q6WzEsIjxzZWxlY3Q+IiwiPC9zZWxlY3Q+Il0sdGJvZHk6WzIsIjx0YWJsZT48dGJvZHk+IiwiPC90Ym9keT48L3RhYmxlPiJdLHRyOlszLCI8dGFibGU+PHRib2R5Pjx0cj4iLCI8L3RyPjwvdGJvZHk+PC90YWJsZT4iXX07CmUudGhlYWQ9ZS50Zm9vdD1lLnRib2R5O3JldHVybiBmdW5jdGlvbihEKXt2YXIgRT1lW3RoaXMuZ2V0KCJ0YWciKV07aWYoIUUmJiFhKXtFPVswLCIiLCIiXTt9aWYoIUUpe3JldHVybiBsLmNhbGwodGhpcyxEKTt9dmFyIEg9RVswXSxHPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLEY9RzsKaWYoIWEpe2IuYXBwZW5kQ2hpbGQoRyk7fUcuaW5uZXJIVE1MPVtFWzFdLEQsRVsyXV0uZmxhdHRlbigpLmpvaW4oIiIpO3doaWxlKEgtLSl7Rj1GLmZpcnN0Q2hpbGQ7fXRoaXMuZW1wdHkoKS5hZG9wdChGLmNoaWxkTm9kZXMpO2lmKCFhKXtiLnJlbW92ZUNoaWxkKEcpOwp9Rz1udWxsO307fSkoRWxlbWVudC5Qcm9wZXJ0aWVzLmh0bWwuc2V0KTt9dmFyIG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZm9ybSIpO24uaW5uZXJIVE1MPSI8c2VsZWN0PjxvcHRpb24+czwvb3B0aW9uPjwvc2VsZWN0PiI7aWYobi5maXJzdENoaWxkLnZhbHVlIT0icyIpe0VsZW1lbnQuUHJvcGVydGllcy52YWx1ZT17c2V0OmZ1bmN0aW9uKEcpe3ZhciBsPXRoaXMuZ2V0KCJ0YWciKTsKaWYobCE9InNlbGVjdCIpe3JldHVybiB0aGlzLnNldFByb3BlcnR5KCJ2YWx1ZSIsRyk7fXZhciBEPXRoaXMuZ2V0RWxlbWVudHMoIm9wdGlvbiIpO2Zvcih2YXIgRT0wO0U8RC5sZW5ndGg7RSsrKXt2YXIgRj1EW0VdLGU9Ri5nZXRBdHRyaWJ1dGVOb2RlKCJ2YWx1ZSIpLEg9KGUmJmUuc3BlY2lmaWVkKT9GLnZhbHVlOkYuZ2V0KCJ0ZXh0Iik7CmlmKEg9PUcpe3JldHVybiBGLnNlbGVjdGVkPXRydWU7fX19LGdldDpmdW5jdGlvbigpe3ZhciBEPXRoaXMsbD1ELmdldCgidGFnIik7aWYobCE9InNlbGVjdCImJmwhPSJvcHRpb24iKXtyZXR1cm4gdGhpcy5nZXRQcm9wZXJ0eSgidmFsdWUiKTt9aWYobD09InNlbGVjdCImJiEoRD1ELmdldFNlbGVjdGVkKClbMF0pKXtyZXR1cm4iIjsKfXZhciBlPUQuZ2V0QXR0cmlidXRlTm9kZSgidmFsdWUiKTtyZXR1cm4oZSYmZS5zcGVjaWZpZWQpP0QudmFsdWU6RC5nZXQoInRleHQiKTt9fTt9bj1udWxsO2lmKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLmdldEF0dHJpYnV0ZU5vZGUoImlkIikpe0VsZW1lbnQuUHJvcGVydGllcy5pZD17c2V0OmZ1bmN0aW9uKGUpe3RoaXMuaWQ9dGhpcy5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpLnZhbHVlPWU7Cn0sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaWR8fG51bGw7fSxlcmFzZTpmdW5jdGlvbigpe3RoaXMuaWQ9dGhpcy5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpLnZhbHVlPSIiO319O319KSgpOyhmdW5jdGlvbigpe3ZhciBpPWRvY3VtZW50Lmh0bWw7dmFyIGQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CmQuc3R5bGUuY29sb3I9InJlZCI7ZC5zdHlsZS5jb2xvcj1udWxsO3ZhciBjPWQuc3R5bGUuY29sb3I9PSJyZWQiO2Q9bnVsbDtFbGVtZW50LlByb3BlcnRpZXMuc3R5bGVzPXtzZXQ6ZnVuY3Rpb24oayl7dGhpcy5zZXRTdHlsZXMoayk7fX07dmFyIGg9KGkuc3R5bGUub3BhY2l0eSE9bnVsbCksZT0oaS5zdHlsZS5maWx0ZXIhPW51bGwpLGo9L2FscGhhXChvcGFjaXR5PShbXGQuXSspXCkvaTsKdmFyIGE9ZnVuY3Rpb24obCxrKXtsLnN0b3JlKCIkb3BhY2l0eSIsayk7bC5zdHlsZS52aXNpYmlsaXR5PWs+MHx8az09bnVsbD8idmlzaWJsZSI6ImhpZGRlbiI7fTt2YXIgZj0oaD9mdW5jdGlvbihsLGspe2wuc3R5bGUub3BhY2l0eT1rO306KGU/ZnVuY3Rpb24obCxrKXt2YXIgbj1sLnN0eWxlOwppZighbC5jdXJyZW50U3R5bGV8fCFsLmN1cnJlbnRTdHlsZS5oYXNMYXlvdXQpe24uem9vbT0xO31pZihrPT1udWxsfHxrPT0xKXtrPSIiO31lbHNle2s9ImFscGhhKG9wYWNpdHk9IisoayoxMDApLmxpbWl0KDAsMTAwKS5yb3VuZCgpKyIpIjt9dmFyIG09bi5maWx0ZXJ8fGwuZ2V0Q29tcHV0ZWRTdHlsZSgiZmlsdGVyIil8fCIiOwpuLmZpbHRlcj1qLnRlc3QobSk/bS5yZXBsYWNlKGosayk6bStrO2lmKCFuLmZpbHRlcil7bi5yZW1vdmVBdHRyaWJ1dGUoImZpbHRlciIpO319OmEpKTt2YXIgZz0oaD9mdW5jdGlvbihsKXt2YXIgaz1sLnN0eWxlLm9wYWNpdHl8fGwuZ2V0Q29tcHV0ZWRTdHlsZSgib3BhY2l0eSIpOwpyZXR1cm4oaz09IiIpPzE6ay50b0Zsb2F0KCk7fTooZT9mdW5jdGlvbihsKXt2YXIgbT0obC5zdHlsZS5maWx0ZXJ8fGwuZ2V0Q29tcHV0ZWRTdHlsZSgiZmlsdGVyIikpLGs7aWYobSl7az1tLm1hdGNoKGopO31yZXR1cm4oaz09bnVsbHx8bT09bnVsbCk/MTooa1sxXS8xMDApOwp9OmZ1bmN0aW9uKGwpe3ZhciBrPWwucmV0cmlldmUoIiRvcGFjaXR5Iik7aWYoaz09bnVsbCl7az0obC5zdHlsZS52aXNpYmlsaXR5PT0iaGlkZGVuIj8wOjEpO31yZXR1cm4gazt9KSk7dmFyIGI9KGkuc3R5bGUuY3NzRmxvYXQ9PW51bGwpPyJzdHlsZUZsb2F0IjoiY3NzRmxvYXQiOwpFbGVtZW50LmltcGxlbWVudCh7Z2V0Q29tcHV0ZWRTdHlsZTpmdW5jdGlvbihtKXtpZih0aGlzLmN1cnJlbnRTdHlsZSl7cmV0dXJuIHRoaXMuY3VycmVudFN0eWxlW20uY2FtZWxDYXNlKCldO312YXIgbD1FbGVtZW50LmdldERvY3VtZW50KHRoaXMpLmRlZmF1bHRWaWV3LGs9bD9sLmdldENvbXB1dGVkU3R5bGUodGhpcyxudWxsKTpudWxsOwpyZXR1cm4oayk/ay5nZXRQcm9wZXJ0eVZhbHVlKChtPT1iKT8iZmxvYXQiOm0uaHlwaGVuYXRlKCkpOm51bGw7fSxzZXRTdHlsZTpmdW5jdGlvbihsLGspe2lmKGw9PSJvcGFjaXR5Iil7aWYoayE9bnVsbCl7az1wYXJzZUZsb2F0KGspO31mKHRoaXMsayk7cmV0dXJuIHRoaXM7Cn1sPShsPT0iZmxvYXQiP2I6bCkuY2FtZWxDYXNlKCk7aWYodHlwZU9mKGspIT0ic3RyaW5nIil7dmFyIG09KEVsZW1lbnQuU3R5bGVzW2xdfHwiQCIpLnNwbGl0KCIgIik7az1BcnJheS5mcm9tKGspLm1hcChmdW5jdGlvbihvLG4pe2lmKCFtW25dKXtyZXR1cm4iIjsKfXJldHVybih0eXBlT2Yobyk9PSJudW1iZXIiKT9tW25dLnJlcGxhY2UoIkAiLE1hdGgucm91bmQobykpOm87fSkuam9pbigiICIpO31lbHNle2lmKGs9PVN0cmluZyhOdW1iZXIoaykpKXtrPU1hdGgucm91bmQoayk7fX10aGlzLnN0eWxlW2xdPWs7aWYoKGs9PSIifHxrPT1udWxsKSYmYyYmdGhpcy5zdHlsZS5yZW1vdmVBdHRyaWJ1dGUpe3RoaXMuc3R5bGUucmVtb3ZlQXR0cmlidXRlKGwpOwp9cmV0dXJuIHRoaXM7fSxnZXRTdHlsZTpmdW5jdGlvbihxKXtpZihxPT0ib3BhY2l0eSIpe3JldHVybiBnKHRoaXMpO31xPShxPT0iZmxvYXQiP2I6cSkuY2FtZWxDYXNlKCk7dmFyIGs9dGhpcy5zdHlsZVtxXTtpZigha3x8cT09InpJbmRleCIpe2s9W107Zm9yKHZhciBwIGluIEVsZW1lbnQuU2hvcnRTdHlsZXMpe2lmKHEhPXApe2NvbnRpbnVlOwp9Zm9yKHZhciBvIGluIEVsZW1lbnQuU2hvcnRTdHlsZXNbcF0pe2sucHVzaCh0aGlzLmdldFN0eWxlKG8pKTt9cmV0dXJuIGsuam9pbigiICIpO31rPXRoaXMuZ2V0Q29tcHV0ZWRTdHlsZShxKTt9aWYoayl7az1TdHJpbmcoayk7dmFyIG09ay5tYXRjaCgvcmdiYT9cKFtcZFxzLF0rXCkvKTsKaWYobSl7az1rLnJlcGxhY2UobVswXSxtWzBdLnJnYlRvSGV4KCkpO319aWYoQnJvd3Nlci5vcGVyYXx8QnJvd3Nlci5pZSl7aWYoKC9eKGhlaWdodHx3aWR0aCkkLykudGVzdChxKSYmISgvcHgkLy50ZXN0KGspKSl7dmFyIGw9KHE9PSJ3aWR0aCIpP1sibGVmdCIsInJpZ2h0Il06WyJ0b3AiLCJib3R0b20iXSxuPTA7CmwuZWFjaChmdW5jdGlvbihyKXtuKz10aGlzLmdldFN0eWxlKCJib3JkZXItIityKyItd2lkdGgiKS50b0ludCgpK3RoaXMuZ2V0U3R5bGUoInBhZGRpbmctIityKS50b0ludCgpO30sdGhpcyk7cmV0dXJuIHRoaXNbIm9mZnNldCIrcS5jYXBpdGFsaXplKCldLW4rInB4IjsKfWlmKEJyb3dzZXIuaWUmJigvXmJvcmRlciguKylXaWR0aHxtYXJnaW58cGFkZGluZy8pLnRlc3QocSkmJmlzTmFOKHBhcnNlRmxvYXQoaykpKXtyZXR1cm4iMHB4Ijt9fXJldHVybiBrO30sc2V0U3R5bGVzOmZ1bmN0aW9uKGwpe2Zvcih2YXIgayBpbiBsKXt0aGlzLnNldFN0eWxlKGssbFtrXSk7Cn1yZXR1cm4gdGhpczt9LGdldFN0eWxlczpmdW5jdGlvbigpe3ZhciBrPXt9O0FycmF5LmZsYXR0ZW4oYXJndW1lbnRzKS5lYWNoKGZ1bmN0aW9uKGwpe2tbbF09dGhpcy5nZXRTdHlsZShsKTt9LHRoaXMpO3JldHVybiBrO319KTtFbGVtZW50LlN0eWxlcz17bGVmdDoiQHB4Iix0b3A6IkBweCIsYm90dG9tOiJAcHgiLHJpZ2h0OiJAcHgiLHdpZHRoOiJAcHgiLGhlaWdodDoiQHB4IixtYXhXaWR0aDoiQHB4IixtYXhIZWlnaHQ6IkBweCIsbWluV2lkdGg6IkBweCIsbWluSGVpZ2h0OiJAcHgiLGJhY2tncm91bmRDb2xvcjoicmdiKEAsIEAsIEApIixiYWNrZ3JvdW5kUG9zaXRpb246IkBweCBAcHgiLGNvbG9yOiJyZ2IoQCwgQCwgQCkiLGZvbnRTaXplOiJAcHgiLGxldHRlclNwYWNpbmc6IkBweCIsbGluZUhlaWdodDoiQHB4IixjbGlwOiJyZWN0KEBweCBAcHggQHB4IEBweCkiLG1hcmdpbjoiQHB4IEBweCBAcHggQHB4IixwYWRkaW5nOiJAcHggQHB4IEBweCBAcHgiLGJvcmRlcjoiQHB4IEAgcmdiKEAsIEAsIEApIEBweCBAIHJnYihALCBALCBAKSBAcHggQCByZ2IoQCwgQCwgQCkiLGJvcmRlcldpZHRoOiJAcHggQHB4IEBweCBAcHgiLGJvcmRlclN0eWxlOiJAIEAgQCBAIixib3JkZXJDb2xvcjoicmdiKEAsIEAsIEApIHJnYihALCBALCBAKSByZ2IoQCwgQCwgQCkgcmdiKEAsIEAsIEApIix6SW5kZXg6IkAiLHpvb206IkAiLGZvbnRXZWlnaHQ6IkAiLHRleHRJbmRlbnQ6IkBweCIsb3BhY2l0eToiQCJ9OwpFbGVtZW50LlNob3J0U3R5bGVzPXttYXJnaW46e30scGFkZGluZzp7fSxib3JkZXI6e30sYm9yZGVyV2lkdGg6e30sYm9yZGVyU3R5bGU6e30sYm9yZGVyQ29sb3I6e319O1siVG9wIiwiUmlnaHQiLCJCb3R0b20iLCJMZWZ0Il0uZWFjaChmdW5jdGlvbihxKXt2YXIgcD1FbGVtZW50LlNob3J0U3R5bGVzOwp2YXIgbD1FbGVtZW50LlN0eWxlcztbIm1hcmdpbiIsInBhZGRpbmciXS5lYWNoKGZ1bmN0aW9uKHIpe3ZhciBzPXIrcTtwW3JdW3NdPWxbc109IkBweCI7fSk7dmFyIG89ImJvcmRlciIrcTtwLmJvcmRlcltvXT1sW29dPSJAcHggQCByZ2IoQCwgQCwgQCkiO3ZhciBuPW8rIldpZHRoIixrPW8rIlN0eWxlIixtPW8rIkNvbG9yIjsKcFtvXT17fTtwLmJvcmRlcldpZHRoW25dPXBbb11bbl09bFtuXT0iQHB4IjtwLmJvcmRlclN0eWxlW2tdPXBbb11ba109bFtrXT0iQCI7cC5ib3JkZXJDb2xvclttXT1wW29dW21dPWxbbV09InJnYihALCBALCBAKSI7fSk7fSkoKTsoZnVuY3Rpb24oKXtFbGVtZW50LlByb3BlcnRpZXMuZXZlbnRzPXtzZXQ6ZnVuY3Rpb24oYil7dGhpcy5hZGRFdmVudHMoYik7Cn19O1tFbGVtZW50LFdpbmRvdyxEb2N1bWVudF0uaW52b2tlKCJpbXBsZW1lbnQiLHthZGRFdmVudDpmdW5jdGlvbihmLGgpe3ZhciBpPXRoaXMucmV0cmlldmUoImV2ZW50cyIse30pO2lmKCFpW2ZdKXtpW2ZdPXtrZXlzOltdLHZhbHVlczpbXX07fWlmKGlbZl0ua2V5cy5jb250YWlucyhoKSl7cmV0dXJuIHRoaXM7Cn1pW2ZdLmtleXMucHVzaChoKTt2YXIgZz1mLGI9RWxlbWVudC5FdmVudHNbZl0sZD1oLGo9dGhpcztpZihiKXtpZihiLm9uQWRkKXtiLm9uQWRkLmNhbGwodGhpcyxoLGYpO31pZihiLmNvbmRpdGlvbil7ZD1mdW5jdGlvbihrKXtpZihiLmNvbmRpdGlvbi5jYWxsKHRoaXMsayxmKSl7cmV0dXJuIGguY2FsbCh0aGlzLGspOwp9cmV0dXJuIHRydWU7fTt9aWYoYi5iYXNlKXtnPUZ1bmN0aW9uLmZyb20oYi5iYXNlKS5jYWxsKHRoaXMsZik7fX12YXIgZT1mdW5jdGlvbigpe3JldHVybiBoLmNhbGwoaik7fTt2YXIgYz1FbGVtZW50Lk5hdGl2ZUV2ZW50c1tnXTtpZihjKXtpZihjPT0yKXtlPWZ1bmN0aW9uKGspe2s9bmV3IERPTUV2ZW50KGssai5nZXRXaW5kb3coKSk7CmlmKGQuY2FsbChqLGspPT09ZmFsc2Upe2suc3RvcCgpO319O310aGlzLmFkZExpc3RlbmVyKGcsZSxhcmd1bWVudHNbMl0pO31pW2ZdLnZhbHVlcy5wdXNoKGUpO3JldHVybiB0aGlzO30scmVtb3ZlRXZlbnQ6ZnVuY3Rpb24oZSxkKXt2YXIgYz10aGlzLnJldHJpZXZlKCJldmVudHMiKTsKaWYoIWN8fCFjW2VdKXtyZXR1cm4gdGhpczt9dmFyIGg9Y1tlXTt2YXIgYj1oLmtleXMuaW5kZXhPZihkKTtpZihiPT0tMSl7cmV0dXJuIHRoaXM7fXZhciBnPWgudmFsdWVzW2JdO2RlbGV0ZSBoLmtleXNbYl07ZGVsZXRlIGgudmFsdWVzW2JdO3ZhciBmPUVsZW1lbnQuRXZlbnRzW2VdOwppZihmKXtpZihmLm9uUmVtb3ZlKXtmLm9uUmVtb3ZlLmNhbGwodGhpcyxkLGUpO31pZihmLmJhc2Upe2U9RnVuY3Rpb24uZnJvbShmLmJhc2UpLmNhbGwodGhpcyxlKTt9fXJldHVybihFbGVtZW50Lk5hdGl2ZUV2ZW50c1tlXSk/dGhpcy5yZW1vdmVMaXN0ZW5lcihlLGcsYXJndW1lbnRzWzJdKTp0aGlzOwp9LGFkZEV2ZW50czpmdW5jdGlvbihiKXtmb3IodmFyIGMgaW4gYil7dGhpcy5hZGRFdmVudChjLGJbY10pO31yZXR1cm4gdGhpczt9LHJlbW92ZUV2ZW50czpmdW5jdGlvbihiKXt2YXIgZDtpZih0eXBlT2YoYik9PSJvYmplY3QiKXtmb3IoZCBpbiBiKXt0aGlzLnJlbW92ZUV2ZW50KGQsYltkXSk7Cn1yZXR1cm4gdGhpczt9dmFyIGM9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIik7aWYoIWMpe3JldHVybiB0aGlzO31pZighYil7Zm9yKGQgaW4gYyl7dGhpcy5yZW1vdmVFdmVudHMoZCk7fXRoaXMuZWxpbWluYXRlKCJldmVudHMiKTt9ZWxzZXtpZihjW2JdKXtjW2JdLmtleXMuZWFjaChmdW5jdGlvbihlKXt0aGlzLnJlbW92ZUV2ZW50KGIsZSk7Cn0sdGhpcyk7ZGVsZXRlIGNbYl07fX1yZXR1cm4gdGhpczt9LGZpcmVFdmVudDpmdW5jdGlvbihlLGMsYil7dmFyIGQ9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIik7aWYoIWR8fCFkW2VdKXtyZXR1cm4gdGhpczt9Yz1BcnJheS5mcm9tKGMpO2RbZV0ua2V5cy5lYWNoKGZ1bmN0aW9uKGYpe2lmKGIpe2YuZGVsYXkoYix0aGlzLGMpOwp9ZWxzZXtmLmFwcGx5KHRoaXMsYyk7fX0sdGhpcyk7cmV0dXJuIHRoaXM7fSxjbG9uZUV2ZW50czpmdW5jdGlvbihlLGQpe2U9ZG9jdW1lbnQuaWQoZSk7dmFyIGM9ZS5yZXRyaWV2ZSgiZXZlbnRzIik7aWYoIWMpe3JldHVybiB0aGlzO31pZighZCl7Zm9yKHZhciBiIGluIGMpe3RoaXMuY2xvbmVFdmVudHMoZSxiKTsKfX1lbHNle2lmKGNbZF0pe2NbZF0ua2V5cy5lYWNoKGZ1bmN0aW9uKGYpe3RoaXMuYWRkRXZlbnQoZCxmKTt9LHRoaXMpO319cmV0dXJuIHRoaXM7fX0pO0VsZW1lbnQuTmF0aXZlRXZlbnRzPXtjbGljazoyLGRibGNsaWNrOjIsbW91c2V1cDoyLG1vdXNlZG93bjoyLGNvbnRleHRtZW51OjIsbW91c2V3aGVlbDoyLERPTU1vdXNlU2Nyb2xsOjIsbW91c2VvdmVyOjIsbW91c2VvdXQ6Mixtb3VzZW1vdmU6MixzZWxlY3RzdGFydDoyLHNlbGVjdGVuZDoyLGtleWRvd246MixrZXlwcmVzczoyLGtleXVwOjIsb3JpZW50YXRpb25jaGFuZ2U6Mix0b3VjaHN0YXJ0OjIsdG91Y2htb3ZlOjIsdG91Y2hlbmQ6Mix0b3VjaGNhbmNlbDoyLGdlc3R1cmVzdGFydDoyLGdlc3R1cmVjaGFuZ2U6MixnZXN0dXJlZW5kOjIsZm9jdXM6MixibHVyOjIsY2hhbmdlOjIscmVzZXQ6MixzZWxlY3Q6MixzdWJtaXQ6MixwYXN0ZToyLGlucHV0OjIsbG9hZDoyLHVubG9hZDoxLGJlZm9yZXVubG9hZDoyLHJlc2l6ZToxLG1vdmU6MSxET01Db250ZW50TG9hZGVkOjEscmVhZHlzdGF0ZWNoYW5nZToxLGVycm9yOjEsYWJvcnQ6MSxzY3JvbGw6MX07CkVsZW1lbnQuRXZlbnRzPXttb3VzZXdoZWVsOntiYXNlOihCcm93c2VyLmZpcmVmb3gpPyJET01Nb3VzZVNjcm9sbCI6Im1vdXNld2hlZWwifX07aWYoIm9ubW91c2VlbnRlciIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KXtFbGVtZW50Lk5hdGl2ZUV2ZW50cy5tb3VzZWVudGVyPUVsZW1lbnQuTmF0aXZlRXZlbnRzLm1vdXNlbGVhdmU9MjsKfWVsc2V7dmFyIGE9ZnVuY3Rpb24oYil7dmFyIGM9Yi5yZWxhdGVkVGFyZ2V0O2lmKGM9PW51bGwpe3JldHVybiB0cnVlO31pZighYyl7cmV0dXJuIGZhbHNlO31yZXR1cm4oYyE9dGhpcyYmYy5wcmVmaXghPSJ4dWwiJiZ0eXBlT2YodGhpcykhPSJkb2N1bWVudCImJiF0aGlzLmNvbnRhaW5zKGMpKTsKfTtFbGVtZW50LkV2ZW50cy5tb3VzZWVudGVyPXtiYXNlOiJtb3VzZW92ZXIiLGNvbmRpdGlvbjphfTtFbGVtZW50LkV2ZW50cy5tb3VzZWxlYXZlPXtiYXNlOiJtb3VzZW91dCIsY29uZGl0aW9uOmF9O31pZighd2luZG93LmFkZEV2ZW50TGlzdGVuZXIpe0VsZW1lbnQuTmF0aXZlRXZlbnRzLnByb3BlcnR5Y2hhbmdlPTI7CkVsZW1lbnQuRXZlbnRzLmNoYW5nZT17YmFzZTpmdW5jdGlvbigpe3ZhciBiPXRoaXMudHlwZTtyZXR1cm4odGhpcy5nZXQoInRhZyIpPT0iaW5wdXQiJiYoYj09InJhZGlvInx8Yj09ImNoZWNrYm94IikpPyJwcm9wZXJ0eWNoYW5nZSI6ImNoYW5nZSI7fSxjb25kaXRpb246ZnVuY3Rpb24oYil7cmV0dXJuIHRoaXMudHlwZSE9InJhZGlvInx8KGIuZXZlbnQucHJvcGVydHlOYW1lPT0iY2hlY2tlZCImJnRoaXMuY2hlY2tlZCk7Cn19O319KSgpOyhmdW5jdGlvbigpe3ZhciBjPSEhd2luZG93LmFkZEV2ZW50TGlzdGVuZXI7RWxlbWVudC5OYXRpdmVFdmVudHMuZm9jdXNpbj1FbGVtZW50Lk5hdGl2ZUV2ZW50cy5mb2N1c291dD0yO3ZhciBrPWZ1bmN0aW9uKGwsbSxuLG8scCl7d2hpbGUocCYmcCE9bCl7aWYobShwLG8pKXtyZXR1cm4gbi5jYWxsKHAsbyxwKTsKfXA9ZG9jdW1lbnQuaWQocC5wYXJlbnROb2RlKTt9fTt2YXIgYT17bW91c2VlbnRlcjp7YmFzZToibW91c2VvdmVyIn0sbW91c2VsZWF2ZTp7YmFzZToibW91c2VvdXQifSxmb2N1czp7YmFzZToiZm9jdXMiKyhjPyIiOiJpbiIpLGNhcHR1cmU6dHJ1ZX0sYmx1cjp7YmFzZTpjPyJibHVyIjoiZm9jdXNvdXQiLGNhcHR1cmU6dHJ1ZX19Owp2YXIgYj0iJGRlbGVnYXRpb246Ijt2YXIgaT1mdW5jdGlvbihsKXtyZXR1cm57YmFzZToiZm9jdXNpbiIscmVtb3ZlOmZ1bmN0aW9uKG0sbyl7dmFyIHA9bS5yZXRyaWV2ZShiK2wrImxpc3RlbmVycyIse30pW29dO2lmKHAmJnAuZm9ybXMpe2Zvcih2YXIgbj1wLmZvcm1zLmxlbmd0aDsKbi0tOyl7cC5mb3Jtc1tuXS5yZW1vdmVFdmVudChsLHAuZm5zW25dKTt9fX0sbGlzdGVuOmZ1bmN0aW9uKHgscix2LG4sdCxzKXt2YXIgbz0odC5nZXQoInRhZyIpPT0iZm9ybSIpP3Q6bi50YXJnZXQuZ2V0UGFyZW50KCJmb3JtIik7aWYoIW8pe3JldHVybjt9dmFyIHU9eC5yZXRyaWV2ZShiK2wrImxpc3RlbmVycyIse30pLHA9dVtzXXx8e2Zvcm1zOltdLGZuczpbXX0sbT1wLmZvcm1zLHc9cC5mbnM7CmlmKG0uaW5kZXhPZihvKSE9LTEpe3JldHVybjt9bS5wdXNoKG8pO3ZhciBxPWZ1bmN0aW9uKHkpe2soeCxyLHYseSx0KTt9O28uYWRkRXZlbnQobCxxKTt3LnB1c2gocSk7dVtzXT1wO3guc3RvcmUoYitsKyJsaXN0ZW5lcnMiLHUpO319O307dmFyIGQ9ZnVuY3Rpb24obCl7cmV0dXJue2Jhc2U6ImZvY3VzaW4iLGxpc3RlbjpmdW5jdGlvbihtLG4scCxxLHIpe3ZhciBvPXtibHVyOmZ1bmN0aW9uKCl7dGhpcy5yZW1vdmVFdmVudHMobyk7Cn19O29bbF09ZnVuY3Rpb24ocyl7ayhtLG4scCxzLHIpO307cS50YXJnZXQuYWRkRXZlbnRzKG8pO319O307aWYoIWMpe09iamVjdC5hcHBlbmQoYSx7c3VibWl0OmkoInN1Ym1pdCIpLHJlc2V0OmkoInJlc2V0IiksY2hhbmdlOmQoImNoYW5nZSIpLHNlbGVjdDpkKCJzZWxlY3QiKX0pOwp9dmFyIGg9RWxlbWVudC5wcm90b3R5cGUsZj1oLmFkZEV2ZW50LGo9aC5yZW1vdmVFdmVudDt2YXIgZT1mdW5jdGlvbihsLG0pe3JldHVybiBmdW5jdGlvbihyLHEsbil7aWYoci5pbmRleE9mKCI6cmVsYXkiKT09LTEpe3JldHVybiBsLmNhbGwodGhpcyxyLHEsbik7Cn12YXIgbz1TbGljay5wYXJzZShyKS5leHByZXNzaW9uc1swXVswXTtpZihvLnBzZXVkb3NbMF0ua2V5IT0icmVsYXkiKXtyZXR1cm4gbC5jYWxsKHRoaXMscixxLG4pO312YXIgcD1vLnRhZztvLnBzZXVkb3Muc2xpY2UoMSkuZWFjaChmdW5jdGlvbihzKXtwKz0iOiIrcy5rZXkrKHMudmFsdWU/IigiK3MudmFsdWUrIikiOiIiKTsKfSk7bC5jYWxsKHRoaXMscixxKTtyZXR1cm4gbS5jYWxsKHRoaXMscCxvLnBzZXVkb3NbMF0udmFsdWUscSk7fTt9O3ZhciBnPXthZGRFdmVudDpmdW5jdGlvbih2LHEseCl7dmFyIHQ9dGhpcy5yZXRyaWV2ZSgiJGRlbGVnYXRlcyIse30pLHI9dFt2XTtpZihyKXtmb3IodmFyIHkgaW4gcil7aWYoclt5XS5mbj09eCYmclt5XS5tYXRjaD09cSl7cmV0dXJuIHRoaXM7Cn19fXZhciBwPXYsdT1xLG89eCxuPWFbdl18fHt9O3Y9bi5iYXNlfHxwO3E9ZnVuY3Rpb24oQil7cmV0dXJuIFNsaWNrLm1hdGNoKEIsdSk7fTt2YXIgdz1FbGVtZW50LkV2ZW50c1twXTtpZih3JiZ3LmNvbmRpdGlvbil7dmFyIGw9cSxtPXcuY29uZGl0aW9uO3E9ZnVuY3Rpb24oQyxCKXtyZXR1cm4gbChDLEIpJiZtLmNhbGwoQyxCLHYpOwp9O312YXIgej10aGlzLHM9U3RyaW5nLnVuaXF1ZUlEKCk7dmFyIEE9bi5saXN0ZW4/ZnVuY3Rpb24oQixDKXtpZighQyYmQiYmQi50YXJnZXQpe0M9Qi50YXJnZXQ7fWlmKEMpe24ubGlzdGVuKHoscSx4LEIsQyxzKTt9fTpmdW5jdGlvbihCLEMpe2lmKCFDJiZCJiZCLnRhcmdldCl7Qz1CLnRhcmdldDsKfWlmKEMpe2soeixxLHgsQixDKTt9fTtpZighcil7cj17fTt9cltzXT17bWF0Y2g6dSxmbjpvLGRlbGVnYXRvcjpBfTt0W3BdPXI7cmV0dXJuIGYuY2FsbCh0aGlzLHYsQSxuLmNhcHR1cmUpO30scmVtb3ZlRXZlbnQ6ZnVuY3Rpb24ocixuLHQsdSl7dmFyIHE9dGhpcy5yZXRyaWV2ZSgiJGRlbGVnYXRlcyIse30pLHA9cVtyXTsKaWYoIXApe3JldHVybiB0aGlzO31pZih1KXt2YXIgbT1yLHc9cFt1XS5kZWxlZ2F0b3IsbD1hW3JdfHx7fTtyPWwuYmFzZXx8bTtpZihsLnJlbW92ZSl7bC5yZW1vdmUodGhpcyx1KTt9ZGVsZXRlIHBbdV07cVttXT1wO3JldHVybiBqLmNhbGwodGhpcyxyLHcpO312YXIgbyx2OwppZih0KXtmb3IobyBpbiBwKXt2PXBbb107aWYodi5tYXRjaD09biYmdi5mbj09dCl7cmV0dXJuIGcucmVtb3ZlRXZlbnQuY2FsbCh0aGlzLHIsbix0LG8pO319fWVsc2V7Zm9yKG8gaW4gcCl7dj1wW29dO2lmKHYubWF0Y2g9PW4pe2cucmVtb3ZlRXZlbnQuY2FsbCh0aGlzLHIsbix2LmZuLG8pOwp9fX1yZXR1cm4gdGhpczt9fTtbRWxlbWVudCxXaW5kb3csRG9jdW1lbnRdLmludm9rZSgiaW1wbGVtZW50Iix7YWRkRXZlbnQ6ZShmLGcuYWRkRXZlbnQpLHJlbW92ZUV2ZW50OmUoaixnLnJlbW92ZUV2ZW50KX0pO30pKCk7KGZ1bmN0aW9uKCl7dmFyIGg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKaC5zdHlsZS5oZWlnaHQ9IjAiO2guYXBwZW5kQ2hpbGQoZSk7dmFyIGQ9KGUub2Zmc2V0UGFyZW50PT09aCk7aD1lPW51bGw7dmFyIGw9ZnVuY3Rpb24obSl7cmV0dXJuIGsobSwicG9zaXRpb24iKSE9InN0YXRpYyJ8fGEobSk7fTt2YXIgaT1mdW5jdGlvbihtKXtyZXR1cm4gbChtKXx8KC9eKD86dGFibGV8dGR8dGgpJC9pKS50ZXN0KG0udGFnTmFtZSk7Cn07RWxlbWVudC5pbXBsZW1lbnQoe3Njcm9sbFRvOmZ1bmN0aW9uKG0sbil7aWYoYSh0aGlzKSl7dGhpcy5nZXRXaW5kb3coKS5zY3JvbGxUbyhtLG4pO31lbHNle3RoaXMuc2Nyb2xsTGVmdD1tO3RoaXMuc2Nyb2xsVG9wPW47fXJldHVybiB0aGlzO30sZ2V0U2l6ZTpmdW5jdGlvbigpe2lmKGEodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldFNpemUoKTsKfXJldHVybnt4OnRoaXMub2Zmc2V0V2lkdGgseTp0aGlzLm9mZnNldEhlaWdodH07fSxnZXRTY3JvbGxTaXplOmZ1bmN0aW9uKCl7aWYoYSh0aGlzKSl7cmV0dXJuIHRoaXMuZ2V0V2luZG93KCkuZ2V0U2Nyb2xsU2l6ZSgpO31yZXR1cm57eDp0aGlzLnNjcm9sbFdpZHRoLHk6dGhpcy5zY3JvbGxIZWlnaHR9Owp9LGdldFNjcm9sbDpmdW5jdGlvbigpe2lmKGEodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldFNjcm9sbCgpO31yZXR1cm57eDp0aGlzLnNjcm9sbExlZnQseTp0aGlzLnNjcm9sbFRvcH07fSxnZXRTY3JvbGxzOmZ1bmN0aW9uKCl7dmFyIG49dGhpcy5wYXJlbnROb2RlLG09e3g6MCx5OjB9Owp3aGlsZShuJiYhYShuKSl7bS54Kz1uLnNjcm9sbExlZnQ7bS55Kz1uLnNjcm9sbFRvcDtuPW4ucGFyZW50Tm9kZTt9cmV0dXJuIG07fSxnZXRPZmZzZXRQYXJlbnQ6ZD9mdW5jdGlvbigpe3ZhciBtPXRoaXM7aWYoYShtKXx8ayhtLCJwb3NpdGlvbiIpPT0iZml4ZWQiKXtyZXR1cm4gbnVsbDsKfXZhciBuPShrKG0sInBvc2l0aW9uIik9PSJzdGF0aWMiKT9pOmw7d2hpbGUoKG09bS5wYXJlbnROb2RlKSl7aWYobihtKSl7cmV0dXJuIG07fX1yZXR1cm4gbnVsbDt9OmZ1bmN0aW9uKCl7dmFyIG09dGhpcztpZihhKG0pfHxrKG0sInBvc2l0aW9uIik9PSJmaXhlZCIpe3JldHVybiBudWxsOwp9dHJ5e3JldHVybiBtLm9mZnNldFBhcmVudDt9Y2F0Y2gobil7fXJldHVybiBudWxsO30sZ2V0T2Zmc2V0czpmdW5jdGlvbigpe2lmKHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0JiYhQnJvd3Nlci5QbGF0Zm9ybS5pb3Mpe3ZhciByPXRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbz1kb2N1bWVudC5pZCh0aGlzLmdldERvY3VtZW50KCkuZG9jdW1lbnRFbGVtZW50KSxxPW8uZ2V0U2Nyb2xsKCksdD10aGlzLmdldFNjcm9sbHMoKSxzPShrKHRoaXMsInBvc2l0aW9uIik9PSJmaXhlZCIpOwpyZXR1cm57eDpyLmxlZnQudG9JbnQoKSt0LngrKChzKT8wOnEueCktby5jbGllbnRMZWZ0LHk6ci50b3AudG9JbnQoKSt0LnkrKChzKT8wOnEueSktby5jbGllbnRUb3B9O312YXIgbj10aGlzLG09e3g6MCx5OjB9O2lmKGEodGhpcykpe3JldHVybiBtO313aGlsZShuJiYhYShuKSl7bS54Kz1uLm9mZnNldExlZnQ7Cm0ueSs9bi5vZmZzZXRUb3A7aWYoQnJvd3Nlci5maXJlZm94KXtpZighYyhuKSl7bS54Kz1iKG4pO20ueSs9ZyhuKTt9dmFyIHA9bi5wYXJlbnROb2RlO2lmKHAmJmsocCwib3ZlcmZsb3ciKSE9InZpc2libGUiKXttLngrPWIocCk7bS55Kz1nKHApO319ZWxzZXtpZihuIT10aGlzJiZCcm93c2VyLnNhZmFyaSl7bS54Kz1iKG4pOwptLnkrPWcobik7fX1uPW4ub2Zmc2V0UGFyZW50O31pZihCcm93c2VyLmZpcmVmb3gmJiFjKHRoaXMpKXttLngtPWIodGhpcyk7bS55LT1nKHRoaXMpO31yZXR1cm4gbTt9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKHApe3ZhciBxPXRoaXMuZ2V0T2Zmc2V0cygpLG49dGhpcy5nZXRTY3JvbGxzKCk7CnZhciBtPXt4OnEueC1uLngseTpxLnktbi55fTtpZihwJiYocD1kb2N1bWVudC5pZChwKSkpe3ZhciBvPXAuZ2V0UG9zaXRpb24oKTtyZXR1cm57eDptLngtby54LWIocCkseTptLnktby55LWcocCl9O31yZXR1cm4gbTt9LGdldENvb3JkaW5hdGVzOmZ1bmN0aW9uKG8pe2lmKGEodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldENvb3JkaW5hdGVzKCk7Cn12YXIgbT10aGlzLmdldFBvc2l0aW9uKG8pLG49dGhpcy5nZXRTaXplKCk7dmFyIHA9e2xlZnQ6bS54LHRvcDptLnksd2lkdGg6bi54LGhlaWdodDpuLnl9O3AucmlnaHQ9cC5sZWZ0K3Aud2lkdGg7cC5ib3R0b209cC50b3ArcC5oZWlnaHQ7cmV0dXJuIHA7fSxjb21wdXRlUG9zaXRpb246ZnVuY3Rpb24obSl7cmV0dXJue2xlZnQ6bS54LWoodGhpcywibWFyZ2luLWxlZnQiKSx0b3A6bS55LWoodGhpcywibWFyZ2luLXRvcCIpfTsKfSxzZXRQb3NpdGlvbjpmdW5jdGlvbihtKXtyZXR1cm4gdGhpcy5zZXRTdHlsZXModGhpcy5jb21wdXRlUG9zaXRpb24obSkpO319KTtbRG9jdW1lbnQsV2luZG93XS5pbnZva2UoImltcGxlbWVudCIse2dldFNpemU6ZnVuY3Rpb24oKXt2YXIgbT1mKHRoaXMpO3JldHVybnt4Om0uY2xpZW50V2lkdGgseTptLmNsaWVudEhlaWdodH07Cn0sZ2V0U2Nyb2xsOmZ1bmN0aW9uKCl7dmFyIG49dGhpcy5nZXRXaW5kb3coKSxtPWYodGhpcyk7cmV0dXJue3g6bi5wYWdlWE9mZnNldHx8bS5zY3JvbGxMZWZ0LHk6bi5wYWdlWU9mZnNldHx8bS5zY3JvbGxUb3B9O30sZ2V0U2Nyb2xsU2l6ZTpmdW5jdGlvbigpe3ZhciBvPWYodGhpcyksbj10aGlzLmdldFNpemUoKSxtPXRoaXMuZ2V0RG9jdW1lbnQoKS5ib2R5OwpyZXR1cm57eDpNYXRoLm1heChvLnNjcm9sbFdpZHRoLG0uc2Nyb2xsV2lkdGgsbi54KSx5Ok1hdGgubWF4KG8uc2Nyb2xsSGVpZ2h0LG0uc2Nyb2xsSGVpZ2h0LG4ueSl9O30sZ2V0UG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm57eDowLHk6MH07fSxnZXRDb29yZGluYXRlczpmdW5jdGlvbigpe3ZhciBtPXRoaXMuZ2V0U2l6ZSgpOwpyZXR1cm57dG9wOjAsbGVmdDowLGJvdHRvbTptLnkscmlnaHQ6bS54LGhlaWdodDptLnksd2lkdGg6bS54fTt9fSk7dmFyIGs9RWxlbWVudC5nZXRDb21wdXRlZFN0eWxlO2Z1bmN0aW9uIGoobSxuKXtyZXR1cm4gayhtLG4pLnRvSW50KCl8fDA7fWZ1bmN0aW9uIGMobSl7cmV0dXJuIGsobSwiLW1vei1ib3gtc2l6aW5nIik9PSJib3JkZXItYm94IjsKfWZ1bmN0aW9uIGcobSl7cmV0dXJuIGoobSwiYm9yZGVyLXRvcC13aWR0aCIpO31mdW5jdGlvbiBiKG0pe3JldHVybiBqKG0sImJvcmRlci1sZWZ0LXdpZHRoIik7fWZ1bmN0aW9uIGEobSl7cmV0dXJuKC9eKD86Ym9keXxodG1sKSQvaSkudGVzdChtLnRhZ05hbWUpOwp9ZnVuY3Rpb24gZihtKXt2YXIgbj1tLmdldERvY3VtZW50KCk7cmV0dXJuKCFuLmNvbXBhdE1vZGV8fG4uY29tcGF0TW9kZT09IkNTUzFDb21wYXQiKT9uLmh0bWw6bi5ib2R5O319KSgpO0VsZW1lbnQuYWxpYXMoe3Bvc2l0aW9uOiJzZXRQb3NpdGlvbiJ9KTtbV2luZG93LERvY3VtZW50LEVsZW1lbnRdLmludm9rZSgiaW1wbGVtZW50Iix7Z2V0SGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2l6ZSgpLnk7Cn0sZ2V0V2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTaXplKCkueDt9LGdldFNjcm9sbFRvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbCgpLnk7fSxnZXRTY3JvbGxMZWZ0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2Nyb2xsKCkueDsKfSxnZXRTY3JvbGxIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTY3JvbGxTaXplKCkueTt9LGdldFNjcm9sbFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2Nyb2xsU2l6ZSgpLng7fSxnZXRUb3A6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRQb3NpdGlvbigpLnk7Cn0sZ2V0TGVmdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFBvc2l0aW9uKCkueDt9fSk7KGZ1bmN0aW9uKCl7dmFyIGY9dGhpcy5GeD1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6W0NoYWluLEV2ZW50cyxPcHRpb25zXSxvcHRpb25zOntmcHM6NjAsdW5pdDpmYWxzZSxkdXJhdGlvbjo1MDAsZnJhbWVzOm51bGwsZnJhbWVTa2lwOnRydWUsbGluazoiaWdub3JlIn0saW5pdGlhbGl6ZTpmdW5jdGlvbihnKXt0aGlzLnN1YmplY3Q9dGhpcy5zdWJqZWN0fHx0aGlzOwp0aGlzLnNldE9wdGlvbnMoZyk7fSxnZXRUcmFuc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGcpe3JldHVybiAtKE1hdGguY29zKE1hdGguUEkqZyktMSkvMjt9O30sc3RlcDpmdW5jdGlvbihnKXtpZih0aGlzLm9wdGlvbnMuZnJhbWVTa2lwKXt2YXIgaD0odGhpcy50aW1lIT1udWxsKT8oZy10aGlzLnRpbWUpOjAsaT1oL3RoaXMuZnJhbWVJbnRlcnZhbDsKdGhpcy50aW1lPWc7dGhpcy5mcmFtZSs9aTt9ZWxzZXt0aGlzLmZyYW1lKys7fWlmKHRoaXMuZnJhbWU8dGhpcy5mcmFtZXMpe3ZhciBqPXRoaXMudHJhbnNpdGlvbih0aGlzLmZyYW1lL3RoaXMuZnJhbWVzKTt0aGlzLnNldCh0aGlzLmNvbXB1dGUodGhpcy5mcm9tLHRoaXMudG8saikpOwp9ZWxzZXt0aGlzLmZyYW1lPXRoaXMuZnJhbWVzO3RoaXMuc2V0KHRoaXMuY29tcHV0ZSh0aGlzLmZyb20sdGhpcy50bywxKSk7dGhpcy5zdG9wKCk7fX0sc2V0OmZ1bmN0aW9uKGcpe3JldHVybiBnO30sY29tcHV0ZTpmdW5jdGlvbihpLGgsZyl7cmV0dXJuIGYuY29tcHV0ZShpLGgsZyk7Cn0sY2hlY2s6ZnVuY3Rpb24oKXtpZighdGhpcy5pc1J1bm5pbmcoKSl7cmV0dXJuIHRydWU7fXN3aXRjaCh0aGlzLm9wdGlvbnMubGluayl7Y2FzZSJjYW5jZWwiOnRoaXMuY2FuY2VsKCk7cmV0dXJuIHRydWU7Y2FzZSJjaGFpbiI6dGhpcy5jaGFpbih0aGlzLmNhbGxlci5wYXNzKGFyZ3VtZW50cyx0aGlzKSk7CnJldHVybiBmYWxzZTt9cmV0dXJuIGZhbHNlO30sc3RhcnQ6ZnVuY3Rpb24oayxqKXtpZighdGhpcy5jaGVjayhrLGopKXtyZXR1cm4gdGhpczt9dGhpcy5mcm9tPWs7dGhpcy50bz1qO3RoaXMuZnJhbWU9KHRoaXMub3B0aW9ucy5mcmFtZVNraXApPzA6LTE7dGhpcy50aW1lPW51bGw7CnRoaXMudHJhbnNpdGlvbj10aGlzLmdldFRyYW5zaXRpb24oKTt2YXIgaT10aGlzLm9wdGlvbnMuZnJhbWVzLGg9dGhpcy5vcHRpb25zLmZwcyxnPXRoaXMub3B0aW9ucy5kdXJhdGlvbjt0aGlzLmR1cmF0aW9uPWYuRHVyYXRpb25zW2ddfHxnLnRvSW50KCk7dGhpcy5mcmFtZUludGVydmFsPTEwMDAvaDsKdGhpcy5mcmFtZXM9aXx8TWF0aC5yb3VuZCh0aGlzLmR1cmF0aW9uL3RoaXMuZnJhbWVJbnRlcnZhbCk7dGhpcy5maXJlRXZlbnQoInN0YXJ0Iix0aGlzLnN1YmplY3QpO2IuY2FsbCh0aGlzLGgpO3JldHVybiB0aGlzO30sc3RvcDpmdW5jdGlvbigpe2lmKHRoaXMuaXNSdW5uaW5nKCkpe3RoaXMudGltZT1udWxsOwpkLmNhbGwodGhpcyx0aGlzLm9wdGlvbnMuZnBzKTtpZih0aGlzLmZyYW1lcz09dGhpcy5mcmFtZSl7dGhpcy5maXJlRXZlbnQoImNvbXBsZXRlIix0aGlzLnN1YmplY3QpO2lmKCF0aGlzLmNhbGxDaGFpbigpKXt0aGlzLmZpcmVFdmVudCgiY2hhaW5Db21wbGV0ZSIsdGhpcy5zdWJqZWN0KTsKfX1lbHNle3RoaXMuZmlyZUV2ZW50KCJzdG9wIix0aGlzLnN1YmplY3QpO319cmV0dXJuIHRoaXM7fSxjYW5jZWw6ZnVuY3Rpb24oKXtpZih0aGlzLmlzUnVubmluZygpKXt0aGlzLnRpbWU9bnVsbDtkLmNhbGwodGhpcyx0aGlzLm9wdGlvbnMuZnBzKTt0aGlzLmZyYW1lPXRoaXMuZnJhbWVzOwp0aGlzLmZpcmVFdmVudCgiY2FuY2VsIix0aGlzLnN1YmplY3QpLmNsZWFyQ2hhaW4oKTt9cmV0dXJuIHRoaXM7fSxwYXVzZTpmdW5jdGlvbigpe2lmKHRoaXMuaXNSdW5uaW5nKCkpe3RoaXMudGltZT1udWxsO2QuY2FsbCh0aGlzLHRoaXMub3B0aW9ucy5mcHMpO31yZXR1cm4gdGhpczsKfSxyZXN1bWU6ZnVuY3Rpb24oKXtpZigodGhpcy5mcmFtZTx0aGlzLmZyYW1lcykmJiF0aGlzLmlzUnVubmluZygpKXtiLmNhbGwodGhpcyx0aGlzLm9wdGlvbnMuZnBzKTt9cmV0dXJuIHRoaXM7fSxpc1J1bm5pbmc6ZnVuY3Rpb24oKXt2YXIgZz1lW3RoaXMub3B0aW9ucy5mcHNdOwpyZXR1cm4gZyYmZy5jb250YWlucyh0aGlzKTt9fSk7Zi5jb21wdXRlPWZ1bmN0aW9uKGksaCxnKXtyZXR1cm4oaC1pKSpnK2k7fTtmLkR1cmF0aW9ucz17InNob3J0IjoyNTAsbm9ybWFsOjUwMCwibG9uZyI6MTAwMH07dmFyIGU9e30sYz17fTt2YXIgYT1mdW5jdGlvbigpe3ZhciBoPURhdGUubm93KCk7CmZvcih2YXIgaj10aGlzLmxlbmd0aDtqLS07KXt2YXIgZz10aGlzW2pdO2lmKGcpe2cuc3RlcChoKTt9fX07dmFyIGI9ZnVuY3Rpb24oaCl7dmFyIGc9ZVtoXXx8KGVbaF09W10pO2cucHVzaCh0aGlzKTtpZighY1toXSl7Y1toXT1hLnBlcmlvZGljYWwoTWF0aC5yb3VuZCgxMDAwL2gpLGcpOwp9fTt2YXIgZD1mdW5jdGlvbihoKXt2YXIgZz1lW2hdO2lmKGcpe2cuZXJhc2UodGhpcyk7aWYoIWcubGVuZ3RoJiZjW2hdKXtkZWxldGUgZVtoXTtjW2hdPWNsZWFySW50ZXJ2YWwoY1toXSk7fX19O30pKCk7RnguQ1NTPW5ldyBDbGFzcyh7RXh0ZW5kczpGeCxwcmVwYXJlOmZ1bmN0aW9uKGIsZSxhKXthPUFycmF5LmZyb20oYSk7CnZhciBoPWFbMF0sZz1hWzFdO2lmKGc9PW51bGwpe2c9aDtoPWIuZ2V0U3R5bGUoZSk7dmFyIGM9dGhpcy5vcHRpb25zLnVuaXQ7aWYoYyYmaC5zbGljZSgtYy5sZW5ndGgpIT1jJiZwYXJzZUZsb2F0KGgpIT0wKXtiLnNldFN0eWxlKGUsZytjKTt2YXIgZD1iLmdldENvbXB1dGVkU3R5bGUoZSk7CmlmKCEoL3B4JC8udGVzdChkKSkpe2Q9Yi5zdHlsZVsoInBpeGVsLSIrZSkuY2FtZWxDYXNlKCldO2lmKGQ9PW51bGwpe3ZhciBmPWIuc3R5bGUubGVmdDtiLnN0eWxlLmxlZnQ9ZytjO2Q9Yi5zdHlsZS5waXhlbExlZnQ7Yi5zdHlsZS5sZWZ0PWY7fX1oPShnfHwxKS8ocGFyc2VGbG9hdChkKXx8MSkqKHBhcnNlRmxvYXQoaCl8fDApOwpiLnNldFN0eWxlKGUsaCtjKTt9fXJldHVybntmcm9tOnRoaXMucGFyc2UoaCksdG86dGhpcy5wYXJzZShnKX07fSxwYXJzZTpmdW5jdGlvbihhKXthPUZ1bmN0aW9uLmZyb20oYSkoKTthPSh0eXBlb2YgYT09InN0cmluZyIpP2Euc3BsaXQoIiAiKTpBcnJheS5mcm9tKGEpOwpyZXR1cm4gYS5tYXAoZnVuY3Rpb24oYyl7Yz1TdHJpbmcoYyk7dmFyIGI9ZmFsc2U7T2JqZWN0LmVhY2goRnguQ1NTLlBhcnNlcnMsZnVuY3Rpb24oZixlKXtpZihiKXtyZXR1cm47fXZhciBkPWYucGFyc2UoYyk7aWYoZHx8ZD09PTApe2I9e3ZhbHVlOmQscGFyc2VyOmZ9Owp9fSk7Yj1ifHx7dmFsdWU6YyxwYXJzZXI6RnguQ1NTLlBhcnNlcnMuU3RyaW5nfTtyZXR1cm4gYjt9KTt9LGNvbXB1dGU6ZnVuY3Rpb24oZCxjLGIpe3ZhciBhPVtdOyhNYXRoLm1pbihkLmxlbmd0aCxjLmxlbmd0aCkpLnRpbWVzKGZ1bmN0aW9uKGUpe2EucHVzaCh7dmFsdWU6ZFtlXS5wYXJzZXIuY29tcHV0ZShkW2VdLnZhbHVlLGNbZV0udmFsdWUsYikscGFyc2VyOmRbZV0ucGFyc2VyfSk7Cn0pO2EuJGZhbWlseT1GdW5jdGlvbi5mcm9tKCJmeDpjc3M6dmFsdWUiKTtyZXR1cm4gYTt9LHNlcnZlOmZ1bmN0aW9uKGMsYil7aWYodHlwZU9mKGMpIT0iZng6Y3NzOnZhbHVlIil7Yz10aGlzLnBhcnNlKGMpO312YXIgYT1bXTtjLmVhY2goZnVuY3Rpb24oZCl7YT1hLmNvbmNhdChkLnBhcnNlci5zZXJ2ZShkLnZhbHVlLGIpKTsKfSk7cmV0dXJuIGE7fSxyZW5kZXI6ZnVuY3Rpb24oYSxkLGMsYil7YS5zZXRTdHlsZShkLHRoaXMuc2VydmUoYyxiKSk7fSxzZWFyY2g6ZnVuY3Rpb24oYSl7aWYoRnguQ1NTLkNhY2hlW2FdKXtyZXR1cm4gRnguQ1NTLkNhY2hlW2FdO312YXIgYz17fSxiPW5ldyBSZWdFeHAoIl4iK2EuZXNjYXBlUmVnRXhwKCkrIiQiKTsKQXJyYXkuZWFjaChkb2N1bWVudC5zdHlsZVNoZWV0cyxmdW5jdGlvbihmLGUpe3ZhciBkPWYuaHJlZjtpZihkJiZkLmNvbnRhaW5zKCI6Ly8iKSYmIWQuY29udGFpbnMoZG9jdW1lbnQuZG9tYWluKSl7cmV0dXJuO312YXIgZz1mLnJ1bGVzfHxmLmNzc1J1bGVzO0FycmF5LmVhY2goZyxmdW5jdGlvbihrLGgpe2lmKCFrLnN0eWxlKXtyZXR1cm47Cn12YXIgaj0oay5zZWxlY3RvclRleHQpP2suc2VsZWN0b3JUZXh0LnJlcGxhY2UoL15cdysvLGZ1bmN0aW9uKGkpe3JldHVybiBpLnRvTG93ZXJDYXNlKCk7fSk6bnVsbDtpZighanx8IWIudGVzdChqKSl7cmV0dXJuO31PYmplY3QuZWFjaChFbGVtZW50LlN0eWxlcyxmdW5jdGlvbihsLGkpe2lmKCFrLnN0eWxlW2ldfHxFbGVtZW50LlNob3J0U3R5bGVzW2ldKXtyZXR1cm47Cn1sPVN0cmluZyhrLnN0eWxlW2ldKTtjW2ldPSgoL15yZ2IvKS50ZXN0KGwpKT9sLnJnYlRvSGV4KCk6bDt9KTt9KTt9KTtyZXR1cm4gRnguQ1NTLkNhY2hlW2FdPWM7fX0pO0Z4LkNTUy5DYWNoZT17fTtGeC5DU1MuUGFyc2Vycz17Q29sb3I6e3BhcnNlOmZ1bmN0aW9uKGEpe2lmKGEubWF0Y2goL14jWzAtOWEtZl17Myw2fSQvaSkpe3JldHVybiBhLmhleFRvUmdiKHRydWUpOwp9cmV0dXJuKChhPWEubWF0Y2goLyhcZCspLFxzKihcZCspLFxzKihcZCspLykpKT9bYVsxXSxhWzJdLGFbM11dOmZhbHNlO30sY29tcHV0ZTpmdW5jdGlvbihjLGIsYSl7cmV0dXJuIGMubWFwKGZ1bmN0aW9uKGUsZCl7cmV0dXJuIE1hdGgucm91bmQoRnguY29tcHV0ZShjW2RdLGJbZF0sYSkpOwp9KTt9LHNlcnZlOmZ1bmN0aW9uKGEpe3JldHVybiBhLm1hcChOdW1iZXIpO319LE51bWJlcjp7cGFyc2U6cGFyc2VGbG9hdCxjb21wdXRlOkZ4LmNvbXB1dGUsc2VydmU6ZnVuY3Rpb24oYixhKXtyZXR1cm4oYSk/YithOmI7fX0sU3RyaW5nOntwYXJzZTpGdW5jdGlvbi5mcm9tKGZhbHNlKSxjb21wdXRlOmZ1bmN0aW9uKGIsYSl7cmV0dXJuIGE7Cn0sc2VydmU6ZnVuY3Rpb24oYSl7cmV0dXJuIGE7fX19O0Z4LlR3ZWVuPW5ldyBDbGFzcyh7RXh0ZW5kczpGeC5DU1MsaW5pdGlhbGl6ZTpmdW5jdGlvbihiLGEpe3RoaXMuZWxlbWVudD10aGlzLnN1YmplY3Q9ZG9jdW1lbnQuaWQoYik7dGhpcy5wYXJlbnQoYSk7fSxzZXQ6ZnVuY3Rpb24oYixhKXtpZihhcmd1bWVudHMubGVuZ3RoPT0xKXthPWI7CmI9dGhpcy5wcm9wZXJ0eXx8dGhpcy5vcHRpb25zLnByb3BlcnR5O310aGlzLnJlbmRlcih0aGlzLmVsZW1lbnQsYixhLHRoaXMub3B0aW9ucy51bml0KTtyZXR1cm4gdGhpczt9LHN0YXJ0OmZ1bmN0aW9uKGMsZSxkKXtpZighdGhpcy5jaGVjayhjLGUsZCkpe3JldHVybiB0aGlzOwp9dmFyIGI9QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpO3RoaXMucHJvcGVydHk9dGhpcy5vcHRpb25zLnByb3BlcnR5fHxiLnNoaWZ0KCk7dmFyIGE9dGhpcy5wcmVwYXJlKHRoaXMuZWxlbWVudCx0aGlzLnByb3BlcnR5LGIpO3JldHVybiB0aGlzLnBhcmVudChhLmZyb20sYS50byk7Cn19KTtFbGVtZW50LlByb3BlcnRpZXMudHdlZW49e3NldDpmdW5jdGlvbihhKXt0aGlzLmdldCgidHdlZW4iKS5jYW5jZWwoKS5zZXRPcHRpb25zKGEpO3JldHVybiB0aGlzO30sZ2V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yZXRyaWV2ZSgidHdlZW4iKTtpZighYSl7YT1uZXcgRnguVHdlZW4odGhpcyx7bGluazoiY2FuY2VsIn0pOwp0aGlzLnN0b3JlKCJ0d2VlbiIsYSk7fXJldHVybiBhO319O0VsZW1lbnQuaW1wbGVtZW50KHt0d2VlbjpmdW5jdGlvbihhLGMsYil7dGhpcy5nZXQoInR3ZWVuIikuc3RhcnQoYSxjLGIpO3JldHVybiB0aGlzO30sZmFkZTpmdW5jdGlvbihkKXt2YXIgZT10aGlzLmdldCgidHdlZW4iKSxnLGM9WyJvcGFjaXR5Il0uYXBwZW5kKGFyZ3VtZW50cyksYTsKaWYoY1sxXT09bnVsbCl7Y1sxXT0idG9nZ2xlIjt9c3dpdGNoKGNbMV0pe2Nhc2UiaW4iOmc9InN0YXJ0IjtjWzFdPTE7YnJlYWs7Y2FzZSJvdXQiOmc9InN0YXJ0IjtjWzFdPTA7YnJlYWs7Y2FzZSJzaG93IjpnPSJzZXQiO2NbMV09MTticmVhaztjYXNlImhpZGUiOmc9InNldCI7CmNbMV09MDticmVhaztjYXNlInRvZ2dsZSI6dmFyIGI9dGhpcy5yZXRyaWV2ZSgiZmFkZTpmbGFnIix0aGlzLmdldFN0eWxlKCJvcGFjaXR5Iik9PTEpO2c9InN0YXJ0IjtjWzFdPWI/MDoxO3RoaXMuc3RvcmUoImZhZGU6ZmxhZyIsIWIpO2E9dHJ1ZTticmVhaztkZWZhdWx0Omc9InN0YXJ0IjsKfWlmKCFhKXt0aGlzLmVsaW1pbmF0ZSgiZmFkZTpmbGFnIik7fWVbZ10uYXBwbHkoZSxjKTt2YXIgZj1jW2MubGVuZ3RoLTFdO2lmKGc9PSJzZXQifHxmIT0wKXt0aGlzLnNldFN0eWxlKCJ2aXNpYmlsaXR5IixmPT0wPyJoaWRkZW4iOiJ2aXNpYmxlIik7fWVsc2V7ZS5jaGFpbihmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5zZXRTdHlsZSgidmlzaWJpbGl0eSIsImhpZGRlbiIpOwp0aGlzLmNhbGxDaGFpbigpO30pO31yZXR1cm4gdGhpczt9LGhpZ2hsaWdodDpmdW5jdGlvbihjLGEpe2lmKCFhKXthPXRoaXMucmV0cmlldmUoImhpZ2hsaWdodDpvcmlnaW5hbCIsdGhpcy5nZXRTdHlsZSgiYmFja2dyb3VuZC1jb2xvciIpKTthPShhPT0idHJhbnNwYXJlbnQiKT8iI2ZmZiI6YTsKfXZhciBiPXRoaXMuZ2V0KCJ0d2VlbiIpO2Iuc3RhcnQoImJhY2tncm91bmQtY29sb3IiLGN8fCIjZmZmZjg4IixhKS5jaGFpbihmdW5jdGlvbigpe3RoaXMuc2V0U3R5bGUoImJhY2tncm91bmQtY29sb3IiLHRoaXMucmV0cmlldmUoImhpZ2hsaWdodDpvcmlnaW5hbCIpKTsKYi5jYWxsQ2hhaW4oKTt9LmJpbmQodGhpcykpO3JldHVybiB0aGlzO319KTtGeC5Nb3JwaD1uZXcgQ2xhc3Moe0V4dGVuZHM6RnguQ1NTLGluaXRpYWxpemU6ZnVuY3Rpb24oYixhKXt0aGlzLmVsZW1lbnQ9dGhpcy5zdWJqZWN0PWRvY3VtZW50LmlkKGIpO3RoaXMucGFyZW50KGEpOwp9LHNldDpmdW5jdGlvbihhKXtpZih0eXBlb2YgYT09InN0cmluZyIpe2E9dGhpcy5zZWFyY2goYSk7fWZvcih2YXIgYiBpbiBhKXt0aGlzLnJlbmRlcih0aGlzLmVsZW1lbnQsYixhW2JdLHRoaXMub3B0aW9ucy51bml0KTt9cmV0dXJuIHRoaXM7fSxjb21wdXRlOmZ1bmN0aW9uKGUsZCxjKXt2YXIgYT17fTsKZm9yKHZhciBiIGluIGUpe2FbYl09dGhpcy5wYXJlbnQoZVtiXSxkW2JdLGMpO31yZXR1cm4gYTt9LHN0YXJ0OmZ1bmN0aW9uKGIpe2lmKCF0aGlzLmNoZWNrKGIpKXtyZXR1cm4gdGhpczt9aWYodHlwZW9mIGI9PSJzdHJpbmciKXtiPXRoaXMuc2VhcmNoKGIpO312YXIgZT17fSxkPXt9Owpmb3IodmFyIGMgaW4gYil7dmFyIGE9dGhpcy5wcmVwYXJlKHRoaXMuZWxlbWVudCxjLGJbY10pO2VbY109YS5mcm9tO2RbY109YS50bzt9cmV0dXJuIHRoaXMucGFyZW50KGUsZCk7fX0pO0VsZW1lbnQuUHJvcGVydGllcy5tb3JwaD17c2V0OmZ1bmN0aW9uKGEpe3RoaXMuZ2V0KCJtb3JwaCIpLmNhbmNlbCgpLnNldE9wdGlvbnMoYSk7CnJldHVybiB0aGlzO30sZ2V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yZXRyaWV2ZSgibW9ycGgiKTtpZighYSl7YT1uZXcgRnguTW9ycGgodGhpcyx7bGluazoiY2FuY2VsIn0pO3RoaXMuc3RvcmUoIm1vcnBoIixhKTt9cmV0dXJuIGE7fX07RWxlbWVudC5pbXBsZW1lbnQoe21vcnBoOmZ1bmN0aW9uKGEpe3RoaXMuZ2V0KCJtb3JwaCIpLnN0YXJ0KGEpOwpyZXR1cm4gdGhpczt9fSk7RnguaW1wbGVtZW50KHtnZXRUcmFuc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLnRyYW5zaXRpb258fEZ4LlRyYW5zaXRpb25zLlNpbmUuZWFzZUluT3V0O2lmKHR5cGVvZiBhPT0ic3RyaW5nIil7dmFyIGI9YS5zcGxpdCgiOiIpOwphPUZ4LlRyYW5zaXRpb25zO2E9YVtiWzBdXXx8YVtiWzBdLmNhcGl0YWxpemUoKV07aWYoYlsxXSl7YT1hWyJlYXNlIitiWzFdLmNhcGl0YWxpemUoKSsoYlsyXT9iWzJdLmNhcGl0YWxpemUoKToiIildO319cmV0dXJuIGE7fX0pO0Z4LlRyYW5zaXRpb249ZnVuY3Rpb24oYyxiKXtiPUFycmF5LmZyb20oYik7CnZhciBhPWZ1bmN0aW9uKGQpe3JldHVybiBjKGQsYik7fTtyZXR1cm4gT2JqZWN0LmFwcGVuZChhLHtlYXNlSW46YSxlYXNlT3V0OmZ1bmN0aW9uKGQpe3JldHVybiAxLWMoMS1kLGIpO30sZWFzZUluT3V0OmZ1bmN0aW9uKGQpe3JldHVybihkPD0wLjU/YygyKmQsYik6KDItYygyKigxLWQpLGIpKSkvMjsKfX0pO307RnguVHJhbnNpdGlvbnM9e2xpbmVhcjpmdW5jdGlvbihhKXtyZXR1cm4gYTt9fTtGeC5UcmFuc2l0aW9ucy5leHRlbmQ9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiIGluIGEpe0Z4LlRyYW5zaXRpb25zW2JdPW5ldyBGeC5UcmFuc2l0aW9uKGFbYl0pO319O0Z4LlRyYW5zaXRpb25zLmV4dGVuZCh7UG93OmZ1bmN0aW9uKGIsYSl7cmV0dXJuIE1hdGgucG93KGIsYSYmYVswXXx8Nik7Cn0sRXhwbzpmdW5jdGlvbihhKXtyZXR1cm4gTWF0aC5wb3coMiw4KihhLTEpKTt9LENpcmM6ZnVuY3Rpb24oYSl7cmV0dXJuIDEtTWF0aC5zaW4oTWF0aC5hY29zKGEpKTt9LFNpbmU6ZnVuY3Rpb24oYSl7cmV0dXJuIDEtTWF0aC5jb3MoYSpNYXRoLlBJLzIpO30sQmFjazpmdW5jdGlvbihiLGEpe2E9YSYmYVswXXx8MS42MTg7CnJldHVybiBNYXRoLnBvdyhiLDIpKigoYSsxKSpiLWEpO30sQm91bmNlOmZ1bmN0aW9uKGYpe3ZhciBlO2Zvcih2YXIgZD0wLGM9MTsxO2QrPWMsYy89Mil7aWYoZj49KDctNCpkKS8xMSl7ZT1jKmMtTWF0aC5wb3coKDExLTYqZC0xMSpmKS80LDIpO2JyZWFrO319cmV0dXJuIGU7Cn0sRWxhc3RpYzpmdW5jdGlvbihiLGEpe3JldHVybiBNYXRoLnBvdygyLDEwKi0tYikqTWF0aC5jb3MoMjAqYipNYXRoLlBJKihhJiZhWzBdfHwxKS8zKTt9fSk7WyJRdWFkIiwiQ3ViaWMiLCJRdWFydCIsIlF1aW50Il0uZWFjaChmdW5jdGlvbihiLGEpe0Z4LlRyYW5zaXRpb25zW2JdPW5ldyBGeC5UcmFuc2l0aW9uKGZ1bmN0aW9uKGMpe3JldHVybiBNYXRoLnBvdyhjLGErMik7Cn0pO30pOyhmdW5jdGlvbigpe3ZhciBkPWZ1bmN0aW9uKCl7fSxhPSgib25wcm9ncmVzcyIgaW4gbmV3IEJyb3dzZXIuUmVxdWVzdCk7dmFyIGM9dGhpcy5SZXF1ZXN0PW5ldyBDbGFzcyh7SW1wbGVtZW50czpbQ2hhaW4sRXZlbnRzLE9wdGlvbnNdLG9wdGlvbnM6e3VybDoiIixkYXRhOiIiLGhlYWRlcnM6eyJYLVJlcXVlc3RlZC1XaXRoIjoiWE1MSHR0cFJlcXVlc3QiLEFjY2VwdDoidGV4dC9qYXZhc2NyaXB0LCB0ZXh0L2h0bWwsIGFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwsICovKiJ9LGFzeW5jOnRydWUsZm9ybWF0OmZhbHNlLG1ldGhvZDoicG9zdCIsbGluazoiaWdub3JlIixpc1N1Y2Nlc3M6bnVsbCxlbXVsYXRpb246dHJ1ZSx1cmxFbmNvZGVkOnRydWUsZW5jb2Rpbmc6InV0Zi04IixldmFsU2NyaXB0czpmYWxzZSxldmFsUmVzcG9uc2U6ZmFsc2UsdGltZW91dDowLG5vQ2FjaGU6ZmFsc2V9LGluaXRpYWxpemU6ZnVuY3Rpb24oZSl7dGhpcy54aHI9bmV3IEJyb3dzZXIuUmVxdWVzdCgpOwp0aGlzLnNldE9wdGlvbnMoZSk7dGhpcy5oZWFkZXJzPXRoaXMub3B0aW9ucy5oZWFkZXJzO30sb25TdGF0ZUNoYW5nZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMueGhyO2lmKGUucmVhZHlTdGF0ZSE9NHx8IXRoaXMucnVubmluZyl7cmV0dXJuO310aGlzLnJ1bm5pbmc9ZmFsc2U7CnRoaXMuc3RhdHVzPTA7RnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3ZhciBmPWUuc3RhdHVzO3RoaXMuc3RhdHVzPShmPT0xMjIzKT8yMDQ6Zjt9LmJpbmQodGhpcykpO2Uub25yZWFkeXN0YXRlY2hhbmdlPWQ7aWYoYSl7ZS5vbnByb2dyZXNzPWUub25sb2Fkc3RhcnQ9ZDsKfWNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTt0aGlzLnJlc3BvbnNlPXt0ZXh0OnRoaXMueGhyLnJlc3BvbnNlVGV4dHx8IiIseG1sOnRoaXMueGhyLnJlc3BvbnNlWE1MfTtpZih0aGlzLm9wdGlvbnMuaXNTdWNjZXNzLmNhbGwodGhpcyx0aGlzLnN0YXR1cykpe3RoaXMuc3VjY2Vzcyh0aGlzLnJlc3BvbnNlLnRleHQsdGhpcy5yZXNwb25zZS54bWwpOwp9ZWxzZXt0aGlzLmZhaWx1cmUoKTt9fSxpc1N1Y2Nlc3M6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnN0YXR1cztyZXR1cm4oZT49MjAwJiZlPDMwMCk7fSxpc1J1bm5pbmc6ZnVuY3Rpb24oKXtyZXR1cm4gISF0aGlzLnJ1bm5pbmc7fSxwcm9jZXNzU2NyaXB0czpmdW5jdGlvbihlKXtpZih0aGlzLm9wdGlvbnMuZXZhbFJlc3BvbnNlfHwoLyhlY21hfGphdmEpc2NyaXB0LykudGVzdCh0aGlzLmdldEhlYWRlcigiQ29udGVudC10eXBlIikpKXtyZXR1cm4gQnJvd3Nlci5leGVjKGUpOwp9cmV0dXJuIGUuc3RyaXBTY3JpcHRzKHRoaXMub3B0aW9ucy5ldmFsU2NyaXB0cyk7fSxzdWNjZXNzOmZ1bmN0aW9uKGYsZSl7dGhpcy5vblN1Y2Nlc3ModGhpcy5wcm9jZXNzU2NyaXB0cyhmKSxlKTt9LG9uU3VjY2VzczpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJjb21wbGV0ZSIsYXJndW1lbnRzKS5maXJlRXZlbnQoInN1Y2Nlc3MiLGFyZ3VtZW50cykuY2FsbENoYWluKCk7Cn0sZmFpbHVyZTpmdW5jdGlvbigpe3RoaXMub25GYWlsdXJlKCk7fSxvbkZhaWx1cmU6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiKS5maXJlRXZlbnQoImZhaWx1cmUiLHRoaXMueGhyKTt9LGxvYWRzdGFydDpmdW5jdGlvbihlKXt0aGlzLmZpcmVFdmVudCgibG9hZHN0YXJ0IixbZSx0aGlzLnhocl0pOwp9LHByb2dyZXNzOmZ1bmN0aW9uKGUpe3RoaXMuZmlyZUV2ZW50KCJwcm9ncmVzcyIsW2UsdGhpcy54aHJdKTt9LHRpbWVvdXQ6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgidGltZW91dCIsdGhpcy54aHIpO30sc2V0SGVhZGVyOmZ1bmN0aW9uKGUsZil7dGhpcy5oZWFkZXJzW2VdPWY7CnJldHVybiB0aGlzO30sZ2V0SGVhZGVyOmZ1bmN0aW9uKGUpe3JldHVybiBGdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueGhyLmdldFJlc3BvbnNlSGVhZGVyKGUpO30uYmluZCh0aGlzKSk7fSxjaGVjazpmdW5jdGlvbigpe2lmKCF0aGlzLnJ1bm5pbmcpe3JldHVybiB0cnVlOwp9c3dpdGNoKHRoaXMub3B0aW9ucy5saW5rKXtjYXNlImNhbmNlbCI6dGhpcy5jYW5jZWwoKTtyZXR1cm4gdHJ1ZTtjYXNlImNoYWluIjp0aGlzLmNoYWluKHRoaXMuY2FsbGVyLnBhc3MoYXJndW1lbnRzLHRoaXMpKTtyZXR1cm4gZmFsc2U7fXJldHVybiBmYWxzZTt9LHNlbmQ6ZnVuY3Rpb24obyl7aWYoIXRoaXMuY2hlY2sobykpe3JldHVybiB0aGlzOwp9dGhpcy5vcHRpb25zLmlzU3VjY2Vzcz10aGlzLm9wdGlvbnMuaXNTdWNjZXNzfHx0aGlzLmlzU3VjY2Vzczt0aGlzLnJ1bm5pbmc9dHJ1ZTt2YXIgbD10eXBlT2Yobyk7aWYobD09InN0cmluZyJ8fGw9PSJlbGVtZW50Iil7bz17ZGF0YTpvfTt9dmFyIGg9dGhpcy5vcHRpb25zOwpvPU9iamVjdC5hcHBlbmQoe2RhdGE6aC5kYXRhLHVybDpoLnVybCxtZXRob2Q6aC5tZXRob2R9LG8pO3ZhciBqPW8uZGF0YSxmPVN0cmluZyhvLnVybCksZT1vLm1ldGhvZC50b0xvd2VyQ2FzZSgpO3N3aXRjaCh0eXBlT2Yoaikpe2Nhc2UiZWxlbWVudCI6aj1kb2N1bWVudC5pZChqKS50b1F1ZXJ5U3RyaW5nKCk7CmJyZWFrO2Nhc2Uib2JqZWN0IjpjYXNlImhhc2giOmo9T2JqZWN0LnRvUXVlcnlTdHJpbmcoaik7fWlmKHRoaXMub3B0aW9ucy5mb3JtYXQpe3ZhciBtPSJmb3JtYXQ9Iit0aGlzLm9wdGlvbnMuZm9ybWF0O2o9KGopP20rIiYiK2o6bTt9aWYodGhpcy5vcHRpb25zLmVtdWxhdGlvbiYmIVsiZ2V0IiwicG9zdCJdLmNvbnRhaW5zKGUpKXt2YXIgaz0iX21ldGhvZD0iK2U7Cmo9KGopP2srIiYiK2o6aztlPSJwb3N0Ijt9aWYodGhpcy5vcHRpb25zLnVybEVuY29kZWQmJlsicG9zdCIsInB1dCJdLmNvbnRhaW5zKGUpKXt2YXIgZz0odGhpcy5vcHRpb25zLmVuY29kaW5nKT8iOyBjaGFyc2V0PSIrdGhpcy5vcHRpb25zLmVuY29kaW5nOiIiO3RoaXMuaGVhZGVyc1siQ29udGVudC10eXBlIl09ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIrZzsKfWlmKCFmKXtmPWRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lO312YXIgaT1mLmxhc3RJbmRleE9mKCIvIik7aWYoaT4tMSYmKGk9Zi5pbmRleE9mKCIjIikpPi0xKXtmPWYuc3Vic3RyKDAsaSk7fWlmKHRoaXMub3B0aW9ucy5ub0NhY2hlKXtmKz0oZi5jb250YWlucygiPyIpPyImIjoiPyIpK1N0cmluZy51bmlxdWVJRCgpOwp9aWYoaiYmZT09ImdldCIpe2YrPShmLmNvbnRhaW5zKCI/Iik/IiYiOiI/IikrajtqPW51bGw7fXZhciBuPXRoaXMueGhyO2lmKGEpe24ub25sb2Fkc3RhcnQ9dGhpcy5sb2Fkc3RhcnQuYmluZCh0aGlzKTtuLm9ucHJvZ3Jlc3M9dGhpcy5wcm9ncmVzcy5iaW5kKHRoaXMpOwp9bi5vcGVuKGUudG9VcHBlckNhc2UoKSxmLHRoaXMub3B0aW9ucy5hc3luYyx0aGlzLm9wdGlvbnMudXNlcix0aGlzLm9wdGlvbnMucGFzc3dvcmQpO2lmKHRoaXMub3B0aW9ucy51c2VyJiYid2l0aENyZWRlbnRpYWxzIiBpbiBuKXtuLndpdGhDcmVkZW50aWFscz10cnVlOwp9bi5vbnJlYWR5c3RhdGVjaGFuZ2U9dGhpcy5vblN0YXRlQ2hhbmdlLmJpbmQodGhpcyk7T2JqZWN0LmVhY2godGhpcy5oZWFkZXJzLGZ1bmN0aW9uKHEscCl7dHJ5e24uc2V0UmVxdWVzdEhlYWRlcihwLHEpO31jYXRjaChyKXt0aGlzLmZpcmVFdmVudCgiZXhjZXB0aW9uIixbcCxxXSk7Cn19LHRoaXMpO3RoaXMuZmlyZUV2ZW50KCJyZXF1ZXN0Iik7bi5zZW5kKGopO2lmKCF0aGlzLm9wdGlvbnMuYXN5bmMpe3RoaXMub25TdGF0ZUNoYW5nZSgpO31lbHNle2lmKHRoaXMub3B0aW9ucy50aW1lb3V0KXt0aGlzLnRpbWVyPXRoaXMudGltZW91dC5kZWxheSh0aGlzLm9wdGlvbnMudGltZW91dCx0aGlzKTsKfX1yZXR1cm4gdGhpczt9LGNhbmNlbDpmdW5jdGlvbigpe2lmKCF0aGlzLnJ1bm5pbmcpe3JldHVybiB0aGlzO310aGlzLnJ1bm5pbmc9ZmFsc2U7dmFyIGU9dGhpcy54aHI7ZS5hYm9ydCgpO2NsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtlLm9ucmVhZHlzdGF0ZWNoYW5nZT1kOwppZihhKXtlLm9ucHJvZ3Jlc3M9ZS5vbmxvYWRzdGFydD1kO310aGlzLnhocj1uZXcgQnJvd3Nlci5SZXF1ZXN0KCk7dGhpcy5maXJlRXZlbnQoImNhbmNlbCIpO3JldHVybiB0aGlzO319KTt2YXIgYj17fTtbImdldCIsInBvc3QiLCJwdXQiLCJkZWxldGUiLCJHRVQiLCJQT1NUIiwiUFVUIiwiREVMRVRFIl0uZWFjaChmdW5jdGlvbihlKXtiW2VdPWZ1bmN0aW9uKGcpe3ZhciBmPXttZXRob2Q6ZX07CmlmKGchPW51bGwpe2YuZGF0YT1nO31yZXR1cm4gdGhpcy5zZW5kKGYpO307fSk7Yy5pbXBsZW1lbnQoYik7RWxlbWVudC5Qcm9wZXJ0aWVzLnNlbmQ9e3NldDpmdW5jdGlvbihlKXt2YXIgZj10aGlzLmdldCgic2VuZCIpLmNhbmNlbCgpO2Yuc2V0T3B0aW9ucyhlKTsKcmV0dXJuIHRoaXM7fSxnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnJldHJpZXZlKCJzZW5kIik7aWYoIWUpe2U9bmV3IGMoe2RhdGE6dGhpcyxsaW5rOiJjYW5jZWwiLG1ldGhvZDp0aGlzLmdldCgibWV0aG9kIil8fCJwb3N0Iix1cmw6dGhpcy5nZXQoImFjdGlvbiIpfSk7CnRoaXMuc3RvcmUoInNlbmQiLGUpO31yZXR1cm4gZTt9fTtFbGVtZW50LmltcGxlbWVudCh7c2VuZDpmdW5jdGlvbihlKXt2YXIgZj10aGlzLmdldCgic2VuZCIpO2Yuc2VuZCh7ZGF0YTp0aGlzLHVybDplfHxmLm9wdGlvbnMudXJsfSk7cmV0dXJuIHRoaXM7fX0pO30pKCk7ClJlcXVlc3QuSFRNTD1uZXcgQ2xhc3Moe0V4dGVuZHM6UmVxdWVzdCxvcHRpb25zOnt1cGRhdGU6ZmFsc2UsYXBwZW5kOmZhbHNlLGV2YWxTY3JpcHRzOnRydWUsZmlsdGVyOmZhbHNlLGhlYWRlcnM6e0FjY2VwdDoidGV4dC9odG1sLCBhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sLCAqLyoifX0sc3VjY2VzczpmdW5jdGlvbihmKXt2YXIgZT10aGlzLm9wdGlvbnMsYz10aGlzLnJlc3BvbnNlOwpjLmh0bWw9Zi5zdHJpcFNjcmlwdHMoZnVuY3Rpb24oaCl7Yy5qYXZhc2NyaXB0PWg7fSk7dmFyIGQ9Yy5odG1sLm1hdGNoKC88Ym9keVtePl0qPihbXHNcU10qPyk8XC9ib2R5Pi9pKTtpZihkKXtjLmh0bWw9ZFsxXTt9dmFyIGI9bmV3IEVsZW1lbnQoImRpdiIpLnNldCgiaHRtbCIsYy5odG1sKTsKYy50cmVlPWIuY2hpbGROb2RlcztjLmVsZW1lbnRzPWIuZ2V0RWxlbWVudHMoZS5maWx0ZXJ8fCIqIik7aWYoZS5maWx0ZXIpe2MudHJlZT1jLmVsZW1lbnRzO31pZihlLnVwZGF0ZSl7dmFyIGc9ZG9jdW1lbnQuaWQoZS51cGRhdGUpLmVtcHR5KCk7aWYoZS5maWx0ZXIpe2cuYWRvcHQoYy5lbGVtZW50cyk7Cn1lbHNle2cuc2V0KCJodG1sIixjLmh0bWwpO319ZWxzZXtpZihlLmFwcGVuZCl7dmFyIGE9ZG9jdW1lbnQuaWQoZS5hcHBlbmQpO2lmKGUuZmlsdGVyKXtjLmVsZW1lbnRzLnJldmVyc2UoKS5pbmplY3QoYSk7fWVsc2V7YS5hZG9wdChiLmdldENoaWxkcmVuKCkpO319fWlmKGUuZXZhbFNjcmlwdHMpe0Jyb3dzZXIuZXhlYyhjLmphdmFzY3JpcHQpOwp9dGhpcy5vblN1Y2Nlc3MoYy50cmVlLGMuZWxlbWVudHMsYy5odG1sLGMuamF2YXNjcmlwdCk7fX0pO0VsZW1lbnQuUHJvcGVydGllcy5sb2FkPXtzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXQoImxvYWQiKS5jYW5jZWwoKTtiLnNldE9wdGlvbnMoYSk7cmV0dXJuIHRoaXM7Cn0sZ2V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yZXRyaWV2ZSgibG9hZCIpO2lmKCFhKXthPW5ldyBSZXF1ZXN0LkhUTUwoe2RhdGE6dGhpcyxsaW5rOiJjYW5jZWwiLHVwZGF0ZTp0aGlzLG1ldGhvZDoiZ2V0In0pO3RoaXMuc3RvcmUoImxvYWQiLGEpO31yZXR1cm4gYTsKfX07RWxlbWVudC5pbXBsZW1lbnQoe2xvYWQ6ZnVuY3Rpb24oKXt0aGlzLmdldCgibG9hZCIpLnNlbmQoQXJyYXkubGluayhhcmd1bWVudHMse2RhdGE6VHlwZS5pc09iamVjdCx1cmw6VHlwZS5pc1N0cmluZ30pKTtyZXR1cm4gdGhpczt9fSk7aWYodHlwZW9mIEpTT049PSJ1bmRlZmluZWQiKXt0aGlzLkpTT049e307Cn0oZnVuY3Rpb24oKXt2YXIgc3BlY2lhbD17IlxiIjoiXFxiIiwiXHQiOiJcXHQiLCJcbiI6IlxcbiIsIlxmIjoiXFxmIiwiXHIiOiJcXHIiLCciJzonXFwiJywiXFwiOiJcXFxcIn07dmFyIGVzY2FwZT1mdW5jdGlvbihjaHIpe3JldHVybiBzcGVjaWFsW2Nocl18fCJcXHUiKygiMDAwMCIrY2hyLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpKS5zbGljZSgtNCk7Cn07SlNPTi52YWxpZGF0ZT1mdW5jdGlvbihzdHJpbmcpe3N0cmluZz1zdHJpbmcucmVwbGFjZSgvXFwoPzpbIlxcXC9iZm5ydF18dVswLTlhLWZBLUZdezR9KS9nLCJAIikucmVwbGFjZSgvIlteIlxcXG5ccl0qInx0cnVlfGZhbHNlfG51bGx8LT9cZCsoPzpcLlxkKik/KD86W2VFXVsrXC1dP1xkKyk/L2csIl0iKS5yZXBsYWNlKC8oPzpefDp8LCkoPzpccypcWykrL2csIiIpOwpyZXR1cm4oL15bXF0sOnt9XHNdKiQvKS50ZXN0KHN0cmluZyk7fTtKU09OLmVuY29kZT1KU09OLnN0cmluZ2lmeT9mdW5jdGlvbihvYmope3JldHVybiBKU09OLnN0cmluZ2lmeShvYmopO306ZnVuY3Rpb24ob2JqKXtpZihvYmomJm9iai50b0pTT04pe29iaj1vYmoudG9KU09OKCk7Cn1zd2l0Y2godHlwZU9mKG9iaikpe2Nhc2Uic3RyaW5nIjpyZXR1cm4nIicrb2JqLnJlcGxhY2UoL1tceDAwLVx4MWZcXCJdL2csZXNjYXBlKSsnIic7Y2FzZSJhcnJheSI6cmV0dXJuIlsiK29iai5tYXAoSlNPTi5lbmNvZGUpLmNsZWFuKCkrIl0iO2Nhc2Uib2JqZWN0IjpjYXNlImhhc2giOnZhciBzdHJpbmc9W107Ck9iamVjdC5lYWNoKG9iaixmdW5jdGlvbih2YWx1ZSxrZXkpe3ZhciBqc29uPUpTT04uZW5jb2RlKHZhbHVlKTtpZihqc29uKXtzdHJpbmcucHVzaChKU09OLmVuY29kZShrZXkpKyI6Iitqc29uKTt9fSk7cmV0dXJuInsiK3N0cmluZysifSI7Y2FzZSJudW1iZXIiOmNhc2UiYm9vbGVhbiI6cmV0dXJuIiIrb2JqOwpjYXNlIm51bGwiOnJldHVybiJudWxsIjt9cmV0dXJuIG51bGw7fTtKU09OLmRlY29kZT1mdW5jdGlvbihzdHJpbmcsc2VjdXJlKXtpZighc3RyaW5nfHx0eXBlT2Yoc3RyaW5nKSE9InN0cmluZyIpe3JldHVybiBudWxsO31pZihzZWN1cmV8fEpTT04uc2VjdXJlKXtpZihKU09OLnBhcnNlKXtyZXR1cm4gSlNPTi5wYXJzZShzdHJpbmcpOwp9aWYoIUpTT04udmFsaWRhdGUoc3RyaW5nKSl7dGhyb3cgbmV3IEVycm9yKCJKU09OIGNvdWxkIG5vdCBkZWNvZGUgdGhlIGlucHV0OyBzZWN1cml0eSBpcyBlbmFibGVkIGFuZCB0aGUgdmFsdWUgaXMgbm90IHNlY3VyZS4iKTt9fXJldHVybiBldmFsKCIoIitzdHJpbmcrIikiKTsKfTt9KSgpO1JlcXVlc3QuSlNPTj1uZXcgQ2xhc3Moe0V4dGVuZHM6UmVxdWVzdCxvcHRpb25zOntzZWN1cmU6dHJ1ZX0saW5pdGlhbGl6ZTpmdW5jdGlvbihhKXt0aGlzLnBhcmVudChhKTtPYmplY3QuYXBwZW5kKHRoaXMuaGVhZGVycyx7QWNjZXB0OiJhcHBsaWNhdGlvbi9qc29uIiwiWC1SZXF1ZXN0IjoiSlNPTiJ9KTsKfSxzdWNjZXNzOmZ1bmN0aW9uKGMpe3ZhciBiO3RyeXtiPXRoaXMucmVzcG9uc2UuanNvbj1KU09OLmRlY29kZShjLHRoaXMub3B0aW9ucy5zZWN1cmUpO31jYXRjaChhKXt0aGlzLmZpcmVFdmVudCgiZXJyb3IiLFtjLGFdKTtyZXR1cm47fWlmKGI9PW51bGwpe3RoaXMub25GYWlsdXJlKCk7Cn1lbHNle3RoaXMub25TdWNjZXNzKGIsYyk7fX19KTt2YXIgQ29va2llPW5ldyBDbGFzcyh7SW1wbGVtZW50czpPcHRpb25zLG9wdGlvbnM6e3BhdGg6Ii8iLGRvbWFpbjpmYWxzZSxkdXJhdGlvbjpmYWxzZSxzZWN1cmU6ZmFsc2UsZG9jdW1lbnQ6ZG9jdW1lbnQsZW5jb2RlOnRydWV9LGluaXRpYWxpemU6ZnVuY3Rpb24oYixhKXt0aGlzLmtleT1iOwp0aGlzLnNldE9wdGlvbnMoYSk7fSx3cml0ZTpmdW5jdGlvbihiKXtpZih0aGlzLm9wdGlvbnMuZW5jb2RlKXtiPWVuY29kZVVSSUNvbXBvbmVudChiKTt9aWYodGhpcy5vcHRpb25zLmRvbWFpbil7Yis9IjsgZG9tYWluPSIrdGhpcy5vcHRpb25zLmRvbWFpbjt9aWYodGhpcy5vcHRpb25zLnBhdGgpe2IrPSI7IHBhdGg9Iit0aGlzLm9wdGlvbnMucGF0aDsKfWlmKHRoaXMub3B0aW9ucy5kdXJhdGlvbil7dmFyIGE9bmV3IERhdGUoKTthLnNldFRpbWUoYS5nZXRUaW1lKCkrdGhpcy5vcHRpb25zLmR1cmF0aW9uKjI0KjYwKjYwKjEwMDApO2IrPSI7IGV4cGlyZXM9IithLnRvR01UU3RyaW5nKCk7fWlmKHRoaXMub3B0aW9ucy5zZWN1cmUpe2IrPSI7IHNlY3VyZSI7Cn10aGlzLm9wdGlvbnMuZG9jdW1lbnQuY29va2llPXRoaXMua2V5KyI9IitiO3JldHVybiB0aGlzO30scmVhZDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5kb2N1bWVudC5jb29raWUubWF0Y2goIig/Ol58OylcXHMqIit0aGlzLmtleS5lc2NhcGVSZWdFeHAoKSsiPShbXjtdKikiKTsKcmV0dXJuKGEpP2RlY29kZVVSSUNvbXBvbmVudChhWzFdKTpudWxsO30sZGlzcG9zZTpmdW5jdGlvbigpe25ldyBDb29raWUodGhpcy5rZXksT2JqZWN0Lm1lcmdlKHt9LHRoaXMub3B0aW9ucyx7ZHVyYXRpb246LTF9KSkud3JpdGUoIiIpO3JldHVybiB0aGlzO319KTsKQ29va2llLndyaXRlPWZ1bmN0aW9uKGIsYyxhKXtyZXR1cm4gbmV3IENvb2tpZShiLGEpLndyaXRlKGMpO307Q29va2llLnJlYWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBDb29raWUoYSkucmVhZCgpO307Q29va2llLmRpc3Bvc2U9ZnVuY3Rpb24oYixhKXtyZXR1cm4gbmV3IENvb2tpZShiLGEpLmRpc3Bvc2UoKTsKfTsoZnVuY3Rpb24oaSxrKXt2YXIgbCxmLGU9W10sYyxiLGQ9ay5jcmVhdGVFbGVtZW50KCJkaXYiKTt2YXIgZz1mdW5jdGlvbigpe2NsZWFyVGltZW91dChiKTtpZihsKXtyZXR1cm47fUJyb3dzZXIubG9hZGVkPWw9dHJ1ZTtrLnJlbW92ZUxpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixnKS5yZW1vdmVMaXN0ZW5lcigicmVhZHlzdGF0ZWNoYW5nZSIsYSk7CmsuZmlyZUV2ZW50KCJkb21yZWFkeSIpO2kuZmlyZUV2ZW50KCJkb21yZWFkeSIpO307dmFyIGE9ZnVuY3Rpb24oKXtmb3IodmFyIG09ZS5sZW5ndGg7bS0tOyl7aWYoZVttXSgpKXtnKCk7cmV0dXJuIHRydWU7fX1yZXR1cm4gZmFsc2U7fTt2YXIgaj1mdW5jdGlvbigpe2NsZWFyVGltZW91dChiKTsKaWYoIWEoKSl7Yj1zZXRUaW1lb3V0KGosMTApO319O2suYWRkTGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLGcpO3ZhciBoPWZ1bmN0aW9uKCl7dHJ5e2QuZG9TY3JvbGwoKTtyZXR1cm4gdHJ1ZTt9Y2F0Y2gobSl7fXJldHVybiBmYWxzZTt9O2lmKGQuZG9TY3JvbGwmJiFoKCkpe2UucHVzaChoKTsKYz10cnVlO31pZihrLnJlYWR5U3RhdGUpe2UucHVzaChmdW5jdGlvbigpe3ZhciBtPWsucmVhZHlTdGF0ZTtyZXR1cm4obT09ImxvYWRlZCJ8fG09PSJjb21wbGV0ZSIpO30pO31pZigib25yZWFkeXN0YXRlY2hhbmdlIiBpbiBrKXtrLmFkZExpc3RlbmVyKCJyZWFkeXN0YXRlY2hhbmdlIixhKTsKfWVsc2V7Yz10cnVlO31pZihjKXtqKCk7fUVsZW1lbnQuRXZlbnRzLmRvbXJlYWR5PXtvbkFkZDpmdW5jdGlvbihtKXtpZihsKXttLmNhbGwodGhpcyk7fX19O0VsZW1lbnQuRXZlbnRzLmxvYWQ9e2Jhc2U6ImxvYWQiLG9uQWRkOmZ1bmN0aW9uKG0pe2lmKGYmJnRoaXM9PWkpe20uY2FsbCh0aGlzKTsKfX0sY29uZGl0aW9uOmZ1bmN0aW9uKCl7aWYodGhpcz09aSl7ZygpO2RlbGV0ZSBFbGVtZW50LkV2ZW50cy5sb2FkO31yZXR1cm4gdHJ1ZTt9fTtpLmFkZEV2ZW50KCJsb2FkIixmdW5jdGlvbigpe2Y9dHJ1ZTt9KTt9KSh3aW5kb3csZG9jdW1lbnQpOyhmdW5jdGlvbigpe3ZhciBTd2lmZj10aGlzLlN3aWZmPW5ldyBDbGFzcyh7SW1wbGVtZW50czpPcHRpb25zLG9wdGlvbnM6e2lkOm51bGwsaGVpZ2h0OjEsd2lkdGg6MSxjb250YWluZXI6bnVsbCxwcm9wZXJ0aWVzOnt9LHBhcmFtczp7cXVhbGl0eToiaGlnaCIsYWxsb3dTY3JpcHRBY2Nlc3M6ImFsd2F5cyIsd01vZGU6IndpbmRvdyIsc3dMaXZlQ29ubmVjdDp0cnVlfSxjYWxsQmFja3M6e30sdmFyczp7fX0sdG9FbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub2JqZWN0Owp9LGluaXRpYWxpemU6ZnVuY3Rpb24ocGF0aCxvcHRpb25zKXt0aGlzLmluc3RhbmNlPSJTd2lmZl8iK1N0cmluZy51bmlxdWVJRCgpO3RoaXMuc2V0T3B0aW9ucyhvcHRpb25zKTtvcHRpb25zPXRoaXMub3B0aW9uczt2YXIgaWQ9dGhpcy5pZD1vcHRpb25zLmlkfHx0aGlzLmluc3RhbmNlOwp2YXIgY29udGFpbmVyPWRvY3VtZW50LmlkKG9wdGlvbnMuY29udGFpbmVyKTtTd2lmZi5DYWxsQmFja3NbdGhpcy5pbnN0YW5jZV09e307dmFyIHBhcmFtcz1vcHRpb25zLnBhcmFtcyx2YXJzPW9wdGlvbnMudmFycyxjYWxsQmFja3M9b3B0aW9ucy5jYWxsQmFja3M7CnZhciBwcm9wZXJ0aWVzPU9iamVjdC5hcHBlbmQoe2hlaWdodDpvcHRpb25zLmhlaWdodCx3aWR0aDpvcHRpb25zLndpZHRofSxvcHRpb25zLnByb3BlcnRpZXMpO3ZhciBzZWxmPXRoaXM7Zm9yKHZhciBjYWxsQmFjayBpbiBjYWxsQmFja3Mpe1N3aWZmLkNhbGxCYWNrc1t0aGlzLmluc3RhbmNlXVtjYWxsQmFja109KGZ1bmN0aW9uKG9wdGlvbil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG9wdGlvbi5hcHBseShzZWxmLm9iamVjdCxhcmd1bWVudHMpOwp9O30pKGNhbGxCYWNrc1tjYWxsQmFja10pO3ZhcnNbY2FsbEJhY2tdPSJTd2lmZi5DYWxsQmFja3MuIit0aGlzLmluc3RhbmNlKyIuIitjYWxsQmFjazt9cGFyYW1zLmZsYXNoVmFycz1PYmplY3QudG9RdWVyeVN0cmluZyh2YXJzKTtpZihCcm93c2VyLmllKXtwcm9wZXJ0aWVzLmNsYXNzaWQ9ImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMCI7CnBhcmFtcy5tb3ZpZT1wYXRoO31lbHNle3Byb3BlcnRpZXMudHlwZT0iYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giO31wcm9wZXJ0aWVzLmRhdGE9cGF0aDt2YXIgYnVpbGQ9JzxvYmplY3QgaWQ9IicraWQrJyInO2Zvcih2YXIgcHJvcGVydHkgaW4gcHJvcGVydGllcyl7YnVpbGQrPSIgIitwcm9wZXJ0eSsnPSInK3Byb3BlcnRpZXNbcHJvcGVydHldKyciJzsKfWJ1aWxkKz0iPiI7Zm9yKHZhciBwYXJhbSBpbiBwYXJhbXMpe2lmKHBhcmFtc1twYXJhbV0pe2J1aWxkKz0nPHBhcmFtIG5hbWU9IicrcGFyYW0rJyIgdmFsdWU9IicrcGFyYW1zW3BhcmFtXSsnIiAvPic7fX1idWlsZCs9Ijwvb2JqZWN0PiI7dGhpcy5vYmplY3Q9KChjb250YWluZXIpP2NvbnRhaW5lci5lbXB0eSgpOm5ldyBFbGVtZW50KCJkaXYiKSkuc2V0KCJodG1sIixidWlsZCkuZmlyc3RDaGlsZDsKfSxyZXBsYWNlczpmdW5jdGlvbihlbGVtZW50KXtlbGVtZW50PWRvY3VtZW50LmlkKGVsZW1lbnQsdHJ1ZSk7ZWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCh0aGlzLnRvRWxlbWVudCgpLGVsZW1lbnQpO3JldHVybiB0aGlzO30saW5qZWN0OmZ1bmN0aW9uKGVsZW1lbnQpe2RvY3VtZW50LmlkKGVsZW1lbnQsdHJ1ZSkuYXBwZW5kQ2hpbGQodGhpcy50b0VsZW1lbnQoKSk7CnJldHVybiB0aGlzO30scmVtb3RlOmZ1bmN0aW9uKCl7cmV0dXJuIFN3aWZmLnJlbW90ZS5hcHBseShTd2lmZixbdGhpcy50b0VsZW1lbnQoKV0uYXBwZW5kKGFyZ3VtZW50cykpO319KTtTd2lmZi5DYWxsQmFja3M9e307U3dpZmYucmVtb3RlPWZ1bmN0aW9uKG9iaixmbil7dmFyIHJzPW9iai5DYWxsRnVuY3Rpb24oJzxpbnZva2UgbmFtZT0iJytmbisnIiByZXR1cm50eXBlPSJqYXZhc2NyaXB0Ij4nK19fZmxhc2hfX2FyZ3VtZW50c1RvWE1MKGFyZ3VtZW50cywyKSsiPC9pbnZva2U+Iik7CnJldHVybiBldmFsKHJzKTt9O30pKCk7",
                "body": "LyoKLS0tCk1vb1Rvb2xzOiB0aGUgamF2YXNjcmlwdCBmcmFtZXdvcmsKCndlYiBidWlsZDoKIC0gaHR0cDovL21vb3Rvb2xzLm5ldC9jb3JlLzc2YmY0NzA2MmQ2YzE5ODNkNjZjZTQ3YWQ2NmFhMGUwCgpwYWNrYWdlciBidWlsZDoKIC0gcGFja2FnZXIgYnVpbGQgQ29yZS9Db3JlIENvcmUvQXJyYXkgQ29yZS9TdHJpbmcgQ29yZS9OdW1iZXIgQ29yZS9GdW5jdGlvbiBDb3JlL09iamVjdCBDb3JlL0V2ZW50IENvcmUvQnJvd3NlciBDb3JlL0NsYXNzIENvcmUvQ2xhc3MuRXh0cmFzIENvcmUvU2xpY2suUGFyc2VyIENvcmUvU2xpY2suRmluZGVyIENvcmUvRWxlbWVudCBDb3JlL0VsZW1lbnQuU3R5bGUgQ29yZS9FbGVtZW50LkV2ZW50IENvcmUvRWxlbWVudC5EZWxlZ2F0aW9uIENvcmUvRWxlbWVudC5EaW1lbnNpb25zIENvcmUvRnggQ29yZS9GeC5DU1MgQ29yZS9GeC5Ud2VlbiBDb3JlL0Z4Lk1vcnBoIENvcmUvRnguVHJhbnNpdGlvbnMgQ29yZS9SZXF1ZXN0IENvcmUvUmVxdWVzdC5IVE1MIENvcmUvUmVxdWVzdC5KU09OIENvcmUvQ29va2llIENvcmUvSlNPTiBDb3JlL0RPTVJlYWR5IENvcmUvU3dpZmYKCmNvcHlyaWdodHM6CiAgLSBbTW9vVG9vbHNdKGh0dHA6Ly9tb290b29scy5uZXQpCgpsaWNlbnNlczoKICAtIFtNSVQgTGljZW5zZV0oaHR0cDovL21vb3Rvb2xzLm5ldC9saWNlbnNlLnR4dCkKLi4uCiovCgooZnVuY3Rpb24oKXt0aGlzLk1vb1Rvb2xzPXt2ZXJzaW9uOiIxLjQuNSIsYnVpbGQ6ImFiOGVhODgyNGRjM2IyNGI2NjY2ODY3YTJjNGVkNThlYmI3NjJjZjAifTt2YXIgbz10aGlzLnR5cGVPZj1mdW5jdGlvbihpKXtpZihpPT1udWxsKXtyZXR1cm4ibnVsbCI7fWlmKGkuJGZhbWlseSE9bnVsbCl7cmV0dXJuIGkuJGZhbWlseSgpOwp9aWYoaS5ub2RlTmFtZSl7aWYoaS5ub2RlVHlwZT09MSl7cmV0dXJuImVsZW1lbnQiO31pZihpLm5vZGVUeXBlPT0zKXtyZXR1cm4oL1xTLykudGVzdChpLm5vZGVWYWx1ZSk/InRleHRub2RlIjoid2hpdGVzcGFjZSI7fX1lbHNle2lmKHR5cGVvZiBpLmxlbmd0aD09Im51bWJlciIpe2lmKGkuY2FsbGVlKXtyZXR1cm4iYXJndW1lbnRzIjsKfWlmKCJpdGVtIiBpbiBpKXtyZXR1cm4iY29sbGVjdGlvbiI7fX19cmV0dXJuIHR5cGVvZiBpO307dmFyIGo9dGhpcy5pbnN0YW5jZU9mPWZ1bmN0aW9uKHQsaSl7aWYodD09bnVsbCl7cmV0dXJuIGZhbHNlO312YXIgcz10LiRjb25zdHJ1Y3Rvcnx8dC5jb25zdHJ1Y3RvcjsKd2hpbGUocyl7aWYocz09PWkpe3JldHVybiB0cnVlO31zPXMucGFyZW50O31pZighdC5oYXNPd25Qcm9wZXJ0eSl7cmV0dXJuIGZhbHNlO31yZXR1cm4gdCBpbnN0YW5jZW9mIGk7fTt2YXIgZj10aGlzLkZ1bmN0aW9uO3ZhciBwPXRydWU7Zm9yKHZhciBrIGluIHt0b1N0cmluZzoxfSl7cD1udWxsOwp9aWYocCl7cD1bImhhc093blByb3BlcnR5IiwidmFsdWVPZiIsImlzUHJvdG90eXBlT2YiLCJwcm9wZXJ0eUlzRW51bWVyYWJsZSIsInRvTG9jYWxlU3RyaW5nIiwidG9TdHJpbmciLCJjb25zdHJ1Y3RvciJdO31mLnByb3RvdHlwZS5vdmVybG9hZFNldHRlcj1mdW5jdGlvbihzKXt2YXIgaT10aGlzOwpyZXR1cm4gZnVuY3Rpb24odSx0KXtpZih1PT1udWxsKXtyZXR1cm4gdGhpczt9aWYoc3x8dHlwZW9mIHUhPSJzdHJpbmciKXtmb3IodmFyIHYgaW4gdSl7aS5jYWxsKHRoaXMsdix1W3ZdKTt9aWYocCl7Zm9yKHZhciB3PXAubGVuZ3RoO3ctLTspe3Y9cFt3XTtpZih1Lmhhc093blByb3BlcnR5KHYpKXtpLmNhbGwodGhpcyx2LHVbdl0pOwp9fX19ZWxzZXtpLmNhbGwodGhpcyx1LHQpO31yZXR1cm4gdGhpczt9O307Zi5wcm90b3R5cGUub3ZlcmxvYWRHZXR0ZXI9ZnVuY3Rpb24ocyl7dmFyIGk9dGhpcztyZXR1cm4gZnVuY3Rpb24odSl7dmFyIHYsdDtpZih0eXBlb2YgdSE9InN0cmluZyIpe3Y9dTt9ZWxzZXtpZihhcmd1bWVudHMubGVuZ3RoPjEpe3Y9YXJndW1lbnRzOwp9ZWxzZXtpZihzKXt2PVt1XTt9fX1pZih2KXt0PXt9O2Zvcih2YXIgdz0wO3c8di5sZW5ndGg7dysrKXt0W3Zbd11dPWkuY2FsbCh0aGlzLHZbd10pO319ZWxzZXt0PWkuY2FsbCh0aGlzLHUpO31yZXR1cm4gdDt9O307Zi5wcm90b3R5cGUuZXh0ZW5kPWZ1bmN0aW9uKGkscyl7dGhpc1tpXT1zOwp9Lm92ZXJsb2FkU2V0dGVyKCk7Zi5wcm90b3R5cGUuaW1wbGVtZW50PWZ1bmN0aW9uKGkscyl7dGhpcy5wcm90b3R5cGVbaV09czt9Lm92ZXJsb2FkU2V0dGVyKCk7dmFyIG49QXJyYXkucHJvdG90eXBlLnNsaWNlO2YuZnJvbT1mdW5jdGlvbihpKXtyZXR1cm4obyhpKT09ImZ1bmN0aW9uIik/aTpmdW5jdGlvbigpe3JldHVybiBpOwp9O307QXJyYXkuZnJvbT1mdW5jdGlvbihpKXtpZihpPT1udWxsKXtyZXR1cm5bXTt9cmV0dXJuKGEuaXNFbnVtZXJhYmxlKGkpJiZ0eXBlb2YgaSE9InN0cmluZyIpPyhvKGkpPT0iYXJyYXkiKT9pOm4uY2FsbChpKTpbaV07fTtOdW1iZXIuZnJvbT1mdW5jdGlvbihzKXt2YXIgaT1wYXJzZUZsb2F0KHMpOwpyZXR1cm4gaXNGaW5pdGUoaSk/aTpudWxsO307U3RyaW5nLmZyb209ZnVuY3Rpb24oaSl7cmV0dXJuIGkrIiI7fTtmLmltcGxlbWVudCh7aGlkZTpmdW5jdGlvbigpe3RoaXMuJGhpZGRlbj10cnVlO3JldHVybiB0aGlzO30scHJvdGVjdDpmdW5jdGlvbigpe3RoaXMuJHByb3RlY3RlZD10cnVlOwpyZXR1cm4gdGhpczt9fSk7dmFyIGE9dGhpcy5UeXBlPWZ1bmN0aW9uKHUsdCl7aWYodSl7dmFyIHM9dS50b0xvd2VyQ2FzZSgpO3ZhciBpPWZ1bmN0aW9uKHYpe3JldHVybihvKHYpPT1zKTt9O2FbImlzIit1XT1pO2lmKHQhPW51bGwpe3QucHJvdG90eXBlLiRmYW1pbHk9KGZ1bmN0aW9uKCl7cmV0dXJuIHM7Cn0pLmhpZGUoKTt9fWlmKHQ9PW51bGwpe3JldHVybiBudWxsO310LmV4dGVuZCh0aGlzKTt0LiRjb25zdHJ1Y3Rvcj1hO3QucHJvdG90eXBlLiRjb25zdHJ1Y3Rvcj10O3JldHVybiB0O307dmFyIGU9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzthLmlzRW51bWVyYWJsZT1mdW5jdGlvbihpKXtyZXR1cm4oaSE9bnVsbCYmdHlwZW9mIGkubGVuZ3RoPT0ibnVtYmVyIiYmZS5jYWxsKGkpIT0iW29iamVjdCBGdW5jdGlvbl0iKTsKfTt2YXIgcT17fTt2YXIgcj1mdW5jdGlvbihpKXt2YXIgcz1vKGkucHJvdG90eXBlKTtyZXR1cm4gcVtzXXx8KHFbc109W10pO307dmFyIGI9ZnVuY3Rpb24odCx4KXtpZih4JiZ4LiRoaWRkZW4pe3JldHVybjt9dmFyIHM9cih0aGlzKTtmb3IodmFyIHU9MDt1PHMubGVuZ3RoOwp1Kyspe3ZhciB3PXNbdV07aWYobyh3KT09InR5cGUiKXtiLmNhbGwodyx0LHgpO31lbHNle3cuY2FsbCh0aGlzLHQseCk7fX12YXIgdj10aGlzLnByb3RvdHlwZVt0XTtpZih2PT1udWxsfHwhdi4kcHJvdGVjdGVkKXt0aGlzLnByb3RvdHlwZVt0XT14O31pZih0aGlzW3RdPT1udWxsJiZvKHgpPT0iZnVuY3Rpb24iKXttLmNhbGwodGhpcyx0LGZ1bmN0aW9uKGkpe3JldHVybiB4LmFwcGx5KGksbi5jYWxsKGFyZ3VtZW50cywxKSk7Cn0pO319O3ZhciBtPWZ1bmN0aW9uKGksdCl7aWYodCYmdC4kaGlkZGVuKXtyZXR1cm47fXZhciBzPXRoaXNbaV07aWYocz09bnVsbHx8IXMuJHByb3RlY3RlZCl7dGhpc1tpXT10O319O2EuaW1wbGVtZW50KHtpbXBsZW1lbnQ6Yi5vdmVybG9hZFNldHRlcigpLGV4dGVuZDptLm92ZXJsb2FkU2V0dGVyKCksYWxpYXM6ZnVuY3Rpb24oaSxzKXtiLmNhbGwodGhpcyxpLHRoaXMucHJvdG90eXBlW3NdKTsKfS5vdmVybG9hZFNldHRlcigpLG1pcnJvcjpmdW5jdGlvbihpKXtyKHRoaXMpLnB1c2goaSk7cmV0dXJuIHRoaXM7fX0pO25ldyBhKCJUeXBlIixhKTt2YXIgZD1mdW5jdGlvbihzLHgsdil7dmFyIHU9KHghPU9iamVjdCksQj14LnByb3RvdHlwZTtpZih1KXt4PW5ldyBhKHMseCk7Cn1mb3IodmFyIHk9MCx3PXYubGVuZ3RoO3k8dzt5Kyspe3ZhciBDPXZbeV0sQT14W0NdLHo9QltDXTtpZihBKXtBLnByb3RlY3QoKTt9aWYodSYmeil7eC5pbXBsZW1lbnQoQyx6LnByb3RlY3QoKSk7fX1pZih1KXt2YXIgdD1CLnByb3BlcnR5SXNFbnVtZXJhYmxlKHZbMF0pOwp4LmZvckVhY2hNZXRob2Q9ZnVuY3Rpb24oRyl7aWYoIXQpe2Zvcih2YXIgRj0wLEQ9di5sZW5ndGg7RjxEO0YrKyl7Ry5jYWxsKEIsQlt2W0ZdXSx2W0ZdKTt9fWZvcih2YXIgRSBpbiBCKXtHLmNhbGwoQixCW0VdLEUpO319O31yZXR1cm4gZDt9O2QoIlN0cmluZyIsU3RyaW5nLFsiY2hhckF0IiwiY2hhckNvZGVBdCIsImNvbmNhdCIsImluZGV4T2YiLCJsYXN0SW5kZXhPZiIsIm1hdGNoIiwicXVvdGUiLCJyZXBsYWNlIiwic2VhcmNoIiwic2xpY2UiLCJzcGxpdCIsInN1YnN0ciIsInN1YnN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsInRvVXBwZXJDYXNlIl0pKCJBcnJheSIsQXJyYXksWyJwb3AiLCJwdXNoIiwicmV2ZXJzZSIsInNoaWZ0Iiwic29ydCIsInNwbGljZSIsInVuc2hpZnQiLCJjb25jYXQiLCJqb2luIiwic2xpY2UiLCJpbmRleE9mIiwibGFzdEluZGV4T2YiLCJmaWx0ZXIiLCJmb3JFYWNoIiwiZXZlcnkiLCJtYXAiLCJzb21lIiwicmVkdWNlIiwicmVkdWNlUmlnaHQiXSkoIk51bWJlciIsTnVtYmVyLFsidG9FeHBvbmVudGlhbCIsInRvRml4ZWQiLCJ0b0xvY2FsZVN0cmluZyIsInRvUHJlY2lzaW9uIl0pKCJGdW5jdGlvbiIsZixbImFwcGx5IiwiY2FsbCIsImJpbmQiXSkoIlJlZ0V4cCIsUmVnRXhwLFsiZXhlYyIsInRlc3QiXSkoIk9iamVjdCIsT2JqZWN0LFsiY3JlYXRlIiwiZGVmaW5lUHJvcGVydHkiLCJkZWZpbmVQcm9wZXJ0aWVzIiwia2V5cyIsImdldFByb3RvdHlwZU9mIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsInByZXZlbnRFeHRlbnNpb25zIiwiaXNFeHRlbnNpYmxlIiwic2VhbCIsImlzU2VhbGVkIiwiZnJlZXplIiwiaXNGcm96ZW4iXSkoIkRhdGUiLERhdGUsWyJub3ciXSk7Ck9iamVjdC5leHRlbmQ9bS5vdmVybG9hZFNldHRlcigpO0RhdGUuZXh0ZW5kKCJub3ciLGZ1bmN0aW9uKCl7cmV0dXJuICsobmV3IERhdGUpO30pO25ldyBhKCJCb29sZWFuIixCb29sZWFuKTtOdW1iZXIucHJvdG90eXBlLiRmYW1pbHk9ZnVuY3Rpb24oKXtyZXR1cm4gaXNGaW5pdGUodGhpcyk/Im51bWJlciI6Im51bGwiOwp9LmhpZGUoKTtOdW1iZXIuZXh0ZW5kKCJyYW5kb20iLGZ1bmN0aW9uKHMsaSl7cmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSooaS1zKzEpK3MpO30pO3ZhciBnPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7T2JqZWN0LmV4dGVuZCgiZm9yRWFjaCIsZnVuY3Rpb24oaSx0LHUpe2Zvcih2YXIgcyBpbiBpKXtpZihnLmNhbGwoaSxzKSl7dC5jYWxsKHUsaVtzXSxzLGkpOwp9fX0pO09iamVjdC5lYWNoPU9iamVjdC5mb3JFYWNoO0FycmF5LmltcGxlbWVudCh7Zm9yRWFjaDpmdW5jdGlvbih1LHYpe2Zvcih2YXIgdD0wLHM9dGhpcy5sZW5ndGg7dDxzO3QrKyl7aWYodCBpbiB0aGlzKXt1LmNhbGwodix0aGlzW3RdLHQsdGhpcyk7fX19LGVhY2g6ZnVuY3Rpb24oaSxzKXtBcnJheS5mb3JFYWNoKHRoaXMsaSxzKTsKcmV0dXJuIHRoaXM7fX0pO3ZhciBsPWZ1bmN0aW9uKGkpe3N3aXRjaChvKGkpKXtjYXNlImFycmF5IjpyZXR1cm4gaS5jbG9uZSgpO2Nhc2Uib2JqZWN0IjpyZXR1cm4gT2JqZWN0LmNsb25lKGkpO2RlZmF1bHQ6cmV0dXJuIGk7fX07QXJyYXkuaW1wbGVtZW50KCJjbG9uZSIsZnVuY3Rpb24oKXt2YXIgcz10aGlzLmxlbmd0aCx0PW5ldyBBcnJheShzKTsKd2hpbGUocy0tKXt0W3NdPWwodGhpc1tzXSk7fXJldHVybiB0O30pO3ZhciBoPWZ1bmN0aW9uKHMsaSx0KXtzd2l0Y2gobyh0KSl7Y2FzZSJvYmplY3QiOmlmKG8oc1tpXSk9PSJvYmplY3QiKXtPYmplY3QubWVyZ2Uoc1tpXSx0KTt9ZWxzZXtzW2ldPU9iamVjdC5jbG9uZSh0KTsKfWJyZWFrO2Nhc2UiYXJyYXkiOnNbaV09dC5jbG9uZSgpO2JyZWFrO2RlZmF1bHQ6c1tpXT10O31yZXR1cm4gczt9O09iamVjdC5leHRlbmQoe21lcmdlOmZ1bmN0aW9uKHosdSx0KXtpZihvKHUpPT0ic3RyaW5nIil7cmV0dXJuIGgoeix1LHQpO31mb3IodmFyIHk9MSxzPWFyZ3VtZW50cy5sZW5ndGg7Cnk8czt5Kyspe3ZhciB3PWFyZ3VtZW50c1t5XTtmb3IodmFyIHggaW4gdyl7aCh6LHgsd1t4XSk7fX1yZXR1cm4gejt9LGNsb25lOmZ1bmN0aW9uKGkpe3ZhciB0PXt9O2Zvcih2YXIgcyBpbiBpKXt0W3NdPWwoaVtzXSk7fXJldHVybiB0O30sYXBwZW5kOmZ1bmN0aW9uKHcpe2Zvcih2YXIgdj0xLHQ9YXJndW1lbnRzLmxlbmd0aDsKdjx0O3YrKyl7dmFyIHM9YXJndW1lbnRzW3ZdfHx7fTtmb3IodmFyIHUgaW4gcyl7d1t1XT1zW3VdO319cmV0dXJuIHc7fX0pO1siT2JqZWN0IiwiV2hpdGVTcGFjZSIsIlRleHROb2RlIiwiQ29sbGVjdGlvbiIsIkFyZ3VtZW50cyJdLmVhY2goZnVuY3Rpb24oaSl7bmV3IGEoaSk7Cn0pO3ZhciBjPURhdGUubm93KCk7U3RyaW5nLmV4dGVuZCgidW5pcXVlSUQiLGZ1bmN0aW9uKCl7cmV0dXJuKGMrKykudG9TdHJpbmcoMzYpO30pO30pKCk7QXJyYXkuaW1wbGVtZW50KHtldmVyeTpmdW5jdGlvbihjLGQpe2Zvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg+Pj4wOwpiPGE7YisrKXtpZigoYiBpbiB0aGlzKSYmIWMuY2FsbChkLHRoaXNbYl0sYix0aGlzKSl7cmV0dXJuIGZhbHNlO319cmV0dXJuIHRydWU7fSxmaWx0ZXI6ZnVuY3Rpb24oZCxmKXt2YXIgYz1bXTtmb3IodmFyIGUsYj0wLGE9dGhpcy5sZW5ndGg+Pj4wO2I8YTtiKyspe2lmKGIgaW4gdGhpcyl7ZT10aGlzW2JdOwppZihkLmNhbGwoZixlLGIsdGhpcykpe2MucHVzaChlKTt9fX1yZXR1cm4gYzt9LGluZGV4T2Y6ZnVuY3Rpb24oYyxkKXt2YXIgYj10aGlzLmxlbmd0aD4+PjA7Zm9yKHZhciBhPShkPDApP01hdGgubWF4KDAsYitkKTpkfHwwO2E8YjthKyspe2lmKHRoaXNbYV09PT1jKXtyZXR1cm4gYTsKfX1yZXR1cm4gLTE7fSxtYXA6ZnVuY3Rpb24oYyxlKXt2YXIgZD10aGlzLmxlbmd0aD4+PjAsYj1BcnJheShkKTtmb3IodmFyIGE9MDthPGQ7YSsrKXtpZihhIGluIHRoaXMpe2JbYV09Yy5jYWxsKGUsdGhpc1thXSxhLHRoaXMpO319cmV0dXJuIGI7fSxzb21lOmZ1bmN0aW9uKGMsZCl7Zm9yKHZhciBiPTAsYT10aGlzLmxlbmd0aD4+PjA7CmI8YTtiKyspe2lmKChiIGluIHRoaXMpJiZjLmNhbGwoZCx0aGlzW2JdLGIsdGhpcykpe3JldHVybiB0cnVlO319cmV0dXJuIGZhbHNlO30sY2xlYW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oYSl7cmV0dXJuIGEhPW51bGw7fSk7fSxpbnZva2U6ZnVuY3Rpb24oYSl7dmFyIGI9QXJyYXkuc2xpY2UoYXJndW1lbnRzLDEpOwpyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oYyl7cmV0dXJuIGNbYV0uYXBwbHkoYyxiKTt9KTt9LGFzc29jaWF0ZTpmdW5jdGlvbihjKXt2YXIgZD17fSxiPU1hdGgubWluKHRoaXMubGVuZ3RoLGMubGVuZ3RoKTtmb3IodmFyIGE9MDthPGI7YSsrKXtkW2NbYV1dPXRoaXNbYV07Cn1yZXR1cm4gZDt9LGxpbms6ZnVuY3Rpb24oYyl7dmFyIGE9e307Zm9yKHZhciBlPTAsYj10aGlzLmxlbmd0aDtlPGI7ZSsrKXtmb3IodmFyIGQgaW4gYyl7aWYoY1tkXSh0aGlzW2VdKSl7YVtkXT10aGlzW2VdO2RlbGV0ZSBjW2RdO2JyZWFrO319fXJldHVybiBhO30sY29udGFpbnM6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5pbmRleE9mKGEsYikhPS0xOwp9LGFwcGVuZDpmdW5jdGlvbihhKXt0aGlzLnB1c2guYXBwbHkodGhpcyxhKTtyZXR1cm4gdGhpczt9LGdldExhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5sZW5ndGgpP3RoaXNbdGhpcy5sZW5ndGgtMV06bnVsbDt9LGdldFJhbmRvbTpmdW5jdGlvbigpe3JldHVybih0aGlzLmxlbmd0aCk/dGhpc1tOdW1iZXIucmFuZG9tKDAsdGhpcy5sZW5ndGgtMSldOm51bGw7Cn0saW5jbHVkZTpmdW5jdGlvbihhKXtpZighdGhpcy5jb250YWlucyhhKSl7dGhpcy5wdXNoKGEpO31yZXR1cm4gdGhpczt9LGNvbWJpbmU6ZnVuY3Rpb24oYyl7Zm9yKHZhciBiPTAsYT1jLmxlbmd0aDtiPGE7YisrKXt0aGlzLmluY2x1ZGUoY1tiXSk7fXJldHVybiB0aGlzOwp9LGVyYXNlOmZ1bmN0aW9uKGIpe2Zvcih2YXIgYT10aGlzLmxlbmd0aDthLS07KXtpZih0aGlzW2FdPT09Yil7dGhpcy5zcGxpY2UoYSwxKTt9fXJldHVybiB0aGlzO30sZW1wdHk6ZnVuY3Rpb24oKXt0aGlzLmxlbmd0aD0wO3JldHVybiB0aGlzO30sZmxhdHRlbjpmdW5jdGlvbigpe3ZhciBkPVtdOwpmb3IodmFyIGI9MCxhPXRoaXMubGVuZ3RoO2I8YTtiKyspe3ZhciBjPXR5cGVPZih0aGlzW2JdKTtpZihjPT0ibnVsbCIpe2NvbnRpbnVlO31kPWQuY29uY2F0KChjPT0iYXJyYXkifHxjPT0iY29sbGVjdGlvbiJ8fGM9PSJhcmd1bWVudHMifHxpbnN0YW5jZU9mKHRoaXNbYl0sQXJyYXkpKT9BcnJheS5mbGF0dGVuKHRoaXNbYl0pOnRoaXNbYl0pOwp9cmV0dXJuIGQ7fSxwaWNrOmZ1bmN0aW9uKCl7Zm9yKHZhciBiPTAsYT10aGlzLmxlbmd0aDtiPGE7YisrKXtpZih0aGlzW2JdIT1udWxsKXtyZXR1cm4gdGhpc1tiXTt9fXJldHVybiBudWxsO30saGV4VG9SZ2I6ZnVuY3Rpb24oYil7aWYodGhpcy5sZW5ndGghPTMpe3JldHVybiBudWxsOwp9dmFyIGE9dGhpcy5tYXAoZnVuY3Rpb24oYyl7aWYoYy5sZW5ndGg9PTEpe2MrPWM7fXJldHVybiBjLnRvSW50KDE2KTt9KTtyZXR1cm4oYik/YToicmdiKCIrYSsiKSI7fSxyZ2JUb0hleDpmdW5jdGlvbihkKXtpZih0aGlzLmxlbmd0aDwzKXtyZXR1cm4gbnVsbDt9aWYodGhpcy5sZW5ndGg9PTQmJnRoaXNbM109PTAmJiFkKXtyZXR1cm4idHJhbnNwYXJlbnQiOwp9dmFyIGI9W107Zm9yKHZhciBhPTA7YTwzO2ErKyl7dmFyIGM9KHRoaXNbYV0tMCkudG9TdHJpbmcoMTYpO2IucHVzaCgoYy5sZW5ndGg9PTEpPyIwIitjOmMpO31yZXR1cm4oZCk/YjoiIyIrYi5qb2luKCIiKTt9fSk7U3RyaW5nLmltcGxlbWVudCh7dGVzdDpmdW5jdGlvbihhLGIpe3JldHVybigodHlwZU9mKGEpPT0icmVnZXhwIik/YTpuZXcgUmVnRXhwKCIiK2EsYikpLnRlc3QodGhpcyk7Cn0sY29udGFpbnM6ZnVuY3Rpb24oYSxiKXtyZXR1cm4oYik/KGIrdGhpcytiKS5pbmRleE9mKGIrYStiKT4tMTpTdHJpbmcodGhpcykuaW5kZXhPZihhKT4tMTt9LHRyaW06ZnVuY3Rpb24oKXtyZXR1cm4gU3RyaW5nKHRoaXMpLnJlcGxhY2UoL15ccyt8XHMrJC9nLCIiKTsKfSxjbGVhbjpmdW5jdGlvbigpe3JldHVybiBTdHJpbmcodGhpcykucmVwbGFjZSgvXHMrL2csIiAiKS50cmltKCk7fSxjYW1lbENhc2U6ZnVuY3Rpb24oKXtyZXR1cm4gU3RyaW5nKHRoaXMpLnJlcGxhY2UoLy1cRC9nLGZ1bmN0aW9uKGEpe3JldHVybiBhLmNoYXJBdCgxKS50b1VwcGVyQ2FzZSgpOwp9KTt9LGh5cGhlbmF0ZTpmdW5jdGlvbigpe3JldHVybiBTdHJpbmcodGhpcykucmVwbGFjZSgvW0EtWl0vZyxmdW5jdGlvbihhKXtyZXR1cm4oIi0iK2EuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkpO30pO30sY2FwaXRhbGl6ZTpmdW5jdGlvbigpe3JldHVybiBTdHJpbmcodGhpcykucmVwbGFjZSgvXGJbYS16XS9nLGZ1bmN0aW9uKGEpe3JldHVybiBhLnRvVXBwZXJDYXNlKCk7Cn0pO30sZXNjYXBlUmVnRXhwOmZ1bmN0aW9uKCl7cmV0dXJuIFN0cmluZyh0aGlzKS5yZXBsYWNlKC8oWy0uKis/XiR7fSgpfFtcXVwvXFxdKS9nLCJcXCQxIik7fSx0b0ludDpmdW5jdGlvbihhKXtyZXR1cm4gcGFyc2VJbnQodGhpcyxhfHwxMCk7fSx0b0Zsb2F0OmZ1bmN0aW9uKCl7cmV0dXJuIHBhcnNlRmxvYXQodGhpcyk7Cn0saGV4VG9SZ2I6ZnVuY3Rpb24oYil7dmFyIGE9U3RyaW5nKHRoaXMpLm1hdGNoKC9eIz8oXHd7MSwyfSkoXHd7MSwyfSkoXHd7MSwyfSkkLyk7cmV0dXJuKGEpP2Euc2xpY2UoMSkuaGV4VG9SZ2IoYik6bnVsbDt9LHJnYlRvSGV4OmZ1bmN0aW9uKGIpe3ZhciBhPVN0cmluZyh0aGlzKS5tYXRjaCgvXGR7MSwzfS9nKTsKcmV0dXJuKGEpP2EucmdiVG9IZXgoYik6bnVsbDt9LHN1YnN0aXR1dGU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gU3RyaW5nKHRoaXMpLnJlcGxhY2UoYnx8KC9cXD9ceyhbXnt9XSspXH0vZyksZnVuY3Rpb24oZCxjKXtpZihkLmNoYXJBdCgwKT09IlxcIil7cmV0dXJuIGQuc2xpY2UoMSk7Cn1yZXR1cm4oYVtjXSE9bnVsbCk/YVtjXToiIjt9KTt9fSk7TnVtYmVyLmltcGxlbWVudCh7bGltaXQ6ZnVuY3Rpb24oYixhKXtyZXR1cm4gTWF0aC5taW4oYSxNYXRoLm1heChiLHRoaXMpKTt9LHJvdW5kOmZ1bmN0aW9uKGEpe2E9TWF0aC5wb3coMTAsYXx8MCkudG9GaXhlZChhPDA/LWE6MCk7CnJldHVybiBNYXRoLnJvdW5kKHRoaXMqYSkvYTt9LHRpbWVzOmZ1bmN0aW9uKGIsYyl7Zm9yKHZhciBhPTA7YTx0aGlzO2ErKyl7Yi5jYWxsKGMsYSx0aGlzKTt9fSx0b0Zsb2F0OmZ1bmN0aW9uKCl7cmV0dXJuIHBhcnNlRmxvYXQodGhpcyk7fSx0b0ludDpmdW5jdGlvbihhKXtyZXR1cm4gcGFyc2VJbnQodGhpcyxhfHwxMCk7Cn19KTtOdW1iZXIuYWxpYXMoImVhY2giLCJ0aW1lcyIpOyhmdW5jdGlvbihiKXt2YXIgYT17fTtiLmVhY2goZnVuY3Rpb24oYyl7aWYoIU51bWJlcltjXSl7YVtjXT1mdW5jdGlvbigpe3JldHVybiBNYXRoW2NdLmFwcGx5KG51bGwsW3RoaXNdLmNvbmNhdChBcnJheS5mcm9tKGFyZ3VtZW50cykpKTsKfTt9fSk7TnVtYmVyLmltcGxlbWVudChhKTt9KShbImFicyIsImFjb3MiLCJhc2luIiwiYXRhbiIsImF0YW4yIiwiY2VpbCIsImNvcyIsImV4cCIsImZsb29yIiwibG9nIiwibWF4IiwibWluIiwicG93Iiwic2luIiwic3FydCIsInRhbiJdKTtGdW5jdGlvbi5leHRlbmQoe2F0dGVtcHQ6ZnVuY3Rpb24oKXtmb3IodmFyIGI9MCxhPWFyZ3VtZW50cy5sZW5ndGg7CmI8YTtiKyspe3RyeXtyZXR1cm4gYXJndW1lbnRzW2JdKCk7fWNhdGNoKGMpe319cmV0dXJuIG51bGw7fX0pO0Z1bmN0aW9uLmltcGxlbWVudCh7YXR0ZW1wdDpmdW5jdGlvbihhLGMpe3RyeXtyZXR1cm4gdGhpcy5hcHBseShjLEFycmF5LmZyb20oYSkpO31jYXRjaChiKXt9cmV0dXJuIG51bGw7Cn0sYmluZDpmdW5jdGlvbihlKXt2YXIgYT10aGlzLGI9YXJndW1lbnRzLmxlbmd0aD4xP0FycmF5LnNsaWNlKGFyZ3VtZW50cywxKTpudWxsLGQ9ZnVuY3Rpb24oKXt9O3ZhciBjPWZ1bmN0aW9uKCl7dmFyIGc9ZSxoPWFyZ3VtZW50cy5sZW5ndGg7aWYodGhpcyBpbnN0YW5jZW9mIGMpe2QucHJvdG90eXBlPWEucHJvdG90eXBlOwpnPW5ldyBkO312YXIgZj0oIWImJiFoKT9hLmNhbGwoZyk6YS5hcHBseShnLGImJmg/Yi5jb25jYXQoQXJyYXkuc2xpY2UoYXJndW1lbnRzKSk6Ynx8YXJndW1lbnRzKTtyZXR1cm4gZz09ZT9mOmc7fTtyZXR1cm4gYzt9LHBhc3M6ZnVuY3Rpb24oYixjKXt2YXIgYT10aGlzOwppZihiIT1udWxsKXtiPUFycmF5LmZyb20oYik7fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGMsYnx8YXJndW1lbnRzKTt9O30sZGVsYXk6ZnVuY3Rpb24oYixjLGEpe3JldHVybiBzZXRUaW1lb3V0KHRoaXMucGFzcygoYT09bnVsbD9bXTphKSxjKSxiKTsKfSxwZXJpb2RpY2FsOmZ1bmN0aW9uKGMsYixhKXtyZXR1cm4gc2V0SW50ZXJ2YWwodGhpcy5wYXNzKChhPT1udWxsP1tdOmEpLGIpLGMpO319KTsoZnVuY3Rpb24oKXt2YXIgYT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O09iamVjdC5leHRlbmQoe3N1YnNldDpmdW5jdGlvbihkLGcpe3ZhciBmPXt9Owpmb3IodmFyIGU9MCxiPWcubGVuZ3RoO2U8YjtlKyspe3ZhciBjPWdbZV07aWYoYyBpbiBkKXtmW2NdPWRbY107fX1yZXR1cm4gZjt9LG1hcDpmdW5jdGlvbihiLGUsZil7dmFyIGQ9e307Zm9yKHZhciBjIGluIGIpe2lmKGEuY2FsbChiLGMpKXtkW2NdPWUuY2FsbChmLGJbY10sYyxiKTsKfX1yZXR1cm4gZDt9LGZpbHRlcjpmdW5jdGlvbihiLGUsZyl7dmFyIGQ9e307Zm9yKHZhciBjIGluIGIpe3ZhciBmPWJbY107aWYoYS5jYWxsKGIsYykmJmUuY2FsbChnLGYsYyxiKSl7ZFtjXT1mO319cmV0dXJuIGQ7fSxldmVyeTpmdW5jdGlvbihiLGQsZSl7Zm9yKHZhciBjIGluIGIpe2lmKGEuY2FsbChiLGMpJiYhZC5jYWxsKGUsYltjXSxjKSl7cmV0dXJuIGZhbHNlOwp9fXJldHVybiB0cnVlO30sc29tZTpmdW5jdGlvbihiLGQsZSl7Zm9yKHZhciBjIGluIGIpe2lmKGEuY2FsbChiLGMpJiZkLmNhbGwoZSxiW2NdLGMpKXtyZXR1cm4gdHJ1ZTt9fXJldHVybiBmYWxzZTt9LGtleXM6ZnVuY3Rpb24oYil7dmFyIGQ9W107Zm9yKHZhciBjIGluIGIpe2lmKGEuY2FsbChiLGMpKXtkLnB1c2goYyk7Cn19cmV0dXJuIGQ7fSx2YWx1ZXM6ZnVuY3Rpb24oYyl7dmFyIGI9W107Zm9yKHZhciBkIGluIGMpe2lmKGEuY2FsbChjLGQpKXtiLnB1c2goY1tkXSk7fX1yZXR1cm4gYjt9LGdldExlbmd0aDpmdW5jdGlvbihiKXtyZXR1cm4gT2JqZWN0LmtleXMoYikubGVuZ3RoO30sa2V5T2Y6ZnVuY3Rpb24oYixkKXtmb3IodmFyIGMgaW4gYil7aWYoYS5jYWxsKGIsYykmJmJbY109PT1kKXtyZXR1cm4gYzsKfX1yZXR1cm4gbnVsbDt9LGNvbnRhaW5zOmZ1bmN0aW9uKGIsYyl7cmV0dXJuIE9iamVjdC5rZXlPZihiLGMpIT1udWxsO30sdG9RdWVyeVN0cmluZzpmdW5jdGlvbihiLGMpe3ZhciBkPVtdO09iamVjdC5lYWNoKGIsZnVuY3Rpb24oaCxnKXtpZihjKXtnPWMrIlsiK2crIl0iOwp9dmFyIGY7c3dpdGNoKHR5cGVPZihoKSl7Y2FzZSJvYmplY3QiOmY9T2JqZWN0LnRvUXVlcnlTdHJpbmcoaCxnKTticmVhaztjYXNlImFycmF5Ijp2YXIgZT17fTtoLmVhY2goZnVuY3Rpb24oayxqKXtlW2pdPWs7fSk7Zj1PYmplY3QudG9RdWVyeVN0cmluZyhlLGcpOwpicmVhaztkZWZhdWx0OmY9ZysiPSIrZW5jb2RlVVJJQ29tcG9uZW50KGgpO31pZihoIT1udWxsKXtkLnB1c2goZik7fX0pO3JldHVybiBkLmpvaW4oIiYiKTt9fSk7fSkoKTsoZnVuY3Rpb24oKXt2YXIgaj10aGlzLmRvY3VtZW50O3ZhciBnPWoud2luZG93PXRoaXM7CnZhciBhPW5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSxiPW5hdmlnYXRvci5wbGF0Zm9ybS50b0xvd2VyQ2FzZSgpLGg9YS5tYXRjaCgvKG9wZXJhfGllfGZpcmVmb3h8Y2hyb21lfHZlcnNpb24pW1xzXC86XShbXHdcZFwuXSspPy4qPyhzYWZhcml8dmVyc2lvbltcc1wvOl0oW1x3XGRcLl0rKXwkKS8pfHxbbnVsbCwidW5rbm93biIsMF0sZD1oWzFdPT0iaWUiJiZqLmRvY3VtZW50TW9kZTsKdmFyIG49dGhpcy5Ccm93c2VyPXtleHRlbmQ6RnVuY3Rpb24ucHJvdG90eXBlLmV4dGVuZCxuYW1lOihoWzFdPT0idmVyc2lvbiIpP2hbM106aFsxXSx2ZXJzaW9uOmR8fHBhcnNlRmxvYXQoKGhbMV09PSJvcGVyYSImJmhbNF0pP2hbNF06aFsyXSksUGxhdGZvcm06e25hbWU6YS5tYXRjaCgvaXAoPzphZHxvZHxob25lKS8pPyJpb3MiOihhLm1hdGNoKC8oPzp3ZWJvc3xhbmRyb2lkKS8pfHxiLm1hdGNoKC9tYWN8d2lufGxpbnV4Lyl8fFsib3RoZXIiXSlbMF19LEZlYXR1cmVzOnt4cGF0aDohIShqLmV2YWx1YXRlKSxhaXI6ISEoZy5ydW50aW1lKSxxdWVyeTohIShqLnF1ZXJ5U2VsZWN0b3IpLGpzb246ISEoZy5KU09OKX0sUGx1Z2luczp7fX07Cm5bbi5uYW1lXT10cnVlO25bbi5uYW1lK3BhcnNlSW50KG4udmVyc2lvbiwxMCldPXRydWU7bi5QbGF0Zm9ybVtuLlBsYXRmb3JtLm5hbWVdPXRydWU7bi5SZXF1ZXN0PShmdW5jdGlvbigpe3ZhciBwPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpOwp9O3ZhciBvPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KCJNU1hNTDIuWE1MSFRUUCIpO307dmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7fTtyZXR1cm4gRnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3AoKTsKcmV0dXJuIHA7fSxmdW5jdGlvbigpe28oKTtyZXR1cm4gbzt9LGZ1bmN0aW9uKCl7ZSgpO3JldHVybiBlO30pO30pKCk7bi5GZWF0dXJlcy54aHI9ISEobi5SZXF1ZXN0KTt2YXIgaT0oRnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3JldHVybiBuYXZpZ2F0b3IucGx1Z2luc1siU2hvY2t3YXZlIEZsYXNoIl0uZGVzY3JpcHRpb247Cn0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoIikuR2V0VmFyaWFibGUoIiR2ZXJzaW9uIik7fSl8fCIwIHIwIikubWF0Y2goL1xkKy9nKTtuLlBsdWdpbnMuRmxhc2g9e3ZlcnNpb246TnVtYmVyKGlbMF18fCIwLiIraVsxXSl8fDAsYnVpbGQ6TnVtYmVyKGlbMl0pfHwwfTsKbi5leGVjPWZ1bmN0aW9uKG8pe2lmKCFvKXtyZXR1cm4gbzt9aWYoZy5leGVjU2NyaXB0KXtnLmV4ZWNTY3JpcHQobyk7fWVsc2V7dmFyIGU9ai5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtlLnNldEF0dHJpYnV0ZSgidHlwZSIsInRleHQvamF2YXNjcmlwdCIpO2UudGV4dD1vOwpqLmhlYWQuYXBwZW5kQ2hpbGQoZSk7ai5oZWFkLnJlbW92ZUNoaWxkKGUpO31yZXR1cm4gbzt9O1N0cmluZy5pbXBsZW1lbnQoInN0cmlwU2NyaXB0cyIsZnVuY3Rpb24obyl7dmFyIGU9IiI7dmFyIHA9dGhpcy5yZXBsYWNlKC88c2NyaXB0W14+XSo+KFtcc1xTXSo/KTxcL3NjcmlwdD4vZ2ksZnVuY3Rpb24ocSxyKXtlKz1yKyJcbiI7CnJldHVybiIiO30pO2lmKG89PT10cnVlKXtuLmV4ZWMoZSk7fWVsc2V7aWYodHlwZU9mKG8pPT0iZnVuY3Rpb24iKXtvKGUscCk7fX1yZXR1cm4gcDt9KTtuLmV4dGVuZCh7RG9jdW1lbnQ6dGhpcy5Eb2N1bWVudCxXaW5kb3c6dGhpcy5XaW5kb3csRWxlbWVudDp0aGlzLkVsZW1lbnQsRXZlbnQ6dGhpcy5FdmVudH0pOwp0aGlzLldpbmRvdz10aGlzLiRjb25zdHJ1Y3Rvcj1uZXcgVHlwZSgiV2luZG93IixmdW5jdGlvbigpe30pO3RoaXMuJGZhbWlseT1GdW5jdGlvbi5mcm9tKCJ3aW5kb3ciKS5oaWRlKCk7V2luZG93Lm1pcnJvcihmdW5jdGlvbihlLG8pe2dbZV09bzt9KTt0aGlzLkRvY3VtZW50PWouJGNvbnN0cnVjdG9yPW5ldyBUeXBlKCJEb2N1bWVudCIsZnVuY3Rpb24oKXt9KTsKai4kZmFtaWx5PUZ1bmN0aW9uLmZyb20oImRvY3VtZW50IikuaGlkZSgpO0RvY3VtZW50Lm1pcnJvcihmdW5jdGlvbihlLG8pe2pbZV09bzt9KTtqLmh0bWw9ai5kb2N1bWVudEVsZW1lbnQ7aWYoIWouaGVhZCl7ai5oZWFkPWouZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXTsKfWlmKGouZXhlY0NvbW1hbmQpe3RyeXtqLmV4ZWNDb21tYW5kKCJCYWNrZ3JvdW5kSW1hZ2VDYWNoZSIsZmFsc2UsdHJ1ZSk7fWNhdGNoKGYpe319aWYodGhpcy5hdHRhY2hFdmVudCYmIXRoaXMuYWRkRXZlbnRMaXN0ZW5lcil7dmFyIGM9ZnVuY3Rpb24oKXt0aGlzLmRldGFjaEV2ZW50KCJvbnVubG9hZCIsYyk7CmouaGVhZD1qLmh0bWw9ai53aW5kb3c9bnVsbDt9O3RoaXMuYXR0YWNoRXZlbnQoIm9udW5sb2FkIixjKTt9dmFyIGw9QXJyYXkuZnJvbTt0cnl7bChqLmh0bWwuY2hpbGROb2Rlcyk7fWNhdGNoKGYpe0FycmF5LmZyb209ZnVuY3Rpb24obyl7aWYodHlwZW9mIG8hPSJzdHJpbmciJiZUeXBlLmlzRW51bWVyYWJsZShvKSYmdHlwZU9mKG8pIT0iYXJyYXkiKXt2YXIgZT1vLmxlbmd0aCxwPW5ldyBBcnJheShlKTsKd2hpbGUoZS0tKXtwW2VdPW9bZV07fXJldHVybiBwO31yZXR1cm4gbChvKTt9O3ZhciBrPUFycmF5LnByb3RvdHlwZSxtPWsuc2xpY2U7WyJwb3AiLCJwdXNoIiwicmV2ZXJzZSIsInNoaWZ0Iiwic29ydCIsInNwbGljZSIsInVuc2hpZnQiLCJjb25jYXQiLCJqb2luIiwic2xpY2UiXS5lYWNoKGZ1bmN0aW9uKGUpe3ZhciBvPWtbZV07CkFycmF5W2VdPWZ1bmN0aW9uKHApe3JldHVybiBvLmFwcGx5KEFycmF5LmZyb20ocCksbS5jYWxsKGFyZ3VtZW50cywxKSk7fTt9KTt9fSkoKTsoZnVuY3Rpb24oKXt2YXIgYj17fTt2YXIgYT10aGlzLkRPTUV2ZW50PW5ldyBUeXBlKCJET01FdmVudCIsZnVuY3Rpb24oYyxnKXtpZighZyl7Zz13aW5kb3c7Cn1jPWN8fGcuZXZlbnQ7aWYoYy4kZXh0ZW5kZWQpe3JldHVybiBjO310aGlzLmV2ZW50PWM7dGhpcy4kZXh0ZW5kZWQ9dHJ1ZTt0aGlzLnNoaWZ0PWMuc2hpZnRLZXk7dGhpcy5jb250cm9sPWMuY3RybEtleTt0aGlzLmFsdD1jLmFsdEtleTt0aGlzLm1ldGE9Yy5tZXRhS2V5Owp2YXIgaT10aGlzLnR5cGU9Yy50eXBlO3ZhciBoPWMudGFyZ2V0fHxjLnNyY0VsZW1lbnQ7d2hpbGUoaCYmaC5ub2RlVHlwZT09Myl7aD1oLnBhcmVudE5vZGU7fXRoaXMudGFyZ2V0PWRvY3VtZW50LmlkKGgpO2lmKGkuaW5kZXhPZigia2V5Iik9PTApe3ZhciBkPXRoaXMuY29kZT0oYy53aGljaHx8Yy5rZXlDb2RlKTsKdGhpcy5rZXk9YltkXTtpZihpPT0ia2V5ZG93biIpe2lmKGQ+MTExJiZkPDEyNCl7dGhpcy5rZXk9ImYiKyhkLTExMSk7fWVsc2V7aWYoZD45NSYmZDwxMDYpe3RoaXMua2V5PWQtOTY7fX19aWYodGhpcy5rZXk9PW51bGwpe3RoaXMua2V5PVN0cmluZy5mcm9tQ2hhckNvZGUoZCkudG9Mb3dlckNhc2UoKTsKfX1lbHNle2lmKGk9PSJjbGljayJ8fGk9PSJkYmxjbGljayJ8fGk9PSJjb250ZXh0bWVudSJ8fGk9PSJET01Nb3VzZVNjcm9sbCJ8fGkuaW5kZXhPZigibW91c2UiKT09MCl7dmFyIGo9Zy5kb2N1bWVudDtqPSghai5jb21wYXRNb2RlfHxqLmNvbXBhdE1vZGU9PSJDU1MxQ29tcGF0Iik/ai5odG1sOmouYm9keTsKdGhpcy5wYWdlPXt4OihjLnBhZ2VYIT1udWxsKT9jLnBhZ2VYOmMuY2xpZW50WCtqLnNjcm9sbExlZnQseTooYy5wYWdlWSE9bnVsbCk/Yy5wYWdlWTpjLmNsaWVudFkrai5zY3JvbGxUb3B9O3RoaXMuY2xpZW50PXt4OihjLnBhZ2VYIT1udWxsKT9jLnBhZ2VYLWcucGFnZVhPZmZzZXQ6Yy5jbGllbnRYLHk6KGMucGFnZVkhPW51bGwpP2MucGFnZVktZy5wYWdlWU9mZnNldDpjLmNsaWVudFl9OwppZihpPT0iRE9NTW91c2VTY3JvbGwifHxpPT0ibW91c2V3aGVlbCIpe3RoaXMud2hlZWw9KGMud2hlZWxEZWx0YSk/Yy53aGVlbERlbHRhLzEyMDotKGMuZGV0YWlsfHwwKS8zO310aGlzLnJpZ2h0Q2xpY2s9KGMud2hpY2g9PTN8fGMuYnV0dG9uPT0yKTtpZihpPT0ibW91c2VvdmVyInx8aT09Im1vdXNlb3V0Iil7dmFyIGs9Yy5yZWxhdGVkVGFyZ2V0fHxjWyhpPT0ibW91c2VvdmVyIj8iZnJvbSI6InRvIikrIkVsZW1lbnQiXTsKd2hpbGUoayYmay5ub2RlVHlwZT09Myl7az1rLnBhcmVudE5vZGU7fXRoaXMucmVsYXRlZFRhcmdldD1kb2N1bWVudC5pZChrKTt9fWVsc2V7aWYoaS5pbmRleE9mKCJ0b3VjaCIpPT0wfHxpLmluZGV4T2YoImdlc3R1cmUiKT09MCl7dGhpcy5yb3RhdGlvbj1jLnJvdGF0aW9uOwp0aGlzLnNjYWxlPWMuc2NhbGU7dGhpcy50YXJnZXRUb3VjaGVzPWMudGFyZ2V0VG91Y2hlczt0aGlzLmNoYW5nZWRUb3VjaGVzPWMuY2hhbmdlZFRvdWNoZXM7dmFyIGY9dGhpcy50b3VjaGVzPWMudG91Y2hlcztpZihmJiZmWzBdKXt2YXIgZT1mWzBdO3RoaXMucGFnZT17eDplLnBhZ2VYLHk6ZS5wYWdlWX07CnRoaXMuY2xpZW50PXt4OmUuY2xpZW50WCx5OmUuY2xpZW50WX07fX19fWlmKCF0aGlzLmNsaWVudCl7dGhpcy5jbGllbnQ9e307fWlmKCF0aGlzLnBhZ2Upe3RoaXMucGFnZT17fTt9fSk7YS5pbXBsZW1lbnQoe3N0b3A6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2ZW50RGVmYXVsdCgpLnN0b3BQcm9wYWdhdGlvbigpOwp9LHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe2lmKHRoaXMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKXt0aGlzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO31lbHNle3RoaXMuZXZlbnQuY2FuY2VsQnViYmxlPXRydWU7fXJldHVybiB0aGlzO30scHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXtpZih0aGlzLmV2ZW50LnByZXZlbnREZWZhdWx0KXt0aGlzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7Cn1lbHNle3RoaXMuZXZlbnQucmV0dXJuVmFsdWU9ZmFsc2U7fXJldHVybiB0aGlzO319KTthLmRlZmluZUtleT1mdW5jdGlvbihkLGMpe2JbZF09YztyZXR1cm4gdGhpczt9O2EuZGVmaW5lS2V5cz1hLmRlZmluZUtleS5vdmVybG9hZFNldHRlcih0cnVlKTthLmRlZmluZUtleXMoeyIzOCI6InVwIiwiNDAiOiJkb3duIiwiMzciOiJsZWZ0IiwiMzkiOiJyaWdodCIsIjI3IjoiZXNjIiwiMzIiOiJzcGFjZSIsIjgiOiJiYWNrc3BhY2UiLCI5IjoidGFiIiwiNDYiOiJkZWxldGUiLCIxMyI6ImVudGVyIn0pOwp9KSgpOyhmdW5jdGlvbigpe3ZhciBhPXRoaXMuQ2xhc3M9bmV3IFR5cGUoIkNsYXNzIixmdW5jdGlvbihoKXtpZihpbnN0YW5jZU9mKGgsRnVuY3Rpb24pKXtoPXtpbml0aWFsaXplOmh9O312YXIgZz1mdW5jdGlvbigpe2UodGhpcyk7aWYoZy4kcHJvdG90eXBpbmcpe3JldHVybiB0aGlzOwp9dGhpcy4kY2FsbGVyPW51bGw7dmFyIGk9KHRoaXMuaW5pdGlhbGl6ZSk/dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzO3RoaXMuJGNhbGxlcj10aGlzLmNhbGxlcj1udWxsO3JldHVybiBpO30uZXh0ZW5kKHRoaXMpLmltcGxlbWVudChoKTsKZy4kY29uc3RydWN0b3I9YTtnLnByb3RvdHlwZS4kY29uc3RydWN0b3I9ZztnLnByb3RvdHlwZS5wYXJlbnQ9YztyZXR1cm4gZzt9KTt2YXIgYz1mdW5jdGlvbigpe2lmKCF0aGlzLiRjYWxsZXIpe3Rocm93IG5ldyBFcnJvcignVGhlIG1ldGhvZCAicGFyZW50IiBjYW5ub3QgYmUgY2FsbGVkLicpOwp9dmFyIGc9dGhpcy4kY2FsbGVyLiRuYW1lLGg9dGhpcy4kY2FsbGVyLiRvd25lci5wYXJlbnQsaT0oaCk/aC5wcm90b3R5cGVbZ106bnVsbDtpZighaSl7dGhyb3cgbmV3IEVycm9yKCdUaGUgbWV0aG9kICInK2crJyIgaGFzIG5vIHBhcmVudC4nKTt9cmV0dXJuIGkuYXBwbHkodGhpcyxhcmd1bWVudHMpOwp9O3ZhciBlPWZ1bmN0aW9uKGcpe2Zvcih2YXIgaCBpbiBnKXt2YXIgaj1nW2hdO3N3aXRjaCh0eXBlT2Yoaikpe2Nhc2Uib2JqZWN0Ijp2YXIgaT1mdW5jdGlvbigpe307aS5wcm90b3R5cGU9ajtnW2hdPWUobmV3IGkpO2JyZWFrO2Nhc2UiYXJyYXkiOmdbaF09ai5jbG9uZSgpOwpicmVhazt9fXJldHVybiBnO307dmFyIGI9ZnVuY3Rpb24oZyxoLGope2lmKGouJG9yaWdpbil7aj1qLiRvcmlnaW47fXZhciBpPWZ1bmN0aW9uKCl7aWYoai4kcHJvdGVjdGVkJiZ0aGlzLiRjYWxsZXI9PW51bGwpe3Rocm93IG5ldyBFcnJvcignVGhlIG1ldGhvZCAiJytoKyciIGNhbm5vdCBiZSBjYWxsZWQuJyk7Cn12YXIgbD10aGlzLmNhbGxlcixtPXRoaXMuJGNhbGxlcjt0aGlzLmNhbGxlcj1tO3RoaXMuJGNhbGxlcj1pO3ZhciBrPWouYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuJGNhbGxlcj1tO3RoaXMuY2FsbGVyPWw7cmV0dXJuIGs7fS5leHRlbmQoeyRvd25lcjpnLCRvcmlnaW46aiwkbmFtZTpofSk7CnJldHVybiBpO307dmFyIGY9ZnVuY3Rpb24oaCxpLGcpe2lmKGEuTXV0YXRvcnMuaGFzT3duUHJvcGVydHkoaCkpe2k9YS5NdXRhdG9yc1toXS5jYWxsKHRoaXMsaSk7aWYoaT09bnVsbCl7cmV0dXJuIHRoaXM7fX1pZih0eXBlT2YoaSk9PSJmdW5jdGlvbiIpe2lmKGkuJGhpZGRlbil7cmV0dXJuIHRoaXM7Cn10aGlzLnByb3RvdHlwZVtoXT0oZyk/aTpiKHRoaXMsaCxpKTt9ZWxzZXtPYmplY3QubWVyZ2UodGhpcy5wcm90b3R5cGUsaCxpKTt9cmV0dXJuIHRoaXM7fTt2YXIgZD1mdW5jdGlvbihnKXtnLiRwcm90b3R5cGluZz10cnVlO3ZhciBoPW5ldyBnO2RlbGV0ZSBnLiRwcm90b3R5cGluZzsKcmV0dXJuIGg7fTthLmltcGxlbWVudCgiaW1wbGVtZW50IixmLm92ZXJsb2FkU2V0dGVyKCkpO2EuTXV0YXRvcnM9e0V4dGVuZHM6ZnVuY3Rpb24oZyl7dGhpcy5wYXJlbnQ9Zzt0aGlzLnByb3RvdHlwZT1kKGcpO30sSW1wbGVtZW50czpmdW5jdGlvbihnKXtBcnJheS5mcm9tKGcpLmVhY2goZnVuY3Rpb24oail7dmFyIGg9bmV3IGo7CmZvcih2YXIgaSBpbiBoKXtmLmNhbGwodGhpcyxpLGhbaV0sdHJ1ZSk7fX0sdGhpcyk7fX07fSkoKTsoZnVuY3Rpb24oKXt0aGlzLkNoYWluPW5ldyBDbGFzcyh7JGNoYWluOltdLGNoYWluOmZ1bmN0aW9uKCl7dGhpcy4kY2hhaW4uYXBwZW5kKEFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKSk7CnJldHVybiB0aGlzO30sY2FsbENoYWluOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuJGNoYWluLmxlbmd0aCk/dGhpcy4kY2hhaW4uc2hpZnQoKS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6ZmFsc2U7fSxjbGVhckNoYWluOmZ1bmN0aW9uKCl7dGhpcy4kY2hhaW4uZW1wdHkoKTsKcmV0dXJuIHRoaXM7fX0pO3ZhciBhPWZ1bmN0aW9uKGIpe3JldHVybiBiLnJlcGxhY2UoL15vbihbQS1aXSkvLGZ1bmN0aW9uKGMsZCl7cmV0dXJuIGQudG9Mb3dlckNhc2UoKTt9KTt9O3RoaXMuRXZlbnRzPW5ldyBDbGFzcyh7JGV2ZW50czp7fSxhZGRFdmVudDpmdW5jdGlvbihkLGMsYil7ZD1hKGQpOwp0aGlzLiRldmVudHNbZF09KHRoaXMuJGV2ZW50c1tkXXx8W10pLmluY2x1ZGUoYyk7aWYoYil7Yy5pbnRlcm5hbD10cnVlO31yZXR1cm4gdGhpczt9LGFkZEV2ZW50czpmdW5jdGlvbihiKXtmb3IodmFyIGMgaW4gYil7dGhpcy5hZGRFdmVudChjLGJbY10pO31yZXR1cm4gdGhpczsKfSxmaXJlRXZlbnQ6ZnVuY3Rpb24oZSxjLGIpe2U9YShlKTt2YXIgZD10aGlzLiRldmVudHNbZV07aWYoIWQpe3JldHVybiB0aGlzO31jPUFycmF5LmZyb20oYyk7ZC5lYWNoKGZ1bmN0aW9uKGYpe2lmKGIpe2YuZGVsYXkoYix0aGlzLGMpO31lbHNle2YuYXBwbHkodGhpcyxjKTsKfX0sdGhpcyk7cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudDpmdW5jdGlvbihlLGQpe2U9YShlKTt2YXIgYz10aGlzLiRldmVudHNbZV07aWYoYyYmIWQuaW50ZXJuYWwpe3ZhciBiPWMuaW5kZXhPZihkKTtpZihiIT0tMSl7ZGVsZXRlIGNbYl07fX1yZXR1cm4gdGhpczsKfSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oZCl7dmFyIGU7aWYodHlwZU9mKGQpPT0ib2JqZWN0Iil7Zm9yKGUgaW4gZCl7dGhpcy5yZW1vdmVFdmVudChlLGRbZV0pO31yZXR1cm4gdGhpczt9aWYoZCl7ZD1hKGQpO31mb3IoZSBpbiB0aGlzLiRldmVudHMpe2lmKGQmJmQhPWUpe2NvbnRpbnVlOwp9dmFyIGM9dGhpcy4kZXZlbnRzW2VdO2Zvcih2YXIgYj1jLmxlbmd0aDtiLS07KXtpZihiIGluIGMpe3RoaXMucmVtb3ZlRXZlbnQoZSxjW2JdKTt9fX1yZXR1cm4gdGhpczt9fSk7dGhpcy5PcHRpb25zPW5ldyBDbGFzcyh7c2V0T3B0aW9uczpmdW5jdGlvbigpe3ZhciBiPXRoaXMub3B0aW9ucz1PYmplY3QubWVyZ2UuYXBwbHkobnVsbCxbe30sdGhpcy5vcHRpb25zXS5hcHBlbmQoYXJndW1lbnRzKSk7CmlmKHRoaXMuYWRkRXZlbnQpe2Zvcih2YXIgYyBpbiBiKXtpZih0eXBlT2YoYltjXSkhPSJmdW5jdGlvbiJ8fCEoL15vbltBLVpdLykudGVzdChjKSl7Y29udGludWU7fXRoaXMuYWRkRXZlbnQoYyxiW2NdKTtkZWxldGUgYltjXTt9fXJldHVybiB0aGlzO319KTt9KSgpOwooZnVuY3Rpb24oKXt2YXIgayxuLGwsZyxhPXt9LGM9e30sbT0vXFwvZzt2YXIgZT1mdW5jdGlvbihxLHApe2lmKHE9PW51bGwpe3JldHVybiBudWxsO31pZihxLlNsaWNrPT09dHJ1ZSl7cmV0dXJuIHE7fXE9KCIiK3EpLnJlcGxhY2UoL15ccyt8XHMrJC9nLCIiKTtnPSEhcDsKdmFyIG89KGcpP2M6YTtpZihvW3FdKXtyZXR1cm4gb1txXTt9az17U2xpY2s6dHJ1ZSxleHByZXNzaW9uczpbXSxyYXc6cSxyZXZlcnNlOmZ1bmN0aW9uKCl7cmV0dXJuIGUodGhpcy5yYXcsdHJ1ZSk7fX07bj0tMTt3aGlsZShxIT0ocT1xLnJlcGxhY2UoaixiKSkpe31rLmxlbmd0aD1rLmV4cHJlc3Npb25zLmxlbmd0aDsKcmV0dXJuIG9bay5yYXddPShnKT9oKGspOms7fTt2YXIgaT1mdW5jdGlvbihvKXtpZihvPT09IiEiKXtyZXR1cm4iICI7fWVsc2V7aWYobz09PSIgIil7cmV0dXJuIiEiO31lbHNle2lmKCgvXiEvKS50ZXN0KG8pKXtyZXR1cm4gby5yZXBsYWNlKC9eIS8sIiIpO31lbHNle3JldHVybiIhIitvOwp9fX19O3ZhciBoPWZ1bmN0aW9uKHUpe3ZhciByPXUuZXhwcmVzc2lvbnM7Zm9yKHZhciBwPTA7cDxyLmxlbmd0aDtwKyspe3ZhciB0PXJbcF07dmFyIHE9e3BhcnRzOltdLHRhZzoiKiIsY29tYmluYXRvcjppKHRbMF0uY29tYmluYXRvcil9O2Zvcih2YXIgbz0wO288dC5sZW5ndGg7Cm8rKyl7dmFyIHM9dFtvXTtpZighcy5yZXZlcnNlQ29tYmluYXRvcil7cy5yZXZlcnNlQ29tYmluYXRvcj0iICI7fXMuY29tYmluYXRvcj1zLnJldmVyc2VDb21iaW5hdG9yO2RlbGV0ZSBzLnJldmVyc2VDb21iaW5hdG9yO310LnJldmVyc2UoKS5wdXNoKHEpO31yZXR1cm4gdTsKfTt2YXIgZj1mdW5jdGlvbihvKXtyZXR1cm4gby5yZXBsYWNlKC9bLVtcXXt9KCkqKz8uXFxeJHwsI1xzXS9nLGZ1bmN0aW9uKHApe3JldHVybiJcXCIrcDt9KTt9O3ZhciBqPW5ldyBSZWdFeHAoIl4oPzpcXHMqKCwpXFxzKnxcXHMqKDxjb21iaW5hdG9yPispXFxzKnwoXFxzKyl8KDx1bmljb2RlPit8XFwqKXxcXCMoPHVuaWNvZGU+Kyl8XFwuKDx1bmljb2RlPispfFxcW1xccyooPHVuaWNvZGUxPispKD86XFxzKihbKl4kIX58XT89KSg/OlxccyooPzooW1wiJ10/KSguKj8pXFw5KSkpP1xccypcXF0oPyFcXF0pfCg6KykoPHVuaWNvZGU+KykoPzpcXCgoPzooPzooW1wiJ10pKFteXFwxM10qKVxcMTMpfCgoPzpcXChbXildK1xcKXxbXigpXSopKykpXFwpKT8pIi5yZXBsYWNlKC88Y29tYmluYXRvcj4vLCJbIitmKCI+K35gIUAkJV4mPXt9XFw7PC8iKSsiXSIpLnJlcGxhY2UoLzx1bmljb2RlPi9nLCIoPzpbXFx3XFx1MDBhMS1cXHVGRkZGLV18XFxcXFteXFxzMC05YS1mXSkiKS5yZXBsYWNlKC88dW5pY29kZTE+L2csIig/Ols6XFx3XFx1MDBhMS1cXHVGRkZGLV18XFxcXFteXFxzMC05YS1mXSkiKSk7CmZ1bmN0aW9uIGIoeCxzLEQseixyLEMscSxCLEEseSx1LEYsRyx2LHAsdyl7aWYoc3x8bj09PS0xKXtrLmV4cHJlc3Npb25zWysrbl09W107bD0tMTtpZihzKXtyZXR1cm4iIjt9fWlmKER8fHp8fGw9PT0tMSl7RD1EfHwiICI7dmFyIHQ9ay5leHByZXNzaW9uc1tuXTsKaWYoZyYmdFtsXSl7dFtsXS5yZXZlcnNlQ29tYmluYXRvcj1pKEQpO310WysrbF09e2NvbWJpbmF0b3I6RCx0YWc6IioifTt9dmFyIG89ay5leHByZXNzaW9uc1tuXVtsXTtpZihyKXtvLnRhZz1yLnJlcGxhY2UobSwiIik7fWVsc2V7aWYoQyl7by5pZD1DLnJlcGxhY2UobSwiIik7Cn1lbHNle2lmKHEpe3E9cS5yZXBsYWNlKG0sIiIpO2lmKCFvLmNsYXNzTGlzdCl7by5jbGFzc0xpc3Q9W107fWlmKCFvLmNsYXNzZXMpe28uY2xhc3Nlcz1bXTt9by5jbGFzc0xpc3QucHVzaChxKTtvLmNsYXNzZXMucHVzaCh7dmFsdWU6cSxyZWdleHA6bmV3IFJlZ0V4cCgiKF58XFxzKSIrZihxKSsiKFxcc3wkKSIpfSk7Cn1lbHNle2lmKEcpe3c9d3x8cDt3PXc/dy5yZXBsYWNlKG0sIiIpOm51bGw7aWYoIW8ucHNldWRvcyl7by5wc2V1ZG9zPVtdO31vLnBzZXVkb3MucHVzaCh7a2V5OkcucmVwbGFjZShtLCIiKSx2YWx1ZTp3LHR5cGU6Ri5sZW5ndGg9PTE/ImNsYXNzIjoiZWxlbWVudCJ9KTsKfWVsc2V7aWYoQil7Qj1CLnJlcGxhY2UobSwiIik7dT0odXx8IiIpLnJlcGxhY2UobSwiIik7dmFyIEUsSDtzd2l0Y2goQSl7Y2FzZSJePSI6SD1uZXcgUmVnRXhwKCJeIitmKHUpKTticmVhaztjYXNlIiQ9IjpIPW5ldyBSZWdFeHAoZih1KSsiJCIpO2JyZWFrO2Nhc2Uifj0iOkg9bmV3IFJlZ0V4cCgiKF58XFxzKSIrZih1KSsiKFxcc3wkKSIpOwpicmVhaztjYXNlInw9IjpIPW5ldyBSZWdFeHAoIl4iK2YodSkrIigtfCQpIik7YnJlYWs7Y2FzZSI9IjpFPWZ1bmN0aW9uKEkpe3JldHVybiB1PT1JO307YnJlYWs7Y2FzZSIqPSI6RT1mdW5jdGlvbihJKXtyZXR1cm4gSSYmSS5pbmRleE9mKHUpPi0xO307YnJlYWs7CmNhc2UiIT0iOkU9ZnVuY3Rpb24oSSl7cmV0dXJuIHUhPUk7fTticmVhaztkZWZhdWx0OkU9ZnVuY3Rpb24oSSl7cmV0dXJuICEhSTt9O31pZih1PT0iIiYmKC9eWyokXl09JC8pLnRlc3QoQSkpe0U9ZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7fTt9aWYoIUUpe0U9ZnVuY3Rpb24oSSl7cmV0dXJuIEkmJkgudGVzdChJKTsKfTt9aWYoIW8uYXR0cmlidXRlcyl7by5hdHRyaWJ1dGVzPVtdO31vLmF0dHJpYnV0ZXMucHVzaCh7a2V5OkIsb3BlcmF0b3I6QSx2YWx1ZTp1LHRlc3Q6RX0pO319fX19cmV0dXJuIiI7fXZhciBkPSh0aGlzLlNsaWNrfHx7fSk7ZC5wYXJzZT1mdW5jdGlvbihvKXtyZXR1cm4gZShvKTsKfTtkLmVzY2FwZVJlZ0V4cD1mO2lmKCF0aGlzLlNsaWNrKXt0aGlzLlNsaWNrPWQ7fX0pLmFwcGx5KCh0eXBlb2YgZXhwb3J0cyE9InVuZGVmaW5lZCIpP2V4cG9ydHM6dGhpcyk7KGZ1bmN0aW9uKCl7dmFyIGs9e30sbT17fSxkPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CmsuaXNOYXRpdmVDb2RlPWZ1bmN0aW9uKGMpe3JldHVybigvXHtccypcW25hdGl2ZSBjb2RlXF1ccypcfS8pLnRlc3QoIiIrYyk7fTtrLmlzWE1MPWZ1bmN0aW9uKGMpe3JldHVybighIWMueG1sVmVyc2lvbil8fCghIWMueG1sKXx8KGQuY2FsbChjKT09IltvYmplY3QgWE1MRG9jdW1lbnRdIil8fChjLm5vZGVUeXBlPT05JiZjLmRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSE9IkhUTUwiKTsKfTtrLnNldERvY3VtZW50PWZ1bmN0aW9uKHcpe3ZhciBwPXcubm9kZVR5cGU7aWYocD09OSl7fWVsc2V7aWYocCl7dz13Lm93bmVyRG9jdW1lbnQ7fWVsc2V7aWYody5uYXZpZ2F0b3Ipe3c9dy5kb2N1bWVudDt9ZWxzZXtyZXR1cm47fX19aWYodGhpcy5kb2N1bWVudD09PXcpe3JldHVybjsKfXRoaXMuZG9jdW1lbnQ9dzt2YXIgQT13LmRvY3VtZW50RWxlbWVudCxvPXRoaXMuZ2V0VUlEWE1MKEEpLHM9bVtvXSxyO2lmKHMpe2ZvcihyIGluIHMpe3RoaXNbcl09c1tyXTt9cmV0dXJuO31zPW1bb109e307cy5yb290PUE7cy5pc1hNTERvY3VtZW50PXRoaXMuaXNYTUwodyk7CnMuYnJva2VuU3RhckdFQlROPXMuc3RhclNlbGVjdHNDbG9zZWRRU0E9cy5pZEdldHNOYW1lPXMuYnJva2VuTWl4ZWRDYXNlUVNBPXMuYnJva2VuR0VCQ049cy5icm9rZW5DaGVja2VkUVNBPXMuYnJva2VuRW1wdHlBdHRyaWJ1dGVRU0E9cy5pc0hUTUxEb2N1bWVudD1zLm5hdGl2ZU1hdGNoZXNTZWxlY3Rvcj1mYWxzZTsKdmFyIHEsdSx5LHosdDt2YXIgeCx2PSJzbGlja191bmlxdWVpZCI7dmFyIGM9dy5jcmVhdGVFbGVtZW50KCJkaXYiKTt2YXIgbj13LmJvZHl8fHcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImJvZHkiKVswXXx8QTtuLmFwcGVuZENoaWxkKGMpO3RyeXtjLmlubmVySFRNTD0nPGEgaWQ9IicrdisnIj48L2E+JzsKcy5pc0hUTUxEb2N1bWVudD0hIXcuZ2V0RWxlbWVudEJ5SWQodik7fWNhdGNoKEMpe31pZihzLmlzSFRNTERvY3VtZW50KXtjLnN0eWxlLmRpc3BsYXk9Im5vbmUiO2MuYXBwZW5kQ2hpbGQody5jcmVhdGVDb21tZW50KCIiKSk7dT0oYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aD4xKTsKdHJ5e2MuaW5uZXJIVE1MPSJmb288L2Zvbz4iO3g9Yy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpO3E9KHgmJiEheC5sZW5ndGgmJnhbMF0ubm9kZU5hbWUuY2hhckF0KDApPT0iLyIpO31jYXRjaChDKXt9cy5icm9rZW5TdGFyR0VCVE49dXx8cTt0cnl7Yy5pbm5lckhUTUw9JzxhIG5hbWU9IicrdisnIj48L2E+PGIgaWQ9IicrdisnIj48L2I+JzsKcy5pZEdldHNOYW1lPXcuZ2V0RWxlbWVudEJ5SWQodik9PT1jLmZpcnN0Q2hpbGQ7fWNhdGNoKEMpe31pZihjLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpe3RyeXtjLmlubmVySFRNTD0nPGEgY2xhc3M9ImYiPjwvYT48YSBjbGFzcz0iYiI+PC9hPic7Yy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJiIikubGVuZ3RoOwpjLmZpcnN0Q2hpbGQuY2xhc3NOYW1lPSJiIjt6PShjLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImIiKS5sZW5ndGghPTIpO31jYXRjaChDKXt9dHJ5e2MuaW5uZXJIVE1MPSc8YSBjbGFzcz0iYSI+PC9hPjxhIGNsYXNzPSJmIGIgYSI+PC9hPic7eT0oYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJhIikubGVuZ3RoIT0yKTsKfWNhdGNoKEMpe31zLmJyb2tlbkdFQkNOPXp8fHk7fWlmKGMucXVlcnlTZWxlY3RvckFsbCl7dHJ5e2MuaW5uZXJIVE1MPSJmb288L2Zvbz4iO3g9Yy5xdWVyeVNlbGVjdG9yQWxsKCIqIik7cy5zdGFyU2VsZWN0c0Nsb3NlZFFTQT0oeCYmISF4Lmxlbmd0aCYmeFswXS5ub2RlTmFtZS5jaGFyQXQoMCk9PSIvIik7Cn1jYXRjaChDKXt9dHJ5e2MuaW5uZXJIVE1MPSc8YSBjbGFzcz0iTWlYIj48L2E+JztzLmJyb2tlbk1peGVkQ2FzZVFTQT0hYy5xdWVyeVNlbGVjdG9yQWxsKCIuTWlYIikubGVuZ3RoO31jYXRjaChDKXt9dHJ5e2MuaW5uZXJIVE1MPSc8c2VsZWN0PjxvcHRpb24gc2VsZWN0ZWQ9InNlbGVjdGVkIj5hPC9vcHRpb24+PC9zZWxlY3Q+JzsKcy5icm9rZW5DaGVja2VkUVNBPShjLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RoPT0wKTt9Y2F0Y2goQyl7fXRyeXtjLmlubmVySFRNTD0nPGEgY2xhc3M9IiI+PC9hPic7cy5icm9rZW5FbXB0eUF0dHJpYnV0ZVFTQT0oYy5xdWVyeVNlbGVjdG9yQWxsKCdbY2xhc3MqPSIiXScpLmxlbmd0aCE9MCk7Cn1jYXRjaChDKXt9fXRyeXtjLmlubmVySFRNTD0nPGZvcm0gYWN0aW9uPSJzIj48aW5wdXQgaWQ9ImFjdGlvbiIvPjwvZm9ybT4nO3Q9KGMuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImFjdGlvbiIpIT0icyIpO31jYXRjaChDKXt9cy5uYXRpdmVNYXRjaGVzU2VsZWN0b3I9QS5tYXRjaGVzU2VsZWN0b3J8fEEubW96TWF0Y2hlc1NlbGVjdG9yfHxBLndlYmtpdE1hdGNoZXNTZWxlY3RvcjsKaWYocy5uYXRpdmVNYXRjaGVzU2VsZWN0b3Ipe3RyeXtzLm5hdGl2ZU1hdGNoZXNTZWxlY3Rvci5jYWxsKEEsIjpzbGljayIpO3MubmF0aXZlTWF0Y2hlc1NlbGVjdG9yPW51bGw7fWNhdGNoKEMpe319fXRyeXtBLnNsaWNrX2V4cGFuZG89MTtkZWxldGUgQS5zbGlja19leHBhbmRvOwpzLmdldFVJRD10aGlzLmdldFVJREhUTUw7fWNhdGNoKEMpe3MuZ2V0VUlEPXRoaXMuZ2V0VUlEWE1MO31uLnJlbW92ZUNoaWxkKGMpO2M9eD1uPW51bGw7cy5nZXRBdHRyaWJ1dGU9KHMuaXNIVE1MRG9jdW1lbnQmJnQpP2Z1bmN0aW9uKEcsRSl7dmFyIEg9dGhpcy5hdHRyaWJ1dGVHZXR0ZXJzW0VdOwppZihIKXtyZXR1cm4gSC5jYWxsKEcpO312YXIgRj1HLmdldEF0dHJpYnV0ZU5vZGUoRSk7cmV0dXJuKEYpP0Yubm9kZVZhbHVlOm51bGw7fTpmdW5jdGlvbihGLEUpe3ZhciBHPXRoaXMuYXR0cmlidXRlR2V0dGVyc1tFXTtyZXR1cm4oRyk/Ry5jYWxsKEYpOkYuZ2V0QXR0cmlidXRlKEUpOwp9O3MuaGFzQXR0cmlidXRlPShBJiZ0aGlzLmlzTmF0aXZlQ29kZShBLmhhc0F0dHJpYnV0ZSkpP2Z1bmN0aW9uKEYsRSl7cmV0dXJuIEYuaGFzQXR0cmlidXRlKEUpO306ZnVuY3Rpb24oRixFKXtGPUYuZ2V0QXR0cmlidXRlTm9kZShFKTtyZXR1cm4gISEoRiYmKEYuc3BlY2lmaWVkfHxGLm5vZGVWYWx1ZSkpOwp9O3ZhciBEPUEmJnRoaXMuaXNOYXRpdmVDb2RlKEEuY29udGFpbnMpLEI9dyYmdGhpcy5pc05hdGl2ZUNvZGUody5jb250YWlucyk7cy5jb250YWlucz0oRCYmQik/ZnVuY3Rpb24oRSxGKXtyZXR1cm4gRS5jb250YWlucyhGKTt9OihEJiYhQik/ZnVuY3Rpb24oRSxGKXtyZXR1cm4gRT09PUZ8fCgoRT09PXcpP3cuZG9jdW1lbnRFbGVtZW50OkUpLmNvbnRhaW5zKEYpOwp9OihBJiZBLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKT9mdW5jdGlvbihFLEYpe3JldHVybiBFPT09Rnx8ISEoRS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihGKSYxNik7fTpmdW5jdGlvbihFLEYpe2lmKEYpe2Rve2lmKEY9PT1FKXtyZXR1cm4gdHJ1ZTt9fXdoaWxlKChGPUYucGFyZW50Tm9kZSkpOwp9cmV0dXJuIGZhbHNlO307cy5kb2N1bWVudFNvcnRlcj0oQS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbik/ZnVuY3Rpb24oRixFKXtpZighRi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbnx8IUUuY29tcGFyZURvY3VtZW50UG9zaXRpb24pe3JldHVybiAwO31yZXR1cm4gRi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihFKSY0Py0xOkY9PT1FPzA6MTsKfTooInNvdXJjZUluZGV4IiBpbiBBKT9mdW5jdGlvbihGLEUpe2lmKCFGLnNvdXJjZUluZGV4fHwhRS5zb3VyY2VJbmRleCl7cmV0dXJuIDA7fXJldHVybiBGLnNvdXJjZUluZGV4LUUuc291cmNlSW5kZXg7fToody5jcmVhdGVSYW5nZSk/ZnVuY3Rpb24oSCxGKXtpZighSC5vd25lckRvY3VtZW50fHwhRi5vd25lckRvY3VtZW50KXtyZXR1cm4gMDsKfXZhciBHPUgub3duZXJEb2N1bWVudC5jcmVhdGVSYW5nZSgpLEU9Ri5vd25lckRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7Ry5zZXRTdGFydChILDApO0cuc2V0RW5kKEgsMCk7RS5zZXRTdGFydChGLDApO0Uuc2V0RW5kKEYsMCk7cmV0dXJuIEcuY29tcGFyZUJvdW5kYXJ5UG9pbnRzKFJhbmdlLlNUQVJUX1RPX0VORCxFKTsKfTpudWxsO0E9bnVsbDtmb3IociBpbiBzKXt0aGlzW3JdPXNbcl07fX07dmFyIGY9L14oWyMuXT8pKCg/Oltcdy1dK3xcKikpJC8saD0vXFsuK1sqJF5dPSg/OiIifCcnKT9cXS8sZz17fTtrLnNlYXJjaD1mdW5jdGlvbihVLHosSCxzKXt2YXIgcD10aGlzLmZvdW5kPShzKT9udWxsOihIfHxbXSk7CmlmKCFVKXtyZXR1cm4gcDt9ZWxzZXtpZihVLm5hdmlnYXRvcil7VT1VLmRvY3VtZW50O31lbHNle2lmKCFVLm5vZGVUeXBlKXtyZXR1cm4gcDt9fX12YXIgRixPLFY9dGhpcy51bmlxdWVzPXt9LEk9ISEoSCYmSC5sZW5ndGgpLHk9KFUubm9kZVR5cGU9PTkpO2lmKHRoaXMuZG9jdW1lbnQhPT0oeT9VOlUub3duZXJEb2N1bWVudCkpe3RoaXMuc2V0RG9jdW1lbnQoVSk7Cn1pZihJKXtmb3IoTz1wLmxlbmd0aDtPLS07KXtWW3RoaXMuZ2V0VUlEKHBbT10pXT10cnVlO319aWYodHlwZW9mIHo9PSJzdHJpbmciKXt2YXIgcj16Lm1hdGNoKGYpO3NpbXBsZVNlbGVjdG9yczppZihyKXt2YXIgdT1yWzFdLHY9clsyXSxBLEU7aWYoIXUpe2lmKHY9PSIqIiYmdGhpcy5icm9rZW5TdGFyR0VCVE4pe2JyZWFrIHNpbXBsZVNlbGVjdG9yczsKfUU9VS5nZXRFbGVtZW50c0J5VGFnTmFtZSh2KTtpZihzKXtyZXR1cm4gRVswXXx8bnVsbDt9Zm9yKE89MDtBPUVbTysrXTspe2lmKCEoSSYmVlt0aGlzLmdldFVJRChBKV0pKXtwLnB1c2goQSk7fX19ZWxzZXtpZih1PT0iIyIpe2lmKCF0aGlzLmlzSFRNTERvY3VtZW50fHwheSl7YnJlYWsgc2ltcGxlU2VsZWN0b3JzOwp9QT1VLmdldEVsZW1lbnRCeUlkKHYpO2lmKCFBKXtyZXR1cm4gcDt9aWYodGhpcy5pZEdldHNOYW1lJiZBLmdldEF0dHJpYnV0ZU5vZGUoImlkIikubm9kZVZhbHVlIT12KXticmVhayBzaW1wbGVTZWxlY3RvcnM7fWlmKHMpe3JldHVybiBBfHxudWxsO31pZighKEkmJlZbdGhpcy5nZXRVSUQoQSldKSl7cC5wdXNoKEEpOwp9fWVsc2V7aWYodT09Ii4iKXtpZighdGhpcy5pc0hUTUxEb2N1bWVudHx8KCghVS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lfHx0aGlzLmJyb2tlbkdFQkNOKSYmVS5xdWVyeVNlbGVjdG9yQWxsKSl7YnJlYWsgc2ltcGxlU2VsZWN0b3JzO31pZihVLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJiF0aGlzLmJyb2tlbkdFQkNOKXtFPVUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh2KTsKaWYocyl7cmV0dXJuIEVbMF18fG51bGw7fWZvcihPPTA7QT1FW08rK107KXtpZighKEkmJlZbdGhpcy5nZXRVSUQoQSldKSl7cC5wdXNoKEEpO319fWVsc2V7dmFyIFQ9bmV3IFJlZ0V4cCgiKF58XFxzKSIrZS5lc2NhcGVSZWdFeHAodikrIihcXHN8JCkiKTtFPVUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKTsKZm9yKE89MDtBPUVbTysrXTspe2NsYXNzTmFtZT1BLmNsYXNzTmFtZTtpZighKGNsYXNzTmFtZSYmVC50ZXN0KGNsYXNzTmFtZSkpKXtjb250aW51ZTt9aWYocyl7cmV0dXJuIEE7fWlmKCEoSSYmVlt0aGlzLmdldFVJRChBKV0pKXtwLnB1c2goQSk7fX19fX19aWYoSSl7dGhpcy5zb3J0KHApOwp9cmV0dXJuKHMpP251bGw6cDt9cXVlcnlTZWxlY3RvcjppZihVLnF1ZXJ5U2VsZWN0b3JBbGwpe2lmKCF0aGlzLmlzSFRNTERvY3VtZW50fHxnW3pdfHx0aGlzLmJyb2tlbk1peGVkQ2FzZVFTQXx8KHRoaXMuYnJva2VuQ2hlY2tlZFFTQSYmei5pbmRleE9mKCI6Y2hlY2tlZCIpPi0xKXx8KHRoaXMuYnJva2VuRW1wdHlBdHRyaWJ1dGVRU0EmJmgudGVzdCh6KSl8fCgheSYmei5pbmRleE9mKCIsIik+LTEpfHxlLmRpc2FibGVRU0Epe2JyZWFrIHF1ZXJ5U2VsZWN0b3I7Cn12YXIgUz16LHg9VTtpZigheSl7dmFyIEM9eC5nZXRBdHRyaWJ1dGUoImlkIiksdD0ic2xpY2tpZF9fIjt4LnNldEF0dHJpYnV0ZSgiaWQiLHQpO1M9IiMiK3QrIiAiK1M7VT14LnBhcmVudE5vZGU7fXRyeXtpZihzKXtyZXR1cm4gVS5xdWVyeVNlbGVjdG9yKFMpfHxudWxsOwp9ZWxzZXtFPVUucXVlcnlTZWxlY3RvckFsbChTKTt9fWNhdGNoKFEpe2dbel09MTticmVhayBxdWVyeVNlbGVjdG9yO31maW5hbGx5e2lmKCF5KXtpZihDKXt4LnNldEF0dHJpYnV0ZSgiaWQiLEMpO31lbHNle3gucmVtb3ZlQXR0cmlidXRlKCJpZCIpO31VPXg7fX1pZih0aGlzLnN0YXJTZWxlY3RzQ2xvc2VkUVNBKXtmb3IoTz0wOwpBPUVbTysrXTspe2lmKEEubm9kZU5hbWU+IkAiJiYhKEkmJlZbdGhpcy5nZXRVSUQoQSldKSl7cC5wdXNoKEEpO319fWVsc2V7Zm9yKE89MDtBPUVbTysrXTspe2lmKCEoSSYmVlt0aGlzLmdldFVJRChBKV0pKXtwLnB1c2goQSk7fX19aWYoSSl7dGhpcy5zb3J0KHApOwp9cmV0dXJuIHA7fUY9dGhpcy5TbGljay5wYXJzZSh6KTtpZighRi5sZW5ndGgpe3JldHVybiBwO319ZWxzZXtpZih6PT1udWxsKXtyZXR1cm4gcDt9ZWxzZXtpZih6LlNsaWNrKXtGPXo7fWVsc2V7aWYodGhpcy5jb250YWlucyhVLmRvY3VtZW50RWxlbWVudHx8VSx6KSl7KHApP3AucHVzaCh6KTpwPXo7CnJldHVybiBwO31lbHNle3JldHVybiBwO319fX10aGlzLnBvc05USD17fTt0aGlzLnBvc05USExhc3Q9e307dGhpcy5wb3NOVEhUeXBlPXt9O3RoaXMucG9zTlRIVHlwZUxhc3Q9e307dGhpcy5wdXNoPSghSSYmKHN8fChGLmxlbmd0aD09MSYmRi5leHByZXNzaW9uc1swXS5sZW5ndGg9PTEpKSk/dGhpcy5wdXNoQXJyYXk6dGhpcy5wdXNoVUlEOwppZihwPT1udWxsKXtwPVtdO312YXIgTSxMLEs7dmFyIEIsSixELGMscSxHLFc7dmFyIE4sUCxvLHcsUj1GLmV4cHJlc3Npb25zO3NlYXJjaDpmb3IoTz0wOyhQPVJbT10pO08rKyl7Zm9yKE09MDsobz1QW01dKTtNKyspe0I9ImNvbWJpbmF0b3I6IitvLmNvbWJpbmF0b3I7CmlmKCF0aGlzW0JdKXtjb250aW51ZSBzZWFyY2g7fUo9KHRoaXMuaXNYTUxEb2N1bWVudCk/by50YWc6by50YWcudG9VcHBlckNhc2UoKTtEPW8uaWQ7Yz1vLmNsYXNzTGlzdDtxPW8uY2xhc3NlcztHPW8uYXR0cmlidXRlcztXPW8ucHNldWRvczt3PShNPT09KFAubGVuZ3RoLTEpKTsKdGhpcy5iaXRVbmlxdWVzPXt9O2lmKHcpe3RoaXMudW5pcXVlcz1WO3RoaXMuZm91bmQ9cDt9ZWxzZXt0aGlzLnVuaXF1ZXM9e307dGhpcy5mb3VuZD1bXTt9aWYoTT09PTApe3RoaXNbQl0oVSxKLEQscSxHLFcsYyk7aWYocyYmdyYmcC5sZW5ndGgpe2JyZWFrIHNlYXJjaDsKfX1lbHNle2lmKHMmJncpe2ZvcihMPTAsSz1OLmxlbmd0aDtMPEs7TCsrKXt0aGlzW0JdKE5bTF0sSixELHEsRyxXLGMpO2lmKHAubGVuZ3RoKXticmVhayBzZWFyY2g7fX19ZWxzZXtmb3IoTD0wLEs9Ti5sZW5ndGg7TDxLO0wrKyl7dGhpc1tCXShOW0xdLEosRCxxLEcsVyxjKTsKfX19Tj10aGlzLmZvdW5kO319aWYoSXx8KEYuZXhwcmVzc2lvbnMubGVuZ3RoPjEpKXt0aGlzLnNvcnQocCk7fXJldHVybihzKT8ocFswXXx8bnVsbCk6cDt9O2sudWlkeD0xO2sudWlkaz0ic2xpY2stdW5pcXVlaWQiO2suZ2V0VUlEWE1MPWZ1bmN0aW9uKG4pe3ZhciBjPW4uZ2V0QXR0cmlidXRlKHRoaXMudWlkayk7CmlmKCFjKXtjPXRoaXMudWlkeCsrO24uc2V0QXR0cmlidXRlKHRoaXMudWlkayxjKTt9cmV0dXJuIGM7fTtrLmdldFVJREhUTUw9ZnVuY3Rpb24oYyl7cmV0dXJuIGMudW5pcXVlTnVtYmVyfHwoYy51bmlxdWVOdW1iZXI9dGhpcy51aWR4KyspO307ay5zb3J0PWZ1bmN0aW9uKGMpe2lmKCF0aGlzLmRvY3VtZW50U29ydGVyKXtyZXR1cm4gYzsKfWMuc29ydCh0aGlzLmRvY3VtZW50U29ydGVyKTtyZXR1cm4gYzt9O2suY2FjaGVOVEg9e307ay5tYXRjaE5USD0vXihbKy1dP1xkKik/KFthLXpdKyk/KFsrLV1cZCspPyQvO2sucGFyc2VOVEhBcmd1bWVudD1mdW5jdGlvbihxKXt2YXIgbz1xLm1hdGNoKHRoaXMubWF0Y2hOVEgpOwppZighbyl7cmV0dXJuIGZhbHNlO312YXIgcD1vWzJdfHxmYWxzZTt2YXIgbj1vWzFdfHwxO2lmKG49PSItIil7bj0tMTt9dmFyIGM9K29bM118fDA7bz0ocD09Im4iKT97YTpuLGI6Y306KHA9PSJvZGQiKT97YToyLGI6MX06KHA9PSJldmVuIik/e2E6MixiOjB9OnthOjAsYjpufTsKcmV0dXJuKHRoaXMuY2FjaGVOVEhbcV09byk7fTtrLmNyZWF0ZU5USFBzZXVkbz1mdW5jdGlvbihwLG4sYyxvKXtyZXR1cm4gZnVuY3Rpb24ocyxxKXt2YXIgdT10aGlzLmdldFVJRChzKTtpZighdGhpc1tjXVt1XSl7dmFyIEE9cy5wYXJlbnROb2RlO2lmKCFBKXtyZXR1cm4gZmFsc2U7Cn12YXIgcj1BW3BdLHQ9MTtpZihvKXt2YXIgej1zLm5vZGVOYW1lO2Rve2lmKHIubm9kZU5hbWUhPXope2NvbnRpbnVlO310aGlzW2NdW3RoaXMuZ2V0VUlEKHIpXT10Kys7fXdoaWxlKChyPXJbbl0pKTt9ZWxzZXtkb3tpZihyLm5vZGVUeXBlIT0xKXtjb250aW51ZTsKfXRoaXNbY11bdGhpcy5nZXRVSUQocildPXQrKzt9d2hpbGUoKHI9cltuXSkpO319cT1xfHwibiI7dmFyIHY9dGhpcy5jYWNoZU5USFtxXXx8dGhpcy5wYXJzZU5USEFyZ3VtZW50KHEpO2lmKCF2KXtyZXR1cm4gZmFsc2U7fXZhciB5PXYuYSx4PXYuYix3PXRoaXNbY11bdV07CmlmKHk9PTApe3JldHVybiB4PT13O31pZih5PjApe2lmKHc8eCl7cmV0dXJuIGZhbHNlO319ZWxzZXtpZih4PHcpe3JldHVybiBmYWxzZTt9fXJldHVybigody14KSV5KT09MDt9O307ay5wdXNoQXJyYXk9ZnVuY3Rpb24ocCxjLHIsbyxuLHEpe2lmKHRoaXMubWF0Y2hTZWxlY3RvcihwLGMscixvLG4scSkpe3RoaXMuZm91bmQucHVzaChwKTsKfX07ay5wdXNoVUlEPWZ1bmN0aW9uKHEsYyxzLHAsbixyKXt2YXIgbz10aGlzLmdldFVJRChxKTtpZighdGhpcy51bmlxdWVzW29dJiZ0aGlzLm1hdGNoU2VsZWN0b3IocSxjLHMscCxuLHIpKXt0aGlzLnVuaXF1ZXNbb109dHJ1ZTt0aGlzLmZvdW5kLnB1c2gocSk7fX07CmsubWF0Y2hOb2RlPWZ1bmN0aW9uKG4sbyl7aWYodGhpcy5pc0hUTUxEb2N1bWVudCYmdGhpcy5uYXRpdmVNYXRjaGVzU2VsZWN0b3Ipe3RyeXtyZXR1cm4gdGhpcy5uYXRpdmVNYXRjaGVzU2VsZWN0b3IuY2FsbChuLG8ucmVwbGFjZSgvXFsoW149XSspPVxzKihbXiciXF1dKz8pXHMqXF0vZywnWyQxPSIkMiJdJykpOwp9Y2F0Y2godSl7fX12YXIgdD10aGlzLlNsaWNrLnBhcnNlKG8pO2lmKCF0KXtyZXR1cm4gdHJ1ZTt9dmFyIHI9dC5leHByZXNzaW9ucyxzPTAscTtmb3IocT0wOyhjdXJyZW50RXhwcmVzc2lvbj1yW3FdKTtxKyspe2lmKGN1cnJlbnRFeHByZXNzaW9uLmxlbmd0aD09MSl7dmFyIHA9Y3VycmVudEV4cHJlc3Npb25bMF07CmlmKHRoaXMubWF0Y2hTZWxlY3RvcihuLCh0aGlzLmlzWE1MRG9jdW1lbnQpP3AudGFnOnAudGFnLnRvVXBwZXJDYXNlKCkscC5pZCxwLmNsYXNzZXMscC5hdHRyaWJ1dGVzLHAucHNldWRvcykpe3JldHVybiB0cnVlO31zKys7fX1pZihzPT10Lmxlbmd0aCl7cmV0dXJuIGZhbHNlOwp9dmFyIGM9dGhpcy5zZWFyY2godGhpcy5kb2N1bWVudCx0KSx2O2ZvcihxPTA7dj1jW3ErK107KXtpZih2PT09bil7cmV0dXJuIHRydWU7fX1yZXR1cm4gZmFsc2U7fTtrLm1hdGNoUHNldWRvPWZ1bmN0aW9uKHEsYyxwKXt2YXIgbj0icHNldWRvOiIrYztpZih0aGlzW25dKXtyZXR1cm4gdGhpc1tuXShxLHApOwp9dmFyIG89dGhpcy5nZXRBdHRyaWJ1dGUocSxjKTtyZXR1cm4ocCk/cD09bzohIW87fTtrLm1hdGNoU2VsZWN0b3I9ZnVuY3Rpb24obyx2LGMscCxxLHMpe2lmKHYpe3ZhciB0PSh0aGlzLmlzWE1MRG9jdW1lbnQpP28ubm9kZU5hbWU6by5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpOwppZih2PT0iKiIpe2lmKHQ8IkAiKXtyZXR1cm4gZmFsc2U7fX1lbHNle2lmKHQhPXYpe3JldHVybiBmYWxzZTt9fX1pZihjJiZvLmdldEF0dHJpYnV0ZSgiaWQiKSE9Yyl7cmV0dXJuIGZhbHNlO312YXIgcixuLHU7aWYocCl7Zm9yKHI9cC5sZW5ndGg7ci0tOyl7dT10aGlzLmdldEF0dHJpYnV0ZShvLCJjbGFzcyIpOwppZighKHUmJnBbcl0ucmVnZXhwLnRlc3QodSkpKXtyZXR1cm4gZmFsc2U7fX19aWYocSl7Zm9yKHI9cS5sZW5ndGg7ci0tOyl7bj1xW3JdO2lmKG4ub3BlcmF0b3I/IW4udGVzdCh0aGlzLmdldEF0dHJpYnV0ZShvLG4ua2V5KSk6IXRoaXMuaGFzQXR0cmlidXRlKG8sbi5rZXkpKXtyZXR1cm4gZmFsc2U7Cn19fWlmKHMpe2ZvcihyPXMubGVuZ3RoO3ItLTspe249c1tyXTtpZighdGhpcy5tYXRjaFBzZXVkbyhvLG4ua2V5LG4udmFsdWUpKXtyZXR1cm4gZmFsc2U7fX19cmV0dXJuIHRydWU7fTt2YXIgaj17IiAiOmZ1bmN0aW9uKHEsdyxuLHIscyx1LHApe3ZhciB0LHYsbzsKaWYodGhpcy5pc0hUTUxEb2N1bWVudCl7Z2V0QnlJZDppZihuKXt2PXRoaXMuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobik7aWYoKCF2JiZxLmFsbCl8fCh0aGlzLmlkR2V0c05hbWUmJnYmJnYuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS5ub2RlVmFsdWUhPW4pKXtvPXEuYWxsW25dOwppZighbyl7cmV0dXJuO31pZighb1swXSl7bz1bb107fWZvcih0PTA7dj1vW3QrK107KXt2YXIgYz12LmdldEF0dHJpYnV0ZU5vZGUoImlkIik7aWYoYyYmYy5ub2RlVmFsdWU9PW4pe3RoaXMucHVzaCh2LHcsbnVsbCxyLHMsdSk7YnJlYWs7fX1yZXR1cm47fWlmKCF2KXtpZih0aGlzLmNvbnRhaW5zKHRoaXMucm9vdCxxKSl7cmV0dXJuOwp9ZWxzZXticmVhayBnZXRCeUlkO319ZWxzZXtpZih0aGlzLmRvY3VtZW50IT09cSYmIXRoaXMuY29udGFpbnMocSx2KSl7cmV0dXJuO319dGhpcy5wdXNoKHYsdyxudWxsLHIscyx1KTtyZXR1cm47fWdldEJ5Q2xhc3M6aWYociYmcS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiYhdGhpcy5icm9rZW5HRUJDTil7bz1xLmdldEVsZW1lbnRzQnlDbGFzc05hbWUocC5qb2luKCIgIikpOwppZighKG8mJm8ubGVuZ3RoKSl7YnJlYWsgZ2V0QnlDbGFzczt9Zm9yKHQ9MDt2PW9bdCsrXTspe3RoaXMucHVzaCh2LHcsbixudWxsLHMsdSk7fXJldHVybjt9fWdldEJ5VGFnOntvPXEuZ2V0RWxlbWVudHNCeVRhZ05hbWUodyk7aWYoIShvJiZvLmxlbmd0aCkpe2JyZWFrIGdldEJ5VGFnOwp9aWYoIXRoaXMuYnJva2VuU3RhckdFQlROKXt3PW51bGw7fWZvcih0PTA7dj1vW3QrK107KXt0aGlzLnB1c2godix3LG4scixzLHUpO319fSwiPiI6ZnVuY3Rpb24ocCxjLHIsbyxuLHEpe2lmKChwPXAuZmlyc3RDaGlsZCkpe2Rve2lmKHAubm9kZVR5cGU9PTEpe3RoaXMucHVzaChwLGMscixvLG4scSk7Cn19d2hpbGUoKHA9cC5uZXh0U2libGluZykpO319LCIrIjpmdW5jdGlvbihwLGMscixvLG4scSl7d2hpbGUoKHA9cC5uZXh0U2libGluZykpe2lmKHAubm9kZVR5cGU9PTEpe3RoaXMucHVzaChwLGMscixvLG4scSk7YnJlYWs7fX19LCJeIjpmdW5jdGlvbihwLGMscixvLG4scSl7cD1wLmZpcnN0Q2hpbGQ7CmlmKHApe2lmKHAubm9kZVR5cGU9PTEpe3RoaXMucHVzaChwLGMscixvLG4scSk7fWVsc2V7dGhpc1siY29tYmluYXRvcjorIl0ocCxjLHIsbyxuLHEpO319fSwifiI6ZnVuY3Rpb24ocSxjLHMscCxuLHIpe3doaWxlKChxPXEubmV4dFNpYmxpbmcpKXtpZihxLm5vZGVUeXBlIT0xKXtjb250aW51ZTsKfXZhciBvPXRoaXMuZ2V0VUlEKHEpO2lmKHRoaXMuYml0VW5pcXVlc1tvXSl7YnJlYWs7fXRoaXMuYml0VW5pcXVlc1tvXT10cnVlO3RoaXMucHVzaChxLGMscyxwLG4scik7fX0sIisrIjpmdW5jdGlvbihwLGMscixvLG4scSl7dGhpc1siY29tYmluYXRvcjorIl0ocCxjLHIsbyxuLHEpOwp0aGlzWyJjb21iaW5hdG9yOiErIl0ocCxjLHIsbyxuLHEpO30sIn5+IjpmdW5jdGlvbihwLGMscixvLG4scSl7dGhpc1siY29tYmluYXRvcjp+Il0ocCxjLHIsbyxuLHEpO3RoaXNbImNvbWJpbmF0b3I6IX4iXShwLGMscixvLG4scSk7fSwiISI6ZnVuY3Rpb24ocCxjLHIsbyxuLHEpe3doaWxlKChwPXAucGFyZW50Tm9kZSkpe2lmKHAhPT10aGlzLmRvY3VtZW50KXt0aGlzLnB1c2gocCxjLHIsbyxuLHEpOwp9fX0sIiE+IjpmdW5jdGlvbihwLGMscixvLG4scSl7cD1wLnBhcmVudE5vZGU7aWYocCE9PXRoaXMuZG9jdW1lbnQpe3RoaXMucHVzaChwLGMscixvLG4scSk7fX0sIiErIjpmdW5jdGlvbihwLGMscixvLG4scSl7d2hpbGUoKHA9cC5wcmV2aW91c1NpYmxpbmcpKXtpZihwLm5vZGVUeXBlPT0xKXt0aGlzLnB1c2gocCxjLHIsbyxuLHEpOwpicmVhazt9fX0sIiFeIjpmdW5jdGlvbihwLGMscixvLG4scSl7cD1wLmxhc3RDaGlsZDtpZihwKXtpZihwLm5vZGVUeXBlPT0xKXt0aGlzLnB1c2gocCxjLHIsbyxuLHEpO31lbHNle3RoaXNbImNvbWJpbmF0b3I6ISsiXShwLGMscixvLG4scSk7fX19LCIhfiI6ZnVuY3Rpb24ocSxjLHMscCxuLHIpe3doaWxlKChxPXEucHJldmlvdXNTaWJsaW5nKSl7aWYocS5ub2RlVHlwZSE9MSl7Y29udGludWU7Cn12YXIgbz10aGlzLmdldFVJRChxKTtpZih0aGlzLmJpdFVuaXF1ZXNbb10pe2JyZWFrO310aGlzLmJpdFVuaXF1ZXNbb109dHJ1ZTt0aGlzLnB1c2gocSxjLHMscCxuLHIpO319fTtmb3IodmFyIGkgaW4gail7a1siY29tYmluYXRvcjoiK2ldPWpbaV07fXZhciBsPXtlbXB0eTpmdW5jdGlvbihjKXt2YXIgbj1jLmZpcnN0Q2hpbGQ7CnJldHVybiAhKG4mJm4ubm9kZVR5cGU9PTEpJiYhKGMuaW5uZXJUZXh0fHxjLnRleHRDb250ZW50fHwiIikubGVuZ3RoO30sbm90OmZ1bmN0aW9uKGMsbil7cmV0dXJuICF0aGlzLm1hdGNoTm9kZShjLG4pO30sY29udGFpbnM6ZnVuY3Rpb24oYyxuKXtyZXR1cm4oYy5pbm5lclRleHR8fGMudGV4dENvbnRlbnR8fCIiKS5pbmRleE9mKG4pPi0xOwp9LCJmaXJzdC1jaGlsZCI6ZnVuY3Rpb24oYyl7d2hpbGUoKGM9Yy5wcmV2aW91c1NpYmxpbmcpKXtpZihjLm5vZGVUeXBlPT0xKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTt9LCJsYXN0LWNoaWxkIjpmdW5jdGlvbihjKXt3aGlsZSgoYz1jLm5leHRTaWJsaW5nKSl7aWYoYy5ub2RlVHlwZT09MSl7cmV0dXJuIGZhbHNlOwp9fXJldHVybiB0cnVlO30sIm9ubHktY2hpbGQiOmZ1bmN0aW9uKG8pe3ZhciBuPW87d2hpbGUoKG49bi5wcmV2aW91c1NpYmxpbmcpKXtpZihuLm5vZGVUeXBlPT0xKXtyZXR1cm4gZmFsc2U7fX12YXIgYz1vO3doaWxlKChjPWMubmV4dFNpYmxpbmcpKXtpZihjLm5vZGVUeXBlPT0xKXtyZXR1cm4gZmFsc2U7Cn19cmV0dXJuIHRydWU7fSwibnRoLWNoaWxkIjprLmNyZWF0ZU5USFBzZXVkbygiZmlyc3RDaGlsZCIsIm5leHRTaWJsaW5nIiwicG9zTlRIIiksIm50aC1sYXN0LWNoaWxkIjprLmNyZWF0ZU5USFBzZXVkbygibGFzdENoaWxkIiwicHJldmlvdXNTaWJsaW5nIiwicG9zTlRITGFzdCIpLCJudGgtb2YtdHlwZSI6ay5jcmVhdGVOVEhQc2V1ZG8oImZpcnN0Q2hpbGQiLCJuZXh0U2libGluZyIsInBvc05USFR5cGUiLHRydWUpLCJudGgtbGFzdC1vZi10eXBlIjprLmNyZWF0ZU5USFBzZXVkbygibGFzdENoaWxkIiwicHJldmlvdXNTaWJsaW5nIiwicG9zTlRIVHlwZUxhc3QiLHRydWUpLGluZGV4OmZ1bmN0aW9uKG4sYyl7cmV0dXJuIHRoaXNbInBzZXVkbzpudGgtY2hpbGQiXShuLCIiKyhjKzEpKTsKfSxldmVuOmZ1bmN0aW9uKGMpe3JldHVybiB0aGlzWyJwc2V1ZG86bnRoLWNoaWxkIl0oYywiMm4iKTt9LG9kZDpmdW5jdGlvbihjKXtyZXR1cm4gdGhpc1sicHNldWRvOm50aC1jaGlsZCJdKGMsIjJuKzEiKTt9LCJmaXJzdC1vZi10eXBlIjpmdW5jdGlvbihjKXt2YXIgbj1jLm5vZGVOYW1lOwp3aGlsZSgoYz1jLnByZXZpb3VzU2libGluZykpe2lmKGMubm9kZU5hbWU9PW4pe3JldHVybiBmYWxzZTt9fXJldHVybiB0cnVlO30sImxhc3Qtb2YtdHlwZSI6ZnVuY3Rpb24oYyl7dmFyIG49Yy5ub2RlTmFtZTt3aGlsZSgoYz1jLm5leHRTaWJsaW5nKSl7aWYoYy5ub2RlTmFtZT09bil7cmV0dXJuIGZhbHNlOwp9fXJldHVybiB0cnVlO30sIm9ubHktb2YtdHlwZSI6ZnVuY3Rpb24obyl7dmFyIG49byxwPW8ubm9kZU5hbWU7d2hpbGUoKG49bi5wcmV2aW91c1NpYmxpbmcpKXtpZihuLm5vZGVOYW1lPT1wKXtyZXR1cm4gZmFsc2U7fX12YXIgYz1vO3doaWxlKChjPWMubmV4dFNpYmxpbmcpKXtpZihjLm5vZGVOYW1lPT1wKXtyZXR1cm4gZmFsc2U7Cn19cmV0dXJuIHRydWU7fSxlbmFibGVkOmZ1bmN0aW9uKGMpe3JldHVybiAhYy5kaXNhYmxlZDt9LGRpc2FibGVkOmZ1bmN0aW9uKGMpe3JldHVybiBjLmRpc2FibGVkO30sY2hlY2tlZDpmdW5jdGlvbihjKXtyZXR1cm4gYy5jaGVja2VkfHxjLnNlbGVjdGVkO30sZm9jdXM6ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuaXNIVE1MRG9jdW1lbnQmJnRoaXMuZG9jdW1lbnQuYWN0aXZlRWxlbWVudD09PWMmJihjLmhyZWZ8fGMudHlwZXx8dGhpcy5oYXNBdHRyaWJ1dGUoYywidGFiaW5kZXgiKSk7Cn0scm9vdDpmdW5jdGlvbihjKXtyZXR1cm4oYz09PXRoaXMucm9vdCk7fSxzZWxlY3RlZDpmdW5jdGlvbihjKXtyZXR1cm4gYy5zZWxlY3RlZDt9fTtmb3IodmFyIGIgaW4gbCl7a1sicHNldWRvOiIrYl09bFtiXTt9dmFyIGE9ay5hdHRyaWJ1dGVHZXR0ZXJzPXsiZm9yIjpmdW5jdGlvbigpe3JldHVybigiaHRtbEZvciIgaW4gdGhpcyk/dGhpcy5odG1sRm9yOnRoaXMuZ2V0QXR0cmlidXRlKCJmb3IiKTsKfSxocmVmOmZ1bmN0aW9uKCl7cmV0dXJuKCJocmVmIiBpbiB0aGlzKT90aGlzLmdldEF0dHJpYnV0ZSgiaHJlZiIsMik6dGhpcy5nZXRBdHRyaWJ1dGUoImhyZWYiKTt9LHN0eWxlOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuc3R5bGUpP3RoaXMuc3R5bGUuY3NzVGV4dDp0aGlzLmdldEF0dHJpYnV0ZSgic3R5bGUiKTsKfSx0YWJpbmRleDpmdW5jdGlvbigpe3ZhciBjPXRoaXMuZ2V0QXR0cmlidXRlTm9kZSgidGFiaW5kZXgiKTtyZXR1cm4oYyYmYy5zcGVjaWZpZWQpP2Mubm9kZVZhbHVlOm51bGw7fSx0eXBlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKCJ0eXBlIik7Cn0sbWF4bGVuZ3RoOmZ1bmN0aW9uKCl7dmFyIGM9dGhpcy5nZXRBdHRyaWJ1dGVOb2RlKCJtYXhMZW5ndGgiKTtyZXR1cm4oYyYmYy5zcGVjaWZpZWQpP2Mubm9kZVZhbHVlOm51bGw7fX07YS5NQVhMRU5HVEg9YS5tYXhMZW5ndGg9YS5tYXhsZW5ndGg7dmFyIGU9ay5TbGljaz0odGhpcy5TbGlja3x8e30pOwplLnZlcnNpb249IjEuMS43IjtlLnNlYXJjaD1mdW5jdGlvbihuLG8sYyl7cmV0dXJuIGsuc2VhcmNoKG4sbyxjKTt9O2UuZmluZD1mdW5jdGlvbihjLG4pe3JldHVybiBrLnNlYXJjaChjLG4sbnVsbCx0cnVlKTt9O2UuY29udGFpbnM9ZnVuY3Rpb24oYyxuKXtrLnNldERvY3VtZW50KGMpOwpyZXR1cm4gay5jb250YWlucyhjLG4pO307ZS5nZXRBdHRyaWJ1dGU9ZnVuY3Rpb24obixjKXtrLnNldERvY3VtZW50KG4pO3JldHVybiBrLmdldEF0dHJpYnV0ZShuLGMpO307ZS5oYXNBdHRyaWJ1dGU9ZnVuY3Rpb24obixjKXtrLnNldERvY3VtZW50KG4pO3JldHVybiBrLmhhc0F0dHJpYnV0ZShuLGMpOwp9O2UubWF0Y2g9ZnVuY3Rpb24obixjKXtpZighKG4mJmMpKXtyZXR1cm4gZmFsc2U7fWlmKCFjfHxjPT09bil7cmV0dXJuIHRydWU7fWsuc2V0RG9jdW1lbnQobik7cmV0dXJuIGsubWF0Y2hOb2RlKG4sYyk7fTtlLmRlZmluZUF0dHJpYnV0ZUdldHRlcj1mdW5jdGlvbihjLG4pe2suYXR0cmlidXRlR2V0dGVyc1tjXT1uOwpyZXR1cm4gdGhpczt9O2UubG9va3VwQXR0cmlidXRlR2V0dGVyPWZ1bmN0aW9uKGMpe3JldHVybiBrLmF0dHJpYnV0ZUdldHRlcnNbY107fTtlLmRlZmluZVBzZXVkbz1mdW5jdGlvbihjLG4pe2tbInBzZXVkbzoiK2NdPWZ1bmN0aW9uKHAsbyl7cmV0dXJuIG4uY2FsbChwLG8pOwp9O3JldHVybiB0aGlzO307ZS5sb29rdXBQc2V1ZG89ZnVuY3Rpb24oYyl7dmFyIG49a1sicHNldWRvOiIrY107aWYobil7cmV0dXJuIGZ1bmN0aW9uKG8pe3JldHVybiBuLmNhbGwodGhpcyxvKTt9O31yZXR1cm4gbnVsbDt9O2Uub3ZlcnJpZGU9ZnVuY3Rpb24obixjKXtrLm92ZXJyaWRlKG4sYyk7CnJldHVybiB0aGlzO307ZS5pc1hNTD1rLmlzWE1MO2UudWlkT2Y9ZnVuY3Rpb24oYyl7cmV0dXJuIGsuZ2V0VUlESFRNTChjKTt9O2lmKCF0aGlzLlNsaWNrKXt0aGlzLlNsaWNrPWU7fX0pLmFwcGx5KCh0eXBlb2YgZXhwb3J0cyE9InVuZGVmaW5lZCIpP2V4cG9ydHM6dGhpcyk7CnZhciBFbGVtZW50PWZ1bmN0aW9uKGIsZyl7dmFyIGg9RWxlbWVudC5Db25zdHJ1Y3RvcnNbYl07aWYoaCl7cmV0dXJuIGgoZyk7fWlmKHR5cGVvZiBiIT0ic3RyaW5nIil7cmV0dXJuIGRvY3VtZW50LmlkKGIpLnNldChnKTt9aWYoIWcpe2c9e307fWlmKCEoL15bXHctXSskLykudGVzdChiKSl7dmFyIGU9U2xpY2sucGFyc2UoYikuZXhwcmVzc2lvbnNbMF1bMF07CmI9KGUudGFnPT0iKiIpPyJkaXYiOmUudGFnO2lmKGUuaWQmJmcuaWQ9PW51bGwpe2cuaWQ9ZS5pZDt9dmFyIGQ9ZS5hdHRyaWJ1dGVzO2lmKGQpe2Zvcih2YXIgYSxmPTAsYz1kLmxlbmd0aDtmPGM7ZisrKXthPWRbZl07aWYoZ1thLmtleV0hPW51bGwpe2NvbnRpbnVlOwp9aWYoYS52YWx1ZSE9bnVsbCYmYS5vcGVyYXRvcj09Ij0iKXtnW2Eua2V5XT1hLnZhbHVlO31lbHNle2lmKCFhLnZhbHVlJiYhYS5vcGVyYXRvcil7Z1thLmtleV09dHJ1ZTt9fX19aWYoZS5jbGFzc0xpc3QmJmdbImNsYXNzIl09PW51bGwpe2dbImNsYXNzIl09ZS5jbGFzc0xpc3Quam9pbigiICIpOwp9fXJldHVybiBkb2N1bWVudC5uZXdFbGVtZW50KGIsZyk7fTtpZihCcm93c2VyLkVsZW1lbnQpe0VsZW1lbnQucHJvdG90eXBlPUJyb3dzZXIuRWxlbWVudC5wcm90b3R5cGU7RWxlbWVudC5wcm90b3R5cGUuX2ZpcmVFdmVudD0oZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEuY2FsbCh0aGlzLGIsYyk7Cn07fSkoRWxlbWVudC5wcm90b3R5cGUuZmlyZUV2ZW50KTt9bmV3IFR5cGUoIkVsZW1lbnQiLEVsZW1lbnQpLm1pcnJvcihmdW5jdGlvbihhKXtpZihBcnJheS5wcm90b3R5cGVbYV0pe3JldHVybjt9dmFyIGI9e307YlthXT1mdW5jdGlvbigpe3ZhciBoPVtdLGU9YXJndW1lbnRzLGo9dHJ1ZTsKZm9yKHZhciBnPTAsZD10aGlzLmxlbmd0aDtnPGQ7ZysrKXt2YXIgZj10aGlzW2ddLGM9aFtnXT1mW2FdLmFwcGx5KGYsZSk7aj0oaiYmdHlwZU9mKGMpPT0iZWxlbWVudCIpO31yZXR1cm4oaik/bmV3IEVsZW1lbnRzKGgpOmg7fTtFbGVtZW50cy5pbXBsZW1lbnQoYik7Cn0pO2lmKCFCcm93c2VyLkVsZW1lbnQpe0VsZW1lbnQucGFyZW50PU9iamVjdDtFbGVtZW50LlByb3RvdHlwZT17IiRjb25zdHJ1Y3RvciI6RWxlbWVudCwiJGZhbWlseSI6RnVuY3Rpb24uZnJvbSgiZWxlbWVudCIpLmhpZGUoKX07RWxlbWVudC5taXJyb3IoZnVuY3Rpb24oYSxiKXtFbGVtZW50LlByb3RvdHlwZVthXT1iOwp9KTt9RWxlbWVudC5Db25zdHJ1Y3RvcnM9e307dmFyIElGcmFtZT1uZXcgVHlwZSgiSUZyYW1lIixmdW5jdGlvbigpe3ZhciBlPUFycmF5LmxpbmsoYXJndW1lbnRzLHtwcm9wZXJ0aWVzOlR5cGUuaXNPYmplY3QsaWZyYW1lOmZ1bmN0aW9uKGYpe3JldHVybihmIT1udWxsKTsKfX0pO3ZhciBjPWUucHJvcGVydGllc3x8e30sYjtpZihlLmlmcmFtZSl7Yj1kb2N1bWVudC5pZChlLmlmcmFtZSk7fXZhciBkPWMub25sb2FkfHxmdW5jdGlvbigpe307ZGVsZXRlIGMub25sb2FkO2MuaWQ9Yy5uYW1lPVtjLmlkLGMubmFtZSxiPyhiLmlkfHxiLm5hbWUpOiJJRnJhbWVfIitTdHJpbmcudW5pcXVlSUQoKV0ucGljaygpOwpiPW5ldyBFbGVtZW50KGJ8fCJpZnJhbWUiLGMpO3ZhciBhPWZ1bmN0aW9uKCl7ZC5jYWxsKGIuY29udGVudFdpbmRvdyk7fTtpZih3aW5kb3cuZnJhbWVzW2MuaWRdKXthKCk7fWVsc2V7Yi5hZGRMaXN0ZW5lcigibG9hZCIsYSk7fXJldHVybiBiO30pO3ZhciBFbGVtZW50cz10aGlzLkVsZW1lbnRzPWZ1bmN0aW9uKGEpe2lmKGEmJmEubGVuZ3RoKXt2YXIgZT17fSxkOwpmb3IodmFyIGM9MDtkPWFbYysrXTspe3ZhciBiPVNsaWNrLnVpZE9mKGQpO2lmKCFlW2JdKXtlW2JdPXRydWU7dGhpcy5wdXNoKGQpO319fX07RWxlbWVudHMucHJvdG90eXBlPXtsZW5ndGg6MH07RWxlbWVudHMucGFyZW50PUFycmF5O25ldyBUeXBlKCJFbGVtZW50cyIsRWxlbWVudHMpLmltcGxlbWVudCh7ZmlsdGVyOmZ1bmN0aW9uKGEsYil7aWYoIWEpe3JldHVybiB0aGlzOwp9cmV0dXJuIG5ldyBFbGVtZW50cyhBcnJheS5maWx0ZXIodGhpcywodHlwZU9mKGEpPT0ic3RyaW5nIik/ZnVuY3Rpb24oYyl7cmV0dXJuIGMubWF0Y2goYSk7fTphLGIpKTt9LnByb3RlY3QoKSxwdXNoOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5sZW5ndGg7Zm9yKHZhciBiPTAsYT1hcmd1bWVudHMubGVuZ3RoOwpiPGE7YisrKXt2YXIgYz1kb2N1bWVudC5pZChhcmd1bWVudHNbYl0pO2lmKGMpe3RoaXNbZCsrXT1jO319cmV0dXJuKHRoaXMubGVuZ3RoPWQpO30ucHJvdGVjdCgpLHVuc2hpZnQ6ZnVuY3Rpb24oKXt2YXIgYj1bXTtmb3IodmFyIGM9MCxhPWFyZ3VtZW50cy5sZW5ndGg7CmM8YTtjKyspe3ZhciBkPWRvY3VtZW50LmlkKGFyZ3VtZW50c1tjXSk7aWYoZCl7Yi5wdXNoKGQpO319cmV0dXJuIEFycmF5LnByb3RvdHlwZS51bnNoaWZ0LmFwcGx5KHRoaXMsYik7fS5wcm90ZWN0KCksY29uY2F0OmZ1bmN0aW9uKCl7dmFyIGI9bmV3IEVsZW1lbnRzKHRoaXMpOwpmb3IodmFyIGM9MCxhPWFyZ3VtZW50cy5sZW5ndGg7YzxhO2MrKyl7dmFyIGQ9YXJndW1lbnRzW2NdO2lmKFR5cGUuaXNFbnVtZXJhYmxlKGQpKXtiLmFwcGVuZChkKTt9ZWxzZXtiLnB1c2goZCk7fX1yZXR1cm4gYjt9LnByb3RlY3QoKSxhcHBlbmQ6ZnVuY3Rpb24oYyl7Zm9yKHZhciBiPTAsYT1jLmxlbmd0aDsKYjxhO2IrKyl7dGhpcy5wdXNoKGNbYl0pO31yZXR1cm4gdGhpczt9LnByb3RlY3QoKSxlbXB0eTpmdW5jdGlvbigpe3doaWxlKHRoaXMubGVuZ3RoKXtkZWxldGUgdGhpc1stLXRoaXMubGVuZ3RoXTt9cmV0dXJuIHRoaXM7fS5wcm90ZWN0KCl9KTsoZnVuY3Rpb24oKXt2YXIgZj1BcnJheS5wcm90b3R5cGUuc3BsaWNlLGE9eyIwIjowLCIxIjoxLGxlbmd0aDoyfTsKZi5jYWxsKGEsMSwxKTtpZihhWzFdPT0xKXtFbGVtZW50cy5pbXBsZW1lbnQoInNwbGljZSIsZnVuY3Rpb24oKXt2YXIgZz10aGlzLmxlbmd0aDt2YXIgZT1mLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt3aGlsZShnPj10aGlzLmxlbmd0aCl7ZGVsZXRlIHRoaXNbZy0tXTsKfXJldHVybiBlO30ucHJvdGVjdCgpKTt9QXJyYXkuZm9yRWFjaE1ldGhvZChmdW5jdGlvbihnLGUpe0VsZW1lbnRzLmltcGxlbWVudChlLGcpO30pO0FycmF5Lm1pcnJvcihFbGVtZW50cyk7dmFyIGQ7dHJ5e2Q9KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIjxpbnB1dCBuYW1lPXg+IikubmFtZT09IngiKTsKfWNhdGNoKGIpe312YXIgYz1mdW5jdGlvbihlKXtyZXR1cm4oIiIrZSkucmVwbGFjZSgvJi9nLCImYW1wOyIpLnJlcGxhY2UoLyIvZywiJnF1b3Q7Iik7fTtEb2N1bWVudC5pbXBsZW1lbnQoe25ld0VsZW1lbnQ6ZnVuY3Rpb24oZSxnKXtpZihnJiZnLmNoZWNrZWQhPW51bGwpe2cuZGVmYXVsdENoZWNrZWQ9Zy5jaGVja2VkOwp9aWYoZCYmZyl7ZT0iPCIrZTtpZihnLm5hbWUpe2UrPScgbmFtZT0iJytjKGcubmFtZSkrJyInO31pZihnLnR5cGUpe2UrPScgdHlwZT0iJytjKGcudHlwZSkrJyInO31lKz0iPiI7ZGVsZXRlIGcubmFtZTtkZWxldGUgZy50eXBlO31yZXR1cm4gdGhpcy5pZCh0aGlzLmNyZWF0ZUVsZW1lbnQoZSkpLnNldChnKTsKfX0pO30pKCk7KGZ1bmN0aW9uKCl7U2xpY2sudWlkT2Yod2luZG93KTtTbGljay51aWRPZihkb2N1bWVudCk7RG9jdW1lbnQuaW1wbGVtZW50KHtuZXdUZXh0Tm9kZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5jcmVhdGVUZXh0Tm9kZShlKTt9LGdldERvY3VtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7Cn0sZ2V0V2luZG93OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMud2luZG93O30saWQ6KGZ1bmN0aW9uKCl7dmFyIGU9e3N0cmluZzpmdW5jdGlvbihFLEQsbCl7RT1TbGljay5maW5kKGwsIiMiK0UucmVwbGFjZSgvKFxXKS9nLCJcXCQxIikpO3JldHVybihFKT9lLmVsZW1lbnQoRSxEKTpudWxsOwp9LGVsZW1lbnQ6ZnVuY3Rpb24oRCxFKXtTbGljay51aWRPZihEKTtpZighRSYmIUQuJGZhbWlseSYmISgvXig/Om9iamVjdHxlbWJlZCkkL2kpLnRlc3QoRC50YWdOYW1lKSl7dmFyIGw9RC5maXJlRXZlbnQ7RC5fZmlyZUV2ZW50PWZ1bmN0aW9uKEYsRyl7cmV0dXJuIGwoRixHKTsKfTtPYmplY3QuYXBwZW5kKEQsRWxlbWVudC5Qcm90b3R5cGUpO31yZXR1cm4gRDt9LG9iamVjdDpmdW5jdGlvbihELEUsbCl7aWYoRC50b0VsZW1lbnQpe3JldHVybiBlLmVsZW1lbnQoRC50b0VsZW1lbnQobCksRSk7fXJldHVybiBudWxsO319O2UudGV4dG5vZGU9ZS53aGl0ZXNwYWNlPWUud2luZG93PWUuZG9jdW1lbnQ9ZnVuY3Rpb24obCl7cmV0dXJuIGw7Cn07cmV0dXJuIGZ1bmN0aW9uKEQsRixFKXtpZihEJiZELiRmYW1pbHkmJkQudW5pcXVlTnVtYmVyKXtyZXR1cm4gRDt9dmFyIGw9dHlwZU9mKEQpO3JldHVybihlW2xdKT9lW2xdKEQsRixFfHxkb2N1bWVudCk6bnVsbDt9O30pKCl9KTtpZih3aW5kb3cuJD09bnVsbCl7V2luZG93LmltcGxlbWVudCgiJCIsZnVuY3Rpb24oZSxsKXtyZXR1cm4gZG9jdW1lbnQuaWQoZSxsLHRoaXMuZG9jdW1lbnQpOwp9KTt9V2luZG93LmltcGxlbWVudCh7Z2V0RG9jdW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb2N1bWVudDt9LGdldFdpbmRvdzpmdW5jdGlvbigpe3JldHVybiB0aGlzO319KTtbRG9jdW1lbnQsRWxlbWVudF0uaW52b2tlKCJpbXBsZW1lbnQiLHtnZXRFbGVtZW50czpmdW5jdGlvbihlKXtyZXR1cm4gU2xpY2suc2VhcmNoKHRoaXMsZSxuZXcgRWxlbWVudHMpOwp9LGdldEVsZW1lbnQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGRvY3VtZW50LmlkKFNsaWNrLmZpbmQodGhpcyxlKSk7fX0pO3ZhciBtPXtjb250YWluczpmdW5jdGlvbihlKXtyZXR1cm4gU2xpY2suY29udGFpbnModGhpcyxlKTt9fTtpZighZG9jdW1lbnQuY29udGFpbnMpe0RvY3VtZW50LmltcGxlbWVudChtKTsKfWlmKCFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKS5jb250YWlucyl7RWxlbWVudC5pbXBsZW1lbnQobSk7fXZhciByPWZ1bmN0aW9uKEUsRCl7aWYoIUUpe3JldHVybiBEO31FPU9iamVjdC5jbG9uZShTbGljay5wYXJzZShFKSk7dmFyIGw9RS5leHByZXNzaW9uczsKZm9yKHZhciBlPWwubGVuZ3RoO2UtLTspe2xbZV1bMF0uY29tYmluYXRvcj1EO31yZXR1cm4gRTt9O09iamVjdC5mb3JFYWNoKHtnZXROZXh0OiJ+IixnZXRQcmV2aW91czoiIX4iLGdldFBhcmVudDoiISJ9LGZ1bmN0aW9uKGUsbCl7RWxlbWVudC5pbXBsZW1lbnQobCxmdW5jdGlvbihEKXtyZXR1cm4gdGhpcy5nZXRFbGVtZW50KHIoRCxlKSk7Cn0pO30pO09iamVjdC5mb3JFYWNoKHtnZXRBbGxOZXh0OiJ+IixnZXRBbGxQcmV2aW91czoiIX4iLGdldFNpYmxpbmdzOiJ+fiIsZ2V0Q2hpbGRyZW46Ij4iLGdldFBhcmVudHM6IiEifSxmdW5jdGlvbihlLGwpe0VsZW1lbnQuaW1wbGVtZW50KGwsZnVuY3Rpb24oRCl7cmV0dXJuIHRoaXMuZ2V0RWxlbWVudHMocihELGUpKTsKfSk7fSk7RWxlbWVudC5pbXBsZW1lbnQoe2dldEZpcnN0OmZ1bmN0aW9uKGUpe3JldHVybiBkb2N1bWVudC5pZChTbGljay5zZWFyY2godGhpcyxyKGUsIj4iKSlbMF0pO30sZ2V0TGFzdDpmdW5jdGlvbihlKXtyZXR1cm4gZG9jdW1lbnQuaWQoU2xpY2suc2VhcmNoKHRoaXMscihlLCI+IikpLmdldExhc3QoKSk7Cn0sZ2V0V2luZG93OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3duZXJEb2N1bWVudC53aW5kb3c7fSxnZXREb2N1bWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm93bmVyRG9jdW1lbnQ7fSxnZXRFbGVtZW50QnlJZDpmdW5jdGlvbihlKXtyZXR1cm4gZG9jdW1lbnQuaWQoU2xpY2suZmluZCh0aGlzLCIjIisoIiIrZSkucmVwbGFjZSgvKFxXKS9nLCJcXCQxIikpKTsKfSxtYXRjaDpmdW5jdGlvbihlKXtyZXR1cm4gIWV8fFNsaWNrLm1hdGNoKHRoaXMsZSk7fX0pO2lmKHdpbmRvdy4kJD09bnVsbCl7V2luZG93LmltcGxlbWVudCgiJCQiLGZ1bmN0aW9uKGUpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe2lmKHR5cGVvZiBlPT0ic3RyaW5nIil7cmV0dXJuIFNsaWNrLnNlYXJjaCh0aGlzLmRvY3VtZW50LGUsbmV3IEVsZW1lbnRzKTsKfWVsc2V7aWYoVHlwZS5pc0VudW1lcmFibGUoZSkpe3JldHVybiBuZXcgRWxlbWVudHMoZSk7fX19cmV0dXJuIG5ldyBFbGVtZW50cyhhcmd1bWVudHMpO30pO312YXIgdz17YmVmb3JlOmZ1bmN0aW9uKGwsZSl7dmFyIEQ9ZS5wYXJlbnROb2RlO2lmKEQpe0QuaW5zZXJ0QmVmb3JlKGwsZSk7Cn19LGFmdGVyOmZ1bmN0aW9uKGwsZSl7dmFyIEQ9ZS5wYXJlbnROb2RlO2lmKEQpe0QuaW5zZXJ0QmVmb3JlKGwsZS5uZXh0U2libGluZyk7fX0sYm90dG9tOmZ1bmN0aW9uKGwsZSl7ZS5hcHBlbmRDaGlsZChsKTt9LHRvcDpmdW5jdGlvbihsLGUpe2UuaW5zZXJ0QmVmb3JlKGwsZS5maXJzdENoaWxkKTsKfX07dy5pbnNpZGU9dy5ib3R0b207dmFyIGo9e30sZD17fTt2YXIgaz17fTtBcnJheS5mb3JFYWNoKFsidHlwZSIsInZhbHVlIiwiZGVmYXVsdFZhbHVlIiwiYWNjZXNzS2V5IiwiY2VsbFBhZGRpbmciLCJjZWxsU3BhY2luZyIsImNvbFNwYW4iLCJmcmFtZUJvcmRlciIsInJvd1NwYW4iLCJ0YWJJbmRleCIsInVzZU1hcCJdLGZ1bmN0aW9uKGUpe2tbZS50b0xvd2VyQ2FzZSgpXT1lOwp9KTtrLmh0bWw9ImlubmVySFRNTCI7ay50ZXh0PShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKS50ZXh0Q29udGVudD09bnVsbCk/ImlubmVyVGV4dCI6InRleHRDb250ZW50IjtPYmplY3QuZm9yRWFjaChrLGZ1bmN0aW9uKGwsZSl7ZFtlXT1mdW5jdGlvbihELEUpe0RbbF09RTsKfTtqW2VdPWZ1bmN0aW9uKEQpe3JldHVybiBEW2xdO307fSk7dmFyIHg9WyJjb21wYWN0Iiwibm93cmFwIiwiaXNtYXAiLCJkZWNsYXJlIiwibm9zaGFkZSIsImNoZWNrZWQiLCJkaXNhYmxlZCIsInJlYWRPbmx5IiwibXVsdGlwbGUiLCJzZWxlY3RlZCIsIm5vcmVzaXplIiwiZGVmZXIiLCJkZWZhdWx0Q2hlY2tlZCIsImF1dG9mb2N1cyIsImNvbnRyb2xzIiwiYXV0b3BsYXkiLCJsb29wIl07CnZhciBoPXt9O0FycmF5LmZvckVhY2goeCxmdW5jdGlvbihlKXt2YXIgbD1lLnRvTG93ZXJDYXNlKCk7aFtsXT1lO2RbbF09ZnVuY3Rpb24oRCxFKXtEW2VdPSEhRTt9O2pbbF09ZnVuY3Rpb24oRCl7cmV0dXJuICEhRFtlXTt9O30pO09iamVjdC5hcHBlbmQoZCx7ImNsYXNzIjpmdW5jdGlvbihlLGwpeygiY2xhc3NOYW1lIiBpbiBlKT9lLmNsYXNzTmFtZT0obHx8IiIpOmUuc2V0QXR0cmlidXRlKCJjbGFzcyIsbCk7Cn0sImZvciI6ZnVuY3Rpb24oZSxsKXsoImh0bWxGb3IiIGluIGUpP2UuaHRtbEZvcj1sOmUuc2V0QXR0cmlidXRlKCJmb3IiLGwpO30sc3R5bGU6ZnVuY3Rpb24oZSxsKXsoZS5zdHlsZSk/ZS5zdHlsZS5jc3NUZXh0PWw6ZS5zZXRBdHRyaWJ1dGUoInN0eWxlIixsKTsKfSx2YWx1ZTpmdW5jdGlvbihlLGwpe2UudmFsdWU9KGwhPW51bGwpP2w6IiI7fX0pO2pbImNsYXNzIl09ZnVuY3Rpb24oZSl7cmV0dXJuKCJjbGFzc05hbWUiIGluIGUpP2UuY2xhc3NOYW1lfHxudWxsOmUuZ2V0QXR0cmlidXRlKCJjbGFzcyIpO307dmFyIGY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CnRyeXtmLnR5cGU9ImJ1dHRvbiI7fWNhdGNoKHope31pZihmLnR5cGUhPSJidXR0b24iKXtkLnR5cGU9ZnVuY3Rpb24oZSxsKXtlLnNldEF0dHJpYnV0ZSgidHlwZSIsbCk7fTt9Zj1udWxsO3ZhciBwPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7cC52YWx1ZT0idCI7CnAudHlwZT0ic3VibWl0IjtpZihwLnZhbHVlIT0idCIpe2QudHlwZT1mdW5jdGlvbihsLGUpe3ZhciBEPWwudmFsdWU7bC50eXBlPWU7bC52YWx1ZT1EO307fXA9bnVsbDt2YXIgcT0oZnVuY3Rpb24oZSl7ZS5yYW5kb209ImF0dHJpYnV0ZSI7cmV0dXJuKGUuZ2V0QXR0cmlidXRlKCJyYW5kb20iKT09ImF0dHJpYnV0ZSIpOwp9KShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSk7RWxlbWVudC5pbXBsZW1lbnQoe3NldFByb3BlcnR5OmZ1bmN0aW9uKGwsRCl7dmFyIEU9ZFtsLnRvTG93ZXJDYXNlKCldO2lmKEUpe0UodGhpcyxEKTt9ZWxzZXtpZihxKXt2YXIgZT10aGlzLnJldHJpZXZlKCIkYXR0cmlidXRlV2hpdGVMaXN0Iix7fSk7Cn1pZihEPT1udWxsKXt0aGlzLnJlbW92ZUF0dHJpYnV0ZShsKTtpZihxKXtkZWxldGUgZVtsXTt9fWVsc2V7dGhpcy5zZXRBdHRyaWJ1dGUobCwiIitEKTtpZihxKXtlW2xdPXRydWU7fX19cmV0dXJuIHRoaXM7fSxzZXRQcm9wZXJ0aWVzOmZ1bmN0aW9uKGUpe2Zvcih2YXIgbCBpbiBlKXt0aGlzLnNldFByb3BlcnR5KGwsZVtsXSk7Cn1yZXR1cm4gdGhpczt9LGdldFByb3BlcnR5OmZ1bmN0aW9uKEYpe3ZhciBEPWpbRi50b0xvd2VyQ2FzZSgpXTtpZihEKXtyZXR1cm4gRCh0aGlzKTt9aWYocSl7dmFyIGw9dGhpcy5nZXRBdHRyaWJ1dGVOb2RlKEYpLEU9dGhpcy5yZXRyaWV2ZSgiJGF0dHJpYnV0ZVdoaXRlTGlzdCIse30pOwppZighbCl7cmV0dXJuIG51bGw7fWlmKGwuZXhwYW5kbyYmIUVbRl0pe3ZhciBHPXRoaXMub3V0ZXJIVE1MO2lmKEcuc3Vic3RyKDAsRy5zZWFyY2goL1wvP1snIl0/Pig/IVtePF0qPFsnIl0pLykpLmluZGV4T2YoRik8MCl7cmV0dXJuIG51bGw7fUVbRl09dHJ1ZTt9fXZhciBlPVNsaWNrLmdldEF0dHJpYnV0ZSh0aGlzLEYpOwpyZXR1cm4oIWUmJiFTbGljay5oYXNBdHRyaWJ1dGUodGhpcyxGKSk/bnVsbDplO30sZ2V0UHJvcGVydGllczpmdW5jdGlvbigpe3ZhciBlPUFycmF5LmZyb20oYXJndW1lbnRzKTtyZXR1cm4gZS5tYXAodGhpcy5nZXRQcm9wZXJ0eSx0aGlzKS5hc3NvY2lhdGUoZSk7Cn0scmVtb3ZlUHJvcGVydHk6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuc2V0UHJvcGVydHkoZSxudWxsKTt9LHJlbW92ZVByb3BlcnRpZXM6ZnVuY3Rpb24oKXtBcnJheS5lYWNoKGFyZ3VtZW50cyx0aGlzLnJlbW92ZVByb3BlcnR5LHRoaXMpO3JldHVybiB0aGlzO30sc2V0OmZ1bmN0aW9uKEQsbCl7dmFyIGU9RWxlbWVudC5Qcm9wZXJ0aWVzW0RdOwooZSYmZS5zZXQpP2Uuc2V0LmNhbGwodGhpcyxsKTp0aGlzLnNldFByb3BlcnR5KEQsbCk7fS5vdmVybG9hZFNldHRlcigpLGdldDpmdW5jdGlvbihsKXt2YXIgZT1FbGVtZW50LlByb3BlcnRpZXNbbF07cmV0dXJuKGUmJmUuZ2V0KT9lLmdldC5hcHBseSh0aGlzKTp0aGlzLmdldFByb3BlcnR5KGwpOwp9Lm92ZXJsb2FkR2V0dGVyKCksZXJhc2U6ZnVuY3Rpb24obCl7dmFyIGU9RWxlbWVudC5Qcm9wZXJ0aWVzW2xdOyhlJiZlLmVyYXNlKT9lLmVyYXNlLmFwcGx5KHRoaXMpOnRoaXMucmVtb3ZlUHJvcGVydHkobCk7cmV0dXJuIHRoaXM7fSxoYXNDbGFzczpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5jbGFzc05hbWUuY2xlYW4oKS5jb250YWlucyhlLCIgIik7Cn0sYWRkQ2xhc3M6ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaGFzQ2xhc3MoZSkpe3RoaXMuY2xhc3NOYW1lPSh0aGlzLmNsYXNzTmFtZSsiICIrZSkuY2xlYW4oKTt9cmV0dXJuIHRoaXM7fSxyZW1vdmVDbGFzczpmdW5jdGlvbihlKXt0aGlzLmNsYXNzTmFtZT10aGlzLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoIihefFxccykiK2UrIig/Olxcc3wkKSIpLCIkMSIpOwpyZXR1cm4gdGhpczt9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKGUsbCl7aWYobD09bnVsbCl7bD0hdGhpcy5oYXNDbGFzcyhlKTt9cmV0dXJuKGwpP3RoaXMuYWRkQ2xhc3MoZSk6dGhpcy5yZW1vdmVDbGFzcyhlKTt9LGFkb3B0OmZ1bmN0aW9uKCl7dmFyIEU9dGhpcyxlLEc9QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpLEY9Ry5sZW5ndGg7CmlmKEY+MSl7RT1lPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTt9Zm9yKHZhciBEPTA7RDxGO0QrKyl7dmFyIGw9ZG9jdW1lbnQuaWQoR1tEXSx0cnVlKTtpZihsKXtFLmFwcGVuZENoaWxkKGwpO319aWYoZSl7dGhpcy5hcHBlbmRDaGlsZChlKTt9cmV0dXJuIHRoaXM7Cn0sYXBwZW5kVGV4dDpmdW5jdGlvbihsLGUpe3JldHVybiB0aGlzLmdyYWIodGhpcy5nZXREb2N1bWVudCgpLm5ld1RleHROb2RlKGwpLGUpO30sZ3JhYjpmdW5jdGlvbihsLGUpe3dbZXx8ImJvdHRvbSJdKGRvY3VtZW50LmlkKGwsdHJ1ZSksdGhpcyk7cmV0dXJuIHRoaXM7Cn0saW5qZWN0OmZ1bmN0aW9uKGwsZSl7d1tlfHwiYm90dG9tIl0odGhpcyxkb2N1bWVudC5pZChsLHRydWUpKTtyZXR1cm4gdGhpczt9LHJlcGxhY2VzOmZ1bmN0aW9uKGUpe2U9ZG9jdW1lbnQuaWQoZSx0cnVlKTtlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHRoaXMsZSk7CnJldHVybiB0aGlzO30sd3JhcHM6ZnVuY3Rpb24obCxlKXtsPWRvY3VtZW50LmlkKGwsdHJ1ZSk7cmV0dXJuIHRoaXMucmVwbGFjZXMobCkuZ3JhYihsLGUpO30sZ2V0U2VsZWN0ZWQ6ZnVuY3Rpb24oKXt0aGlzLnNlbGVjdGVkSW5kZXg7cmV0dXJuIG5ldyBFbGVtZW50cyhBcnJheS5mcm9tKHRoaXMub3B0aW9ucykuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiBlLnNlbGVjdGVkOwp9KSk7fSx0b1F1ZXJ5U3RyaW5nOmZ1bmN0aW9uKCl7dmFyIGU9W107dGhpcy5nZXRFbGVtZW50cygiaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEiKS5lYWNoKGZ1bmN0aW9uKEQpe3ZhciBsPUQudHlwZTtpZighRC5uYW1lfHxELmRpc2FibGVkfHxsPT0ic3VibWl0Inx8bD09InJlc2V0Inx8bD09ImZpbGUifHxsPT0iaW1hZ2UiKXtyZXR1cm47Cn12YXIgRT0oRC5nZXQoInRhZyIpPT0ic2VsZWN0Iik/RC5nZXRTZWxlY3RlZCgpLm1hcChmdW5jdGlvbihGKXtyZXR1cm4gZG9jdW1lbnQuaWQoRikuZ2V0KCJ2YWx1ZSIpO30pOigobD09InJhZGlvInx8bD09ImNoZWNrYm94IikmJiFELmNoZWNrZWQpP251bGw6RC5nZXQoInZhbHVlIik7CkFycmF5LmZyb20oRSkuZWFjaChmdW5jdGlvbihGKXtpZih0eXBlb2YgRiE9InVuZGVmaW5lZCIpe2UucHVzaChlbmNvZGVVUklDb21wb25lbnQoRC5uYW1lKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KEYpKTt9fSk7fSk7cmV0dXJuIGUuam9pbigiJiIpO319KTt2YXIgaT17fSxBPXt9Owp2YXIgQj1mdW5jdGlvbihlKXtyZXR1cm4oQVtlXXx8KEFbZV09e30pKTt9O3ZhciB2PWZ1bmN0aW9uKGwpe3ZhciBlPWwudW5pcXVlTnVtYmVyO2lmKGwucmVtb3ZlRXZlbnRzKXtsLnJlbW92ZUV2ZW50cygpO31pZihsLmNsZWFyQXR0cmlidXRlcyl7bC5jbGVhckF0dHJpYnV0ZXMoKTsKfWlmKGUhPW51bGwpe2RlbGV0ZSBpW2VdO2RlbGV0ZSBBW2VdO31yZXR1cm4gbDt9O3ZhciBDPXtpbnB1dDoiY2hlY2tlZCIsb3B0aW9uOiJzZWxlY3RlZCIsdGV4dGFyZWE6InZhbHVlIn07RWxlbWVudC5pbXBsZW1lbnQoe2Rlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgZT12KHRoaXMpLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIik7CkFycmF5LmVhY2goZSx2KTtFbGVtZW50LmRpc3Bvc2UodGhpcyk7cmV0dXJuIG51bGw7fSxlbXB0eTpmdW5jdGlvbigpe0FycmF5LmZyb20odGhpcy5jaGlsZE5vZGVzKS5lYWNoKEVsZW1lbnQuZGlzcG9zZSk7cmV0dXJuIHRoaXM7fSxkaXNwb3NlOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMucGFyZW50Tm9kZSk/dGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpOnRoaXM7Cn0sY2xvbmU6ZnVuY3Rpb24oRyxFKXtHPUchPT1mYWxzZTt2YXIgTD10aGlzLmNsb25lTm9kZShHKSxEPVtMXSxGPVt0aGlzXSxKO2lmKEcpe0QuYXBwZW5kKEFycmF5LmZyb20oTC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpKSk7Ri5hcHBlbmQoQXJyYXkuZnJvbSh0aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpKTsKfWZvcihKPUQubGVuZ3RoO0otLTspe3ZhciBIPURbSl0sSz1GW0pdO2lmKCFFKXtILnJlbW92ZUF0dHJpYnV0ZSgiaWQiKTt9aWYoSC5jbGVhckF0dHJpYnV0ZXMpe0guY2xlYXJBdHRyaWJ1dGVzKCk7SC5tZXJnZUF0dHJpYnV0ZXMoSyk7SC5yZW1vdmVBdHRyaWJ1dGUoInVuaXF1ZU51bWJlciIpOwppZihILm9wdGlvbnMpe3ZhciBPPUgub3B0aW9ucyxlPUsub3B0aW9ucztmb3IodmFyIEk9Ty5sZW5ndGg7SS0tOyl7T1tJXS5zZWxlY3RlZD1lW0ldLnNlbGVjdGVkO319fXZhciBsPUNbSy50YWdOYW1lLnRvTG93ZXJDYXNlKCldO2lmKGwmJktbbF0pe0hbbF09S1tsXTsKfX1pZihCcm93c2VyLmllKXt2YXIgTT1MLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJvYmplY3QiKSxOPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm9iamVjdCIpO2ZvcihKPU0ubGVuZ3RoO0otLTspe01bSl0ub3V0ZXJIVE1MPU5bSl0ub3V0ZXJIVE1MO319cmV0dXJuIGRvY3VtZW50LmlkKEwpOwp9fSk7W0VsZW1lbnQsV2luZG93LERvY3VtZW50XS5pbnZva2UoImltcGxlbWVudCIse2FkZExpc3RlbmVyOmZ1bmN0aW9uKEUsRCl7aWYoRT09InVubG9hZCIpe3ZhciBlPUQsbD10aGlzO0Q9ZnVuY3Rpb24oKXtsLnJlbW92ZUxpc3RlbmVyKCJ1bmxvYWQiLEQpO2UoKTsKfTt9ZWxzZXtpW1NsaWNrLnVpZE9mKHRoaXMpXT10aGlzO31pZih0aGlzLmFkZEV2ZW50TGlzdGVuZXIpe3RoaXMuYWRkRXZlbnRMaXN0ZW5lcihFLEQsISFhcmd1bWVudHNbMl0pO31lbHNle3RoaXMuYXR0YWNoRXZlbnQoIm9uIitFLEQpO31yZXR1cm4gdGhpczt9LHJlbW92ZUxpc3RlbmVyOmZ1bmN0aW9uKGwsZSl7aWYodGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKXt0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIobCxlLCEhYXJndW1lbnRzWzJdKTsKfWVsc2V7dGhpcy5kZXRhY2hFdmVudCgib24iK2wsZSk7fXJldHVybiB0aGlzO30scmV0cmlldmU6ZnVuY3Rpb24obCxlKXt2YXIgRT1CKFNsaWNrLnVpZE9mKHRoaXMpKSxEPUVbbF07aWYoZSE9bnVsbCYmRD09bnVsbCl7RD1FW2xdPWU7fXJldHVybiBEIT1udWxsP0Q6bnVsbDsKfSxzdG9yZTpmdW5jdGlvbihsLGUpe3ZhciBEPUIoU2xpY2sudWlkT2YodGhpcykpO0RbbF09ZTtyZXR1cm4gdGhpczt9LGVsaW1pbmF0ZTpmdW5jdGlvbihlKXt2YXIgbD1CKFNsaWNrLnVpZE9mKHRoaXMpKTtkZWxldGUgbFtlXTtyZXR1cm4gdGhpczt9fSk7aWYod2luZG93LmF0dGFjaEV2ZW50JiYhd2luZG93LmFkZEV2ZW50TGlzdGVuZXIpe3dpbmRvdy5hZGRMaXN0ZW5lcigidW5sb2FkIixmdW5jdGlvbigpe09iamVjdC5lYWNoKGksdik7CmlmKHdpbmRvdy5Db2xsZWN0R2FyYmFnZSl7Q29sbGVjdEdhcmJhZ2UoKTt9fSk7fUVsZW1lbnQuUHJvcGVydGllcz17fTtFbGVtZW50LlByb3BlcnRpZXMuc3R5bGU9e3NldDpmdW5jdGlvbihlKXt0aGlzLnN0eWxlLmNzc1RleHQ9ZTt9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0eWxlLmNzc1RleHQ7Cn0sZXJhc2U6ZnVuY3Rpb24oKXt0aGlzLnN0eWxlLmNzc1RleHQ9IiI7fX07RWxlbWVudC5Qcm9wZXJ0aWVzLnRhZz17Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGFnTmFtZS50b0xvd2VyQ2FzZSgpO319O0VsZW1lbnQuUHJvcGVydGllcy5odG1sPXtzZXQ6ZnVuY3Rpb24oZSl7aWYoZT09bnVsbCl7ZT0iIjsKfWVsc2V7aWYodHlwZU9mKGUpPT0iYXJyYXkiKXtlPWUuam9pbigiIik7fX10aGlzLmlubmVySFRNTD1lO30sZXJhc2U6ZnVuY3Rpb24oKXt0aGlzLmlubmVySFRNTD0iIjt9fTt2YXIgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTt0LmlubmVySFRNTD0iPG5hdj48L25hdj4iOwp2YXIgYT0odC5jaGlsZE5vZGVzLmxlbmd0aD09MSk7aWYoIWEpe3ZhciBzPSJhYmJyIGFydGljbGUgYXNpZGUgYXVkaW8gY2FudmFzIGRhdGFsaXN0IGRldGFpbHMgZmlnY2FwdGlvbiBmaWd1cmUgZm9vdGVyIGhlYWRlciBoZ3JvdXAgbWFyayBtZXRlciBuYXYgb3V0cHV0IHByb2dyZXNzIHNlY3Rpb24gc3VtbWFyeSB0aW1lIHZpZGVvIi5zcGxpdCgiICIpLGI9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLHU9cy5sZW5ndGg7CndoaWxlKHUtLSl7Yi5jcmVhdGVFbGVtZW50KHNbdV0pO319dD1udWxsO3ZhciBnPUZ1bmN0aW9uLmF0dGVtcHQoZnVuY3Rpb24oKXt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0YWJsZSIpO2UuaW5uZXJIVE1MPSI8dHI+PHRkPjwvdGQ+PC90cj4iO3JldHVybiB0cnVlOwp9KTt2YXIgYz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ciIpLG89Ijx0ZD48L3RkPiI7Yy5pbm5lckhUTUw9bzt2YXIgeT0oYy5pbm5lckhUTUw9PW8pO2M9bnVsbDtpZighZ3x8IXl8fCFhKXtFbGVtZW50LlByb3BlcnRpZXMuaHRtbC5zZXQ9KGZ1bmN0aW9uKGwpe3ZhciBlPXt0YWJsZTpbMSwiPHRhYmxlPiIsIjwvdGFibGU+Il0sc2VsZWN0OlsxLCI8c2VsZWN0PiIsIjwvc2VsZWN0PiJdLHRib2R5OlsyLCI8dGFibGU+PHRib2R5PiIsIjwvdGJvZHk+PC90YWJsZT4iXSx0cjpbMywiPHRhYmxlPjx0Ym9keT48dHI+IiwiPC90cj48L3Rib2R5PjwvdGFibGU+Il19OwplLnRoZWFkPWUudGZvb3Q9ZS50Ym9keTtyZXR1cm4gZnVuY3Rpb24oRCl7dmFyIEU9ZVt0aGlzLmdldCgidGFnIildO2lmKCFFJiYhYSl7RT1bMCwiIiwiIl07fWlmKCFFKXtyZXR1cm4gbC5jYWxsKHRoaXMsRCk7fXZhciBIPUVbMF0sRz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxGPUc7CmlmKCFhKXtiLmFwcGVuZENoaWxkKEcpO31HLmlubmVySFRNTD1bRVsxXSxELEVbMl1dLmZsYXR0ZW4oKS5qb2luKCIiKTt3aGlsZShILS0pe0Y9Ri5maXJzdENoaWxkO310aGlzLmVtcHR5KCkuYWRvcHQoRi5jaGlsZE5vZGVzKTtpZighYSl7Yi5yZW1vdmVDaGlsZChHKTsKfUc9bnVsbDt9O30pKEVsZW1lbnQuUHJvcGVydGllcy5odG1sLnNldCk7fXZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImZvcm0iKTtuLmlubmVySFRNTD0iPHNlbGVjdD48b3B0aW9uPnM8L29wdGlvbj48L3NlbGVjdD4iO2lmKG4uZmlyc3RDaGlsZC52YWx1ZSE9InMiKXtFbGVtZW50LlByb3BlcnRpZXMudmFsdWU9e3NldDpmdW5jdGlvbihHKXt2YXIgbD10aGlzLmdldCgidGFnIik7CmlmKGwhPSJzZWxlY3QiKXtyZXR1cm4gdGhpcy5zZXRQcm9wZXJ0eSgidmFsdWUiLEcpO312YXIgRD10aGlzLmdldEVsZW1lbnRzKCJvcHRpb24iKTtmb3IodmFyIEU9MDtFPEQubGVuZ3RoO0UrKyl7dmFyIEY9RFtFXSxlPUYuZ2V0QXR0cmlidXRlTm9kZSgidmFsdWUiKSxIPShlJiZlLnNwZWNpZmllZCk/Ri52YWx1ZTpGLmdldCgidGV4dCIpOwppZihIPT1HKXtyZXR1cm4gRi5zZWxlY3RlZD10cnVlO319fSxnZXQ6ZnVuY3Rpb24oKXt2YXIgRD10aGlzLGw9RC5nZXQoInRhZyIpO2lmKGwhPSJzZWxlY3QiJiZsIT0ib3B0aW9uIil7cmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoInZhbHVlIik7fWlmKGw9PSJzZWxlY3QiJiYhKEQ9RC5nZXRTZWxlY3RlZCgpWzBdKSl7cmV0dXJuIiI7Cn12YXIgZT1ELmdldEF0dHJpYnV0ZU5vZGUoInZhbHVlIik7cmV0dXJuKGUmJmUuc3BlY2lmaWVkKT9ELnZhbHVlOkQuZ2V0KCJ0ZXh0Iik7fX07fW49bnVsbDtpZihkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpKXtFbGVtZW50LlByb3BlcnRpZXMuaWQ9e3NldDpmdW5jdGlvbihlKXt0aGlzLmlkPXRoaXMuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS52YWx1ZT1lOwp9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlkfHxudWxsO30sZXJhc2U6ZnVuY3Rpb24oKXt0aGlzLmlkPXRoaXMuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS52YWx1ZT0iIjt9fTt9fSkoKTsoZnVuY3Rpb24oKXt2YXIgaT1kb2N1bWVudC5odG1sO3ZhciBkPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwpkLnN0eWxlLmNvbG9yPSJyZWQiO2Quc3R5bGUuY29sb3I9bnVsbDt2YXIgYz1kLnN0eWxlLmNvbG9yPT0icmVkIjtkPW51bGw7RWxlbWVudC5Qcm9wZXJ0aWVzLnN0eWxlcz17c2V0OmZ1bmN0aW9uKGspe3RoaXMuc2V0U3R5bGVzKGspO319O3ZhciBoPShpLnN0eWxlLm9wYWNpdHkhPW51bGwpLGU9KGkuc3R5bGUuZmlsdGVyIT1udWxsKSxqPS9hbHBoYVwob3BhY2l0eT0oW1xkLl0rKVwpL2k7CnZhciBhPWZ1bmN0aW9uKGwsayl7bC5zdG9yZSgiJG9wYWNpdHkiLGspO2wuc3R5bGUudmlzaWJpbGl0eT1rPjB8fGs9PW51bGw/InZpc2libGUiOiJoaWRkZW4iO307dmFyIGY9KGg/ZnVuY3Rpb24obCxrKXtsLnN0eWxlLm9wYWNpdHk9azt9OihlP2Z1bmN0aW9uKGwsayl7dmFyIG49bC5zdHlsZTsKaWYoIWwuY3VycmVudFN0eWxlfHwhbC5jdXJyZW50U3R5bGUuaGFzTGF5b3V0KXtuLnpvb209MTt9aWYoaz09bnVsbHx8az09MSl7az0iIjt9ZWxzZXtrPSJhbHBoYShvcGFjaXR5PSIrKGsqMTAwKS5saW1pdCgwLDEwMCkucm91bmQoKSsiKSI7fXZhciBtPW4uZmlsdGVyfHxsLmdldENvbXB1dGVkU3R5bGUoImZpbHRlciIpfHwiIjsKbi5maWx0ZXI9ai50ZXN0KG0pP20ucmVwbGFjZShqLGspOm0raztpZighbi5maWx0ZXIpe24ucmVtb3ZlQXR0cmlidXRlKCJmaWx0ZXIiKTt9fTphKSk7dmFyIGc9KGg/ZnVuY3Rpb24obCl7dmFyIGs9bC5zdHlsZS5vcGFjaXR5fHxsLmdldENvbXB1dGVkU3R5bGUoIm9wYWNpdHkiKTsKcmV0dXJuKGs9PSIiKT8xOmsudG9GbG9hdCgpO306KGU/ZnVuY3Rpb24obCl7dmFyIG09KGwuc3R5bGUuZmlsdGVyfHxsLmdldENvbXB1dGVkU3R5bGUoImZpbHRlciIpKSxrO2lmKG0pe2s9bS5tYXRjaChqKTt9cmV0dXJuKGs9PW51bGx8fG09PW51bGwpPzE6KGtbMV0vMTAwKTsKfTpmdW5jdGlvbihsKXt2YXIgaz1sLnJldHJpZXZlKCIkb3BhY2l0eSIpO2lmKGs9PW51bGwpe2s9KGwuc3R5bGUudmlzaWJpbGl0eT09ImhpZGRlbiI/MDoxKTt9cmV0dXJuIGs7fSkpO3ZhciBiPShpLnN0eWxlLmNzc0Zsb2F0PT1udWxsKT8ic3R5bGVGbG9hdCI6ImNzc0Zsb2F0IjsKRWxlbWVudC5pbXBsZW1lbnQoe2dldENvbXB1dGVkU3R5bGU6ZnVuY3Rpb24obSl7aWYodGhpcy5jdXJyZW50U3R5bGUpe3JldHVybiB0aGlzLmN1cnJlbnRTdHlsZVttLmNhbWVsQ2FzZSgpXTt9dmFyIGw9RWxlbWVudC5nZXREb2N1bWVudCh0aGlzKS5kZWZhdWx0VmlldyxrPWw/bC5nZXRDb21wdXRlZFN0eWxlKHRoaXMsbnVsbCk6bnVsbDsKcmV0dXJuKGspP2suZ2V0UHJvcGVydHlWYWx1ZSgobT09Yik/ImZsb2F0IjptLmh5cGhlbmF0ZSgpKTpudWxsO30sc2V0U3R5bGU6ZnVuY3Rpb24obCxrKXtpZihsPT0ib3BhY2l0eSIpe2lmKGshPW51bGwpe2s9cGFyc2VGbG9hdChrKTt9Zih0aGlzLGspO3JldHVybiB0aGlzOwp9bD0obD09ImZsb2F0Ij9iOmwpLmNhbWVsQ2FzZSgpO2lmKHR5cGVPZihrKSE9InN0cmluZyIpe3ZhciBtPShFbGVtZW50LlN0eWxlc1tsXXx8IkAiKS5zcGxpdCgiICIpO2s9QXJyYXkuZnJvbShrKS5tYXAoZnVuY3Rpb24obyxuKXtpZighbVtuXSl7cmV0dXJuIiI7Cn1yZXR1cm4odHlwZU9mKG8pPT0ibnVtYmVyIik/bVtuXS5yZXBsYWNlKCJAIixNYXRoLnJvdW5kKG8pKTpvO30pLmpvaW4oIiAiKTt9ZWxzZXtpZihrPT1TdHJpbmcoTnVtYmVyKGspKSl7az1NYXRoLnJvdW5kKGspO319dGhpcy5zdHlsZVtsXT1rO2lmKChrPT0iInx8az09bnVsbCkmJmMmJnRoaXMuc3R5bGUucmVtb3ZlQXR0cmlidXRlKXt0aGlzLnN0eWxlLnJlbW92ZUF0dHJpYnV0ZShsKTsKfXJldHVybiB0aGlzO30sZ2V0U3R5bGU6ZnVuY3Rpb24ocSl7aWYocT09Im9wYWNpdHkiKXtyZXR1cm4gZyh0aGlzKTt9cT0ocT09ImZsb2F0Ij9iOnEpLmNhbWVsQ2FzZSgpO3ZhciBrPXRoaXMuc3R5bGVbcV07aWYoIWt8fHE9PSJ6SW5kZXgiKXtrPVtdO2Zvcih2YXIgcCBpbiBFbGVtZW50LlNob3J0U3R5bGVzKXtpZihxIT1wKXtjb250aW51ZTsKfWZvcih2YXIgbyBpbiBFbGVtZW50LlNob3J0U3R5bGVzW3BdKXtrLnB1c2godGhpcy5nZXRTdHlsZShvKSk7fXJldHVybiBrLmpvaW4oIiAiKTt9az10aGlzLmdldENvbXB1dGVkU3R5bGUocSk7fWlmKGspe2s9U3RyaW5nKGspO3ZhciBtPWsubWF0Y2goL3JnYmE/XChbXGRccyxdK1wpLyk7CmlmKG0pe2s9ay5yZXBsYWNlKG1bMF0sbVswXS5yZ2JUb0hleCgpKTt9fWlmKEJyb3dzZXIub3BlcmF8fEJyb3dzZXIuaWUpe2lmKCgvXihoZWlnaHR8d2lkdGgpJC8pLnRlc3QocSkmJiEoL3B4JC8udGVzdChrKSkpe3ZhciBsPShxPT0id2lkdGgiKT9bImxlZnQiLCJyaWdodCJdOlsidG9wIiwiYm90dG9tIl0sbj0wOwpsLmVhY2goZnVuY3Rpb24ocil7bis9dGhpcy5nZXRTdHlsZSgiYm9yZGVyLSIrcisiLXdpZHRoIikudG9JbnQoKSt0aGlzLmdldFN0eWxlKCJwYWRkaW5nLSIrcikudG9JbnQoKTt9LHRoaXMpO3JldHVybiB0aGlzWyJvZmZzZXQiK3EuY2FwaXRhbGl6ZSgpXS1uKyJweCI7Cn1pZihCcm93c2VyLmllJiYoL15ib3JkZXIoLispV2lkdGh8bWFyZ2lufHBhZGRpbmcvKS50ZXN0KHEpJiZpc05hTihwYXJzZUZsb2F0KGspKSl7cmV0dXJuIjBweCI7fX1yZXR1cm4gazt9LHNldFN0eWxlczpmdW5jdGlvbihsKXtmb3IodmFyIGsgaW4gbCl7dGhpcy5zZXRTdHlsZShrLGxba10pOwp9cmV0dXJuIHRoaXM7fSxnZXRTdHlsZXM6ZnVuY3Rpb24oKXt2YXIgaz17fTtBcnJheS5mbGF0dGVuKGFyZ3VtZW50cykuZWFjaChmdW5jdGlvbihsKXtrW2xdPXRoaXMuZ2V0U3R5bGUobCk7fSx0aGlzKTtyZXR1cm4gazt9fSk7RWxlbWVudC5TdHlsZXM9e2xlZnQ6IkBweCIsdG9wOiJAcHgiLGJvdHRvbToiQHB4IixyaWdodDoiQHB4Iix3aWR0aDoiQHB4IixoZWlnaHQ6IkBweCIsbWF4V2lkdGg6IkBweCIsbWF4SGVpZ2h0OiJAcHgiLG1pbldpZHRoOiJAcHgiLG1pbkhlaWdodDoiQHB4IixiYWNrZ3JvdW5kQ29sb3I6InJnYihALCBALCBAKSIsYmFja2dyb3VuZFBvc2l0aW9uOiJAcHggQHB4Iixjb2xvcjoicmdiKEAsIEAsIEApIixmb250U2l6ZToiQHB4IixsZXR0ZXJTcGFjaW5nOiJAcHgiLGxpbmVIZWlnaHQ6IkBweCIsY2xpcDoicmVjdChAcHggQHB4IEBweCBAcHgpIixtYXJnaW46IkBweCBAcHggQHB4IEBweCIscGFkZGluZzoiQHB4IEBweCBAcHggQHB4Iixib3JkZXI6IkBweCBAIHJnYihALCBALCBAKSBAcHggQCByZ2IoQCwgQCwgQCkgQHB4IEAgcmdiKEAsIEAsIEApIixib3JkZXJXaWR0aDoiQHB4IEBweCBAcHggQHB4Iixib3JkZXJTdHlsZToiQCBAIEAgQCIsYm9yZGVyQ29sb3I6InJnYihALCBALCBAKSByZ2IoQCwgQCwgQCkgcmdiKEAsIEAsIEApIHJnYihALCBALCBAKSIsekluZGV4OiJAIix6b29tOiJAIixmb250V2VpZ2h0OiJAIix0ZXh0SW5kZW50OiJAcHgiLG9wYWNpdHk6IkAifTsKRWxlbWVudC5TaG9ydFN0eWxlcz17bWFyZ2luOnt9LHBhZGRpbmc6e30sYm9yZGVyOnt9LGJvcmRlcldpZHRoOnt9LGJvcmRlclN0eWxlOnt9LGJvcmRlckNvbG9yOnt9fTtbIlRvcCIsIlJpZ2h0IiwiQm90dG9tIiwiTGVmdCJdLmVhY2goZnVuY3Rpb24ocSl7dmFyIHA9RWxlbWVudC5TaG9ydFN0eWxlczsKdmFyIGw9RWxlbWVudC5TdHlsZXM7WyJtYXJnaW4iLCJwYWRkaW5nIl0uZWFjaChmdW5jdGlvbihyKXt2YXIgcz1yK3E7cFtyXVtzXT1sW3NdPSJAcHgiO30pO3ZhciBvPSJib3JkZXIiK3E7cC5ib3JkZXJbb109bFtvXT0iQHB4IEAgcmdiKEAsIEAsIEApIjt2YXIgbj1vKyJXaWR0aCIsaz1vKyJTdHlsZSIsbT1vKyJDb2xvciI7CnBbb109e307cC5ib3JkZXJXaWR0aFtuXT1wW29dW25dPWxbbl09IkBweCI7cC5ib3JkZXJTdHlsZVtrXT1wW29dW2tdPWxba109IkAiO3AuYm9yZGVyQ29sb3JbbV09cFtvXVttXT1sW21dPSJyZ2IoQCwgQCwgQCkiO30pO30pKCk7KGZ1bmN0aW9uKCl7RWxlbWVudC5Qcm9wZXJ0aWVzLmV2ZW50cz17c2V0OmZ1bmN0aW9uKGIpe3RoaXMuYWRkRXZlbnRzKGIpOwp9fTtbRWxlbWVudCxXaW5kb3csRG9jdW1lbnRdLmludm9rZSgiaW1wbGVtZW50Iix7YWRkRXZlbnQ6ZnVuY3Rpb24oZixoKXt2YXIgaT10aGlzLnJldHJpZXZlKCJldmVudHMiLHt9KTtpZighaVtmXSl7aVtmXT17a2V5czpbXSx2YWx1ZXM6W119O31pZihpW2ZdLmtleXMuY29udGFpbnMoaCkpe3JldHVybiB0aGlzOwp9aVtmXS5rZXlzLnB1c2goaCk7dmFyIGc9ZixiPUVsZW1lbnQuRXZlbnRzW2ZdLGQ9aCxqPXRoaXM7aWYoYil7aWYoYi5vbkFkZCl7Yi5vbkFkZC5jYWxsKHRoaXMsaCxmKTt9aWYoYi5jb25kaXRpb24pe2Q9ZnVuY3Rpb24oayl7aWYoYi5jb25kaXRpb24uY2FsbCh0aGlzLGssZikpe3JldHVybiBoLmNhbGwodGhpcyxrKTsKfXJldHVybiB0cnVlO307fWlmKGIuYmFzZSl7Zz1GdW5jdGlvbi5mcm9tKGIuYmFzZSkuY2FsbCh0aGlzLGYpO319dmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gaC5jYWxsKGopO307dmFyIGM9RWxlbWVudC5OYXRpdmVFdmVudHNbZ107aWYoYyl7aWYoYz09Mil7ZT1mdW5jdGlvbihrKXtrPW5ldyBET01FdmVudChrLGouZ2V0V2luZG93KCkpOwppZihkLmNhbGwoaixrKT09PWZhbHNlKXtrLnN0b3AoKTt9fTt9dGhpcy5hZGRMaXN0ZW5lcihnLGUsYXJndW1lbnRzWzJdKTt9aVtmXS52YWx1ZXMucHVzaChlKTtyZXR1cm4gdGhpczt9LHJlbW92ZUV2ZW50OmZ1bmN0aW9uKGUsZCl7dmFyIGM9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIik7CmlmKCFjfHwhY1tlXSl7cmV0dXJuIHRoaXM7fXZhciBoPWNbZV07dmFyIGI9aC5rZXlzLmluZGV4T2YoZCk7aWYoYj09LTEpe3JldHVybiB0aGlzO312YXIgZz1oLnZhbHVlc1tiXTtkZWxldGUgaC5rZXlzW2JdO2RlbGV0ZSBoLnZhbHVlc1tiXTt2YXIgZj1FbGVtZW50LkV2ZW50c1tlXTsKaWYoZil7aWYoZi5vblJlbW92ZSl7Zi5vblJlbW92ZS5jYWxsKHRoaXMsZCxlKTt9aWYoZi5iYXNlKXtlPUZ1bmN0aW9uLmZyb20oZi5iYXNlKS5jYWxsKHRoaXMsZSk7fX1yZXR1cm4oRWxlbWVudC5OYXRpdmVFdmVudHNbZV0pP3RoaXMucmVtb3ZlTGlzdGVuZXIoZSxnLGFyZ3VtZW50c1syXSk6dGhpczsKfSxhZGRFdmVudHM6ZnVuY3Rpb24oYil7Zm9yKHZhciBjIGluIGIpe3RoaXMuYWRkRXZlbnQoYyxiW2NdKTt9cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oYil7dmFyIGQ7aWYodHlwZU9mKGIpPT0ib2JqZWN0Iil7Zm9yKGQgaW4gYil7dGhpcy5yZW1vdmVFdmVudChkLGJbZF0pOwp9cmV0dXJuIHRoaXM7fXZhciBjPXRoaXMucmV0cmlldmUoImV2ZW50cyIpO2lmKCFjKXtyZXR1cm4gdGhpczt9aWYoIWIpe2ZvcihkIGluIGMpe3RoaXMucmVtb3ZlRXZlbnRzKGQpO310aGlzLmVsaW1pbmF0ZSgiZXZlbnRzIik7fWVsc2V7aWYoY1tiXSl7Y1tiXS5rZXlzLmVhY2goZnVuY3Rpb24oZSl7dGhpcy5yZW1vdmVFdmVudChiLGUpOwp9LHRoaXMpO2RlbGV0ZSBjW2JdO319cmV0dXJuIHRoaXM7fSxmaXJlRXZlbnQ6ZnVuY3Rpb24oZSxjLGIpe3ZhciBkPXRoaXMucmV0cmlldmUoImV2ZW50cyIpO2lmKCFkfHwhZFtlXSl7cmV0dXJuIHRoaXM7fWM9QXJyYXkuZnJvbShjKTtkW2VdLmtleXMuZWFjaChmdW5jdGlvbihmKXtpZihiKXtmLmRlbGF5KGIsdGhpcyxjKTsKfWVsc2V7Zi5hcHBseSh0aGlzLGMpO319LHRoaXMpO3JldHVybiB0aGlzO30sY2xvbmVFdmVudHM6ZnVuY3Rpb24oZSxkKXtlPWRvY3VtZW50LmlkKGUpO3ZhciBjPWUucmV0cmlldmUoImV2ZW50cyIpO2lmKCFjKXtyZXR1cm4gdGhpczt9aWYoIWQpe2Zvcih2YXIgYiBpbiBjKXt0aGlzLmNsb25lRXZlbnRzKGUsYik7Cn19ZWxzZXtpZihjW2RdKXtjW2RdLmtleXMuZWFjaChmdW5jdGlvbihmKXt0aGlzLmFkZEV2ZW50KGQsZik7fSx0aGlzKTt9fXJldHVybiB0aGlzO319KTtFbGVtZW50Lk5hdGl2ZUV2ZW50cz17Y2xpY2s6MixkYmxjbGljazoyLG1vdXNldXA6Mixtb3VzZWRvd246Mixjb250ZXh0bWVudToyLG1vdXNld2hlZWw6MixET01Nb3VzZVNjcm9sbDoyLG1vdXNlb3ZlcjoyLG1vdXNlb3V0OjIsbW91c2Vtb3ZlOjIsc2VsZWN0c3RhcnQ6MixzZWxlY3RlbmQ6MixrZXlkb3duOjIsa2V5cHJlc3M6MixrZXl1cDoyLG9yaWVudGF0aW9uY2hhbmdlOjIsdG91Y2hzdGFydDoyLHRvdWNobW92ZToyLHRvdWNoZW5kOjIsdG91Y2hjYW5jZWw6MixnZXN0dXJlc3RhcnQ6MixnZXN0dXJlY2hhbmdlOjIsZ2VzdHVyZWVuZDoyLGZvY3VzOjIsYmx1cjoyLGNoYW5nZToyLHJlc2V0OjIsc2VsZWN0OjIsc3VibWl0OjIscGFzdGU6MixpbnB1dDoyLGxvYWQ6Mix1bmxvYWQ6MSxiZWZvcmV1bmxvYWQ6MixyZXNpemU6MSxtb3ZlOjEsRE9NQ29udGVudExvYWRlZDoxLHJlYWR5c3RhdGVjaGFuZ2U6MSxlcnJvcjoxLGFib3J0OjEsc2Nyb2xsOjF9OwpFbGVtZW50LkV2ZW50cz17bW91c2V3aGVlbDp7YmFzZTooQnJvd3Nlci5maXJlZm94KT8iRE9NTW91c2VTY3JvbGwiOiJtb3VzZXdoZWVsIn19O2lmKCJvbm1vdXNlZW50ZXIiIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCl7RWxlbWVudC5OYXRpdmVFdmVudHMubW91c2VlbnRlcj1FbGVtZW50Lk5hdGl2ZUV2ZW50cy5tb3VzZWxlYXZlPTI7Cn1lbHNle3ZhciBhPWZ1bmN0aW9uKGIpe3ZhciBjPWIucmVsYXRlZFRhcmdldDtpZihjPT1udWxsKXtyZXR1cm4gdHJ1ZTt9aWYoIWMpe3JldHVybiBmYWxzZTt9cmV0dXJuKGMhPXRoaXMmJmMucHJlZml4IT0ieHVsIiYmdHlwZU9mKHRoaXMpIT0iZG9jdW1lbnQiJiYhdGhpcy5jb250YWlucyhjKSk7Cn07RWxlbWVudC5FdmVudHMubW91c2VlbnRlcj17YmFzZToibW91c2VvdmVyIixjb25kaXRpb246YX07RWxlbWVudC5FdmVudHMubW91c2VsZWF2ZT17YmFzZToibW91c2VvdXQiLGNvbmRpdGlvbjphfTt9aWYoIXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKXtFbGVtZW50Lk5hdGl2ZUV2ZW50cy5wcm9wZXJ0eWNoYW5nZT0yOwpFbGVtZW50LkV2ZW50cy5jaGFuZ2U9e2Jhc2U6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLnR5cGU7cmV0dXJuKHRoaXMuZ2V0KCJ0YWciKT09ImlucHV0IiYmKGI9PSJyYWRpbyJ8fGI9PSJjaGVja2JveCIpKT8icHJvcGVydHljaGFuZ2UiOiJjaGFuZ2UiO30sY29uZGl0aW9uOmZ1bmN0aW9uKGIpe3JldHVybiB0aGlzLnR5cGUhPSJyYWRpbyJ8fChiLmV2ZW50LnByb3BlcnR5TmFtZT09ImNoZWNrZWQiJiZ0aGlzLmNoZWNrZWQpOwp9fTt9fSkoKTsoZnVuY3Rpb24oKXt2YXIgYz0hIXdpbmRvdy5hZGRFdmVudExpc3RlbmVyO0VsZW1lbnQuTmF0aXZlRXZlbnRzLmZvY3VzaW49RWxlbWVudC5OYXRpdmVFdmVudHMuZm9jdXNvdXQ9Mjt2YXIgaz1mdW5jdGlvbihsLG0sbixvLHApe3doaWxlKHAmJnAhPWwpe2lmKG0ocCxvKSl7cmV0dXJuIG4uY2FsbChwLG8scCk7Cn1wPWRvY3VtZW50LmlkKHAucGFyZW50Tm9kZSk7fX07dmFyIGE9e21vdXNlZW50ZXI6e2Jhc2U6Im1vdXNlb3ZlciJ9LG1vdXNlbGVhdmU6e2Jhc2U6Im1vdXNlb3V0In0sZm9jdXM6e2Jhc2U6ImZvY3VzIisoYz8iIjoiaW4iKSxjYXB0dXJlOnRydWV9LGJsdXI6e2Jhc2U6Yz8iYmx1ciI6ImZvY3Vzb3V0IixjYXB0dXJlOnRydWV9fTsKdmFyIGI9IiRkZWxlZ2F0aW9uOiI7dmFyIGk9ZnVuY3Rpb24obCl7cmV0dXJue2Jhc2U6ImZvY3VzaW4iLHJlbW92ZTpmdW5jdGlvbihtLG8pe3ZhciBwPW0ucmV0cmlldmUoYitsKyJsaXN0ZW5lcnMiLHt9KVtvXTtpZihwJiZwLmZvcm1zKXtmb3IodmFyIG49cC5mb3Jtcy5sZW5ndGg7Cm4tLTspe3AuZm9ybXNbbl0ucmVtb3ZlRXZlbnQobCxwLmZuc1tuXSk7fX19LGxpc3RlbjpmdW5jdGlvbih4LHIsdixuLHQscyl7dmFyIG89KHQuZ2V0KCJ0YWciKT09ImZvcm0iKT90Om4udGFyZ2V0LmdldFBhcmVudCgiZm9ybSIpO2lmKCFvKXtyZXR1cm47fXZhciB1PXgucmV0cmlldmUoYitsKyJsaXN0ZW5lcnMiLHt9KSxwPXVbc118fHtmb3JtczpbXSxmbnM6W119LG09cC5mb3Jtcyx3PXAuZm5zOwppZihtLmluZGV4T2YobykhPS0xKXtyZXR1cm47fW0ucHVzaChvKTt2YXIgcT1mdW5jdGlvbih5KXtrKHgscix2LHksdCk7fTtvLmFkZEV2ZW50KGwscSk7dy5wdXNoKHEpO3Vbc109cDt4LnN0b3JlKGIrbCsibGlzdGVuZXJzIix1KTt9fTt9O3ZhciBkPWZ1bmN0aW9uKGwpe3JldHVybntiYXNlOiJmb2N1c2luIixsaXN0ZW46ZnVuY3Rpb24obSxuLHAscSxyKXt2YXIgbz17Ymx1cjpmdW5jdGlvbigpe3RoaXMucmVtb3ZlRXZlbnRzKG8pOwp9fTtvW2xdPWZ1bmN0aW9uKHMpe2sobSxuLHAscyxyKTt9O3EudGFyZ2V0LmFkZEV2ZW50cyhvKTt9fTt9O2lmKCFjKXtPYmplY3QuYXBwZW5kKGEse3N1Ym1pdDppKCJzdWJtaXQiKSxyZXNldDppKCJyZXNldCIpLGNoYW5nZTpkKCJjaGFuZ2UiKSxzZWxlY3Q6ZCgic2VsZWN0Iil9KTsKfXZhciBoPUVsZW1lbnQucHJvdG90eXBlLGY9aC5hZGRFdmVudCxqPWgucmVtb3ZlRXZlbnQ7dmFyIGU9ZnVuY3Rpb24obCxtKXtyZXR1cm4gZnVuY3Rpb24ocixxLG4pe2lmKHIuaW5kZXhPZigiOnJlbGF5Iik9PS0xKXtyZXR1cm4gbC5jYWxsKHRoaXMscixxLG4pOwp9dmFyIG89U2xpY2sucGFyc2UocikuZXhwcmVzc2lvbnNbMF1bMF07aWYoby5wc2V1ZG9zWzBdLmtleSE9InJlbGF5Iil7cmV0dXJuIGwuY2FsbCh0aGlzLHIscSxuKTt9dmFyIHA9by50YWc7by5wc2V1ZG9zLnNsaWNlKDEpLmVhY2goZnVuY3Rpb24ocyl7cCs9IjoiK3Mua2V5KyhzLnZhbHVlPyIoIitzLnZhbHVlKyIpIjoiIik7Cn0pO2wuY2FsbCh0aGlzLHIscSk7cmV0dXJuIG0uY2FsbCh0aGlzLHAsby5wc2V1ZG9zWzBdLnZhbHVlLHEpO307fTt2YXIgZz17YWRkRXZlbnQ6ZnVuY3Rpb24odixxLHgpe3ZhciB0PXRoaXMucmV0cmlldmUoIiRkZWxlZ2F0ZXMiLHt9KSxyPXRbdl07aWYocil7Zm9yKHZhciB5IGluIHIpe2lmKHJbeV0uZm49PXgmJnJbeV0ubWF0Y2g9PXEpe3JldHVybiB0aGlzOwp9fX12YXIgcD12LHU9cSxvPXgsbj1hW3ZdfHx7fTt2PW4uYmFzZXx8cDtxPWZ1bmN0aW9uKEIpe3JldHVybiBTbGljay5tYXRjaChCLHUpO307dmFyIHc9RWxlbWVudC5FdmVudHNbcF07aWYodyYmdy5jb25kaXRpb24pe3ZhciBsPXEsbT13LmNvbmRpdGlvbjtxPWZ1bmN0aW9uKEMsQil7cmV0dXJuIGwoQyxCKSYmbS5jYWxsKEMsQix2KTsKfTt9dmFyIHo9dGhpcyxzPVN0cmluZy51bmlxdWVJRCgpO3ZhciBBPW4ubGlzdGVuP2Z1bmN0aW9uKEIsQyl7aWYoIUMmJkImJkIudGFyZ2V0KXtDPUIudGFyZ2V0O31pZihDKXtuLmxpc3Rlbih6LHEseCxCLEMscyk7fX06ZnVuY3Rpb24oQixDKXtpZighQyYmQiYmQi50YXJnZXQpe0M9Qi50YXJnZXQ7Cn1pZihDKXtrKHoscSx4LEIsQyk7fX07aWYoIXIpe3I9e307fXJbc109e21hdGNoOnUsZm46byxkZWxlZ2F0b3I6QX07dFtwXT1yO3JldHVybiBmLmNhbGwodGhpcyx2LEEsbi5jYXB0dXJlKTt9LHJlbW92ZUV2ZW50OmZ1bmN0aW9uKHIsbix0LHUpe3ZhciBxPXRoaXMucmV0cmlldmUoIiRkZWxlZ2F0ZXMiLHt9KSxwPXFbcl07CmlmKCFwKXtyZXR1cm4gdGhpczt9aWYodSl7dmFyIG09cix3PXBbdV0uZGVsZWdhdG9yLGw9YVtyXXx8e307cj1sLmJhc2V8fG07aWYobC5yZW1vdmUpe2wucmVtb3ZlKHRoaXMsdSk7fWRlbGV0ZSBwW3VdO3FbbV09cDtyZXR1cm4gai5jYWxsKHRoaXMscix3KTt9dmFyIG8sdjsKaWYodCl7Zm9yKG8gaW4gcCl7dj1wW29dO2lmKHYubWF0Y2g9PW4mJnYuZm49PXQpe3JldHVybiBnLnJlbW92ZUV2ZW50LmNhbGwodGhpcyxyLG4sdCxvKTt9fX1lbHNle2ZvcihvIGluIHApe3Y9cFtvXTtpZih2Lm1hdGNoPT1uKXtnLnJlbW92ZUV2ZW50LmNhbGwodGhpcyxyLG4sdi5mbixvKTsKfX19cmV0dXJuIHRoaXM7fX07W0VsZW1lbnQsV2luZG93LERvY3VtZW50XS5pbnZva2UoImltcGxlbWVudCIse2FkZEV2ZW50OmUoZixnLmFkZEV2ZW50KSxyZW1vdmVFdmVudDplKGosZy5yZW1vdmVFdmVudCl9KTt9KSgpOyhmdW5jdGlvbigpe3ZhciBoPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Cmguc3R5bGUuaGVpZ2h0PSIwIjtoLmFwcGVuZENoaWxkKGUpO3ZhciBkPShlLm9mZnNldFBhcmVudD09PWgpO2g9ZT1udWxsO3ZhciBsPWZ1bmN0aW9uKG0pe3JldHVybiBrKG0sInBvc2l0aW9uIikhPSJzdGF0aWMifHxhKG0pO307dmFyIGk9ZnVuY3Rpb24obSl7cmV0dXJuIGwobSl8fCgvXig/OnRhYmxlfHRkfHRoKSQvaSkudGVzdChtLnRhZ05hbWUpOwp9O0VsZW1lbnQuaW1wbGVtZW50KHtzY3JvbGxUbzpmdW5jdGlvbihtLG4pe2lmKGEodGhpcykpe3RoaXMuZ2V0V2luZG93KCkuc2Nyb2xsVG8obSxuKTt9ZWxzZXt0aGlzLnNjcm9sbExlZnQ9bTt0aGlzLnNjcm9sbFRvcD1uO31yZXR1cm4gdGhpczt9LGdldFNpemU6ZnVuY3Rpb24oKXtpZihhKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRTaXplKCk7Cn1yZXR1cm57eDp0aGlzLm9mZnNldFdpZHRoLHk6dGhpcy5vZmZzZXRIZWlnaHR9O30sZ2V0U2Nyb2xsU2l6ZTpmdW5jdGlvbigpe2lmKGEodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldFNjcm9sbFNpemUoKTt9cmV0dXJue3g6dGhpcy5zY3JvbGxXaWR0aCx5OnRoaXMuc2Nyb2xsSGVpZ2h0fTsKfSxnZXRTY3JvbGw6ZnVuY3Rpb24oKXtpZihhKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRTY3JvbGwoKTt9cmV0dXJue3g6dGhpcy5zY3JvbGxMZWZ0LHk6dGhpcy5zY3JvbGxUb3B9O30sZ2V0U2Nyb2xsczpmdW5jdGlvbigpe3ZhciBuPXRoaXMucGFyZW50Tm9kZSxtPXt4OjAseTowfTsKd2hpbGUobiYmIWEobikpe20ueCs9bi5zY3JvbGxMZWZ0O20ueSs9bi5zY3JvbGxUb3A7bj1uLnBhcmVudE5vZGU7fXJldHVybiBtO30sZ2V0T2Zmc2V0UGFyZW50OmQ/ZnVuY3Rpb24oKXt2YXIgbT10aGlzO2lmKGEobSl8fGsobSwicG9zaXRpb24iKT09ImZpeGVkIil7cmV0dXJuIG51bGw7Cn12YXIgbj0oayhtLCJwb3NpdGlvbiIpPT0ic3RhdGljIik/aTpsO3doaWxlKChtPW0ucGFyZW50Tm9kZSkpe2lmKG4obSkpe3JldHVybiBtO319cmV0dXJuIG51bGw7fTpmdW5jdGlvbigpe3ZhciBtPXRoaXM7aWYoYShtKXx8ayhtLCJwb3NpdGlvbiIpPT0iZml4ZWQiKXtyZXR1cm4gbnVsbDsKfXRyeXtyZXR1cm4gbS5vZmZzZXRQYXJlbnQ7fWNhdGNoKG4pe31yZXR1cm4gbnVsbDt9LGdldE9mZnNldHM6ZnVuY3Rpb24oKXtpZih0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCYmIUJyb3dzZXIuUGxhdGZvcm0uaW9zKXt2YXIgcj10aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLG89ZG9jdW1lbnQuaWQodGhpcy5nZXREb2N1bWVudCgpLmRvY3VtZW50RWxlbWVudCkscT1vLmdldFNjcm9sbCgpLHQ9dGhpcy5nZXRTY3JvbGxzKCkscz0oayh0aGlzLCJwb3NpdGlvbiIpPT0iZml4ZWQiKTsKcmV0dXJue3g6ci5sZWZ0LnRvSW50KCkrdC54Kygocyk/MDpxLngpLW8uY2xpZW50TGVmdCx5OnIudG9wLnRvSW50KCkrdC55Kygocyk/MDpxLnkpLW8uY2xpZW50VG9wfTt9dmFyIG49dGhpcyxtPXt4OjAseTowfTtpZihhKHRoaXMpKXtyZXR1cm4gbTt9d2hpbGUobiYmIWEobikpe20ueCs9bi5vZmZzZXRMZWZ0OwptLnkrPW4ub2Zmc2V0VG9wO2lmKEJyb3dzZXIuZmlyZWZveCl7aWYoIWMobikpe20ueCs9YihuKTttLnkrPWcobik7fXZhciBwPW4ucGFyZW50Tm9kZTtpZihwJiZrKHAsIm92ZXJmbG93IikhPSJ2aXNpYmxlIil7bS54Kz1iKHApO20ueSs9ZyhwKTt9fWVsc2V7aWYobiE9dGhpcyYmQnJvd3Nlci5zYWZhcmkpe20ueCs9YihuKTsKbS55Kz1nKG4pO319bj1uLm9mZnNldFBhcmVudDt9aWYoQnJvd3Nlci5maXJlZm94JiYhYyh0aGlzKSl7bS54LT1iKHRoaXMpO20ueS09Zyh0aGlzKTt9cmV0dXJuIG07fSxnZXRQb3NpdGlvbjpmdW5jdGlvbihwKXt2YXIgcT10aGlzLmdldE9mZnNldHMoKSxuPXRoaXMuZ2V0U2Nyb2xscygpOwp2YXIgbT17eDpxLngtbi54LHk6cS55LW4ueX07aWYocCYmKHA9ZG9jdW1lbnQuaWQocCkpKXt2YXIgbz1wLmdldFBvc2l0aW9uKCk7cmV0dXJue3g6bS54LW8ueC1iKHApLHk6bS55LW8ueS1nKHApfTt9cmV0dXJuIG07fSxnZXRDb29yZGluYXRlczpmdW5jdGlvbihvKXtpZihhKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRDb29yZGluYXRlcygpOwp9dmFyIG09dGhpcy5nZXRQb3NpdGlvbihvKSxuPXRoaXMuZ2V0U2l6ZSgpO3ZhciBwPXtsZWZ0Om0ueCx0b3A6bS55LHdpZHRoOm4ueCxoZWlnaHQ6bi55fTtwLnJpZ2h0PXAubGVmdCtwLndpZHRoO3AuYm90dG9tPXAudG9wK3AuaGVpZ2h0O3JldHVybiBwO30sY29tcHV0ZVBvc2l0aW9uOmZ1bmN0aW9uKG0pe3JldHVybntsZWZ0Om0ueC1qKHRoaXMsIm1hcmdpbi1sZWZ0IiksdG9wOm0ueS1qKHRoaXMsIm1hcmdpbi10b3AiKX07Cn0sc2V0UG9zaXRpb246ZnVuY3Rpb24obSl7cmV0dXJuIHRoaXMuc2V0U3R5bGVzKHRoaXMuY29tcHV0ZVBvc2l0aW9uKG0pKTt9fSk7W0RvY3VtZW50LFdpbmRvd10uaW52b2tlKCJpbXBsZW1lbnQiLHtnZXRTaXplOmZ1bmN0aW9uKCl7dmFyIG09Zih0aGlzKTtyZXR1cm57eDptLmNsaWVudFdpZHRoLHk6bS5jbGllbnRIZWlnaHR9Owp9LGdldFNjcm9sbDpmdW5jdGlvbigpe3ZhciBuPXRoaXMuZ2V0V2luZG93KCksbT1mKHRoaXMpO3JldHVybnt4Om4ucGFnZVhPZmZzZXR8fG0uc2Nyb2xsTGVmdCx5Om4ucGFnZVlPZmZzZXR8fG0uc2Nyb2xsVG9wfTt9LGdldFNjcm9sbFNpemU6ZnVuY3Rpb24oKXt2YXIgbz1mKHRoaXMpLG49dGhpcy5nZXRTaXplKCksbT10aGlzLmdldERvY3VtZW50KCkuYm9keTsKcmV0dXJue3g6TWF0aC5tYXgoby5zY3JvbGxXaWR0aCxtLnNjcm9sbFdpZHRoLG4ueCkseTpNYXRoLm1heChvLnNjcm9sbEhlaWdodCxtLnNjcm9sbEhlaWdodCxuLnkpfTt9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJue3g6MCx5OjB9O30sZ2V0Q29vcmRpbmF0ZXM6ZnVuY3Rpb24oKXt2YXIgbT10aGlzLmdldFNpemUoKTsKcmV0dXJue3RvcDowLGxlZnQ6MCxib3R0b206bS55LHJpZ2h0Om0ueCxoZWlnaHQ6bS55LHdpZHRoOm0ueH07fX0pO3ZhciBrPUVsZW1lbnQuZ2V0Q29tcHV0ZWRTdHlsZTtmdW5jdGlvbiBqKG0sbil7cmV0dXJuIGsobSxuKS50b0ludCgpfHwwO31mdW5jdGlvbiBjKG0pe3JldHVybiBrKG0sIi1tb3otYm94LXNpemluZyIpPT0iYm9yZGVyLWJveCI7Cn1mdW5jdGlvbiBnKG0pe3JldHVybiBqKG0sImJvcmRlci10b3Atd2lkdGgiKTt9ZnVuY3Rpb24gYihtKXtyZXR1cm4gaihtLCJib3JkZXItbGVmdC13aWR0aCIpO31mdW5jdGlvbiBhKG0pe3JldHVybigvXig/OmJvZHl8aHRtbCkkL2kpLnRlc3QobS50YWdOYW1lKTsKfWZ1bmN0aW9uIGYobSl7dmFyIG49bS5nZXREb2N1bWVudCgpO3JldHVybighbi5jb21wYXRNb2RlfHxuLmNvbXBhdE1vZGU9PSJDU1MxQ29tcGF0Iik/bi5odG1sOm4uYm9keTt9fSkoKTtFbGVtZW50LmFsaWFzKHtwb3NpdGlvbjoic2V0UG9zaXRpb24ifSk7W1dpbmRvdyxEb2N1bWVudCxFbGVtZW50XS5pbnZva2UoImltcGxlbWVudCIse2dldEhlaWdodDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNpemUoKS55Owp9LGdldFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2l6ZSgpLng7fSxnZXRTY3JvbGxUb3A6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTY3JvbGwoKS55O30sZ2V0U2Nyb2xsTGVmdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbCgpLng7Cn0sZ2V0U2Nyb2xsSGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2Nyb2xsU2l6ZSgpLnk7fSxnZXRTY3JvbGxXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbFNpemUoKS54O30sZ2V0VG9wOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0UG9zaXRpb24oKS55Owp9LGdldExlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRQb3NpdGlvbigpLng7fX0pOyhmdW5jdGlvbigpe3ZhciBmPXRoaXMuRng9bmV3IENsYXNzKHtJbXBsZW1lbnRzOltDaGFpbixFdmVudHMsT3B0aW9uc10sb3B0aW9uczp7ZnBzOjYwLHVuaXQ6ZmFsc2UsZHVyYXRpb246NTAwLGZyYW1lczpudWxsLGZyYW1lU2tpcDp0cnVlLGxpbms6Imlnbm9yZSJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oZyl7dGhpcy5zdWJqZWN0PXRoaXMuc3ViamVjdHx8dGhpczsKdGhpcy5zZXRPcHRpb25zKGcpO30sZ2V0VHJhbnNpdGlvbjpmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihnKXtyZXR1cm4gLShNYXRoLmNvcyhNYXRoLlBJKmcpLTEpLzI7fTt9LHN0ZXA6ZnVuY3Rpb24oZyl7aWYodGhpcy5vcHRpb25zLmZyYW1lU2tpcCl7dmFyIGg9KHRoaXMudGltZSE9bnVsbCk/KGctdGhpcy50aW1lKTowLGk9aC90aGlzLmZyYW1lSW50ZXJ2YWw7CnRoaXMudGltZT1nO3RoaXMuZnJhbWUrPWk7fWVsc2V7dGhpcy5mcmFtZSsrO31pZih0aGlzLmZyYW1lPHRoaXMuZnJhbWVzKXt2YXIgaj10aGlzLnRyYW5zaXRpb24odGhpcy5mcmFtZS90aGlzLmZyYW1lcyk7dGhpcy5zZXQodGhpcy5jb21wdXRlKHRoaXMuZnJvbSx0aGlzLnRvLGopKTsKfWVsc2V7dGhpcy5mcmFtZT10aGlzLmZyYW1lczt0aGlzLnNldCh0aGlzLmNvbXB1dGUodGhpcy5mcm9tLHRoaXMudG8sMSkpO3RoaXMuc3RvcCgpO319LHNldDpmdW5jdGlvbihnKXtyZXR1cm4gZzt9LGNvbXB1dGU6ZnVuY3Rpb24oaSxoLGcpe3JldHVybiBmLmNvbXB1dGUoaSxoLGcpOwp9LGNoZWNrOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNSdW5uaW5nKCkpe3JldHVybiB0cnVlO31zd2l0Y2godGhpcy5vcHRpb25zLmxpbmspe2Nhc2UiY2FuY2VsIjp0aGlzLmNhbmNlbCgpO3JldHVybiB0cnVlO2Nhc2UiY2hhaW4iOnRoaXMuY2hhaW4odGhpcy5jYWxsZXIucGFzcyhhcmd1bWVudHMsdGhpcykpOwpyZXR1cm4gZmFsc2U7fXJldHVybiBmYWxzZTt9LHN0YXJ0OmZ1bmN0aW9uKGssail7aWYoIXRoaXMuY2hlY2soayxqKSl7cmV0dXJuIHRoaXM7fXRoaXMuZnJvbT1rO3RoaXMudG89ajt0aGlzLmZyYW1lPSh0aGlzLm9wdGlvbnMuZnJhbWVTa2lwKT8wOi0xO3RoaXMudGltZT1udWxsOwp0aGlzLnRyYW5zaXRpb249dGhpcy5nZXRUcmFuc2l0aW9uKCk7dmFyIGk9dGhpcy5vcHRpb25zLmZyYW1lcyxoPXRoaXMub3B0aW9ucy5mcHMsZz10aGlzLm9wdGlvbnMuZHVyYXRpb247dGhpcy5kdXJhdGlvbj1mLkR1cmF0aW9uc1tnXXx8Zy50b0ludCgpO3RoaXMuZnJhbWVJbnRlcnZhbD0xMDAwL2g7CnRoaXMuZnJhbWVzPWl8fE1hdGgucm91bmQodGhpcy5kdXJhdGlvbi90aGlzLmZyYW1lSW50ZXJ2YWwpO3RoaXMuZmlyZUV2ZW50KCJzdGFydCIsdGhpcy5zdWJqZWN0KTtiLmNhbGwodGhpcyxoKTtyZXR1cm4gdGhpczt9LHN0b3A6ZnVuY3Rpb24oKXtpZih0aGlzLmlzUnVubmluZygpKXt0aGlzLnRpbWU9bnVsbDsKZC5jYWxsKHRoaXMsdGhpcy5vcHRpb25zLmZwcyk7aWYodGhpcy5mcmFtZXM9PXRoaXMuZnJhbWUpe3RoaXMuZmlyZUV2ZW50KCJjb21wbGV0ZSIsdGhpcy5zdWJqZWN0KTtpZighdGhpcy5jYWxsQ2hhaW4oKSl7dGhpcy5maXJlRXZlbnQoImNoYWluQ29tcGxldGUiLHRoaXMuc3ViamVjdCk7Cn19ZWxzZXt0aGlzLmZpcmVFdmVudCgic3RvcCIsdGhpcy5zdWJqZWN0KTt9fXJldHVybiB0aGlzO30sY2FuY2VsOmZ1bmN0aW9uKCl7aWYodGhpcy5pc1J1bm5pbmcoKSl7dGhpcy50aW1lPW51bGw7ZC5jYWxsKHRoaXMsdGhpcy5vcHRpb25zLmZwcyk7dGhpcy5mcmFtZT10aGlzLmZyYW1lczsKdGhpcy5maXJlRXZlbnQoImNhbmNlbCIsdGhpcy5zdWJqZWN0KS5jbGVhckNoYWluKCk7fXJldHVybiB0aGlzO30scGF1c2U6ZnVuY3Rpb24oKXtpZih0aGlzLmlzUnVubmluZygpKXt0aGlzLnRpbWU9bnVsbDtkLmNhbGwodGhpcyx0aGlzLm9wdGlvbnMuZnBzKTt9cmV0dXJuIHRoaXM7Cn0scmVzdW1lOmZ1bmN0aW9uKCl7aWYoKHRoaXMuZnJhbWU8dGhpcy5mcmFtZXMpJiYhdGhpcy5pc1J1bm5pbmcoKSl7Yi5jYWxsKHRoaXMsdGhpcy5vcHRpb25zLmZwcyk7fXJldHVybiB0aGlzO30saXNSdW5uaW5nOmZ1bmN0aW9uKCl7dmFyIGc9ZVt0aGlzLm9wdGlvbnMuZnBzXTsKcmV0dXJuIGcmJmcuY29udGFpbnModGhpcyk7fX0pO2YuY29tcHV0ZT1mdW5jdGlvbihpLGgsZyl7cmV0dXJuKGgtaSkqZytpO307Zi5EdXJhdGlvbnM9eyJzaG9ydCI6MjUwLG5vcm1hbDo1MDAsImxvbmciOjEwMDB9O3ZhciBlPXt9LGM9e307dmFyIGE9ZnVuY3Rpb24oKXt2YXIgaD1EYXRlLm5vdygpOwpmb3IodmFyIGo9dGhpcy5sZW5ndGg7ai0tOyl7dmFyIGc9dGhpc1tqXTtpZihnKXtnLnN0ZXAoaCk7fX19O3ZhciBiPWZ1bmN0aW9uKGgpe3ZhciBnPWVbaF18fChlW2hdPVtdKTtnLnB1c2godGhpcyk7aWYoIWNbaF0pe2NbaF09YS5wZXJpb2RpY2FsKE1hdGgucm91bmQoMTAwMC9oKSxnKTsKfX07dmFyIGQ9ZnVuY3Rpb24oaCl7dmFyIGc9ZVtoXTtpZihnKXtnLmVyYXNlKHRoaXMpO2lmKCFnLmxlbmd0aCYmY1toXSl7ZGVsZXRlIGVbaF07Y1toXT1jbGVhckludGVydmFsKGNbaF0pO319fTt9KSgpO0Z4LkNTUz1uZXcgQ2xhc3Moe0V4dGVuZHM6RngscHJlcGFyZTpmdW5jdGlvbihiLGUsYSl7YT1BcnJheS5mcm9tKGEpOwp2YXIgaD1hWzBdLGc9YVsxXTtpZihnPT1udWxsKXtnPWg7aD1iLmdldFN0eWxlKGUpO3ZhciBjPXRoaXMub3B0aW9ucy51bml0O2lmKGMmJmguc2xpY2UoLWMubGVuZ3RoKSE9YyYmcGFyc2VGbG9hdChoKSE9MCl7Yi5zZXRTdHlsZShlLGcrYyk7dmFyIGQ9Yi5nZXRDb21wdXRlZFN0eWxlKGUpOwppZighKC9weCQvLnRlc3QoZCkpKXtkPWIuc3R5bGVbKCJwaXhlbC0iK2UpLmNhbWVsQ2FzZSgpXTtpZihkPT1udWxsKXt2YXIgZj1iLnN0eWxlLmxlZnQ7Yi5zdHlsZS5sZWZ0PWcrYztkPWIuc3R5bGUucGl4ZWxMZWZ0O2Iuc3R5bGUubGVmdD1mO319aD0oZ3x8MSkvKHBhcnNlRmxvYXQoZCl8fDEpKihwYXJzZUZsb2F0KGgpfHwwKTsKYi5zZXRTdHlsZShlLGgrYyk7fX1yZXR1cm57ZnJvbTp0aGlzLnBhcnNlKGgpLHRvOnRoaXMucGFyc2UoZyl9O30scGFyc2U6ZnVuY3Rpb24oYSl7YT1GdW5jdGlvbi5mcm9tKGEpKCk7YT0odHlwZW9mIGE9PSJzdHJpbmciKT9hLnNwbGl0KCIgIik6QXJyYXkuZnJvbShhKTsKcmV0dXJuIGEubWFwKGZ1bmN0aW9uKGMpe2M9U3RyaW5nKGMpO3ZhciBiPWZhbHNlO09iamVjdC5lYWNoKEZ4LkNTUy5QYXJzZXJzLGZ1bmN0aW9uKGYsZSl7aWYoYil7cmV0dXJuO312YXIgZD1mLnBhcnNlKGMpO2lmKGR8fGQ9PT0wKXtiPXt2YWx1ZTpkLHBhcnNlcjpmfTsKfX0pO2I9Ynx8e3ZhbHVlOmMscGFyc2VyOkZ4LkNTUy5QYXJzZXJzLlN0cmluZ307cmV0dXJuIGI7fSk7fSxjb21wdXRlOmZ1bmN0aW9uKGQsYyxiKXt2YXIgYT1bXTsoTWF0aC5taW4oZC5sZW5ndGgsYy5sZW5ndGgpKS50aW1lcyhmdW5jdGlvbihlKXthLnB1c2goe3ZhbHVlOmRbZV0ucGFyc2VyLmNvbXB1dGUoZFtlXS52YWx1ZSxjW2VdLnZhbHVlLGIpLHBhcnNlcjpkW2VdLnBhcnNlcn0pOwp9KTthLiRmYW1pbHk9RnVuY3Rpb24uZnJvbSgiZng6Y3NzOnZhbHVlIik7cmV0dXJuIGE7fSxzZXJ2ZTpmdW5jdGlvbihjLGIpe2lmKHR5cGVPZihjKSE9ImZ4OmNzczp2YWx1ZSIpe2M9dGhpcy5wYXJzZShjKTt9dmFyIGE9W107Yy5lYWNoKGZ1bmN0aW9uKGQpe2E9YS5jb25jYXQoZC5wYXJzZXIuc2VydmUoZC52YWx1ZSxiKSk7Cn0pO3JldHVybiBhO30scmVuZGVyOmZ1bmN0aW9uKGEsZCxjLGIpe2Euc2V0U3R5bGUoZCx0aGlzLnNlcnZlKGMsYikpO30sc2VhcmNoOmZ1bmN0aW9uKGEpe2lmKEZ4LkNTUy5DYWNoZVthXSl7cmV0dXJuIEZ4LkNTUy5DYWNoZVthXTt9dmFyIGM9e30sYj1uZXcgUmVnRXhwKCJeIithLmVzY2FwZVJlZ0V4cCgpKyIkIik7CkFycmF5LmVhY2goZG9jdW1lbnQuc3R5bGVTaGVldHMsZnVuY3Rpb24oZixlKXt2YXIgZD1mLmhyZWY7aWYoZCYmZC5jb250YWlucygiOi8vIikmJiFkLmNvbnRhaW5zKGRvY3VtZW50LmRvbWFpbikpe3JldHVybjt9dmFyIGc9Zi5ydWxlc3x8Zi5jc3NSdWxlcztBcnJheS5lYWNoKGcsZnVuY3Rpb24oayxoKXtpZighay5zdHlsZSl7cmV0dXJuOwp9dmFyIGo9KGsuc2VsZWN0b3JUZXh0KT9rLnNlbGVjdG9yVGV4dC5yZXBsYWNlKC9eXHcrLyxmdW5jdGlvbihpKXtyZXR1cm4gaS50b0xvd2VyQ2FzZSgpO30pOm51bGw7aWYoIWp8fCFiLnRlc3Qoaikpe3JldHVybjt9T2JqZWN0LmVhY2goRWxlbWVudC5TdHlsZXMsZnVuY3Rpb24obCxpKXtpZighay5zdHlsZVtpXXx8RWxlbWVudC5TaG9ydFN0eWxlc1tpXSl7cmV0dXJuOwp9bD1TdHJpbmcoay5zdHlsZVtpXSk7Y1tpXT0oKC9ecmdiLykudGVzdChsKSk/bC5yZ2JUb0hleCgpOmw7fSk7fSk7fSk7cmV0dXJuIEZ4LkNTUy5DYWNoZVthXT1jO319KTtGeC5DU1MuQ2FjaGU9e307RnguQ1NTLlBhcnNlcnM9e0NvbG9yOntwYXJzZTpmdW5jdGlvbihhKXtpZihhLm1hdGNoKC9eI1swLTlhLWZdezMsNn0kL2kpKXtyZXR1cm4gYS5oZXhUb1JnYih0cnVlKTsKfXJldHVybigoYT1hLm1hdGNoKC8oXGQrKSxccyooXGQrKSxccyooXGQrKS8pKSk/W2FbMV0sYVsyXSxhWzNdXTpmYWxzZTt9LGNvbXB1dGU6ZnVuY3Rpb24oYyxiLGEpe3JldHVybiBjLm1hcChmdW5jdGlvbihlLGQpe3JldHVybiBNYXRoLnJvdW5kKEZ4LmNvbXB1dGUoY1tkXSxiW2RdLGEpKTsKfSk7fSxzZXJ2ZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5tYXAoTnVtYmVyKTt9fSxOdW1iZXI6e3BhcnNlOnBhcnNlRmxvYXQsY29tcHV0ZTpGeC5jb21wdXRlLHNlcnZlOmZ1bmN0aW9uKGIsYSl7cmV0dXJuKGEpP2IrYTpiO319LFN0cmluZzp7cGFyc2U6RnVuY3Rpb24uZnJvbShmYWxzZSksY29tcHV0ZTpmdW5jdGlvbihiLGEpe3JldHVybiBhOwp9LHNlcnZlOmZ1bmN0aW9uKGEpe3JldHVybiBhO319fTtGeC5Ud2Vlbj1uZXcgQ2xhc3Moe0V4dGVuZHM6RnguQ1NTLGluaXRpYWxpemU6ZnVuY3Rpb24oYixhKXt0aGlzLmVsZW1lbnQ9dGhpcy5zdWJqZWN0PWRvY3VtZW50LmlkKGIpO3RoaXMucGFyZW50KGEpO30sc2V0OmZ1bmN0aW9uKGIsYSl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7YT1iOwpiPXRoaXMucHJvcGVydHl8fHRoaXMub3B0aW9ucy5wcm9wZXJ0eTt9dGhpcy5yZW5kZXIodGhpcy5lbGVtZW50LGIsYSx0aGlzLm9wdGlvbnMudW5pdCk7cmV0dXJuIHRoaXM7fSxzdGFydDpmdW5jdGlvbihjLGUsZCl7aWYoIXRoaXMuY2hlY2soYyxlLGQpKXtyZXR1cm4gdGhpczsKfXZhciBiPUFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKTt0aGlzLnByb3BlcnR5PXRoaXMub3B0aW9ucy5wcm9wZXJ0eXx8Yi5zaGlmdCgpO3ZhciBhPXRoaXMucHJlcGFyZSh0aGlzLmVsZW1lbnQsdGhpcy5wcm9wZXJ0eSxiKTtyZXR1cm4gdGhpcy5wYXJlbnQoYS5mcm9tLGEudG8pOwp9fSk7RWxlbWVudC5Qcm9wZXJ0aWVzLnR3ZWVuPXtzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5nZXQoInR3ZWVuIikuY2FuY2VsKCkuc2V0T3B0aW9ucyhhKTtyZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbigpe3ZhciBhPXRoaXMucmV0cmlldmUoInR3ZWVuIik7aWYoIWEpe2E9bmV3IEZ4LlR3ZWVuKHRoaXMse2xpbms6ImNhbmNlbCJ9KTsKdGhpcy5zdG9yZSgidHdlZW4iLGEpO31yZXR1cm4gYTt9fTtFbGVtZW50LmltcGxlbWVudCh7dHdlZW46ZnVuY3Rpb24oYSxjLGIpe3RoaXMuZ2V0KCJ0d2VlbiIpLnN0YXJ0KGEsYyxiKTtyZXR1cm4gdGhpczt9LGZhZGU6ZnVuY3Rpb24oZCl7dmFyIGU9dGhpcy5nZXQoInR3ZWVuIiksZyxjPVsib3BhY2l0eSJdLmFwcGVuZChhcmd1bWVudHMpLGE7CmlmKGNbMV09PW51bGwpe2NbMV09InRvZ2dsZSI7fXN3aXRjaChjWzFdKXtjYXNlImluIjpnPSJzdGFydCI7Y1sxXT0xO2JyZWFrO2Nhc2Uib3V0IjpnPSJzdGFydCI7Y1sxXT0wO2JyZWFrO2Nhc2Uic2hvdyI6Zz0ic2V0IjtjWzFdPTE7YnJlYWs7Y2FzZSJoaWRlIjpnPSJzZXQiOwpjWzFdPTA7YnJlYWs7Y2FzZSJ0b2dnbGUiOnZhciBiPXRoaXMucmV0cmlldmUoImZhZGU6ZmxhZyIsdGhpcy5nZXRTdHlsZSgib3BhY2l0eSIpPT0xKTtnPSJzdGFydCI7Y1sxXT1iPzA6MTt0aGlzLnN0b3JlKCJmYWRlOmZsYWciLCFiKTthPXRydWU7YnJlYWs7ZGVmYXVsdDpnPSJzdGFydCI7Cn1pZighYSl7dGhpcy5lbGltaW5hdGUoImZhZGU6ZmxhZyIpO31lW2ddLmFwcGx5KGUsYyk7dmFyIGY9Y1tjLmxlbmd0aC0xXTtpZihnPT0ic2V0Inx8ZiE9MCl7dGhpcy5zZXRTdHlsZSgidmlzaWJpbGl0eSIsZj09MD8iaGlkZGVuIjoidmlzaWJsZSIpO31lbHNle2UuY2hhaW4oZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQuc2V0U3R5bGUoInZpc2liaWxpdHkiLCJoaWRkZW4iKTsKdGhpcy5jYWxsQ2hhaW4oKTt9KTt9cmV0dXJuIHRoaXM7fSxoaWdobGlnaHQ6ZnVuY3Rpb24oYyxhKXtpZighYSl7YT10aGlzLnJldHJpZXZlKCJoaWdobGlnaHQ6b3JpZ2luYWwiLHRoaXMuZ2V0U3R5bGUoImJhY2tncm91bmQtY29sb3IiKSk7YT0oYT09InRyYW5zcGFyZW50Iik/IiNmZmYiOmE7Cn12YXIgYj10aGlzLmdldCgidHdlZW4iKTtiLnN0YXJ0KCJiYWNrZ3JvdW5kLWNvbG9yIixjfHwiI2ZmZmY4OCIsYSkuY2hhaW4oZnVuY3Rpb24oKXt0aGlzLnNldFN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIix0aGlzLnJldHJpZXZlKCJoaWdobGlnaHQ6b3JpZ2luYWwiKSk7CmIuY2FsbENoYWluKCk7fS5iaW5kKHRoaXMpKTtyZXR1cm4gdGhpczt9fSk7RnguTW9ycGg9bmV3IENsYXNzKHtFeHRlbmRzOkZ4LkNTUyxpbml0aWFsaXplOmZ1bmN0aW9uKGIsYSl7dGhpcy5lbGVtZW50PXRoaXMuc3ViamVjdD1kb2N1bWVudC5pZChiKTt0aGlzLnBhcmVudChhKTsKfSxzZXQ6ZnVuY3Rpb24oYSl7aWYodHlwZW9mIGE9PSJzdHJpbmciKXthPXRoaXMuc2VhcmNoKGEpO31mb3IodmFyIGIgaW4gYSl7dGhpcy5yZW5kZXIodGhpcy5lbGVtZW50LGIsYVtiXSx0aGlzLm9wdGlvbnMudW5pdCk7fXJldHVybiB0aGlzO30sY29tcHV0ZTpmdW5jdGlvbihlLGQsYyl7dmFyIGE9e307CmZvcih2YXIgYiBpbiBlKXthW2JdPXRoaXMucGFyZW50KGVbYl0sZFtiXSxjKTt9cmV0dXJuIGE7fSxzdGFydDpmdW5jdGlvbihiKXtpZighdGhpcy5jaGVjayhiKSl7cmV0dXJuIHRoaXM7fWlmKHR5cGVvZiBiPT0ic3RyaW5nIil7Yj10aGlzLnNlYXJjaChiKTt9dmFyIGU9e30sZD17fTsKZm9yKHZhciBjIGluIGIpe3ZhciBhPXRoaXMucHJlcGFyZSh0aGlzLmVsZW1lbnQsYyxiW2NdKTtlW2NdPWEuZnJvbTtkW2NdPWEudG87fXJldHVybiB0aGlzLnBhcmVudChlLGQpO319KTtFbGVtZW50LlByb3BlcnRpZXMubW9ycGg9e3NldDpmdW5jdGlvbihhKXt0aGlzLmdldCgibW9ycGgiKS5jYW5jZWwoKS5zZXRPcHRpb25zKGEpOwpyZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbigpe3ZhciBhPXRoaXMucmV0cmlldmUoIm1vcnBoIik7aWYoIWEpe2E9bmV3IEZ4Lk1vcnBoKHRoaXMse2xpbms6ImNhbmNlbCJ9KTt0aGlzLnN0b3JlKCJtb3JwaCIsYSk7fXJldHVybiBhO319O0VsZW1lbnQuaW1wbGVtZW50KHttb3JwaDpmdW5jdGlvbihhKXt0aGlzLmdldCgibW9ycGgiKS5zdGFydChhKTsKcmV0dXJuIHRoaXM7fX0pO0Z4LmltcGxlbWVudCh7Z2V0VHJhbnNpdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy50cmFuc2l0aW9ufHxGeC5UcmFuc2l0aW9ucy5TaW5lLmVhc2VJbk91dDtpZih0eXBlb2YgYT09InN0cmluZyIpe3ZhciBiPWEuc3BsaXQoIjoiKTsKYT1GeC5UcmFuc2l0aW9uczthPWFbYlswXV18fGFbYlswXS5jYXBpdGFsaXplKCldO2lmKGJbMV0pe2E9YVsiZWFzZSIrYlsxXS5jYXBpdGFsaXplKCkrKGJbMl0/YlsyXS5jYXBpdGFsaXplKCk6IiIpXTt9fXJldHVybiBhO319KTtGeC5UcmFuc2l0aW9uPWZ1bmN0aW9uKGMsYil7Yj1BcnJheS5mcm9tKGIpOwp2YXIgYT1mdW5jdGlvbihkKXtyZXR1cm4gYyhkLGIpO307cmV0dXJuIE9iamVjdC5hcHBlbmQoYSx7ZWFzZUluOmEsZWFzZU91dDpmdW5jdGlvbihkKXtyZXR1cm4gMS1jKDEtZCxiKTt9LGVhc2VJbk91dDpmdW5jdGlvbihkKXtyZXR1cm4oZDw9MC41P2MoMipkLGIpOigyLWMoMiooMS1kKSxiKSkpLzI7Cn19KTt9O0Z4LlRyYW5zaXRpb25zPXtsaW5lYXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGE7fX07RnguVHJhbnNpdGlvbnMuZXh0ZW5kPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKXtGeC5UcmFuc2l0aW9uc1tiXT1uZXcgRnguVHJhbnNpdGlvbihhW2JdKTt9fTtGeC5UcmFuc2l0aW9ucy5leHRlbmQoe1BvdzpmdW5jdGlvbihiLGEpe3JldHVybiBNYXRoLnBvdyhiLGEmJmFbMF18fDYpOwp9LEV4cG86ZnVuY3Rpb24oYSl7cmV0dXJuIE1hdGgucG93KDIsOCooYS0xKSk7fSxDaXJjOmZ1bmN0aW9uKGEpe3JldHVybiAxLU1hdGguc2luKE1hdGguYWNvcyhhKSk7fSxTaW5lOmZ1bmN0aW9uKGEpe3JldHVybiAxLU1hdGguY29zKGEqTWF0aC5QSS8yKTt9LEJhY2s6ZnVuY3Rpb24oYixhKXthPWEmJmFbMF18fDEuNjE4OwpyZXR1cm4gTWF0aC5wb3coYiwyKSooKGErMSkqYi1hKTt9LEJvdW5jZTpmdW5jdGlvbihmKXt2YXIgZTtmb3IodmFyIGQ9MCxjPTE7MTtkKz1jLGMvPTIpe2lmKGY+PSg3LTQqZCkvMTEpe2U9YypjLU1hdGgucG93KCgxMS02KmQtMTEqZikvNCwyKTticmVhazt9fXJldHVybiBlOwp9LEVsYXN0aWM6ZnVuY3Rpb24oYixhKXtyZXR1cm4gTWF0aC5wb3coMiwxMCotLWIpKk1hdGguY29zKDIwKmIqTWF0aC5QSSooYSYmYVswXXx8MSkvMyk7fX0pO1siUXVhZCIsIkN1YmljIiwiUXVhcnQiLCJRdWludCJdLmVhY2goZnVuY3Rpb24oYixhKXtGeC5UcmFuc2l0aW9uc1tiXT1uZXcgRnguVHJhbnNpdGlvbihmdW5jdGlvbihjKXtyZXR1cm4gTWF0aC5wb3coYyxhKzIpOwp9KTt9KTsoZnVuY3Rpb24oKXt2YXIgZD1mdW5jdGlvbigpe30sYT0oIm9ucHJvZ3Jlc3MiIGluIG5ldyBCcm93c2VyLlJlcXVlc3QpO3ZhciBjPXRoaXMuUmVxdWVzdD1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6W0NoYWluLEV2ZW50cyxPcHRpb25zXSxvcHRpb25zOnt1cmw6IiIsZGF0YToiIixoZWFkZXJzOnsiWC1SZXF1ZXN0ZWQtV2l0aCI6IlhNTEh0dHBSZXF1ZXN0IixBY2NlcHQ6InRleHQvamF2YXNjcmlwdCwgdGV4dC9odG1sLCBhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sLCAqLyoifSxhc3luYzp0cnVlLGZvcm1hdDpmYWxzZSxtZXRob2Q6InBvc3QiLGxpbms6Imlnbm9yZSIsaXNTdWNjZXNzOm51bGwsZW11bGF0aW9uOnRydWUsdXJsRW5jb2RlZDp0cnVlLGVuY29kaW5nOiJ1dGYtOCIsZXZhbFNjcmlwdHM6ZmFsc2UsZXZhbFJlc3BvbnNlOmZhbHNlLHRpbWVvdXQ6MCxub0NhY2hlOmZhbHNlfSxpbml0aWFsaXplOmZ1bmN0aW9uKGUpe3RoaXMueGhyPW5ldyBCcm93c2VyLlJlcXVlc3QoKTsKdGhpcy5zZXRPcHRpb25zKGUpO3RoaXMuaGVhZGVycz10aGlzLm9wdGlvbnMuaGVhZGVyczt9LG9uU3RhdGVDaGFuZ2U6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnhocjtpZihlLnJlYWR5U3RhdGUhPTR8fCF0aGlzLnJ1bm5pbmcpe3JldHVybjt9dGhpcy5ydW5uaW5nPWZhbHNlOwp0aGlzLnN0YXR1cz0wO0Z1bmN0aW9uLmF0dGVtcHQoZnVuY3Rpb24oKXt2YXIgZj1lLnN0YXR1czt0aGlzLnN0YXR1cz0oZj09MTIyMyk/MjA0OmY7fS5iaW5kKHRoaXMpKTtlLm9ucmVhZHlzdGF0ZWNoYW5nZT1kO2lmKGEpe2Uub25wcm9ncmVzcz1lLm9ubG9hZHN0YXJ0PWQ7Cn1jbGVhclRpbWVvdXQodGhpcy50aW1lcik7dGhpcy5yZXNwb25zZT17dGV4dDp0aGlzLnhoci5yZXNwb25zZVRleHR8fCIiLHhtbDp0aGlzLnhoci5yZXNwb25zZVhNTH07aWYodGhpcy5vcHRpb25zLmlzU3VjY2Vzcy5jYWxsKHRoaXMsdGhpcy5zdGF0dXMpKXt0aGlzLnN1Y2Nlc3ModGhpcy5yZXNwb25zZS50ZXh0LHRoaXMucmVzcG9uc2UueG1sKTsKfWVsc2V7dGhpcy5mYWlsdXJlKCk7fX0saXNTdWNjZXNzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5zdGF0dXM7cmV0dXJuKGU+PTIwMCYmZTwzMDApO30saXNSdW5uaW5nOmZ1bmN0aW9uKCl7cmV0dXJuICEhdGhpcy5ydW5uaW5nO30scHJvY2Vzc1NjcmlwdHM6ZnVuY3Rpb24oZSl7aWYodGhpcy5vcHRpb25zLmV2YWxSZXNwb25zZXx8KC8oZWNtYXxqYXZhKXNjcmlwdC8pLnRlc3QodGhpcy5nZXRIZWFkZXIoIkNvbnRlbnQtdHlwZSIpKSl7cmV0dXJuIEJyb3dzZXIuZXhlYyhlKTsKfXJldHVybiBlLnN0cmlwU2NyaXB0cyh0aGlzLm9wdGlvbnMuZXZhbFNjcmlwdHMpO30sc3VjY2VzczpmdW5jdGlvbihmLGUpe3RoaXMub25TdWNjZXNzKHRoaXMucHJvY2Vzc1NjcmlwdHMoZiksZSk7fSxvblN1Y2Nlc3M6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiLGFyZ3VtZW50cykuZmlyZUV2ZW50KCJzdWNjZXNzIixhcmd1bWVudHMpLmNhbGxDaGFpbigpOwp9LGZhaWx1cmU6ZnVuY3Rpb24oKXt0aGlzLm9uRmFpbHVyZSgpO30sb25GYWlsdXJlOmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoImNvbXBsZXRlIikuZmlyZUV2ZW50KCJmYWlsdXJlIix0aGlzLnhocik7fSxsb2Fkc3RhcnQ6ZnVuY3Rpb24oZSl7dGhpcy5maXJlRXZlbnQoImxvYWRzdGFydCIsW2UsdGhpcy54aHJdKTsKfSxwcm9ncmVzczpmdW5jdGlvbihlKXt0aGlzLmZpcmVFdmVudCgicHJvZ3Jlc3MiLFtlLHRoaXMueGhyXSk7fSx0aW1lb3V0OmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoInRpbWVvdXQiLHRoaXMueGhyKTt9LHNldEhlYWRlcjpmdW5jdGlvbihlLGYpe3RoaXMuaGVhZGVyc1tlXT1mOwpyZXR1cm4gdGhpczt9LGdldEhlYWRlcjpmdW5jdGlvbihlKXtyZXR1cm4gRnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3JldHVybiB0aGlzLnhoci5nZXRSZXNwb25zZUhlYWRlcihlKTt9LmJpbmQodGhpcykpO30sY2hlY2s6ZnVuY3Rpb24oKXtpZighdGhpcy5ydW5uaW5nKXtyZXR1cm4gdHJ1ZTsKfXN3aXRjaCh0aGlzLm9wdGlvbnMubGluayl7Y2FzZSJjYW5jZWwiOnRoaXMuY2FuY2VsKCk7cmV0dXJuIHRydWU7Y2FzZSJjaGFpbiI6dGhpcy5jaGFpbih0aGlzLmNhbGxlci5wYXNzKGFyZ3VtZW50cyx0aGlzKSk7cmV0dXJuIGZhbHNlO31yZXR1cm4gZmFsc2U7fSxzZW5kOmZ1bmN0aW9uKG8pe2lmKCF0aGlzLmNoZWNrKG8pKXtyZXR1cm4gdGhpczsKfXRoaXMub3B0aW9ucy5pc1N1Y2Nlc3M9dGhpcy5vcHRpb25zLmlzU3VjY2Vzc3x8dGhpcy5pc1N1Y2Nlc3M7dGhpcy5ydW5uaW5nPXRydWU7dmFyIGw9dHlwZU9mKG8pO2lmKGw9PSJzdHJpbmcifHxsPT0iZWxlbWVudCIpe289e2RhdGE6b307fXZhciBoPXRoaXMub3B0aW9uczsKbz1PYmplY3QuYXBwZW5kKHtkYXRhOmguZGF0YSx1cmw6aC51cmwsbWV0aG9kOmgubWV0aG9kfSxvKTt2YXIgaj1vLmRhdGEsZj1TdHJpbmcoby51cmwpLGU9by5tZXRob2QudG9Mb3dlckNhc2UoKTtzd2l0Y2godHlwZU9mKGopKXtjYXNlImVsZW1lbnQiOmo9ZG9jdW1lbnQuaWQoaikudG9RdWVyeVN0cmluZygpOwpicmVhaztjYXNlIm9iamVjdCI6Y2FzZSJoYXNoIjpqPU9iamVjdC50b1F1ZXJ5U3RyaW5nKGopO31pZih0aGlzLm9wdGlvbnMuZm9ybWF0KXt2YXIgbT0iZm9ybWF0PSIrdGhpcy5vcHRpb25zLmZvcm1hdDtqPShqKT9tKyImIitqOm07fWlmKHRoaXMub3B0aW9ucy5lbXVsYXRpb24mJiFbImdldCIsInBvc3QiXS5jb250YWlucyhlKSl7dmFyIGs9Il9tZXRob2Q9IitlOwpqPShqKT9rKyImIitqOms7ZT0icG9zdCI7fWlmKHRoaXMub3B0aW9ucy51cmxFbmNvZGVkJiZbInBvc3QiLCJwdXQiXS5jb250YWlucyhlKSl7dmFyIGc9KHRoaXMub3B0aW9ucy5lbmNvZGluZyk/IjsgY2hhcnNldD0iK3RoaXMub3B0aW9ucy5lbmNvZGluZzoiIjt0aGlzLmhlYWRlcnNbIkNvbnRlbnQtdHlwZSJdPSJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiK2c7Cn1pZighZil7Zj1kb2N1bWVudC5sb2NhdGlvbi5wYXRobmFtZTt9dmFyIGk9Zi5sYXN0SW5kZXhPZigiLyIpO2lmKGk+LTEmJihpPWYuaW5kZXhPZigiIyIpKT4tMSl7Zj1mLnN1YnN0cigwLGkpO31pZih0aGlzLm9wdGlvbnMubm9DYWNoZSl7Zis9KGYuY29udGFpbnMoIj8iKT8iJiI6Ij8iKStTdHJpbmcudW5pcXVlSUQoKTsKfWlmKGomJmU9PSJnZXQiKXtmKz0oZi5jb250YWlucygiPyIpPyImIjoiPyIpK2o7aj1udWxsO312YXIgbj10aGlzLnhocjtpZihhKXtuLm9ubG9hZHN0YXJ0PXRoaXMubG9hZHN0YXJ0LmJpbmQodGhpcyk7bi5vbnByb2dyZXNzPXRoaXMucHJvZ3Jlc3MuYmluZCh0aGlzKTsKfW4ub3BlbihlLnRvVXBwZXJDYXNlKCksZix0aGlzLm9wdGlvbnMuYXN5bmMsdGhpcy5vcHRpb25zLnVzZXIsdGhpcy5vcHRpb25zLnBhc3N3b3JkKTtpZih0aGlzLm9wdGlvbnMudXNlciYmIndpdGhDcmVkZW50aWFscyIgaW4gbil7bi53aXRoQ3JlZGVudGlhbHM9dHJ1ZTsKfW4ub25yZWFkeXN0YXRlY2hhbmdlPXRoaXMub25TdGF0ZUNoYW5nZS5iaW5kKHRoaXMpO09iamVjdC5lYWNoKHRoaXMuaGVhZGVycyxmdW5jdGlvbihxLHApe3RyeXtuLnNldFJlcXVlc3RIZWFkZXIocCxxKTt9Y2F0Y2gocil7dGhpcy5maXJlRXZlbnQoImV4Y2VwdGlvbiIsW3AscV0pOwp9fSx0aGlzKTt0aGlzLmZpcmVFdmVudCgicmVxdWVzdCIpO24uc2VuZChqKTtpZighdGhpcy5vcHRpb25zLmFzeW5jKXt0aGlzLm9uU3RhdGVDaGFuZ2UoKTt9ZWxzZXtpZih0aGlzLm9wdGlvbnMudGltZW91dCl7dGhpcy50aW1lcj10aGlzLnRpbWVvdXQuZGVsYXkodGhpcy5vcHRpb25zLnRpbWVvdXQsdGhpcyk7Cn19cmV0dXJuIHRoaXM7fSxjYW5jZWw6ZnVuY3Rpb24oKXtpZighdGhpcy5ydW5uaW5nKXtyZXR1cm4gdGhpczt9dGhpcy5ydW5uaW5nPWZhbHNlO3ZhciBlPXRoaXMueGhyO2UuYWJvcnQoKTtjbGVhclRpbWVvdXQodGhpcy50aW1lcik7ZS5vbnJlYWR5c3RhdGVjaGFuZ2U9ZDsKaWYoYSl7ZS5vbnByb2dyZXNzPWUub25sb2Fkc3RhcnQ9ZDt9dGhpcy54aHI9bmV3IEJyb3dzZXIuUmVxdWVzdCgpO3RoaXMuZmlyZUV2ZW50KCJjYW5jZWwiKTtyZXR1cm4gdGhpczt9fSk7dmFyIGI9e307WyJnZXQiLCJwb3N0IiwicHV0IiwiZGVsZXRlIiwiR0VUIiwiUE9TVCIsIlBVVCIsIkRFTEVURSJdLmVhY2goZnVuY3Rpb24oZSl7YltlXT1mdW5jdGlvbihnKXt2YXIgZj17bWV0aG9kOmV9OwppZihnIT1udWxsKXtmLmRhdGE9Zzt9cmV0dXJuIHRoaXMuc2VuZChmKTt9O30pO2MuaW1wbGVtZW50KGIpO0VsZW1lbnQuUHJvcGVydGllcy5zZW5kPXtzZXQ6ZnVuY3Rpb24oZSl7dmFyIGY9dGhpcy5nZXQoInNlbmQiKS5jYW5jZWwoKTtmLnNldE9wdGlvbnMoZSk7CnJldHVybiB0aGlzO30sZ2V0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5yZXRyaWV2ZSgic2VuZCIpO2lmKCFlKXtlPW5ldyBjKHtkYXRhOnRoaXMsbGluazoiY2FuY2VsIixtZXRob2Q6dGhpcy5nZXQoIm1ldGhvZCIpfHwicG9zdCIsdXJsOnRoaXMuZ2V0KCJhY3Rpb24iKX0pOwp0aGlzLnN0b3JlKCJzZW5kIixlKTt9cmV0dXJuIGU7fX07RWxlbWVudC5pbXBsZW1lbnQoe3NlbmQ6ZnVuY3Rpb24oZSl7dmFyIGY9dGhpcy5nZXQoInNlbmQiKTtmLnNlbmQoe2RhdGE6dGhpcyx1cmw6ZXx8Zi5vcHRpb25zLnVybH0pO3JldHVybiB0aGlzO319KTt9KSgpOwpSZXF1ZXN0LkhUTUw9bmV3IENsYXNzKHtFeHRlbmRzOlJlcXVlc3Qsb3B0aW9uczp7dXBkYXRlOmZhbHNlLGFwcGVuZDpmYWxzZSxldmFsU2NyaXB0czp0cnVlLGZpbHRlcjpmYWxzZSxoZWFkZXJzOntBY2NlcHQ6InRleHQvaHRtbCwgYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCwgKi8qIn19LHN1Y2Nlc3M6ZnVuY3Rpb24oZil7dmFyIGU9dGhpcy5vcHRpb25zLGM9dGhpcy5yZXNwb25zZTsKYy5odG1sPWYuc3RyaXBTY3JpcHRzKGZ1bmN0aW9uKGgpe2MuamF2YXNjcmlwdD1oO30pO3ZhciBkPWMuaHRtbC5tYXRjaCgvPGJvZHlbXj5dKj4oW1xzXFNdKj8pPFwvYm9keT4vaSk7aWYoZCl7Yy5odG1sPWRbMV07fXZhciBiPW5ldyBFbGVtZW50KCJkaXYiKS5zZXQoImh0bWwiLGMuaHRtbCk7CmMudHJlZT1iLmNoaWxkTm9kZXM7Yy5lbGVtZW50cz1iLmdldEVsZW1lbnRzKGUuZmlsdGVyfHwiKiIpO2lmKGUuZmlsdGVyKXtjLnRyZWU9Yy5lbGVtZW50czt9aWYoZS51cGRhdGUpe3ZhciBnPWRvY3VtZW50LmlkKGUudXBkYXRlKS5lbXB0eSgpO2lmKGUuZmlsdGVyKXtnLmFkb3B0KGMuZWxlbWVudHMpOwp9ZWxzZXtnLnNldCgiaHRtbCIsYy5odG1sKTt9fWVsc2V7aWYoZS5hcHBlbmQpe3ZhciBhPWRvY3VtZW50LmlkKGUuYXBwZW5kKTtpZihlLmZpbHRlcil7Yy5lbGVtZW50cy5yZXZlcnNlKCkuaW5qZWN0KGEpO31lbHNle2EuYWRvcHQoYi5nZXRDaGlsZHJlbigpKTt9fX1pZihlLmV2YWxTY3JpcHRzKXtCcm93c2VyLmV4ZWMoYy5qYXZhc2NyaXB0KTsKfXRoaXMub25TdWNjZXNzKGMudHJlZSxjLmVsZW1lbnRzLGMuaHRtbCxjLmphdmFzY3JpcHQpO319KTtFbGVtZW50LlByb3BlcnRpZXMubG9hZD17c2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZ2V0KCJsb2FkIikuY2FuY2VsKCk7Yi5zZXRPcHRpb25zKGEpO3JldHVybiB0aGlzOwp9LGdldDpmdW5jdGlvbigpe3ZhciBhPXRoaXMucmV0cmlldmUoImxvYWQiKTtpZighYSl7YT1uZXcgUmVxdWVzdC5IVE1MKHtkYXRhOnRoaXMsbGluazoiY2FuY2VsIix1cGRhdGU6dGhpcyxtZXRob2Q6ImdldCJ9KTt0aGlzLnN0b3JlKCJsb2FkIixhKTt9cmV0dXJuIGE7Cn19O0VsZW1lbnQuaW1wbGVtZW50KHtsb2FkOmZ1bmN0aW9uKCl7dGhpcy5nZXQoImxvYWQiKS5zZW5kKEFycmF5LmxpbmsoYXJndW1lbnRzLHtkYXRhOlR5cGUuaXNPYmplY3QsdXJsOlR5cGUuaXNTdHJpbmd9KSk7cmV0dXJuIHRoaXM7fX0pO2lmKHR5cGVvZiBKU09OPT0idW5kZWZpbmVkIil7dGhpcy5KU09OPXt9Owp9KGZ1bmN0aW9uKCl7dmFyIHNwZWNpYWw9eyJcYiI6IlxcYiIsIlx0IjoiXFx0IiwiXG4iOiJcXG4iLCJcZiI6IlxcZiIsIlxyIjoiXFxyIiwnIic6J1xcIicsIlxcIjoiXFxcXCJ9O3ZhciBlc2NhcGU9ZnVuY3Rpb24oY2hyKXtyZXR1cm4gc3BlY2lhbFtjaHJdfHwiXFx1IisoIjAwMDAiK2Noci5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTQpOwp9O0pTT04udmFsaWRhdGU9ZnVuY3Rpb24oc3RyaW5nKXtzdHJpbmc9c3RyaW5nLnJlcGxhY2UoL1xcKD86WyJcXFwvYmZucnRdfHVbMC05YS1mQS1GXXs0fSkvZywiQCIpLnJlcGxhY2UoLyJbXiJcXFxuXHJdKiJ8dHJ1ZXxmYWxzZXxudWxsfC0/XGQrKD86XC5cZCopPyg/OltlRV1bK1wtXT9cZCspPy9nLCJdIikucmVwbGFjZSgvKD86Xnw6fCwpKD86XHMqXFspKy9nLCIiKTsKcmV0dXJuKC9eW1xdLDp7fVxzXSokLykudGVzdChzdHJpbmcpO307SlNPTi5lbmNvZGU9SlNPTi5zdHJpbmdpZnk/ZnVuY3Rpb24ob2JqKXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKTt9OmZ1bmN0aW9uKG9iail7aWYob2JqJiZvYmoudG9KU09OKXtvYmo9b2JqLnRvSlNPTigpOwp9c3dpdGNoKHR5cGVPZihvYmopKXtjYXNlInN0cmluZyI6cmV0dXJuJyInK29iai5yZXBsYWNlKC9bXHgwMC1ceDFmXFwiXS9nLGVzY2FwZSkrJyInO2Nhc2UiYXJyYXkiOnJldHVybiJbIitvYmoubWFwKEpTT04uZW5jb2RlKS5jbGVhbigpKyJdIjtjYXNlIm9iamVjdCI6Y2FzZSJoYXNoIjp2YXIgc3RyaW5nPVtdOwpPYmplY3QuZWFjaChvYmosZnVuY3Rpb24odmFsdWUsa2V5KXt2YXIganNvbj1KU09OLmVuY29kZSh2YWx1ZSk7aWYoanNvbil7c3RyaW5nLnB1c2goSlNPTi5lbmNvZGUoa2V5KSsiOiIranNvbik7fX0pO3JldHVybiJ7IitzdHJpbmcrIn0iO2Nhc2UibnVtYmVyIjpjYXNlImJvb2xlYW4iOnJldHVybiIiK29iajsKY2FzZSJudWxsIjpyZXR1cm4ibnVsbCI7fXJldHVybiBudWxsO307SlNPTi5kZWNvZGU9ZnVuY3Rpb24oc3RyaW5nLHNlY3VyZSl7aWYoIXN0cmluZ3x8dHlwZU9mKHN0cmluZykhPSJzdHJpbmciKXtyZXR1cm4gbnVsbDt9aWYoc2VjdXJlfHxKU09OLnNlY3VyZSl7aWYoSlNPTi5wYXJzZSl7cmV0dXJuIEpTT04ucGFyc2Uoc3RyaW5nKTsKfWlmKCFKU09OLnZhbGlkYXRlKHN0cmluZykpe3Rocm93IG5ldyBFcnJvcigiSlNPTiBjb3VsZCBub3QgZGVjb2RlIHRoZSBpbnB1dDsgc2VjdXJpdHkgaXMgZW5hYmxlZCBhbmQgdGhlIHZhbHVlIGlzIG5vdCBzZWN1cmUuIik7fX1yZXR1cm4gZXZhbCgiKCIrc3RyaW5nKyIpIik7Cn07fSkoKTtSZXF1ZXN0LkpTT049bmV3IENsYXNzKHtFeHRlbmRzOlJlcXVlc3Qsb3B0aW9uczp7c2VjdXJlOnRydWV9LGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnQoYSk7T2JqZWN0LmFwcGVuZCh0aGlzLmhlYWRlcnMse0FjY2VwdDoiYXBwbGljYXRpb24vanNvbiIsIlgtUmVxdWVzdCI6IkpTT04ifSk7Cn0sc3VjY2VzczpmdW5jdGlvbihjKXt2YXIgYjt0cnl7Yj10aGlzLnJlc3BvbnNlLmpzb249SlNPTi5kZWNvZGUoYyx0aGlzLm9wdGlvbnMuc2VjdXJlKTt9Y2F0Y2goYSl7dGhpcy5maXJlRXZlbnQoImVycm9yIixbYyxhXSk7cmV0dXJuO31pZihiPT1udWxsKXt0aGlzLm9uRmFpbHVyZSgpOwp9ZWxzZXt0aGlzLm9uU3VjY2VzcyhiLGMpO319fSk7dmFyIENvb2tpZT1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6T3B0aW9ucyxvcHRpb25zOntwYXRoOiIvIixkb21haW46ZmFsc2UsZHVyYXRpb246ZmFsc2Usc2VjdXJlOmZhbHNlLGRvY3VtZW50OmRvY3VtZW50LGVuY29kZTp0cnVlfSxpbml0aWFsaXplOmZ1bmN0aW9uKGIsYSl7dGhpcy5rZXk9YjsKdGhpcy5zZXRPcHRpb25zKGEpO30sd3JpdGU6ZnVuY3Rpb24oYil7aWYodGhpcy5vcHRpb25zLmVuY29kZSl7Yj1lbmNvZGVVUklDb21wb25lbnQoYik7fWlmKHRoaXMub3B0aW9ucy5kb21haW4pe2IrPSI7IGRvbWFpbj0iK3RoaXMub3B0aW9ucy5kb21haW47fWlmKHRoaXMub3B0aW9ucy5wYXRoKXtiKz0iOyBwYXRoPSIrdGhpcy5vcHRpb25zLnBhdGg7Cn1pZih0aGlzLm9wdGlvbnMuZHVyYXRpb24pe3ZhciBhPW5ldyBEYXRlKCk7YS5zZXRUaW1lKGEuZ2V0VGltZSgpK3RoaXMub3B0aW9ucy5kdXJhdGlvbioyNCo2MCo2MCoxMDAwKTtiKz0iOyBleHBpcmVzPSIrYS50b0dNVFN0cmluZygpO31pZih0aGlzLm9wdGlvbnMuc2VjdXJlKXtiKz0iOyBzZWN1cmUiOwp9dGhpcy5vcHRpb25zLmRvY3VtZW50LmNvb2tpZT10aGlzLmtleSsiPSIrYjtyZXR1cm4gdGhpczt9LHJlYWQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuZG9jdW1lbnQuY29va2llLm1hdGNoKCIoPzpefDspXFxzKiIrdGhpcy5rZXkuZXNjYXBlUmVnRXhwKCkrIj0oW147XSopIik7CnJldHVybihhKT9kZWNvZGVVUklDb21wb25lbnQoYVsxXSk6bnVsbDt9LGRpc3Bvc2U6ZnVuY3Rpb24oKXtuZXcgQ29va2llKHRoaXMua2V5LE9iamVjdC5tZXJnZSh7fSx0aGlzLm9wdGlvbnMse2R1cmF0aW9uOi0xfSkpLndyaXRlKCIiKTtyZXR1cm4gdGhpczt9fSk7CkNvb2tpZS53cml0ZT1mdW5jdGlvbihiLGMsYSl7cmV0dXJuIG5ldyBDb29raWUoYixhKS53cml0ZShjKTt9O0Nvb2tpZS5yZWFkPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgQ29va2llKGEpLnJlYWQoKTt9O0Nvb2tpZS5kaXNwb3NlPWZ1bmN0aW9uKGIsYSl7cmV0dXJuIG5ldyBDb29raWUoYixhKS5kaXNwb3NlKCk7Cn07KGZ1bmN0aW9uKGksayl7dmFyIGwsZixlPVtdLGMsYixkPWsuY3JlYXRlRWxlbWVudCgiZGl2Iik7dmFyIGc9ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoYik7aWYobCl7cmV0dXJuO31Ccm93c2VyLmxvYWRlZD1sPXRydWU7ay5yZW1vdmVMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsZykucmVtb3ZlTGlzdGVuZXIoInJlYWR5c3RhdGVjaGFuZ2UiLGEpOwprLmZpcmVFdmVudCgiZG9tcmVhZHkiKTtpLmZpcmVFdmVudCgiZG9tcmVhZHkiKTt9O3ZhciBhPWZ1bmN0aW9uKCl7Zm9yKHZhciBtPWUubGVuZ3RoO20tLTspe2lmKGVbbV0oKSl7ZygpO3JldHVybiB0cnVlO319cmV0dXJuIGZhbHNlO307dmFyIGo9ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoYik7CmlmKCFhKCkpe2I9c2V0VGltZW91dChqLDEwKTt9fTtrLmFkZExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixnKTt2YXIgaD1mdW5jdGlvbigpe3RyeXtkLmRvU2Nyb2xsKCk7cmV0dXJuIHRydWU7fWNhdGNoKG0pe31yZXR1cm4gZmFsc2U7fTtpZihkLmRvU2Nyb2xsJiYhaCgpKXtlLnB1c2goaCk7CmM9dHJ1ZTt9aWYoay5yZWFkeVN0YXRlKXtlLnB1c2goZnVuY3Rpb24oKXt2YXIgbT1rLnJlYWR5U3RhdGU7cmV0dXJuKG09PSJsb2FkZWQifHxtPT0iY29tcGxldGUiKTt9KTt9aWYoIm9ucmVhZHlzdGF0ZWNoYW5nZSIgaW4gayl7ay5hZGRMaXN0ZW5lcigicmVhZHlzdGF0ZWNoYW5nZSIsYSk7Cn1lbHNle2M9dHJ1ZTt9aWYoYyl7aigpO31FbGVtZW50LkV2ZW50cy5kb21yZWFkeT17b25BZGQ6ZnVuY3Rpb24obSl7aWYobCl7bS5jYWxsKHRoaXMpO319fTtFbGVtZW50LkV2ZW50cy5sb2FkPXtiYXNlOiJsb2FkIixvbkFkZDpmdW5jdGlvbihtKXtpZihmJiZ0aGlzPT1pKXttLmNhbGwodGhpcyk7Cn19LGNvbmRpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXM9PWkpe2coKTtkZWxldGUgRWxlbWVudC5FdmVudHMubG9hZDt9cmV0dXJuIHRydWU7fX07aS5hZGRFdmVudCgibG9hZCIsZnVuY3Rpb24oKXtmPXRydWU7fSk7fSkod2luZG93LGRvY3VtZW50KTsoZnVuY3Rpb24oKXt2YXIgU3dpZmY9dGhpcy5Td2lmZj1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6T3B0aW9ucyxvcHRpb25zOntpZDpudWxsLGhlaWdodDoxLHdpZHRoOjEsY29udGFpbmVyOm51bGwscHJvcGVydGllczp7fSxwYXJhbXM6e3F1YWxpdHk6ImhpZ2giLGFsbG93U2NyaXB0QWNjZXNzOiJhbHdheXMiLHdNb2RlOiJ3aW5kb3ciLHN3TGl2ZUNvbm5lY3Q6dHJ1ZX0sY2FsbEJhY2tzOnt9LHZhcnM6e319LHRvRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9iamVjdDsKfSxpbml0aWFsaXplOmZ1bmN0aW9uKHBhdGgsb3B0aW9ucyl7dGhpcy5pbnN0YW5jZT0iU3dpZmZfIitTdHJpbmcudW5pcXVlSUQoKTt0aGlzLnNldE9wdGlvbnMob3B0aW9ucyk7b3B0aW9ucz10aGlzLm9wdGlvbnM7dmFyIGlkPXRoaXMuaWQ9b3B0aW9ucy5pZHx8dGhpcy5pbnN0YW5jZTsKdmFyIGNvbnRhaW5lcj1kb2N1bWVudC5pZChvcHRpb25zLmNvbnRhaW5lcik7U3dpZmYuQ2FsbEJhY2tzW3RoaXMuaW5zdGFuY2VdPXt9O3ZhciBwYXJhbXM9b3B0aW9ucy5wYXJhbXMsdmFycz1vcHRpb25zLnZhcnMsY2FsbEJhY2tzPW9wdGlvbnMuY2FsbEJhY2tzOwp2YXIgcHJvcGVydGllcz1PYmplY3QuYXBwZW5kKHtoZWlnaHQ6b3B0aW9ucy5oZWlnaHQsd2lkdGg6b3B0aW9ucy53aWR0aH0sb3B0aW9ucy5wcm9wZXJ0aWVzKTt2YXIgc2VsZj10aGlzO2Zvcih2YXIgY2FsbEJhY2sgaW4gY2FsbEJhY2tzKXtTd2lmZi5DYWxsQmFja3NbdGhpcy5pbnN0YW5jZV1bY2FsbEJhY2tdPShmdW5jdGlvbihvcHRpb24pe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBvcHRpb24uYXBwbHkoc2VsZi5vYmplY3QsYXJndW1lbnRzKTsKfTt9KShjYWxsQmFja3NbY2FsbEJhY2tdKTt2YXJzW2NhbGxCYWNrXT0iU3dpZmYuQ2FsbEJhY2tzLiIrdGhpcy5pbnN0YW5jZSsiLiIrY2FsbEJhY2s7fXBhcmFtcy5mbGFzaFZhcnM9T2JqZWN0LnRvUXVlcnlTdHJpbmcodmFycyk7aWYoQnJvd3Nlci5pZSl7cHJvcGVydGllcy5jbGFzc2lkPSJjbHNpZDpEMjdDREI2RS1BRTZELTExY2YtOTZCOC00NDQ1NTM1NDAwMDAiOwpwYXJhbXMubW92aWU9cGF0aDt9ZWxzZXtwcm9wZXJ0aWVzLnR5cGU9ImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoIjt9cHJvcGVydGllcy5kYXRhPXBhdGg7dmFyIGJ1aWxkPSc8b2JqZWN0IGlkPSInK2lkKyciJztmb3IodmFyIHByb3BlcnR5IGluIHByb3BlcnRpZXMpe2J1aWxkKz0iICIrcHJvcGVydHkrJz0iJytwcm9wZXJ0aWVzW3Byb3BlcnR5XSsnIic7Cn1idWlsZCs9Ij4iO2Zvcih2YXIgcGFyYW0gaW4gcGFyYW1zKXtpZihwYXJhbXNbcGFyYW1dKXtidWlsZCs9JzxwYXJhbSBuYW1lPSInK3BhcmFtKyciIHZhbHVlPSInK3BhcmFtc1twYXJhbV0rJyIgLz4nO319YnVpbGQrPSI8L29iamVjdD4iO3RoaXMub2JqZWN0PSgoY29udGFpbmVyKT9jb250YWluZXIuZW1wdHkoKTpuZXcgRWxlbWVudCgiZGl2IikpLnNldCgiaHRtbCIsYnVpbGQpLmZpcnN0Q2hpbGQ7Cn0scmVwbGFjZXM6ZnVuY3Rpb24oZWxlbWVudCl7ZWxlbWVudD1kb2N1bWVudC5pZChlbGVtZW50LHRydWUpO2VsZW1lbnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodGhpcy50b0VsZW1lbnQoKSxlbGVtZW50KTtyZXR1cm4gdGhpczt9LGluamVjdDpmdW5jdGlvbihlbGVtZW50KXtkb2N1bWVudC5pZChlbGVtZW50LHRydWUpLmFwcGVuZENoaWxkKHRoaXMudG9FbGVtZW50KCkpOwpyZXR1cm4gdGhpczt9LHJlbW90ZTpmdW5jdGlvbigpe3JldHVybiBTd2lmZi5yZW1vdGUuYXBwbHkoU3dpZmYsW3RoaXMudG9FbGVtZW50KCldLmFwcGVuZChhcmd1bWVudHMpKTt9fSk7U3dpZmYuQ2FsbEJhY2tzPXt9O1N3aWZmLnJlbW90ZT1mdW5jdGlvbihvYmosZm4pe3ZhciBycz1vYmouQ2FsbEZ1bmN0aW9uKCc8aW52b2tlIG5hbWU9IicrZm4rJyIgcmV0dXJudHlwZT0iamF2YXNjcmlwdCI+JytfX2ZsYXNoX19hcmd1bWVudHNUb1hNTChhcmd1bWVudHMsMikrIjwvaW52b2tlPiIpOwpyZXR1cm4gZXZhbChycyk7fTt9KSgpOw==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 03:54:57 GMT",
                    "Content-Length": "90109",
                    "Date": "Sat, 08 Nov 2014 03:55:24 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}