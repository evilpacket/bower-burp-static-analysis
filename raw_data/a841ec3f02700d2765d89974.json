{
    "url": "http://localhost:9999/documentcloud/visualsearch/build-min/dependencies.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>location.href</b> and written to <b>location.replace()</b> via the following statements:<ul><li>var href=location.href.replace(/(javascript:|#).*$/,'');</li><li>location.replace(href+'#'+fragment);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/documentcloud/visualsearch/build-min/dependencies.js",
                "path": "/documentcloud/visualsearch/build-min/dependencies.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9kb2N1bWVudGNsb3VkL3Zpc3VhbHNlYXJjaC9idWlsZC1taW4vZGVwZW5kZW5jaWVzLmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMjQzNzg1DQpBY2NlcHQtUmFuZ2VzOiBieXRlcw0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0DQpEYXRlOiBTdW4sIDA5IE5vdiAyMDE0IDAxOjUzOjIzIEdNVA0KTGFzdC1Nb2RpZmllZDogU3VuLCAwOSBOb3YgMjAxNCAwMTo1MzoyMyBHTVQNCg0KCihmdW5jdGlvbihnbG9iYWwsZmFjdG9yeSl7aWYodHlwZW9mIG1vZHVsZT09PSJvYmplY3QiJiZ0eXBlb2YgbW9kdWxlLmV4cG9ydHM9PT0ib2JqZWN0Iil7bW9kdWxlLmV4cG9ydHM9Z2xvYmFsLmRvY3VtZW50P2ZhY3RvcnkoZ2xvYmFsLHRydWUpOmZ1bmN0aW9uKHcpe2lmKCF3LmRvY3VtZW50KXt0aHJvdyBuZXcgRXJyb3IoImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnQiKTt9CnJldHVybiBmYWN0b3J5KHcpO307fWVsc2V7ZmFjdG9yeShnbG9iYWwpO319KHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIj93aW5kb3c6dGhpcyxmdW5jdGlvbih3aW5kb3csbm9HbG9iYWwpe3ZhciBkZWxldGVkSWRzPVtdO3ZhciBzbGljZT1kZWxldGVkSWRzLnNsaWNlO3ZhciBjb25jYXQ9ZGVsZXRlZElkcy5jb25jYXQ7dmFyIHB1c2g9ZGVsZXRlZElkcy5wdXNoO3ZhciBpbmRleE9mPWRlbGV0ZWRJZHMuaW5kZXhPZjt2YXIgY2xhc3MydHlwZT17fTt2YXIgdG9TdHJpbmc9Y2xhc3MydHlwZS50b1N0cmluZzt2YXIgaGFzT3duPWNsYXNzMnR5cGUuaGFzT3duUHJvcGVydHk7dmFyIHRyaW09IiIudHJpbTt2YXIgc3VwcG9ydD17fTt2YXIKdmVyc2lvbj0iMS4xMS4wIixqUXVlcnk9ZnVuY3Rpb24oc2VsZWN0b3IsY29udGV4dCl7cmV0dXJuIG5ldyBqUXVlcnkuZm4uaW5pdChzZWxlY3Rvcixjb250ZXh0KTt9LHJ0cmltPS9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZyxybXNQcmVmaXg9L14tbXMtLyxyZGFzaEFscGhhPS8tKFtcZGEtel0pL2dpLGZjYW1lbENhc2U9ZnVuY3Rpb24oYWxsLGxldHRlcil7cmV0dXJuIGxldHRlci50b1VwcGVyQ2FzZSgpO307alF1ZXJ5LmZuPWpRdWVyeS5wcm90b3R5cGU9e2pxdWVyeTp2ZXJzaW9uLGNvbnN0cnVjdG9yOmpRdWVyeSxzZWxlY3RvcjoiIixsZW5ndGg6MCx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHNsaWNlLmNhbGwodGhpcyk7fSxnZXQ6ZnVuY3Rpb24obnVtKXtyZXR1cm4gbnVtIT1udWxsPyhudW08MD90aGlzW251bSt0aGlzLmxlbmd0aF06dGhpc1tudW1dKTpzbGljZS5jYWxsKHRoaXMpO30scHVzaFN0YWNrOmZ1bmN0aW9uKGVsZW1zKXt2YXIgcmV0PWpRdWVyeS5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksZWxlbXMpO3JldC5wcmV2T2JqZWN0PXRoaXM7cmV0LmNvbnRleHQ9dGhpcy5jb250ZXh0O3JldHVybiByZXQ7fSxlYWNoOmZ1bmN0aW9uKGNhbGxiYWNrLGFyZ3Mpe3JldHVybiBqUXVlcnkuZWFjaCh0aGlzLGNhbGxiYWNrLGFyZ3MpO30sbWFwOmZ1bmN0aW9uKGNhbGxiYWNrKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soalF1ZXJ5Lm1hcCh0aGlzLGZ1bmN0aW9uKGVsZW0saSl7cmV0dXJuIGNhbGxiYWNrLmNhbGwoZWxlbSxpLGVsZW0pO30pKTt9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHNsaWNlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSk7fSxmaXJzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKDApO30sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKTt9LGVxOmZ1bmN0aW9uKGkpe3ZhciBsZW49dGhpcy5sZW5ndGgsaj0raSsoaTwwP2xlbjowKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soaj49MCYmajxsZW4/W3RoaXNbal1dOltdKTt9LGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXZPYmplY3R8fHRoaXMuY29uc3RydWN0b3IobnVsbCk7fSxwdXNoOnB1c2gsc29ydDpkZWxldGVkSWRzLnNvcnQsc3BsaWNlOmRlbGV0ZWRJZHMuc3BsaWNlfTtqUXVlcnkuZXh0ZW5kPWpRdWVyeS5mbi5leHRlbmQ9ZnVuY3Rpb24oKXt2YXIgc3JjLGNvcHlJc0FycmF5LGNvcHksbmFtZSxvcHRpb25zLGNsb25lLHRhcmdldD1hcmd1bWVudHNbMF18fHt9LGk9MSxsZW5ndGg9YXJndW1lbnRzLmxlbmd0aCxkZWVwPWZhbHNlO2lmKHR5cGVvZiB0YXJnZXQ9PT0iYm9vbGVhbiIpe2RlZXA9dGFyZ2V0O3RhcmdldD1hcmd1bWVudHNbaV18fHt9O2krKzt9CmlmKHR5cGVvZiB0YXJnZXQhPT0ib2JqZWN0IiYmIWpRdWVyeS5pc0Z1bmN0aW9uKHRhcmdldCkpe3RhcmdldD17fTt9CmlmKGk9PT1sZW5ndGgpe3RhcmdldD10aGlzO2ktLTt9CmZvcig7aTxsZW5ndGg7aSsrKXtpZigob3B0aW9ucz1hcmd1bWVudHNbaV0pIT1udWxsKXtmb3IobmFtZSBpbiBvcHRpb25zKXtzcmM9dGFyZ2V0W25hbWVdO2NvcHk9b3B0aW9uc1tuYW1lXTtpZih0YXJnZXQ9PT1jb3B5KXtjb250aW51ZTt9CmlmKGRlZXAmJmNvcHkmJihqUXVlcnkuaXNQbGFpbk9iamVjdChjb3B5KXx8KGNvcHlJc0FycmF5PWpRdWVyeS5pc0FycmF5KGNvcHkpKSkpe2lmKGNvcHlJc0FycmF5KXtjb3B5SXNBcnJheT1mYWxzZTtjbG9uZT1zcmMmJmpRdWVyeS5pc0FycmF5KHNyYyk/c3JjOltdO31lbHNle2Nsb25lPXNyYyYmalF1ZXJ5LmlzUGxhaW5PYmplY3Qoc3JjKT9zcmM6e307fQp0YXJnZXRbbmFtZV09alF1ZXJ5LmV4dGVuZChkZWVwLGNsb25lLGNvcHkpO31lbHNlIGlmKGNvcHkhPT11bmRlZmluZWQpe3RhcmdldFtuYW1lXT1jb3B5O319fX0KcmV0dXJuIHRhcmdldDt9O2pRdWVyeS5leHRlbmQoe2V4cGFuZG86ImpRdWVyeSIrKHZlcnNpb24rTWF0aC5yYW5kb20oKSkucmVwbGFjZSgvXEQvZywiIiksaXNSZWFkeTp0cnVlLGVycm9yOmZ1bmN0aW9uKG1zZyl7dGhyb3cgbmV3IEVycm9yKG1zZyk7fSxub29wOmZ1bmN0aW9uKCl7fSxpc0Z1bmN0aW9uOmZ1bmN0aW9uKG9iail7cmV0dXJuIGpRdWVyeS50eXBlKG9iaik9PT0iZnVuY3Rpb24iO30saXNBcnJheTpBcnJheS5pc0FycmF5fHxmdW5jdGlvbihvYmope3JldHVybiBqUXVlcnkudHlwZShvYmopPT09ImFycmF5Ijt9LGlzV2luZG93OmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iaiE9bnVsbCYmb2JqPT1vYmoud2luZG93O30saXNOdW1lcmljOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai1wYXJzZUZsb2F0KG9iaik+PTA7fSxpc0VtcHR5T2JqZWN0OmZ1bmN0aW9uKG9iail7dmFyIG5hbWU7Zm9yKG5hbWUgaW4gb2JqKXtyZXR1cm4gZmFsc2U7fQpyZXR1cm4gdHJ1ZTt9LGlzUGxhaW5PYmplY3Q6ZnVuY3Rpb24ob2JqKXt2YXIga2V5O2lmKCFvYmp8fGpRdWVyeS50eXBlKG9iaikhPT0ib2JqZWN0Inx8b2JqLm5vZGVUeXBlfHxqUXVlcnkuaXNXaW5kb3cob2JqKSl7cmV0dXJuIGZhbHNlO30KdHJ5e2lmKG9iai5jb25zdHJ1Y3RvciYmIWhhc093bi5jYWxsKG9iaiwiY29uc3RydWN0b3IiKSYmIWhhc093bi5jYWxsKG9iai5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsImlzUHJvdG90eXBlT2YiKSl7cmV0dXJuIGZhbHNlO319Y2F0Y2goZSl7cmV0dXJuIGZhbHNlO30KaWYoc3VwcG9ydC5vd25MYXN0KXtmb3Ioa2V5IGluIG9iail7cmV0dXJuIGhhc093bi5jYWxsKG9iaixrZXkpO319CmZvcihrZXkgaW4gb2JqKXt9CnJldHVybiBrZXk9PT11bmRlZmluZWR8fGhhc093bi5jYWxsKG9iaixrZXkpO30sdHlwZTpmdW5jdGlvbihvYmope2lmKG9iaj09bnVsbCl7cmV0dXJuIG9iaisiIjt9CnJldHVybiB0eXBlb2Ygb2JqPT09Im9iamVjdCJ8fHR5cGVvZiBvYmo9PT0iZnVuY3Rpb24iP2NsYXNzMnR5cGVbdG9TdHJpbmcuY2FsbChvYmopXXx8Im9iamVjdCI6dHlwZW9mIG9iajt9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oZGF0YSl7aWYoZGF0YSYmalF1ZXJ5LnRyaW0oZGF0YSkpeyh3aW5kb3cuZXhlY1NjcmlwdHx8ZnVuY3Rpb24oZGF0YSl7d2luZG93WyJldmFsIl0uY2FsbCh3aW5kb3csZGF0YSk7fSkoZGF0YSk7fX0sY2FtZWxDYXNlOmZ1bmN0aW9uKHN0cmluZyl7cmV0dXJuIHN0cmluZy5yZXBsYWNlKHJtc1ByZWZpeCwibXMtIikucmVwbGFjZShyZGFzaEFscGhhLGZjYW1lbENhc2UpO30sbm9kZU5hbWU6ZnVuY3Rpb24oZWxlbSxuYW1lKXtyZXR1cm4gZWxlbS5ub2RlTmFtZSYmZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09bmFtZS50b0xvd2VyQ2FzZSgpO30sZWFjaDpmdW5jdGlvbihvYmosY2FsbGJhY2ssYXJncyl7dmFyIHZhbHVlLGk9MCxsZW5ndGg9b2JqLmxlbmd0aCxpc0FycmF5PWlzQXJyYXlsaWtlKG9iaik7aWYoYXJncyl7aWYoaXNBcnJheSl7Zm9yKDtpPGxlbmd0aDtpKyspe3ZhbHVlPWNhbGxiYWNrLmFwcGx5KG9ialtpXSxhcmdzKTtpZih2YWx1ZT09PWZhbHNlKXticmVhazt9fX1lbHNle2ZvcihpIGluIG9iail7dmFsdWU9Y2FsbGJhY2suYXBwbHkob2JqW2ldLGFyZ3MpO2lmKHZhbHVlPT09ZmFsc2Upe2JyZWFrO319fX1lbHNle2lmKGlzQXJyYXkpe2Zvcig7aTxsZW5ndGg7aSsrKXt2YWx1ZT1jYWxsYmFjay5jYWxsKG9ialtpXSxpLG9ialtpXSk7aWYodmFsdWU9PT1mYWxzZSl7YnJlYWs7fX19ZWxzZXtmb3IoaSBpbiBvYmope3ZhbHVlPWNhbGxiYWNrLmNhbGwob2JqW2ldLGksb2JqW2ldKTtpZih2YWx1ZT09PWZhbHNlKXticmVhazt9fX19CnJldHVybiBvYmo7fSx0cmltOnRyaW0mJiF0cmltLmNhbGwoIlx1RkVGRlx4QTAiKT9mdW5jdGlvbih0ZXh0KXtyZXR1cm4gdGV4dD09bnVsbD8iIjp0cmltLmNhbGwodGV4dCk7fTpmdW5jdGlvbih0ZXh0KXtyZXR1cm4gdGV4dD09bnVsbD8iIjoodGV4dCsiIikucmVwbGFjZShydHJpbSwiIik7fSxtYWtlQXJyYXk6ZnVuY3Rpb24oYXJyLHJlc3VsdHMpe3ZhciByZXQ9cmVzdWx0c3x8W107aWYoYXJyIT1udWxsKXtpZihpc0FycmF5bGlrZShPYmplY3QoYXJyKSkpe2pRdWVyeS5tZXJnZShyZXQsdHlwZW9mIGFycj09PSJzdHJpbmciP1thcnJdOmFycik7fWVsc2V7cHVzaC5jYWxsKHJldCxhcnIpO319CnJldHVybiByZXQ7fSxpbkFycmF5OmZ1bmN0aW9uKGVsZW0sYXJyLGkpe3ZhciBsZW47aWYoYXJyKXtpZihpbmRleE9mKXtyZXR1cm4gaW5kZXhPZi5jYWxsKGFycixlbGVtLGkpO30KbGVuPWFyci5sZW5ndGg7aT1pP2k8MD9NYXRoLm1heCgwLGxlbitpKTppOjA7Zm9yKDtpPGxlbjtpKyspe2lmKGkgaW4gYXJyJiZhcnJbaV09PT1lbGVtKXtyZXR1cm4gaTt9fX0KcmV0dXJuLTE7fSxtZXJnZTpmdW5jdGlvbihmaXJzdCxzZWNvbmQpe3ZhciBsZW49K3NlY29uZC5sZW5ndGgsaj0wLGk9Zmlyc3QubGVuZ3RoO3doaWxlKGo8bGVuKXtmaXJzdFtpKytdPXNlY29uZFtqKytdO30KaWYobGVuIT09bGVuKXt3aGlsZShzZWNvbmRbal0hPT11bmRlZmluZWQpe2ZpcnN0W2krK109c2Vjb25kW2orK107fX0KZmlyc3QubGVuZ3RoPWk7cmV0dXJuIGZpcnN0O30sZ3JlcDpmdW5jdGlvbihlbGVtcyxjYWxsYmFjayxpbnZlcnQpe3ZhciBjYWxsYmFja0ludmVyc2UsbWF0Y2hlcz1bXSxpPTAsbGVuZ3RoPWVsZW1zLmxlbmd0aCxjYWxsYmFja0V4cGVjdD0haW52ZXJ0O2Zvcig7aTxsZW5ndGg7aSsrKXtjYWxsYmFja0ludmVyc2U9IWNhbGxiYWNrKGVsZW1zW2ldLGkpO2lmKGNhbGxiYWNrSW52ZXJzZSE9PWNhbGxiYWNrRXhwZWN0KXttYXRjaGVzLnB1c2goZWxlbXNbaV0pO319CnJldHVybiBtYXRjaGVzO30sbWFwOmZ1bmN0aW9uKGVsZW1zLGNhbGxiYWNrLGFyZyl7dmFyIHZhbHVlLGk9MCxsZW5ndGg9ZWxlbXMubGVuZ3RoLGlzQXJyYXk9aXNBcnJheWxpa2UoZWxlbXMpLHJldD1bXTtpZihpc0FycmF5KXtmb3IoO2k8bGVuZ3RoO2krKyl7dmFsdWU9Y2FsbGJhY2soZWxlbXNbaV0saSxhcmcpO2lmKHZhbHVlIT1udWxsKXtyZXQucHVzaCh2YWx1ZSk7fX19ZWxzZXtmb3IoaSBpbiBlbGVtcyl7dmFsdWU9Y2FsbGJhY2soZWxlbXNbaV0saSxhcmcpO2lmKHZhbHVlIT1udWxsKXtyZXQucHVzaCh2YWx1ZSk7fX19CnJldHVybiBjb25jYXQuYXBwbHkoW10scmV0KTt9LGd1aWQ6MSxwcm94eTpmdW5jdGlvbihmbixjb250ZXh0KXt2YXIgYXJncyxwcm94eSx0bXA7aWYodHlwZW9mIGNvbnRleHQ9PT0ic3RyaW5nIil7dG1wPWZuW2NvbnRleHRdO2NvbnRleHQ9Zm47Zm49dG1wO30KaWYoIWpRdWVyeS5pc0Z1bmN0aW9uKGZuKSl7cmV0dXJuIHVuZGVmaW5lZDt9CmFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMsMik7cHJveHk9ZnVuY3Rpb24oKXtyZXR1cm4gZm4uYXBwbHkoY29udGV4dHx8dGhpcyxhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTt9O3Byb3h5Lmd1aWQ9Zm4uZ3VpZD1mbi5ndWlkfHxqUXVlcnkuZ3VpZCsrO3JldHVybiBwcm94eTt9LG5vdzpmdW5jdGlvbigpe3JldHVybisobmV3IERhdGUoKSk7fSxzdXBwb3J0OnN1cHBvcnR9KTtqUXVlcnkuZWFjaCgiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvciIuc3BsaXQoIiAiKSxmdW5jdGlvbihpLG5hbWUpe2NsYXNzMnR5cGVbIltvYmplY3QgIituYW1lKyJdIl09bmFtZS50b0xvd2VyQ2FzZSgpO30pO2Z1bmN0aW9uIGlzQXJyYXlsaWtlKG9iail7dmFyIGxlbmd0aD1vYmoubGVuZ3RoLHR5cGU9alF1ZXJ5LnR5cGUob2JqKTtpZih0eXBlPT09ImZ1bmN0aW9uInx8alF1ZXJ5LmlzV2luZG93KG9iaikpe3JldHVybiBmYWxzZTt9CmlmKG9iai5ub2RlVHlwZT09PTEmJmxlbmd0aCl7cmV0dXJuIHRydWU7fQpyZXR1cm4gdHlwZT09PSJhcnJheSJ8fGxlbmd0aD09PTB8fHR5cGVvZiBsZW5ndGg9PT0ibnVtYmVyIiYmbGVuZ3RoPjAmJihsZW5ndGgtMSlpbiBvYmo7fQp2YXIgU2l6emxlPShmdW5jdGlvbih3aW5kb3cpe3ZhciBpLHN1cHBvcnQsRXhwcixnZXRUZXh0LGlzWE1MLGNvbXBpbGUsb3V0ZXJtb3N0Q29udGV4dCxzb3J0SW5wdXQsaGFzRHVwbGljYXRlLHNldERvY3VtZW50LGRvY3VtZW50LGRvY0VsZW0sZG9jdW1lbnRJc0hUTUwscmJ1Z2d5UVNBLHJidWdneU1hdGNoZXMsbWF0Y2hlcyxjb250YWlucyxleHBhbmRvPSJzaXp6bGUiKy0obmV3IERhdGUoKSkscHJlZmVycmVkRG9jPXdpbmRvdy5kb2N1bWVudCxkaXJydW5zPTAsZG9uZT0wLGNsYXNzQ2FjaGU9Y3JlYXRlQ2FjaGUoKSx0b2tlbkNhY2hlPWNyZWF0ZUNhY2hlKCksY29tcGlsZXJDYWNoZT1jcmVhdGVDYWNoZSgpLHNvcnRPcmRlcj1mdW5jdGlvbihhLGIpe2lmKGE9PT1iKXtoYXNEdXBsaWNhdGU9dHJ1ZTt9CnJldHVybiAwO30sc3RydW5kZWZpbmVkPXR5cGVvZiB1bmRlZmluZWQsTUFYX05FR0FUSVZFPTE8PDMxLGhhc093bj0oe30pLmhhc093blByb3BlcnR5LGFycj1bXSxwb3A9YXJyLnBvcCxwdXNoX25hdGl2ZT1hcnIucHVzaCxwdXNoPWFyci5wdXNoLHNsaWNlPWFyci5zbGljZSxpbmRleE9mPWFyci5pbmRleE9mfHxmdW5jdGlvbihlbGVtKXt2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDtmb3IoO2k8bGVuO2krKyl7aWYodGhpc1tpXT09PWVsZW0pe3JldHVybiBpO319CnJldHVybi0xO30sYm9vbGVhbnM9ImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxpc21hcHxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkIix3aGl0ZXNwYWNlPSJbXFx4MjBcXHRcXHJcXG5cXGZdIixjaGFyYWN0ZXJFbmNvZGluZz0iKD86XFxcXC58W1xcdy1dfFteXFx4MDAtXFx4YTBdKSsiLGlkZW50aWZpZXI9Y2hhcmFjdGVyRW5jb2RpbmcucmVwbGFjZSgidyIsIncjIiksYXR0cmlidXRlcz0iXFxbIit3aGl0ZXNwYWNlKyIqKCIrY2hhcmFjdGVyRW5jb2RpbmcrIikiK3doaXRlc3BhY2UrIiooPzooWypeJHwhfl0/PSkiK3doaXRlc3BhY2UrIiooPzooWydcIl0pKCg/OlxcXFwufFteXFxcXF0pKj8pXFwzfCgiK2lkZW50aWZpZXIrIil8KXwpIit3aGl0ZXNwYWNlKyIqXFxdIixwc2V1ZG9zPSI6KCIrY2hhcmFjdGVyRW5jb2RpbmcrIikoPzpcXCgoKFsnXCJdKSgoPzpcXFxcLnxbXlxcXFxdKSo/KVxcM3woKD86XFxcXC58W15cXFxcKClbXFxdXXwiK2F0dHJpYnV0ZXMucmVwbGFjZSgzLDgpKyIpKil8LiopXFwpfCkiLHJ0cmltPW5ldyBSZWdFeHAoIl4iK3doaXRlc3BhY2UrIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIrd2hpdGVzcGFjZSsiKyQiLCJnIikscmNvbW1hPW5ldyBSZWdFeHAoIl4iK3doaXRlc3BhY2UrIiosIit3aGl0ZXNwYWNlKyIqIikscmNvbWJpbmF0b3JzPW5ldyBSZWdFeHAoIl4iK3doaXRlc3BhY2UrIiooWz4rfl18Iit3aGl0ZXNwYWNlKyIpIit3aGl0ZXNwYWNlKyIqIikscmF0dHJpYnV0ZVF1b3Rlcz1uZXcgUmVnRXhwKCI9Iit3aGl0ZXNwYWNlKyIqKFteXFxdJ1wiXSo/KSIrd2hpdGVzcGFjZSsiKlxcXSIsImciKSxycHNldWRvPW5ldyBSZWdFeHAocHNldWRvcykscmlkZW50aWZpZXI9bmV3IFJlZ0V4cCgiXiIraWRlbnRpZmllcisiJCIpLG1hdGNoRXhwcj17IklEIjpuZXcgUmVnRXhwKCJeIygiK2NoYXJhY3RlckVuY29kaW5nKyIpIiksIkNMQVNTIjpuZXcgUmVnRXhwKCJeXFwuKCIrY2hhcmFjdGVyRW5jb2RpbmcrIikiKSwiVEFHIjpuZXcgUmVnRXhwKCJeKCIrY2hhcmFjdGVyRW5jb2RpbmcucmVwbGFjZSgidyIsIncqIikrIikiKSwiQVRUUiI6bmV3IFJlZ0V4cCgiXiIrYXR0cmlidXRlcyksIlBTRVVETyI6bmV3IFJlZ0V4cCgiXiIrcHNldWRvcyksIkNISUxEIjpuZXcgUmVnRXhwKCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXCgiK3doaXRlc3BhY2UrIiooZXZlbnxvZGR8KChbKy1dfCkoXFxkKilufCkiK3doaXRlc3BhY2UrIiooPzooWystXXwpIit3aGl0ZXNwYWNlKyIqKFxcZCspfCkpIit3aGl0ZXNwYWNlKyIqXFwpfCkiLCJpIiksImJvb2wiOm5ldyBSZWdFeHAoIl4oPzoiK2Jvb2xlYW5zKyIpJCIsImkiKSwibmVlZHNDb250ZXh0IjpuZXcgUmVnRXhwKCJeIit3aGl0ZXNwYWNlKyIqWz4rfl18OihldmVufG9kZHxlcXxndHxsdHxudGh8Zmlyc3R8bGFzdCkoPzpcXCgiKwp3aGl0ZXNwYWNlKyIqKCg/Oi1cXGQpP1xcZCopIit3aGl0ZXNwYWNlKyIqXFwpfCkoPz1bXi1dfCQpIiwiaSIpfSxyaW5wdXRzPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2kscmhlYWRlcj0vXmhcZCQvaSxybmF0aXZlPS9eW157XStce1xzKlxbbmF0aXZlIFx3LyxycXVpY2tFeHByPS9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8scnNpYmxpbmc9L1srfl0vLHJlc2NhcGU9Lyd8XFwvZyxydW5lc2NhcGU9bmV3IFJlZ0V4cCgiXFxcXChbXFxkYS1mXXsxLDZ9Iit3aGl0ZXNwYWNlKyI/fCgiK3doaXRlc3BhY2UrIil8LikiLCJpZyIpLGZ1bmVzY2FwZT1mdW5jdGlvbihfLGVzY2FwZWQsZXNjYXBlZFdoaXRlc3BhY2Upe3ZhciBoaWdoPSIweCIrZXNjYXBlZC0weDEwMDAwO3JldHVybiBoaWdoIT09aGlnaHx8ZXNjYXBlZFdoaXRlc3BhY2U/ZXNjYXBlZDpoaWdoPDA/U3RyaW5nLmZyb21DaGFyQ29kZShoaWdoKzB4MTAwMDApOlN0cmluZy5mcm9tQ2hhckNvZGUoaGlnaD4+MTB8MHhEODAwLGhpZ2gmMHgzRkZ8MHhEQzAwKTt9O3RyeXtwdXNoLmFwcGx5KChhcnI9c2xpY2UuY2FsbChwcmVmZXJyZWREb2MuY2hpbGROb2RlcykpLHByZWZlcnJlZERvYy5jaGlsZE5vZGVzKTthcnJbcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMubGVuZ3RoXS5ub2RlVHlwZTt9Y2F0Y2goZSl7cHVzaD17YXBwbHk6YXJyLmxlbmd0aD9mdW5jdGlvbih0YXJnZXQsZWxzKXtwdXNoX25hdGl2ZS5hcHBseSh0YXJnZXQsc2xpY2UuY2FsbChlbHMpKTt9OmZ1bmN0aW9uKHRhcmdldCxlbHMpe3ZhciBqPXRhcmdldC5sZW5ndGgsaT0wO3doaWxlKCh0YXJnZXRbaisrXT1lbHNbaSsrXSkpe30KdGFyZ2V0Lmxlbmd0aD1qLTE7fX07fQpmdW5jdGlvbiBTaXp6bGUoc2VsZWN0b3IsY29udGV4dCxyZXN1bHRzLHNlZWQpe3ZhciBtYXRjaCxlbGVtLG0sbm9kZVR5cGUsaSxncm91cHMsb2xkLG5pZCxuZXdDb250ZXh0LG5ld1NlbGVjdG9yO2lmKChjb250ZXh0P2NvbnRleHQub3duZXJEb2N1bWVudHx8Y29udGV4dDpwcmVmZXJyZWREb2MpIT09ZG9jdW1lbnQpe3NldERvY3VtZW50KGNvbnRleHQpO30KY29udGV4dD1jb250ZXh0fHxkb2N1bWVudDtyZXN1bHRzPXJlc3VsdHN8fFtdO2lmKCFzZWxlY3Rvcnx8dHlwZW9mIHNlbGVjdG9yIT09InN0cmluZyIpe3JldHVybiByZXN1bHRzO30KaWYoKG5vZGVUeXBlPWNvbnRleHQubm9kZVR5cGUpIT09MSYmbm9kZVR5cGUhPT05KXtyZXR1cm5bXTt9CmlmKGRvY3VtZW50SXNIVE1MJiYhc2VlZCl7aWYoKG1hdGNoPXJxdWlja0V4cHIuZXhlYyhzZWxlY3RvcikpKXtpZigobT1tYXRjaFsxXSkpe2lmKG5vZGVUeXBlPT09OSl7ZWxlbT1jb250ZXh0LmdldEVsZW1lbnRCeUlkKG0pO2lmKGVsZW0mJmVsZW0ucGFyZW50Tm9kZSl7aWYoZWxlbS5pZD09PW0pe3Jlc3VsdHMucHVzaChlbGVtKTtyZXR1cm4gcmVzdWx0czt9fWVsc2V7cmV0dXJuIHJlc3VsdHM7fX1lbHNle2lmKGNvbnRleHQub3duZXJEb2N1bWVudCYmKGVsZW09Y29udGV4dC5vd25lckRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG0pKSYmY29udGFpbnMoY29udGV4dCxlbGVtKSYmZWxlbS5pZD09PW0pe3Jlc3VsdHMucHVzaChlbGVtKTtyZXR1cm4gcmVzdWx0czt9fX1lbHNlIGlmKG1hdGNoWzJdKXtwdXNoLmFwcGx5KHJlc3VsdHMsY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZShzZWxlY3RvcikpO3JldHVybiByZXN1bHRzO31lbHNlIGlmKChtPW1hdGNoWzNdKSYmc3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUpe3B1c2guYXBwbHkocmVzdWx0cyxjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUobSkpO3JldHVybiByZXN1bHRzO319CmlmKHN1cHBvcnQucXNhJiYoIXJidWdneVFTQXx8IXJidWdneVFTQS50ZXN0KHNlbGVjdG9yKSkpe25pZD1vbGQ9ZXhwYW5kbztuZXdDb250ZXh0PWNvbnRleHQ7bmV3U2VsZWN0b3I9bm9kZVR5cGU9PT05JiZzZWxlY3RvcjtpZihub2RlVHlwZT09PTEmJmNvbnRleHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSE9PSJvYmplY3QiKXtncm91cHM9dG9rZW5pemUoc2VsZWN0b3IpO2lmKChvbGQ9Y29udGV4dC5nZXRBdHRyaWJ1dGUoImlkIikpKXtuaWQ9b2xkLnJlcGxhY2UocmVzY2FwZSwiXFwkJiIpO31lbHNle2NvbnRleHQuc2V0QXR0cmlidXRlKCJpZCIsbmlkKTt9Cm5pZD0iW2lkPSciK25pZCsiJ10gIjtpPWdyb3Vwcy5sZW5ndGg7d2hpbGUoaS0tKXtncm91cHNbaV09bmlkK3RvU2VsZWN0b3IoZ3JvdXBzW2ldKTt9Cm5ld0NvbnRleHQ9cnNpYmxpbmcudGVzdChzZWxlY3RvcikmJnRlc3RDb250ZXh0KGNvbnRleHQucGFyZW50Tm9kZSl8fGNvbnRleHQ7bmV3U2VsZWN0b3I9Z3JvdXBzLmpvaW4oIiwiKTt9CmlmKG5ld1NlbGVjdG9yKXt0cnl7cHVzaC5hcHBseShyZXN1bHRzLG5ld0NvbnRleHQucXVlcnlTZWxlY3RvckFsbChuZXdTZWxlY3RvcikpO3JldHVybiByZXN1bHRzO31jYXRjaChxc2FFcnJvcil7fWZpbmFsbHl7aWYoIW9sZCl7Y29udGV4dC5yZW1vdmVBdHRyaWJ1dGUoImlkIik7fX19fX0KcmV0dXJuIHNlbGVjdChzZWxlY3Rvci5yZXBsYWNlKHJ0cmltLCIkMSIpLGNvbnRleHQscmVzdWx0cyxzZWVkKTt9CmZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCl7dmFyIGtleXM9W107ZnVuY3Rpb24gY2FjaGUoa2V5LHZhbHVlKXtpZihrZXlzLnB1c2goa2V5KyIgIik+RXhwci5jYWNoZUxlbmd0aCl7ZGVsZXRlIGNhY2hlW2tleXMuc2hpZnQoKV07fQpyZXR1cm4oY2FjaGVba2V5KyIgIl09dmFsdWUpO30KcmV0dXJuIGNhY2hlO30KZnVuY3Rpb24gbWFya0Z1bmN0aW9uKGZuKXtmbltleHBhbmRvXT10cnVlO3JldHVybiBmbjt9CmZ1bmN0aW9uIGFzc2VydChmbil7dmFyIGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTt0cnl7cmV0dXJuISFmbihkaXYpO31jYXRjaChlKXtyZXR1cm4gZmFsc2U7fWZpbmFsbHl7aWYoZGl2LnBhcmVudE5vZGUpe2Rpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRpdik7fQpkaXY9bnVsbDt9fQpmdW5jdGlvbiBhZGRIYW5kbGUoYXR0cnMsaGFuZGxlcil7dmFyIGFycj1hdHRycy5zcGxpdCgifCIpLGk9YXR0cnMubGVuZ3RoO3doaWxlKGktLSl7RXhwci5hdHRySGFuZGxlW2FycltpXV09aGFuZGxlcjt9fQpmdW5jdGlvbiBzaWJsaW5nQ2hlY2soYSxiKXt2YXIgY3VyPWImJmEsZGlmZj1jdXImJmEubm9kZVR5cGU9PT0xJiZiLm5vZGVUeXBlPT09MSYmKH5iLnNvdXJjZUluZGV4fHxNQVhfTkVHQVRJVkUpLQoofmEuc291cmNlSW5kZXh8fE1BWF9ORUdBVElWRSk7aWYoZGlmZil7cmV0dXJuIGRpZmY7fQppZihjdXIpe3doaWxlKChjdXI9Y3VyLm5leHRTaWJsaW5nKSl7aWYoY3VyPT09Yil7cmV0dXJuLTE7fX19CnJldHVybiBhPzE6LTE7fQpmdW5jdGlvbiBjcmVhdGVJbnB1dFBzZXVkbyh0eXBlKXtyZXR1cm4gZnVuY3Rpb24oZWxlbSl7dmFyIG5hbWU9ZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybiBuYW1lPT09ImlucHV0IiYmZWxlbS50eXBlPT09dHlwZTt9O30KZnVuY3Rpb24gY3JlYXRlQnV0dG9uUHNldWRvKHR5cGUpe3JldHVybiBmdW5jdGlvbihlbGVtKXt2YXIgbmFtZT1lbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKG5hbWU9PT0iaW5wdXQifHxuYW1lPT09ImJ1dHRvbiIpJiZlbGVtLnR5cGU9PT10eXBlO307fQpmdW5jdGlvbiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZuKXtyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKGFyZ3VtZW50KXthcmd1bWVudD0rYXJndW1lbnQ7cmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbihzZWVkLG1hdGNoZXMpe3ZhciBqLG1hdGNoSW5kZXhlcz1mbihbXSxzZWVkLmxlbmd0aCxhcmd1bWVudCksaT1tYXRjaEluZGV4ZXMubGVuZ3RoO3doaWxlKGktLSl7aWYoc2VlZFsoaj1tYXRjaEluZGV4ZXNbaV0pXSl7c2VlZFtqXT0hKG1hdGNoZXNbal09c2VlZFtqXSk7fX19KTt9KTt9CmZ1bmN0aW9uIHRlc3RDb250ZXh0KGNvbnRleHQpe3JldHVybiBjb250ZXh0JiZ0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSE9PXN0cnVuZGVmaW5lZCYmY29udGV4dDt9CnN1cHBvcnQ9U2l6emxlLnN1cHBvcnQ9e307aXNYTUw9U2l6emxlLmlzWE1MPWZ1bmN0aW9uKGVsZW0pe3ZhciBkb2N1bWVudEVsZW1lbnQ9ZWxlbSYmKGVsZW0ub3duZXJEb2N1bWVudHx8ZWxlbSkuZG9jdW1lbnRFbGVtZW50O3JldHVybiBkb2N1bWVudEVsZW1lbnQ/ZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lIT09IkhUTUwiOmZhbHNlO307c2V0RG9jdW1lbnQ9U2l6emxlLnNldERvY3VtZW50PWZ1bmN0aW9uKG5vZGUpe3ZhciBoYXNDb21wYXJlLGRvYz1ub2RlP25vZGUub3duZXJEb2N1bWVudHx8bm9kZTpwcmVmZXJyZWREb2MscGFyZW50PWRvYy5kZWZhdWx0VmlldztpZihkb2M9PT1kb2N1bWVudHx8ZG9jLm5vZGVUeXBlIT09OXx8IWRvYy5kb2N1bWVudEVsZW1lbnQpe3JldHVybiBkb2N1bWVudDt9CmRvY3VtZW50PWRvYztkb2NFbGVtPWRvYy5kb2N1bWVudEVsZW1lbnQ7ZG9jdW1lbnRJc0hUTUw9IWlzWE1MKGRvYyk7aWYocGFyZW50JiZwYXJlbnQhPT1wYXJlbnQudG9wKXtpZihwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcil7cGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoInVubG9hZCIsZnVuY3Rpb24oKXtzZXREb2N1bWVudCgpO30sZmFsc2UpO31lbHNlIGlmKHBhcmVudC5hdHRhY2hFdmVudCl7cGFyZW50LmF0dGFjaEV2ZW50KCJvbnVubG9hZCIsZnVuY3Rpb24oKXtzZXREb2N1bWVudCgpO30pO319CnN1cHBvcnQuYXR0cmlidXRlcz1hc3NlcnQoZnVuY3Rpb24oZGl2KXtkaXYuY2xhc3NOYW1lPSJpIjtyZXR1cm4hZGl2LmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIik7fSk7c3VwcG9ydC5nZXRFbGVtZW50c0J5VGFnTmFtZT1hc3NlcnQoZnVuY3Rpb24oZGl2KXtkaXYuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZUNvbW1lbnQoIiIpKTtyZXR1cm4hZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RoO30pO3N1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT1ybmF0aXZlLnRlc3QoZG9jLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpJiZhc3NlcnQoZnVuY3Rpb24oZGl2KXtkaXYuaW5uZXJIVE1MPSI8ZGl2IGNsYXNzPSdhJz48L2Rpdj48ZGl2IGNsYXNzPSdhIGknPjwvZGl2PiI7ZGl2LmZpcnN0Q2hpbGQuY2xhc3NOYW1lPSJpIjtyZXR1cm4gZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImkiKS5sZW5ndGg9PT0yO30pO3N1cHBvcnQuZ2V0QnlJZD1hc3NlcnQoZnVuY3Rpb24oZGl2KXtkb2NFbGVtLmFwcGVuZENoaWxkKGRpdikuaWQ9ZXhwYW5kbztyZXR1cm4hZG9jLmdldEVsZW1lbnRzQnlOYW1lfHwhZG9jLmdldEVsZW1lbnRzQnlOYW1lKGV4cGFuZG8pLmxlbmd0aDt9KTtpZihzdXBwb3J0LmdldEJ5SWQpe0V4cHIuZmluZFsiSUQiXT1mdW5jdGlvbihpZCxjb250ZXh0KXtpZih0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50QnlJZCE9PXN0cnVuZGVmaW5lZCYmZG9jdW1lbnRJc0hUTUwpe3ZhciBtPWNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoaWQpO3JldHVybiBtJiZtLnBhcmVudE5vZGU/W21dOltdO319O0V4cHIuZmlsdGVyWyJJRCJdPWZ1bmN0aW9uKGlkKXt2YXIgYXR0cklkPWlkLnJlcGxhY2UocnVuZXNjYXBlLGZ1bmVzY2FwZSk7cmV0dXJuIGZ1bmN0aW9uKGVsZW0pe3JldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgiaWQiKT09PWF0dHJJZDt9O307fWVsc2V7ZGVsZXRlIEV4cHIuZmluZFsiSUQiXTtFeHByLmZpbHRlclsiSUQiXT1mdW5jdGlvbihpZCl7dmFyIGF0dHJJZD1pZC5yZXBsYWNlKHJ1bmVzY2FwZSxmdW5lc2NhcGUpO3JldHVybiBmdW5jdGlvbihlbGVtKXt2YXIgbm9kZT10eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlIT09c3RydW5kZWZpbmVkJiZlbGVtLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7cmV0dXJuIG5vZGUmJm5vZGUudmFsdWU9PT1hdHRySWQ7fTt9O30KRXhwci5maW5kWyJUQUciXT1zdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lP2Z1bmN0aW9uKHRhZyxjb250ZXh0KXtpZih0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSE9PXN0cnVuZGVmaW5lZCl7cmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnKTt9fTpmdW5jdGlvbih0YWcsY29udGV4dCl7dmFyIGVsZW0sdG1wPVtdLGk9MCxyZXN1bHRzPWNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnKTtpZih0YWc9PT0iKiIpe3doaWxlKChlbGVtPXJlc3VsdHNbaSsrXSkpe2lmKGVsZW0ubm9kZVR5cGU9PT0xKXt0bXAucHVzaChlbGVtKTt9fQpyZXR1cm4gdG1wO30KcmV0dXJuIHJlc3VsdHM7fTtFeHByLmZpbmRbIkNMQVNTIl09c3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZmdW5jdGlvbihjbGFzc05hbWUsY29udGV4dCl7aWYodHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSE9PXN0cnVuZGVmaW5lZCYmZG9jdW1lbnRJc0hUTUwpe3JldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoY2xhc3NOYW1lKTt9fTtyYnVnZ3lNYXRjaGVzPVtdO3JidWdneVFTQT1bXTtpZigoc3VwcG9ydC5xc2E9cm5hdGl2ZS50ZXN0KGRvYy5xdWVyeVNlbGVjdG9yQWxsKSkpe2Fzc2VydChmdW5jdGlvbihkaXYpe2Rpdi5pbm5lckhUTUw9IjxzZWxlY3QgdD0nJz48b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PiI7aWYoZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIlt0Xj0nJ10iKS5sZW5ndGgpe3JidWdneVFTQS5wdXNoKCJbKl4kXT0iK3doaXRlc3BhY2UrIiooPzonJ3xcIlwiKSIpO30KaWYoIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RoKXtyYnVnZ3lRU0EucHVzaCgiXFxbIit3aGl0ZXNwYWNlKyIqKD86dmFsdWV8Iitib29sZWFucysiKSIpO30KaWYoIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aCl7cmJ1Z2d5UVNBLnB1c2goIjpjaGVja2VkIik7fX0pO2Fzc2VydChmdW5jdGlvbihkaXYpe3ZhciBpbnB1dD1kb2MuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTtpbnB1dC5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKTtkaXYuYXBwZW5kQ2hpbGQoaW5wdXQpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKTtpZihkaXYucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9ZF0iKS5sZW5ndGgpe3JidWdneVFTQS5wdXNoKCJuYW1lIit3aGl0ZXNwYWNlKyIqWypeJHwhfl0/PSIpO30KaWYoIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aCl7cmJ1Z2d5UVNBLnB1c2goIjplbmFibGVkIiwiOmRpc2FibGVkIik7fQpkaXYucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpO3JidWdneVFTQS5wdXNoKCIsLio6Iik7fSk7fQppZigoc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3I9cm5hdGl2ZS50ZXN0KChtYXRjaGVzPWRvY0VsZW0ud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxkb2NFbGVtLm1vek1hdGNoZXNTZWxlY3Rvcnx8ZG9jRWxlbS5vTWF0Y2hlc1NlbGVjdG9yfHxkb2NFbGVtLm1zTWF0Y2hlc1NlbGVjdG9yKSkpKXthc3NlcnQoZnVuY3Rpb24oZGl2KXtzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoPW1hdGNoZXMuY2FsbChkaXYsImRpdiIpO21hdGNoZXMuY2FsbChkaXYsIltzIT0nJ106eCIpO3JidWdneU1hdGNoZXMucHVzaCgiIT0iLHBzZXVkb3MpO30pO30KcmJ1Z2d5UVNBPXJidWdneVFTQS5sZW5ndGgmJm5ldyBSZWdFeHAocmJ1Z2d5UVNBLmpvaW4oInwiKSk7cmJ1Z2d5TWF0Y2hlcz1yYnVnZ3lNYXRjaGVzLmxlbmd0aCYmbmV3IFJlZ0V4cChyYnVnZ3lNYXRjaGVzLmpvaW4oInwiKSk7aGFzQ29tcGFyZT1ybmF0aXZlLnRlc3QoZG9jRWxlbS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbik7Y29udGFpbnM9aGFzQ29tcGFyZXx8cm5hdGl2ZS50ZXN0KGRvY0VsZW0uY29udGFpbnMpP2Z1bmN0aW9uKGEsYil7dmFyIGFkb3duPWEubm9kZVR5cGU9PT05P2EuZG9jdW1lbnRFbGVtZW50OmEsYnVwPWImJmIucGFyZW50Tm9kZTtyZXR1cm4gYT09PWJ1cHx8ISEoYnVwJiZidXAubm9kZVR5cGU9PT0xJiYoYWRvd24uY29udGFpbnM/YWRvd24uY29udGFpbnMoYnVwKTphLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiZhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGJ1cCkmMTYpKTt9OmZ1bmN0aW9uKGEsYil7aWYoYil7d2hpbGUoKGI9Yi5wYXJlbnROb2RlKSl7aWYoYj09PWEpe3JldHVybiB0cnVlO319fQpyZXR1cm4gZmFsc2U7fTtzb3J0T3JkZXI9aGFzQ29tcGFyZT9mdW5jdGlvbihhLGIpe2lmKGE9PT1iKXtoYXNEdXBsaWNhdGU9dHJ1ZTtyZXR1cm4gMDt9CnZhciBjb21wYXJlPSFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uLSFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO2lmKGNvbXBhcmUpe3JldHVybiBjb21wYXJlO30KY29tcGFyZT0oYS5vd25lckRvY3VtZW50fHxhKT09PShiLm93bmVyRG9jdW1lbnR8fGIpP2EuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYik6MTtpZihjb21wYXJlJjF8fCghc3VwcG9ydC5zb3J0RGV0YWNoZWQmJmIuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYSk9PT1jb21wYXJlKSl7aWYoYT09PWRvY3x8YS5vd25lckRvY3VtZW50PT09cHJlZmVycmVkRG9jJiZjb250YWlucyhwcmVmZXJyZWREb2MsYSkpe3JldHVybi0xO30KaWYoYj09PWRvY3x8Yi5vd25lckRvY3VtZW50PT09cHJlZmVycmVkRG9jJiZjb250YWlucyhwcmVmZXJyZWREb2MsYikpe3JldHVybiAxO30KcmV0dXJuIHNvcnRJbnB1dD8oaW5kZXhPZi5jYWxsKHNvcnRJbnB1dCxhKS1pbmRleE9mLmNhbGwoc29ydElucHV0LGIpKTowO30KcmV0dXJuIGNvbXBhcmUmND8tMToxO306ZnVuY3Rpb24oYSxiKXtpZihhPT09Yil7aGFzRHVwbGljYXRlPXRydWU7cmV0dXJuIDA7fQp2YXIgY3VyLGk9MCxhdXA9YS5wYXJlbnROb2RlLGJ1cD1iLnBhcmVudE5vZGUsYXA9W2FdLGJwPVtiXTtpZighYXVwfHwhYnVwKXtyZXR1cm4gYT09PWRvYz8tMTpiPT09ZG9jPzE6YXVwPy0xOmJ1cD8xOnNvcnRJbnB1dD8oaW5kZXhPZi5jYWxsKHNvcnRJbnB1dCxhKS1pbmRleE9mLmNhbGwoc29ydElucHV0LGIpKTowO31lbHNlIGlmKGF1cD09PWJ1cCl7cmV0dXJuIHNpYmxpbmdDaGVjayhhLGIpO30KY3VyPWE7d2hpbGUoKGN1cj1jdXIucGFyZW50Tm9kZSkpe2FwLnVuc2hpZnQoY3VyKTt9CmN1cj1iO3doaWxlKChjdXI9Y3VyLnBhcmVudE5vZGUpKXticC51bnNoaWZ0KGN1cik7fQp3aGlsZShhcFtpXT09PWJwW2ldKXtpKys7fQpyZXR1cm4gaT9zaWJsaW5nQ2hlY2soYXBbaV0sYnBbaV0pOmFwW2ldPT09cHJlZmVycmVkRG9jPy0xOmJwW2ldPT09cHJlZmVycmVkRG9jPzE6MDt9O3JldHVybiBkb2M7fTtTaXp6bGUubWF0Y2hlcz1mdW5jdGlvbihleHByLGVsZW1lbnRzKXtyZXR1cm4gU2l6emxlKGV4cHIsbnVsbCxudWxsLGVsZW1lbnRzKTt9O1NpenpsZS5tYXRjaGVzU2VsZWN0b3I9ZnVuY3Rpb24oZWxlbSxleHByKXtpZigoZWxlbS5vd25lckRvY3VtZW50fHxlbGVtKSE9PWRvY3VtZW50KXtzZXREb2N1bWVudChlbGVtKTt9CmV4cHI9ZXhwci5yZXBsYWNlKHJhdHRyaWJ1dGVRdW90ZXMsIj0nJDEnXSIpO2lmKHN1cHBvcnQubWF0Y2hlc1NlbGVjdG9yJiZkb2N1bWVudElzSFRNTCYmKCFyYnVnZ3lNYXRjaGVzfHwhcmJ1Z2d5TWF0Y2hlcy50ZXN0KGV4cHIpKSYmKCFyYnVnZ3lRU0F8fCFyYnVnZ3lRU0EudGVzdChleHByKSkpe3RyeXt2YXIgcmV0PW1hdGNoZXMuY2FsbChlbGVtLGV4cHIpO2lmKHJldHx8c3VwcG9ydC5kaXNjb25uZWN0ZWRNYXRjaHx8ZWxlbS5kb2N1bWVudCYmZWxlbS5kb2N1bWVudC5ub2RlVHlwZSE9PTExKXtyZXR1cm4gcmV0O319Y2F0Y2goZSl7fX0KcmV0dXJuIFNpenpsZShleHByLGRvY3VtZW50LG51bGwsW2VsZW1dKS5sZW5ndGg+MDt9O1NpenpsZS5jb250YWlucz1mdW5jdGlvbihjb250ZXh0LGVsZW0pe2lmKChjb250ZXh0Lm93bmVyRG9jdW1lbnR8fGNvbnRleHQpIT09ZG9jdW1lbnQpe3NldERvY3VtZW50KGNvbnRleHQpO30KcmV0dXJuIGNvbnRhaW5zKGNvbnRleHQsZWxlbSk7fTtTaXp6bGUuYXR0cj1mdW5jdGlvbihlbGVtLG5hbWUpe2lmKChlbGVtLm93bmVyRG9jdW1lbnR8fGVsZW0pIT09ZG9jdW1lbnQpe3NldERvY3VtZW50KGVsZW0pO30KdmFyIGZuPUV4cHIuYXR0ckhhbmRsZVtuYW1lLnRvTG93ZXJDYXNlKCldLHZhbD1mbiYmaGFzT3duLmNhbGwoRXhwci5hdHRySGFuZGxlLG5hbWUudG9Mb3dlckNhc2UoKSk/Zm4oZWxlbSxuYW1lLCFkb2N1bWVudElzSFRNTCk6dW5kZWZpbmVkO3JldHVybiB2YWwhPT11bmRlZmluZWQ/dmFsOnN1cHBvcnQuYXR0cmlidXRlc3x8IWRvY3VtZW50SXNIVE1MP2VsZW0uZ2V0QXR0cmlidXRlKG5hbWUpOih2YWw9ZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKG5hbWUpKSYmdmFsLnNwZWNpZmllZD92YWwudmFsdWU6bnVsbDt9O1NpenpsZS5lcnJvcj1mdW5jdGlvbihtc2cpe3Rocm93IG5ldyBFcnJvcigiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIittc2cpO307U2l6emxlLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24ocmVzdWx0cyl7dmFyIGVsZW0sZHVwbGljYXRlcz1bXSxqPTAsaT0wO2hhc0R1cGxpY2F0ZT0hc3VwcG9ydC5kZXRlY3REdXBsaWNhdGVzO3NvcnRJbnB1dD0hc3VwcG9ydC5zb3J0U3RhYmxlJiZyZXN1bHRzLnNsaWNlKDApO3Jlc3VsdHMuc29ydChzb3J0T3JkZXIpO2lmKGhhc0R1cGxpY2F0ZSl7d2hpbGUoKGVsZW09cmVzdWx0c1tpKytdKSl7aWYoZWxlbT09PXJlc3VsdHNbaV0pe2o9ZHVwbGljYXRlcy5wdXNoKGkpO319CndoaWxlKGotLSl7cmVzdWx0cy5zcGxpY2UoZHVwbGljYXRlc1tqXSwxKTt9fQpzb3J0SW5wdXQ9bnVsbDtyZXR1cm4gcmVzdWx0czt9O2dldFRleHQ9U2l6emxlLmdldFRleHQ9ZnVuY3Rpb24oZWxlbSl7dmFyIG5vZGUscmV0PSIiLGk9MCxub2RlVHlwZT1lbGVtLm5vZGVUeXBlO2lmKCFub2RlVHlwZSl7d2hpbGUoKG5vZGU9ZWxlbVtpKytdKSl7cmV0Kz1nZXRUZXh0KG5vZGUpO319ZWxzZSBpZihub2RlVHlwZT09PTF8fG5vZGVUeXBlPT09OXx8bm9kZVR5cGU9PT0xMSl7aWYodHlwZW9mIGVsZW0udGV4dENvbnRlbnQ9PT0ic3RyaW5nIil7cmV0dXJuIGVsZW0udGV4dENvbnRlbnQ7fWVsc2V7Zm9yKGVsZW09ZWxlbS5maXJzdENoaWxkO2VsZW07ZWxlbT1lbGVtLm5leHRTaWJsaW5nKXtyZXQrPWdldFRleHQoZWxlbSk7fX19ZWxzZSBpZihub2RlVHlwZT09PTN8fG5vZGVUeXBlPT09NCl7cmV0dXJuIGVsZW0ubm9kZVZhbHVlO30KcmV0dXJuIHJldDt9O0V4cHI9U2l6emxlLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOm1hcmtGdW5jdGlvbixtYXRjaDptYXRjaEV4cHIsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6dHJ1ZX0sIiAiOntkaXI6InBhcmVudE5vZGUifSwiKyI6e2RpcjoicHJldmlvdXNTaWJsaW5nIixmaXJzdDp0cnVlfSwifiI6e2RpcjoicHJldmlvdXNTaWJsaW5nIn19LHByZUZpbHRlcjp7IkFUVFIiOmZ1bmN0aW9uKG1hdGNoKXttYXRjaFsxXT1tYXRjaFsxXS5yZXBsYWNlKHJ1bmVzY2FwZSxmdW5lc2NhcGUpO21hdGNoWzNdPShtYXRjaFs0XXx8bWF0Y2hbNV18fCIiKS5yZXBsYWNlKHJ1bmVzY2FwZSxmdW5lc2NhcGUpO2lmKG1hdGNoWzJdPT09In49Iil7bWF0Y2hbM109IiAiK21hdGNoWzNdKyIgIjt9CnJldHVybiBtYXRjaC5zbGljZSgwLDQpO30sIkNISUxEIjpmdW5jdGlvbihtYXRjaCl7bWF0Y2hbMV09bWF0Y2hbMV0udG9Mb3dlckNhc2UoKTtpZihtYXRjaFsxXS5zbGljZSgwLDMpPT09Im50aCIpe2lmKCFtYXRjaFszXSl7U2l6emxlLmVycm9yKG1hdGNoWzBdKTt9Cm1hdGNoWzRdPSsobWF0Y2hbNF0/bWF0Y2hbNV0rKG1hdGNoWzZdfHwxKToyKihtYXRjaFszXT09PSJldmVuInx8bWF0Y2hbM109PT0ib2RkIikpO21hdGNoWzVdPSsoKG1hdGNoWzddK21hdGNoWzhdKXx8bWF0Y2hbM109PT0ib2RkIik7fWVsc2UgaWYobWF0Y2hbM10pe1NpenpsZS5lcnJvcihtYXRjaFswXSk7fQpyZXR1cm4gbWF0Y2g7fSwiUFNFVURPIjpmdW5jdGlvbihtYXRjaCl7dmFyIGV4Y2Vzcyx1bnF1b3RlZD0hbWF0Y2hbNV0mJm1hdGNoWzJdO2lmKG1hdGNoRXhwclsiQ0hJTEQiXS50ZXN0KG1hdGNoWzBdKSl7cmV0dXJuIG51bGw7fQppZihtYXRjaFszXSYmbWF0Y2hbNF0hPT11bmRlZmluZWQpe21hdGNoWzJdPW1hdGNoWzRdO31lbHNlIGlmKHVucXVvdGVkJiZycHNldWRvLnRlc3QodW5xdW90ZWQpJiYoZXhjZXNzPXRva2VuaXplKHVucXVvdGVkLHRydWUpKSYmKGV4Y2Vzcz11bnF1b3RlZC5pbmRleE9mKCIpIix1bnF1b3RlZC5sZW5ndGgtZXhjZXNzKS11bnF1b3RlZC5sZW5ndGgpKXttYXRjaFswXT1tYXRjaFswXS5zbGljZSgwLGV4Y2Vzcyk7bWF0Y2hbMl09dW5xdW90ZWQuc2xpY2UoMCxleGNlc3MpO30KcmV0dXJuIG1hdGNoLnNsaWNlKDAsMyk7fX0sZmlsdGVyOnsiVEFHIjpmdW5jdGlvbihub2RlTmFtZVNlbGVjdG9yKXt2YXIgbm9kZU5hbWU9bm9kZU5hbWVTZWxlY3Rvci5yZXBsYWNlKHJ1bmVzY2FwZSxmdW5lc2NhcGUpLnRvTG93ZXJDYXNlKCk7cmV0dXJuIG5vZGVOYW1lU2VsZWN0b3I9PT0iKiI/ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9OmZ1bmN0aW9uKGVsZW0pe3JldHVybiBlbGVtLm5vZGVOYW1lJiZlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1ub2RlTmFtZTt9O30sIkNMQVNTIjpmdW5jdGlvbihjbGFzc05hbWUpe3ZhciBwYXR0ZXJuPWNsYXNzQ2FjaGVbY2xhc3NOYW1lKyIgIl07cmV0dXJuIHBhdHRlcm58fChwYXR0ZXJuPW5ldyBSZWdFeHAoIihefCIrd2hpdGVzcGFjZSsiKSIrY2xhc3NOYW1lKyIoIit3aGl0ZXNwYWNlKyJ8JCkiKSkmJmNsYXNzQ2FjaGUoY2xhc3NOYW1lLGZ1bmN0aW9uKGVsZW0pe3JldHVybiBwYXR0ZXJuLnRlc3QodHlwZW9mIGVsZW0uY2xhc3NOYW1lPT09InN0cmluZyImJmVsZW0uY2xhc3NOYW1lfHx0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGUhPT1zdHJ1bmRlZmluZWQmJmVsZW0uZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIik7fSk7fSwiQVRUUiI6ZnVuY3Rpb24obmFtZSxvcGVyYXRvcixjaGVjayl7cmV0dXJuIGZ1bmN0aW9uKGVsZW0pe3ZhciByZXN1bHQ9U2l6emxlLmF0dHIoZWxlbSxuYW1lKTtpZihyZXN1bHQ9PW51bGwpe3JldHVybiBvcGVyYXRvcj09PSIhPSI7fQppZighb3BlcmF0b3Ipe3JldHVybiB0cnVlO30KcmVzdWx0Kz0iIjtyZXR1cm4gb3BlcmF0b3I9PT0iPSI/cmVzdWx0PT09Y2hlY2s6b3BlcmF0b3I9PT0iIT0iP3Jlc3VsdCE9PWNoZWNrOm9wZXJhdG9yPT09Il49Ij9jaGVjayYmcmVzdWx0LmluZGV4T2YoY2hlY2spPT09MDpvcGVyYXRvcj09PSIqPSI/Y2hlY2smJnJlc3VsdC5pbmRleE9mKGNoZWNrKT4tMTpvcGVyYXRvcj09PSIkPSI/Y2hlY2smJnJlc3VsdC5zbGljZSgtY2hlY2subGVuZ3RoKT09PWNoZWNrOm9wZXJhdG9yPT09In49Ij8oIiAiK3Jlc3VsdCsiICIpLmluZGV4T2YoY2hlY2spPi0xOm9wZXJhdG9yPT09Inw9Ij9yZXN1bHQ9PT1jaGVja3x8cmVzdWx0LnNsaWNlKDAsY2hlY2subGVuZ3RoKzEpPT09Y2hlY2srIi0iOmZhbHNlO307fSwiQ0hJTEQiOmZ1bmN0aW9uKHR5cGUsd2hhdCxhcmd1bWVudCxmaXJzdCxsYXN0KXt2YXIgc2ltcGxlPXR5cGUuc2xpY2UoMCwzKSE9PSJudGgiLGZvcndhcmQ9dHlwZS5zbGljZSgtNCkhPT0ibGFzdCIsb2ZUeXBlPXdoYXQ9PT0ib2YtdHlwZSI7cmV0dXJuIGZpcnN0PT09MSYmbGFzdD09PTA/ZnVuY3Rpb24oZWxlbSl7cmV0dXJuISFlbGVtLnBhcmVudE5vZGU7fTpmdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXt2YXIgY2FjaGUsb3V0ZXJDYWNoZSxub2RlLGRpZmYsbm9kZUluZGV4LHN0YXJ0LGRpcj1zaW1wbGUhPT1mb3J3YXJkPyJuZXh0U2libGluZyI6InByZXZpb3VzU2libGluZyIscGFyZW50PWVsZW0ucGFyZW50Tm9kZSxuYW1lPW9mVHlwZSYmZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLHVzZUNhY2hlPSF4bWwmJiFvZlR5cGU7aWYocGFyZW50KXtpZihzaW1wbGUpe3doaWxlKGRpcil7bm9kZT1lbGVtO3doaWxlKChub2RlPW5vZGVbZGlyXSkpe2lmKG9mVHlwZT9ub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1uYW1lOm5vZGUubm9kZVR5cGU9PT0xKXtyZXR1cm4gZmFsc2U7fX0Kc3RhcnQ9ZGlyPXR5cGU9PT0ib25seSImJiFzdGFydCYmIm5leHRTaWJsaW5nIjt9CnJldHVybiB0cnVlO30Kc3RhcnQ9W2ZvcndhcmQ/cGFyZW50LmZpcnN0Q2hpbGQ6cGFyZW50Lmxhc3RDaGlsZF07aWYoZm9yd2FyZCYmdXNlQ2FjaGUpe291dGVyQ2FjaGU9cGFyZW50W2V4cGFuZG9dfHwocGFyZW50W2V4cGFuZG9dPXt9KTtjYWNoZT1vdXRlckNhY2hlW3R5cGVdfHxbXTtub2RlSW5kZXg9Y2FjaGVbMF09PT1kaXJydW5zJiZjYWNoZVsxXTtkaWZmPWNhY2hlWzBdPT09ZGlycnVucyYmY2FjaGVbMl07bm9kZT1ub2RlSW5kZXgmJnBhcmVudC5jaGlsZE5vZGVzW25vZGVJbmRleF07d2hpbGUoKG5vZGU9Kytub2RlSW5kZXgmJm5vZGUmJm5vZGVbZGlyXXx8KGRpZmY9bm9kZUluZGV4PTApfHxzdGFydC5wb3AoKSkpe2lmKG5vZGUubm9kZVR5cGU9PT0xJiYrK2RpZmYmJm5vZGU9PT1lbGVtKXtvdXRlckNhY2hlW3R5cGVdPVtkaXJydW5zLG5vZGVJbmRleCxkaWZmXTticmVhazt9fX1lbHNlIGlmKHVzZUNhY2hlJiYoY2FjaGU9KGVsZW1bZXhwYW5kb118fChlbGVtW2V4cGFuZG9dPXt9KSlbdHlwZV0pJiZjYWNoZVswXT09PWRpcnJ1bnMpe2RpZmY9Y2FjaGVbMV07fWVsc2V7d2hpbGUoKG5vZGU9Kytub2RlSW5kZXgmJm5vZGUmJm5vZGVbZGlyXXx8KGRpZmY9bm9kZUluZGV4PTApfHxzdGFydC5wb3AoKSkpe2lmKChvZlR5cGU/bm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09bmFtZTpub2RlLm5vZGVUeXBlPT09MSkmJisrZGlmZil7aWYodXNlQ2FjaGUpeyhub2RlW2V4cGFuZG9dfHwobm9kZVtleHBhbmRvXT17fSkpW3R5cGVdPVtkaXJydW5zLGRpZmZdO30KaWYobm9kZT09PWVsZW0pe2JyZWFrO319fX0KZGlmZi09bGFzdDtyZXR1cm4gZGlmZj09PWZpcnN0fHwoZGlmZiVmaXJzdD09PTAmJmRpZmYvZmlyc3Q+PTApO319O30sIlBTRVVETyI6ZnVuY3Rpb24ocHNldWRvLGFyZ3VtZW50KXt2YXIgYXJncyxmbj1FeHByLnBzZXVkb3NbcHNldWRvXXx8RXhwci5zZXRGaWx0ZXJzW3BzZXVkby50b0xvd2VyQ2FzZSgpXXx8U2l6emxlLmVycm9yKCJ1bnN1cHBvcnRlZCBwc2V1ZG86ICIrcHNldWRvKTtpZihmbltleHBhbmRvXSl7cmV0dXJuIGZuKGFyZ3VtZW50KTt9CmlmKGZuLmxlbmd0aD4xKXthcmdzPVtwc2V1ZG8scHNldWRvLCIiLGFyZ3VtZW50XTtyZXR1cm4gRXhwci5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KHBzZXVkby50b0xvd2VyQ2FzZSgpKT9tYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VlZCxtYXRjaGVzKXt2YXIgaWR4LG1hdGNoZWQ9Zm4oc2VlZCxhcmd1bWVudCksaT1tYXRjaGVkLmxlbmd0aDt3aGlsZShpLS0pe2lkeD1pbmRleE9mLmNhbGwoc2VlZCxtYXRjaGVkW2ldKTtzZWVkW2lkeF09IShtYXRjaGVzW2lkeF09bWF0Y2hlZFtpXSk7fX0pOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBmbihlbGVtLDAsYXJncyk7fTt9CnJldHVybiBmbjt9fSxwc2V1ZG9zOnsibm90IjptYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VsZWN0b3Ipe3ZhciBpbnB1dD1bXSxyZXN1bHRzPVtdLG1hdGNoZXI9Y29tcGlsZShzZWxlY3Rvci5yZXBsYWNlKHJ0cmltLCIkMSIpKTtyZXR1cm4gbWF0Y2hlcltleHBhbmRvXT9tYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VlZCxtYXRjaGVzLGNvbnRleHQseG1sKXt2YXIgZWxlbSx1bm1hdGNoZWQ9bWF0Y2hlcihzZWVkLG51bGwseG1sLFtdKSxpPXNlZWQubGVuZ3RoO3doaWxlKGktLSl7aWYoKGVsZW09dW5tYXRjaGVkW2ldKSl7c2VlZFtpXT0hKG1hdGNoZXNbaV09ZWxlbSk7fX19KTpmdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXtpbnB1dFswXT1lbGVtO21hdGNoZXIoaW5wdXQsbnVsbCx4bWwscmVzdWx0cyk7cmV0dXJuIXJlc3VsdHMucG9wKCk7fTt9KSwiaGFzIjptYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VsZWN0b3Ipe3JldHVybiBmdW5jdGlvbihlbGVtKXtyZXR1cm4gU2l6emxlKHNlbGVjdG9yLGVsZW0pLmxlbmd0aD4wO307fSksImNvbnRhaW5zIjptYXJrRnVuY3Rpb24oZnVuY3Rpb24odGV4dCl7cmV0dXJuIGZ1bmN0aW9uKGVsZW0pe3JldHVybihlbGVtLnRleHRDb250ZW50fHxlbGVtLmlubmVyVGV4dHx8Z2V0VGV4dChlbGVtKSkuaW5kZXhPZih0ZXh0KT4tMTt9O30pLCJsYW5nIjptYXJrRnVuY3Rpb24oZnVuY3Rpb24obGFuZyl7aWYoIXJpZGVudGlmaWVyLnRlc3QobGFuZ3x8IiIpKXtTaXp6bGUuZXJyb3IoInVuc3VwcG9ydGVkIGxhbmc6ICIrbGFuZyk7fQpsYW5nPWxhbmcucmVwbGFjZShydW5lc2NhcGUsZnVuZXNjYXBlKS50b0xvd2VyQ2FzZSgpO3JldHVybiBmdW5jdGlvbihlbGVtKXt2YXIgZWxlbUxhbmc7ZG97aWYoKGVsZW1MYW5nPWRvY3VtZW50SXNIVE1MP2VsZW0ubGFuZzplbGVtLmdldEF0dHJpYnV0ZSgieG1sOmxhbmciKXx8ZWxlbS5nZXRBdHRyaWJ1dGUoImxhbmciKSkpe2VsZW1MYW5nPWVsZW1MYW5nLnRvTG93ZXJDYXNlKCk7cmV0dXJuIGVsZW1MYW5nPT09bGFuZ3x8ZWxlbUxhbmcuaW5kZXhPZihsYW5nKyItIik9PT0wO319d2hpbGUoKGVsZW09ZWxlbS5wYXJlbnROb2RlKSYmZWxlbS5ub2RlVHlwZT09PTEpO3JldHVybiBmYWxzZTt9O30pLCJ0YXJnZXQiOmZ1bmN0aW9uKGVsZW0pe3ZhciBoYXNoPXdpbmRvdy5sb2NhdGlvbiYmd2luZG93LmxvY2F0aW9uLmhhc2g7cmV0dXJuIGhhc2gmJmhhc2guc2xpY2UoMSk9PT1lbGVtLmlkO30sInJvb3QiOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBlbGVtPT09ZG9jRWxlbTt9LCJmb2N1cyI6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGVsZW09PT1kb2N1bWVudC5hY3RpdmVFbGVtZW50JiYoIWRvY3VtZW50Lmhhc0ZvY3VzfHxkb2N1bWVudC5oYXNGb2N1cygpKSYmISEoZWxlbS50eXBlfHxlbGVtLmhyZWZ8fH5lbGVtLnRhYkluZGV4KTt9LCJlbmFibGVkIjpmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5kaXNhYmxlZD09PWZhbHNlO30sImRpc2FibGVkIjpmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5kaXNhYmxlZD09PXRydWU7fSwiY2hlY2tlZCI6ZnVuY3Rpb24oZWxlbSl7dmFyIG5vZGVOYW1lPWVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4obm9kZU5hbWU9PT0iaW5wdXQiJiYhIWVsZW0uY2hlY2tlZCl8fChub2RlTmFtZT09PSJvcHRpb24iJiYhIWVsZW0uc2VsZWN0ZWQpO30sInNlbGVjdGVkIjpmdW5jdGlvbihlbGVtKXtpZihlbGVtLnBhcmVudE5vZGUpe2VsZW0ucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4O30KcmV0dXJuIGVsZW0uc2VsZWN0ZWQ9PT10cnVlO30sImVtcHR5IjpmdW5jdGlvbihlbGVtKXtmb3IoZWxlbT1lbGVtLmZpcnN0Q2hpbGQ7ZWxlbTtlbGVtPWVsZW0ubmV4dFNpYmxpbmcpe2lmKGVsZW0ubm9kZVR5cGU8Nil7cmV0dXJuIGZhbHNlO319CnJldHVybiB0cnVlO30sInBhcmVudCI6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIUV4cHIucHNldWRvc1siZW1wdHkiXShlbGVtKTt9LCJoZWFkZXIiOmZ1bmN0aW9uKGVsZW0pe3JldHVybiByaGVhZGVyLnRlc3QoZWxlbS5ub2RlTmFtZSk7fSwiaW5wdXQiOmZ1bmN0aW9uKGVsZW0pe3JldHVybiByaW5wdXRzLnRlc3QoZWxlbS5ub2RlTmFtZSk7fSwiYnV0dG9uIjpmdW5jdGlvbihlbGVtKXt2YXIgbmFtZT1lbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuIG5hbWU9PT0iaW5wdXQiJiZlbGVtLnR5cGU9PT0iYnV0dG9uInx8bmFtZT09PSJidXR0b24iO30sInRleHQiOmZ1bmN0aW9uKGVsZW0pe3ZhciBhdHRyO3JldHVybiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT0iaW5wdXQiJiZlbGVtLnR5cGU9PT0idGV4dCImJigoYXR0cj1lbGVtLmdldEF0dHJpYnV0ZSgidHlwZSIpKT09bnVsbHx8YXR0ci50b0xvd2VyQ2FzZSgpPT09InRleHQiKTt9LCJmaXJzdCI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbigpe3JldHVyblswXTt9KSwibGFzdCI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsbGVuZ3RoKXtyZXR1cm5bbGVuZ3RoLTFdO30pLCJlcSI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsbGVuZ3RoLGFyZ3VtZW50KXtyZXR1cm5bYXJndW1lbnQ8MD9hcmd1bWVudCtsZW5ndGg6YXJndW1lbnRdO30pLCJldmVuIjpjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKG1hdGNoSW5kZXhlcyxsZW5ndGgpe3ZhciBpPTA7Zm9yKDtpPGxlbmd0aDtpKz0yKXttYXRjaEluZGV4ZXMucHVzaChpKTt9CnJldHVybiBtYXRjaEluZGV4ZXM7fSksIm9kZCI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsbGVuZ3RoKXt2YXIgaT0xO2Zvcig7aTxsZW5ndGg7aSs9Mil7bWF0Y2hJbmRleGVzLnB1c2goaSk7fQpyZXR1cm4gbWF0Y2hJbmRleGVzO30pLCJsdCI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsbGVuZ3RoLGFyZ3VtZW50KXt2YXIgaT1hcmd1bWVudDwwP2FyZ3VtZW50K2xlbmd0aDphcmd1bWVudDtmb3IoOy0taT49MDspe21hdGNoSW5kZXhlcy5wdXNoKGkpO30KcmV0dXJuIG1hdGNoSW5kZXhlczt9KSwiZ3QiOmNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24obWF0Y2hJbmRleGVzLGxlbmd0aCxhcmd1bWVudCl7dmFyIGk9YXJndW1lbnQ8MD9hcmd1bWVudCtsZW5ndGg6YXJndW1lbnQ7Zm9yKDsrK2k8bGVuZ3RoOyl7bWF0Y2hJbmRleGVzLnB1c2goaSk7fQpyZXR1cm4gbWF0Y2hJbmRleGVzO30pfX07RXhwci5wc2V1ZG9zWyJudGgiXT1FeHByLnBzZXVkb3NbImVxIl07Zm9yKGkgaW57cmFkaW86dHJ1ZSxjaGVja2JveDp0cnVlLGZpbGU6dHJ1ZSxwYXNzd29yZDp0cnVlLGltYWdlOnRydWV9KXtFeHByLnBzZXVkb3NbaV09Y3JlYXRlSW5wdXRQc2V1ZG8oaSk7fQpmb3IoaSBpbntzdWJtaXQ6dHJ1ZSxyZXNldDp0cnVlfSl7RXhwci5wc2V1ZG9zW2ldPWNyZWF0ZUJ1dHRvblBzZXVkbyhpKTt9CmZ1bmN0aW9uIHNldEZpbHRlcnMoKXt9CnNldEZpbHRlcnMucHJvdG90eXBlPUV4cHIuZmlsdGVycz1FeHByLnBzZXVkb3M7RXhwci5zZXRGaWx0ZXJzPW5ldyBzZXRGaWx0ZXJzKCk7ZnVuY3Rpb24gdG9rZW5pemUoc2VsZWN0b3IscGFyc2VPbmx5KXt2YXIgbWF0Y2hlZCxtYXRjaCx0b2tlbnMsdHlwZSxzb0Zhcixncm91cHMscHJlRmlsdGVycyxjYWNoZWQ9dG9rZW5DYWNoZVtzZWxlY3RvcisiICJdO2lmKGNhY2hlZCl7cmV0dXJuIHBhcnNlT25seT8wOmNhY2hlZC5zbGljZSgwKTt9CnNvRmFyPXNlbGVjdG9yO2dyb3Vwcz1bXTtwcmVGaWx0ZXJzPUV4cHIucHJlRmlsdGVyO3doaWxlKHNvRmFyKXtpZighbWF0Y2hlZHx8KG1hdGNoPXJjb21tYS5leGVjKHNvRmFyKSkpe2lmKG1hdGNoKXtzb0Zhcj1zb0Zhci5zbGljZShtYXRjaFswXS5sZW5ndGgpfHxzb0Zhcjt9Cmdyb3Vwcy5wdXNoKCh0b2tlbnM9W10pKTt9Cm1hdGNoZWQ9ZmFsc2U7aWYoKG1hdGNoPXJjb21iaW5hdG9ycy5leGVjKHNvRmFyKSkpe21hdGNoZWQ9bWF0Y2guc2hpZnQoKTt0b2tlbnMucHVzaCh7dmFsdWU6bWF0Y2hlZCx0eXBlOm1hdGNoWzBdLnJlcGxhY2UocnRyaW0sIiAiKX0pO3NvRmFyPXNvRmFyLnNsaWNlKG1hdGNoZWQubGVuZ3RoKTt9CmZvcih0eXBlIGluIEV4cHIuZmlsdGVyKXtpZigobWF0Y2g9bWF0Y2hFeHByW3R5cGVdLmV4ZWMoc29GYXIpKSYmKCFwcmVGaWx0ZXJzW3R5cGVdfHwobWF0Y2g9cHJlRmlsdGVyc1t0eXBlXShtYXRjaCkpKSl7bWF0Y2hlZD1tYXRjaC5zaGlmdCgpO3Rva2Vucy5wdXNoKHt2YWx1ZTptYXRjaGVkLHR5cGU6dHlwZSxtYXRjaGVzOm1hdGNofSk7c29GYXI9c29GYXIuc2xpY2UobWF0Y2hlZC5sZW5ndGgpO319CmlmKCFtYXRjaGVkKXticmVhazt9fQpyZXR1cm4gcGFyc2VPbmx5P3NvRmFyLmxlbmd0aDpzb0Zhcj9TaXp6bGUuZXJyb3Ioc2VsZWN0b3IpOnRva2VuQ2FjaGUoc2VsZWN0b3IsZ3JvdXBzKS5zbGljZSgwKTt9CmZ1bmN0aW9uIHRvU2VsZWN0b3IodG9rZW5zKXt2YXIgaT0wLGxlbj10b2tlbnMubGVuZ3RoLHNlbGVjdG9yPSIiO2Zvcig7aTxsZW47aSsrKXtzZWxlY3Rvcis9dG9rZW5zW2ldLnZhbHVlO30KcmV0dXJuIHNlbGVjdG9yO30KZnVuY3Rpb24gYWRkQ29tYmluYXRvcihtYXRjaGVyLGNvbWJpbmF0b3IsYmFzZSl7dmFyIGRpcj1jb21iaW5hdG9yLmRpcixjaGVja05vbkVsZW1lbnRzPWJhc2UmJmRpcj09PSJwYXJlbnROb2RlIixkb25lTmFtZT1kb25lKys7cmV0dXJuIGNvbWJpbmF0b3IuZmlyc3Q/ZnVuY3Rpb24oZWxlbSxjb250ZXh0LHhtbCl7d2hpbGUoKGVsZW09ZWxlbVtkaXJdKSl7aWYoZWxlbS5ub2RlVHlwZT09PTF8fGNoZWNrTm9uRWxlbWVudHMpe3JldHVybiBtYXRjaGVyKGVsZW0sY29udGV4dCx4bWwpO319fTpmdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXt2YXIgb2xkQ2FjaGUsb3V0ZXJDYWNoZSxuZXdDYWNoZT1bZGlycnVucyxkb25lTmFtZV07aWYoeG1sKXt3aGlsZSgoZWxlbT1lbGVtW2Rpcl0pKXtpZihlbGVtLm5vZGVUeXBlPT09MXx8Y2hlY2tOb25FbGVtZW50cyl7aWYobWF0Y2hlcihlbGVtLGNvbnRleHQseG1sKSl7cmV0dXJuIHRydWU7fX19fWVsc2V7d2hpbGUoKGVsZW09ZWxlbVtkaXJdKSl7aWYoZWxlbS5ub2RlVHlwZT09PTF8fGNoZWNrTm9uRWxlbWVudHMpe291dGVyQ2FjaGU9ZWxlbVtleHBhbmRvXXx8KGVsZW1bZXhwYW5kb109e30pO2lmKChvbGRDYWNoZT1vdXRlckNhY2hlW2Rpcl0pJiZvbGRDYWNoZVswXT09PWRpcnJ1bnMmJm9sZENhY2hlWzFdPT09ZG9uZU5hbWUpe3JldHVybihuZXdDYWNoZVsyXT1vbGRDYWNoZVsyXSk7fWVsc2V7b3V0ZXJDYWNoZVtkaXJdPW5ld0NhY2hlO2lmKChuZXdDYWNoZVsyXT1tYXRjaGVyKGVsZW0sY29udGV4dCx4bWwpKSl7cmV0dXJuIHRydWU7fX19fX19O30KZnVuY3Rpb24gZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpe3JldHVybiBtYXRjaGVycy5sZW5ndGg+MT9mdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXt2YXIgaT1tYXRjaGVycy5sZW5ndGg7d2hpbGUoaS0tKXtpZighbWF0Y2hlcnNbaV0oZWxlbSxjb250ZXh0LHhtbCkpe3JldHVybiBmYWxzZTt9fQpyZXR1cm4gdHJ1ZTt9Om1hdGNoZXJzWzBdO30KZnVuY3Rpb24gY29uZGVuc2UodW5tYXRjaGVkLG1hcCxmaWx0ZXIsY29udGV4dCx4bWwpe3ZhciBlbGVtLG5ld1VubWF0Y2hlZD1bXSxpPTAsbGVuPXVubWF0Y2hlZC5sZW5ndGgsbWFwcGVkPW1hcCE9bnVsbDtmb3IoO2k8bGVuO2krKyl7aWYoKGVsZW09dW5tYXRjaGVkW2ldKSl7aWYoIWZpbHRlcnx8ZmlsdGVyKGVsZW0sY29udGV4dCx4bWwpKXtuZXdVbm1hdGNoZWQucHVzaChlbGVtKTtpZihtYXBwZWQpe21hcC5wdXNoKGkpO319fX0KcmV0dXJuIG5ld1VubWF0Y2hlZDt9CmZ1bmN0aW9uIHNldE1hdGNoZXIocHJlRmlsdGVyLHNlbGVjdG9yLG1hdGNoZXIscG9zdEZpbHRlcixwb3N0RmluZGVyLHBvc3RTZWxlY3Rvcil7aWYocG9zdEZpbHRlciYmIXBvc3RGaWx0ZXJbZXhwYW5kb10pe3Bvc3RGaWx0ZXI9c2V0TWF0Y2hlcihwb3N0RmlsdGVyKTt9CmlmKHBvc3RGaW5kZXImJiFwb3N0RmluZGVyW2V4cGFuZG9dKXtwb3N0RmluZGVyPXNldE1hdGNoZXIocG9zdEZpbmRlcixwb3N0U2VsZWN0b3IpO30KcmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbihzZWVkLHJlc3VsdHMsY29udGV4dCx4bWwpe3ZhciB0ZW1wLGksZWxlbSxwcmVNYXA9W10scG9zdE1hcD1bXSxwcmVleGlzdGluZz1yZXN1bHRzLmxlbmd0aCxlbGVtcz1zZWVkfHxtdWx0aXBsZUNvbnRleHRzKHNlbGVjdG9yfHwiKiIsY29udGV4dC5ub2RlVHlwZT9bY29udGV4dF06Y29udGV4dCxbXSksbWF0Y2hlckluPXByZUZpbHRlciYmKHNlZWR8fCFzZWxlY3Rvcik/Y29uZGVuc2UoZWxlbXMscHJlTWFwLHByZUZpbHRlcixjb250ZXh0LHhtbCk6ZWxlbXMsbWF0Y2hlck91dD1tYXRjaGVyP3Bvc3RGaW5kZXJ8fChzZWVkP3ByZUZpbHRlcjpwcmVleGlzdGluZ3x8cG9zdEZpbHRlcik/W106cmVzdWx0czptYXRjaGVySW47aWYobWF0Y2hlcil7bWF0Y2hlcihtYXRjaGVySW4sbWF0Y2hlck91dCxjb250ZXh0LHhtbCk7fQppZihwb3N0RmlsdGVyKXt0ZW1wPWNvbmRlbnNlKG1hdGNoZXJPdXQscG9zdE1hcCk7cG9zdEZpbHRlcih0ZW1wLFtdLGNvbnRleHQseG1sKTtpPXRlbXAubGVuZ3RoO3doaWxlKGktLSl7aWYoKGVsZW09dGVtcFtpXSkpe21hdGNoZXJPdXRbcG9zdE1hcFtpXV09IShtYXRjaGVySW5bcG9zdE1hcFtpXV09ZWxlbSk7fX19CmlmKHNlZWQpe2lmKHBvc3RGaW5kZXJ8fHByZUZpbHRlcil7aWYocG9zdEZpbmRlcil7dGVtcD1bXTtpPW1hdGNoZXJPdXQubGVuZ3RoO3doaWxlKGktLSl7aWYoKGVsZW09bWF0Y2hlck91dFtpXSkpe3RlbXAucHVzaCgobWF0Y2hlckluW2ldPWVsZW0pKTt9fQpwb3N0RmluZGVyKG51bGwsKG1hdGNoZXJPdXQ9W10pLHRlbXAseG1sKTt9Cmk9bWF0Y2hlck91dC5sZW5ndGg7d2hpbGUoaS0tKXtpZigoZWxlbT1tYXRjaGVyT3V0W2ldKSYmKHRlbXA9cG9zdEZpbmRlcj9pbmRleE9mLmNhbGwoc2VlZCxlbGVtKTpwcmVNYXBbaV0pPi0xKXtzZWVkW3RlbXBdPSEocmVzdWx0c1t0ZW1wXT1lbGVtKTt9fX19ZWxzZXttYXRjaGVyT3V0PWNvbmRlbnNlKG1hdGNoZXJPdXQ9PT1yZXN1bHRzP21hdGNoZXJPdXQuc3BsaWNlKHByZWV4aXN0aW5nLG1hdGNoZXJPdXQubGVuZ3RoKTptYXRjaGVyT3V0KTtpZihwb3N0RmluZGVyKXtwb3N0RmluZGVyKG51bGwscmVzdWx0cyxtYXRjaGVyT3V0LHhtbCk7fWVsc2V7cHVzaC5hcHBseShyZXN1bHRzLG1hdGNoZXJPdXQpO319fSk7fQpmdW5jdGlvbiBtYXRjaGVyRnJvbVRva2Vucyh0b2tlbnMpe3ZhciBjaGVja0NvbnRleHQsbWF0Y2hlcixqLGxlbj10b2tlbnMubGVuZ3RoLGxlYWRpbmdSZWxhdGl2ZT1FeHByLnJlbGF0aXZlW3Rva2Vuc1swXS50eXBlXSxpbXBsaWNpdFJlbGF0aXZlPWxlYWRpbmdSZWxhdGl2ZXx8RXhwci5yZWxhdGl2ZVsiICJdLGk9bGVhZGluZ1JlbGF0aXZlPzE6MCxtYXRjaENvbnRleHQ9YWRkQ29tYmluYXRvcihmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbT09PWNoZWNrQ29udGV4dDt9LGltcGxpY2l0UmVsYXRpdmUsdHJ1ZSksbWF0Y2hBbnlDb250ZXh0PWFkZENvbWJpbmF0b3IoZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGluZGV4T2YuY2FsbChjaGVja0NvbnRleHQsZWxlbSk+LTE7fSxpbXBsaWNpdFJlbGF0aXZlLHRydWUpLG1hdGNoZXJzPVtmdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXtyZXR1cm4oIWxlYWRpbmdSZWxhdGl2ZSYmKHhtbHx8Y29udGV4dCE9PW91dGVybW9zdENvbnRleHQpKXx8KChjaGVja0NvbnRleHQ9Y29udGV4dCkubm9kZVR5cGU/bWF0Y2hDb250ZXh0KGVsZW0sY29udGV4dCx4bWwpOm1hdGNoQW55Q29udGV4dChlbGVtLGNvbnRleHQseG1sKSk7fV07Zm9yKDtpPGxlbjtpKyspe2lmKChtYXRjaGVyPUV4cHIucmVsYXRpdmVbdG9rZW5zW2ldLnR5cGVdKSl7bWF0Y2hlcnM9W2FkZENvbWJpbmF0b3IoZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpLG1hdGNoZXIpXTt9ZWxzZXttYXRjaGVyPUV4cHIuZmlsdGVyW3Rva2Vuc1tpXS50eXBlXS5hcHBseShudWxsLHRva2Vuc1tpXS5tYXRjaGVzKTtpZihtYXRjaGVyW2V4cGFuZG9dKXtqPSsraTtmb3IoO2o8bGVuO2orKyl7aWYoRXhwci5yZWxhdGl2ZVt0b2tlbnNbal0udHlwZV0pe2JyZWFrO319CnJldHVybiBzZXRNYXRjaGVyKGk+MSYmZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpLGk+MSYmdG9TZWxlY3Rvcih0b2tlbnMuc2xpY2UoMCxpLTEpLmNvbmNhdCh7dmFsdWU6dG9rZW5zW2ktMl0udHlwZT09PSIgIj8iKiI6IiJ9KSkucmVwbGFjZShydHJpbSwiJDEiKSxtYXRjaGVyLGk8aiYmbWF0Y2hlckZyb21Ub2tlbnModG9rZW5zLnNsaWNlKGksaikpLGo8bGVuJiZtYXRjaGVyRnJvbVRva2VucygodG9rZW5zPXRva2Vucy5zbGljZShqKSkpLGo8bGVuJiZ0b1NlbGVjdG9yKHRva2VucykpO30KbWF0Y2hlcnMucHVzaChtYXRjaGVyKTt9fQpyZXR1cm4gZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpO30KZnVuY3Rpb24gbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKGVsZW1lbnRNYXRjaGVycyxzZXRNYXRjaGVycyl7dmFyIGJ5U2V0PXNldE1hdGNoZXJzLmxlbmd0aD4wLGJ5RWxlbWVudD1lbGVtZW50TWF0Y2hlcnMubGVuZ3RoPjAsc3VwZXJNYXRjaGVyPWZ1bmN0aW9uKHNlZWQsY29udGV4dCx4bWwscmVzdWx0cyxvdXRlcm1vc3Qpe3ZhciBlbGVtLGosbWF0Y2hlcixtYXRjaGVkQ291bnQ9MCxpPSIwIix1bm1hdGNoZWQ9c2VlZCYmW10sc2V0TWF0Y2hlZD1bXSxjb250ZXh0QmFja3VwPW91dGVybW9zdENvbnRleHQsZWxlbXM9c2VlZHx8YnlFbGVtZW50JiZFeHByLmZpbmRbIlRBRyJdKCIqIixvdXRlcm1vc3QpLGRpcnJ1bnNVbmlxdWU9KGRpcnJ1bnMrPWNvbnRleHRCYWNrdXA9PW51bGw/MTpNYXRoLnJhbmRvbSgpfHwwLjEpLGxlbj1lbGVtcy5sZW5ndGg7aWYob3V0ZXJtb3N0KXtvdXRlcm1vc3RDb250ZXh0PWNvbnRleHQhPT1kb2N1bWVudCYmY29udGV4dDt9CmZvcig7aSE9PWxlbiYmKGVsZW09ZWxlbXNbaV0pIT1udWxsO2krKyl7aWYoYnlFbGVtZW50JiZlbGVtKXtqPTA7d2hpbGUoKG1hdGNoZXI9ZWxlbWVudE1hdGNoZXJzW2orK10pKXtpZihtYXRjaGVyKGVsZW0sY29udGV4dCx4bWwpKXtyZXN1bHRzLnB1c2goZWxlbSk7YnJlYWs7fX0KaWYob3V0ZXJtb3N0KXtkaXJydW5zPWRpcnJ1bnNVbmlxdWU7fX0KaWYoYnlTZXQpe2lmKChlbGVtPSFtYXRjaGVyJiZlbGVtKSl7bWF0Y2hlZENvdW50LS07fQppZihzZWVkKXt1bm1hdGNoZWQucHVzaChlbGVtKTt9fX0KbWF0Y2hlZENvdW50Kz1pO2lmKGJ5U2V0JiZpIT09bWF0Y2hlZENvdW50KXtqPTA7d2hpbGUoKG1hdGNoZXI9c2V0TWF0Y2hlcnNbaisrXSkpe21hdGNoZXIodW5tYXRjaGVkLHNldE1hdGNoZWQsY29udGV4dCx4bWwpO30KaWYoc2VlZCl7aWYobWF0Y2hlZENvdW50PjApe3doaWxlKGktLSl7aWYoISh1bm1hdGNoZWRbaV18fHNldE1hdGNoZWRbaV0pKXtzZXRNYXRjaGVkW2ldPXBvcC5jYWxsKHJlc3VsdHMpO319fQpzZXRNYXRjaGVkPWNvbmRlbnNlKHNldE1hdGNoZWQpO30KcHVzaC5hcHBseShyZXN1bHRzLHNldE1hdGNoZWQpO2lmKG91dGVybW9zdCYmIXNlZWQmJnNldE1hdGNoZWQubGVuZ3RoPjAmJihtYXRjaGVkQ291bnQrc2V0TWF0Y2hlcnMubGVuZ3RoKT4xKXtTaXp6bGUudW5pcXVlU29ydChyZXN1bHRzKTt9fQppZihvdXRlcm1vc3Qpe2RpcnJ1bnM9ZGlycnVuc1VuaXF1ZTtvdXRlcm1vc3RDb250ZXh0PWNvbnRleHRCYWNrdXA7fQpyZXR1cm4gdW5tYXRjaGVkO307cmV0dXJuIGJ5U2V0P21hcmtGdW5jdGlvbihzdXBlck1hdGNoZXIpOnN1cGVyTWF0Y2hlcjt9CmNvbXBpbGU9U2l6emxlLmNvbXBpbGU9ZnVuY3Rpb24oc2VsZWN0b3IsZ3JvdXApe3ZhciBpLHNldE1hdGNoZXJzPVtdLGVsZW1lbnRNYXRjaGVycz1bXSxjYWNoZWQ9Y29tcGlsZXJDYWNoZVtzZWxlY3RvcisiICJdO2lmKCFjYWNoZWQpe2lmKCFncm91cCl7Z3JvdXA9dG9rZW5pemUoc2VsZWN0b3IpO30KaT1ncm91cC5sZW5ndGg7d2hpbGUoaS0tKXtjYWNoZWQ9bWF0Y2hlckZyb21Ub2tlbnMoZ3JvdXBbaV0pO2lmKGNhY2hlZFtleHBhbmRvXSl7c2V0TWF0Y2hlcnMucHVzaChjYWNoZWQpO31lbHNle2VsZW1lbnRNYXRjaGVycy5wdXNoKGNhY2hlZCk7fX0KY2FjaGVkPWNvbXBpbGVyQ2FjaGUoc2VsZWN0b3IsbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKGVsZW1lbnRNYXRjaGVycyxzZXRNYXRjaGVycykpO30KcmV0dXJuIGNhY2hlZDt9O2Z1bmN0aW9uIG11bHRpcGxlQ29udGV4dHMoc2VsZWN0b3IsY29udGV4dHMscmVzdWx0cyl7dmFyIGk9MCxsZW49Y29udGV4dHMubGVuZ3RoO2Zvcig7aTxsZW47aSsrKXtTaXp6bGUoc2VsZWN0b3IsY29udGV4dHNbaV0scmVzdWx0cyk7fQpyZXR1cm4gcmVzdWx0czt9CmZ1bmN0aW9uIHNlbGVjdChzZWxlY3Rvcixjb250ZXh0LHJlc3VsdHMsc2VlZCl7dmFyIGksdG9rZW5zLHRva2VuLHR5cGUsZmluZCxtYXRjaD10b2tlbml6ZShzZWxlY3Rvcik7aWYoIXNlZWQpe2lmKG1hdGNoLmxlbmd0aD09PTEpe3Rva2Vucz1tYXRjaFswXT1tYXRjaFswXS5zbGljZSgwKTtpZih0b2tlbnMubGVuZ3RoPjImJih0b2tlbj10b2tlbnNbMF0pLnR5cGU9PT0iSUQiJiZzdXBwb3J0LmdldEJ5SWQmJmNvbnRleHQubm9kZVR5cGU9PT05JiZkb2N1bWVudElzSFRNTCYmRXhwci5yZWxhdGl2ZVt0b2tlbnNbMV0udHlwZV0pe2NvbnRleHQ9KEV4cHIuZmluZFsiSUQiXSh0b2tlbi5tYXRjaGVzWzBdLnJlcGxhY2UocnVuZXNjYXBlLGZ1bmVzY2FwZSksY29udGV4dCl8fFtdKVswXTtpZighY29udGV4dCl7cmV0dXJuIHJlc3VsdHM7fQpzZWxlY3Rvcj1zZWxlY3Rvci5zbGljZSh0b2tlbnMuc2hpZnQoKS52YWx1ZS5sZW5ndGgpO30KaT1tYXRjaEV4cHJbIm5lZWRzQ29udGV4dCJdLnRlc3Qoc2VsZWN0b3IpPzA6dG9rZW5zLmxlbmd0aDt3aGlsZShpLS0pe3Rva2VuPXRva2Vuc1tpXTtpZihFeHByLnJlbGF0aXZlWyh0eXBlPXRva2VuLnR5cGUpXSl7YnJlYWs7fQppZigoZmluZD1FeHByLmZpbmRbdHlwZV0pKXtpZigoc2VlZD1maW5kKHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZShydW5lc2NhcGUsZnVuZXNjYXBlKSxyc2libGluZy50ZXN0KHRva2Vuc1swXS50eXBlKSYmdGVzdENvbnRleHQoY29udGV4dC5wYXJlbnROb2RlKXx8Y29udGV4dCkpKXt0b2tlbnMuc3BsaWNlKGksMSk7c2VsZWN0b3I9c2VlZC5sZW5ndGgmJnRvU2VsZWN0b3IodG9rZW5zKTtpZighc2VsZWN0b3Ipe3B1c2guYXBwbHkocmVzdWx0cyxzZWVkKTtyZXR1cm4gcmVzdWx0czt9CmJyZWFrO319fX19CmNvbXBpbGUoc2VsZWN0b3IsbWF0Y2gpKHNlZWQsY29udGV4dCwhZG9jdW1lbnRJc0hUTUwscmVzdWx0cyxyc2libGluZy50ZXN0KHNlbGVjdG9yKSYmdGVzdENvbnRleHQoY29udGV4dC5wYXJlbnROb2RlKXx8Y29udGV4dCk7cmV0dXJuIHJlc3VsdHM7fQpzdXBwb3J0LnNvcnRTdGFibGU9ZXhwYW5kby5zcGxpdCgiIikuc29ydChzb3J0T3JkZXIpLmpvaW4oIiIpPT09ZXhwYW5kbztzdXBwb3J0LmRldGVjdER1cGxpY2F0ZXM9ISFoYXNEdXBsaWNhdGU7c2V0RG9jdW1lbnQoKTtzdXBwb3J0LnNvcnREZXRhY2hlZD1hc3NlcnQoZnVuY3Rpb24oZGl2MSl7cmV0dXJuIGRpdjEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpJjE7fSk7aWYoIWFzc2VydChmdW5jdGlvbihkaXYpe2Rpdi5pbm5lckhUTUw9IjxhIGhyZWY9JyMnPjwvYT4iO3JldHVybiBkaXYuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYiKT09PSIjIjt9KSl7YWRkSGFuZGxlKCJ0eXBlfGhyZWZ8aGVpZ2h0fHdpZHRoIixmdW5jdGlvbihlbGVtLG5hbWUsaXNYTUwpe2lmKCFpc1hNTCl7cmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKG5hbWUsbmFtZS50b0xvd2VyQ2FzZSgpPT09InR5cGUiPzE6Mik7fX0pO30KaWYoIXN1cHBvcnQuYXR0cmlidXRlc3x8IWFzc2VydChmdW5jdGlvbihkaXYpe2Rpdi5pbm5lckhUTUw9IjxpbnB1dC8+IjtkaXYuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwiIik7cmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgidmFsdWUiKT09PSIiO30pKXthZGRIYW5kbGUoInZhbHVlIixmdW5jdGlvbihlbGVtLG5hbWUsaXNYTUwpe2lmKCFpc1hNTCYmZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09ImlucHV0Iil7cmV0dXJuIGVsZW0uZGVmYXVsdFZhbHVlO319KTt9CmlmKCFhc3NlcnQoZnVuY3Rpb24oZGl2KXtyZXR1cm4gZGl2LmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKT09bnVsbDt9KSl7YWRkSGFuZGxlKGJvb2xlYW5zLGZ1bmN0aW9uKGVsZW0sbmFtZSxpc1hNTCl7dmFyIHZhbDtpZighaXNYTUwpe3JldHVybiBlbGVtW25hbWVdPT09dHJ1ZT9uYW1lLnRvTG93ZXJDYXNlKCk6KHZhbD1lbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpJiZ2YWwuc3BlY2lmaWVkP3ZhbC52YWx1ZTpudWxsO319KTt9CnJldHVybiBTaXp6bGU7fSkod2luZG93KTtqUXVlcnkuZmluZD1TaXp6bGU7alF1ZXJ5LmV4cHI9U2l6emxlLnNlbGVjdG9ycztqUXVlcnkuZXhwclsiOiJdPWpRdWVyeS5leHByLnBzZXVkb3M7alF1ZXJ5LnVuaXF1ZT1TaXp6bGUudW5pcXVlU29ydDtqUXVlcnkudGV4dD1TaXp6bGUuZ2V0VGV4dDtqUXVlcnkuaXNYTUxEb2M9U2l6emxlLmlzWE1MO2pRdWVyeS5jb250YWlucz1TaXp6bGUuY29udGFpbnM7dmFyIHJuZWVkc0NvbnRleHQ9alF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0O3ZhciByc2luZ2xlVGFnPSgvXjwoXHcrKVxzKlwvPz4oPzo8XC9cMT58KSQvKTt2YXIgcmlzU2ltcGxlPS9eLlteOiNcW1wuLF0qJC87ZnVuY3Rpb24gd2lubm93KGVsZW1lbnRzLHF1YWxpZmllcixub3Qpe2lmKGpRdWVyeS5pc0Z1bmN0aW9uKHF1YWxpZmllcikpe3JldHVybiBqUXVlcnkuZ3JlcChlbGVtZW50cyxmdW5jdGlvbihlbGVtLGkpe3JldHVybiEhcXVhbGlmaWVyLmNhbGwoZWxlbSxpLGVsZW0pIT09bm90O30pO30KaWYocXVhbGlmaWVyLm5vZGVUeXBlKXtyZXR1cm4galF1ZXJ5LmdyZXAoZWxlbWVudHMsZnVuY3Rpb24oZWxlbSl7cmV0dXJuKGVsZW09PT1xdWFsaWZpZXIpIT09bm90O30pO30KaWYodHlwZW9mIHF1YWxpZmllcj09PSJzdHJpbmciKXtpZihyaXNTaW1wbGUudGVzdChxdWFsaWZpZXIpKXtyZXR1cm4galF1ZXJ5LmZpbHRlcihxdWFsaWZpZXIsZWxlbWVudHMsbm90KTt9CnF1YWxpZmllcj1qUXVlcnkuZmlsdGVyKHF1YWxpZmllcixlbGVtZW50cyk7fQpyZXR1cm4galF1ZXJ5LmdyZXAoZWxlbWVudHMsZnVuY3Rpb24oZWxlbSl7cmV0dXJuKGpRdWVyeS5pbkFycmF5KGVsZW0scXVhbGlmaWVyKT49MCkhPT1ub3Q7fSk7fQpqUXVlcnkuZmlsdGVyPWZ1bmN0aW9uKGV4cHIsZWxlbXMsbm90KXt2YXIgZWxlbT1lbGVtc1swXTtpZihub3Qpe2V4cHI9Ijpub3QoIitleHByKyIpIjt9CnJldHVybiBlbGVtcy5sZW5ndGg9PT0xJiZlbGVtLm5vZGVUeXBlPT09MT9qUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoZWxlbSxleHByKT9bZWxlbV06W106alF1ZXJ5LmZpbmQubWF0Y2hlcyhleHByLGpRdWVyeS5ncmVwKGVsZW1zLGZ1bmN0aW9uKGVsZW0pe3JldHVybiBlbGVtLm5vZGVUeXBlPT09MTt9KSk7fTtqUXVlcnkuZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKHNlbGVjdG9yKXt2YXIgaSxyZXQ9W10sc2VsZj10aGlzLGxlbj1zZWxmLmxlbmd0aDtpZih0eXBlb2Ygc2VsZWN0b3IhPT0ic3RyaW5nIil7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGpRdWVyeShzZWxlY3RvcikuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKGk9MDtpPGxlbjtpKyspe2lmKGpRdWVyeS5jb250YWlucyhzZWxmW2ldLHRoaXMpKXtyZXR1cm4gdHJ1ZTt9fX0pKTt9CmZvcihpPTA7aTxsZW47aSsrKXtqUXVlcnkuZmluZChzZWxlY3RvcixzZWxmW2ldLHJldCk7fQpyZXQ9dGhpcy5wdXNoU3RhY2sobGVuPjE/alF1ZXJ5LnVuaXF1ZShyZXQpOnJldCk7cmV0LnNlbGVjdG9yPXRoaXMuc2VsZWN0b3I/dGhpcy5zZWxlY3RvcisiICIrc2VsZWN0b3I6c2VsZWN0b3I7cmV0dXJuIHJldDt9LGZpbHRlcjpmdW5jdGlvbihzZWxlY3Rvcil7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHdpbm5vdyh0aGlzLHNlbGVjdG9yfHxbXSxmYWxzZSkpO30sbm90OmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sod2lubm93KHRoaXMsc2VsZWN0b3J8fFtdLHRydWUpKTt9LGlzOmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4hIXdpbm5vdyh0aGlzLHR5cGVvZiBzZWxlY3Rvcj09PSJzdHJpbmciJiZybmVlZHNDb250ZXh0LnRlc3Qoc2VsZWN0b3IpP2pRdWVyeShzZWxlY3Rvcik6c2VsZWN0b3J8fFtdLGZhbHNlKS5sZW5ndGg7fX0pO3ZhciByb290alF1ZXJ5LGRvY3VtZW50PXdpbmRvdy5kb2N1bWVudCxycXVpY2tFeHByPS9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKikpJC8saW5pdD1qUXVlcnkuZm4uaW5pdD1mdW5jdGlvbihzZWxlY3Rvcixjb250ZXh0KXt2YXIgbWF0Y2gsZWxlbTtpZighc2VsZWN0b3Ipe3JldHVybiB0aGlzO30KaWYodHlwZW9mIHNlbGVjdG9yPT09InN0cmluZyIpe2lmKHNlbGVjdG9yLmNoYXJBdCgwKT09PSI8IiYmc2VsZWN0b3IuY2hhckF0KHNlbGVjdG9yLmxlbmd0aC0xKT09PSI+IiYmc2VsZWN0b3IubGVuZ3RoPj0zKXttYXRjaD1bbnVsbCxzZWxlY3RvcixudWxsXTt9ZWxzZXttYXRjaD1ycXVpY2tFeHByLmV4ZWMoc2VsZWN0b3IpO30KaWYobWF0Y2gmJihtYXRjaFsxXXx8IWNvbnRleHQpKXtpZihtYXRjaFsxXSl7Y29udGV4dD1jb250ZXh0IGluc3RhbmNlb2YgalF1ZXJ5P2NvbnRleHRbMF06Y29udGV4dDtqUXVlcnkubWVyZ2UodGhpcyxqUXVlcnkucGFyc2VIVE1MKG1hdGNoWzFdLGNvbnRleHQmJmNvbnRleHQubm9kZVR5cGU/Y29udGV4dC5vd25lckRvY3VtZW50fHxjb250ZXh0OmRvY3VtZW50LHRydWUpKTtpZihyc2luZ2xlVGFnLnRlc3QobWF0Y2hbMV0pJiZqUXVlcnkuaXNQbGFpbk9iamVjdChjb250ZXh0KSl7Zm9yKG1hdGNoIGluIGNvbnRleHQpe2lmKGpRdWVyeS5pc0Z1bmN0aW9uKHRoaXNbbWF0Y2hdKSl7dGhpc1ttYXRjaF0oY29udGV4dFttYXRjaF0pO31lbHNle3RoaXMuYXR0cihtYXRjaCxjb250ZXh0W21hdGNoXSk7fX19CnJldHVybiB0aGlzO31lbHNle2VsZW09ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWF0Y2hbMl0pO2lmKGVsZW0mJmVsZW0ucGFyZW50Tm9kZSl7aWYoZWxlbS5pZCE9PW1hdGNoWzJdKXtyZXR1cm4gcm9vdGpRdWVyeS5maW5kKHNlbGVjdG9yKTt9CnRoaXMubGVuZ3RoPTE7dGhpc1swXT1lbGVtO30KdGhpcy5jb250ZXh0PWRvY3VtZW50O3RoaXMuc2VsZWN0b3I9c2VsZWN0b3I7cmV0dXJuIHRoaXM7fX1lbHNlIGlmKCFjb250ZXh0fHxjb250ZXh0LmpxdWVyeSl7cmV0dXJuKGNvbnRleHR8fHJvb3RqUXVlcnkpLmZpbmQoc2VsZWN0b3IpO31lbHNle3JldHVybiB0aGlzLmNvbnN0cnVjdG9yKGNvbnRleHQpLmZpbmQoc2VsZWN0b3IpO319ZWxzZSBpZihzZWxlY3Rvci5ub2RlVHlwZSl7dGhpcy5jb250ZXh0PXRoaXNbMF09c2VsZWN0b3I7dGhpcy5sZW5ndGg9MTtyZXR1cm4gdGhpczt9ZWxzZSBpZihqUXVlcnkuaXNGdW5jdGlvbihzZWxlY3Rvcikpe3JldHVybiB0eXBlb2Ygcm9vdGpRdWVyeS5yZWFkeSE9PSJ1bmRlZmluZWQiP3Jvb3RqUXVlcnkucmVhZHkoc2VsZWN0b3IpOnNlbGVjdG9yKGpRdWVyeSk7fQppZihzZWxlY3Rvci5zZWxlY3RvciE9PXVuZGVmaW5lZCl7dGhpcy5zZWxlY3Rvcj1zZWxlY3Rvci5zZWxlY3Rvcjt0aGlzLmNvbnRleHQ9c2VsZWN0b3IuY29udGV4dDt9CnJldHVybiBqUXVlcnkubWFrZUFycmF5KHNlbGVjdG9yLHRoaXMpO307aW5pdC5wcm90b3R5cGU9alF1ZXJ5LmZuO3Jvb3RqUXVlcnk9alF1ZXJ5KGRvY3VtZW50KTt2YXIgcnBhcmVudHNwcmV2PS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLGd1YXJhbnRlZWRVbmlxdWU9e2NoaWxkcmVuOnRydWUsY29udGVudHM6dHJ1ZSxuZXh0OnRydWUscHJldjp0cnVlfTtqUXVlcnkuZXh0ZW5kKHtkaXI6ZnVuY3Rpb24oZWxlbSxkaXIsdW50aWwpe3ZhciBtYXRjaGVkPVtdLGN1cj1lbGVtW2Rpcl07d2hpbGUoY3VyJiZjdXIubm9kZVR5cGUhPT05JiYodW50aWw9PT11bmRlZmluZWR8fGN1ci5ub2RlVHlwZSE9PTF8fCFqUXVlcnkoY3VyKS5pcyh1bnRpbCkpKXtpZihjdXIubm9kZVR5cGU9PT0xKXttYXRjaGVkLnB1c2goY3VyKTt9CmN1cj1jdXJbZGlyXTt9CnJldHVybiBtYXRjaGVkO30sc2libGluZzpmdW5jdGlvbihuLGVsZW0pe3ZhciByPVtdO2Zvcig7bjtuPW4ubmV4dFNpYmxpbmcpe2lmKG4ubm9kZVR5cGU9PT0xJiZuIT09ZWxlbSl7ci5wdXNoKG4pO319CnJldHVybiByO319KTtqUXVlcnkuZm4uZXh0ZW5kKHtoYXM6ZnVuY3Rpb24odGFyZ2V0KXt2YXIgaSx0YXJnZXRzPWpRdWVyeSh0YXJnZXQsdGhpcyksbGVuPXRhcmdldHMubGVuZ3RoO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2ZvcihpPTA7aTxsZW47aSsrKXtpZihqUXVlcnkuY29udGFpbnModGhpcyx0YXJnZXRzW2ldKSl7cmV0dXJuIHRydWU7fX19KTt9LGNsb3Nlc3Q6ZnVuY3Rpb24oc2VsZWN0b3JzLGNvbnRleHQpe3ZhciBjdXIsaT0wLGw9dGhpcy5sZW5ndGgsbWF0Y2hlZD1bXSxwb3M9cm5lZWRzQ29udGV4dC50ZXN0KHNlbGVjdG9ycyl8fHR5cGVvZiBzZWxlY3RvcnMhPT0ic3RyaW5nIj9qUXVlcnkoc2VsZWN0b3JzLGNvbnRleHR8fHRoaXMuY29udGV4dCk6MDtmb3IoO2k8bDtpKyspe2ZvcihjdXI9dGhpc1tpXTtjdXImJmN1ciE9PWNvbnRleHQ7Y3VyPWN1ci5wYXJlbnROb2RlKXtpZihjdXIubm9kZVR5cGU8MTEmJihwb3M/cG9zLmluZGV4KGN1cik+LTE6Y3VyLm5vZGVUeXBlPT09MSYmalF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGN1cixzZWxlY3RvcnMpKSl7bWF0Y2hlZC5wdXNoKGN1cik7YnJlYWs7fX19CnJldHVybiB0aGlzLnB1c2hTdGFjayhtYXRjaGVkLmxlbmd0aD4xP2pRdWVyeS51bmlxdWUobWF0Y2hlZCk6bWF0Y2hlZCk7fSxpbmRleDpmdW5jdGlvbihlbGVtKXtpZighZWxlbSl7cmV0dXJuKHRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZSk/dGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGg6LTE7fQppZih0eXBlb2YgZWxlbT09PSJzdHJpbmciKXtyZXR1cm4galF1ZXJ5LmluQXJyYXkodGhpc1swXSxqUXVlcnkoZWxlbSkpO30KcmV0dXJuIGpRdWVyeS5pbkFycmF5KGVsZW0uanF1ZXJ5P2VsZW1bMF06ZWxlbSx0aGlzKTt9LGFkZDpmdW5jdGlvbihzZWxlY3Rvcixjb250ZXh0KXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soalF1ZXJ5LnVuaXF1ZShqUXVlcnkubWVyZ2UodGhpcy5nZXQoKSxqUXVlcnkoc2VsZWN0b3IsY29udGV4dCkpKSk7fSxhZGRCYWNrOmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4gdGhpcy5hZGQoc2VsZWN0b3I9PW51bGw/dGhpcy5wcmV2T2JqZWN0OnRoaXMucHJldk9iamVjdC5maWx0ZXIoc2VsZWN0b3IpKTt9fSk7ZnVuY3Rpb24gc2libGluZyhjdXIsZGlyKXtkb3tjdXI9Y3VyW2Rpcl07fXdoaWxlKGN1ciYmY3VyLm5vZGVUeXBlIT09MSk7cmV0dXJuIGN1cjt9CmpRdWVyeS5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oZWxlbSl7dmFyIHBhcmVudD1lbGVtLnBhcmVudE5vZGU7cmV0dXJuIHBhcmVudCYmcGFyZW50Lm5vZGVUeXBlIT09MTE/cGFyZW50Om51bGw7fSxwYXJlbnRzOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sInBhcmVudE5vZGUiKTt9LHBhcmVudHNVbnRpbDpmdW5jdGlvbihlbGVtLGksdW50aWwpe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sInBhcmVudE5vZGUiLHVudGlsKTt9LG5leHQ6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIHNpYmxpbmcoZWxlbSwibmV4dFNpYmxpbmciKTt9LHByZXY6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIHNpYmxpbmcoZWxlbSwicHJldmlvdXNTaWJsaW5nIik7fSxuZXh0QWxsOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sIm5leHRTaWJsaW5nIik7fSxwcmV2QWxsOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sInByZXZpb3VzU2libGluZyIpO30sbmV4dFVudGlsOmZ1bmN0aW9uKGVsZW0saSx1bnRpbCl7cmV0dXJuIGpRdWVyeS5kaXIoZWxlbSwibmV4dFNpYmxpbmciLHVudGlsKTt9LHByZXZVbnRpbDpmdW5jdGlvbihlbGVtLGksdW50aWwpe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sInByZXZpb3VzU2libGluZyIsdW50aWwpO30sc2libGluZ3M6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGpRdWVyeS5zaWJsaW5nKChlbGVtLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGVsZW0pO30sY2hpbGRyZW46ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGpRdWVyeS5zaWJsaW5nKGVsZW0uZmlyc3RDaGlsZCk7fSxjb250ZW50czpmdW5jdGlvbihlbGVtKXtyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKGVsZW0sImlmcmFtZSIpP2VsZW0uY29udGVudERvY3VtZW50fHxlbGVtLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ6alF1ZXJ5Lm1lcmdlKFtdLGVsZW0uY2hpbGROb2Rlcyk7fX0sZnVuY3Rpb24obmFtZSxmbil7alF1ZXJ5LmZuW25hbWVdPWZ1bmN0aW9uKHVudGlsLHNlbGVjdG9yKXt2YXIgcmV0PWpRdWVyeS5tYXAodGhpcyxmbix1bnRpbCk7aWYobmFtZS5zbGljZSgtNSkhPT0iVW50aWwiKXtzZWxlY3Rvcj11bnRpbDt9CmlmKHNlbGVjdG9yJiZ0eXBlb2Ygc2VsZWN0b3I9PT0ic3RyaW5nIil7cmV0PWpRdWVyeS5maWx0ZXIoc2VsZWN0b3IscmV0KTt9CmlmKHRoaXMubGVuZ3RoPjEpe2lmKCFndWFyYW50ZWVkVW5pcXVlW25hbWVdKXtyZXQ9alF1ZXJ5LnVuaXF1ZShyZXQpO30KaWYocnBhcmVudHNwcmV2LnRlc3QobmFtZSkpe3JldD1yZXQucmV2ZXJzZSgpO319CnJldHVybiB0aGlzLnB1c2hTdGFjayhyZXQpO307fSk7dmFyIHJub3R3aGl0ZT0oL1xTKy9nKTt2YXIgb3B0aW9uc0NhY2hlPXt9O2Z1bmN0aW9uIGNyZWF0ZU9wdGlvbnMob3B0aW9ucyl7dmFyIG9iamVjdD1vcHRpb25zQ2FjaGVbb3B0aW9uc109e307alF1ZXJ5LmVhY2gob3B0aW9ucy5tYXRjaChybm90d2hpdGUpfHxbXSxmdW5jdGlvbihfLGZsYWcpe29iamVjdFtmbGFnXT10cnVlO30pO3JldHVybiBvYmplY3Q7fQpqUXVlcnkuQ2FsbGJhY2tzPWZ1bmN0aW9uKG9wdGlvbnMpe29wdGlvbnM9dHlwZW9mIG9wdGlvbnM9PT0ic3RyaW5nIj8ob3B0aW9uc0NhY2hlW29wdGlvbnNdfHxjcmVhdGVPcHRpb25zKG9wdGlvbnMpKTpqUXVlcnkuZXh0ZW5kKHt9LG9wdGlvbnMpO3ZhcgpmaXJpbmcsbWVtb3J5LGZpcmVkLGZpcmluZ0xlbmd0aCxmaXJpbmdJbmRleCxmaXJpbmdTdGFydCxsaXN0PVtdLHN0YWNrPSFvcHRpb25zLm9uY2UmJltdLGZpcmU9ZnVuY3Rpb24oZGF0YSl7bWVtb3J5PW9wdGlvbnMubWVtb3J5JiZkYXRhO2ZpcmVkPXRydWU7ZmlyaW5nSW5kZXg9ZmlyaW5nU3RhcnR8fDA7ZmlyaW5nU3RhcnQ9MDtmaXJpbmdMZW5ndGg9bGlzdC5sZW5ndGg7ZmlyaW5nPXRydWU7Zm9yKDtsaXN0JiZmaXJpbmdJbmRleDxmaXJpbmdMZW5ndGg7ZmlyaW5nSW5kZXgrKyl7aWYobGlzdFtmaXJpbmdJbmRleF0uYXBwbHkoZGF0YVswXSxkYXRhWzFdKT09PWZhbHNlJiZvcHRpb25zLnN0b3BPbkZhbHNlKXttZW1vcnk9ZmFsc2U7YnJlYWs7fX0KZmlyaW5nPWZhbHNlO2lmKGxpc3Qpe2lmKHN0YWNrKXtpZihzdGFjay5sZW5ndGgpe2ZpcmUoc3RhY2suc2hpZnQoKSk7fX1lbHNlIGlmKG1lbW9yeSl7bGlzdD1bXTt9ZWxzZXtzZWxmLmRpc2FibGUoKTt9fX0sc2VsZj17YWRkOmZ1bmN0aW9uKCl7aWYobGlzdCl7dmFyIHN0YXJ0PWxpc3QubGVuZ3RoOyhmdW5jdGlvbiBhZGQoYXJncyl7alF1ZXJ5LmVhY2goYXJncyxmdW5jdGlvbihfLGFyZyl7dmFyIHR5cGU9alF1ZXJ5LnR5cGUoYXJnKTtpZih0eXBlPT09ImZ1bmN0aW9uIil7aWYoIW9wdGlvbnMudW5pcXVlfHwhc2VsZi5oYXMoYXJnKSl7bGlzdC5wdXNoKGFyZyk7fX1lbHNlIGlmKGFyZyYmYXJnLmxlbmd0aCYmdHlwZSE9PSJzdHJpbmciKXthZGQoYXJnKTt9fSk7fSkoYXJndW1lbnRzKTtpZihmaXJpbmcpe2ZpcmluZ0xlbmd0aD1saXN0Lmxlbmd0aDt9ZWxzZSBpZihtZW1vcnkpe2ZpcmluZ1N0YXJ0PXN0YXJ0O2ZpcmUobWVtb3J5KTt9fQpyZXR1cm4gdGhpczt9LHJlbW92ZTpmdW5jdGlvbigpe2lmKGxpc3Qpe2pRdWVyeS5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbihfLGFyZyl7dmFyIGluZGV4O3doaWxlKChpbmRleD1qUXVlcnkuaW5BcnJheShhcmcsbGlzdCxpbmRleCkpPi0xKXtsaXN0LnNwbGljZShpbmRleCwxKTtpZihmaXJpbmcpe2lmKGluZGV4PD1maXJpbmdMZW5ndGgpe2ZpcmluZ0xlbmd0aC0tO30KaWYoaW5kZXg8PWZpcmluZ0luZGV4KXtmaXJpbmdJbmRleC0tO319fX0pO30KcmV0dXJuIHRoaXM7fSxoYXM6ZnVuY3Rpb24oZm4pe3JldHVybiBmbj9qUXVlcnkuaW5BcnJheShmbixsaXN0KT4tMTohIShsaXN0JiZsaXN0Lmxlbmd0aCk7fSxlbXB0eTpmdW5jdGlvbigpe2xpc3Q9W107ZmlyaW5nTGVuZ3RoPTA7cmV0dXJuIHRoaXM7fSxkaXNhYmxlOmZ1bmN0aW9uKCl7bGlzdD1zdGFjaz1tZW1vcnk9dW5kZWZpbmVkO3JldHVybiB0aGlzO30sZGlzYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hbGlzdDt9LGxvY2s6ZnVuY3Rpb24oKXtzdGFjaz11bmRlZmluZWQ7aWYoIW1lbW9yeSl7c2VsZi5kaXNhYmxlKCk7fQpyZXR1cm4gdGhpczt9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiFzdGFjazt9LGZpcmVXaXRoOmZ1bmN0aW9uKGNvbnRleHQsYXJncyl7aWYobGlzdCYmKCFmaXJlZHx8c3RhY2spKXthcmdzPWFyZ3N8fFtdO2FyZ3M9W2NvbnRleHQsYXJncy5zbGljZT9hcmdzLnNsaWNlKCk6YXJnc107aWYoZmlyaW5nKXtzdGFjay5wdXNoKGFyZ3MpO31lbHNle2ZpcmUoYXJncyk7fX0KcmV0dXJuIHRoaXM7fSxmaXJlOmZ1bmN0aW9uKCl7c2VsZi5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXM7fSxmaXJlZDpmdW5jdGlvbigpe3JldHVybiEhZmlyZWQ7fX07cmV0dXJuIHNlbGY7fTtqUXVlcnkuZXh0ZW5kKHtEZWZlcnJlZDpmdW5jdGlvbihmdW5jKXt2YXIgdHVwbGVzPVtbInJlc29sdmUiLCJkb25lIixqUXVlcnkuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLCJyZXNvbHZlZCJdLFsicmVqZWN0IiwiZmFpbCIsalF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwicmVqZWN0ZWQiXSxbIm5vdGlmeSIsInByb2dyZXNzIixqUXVlcnkuQ2FsbGJhY2tzKCJtZW1vcnkiKV1dLHN0YXRlPSJwZW5kaW5nIixwcm9taXNlPXtzdGF0ZTpmdW5jdGlvbigpe3JldHVybiBzdGF0ZTt9LGFsd2F5czpmdW5jdGlvbigpe2RlZmVycmVkLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyk7cmV0dXJuIHRoaXM7fSx0aGVuOmZ1bmN0aW9uKCl7dmFyIGZucz1hcmd1bWVudHM7cmV0dXJuIGpRdWVyeS5EZWZlcnJlZChmdW5jdGlvbihuZXdEZWZlcil7alF1ZXJ5LmVhY2godHVwbGVzLGZ1bmN0aW9uKGksdHVwbGUpe3ZhciBmbj1qUXVlcnkuaXNGdW5jdGlvbihmbnNbaV0pJiZmbnNbaV07ZGVmZXJyZWRbdHVwbGVbMV1dKGZ1bmN0aW9uKCl7dmFyIHJldHVybmVkPWZuJiZmbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYocmV0dXJuZWQmJmpRdWVyeS5pc0Z1bmN0aW9uKHJldHVybmVkLnByb21pc2UpKXtyZXR1cm5lZC5wcm9taXNlKCkuZG9uZShuZXdEZWZlci5yZXNvbHZlKS5mYWlsKG5ld0RlZmVyLnJlamVjdCkucHJvZ3Jlc3MobmV3RGVmZXIubm90aWZ5KTt9ZWxzZXtuZXdEZWZlclt0dXBsZVswXSsiV2l0aCJdKHRoaXM9PT1wcm9taXNlP25ld0RlZmVyLnByb21pc2UoKTp0aGlzLGZuP1tyZXR1cm5lZF06YXJndW1lbnRzKTt9fSk7fSk7Zm5zPW51bGw7fSkucHJvbWlzZSgpO30scHJvbWlzZTpmdW5jdGlvbihvYmope3JldHVybiBvYmohPW51bGw/alF1ZXJ5LmV4dGVuZChvYmoscHJvbWlzZSk6cHJvbWlzZTt9fSxkZWZlcnJlZD17fTtwcm9taXNlLnBpcGU9cHJvbWlzZS50aGVuO2pRdWVyeS5lYWNoKHR1cGxlcyxmdW5jdGlvbihpLHR1cGxlKXt2YXIgbGlzdD10dXBsZVsyXSxzdGF0ZVN0cmluZz10dXBsZVszXTtwcm9taXNlW3R1cGxlWzFdXT1saXN0LmFkZDtpZihzdGF0ZVN0cmluZyl7bGlzdC5hZGQoZnVuY3Rpb24oKXtzdGF0ZT1zdGF0ZVN0cmluZzt9LHR1cGxlc1tpXjFdWzJdLmRpc2FibGUsdHVwbGVzWzJdWzJdLmxvY2spO30KZGVmZXJyZWRbdHVwbGVbMF1dPWZ1bmN0aW9uKCl7ZGVmZXJyZWRbdHVwbGVbMF0rIldpdGgiXSh0aGlzPT09ZGVmZXJyZWQ/cHJvbWlzZTp0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXM7fTtkZWZlcnJlZFt0dXBsZVswXSsiV2l0aCJdPWxpc3QuZmlyZVdpdGg7fSk7cHJvbWlzZS5wcm9taXNlKGRlZmVycmVkKTtpZihmdW5jKXtmdW5jLmNhbGwoZGVmZXJyZWQsZGVmZXJyZWQpO30KcmV0dXJuIGRlZmVycmVkO30sd2hlbjpmdW5jdGlvbihzdWJvcmRpbmF0ZSl7dmFyIGk9MCxyZXNvbHZlVmFsdWVzPXNsaWNlLmNhbGwoYXJndW1lbnRzKSxsZW5ndGg9cmVzb2x2ZVZhbHVlcy5sZW5ndGgscmVtYWluaW5nPWxlbmd0aCE9PTF8fChzdWJvcmRpbmF0ZSYmalF1ZXJ5LmlzRnVuY3Rpb24oc3Vib3JkaW5hdGUucHJvbWlzZSkpP2xlbmd0aDowLGRlZmVycmVkPXJlbWFpbmluZz09PTE/c3Vib3JkaW5hdGU6alF1ZXJ5LkRlZmVycmVkKCksdXBkYXRlRnVuYz1mdW5jdGlvbihpLGNvbnRleHRzLHZhbHVlcyl7cmV0dXJuIGZ1bmN0aW9uKHZhbHVlKXtjb250ZXh0c1tpXT10aGlzO3ZhbHVlc1tpXT1hcmd1bWVudHMubGVuZ3RoPjE/c2xpY2UuY2FsbChhcmd1bWVudHMpOnZhbHVlO2lmKHZhbHVlcz09PXByb2dyZXNzVmFsdWVzKXtkZWZlcnJlZC5ub3RpZnlXaXRoKGNvbnRleHRzLHZhbHVlcyk7fWVsc2UgaWYoISgtLXJlbWFpbmluZykpe2RlZmVycmVkLnJlc29sdmVXaXRoKGNvbnRleHRzLHZhbHVlcyk7fX07fSxwcm9ncmVzc1ZhbHVlcyxwcm9ncmVzc0NvbnRleHRzLHJlc29sdmVDb250ZXh0cztpZihsZW5ndGg+MSl7cHJvZ3Jlc3NWYWx1ZXM9bmV3IEFycmF5KGxlbmd0aCk7cHJvZ3Jlc3NDb250ZXh0cz1uZXcgQXJyYXkobGVuZ3RoKTtyZXNvbHZlQ29udGV4dHM9bmV3IEFycmF5KGxlbmd0aCk7Zm9yKDtpPGxlbmd0aDtpKyspe2lmKHJlc29sdmVWYWx1ZXNbaV0mJmpRdWVyeS5pc0Z1bmN0aW9uKHJlc29sdmVWYWx1ZXNbaV0ucHJvbWlzZSkpe3Jlc29sdmVWYWx1ZXNbaV0ucHJvbWlzZSgpLmRvbmUodXBkYXRlRnVuYyhpLHJlc29sdmVDb250ZXh0cyxyZXNvbHZlVmFsdWVzKSkuZmFpbChkZWZlcnJlZC5yZWplY3QpLnByb2dyZXNzKHVwZGF0ZUZ1bmMoaSxwcm9ncmVzc0NvbnRleHRzLHByb2dyZXNzVmFsdWVzKSk7fWVsc2V7LS1yZW1haW5pbmc7fX19CmlmKCFyZW1haW5pbmcpe2RlZmVycmVkLnJlc29sdmVXaXRoKHJlc29sdmVDb250ZXh0cyxyZXNvbHZlVmFsdWVzKTt9CnJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7fX0pO3ZhciByZWFkeUxpc3Q7alF1ZXJ5LmZuLnJlYWR5PWZ1bmN0aW9uKGZuKXtqUXVlcnkucmVhZHkucHJvbWlzZSgpLmRvbmUoZm4pO3JldHVybiB0aGlzO307alF1ZXJ5LmV4dGVuZCh7aXNSZWFkeTpmYWxzZSxyZWFkeVdhaXQ6MSxob2xkUmVhZHk6ZnVuY3Rpb24oaG9sZCl7aWYoaG9sZCl7alF1ZXJ5LnJlYWR5V2FpdCsrO31lbHNle2pRdWVyeS5yZWFkeSh0cnVlKTt9fSxyZWFkeTpmdW5jdGlvbih3YWl0KXtpZih3YWl0PT09dHJ1ZT8tLWpRdWVyeS5yZWFkeVdhaXQ6alF1ZXJ5LmlzUmVhZHkpe3JldHVybjt9CmlmKCFkb2N1bWVudC5ib2R5KXtyZXR1cm4gc2V0VGltZW91dChqUXVlcnkucmVhZHkpO30KalF1ZXJ5LmlzUmVhZHk9dHJ1ZTtpZih3YWl0IT09dHJ1ZSYmLS1qUXVlcnkucmVhZHlXYWl0PjApe3JldHVybjt9CnJlYWR5TGlzdC5yZXNvbHZlV2l0aChkb2N1bWVudCxbalF1ZXJ5XSk7aWYoalF1ZXJ5LmZuLnRyaWdnZXIpe2pRdWVyeShkb2N1bWVudCkudHJpZ2dlcigicmVhZHkiKS5vZmYoInJlYWR5Iik7fX19KTtmdW5jdGlvbiBkZXRhY2goKXtpZihkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixjb21wbGV0ZWQsZmFsc2UpO3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixjb21wbGV0ZWQsZmFsc2UpO31lbHNle2RvY3VtZW50LmRldGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLGNvbXBsZXRlZCk7d2luZG93LmRldGFjaEV2ZW50KCJvbmxvYWQiLGNvbXBsZXRlZCk7fX0KZnVuY3Rpb24gY29tcGxldGVkKCl7aWYoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcnx8ZXZlbnQudHlwZT09PSJsb2FkInx8ZG9jdW1lbnQucmVhZHlTdGF0ZT09PSJjb21wbGV0ZSIpe2RldGFjaCgpO2pRdWVyeS5yZWFkeSgpO319CmpRdWVyeS5yZWFkeS5wcm9taXNlPWZ1bmN0aW9uKG9iail7aWYoIXJlYWR5TGlzdCl7cmVhZHlMaXN0PWpRdWVyeS5EZWZlcnJlZCgpO2lmKGRvY3VtZW50LnJlYWR5U3RhdGU9PT0iY29tcGxldGUiKXtzZXRUaW1lb3V0KGpRdWVyeS5yZWFkeSk7fWVsc2UgaWYoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcil7ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsY29tcGxldGVkLGZhbHNlKTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsY29tcGxldGVkLGZhbHNlKTt9ZWxzZXtkb2N1bWVudC5hdHRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIixjb21wbGV0ZWQpO3dpbmRvdy5hdHRhY2hFdmVudCgib25sb2FkIixjb21wbGV0ZWQpO3ZhciB0b3A9ZmFsc2U7dHJ5e3RvcD13aW5kb3cuZnJhbWVFbGVtZW50PT1udWxsJiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7fWNhdGNoKGUpe30KaWYodG9wJiZ0b3AuZG9TY3JvbGwpeyhmdW5jdGlvbiBkb1Njcm9sbENoZWNrKCl7aWYoIWpRdWVyeS5pc1JlYWR5KXt0cnl7dG9wLmRvU2Nyb2xsKCJsZWZ0Iik7fWNhdGNoKGUpe3JldHVybiBzZXRUaW1lb3V0KGRvU2Nyb2xsQ2hlY2ssNTApO30KZGV0YWNoKCk7alF1ZXJ5LnJlYWR5KCk7fX0pKCk7fX19CnJldHVybiByZWFkeUxpc3QucHJvbWlzZShvYmopO307dmFyIHN0cnVuZGVmaW5lZD10eXBlb2YgdW5kZWZpbmVkO3ZhciBpO2ZvcihpIGluIGpRdWVyeShzdXBwb3J0KSl7YnJlYWs7fQpzdXBwb3J0Lm93bkxhc3Q9aSE9PSIwIjtzdXBwb3J0LmlubGluZUJsb2NrTmVlZHNMYXlvdXQ9ZmFsc2U7alF1ZXJ5KGZ1bmN0aW9uKCl7dmFyIGNvbnRhaW5lcixkaXYsYm9keT1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdO2lmKCFib2R5KXtyZXR1cm47fQpjb250YWluZXI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Y29udGFpbmVyLnN0eWxlLmNzc1RleHQ9ImJvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDotOTk5OXB4O21hcmdpbi10b3A6MXB4IjtkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Ym9keS5hcHBlbmRDaGlsZChjb250YWluZXIpLmFwcGVuZENoaWxkKGRpdik7aWYodHlwZW9mIGRpdi5zdHlsZS56b29tIT09c3RydW5kZWZpbmVkKXtkaXYuc3R5bGUuY3NzVGV4dD0iYm9yZGVyOjA7bWFyZ2luOjA7d2lkdGg6MXB4O3BhZGRpbmc6MXB4O2Rpc3BsYXk6aW5saW5lO3pvb206MSI7aWYoKHN1cHBvcnQuaW5saW5lQmxvY2tOZWVkc0xheW91dD0oZGl2Lm9mZnNldFdpZHRoPT09MykpKXtib2R5LnN0eWxlLnpvb209MTt9fQpib2R5LnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7Y29udGFpbmVyPWRpdj1udWxsO30pOyhmdW5jdGlvbigpe3ZhciBkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7aWYoc3VwcG9ydC5kZWxldGVFeHBhbmRvPT1udWxsKXtzdXBwb3J0LmRlbGV0ZUV4cGFuZG89dHJ1ZTt0cnl7ZGVsZXRlIGRpdi50ZXN0O31jYXRjaChlKXtzdXBwb3J0LmRlbGV0ZUV4cGFuZG89ZmFsc2U7fX0KZGl2PW51bGw7fSkoKTtqUXVlcnkuYWNjZXB0RGF0YT1mdW5jdGlvbihlbGVtKXt2YXIgbm9EYXRhPWpRdWVyeS5ub0RhdGFbKGVsZW0ubm9kZU5hbWUrIiAiKS50b0xvd2VyQ2FzZSgpXSxub2RlVHlwZT0rZWxlbS5ub2RlVHlwZXx8MTtyZXR1cm4gbm9kZVR5cGUhPT0xJiZub2RlVHlwZSE9PTk/ZmFsc2U6IW5vRGF0YXx8bm9EYXRhIT09dHJ1ZSYmZWxlbS5nZXRBdHRyaWJ1dGUoImNsYXNzaWQiKT09PW5vRGF0YTt9O3ZhciByYnJhY2U9L14oPzpce1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLyxybXVsdGlEYXNoPS8oW0EtWl0pL2c7ZnVuY3Rpb24gZGF0YUF0dHIoZWxlbSxrZXksZGF0YSl7aWYoZGF0YT09PXVuZGVmaW5lZCYmZWxlbS5ub2RlVHlwZT09PTEpe3ZhciBuYW1lPSJkYXRhLSIra2V5LnJlcGxhY2Uocm11bHRpRGFzaCwiLSQxIikudG9Mb3dlckNhc2UoKTtkYXRhPWVsZW0uZ2V0QXR0cmlidXRlKG5hbWUpO2lmKHR5cGVvZiBkYXRhPT09InN0cmluZyIpe3RyeXtkYXRhPWRhdGE9PT0idHJ1ZSI/dHJ1ZTpkYXRhPT09ImZhbHNlIj9mYWxzZTpkYXRhPT09Im51bGwiP251bGw6K2RhdGErIiI9PT1kYXRhPytkYXRhOnJicmFjZS50ZXN0KGRhdGEpP2pRdWVyeS5wYXJzZUpTT04oZGF0YSk6ZGF0YTt9Y2F0Y2goZSl7fQpqUXVlcnkuZGF0YShlbGVtLGtleSxkYXRhKTt9ZWxzZXtkYXRhPXVuZGVmaW5lZDt9fQpyZXR1cm4gZGF0YTt9CmZ1bmN0aW9uIGlzRW1wdHlEYXRhT2JqZWN0KG9iail7dmFyIG5hbWU7Zm9yKG5hbWUgaW4gb2JqKXtpZihuYW1lPT09ImRhdGEiJiZqUXVlcnkuaXNFbXB0eU9iamVjdChvYmpbbmFtZV0pKXtjb250aW51ZTt9CmlmKG5hbWUhPT0idG9KU09OIil7cmV0dXJuIGZhbHNlO319CnJldHVybiB0cnVlO30KZnVuY3Rpb24gaW50ZXJuYWxEYXRhKGVsZW0sbmFtZSxkYXRhLHB2dCl7aWYoIWpRdWVyeS5hY2NlcHREYXRhKGVsZW0pKXtyZXR1cm47fQp2YXIgcmV0LHRoaXNDYWNoZSxpbnRlcm5hbEtleT1qUXVlcnkuZXhwYW5kbyxpc05vZGU9ZWxlbS5ub2RlVHlwZSxjYWNoZT1pc05vZGU/alF1ZXJ5LmNhY2hlOmVsZW0saWQ9aXNOb2RlP2VsZW1baW50ZXJuYWxLZXldOmVsZW1baW50ZXJuYWxLZXldJiZpbnRlcm5hbEtleTtpZigoIWlkfHwhY2FjaGVbaWRdfHwoIXB2dCYmIWNhY2hlW2lkXS5kYXRhKSkmJmRhdGE9PT11bmRlZmluZWQmJnR5cGVvZiBuYW1lPT09InN0cmluZyIpe3JldHVybjt9CmlmKCFpZCl7aWYoaXNOb2RlKXtpZD1lbGVtW2ludGVybmFsS2V5XT1kZWxldGVkSWRzLnBvcCgpfHxqUXVlcnkuZ3VpZCsrO31lbHNle2lkPWludGVybmFsS2V5O319CmlmKCFjYWNoZVtpZF0pe2NhY2hlW2lkXT1pc05vZGU/e306e3RvSlNPTjpqUXVlcnkubm9vcH07fQppZih0eXBlb2YgbmFtZT09PSJvYmplY3QifHx0eXBlb2YgbmFtZT09PSJmdW5jdGlvbiIpe2lmKHB2dCl7Y2FjaGVbaWRdPWpRdWVyeS5leHRlbmQoY2FjaGVbaWRdLG5hbWUpO31lbHNle2NhY2hlW2lkXS5kYXRhPWpRdWVyeS5leHRlbmQoY2FjaGVbaWRdLmRhdGEsbmFtZSk7fX0KdGhpc0NhY2hlPWNhY2hlW2lkXTtpZighcHZ0KXtpZighdGhpc0NhY2hlLmRhdGEpe3RoaXNDYWNoZS5kYXRhPXt9O30KdGhpc0NhY2hlPXRoaXNDYWNoZS5kYXRhO30KaWYoZGF0YSE9PXVuZGVmaW5lZCl7dGhpc0NhY2hlW2pRdWVyeS5jYW1lbENhc2UobmFtZSldPWRhdGE7fQppZih0eXBlb2YgbmFtZT09PSJzdHJpbmciKXtyZXQ9dGhpc0NhY2hlW25hbWVdO2lmKHJldD09bnVsbCl7cmV0PXRoaXNDYWNoZVtqUXVlcnkuY2FtZWxDYXNlKG5hbWUpXTt9fWVsc2V7cmV0PXRoaXNDYWNoZTt9CnJldHVybiByZXQ7fQpmdW5jdGlvbiBpbnRlcm5hbFJlbW92ZURhdGEoZWxlbSxuYW1lLHB2dCl7aWYoIWpRdWVyeS5hY2NlcHREYXRhKGVsZW0pKXtyZXR1cm47fQp2YXIgdGhpc0NhY2hlLGksaXNOb2RlPWVsZW0ubm9kZVR5cGUsY2FjaGU9aXNOb2RlP2pRdWVyeS5jYWNoZTplbGVtLGlkPWlzTm9kZT9lbGVtW2pRdWVyeS5leHBhbmRvXTpqUXVlcnkuZXhwYW5kbztpZighY2FjaGVbaWRdKXtyZXR1cm47fQppZihuYW1lKXt0aGlzQ2FjaGU9cHZ0P2NhY2hlW2lkXTpjYWNoZVtpZF0uZGF0YTtpZih0aGlzQ2FjaGUpe2lmKCFqUXVlcnkuaXNBcnJheShuYW1lKSl7aWYobmFtZSBpbiB0aGlzQ2FjaGUpe25hbWU9W25hbWVdO31lbHNle25hbWU9alF1ZXJ5LmNhbWVsQ2FzZShuYW1lKTtpZihuYW1lIGluIHRoaXNDYWNoZSl7bmFtZT1bbmFtZV07fWVsc2V7bmFtZT1uYW1lLnNwbGl0KCIgIik7fX19ZWxzZXtuYW1lPW5hbWUuY29uY2F0KGpRdWVyeS5tYXAobmFtZSxqUXVlcnkuY2FtZWxDYXNlKSk7fQppPW5hbWUubGVuZ3RoO3doaWxlKGktLSl7ZGVsZXRlIHRoaXNDYWNoZVtuYW1lW2ldXTt9CmlmKHB2dD8haXNFbXB0eURhdGFPYmplY3QodGhpc0NhY2hlKTohalF1ZXJ5LmlzRW1wdHlPYmplY3QodGhpc0NhY2hlKSl7cmV0dXJuO319fQppZighcHZ0KXtkZWxldGUgY2FjaGVbaWRdLmRhdGE7aWYoIWlzRW1wdHlEYXRhT2JqZWN0KGNhY2hlW2lkXSkpe3JldHVybjt9fQppZihpc05vZGUpe2pRdWVyeS5jbGVhbkRhdGEoW2VsZW1dLHRydWUpO31lbHNlIGlmKHN1cHBvcnQuZGVsZXRlRXhwYW5kb3x8Y2FjaGUhPWNhY2hlLndpbmRvdyl7ZGVsZXRlIGNhY2hlW2lkXTt9ZWxzZXtjYWNoZVtpZF09bnVsbDt9fQpqUXVlcnkuZXh0ZW5kKHtjYWNoZTp7fSxub0RhdGE6eyJhcHBsZXQgIjp0cnVlLCJlbWJlZCAiOnRydWUsIm9iamVjdCAiOiJjbHNpZDpEMjdDREI2RS1BRTZELTExY2YtOTZCOC00NDQ1NTM1NDAwMDAifSxoYXNEYXRhOmZ1bmN0aW9uKGVsZW0pe2VsZW09ZWxlbS5ub2RlVHlwZT9qUXVlcnkuY2FjaGVbZWxlbVtqUXVlcnkuZXhwYW5kb11dOmVsZW1balF1ZXJ5LmV4cGFuZG9dO3JldHVybiEhZWxlbSYmIWlzRW1wdHlEYXRhT2JqZWN0KGVsZW0pO30sZGF0YTpmdW5jdGlvbihlbGVtLG5hbWUsZGF0YSl7cmV0dXJuIGludGVybmFsRGF0YShlbGVtLG5hbWUsZGF0YSk7fSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGVsZW0sbmFtZSl7cmV0dXJuIGludGVybmFsUmVtb3ZlRGF0YShlbGVtLG5hbWUpO30sX2RhdGE6ZnVuY3Rpb24oZWxlbSxuYW1lLGRhdGEpe3JldHVybiBpbnRlcm5hbERhdGEoZWxlbSxuYW1lLGRhdGEsdHJ1ZSk7fSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihlbGVtLG5hbWUpe3JldHVybiBpbnRlcm5hbFJlbW92ZURhdGEoZWxlbSxuYW1lLHRydWUpO319KTtqUXVlcnkuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGtleSx2YWx1ZSl7dmFyIGksbmFtZSxkYXRhLGVsZW09dGhpc1swXSxhdHRycz1lbGVtJiZlbGVtLmF0dHJpYnV0ZXM7aWYoa2V5PT09dW5kZWZpbmVkKXtpZih0aGlzLmxlbmd0aCl7ZGF0YT1qUXVlcnkuZGF0YShlbGVtKTtpZihlbGVtLm5vZGVUeXBlPT09MSYmIWpRdWVyeS5fZGF0YShlbGVtLCJwYXJzZWRBdHRycyIpKXtpPWF0dHJzLmxlbmd0aDt3aGlsZShpLS0pe25hbWU9YXR0cnNbaV0ubmFtZTtpZihuYW1lLmluZGV4T2YoImRhdGEtIik9PT0wKXtuYW1lPWpRdWVyeS5jYW1lbENhc2UobmFtZS5zbGljZSg1KSk7ZGF0YUF0dHIoZWxlbSxuYW1lLGRhdGFbbmFtZV0pO319CmpRdWVyeS5fZGF0YShlbGVtLCJwYXJzZWRBdHRycyIsdHJ1ZSk7fX0KcmV0dXJuIGRhdGE7fQppZih0eXBlb2Yga2V5PT09Im9iamVjdCIpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkuZGF0YSh0aGlzLGtleSk7fSk7fQpyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4xP3RoaXMuZWFjaChmdW5jdGlvbigpe2pRdWVyeS5kYXRhKHRoaXMsa2V5LHZhbHVlKTt9KTplbGVtP2RhdGFBdHRyKGVsZW0sa2V5LGpRdWVyeS5kYXRhKGVsZW0sa2V5KSk6dW5kZWZpbmVkO30scmVtb3ZlRGF0YTpmdW5jdGlvbihrZXkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkucmVtb3ZlRGF0YSh0aGlzLGtleSk7fSk7fX0pO2pRdWVyeS5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGVsZW0sdHlwZSxkYXRhKXt2YXIgcXVldWU7aWYoZWxlbSl7dHlwZT0odHlwZXx8ImZ4IikrInF1ZXVlIjtxdWV1ZT1qUXVlcnkuX2RhdGEoZWxlbSx0eXBlKTtpZihkYXRhKXtpZighcXVldWV8fGpRdWVyeS5pc0FycmF5KGRhdGEpKXtxdWV1ZT1qUXVlcnkuX2RhdGEoZWxlbSx0eXBlLGpRdWVyeS5tYWtlQXJyYXkoZGF0YSkpO31lbHNle3F1ZXVlLnB1c2goZGF0YSk7fX0KcmV0dXJuIHF1ZXVlfHxbXTt9fSxkZXF1ZXVlOmZ1bmN0aW9uKGVsZW0sdHlwZSl7dHlwZT10eXBlfHwiZngiO3ZhciBxdWV1ZT1qUXVlcnkucXVldWUoZWxlbSx0eXBlKSxzdGFydExlbmd0aD1xdWV1ZS5sZW5ndGgsZm49cXVldWUuc2hpZnQoKSxob29rcz1qUXVlcnkuX3F1ZXVlSG9va3MoZWxlbSx0eXBlKSxuZXh0PWZ1bmN0aW9uKCl7alF1ZXJ5LmRlcXVldWUoZWxlbSx0eXBlKTt9O2lmKGZuPT09ImlucHJvZ3Jlc3MiKXtmbj1xdWV1ZS5zaGlmdCgpO3N0YXJ0TGVuZ3RoLS07fQppZihmbil7aWYodHlwZT09PSJmeCIpe3F1ZXVlLnVuc2hpZnQoImlucHJvZ3Jlc3MiKTt9CmRlbGV0ZSBob29rcy5zdG9wO2ZuLmNhbGwoZWxlbSxuZXh0LGhvb2tzKTt9CmlmKCFzdGFydExlbmd0aCYmaG9va3Mpe2hvb2tzLmVtcHR5LmZpcmUoKTt9fSxfcXVldWVIb29rczpmdW5jdGlvbihlbGVtLHR5cGUpe3ZhciBrZXk9dHlwZSsicXVldWVIb29rcyI7cmV0dXJuIGpRdWVyeS5fZGF0YShlbGVtLGtleSl8fGpRdWVyeS5fZGF0YShlbGVtLGtleSx7ZW1wdHk6alF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKS5hZGQoZnVuY3Rpb24oKXtqUXVlcnkuX3JlbW92ZURhdGEoZWxlbSx0eXBlKyJxdWV1ZSIpO2pRdWVyeS5fcmVtb3ZlRGF0YShlbGVtLGtleSk7fSl9KTt9fSk7alF1ZXJ5LmZuLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24odHlwZSxkYXRhKXt2YXIgc2V0dGVyPTI7aWYodHlwZW9mIHR5cGUhPT0ic3RyaW5nIil7ZGF0YT10eXBlO3R5cGU9ImZ4IjtzZXR0ZXItLTt9CmlmKGFyZ3VtZW50cy5sZW5ndGg8c2V0dGVyKXtyZXR1cm4galF1ZXJ5LnF1ZXVlKHRoaXNbMF0sdHlwZSk7fQpyZXR1cm4gZGF0YT09PXVuZGVmaW5lZD90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBxdWV1ZT1qUXVlcnkucXVldWUodGhpcyx0eXBlLGRhdGEpO2pRdWVyeS5fcXVldWVIb29rcyh0aGlzLHR5cGUpO2lmKHR5cGU9PT0iZngiJiZxdWV1ZVswXSE9PSJpbnByb2dyZXNzIil7alF1ZXJ5LmRlcXVldWUodGhpcyx0eXBlKTt9fSk7fSxkZXF1ZXVlOmZ1bmN0aW9uKHR5cGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkuZGVxdWV1ZSh0aGlzLHR5cGUpO30pO30sY2xlYXJRdWV1ZTpmdW5jdGlvbih0eXBlKXtyZXR1cm4gdGhpcy5xdWV1ZSh0eXBlfHwiZngiLFtdKTt9LHByb21pc2U6ZnVuY3Rpb24odHlwZSxvYmope3ZhciB0bXAsY291bnQ9MSxkZWZlcj1qUXVlcnkuRGVmZXJyZWQoKSxlbGVtZW50cz10aGlzLGk9dGhpcy5sZW5ndGgscmVzb2x2ZT1mdW5jdGlvbigpe2lmKCEoLS1jb3VudCkpe2RlZmVyLnJlc29sdmVXaXRoKGVsZW1lbnRzLFtlbGVtZW50c10pO319O2lmKHR5cGVvZiB0eXBlIT09InN0cmluZyIpe29iaj10eXBlO3R5cGU9dW5kZWZpbmVkO30KdHlwZT10eXBlfHwiZngiO3doaWxlKGktLSl7dG1wPWpRdWVyeS5fZGF0YShlbGVtZW50c1tpXSx0eXBlKyJxdWV1ZUhvb2tzIik7aWYodG1wJiZ0bXAuZW1wdHkpe2NvdW50Kys7dG1wLmVtcHR5LmFkZChyZXNvbHZlKTt9fQpyZXNvbHZlKCk7cmV0dXJuIGRlZmVyLnByb21pc2Uob2JqKTt9fSk7dmFyIHBudW09KC9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8pLnNvdXJjZTt2YXIgY3NzRXhwYW5kPVsiVG9wIiwiUmlnaHQiLCJCb3R0b20iLCJMZWZ0Il07dmFyIGlzSGlkZGVuPWZ1bmN0aW9uKGVsZW0sZWwpe2VsZW09ZWx8fGVsZW07cmV0dXJuIGpRdWVyeS5jc3MoZWxlbSwiZGlzcGxheSIpPT09Im5vbmUifHwhalF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCxlbGVtKTt9O3ZhciBhY2Nlc3M9alF1ZXJ5LmFjY2Vzcz1mdW5jdGlvbihlbGVtcyxmbixrZXksdmFsdWUsY2hhaW5hYmxlLGVtcHR5R2V0LHJhdyl7dmFyIGk9MCxsZW5ndGg9ZWxlbXMubGVuZ3RoLGJ1bGs9a2V5PT1udWxsO2lmKGpRdWVyeS50eXBlKGtleSk9PT0ib2JqZWN0Iil7Y2hhaW5hYmxlPXRydWU7Zm9yKGkgaW4ga2V5KXtqUXVlcnkuYWNjZXNzKGVsZW1zLGZuLGksa2V5W2ldLHRydWUsZW1wdHlHZXQscmF3KTt9fWVsc2UgaWYodmFsdWUhPT11bmRlZmluZWQpe2NoYWluYWJsZT10cnVlO2lmKCFqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpe3Jhdz10cnVlO30KaWYoYnVsayl7aWYocmF3KXtmbi5jYWxsKGVsZW1zLHZhbHVlKTtmbj1udWxsO31lbHNle2J1bGs9Zm47Zm49ZnVuY3Rpb24oZWxlbSxrZXksdmFsdWUpe3JldHVybiBidWxrLmNhbGwoalF1ZXJ5KGVsZW0pLHZhbHVlKTt9O319CmlmKGZuKXtmb3IoO2k8bGVuZ3RoO2krKyl7Zm4oZWxlbXNbaV0sa2V5LHJhdz92YWx1ZTp2YWx1ZS5jYWxsKGVsZW1zW2ldLGksZm4oZWxlbXNbaV0sa2V5KSkpO319fQpyZXR1cm4gY2hhaW5hYmxlP2VsZW1zOmJ1bGs/Zm4uY2FsbChlbGVtcyk6bGVuZ3RoP2ZuKGVsZW1zWzBdLGtleSk6ZW1wdHlHZXQ7fTt2YXIgcmNoZWNrYWJsZVR5cGU9KC9eKD86Y2hlY2tib3h8cmFkaW8pJC9pKTsoZnVuY3Rpb24oKXt2YXIgZnJhZ21lbnQ9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxpbnB1dD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO2Rpdi5zZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIsInQiKTtkaXYuaW5uZXJIVE1MPSIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT4iO3N1cHBvcnQubGVhZGluZ1doaXRlc3BhY2U9ZGl2LmZpcnN0Q2hpbGQubm9kZVR5cGU9PT0zO3N1cHBvcnQudGJvZHk9IWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGJvZHkiKS5sZW5ndGg7c3VwcG9ydC5odG1sU2VyaWFsaXplPSEhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJsaW5rIikubGVuZ3RoO3N1cHBvcnQuaHRtbDVDbG9uZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJuYXYiKS5jbG9uZU5vZGUodHJ1ZSkub3V0ZXJIVE1MIT09Ijw6bmF2PjwvOm5hdj4iO2lucHV0LnR5cGU9ImNoZWNrYm94IjtpbnB1dC5jaGVja2VkPXRydWU7ZnJhZ21lbnQuYXBwZW5kQ2hpbGQoaW5wdXQpO3N1cHBvcnQuYXBwZW5kQ2hlY2tlZD1pbnB1dC5jaGVja2VkO2Rpdi5pbm5lckhUTUw9Ijx0ZXh0YXJlYT54PC90ZXh0YXJlYT4iO3N1cHBvcnQubm9DbG9uZUNoZWNrZWQ9ISFkaXYuY2xvbmVOb2RlKHRydWUpLmxhc3RDaGlsZC5kZWZhdWx0VmFsdWU7ZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZGl2KTtkaXYuaW5uZXJIVE1MPSI8aW5wdXQgdHlwZT0ncmFkaW8nIGNoZWNrZWQ9J2NoZWNrZWQnIG5hbWU9J3QnLz4iO3N1cHBvcnQuY2hlY2tDbG9uZT1kaXYuY2xvbmVOb2RlKHRydWUpLmNsb25lTm9kZSh0cnVlKS5sYXN0Q2hpbGQuY2hlY2tlZDtzdXBwb3J0Lm5vQ2xvbmVFdmVudD10cnVlO2lmKGRpdi5hdHRhY2hFdmVudCl7ZGl2LmF0dGFjaEV2ZW50KCJvbmNsaWNrIixmdW5jdGlvbigpe3N1cHBvcnQubm9DbG9uZUV2ZW50PWZhbHNlO30pO2Rpdi5jbG9uZU5vZGUodHJ1ZSkuY2xpY2soKTt9CmlmKHN1cHBvcnQuZGVsZXRlRXhwYW5kbz09bnVsbCl7c3VwcG9ydC5kZWxldGVFeHBhbmRvPXRydWU7dHJ5e2RlbGV0ZSBkaXYudGVzdDt9Y2F0Y2goZSl7c3VwcG9ydC5kZWxldGVFeHBhbmRvPWZhbHNlO319CmZyYWdtZW50PWRpdj1pbnB1dD1udWxsO30pKCk7KGZ1bmN0aW9uKCl7dmFyIGksZXZlbnROYW1lLGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtmb3IoaSBpbntzdWJtaXQ6dHJ1ZSxjaGFuZ2U6dHJ1ZSxmb2N1c2luOnRydWV9KXtldmVudE5hbWU9Im9uIitpO2lmKCEoc3VwcG9ydFtpKyJCdWJibGVzIl09ZXZlbnROYW1lIGluIHdpbmRvdykpe2Rpdi5zZXRBdHRyaWJ1dGUoZXZlbnROYW1lLCJ0Iik7c3VwcG9ydFtpKyJCdWJibGVzIl09ZGl2LmF0dHJpYnV0ZXNbZXZlbnROYW1lXS5leHBhbmRvPT09ZmFsc2U7fX0KZGl2PW51bGw7fSkoKTt2YXIgcmZvcm1FbGVtcz0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYSkkL2kscmtleUV2ZW50PS9ea2V5LyxybW91c2VFdmVudD0vXig/Om1vdXNlfGNvbnRleHRtZW51KXxjbGljay8scmZvY3VzTW9ycGg9L14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLHJ0eXBlbmFtZXNwYWNlPS9eKFteLl0qKSg/OlwuKC4rKXwpJC87ZnVuY3Rpb24gcmV0dXJuVHJ1ZSgpe3JldHVybiB0cnVlO30KZnVuY3Rpb24gcmV0dXJuRmFsc2UoKXtyZXR1cm4gZmFsc2U7fQpmdW5jdGlvbiBzYWZlQWN0aXZlRWxlbWVudCgpe3RyeXtyZXR1cm4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDt9Y2F0Y2goZXJyKXt9fQpqUXVlcnkuZXZlbnQ9e2dsb2JhbDp7fSxhZGQ6ZnVuY3Rpb24oZWxlbSx0eXBlcyxoYW5kbGVyLGRhdGEsc2VsZWN0b3Ipe3ZhciB0bXAsZXZlbnRzLHQsaGFuZGxlT2JqSW4sc3BlY2lhbCxldmVudEhhbmRsZSxoYW5kbGVPYmosaGFuZGxlcnMsdHlwZSxuYW1lc3BhY2VzLG9yaWdUeXBlLGVsZW1EYXRhPWpRdWVyeS5fZGF0YShlbGVtKTtpZighZWxlbURhdGEpe3JldHVybjt9CmlmKGhhbmRsZXIuaGFuZGxlcil7aGFuZGxlT2JqSW49aGFuZGxlcjtoYW5kbGVyPWhhbmRsZU9iakluLmhhbmRsZXI7c2VsZWN0b3I9aGFuZGxlT2JqSW4uc2VsZWN0b3I7fQppZighaGFuZGxlci5ndWlkKXtoYW5kbGVyLmd1aWQ9alF1ZXJ5Lmd1aWQrKzt9CmlmKCEoZXZlbnRzPWVsZW1EYXRhLmV2ZW50cykpe2V2ZW50cz1lbGVtRGF0YS5ldmVudHM9e307fQppZighKGV2ZW50SGFuZGxlPWVsZW1EYXRhLmhhbmRsZSkpe2V2ZW50SGFuZGxlPWVsZW1EYXRhLmhhbmRsZT1mdW5jdGlvbihlKXtyZXR1cm4gdHlwZW9mIGpRdWVyeSE9PXN0cnVuZGVmaW5lZCYmKCFlfHxqUXVlcnkuZXZlbnQudHJpZ2dlcmVkIT09ZS50eXBlKT9qUXVlcnkuZXZlbnQuZGlzcGF0Y2guYXBwbHkoZXZlbnRIYW5kbGUuZWxlbSxhcmd1bWVudHMpOnVuZGVmaW5lZDt9O2V2ZW50SGFuZGxlLmVsZW09ZWxlbTt9CnR5cGVzPSh0eXBlc3x8IiIpLm1hdGNoKHJub3R3aGl0ZSl8fFsiIl07dD10eXBlcy5sZW5ndGg7d2hpbGUodC0tKXt0bXA9cnR5cGVuYW1lc3BhY2UuZXhlYyh0eXBlc1t0XSl8fFtdO3R5cGU9b3JpZ1R5cGU9dG1wWzFdO25hbWVzcGFjZXM9KHRtcFsyXXx8IiIpLnNwbGl0KCIuIikuc29ydCgpO2lmKCF0eXBlKXtjb250aW51ZTt9CnNwZWNpYWw9alF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV18fHt9O3R5cGU9KHNlbGVjdG9yP3NwZWNpYWwuZGVsZWdhdGVUeXBlOnNwZWNpYWwuYmluZFR5cGUpfHx0eXBlO3NwZWNpYWw9alF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV18fHt9O2hhbmRsZU9iaj1qUXVlcnkuZXh0ZW5kKHt0eXBlOnR5cGUsb3JpZ1R5cGU6b3JpZ1R5cGUsZGF0YTpkYXRhLGhhbmRsZXI6aGFuZGxlcixndWlkOmhhbmRsZXIuZ3VpZCxzZWxlY3RvcjpzZWxlY3RvcixuZWVkc0NvbnRleHQ6c2VsZWN0b3ImJmpRdWVyeS5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KHNlbGVjdG9yKSxuYW1lc3BhY2U6bmFtZXNwYWNlcy5qb2luKCIuIil9LGhhbmRsZU9iakluKTtpZighKGhhbmRsZXJzPWV2ZW50c1t0eXBlXSkpe2hhbmRsZXJzPWV2ZW50c1t0eXBlXT1bXTtoYW5kbGVycy5kZWxlZ2F0ZUNvdW50PTA7aWYoIXNwZWNpYWwuc2V0dXB8fHNwZWNpYWwuc2V0dXAuY2FsbChlbGVtLGRhdGEsbmFtZXNwYWNlcyxldmVudEhhbmRsZSk9PT1mYWxzZSl7aWYoZWxlbS5hZGRFdmVudExpc3RlbmVyKXtlbGVtLmFkZEV2ZW50TGlzdGVuZXIodHlwZSxldmVudEhhbmRsZSxmYWxzZSk7fWVsc2UgaWYoZWxlbS5hdHRhY2hFdmVudCl7ZWxlbS5hdHRhY2hFdmVudCgib24iK3R5cGUsZXZlbnRIYW5kbGUpO319fQppZihzcGVjaWFsLmFkZCl7c3BlY2lhbC5hZGQuY2FsbChlbGVtLGhhbmRsZU9iaik7aWYoIWhhbmRsZU9iai5oYW5kbGVyLmd1aWQpe2hhbmRsZU9iai5oYW5kbGVyLmd1aWQ9aGFuZGxlci5ndWlkO319CmlmKHNlbGVjdG9yKXtoYW5kbGVycy5zcGxpY2UoaGFuZGxlcnMuZGVsZWdhdGVDb3VudCsrLDAsaGFuZGxlT2JqKTt9ZWxzZXtoYW5kbGVycy5wdXNoKGhhbmRsZU9iaik7fQpqUXVlcnkuZXZlbnQuZ2xvYmFsW3R5cGVdPXRydWU7fQplbGVtPW51bGw7fSxyZW1vdmU6ZnVuY3Rpb24oZWxlbSx0eXBlcyxoYW5kbGVyLHNlbGVjdG9yLG1hcHBlZFR5cGVzKXt2YXIgaixoYW5kbGVPYmosdG1wLG9yaWdDb3VudCx0LGV2ZW50cyxzcGVjaWFsLGhhbmRsZXJzLHR5cGUsbmFtZXNwYWNlcyxvcmlnVHlwZSxlbGVtRGF0YT1qUXVlcnkuaGFzRGF0YShlbGVtKSYmalF1ZXJ5Ll9kYXRhKGVsZW0pO2lmKCFlbGVtRGF0YXx8IShldmVudHM9ZWxlbURhdGEuZXZlbnRzKSl7cmV0dXJuO30KdHlwZXM9KHR5cGVzfHwiIikubWF0Y2gocm5vdHdoaXRlKXx8WyIiXTt0PXR5cGVzLmxlbmd0aDt3aGlsZSh0LS0pe3RtcD1ydHlwZW5hbWVzcGFjZS5leGVjKHR5cGVzW3RdKXx8W107dHlwZT1vcmlnVHlwZT10bXBbMV07bmFtZXNwYWNlcz0odG1wWzJdfHwiIikuc3BsaXQoIi4iKS5zb3J0KCk7aWYoIXR5cGUpe2Zvcih0eXBlIGluIGV2ZW50cyl7alF1ZXJ5LmV2ZW50LnJlbW92ZShlbGVtLHR5cGUrdHlwZXNbdF0saGFuZGxlcixzZWxlY3Rvcix0cnVlKTt9CmNvbnRpbnVlO30Kc3BlY2lhbD1qUXVlcnkuZXZlbnQuc3BlY2lhbFt0eXBlXXx8e307dHlwZT0oc2VsZWN0b3I/c3BlY2lhbC5kZWxlZ2F0ZVR5cGU6c3BlY2lhbC5iaW5kVHlwZSl8fHR5cGU7aGFuZGxlcnM9ZXZlbnRzW3R5cGVdfHxbXTt0bXA9dG1wWzJdJiZuZXcgUmVnRXhwKCIoXnxcXC4pIituYW1lc3BhY2VzLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpO29yaWdDb3VudD1qPWhhbmRsZXJzLmxlbmd0aDt3aGlsZShqLS0pe2hhbmRsZU9iaj1oYW5kbGVyc1tqXTtpZigobWFwcGVkVHlwZXN8fG9yaWdUeXBlPT09aGFuZGxlT2JqLm9yaWdUeXBlKSYmKCFoYW5kbGVyfHxoYW5kbGVyLmd1aWQ9PT1oYW5kbGVPYmouZ3VpZCkmJighdG1wfHx0bXAudGVzdChoYW5kbGVPYmoubmFtZXNwYWNlKSkmJighc2VsZWN0b3J8fHNlbGVjdG9yPT09aGFuZGxlT2JqLnNlbGVjdG9yfHxzZWxlY3Rvcj09PSIqKiImJmhhbmRsZU9iai5zZWxlY3Rvcikpe2hhbmRsZXJzLnNwbGljZShqLDEpO2lmKGhhbmRsZU9iai5zZWxlY3Rvcil7aGFuZGxlcnMuZGVsZWdhdGVDb3VudC0tO30KaWYoc3BlY2lhbC5yZW1vdmUpe3NwZWNpYWwucmVtb3ZlLmNhbGwoZWxlbSxoYW5kbGVPYmopO319fQppZihvcmlnQ291bnQmJiFoYW5kbGVycy5sZW5ndGgpe2lmKCFzcGVjaWFsLnRlYXJkb3dufHxzcGVjaWFsLnRlYXJkb3duLmNhbGwoZWxlbSxuYW1lc3BhY2VzLGVsZW1EYXRhLmhhbmRsZSk9PT1mYWxzZSl7alF1ZXJ5LnJlbW92ZUV2ZW50KGVsZW0sdHlwZSxlbGVtRGF0YS5oYW5kbGUpO30KZGVsZXRlIGV2ZW50c1t0eXBlXTt9fQppZihqUXVlcnkuaXNFbXB0eU9iamVjdChldmVudHMpKXtkZWxldGUgZWxlbURhdGEuaGFuZGxlO2pRdWVyeS5fcmVtb3ZlRGF0YShlbGVtLCJldmVudHMiKTt9fSx0cmlnZ2VyOmZ1bmN0aW9uKGV2ZW50LGRhdGEsZWxlbSxvbmx5SGFuZGxlcnMpe3ZhciBoYW5kbGUsb250eXBlLGN1cixidWJibGVUeXBlLHNwZWNpYWwsdG1wLGksZXZlbnRQYXRoPVtlbGVtfHxkb2N1bWVudF0sdHlwZT1oYXNPd24uY2FsbChldmVudCwidHlwZSIpP2V2ZW50LnR5cGU6ZXZlbnQsbmFtZXNwYWNlcz1oYXNPd24uY2FsbChldmVudCwibmFtZXNwYWNlIik/ZXZlbnQubmFtZXNwYWNlLnNwbGl0KCIuIik6W107Y3VyPXRtcD1lbGVtPWVsZW18fGRvY3VtZW50O2lmKGVsZW0ubm9kZVR5cGU9PT0zfHxlbGVtLm5vZGVUeXBlPT09OCl7cmV0dXJuO30KaWYocmZvY3VzTW9ycGgudGVzdCh0eXBlK2pRdWVyeS5ldmVudC50cmlnZ2VyZWQpKXtyZXR1cm47fQppZih0eXBlLmluZGV4T2YoIi4iKT49MCl7bmFtZXNwYWNlcz10eXBlLnNwbGl0KCIuIik7dHlwZT1uYW1lc3BhY2VzLnNoaWZ0KCk7bmFtZXNwYWNlcy5zb3J0KCk7fQpvbnR5cGU9dHlwZS5pbmRleE9mKCI6Iik8MCYmIm9uIit0eXBlO2V2ZW50PWV2ZW50W2pRdWVyeS5leHBhbmRvXT9ldmVudDpuZXcgalF1ZXJ5LkV2ZW50KHR5cGUsdHlwZW9mIGV2ZW50PT09Im9iamVjdCImJmV2ZW50KTtldmVudC5pc1RyaWdnZXI9b25seUhhbmRsZXJzPzI6MztldmVudC5uYW1lc3BhY2U9bmFtZXNwYWNlcy5qb2luKCIuIik7ZXZlbnQubmFtZXNwYWNlX3JlPWV2ZW50Lm5hbWVzcGFjZT9uZXcgUmVnRXhwKCIoXnxcXC4pIituYW1lc3BhY2VzLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpOm51bGw7ZXZlbnQucmVzdWx0PXVuZGVmaW5lZDtpZighZXZlbnQudGFyZ2V0KXtldmVudC50YXJnZXQ9ZWxlbTt9CmRhdGE9ZGF0YT09bnVsbD9bZXZlbnRdOmpRdWVyeS5tYWtlQXJyYXkoZGF0YSxbZXZlbnRdKTtzcGVjaWFsPWpRdWVyeS5ldmVudC5zcGVjaWFsW3R5cGVdfHx7fTtpZighb25seUhhbmRsZXJzJiZzcGVjaWFsLnRyaWdnZXImJnNwZWNpYWwudHJpZ2dlci5hcHBseShlbGVtLGRhdGEpPT09ZmFsc2Upe3JldHVybjt9CmlmKCFvbmx5SGFuZGxlcnMmJiFzcGVjaWFsLm5vQnViYmxlJiYhalF1ZXJ5LmlzV2luZG93KGVsZW0pKXtidWJibGVUeXBlPXNwZWNpYWwuZGVsZWdhdGVUeXBlfHx0eXBlO2lmKCFyZm9jdXNNb3JwaC50ZXN0KGJ1YmJsZVR5cGUrdHlwZSkpe2N1cj1jdXIucGFyZW50Tm9kZTt9CmZvcig7Y3VyO2N1cj1jdXIucGFyZW50Tm9kZSl7ZXZlbnRQYXRoLnB1c2goY3VyKTt0bXA9Y3VyO30KaWYodG1wPT09KGVsZW0ub3duZXJEb2N1bWVudHx8ZG9jdW1lbnQpKXtldmVudFBhdGgucHVzaCh0bXAuZGVmYXVsdFZpZXd8fHRtcC5wYXJlbnRXaW5kb3d8fHdpbmRvdyk7fX0KaT0wO3doaWxlKChjdXI9ZXZlbnRQYXRoW2krK10pJiYhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSl7ZXZlbnQudHlwZT1pPjE/YnViYmxlVHlwZTpzcGVjaWFsLmJpbmRUeXBlfHx0eXBlO2hhbmRsZT0oalF1ZXJ5Ll9kYXRhKGN1ciwiZXZlbnRzIil8fHt9KVtldmVudC50eXBlXSYmalF1ZXJ5Ll9kYXRhKGN1ciwiaGFuZGxlIik7aWYoaGFuZGxlKXtoYW5kbGUuYXBwbHkoY3VyLGRhdGEpO30KaGFuZGxlPW9udHlwZSYmY3VyW29udHlwZV07aWYoaGFuZGxlJiZoYW5kbGUuYXBwbHkmJmpRdWVyeS5hY2NlcHREYXRhKGN1cikpe2V2ZW50LnJlc3VsdD1oYW5kbGUuYXBwbHkoY3VyLGRhdGEpO2lmKGV2ZW50LnJlc3VsdD09PWZhbHNlKXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO319fQpldmVudC50eXBlPXR5cGU7aWYoIW9ubHlIYW5kbGVycyYmIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKXtpZigoIXNwZWNpYWwuX2RlZmF1bHR8fHNwZWNpYWwuX2RlZmF1bHQuYXBwbHkoZXZlbnRQYXRoLnBvcCgpLGRhdGEpPT09ZmFsc2UpJiZqUXVlcnkuYWNjZXB0RGF0YShlbGVtKSl7aWYob250eXBlJiZlbGVtW3R5cGVdJiYhalF1ZXJ5LmlzV2luZG93KGVsZW0pKXt0bXA9ZWxlbVtvbnR5cGVdO2lmKHRtcCl7ZWxlbVtvbnR5cGVdPW51bGw7fQpqUXVlcnkuZXZlbnQudHJpZ2dlcmVkPXR5cGU7dHJ5e2VsZW1bdHlwZV0oKTt9Y2F0Y2goZSl7fQpqUXVlcnkuZXZlbnQudHJpZ2dlcmVkPXVuZGVmaW5lZDtpZih0bXApe2VsZW1bb250eXBlXT10bXA7fX19fQpyZXR1cm4gZXZlbnQucmVzdWx0O30sZGlzcGF0Y2g6ZnVuY3Rpb24oZXZlbnQpe2V2ZW50PWpRdWVyeS5ldmVudC5maXgoZXZlbnQpO3ZhciBpLHJldCxoYW5kbGVPYmosbWF0Y2hlZCxqLGhhbmRsZXJRdWV1ZT1bXSxhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzKSxoYW5kbGVycz0oalF1ZXJ5Ll9kYXRhKHRoaXMsImV2ZW50cyIpfHx7fSlbZXZlbnQudHlwZV18fFtdLHNwZWNpYWw9alF1ZXJ5LmV2ZW50LnNwZWNpYWxbZXZlbnQudHlwZV18fHt9O2FyZ3NbMF09ZXZlbnQ7ZXZlbnQuZGVsZWdhdGVUYXJnZXQ9dGhpcztpZihzcGVjaWFsLnByZURpc3BhdGNoJiZzcGVjaWFsLnByZURpc3BhdGNoLmNhbGwodGhpcyxldmVudCk9PT1mYWxzZSl7cmV0dXJuO30KaGFuZGxlclF1ZXVlPWpRdWVyeS5ldmVudC5oYW5kbGVycy5jYWxsKHRoaXMsZXZlbnQsaGFuZGxlcnMpO2k9MDt3aGlsZSgobWF0Y2hlZD1oYW5kbGVyUXVldWVbaSsrXSkmJiFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKXtldmVudC5jdXJyZW50VGFyZ2V0PW1hdGNoZWQuZWxlbTtqPTA7d2hpbGUoKGhhbmRsZU9iaj1tYXRjaGVkLmhhbmRsZXJzW2orK10pJiYhZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSl7aWYoIWV2ZW50Lm5hbWVzcGFjZV9yZXx8ZXZlbnQubmFtZXNwYWNlX3JlLnRlc3QoaGFuZGxlT2JqLm5hbWVzcGFjZSkpe2V2ZW50LmhhbmRsZU9iaj1oYW5kbGVPYmo7ZXZlbnQuZGF0YT1oYW5kbGVPYmouZGF0YTtyZXQ9KChqUXVlcnkuZXZlbnQuc3BlY2lhbFtoYW5kbGVPYmoub3JpZ1R5cGVdfHx7fSkuaGFuZGxlfHxoYW5kbGVPYmouaGFuZGxlcikuYXBwbHkobWF0Y2hlZC5lbGVtLGFyZ3MpO2lmKHJldCE9PXVuZGVmaW5lZCl7aWYoKGV2ZW50LnJlc3VsdD1yZXQpPT09ZmFsc2Upe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7fX19fX0KaWYoc3BlY2lhbC5wb3N0RGlzcGF0Y2gpe3NwZWNpYWwucG9zdERpc3BhdGNoLmNhbGwodGhpcyxldmVudCk7fQpyZXR1cm4gZXZlbnQucmVzdWx0O30saGFuZGxlcnM6ZnVuY3Rpb24oZXZlbnQsaGFuZGxlcnMpe3ZhciBzZWwsaGFuZGxlT2JqLG1hdGNoZXMsaSxoYW5kbGVyUXVldWU9W10sZGVsZWdhdGVDb3VudD1oYW5kbGVycy5kZWxlZ2F0ZUNvdW50LGN1cj1ldmVudC50YXJnZXQ7aWYoZGVsZWdhdGVDb3VudCYmY3VyLm5vZGVUeXBlJiYoIWV2ZW50LmJ1dHRvbnx8ZXZlbnQudHlwZSE9PSJjbGljayIpKXtmb3IoO2N1ciE9dGhpcztjdXI9Y3VyLnBhcmVudE5vZGV8fHRoaXMpe2lmKGN1ci5ub2RlVHlwZT09PTEmJihjdXIuZGlzYWJsZWQhPT10cnVlfHxldmVudC50eXBlIT09ImNsaWNrIikpe21hdGNoZXM9W107Zm9yKGk9MDtpPGRlbGVnYXRlQ291bnQ7aSsrKXtoYW5kbGVPYmo9aGFuZGxlcnNbaV07c2VsPWhhbmRsZU9iai5zZWxlY3RvcisiICI7aWYobWF0Y2hlc1tzZWxdPT09dW5kZWZpbmVkKXttYXRjaGVzW3NlbF09aGFuZGxlT2JqLm5lZWRzQ29udGV4dD9qUXVlcnkoc2VsLHRoaXMpLmluZGV4KGN1cik+PTA6alF1ZXJ5LmZpbmQoc2VsLHRoaXMsbnVsbCxbY3VyXSkubGVuZ3RoO30KaWYobWF0Y2hlc1tzZWxdKXttYXRjaGVzLnB1c2goaGFuZGxlT2JqKTt9fQppZihtYXRjaGVzLmxlbmd0aCl7aGFuZGxlclF1ZXVlLnB1c2goe2VsZW06Y3VyLGhhbmRsZXJzOm1hdGNoZXN9KTt9fX19CmlmKGRlbGVnYXRlQ291bnQ8aGFuZGxlcnMubGVuZ3RoKXtoYW5kbGVyUXVldWUucHVzaCh7ZWxlbTp0aGlzLGhhbmRsZXJzOmhhbmRsZXJzLnNsaWNlKGRlbGVnYXRlQ291bnQpfSk7fQpyZXR1cm4gaGFuZGxlclF1ZXVlO30sZml4OmZ1bmN0aW9uKGV2ZW50KXtpZihldmVudFtqUXVlcnkuZXhwYW5kb10pe3JldHVybiBldmVudDt9CnZhciBpLHByb3AsY29weSx0eXBlPWV2ZW50LnR5cGUsb3JpZ2luYWxFdmVudD1ldmVudCxmaXhIb29rPXRoaXMuZml4SG9va3NbdHlwZV07aWYoIWZpeEhvb2spe3RoaXMuZml4SG9va3NbdHlwZV09Zml4SG9vaz1ybW91c2VFdmVudC50ZXN0KHR5cGUpP3RoaXMubW91c2VIb29rczpya2V5RXZlbnQudGVzdCh0eXBlKT90aGlzLmtleUhvb2tzOnt9O30KY29weT1maXhIb29rLnByb3BzP3RoaXMucHJvcHMuY29uY2F0KGZpeEhvb2sucHJvcHMpOnRoaXMucHJvcHM7ZXZlbnQ9bmV3IGpRdWVyeS5FdmVudChvcmlnaW5hbEV2ZW50KTtpPWNvcHkubGVuZ3RoO3doaWxlKGktLSl7cHJvcD1jb3B5W2ldO2V2ZW50W3Byb3BdPW9yaWdpbmFsRXZlbnRbcHJvcF07fQppZighZXZlbnQudGFyZ2V0KXtldmVudC50YXJnZXQ9b3JpZ2luYWxFdmVudC5zcmNFbGVtZW50fHxkb2N1bWVudDt9CmlmKGV2ZW50LnRhcmdldC5ub2RlVHlwZT09PTMpe2V2ZW50LnRhcmdldD1ldmVudC50YXJnZXQucGFyZW50Tm9kZTt9CmV2ZW50Lm1ldGFLZXk9ISFldmVudC5tZXRhS2V5O3JldHVybiBmaXhIb29rLmZpbHRlcj9maXhIb29rLmZpbHRlcihldmVudCxvcmlnaW5hbEV2ZW50KTpldmVudDt9LHByb3BzOiJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2giLnNwbGl0KCIgIiksZml4SG9va3M6e30sa2V5SG9va3M6e3Byb3BzOiJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlIi5zcGxpdCgiICIpLGZpbHRlcjpmdW5jdGlvbihldmVudCxvcmlnaW5hbCl7aWYoZXZlbnQud2hpY2g9PW51bGwpe2V2ZW50LndoaWNoPW9yaWdpbmFsLmNoYXJDb2RlIT1udWxsP29yaWdpbmFsLmNoYXJDb2RlOm9yaWdpbmFsLmtleUNvZGU7fQpyZXR1cm4gZXZlbnQ7fX0sbW91c2VIb29rczp7cHJvcHM6ImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBmcm9tRWxlbWVudCBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudCIuc3BsaXQoIiAiKSxmaWx0ZXI6ZnVuY3Rpb24oZXZlbnQsb3JpZ2luYWwpe3ZhciBib2R5LGV2ZW50RG9jLGRvYyxidXR0b249b3JpZ2luYWwuYnV0dG9uLGZyb21FbGVtZW50PW9yaWdpbmFsLmZyb21FbGVtZW50O2lmKGV2ZW50LnBhZ2VYPT1udWxsJiZvcmlnaW5hbC5jbGllbnRYIT1udWxsKXtldmVudERvYz1ldmVudC50YXJnZXQub3duZXJEb2N1bWVudHx8ZG9jdW1lbnQ7ZG9jPWV2ZW50RG9jLmRvY3VtZW50RWxlbWVudDtib2R5PWV2ZW50RG9jLmJvZHk7ZXZlbnQucGFnZVg9b3JpZ2luYWwuY2xpZW50WCsoZG9jJiZkb2Muc2Nyb2xsTGVmdHx8Ym9keSYmYm9keS5zY3JvbGxMZWZ0fHwwKS0oZG9jJiZkb2MuY2xpZW50TGVmdHx8Ym9keSYmYm9keS5jbGllbnRMZWZ0fHwwKTtldmVudC5wYWdlWT1vcmlnaW5hbC5jbGllbnRZKyhkb2MmJmRvYy5zY3JvbGxUb3B8fGJvZHkmJmJvZHkuc2Nyb2xsVG9wfHwwKS0oZG9jJiZkb2MuY2xpZW50VG9wfHxib2R5JiZib2R5LmNsaWVudFRvcHx8MCk7fQppZighZXZlbnQucmVsYXRlZFRhcmdldCYmZnJvbUVsZW1lbnQpe2V2ZW50LnJlbGF0ZWRUYXJnZXQ9ZnJvbUVsZW1lbnQ9PT1ldmVudC50YXJnZXQ/b3JpZ2luYWwudG9FbGVtZW50OmZyb21FbGVtZW50O30KaWYoIWV2ZW50LndoaWNoJiZidXR0b24hPT11bmRlZmluZWQpe2V2ZW50LndoaWNoPShidXR0b24mMT8xOihidXR0b24mMj8zOihidXR0b24mND8yOjApKSk7fQpyZXR1cm4gZXZlbnQ7fX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6dHJ1ZX0sZm9jdXM6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZih0aGlzIT09c2FmZUFjdGl2ZUVsZW1lbnQoKSYmdGhpcy5mb2N1cyl7dHJ5e3RoaXMuZm9jdXMoKTtyZXR1cm4gZmFsc2U7fWNhdGNoKGUpe319fSxkZWxlZ2F0ZVR5cGU6ImZvY3VzaW4ifSxibHVyOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYodGhpcz09PXNhZmVBY3RpdmVFbGVtZW50KCkmJnRoaXMuYmx1cil7dGhpcy5ibHVyKCk7cmV0dXJuIGZhbHNlO319LGRlbGVnYXRlVHlwZToiZm9jdXNvdXQifSxjbGljazp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKGpRdWVyeS5ub2RlTmFtZSh0aGlzLCJpbnB1dCIpJiZ0aGlzLnR5cGU9PT0iY2hlY2tib3giJiZ0aGlzLmNsaWNrKXt0aGlzLmNsaWNrKCk7cmV0dXJuIGZhbHNlO319LF9kZWZhdWx0OmZ1bmN0aW9uKGV2ZW50KXtyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKGV2ZW50LnRhcmdldCwiYSIpO319LGJlZm9yZXVubG9hZDp7cG9zdERpc3BhdGNoOmZ1bmN0aW9uKGV2ZW50KXtpZihldmVudC5yZXN1bHQhPT11bmRlZmluZWQpe2V2ZW50Lm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWU9ZXZlbnQucmVzdWx0O319fX0sc2ltdWxhdGU6ZnVuY3Rpb24odHlwZSxlbGVtLGV2ZW50LGJ1YmJsZSl7dmFyIGU9alF1ZXJ5LmV4dGVuZChuZXcgalF1ZXJ5LkV2ZW50KCksZXZlbnQse3R5cGU6dHlwZSxpc1NpbXVsYXRlZDp0cnVlLG9yaWdpbmFsRXZlbnQ6e319KTtpZihidWJibGUpe2pRdWVyeS5ldmVudC50cmlnZ2VyKGUsbnVsbCxlbGVtKTt9ZWxzZXtqUXVlcnkuZXZlbnQuZGlzcGF0Y2guY2FsbChlbGVtLGUpO30KaWYoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9fX07alF1ZXJ5LnJlbW92ZUV2ZW50PWRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXI/ZnVuY3Rpb24oZWxlbSx0eXBlLGhhbmRsZSl7aWYoZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKXtlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSxoYW5kbGUsZmFsc2UpO319OmZ1bmN0aW9uKGVsZW0sdHlwZSxoYW5kbGUpe3ZhciBuYW1lPSJvbiIrdHlwZTtpZihlbGVtLmRldGFjaEV2ZW50KXtpZih0eXBlb2YgZWxlbVtuYW1lXT09PXN0cnVuZGVmaW5lZCl7ZWxlbVtuYW1lXT1udWxsO30KZWxlbS5kZXRhY2hFdmVudChuYW1lLGhhbmRsZSk7fX07alF1ZXJ5LkV2ZW50PWZ1bmN0aW9uKHNyYyxwcm9wcyl7aWYoISh0aGlzIGluc3RhbmNlb2YgalF1ZXJ5LkV2ZW50KSl7cmV0dXJuIG5ldyBqUXVlcnkuRXZlbnQoc3JjLHByb3BzKTt9CmlmKHNyYyYmc3JjLnR5cGUpe3RoaXMub3JpZ2luYWxFdmVudD1zcmM7dGhpcy50eXBlPXNyYy50eXBlO3RoaXMuaXNEZWZhdWx0UHJldmVudGVkPXNyYy5kZWZhdWx0UHJldmVudGVkfHxzcmMuZGVmYXVsdFByZXZlbnRlZD09PXVuZGVmaW5lZCYmKHNyYy5yZXR1cm5WYWx1ZT09PWZhbHNlfHxzcmMuZ2V0UHJldmVudERlZmF1bHQmJnNyYy5nZXRQcmV2ZW50RGVmYXVsdCgpKT9yZXR1cm5UcnVlOnJldHVybkZhbHNlO31lbHNle3RoaXMudHlwZT1zcmM7fQppZihwcm9wcyl7alF1ZXJ5LmV4dGVuZCh0aGlzLHByb3BzKTt9CnRoaXMudGltZVN0YW1wPXNyYyYmc3JjLnRpbWVTdGFtcHx8alF1ZXJ5Lm5vdygpO3RoaXNbalF1ZXJ5LmV4cGFuZG9dPXRydWU7fTtqUXVlcnkuRXZlbnQucHJvdG90eXBlPXtpc0RlZmF1bHRQcmV2ZW50ZWQ6cmV0dXJuRmFsc2UsaXNQcm9wYWdhdGlvblN0b3BwZWQ6cmV0dXJuRmFsc2UsaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6cmV0dXJuRmFsc2UscHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9cmV0dXJuVHJ1ZTtpZighZSl7cmV0dXJuO30KaWYoZS5wcmV2ZW50RGVmYXVsdCl7ZS5wcmV2ZW50RGVmYXVsdCgpO31lbHNle2UucmV0dXJuVmFsdWU9ZmFsc2U7fX0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQ9cmV0dXJuVHJ1ZTtpZighZSl7cmV0dXJuO30KaWYoZS5zdG9wUHJvcGFnYXRpb24pe2Uuc3RvcFByb3BhZ2F0aW9uKCk7fQplLmNhbmNlbEJ1YmJsZT10cnVlO30sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1yZXR1cm5UcnVlO3RoaXMuc3RvcFByb3BhZ2F0aW9uKCk7fX07alF1ZXJ5LmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQifSxmdW5jdGlvbihvcmlnLGZpeCl7alF1ZXJ5LmV2ZW50LnNwZWNpYWxbb3JpZ109e2RlbGVnYXRlVHlwZTpmaXgsYmluZFR5cGU6Zml4LGhhbmRsZTpmdW5jdGlvbihldmVudCl7dmFyIHJldCx0YXJnZXQ9dGhpcyxyZWxhdGVkPWV2ZW50LnJlbGF0ZWRUYXJnZXQsaGFuZGxlT2JqPWV2ZW50LmhhbmRsZU9iajtpZighcmVsYXRlZHx8KHJlbGF0ZWQhPT10YXJnZXQmJiFqUXVlcnkuY29udGFpbnModGFyZ2V0LHJlbGF0ZWQpKSl7ZXZlbnQudHlwZT1oYW5kbGVPYmoub3JpZ1R5cGU7cmV0PWhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtldmVudC50eXBlPWZpeDt9CnJldHVybiByZXQ7fX07fSk7aWYoIXN1cHBvcnQuc3VibWl0QnViYmxlcyl7alF1ZXJ5LmV2ZW50LnNwZWNpYWwuc3VibWl0PXtzZXR1cDpmdW5jdGlvbigpe2lmKGpRdWVyeS5ub2RlTmFtZSh0aGlzLCJmb3JtIikpe3JldHVybiBmYWxzZTt9CmpRdWVyeS5ldmVudC5hZGQodGhpcywiY2xpY2suX3N1Ym1pdCBrZXlwcmVzcy5fc3VibWl0IixmdW5jdGlvbihlKXt2YXIgZWxlbT1lLnRhcmdldCxmb3JtPWpRdWVyeS5ub2RlTmFtZShlbGVtLCJpbnB1dCIpfHxqUXVlcnkubm9kZU5hbWUoZWxlbSwiYnV0dG9uIik/ZWxlbS5mb3JtOnVuZGVmaW5lZDtpZihmb3JtJiYhalF1ZXJ5Ll9kYXRhKGZvcm0sInN1Ym1pdEJ1YmJsZXMiKSl7alF1ZXJ5LmV2ZW50LmFkZChmb3JtLCJzdWJtaXQuX3N1Ym1pdCIsZnVuY3Rpb24oZXZlbnQpe2V2ZW50Ll9zdWJtaXRfYnViYmxlPXRydWU7fSk7alF1ZXJ5Ll9kYXRhKGZvcm0sInN1Ym1pdEJ1YmJsZXMiLHRydWUpO319KTt9LHBvc3REaXNwYXRjaDpmdW5jdGlvbihldmVudCl7aWYoZXZlbnQuX3N1Ym1pdF9idWJibGUpe2RlbGV0ZSBldmVudC5fc3VibWl0X2J1YmJsZTtpZih0aGlzLnBhcmVudE5vZGUmJiFldmVudC5pc1RyaWdnZXIpe2pRdWVyeS5ldmVudC5zaW11bGF0ZSgic3VibWl0Iix0aGlzLnBhcmVudE5vZGUsZXZlbnQsdHJ1ZSk7fX19LHRlYXJkb3duOmZ1bmN0aW9uKCl7aWYoalF1ZXJ5Lm5vZGVOYW1lKHRoaXMsImZvcm0iKSl7cmV0dXJuIGZhbHNlO30KalF1ZXJ5LmV2ZW50LnJlbW92ZSh0aGlzLCIuX3N1Ym1pdCIpO319O30KaWYoIXN1cHBvcnQuY2hhbmdlQnViYmxlcyl7alF1ZXJ5LmV2ZW50LnNwZWNpYWwuY2hhbmdlPXtzZXR1cDpmdW5jdGlvbigpe2lmKHJmb3JtRWxlbXMudGVzdCh0aGlzLm5vZGVOYW1lKSl7aWYodGhpcy50eXBlPT09ImNoZWNrYm94Inx8dGhpcy50eXBlPT09InJhZGlvIil7alF1ZXJ5LmV2ZW50LmFkZCh0aGlzLCJwcm9wZXJ0eWNoYW5nZS5fY2hhbmdlIixmdW5jdGlvbihldmVudCl7aWYoZXZlbnQub3JpZ2luYWxFdmVudC5wcm9wZXJ0eU5hbWU9PT0iY2hlY2tlZCIpe3RoaXMuX2p1c3RfY2hhbmdlZD10cnVlO319KTtqUXVlcnkuZXZlbnQuYWRkKHRoaXMsImNsaWNrLl9jaGFuZ2UiLGZ1bmN0aW9uKGV2ZW50KXtpZih0aGlzLl9qdXN0X2NoYW5nZWQmJiFldmVudC5pc1RyaWdnZXIpe3RoaXMuX2p1c3RfY2hhbmdlZD1mYWxzZTt9CmpRdWVyeS5ldmVudC5zaW11bGF0ZSgiY2hhbmdlIix0aGlzLGV2ZW50LHRydWUpO30pO30KcmV0dXJuIGZhbHNlO30KalF1ZXJ5LmV2ZW50LmFkZCh0aGlzLCJiZWZvcmVhY3RpdmF0ZS5fY2hhbmdlIixmdW5jdGlvbihlKXt2YXIgZWxlbT1lLnRhcmdldDtpZihyZm9ybUVsZW1zLnRlc3QoZWxlbS5ub2RlTmFtZSkmJiFqUXVlcnkuX2RhdGEoZWxlbSwiY2hhbmdlQnViYmxlcyIpKXtqUXVlcnkuZXZlbnQuYWRkKGVsZW0sImNoYW5nZS5fY2hhbmdlIixmdW5jdGlvbihldmVudCl7aWYodGhpcy5wYXJlbnROb2RlJiYhZXZlbnQuaXNTaW11bGF0ZWQmJiFldmVudC5pc1RyaWdnZXIpe2pRdWVyeS5ldmVudC5zaW11bGF0ZSgiY2hhbmdlIix0aGlzLnBhcmVudE5vZGUsZXZlbnQsdHJ1ZSk7fX0pO2pRdWVyeS5fZGF0YShlbGVtLCJjaGFuZ2VCdWJibGVzIix0cnVlKTt9fSk7fSxoYW5kbGU6ZnVuY3Rpb24oZXZlbnQpe3ZhciBlbGVtPWV2ZW50LnRhcmdldDtpZih0aGlzIT09ZWxlbXx8ZXZlbnQuaXNTaW11bGF0ZWR8fGV2ZW50LmlzVHJpZ2dlcnx8KGVsZW0udHlwZSE9PSJyYWRpbyImJmVsZW0udHlwZSE9PSJjaGVja2JveCIpKXtyZXR1cm4gZXZlbnQuaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319LHRlYXJkb3duOmZ1bmN0aW9uKCl7alF1ZXJ5LmV2ZW50LnJlbW92ZSh0aGlzLCIuX2NoYW5nZSIpO3JldHVybiFyZm9ybUVsZW1zLnRlc3QodGhpcy5ub2RlTmFtZSk7fX07fQppZighc3VwcG9ydC5mb2N1c2luQnViYmxlcyl7alF1ZXJ5LmVhY2goe2ZvY3VzOiJmb2N1c2luIixibHVyOiJmb2N1c291dCJ9LGZ1bmN0aW9uKG9yaWcsZml4KXt2YXIgaGFuZGxlcj1mdW5jdGlvbihldmVudCl7alF1ZXJ5LmV2ZW50LnNpbXVsYXRlKGZpeCxldmVudC50YXJnZXQsalF1ZXJ5LmV2ZW50LmZpeChldmVudCksdHJ1ZSk7fTtqUXVlcnkuZXZlbnQuc3BlY2lhbFtmaXhdPXtzZXR1cDpmdW5jdGlvbigpe3ZhciBkb2M9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGF0dGFjaGVzPWpRdWVyeS5fZGF0YShkb2MsZml4KTtpZighYXR0YWNoZXMpe2RvYy5hZGRFdmVudExpc3RlbmVyKG9yaWcsaGFuZGxlcix0cnVlKTt9CmpRdWVyeS5fZGF0YShkb2MsZml4LChhdHRhY2hlc3x8MCkrMSk7fSx0ZWFyZG93bjpmdW5jdGlvbigpe3ZhciBkb2M9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGF0dGFjaGVzPWpRdWVyeS5fZGF0YShkb2MsZml4KS0xO2lmKCFhdHRhY2hlcyl7ZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIob3JpZyxoYW5kbGVyLHRydWUpO2pRdWVyeS5fcmVtb3ZlRGF0YShkb2MsZml4KTt9ZWxzZXtqUXVlcnkuX2RhdGEoZG9jLGZpeCxhdHRhY2hlcyk7fX19O30pO30KalF1ZXJ5LmZuLmV4dGVuZCh7b246ZnVuY3Rpb24odHlwZXMsc2VsZWN0b3IsZGF0YSxmbixvbmUpe3ZhciB0eXBlLG9yaWdGbjtpZih0eXBlb2YgdHlwZXM9PT0ib2JqZWN0Iil7aWYodHlwZW9mIHNlbGVjdG9yIT09InN0cmluZyIpe2RhdGE9ZGF0YXx8c2VsZWN0b3I7c2VsZWN0b3I9dW5kZWZpbmVkO30KZm9yKHR5cGUgaW4gdHlwZXMpe3RoaXMub24odHlwZSxzZWxlY3RvcixkYXRhLHR5cGVzW3R5cGVdLG9uZSk7fQpyZXR1cm4gdGhpczt9CmlmKGRhdGE9PW51bGwmJmZuPT1udWxsKXtmbj1zZWxlY3RvcjtkYXRhPXNlbGVjdG9yPXVuZGVmaW5lZDt9ZWxzZSBpZihmbj09bnVsbCl7aWYodHlwZW9mIHNlbGVjdG9yPT09InN0cmluZyIpe2ZuPWRhdGE7ZGF0YT11bmRlZmluZWQ7fWVsc2V7Zm49ZGF0YTtkYXRhPXNlbGVjdG9yO3NlbGVjdG9yPXVuZGVmaW5lZDt9fQppZihmbj09PWZhbHNlKXtmbj1yZXR1cm5GYWxzZTt9ZWxzZSBpZighZm4pe3JldHVybiB0aGlzO30KaWYob25lPT09MSl7b3JpZ0ZuPWZuO2ZuPWZ1bmN0aW9uKGV2ZW50KXtqUXVlcnkoKS5vZmYoZXZlbnQpO3JldHVybiBvcmlnRm4uYXBwbHkodGhpcyxhcmd1bWVudHMpO307Zm4uZ3VpZD1vcmlnRm4uZ3VpZHx8KG9yaWdGbi5ndWlkPWpRdWVyeS5ndWlkKyspO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2pRdWVyeS5ldmVudC5hZGQodGhpcyx0eXBlcyxmbixkYXRhLHNlbGVjdG9yKTt9KTt9LG9uZTpmdW5jdGlvbih0eXBlcyxzZWxlY3RvcixkYXRhLGZuKXtyZXR1cm4gdGhpcy5vbih0eXBlcyxzZWxlY3RvcixkYXRhLGZuLDEpO30sb2ZmOmZ1bmN0aW9uKHR5cGVzLHNlbGVjdG9yLGZuKXt2YXIgaGFuZGxlT2JqLHR5cGU7aWYodHlwZXMmJnR5cGVzLnByZXZlbnREZWZhdWx0JiZ0eXBlcy5oYW5kbGVPYmope2hhbmRsZU9iaj10eXBlcy5oYW5kbGVPYmo7alF1ZXJ5KHR5cGVzLmRlbGVnYXRlVGFyZ2V0KS5vZmYoaGFuZGxlT2JqLm5hbWVzcGFjZT9oYW5kbGVPYmoub3JpZ1R5cGUrIi4iK2hhbmRsZU9iai5uYW1lc3BhY2U6aGFuZGxlT2JqLm9yaWdUeXBlLGhhbmRsZU9iai5zZWxlY3RvcixoYW5kbGVPYmouaGFuZGxlcik7cmV0dXJuIHRoaXM7fQppZih0eXBlb2YgdHlwZXM9PT0ib2JqZWN0Iil7Zm9yKHR5cGUgaW4gdHlwZXMpe3RoaXMub2ZmKHR5cGUsc2VsZWN0b3IsdHlwZXNbdHlwZV0pO30KcmV0dXJuIHRoaXM7fQppZihzZWxlY3Rvcj09PWZhbHNlfHx0eXBlb2Ygc2VsZWN0b3I9PT0iZnVuY3Rpb24iKXtmbj1zZWxlY3RvcjtzZWxlY3Rvcj11bmRlZmluZWQ7fQppZihmbj09PWZhbHNlKXtmbj1yZXR1cm5GYWxzZTt9CnJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkuZXZlbnQucmVtb3ZlKHRoaXMsdHlwZXMsZm4sc2VsZWN0b3IpO30pO30sdHJpZ2dlcjpmdW5jdGlvbih0eXBlLGRhdGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkuZXZlbnQudHJpZ2dlcih0eXBlLGRhdGEsdGhpcyk7fSk7fSx0cmlnZ2VySGFuZGxlcjpmdW5jdGlvbih0eXBlLGRhdGEpe3ZhciBlbGVtPXRoaXNbMF07aWYoZWxlbSl7cmV0dXJuIGpRdWVyeS5ldmVudC50cmlnZ2VyKHR5cGUsZGF0YSxlbGVtLHRydWUpO319fSk7ZnVuY3Rpb24gY3JlYXRlU2FmZUZyYWdtZW50KGRvY3VtZW50KXt2YXIgbGlzdD1ub2RlTmFtZXMuc3BsaXQoInwiKSxzYWZlRnJhZz1kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7aWYoc2FmZUZyYWcuY3JlYXRlRWxlbWVudCl7d2hpbGUobGlzdC5sZW5ndGgpe3NhZmVGcmFnLmNyZWF0ZUVsZW1lbnQobGlzdC5wb3AoKSk7fX0KcmV0dXJuIHNhZmVGcmFnO30KdmFyIG5vZGVOYW1lcz0iYWJicnxhcnRpY2xlfGFzaWRlfGF1ZGlvfGJkaXxjYW52YXN8ZGF0YXxkYXRhbGlzdHxkZXRhaWxzfGZpZ2NhcHRpb258ZmlndXJlfGZvb3RlcnwiKyJoZWFkZXJ8aGdyb3VwfG1hcmt8bWV0ZXJ8bmF2fG91dHB1dHxwcm9ncmVzc3xzZWN0aW9ufHN1bW1hcnl8dGltZXx2aWRlbyIscmlubGluZWpRdWVyeT0vIGpRdWVyeVxkKz0iKD86bnVsbHxcZCspIi9nLHJub3NoaW1jYWNoZT1uZXcgUmVnRXhwKCI8KD86Iitub2RlTmFtZXMrIilbXFxzLz5dIiwiaSIpLHJsZWFkaW5nV2hpdGVzcGFjZT0vXlxzKy8scnhodG1sVGFnPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcdzpdKylbXj5dKilcLz4vZ2kscnRhZ05hbWU9LzwoW1x3Ol0rKS8scnRib2R5PS88dGJvZHkvaSxyaHRtbD0vPHwmIz9cdys7Lyxybm9Jbm5lcmh0bWw9LzwoPzpzY3JpcHR8c3R5bGV8bGluaykvaSxyY2hlY2tlZD0vY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSxyc2NyaXB0VHlwZT0vXiR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2kscnNjcmlwdFR5cGVNYXNrZWQ9L150cnVlXC8oLiopLyxyY2xlYW5TY3JpcHQ9L15ccyo8ISg/OlxbQ0RBVEFcW3wtLSl8KD86XF1cXXwtLSk+XHMqJC9nLHdyYXBNYXA9e29wdGlvbjpbMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdLGxlZ2VuZDpbMSwiPGZpZWxkc2V0PiIsIjwvZmllbGRzZXQ+Il0sYXJlYTpbMSwiPG1hcD4iLCI8L21hcD4iXSxwYXJhbTpbMSwiPG9iamVjdD4iLCI8L29iamVjdD4iXSx0aGVhZDpbMSwiPHRhYmxlPiIsIjwvdGFibGU+Il0sdHI6WzIsIjx0YWJsZT48dGJvZHk+IiwiPC90Ym9keT48L3RhYmxlPiJdLGNvbDpbMiwiPHRhYmxlPjx0Ym9keT48L3Rib2R5Pjxjb2xncm91cD4iLCI8L2NvbGdyb3VwPjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLF9kZWZhdWx0OnN1cHBvcnQuaHRtbFNlcmlhbGl6ZT9bMCwiIiwiIl06WzEsIlg8ZGl2PiIsIjwvZGl2PiJdfSxzYWZlRnJhZ21lbnQ9Y3JlYXRlU2FmZUZyYWdtZW50KGRvY3VtZW50KSxmcmFnbWVudERpdj1zYWZlRnJhZ21lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpO3dyYXBNYXAub3B0Z3JvdXA9d3JhcE1hcC5vcHRpb247d3JhcE1hcC50Ym9keT13cmFwTWFwLnRmb290PXdyYXBNYXAuY29sZ3JvdXA9d3JhcE1hcC5jYXB0aW9uPXdyYXBNYXAudGhlYWQ7d3JhcE1hcC50aD13cmFwTWFwLnRkO2Z1bmN0aW9uIGdldEFsbChjb250ZXh0LHRhZyl7dmFyIGVsZW1zLGVsZW0saT0wLGZvdW5kPXR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lIT09c3RydW5kZWZpbmVkP2NvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnfHwiKiIpOnR5cGVvZiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwhPT1zdHJ1bmRlZmluZWQ/Y29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKHRhZ3x8IioiKTp1bmRlZmluZWQ7aWYoIWZvdW5kKXtmb3IoZm91bmQ9W10sZWxlbXM9Y29udGV4dC5jaGlsZE5vZGVzfHxjb250ZXh0OyhlbGVtPWVsZW1zW2ldKSE9bnVsbDtpKyspe2lmKCF0YWd8fGpRdWVyeS5ub2RlTmFtZShlbGVtLHRhZykpe2ZvdW5kLnB1c2goZWxlbSk7fWVsc2V7alF1ZXJ5Lm1lcmdlKGZvdW5kLGdldEFsbChlbGVtLHRhZykpO319fQpyZXR1cm4gdGFnPT09dW5kZWZpbmVkfHx0YWcmJmpRdWVyeS5ub2RlTmFtZShjb250ZXh0LHRhZyk/alF1ZXJ5Lm1lcmdlKFtjb250ZXh0XSxmb3VuZCk6Zm91bmQ7fQpmdW5jdGlvbiBmaXhEZWZhdWx0Q2hlY2tlZChlbGVtKXtpZihyY2hlY2thYmxlVHlwZS50ZXN0KGVsZW0udHlwZSkpe2VsZW0uZGVmYXVsdENoZWNrZWQ9ZWxlbS5jaGVja2VkO319CmZ1bmN0aW9uIG1hbmlwdWxhdGlvblRhcmdldChlbGVtLGNvbnRlbnQpe3JldHVybiBqUXVlcnkubm9kZU5hbWUoZWxlbSwidGFibGUiKSYmalF1ZXJ5Lm5vZGVOYW1lKGNvbnRlbnQubm9kZVR5cGUhPT0xMT9jb250ZW50OmNvbnRlbnQuZmlyc3RDaGlsZCwidHIiKT9lbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdfHxlbGVtLmFwcGVuZENoaWxkKGVsZW0ub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpKTplbGVtO30KZnVuY3Rpb24gZGlzYWJsZVNjcmlwdChlbGVtKXtlbGVtLnR5cGU9KGpRdWVyeS5maW5kLmF0dHIoZWxlbSwidHlwZSIpIT09bnVsbCkrIi8iK2VsZW0udHlwZTtyZXR1cm4gZWxlbTt9CmZ1bmN0aW9uIHJlc3RvcmVTY3JpcHQoZWxlbSl7dmFyIG1hdGNoPXJzY3JpcHRUeXBlTWFza2VkLmV4ZWMoZWxlbS50eXBlKTtpZihtYXRjaCl7ZWxlbS50eXBlPW1hdGNoWzFdO31lbHNle2VsZW0ucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIik7fQpyZXR1cm4gZWxlbTt9CmZ1bmN0aW9uIHNldEdsb2JhbEV2YWwoZWxlbXMscmVmRWxlbWVudHMpe3ZhciBlbGVtLGk9MDtmb3IoOyhlbGVtPWVsZW1zW2ldKSE9bnVsbDtpKyspe2pRdWVyeS5fZGF0YShlbGVtLCJnbG9iYWxFdmFsIiwhcmVmRWxlbWVudHN8fGpRdWVyeS5fZGF0YShyZWZFbGVtZW50c1tpXSwiZ2xvYmFsRXZhbCIpKTt9fQpmdW5jdGlvbiBjbG9uZUNvcHlFdmVudChzcmMsZGVzdCl7aWYoZGVzdC5ub2RlVHlwZSE9PTF8fCFqUXVlcnkuaGFzRGF0YShzcmMpKXtyZXR1cm47fQp2YXIgdHlwZSxpLGwsb2xkRGF0YT1qUXVlcnkuX2RhdGEoc3JjKSxjdXJEYXRhPWpRdWVyeS5fZGF0YShkZXN0LG9sZERhdGEpLGV2ZW50cz1vbGREYXRhLmV2ZW50cztpZihldmVudHMpe2RlbGV0ZSBjdXJEYXRhLmhhbmRsZTtjdXJEYXRhLmV2ZW50cz17fTtmb3IodHlwZSBpbiBldmVudHMpe2ZvcihpPTAsbD1ldmVudHNbdHlwZV0ubGVuZ3RoO2k8bDtpKyspe2pRdWVyeS5ldmVudC5hZGQoZGVzdCx0eXBlLGV2ZW50c1t0eXBlXVtpXSk7fX19CmlmKGN1ckRhdGEuZGF0YSl7Y3VyRGF0YS5kYXRhPWpRdWVyeS5leHRlbmQoe30sY3VyRGF0YS5kYXRhKTt9fQpmdW5jdGlvbiBmaXhDbG9uZU5vZGVJc3N1ZXMoc3JjLGRlc3Qpe3ZhciBub2RlTmFtZSxlLGRhdGE7aWYoZGVzdC5ub2RlVHlwZSE9PTEpe3JldHVybjt9Cm5vZGVOYW1lPWRlc3Qubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtpZighc3VwcG9ydC5ub0Nsb25lRXZlbnQmJmRlc3RbalF1ZXJ5LmV4cGFuZG9dKXtkYXRhPWpRdWVyeS5fZGF0YShkZXN0KTtmb3IoZSBpbiBkYXRhLmV2ZW50cyl7alF1ZXJ5LnJlbW92ZUV2ZW50KGRlc3QsZSxkYXRhLmhhbmRsZSk7fQpkZXN0LnJlbW92ZUF0dHJpYnV0ZShqUXVlcnkuZXhwYW5kbyk7fQppZihub2RlTmFtZT09PSJzY3JpcHQiJiZkZXN0LnRleHQhPT1zcmMudGV4dCl7ZGlzYWJsZVNjcmlwdChkZXN0KS50ZXh0PXNyYy50ZXh0O3Jlc3RvcmVTY3JpcHQoZGVzdCk7fWVsc2UgaWYobm9kZU5hbWU9PT0ib2JqZWN0Iil7aWYoZGVzdC5wYXJlbnROb2RlKXtkZXN0Lm91dGVySFRNTD1zcmMub3V0ZXJIVE1MO30KaWYoc3VwcG9ydC5odG1sNUNsb25lJiYoc3JjLmlubmVySFRNTCYmIWpRdWVyeS50cmltKGRlc3QuaW5uZXJIVE1MKSkpe2Rlc3QuaW5uZXJIVE1MPXNyYy5pbm5lckhUTUw7fX1lbHNlIGlmKG5vZGVOYW1lPT09ImlucHV0IiYmcmNoZWNrYWJsZVR5cGUudGVzdChzcmMudHlwZSkpe2Rlc3QuZGVmYXVsdENoZWNrZWQ9ZGVzdC5jaGVja2VkPXNyYy5jaGVja2VkO2lmKGRlc3QudmFsdWUhPT1zcmMudmFsdWUpe2Rlc3QudmFsdWU9c3JjLnZhbHVlO319ZWxzZSBpZihub2RlTmFtZT09PSJvcHRpb24iKXtkZXN0LmRlZmF1bHRTZWxlY3RlZD1kZXN0LnNlbGVjdGVkPXNyYy5kZWZhdWx0U2VsZWN0ZWQ7fWVsc2UgaWYobm9kZU5hbWU9PT0iaW5wdXQifHxub2RlTmFtZT09PSJ0ZXh0YXJlYSIpe2Rlc3QuZGVmYXVsdFZhbHVlPXNyYy5kZWZhdWx0VmFsdWU7fX0KalF1ZXJ5LmV4dGVuZCh7Y2xvbmU6ZnVuY3Rpb24oZWxlbSxkYXRhQW5kRXZlbnRzLGRlZXBEYXRhQW5kRXZlbnRzKXt2YXIgZGVzdEVsZW1lbnRzLG5vZGUsY2xvbmUsaSxzcmNFbGVtZW50cyxpblBhZ2U9alF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCxlbGVtKTtpZihzdXBwb3J0Lmh0bWw1Q2xvbmV8fGpRdWVyeS5pc1hNTERvYyhlbGVtKXx8IXJub3NoaW1jYWNoZS50ZXN0KCI8IitlbGVtLm5vZGVOYW1lKyI+Iikpe2Nsb25lPWVsZW0uY2xvbmVOb2RlKHRydWUpO31lbHNle2ZyYWdtZW50RGl2LmlubmVySFRNTD1lbGVtLm91dGVySFRNTDtmcmFnbWVudERpdi5yZW1vdmVDaGlsZChjbG9uZT1mcmFnbWVudERpdi5maXJzdENoaWxkKTt9CmlmKCghc3VwcG9ydC5ub0Nsb25lRXZlbnR8fCFzdXBwb3J0Lm5vQ2xvbmVDaGVja2VkKSYmKGVsZW0ubm9kZVR5cGU9PT0xfHxlbGVtLm5vZGVUeXBlPT09MTEpJiYhalF1ZXJ5LmlzWE1MRG9jKGVsZW0pKXtkZXN0RWxlbWVudHM9Z2V0QWxsKGNsb25lKTtzcmNFbGVtZW50cz1nZXRBbGwoZWxlbSk7Zm9yKGk9MDsobm9kZT1zcmNFbGVtZW50c1tpXSkhPW51bGw7KytpKXtpZihkZXN0RWxlbWVudHNbaV0pe2ZpeENsb25lTm9kZUlzc3Vlcyhub2RlLGRlc3RFbGVtZW50c1tpXSk7fX19CmlmKGRhdGFBbmRFdmVudHMpe2lmKGRlZXBEYXRhQW5kRXZlbnRzKXtzcmNFbGVtZW50cz1zcmNFbGVtZW50c3x8Z2V0QWxsKGVsZW0pO2Rlc3RFbGVtZW50cz1kZXN0RWxlbWVudHN8fGdldEFsbChjbG9uZSk7Zm9yKGk9MDsobm9kZT1zcmNFbGVtZW50c1tpXSkhPW51bGw7aSsrKXtjbG9uZUNvcHlFdmVudChub2RlLGRlc3RFbGVtZW50c1tpXSk7fX1lbHNle2Nsb25lQ29weUV2ZW50KGVsZW0sY2xvbmUpO319CmRlc3RFbGVtZW50cz1nZXRBbGwoY2xvbmUsInNjcmlwdCIpO2lmKGRlc3RFbGVtZW50cy5sZW5ndGg+MCl7c2V0R2xvYmFsRXZhbChkZXN0RWxlbWVudHMsIWluUGFnZSYmZ2V0QWxsKGVsZW0sInNjcmlwdCIpKTt9CmRlc3RFbGVtZW50cz1zcmNFbGVtZW50cz1ub2RlPW51bGw7cmV0dXJuIGNsb25lO30sYnVpbGRGcmFnbWVudDpmdW5jdGlvbihlbGVtcyxjb250ZXh0LHNjcmlwdHMsc2VsZWN0aW9uKXt2YXIgaixlbGVtLGNvbnRhaW5zLHRtcCx0YWcsdGJvZHksd3JhcCxsPWVsZW1zLmxlbmd0aCxzYWZlPWNyZWF0ZVNhZmVGcmFnbWVudChjb250ZXh0KSxub2Rlcz1bXSxpPTA7Zm9yKDtpPGw7aSsrKXtlbGVtPWVsZW1zW2ldO2lmKGVsZW18fGVsZW09PT0wKXtpZihqUXVlcnkudHlwZShlbGVtKT09PSJvYmplY3QiKXtqUXVlcnkubWVyZ2Uobm9kZXMsZWxlbS5ub2RlVHlwZT9bZWxlbV06ZWxlbSk7fWVsc2UgaWYoIXJodG1sLnRlc3QoZWxlbSkpe25vZGVzLnB1c2goY29udGV4dC5jcmVhdGVUZXh0Tm9kZShlbGVtKSk7fWVsc2V7dG1wPXRtcHx8c2FmZS5hcHBlbmRDaGlsZChjb250ZXh0LmNyZWF0ZUVsZW1lbnQoImRpdiIpKTt0YWc9KHJ0YWdOYW1lLmV4ZWMoZWxlbSl8fFsiIiwiIl0pWzFdLnRvTG93ZXJDYXNlKCk7d3JhcD13cmFwTWFwW3RhZ118fHdyYXBNYXAuX2RlZmF1bHQ7dG1wLmlubmVySFRNTD13cmFwWzFdK2VsZW0ucmVwbGFjZShyeGh0bWxUYWcsIjwkMT48LyQyPiIpK3dyYXBbMl07aj13cmFwWzBdO3doaWxlKGotLSl7dG1wPXRtcC5sYXN0Q2hpbGQ7fQppZighc3VwcG9ydC5sZWFkaW5nV2hpdGVzcGFjZSYmcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QoZWxlbSkpe25vZGVzLnB1c2goY29udGV4dC5jcmVhdGVUZXh0Tm9kZShybGVhZGluZ1doaXRlc3BhY2UuZXhlYyhlbGVtKVswXSkpO30KaWYoIXN1cHBvcnQudGJvZHkpe2VsZW09dGFnPT09InRhYmxlIiYmIXJ0Ym9keS50ZXN0KGVsZW0pP3RtcC5maXJzdENoaWxkOndyYXBbMV09PT0iPHRhYmxlPiImJiFydGJvZHkudGVzdChlbGVtKT90bXA6MDtqPWVsZW0mJmVsZW0uY2hpbGROb2Rlcy5sZW5ndGg7d2hpbGUoai0tKXtpZihqUXVlcnkubm9kZU5hbWUoKHRib2R5PWVsZW0uY2hpbGROb2Rlc1tqXSksInRib2R5IikmJiF0Ym9keS5jaGlsZE5vZGVzLmxlbmd0aCl7ZWxlbS5yZW1vdmVDaGlsZCh0Ym9keSk7fX19CmpRdWVyeS5tZXJnZShub2Rlcyx0bXAuY2hpbGROb2Rlcyk7dG1wLnRleHRDb250ZW50PSIiO3doaWxlKHRtcC5maXJzdENoaWxkKXt0bXAucmVtb3ZlQ2hpbGQodG1wLmZpcnN0Q2hpbGQpO30KdG1wPXNhZmUubGFzdENoaWxkO319fQppZih0bXApe3NhZmUucmVtb3ZlQ2hpbGQodG1wKTt9CmlmKCFzdXBwb3J0LmFwcGVuZENoZWNrZWQpe2pRdWVyeS5ncmVwKGdldEFsbChub2RlcywiaW5wdXQiKSxmaXhEZWZhdWx0Q2hlY2tlZCk7fQppPTA7d2hpbGUoKGVsZW09bm9kZXNbaSsrXSkpe2lmKHNlbGVjdGlvbiYmalF1ZXJ5LmluQXJyYXkoZWxlbSxzZWxlY3Rpb24pIT09LTEpe2NvbnRpbnVlO30KY29udGFpbnM9alF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCxlbGVtKTt0bXA9Z2V0QWxsKHNhZmUuYXBwZW5kQ2hpbGQoZWxlbSksInNjcmlwdCIpO2lmKGNvbnRhaW5zKXtzZXRHbG9iYWxFdmFsKHRtcCk7fQppZihzY3JpcHRzKXtqPTA7d2hpbGUoKGVsZW09dG1wW2orK10pKXtpZihyc2NyaXB0VHlwZS50ZXN0KGVsZW0udHlwZXx8IiIpKXtzY3JpcHRzLnB1c2goZWxlbSk7fX19fQp0bXA9bnVsbDtyZXR1cm4gc2FmZTt9LGNsZWFuRGF0YTpmdW5jdGlvbihlbGVtcyxhY2NlcHREYXRhKXt2YXIgZWxlbSx0eXBlLGlkLGRhdGEsaT0wLGludGVybmFsS2V5PWpRdWVyeS5leHBhbmRvLGNhY2hlPWpRdWVyeS5jYWNoZSxkZWxldGVFeHBhbmRvPXN1cHBvcnQuZGVsZXRlRXhwYW5kbyxzcGVjaWFsPWpRdWVyeS5ldmVudC5zcGVjaWFsO2Zvcig7KGVsZW09ZWxlbXNbaV0pIT1udWxsO2krKyl7aWYoYWNjZXB0RGF0YXx8alF1ZXJ5LmFjY2VwdERhdGEoZWxlbSkpe2lkPWVsZW1baW50ZXJuYWxLZXldO2RhdGE9aWQmJmNhY2hlW2lkXTtpZihkYXRhKXtpZihkYXRhLmV2ZW50cyl7Zm9yKHR5cGUgaW4gZGF0YS5ldmVudHMpe2lmKHNwZWNpYWxbdHlwZV0pe2pRdWVyeS5ldmVudC5yZW1vdmUoZWxlbSx0eXBlKTt9ZWxzZXtqUXVlcnkucmVtb3ZlRXZlbnQoZWxlbSx0eXBlLGRhdGEuaGFuZGxlKTt9fX0KaWYoY2FjaGVbaWRdKXtkZWxldGUgY2FjaGVbaWRdO2lmKGRlbGV0ZUV4cGFuZG8pe2RlbGV0ZSBlbGVtW2ludGVybmFsS2V5XTt9ZWxzZSBpZih0eXBlb2YgZWxlbS5yZW1vdmVBdHRyaWJ1dGUhPT1zdHJ1bmRlZmluZWQpe2VsZW0ucmVtb3ZlQXR0cmlidXRlKGludGVybmFsS2V5KTt9ZWxzZXtlbGVtW2ludGVybmFsS2V5XT1udWxsO30KZGVsZXRlZElkcy5wdXNoKGlkKTt9fX19fX0pO2pRdWVyeS5mbi5leHRlbmQoe3RleHQ6ZnVuY3Rpb24odmFsdWUpe3JldHVybiBhY2Nlc3ModGhpcyxmdW5jdGlvbih2YWx1ZSl7cmV0dXJuIHZhbHVlPT09dW5kZWZpbmVkP2pRdWVyeS50ZXh0KHRoaXMpOnRoaXMuZW1wdHkoKS5hcHBlbmQoKHRoaXNbMF0mJnRoaXNbMF0ub3duZXJEb2N1bWVudHx8ZG9jdW1lbnQpLmNyZWF0ZVRleHROb2RlKHZhbHVlKSk7fSxudWxsLHZhbHVlLGFyZ3VtZW50cy5sZW5ndGgpO30sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2lmKHRoaXMubm9kZVR5cGU9PT0xfHx0aGlzLm5vZGVUeXBlPT09MTF8fHRoaXMubm9kZVR5cGU9PT05KXt2YXIgdGFyZ2V0PW1hbmlwdWxhdGlvblRhcmdldCh0aGlzLGVsZW0pO3RhcmdldC5hcHBlbmRDaGlsZChlbGVtKTt9fSk7fSxwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2lmKHRoaXMubm9kZVR5cGU9PT0xfHx0aGlzLm5vZGVUeXBlPT09MTF8fHRoaXMubm9kZVR5cGU9PT05KXt2YXIgdGFyZ2V0PW1hbmlwdWxhdGlvblRhcmdldCh0aGlzLGVsZW0pO3RhcmdldC5pbnNlcnRCZWZvcmUoZWxlbSx0YXJnZXQuZmlyc3RDaGlsZCk7fX0pO30sYmVmb3JlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2lmKHRoaXMucGFyZW50Tm9kZSl7dGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtLHRoaXMpO319KTt9LGFmdGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2lmKHRoaXMucGFyZW50Tm9kZSl7dGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtLHRoaXMubmV4dFNpYmxpbmcpO319KTt9LHJlbW92ZTpmdW5jdGlvbihzZWxlY3RvcixrZWVwRGF0YSl7dmFyIGVsZW0sZWxlbXM9c2VsZWN0b3I/alF1ZXJ5LmZpbHRlcihzZWxlY3Rvcix0aGlzKTp0aGlzLGk9MDtmb3IoOyhlbGVtPWVsZW1zW2ldKSE9bnVsbDtpKyspe2lmKCFrZWVwRGF0YSYmZWxlbS5ub2RlVHlwZT09PTEpe2pRdWVyeS5jbGVhbkRhdGEoZ2V0QWxsKGVsZW0pKTt9CmlmKGVsZW0ucGFyZW50Tm9kZSl7aWYoa2VlcERhdGEmJmpRdWVyeS5jb250YWlucyhlbGVtLm93bmVyRG9jdW1lbnQsZWxlbSkpe3NldEdsb2JhbEV2YWwoZ2V0QWxsKGVsZW0sInNjcmlwdCIpKTt9CmVsZW0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtKTt9fQpyZXR1cm4gdGhpczt9LGVtcHR5OmZ1bmN0aW9uKCl7dmFyIGVsZW0saT0wO2Zvcig7KGVsZW09dGhpc1tpXSkhPW51bGw7aSsrKXtpZihlbGVtLm5vZGVUeXBlPT09MSl7alF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwoZWxlbSxmYWxzZSkpO30Kd2hpbGUoZWxlbS5maXJzdENoaWxkKXtlbGVtLnJlbW92ZUNoaWxkKGVsZW0uZmlyc3RDaGlsZCk7fQppZihlbGVtLm9wdGlvbnMmJmpRdWVyeS5ub2RlTmFtZShlbGVtLCJzZWxlY3QiKSl7ZWxlbS5vcHRpb25zLmxlbmd0aD0wO319CnJldHVybiB0aGlzO30sY2xvbmU6ZnVuY3Rpb24oZGF0YUFuZEV2ZW50cyxkZWVwRGF0YUFuZEV2ZW50cyl7ZGF0YUFuZEV2ZW50cz1kYXRhQW5kRXZlbnRzPT1udWxsP2ZhbHNlOmRhdGFBbmRFdmVudHM7ZGVlcERhdGFBbmRFdmVudHM9ZGVlcERhdGFBbmRFdmVudHM9PW51bGw/ZGF0YUFuZEV2ZW50czpkZWVwRGF0YUFuZEV2ZW50cztyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4galF1ZXJ5LmNsb25lKHRoaXMsZGF0YUFuZEV2ZW50cyxkZWVwRGF0YUFuZEV2ZW50cyk7fSk7fSxodG1sOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gYWNjZXNzKHRoaXMsZnVuY3Rpb24odmFsdWUpe3ZhciBlbGVtPXRoaXNbMF18fHt9LGk9MCxsPXRoaXMubGVuZ3RoO2lmKHZhbHVlPT09dW5kZWZpbmVkKXtyZXR1cm4gZWxlbS5ub2RlVHlwZT09PTE/ZWxlbS5pbm5lckhUTUwucmVwbGFjZShyaW5saW5lalF1ZXJ5LCIiKTp1bmRlZmluZWQ7fQppZih0eXBlb2YgdmFsdWU9PT0ic3RyaW5nIiYmIXJub0lubmVyaHRtbC50ZXN0KHZhbHVlKSYmKHN1cHBvcnQuaHRtbFNlcmlhbGl6ZXx8IXJub3NoaW1jYWNoZS50ZXN0KHZhbHVlKSkmJihzdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlfHwhcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QodmFsdWUpKSYmIXdyYXBNYXBbKHJ0YWdOYW1lLmV4ZWModmFsdWUpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7dmFsdWU9dmFsdWUucmVwbGFjZShyeGh0bWxUYWcsIjwkMT48LyQyPiIpO3RyeXtmb3IoO2k8bDtpKyspe2VsZW09dGhpc1tpXXx8e307aWYoZWxlbS5ub2RlVHlwZT09PTEpe2pRdWVyeS5jbGVhbkRhdGEoZ2V0QWxsKGVsZW0sZmFsc2UpKTtlbGVtLmlubmVySFRNTD12YWx1ZTt9fQplbGVtPTA7fWNhdGNoKGUpe319CmlmKGVsZW0pe3RoaXMuZW1wdHkoKS5hcHBlbmQodmFsdWUpO319LG51bGwsdmFsdWUsYXJndW1lbnRzLmxlbmd0aCk7fSxyZXBsYWNlV2l0aDpmdW5jdGlvbigpe3ZhciBhcmc9YXJndW1lbnRzWzBdO3RoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2FyZz10aGlzLnBhcmVudE5vZGU7alF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwodGhpcykpO2lmKGFyZyl7YXJnLnJlcGxhY2VDaGlsZChlbGVtLHRoaXMpO319KTtyZXR1cm4gYXJnJiYoYXJnLmxlbmd0aHx8YXJnLm5vZGVUeXBlKT90aGlzOnRoaXMucmVtb3ZlKCk7fSxkZXRhY2g6ZnVuY3Rpb24oc2VsZWN0b3Ipe3JldHVybiB0aGlzLnJlbW92ZShzZWxlY3Rvcix0cnVlKTt9LGRvbU1hbmlwOmZ1bmN0aW9uKGFyZ3MsY2FsbGJhY2spe2FyZ3M9Y29uY2F0LmFwcGx5KFtdLGFyZ3MpO3ZhciBmaXJzdCxub2RlLGhhc1NjcmlwdHMsc2NyaXB0cyxkb2MsZnJhZ21lbnQsaT0wLGw9dGhpcy5sZW5ndGgsc2V0PXRoaXMsaU5vQ2xvbmU9bC0xLHZhbHVlPWFyZ3NbMF0saXNGdW5jdGlvbj1qUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSk7aWYoaXNGdW5jdGlvbnx8KGw+MSYmdHlwZW9mIHZhbHVlPT09InN0cmluZyImJiFzdXBwb3J0LmNoZWNrQ2xvbmUmJnJjaGVja2VkLnRlc3QodmFsdWUpKSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpbmRleCl7dmFyIHNlbGY9c2V0LmVxKGluZGV4KTtpZihpc0Z1bmN0aW9uKXthcmdzWzBdPXZhbHVlLmNhbGwodGhpcyxpbmRleCxzZWxmLmh0bWwoKSk7fQpzZWxmLmRvbU1hbmlwKGFyZ3MsY2FsbGJhY2spO30pO30KaWYobCl7ZnJhZ21lbnQ9alF1ZXJ5LmJ1aWxkRnJhZ21lbnQoYXJncyx0aGlzWzBdLm93bmVyRG9jdW1lbnQsZmFsc2UsdGhpcyk7Zmlyc3Q9ZnJhZ21lbnQuZmlyc3RDaGlsZDtpZihmcmFnbWVudC5jaGlsZE5vZGVzLmxlbmd0aD09PTEpe2ZyYWdtZW50PWZpcnN0O30KaWYoZmlyc3Qpe3NjcmlwdHM9alF1ZXJ5Lm1hcChnZXRBbGwoZnJhZ21lbnQsInNjcmlwdCIpLGRpc2FibGVTY3JpcHQpO2hhc1NjcmlwdHM9c2NyaXB0cy5sZW5ndGg7Zm9yKDtpPGw7aSsrKXtub2RlPWZyYWdtZW50O2lmKGkhPT1pTm9DbG9uZSl7bm9kZT1qUXVlcnkuY2xvbmUobm9kZSx0cnVlLHRydWUpO2lmKGhhc1NjcmlwdHMpe2pRdWVyeS5tZXJnZShzY3JpcHRzLGdldEFsbChub2RlLCJzY3JpcHQiKSk7fX0KY2FsbGJhY2suY2FsbCh0aGlzW2ldLG5vZGUsaSk7fQppZihoYXNTY3JpcHRzKXtkb2M9c2NyaXB0c1tzY3JpcHRzLmxlbmd0aC0xXS5vd25lckRvY3VtZW50O2pRdWVyeS5tYXAoc2NyaXB0cyxyZXN0b3JlU2NyaXB0KTtmb3IoaT0wO2k8aGFzU2NyaXB0cztpKyspe25vZGU9c2NyaXB0c1tpXTtpZihyc2NyaXB0VHlwZS50ZXN0KG5vZGUudHlwZXx8IiIpJiYhalF1ZXJ5Ll9kYXRhKG5vZGUsImdsb2JhbEV2YWwiKSYmalF1ZXJ5LmNvbnRhaW5zKGRvYyxub2RlKSl7aWYobm9kZS5zcmMpe2lmKGpRdWVyeS5fZXZhbFVybCl7alF1ZXJ5Ll9ldmFsVXJsKG5vZGUuc3JjKTt9fWVsc2V7alF1ZXJ5Lmdsb2JhbEV2YWwoKG5vZGUudGV4dHx8bm9kZS50ZXh0Q29udGVudHx8bm9kZS5pbm5lckhUTUx8fCIiKS5yZXBsYWNlKHJjbGVhblNjcmlwdCwiIikpO319fX0KZnJhZ21lbnQ9Zmlyc3Q9bnVsbDt9fQpyZXR1cm4gdGhpczt9fSk7alF1ZXJ5LmVhY2goe2FwcGVuZFRvOiJhcHBlbmQiLHByZXBlbmRUbzoicHJlcGVuZCIsaW5zZXJ0QmVmb3JlOiJiZWZvcmUiLGluc2VydEFmdGVyOiJhZnRlciIscmVwbGFjZUFsbDoicmVwbGFjZVdpdGgifSxmdW5jdGlvbihuYW1lLG9yaWdpbmFsKXtqUXVlcnkuZm5bbmFtZV09ZnVuY3Rpb24oc2VsZWN0b3Ipe3ZhciBlbGVtcyxpPTAscmV0PVtdLGluc2VydD1qUXVlcnkoc2VsZWN0b3IpLGxhc3Q9aW5zZXJ0Lmxlbmd0aC0xO2Zvcig7aTw9bGFzdDtpKyspe2VsZW1zPWk9PT1sYXN0P3RoaXM6dGhpcy5jbG9uZSh0cnVlKTtqUXVlcnkoaW5zZXJ0W2ldKVtvcmlnaW5hbF0oZWxlbXMpO3B1c2guYXBwbHkocmV0LGVsZW1zLmdldCgpKTt9CnJldHVybiB0aGlzLnB1c2hTdGFjayhyZXQpO307fSk7dmFyIGlmcmFtZSxlbGVtZGlzcGxheT17fTtmdW5jdGlvbiBhY3R1YWxEaXNwbGF5KG5hbWUsZG9jKXt2YXIgZWxlbT1qUXVlcnkoZG9jLmNyZWF0ZUVsZW1lbnQobmFtZSkpLmFwcGVuZFRvKGRvYy5ib2R5KSxkaXNwbGF5PXdpbmRvdy5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZT93aW5kb3cuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUoZWxlbVswXSkuZGlzcGxheTpqUXVlcnkuY3NzKGVsZW1bMF0sImRpc3BsYXkiKTtlbGVtLmRldGFjaCgpO3JldHVybiBkaXNwbGF5O30KZnVuY3Rpb24gZGVmYXVsdERpc3BsYXkobm9kZU5hbWUpe3ZhciBkb2M9ZG9jdW1lbnQsZGlzcGxheT1lbGVtZGlzcGxheVtub2RlTmFtZV07aWYoIWRpc3BsYXkpe2Rpc3BsYXk9YWN0dWFsRGlzcGxheShub2RlTmFtZSxkb2MpO2lmKGRpc3BsYXk9PT0ibm9uZSJ8fCFkaXNwbGF5KXtpZnJhbWU9KGlmcmFtZXx8alF1ZXJ5KCI8aWZyYW1lIGZyYW1lYm9yZGVyPScwJyB3aWR0aD0nMCcgaGVpZ2h0PScwJy8+IikpLmFwcGVuZFRvKGRvYy5kb2N1bWVudEVsZW1lbnQpO2RvYz0oaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3d8fGlmcmFtZVswXS5jb250ZW50RG9jdW1lbnQpLmRvY3VtZW50O2RvYy53cml0ZSgpO2RvYy5jbG9zZSgpO2Rpc3BsYXk9YWN0dWFsRGlzcGxheShub2RlTmFtZSxkb2MpO2lmcmFtZS5kZXRhY2goKTt9CmVsZW1kaXNwbGF5W25vZGVOYW1lXT1kaXNwbGF5O30KcmV0dXJuIGRpc3BsYXk7fQooZnVuY3Rpb24oKXt2YXIgYSxzaHJpbmtXcmFwQmxvY2tzVmFsLGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxkaXZSZXNldD0iLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94Oy1tb3otYm94LXNpemluZzpjb250ZW50LWJveDtib3gtc2l6aW5nOmNvbnRlbnQtYm94OyIrImRpc3BsYXk6YmxvY2s7cGFkZGluZzowO21hcmdpbjowO2JvcmRlcjowIjtkaXYuaW5uZXJIVE1MPSIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iO2E9ZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJhIilbMF07YS5zdHlsZS5jc3NUZXh0PSJmbG9hdDpsZWZ0O29wYWNpdHk6LjUiO3N1cHBvcnQub3BhY2l0eT0vXjAuNS8udGVzdChhLnN0eWxlLm9wYWNpdHkpO3N1cHBvcnQuY3NzRmxvYXQ9ISFhLnN0eWxlLmNzc0Zsb2F0O2Rpdi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iY29udGVudC1ib3giO2Rpdi5jbG9uZU5vZGUodHJ1ZSkuc3R5bGUuYmFja2dyb3VuZENsaXA9IiI7c3VwcG9ydC5jbGVhckNsb25lU3R5bGU9ZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwPT09ImNvbnRlbnQtYm94IjthPWRpdj1udWxsO3N1cHBvcnQuc2hyaW5rV3JhcEJsb2Nrcz1mdW5jdGlvbigpe3ZhciBib2R5LGNvbnRhaW5lcixkaXYsY29udGFpbmVyU3R5bGVzO2lmKHNocmlua1dyYXBCbG9ja3NWYWw9PW51bGwpe2JvZHk9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImJvZHkiKVswXTtpZighYm9keSl7cmV0dXJuO30KY29udGFpbmVyU3R5bGVzPSJib3JkZXI6MDt3aWR0aDowO2hlaWdodDowO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6LTk5OTlweCI7Y29udGFpbmVyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2Rpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcikuYXBwZW5kQ2hpbGQoZGl2KTtzaHJpbmtXcmFwQmxvY2tzVmFsPWZhbHNlO2lmKHR5cGVvZiBkaXYuc3R5bGUuem9vbSE9PXN0cnVuZGVmaW5lZCl7ZGl2LnN0eWxlLmNzc1RleHQ9ZGl2UmVzZXQrIjt3aWR0aDoxcHg7cGFkZGluZzoxcHg7em9vbToxIjtkaXYuaW5uZXJIVE1MPSI8ZGl2PjwvZGl2PiI7ZGl2LmZpcnN0Q2hpbGQuc3R5bGUud2lkdGg9IjVweCI7c2hyaW5rV3JhcEJsb2Nrc1ZhbD1kaXYub2Zmc2V0V2lkdGghPT0zO30KYm9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO2JvZHk9Y29udGFpbmVyPWRpdj1udWxsO30KcmV0dXJuIHNocmlua1dyYXBCbG9ja3NWYWw7fTt9KSgpO3ZhciBybWFyZ2luPSgvXm1hcmdpbi8pO3ZhciBybnVtbm9ucHg9bmV3IFJlZ0V4cCgiXigiK3BudW0rIikoPyFweClbYS16JV0rJCIsImkiKTt2YXIgZ2V0U3R5bGVzLGN1ckNTUyxycG9zaXRpb249L14odG9wfHJpZ2h0fGJvdHRvbXxsZWZ0KSQvO2lmKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKXtnZXRTdHlsZXM9ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZW0sbnVsbCk7fTtjdXJDU1M9ZnVuY3Rpb24oZWxlbSxuYW1lLGNvbXB1dGVkKXt2YXIgd2lkdGgsbWluV2lkdGgsbWF4V2lkdGgscmV0LHN0eWxlPWVsZW0uc3R5bGU7Y29tcHV0ZWQ9Y29tcHV0ZWR8fGdldFN0eWxlcyhlbGVtKTtyZXQ9Y29tcHV0ZWQ/Y29tcHV0ZWQuZ2V0UHJvcGVydHlWYWx1ZShuYW1lKXx8Y29tcHV0ZWRbbmFtZV06dW5kZWZpbmVkO2lmKGNvbXB1dGVkKXtpZihyZXQ9PT0iIiYmIWpRdWVyeS5jb250YWlucyhlbGVtLm93bmVyRG9jdW1lbnQsZWxlbSkpe3JldD1qUXVlcnkuc3R5bGUoZWxlbSxuYW1lKTt9CmlmKHJudW1ub25weC50ZXN0KHJldCkmJnJtYXJnaW4udGVzdChuYW1lKSl7d2lkdGg9c3R5bGUud2lkdGg7bWluV2lkdGg9c3R5bGUubWluV2lkdGg7bWF4V2lkdGg9c3R5bGUubWF4V2lkdGg7c3R5bGUubWluV2lkdGg9c3R5bGUubWF4V2lkdGg9c3R5bGUud2lkdGg9cmV0O3JldD1jb21wdXRlZC53aWR0aDtzdHlsZS53aWR0aD13aWR0aDtzdHlsZS5taW5XaWR0aD1taW5XaWR0aDtzdHlsZS5tYXhXaWR0aD1tYXhXaWR0aDt9fQpyZXR1cm4gcmV0PT09dW5kZWZpbmVkP3JldDpyZXQrIiI7fTt9ZWxzZSBpZihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlKXtnZXRTdHlsZXM9ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGVsZW0uY3VycmVudFN0eWxlO307Y3VyQ1NTPWZ1bmN0aW9uKGVsZW0sbmFtZSxjb21wdXRlZCl7dmFyIGxlZnQscnMscnNMZWZ0LHJldCxzdHlsZT1lbGVtLnN0eWxlO2NvbXB1dGVkPWNvbXB1dGVkfHxnZXRTdHlsZXMoZWxlbSk7cmV0PWNvbXB1dGVkP2NvbXB1dGVkW25hbWVdOnVuZGVmaW5lZDtpZihyZXQ9PW51bGwmJnN0eWxlJiZzdHlsZVtuYW1lXSl7cmV0PXN0eWxlW25hbWVdO30KaWYocm51bW5vbnB4LnRlc3QocmV0KSYmIXJwb3NpdGlvbi50ZXN0KG5hbWUpKXtsZWZ0PXN0eWxlLmxlZnQ7cnM9ZWxlbS5ydW50aW1lU3R5bGU7cnNMZWZ0PXJzJiZycy5sZWZ0O2lmKHJzTGVmdCl7cnMubGVmdD1lbGVtLmN1cnJlbnRTdHlsZS5sZWZ0O30Kc3R5bGUubGVmdD1uYW1lPT09ImZvbnRTaXplIj8iMWVtIjpyZXQ7cmV0PXN0eWxlLnBpeGVsTGVmdCsicHgiO3N0eWxlLmxlZnQ9bGVmdDtpZihyc0xlZnQpe3JzLmxlZnQ9cnNMZWZ0O319CnJldHVybiByZXQ9PT11bmRlZmluZWQ/cmV0OnJldCsiInx8ImF1dG8iO307fQpmdW5jdGlvbiBhZGRHZXRIb29rSWYoY29uZGl0aW9uRm4saG9va0ZuKXtyZXR1cm57Z2V0OmZ1bmN0aW9uKCl7dmFyIGNvbmRpdGlvbj1jb25kaXRpb25GbigpO2lmKGNvbmRpdGlvbj09bnVsbCl7cmV0dXJuO30KaWYoY29uZGl0aW9uKXtkZWxldGUgdGhpcy5nZXQ7cmV0dXJuO30KcmV0dXJuKHRoaXMuZ2V0PWhvb2tGbikuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O30KKGZ1bmN0aW9uKCl7dmFyIGEscmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsLGJveFNpemluZ1ZhbCxib3hTaXppbmdSZWxpYWJsZVZhbCxwaXhlbFBvc2l0aW9uVmFsLHJlbGlhYmxlTWFyZ2luUmlnaHRWYWwsZGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLGNvbnRhaW5lclN0eWxlcz0iYm9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0Oi05OTk5cHgiLGRpdlJlc2V0PSItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94O2JveC1zaXppbmc6Y29udGVudC1ib3g7IisiZGlzcGxheTpibG9jaztwYWRkaW5nOjA7bWFyZ2luOjA7Ym9yZGVyOjAiO2Rpdi5pbm5lckhUTUw9IiAgPGxpbmsvPjx0YWJsZT48L3RhYmxlPjxhIGhyZWY9Jy9hJz5hPC9hPjxpbnB1dCB0eXBlPSdjaGVja2JveCcvPiI7YT1kaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImEiKVswXTthLnN0eWxlLmNzc1RleHQ9ImZsb2F0OmxlZnQ7b3BhY2l0eTouNSI7c3VwcG9ydC5vcGFjaXR5PS9eMC41Ly50ZXN0KGEuc3R5bGUub3BhY2l0eSk7c3VwcG9ydC5jc3NGbG9hdD0hIWEuc3R5bGUuY3NzRmxvYXQ7ZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwPSJjb250ZW50LWJveCI7ZGl2LmNsb25lTm9kZSh0cnVlKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iIjtzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZT1kaXYuc3R5bGUuYmFja2dyb3VuZENsaXA9PT0iY29udGVudC1ib3giO2E9ZGl2PW51bGw7alF1ZXJ5LmV4dGVuZChzdXBwb3J0LHtyZWxpYWJsZUhpZGRlbk9mZnNldHM6ZnVuY3Rpb24oKXtpZihyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwhPW51bGwpe3JldHVybiByZWxpYWJsZUhpZGRlbk9mZnNldHNWYWw7fQp2YXIgY29udGFpbmVyLHRkcyxpc1N1cHBvcnRlZCxkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksYm9keT1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdO2lmKCFib2R5KXtyZXR1cm47fQpkaXYuc2V0QXR0cmlidXRlKCJjbGFzc05hbWUiLCJ0Iik7ZGl2LmlubmVySFRNTD0iICA8bGluay8+PHRhYmxlPjwvdGFibGU+PGEgaHJlZj0nL2EnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+Ijtjb250YWluZXI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Y29udGFpbmVyLnN0eWxlLmNzc1RleHQ9Y29udGFpbmVyU3R5bGVzO2JvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKS5hcHBlbmRDaGlsZChkaXYpO2Rpdi5pbm5lckhUTUw9Ijx0YWJsZT48dHI+PHRkPjwvdGQ+PHRkPnQ8L3RkPjwvdHI+PC90YWJsZT4iO3Rkcz1kaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRkIik7dGRzWzBdLnN0eWxlLmNzc1RleHQ9InBhZGRpbmc6MDttYXJnaW46MDtib3JkZXI6MDtkaXNwbGF5Om5vbmUiO2lzU3VwcG9ydGVkPSh0ZHNbMF0ub2Zmc2V0SGVpZ2h0PT09MCk7dGRzWzBdLnN0eWxlLmRpc3BsYXk9IiI7dGRzWzFdLnN0eWxlLmRpc3BsYXk9Im5vbmUiO3JlbGlhYmxlSGlkZGVuT2Zmc2V0c1ZhbD1pc1N1cHBvcnRlZCYmKHRkc1swXS5vZmZzZXRIZWlnaHQ9PT0wKTtib2R5LnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7ZGl2PWJvZHk9bnVsbDtyZXR1cm4gcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsO30sYm94U2l6aW5nOmZ1bmN0aW9uKCl7aWYoYm94U2l6aW5nVmFsPT1udWxsKXtjb21wdXRlU3R5bGVUZXN0cygpO30KcmV0dXJuIGJveFNpemluZ1ZhbDt9LGJveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7aWYoYm94U2l6aW5nUmVsaWFibGVWYWw9PW51bGwpe2NvbXB1dGVTdHlsZVRlc3RzKCk7fQpyZXR1cm4gYm94U2l6aW5nUmVsaWFibGVWYWw7fSxwaXhlbFBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYocGl4ZWxQb3NpdGlvblZhbD09bnVsbCl7Y29tcHV0ZVN0eWxlVGVzdHMoKTt9CnJldHVybiBwaXhlbFBvc2l0aW9uVmFsO30scmVsaWFibGVNYXJnaW5SaWdodDpmdW5jdGlvbigpe3ZhciBib2R5LGNvbnRhaW5lcixkaXYsbWFyZ2luRGl2O2lmKHJlbGlhYmxlTWFyZ2luUmlnaHRWYWw9PW51bGwmJndpbmRvdy5nZXRDb21wdXRlZFN0eWxlKXtib2R5PWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07aWYoIWJvZHkpe3JldHVybjt9CmNvbnRhaW5lcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Y29udGFpbmVyLnN0eWxlLmNzc1RleHQ9Y29udGFpbmVyU3R5bGVzO2JvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKS5hcHBlbmRDaGlsZChkaXYpO21hcmdpbkRpdj1kaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpO21hcmdpbkRpdi5zdHlsZS5jc3NUZXh0PWRpdi5zdHlsZS5jc3NUZXh0PWRpdlJlc2V0O21hcmdpbkRpdi5zdHlsZS5tYXJnaW5SaWdodD1tYXJnaW5EaXYuc3R5bGUud2lkdGg9IjAiO2Rpdi5zdHlsZS53aWR0aD0iMXB4IjtyZWxpYWJsZU1hcmdpblJpZ2h0VmFsPSFwYXJzZUZsb2F0KCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShtYXJnaW5EaXYsbnVsbCl8fHt9KS5tYXJnaW5SaWdodCk7Ym9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO30KcmV0dXJuIHJlbGlhYmxlTWFyZ2luUmlnaHRWYWw7fX0pO2Z1bmN0aW9uIGNvbXB1dGVTdHlsZVRlc3RzKCl7dmFyIGNvbnRhaW5lcixkaXYsYm9keT1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdO2lmKCFib2R5KXtyZXR1cm47fQpjb250YWluZXI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7ZGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2NvbnRhaW5lci5zdHlsZS5jc3NUZXh0PWNvbnRhaW5lclN0eWxlcztib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcikuYXBwZW5kQ2hpbGQoZGl2KTtkaXYuc3R5bGUuY3NzVGV4dD0iLXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7LW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94OyIrInBvc2l0aW9uOmFic29sdXRlO2Rpc3BsYXk6YmxvY2s7cGFkZGluZzoxcHg7Ym9yZGVyOjFweDt3aWR0aDo0cHg7IisibWFyZ2luLXRvcDoxJTt0b3A6MSUiO2pRdWVyeS5zd2FwKGJvZHksYm9keS5zdHlsZS56b29tIT1udWxsP3t6b29tOjF9Ont9LGZ1bmN0aW9uKCl7Ym94U2l6aW5nVmFsPWRpdi5vZmZzZXRXaWR0aD09PTQ7fSk7Ym94U2l6aW5nUmVsaWFibGVWYWw9dHJ1ZTtwaXhlbFBvc2l0aW9uVmFsPWZhbHNlO3JlbGlhYmxlTWFyZ2luUmlnaHRWYWw9dHJ1ZTtpZih3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSl7cGl4ZWxQb3NpdGlvblZhbD0od2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2LG51bGwpfHx7fSkudG9wIT09IjElIjtib3hTaXppbmdSZWxpYWJsZVZhbD0od2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2LG51bGwpfHx7d2lkdGg6IjRweCJ9KS53aWR0aD09PSI0cHgiO30KYm9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO2Rpdj1ib2R5PW51bGw7fX0pKCk7alF1ZXJ5LnN3YXA9ZnVuY3Rpb24oZWxlbSxvcHRpb25zLGNhbGxiYWNrLGFyZ3Mpe3ZhciByZXQsbmFtZSxvbGQ9e307Zm9yKG5hbWUgaW4gb3B0aW9ucyl7b2xkW25hbWVdPWVsZW0uc3R5bGVbbmFtZV07ZWxlbS5zdHlsZVtuYW1lXT1vcHRpb25zW25hbWVdO30KcmV0PWNhbGxiYWNrLmFwcGx5KGVsZW0sYXJnc3x8W10pO2ZvcihuYW1lIGluIG9wdGlvbnMpe2VsZW0uc3R5bGVbbmFtZV09b2xkW25hbWVdO30KcmV0dXJuIHJldDt9O3ZhcgpyYWxwaGE9L2FscGhhXChbXildKlwpL2kscm9wYWNpdHk9L29wYWNpdHlccyo9XHMqKFteKV0qKS8scmRpc3BsYXlzd2FwPS9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLyxybnVtc3BsaXQ9bmV3IFJlZ0V4cCgiXigiK3BudW0rIikoLiopJCIsImkiKSxycmVsTnVtPW5ldyBSZWdFeHAoIl4oWystXSk9KCIrcG51bSsiKSIsImkiKSxjc3NTaG93PXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxjc3NOb3JtYWxUcmFuc2Zvcm09e2xldHRlclNwYWNpbmc6MCxmb250V2VpZ2h0OjQwMH0sY3NzUHJlZml4ZXM9WyJXZWJraXQiLCJPIiwiTW96IiwibXMiXTtmdW5jdGlvbiB2ZW5kb3JQcm9wTmFtZShzdHlsZSxuYW1lKXtpZihuYW1lIGluIHN0eWxlKXtyZXR1cm4gbmFtZTt9CnZhciBjYXBOYW1lPW5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrbmFtZS5zbGljZSgxKSxvcmlnTmFtZT1uYW1lLGk9Y3NzUHJlZml4ZXMubGVuZ3RoO3doaWxlKGktLSl7bmFtZT1jc3NQcmVmaXhlc1tpXStjYXBOYW1lO2lmKG5hbWUgaW4gc3R5bGUpe3JldHVybiBuYW1lO319CnJldHVybiBvcmlnTmFtZTt9CmZ1bmN0aW9uIHNob3dIaWRlKGVsZW1lbnRzLHNob3cpe3ZhciBkaXNwbGF5LGVsZW0saGlkZGVuLHZhbHVlcz1bXSxpbmRleD0wLGxlbmd0aD1lbGVtZW50cy5sZW5ndGg7Zm9yKDtpbmRleDxsZW5ndGg7aW5kZXgrKyl7ZWxlbT1lbGVtZW50c1tpbmRleF07aWYoIWVsZW0uc3R5bGUpe2NvbnRpbnVlO30KdmFsdWVzW2luZGV4XT1qUXVlcnkuX2RhdGEoZWxlbSwib2xkZGlzcGxheSIpO2Rpc3BsYXk9ZWxlbS5zdHlsZS5kaXNwbGF5O2lmKHNob3cpe2lmKCF2YWx1ZXNbaW5kZXhdJiZkaXNwbGF5PT09Im5vbmUiKXtlbGVtLnN0eWxlLmRpc3BsYXk9IiI7fQppZihlbGVtLnN0eWxlLmRpc3BsYXk9PT0iIiYmaXNIaWRkZW4oZWxlbSkpe3ZhbHVlc1tpbmRleF09alF1ZXJ5Ll9kYXRhKGVsZW0sIm9sZGRpc3BsYXkiLGRlZmF1bHREaXNwbGF5KGVsZW0ubm9kZU5hbWUpKTt9fWVsc2V7aWYoIXZhbHVlc1tpbmRleF0pe2hpZGRlbj1pc0hpZGRlbihlbGVtKTtpZihkaXNwbGF5JiZkaXNwbGF5IT09Im5vbmUifHwhaGlkZGVuKXtqUXVlcnkuX2RhdGEoZWxlbSwib2xkZGlzcGxheSIsaGlkZGVuP2Rpc3BsYXk6alF1ZXJ5LmNzcyhlbGVtLCJkaXNwbGF5IikpO319fX0KZm9yKGluZGV4PTA7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe2VsZW09ZWxlbWVudHNbaW5kZXhdO2lmKCFlbGVtLnN0eWxlKXtjb250aW51ZTt9CmlmKCFzaG93fHxlbGVtLnN0eWxlLmRpc3BsYXk9PT0ibm9uZSJ8fGVsZW0uc3R5bGUuZGlzcGxheT09PSIiKXtlbGVtLnN0eWxlLmRpc3BsYXk9c2hvdz92YWx1ZXNbaW5kZXhdfHwiIjoibm9uZSI7fX0KcmV0dXJuIGVsZW1lbnRzO30KZnVuY3Rpb24gc2V0UG9zaXRpdmVOdW1iZXIoZWxlbSx2YWx1ZSxzdWJ0cmFjdCl7dmFyIG1hdGNoZXM9cm51bXNwbGl0LmV4ZWModmFsdWUpO3JldHVybiBtYXRjaGVzP01hdGgubWF4KDAsbWF0Y2hlc1sxXS0oc3VidHJhY3R8fDApKSsobWF0Y2hlc1syXXx8InB4Iik6dmFsdWU7fQpmdW5jdGlvbiBhdWdtZW50V2lkdGhPckhlaWdodChlbGVtLG5hbWUsZXh0cmEsaXNCb3JkZXJCb3gsc3R5bGVzKXt2YXIgaT1leHRyYT09PShpc0JvcmRlckJveD8iYm9yZGVyIjoiY29udGVudCIpPzQ6bmFtZT09PSJ3aWR0aCI/MTowLHZhbD0wO2Zvcig7aTw0O2krPTIpe2lmKGV4dHJhPT09Im1hcmdpbiIpe3ZhbCs9alF1ZXJ5LmNzcyhlbGVtLGV4dHJhK2Nzc0V4cGFuZFtpXSx0cnVlLHN0eWxlcyk7fQppZihpc0JvcmRlckJveCl7aWYoZXh0cmE9PT0iY29udGVudCIpe3ZhbC09alF1ZXJ5LmNzcyhlbGVtLCJwYWRkaW5nIitjc3NFeHBhbmRbaV0sdHJ1ZSxzdHlsZXMpO30KaWYoZXh0cmEhPT0ibWFyZ2luIil7dmFsLT1qUXVlcnkuY3NzKGVsZW0sImJvcmRlciIrY3NzRXhwYW5kW2ldKyJXaWR0aCIsdHJ1ZSxzdHlsZXMpO319ZWxzZXt2YWwrPWpRdWVyeS5jc3MoZWxlbSwicGFkZGluZyIrY3NzRXhwYW5kW2ldLHRydWUsc3R5bGVzKTtpZihleHRyYSE9PSJwYWRkaW5nIil7dmFsKz1qUXVlcnkuY3NzKGVsZW0sImJvcmRlciIrY3NzRXhwYW5kW2ldKyJXaWR0aCIsdHJ1ZSxzdHlsZXMpO319fQpyZXR1cm4gdmFsO30KZnVuY3Rpb24gZ2V0V2lkdGhPckhlaWdodChlbGVtLG5hbWUsZXh0cmEpe3ZhciB2YWx1ZUlzQm9yZGVyQm94PXRydWUsdmFsPW5hbWU9PT0id2lkdGgiP2VsZW0ub2Zmc2V0V2lkdGg6ZWxlbS5vZmZzZXRIZWlnaHQsc3R5bGVzPWdldFN0eWxlcyhlbGVtKSxpc0JvcmRlckJveD1zdXBwb3J0LmJveFNpemluZygpJiZqUXVlcnkuY3NzKGVsZW0sImJveFNpemluZyIsZmFsc2Usc3R5bGVzKT09PSJib3JkZXItYm94IjtpZih2YWw8PTB8fHZhbD09bnVsbCl7dmFsPWN1ckNTUyhlbGVtLG5hbWUsc3R5bGVzKTtpZih2YWw8MHx8dmFsPT1udWxsKXt2YWw9ZWxlbS5zdHlsZVtuYW1lXTt9CmlmKHJudW1ub25weC50ZXN0KHZhbCkpe3JldHVybiB2YWw7fQp2YWx1ZUlzQm9yZGVyQm94PWlzQm9yZGVyQm94JiYoc3VwcG9ydC5ib3hTaXppbmdSZWxpYWJsZSgpfHx2YWw9PT1lbGVtLnN0eWxlW25hbWVdKTt2YWw9cGFyc2VGbG9hdCh2YWwpfHwwO30KcmV0dXJuKHZhbCsKYXVnbWVudFdpZHRoT3JIZWlnaHQoZWxlbSxuYW1lLGV4dHJhfHwoaXNCb3JkZXJCb3g/ImJvcmRlciI6ImNvbnRlbnQiKSx2YWx1ZUlzQm9yZGVyQm94LHN0eWxlcykpKyJweCI7fQpqUXVlcnkuZXh0ZW5kKHtjc3NIb29rczp7b3BhY2l0eTp7Z2V0OmZ1bmN0aW9uKGVsZW0sY29tcHV0ZWQpe2lmKGNvbXB1dGVkKXt2YXIgcmV0PWN1ckNTUyhlbGVtLCJvcGFjaXR5Iik7cmV0dXJuIHJldD09PSIiPyIxIjpyZXQ7fX19fSxjc3NOdW1iZXI6eyJjb2x1bW5Db3VudCI6dHJ1ZSwiZmlsbE9wYWNpdHkiOnRydWUsImZvbnRXZWlnaHQiOnRydWUsImxpbmVIZWlnaHQiOnRydWUsIm9wYWNpdHkiOnRydWUsIm9yZGVyIjp0cnVlLCJvcnBoYW5zIjp0cnVlLCJ3aWRvd3MiOnRydWUsInpJbmRleCI6dHJ1ZSwiem9vbSI6dHJ1ZX0sY3NzUHJvcHM6eyJmbG9hdCI6c3VwcG9ydC5jc3NGbG9hdD8iY3NzRmxvYXQiOiJzdHlsZUZsb2F0In0sc3R5bGU6ZnVuY3Rpb24oZWxlbSxuYW1lLHZhbHVlLGV4dHJhKXtpZighZWxlbXx8ZWxlbS5ub2RlVHlwZT09PTN8fGVsZW0ubm9kZVR5cGU9PT04fHwhZWxlbS5zdHlsZSl7cmV0dXJuO30KdmFyIHJldCx0eXBlLGhvb2tzLG9yaWdOYW1lPWpRdWVyeS5jYW1lbENhc2UobmFtZSksc3R5bGU9ZWxlbS5zdHlsZTtuYW1lPWpRdWVyeS5jc3NQcm9wc1tvcmlnTmFtZV18fChqUXVlcnkuY3NzUHJvcHNbb3JpZ05hbWVdPXZlbmRvclByb3BOYW1lKHN0eWxlLG9yaWdOYW1lKSk7aG9va3M9alF1ZXJ5LmNzc0hvb2tzW25hbWVdfHxqUXVlcnkuY3NzSG9va3Nbb3JpZ05hbWVdO2lmKHZhbHVlIT09dW5kZWZpbmVkKXt0eXBlPXR5cGVvZiB2YWx1ZTtpZih0eXBlPT09InN0cmluZyImJihyZXQ9cnJlbE51bS5leGVjKHZhbHVlKSkpe3ZhbHVlPShyZXRbMV0rMSkqcmV0WzJdK3BhcnNlRmxvYXQoalF1ZXJ5LmNzcyhlbGVtLG5hbWUpKTt0eXBlPSJudW1iZXIiO30KaWYodmFsdWU9PW51bGx8fHZhbHVlIT09dmFsdWUpe3JldHVybjt9CmlmKHR5cGU9PT0ibnVtYmVyIiYmIWpRdWVyeS5jc3NOdW1iZXJbb3JpZ05hbWVdKXt2YWx1ZSs9InB4Ijt9CmlmKCFzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZSYmdmFsdWU9PT0iIiYmbmFtZS5pbmRleE9mKCJiYWNrZ3JvdW5kIik9PT0wKXtzdHlsZVtuYW1lXT0iaW5oZXJpdCI7fQppZighaG9va3N8fCEoInNldCJpbiBob29rcyl8fCh2YWx1ZT1ob29rcy5zZXQoZWxlbSx2YWx1ZSxleHRyYSkpIT09dW5kZWZpbmVkKXt0cnl7c3R5bGVbbmFtZV09IiI7c3R5bGVbbmFtZV09dmFsdWU7fWNhdGNoKGUpe319fWVsc2V7aWYoaG9va3MmJiJnZXQiaW4gaG9va3MmJihyZXQ9aG9va3MuZ2V0KGVsZW0sZmFsc2UsZXh0cmEpKSE9PXVuZGVmaW5lZCl7cmV0dXJuIHJldDt9CnJldHVybiBzdHlsZVtuYW1lXTt9fSxjc3M6ZnVuY3Rpb24oZWxlbSxuYW1lLGV4dHJhLHN0eWxlcyl7dmFyIG51bSx2YWwsaG9va3Msb3JpZ05hbWU9alF1ZXJ5LmNhbWVsQ2FzZShuYW1lKTtuYW1lPWpRdWVyeS5jc3NQcm9wc1tvcmlnTmFtZV18fChqUXVlcnkuY3NzUHJvcHNbb3JpZ05hbWVdPXZlbmRvclByb3BOYW1lKGVsZW0uc3R5bGUsb3JpZ05hbWUpKTtob29rcz1qUXVlcnkuY3NzSG9va3NbbmFtZV18fGpRdWVyeS5jc3NIb29rc1tvcmlnTmFtZV07aWYoaG9va3MmJiJnZXQiaW4gaG9va3Mpe3ZhbD1ob29rcy5nZXQoZWxlbSx0cnVlLGV4dHJhKTt9CmlmKHZhbD09PXVuZGVmaW5lZCl7dmFsPWN1ckNTUyhlbGVtLG5hbWUsc3R5bGVzKTt9CmlmKHZhbD09PSJub3JtYWwiJiZuYW1lIGluIGNzc05vcm1hbFRyYW5zZm9ybSl7dmFsPWNzc05vcm1hbFRyYW5zZm9ybVtuYW1lXTt9CmlmKGV4dHJhPT09IiJ8fGV4dHJhKXtudW09cGFyc2VGbG9hdCh2YWwpO3JldHVybiBleHRyYT09PXRydWV8fGpRdWVyeS5pc051bWVyaWMobnVtKT9udW18fDA6dmFsO30KcmV0dXJuIHZhbDt9fSk7alF1ZXJ5LmVhY2goWyJoZWlnaHQiLCJ3aWR0aCJdLGZ1bmN0aW9uKGksbmFtZSl7alF1ZXJ5LmNzc0hvb2tzW25hbWVdPXtnZXQ6ZnVuY3Rpb24oZWxlbSxjb21wdXRlZCxleHRyYSl7aWYoY29tcHV0ZWQpe3JldHVybiBlbGVtLm9mZnNldFdpZHRoPT09MCYmcmRpc3BsYXlzd2FwLnRlc3QoalF1ZXJ5LmNzcyhlbGVtLCJkaXNwbGF5IikpP2pRdWVyeS5zd2FwKGVsZW0sY3NzU2hvdyxmdW5jdGlvbigpe3JldHVybiBnZXRXaWR0aE9ySGVpZ2h0KGVsZW0sbmFtZSxleHRyYSk7fSk6Z2V0V2lkdGhPckhlaWdodChlbGVtLG5hbWUsZXh0cmEpO319LHNldDpmdW5jdGlvbihlbGVtLHZhbHVlLGV4dHJhKXt2YXIgc3R5bGVzPWV4dHJhJiZnZXRTdHlsZXMoZWxlbSk7cmV0dXJuIHNldFBvc2l0aXZlTnVtYmVyKGVsZW0sdmFsdWUsZXh0cmE/YXVnbWVudFdpZHRoT3JIZWlnaHQoZWxlbSxuYW1lLGV4dHJhLHN1cHBvcnQuYm94U2l6aW5nKCkmJmpRdWVyeS5jc3MoZWxlbSwiYm94U2l6aW5nIixmYWxzZSxzdHlsZXMpPT09ImJvcmRlci1ib3giLHN0eWxlcyk6MCk7fX07fSk7aWYoIXN1cHBvcnQub3BhY2l0eSl7alF1ZXJ5LmNzc0hvb2tzLm9wYWNpdHk9e2dldDpmdW5jdGlvbihlbGVtLGNvbXB1dGVkKXtyZXR1cm4gcm9wYWNpdHkudGVzdCgoY29tcHV0ZWQmJmVsZW0uY3VycmVudFN0eWxlP2VsZW0uY3VycmVudFN0eWxlLmZpbHRlcjplbGVtLnN0eWxlLmZpbHRlcil8fCIiKT8oMC4wMSpwYXJzZUZsb2F0KFJlZ0V4cC4kMSkpKyIiOmNvbXB1dGVkPyIxIjoiIjt9LHNldDpmdW5jdGlvbihlbGVtLHZhbHVlKXt2YXIgc3R5bGU9ZWxlbS5zdHlsZSxjdXJyZW50U3R5bGU9ZWxlbS5jdXJyZW50U3R5bGUsb3BhY2l0eT1qUXVlcnkuaXNOdW1lcmljKHZhbHVlKT8iYWxwaGEob3BhY2l0eT0iK3ZhbHVlKjEwMCsiKSI6IiIsZmlsdGVyPWN1cnJlbnRTdHlsZSYmY3VycmVudFN0eWxlLmZpbHRlcnx8c3R5bGUuZmlsdGVyfHwiIjtzdHlsZS56b29tPTE7aWYoKHZhbHVlPj0xfHx2YWx1ZT09PSIiKSYmalF1ZXJ5LnRyaW0oZmlsdGVyLnJlcGxhY2UocmFscGhhLCIiKSk9PT0iIiYmc3R5bGUucmVtb3ZlQXR0cmlidXRlKXtzdHlsZS5yZW1vdmVBdHRyaWJ1dGUoImZpbHRlciIpO2lmKHZhbHVlPT09IiJ8fGN1cnJlbnRTdHlsZSYmIWN1cnJlbnRTdHlsZS5maWx0ZXIpe3JldHVybjt9fQpzdHlsZS5maWx0ZXI9cmFscGhhLnRlc3QoZmlsdGVyKT9maWx0ZXIucmVwbGFjZShyYWxwaGEsb3BhY2l0eSk6ZmlsdGVyKyIgIitvcGFjaXR5O319O30KalF1ZXJ5LmNzc0hvb2tzLm1hcmdpblJpZ2h0PWFkZEdldEhvb2tJZihzdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmlnaHQsZnVuY3Rpb24oZWxlbSxjb21wdXRlZCl7aWYoY29tcHV0ZWQpe3JldHVybiBqUXVlcnkuc3dhcChlbGVtLHsiZGlzcGxheSI6ImlubGluZS1ibG9jayJ9LGN1ckNTUyxbZWxlbSwibWFyZ2luUmlnaHQiXSk7fX0pO2pRdWVyeS5lYWNoKHttYXJnaW46IiIscGFkZGluZzoiIixib3JkZXI6IldpZHRoIn0sZnVuY3Rpb24ocHJlZml4LHN1ZmZpeCl7alF1ZXJ5LmNzc0hvb2tzW3ByZWZpeCtzdWZmaXhdPXtleHBhbmQ6ZnVuY3Rpb24odmFsdWUpe3ZhciBpPTAsZXhwYW5kZWQ9e30scGFydHM9dHlwZW9mIHZhbHVlPT09InN0cmluZyI/dmFsdWUuc3BsaXQoIiAiKTpbdmFsdWVdO2Zvcig7aTw0O2krKyl7ZXhwYW5kZWRbcHJlZml4K2Nzc0V4cGFuZFtpXStzdWZmaXhdPXBhcnRzW2ldfHxwYXJ0c1tpLTJdfHxwYXJ0c1swXTt9CnJldHVybiBleHBhbmRlZDt9fTtpZighcm1hcmdpbi50ZXN0KHByZWZpeCkpe2pRdWVyeS5jc3NIb29rc1twcmVmaXgrc3VmZml4XS5zZXQ9c2V0UG9zaXRpdmVOdW1iZXI7fX0pO2pRdWVyeS5mbi5leHRlbmQoe2NzczpmdW5jdGlvbihuYW1lLHZhbHVlKXtyZXR1cm4gYWNjZXNzKHRoaXMsZnVuY3Rpb24oZWxlbSxuYW1lLHZhbHVlKXt2YXIgc3R5bGVzLGxlbixtYXA9e30saT0wO2lmKGpRdWVyeS5pc0FycmF5KG5hbWUpKXtzdHlsZXM9Z2V0U3R5bGVzKGVsZW0pO2xlbj1uYW1lLmxlbmd0aDtmb3IoO2k8bGVuO2krKyl7bWFwW25hbWVbaV1dPWpRdWVyeS5jc3MoZWxlbSxuYW1lW2ldLGZhbHNlLHN0eWxlcyk7fQpyZXR1cm4gbWFwO30KcmV0dXJuIHZhbHVlIT09dW5kZWZpbmVkP2pRdWVyeS5zdHlsZShlbGVtLG5hbWUsdmFsdWUpOmpRdWVyeS5jc3MoZWxlbSxuYW1lKTt9LG5hbWUsdmFsdWUsYXJndW1lbnRzLmxlbmd0aD4xKTt9LHNob3c6ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd0hpZGUodGhpcyx0cnVlKTt9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd0hpZGUodGhpcyk7fSx0b2dnbGU6ZnVuY3Rpb24oc3RhdGUpe2lmKHR5cGVvZiBzdGF0ZT09PSJib29sZWFuIil7cmV0dXJuIHN0YXRlP3RoaXMuc2hvdygpOnRoaXMuaGlkZSgpO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKGlzSGlkZGVuKHRoaXMpKXtqUXVlcnkodGhpcykuc2hvdygpO31lbHNle2pRdWVyeSh0aGlzKS5oaWRlKCk7fX0pO319KTtmdW5jdGlvbiBUd2VlbihlbGVtLG9wdGlvbnMscHJvcCxlbmQsZWFzaW5nKXtyZXR1cm4gbmV3IFR3ZWVuLnByb3RvdHlwZS5pbml0KGVsZW0sb3B0aW9ucyxwcm9wLGVuZCxlYXNpbmcpO30KalF1ZXJ5LlR3ZWVuPVR3ZWVuO1R3ZWVuLnByb3RvdHlwZT17Y29uc3RydWN0b3I6VHdlZW4saW5pdDpmdW5jdGlvbihlbGVtLG9wdGlvbnMscHJvcCxlbmQsZWFzaW5nLHVuaXQpe3RoaXMuZWxlbT1lbGVtO3RoaXMucHJvcD1wcm9wO3RoaXMuZWFzaW5nPWVhc2luZ3x8InN3aW5nIjt0aGlzLm9wdGlvbnM9b3B0aW9uczt0aGlzLnN0YXJ0PXRoaXMubm93PXRoaXMuY3VyKCk7dGhpcy5lbmQ9ZW5kO3RoaXMudW5pdD11bml0fHwoalF1ZXJ5LmNzc051bWJlcltwcm9wXT8iIjoicHgiKTt9LGN1cjpmdW5jdGlvbigpe3ZhciBob29rcz1Ud2Vlbi5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gaG9va3MmJmhvb2tzLmdldD9ob29rcy5nZXQodGhpcyk6VHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKTt9LHJ1bjpmdW5jdGlvbihwZXJjZW50KXt2YXIgZWFzZWQsaG9va3M9VHdlZW4ucHJvcEhvb2tzW3RoaXMucHJvcF07aWYodGhpcy5vcHRpb25zLmR1cmF0aW9uKXt0aGlzLnBvcz1lYXNlZD1qUXVlcnkuZWFzaW5nW3RoaXMuZWFzaW5nXShwZXJjZW50LHRoaXMub3B0aW9ucy5kdXJhdGlvbipwZXJjZW50LDAsMSx0aGlzLm9wdGlvbnMuZHVyYXRpb24pO31lbHNle3RoaXMucG9zPWVhc2VkPXBlcmNlbnQ7fQp0aGlzLm5vdz0odGhpcy5lbmQtdGhpcy5zdGFydCkqZWFzZWQrdGhpcy5zdGFydDtpZih0aGlzLm9wdGlvbnMuc3RlcCl7dGhpcy5vcHRpb25zLnN0ZXAuY2FsbCh0aGlzLmVsZW0sdGhpcy5ub3csdGhpcyk7fQppZihob29rcyYmaG9va3Muc2V0KXtob29rcy5zZXQodGhpcyk7fWVsc2V7VHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKTt9CnJldHVybiB0aGlzO319O1R3ZWVuLnByb3RvdHlwZS5pbml0LnByb3RvdHlwZT1Ud2Vlbi5wcm90b3R5cGU7VHdlZW4ucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKHR3ZWVuKXt2YXIgcmVzdWx0O2lmKHR3ZWVuLmVsZW1bdHdlZW4ucHJvcF0hPW51bGwmJighdHdlZW4uZWxlbS5zdHlsZXx8dHdlZW4uZWxlbS5zdHlsZVt0d2Vlbi5wcm9wXT09bnVsbCkpe3JldHVybiB0d2Vlbi5lbGVtW3R3ZWVuLnByb3BdO30KcmVzdWx0PWpRdWVyeS5jc3ModHdlZW4uZWxlbSx0d2Vlbi5wcm9wLCIiKTtyZXR1cm4hcmVzdWx0fHxyZXN1bHQ9PT0iYXV0byI/MDpyZXN1bHQ7fSxzZXQ6ZnVuY3Rpb24odHdlZW4pe2lmKGpRdWVyeS5meC5zdGVwW3R3ZWVuLnByb3BdKXtqUXVlcnkuZnguc3RlcFt0d2Vlbi5wcm9wXSh0d2Vlbik7fWVsc2UgaWYodHdlZW4uZWxlbS5zdHlsZSYmKHR3ZWVuLmVsZW0uc3R5bGVbalF1ZXJ5LmNzc1Byb3BzW3R3ZWVuLnByb3BdXSE9bnVsbHx8alF1ZXJ5LmNzc0hvb2tzW3R3ZWVuLnByb3BdKSl7alF1ZXJ5LnN0eWxlKHR3ZWVuLmVsZW0sdHdlZW4ucHJvcCx0d2Vlbi5ub3crdHdlZW4udW5pdCk7fWVsc2V7dHdlZW4uZWxlbVt0d2Vlbi5wcm9wXT10d2Vlbi5ub3c7fX19fTtUd2Vlbi5wcm9wSG9va3Muc2Nyb2xsVG9wPVR3ZWVuLnByb3BIb29rcy5zY3JvbGxMZWZ0PXtzZXQ6ZnVuY3Rpb24odHdlZW4pe2lmKHR3ZWVuLmVsZW0ubm9kZVR5cGUmJnR3ZWVuLmVsZW0ucGFyZW50Tm9kZSl7dHdlZW4uZWxlbVt0d2Vlbi5wcm9wXT10d2Vlbi5ub3c7fX19O2pRdWVyeS5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihwKXtyZXR1cm4gcDt9LHN3aW5nOmZ1bmN0aW9uKHApe3JldHVybiAwLjUtTWF0aC5jb3MocCpNYXRoLlBJKS8yO319O2pRdWVyeS5meD1Ud2Vlbi5wcm90b3R5cGUuaW5pdDtqUXVlcnkuZnguc3RlcD17fTt2YXIKZnhOb3csdGltZXJJZCxyZnh0eXBlcz0vXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8scmZ4bnVtPW5ldyBSZWdFeHAoIl4oPzooWystXSk9fCkoIitwbnVtKyIpKFthLXolXSopJCIsImkiKSxycnVuPS9xdWV1ZUhvb2tzJC8sYW5pbWF0aW9uUHJlZmlsdGVycz1bZGVmYXVsdFByZWZpbHRlcl0sdHdlZW5lcnM9eyIqIjpbZnVuY3Rpb24ocHJvcCx2YWx1ZSl7dmFyIHR3ZWVuPXRoaXMuY3JlYXRlVHdlZW4ocHJvcCx2YWx1ZSksdGFyZ2V0PXR3ZWVuLmN1cigpLHBhcnRzPXJmeG51bS5leGVjKHZhbHVlKSx1bml0PXBhcnRzJiZwYXJ0c1szXXx8KGpRdWVyeS5jc3NOdW1iZXJbcHJvcF0/IiI6InB4Iiksc3RhcnQ9KGpRdWVyeS5jc3NOdW1iZXJbcHJvcF18fHVuaXQhPT0icHgiJiYrdGFyZ2V0KSYmcmZ4bnVtLmV4ZWMoalF1ZXJ5LmNzcyh0d2Vlbi5lbGVtLHByb3ApKSxzY2FsZT0xLG1heEl0ZXJhdGlvbnM9MjA7aWYoc3RhcnQmJnN0YXJ0WzNdIT09dW5pdCl7dW5pdD11bml0fHxzdGFydFszXTtwYXJ0cz1wYXJ0c3x8W107c3RhcnQ9K3RhcmdldHx8MTtkb3tzY2FsZT1zY2FsZXx8Ii41IjtzdGFydD1zdGFydC9zY2FsZTtqUXVlcnkuc3R5bGUodHdlZW4uZWxlbSxwcm9wLHN0YXJ0K3VuaXQpO313aGlsZShzY2FsZSE9PShzY2FsZT10d2Vlbi5jdXIoKS90YXJnZXQpJiZzY2FsZSE9PTEmJi0tbWF4SXRlcmF0aW9ucyk7fQppZihwYXJ0cyl7c3RhcnQ9dHdlZW4uc3RhcnQ9K3N0YXJ0fHwrdGFyZ2V0fHwwO3R3ZWVuLnVuaXQ9dW5pdDt0d2Vlbi5lbmQ9cGFydHNbMV0/c3RhcnQrKHBhcnRzWzFdKzEpKnBhcnRzWzJdOitwYXJ0c1syXTt9CnJldHVybiB0d2Vlbjt9XX07ZnVuY3Rpb24gY3JlYXRlRnhOb3coKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZnhOb3c9dW5kZWZpbmVkO30pO3JldHVybihmeE5vdz1qUXVlcnkubm93KCkpO30KZnVuY3Rpb24gZ2VuRngodHlwZSxpbmNsdWRlV2lkdGgpe3ZhciB3aGljaCxhdHRycz17aGVpZ2h0OnR5cGV9LGk9MDtpbmNsdWRlV2lkdGg9aW5jbHVkZVdpZHRoPzE6MDtmb3IoO2k8NDtpKz0yLWluY2x1ZGVXaWR0aCl7d2hpY2g9Y3NzRXhwYW5kW2ldO2F0dHJzWyJtYXJnaW4iK3doaWNoXT1hdHRyc1sicGFkZGluZyIrd2hpY2hdPXR5cGU7fQppZihpbmNsdWRlV2lkdGgpe2F0dHJzLm9wYWNpdHk9YXR0cnMud2lkdGg9dHlwZTt9CnJldHVybiBhdHRyczt9CmZ1bmN0aW9uIGNyZWF0ZVR3ZWVuKHZhbHVlLHByb3AsYW5pbWF0aW9uKXt2YXIgdHdlZW4sY29sbGVjdGlvbj0odHdlZW5lcnNbcHJvcF18fFtdKS5jb25jYXQodHdlZW5lcnNbIioiXSksaW5kZXg9MCxsZW5ndGg9Y29sbGVjdGlvbi5sZW5ndGg7Zm9yKDtpbmRleDxsZW5ndGg7aW5kZXgrKyl7aWYoKHR3ZWVuPWNvbGxlY3Rpb25baW5kZXhdLmNhbGwoYW5pbWF0aW9uLHByb3AsdmFsdWUpKSl7cmV0dXJuIHR3ZWVuO319fQpmdW5jdGlvbiBkZWZhdWx0UHJlZmlsdGVyKGVsZW0scHJvcHMsb3B0cyl7dmFyIHByb3AsdmFsdWUsdG9nZ2xlLHR3ZWVuLGhvb2tzLG9sZGZpcmUsZGlzcGxheSxkRGlzcGxheSxhbmltPXRoaXMsb3JpZz17fSxzdHlsZT1lbGVtLnN0eWxlLGhpZGRlbj1lbGVtLm5vZGVUeXBlJiZpc0hpZGRlbihlbGVtKSxkYXRhU2hvdz1qUXVlcnkuX2RhdGEoZWxlbSwiZnhzaG93Iik7aWYoIW9wdHMucXVldWUpe2hvb2tzPWpRdWVyeS5fcXVldWVIb29rcyhlbGVtLCJmeCIpO2lmKGhvb2tzLnVucXVldWVkPT1udWxsKXtob29rcy51bnF1ZXVlZD0wO29sZGZpcmU9aG9va3MuZW1wdHkuZmlyZTtob29rcy5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7aWYoIWhvb2tzLnVucXVldWVkKXtvbGRmaXJlKCk7fX07fQpob29rcy51bnF1ZXVlZCsrO2FuaW0uYWx3YXlzKGZ1bmN0aW9uKCl7YW5pbS5hbHdheXMoZnVuY3Rpb24oKXtob29rcy51bnF1ZXVlZC0tO2lmKCFqUXVlcnkucXVldWUoZWxlbSwiZngiKS5sZW5ndGgpe2hvb2tzLmVtcHR5LmZpcmUoKTt9fSk7fSk7fQppZihlbGVtLm5vZGVUeXBlPT09MSYmKCJoZWlnaHQiaW4gcHJvcHN8fCJ3aWR0aCJpbiBwcm9wcykpe29wdHMub3ZlcmZsb3c9W3N0eWxlLm92ZXJmbG93LHN0eWxlLm92ZXJmbG93WCxzdHlsZS5vdmVyZmxvd1ldO2Rpc3BsYXk9alF1ZXJ5LmNzcyhlbGVtLCJkaXNwbGF5Iik7ZERpc3BsYXk9ZGVmYXVsdERpc3BsYXkoZWxlbS5ub2RlTmFtZSk7aWYoZGlzcGxheT09PSJub25lIil7ZGlzcGxheT1kRGlzcGxheTt9CmlmKGRpc3BsYXk9PT0iaW5saW5lIiYmalF1ZXJ5LmNzcyhlbGVtLCJmbG9hdCIpPT09Im5vbmUiKXtpZighc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0fHxkRGlzcGxheT09PSJpbmxpbmUiKXtzdHlsZS5kaXNwbGF5PSJpbmxpbmUtYmxvY2siO31lbHNle3N0eWxlLnpvb209MTt9fX0KaWYob3B0cy5vdmVyZmxvdyl7c3R5bGUub3ZlcmZsb3c9ImhpZGRlbiI7aWYoIXN1cHBvcnQuc2hyaW5rV3JhcEJsb2NrcygpKXthbmltLmFsd2F5cyhmdW5jdGlvbigpe3N0eWxlLm92ZXJmbG93PW9wdHMub3ZlcmZsb3dbMF07c3R5bGUub3ZlcmZsb3dYPW9wdHMub3ZlcmZsb3dbMV07c3R5bGUub3ZlcmZsb3dZPW9wdHMub3ZlcmZsb3dbMl07fSk7fX0KZm9yKHByb3AgaW4gcHJvcHMpe3ZhbHVlPXByb3BzW3Byb3BdO2lmKHJmeHR5cGVzLmV4ZWModmFsdWUpKXtkZWxldGUgcHJvcHNbcHJvcF07dG9nZ2xlPXRvZ2dsZXx8dmFsdWU9PT0idG9nZ2xlIjtpZih2YWx1ZT09PShoaWRkZW4/ImhpZGUiOiJzaG93Iikpe2lmKHZhbHVlPT09InNob3ciJiZkYXRhU2hvdyYmZGF0YVNob3dbcHJvcF0hPT11bmRlZmluZWQpe2hpZGRlbj10cnVlO31lbHNle2NvbnRpbnVlO319Cm9yaWdbcHJvcF09ZGF0YVNob3cmJmRhdGFTaG93W3Byb3BdfHxqUXVlcnkuc3R5bGUoZWxlbSxwcm9wKTt9fQppZighalF1ZXJ5LmlzRW1wdHlPYmplY3Qob3JpZykpe2lmKGRhdGFTaG93KXtpZigiaGlkZGVuImluIGRhdGFTaG93KXtoaWRkZW49ZGF0YVNob3cuaGlkZGVuO319ZWxzZXtkYXRhU2hvdz1qUXVlcnkuX2RhdGEoZWxlbSwiZnhzaG93Iix7fSk7fQppZih0b2dnbGUpe2RhdGFTaG93LmhpZGRlbj0haGlkZGVuO30KaWYoaGlkZGVuKXtqUXVlcnkoZWxlbSkuc2hvdygpO31lbHNle2FuaW0uZG9uZShmdW5jdGlvbigpe2pRdWVyeShlbGVtKS5oaWRlKCk7fSk7fQphbmltLmRvbmUoZnVuY3Rpb24oKXt2YXIgcHJvcDtqUXVlcnkuX3JlbW92ZURhdGEoZWxlbSwiZnhzaG93Iik7Zm9yKHByb3AgaW4gb3JpZyl7alF1ZXJ5LnN0eWxlKGVsZW0scHJvcCxvcmlnW3Byb3BdKTt9fSk7Zm9yKHByb3AgaW4gb3JpZyl7dHdlZW49Y3JlYXRlVHdlZW4oaGlkZGVuP2RhdGFTaG93W3Byb3BdOjAscHJvcCxhbmltKTtpZighKHByb3AgaW4gZGF0YVNob3cpKXtkYXRhU2hvd1twcm9wXT10d2Vlbi5zdGFydDtpZihoaWRkZW4pe3R3ZWVuLmVuZD10d2Vlbi5zdGFydDt0d2Vlbi5zdGFydD1wcm9wPT09IndpZHRoInx8cHJvcD09PSJoZWlnaHQiPzE6MDt9fX19fQpmdW5jdGlvbiBwcm9wRmlsdGVyKHByb3BzLHNwZWNpYWxFYXNpbmcpe3ZhciBpbmRleCxuYW1lLGVhc2luZyx2YWx1ZSxob29rcztmb3IoaW5kZXggaW4gcHJvcHMpe25hbWU9alF1ZXJ5LmNhbWVsQ2FzZShpbmRleCk7ZWFzaW5nPXNwZWNpYWxFYXNpbmdbbmFtZV07dmFsdWU9cHJvcHNbaW5kZXhdO2lmKGpRdWVyeS5pc0FycmF5KHZhbHVlKSl7ZWFzaW5nPXZhbHVlWzFdO3ZhbHVlPXByb3BzW2luZGV4XT12YWx1ZVswXTt9CmlmKGluZGV4IT09bmFtZSl7cHJvcHNbbmFtZV09dmFsdWU7ZGVsZXRlIHByb3BzW2luZGV4XTt9Cmhvb2tzPWpRdWVyeS5jc3NIb29rc1tuYW1lXTtpZihob29rcyYmImV4cGFuZCJpbiBob29rcyl7dmFsdWU9aG9va3MuZXhwYW5kKHZhbHVlKTtkZWxldGUgcHJvcHNbbmFtZV07Zm9yKGluZGV4IGluIHZhbHVlKXtpZighKGluZGV4IGluIHByb3BzKSl7cHJvcHNbaW5kZXhdPXZhbHVlW2luZGV4XTtzcGVjaWFsRWFzaW5nW2luZGV4XT1lYXNpbmc7fX19ZWxzZXtzcGVjaWFsRWFzaW5nW25hbWVdPWVhc2luZzt9fX0KZnVuY3Rpb24gQW5pbWF0aW9uKGVsZW0scHJvcGVydGllcyxvcHRpb25zKXt2YXIgcmVzdWx0LHN0b3BwZWQsaW5kZXg9MCxsZW5ndGg9YW5pbWF0aW9uUHJlZmlsdGVycy5sZW5ndGgsZGVmZXJyZWQ9alF1ZXJ5LkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIHRpY2suZWxlbTt9KSx0aWNrPWZ1bmN0aW9uKCl7aWYoc3RvcHBlZCl7cmV0dXJuIGZhbHNlO30KdmFyIGN1cnJlbnRUaW1lPWZ4Tm93fHxjcmVhdGVGeE5vdygpLHJlbWFpbmluZz1NYXRoLm1heCgwLGFuaW1hdGlvbi5zdGFydFRpbWUrYW5pbWF0aW9uLmR1cmF0aW9uLWN1cnJlbnRUaW1lKSx0ZW1wPXJlbWFpbmluZy9hbmltYXRpb24uZHVyYXRpb258fDAscGVyY2VudD0xLXRlbXAsaW5kZXg9MCxsZW5ndGg9YW5pbWF0aW9uLnR3ZWVucy5sZW5ndGg7Zm9yKDtpbmRleDxsZW5ndGg7aW5kZXgrKyl7YW5pbWF0aW9uLnR3ZWVuc1tpbmRleF0ucnVuKHBlcmNlbnQpO30KZGVmZXJyZWQubm90aWZ5V2l0aChlbGVtLFthbmltYXRpb24scGVyY2VudCxyZW1haW5pbmddKTtpZihwZXJjZW50PDEmJmxlbmd0aCl7cmV0dXJuIHJlbWFpbmluZzt9ZWxzZXtkZWZlcnJlZC5yZXNvbHZlV2l0aChlbGVtLFthbmltYXRpb25dKTtyZXR1cm4gZmFsc2U7fX0sYW5pbWF0aW9uPWRlZmVycmVkLnByb21pc2Uoe2VsZW06ZWxlbSxwcm9wczpqUXVlcnkuZXh0ZW5kKHt9LHByb3BlcnRpZXMpLG9wdHM6alF1ZXJ5LmV4dGVuZCh0cnVlLHtzcGVjaWFsRWFzaW5nOnt9fSxvcHRpb25zKSxvcmlnaW5hbFByb3BlcnRpZXM6cHJvcGVydGllcyxvcmlnaW5hbE9wdGlvbnM6b3B0aW9ucyxzdGFydFRpbWU6ZnhOb3d8fGNyZWF0ZUZ4Tm93KCksZHVyYXRpb246b3B0aW9ucy5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24ocHJvcCxlbmQpe3ZhciB0d2Vlbj1qUXVlcnkuVHdlZW4oZWxlbSxhbmltYXRpb24ub3B0cyxwcm9wLGVuZCxhbmltYXRpb24ub3B0cy5zcGVjaWFsRWFzaW5nW3Byb3BdfHxhbmltYXRpb24ub3B0cy5lYXNpbmcpO2FuaW1hdGlvbi50d2VlbnMucHVzaCh0d2Vlbik7cmV0dXJuIHR3ZWVuO30sc3RvcDpmdW5jdGlvbihnb3RvRW5kKXt2YXIgaW5kZXg9MCxsZW5ndGg9Z290b0VuZD9hbmltYXRpb24udHdlZW5zLmxlbmd0aDowO2lmKHN0b3BwZWQpe3JldHVybiB0aGlzO30Kc3RvcHBlZD10cnVlO2Zvcig7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe2FuaW1hdGlvbi50d2VlbnNbaW5kZXhdLnJ1bigxKTt9CmlmKGdvdG9FbmQpe2RlZmVycmVkLnJlc29sdmVXaXRoKGVsZW0sW2FuaW1hdGlvbixnb3RvRW5kXSk7fWVsc2V7ZGVmZXJyZWQucmVqZWN0V2l0aChlbGVtLFthbmltYXRpb24sZ290b0VuZF0pO30KcmV0dXJuIHRoaXM7fX0pLHByb3BzPWFuaW1hdGlvbi5wcm9wcztwcm9wRmlsdGVyKHByb3BzLGFuaW1hdGlvbi5vcHRzLnNwZWNpYWxFYXNpbmcpO2Zvcig7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe3Jlc3VsdD1hbmltYXRpb25QcmVmaWx0ZXJzW2luZGV4XS5jYWxsKGFuaW1hdGlvbixlbGVtLHByb3BzLGFuaW1hdGlvbi5vcHRzKTtpZihyZXN1bHQpe3JldHVybiByZXN1bHQ7fX0KalF1ZXJ5Lm1hcChwcm9wcyxjcmVhdGVUd2VlbixhbmltYXRpb24pO2lmKGpRdWVyeS5pc0Z1bmN0aW9uKGFuaW1hdGlvbi5vcHRzLnN0YXJ0KSl7YW5pbWF0aW9uLm9wdHMuc3RhcnQuY2FsbChlbGVtLGFuaW1hdGlvbik7fQpqUXVlcnkuZngudGltZXIoalF1ZXJ5LmV4dGVuZCh0aWNrLHtlbGVtOmVsZW0sYW5pbTphbmltYXRpb24scXVldWU6YW5pbWF0aW9uLm9wdHMucXVldWV9KSk7cmV0dXJuIGFuaW1hdGlvbi5wcm9ncmVzcyhhbmltYXRpb24ub3B0cy5wcm9ncmVzcykuZG9uZShhbmltYXRpb24ub3B0cy5kb25lLGFuaW1hdGlvbi5vcHRzLmNvbXBsZXRlKS5mYWlsKGFuaW1hdGlvbi5vcHRzLmZhaWwpLmFsd2F5cyhhbmltYXRpb24ub3B0cy5hbHdheXMpO30KalF1ZXJ5LkFuaW1hdGlvbj1qUXVlcnkuZXh0ZW5kKEFuaW1hdGlvbix7dHdlZW5lcjpmdW5jdGlvbihwcm9wcyxjYWxsYmFjayl7aWYoalF1ZXJ5LmlzRnVuY3Rpb24ocHJvcHMpKXtjYWxsYmFjaz1wcm9wcztwcm9wcz1bIioiXTt9ZWxzZXtwcm9wcz1wcm9wcy5zcGxpdCgiICIpO30KdmFyIHByb3AsaW5kZXg9MCxsZW5ndGg9cHJvcHMubGVuZ3RoO2Zvcig7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe3Byb3A9cHJvcHNbaW5kZXhdO3R3ZWVuZXJzW3Byb3BdPXR3ZWVuZXJzW3Byb3BdfHxbXTt0d2VlbmVyc1twcm9wXS51bnNoaWZ0KGNhbGxiYWNrKTt9fSxwcmVmaWx0ZXI6ZnVuY3Rpb24oY2FsbGJhY2sscHJlcGVuZCl7aWYocHJlcGVuZCl7YW5pbWF0aW9uUHJlZmlsdGVycy51bnNoaWZ0KGNhbGxiYWNrKTt9ZWxzZXthbmltYXRpb25QcmVmaWx0ZXJzLnB1c2goY2FsbGJhY2spO319fSk7alF1ZXJ5LnNwZWVkPWZ1bmN0aW9uKHNwZWVkLGVhc2luZyxmbil7dmFyIG9wdD1zcGVlZCYmdHlwZW9mIHNwZWVkPT09Im9iamVjdCI/alF1ZXJ5LmV4dGVuZCh7fSxzcGVlZCk6e2NvbXBsZXRlOmZufHwhZm4mJmVhc2luZ3x8alF1ZXJ5LmlzRnVuY3Rpb24oc3BlZWQpJiZzcGVlZCxkdXJhdGlvbjpzcGVlZCxlYXNpbmc6Zm4mJmVhc2luZ3x8ZWFzaW5nJiYhalF1ZXJ5LmlzRnVuY3Rpb24oZWFzaW5nKSYmZWFzaW5nfTtvcHQuZHVyYXRpb249alF1ZXJ5LmZ4Lm9mZj8wOnR5cGVvZiBvcHQuZHVyYXRpb249PT0ibnVtYmVyIj9vcHQuZHVyYXRpb246b3B0LmR1cmF0aW9uIGluIGpRdWVyeS5meC5zcGVlZHM/alF1ZXJ5LmZ4LnNwZWVkc1tvcHQuZHVyYXRpb25dOmpRdWVyeS5meC5zcGVlZHMuX2RlZmF1bHQ7aWYob3B0LnF1ZXVlPT1udWxsfHxvcHQucXVldWU9PT10cnVlKXtvcHQucXVldWU9ImZ4Ijt9Cm9wdC5vbGQ9b3B0LmNvbXBsZXRlO29wdC5jb21wbGV0ZT1mdW5jdGlvbigpe2lmKGpRdWVyeS5pc0Z1bmN0aW9uKG9wdC5vbGQpKXtvcHQub2xkLmNhbGwodGhpcyk7fQppZihvcHQucXVldWUpe2pRdWVyeS5kZXF1ZXVlKHRoaXMsb3B0LnF1ZXVlKTt9fTtyZXR1cm4gb3B0O307alF1ZXJ5LmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKHNwZWVkLHRvLGVhc2luZyxjYWxsYmFjayl7cmV0dXJuIHRoaXMuZmlsdGVyKGlzSGlkZGVuKS5jc3MoIm9wYWNpdHkiLDApLnNob3coKS5lbmQoKS5hbmltYXRlKHtvcGFjaXR5OnRvfSxzcGVlZCxlYXNpbmcsY2FsbGJhY2spO30sYW5pbWF0ZTpmdW5jdGlvbihwcm9wLHNwZWVkLGVhc2luZyxjYWxsYmFjayl7dmFyIGVtcHR5PWpRdWVyeS5pc0VtcHR5T2JqZWN0KHByb3ApLG9wdGFsbD1qUXVlcnkuc3BlZWQoc3BlZWQsZWFzaW5nLGNhbGxiYWNrKSxkb0FuaW1hdGlvbj1mdW5jdGlvbigpe3ZhciBhbmltPUFuaW1hdGlvbih0aGlzLGpRdWVyeS5leHRlbmQoe30scHJvcCksb3B0YWxsKTtpZihlbXB0eXx8alF1ZXJ5Ll9kYXRhKHRoaXMsImZpbmlzaCIpKXthbmltLnN0b3AodHJ1ZSk7fX07ZG9BbmltYXRpb24uZmluaXNoPWRvQW5pbWF0aW9uO3JldHVybiBlbXB0eXx8b3B0YWxsLnF1ZXVlPT09ZmFsc2U/dGhpcy5lYWNoKGRvQW5pbWF0aW9uKTp0aGlzLnF1ZXVlKG9wdGFsbC5xdWV1ZSxkb0FuaW1hdGlvbik7fSxzdG9wOmZ1bmN0aW9uKHR5cGUsY2xlYXJRdWV1ZSxnb3RvRW5kKXt2YXIgc3RvcFF1ZXVlPWZ1bmN0aW9uKGhvb2tzKXt2YXIgc3RvcD1ob29rcy5zdG9wO2RlbGV0ZSBob29rcy5zdG9wO3N0b3AoZ290b0VuZCk7fTtpZih0eXBlb2YgdHlwZSE9PSJzdHJpbmciKXtnb3RvRW5kPWNsZWFyUXVldWU7Y2xlYXJRdWV1ZT10eXBlO3R5cGU9dW5kZWZpbmVkO30KaWYoY2xlYXJRdWV1ZSYmdHlwZSE9PWZhbHNlKXt0aGlzLnF1ZXVlKHR5cGV8fCJmeCIsW10pO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBkZXF1ZXVlPXRydWUsaW5kZXg9dHlwZSE9bnVsbCYmdHlwZSsicXVldWVIb29rcyIsdGltZXJzPWpRdWVyeS50aW1lcnMsZGF0YT1qUXVlcnkuX2RhdGEodGhpcyk7aWYoaW5kZXgpe2lmKGRhdGFbaW5kZXhdJiZkYXRhW2luZGV4XS5zdG9wKXtzdG9wUXVldWUoZGF0YVtpbmRleF0pO319ZWxzZXtmb3IoaW5kZXggaW4gZGF0YSl7aWYoZGF0YVtpbmRleF0mJmRhdGFbaW5kZXhdLnN0b3AmJnJydW4udGVzdChpbmRleCkpe3N0b3BRdWV1ZShkYXRhW2luZGV4XSk7fX19CmZvcihpbmRleD10aW1lcnMubGVuZ3RoO2luZGV4LS07KXtpZih0aW1lcnNbaW5kZXhdLmVsZW09PT10aGlzJiYodHlwZT09bnVsbHx8dGltZXJzW2luZGV4XS5xdWV1ZT09PXR5cGUpKXt0aW1lcnNbaW5kZXhdLmFuaW0uc3RvcChnb3RvRW5kKTtkZXF1ZXVlPWZhbHNlO3RpbWVycy5zcGxpY2UoaW5kZXgsMSk7fX0KaWYoZGVxdWV1ZXx8IWdvdG9FbmQpe2pRdWVyeS5kZXF1ZXVlKHRoaXMsdHlwZSk7fX0pO30sZmluaXNoOmZ1bmN0aW9uKHR5cGUpe2lmKHR5cGUhPT1mYWxzZSl7dHlwZT10eXBlfHwiZngiO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBpbmRleCxkYXRhPWpRdWVyeS5fZGF0YSh0aGlzKSxxdWV1ZT1kYXRhW3R5cGUrInF1ZXVlIl0saG9va3M9ZGF0YVt0eXBlKyJxdWV1ZUhvb2tzIl0sdGltZXJzPWpRdWVyeS50aW1lcnMsbGVuZ3RoPXF1ZXVlP3F1ZXVlLmxlbmd0aDowO2RhdGEuZmluaXNoPXRydWU7alF1ZXJ5LnF1ZXVlKHRoaXMsdHlwZSxbXSk7aWYoaG9va3MmJmhvb2tzLnN0b3Ape2hvb2tzLnN0b3AuY2FsbCh0aGlzLHRydWUpO30KZm9yKGluZGV4PXRpbWVycy5sZW5ndGg7aW5kZXgtLTspe2lmKHRpbWVyc1tpbmRleF0uZWxlbT09PXRoaXMmJnRpbWVyc1tpbmRleF0ucXVldWU9PT10eXBlKXt0aW1lcnNbaW5kZXhdLmFuaW0uc3RvcCh0cnVlKTt0aW1lcnMuc3BsaWNlKGluZGV4LDEpO319CmZvcihpbmRleD0wO2luZGV4PGxlbmd0aDtpbmRleCsrKXtpZihxdWV1ZVtpbmRleF0mJnF1ZXVlW2luZGV4XS5maW5pc2gpe3F1ZXVlW2luZGV4XS5maW5pc2guY2FsbCh0aGlzKTt9fQpkZWxldGUgZGF0YS5maW5pc2g7fSk7fX0pO2pRdWVyeS5lYWNoKFsidG9nZ2xlIiwic2hvdyIsImhpZGUiXSxmdW5jdGlvbihpLG5hbWUpe3ZhciBjc3NGbj1qUXVlcnkuZm5bbmFtZV07alF1ZXJ5LmZuW25hbWVdPWZ1bmN0aW9uKHNwZWVkLGVhc2luZyxjYWxsYmFjayl7cmV0dXJuIHNwZWVkPT1udWxsfHx0eXBlb2Ygc3BlZWQ9PT0iYm9vbGVhbiI/Y3NzRm4uYXBwbHkodGhpcyxhcmd1bWVudHMpOnRoaXMuYW5pbWF0ZShnZW5GeChuYW1lLHRydWUpLHNwZWVkLGVhc2luZyxjYWxsYmFjayk7fTt9KTtqUXVlcnkuZWFjaCh7c2xpZGVEb3duOmdlbkZ4KCJzaG93Iiksc2xpZGVVcDpnZW5GeCgiaGlkZSIpLHNsaWRlVG9nZ2xlOmdlbkZ4KCJ0b2dnbGUiKSxmYWRlSW46e29wYWNpdHk6InNob3cifSxmYWRlT3V0OntvcGFjaXR5OiJoaWRlIn0sZmFkZVRvZ2dsZTp7b3BhY2l0eToidG9nZ2xlIn19LGZ1bmN0aW9uKG5hbWUscHJvcHMpe2pRdWVyeS5mbltuYW1lXT1mdW5jdGlvbihzcGVlZCxlYXNpbmcsY2FsbGJhY2spe3JldHVybiB0aGlzLmFuaW1hdGUocHJvcHMsc3BlZWQsZWFzaW5nLGNhbGxiYWNrKTt9O30pO2pRdWVyeS50aW1lcnM9W107alF1ZXJ5LmZ4LnRpY2s9ZnVuY3Rpb24oKXt2YXIgdGltZXIsdGltZXJzPWpRdWVyeS50aW1lcnMsaT0wO2Z4Tm93PWpRdWVyeS5ub3coKTtmb3IoO2k8dGltZXJzLmxlbmd0aDtpKyspe3RpbWVyPXRpbWVyc1tpXTtpZighdGltZXIoKSYmdGltZXJzW2ldPT09dGltZXIpe3RpbWVycy5zcGxpY2UoaS0tLDEpO319CmlmKCF0aW1lcnMubGVuZ3RoKXtqUXVlcnkuZnguc3RvcCgpO30KZnhOb3c9dW5kZWZpbmVkO307alF1ZXJ5LmZ4LnRpbWVyPWZ1bmN0aW9uKHRpbWVyKXtqUXVlcnkudGltZXJzLnB1c2godGltZXIpO2lmKHRpbWVyKCkpe2pRdWVyeS5meC5zdGFydCgpO31lbHNle2pRdWVyeS50aW1lcnMucG9wKCk7fX07alF1ZXJ5LmZ4LmludGVydmFsPTEzO2pRdWVyeS5meC5zdGFydD1mdW5jdGlvbigpe2lmKCF0aW1lcklkKXt0aW1lcklkPXNldEludGVydmFsKGpRdWVyeS5meC50aWNrLGpRdWVyeS5meC5pbnRlcnZhbCk7fX07alF1ZXJ5LmZ4LnN0b3A9ZnVuY3Rpb24oKXtjbGVhckludGVydmFsKHRpbWVySWQpO3RpbWVySWQ9bnVsbDt9O2pRdWVyeS5meC5zcGVlZHM9e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH07alF1ZXJ5LmZuLmRlbGF5PWZ1bmN0aW9uKHRpbWUsdHlwZSl7dGltZT1qUXVlcnkuZng/alF1ZXJ5LmZ4LnNwZWVkc1t0aW1lXXx8dGltZTp0aW1lO3R5cGU9dHlwZXx8ImZ4IjtyZXR1cm4gdGhpcy5xdWV1ZSh0eXBlLGZ1bmN0aW9uKG5leHQsaG9va3Mpe3ZhciB0aW1lb3V0PXNldFRpbWVvdXQobmV4dCx0aW1lKTtob29rcy5zdG9wPWZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO307fSk7fTsoZnVuY3Rpb24oKXt2YXIgYSxpbnB1dCxzZWxlY3Qsb3B0LGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtkaXYuc2V0QXR0cmlidXRlKCJjbGFzc05hbWUiLCJ0Iik7ZGl2LmlubmVySFRNTD0iICA8bGluay8+PHRhYmxlPjwvdGFibGU+PGEgaHJlZj0nL2EnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+IjthPWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpWzBdO3NlbGVjdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKTtvcHQ9c2VsZWN0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpKTtpbnB1dD1kaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IilbMF07YS5zdHlsZS5jc3NUZXh0PSJ0b3A6MXB4IjtzdXBwb3J0LmdldFNldEF0dHJpYnV0ZT1kaXYuY2xhc3NOYW1lIT09InQiO3N1cHBvcnQuc3R5bGU9L3RvcC8udGVzdChhLmdldEF0dHJpYnV0ZSgic3R5bGUiKSk7c3VwcG9ydC5ocmVmTm9ybWFsaXplZD1hLmdldEF0dHJpYnV0ZSgiaHJlZiIpPT09Ii9hIjtzdXBwb3J0LmNoZWNrT249ISFpbnB1dC52YWx1ZTtzdXBwb3J0Lm9wdFNlbGVjdGVkPW9wdC5zZWxlY3RlZDtzdXBwb3J0LmVuY3R5cGU9ISFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJmb3JtIikuZW5jdHlwZTtzZWxlY3QuZGlzYWJsZWQ9dHJ1ZTtzdXBwb3J0Lm9wdERpc2FibGVkPSFvcHQuZGlzYWJsZWQ7aW5wdXQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTtpbnB1dC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwiIik7c3VwcG9ydC5pbnB1dD1pbnB1dC5nZXRBdHRyaWJ1dGUoInZhbHVlIik9PT0iIjtpbnB1dC52YWx1ZT0idCI7aW5wdXQuc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKTtzdXBwb3J0LnJhZGlvVmFsdWU9aW5wdXQudmFsdWU9PT0idCI7YT1pbnB1dD1zZWxlY3Q9b3B0PWRpdj1udWxsO30pKCk7dmFyIHJyZXR1cm49L1xyL2c7alF1ZXJ5LmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKHZhbHVlKXt2YXIgaG9va3MscmV0LGlzRnVuY3Rpb24sZWxlbT10aGlzWzBdO2lmKCFhcmd1bWVudHMubGVuZ3RoKXtpZihlbGVtKXtob29rcz1qUXVlcnkudmFsSG9va3NbZWxlbS50eXBlXXx8alF1ZXJ5LnZhbEhvb2tzW2VsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKV07aWYoaG9va3MmJiJnZXQiaW4gaG9va3MmJihyZXQ9aG9va3MuZ2V0KGVsZW0sInZhbHVlIikpIT09dW5kZWZpbmVkKXtyZXR1cm4gcmV0O30KcmV0PWVsZW0udmFsdWU7cmV0dXJuIHR5cGVvZiByZXQ9PT0ic3RyaW5nIj9yZXQucmVwbGFjZShycmV0dXJuLCIiKTpyZXQ9PW51bGw/IiI6cmV0O30KcmV0dXJuO30KaXNGdW5jdGlvbj1qUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKXt2YXIgdmFsO2lmKHRoaXMubm9kZVR5cGUhPT0xKXtyZXR1cm47fQppZihpc0Z1bmN0aW9uKXt2YWw9dmFsdWUuY2FsbCh0aGlzLGksalF1ZXJ5KHRoaXMpLnZhbCgpKTt9ZWxzZXt2YWw9dmFsdWU7fQppZih2YWw9PW51bGwpe3ZhbD0iIjt9ZWxzZSBpZih0eXBlb2YgdmFsPT09Im51bWJlciIpe3ZhbCs9IiI7fWVsc2UgaWYoalF1ZXJ5LmlzQXJyYXkodmFsKSl7dmFsPWpRdWVyeS5tYXAodmFsLGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdmFsdWU9PW51bGw/IiI6dmFsdWUrIiI7fSk7fQpob29rcz1qUXVlcnkudmFsSG9va3NbdGhpcy50eXBlXXx8alF1ZXJ5LnZhbEhvb2tzW3RoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKV07aWYoIWhvb2tzfHwhKCJzZXQiaW4gaG9va3MpfHxob29rcy5zZXQodGhpcyx2YWwsInZhbHVlIik9PT11bmRlZmluZWQpe3RoaXMudmFsdWU9dmFsO319KTt9fSk7alF1ZXJ5LmV4dGVuZCh7dmFsSG9va3M6e29wdGlvbjp7Z2V0OmZ1bmN0aW9uKGVsZW0pe3ZhciB2YWw9alF1ZXJ5LmZpbmQuYXR0cihlbGVtLCJ2YWx1ZSIpO3JldHVybiB2YWwhPW51bGw/dmFsOmpRdWVyeS50ZXh0KGVsZW0pO319LHNlbGVjdDp7Z2V0OmZ1bmN0aW9uKGVsZW0pe3ZhciB2YWx1ZSxvcHRpb24sb3B0aW9ucz1lbGVtLm9wdGlvbnMsaW5kZXg9ZWxlbS5zZWxlY3RlZEluZGV4LG9uZT1lbGVtLnR5cGU9PT0ic2VsZWN0LW9uZSJ8fGluZGV4PDAsdmFsdWVzPW9uZT9udWxsOltdLG1heD1vbmU/aW5kZXgrMTpvcHRpb25zLmxlbmd0aCxpPWluZGV4PDA/bWF4Om9uZT9pbmRleDowO2Zvcig7aTxtYXg7aSsrKXtvcHRpb249b3B0aW9uc1tpXTtpZigob3B0aW9uLnNlbGVjdGVkfHxpPT09aW5kZXgpJiYoc3VwcG9ydC5vcHREaXNhYmxlZD8hb3B0aW9uLmRpc2FibGVkOm9wdGlvbi5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIik9PT1udWxsKSYmKCFvcHRpb24ucGFyZW50Tm9kZS5kaXNhYmxlZHx8IWpRdWVyeS5ub2RlTmFtZShvcHRpb24ucGFyZW50Tm9kZSwib3B0Z3JvdXAiKSkpe3ZhbHVlPWpRdWVyeShvcHRpb24pLnZhbCgpO2lmKG9uZSl7cmV0dXJuIHZhbHVlO30KdmFsdWVzLnB1c2godmFsdWUpO319CnJldHVybiB2YWx1ZXM7fSxzZXQ6ZnVuY3Rpb24oZWxlbSx2YWx1ZSl7dmFyIG9wdGlvblNldCxvcHRpb24sb3B0aW9ucz1lbGVtLm9wdGlvbnMsdmFsdWVzPWpRdWVyeS5tYWtlQXJyYXkodmFsdWUpLGk9b3B0aW9ucy5sZW5ndGg7d2hpbGUoaS0tKXtvcHRpb249b3B0aW9uc1tpXTtpZihqUXVlcnkuaW5BcnJheShqUXVlcnkudmFsSG9va3Mub3B0aW9uLmdldChvcHRpb24pLHZhbHVlcyk+PTApe3RyeXtvcHRpb24uc2VsZWN0ZWQ9b3B0aW9uU2V0PXRydWU7fWNhdGNoKF8pe29wdGlvbi5zY3JvbGxIZWlnaHQ7fX1lbHNle29wdGlvbi5zZWxlY3RlZD1mYWxzZTt9fQppZighb3B0aW9uU2V0KXtlbGVtLnNlbGVjdGVkSW5kZXg9LTE7fQpyZXR1cm4gb3B0aW9uczt9fX19KTtqUXVlcnkuZWFjaChbInJhZGlvIiwiY2hlY2tib3giXSxmdW5jdGlvbigpe2pRdWVyeS52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGVsZW0sdmFsdWUpe2lmKGpRdWVyeS5pc0FycmF5KHZhbHVlKSl7cmV0dXJuKGVsZW0uY2hlY2tlZD1qUXVlcnkuaW5BcnJheShqUXVlcnkoZWxlbSkudmFsKCksdmFsdWUpPj0wKTt9fX07aWYoIXN1cHBvcnQuY2hlY2tPbil7alF1ZXJ5LnZhbEhvb2tzW3RoaXNdLmdldD1mdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoInZhbHVlIik9PT1udWxsPyJvbiI6ZWxlbS52YWx1ZTt9O319KTt2YXIgbm9kZUhvb2ssYm9vbEhvb2ssYXR0ckhhbmRsZT1qUXVlcnkuZXhwci5hdHRySGFuZGxlLHJ1c2VEZWZhdWx0PS9eKD86Y2hlY2tlZHxzZWxlY3RlZCkkL2ksZ2V0U2V0QXR0cmlidXRlPXN1cHBvcnQuZ2V0U2V0QXR0cmlidXRlLGdldFNldElucHV0PXN1cHBvcnQuaW5wdXQ7alF1ZXJ5LmZuLmV4dGVuZCh7YXR0cjpmdW5jdGlvbihuYW1lLHZhbHVlKXtyZXR1cm4gYWNjZXNzKHRoaXMsalF1ZXJ5LmF0dHIsbmFtZSx2YWx1ZSxhcmd1bWVudHMubGVuZ3RoPjEpO30scmVtb3ZlQXR0cjpmdW5jdGlvbihuYW1lKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7alF1ZXJ5LnJlbW92ZUF0dHIodGhpcyxuYW1lKTt9KTt9fSk7alF1ZXJ5LmV4dGVuZCh7YXR0cjpmdW5jdGlvbihlbGVtLG5hbWUsdmFsdWUpe3ZhciBob29rcyxyZXQsblR5cGU9ZWxlbS5ub2RlVHlwZTtpZighZWxlbXx8blR5cGU9PT0zfHxuVHlwZT09PTh8fG5UeXBlPT09Mil7cmV0dXJuO30KaWYodHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlPT09c3RydW5kZWZpbmVkKXtyZXR1cm4galF1ZXJ5LnByb3AoZWxlbSxuYW1lLHZhbHVlKTt9CmlmKG5UeXBlIT09MXx8IWpRdWVyeS5pc1hNTERvYyhlbGVtKSl7bmFtZT1uYW1lLnRvTG93ZXJDYXNlKCk7aG9va3M9alF1ZXJ5LmF0dHJIb29rc1tuYW1lXXx8KGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdChuYW1lKT9ib29sSG9vazpub2RlSG9vayk7fQppZih2YWx1ZSE9PXVuZGVmaW5lZCl7aWYodmFsdWU9PT1udWxsKXtqUXVlcnkucmVtb3ZlQXR0cihlbGVtLG5hbWUpO31lbHNlIGlmKGhvb2tzJiYic2V0ImluIGhvb2tzJiYocmV0PWhvb2tzLnNldChlbGVtLHZhbHVlLG5hbWUpKSE9PXVuZGVmaW5lZCl7cmV0dXJuIHJldDt9ZWxzZXtlbGVtLnNldEF0dHJpYnV0ZShuYW1lLHZhbHVlKyIiKTtyZXR1cm4gdmFsdWU7fX1lbHNlIGlmKGhvb2tzJiYiZ2V0ImluIGhvb2tzJiYocmV0PWhvb2tzLmdldChlbGVtLG5hbWUpKSE9PW51bGwpe3JldHVybiByZXQ7fWVsc2V7cmV0PWpRdWVyeS5maW5kLmF0dHIoZWxlbSxuYW1lKTtyZXR1cm4gcmV0PT1udWxsP3VuZGVmaW5lZDpyZXQ7fX0scmVtb3ZlQXR0cjpmdW5jdGlvbihlbGVtLHZhbHVlKXt2YXIgbmFtZSxwcm9wTmFtZSxpPTAsYXR0ck5hbWVzPXZhbHVlJiZ2YWx1ZS5tYXRjaChybm90d2hpdGUpO2lmKGF0dHJOYW1lcyYmZWxlbS5ub2RlVHlwZT09PTEpe3doaWxlKChuYW1lPWF0dHJOYW1lc1tpKytdKSl7cHJvcE5hbWU9alF1ZXJ5LnByb3BGaXhbbmFtZV18fG5hbWU7aWYoalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KG5hbWUpKXtpZihnZXRTZXRJbnB1dCYmZ2V0U2V0QXR0cmlidXRlfHwhcnVzZURlZmF1bHQudGVzdChuYW1lKSl7ZWxlbVtwcm9wTmFtZV09ZmFsc2U7fWVsc2V7ZWxlbVtqUXVlcnkuY2FtZWxDYXNlKCJkZWZhdWx0LSIrbmFtZSldPWVsZW1bcHJvcE5hbWVdPWZhbHNlO319ZWxzZXtqUXVlcnkuYXR0cihlbGVtLG5hbWUsIiIpO30KZWxlbS5yZW1vdmVBdHRyaWJ1dGUoZ2V0U2V0QXR0cmlidXRlP25hbWU6cHJvcE5hbWUpO319fSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihlbGVtLHZhbHVlKXtpZighc3VwcG9ydC5yYWRpb1ZhbHVlJiZ2YWx1ZT09PSJyYWRpbyImJmpRdWVyeS5ub2RlTmFtZShlbGVtLCJpbnB1dCIpKXt2YXIgdmFsPWVsZW0udmFsdWU7ZWxlbS5zZXRBdHRyaWJ1dGUoInR5cGUiLHZhbHVlKTtpZih2YWwpe2VsZW0udmFsdWU9dmFsO30KcmV0dXJuIHZhbHVlO319fX19KTtib29sSG9vaz17c2V0OmZ1bmN0aW9uKGVsZW0sdmFsdWUsbmFtZSl7aWYodmFsdWU9PT1mYWxzZSl7alF1ZXJ5LnJlbW92ZUF0dHIoZWxlbSxuYW1lKTt9ZWxzZSBpZihnZXRTZXRJbnB1dCYmZ2V0U2V0QXR0cmlidXRlfHwhcnVzZURlZmF1bHQudGVzdChuYW1lKSl7ZWxlbS5zZXRBdHRyaWJ1dGUoIWdldFNldEF0dHJpYnV0ZSYmalF1ZXJ5LnByb3BGaXhbbmFtZV18fG5hbWUsbmFtZSk7fWVsc2V7ZWxlbVtqUXVlcnkuY2FtZWxDYXNlKCJkZWZhdWx0LSIrbmFtZSldPWVsZW1bbmFtZV09dHJ1ZTt9CnJldHVybiBuYW1lO319O2pRdWVyeS5lYWNoKGpRdWVyeS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksZnVuY3Rpb24oaSxuYW1lKXt2YXIgZ2V0dGVyPWF0dHJIYW5kbGVbbmFtZV18fGpRdWVyeS5maW5kLmF0dHI7YXR0ckhhbmRsZVtuYW1lXT1nZXRTZXRJbnB1dCYmZ2V0U2V0QXR0cmlidXRlfHwhcnVzZURlZmF1bHQudGVzdChuYW1lKT9mdW5jdGlvbihlbGVtLG5hbWUsaXNYTUwpe3ZhciByZXQsaGFuZGxlO2lmKCFpc1hNTCl7aGFuZGxlPWF0dHJIYW5kbGVbbmFtZV07YXR0ckhhbmRsZVtuYW1lXT1yZXQ7cmV0PWdldHRlcihlbGVtLG5hbWUsaXNYTUwpIT1udWxsP25hbWUudG9Mb3dlckNhc2UoKTpudWxsO2F0dHJIYW5kbGVbbmFtZV09aGFuZGxlO30KcmV0dXJuIHJldDt9OmZ1bmN0aW9uKGVsZW0sbmFtZSxpc1hNTCl7aWYoIWlzWE1MKXtyZXR1cm4gZWxlbVtqUXVlcnkuY2FtZWxDYXNlKCJkZWZhdWx0LSIrbmFtZSldP25hbWUudG9Mb3dlckNhc2UoKTpudWxsO319O30pO2lmKCFnZXRTZXRJbnB1dHx8IWdldFNldEF0dHJpYnV0ZSl7alF1ZXJ5LmF0dHJIb29rcy52YWx1ZT17c2V0OmZ1bmN0aW9uKGVsZW0sdmFsdWUsbmFtZSl7aWYoalF1ZXJ5Lm5vZGVOYW1lKGVsZW0sImlucHV0Iikpe2VsZW0uZGVmYXVsdFZhbHVlPXZhbHVlO31lbHNle3JldHVybiBub2RlSG9vayYmbm9kZUhvb2suc2V0KGVsZW0sdmFsdWUsbmFtZSk7fX19O30KaWYoIWdldFNldEF0dHJpYnV0ZSl7bm9kZUhvb2s9e3NldDpmdW5jdGlvbihlbGVtLHZhbHVlLG5hbWUpe3ZhciByZXQ9ZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKG5hbWUpO2lmKCFyZXQpe2VsZW0uc2V0QXR0cmlidXRlTm9kZSgocmV0PWVsZW0ub3duZXJEb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUobmFtZSkpKTt9CnJldC52YWx1ZT12YWx1ZSs9IiI7aWYobmFtZT09PSJ2YWx1ZSJ8fHZhbHVlPT09ZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSkpe3JldHVybiB2YWx1ZTt9fX07YXR0ckhhbmRsZS5pZD1hdHRySGFuZGxlLm5hbWU9YXR0ckhhbmRsZS5jb29yZHM9ZnVuY3Rpb24oZWxlbSxuYW1lLGlzWE1MKXt2YXIgcmV0O2lmKCFpc1hNTCl7cmV0dXJuKHJldD1lbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpJiZyZXQudmFsdWUhPT0iIj9yZXQudmFsdWU6bnVsbDt9fTtqUXVlcnkudmFsSG9va3MuYnV0dG9uPXtnZXQ6ZnVuY3Rpb24oZWxlbSxuYW1lKXt2YXIgcmV0PWVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKTtpZihyZXQmJnJldC5zcGVjaWZpZWQpe3JldHVybiByZXQudmFsdWU7fX0sc2V0Om5vZGVIb29rLnNldH07alF1ZXJ5LmF0dHJIb29rcy5jb250ZW50ZWRpdGFibGU9e3NldDpmdW5jdGlvbihlbGVtLHZhbHVlLG5hbWUpe25vZGVIb29rLnNldChlbGVtLHZhbHVlPT09IiI/ZmFsc2U6dmFsdWUsbmFtZSk7fX07alF1ZXJ5LmVhY2goWyJ3aWR0aCIsImhlaWdodCJdLGZ1bmN0aW9uKGksbmFtZSl7alF1ZXJ5LmF0dHJIb29rc1tuYW1lXT17c2V0OmZ1bmN0aW9uKGVsZW0sdmFsdWUpe2lmKHZhbHVlPT09IiIpe2VsZW0uc2V0QXR0cmlidXRlKG5hbWUsImF1dG8iKTtyZXR1cm4gdmFsdWU7fX19O30pO30KaWYoIXN1cHBvcnQuc3R5bGUpe2pRdWVyeS5hdHRySG9va3Muc3R5bGU9e2dldDpmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5zdHlsZS5jc3NUZXh0fHx1bmRlZmluZWQ7fSxzZXQ6ZnVuY3Rpb24oZWxlbSx2YWx1ZSl7cmV0dXJuKGVsZW0uc3R5bGUuY3NzVGV4dD12YWx1ZSsiIik7fX07fQp2YXIgcmZvY3VzYWJsZT0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvaSxyY2xpY2thYmxlPS9eKD86YXxhcmVhKSQvaTtqUXVlcnkuZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKG5hbWUsdmFsdWUpe3JldHVybiBhY2Nlc3ModGhpcyxqUXVlcnkucHJvcCxuYW1lLHZhbHVlLGFyZ3VtZW50cy5sZW5ndGg+MSk7fSxyZW1vdmVQcm9wOmZ1bmN0aW9uKG5hbWUpe25hbWU9alF1ZXJ5LnByb3BGaXhbbmFtZV18fG5hbWU7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3RyeXt0aGlzW25hbWVdPXVuZGVmaW5lZDtkZWxldGUgdGhpc1tuYW1lXTt9Y2F0Y2goZSl7fX0pO319KTtqUXVlcnkuZXh0ZW5kKHtwcm9wRml4OnsiZm9yIjoiaHRtbEZvciIsImNsYXNzIjoiY2xhc3NOYW1lIn0scHJvcDpmdW5jdGlvbihlbGVtLG5hbWUsdmFsdWUpe3ZhciByZXQsaG9va3Msbm90eG1sLG5UeXBlPWVsZW0ubm9kZVR5cGU7aWYoIWVsZW18fG5UeXBlPT09M3x8blR5cGU9PT04fHxuVHlwZT09PTIpe3JldHVybjt9Cm5vdHhtbD1uVHlwZSE9PTF8fCFqUXVlcnkuaXNYTUxEb2MoZWxlbSk7aWYobm90eG1sKXtuYW1lPWpRdWVyeS5wcm9wRml4W25hbWVdfHxuYW1lO2hvb2tzPWpRdWVyeS5wcm9wSG9va3NbbmFtZV07fQppZih2YWx1ZSE9PXVuZGVmaW5lZCl7cmV0dXJuIGhvb2tzJiYic2V0ImluIGhvb2tzJiYocmV0PWhvb2tzLnNldChlbGVtLHZhbHVlLG5hbWUpKSE9PXVuZGVmaW5lZD9yZXQ6KGVsZW1bbmFtZV09dmFsdWUpO31lbHNle3JldHVybiBob29rcyYmImdldCJpbiBob29rcyYmKHJldD1ob29rcy5nZXQoZWxlbSxuYW1lKSkhPT1udWxsP3JldDplbGVtW25hbWVdO319LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihlbGVtKXt2YXIgdGFiaW5kZXg9alF1ZXJ5LmZpbmQuYXR0cihlbGVtLCJ0YWJpbmRleCIpO3JldHVybiB0YWJpbmRleD9wYXJzZUludCh0YWJpbmRleCwxMCk6cmZvY3VzYWJsZS50ZXN0KGVsZW0ubm9kZU5hbWUpfHxyY2xpY2thYmxlLnRlc3QoZWxlbS5ub2RlTmFtZSkmJmVsZW0uaHJlZj8wOi0xO319fX0pO2lmKCFzdXBwb3J0LmhyZWZOb3JtYWxpemVkKXtqUXVlcnkuZWFjaChbImhyZWYiLCJzcmMiXSxmdW5jdGlvbihpLG5hbWUpe2pRdWVyeS5wcm9wSG9va3NbbmFtZV09e2dldDpmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSw0KTt9fTt9KTt9CmlmKCFzdXBwb3J0Lm9wdFNlbGVjdGVkKXtqUXVlcnkucHJvcEhvb2tzLnNlbGVjdGVkPXtnZXQ6ZnVuY3Rpb24oZWxlbSl7dmFyIHBhcmVudD1lbGVtLnBhcmVudE5vZGU7aWYocGFyZW50KXtwYXJlbnQuc2VsZWN0ZWRJbmRleDtpZihwYXJlbnQucGFyZW50Tm9kZSl7cGFyZW50LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDt9fQpyZXR1cm4gbnVsbDt9fTt9CmpRdWVyeS5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXtqUXVlcnkucHJvcEZpeFt0aGlzLnRvTG93ZXJDYXNlKCldPXRoaXM7fSk7aWYoIXN1cHBvcnQuZW5jdHlwZSl7alF1ZXJ5LnByb3BGaXguZW5jdHlwZT0iZW5jb2RpbmciO30KdmFyIHJjbGFzcz0vW1x0XHJcblxmXS9nO2pRdWVyeS5mbi5leHRlbmQoe2FkZENsYXNzOmZ1bmN0aW9uKHZhbHVlKXt2YXIgY2xhc3NlcyxlbGVtLGN1cixjbGF6eixqLGZpbmFsVmFsdWUsaT0wLGxlbj10aGlzLmxlbmd0aCxwcm9jZWVkPXR5cGVvZiB2YWx1ZT09PSJzdHJpbmciJiZ2YWx1ZTtpZihqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oail7alF1ZXJ5KHRoaXMpLmFkZENsYXNzKHZhbHVlLmNhbGwodGhpcyxqLHRoaXMuY2xhc3NOYW1lKSk7fSk7fQppZihwcm9jZWVkKXtjbGFzc2VzPSh2YWx1ZXx8IiIpLm1hdGNoKHJub3R3aGl0ZSl8fFtdO2Zvcig7aTxsZW47aSsrKXtlbGVtPXRoaXNbaV07Y3VyPWVsZW0ubm9kZVR5cGU9PT0xJiYoZWxlbS5jbGFzc05hbWU/KCIgIitlbGVtLmNsYXNzTmFtZSsiICIpLnJlcGxhY2UocmNsYXNzLCIgIik6IiAiKTtpZihjdXIpe2o9MDt3aGlsZSgoY2xheno9Y2xhc3Nlc1tqKytdKSl7aWYoY3VyLmluZGV4T2YoIiAiK2NsYXp6KyIgIik8MCl7Y3VyKz1jbGF6eisiICI7fX0KZmluYWxWYWx1ZT1qUXVlcnkudHJpbShjdXIpO2lmKGVsZW0uY2xhc3NOYW1lIT09ZmluYWxWYWx1ZSl7ZWxlbS5jbGFzc05hbWU9ZmluYWxWYWx1ZTt9fX19CnJldHVybiB0aGlzO30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24odmFsdWUpe3ZhciBjbGFzc2VzLGVsZW0sY3VyLGNsYXp6LGosZmluYWxWYWx1ZSxpPTAsbGVuPXRoaXMubGVuZ3RoLHByb2NlZWQ9YXJndW1lbnRzLmxlbmd0aD09PTB8fHR5cGVvZiB2YWx1ZT09PSJzdHJpbmciJiZ2YWx1ZTtpZihqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oail7alF1ZXJ5KHRoaXMpLnJlbW92ZUNsYXNzKHZhbHVlLmNhbGwodGhpcyxqLHRoaXMuY2xhc3NOYW1lKSk7fSk7fQppZihwcm9jZWVkKXtjbGFzc2VzPSh2YWx1ZXx8IiIpLm1hdGNoKHJub3R3aGl0ZSl8fFtdO2Zvcig7aTxsZW47aSsrKXtlbGVtPXRoaXNbaV07Y3VyPWVsZW0ubm9kZVR5cGU9PT0xJiYoZWxlbS5jbGFzc05hbWU/KCIgIitlbGVtLmNsYXNzTmFtZSsiICIpLnJlcGxhY2UocmNsYXNzLCIgIik6IiIpO2lmKGN1cil7aj0wO3doaWxlKChjbGF6ej1jbGFzc2VzW2orK10pKXt3aGlsZShjdXIuaW5kZXhPZigiICIrY2xhenorIiAiKT49MCl7Y3VyPWN1ci5yZXBsYWNlKCIgIitjbGF6eisiICIsIiAiKTt9fQpmaW5hbFZhbHVlPXZhbHVlP2pRdWVyeS50cmltKGN1cik6IiI7aWYoZWxlbS5jbGFzc05hbWUhPT1maW5hbFZhbHVlKXtlbGVtLmNsYXNzTmFtZT1maW5hbFZhbHVlO319fX0KcmV0dXJuIHRoaXM7fSx0b2dnbGVDbGFzczpmdW5jdGlvbih2YWx1ZSxzdGF0ZVZhbCl7dmFyIHR5cGU9dHlwZW9mIHZhbHVlO2lmKHR5cGVvZiBzdGF0ZVZhbD09PSJib29sZWFuIiYmdHlwZT09PSJzdHJpbmciKXtyZXR1cm4gc3RhdGVWYWw/dGhpcy5hZGRDbGFzcyh2YWx1ZSk6dGhpcy5yZW1vdmVDbGFzcyh2YWx1ZSk7fQppZihqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSl7alF1ZXJ5KHRoaXMpLnRvZ2dsZUNsYXNzKHZhbHVlLmNhbGwodGhpcyxpLHRoaXMuY2xhc3NOYW1lLHN0YXRlVmFsKSxzdGF0ZVZhbCk7fSk7fQpyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7aWYodHlwZT09PSJzdHJpbmciKXt2YXIgY2xhc3NOYW1lLGk9MCxzZWxmPWpRdWVyeSh0aGlzKSxjbGFzc05hbWVzPXZhbHVlLm1hdGNoKHJub3R3aGl0ZSl8fFtdO3doaWxlKChjbGFzc05hbWU9Y2xhc3NOYW1lc1tpKytdKSl7aWYoc2VsZi5oYXNDbGFzcyhjbGFzc05hbWUpKXtzZWxmLnJlbW92ZUNsYXNzKGNsYXNzTmFtZSk7fWVsc2V7c2VsZi5hZGRDbGFzcyhjbGFzc05hbWUpO319fWVsc2UgaWYodHlwZT09PXN0cnVuZGVmaW5lZHx8dHlwZT09PSJib29sZWFuIil7aWYodGhpcy5jbGFzc05hbWUpe2pRdWVyeS5fZGF0YSh0aGlzLCJfX2NsYXNzTmFtZV9fIix0aGlzLmNsYXNzTmFtZSk7fQp0aGlzLmNsYXNzTmFtZT10aGlzLmNsYXNzTmFtZXx8dmFsdWU9PT1mYWxzZT8iIjpqUXVlcnkuX2RhdGEodGhpcywiX19jbGFzc05hbWVfXyIpfHwiIjt9fSk7fSxoYXNDbGFzczpmdW5jdGlvbihzZWxlY3Rvcil7dmFyIGNsYXNzTmFtZT0iICIrc2VsZWN0b3IrIiAiLGk9MCxsPXRoaXMubGVuZ3RoO2Zvcig7aTxsO2krKyl7aWYodGhpc1tpXS5ub2RlVHlwZT09PTEmJigiICIrdGhpc1tpXS5jbGFzc05hbWUrIiAiKS5yZXBsYWNlKHJjbGFzcywiICIpLmluZGV4T2YoY2xhc3NOYW1lKT49MCl7cmV0dXJuIHRydWU7fX0KcmV0dXJuIGZhbHNlO319KTtqUXVlcnkuZWFjaCgoImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCBsb2FkIHJlc2l6ZSBzY3JvbGwgdW5sb2FkIGNsaWNrIGRibGNsaWNrICIrIm1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlICIrImNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnUiKS5zcGxpdCgiICIpLGZ1bmN0aW9uKGksbmFtZSl7alF1ZXJ5LmZuW25hbWVdPWZ1bmN0aW9uKGRhdGEsZm4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPjA/dGhpcy5vbihuYW1lLG51bGwsZGF0YSxmbik6dGhpcy50cmlnZ2VyKG5hbWUpO307fSk7alF1ZXJ5LmZuLmV4dGVuZCh7aG92ZXI6ZnVuY3Rpb24oZm5PdmVyLGZuT3V0KXtyZXR1cm4gdGhpcy5tb3VzZWVudGVyKGZuT3ZlcikubW91c2VsZWF2ZShmbk91dHx8Zm5PdmVyKTt9LGJpbmQ6ZnVuY3Rpb24odHlwZXMsZGF0YSxmbil7cmV0dXJuIHRoaXMub24odHlwZXMsbnVsbCxkYXRhLGZuKTt9LHVuYmluZDpmdW5jdGlvbih0eXBlcyxmbil7cmV0dXJuIHRoaXMub2ZmKHR5cGVzLG51bGwsZm4pO30sZGVsZWdhdGU6ZnVuY3Rpb24oc2VsZWN0b3IsdHlwZXMsZGF0YSxmbil7cmV0dXJuIHRoaXMub24odHlwZXMsc2VsZWN0b3IsZGF0YSxmbik7fSx1bmRlbGVnYXRlOmZ1bmN0aW9uKHNlbGVjdG9yLHR5cGVzLGZuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD09PTE/dGhpcy5vZmYoc2VsZWN0b3IsIioqIik6dGhpcy5vZmYodHlwZXMsc2VsZWN0b3J8fCIqKiIsZm4pO319KTt2YXIgbm9uY2U9alF1ZXJ5Lm5vdygpO3ZhciBycXVlcnk9KC9cPy8pO3ZhciBydmFsaWR0b2tlbnM9LygsKXwoXFt8eyl8KH18XSl8Iig/OlteIlxcXHJcbl18XFxbIlxcXC9iZm5ydF18XFx1W1xkYS1mQS1GXXs0fSkqIlxzKjo/fHRydWV8ZmFsc2V8bnVsbHwtPyg/ITBcZClcZCsoPzpcLlxkK3wpKD86W2VFXVsrLV0/XGQrfCkvZztqUXVlcnkucGFyc2VKU09OPWZ1bmN0aW9uKGRhdGEpe2lmKHdpbmRvdy5KU09OJiZ3aW5kb3cuSlNPTi5wYXJzZSl7cmV0dXJuIHdpbmRvdy5KU09OLnBhcnNlKGRhdGErIiIpO30KdmFyIHJlcXVpcmVOb25Db21tYSxkZXB0aD1udWxsLHN0cj1qUXVlcnkudHJpbShkYXRhKyIiKTtyZXR1cm4gc3RyJiYhalF1ZXJ5LnRyaW0oc3RyLnJlcGxhY2UocnZhbGlkdG9rZW5zLGZ1bmN0aW9uKHRva2VuLGNvbW1hLG9wZW4sY2xvc2Upe2lmKHJlcXVpcmVOb25Db21tYSYmY29tbWEpe2RlcHRoPTA7fQppZihkZXB0aD09PTApe3JldHVybiB0b2tlbjt9CnJlcXVpcmVOb25Db21tYT1vcGVufHxjb21tYTtkZXB0aCs9IWNsb3NlLSFvcGVuO3JldHVybiIiO30pKT8oRnVuY3Rpb24oInJldHVybiAiK3N0cikpKCk6alF1ZXJ5LmVycm9yKCJJbnZhbGlkIEpTT046ICIrZGF0YSk7fTtqUXVlcnkucGFyc2VYTUw9ZnVuY3Rpb24oZGF0YSl7dmFyIHhtbCx0bXA7aWYoIWRhdGF8fHR5cGVvZiBkYXRhIT09InN0cmluZyIpe3JldHVybiBudWxsO30KdHJ5e2lmKHdpbmRvdy5ET01QYXJzZXIpe3RtcD1uZXcgRE9NUGFyc2VyKCk7eG1sPXRtcC5wYXJzZUZyb21TdHJpbmcoZGF0YSwidGV4dC94bWwiKTt9ZWxzZXt4bWw9bmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKTt4bWwuYXN5bmM9ImZhbHNlIjt4bWwubG9hZFhNTChkYXRhKTt9fWNhdGNoKGUpe3htbD11bmRlZmluZWQ7fQppZigheG1sfHwheG1sLmRvY3VtZW50RWxlbWVudHx8eG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwYXJzZXJlcnJvciIpLmxlbmd0aCl7alF1ZXJ5LmVycm9yKCJJbnZhbGlkIFhNTDogIitkYXRhKTt9CnJldHVybiB4bWw7fTt2YXIKYWpheExvY1BhcnRzLGFqYXhMb2NhdGlvbixyaGFzaD0vIy4qJC8scnRzPS8oWz8mXSlfPVteJl0qLyxyaGVhZGVycz0vXiguKj8pOlsgXHRdKihbXlxyXG5dKilccj8kL21nLHJsb2NhbFByb3RvY29sPS9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLHJub0NvbnRlbnQ9L14oPzpHRVR8SEVBRCkkLyxycHJvdG9jb2w9L15cL1wvLyxydXJsPS9eKFtcdy4rLV0rOikoPzpcL1wvKD86W15cLz8jXSpAfCkoW15cLz8jOl0qKSg/OjooXGQrKXwpfCkvLHByZWZpbHRlcnM9e30sdHJhbnNwb3J0cz17fSxhbGxUeXBlcz0iKi8iLmNvbmNhdCgiKiIpO3RyeXthamF4TG9jYXRpb249bG9jYXRpb24uaHJlZjt9Y2F0Y2goZSl7YWpheExvY2F0aW9uPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTthamF4TG9jYXRpb24uaHJlZj0iIjthamF4TG9jYXRpb249YWpheExvY2F0aW9uLmhyZWY7fQphamF4TG9jUGFydHM9cnVybC5leGVjKGFqYXhMb2NhdGlvbi50b0xvd2VyQ2FzZSgpKXx8W107ZnVuY3Rpb24gYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHN0cnVjdHVyZSl7cmV0dXJuIGZ1bmN0aW9uKGRhdGFUeXBlRXhwcmVzc2lvbixmdW5jKXtpZih0eXBlb2YgZGF0YVR5cGVFeHByZXNzaW9uIT09InN0cmluZyIpe2Z1bmM9ZGF0YVR5cGVFeHByZXNzaW9uO2RhdGFUeXBlRXhwcmVzc2lvbj0iKiI7fQp2YXIgZGF0YVR5cGUsaT0wLGRhdGFUeXBlcz1kYXRhVHlwZUV4cHJlc3Npb24udG9Mb3dlckNhc2UoKS5tYXRjaChybm90d2hpdGUpfHxbXTtpZihqUXVlcnkuaXNGdW5jdGlvbihmdW5jKSl7d2hpbGUoKGRhdGFUeXBlPWRhdGFUeXBlc1tpKytdKSl7aWYoZGF0YVR5cGUuY2hhckF0KDApPT09IisiKXtkYXRhVHlwZT1kYXRhVHlwZS5zbGljZSgxKXx8IioiOyhzdHJ1Y3R1cmVbZGF0YVR5cGVdPXN0cnVjdHVyZVtkYXRhVHlwZV18fFtdKS51bnNoaWZ0KGZ1bmMpO31lbHNleyhzdHJ1Y3R1cmVbZGF0YVR5cGVdPXN0cnVjdHVyZVtkYXRhVHlwZV18fFtdKS5wdXNoKGZ1bmMpO319fX07fQpmdW5jdGlvbiBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyhzdHJ1Y3R1cmUsb3B0aW9ucyxvcmlnaW5hbE9wdGlvbnMsanFYSFIpe3ZhciBpbnNwZWN0ZWQ9e30sc2Vla2luZ1RyYW5zcG9ydD0oc3RydWN0dXJlPT09dHJhbnNwb3J0cyk7ZnVuY3Rpb24gaW5zcGVjdChkYXRhVHlwZSl7dmFyIHNlbGVjdGVkO2luc3BlY3RlZFtkYXRhVHlwZV09dHJ1ZTtqUXVlcnkuZWFjaChzdHJ1Y3R1cmVbZGF0YVR5cGVdfHxbXSxmdW5jdGlvbihfLHByZWZpbHRlck9yRmFjdG9yeSl7dmFyIGRhdGFUeXBlT3JUcmFuc3BvcnQ9cHJlZmlsdGVyT3JGYWN0b3J5KG9wdGlvbnMsb3JpZ2luYWxPcHRpb25zLGpxWEhSKTtpZih0eXBlb2YgZGF0YVR5cGVPclRyYW5zcG9ydD09PSJzdHJpbmciJiYhc2Vla2luZ1RyYW5zcG9ydCYmIWluc3BlY3RlZFtkYXRhVHlwZU9yVHJhbnNwb3J0XSl7b3B0aW9ucy5kYXRhVHlwZXMudW5zaGlmdChkYXRhVHlwZU9yVHJhbnNwb3J0KTtpbnNwZWN0KGRhdGFUeXBlT3JUcmFuc3BvcnQpO3JldHVybiBmYWxzZTt9ZWxzZSBpZihzZWVraW5nVHJhbnNwb3J0KXtyZXR1cm4hKHNlbGVjdGVkPWRhdGFUeXBlT3JUcmFuc3BvcnQpO319KTtyZXR1cm4gc2VsZWN0ZWQ7fQpyZXR1cm4gaW5zcGVjdChvcHRpb25zLmRhdGFUeXBlc1swXSl8fCFpbnNwZWN0ZWRbIioiXSYmaW5zcGVjdCgiKiIpO30KZnVuY3Rpb24gYWpheEV4dGVuZCh0YXJnZXQsc3JjKXt2YXIgZGVlcCxrZXksZmxhdE9wdGlvbnM9alF1ZXJ5LmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKGtleSBpbiBzcmMpe2lmKHNyY1trZXldIT09dW5kZWZpbmVkKXsoZmxhdE9wdGlvbnNba2V5XT90YXJnZXQ6KGRlZXB8fChkZWVwPXt9KSkpW2tleV09c3JjW2tleV07fX0KaWYoZGVlcCl7alF1ZXJ5LmV4dGVuZCh0cnVlLHRhcmdldCxkZWVwKTt9CnJldHVybiB0YXJnZXQ7fQpmdW5jdGlvbiBhamF4SGFuZGxlUmVzcG9uc2VzKHMsanFYSFIscmVzcG9uc2VzKXt2YXIgZmlyc3REYXRhVHlwZSxjdCxmaW5hbERhdGFUeXBlLHR5cGUsY29udGVudHM9cy5jb250ZW50cyxkYXRhVHlwZXM9cy5kYXRhVHlwZXM7d2hpbGUoZGF0YVR5cGVzWzBdPT09IioiKXtkYXRhVHlwZXMuc2hpZnQoKTtpZihjdD09PXVuZGVmaW5lZCl7Y3Q9cy5taW1lVHlwZXx8anFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpO319CmlmKGN0KXtmb3IodHlwZSBpbiBjb250ZW50cyl7aWYoY29udGVudHNbdHlwZV0mJmNvbnRlbnRzW3R5cGVdLnRlc3QoY3QpKXtkYXRhVHlwZXMudW5zaGlmdCh0eXBlKTticmVhazt9fX0KaWYoZGF0YVR5cGVzWzBdaW4gcmVzcG9uc2VzKXtmaW5hbERhdGFUeXBlPWRhdGFUeXBlc1swXTt9ZWxzZXtmb3IodHlwZSBpbiByZXNwb25zZXMpe2lmKCFkYXRhVHlwZXNbMF18fHMuY29udmVydGVyc1t0eXBlKyIgIitkYXRhVHlwZXNbMF1dKXtmaW5hbERhdGFUeXBlPXR5cGU7YnJlYWs7fQppZighZmlyc3REYXRhVHlwZSl7Zmlyc3REYXRhVHlwZT10eXBlO319CmZpbmFsRGF0YVR5cGU9ZmluYWxEYXRhVHlwZXx8Zmlyc3REYXRhVHlwZTt9CmlmKGZpbmFsRGF0YVR5cGUpe2lmKGZpbmFsRGF0YVR5cGUhPT1kYXRhVHlwZXNbMF0pe2RhdGFUeXBlcy51bnNoaWZ0KGZpbmFsRGF0YVR5cGUpO30KcmV0dXJuIHJlc3BvbnNlc1tmaW5hbERhdGFUeXBlXTt9fQpmdW5jdGlvbiBhamF4Q29udmVydChzLHJlc3BvbnNlLGpxWEhSLGlzU3VjY2Vzcyl7dmFyIGNvbnYyLGN1cnJlbnQsY29udix0bXAscHJldixjb252ZXJ0ZXJzPXt9LGRhdGFUeXBlcz1zLmRhdGFUeXBlcy5zbGljZSgpO2lmKGRhdGFUeXBlc1sxXSl7Zm9yKGNvbnYgaW4gcy5jb252ZXJ0ZXJzKXtjb252ZXJ0ZXJzW2NvbnYudG9Mb3dlckNhc2UoKV09cy5jb252ZXJ0ZXJzW2NvbnZdO319CmN1cnJlbnQ9ZGF0YVR5cGVzLnNoaWZ0KCk7d2hpbGUoY3VycmVudCl7aWYocy5yZXNwb25zZUZpZWxkc1tjdXJyZW50XSl7anFYSFJbcy5yZXNwb25zZUZpZWxkc1tjdXJyZW50XV09cmVzcG9uc2U7fQppZighcHJldiYmaXNTdWNjZXNzJiZzLmRhdGFGaWx0ZXIpe3Jlc3BvbnNlPXMuZGF0YUZpbHRlcihyZXNwb25zZSxzLmRhdGFUeXBlKTt9CnByZXY9Y3VycmVudDtjdXJyZW50PWRhdGFUeXBlcy5zaGlmdCgpO2lmKGN1cnJlbnQpe2lmKGN1cnJlbnQ9PT0iKiIpe2N1cnJlbnQ9cHJldjt9ZWxzZSBpZihwcmV2IT09IioiJiZwcmV2IT09Y3VycmVudCl7Y29udj1jb252ZXJ0ZXJzW3ByZXYrIiAiK2N1cnJlbnRdfHxjb252ZXJ0ZXJzWyIqICIrY3VycmVudF07aWYoIWNvbnYpe2Zvcihjb252MiBpbiBjb252ZXJ0ZXJzKXt0bXA9Y29udjIuc3BsaXQoIiAiKTtpZih0bXBbMV09PT1jdXJyZW50KXtjb252PWNvbnZlcnRlcnNbcHJldisiICIrdG1wWzBdXXx8Y29udmVydGVyc1siKiAiK3RtcFswXV07aWYoY29udil7aWYoY29udj09PXRydWUpe2NvbnY9Y29udmVydGVyc1tjb252Ml07fWVsc2UgaWYoY29udmVydGVyc1tjb252Ml0hPT10cnVlKXtjdXJyZW50PXRtcFswXTtkYXRhVHlwZXMudW5zaGlmdCh0bXBbMV0pO30KYnJlYWs7fX19fQppZihjb252IT09dHJ1ZSl7aWYoY29udiYmc1sidGhyb3dzIl0pe3Jlc3BvbnNlPWNvbnYocmVzcG9uc2UpO31lbHNle3RyeXtyZXNwb25zZT1jb252KHJlc3BvbnNlKTt9Y2F0Y2goZSl7cmV0dXJue3N0YXRlOiJwYXJzZXJlcnJvciIsZXJyb3I6Y29udj9lOiJObyBjb252ZXJzaW9uIGZyb20gIitwcmV2KyIgdG8gIitjdXJyZW50fTt9fX19fX0KcmV0dXJue3N0YXRlOiJzdWNjZXNzIixkYXRhOnJlc3BvbnNlfTt9CmpRdWVyeS5leHRlbmQoe2FjdGl2ZTowLGxhc3RNb2RpZmllZDp7fSxldGFnOnt9LGFqYXhTZXR0aW5nczp7dXJsOmFqYXhMb2NhdGlvbix0eXBlOiJHRVQiLGlzTG9jYWw6cmxvY2FsUHJvdG9jb2wudGVzdChhamF4TG9jUGFydHNbMV0pLGdsb2JhbDp0cnVlLHByb2Nlc3NEYXRhOnRydWUsYXN5bmM6dHJ1ZSxjb250ZW50VHlwZToiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IixhY2NlcHRzOnsiKiI6YWxsVHlwZXMsdGV4dDoidGV4dC9wbGFpbiIsaHRtbDoidGV4dC9odG1sIix4bWw6ImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLGpzb246ImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCJ9LGNvbnRlbnRzOnt4bWw6L3htbC8saHRtbDovaHRtbC8sanNvbjovanNvbi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjp0cnVlLCJ0ZXh0IGpzb24iOmpRdWVyeS5wYXJzZUpTT04sInRleHQgeG1sIjpqUXVlcnkucGFyc2VYTUx9LGZsYXRPcHRpb25zOnt1cmw6dHJ1ZSxjb250ZXh0OnRydWV9fSxhamF4U2V0dXA6ZnVuY3Rpb24odGFyZ2V0LHNldHRpbmdzKXtyZXR1cm4gc2V0dGluZ3M/YWpheEV4dGVuZChhamF4RXh0ZW5kKHRhcmdldCxqUXVlcnkuYWpheFNldHRpbmdzKSxzZXR0aW5ncyk6YWpheEV4dGVuZChqUXVlcnkuYWpheFNldHRpbmdzLHRhcmdldCk7fSxhamF4UHJlZmlsdGVyOmFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyhwcmVmaWx0ZXJzKSxhamF4VHJhbnNwb3J0OmFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyh0cmFuc3BvcnRzKSxhamF4OmZ1bmN0aW9uKHVybCxvcHRpb25zKXtpZih0eXBlb2YgdXJsPT09Im9iamVjdCIpe29wdGlvbnM9dXJsO3VybD11bmRlZmluZWQ7fQpvcHRpb25zPW9wdGlvbnN8fHt9O3ZhcgpwYXJ0cyxpLGNhY2hlVVJMLHJlc3BvbnNlSGVhZGVyc1N0cmluZyx0aW1lb3V0VGltZXIsZmlyZUdsb2JhbHMsdHJhbnNwb3J0LHJlc3BvbnNlSGVhZGVycyxzPWpRdWVyeS5hamF4U2V0dXAoe30sb3B0aW9ucyksY2FsbGJhY2tDb250ZXh0PXMuY29udGV4dHx8cyxnbG9iYWxFdmVudENvbnRleHQ9cy5jb250ZXh0JiYoY2FsbGJhY2tDb250ZXh0Lm5vZGVUeXBlfHxjYWxsYmFja0NvbnRleHQuanF1ZXJ5KT9qUXVlcnkoY2FsbGJhY2tDb250ZXh0KTpqUXVlcnkuZXZlbnQsZGVmZXJyZWQ9alF1ZXJ5LkRlZmVycmVkKCksY29tcGxldGVEZWZlcnJlZD1qUXVlcnkuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHN0YXR1c0NvZGU9cy5zdGF0dXNDb2RlfHx7fSxyZXF1ZXN0SGVhZGVycz17fSxyZXF1ZXN0SGVhZGVyc05hbWVzPXt9LHN0YXRlPTAsc3RyQWJvcnQ9ImNhbmNlbGVkIixqcVhIUj17cmVhZHlTdGF0ZTowLGdldFJlc3BvbnNlSGVhZGVyOmZ1bmN0aW9uKGtleSl7dmFyIG1hdGNoO2lmKHN0YXRlPT09Mil7aWYoIXJlc3BvbnNlSGVhZGVycyl7cmVzcG9uc2VIZWFkZXJzPXt9O3doaWxlKChtYXRjaD1yaGVhZGVycy5leGVjKHJlc3BvbnNlSGVhZGVyc1N0cmluZykpKXtyZXNwb25zZUhlYWRlcnNbbWF0Y2hbMV0udG9Mb3dlckNhc2UoKV09bWF0Y2hbMl07fX0KbWF0Y2g9cmVzcG9uc2VIZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXTt9CnJldHVybiBtYXRjaD09bnVsbD9udWxsOm1hdGNoO30sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIHN0YXRlPT09Mj9yZXNwb25zZUhlYWRlcnNTdHJpbmc6bnVsbDt9LHNldFJlcXVlc3RIZWFkZXI6ZnVuY3Rpb24obmFtZSx2YWx1ZSl7dmFyIGxuYW1lPW5hbWUudG9Mb3dlckNhc2UoKTtpZighc3RhdGUpe25hbWU9cmVxdWVzdEhlYWRlcnNOYW1lc1tsbmFtZV09cmVxdWVzdEhlYWRlcnNOYW1lc1tsbmFtZV18fG5hbWU7cmVxdWVzdEhlYWRlcnNbbmFtZV09dmFsdWU7fQpyZXR1cm4gdGhpczt9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24odHlwZSl7aWYoIXN0YXRlKXtzLm1pbWVUeXBlPXR5cGU7fQpyZXR1cm4gdGhpczt9LHN0YXR1c0NvZGU6ZnVuY3Rpb24obWFwKXt2YXIgY29kZTtpZihtYXApe2lmKHN0YXRlPDIpe2Zvcihjb2RlIGluIG1hcCl7c3RhdHVzQ29kZVtjb2RlXT1bc3RhdHVzQ29kZVtjb2RlXSxtYXBbY29kZV1dO319ZWxzZXtqcVhIUi5hbHdheXMobWFwW2pxWEhSLnN0YXR1c10pO319CnJldHVybiB0aGlzO30sYWJvcnQ6ZnVuY3Rpb24oc3RhdHVzVGV4dCl7dmFyIGZpbmFsVGV4dD1zdGF0dXNUZXh0fHxzdHJBYm9ydDtpZih0cmFuc3BvcnQpe3RyYW5zcG9ydC5hYm9ydChmaW5hbFRleHQpO30KZG9uZSgwLGZpbmFsVGV4dCk7cmV0dXJuIHRoaXM7fX07ZGVmZXJyZWQucHJvbWlzZShqcVhIUikuY29tcGxldGU9Y29tcGxldGVEZWZlcnJlZC5hZGQ7anFYSFIuc3VjY2Vzcz1qcVhIUi5kb25lO2pxWEhSLmVycm9yPWpxWEhSLmZhaWw7cy51cmw9KCh1cmx8fHMudXJsfHxhamF4TG9jYXRpb24pKyIiKS5yZXBsYWNlKHJoYXNoLCIiKS5yZXBsYWNlKHJwcm90b2NvbCxhamF4TG9jUGFydHNbMV0rIi8vIik7cy50eXBlPW9wdGlvbnMubWV0aG9kfHxvcHRpb25zLnR5cGV8fHMubWV0aG9kfHxzLnR5cGU7cy5kYXRhVHlwZXM9alF1ZXJ5LnRyaW0ocy5kYXRhVHlwZXx8IioiKS50b0xvd2VyQ2FzZSgpLm1hdGNoKHJub3R3aGl0ZSl8fFsiIl07aWYocy5jcm9zc0RvbWFpbj09bnVsbCl7cGFydHM9cnVybC5leGVjKHMudXJsLnRvTG93ZXJDYXNlKCkpO3MuY3Jvc3NEb21haW49ISEocGFydHMmJihwYXJ0c1sxXSE9PWFqYXhMb2NQYXJ0c1sxXXx8cGFydHNbMl0hPT1hamF4TG9jUGFydHNbMl18fChwYXJ0c1szXXx8KHBhcnRzWzFdPT09Imh0dHA6Ij8iODAiOiI0NDMiKSkhPT0oYWpheExvY1BhcnRzWzNdfHwoYWpheExvY1BhcnRzWzFdPT09Imh0dHA6Ij8iODAiOiI0NDMiKSkpKTt9CmlmKHMuZGF0YSYmcy5wcm9jZXNzRGF0YSYmdHlwZW9mIHMuZGF0YSE9PSJzdHJpbmciKXtzLmRhdGE9alF1ZXJ5LnBhcmFtKHMuZGF0YSxzLnRyYWRpdGlvbmFsKTt9Cmluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHByZWZpbHRlcnMscyxvcHRpb25zLGpxWEhSKTtpZihzdGF0ZT09PTIpe3JldHVybiBqcVhIUjt9CmZpcmVHbG9iYWxzPXMuZ2xvYmFsO2lmKGZpcmVHbG9iYWxzJiZqUXVlcnkuYWN0aXZlKys9PT0wKXtqUXVlcnkuZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0Iik7fQpzLnR5cGU9cy50eXBlLnRvVXBwZXJDYXNlKCk7cy5oYXNDb250ZW50PSFybm9Db250ZW50LnRlc3Qocy50eXBlKTtjYWNoZVVSTD1zLnVybDtpZighcy5oYXNDb250ZW50KXtpZihzLmRhdGEpe2NhY2hlVVJMPShzLnVybCs9KHJxdWVyeS50ZXN0KGNhY2hlVVJMKT8iJiI6Ij8iKStzLmRhdGEpO2RlbGV0ZSBzLmRhdGE7fQppZihzLmNhY2hlPT09ZmFsc2Upe3MudXJsPXJ0cy50ZXN0KGNhY2hlVVJMKT9jYWNoZVVSTC5yZXBsYWNlKHJ0cywiJDFfPSIrbm9uY2UrKyk6Y2FjaGVVUkwrKHJxdWVyeS50ZXN0KGNhY2hlVVJMKT8iJiI6Ij8iKSsiXz0iK25vbmNlKys7fX0KaWYocy5pZk1vZGlmaWVkKXtpZihqUXVlcnkubGFzdE1vZGlmaWVkW2NhY2hlVVJMXSl7anFYSFIuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLGpRdWVyeS5sYXN0TW9kaWZpZWRbY2FjaGVVUkxdKTt9CmlmKGpRdWVyeS5ldGFnW2NhY2hlVVJMXSl7anFYSFIuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsalF1ZXJ5LmV0YWdbY2FjaGVVUkxdKTt9fQppZihzLmRhdGEmJnMuaGFzQ29udGVudCYmcy5jb250ZW50VHlwZSE9PWZhbHNlfHxvcHRpb25zLmNvbnRlbnRUeXBlKXtqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLHMuY29udGVudFR5cGUpO30KanFYSFIuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IixzLmRhdGFUeXBlc1swXSYmcy5hY2NlcHRzW3MuZGF0YVR5cGVzWzBdXT9zLmFjY2VwdHNbcy5kYXRhVHlwZXNbMF1dKyhzLmRhdGFUeXBlc1swXSE9PSIqIj8iLCAiK2FsbFR5cGVzKyI7IHE9MC4wMSI6IiIpOnMuYWNjZXB0c1siKiJdKTtmb3IoaSBpbiBzLmhlYWRlcnMpe2pxWEhSLnNldFJlcXVlc3RIZWFkZXIoaSxzLmhlYWRlcnNbaV0pO30KaWYocy5iZWZvcmVTZW5kJiYocy5iZWZvcmVTZW5kLmNhbGwoY2FsbGJhY2tDb250ZXh0LGpxWEhSLHMpPT09ZmFsc2V8fHN0YXRlPT09Mikpe3JldHVybiBqcVhIUi5hYm9ydCgpO30Kc3RyQWJvcnQ9ImFib3J0Ijtmb3IoaSBpbntzdWNjZXNzOjEsZXJyb3I6MSxjb21wbGV0ZToxfSl7anFYSFJbaV0oc1tpXSk7fQp0cmFuc3BvcnQ9aW5zcGVjdFByZWZpbHRlcnNPclRyYW5zcG9ydHModHJhbnNwb3J0cyxzLG9wdGlvbnMsanFYSFIpO2lmKCF0cmFuc3BvcnQpe2RvbmUoLTEsIk5vIFRyYW5zcG9ydCIpO31lbHNle2pxWEhSLnJlYWR5U3RhdGU9MTtpZihmaXJlR2xvYmFscyl7Z2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoImFqYXhTZW5kIixbanFYSFIsc10pO30KaWYocy5hc3luYyYmcy50aW1lb3V0PjApe3RpbWVvdXRUaW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7anFYSFIuYWJvcnQoInRpbWVvdXQiKTt9LHMudGltZW91dCk7fQp0cnl7c3RhdGU9MTt0cmFuc3BvcnQuc2VuZChyZXF1ZXN0SGVhZGVycyxkb25lKTt9Y2F0Y2goZSl7aWYoc3RhdGU8Mil7ZG9uZSgtMSxlKTt9ZWxzZXt0aHJvdyBlO319fQpmdW5jdGlvbiBkb25lKHN0YXR1cyxuYXRpdmVTdGF0dXNUZXh0LHJlc3BvbnNlcyxoZWFkZXJzKXt2YXIgaXNTdWNjZXNzLHN1Y2Nlc3MsZXJyb3IscmVzcG9uc2UsbW9kaWZpZWQsc3RhdHVzVGV4dD1uYXRpdmVTdGF0dXNUZXh0O2lmKHN0YXRlPT09Mil7cmV0dXJuO30Kc3RhdGU9MjtpZih0aW1lb3V0VGltZXIpe2NsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpO30KdHJhbnNwb3J0PXVuZGVmaW5lZDtyZXNwb25zZUhlYWRlcnNTdHJpbmc9aGVhZGVyc3x8IiI7anFYSFIucmVhZHlTdGF0ZT1zdGF0dXM+MD80OjA7aXNTdWNjZXNzPXN0YXR1cz49MjAwJiZzdGF0dXM8MzAwfHxzdGF0dXM9PT0zMDQ7aWYocmVzcG9uc2VzKXtyZXNwb25zZT1hamF4SGFuZGxlUmVzcG9uc2VzKHMsanFYSFIscmVzcG9uc2VzKTt9CnJlc3BvbnNlPWFqYXhDb252ZXJ0KHMscmVzcG9uc2UsanFYSFIsaXNTdWNjZXNzKTtpZihpc1N1Y2Nlc3Mpe2lmKHMuaWZNb2RpZmllZCl7bW9kaWZpZWQ9anFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKTtpZihtb2RpZmllZCl7alF1ZXJ5Lmxhc3RNb2RpZmllZFtjYWNoZVVSTF09bW9kaWZpZWQ7fQptb2RpZmllZD1qcVhIUi5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpO2lmKG1vZGlmaWVkKXtqUXVlcnkuZXRhZ1tjYWNoZVVSTF09bW9kaWZpZWQ7fX0KaWYoc3RhdHVzPT09MjA0fHxzLnR5cGU9PT0iSEVBRCIpe3N0YXR1c1RleHQ9Im5vY29udGVudCI7fWVsc2UgaWYoc3RhdHVzPT09MzA0KXtzdGF0dXNUZXh0PSJub3Rtb2RpZmllZCI7fWVsc2V7c3RhdHVzVGV4dD1yZXNwb25zZS5zdGF0ZTtzdWNjZXNzPXJlc3BvbnNlLmRhdGE7ZXJyb3I9cmVzcG9uc2UuZXJyb3I7aXNTdWNjZXNzPSFlcnJvcjt9fWVsc2V7ZXJyb3I9c3RhdHVzVGV4dDtpZihzdGF0dXN8fCFzdGF0dXNUZXh0KXtzdGF0dXNUZXh0PSJlcnJvciI7aWYoc3RhdHVzPDApe3N0YXR1cz0wO319fQpqcVhIUi5zdGF0dXM9c3RhdHVzO2pxWEhSLnN0YXR1c1RleHQ9KG5hdGl2ZVN0YXR1c1RleHR8fHN0YXR1c1RleHQpKyIiO2lmKGlzU3VjY2Vzcyl7ZGVmZXJyZWQucmVzb2x2ZVdpdGgoY2FsbGJhY2tDb250ZXh0LFtzdWNjZXNzLHN0YXR1c1RleHQsanFYSFJdKTt9ZWxzZXtkZWZlcnJlZC5yZWplY3RXaXRoKGNhbGxiYWNrQ29udGV4dCxbanFYSFIsc3RhdHVzVGV4dCxlcnJvcl0pO30KanFYSFIuc3RhdHVzQ29kZShzdGF0dXNDb2RlKTtzdGF0dXNDb2RlPXVuZGVmaW5lZDtpZihmaXJlR2xvYmFscyl7Z2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoaXNTdWNjZXNzPyJhamF4U3VjY2VzcyI6ImFqYXhFcnJvciIsW2pxWEhSLHMsaXNTdWNjZXNzP3N1Y2Nlc3M6ZXJyb3JdKTt9CmNvbXBsZXRlRGVmZXJyZWQuZmlyZVdpdGgoY2FsbGJhY2tDb250ZXh0LFtqcVhIUixzdGF0dXNUZXh0XSk7aWYoZmlyZUdsb2JhbHMpe2dsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCJhamF4Q29tcGxldGUiLFtqcVhIUixzXSk7aWYoISgtLWpRdWVyeS5hY3RpdmUpKXtqUXVlcnkuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKTt9fX0KcmV0dXJuIGpxWEhSO30sZ2V0SlNPTjpmdW5jdGlvbih1cmwsZGF0YSxjYWxsYmFjayl7cmV0dXJuIGpRdWVyeS5nZXQodXJsLGRhdGEsY2FsbGJhY2ssImpzb24iKTt9LGdldFNjcmlwdDpmdW5jdGlvbih1cmwsY2FsbGJhY2spe3JldHVybiBqUXVlcnkuZ2V0KHVybCx1bmRlZmluZWQsY2FsbGJhY2ssInNjcmlwdCIpO319KTtqUXVlcnkuZWFjaChbImdldCIsInBvc3QiXSxmdW5jdGlvbihpLG1ldGhvZCl7alF1ZXJ5W21ldGhvZF09ZnVuY3Rpb24odXJsLGRhdGEsY2FsbGJhY2ssdHlwZSl7aWYoalF1ZXJ5LmlzRnVuY3Rpb24oZGF0YSkpe3R5cGU9dHlwZXx8Y2FsbGJhY2s7Y2FsbGJhY2s9ZGF0YTtkYXRhPXVuZGVmaW5lZDt9CnJldHVybiBqUXVlcnkuYWpheCh7dXJsOnVybCx0eXBlOm1ldGhvZCxkYXRhVHlwZTp0eXBlLGRhdGE6ZGF0YSxzdWNjZXNzOmNhbGxiYWNrfSk7fTt9KTtqUXVlcnkuZWFjaChbImFqYXhTdGFydCIsImFqYXhTdG9wIiwiYWpheENvbXBsZXRlIiwiYWpheEVycm9yIiwiYWpheFN1Y2Nlc3MiLCJhamF4U2VuZCJdLGZ1bmN0aW9uKGksdHlwZSl7alF1ZXJ5LmZuW3R5cGVdPWZ1bmN0aW9uKGZuKXtyZXR1cm4gdGhpcy5vbih0eXBlLGZuKTt9O30pO2pRdWVyeS5fZXZhbFVybD1mdW5jdGlvbih1cmwpe3JldHVybiBqUXVlcnkuYWpheCh7dXJsOnVybCx0eXBlOiJHRVQiLGRhdGFUeXBlOiJzY3JpcHQiLGFzeW5jOmZhbHNlLGdsb2JhbDpmYWxzZSwidGhyb3dzIjp0cnVlfSk7fTtqUXVlcnkuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGh0bWwpe2lmKGpRdWVyeS5pc0Z1bmN0aW9uKGh0bWwpKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGkpe2pRdWVyeSh0aGlzKS53cmFwQWxsKGh0bWwuY2FsbCh0aGlzLGkpKTt9KTt9CmlmKHRoaXNbMF0pe3ZhciB3cmFwPWpRdWVyeShodG1sLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUodHJ1ZSk7aWYodGhpc1swXS5wYXJlbnROb2RlKXt3cmFwLmluc2VydEJlZm9yZSh0aGlzWzBdKTt9CndyYXAubWFwKGZ1bmN0aW9uKCl7dmFyIGVsZW09dGhpczt3aGlsZShlbGVtLmZpcnN0Q2hpbGQmJmVsZW0uZmlyc3RDaGlsZC5ub2RlVHlwZT09PTEpe2VsZW09ZWxlbS5maXJzdENoaWxkO30KcmV0dXJuIGVsZW07fSkuYXBwZW5kKHRoaXMpO30KcmV0dXJuIHRoaXM7fSx3cmFwSW5uZXI6ZnVuY3Rpb24oaHRtbCl7aWYoalF1ZXJ5LmlzRnVuY3Rpb24oaHRtbCkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSl7alF1ZXJ5KHRoaXMpLndyYXBJbm5lcihodG1sLmNhbGwodGhpcyxpKSk7fSk7fQpyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHNlbGY9alF1ZXJ5KHRoaXMpLGNvbnRlbnRzPXNlbGYuY29udGVudHMoKTtpZihjb250ZW50cy5sZW5ndGgpe2NvbnRlbnRzLndyYXBBbGwoaHRtbCk7fWVsc2V7c2VsZi5hcHBlbmQoaHRtbCk7fX0pO30sd3JhcDpmdW5jdGlvbihodG1sKXt2YXIgaXNGdW5jdGlvbj1qUXVlcnkuaXNGdW5jdGlvbihodG1sKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGkpe2pRdWVyeSh0aGlzKS53cmFwQWxsKGlzRnVuY3Rpb24/aHRtbC5jYWxsKHRoaXMsaSk6aHRtbCk7fSk7fSx1bndyYXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQoKS5lYWNoKGZ1bmN0aW9uKCl7aWYoIWpRdWVyeS5ub2RlTmFtZSh0aGlzLCJib2R5Iikpe2pRdWVyeSh0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpO319KS5lbmQoKTt9fSk7alF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW49ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGVsZW0ub2Zmc2V0V2lkdGg8PTAmJmVsZW0ub2Zmc2V0SGVpZ2h0PD0wfHwoIXN1cHBvcnQucmVsaWFibGVIaWRkZW5PZmZzZXRzKCkmJigoZWxlbS5zdHlsZSYmZWxlbS5zdHlsZS5kaXNwbGF5KXx8alF1ZXJ5LmNzcyhlbGVtLCJkaXNwbGF5IikpPT09Im5vbmUiKTt9O2pRdWVyeS5leHByLmZpbHRlcnMudmlzaWJsZT1mdW5jdGlvbihlbGVtKXtyZXR1cm4halF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4oZWxlbSk7fTt2YXIgcjIwPS8lMjAvZyxyYnJhY2tldD0vXFtcXSQvLHJDUkxGPS9ccj9cbi9nLHJzdWJtaXR0ZXJUeXBlcz0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2kscnN1Ym1pdHRhYmxlPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTtmdW5jdGlvbiBidWlsZFBhcmFtcyhwcmVmaXgsb2JqLHRyYWRpdGlvbmFsLGFkZCl7dmFyIG5hbWU7aWYoalF1ZXJ5LmlzQXJyYXkob2JqKSl7alF1ZXJ5LmVhY2gob2JqLGZ1bmN0aW9uKGksdil7aWYodHJhZGl0aW9uYWx8fHJicmFja2V0LnRlc3QocHJlZml4KSl7YWRkKHByZWZpeCx2KTt9ZWxzZXtidWlsZFBhcmFtcyhwcmVmaXgrIlsiKyh0eXBlb2Ygdj09PSJvYmplY3QiP2k6IiIpKyJdIix2LHRyYWRpdGlvbmFsLGFkZCk7fX0pO31lbHNlIGlmKCF0cmFkaXRpb25hbCYmalF1ZXJ5LnR5cGUob2JqKT09PSJvYmplY3QiKXtmb3IobmFtZSBpbiBvYmope2J1aWxkUGFyYW1zKHByZWZpeCsiWyIrbmFtZSsiXSIsb2JqW25hbWVdLHRyYWRpdGlvbmFsLGFkZCk7fX1lbHNle2FkZChwcmVmaXgsb2JqKTt9fQpqUXVlcnkucGFyYW09ZnVuY3Rpb24oYSx0cmFkaXRpb25hbCl7dmFyIHByZWZpeCxzPVtdLGFkZD1mdW5jdGlvbihrZXksdmFsdWUpe3ZhbHVlPWpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKT92YWx1ZSgpOih2YWx1ZT09bnVsbD8iIjp2YWx1ZSk7c1tzLmxlbmd0aF09ZW5jb2RlVVJJQ29tcG9uZW50KGtleSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7fTtpZih0cmFkaXRpb25hbD09PXVuZGVmaW5lZCl7dHJhZGl0aW9uYWw9alF1ZXJ5LmFqYXhTZXR0aW5ncyYmalF1ZXJ5LmFqYXhTZXR0aW5ncy50cmFkaXRpb25hbDt9CmlmKGpRdWVyeS5pc0FycmF5KGEpfHwoYS5qcXVlcnkmJiFqUXVlcnkuaXNQbGFpbk9iamVjdChhKSkpe2pRdWVyeS5lYWNoKGEsZnVuY3Rpb24oKXthZGQodGhpcy5uYW1lLHRoaXMudmFsdWUpO30pO31lbHNle2ZvcihwcmVmaXggaW4gYSl7YnVpbGRQYXJhbXMocHJlZml4LGFbcHJlZml4XSx0cmFkaXRpb25hbCxhZGQpO319CnJldHVybiBzLmpvaW4oIiYiKS5yZXBsYWNlKHIyMCwiKyIpO307alF1ZXJ5LmZuLmV4dGVuZCh7c2VyaWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIGpRdWVyeS5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpO30sc2VyaWFsaXplQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgZWxlbWVudHM9alF1ZXJ5LnByb3AodGhpcywiZWxlbWVudHMiKTtyZXR1cm4gZWxlbWVudHM/alF1ZXJ5Lm1ha2VBcnJheShlbGVtZW50cyk6dGhpczt9KS5maWx0ZXIoZnVuY3Rpb24oKXt2YXIgdHlwZT10aGlzLnR5cGU7cmV0dXJuIHRoaXMubmFtZSYmIWpRdWVyeSh0aGlzKS5pcygiOmRpc2FibGVkIikmJnJzdWJtaXR0YWJsZS50ZXN0KHRoaXMubm9kZU5hbWUpJiYhcnN1Ym1pdHRlclR5cGVzLnRlc3QodHlwZSkmJih0aGlzLmNoZWNrZWR8fCFyY2hlY2thYmxlVHlwZS50ZXN0KHR5cGUpKTt9KS5tYXAoZnVuY3Rpb24oaSxlbGVtKXt2YXIgdmFsPWpRdWVyeSh0aGlzKS52YWwoKTtyZXR1cm4gdmFsPT1udWxsP251bGw6alF1ZXJ5LmlzQXJyYXkodmFsKT9qUXVlcnkubWFwKHZhbCxmdW5jdGlvbih2YWwpe3JldHVybntuYW1lOmVsZW0ubmFtZSx2YWx1ZTp2YWwucmVwbGFjZShyQ1JMRiwiXHJcbiIpfTt9KTp7bmFtZTplbGVtLm5hbWUsdmFsdWU6dmFsLnJlcGxhY2UockNSTEYsIlxyXG4iKX07fSkuZ2V0KCk7fX0pO2pRdWVyeS5hamF4U2V0dGluZ3MueGhyPXdpbmRvdy5BY3RpdmVYT2JqZWN0IT09dW5kZWZpbmVkP2Z1bmN0aW9uKCl7cmV0dXJuIXRoaXMuaXNMb2NhbCYmL14oZ2V0fHBvc3R8aGVhZHxwdXR8ZGVsZXRlfG9wdGlvbnMpJC9pLnRlc3QodGhpcy50eXBlKSYmY3JlYXRlU3RhbmRhcmRYSFIoKXx8Y3JlYXRlQWN0aXZlWEhSKCk7fTpjcmVhdGVTdGFuZGFyZFhIUjt2YXIgeGhySWQ9MCx4aHJDYWxsYmFja3M9e30seGhyU3VwcG9ydGVkPWpRdWVyeS5hamF4U2V0dGluZ3MueGhyKCk7aWYod2luZG93LkFjdGl2ZVhPYmplY3Qpe2pRdWVyeSh3aW5kb3cpLm9uKCJ1bmxvYWQiLGZ1bmN0aW9uKCl7Zm9yKHZhciBrZXkgaW4geGhyQ2FsbGJhY2tzKXt4aHJDYWxsYmFja3Nba2V5XSh1bmRlZmluZWQsdHJ1ZSk7fX0pO30Kc3VwcG9ydC5jb3JzPSEheGhyU3VwcG9ydGVkJiYoIndpdGhDcmVkZW50aWFscyJpbiB4aHJTdXBwb3J0ZWQpO3hoclN1cHBvcnRlZD1zdXBwb3J0LmFqYXg9ISF4aHJTdXBwb3J0ZWQ7aWYoeGhyU3VwcG9ydGVkKXtqUXVlcnkuYWpheFRyYW5zcG9ydChmdW5jdGlvbihvcHRpb25zKXtpZighb3B0aW9ucy5jcm9zc0RvbWFpbnx8c3VwcG9ydC5jb3JzKXt2YXIgY2FsbGJhY2s7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oaGVhZGVycyxjb21wbGV0ZSl7dmFyIGkseGhyPW9wdGlvbnMueGhyKCksaWQ9Kyt4aHJJZDt4aHIub3BlbihvcHRpb25zLnR5cGUsb3B0aW9ucy51cmwsb3B0aW9ucy5hc3luYyxvcHRpb25zLnVzZXJuYW1lLG9wdGlvbnMucGFzc3dvcmQpO2lmKG9wdGlvbnMueGhyRmllbGRzKXtmb3IoaSBpbiBvcHRpb25zLnhockZpZWxkcyl7eGhyW2ldPW9wdGlvbnMueGhyRmllbGRzW2ldO319CmlmKG9wdGlvbnMubWltZVR5cGUmJnhoci5vdmVycmlkZU1pbWVUeXBlKXt4aHIub3ZlcnJpZGVNaW1lVHlwZShvcHRpb25zLm1pbWVUeXBlKTt9CmlmKCFvcHRpb25zLmNyb3NzRG9tYWluJiYhaGVhZGVyc1siWC1SZXF1ZXN0ZWQtV2l0aCJdKXtoZWFkZXJzWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0Ijt9CmZvcihpIGluIGhlYWRlcnMpe2lmKGhlYWRlcnNbaV0hPT11bmRlZmluZWQpe3hoci5zZXRSZXF1ZXN0SGVhZGVyKGksaGVhZGVyc1tpXSsiIik7fX0KeGhyLnNlbmQoKG9wdGlvbnMuaGFzQ29udGVudCYmb3B0aW9ucy5kYXRhKXx8bnVsbCk7Y2FsbGJhY2s9ZnVuY3Rpb24oXyxpc0Fib3J0KXt2YXIgc3RhdHVzLHN0YXR1c1RleHQscmVzcG9uc2VzO2lmKGNhbGxiYWNrJiYoaXNBYm9ydHx8eGhyLnJlYWR5U3RhdGU9PT00KSl7ZGVsZXRlIHhockNhbGxiYWNrc1tpZF07Y2FsbGJhY2s9dW5kZWZpbmVkO3hoci5vbnJlYWR5c3RhdGVjaGFuZ2U9alF1ZXJ5Lm5vb3A7aWYoaXNBYm9ydCl7aWYoeGhyLnJlYWR5U3RhdGUhPT00KXt4aHIuYWJvcnQoKTt9fWVsc2V7cmVzcG9uc2VzPXt9O3N0YXR1cz14aHIuc3RhdHVzO2lmKHR5cGVvZiB4aHIucmVzcG9uc2VUZXh0PT09InN0cmluZyIpe3Jlc3BvbnNlcy50ZXh0PXhoci5yZXNwb25zZVRleHQ7fQp0cnl7c3RhdHVzVGV4dD14aHIuc3RhdHVzVGV4dDt9Y2F0Y2goZSl7c3RhdHVzVGV4dD0iIjt9CmlmKCFzdGF0dXMmJm9wdGlvbnMuaXNMb2NhbCYmIW9wdGlvbnMuY3Jvc3NEb21haW4pe3N0YXR1cz1yZXNwb25zZXMudGV4dD8yMDA6NDA0O31lbHNlIGlmKHN0YXR1cz09PTEyMjMpe3N0YXR1cz0yMDQ7fX19CmlmKHJlc3BvbnNlcyl7Y29tcGxldGUoc3RhdHVzLHN0YXR1c1RleHQscmVzcG9uc2VzLHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSk7fX07aWYoIW9wdGlvbnMuYXN5bmMpe2NhbGxiYWNrKCk7fWVsc2UgaWYoeGhyLnJlYWR5U3RhdGU9PT00KXtzZXRUaW1lb3V0KGNhbGxiYWNrKTt9ZWxzZXt4aHIub25yZWFkeXN0YXRlY2hhbmdlPXhockNhbGxiYWNrc1tpZF09Y2FsbGJhY2s7fX0sYWJvcnQ6ZnVuY3Rpb24oKXtpZihjYWxsYmFjayl7Y2FsbGJhY2sodW5kZWZpbmVkLHRydWUpO319fTt9fSk7fQpmdW5jdGlvbiBjcmVhdGVTdGFuZGFyZFhIUigpe3RyeXtyZXR1cm4gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCgpO31jYXRjaChlKXt9fQpmdW5jdGlvbiBjcmVhdGVBY3RpdmVYSFIoKXt0cnl7cmV0dXJuIG5ldyB3aW5kb3cuQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKTt9Y2F0Y2goZSl7fX0KalF1ZXJ5LmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6Lyg/OmphdmF8ZWNtYSlzY3JpcHQvfSxjb252ZXJ0ZXJzOnsidGV4dCBzY3JpcHQiOmZ1bmN0aW9uKHRleHQpe2pRdWVyeS5nbG9iYWxFdmFsKHRleHQpO3JldHVybiB0ZXh0O319fSk7alF1ZXJ5LmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsZnVuY3Rpb24ocyl7aWYocy5jYWNoZT09PXVuZGVmaW5lZCl7cy5jYWNoZT1mYWxzZTt9CmlmKHMuY3Jvc3NEb21haW4pe3MudHlwZT0iR0VUIjtzLmdsb2JhbD1mYWxzZTt9fSk7alF1ZXJ5LmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24ocyl7aWYocy5jcm9zc0RvbWFpbil7dmFyIHNjcmlwdCxoZWFkPWRvY3VtZW50LmhlYWR8fGpRdWVyeSgiaGVhZCIpWzBdfHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oXyxjYWxsYmFjayl7c2NyaXB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO3NjcmlwdC5hc3luYz10cnVlO2lmKHMuc2NyaXB0Q2hhcnNldCl7c2NyaXB0LmNoYXJzZXQ9cy5zY3JpcHRDaGFyc2V0O30Kc2NyaXB0LnNyYz1zLnVybDtzY3JpcHQub25sb2FkPXNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oXyxpc0Fib3J0KXtpZihpc0Fib3J0fHwhc2NyaXB0LnJlYWR5U3RhdGV8fC9sb2FkZWR8Y29tcGxldGUvLnRlc3Qoc2NyaXB0LnJlYWR5U3RhdGUpKXtzY3JpcHQub25sb2FkPXNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDtpZihzY3JpcHQucGFyZW50Tm9kZSl7c2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0KTt9CnNjcmlwdD1udWxsO2lmKCFpc0Fib3J0KXtjYWxsYmFjaygyMDAsInN1Y2Nlc3MiKTt9fX07aGVhZC5pbnNlcnRCZWZvcmUoc2NyaXB0LGhlYWQuZmlyc3RDaGlsZCk7fSxhYm9ydDpmdW5jdGlvbigpe2lmKHNjcmlwdCl7c2NyaXB0Lm9ubG9hZCh1bmRlZmluZWQsdHJ1ZSk7fX19O319KTt2YXIgb2xkQ2FsbGJhY2tzPVtdLHJqc29ucD0vKD0pXD8oPz0mfCQpfFw/XD8vO2pRdWVyeS5hamF4U2V0dXAoe2pzb25wOiJjYWxsYmFjayIsanNvbnBDYWxsYmFjazpmdW5jdGlvbigpe3ZhciBjYWxsYmFjaz1vbGRDYWxsYmFja3MucG9wKCl8fChqUXVlcnkuZXhwYW5kbysiXyIrKG5vbmNlKyspKTt0aGlzW2NhbGxiYWNrXT10cnVlO3JldHVybiBjYWxsYmFjazt9fSk7alF1ZXJ5LmFqYXhQcmVmaWx0ZXIoImpzb24ganNvbnAiLGZ1bmN0aW9uKHMsb3JpZ2luYWxTZXR0aW5ncyxqcVhIUil7dmFyIGNhbGxiYWNrTmFtZSxvdmVyd3JpdHRlbixyZXNwb25zZUNvbnRhaW5lcixqc29uUHJvcD1zLmpzb25wIT09ZmFsc2UmJihyanNvbnAudGVzdChzLnVybCk/InVybCI6dHlwZW9mIHMuZGF0YT09PSJzdHJpbmciJiYhKHMuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmcmpzb25wLnRlc3Qocy5kYXRhKSYmImRhdGEiKTtpZihqc29uUHJvcHx8cy5kYXRhVHlwZXNbMF09PT0ianNvbnAiKXtjYWxsYmFja05hbWU9cy5qc29ucENhbGxiYWNrPWpRdWVyeS5pc0Z1bmN0aW9uKHMuanNvbnBDYWxsYmFjayk/cy5qc29ucENhbGxiYWNrKCk6cy5qc29ucENhbGxiYWNrO2lmKGpzb25Qcm9wKXtzW2pzb25Qcm9wXT1zW2pzb25Qcm9wXS5yZXBsYWNlKHJqc29ucCwiJDEiK2NhbGxiYWNrTmFtZSk7fWVsc2UgaWYocy5qc29ucCE9PWZhbHNlKXtzLnVybCs9KHJxdWVyeS50ZXN0KHMudXJsKT8iJiI6Ij8iKStzLmpzb25wKyI9IitjYWxsYmFja05hbWU7fQpzLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl09ZnVuY3Rpb24oKXtpZighcmVzcG9uc2VDb250YWluZXIpe2pRdWVyeS5lcnJvcihjYWxsYmFja05hbWUrIiB3YXMgbm90IGNhbGxlZCIpO30KcmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWzBdO307cy5kYXRhVHlwZXNbMF09Impzb24iO292ZXJ3cml0dGVuPXdpbmRvd1tjYWxsYmFja05hbWVdO3dpbmRvd1tjYWxsYmFja05hbWVdPWZ1bmN0aW9uKCl7cmVzcG9uc2VDb250YWluZXI9YXJndW1lbnRzO307anFYSFIuYWx3YXlzKGZ1bmN0aW9uKCl7d2luZG93W2NhbGxiYWNrTmFtZV09b3ZlcndyaXR0ZW47aWYoc1tjYWxsYmFja05hbWVdKXtzLmpzb25wQ2FsbGJhY2s9b3JpZ2luYWxTZXR0aW5ncy5qc29ucENhbGxiYWNrO29sZENhbGxiYWNrcy5wdXNoKGNhbGxiYWNrTmFtZSk7fQppZihyZXNwb25zZUNvbnRhaW5lciYmalF1ZXJ5LmlzRnVuY3Rpb24ob3ZlcndyaXR0ZW4pKXtvdmVyd3JpdHRlbihyZXNwb25zZUNvbnRhaW5lclswXSk7fQpyZXNwb25zZUNvbnRhaW5lcj1vdmVyd3JpdHRlbj11bmRlZmluZWQ7fSk7cmV0dXJuInNjcmlwdCI7fX0pO2pRdWVyeS5wYXJzZUhUTUw9ZnVuY3Rpb24oZGF0YSxjb250ZXh0LGtlZXBTY3JpcHRzKXtpZighZGF0YXx8dHlwZW9mIGRhdGEhPT0ic3RyaW5nIil7cmV0dXJuIG51bGw7fQppZih0eXBlb2YgY29udGV4dD09PSJib29sZWFuIil7a2VlcFNjcmlwdHM9Y29udGV4dDtjb250ZXh0PWZhbHNlO30KY29udGV4dD1jb250ZXh0fHxkb2N1bWVudDt2YXIgcGFyc2VkPXJzaW5nbGVUYWcuZXhlYyhkYXRhKSxzY3JpcHRzPSFrZWVwU2NyaXB0cyYmW107aWYocGFyc2VkKXtyZXR1cm5bY29udGV4dC5jcmVhdGVFbGVtZW50KHBhcnNlZFsxXSldO30KcGFyc2VkPWpRdWVyeS5idWlsZEZyYWdtZW50KFtkYXRhXSxjb250ZXh0LHNjcmlwdHMpO2lmKHNjcmlwdHMmJnNjcmlwdHMubGVuZ3RoKXtqUXVlcnkoc2NyaXB0cykucmVtb3ZlKCk7fQpyZXR1cm4galF1ZXJ5Lm1lcmdlKFtdLHBhcnNlZC5jaGlsZE5vZGVzKTt9O3ZhciBfbG9hZD1qUXVlcnkuZm4ubG9hZDtqUXVlcnkuZm4ubG9hZD1mdW5jdGlvbih1cmwscGFyYW1zLGNhbGxiYWNrKXtpZih0eXBlb2YgdXJsIT09InN0cmluZyImJl9sb2FkKXtyZXR1cm4gX2xvYWQuYXBwbHkodGhpcyxhcmd1bWVudHMpO30KdmFyIHNlbGVjdG9yLHJlc3BvbnNlLHR5cGUsc2VsZj10aGlzLG9mZj11cmwuaW5kZXhPZigiICIpO2lmKG9mZj49MCl7c2VsZWN0b3I9dXJsLnNsaWNlKG9mZix1cmwubGVuZ3RoKTt1cmw9dXJsLnNsaWNlKDAsb2ZmKTt9CmlmKGpRdWVyeS5pc0Z1bmN0aW9uKHBhcmFtcykpe2NhbGxiYWNrPXBhcmFtcztwYXJhbXM9dW5kZWZpbmVkO31lbHNlIGlmKHBhcmFtcyYmdHlwZW9mIHBhcmFtcz09PSJvYmplY3QiKXt0eXBlPSJQT1NUIjt9CmlmKHNlbGYubGVuZ3RoPjApe2pRdWVyeS5hamF4KHt1cmw6dXJsLHR5cGU6dHlwZSxkYXRhVHlwZToiaHRtbCIsZGF0YTpwYXJhbXN9KS5kb25lKGZ1bmN0aW9uKHJlc3BvbnNlVGV4dCl7cmVzcG9uc2U9YXJndW1lbnRzO3NlbGYuaHRtbChzZWxlY3Rvcj9qUXVlcnkoIjxkaXY+IikuYXBwZW5kKGpRdWVyeS5wYXJzZUhUTUwocmVzcG9uc2VUZXh0KSkuZmluZChzZWxlY3Rvcik6cmVzcG9uc2VUZXh0KTt9KS5jb21wbGV0ZShjYWxsYmFjayYmZnVuY3Rpb24oanFYSFIsc3RhdHVzKXtzZWxmLmVhY2goY2FsbGJhY2sscmVzcG9uc2V8fFtqcVhIUi5yZXNwb25zZVRleHQsc3RhdHVzLGpxWEhSXSk7fSk7fQpyZXR1cm4gdGhpczt9O2pRdWVyeS5leHByLmZpbHRlcnMuYW5pbWF0ZWQ9ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGpRdWVyeS5ncmVwKGpRdWVyeS50aW1lcnMsZnVuY3Rpb24oZm4pe3JldHVybiBlbGVtPT09Zm4uZWxlbTt9KS5sZW5ndGg7fTt2YXIgZG9jRWxlbT13aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O2Z1bmN0aW9uIGdldFdpbmRvdyhlbGVtKXtyZXR1cm4galF1ZXJ5LmlzV2luZG93KGVsZW0pP2VsZW06ZWxlbS5ub2RlVHlwZT09PTk/ZWxlbS5kZWZhdWx0Vmlld3x8ZWxlbS5wYXJlbnRXaW5kb3c6ZmFsc2U7fQpqUXVlcnkub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oZWxlbSxvcHRpb25zLGkpe3ZhciBjdXJQb3NpdGlvbixjdXJMZWZ0LGN1ckNTU1RvcCxjdXJUb3AsY3VyT2Zmc2V0LGN1ckNTU0xlZnQsY2FsY3VsYXRlUG9zaXRpb24scG9zaXRpb249alF1ZXJ5LmNzcyhlbGVtLCJwb3NpdGlvbiIpLGN1ckVsZW09alF1ZXJ5KGVsZW0pLHByb3BzPXt9O2lmKHBvc2l0aW9uPT09InN0YXRpYyIpe2VsZW0uc3R5bGUucG9zaXRpb249InJlbGF0aXZlIjt9CmN1ck9mZnNldD1jdXJFbGVtLm9mZnNldCgpO2N1ckNTU1RvcD1qUXVlcnkuY3NzKGVsZW0sInRvcCIpO2N1ckNTU0xlZnQ9alF1ZXJ5LmNzcyhlbGVtLCJsZWZ0Iik7Y2FsY3VsYXRlUG9zaXRpb249KHBvc2l0aW9uPT09ImFic29sdXRlInx8cG9zaXRpb249PT0iZml4ZWQiKSYmalF1ZXJ5LmluQXJyYXkoImF1dG8iLFtjdXJDU1NUb3AsY3VyQ1NTTGVmdF0pPi0xO2lmKGNhbGN1bGF0ZVBvc2l0aW9uKXtjdXJQb3NpdGlvbj1jdXJFbGVtLnBvc2l0aW9uKCk7Y3VyVG9wPWN1clBvc2l0aW9uLnRvcDtjdXJMZWZ0PWN1clBvc2l0aW9uLmxlZnQ7fWVsc2V7Y3VyVG9wPXBhcnNlRmxvYXQoY3VyQ1NTVG9wKXx8MDtjdXJMZWZ0PXBhcnNlRmxvYXQoY3VyQ1NTTGVmdCl8fDA7fQppZihqUXVlcnkuaXNGdW5jdGlvbihvcHRpb25zKSl7b3B0aW9ucz1vcHRpb25zLmNhbGwoZWxlbSxpLGN1ck9mZnNldCk7fQppZihvcHRpb25zLnRvcCE9bnVsbCl7cHJvcHMudG9wPShvcHRpb25zLnRvcC1jdXJPZmZzZXQudG9wKStjdXJUb3A7fQppZihvcHRpb25zLmxlZnQhPW51bGwpe3Byb3BzLmxlZnQ9KG9wdGlvbnMubGVmdC1jdXJPZmZzZXQubGVmdCkrY3VyTGVmdDt9CmlmKCJ1c2luZyJpbiBvcHRpb25zKXtvcHRpb25zLnVzaW5nLmNhbGwoZWxlbSxwcm9wcyk7fWVsc2V7Y3VyRWxlbS5jc3MocHJvcHMpO319fTtqUXVlcnkuZm4uZXh0ZW5kKHtvZmZzZXQ6ZnVuY3Rpb24ob3B0aW9ucyl7aWYoYXJndW1lbnRzLmxlbmd0aCl7cmV0dXJuIG9wdGlvbnM9PT11bmRlZmluZWQ/dGhpczp0aGlzLmVhY2goZnVuY3Rpb24oaSl7alF1ZXJ5Lm9mZnNldC5zZXRPZmZzZXQodGhpcyxvcHRpb25zLGkpO30pO30KdmFyIGRvY0VsZW0sd2luLGJveD17dG9wOjAsbGVmdDowfSxlbGVtPXRoaXNbMF0sZG9jPWVsZW0mJmVsZW0ub3duZXJEb2N1bWVudDtpZighZG9jKXtyZXR1cm47fQpkb2NFbGVtPWRvYy5kb2N1bWVudEVsZW1lbnQ7aWYoIWpRdWVyeS5jb250YWlucyhkb2NFbGVtLGVsZW0pKXtyZXR1cm4gYm94O30KaWYodHlwZW9mIGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0IT09c3RydW5kZWZpbmVkKXtib3g9ZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTt9Cndpbj1nZXRXaW5kb3coZG9jKTtyZXR1cm57dG9wOmJveC50b3ArKHdpbi5wYWdlWU9mZnNldHx8ZG9jRWxlbS5zY3JvbGxUb3ApLShkb2NFbGVtLmNsaWVudFRvcHx8MCksbGVmdDpib3gubGVmdCsod2luLnBhZ2VYT2Zmc2V0fHxkb2NFbGVtLnNjcm9sbExlZnQpLShkb2NFbGVtLmNsaWVudExlZnR8fDApfTt9LHBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYoIXRoaXNbMF0pe3JldHVybjt9CnZhciBvZmZzZXRQYXJlbnQsb2Zmc2V0LHBhcmVudE9mZnNldD17dG9wOjAsbGVmdDowfSxlbGVtPXRoaXNbMF07aWYoalF1ZXJ5LmNzcyhlbGVtLCJwb3NpdGlvbiIpPT09ImZpeGVkIil7b2Zmc2V0PWVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7fWVsc2V7b2Zmc2V0UGFyZW50PXRoaXMub2Zmc2V0UGFyZW50KCk7b2Zmc2V0PXRoaXMub2Zmc2V0KCk7aWYoIWpRdWVyeS5ub2RlTmFtZShvZmZzZXRQYXJlbnRbMF0sImh0bWwiKSl7cGFyZW50T2Zmc2V0PW9mZnNldFBhcmVudC5vZmZzZXQoKTt9CnBhcmVudE9mZnNldC50b3ArPWpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50WzBdLCJib3JkZXJUb3BXaWR0aCIsdHJ1ZSk7cGFyZW50T2Zmc2V0LmxlZnQrPWpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50WzBdLCJib3JkZXJMZWZ0V2lkdGgiLHRydWUpO30KcmV0dXJue3RvcDpvZmZzZXQudG9wLXBhcmVudE9mZnNldC50b3AtalF1ZXJ5LmNzcyhlbGVtLCJtYXJnaW5Ub3AiLHRydWUpLGxlZnQ6b2Zmc2V0LmxlZnQtcGFyZW50T2Zmc2V0LmxlZnQtalF1ZXJ5LmNzcyhlbGVtLCJtYXJnaW5MZWZ0Iix0cnVlKX07fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgb2Zmc2V0UGFyZW50PXRoaXMub2Zmc2V0UGFyZW50fHxkb2NFbGVtO3doaWxlKG9mZnNldFBhcmVudCYmKCFqUXVlcnkubm9kZU5hbWUob2Zmc2V0UGFyZW50LCJodG1sIikmJmpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50LCJwb3NpdGlvbiIpPT09InN0YXRpYyIpKXtvZmZzZXRQYXJlbnQ9b2Zmc2V0UGFyZW50Lm9mZnNldFBhcmVudDt9CnJldHVybiBvZmZzZXRQYXJlbnR8fGRvY0VsZW07fSk7fX0pO2pRdWVyeS5lYWNoKHtzY3JvbGxMZWZ0OiJwYWdlWE9mZnNldCIsc2Nyb2xsVG9wOiJwYWdlWU9mZnNldCJ9LGZ1bmN0aW9uKG1ldGhvZCxwcm9wKXt2YXIgdG9wPS9ZLy50ZXN0KHByb3ApO2pRdWVyeS5mblttZXRob2RdPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIGFjY2Vzcyh0aGlzLGZ1bmN0aW9uKGVsZW0sbWV0aG9kLHZhbCl7dmFyIHdpbj1nZXRXaW5kb3coZWxlbSk7aWYodmFsPT09dW5kZWZpbmVkKXtyZXR1cm4gd2luPyhwcm9wIGluIHdpbik/d2luW3Byb3BdOndpbi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbbWV0aG9kXTplbGVtW21ldGhvZF07fQppZih3aW4pe3dpbi5zY3JvbGxUbyghdG9wP3ZhbDpqUXVlcnkod2luKS5zY3JvbGxMZWZ0KCksdG9wP3ZhbDpqUXVlcnkod2luKS5zY3JvbGxUb3AoKSk7fWVsc2V7ZWxlbVttZXRob2RdPXZhbDt9fSxtZXRob2QsdmFsLGFyZ3VtZW50cy5sZW5ndGgsbnVsbCk7fTt9KTtqUXVlcnkuZWFjaChbInRvcCIsImxlZnQiXSxmdW5jdGlvbihpLHByb3Ape2pRdWVyeS5jc3NIb29rc1twcm9wXT1hZGRHZXRIb29rSWYoc3VwcG9ydC5waXhlbFBvc2l0aW9uLGZ1bmN0aW9uKGVsZW0sY29tcHV0ZWQpe2lmKGNvbXB1dGVkKXtjb21wdXRlZD1jdXJDU1MoZWxlbSxwcm9wKTtyZXR1cm4gcm51bW5vbnB4LnRlc3QoY29tcHV0ZWQpP2pRdWVyeShlbGVtKS5wb3NpdGlvbigpW3Byb3BdKyJweCI6Y29tcHV0ZWQ7fX0pO30pO2pRdWVyeS5lYWNoKHtIZWlnaHQ6ImhlaWdodCIsV2lkdGg6IndpZHRoIn0sZnVuY3Rpb24obmFtZSx0eXBlKXtqUXVlcnkuZWFjaCh7cGFkZGluZzoiaW5uZXIiK25hbWUsY29udGVudDp0eXBlLCIiOiJvdXRlciIrbmFtZX0sZnVuY3Rpb24oZGVmYXVsdEV4dHJhLGZ1bmNOYW1lKXtqUXVlcnkuZm5bZnVuY05hbWVdPWZ1bmN0aW9uKG1hcmdpbix2YWx1ZSl7dmFyIGNoYWluYWJsZT1hcmd1bWVudHMubGVuZ3RoJiYoZGVmYXVsdEV4dHJhfHx0eXBlb2YgbWFyZ2luIT09ImJvb2xlYW4iKSxleHRyYT1kZWZhdWx0RXh0cmF8fChtYXJnaW49PT10cnVlfHx2YWx1ZT09PXRydWU/Im1hcmdpbiI6ImJvcmRlciIpO3JldHVybiBhY2Nlc3ModGhpcyxmdW5jdGlvbihlbGVtLHR5cGUsdmFsdWUpe3ZhciBkb2M7aWYoalF1ZXJ5LmlzV2luZG93KGVsZW0pKXtyZXR1cm4gZWxlbS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrbmFtZV07fQppZihlbGVtLm5vZGVUeXBlPT09OSl7ZG9jPWVsZW0uZG9jdW1lbnRFbGVtZW50O3JldHVybiBNYXRoLm1heChlbGVtLmJvZHlbInNjcm9sbCIrbmFtZV0sZG9jWyJzY3JvbGwiK25hbWVdLGVsZW0uYm9keVsib2Zmc2V0IituYW1lXSxkb2NbIm9mZnNldCIrbmFtZV0sZG9jWyJjbGllbnQiK25hbWVdKTt9CnJldHVybiB2YWx1ZT09PXVuZGVmaW5lZD9qUXVlcnkuY3NzKGVsZW0sdHlwZSxleHRyYSk6alF1ZXJ5LnN0eWxlKGVsZW0sdHlwZSx2YWx1ZSxleHRyYSk7fSx0eXBlLGNoYWluYWJsZT9tYXJnaW46dW5kZWZpbmVkLGNoYWluYWJsZSxudWxsKTt9O30pO30pO2pRdWVyeS5mbi5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RoO307alF1ZXJ5LmZuLmFuZFNlbGY9alF1ZXJ5LmZuLmFkZEJhY2s7aWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZSgianF1ZXJ5IixbXSxmdW5jdGlvbigpe3JldHVybiBqUXVlcnk7fSk7fQp2YXIKX2pRdWVyeT13aW5kb3cualF1ZXJ5LF8kPXdpbmRvdy4kO2pRdWVyeS5ub0NvbmZsaWN0PWZ1bmN0aW9uKGRlZXApe2lmKHdpbmRvdy4kPT09alF1ZXJ5KXt3aW5kb3cuJD1fJDt9CmlmKGRlZXAmJndpbmRvdy5qUXVlcnk9PT1qUXVlcnkpe3dpbmRvdy5qUXVlcnk9X2pRdWVyeTt9CnJldHVybiBqUXVlcnk7fTtpZih0eXBlb2Ygbm9HbG9iYWw9PT1zdHJ1bmRlZmluZWQpe3dpbmRvdy5qUXVlcnk9d2luZG93LiQ9alF1ZXJ5O30KcmV0dXJuIGpRdWVyeTt9KSk7KGZ1bmN0aW9uKCQsdW5kZWZpbmVkKXt2YXIgdXVpZD0wLHJ1bmlxdWVJZD0vXnVpLWlkLVxkKyQvOyQudWk9JC51aXx8e307JC5leHRlbmQoJC51aSx7dmVyc2lvbjoiMS4xMC40IixrZXlDb2RlOntCQUNLU1BBQ0U6OCxDT01NQToxODgsREVMRVRFOjQ2LERPV046NDAsRU5EOjM1LEVOVEVSOjEzLEVTQ0FQRToyNyxIT01FOjM2LExFRlQ6MzcsTlVNUEFEX0FERDoxMDcsTlVNUEFEX0RFQ0lNQUw6MTEwLE5VTVBBRF9ESVZJREU6MTExLE5VTVBBRF9FTlRFUjoxMDgsTlVNUEFEX01VTFRJUExZOjEwNixOVU1QQURfU1VCVFJBQ1Q6MTA5LFBBR0VfRE9XTjozNCxQQUdFX1VQOjMzLFBFUklPRDoxOTAsUklHSFQ6MzksU1BBQ0U6MzIsVEFCOjksVVA6Mzh9fSk7JC5mbi5leHRlbmQoe2ZvY3VzOihmdW5jdGlvbihvcmlnKXtyZXR1cm4gZnVuY3Rpb24oZGVsYXksZm4pe3JldHVybiB0eXBlb2YgZGVsYXk9PT0ibnVtYmVyIj90aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgZWxlbT10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXskKGVsZW0pLmZvY3VzKCk7aWYoZm4pe2ZuLmNhbGwoZWxlbSk7fX0sZGVsYXkpO30pOm9yaWcuYXBwbHkodGhpcyxhcmd1bWVudHMpO307fSkoJC5mbi5mb2N1cyksc2Nyb2xsUGFyZW50OmZ1bmN0aW9uKCl7dmFyIHNjcm9sbFBhcmVudDtpZigoJC51aS5pZSYmKC8oc3RhdGljfHJlbGF0aXZlKS8pLnRlc3QodGhpcy5jc3MoInBvc2l0aW9uIikpKXx8KC9hYnNvbHV0ZS8pLnRlc3QodGhpcy5jc3MoInBvc2l0aW9uIikpKXtzY3JvbGxQYXJlbnQ9dGhpcy5wYXJlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuKC8ocmVsYXRpdmV8YWJzb2x1dGV8Zml4ZWQpLykudGVzdCgkLmNzcyh0aGlzLCJwb3NpdGlvbiIpKSYmKC8oYXV0b3xzY3JvbGwpLykudGVzdCgkLmNzcyh0aGlzLCJvdmVyZmxvdyIpKyQuY3NzKHRoaXMsIm92ZXJmbG93LXkiKSskLmNzcyh0aGlzLCJvdmVyZmxvdy14IikpO30pLmVxKDApO31lbHNle3Njcm9sbFBhcmVudD10aGlzLnBhcmVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4oLyhhdXRvfHNjcm9sbCkvKS50ZXN0KCQuY3NzKHRoaXMsIm92ZXJmbG93IikrJC5jc3ModGhpcywib3ZlcmZsb3cteSIpKyQuY3NzKHRoaXMsIm92ZXJmbG93LXgiKSk7fSkuZXEoMCk7fQpyZXR1cm4oL2ZpeGVkLykudGVzdCh0aGlzLmNzcygicG9zaXRpb24iKSl8fCFzY3JvbGxQYXJlbnQubGVuZ3RoPyQoZG9jdW1lbnQpOnNjcm9sbFBhcmVudDt9LHpJbmRleDpmdW5jdGlvbih6SW5kZXgpe2lmKHpJbmRleCE9PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuY3NzKCJ6SW5kZXgiLHpJbmRleCk7fQppZih0aGlzLmxlbmd0aCl7dmFyIGVsZW09JCh0aGlzWzBdKSxwb3NpdGlvbix2YWx1ZTt3aGlsZShlbGVtLmxlbmd0aCYmZWxlbVswXSE9PWRvY3VtZW50KXtwb3NpdGlvbj1lbGVtLmNzcygicG9zaXRpb24iKTtpZihwb3NpdGlvbj09PSJhYnNvbHV0ZSJ8fHBvc2l0aW9uPT09InJlbGF0aXZlInx8cG9zaXRpb249PT0iZml4ZWQiKXt2YWx1ZT1wYXJzZUludChlbGVtLmNzcygiekluZGV4IiksMTApO2lmKCFpc05hTih2YWx1ZSkmJnZhbHVlIT09MCl7cmV0dXJuIHZhbHVlO319CmVsZW09ZWxlbS5wYXJlbnQoKTt9fQpyZXR1cm4gMDt9LHVuaXF1ZUlkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKCF0aGlzLmlkKXt0aGlzLmlkPSJ1aS1pZC0iKygrK3V1aWQpO319KTt9LHJlbW92ZVVuaXF1ZUlkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKHJ1bmlxdWVJZC50ZXN0KHRoaXMuaWQpKXskKHRoaXMpLnJlbW92ZUF0dHIoImlkIik7fX0pO319KTtmdW5jdGlvbiBmb2N1c2FibGUoZWxlbWVudCxpc1RhYkluZGV4Tm90TmFOKXt2YXIgbWFwLG1hcE5hbWUsaW1nLG5vZGVOYW1lPWVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtpZigiYXJlYSI9PT1ub2RlTmFtZSl7bWFwPWVsZW1lbnQucGFyZW50Tm9kZTttYXBOYW1lPW1hcC5uYW1lO2lmKCFlbGVtZW50LmhyZWZ8fCFtYXBOYW1lfHxtYXAubm9kZU5hbWUudG9Mb3dlckNhc2UoKSE9PSJtYXAiKXtyZXR1cm4gZmFsc2U7fQppbWc9JCgiaW1nW3VzZW1hcD0jIittYXBOYW1lKyJdIilbMF07cmV0dXJuISFpbWcmJnZpc2libGUoaW1nKTt9CnJldHVybigvaW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbnxvYmplY3QvLnRlc3Qobm9kZU5hbWUpPyFlbGVtZW50LmRpc2FibGVkOiJhIj09PW5vZGVOYW1lP2VsZW1lbnQuaHJlZnx8aXNUYWJJbmRleE5vdE5hTjppc1RhYkluZGV4Tm90TmFOKSYmdmlzaWJsZShlbGVtZW50KTt9CmZ1bmN0aW9uIHZpc2libGUoZWxlbWVudCl7cmV0dXJuICQuZXhwci5maWx0ZXJzLnZpc2libGUoZWxlbWVudCkmJiEkKGVsZW1lbnQpLnBhcmVudHMoKS5hZGRCYWNrKCkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuICQuY3NzKHRoaXMsInZpc2liaWxpdHkiKT09PSJoaWRkZW4iO30pLmxlbmd0aDt9CiQuZXh0ZW5kKCQuZXhwclsiOiJdLHtkYXRhOiQuZXhwci5jcmVhdGVQc2V1ZG8/JC5leHByLmNyZWF0ZVBzZXVkbyhmdW5jdGlvbihkYXRhTmFtZSl7cmV0dXJuIGZ1bmN0aW9uKGVsZW0pe3JldHVybiEhJC5kYXRhKGVsZW0sZGF0YU5hbWUpO307fSk6ZnVuY3Rpb24oZWxlbSxpLG1hdGNoKXtyZXR1cm4hISQuZGF0YShlbGVtLG1hdGNoWzNdKTt9LGZvY3VzYWJsZTpmdW5jdGlvbihlbGVtZW50KXtyZXR1cm4gZm9jdXNhYmxlKGVsZW1lbnQsIWlzTmFOKCQuYXR0cihlbGVtZW50LCJ0YWJpbmRleCIpKSk7fSx0YWJiYWJsZTpmdW5jdGlvbihlbGVtZW50KXt2YXIgdGFiSW5kZXg9JC5hdHRyKGVsZW1lbnQsInRhYmluZGV4IiksaXNUYWJJbmRleE5hTj1pc05hTih0YWJJbmRleCk7cmV0dXJuKGlzVGFiSW5kZXhOYU58fHRhYkluZGV4Pj0wKSYmZm9jdXNhYmxlKGVsZW1lbnQsIWlzVGFiSW5kZXhOYU4pO319KTtpZighJCgiPGE+Iikub3V0ZXJXaWR0aCgxKS5qcXVlcnkpeyQuZWFjaChbIldpZHRoIiwiSGVpZ2h0Il0sZnVuY3Rpb24oaSxuYW1lKXt2YXIgc2lkZT1uYW1lPT09IldpZHRoIj9bIkxlZnQiLCJSaWdodCJdOlsiVG9wIiwiQm90dG9tIl0sdHlwZT1uYW1lLnRvTG93ZXJDYXNlKCksb3JpZz17aW5uZXJXaWR0aDokLmZuLmlubmVyV2lkdGgsaW5uZXJIZWlnaHQ6JC5mbi5pbm5lckhlaWdodCxvdXRlcldpZHRoOiQuZm4ub3V0ZXJXaWR0aCxvdXRlckhlaWdodDokLmZuLm91dGVySGVpZ2h0fTtmdW5jdGlvbiByZWR1Y2UoZWxlbSxzaXplLGJvcmRlcixtYXJnaW4peyQuZWFjaChzaWRlLGZ1bmN0aW9uKCl7c2l6ZS09cGFyc2VGbG9hdCgkLmNzcyhlbGVtLCJwYWRkaW5nIit0aGlzKSl8fDA7aWYoYm9yZGVyKXtzaXplLT1wYXJzZUZsb2F0KCQuY3NzKGVsZW0sImJvcmRlciIrdGhpcysiV2lkdGgiKSl8fDA7fQppZihtYXJnaW4pe3NpemUtPXBhcnNlRmxvYXQoJC5jc3MoZWxlbSwibWFyZ2luIit0aGlzKSl8fDA7fX0pO3JldHVybiBzaXplO30KJC5mblsiaW5uZXIiK25hbWVdPWZ1bmN0aW9uKHNpemUpe2lmKHNpemU9PT11bmRlZmluZWQpe3JldHVybiBvcmlnWyJpbm5lciIrbmFtZV0uY2FsbCh0aGlzKTt9CnJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXskKHRoaXMpLmNzcyh0eXBlLHJlZHVjZSh0aGlzLHNpemUpKyJweCIpO30pO307JC5mblsib3V0ZXIiK25hbWVdPWZ1bmN0aW9uKHNpemUsbWFyZ2luKXtpZih0eXBlb2Ygc2l6ZSE9PSJudW1iZXIiKXtyZXR1cm4gb3JpZ1sib3V0ZXIiK25hbWVdLmNhbGwodGhpcyxzaXplKTt9CnJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXskKHRoaXMpLmNzcyh0eXBlLHJlZHVjZSh0aGlzLHNpemUsdHJ1ZSxtYXJnaW4pKyJweCIpO30pO307fSk7fQppZighJC5mbi5hZGRCYWNrKXskLmZuLmFkZEJhY2s9ZnVuY3Rpb24oc2VsZWN0b3Ipe3JldHVybiB0aGlzLmFkZChzZWxlY3Rvcj09bnVsbD90aGlzLnByZXZPYmplY3Q6dGhpcy5wcmV2T2JqZWN0LmZpbHRlcihzZWxlY3RvcikpO307fQppZigkKCI8YT4iKS5kYXRhKCJhLWIiLCJhIikucmVtb3ZlRGF0YSgiYS1iIikuZGF0YSgiYS1iIikpeyQuZm4ucmVtb3ZlRGF0YT0oZnVuY3Rpb24ocmVtb3ZlRGF0YSl7cmV0dXJuIGZ1bmN0aW9uKGtleSl7aWYoYXJndW1lbnRzLmxlbmd0aCl7cmV0dXJuIHJlbW92ZURhdGEuY2FsbCh0aGlzLCQuY2FtZWxDYXNlKGtleSkpO31lbHNle3JldHVybiByZW1vdmVEYXRhLmNhbGwodGhpcyk7fX07fSkoJC5mbi5yZW1vdmVEYXRhKTt9CiQudWkuaWU9ISEvbXNpZSBbXHcuXSsvLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKTskLnN1cHBvcnQuc2VsZWN0c3RhcnQ9Im9uc2VsZWN0c3RhcnQiaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7JC5mbi5leHRlbmQoe2Rpc2FibGVTZWxlY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iaW5kKCgkLnN1cHBvcnQuc2VsZWN0c3RhcnQ/InNlbGVjdHN0YXJ0IjoibW91c2Vkb3duIikrIi51aS1kaXNhYmxlU2VsZWN0aW9uIixmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9KTt9LGVuYWJsZVNlbGVjdGlvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnVuYmluZCgiLnVpLWRpc2FibGVTZWxlY3Rpb24iKTt9fSk7JC5leHRlbmQoJC51aSx7cGx1Z2luOnthZGQ6ZnVuY3Rpb24obW9kdWxlLG9wdGlvbixzZXQpe3ZhciBpLHByb3RvPSQudWlbbW9kdWxlXS5wcm90b3R5cGU7Zm9yKGkgaW4gc2V0KXtwcm90by5wbHVnaW5zW2ldPXByb3RvLnBsdWdpbnNbaV18fFtdO3Byb3RvLnBsdWdpbnNbaV0ucHVzaChbb3B0aW9uLHNldFtpXV0pO319LGNhbGw6ZnVuY3Rpb24oaW5zdGFuY2UsbmFtZSxhcmdzKXt2YXIgaSxzZXQ9aW5zdGFuY2UucGx1Z2luc1tuYW1lXTtpZighc2V0fHwhaW5zdGFuY2UuZWxlbWVudFswXS5wYXJlbnROb2RlfHxpbnN0YW5jZS5lbGVtZW50WzBdLnBhcmVudE5vZGUubm9kZVR5cGU9PT0xMSl7cmV0dXJuO30KZm9yKGk9MDtpPHNldC5sZW5ndGg7aSsrKXtpZihpbnN0YW5jZS5vcHRpb25zW3NldFtpXVswXV0pe3NldFtpXVsxXS5hcHBseShpbnN0YW5jZS5lbGVtZW50LGFyZ3MpO319fX0saGFzU2Nyb2xsOmZ1bmN0aW9uKGVsLGEpe2lmKCQoZWwpLmNzcygib3ZlcmZsb3ciKT09PSJoaWRkZW4iKXtyZXR1cm4gZmFsc2U7fQp2YXIgc2Nyb2xsPShhJiZhPT09ImxlZnQiKT8ic2Nyb2xsTGVmdCI6InNjcm9sbFRvcCIsaGFzPWZhbHNlO2lmKGVsW3Njcm9sbF0+MCl7cmV0dXJuIHRydWU7fQplbFtzY3JvbGxdPTE7aGFzPShlbFtzY3JvbGxdPjApO2VsW3Njcm9sbF09MDtyZXR1cm4gaGFzO319KTt9KShqUXVlcnkpOyhmdW5jdGlvbigkLHVuZGVmaW5lZCl7dmFyIHV1aWQ9MCxzbGljZT1BcnJheS5wcm90b3R5cGUuc2xpY2UsX2NsZWFuRGF0YT0kLmNsZWFuRGF0YTskLmNsZWFuRGF0YT1mdW5jdGlvbihlbGVtcyl7Zm9yKHZhciBpPTAsZWxlbTsoZWxlbT1lbGVtc1tpXSkhPW51bGw7aSsrKXt0cnl7JChlbGVtKS50cmlnZ2VySGFuZGxlcigicmVtb3ZlIik7fWNhdGNoKGUpe319Cl9jbGVhbkRhdGEoZWxlbXMpO307JC53aWRnZXQ9ZnVuY3Rpb24obmFtZSxiYXNlLHByb3RvdHlwZSl7dmFyIGZ1bGxOYW1lLGV4aXN0aW5nQ29uc3RydWN0b3IsY29uc3RydWN0b3IsYmFzZVByb3RvdHlwZSxwcm94aWVkUHJvdG90eXBlPXt9LG5hbWVzcGFjZT1uYW1lLnNwbGl0KCIuIilbMF07bmFtZT1uYW1lLnNwbGl0KCIuIilbMV07ZnVsbE5hbWU9bmFtZXNwYWNlKyItIituYW1lO2lmKCFwcm90b3R5cGUpe3Byb3RvdHlwZT1iYXNlO2Jhc2U9JC5XaWRnZXQ7fQokLmV4cHJbIjoiXVtmdWxsTmFtZS50b0xvd2VyQ2FzZSgpXT1mdW5jdGlvbihlbGVtKXtyZXR1cm4hISQuZGF0YShlbGVtLGZ1bGxOYW1lKTt9OyRbbmFtZXNwYWNlXT0kW25hbWVzcGFjZV18fHt9O2V4aXN0aW5nQ29uc3RydWN0b3I9JFtuYW1lc3BhY2VdW25hbWVdO2NvbnN0cnVjdG9yPSRbbmFtZXNwYWNlXVtuYW1lXT1mdW5jdGlvbihvcHRpb25zLGVsZW1lbnQpe2lmKCF0aGlzLl9jcmVhdGVXaWRnZXQpe3JldHVybiBuZXcgY29uc3RydWN0b3Iob3B0aW9ucyxlbGVtZW50KTt9CmlmKGFyZ3VtZW50cy5sZW5ndGgpe3RoaXMuX2NyZWF0ZVdpZGdldChvcHRpb25zLGVsZW1lbnQpO319OyQuZXh0ZW5kKGNvbnN0cnVjdG9yLGV4aXN0aW5nQ29uc3RydWN0b3Ise3ZlcnNpb246cHJvdG90eXBlLnZlcnNpb24sX3Byb3RvOiQuZXh0ZW5kKHt9LHByb3RvdHlwZSksX2NoaWxkQ29uc3RydWN0b3JzOltdfSk7YmFzZVByb3RvdHlwZT1uZXcgYmFzZSgpO2Jhc2VQcm90b3R5cGUub3B0aW9ucz0kLndpZGdldC5leHRlbmQoe30sYmFzZVByb3RvdHlwZS5vcHRpb25zKTskLmVhY2gocHJvdG90eXBlLGZ1bmN0aW9uKHByb3AsdmFsdWUpe2lmKCEkLmlzRnVuY3Rpb24odmFsdWUpKXtwcm94aWVkUHJvdG90eXBlW3Byb3BdPXZhbHVlO3JldHVybjt9CnByb3hpZWRQcm90b3R5cGVbcHJvcF09KGZ1bmN0aW9uKCl7dmFyIF9zdXBlcj1mdW5jdGlvbigpe3JldHVybiBiYXNlLnByb3RvdHlwZVtwcm9wXS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfc3VwZXJBcHBseT1mdW5jdGlvbihhcmdzKXtyZXR1cm4gYmFzZS5wcm90b3R5cGVbcHJvcF0uYXBwbHkodGhpcyxhcmdzKTt9O3JldHVybiBmdW5jdGlvbigpe3ZhciBfX3N1cGVyPXRoaXMuX3N1cGVyLF9fc3VwZXJBcHBseT10aGlzLl9zdXBlckFwcGx5LHJldHVyblZhbHVlO3RoaXMuX3N1cGVyPV9zdXBlcjt0aGlzLl9zdXBlckFwcGx5PV9zdXBlckFwcGx5O3JldHVyblZhbHVlPXZhbHVlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9zdXBlcj1fX3N1cGVyO3RoaXMuX3N1cGVyQXBwbHk9X19zdXBlckFwcGx5O3JldHVybiByZXR1cm5WYWx1ZTt9O30pKCk7fSk7Y29uc3RydWN0b3IucHJvdG90eXBlPSQud2lkZ2V0LmV4dGVuZChiYXNlUHJvdG90eXBlLHt3aWRnZXRFdmVudFByZWZpeDpleGlzdGluZ0NvbnN0cnVjdG9yPyhiYXNlUHJvdG90eXBlLndpZGdldEV2ZW50UHJlZml4fHxuYW1lKTpuYW1lfSxwcm94aWVkUHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjpjb25zdHJ1Y3RvcixuYW1lc3BhY2U6bmFtZXNwYWNlLHdpZGdldE5hbWU6bmFtZSx3aWRnZXRGdWxsTmFtZTpmdWxsTmFtZX0pO2lmKGV4aXN0aW5nQ29uc3RydWN0b3IpeyQuZWFjaChleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycyxmdW5jdGlvbihpLGNoaWxkKXt2YXIgY2hpbGRQcm90b3R5cGU9Y2hpbGQucHJvdG90eXBlOyQud2lkZ2V0KGNoaWxkUHJvdG90eXBlLm5hbWVzcGFjZSsiLiIrY2hpbGRQcm90b3R5cGUud2lkZ2V0TmFtZSxjb25zdHJ1Y3RvcixjaGlsZC5fcHJvdG8pO30pO2RlbGV0ZSBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9yczt9ZWxzZXtiYXNlLl9jaGlsZENvbnN0cnVjdG9ycy5wdXNoKGNvbnN0cnVjdG9yKTt9CiQud2lkZ2V0LmJyaWRnZShuYW1lLGNvbnN0cnVjdG9yKTt9OyQud2lkZ2V0LmV4dGVuZD1mdW5jdGlvbih0YXJnZXQpe3ZhciBpbnB1dD1zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxpbnB1dEluZGV4PTAsaW5wdXRMZW5ndGg9aW5wdXQubGVuZ3RoLGtleSx2YWx1ZTtmb3IoO2lucHV0SW5kZXg8aW5wdXRMZW5ndGg7aW5wdXRJbmRleCsrKXtmb3Ioa2V5IGluIGlucHV0W2lucHV0SW5kZXhdKXt2YWx1ZT1pbnB1dFtpbnB1dEluZGV4XVtrZXldO2lmKGlucHV0W2lucHV0SW5kZXhdLmhhc093blByb3BlcnR5KGtleSkmJnZhbHVlIT09dW5kZWZpbmVkKXtpZigkLmlzUGxhaW5PYmplY3QodmFsdWUpKXt0YXJnZXRba2V5XT0kLmlzUGxhaW5PYmplY3QodGFyZ2V0W2tleV0pPyQud2lkZ2V0LmV4dGVuZCh7fSx0YXJnZXRba2V5XSx2YWx1ZSk6JC53aWRnZXQuZXh0ZW5kKHt9LHZhbHVlKTt9ZWxzZXt0YXJnZXRba2V5XT12YWx1ZTt9fX19CnJldHVybiB0YXJnZXQ7fTskLndpZGdldC5icmlkZ2U9ZnVuY3Rpb24obmFtZSxvYmplY3Qpe3ZhciBmdWxsTmFtZT1vYmplY3QucHJvdG90eXBlLndpZGdldEZ1bGxOYW1lfHxuYW1lOyQuZm5bbmFtZV09ZnVuY3Rpb24ob3B0aW9ucyl7dmFyIGlzTWV0aG9kQ2FsbD10eXBlb2Ygb3B0aW9ucz09PSJzdHJpbmciLGFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMsMSkscmV0dXJuVmFsdWU9dGhpcztvcHRpb25zPSFpc01ldGhvZENhbGwmJmFyZ3MubGVuZ3RoPyQud2lkZ2V0LmV4dGVuZC5hcHBseShudWxsLFtvcHRpb25zXS5jb25jYXQoYXJncykpOm9wdGlvbnM7aWYoaXNNZXRob2RDYWxsKXt0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgbWV0aG9kVmFsdWUsaW5zdGFuY2U9JC5kYXRhKHRoaXMsZnVsbE5hbWUpO2lmKCFpbnN0YW5jZSl7cmV0dXJuICQuZXJyb3IoImNhbm5vdCBjYWxsIG1ldGhvZHMgb24gIituYW1lKyIgcHJpb3IgdG8gaW5pdGlhbGl6YXRpb247ICIrImF0dGVtcHRlZCB0byBjYWxsIG1ldGhvZCAnIitvcHRpb25zKyInIik7fQppZighJC5pc0Z1bmN0aW9uKGluc3RhbmNlW29wdGlvbnNdKXx8b3B0aW9ucy5jaGFyQXQoMCk9PT0iXyIpe3JldHVybiAkLmVycm9yKCJubyBzdWNoIG1ldGhvZCAnIitvcHRpb25zKyInIGZvciAiK25hbWUrIiB3aWRnZXQgaW5zdGFuY2UiKTt9Cm1ldGhvZFZhbHVlPWluc3RhbmNlW29wdGlvbnNdLmFwcGx5KGluc3RhbmNlLGFyZ3MpO2lmKG1ldGhvZFZhbHVlIT09aW5zdGFuY2UmJm1ldGhvZFZhbHVlIT09dW5kZWZpbmVkKXtyZXR1cm5WYWx1ZT1tZXRob2RWYWx1ZSYmbWV0aG9kVmFsdWUuanF1ZXJ5P3JldHVyblZhbHVlLnB1c2hTdGFjayhtZXRob2RWYWx1ZS5nZXQoKSk6bWV0aG9kVmFsdWU7cmV0dXJuIGZhbHNlO319KTt9ZWxzZXt0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgaW5zdGFuY2U9JC5kYXRhKHRoaXMsZnVsbE5hbWUpO2lmKGluc3RhbmNlKXtpbnN0YW5jZS5vcHRpb24ob3B0aW9uc3x8e30pLl9pbml0KCk7fWVsc2V7JC5kYXRhKHRoaXMsZnVsbE5hbWUsbmV3IG9iamVjdChvcHRpb25zLHRoaXMpKTt9fSk7fQpyZXR1cm4gcmV0dXJuVmFsdWU7fTt9OyQuV2lkZ2V0PWZ1bmN0aW9uKCl7fTskLldpZGdldC5fY2hpbGRDb25zdHJ1Y3RvcnM9W107JC5XaWRnZXQucHJvdG90eXBlPXt3aWRnZXROYW1lOiJ3aWRnZXQiLHdpZGdldEV2ZW50UHJlZml4OiIiLGRlZmF1bHRFbGVtZW50OiI8ZGl2PiIsb3B0aW9uczp7ZGlzYWJsZWQ6ZmFsc2UsY3JlYXRlOm51bGx9LF9jcmVhdGVXaWRnZXQ6ZnVuY3Rpb24ob3B0aW9ucyxlbGVtZW50KXtlbGVtZW50PSQoZWxlbWVudHx8dGhpcy5kZWZhdWx0RWxlbWVudHx8dGhpcylbMF07dGhpcy5lbGVtZW50PSQoZWxlbWVudCk7dGhpcy51dWlkPXV1aWQrKzt0aGlzLmV2ZW50TmFtZXNwYWNlPSIuIit0aGlzLndpZGdldE5hbWUrdGhpcy51dWlkO3RoaXMub3B0aW9ucz0kLndpZGdldC5leHRlbmQoe30sdGhpcy5vcHRpb25zLHRoaXMuX2dldENyZWF0ZU9wdGlvbnMoKSxvcHRpb25zKTt0aGlzLmJpbmRpbmdzPSQoKTt0aGlzLmhvdmVyYWJsZT0kKCk7dGhpcy5mb2N1c2FibGU9JCgpO2lmKGVsZW1lbnQhPT10aGlzKXskLmRhdGEoZWxlbWVudCx0aGlzLndpZGdldEZ1bGxOYW1lLHRoaXMpO3RoaXMuX29uKHRydWUsdGhpcy5lbGVtZW50LHtyZW1vdmU6ZnVuY3Rpb24oZXZlbnQpe2lmKGV2ZW50LnRhcmdldD09PWVsZW1lbnQpe3RoaXMuZGVzdHJveSgpO319fSk7dGhpcy5kb2N1bWVudD0kKGVsZW1lbnQuc3R5bGU/ZWxlbWVudC5vd25lckRvY3VtZW50OmVsZW1lbnQuZG9jdW1lbnR8fGVsZW1lbnQpO3RoaXMud2luZG93PSQodGhpcy5kb2N1bWVudFswXS5kZWZhdWx0Vmlld3x8dGhpcy5kb2N1bWVudFswXS5wYXJlbnRXaW5kb3cpO30KdGhpcy5fY3JlYXRlKCk7dGhpcy5fdHJpZ2dlcigiY3JlYXRlIixudWxsLHRoaXMuX2dldENyZWF0ZUV2ZW50RGF0YSgpKTt0aGlzLl9pbml0KCk7fSxfZ2V0Q3JlYXRlT3B0aW9uczokLm5vb3AsX2dldENyZWF0ZUV2ZW50RGF0YTokLm5vb3AsX2NyZWF0ZTokLm5vb3AsX2luaXQ6JC5ub29wLGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLl9kZXN0cm95KCk7dGhpcy5lbGVtZW50LnVuYmluZCh0aGlzLmV2ZW50TmFtZXNwYWNlKS5yZW1vdmVEYXRhKHRoaXMud2lkZ2V0TmFtZSkucmVtb3ZlRGF0YSh0aGlzLndpZGdldEZ1bGxOYW1lKS5yZW1vdmVEYXRhKCQuY2FtZWxDYXNlKHRoaXMud2lkZ2V0RnVsbE5hbWUpKTt0aGlzLndpZGdldCgpLnVuYmluZCh0aGlzLmV2ZW50TmFtZXNwYWNlKS5yZW1vdmVBdHRyKCJhcmlhLWRpc2FibGVkIikucmVtb3ZlQ2xhc3ModGhpcy53aWRnZXRGdWxsTmFtZSsiLWRpc2FibGVkICIrInVpLXN0YXRlLWRpc2FibGVkIik7dGhpcy5iaW5kaW5ncy51bmJpbmQodGhpcy5ldmVudE5hbWVzcGFjZSk7dGhpcy5ob3ZlcmFibGUucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWhvdmVyIik7dGhpcy5mb2N1c2FibGUucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWZvY3VzIik7fSxfZGVzdHJveTokLm5vb3Asd2lkZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudDt9LG9wdGlvbjpmdW5jdGlvbihrZXksdmFsdWUpe3ZhciBvcHRpb25zPWtleSxwYXJ0cyxjdXJPcHRpb24saTtpZihhcmd1bWVudHMubGVuZ3RoPT09MCl7cmV0dXJuICQud2lkZ2V0LmV4dGVuZCh7fSx0aGlzLm9wdGlvbnMpO30KaWYodHlwZW9mIGtleT09PSJzdHJpbmciKXtvcHRpb25zPXt9O3BhcnRzPWtleS5zcGxpdCgiLiIpO2tleT1wYXJ0cy5zaGlmdCgpO2lmKHBhcnRzLmxlbmd0aCl7Y3VyT3B0aW9uPW9wdGlvbnNba2V5XT0kLndpZGdldC5leHRlbmQoe30sdGhpcy5vcHRpb25zW2tleV0pO2ZvcihpPTA7aTxwYXJ0cy5sZW5ndGgtMTtpKyspe2N1ck9wdGlvbltwYXJ0c1tpXV09Y3VyT3B0aW9uW3BhcnRzW2ldXXx8e307Y3VyT3B0aW9uPWN1ck9wdGlvbltwYXJ0c1tpXV07fQprZXk9cGFydHMucG9wKCk7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiBjdXJPcHRpb25ba2V5XT09PXVuZGVmaW5lZD9udWxsOmN1ck9wdGlvbltrZXldO30KY3VyT3B0aW9uW2tleV09dmFsdWU7fWVsc2V7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLm9wdGlvbnNba2V5XT09PXVuZGVmaW5lZD9udWxsOnRoaXMub3B0aW9uc1trZXldO30Kb3B0aW9uc1trZXldPXZhbHVlO319CnRoaXMuX3NldE9wdGlvbnMob3B0aW9ucyk7cmV0dXJuIHRoaXM7fSxfc2V0T3B0aW9uczpmdW5jdGlvbihvcHRpb25zKXt2YXIga2V5O2ZvcihrZXkgaW4gb3B0aW9ucyl7dGhpcy5fc2V0T3B0aW9uKGtleSxvcHRpb25zW2tleV0pO30KcmV0dXJuIHRoaXM7fSxfc2V0T3B0aW9uOmZ1bmN0aW9uKGtleSx2YWx1ZSl7dGhpcy5vcHRpb25zW2tleV09dmFsdWU7aWYoa2V5PT09ImRpc2FibGVkIil7dGhpcy53aWRnZXQoKS50b2dnbGVDbGFzcyh0aGlzLndpZGdldEZ1bGxOYW1lKyItZGlzYWJsZWQgdWktc3RhdGUtZGlzYWJsZWQiLCEhdmFsdWUpLmF0dHIoImFyaWEtZGlzYWJsZWQiLHZhbHVlKTt0aGlzLmhvdmVyYWJsZS5yZW1vdmVDbGFzcygidWktc3RhdGUtaG92ZXIiKTt0aGlzLmZvY3VzYWJsZS5yZW1vdmVDbGFzcygidWktc3RhdGUtZm9jdXMiKTt9CnJldHVybiB0aGlzO30sZW5hYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NldE9wdGlvbigiZGlzYWJsZWQiLGZhbHNlKTt9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2V0T3B0aW9uKCJkaXNhYmxlZCIsdHJ1ZSk7fSxfb246ZnVuY3Rpb24oc3VwcHJlc3NEaXNhYmxlZENoZWNrLGVsZW1lbnQsaGFuZGxlcnMpe3ZhciBkZWxlZ2F0ZUVsZW1lbnQsaW5zdGFuY2U9dGhpcztpZih0eXBlb2Ygc3VwcHJlc3NEaXNhYmxlZENoZWNrIT09ImJvb2xlYW4iKXtoYW5kbGVycz1lbGVtZW50O2VsZW1lbnQ9c3VwcHJlc3NEaXNhYmxlZENoZWNrO3N1cHByZXNzRGlzYWJsZWRDaGVjaz1mYWxzZTt9CmlmKCFoYW5kbGVycyl7aGFuZGxlcnM9ZWxlbWVudDtlbGVtZW50PXRoaXMuZWxlbWVudDtkZWxlZ2F0ZUVsZW1lbnQ9dGhpcy53aWRnZXQoKTt9ZWxzZXtlbGVtZW50PWRlbGVnYXRlRWxlbWVudD0kKGVsZW1lbnQpO3RoaXMuYmluZGluZ3M9dGhpcy5iaW5kaW5ncy5hZGQoZWxlbWVudCk7fQokLmVhY2goaGFuZGxlcnMsZnVuY3Rpb24oZXZlbnQsaGFuZGxlcil7ZnVuY3Rpb24gaGFuZGxlclByb3h5KCl7aWYoIXN1cHByZXNzRGlzYWJsZWRDaGVjayYmKGluc3RhbmNlLm9wdGlvbnMuZGlzYWJsZWQ9PT10cnVlfHwkKHRoaXMpLmhhc0NsYXNzKCJ1aS1zdGF0ZS1kaXNhYmxlZCIpKSl7cmV0dXJuO30KcmV0dXJuKHR5cGVvZiBoYW5kbGVyPT09InN0cmluZyI/aW5zdGFuY2VbaGFuZGxlcl06aGFuZGxlcikuYXBwbHkoaW5zdGFuY2UsYXJndW1lbnRzKTt9CmlmKHR5cGVvZiBoYW5kbGVyIT09InN0cmluZyIpe2hhbmRsZXJQcm94eS5ndWlkPWhhbmRsZXIuZ3VpZD1oYW5kbGVyLmd1aWR8fGhhbmRsZXJQcm94eS5ndWlkfHwkLmd1aWQrKzt9CnZhciBtYXRjaD1ldmVudC5tYXRjaCgvXihcdyspXHMqKC4qKSQvKSxldmVudE5hbWU9bWF0Y2hbMV0raW5zdGFuY2UuZXZlbnROYW1lc3BhY2Usc2VsZWN0b3I9bWF0Y2hbMl07aWYoc2VsZWN0b3Ipe2RlbGVnYXRlRWxlbWVudC5kZWxlZ2F0ZShzZWxlY3RvcixldmVudE5hbWUsaGFuZGxlclByb3h5KTt9ZWxzZXtlbGVtZW50LmJpbmQoZXZlbnROYW1lLGhhbmRsZXJQcm94eSk7fX0pO30sX29mZjpmdW5jdGlvbihlbGVtZW50LGV2ZW50TmFtZSl7ZXZlbnROYW1lPShldmVudE5hbWV8fCIiKS5zcGxpdCgiICIpLmpvaW4odGhpcy5ldmVudE5hbWVzcGFjZSsiICIpK3RoaXMuZXZlbnROYW1lc3BhY2U7ZWxlbWVudC51bmJpbmQoZXZlbnROYW1lKS51bmRlbGVnYXRlKGV2ZW50TmFtZSk7fSxfZGVsYXk6ZnVuY3Rpb24oaGFuZGxlcixkZWxheSl7ZnVuY3Rpb24gaGFuZGxlclByb3h5KCl7cmV0dXJuKHR5cGVvZiBoYW5kbGVyPT09InN0cmluZyI/aW5zdGFuY2VbaGFuZGxlcl06aGFuZGxlcikuYXBwbHkoaW5zdGFuY2UsYXJndW1lbnRzKTt9CnZhciBpbnN0YW5jZT10aGlzO3JldHVybiBzZXRUaW1lb3V0KGhhbmRsZXJQcm94eSxkZWxheXx8MCk7fSxfaG92ZXJhYmxlOmZ1bmN0aW9uKGVsZW1lbnQpe3RoaXMuaG92ZXJhYmxlPXRoaXMuaG92ZXJhYmxlLmFkZChlbGVtZW50KTt0aGlzLl9vbihlbGVtZW50LHttb3VzZWVudGVyOmZ1bmN0aW9uKGV2ZW50KXskKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmFkZENsYXNzKCJ1aS1zdGF0ZS1ob3ZlciIpO30sbW91c2VsZWF2ZTpmdW5jdGlvbihldmVudCl7JChldmVudC5jdXJyZW50VGFyZ2V0KS5yZW1vdmVDbGFzcygidWktc3RhdGUtaG92ZXIiKTt9fSk7fSxfZm9jdXNhYmxlOmZ1bmN0aW9uKGVsZW1lbnQpe3RoaXMuZm9jdXNhYmxlPXRoaXMuZm9jdXNhYmxlLmFkZChlbGVtZW50KTt0aGlzLl9vbihlbGVtZW50LHtmb2N1c2luOmZ1bmN0aW9uKGV2ZW50KXskKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmFkZENsYXNzKCJ1aS1zdGF0ZS1mb2N1cyIpO30sZm9jdXNvdXQ6ZnVuY3Rpb24oZXZlbnQpeyQoZXZlbnQuY3VycmVudFRhcmdldCkucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWZvY3VzIik7fX0pO30sX3RyaWdnZXI6ZnVuY3Rpb24odHlwZSxldmVudCxkYXRhKXt2YXIgcHJvcCxvcmlnLGNhbGxiYWNrPXRoaXMub3B0aW9uc1t0eXBlXTtkYXRhPWRhdGF8fHt9O2V2ZW50PSQuRXZlbnQoZXZlbnQpO2V2ZW50LnR5cGU9KHR5cGU9PT10aGlzLndpZGdldEV2ZW50UHJlZml4P3R5cGU6dGhpcy53aWRnZXRFdmVudFByZWZpeCt0eXBlKS50b0xvd2VyQ2FzZSgpO2V2ZW50LnRhcmdldD10aGlzLmVsZW1lbnRbMF07b3JpZz1ldmVudC5vcmlnaW5hbEV2ZW50O2lmKG9yaWcpe2Zvcihwcm9wIGluIG9yaWcpe2lmKCEocHJvcCBpbiBldmVudCkpe2V2ZW50W3Byb3BdPW9yaWdbcHJvcF07fX19CnRoaXMuZWxlbWVudC50cmlnZ2VyKGV2ZW50LGRhdGEpO3JldHVybiEoJC5pc0Z1bmN0aW9uKGNhbGxiYWNrKSYmY2FsbGJhY2suYXBwbHkodGhpcy5lbGVtZW50WzBdLFtldmVudF0uY29uY2F0KGRhdGEpKT09PWZhbHNlfHxldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSk7fX07JC5lYWNoKHtzaG93OiJmYWRlSW4iLGhpZGU6ImZhZGVPdXQifSxmdW5jdGlvbihtZXRob2QsZGVmYXVsdEVmZmVjdCl7JC5XaWRnZXQucHJvdG90eXBlWyJfIittZXRob2RdPWZ1bmN0aW9uKGVsZW1lbnQsb3B0aW9ucyxjYWxsYmFjayl7aWYodHlwZW9mIG9wdGlvbnM9PT0ic3RyaW5nIil7b3B0aW9ucz17ZWZmZWN0Om9wdGlvbnN9O30KdmFyIGhhc09wdGlvbnMsZWZmZWN0TmFtZT0hb3B0aW9ucz9tZXRob2Q6b3B0aW9ucz09PXRydWV8fHR5cGVvZiBvcHRpb25zPT09Im51bWJlciI/ZGVmYXVsdEVmZmVjdDpvcHRpb25zLmVmZmVjdHx8ZGVmYXVsdEVmZmVjdDtvcHRpb25zPW9wdGlvbnN8fHt9O2lmKHR5cGVvZiBvcHRpb25zPT09Im51bWJlciIpe29wdGlvbnM9e2R1cmF0aW9uOm9wdGlvbnN9O30KaGFzT3B0aW9ucz0hJC5pc0VtcHR5T2JqZWN0KG9wdGlvbnMpO29wdGlvbnMuY29tcGxldGU9Y2FsbGJhY2s7aWYob3B0aW9ucy5kZWxheSl7ZWxlbWVudC5kZWxheShvcHRpb25zLmRlbGF5KTt9CmlmKGhhc09wdGlvbnMmJiQuZWZmZWN0cyYmJC5lZmZlY3RzLmVmZmVjdFtlZmZlY3ROYW1lXSl7ZWxlbWVudFttZXRob2RdKG9wdGlvbnMpO31lbHNlIGlmKGVmZmVjdE5hbWUhPT1tZXRob2QmJmVsZW1lbnRbZWZmZWN0TmFtZV0pe2VsZW1lbnRbZWZmZWN0TmFtZV0ob3B0aW9ucy5kdXJhdGlvbixvcHRpb25zLmVhc2luZyxjYWxsYmFjayk7fWVsc2V7ZWxlbWVudC5xdWV1ZShmdW5jdGlvbihuZXh0KXskKHRoaXMpW21ldGhvZF0oKTtpZihjYWxsYmFjayl7Y2FsbGJhY2suY2FsbChlbGVtZW50WzBdKTt9Cm5leHQoKTt9KTt9fTt9KTt9KShqUXVlcnkpOyhmdW5jdGlvbigkLHVuZGVmaW5lZCl7JC51aT0kLnVpfHx7fTt2YXIgY2FjaGVkU2Nyb2xsYmFyV2lkdGgsbWF4PU1hdGgubWF4LGFicz1NYXRoLmFicyxyb3VuZD1NYXRoLnJvdW5kLHJob3Jpem9udGFsPS9sZWZ0fGNlbnRlcnxyaWdodC8scnZlcnRpY2FsPS90b3B8Y2VudGVyfGJvdHRvbS8scm9mZnNldD0vW1wrXC1dXGQrKFwuW1xkXSspPyU/LyxycG9zaXRpb249L15cdysvLHJwZXJjZW50PS8lJC8sX3Bvc2l0aW9uPSQuZm4ucG9zaXRpb247ZnVuY3Rpb24gZ2V0T2Zmc2V0cyhvZmZzZXRzLHdpZHRoLGhlaWdodCl7cmV0dXJuW3BhcnNlRmxvYXQob2Zmc2V0c1swXSkqKHJwZXJjZW50LnRlc3Qob2Zmc2V0c1swXSk/d2lkdGgvMTAwOjEpLHBhcnNlRmxvYXQob2Zmc2V0c1sxXSkqKHJwZXJjZW50LnRlc3Qob2Zmc2V0c1sxXSk/aGVpZ2h0LzEwMDoxKV07fQpmdW5jdGlvbiBwYXJzZUNzcyhlbGVtZW50LHByb3BlcnR5KXtyZXR1cm4gcGFyc2VJbnQoJC5jc3MoZWxlbWVudCxwcm9wZXJ0eSksMTApfHwwO30KZnVuY3Rpb24gZ2V0RGltZW5zaW9ucyhlbGVtKXt2YXIgcmF3PWVsZW1bMF07aWYocmF3Lm5vZGVUeXBlPT09OSl7cmV0dXJue3dpZHRoOmVsZW0ud2lkdGgoKSxoZWlnaHQ6ZWxlbS5oZWlnaHQoKSxvZmZzZXQ6e3RvcDowLGxlZnQ6MH19O30KaWYoJC5pc1dpbmRvdyhyYXcpKXtyZXR1cm57d2lkdGg6ZWxlbS53aWR0aCgpLGhlaWdodDplbGVtLmhlaWdodCgpLG9mZnNldDp7dG9wOmVsZW0uc2Nyb2xsVG9wKCksbGVmdDplbGVtLnNjcm9sbExlZnQoKX19O30KaWYocmF3LnByZXZlbnREZWZhdWx0KXtyZXR1cm57d2lkdGg6MCxoZWlnaHQ6MCxvZmZzZXQ6e3RvcDpyYXcucGFnZVksbGVmdDpyYXcucGFnZVh9fTt9CnJldHVybnt3aWR0aDplbGVtLm91dGVyV2lkdGgoKSxoZWlnaHQ6ZWxlbS5vdXRlckhlaWdodCgpLG9mZnNldDplbGVtLm9mZnNldCgpfTt9CiQucG9zaXRpb249e3Njcm9sbGJhcldpZHRoOmZ1bmN0aW9uKCl7aWYoY2FjaGVkU2Nyb2xsYmFyV2lkdGghPT11bmRlZmluZWQpe3JldHVybiBjYWNoZWRTY3JvbGxiYXJXaWR0aDt9CnZhciB3MSx3MixkaXY9JCgiPGRpdiBzdHlsZT0nZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDo1MHB4O2hlaWdodDo1MHB4O292ZXJmbG93OmhpZGRlbjsnPjxkaXYgc3R5bGU9J2hlaWdodDoxMDBweDt3aWR0aDphdXRvOyc+PC9kaXY+PC9kaXY+IiksaW5uZXJEaXY9ZGl2LmNoaWxkcmVuKClbMF07JCgiYm9keSIpLmFwcGVuZChkaXYpO3cxPWlubmVyRGl2Lm9mZnNldFdpZHRoO2Rpdi5jc3MoIm92ZXJmbG93Iiwic2Nyb2xsIik7dzI9aW5uZXJEaXYub2Zmc2V0V2lkdGg7aWYodzE9PT13Mil7dzI9ZGl2WzBdLmNsaWVudFdpZHRoO30KZGl2LnJlbW92ZSgpO3JldHVybihjYWNoZWRTY3JvbGxiYXJXaWR0aD13MS13Mik7fSxnZXRTY3JvbGxJbmZvOmZ1bmN0aW9uKHdpdGhpbil7dmFyIG92ZXJmbG93WD13aXRoaW4uaXNXaW5kb3d8fHdpdGhpbi5pc0RvY3VtZW50PyIiOndpdGhpbi5lbGVtZW50LmNzcygib3ZlcmZsb3cteCIpLG92ZXJmbG93WT13aXRoaW4uaXNXaW5kb3d8fHdpdGhpbi5pc0RvY3VtZW50PyIiOndpdGhpbi5lbGVtZW50LmNzcygib3ZlcmZsb3cteSIpLGhhc092ZXJmbG93WD1vdmVyZmxvd1g9PT0ic2Nyb2xsInx8KG92ZXJmbG93WD09PSJhdXRvIiYmd2l0aGluLndpZHRoPHdpdGhpbi5lbGVtZW50WzBdLnNjcm9sbFdpZHRoKSxoYXNPdmVyZmxvd1k9b3ZlcmZsb3dZPT09InNjcm9sbCJ8fChvdmVyZmxvd1k9PT0iYXV0byImJndpdGhpbi5oZWlnaHQ8d2l0aGluLmVsZW1lbnRbMF0uc2Nyb2xsSGVpZ2h0KTtyZXR1cm57d2lkdGg6aGFzT3ZlcmZsb3dZPyQucG9zaXRpb24uc2Nyb2xsYmFyV2lkdGgoKTowLGhlaWdodDpoYXNPdmVyZmxvd1g/JC5wb3NpdGlvbi5zY3JvbGxiYXJXaWR0aCgpOjB9O30sZ2V0V2l0aGluSW5mbzpmdW5jdGlvbihlbGVtZW50KXt2YXIgd2l0aGluRWxlbWVudD0kKGVsZW1lbnR8fHdpbmRvdyksaXNXaW5kb3c9JC5pc1dpbmRvdyh3aXRoaW5FbGVtZW50WzBdKSxpc0RvY3VtZW50PSEhd2l0aGluRWxlbWVudFswXSYmd2l0aGluRWxlbWVudFswXS5ub2RlVHlwZT09PTk7cmV0dXJue2VsZW1lbnQ6d2l0aGluRWxlbWVudCxpc1dpbmRvdzppc1dpbmRvdyxpc0RvY3VtZW50OmlzRG9jdW1lbnQsb2Zmc2V0OndpdGhpbkVsZW1lbnQub2Zmc2V0KCl8fHtsZWZ0OjAsdG9wOjB9LHNjcm9sbExlZnQ6d2l0aGluRWxlbWVudC5zY3JvbGxMZWZ0KCksc2Nyb2xsVG9wOndpdGhpbkVsZW1lbnQuc2Nyb2xsVG9wKCksd2lkdGg6aXNXaW5kb3c/d2l0aGluRWxlbWVudC53aWR0aCgpOndpdGhpbkVsZW1lbnQub3V0ZXJXaWR0aCgpLGhlaWdodDppc1dpbmRvdz93aXRoaW5FbGVtZW50LmhlaWdodCgpOndpdGhpbkVsZW1lbnQub3V0ZXJIZWlnaHQoKX07fX07JC5mbi5wb3NpdGlvbj1mdW5jdGlvbihvcHRpb25zKXtpZighb3B0aW9uc3x8IW9wdGlvbnMub2Ype3JldHVybiBfcG9zaXRpb24uYXBwbHkodGhpcyxhcmd1bWVudHMpO30Kb3B0aW9ucz0kLmV4dGVuZCh7fSxvcHRpb25zKTt2YXIgYXRPZmZzZXQsdGFyZ2V0V2lkdGgsdGFyZ2V0SGVpZ2h0LHRhcmdldE9mZnNldCxiYXNlUG9zaXRpb24sZGltZW5zaW9ucyx0YXJnZXQ9JChvcHRpb25zLm9mKSx3aXRoaW49JC5wb3NpdGlvbi5nZXRXaXRoaW5JbmZvKG9wdGlvbnMud2l0aGluKSxzY3JvbGxJbmZvPSQucG9zaXRpb24uZ2V0U2Nyb2xsSW5mbyh3aXRoaW4pLGNvbGxpc2lvbj0ob3B0aW9ucy5jb2xsaXNpb258fCJmbGlwIikuc3BsaXQoIiAiKSxvZmZzZXRzPXt9O2RpbWVuc2lvbnM9Z2V0RGltZW5zaW9ucyh0YXJnZXQpO2lmKHRhcmdldFswXS5wcmV2ZW50RGVmYXVsdCl7b3B0aW9ucy5hdD0ibGVmdCB0b3AiO30KdGFyZ2V0V2lkdGg9ZGltZW5zaW9ucy53aWR0aDt0YXJnZXRIZWlnaHQ9ZGltZW5zaW9ucy5oZWlnaHQ7dGFyZ2V0T2Zmc2V0PWRpbWVuc2lvbnMub2Zmc2V0O2Jhc2VQb3NpdGlvbj0kLmV4dGVuZCh7fSx0YXJnZXRPZmZzZXQpOyQuZWFjaChbIm15IiwiYXQiXSxmdW5jdGlvbigpe3ZhciBwb3M9KG9wdGlvbnNbdGhpc118fCIiKS5zcGxpdCgiICIpLGhvcml6b250YWxPZmZzZXQsdmVydGljYWxPZmZzZXQ7aWYocG9zLmxlbmd0aD09PTEpe3Bvcz1yaG9yaXpvbnRhbC50ZXN0KHBvc1swXSk/cG9zLmNvbmNhdChbImNlbnRlciJdKTpydmVydGljYWwudGVzdChwb3NbMF0pP1siY2VudGVyIl0uY29uY2F0KHBvcyk6WyJjZW50ZXIiLCJjZW50ZXIiXTt9CnBvc1swXT1yaG9yaXpvbnRhbC50ZXN0KHBvc1swXSk/cG9zWzBdOiJjZW50ZXIiO3Bvc1sxXT1ydmVydGljYWwudGVzdChwb3NbMV0pP3Bvc1sxXToiY2VudGVyIjtob3Jpem9udGFsT2Zmc2V0PXJvZmZzZXQuZXhlYyhwb3NbMF0pO3ZlcnRpY2FsT2Zmc2V0PXJvZmZzZXQuZXhlYyhwb3NbMV0pO29mZnNldHNbdGhpc109W2hvcml6b250YWxPZmZzZXQ/aG9yaXpvbnRhbE9mZnNldFswXTowLHZlcnRpY2FsT2Zmc2V0P3ZlcnRpY2FsT2Zmc2V0WzBdOjBdO29wdGlvbnNbdGhpc109W3Jwb3NpdGlvbi5leGVjKHBvc1swXSlbMF0scnBvc2l0aW9uLmV4ZWMocG9zWzFdKVswXV07fSk7aWYoY29sbGlzaW9uLmxlbmd0aD09PTEpe2NvbGxpc2lvblsxXT1jb2xsaXNpb25bMF07fQppZihvcHRpb25zLmF0WzBdPT09InJpZ2h0Iil7YmFzZVBvc2l0aW9uLmxlZnQrPXRhcmdldFdpZHRoO31lbHNlIGlmKG9wdGlvbnMuYXRbMF09PT0iY2VudGVyIil7YmFzZVBvc2l0aW9uLmxlZnQrPXRhcmdldFdpZHRoLzI7fQppZihvcHRpb25zLmF0WzFdPT09ImJvdHRvbSIpe2Jhc2VQb3NpdGlvbi50b3ArPXRhcmdldEhlaWdodDt9ZWxzZSBpZihvcHRpb25zLmF0WzFdPT09ImNlbnRlciIpe2Jhc2VQb3NpdGlvbi50b3ArPXRhcmdldEhlaWdodC8yO30KYXRPZmZzZXQ9Z2V0T2Zmc2V0cyhvZmZzZXRzLmF0LHRhcmdldFdpZHRoLHRhcmdldEhlaWdodCk7YmFzZVBvc2l0aW9uLmxlZnQrPWF0T2Zmc2V0WzBdO2Jhc2VQb3NpdGlvbi50b3ArPWF0T2Zmc2V0WzFdO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgY29sbGlzaW9uUG9zaXRpb24sdXNpbmcsZWxlbT0kKHRoaXMpLGVsZW1XaWR0aD1lbGVtLm91dGVyV2lkdGgoKSxlbGVtSGVpZ2h0PWVsZW0ub3V0ZXJIZWlnaHQoKSxtYXJnaW5MZWZ0PXBhcnNlQ3NzKHRoaXMsIm1hcmdpbkxlZnQiKSxtYXJnaW5Ub3A9cGFyc2VDc3ModGhpcywibWFyZ2luVG9wIiksY29sbGlzaW9uV2lkdGg9ZWxlbVdpZHRoK21hcmdpbkxlZnQrcGFyc2VDc3ModGhpcywibWFyZ2luUmlnaHQiKStzY3JvbGxJbmZvLndpZHRoLGNvbGxpc2lvbkhlaWdodD1lbGVtSGVpZ2h0K21hcmdpblRvcCtwYXJzZUNzcyh0aGlzLCJtYXJnaW5Cb3R0b20iKStzY3JvbGxJbmZvLmhlaWdodCxwb3NpdGlvbj0kLmV4dGVuZCh7fSxiYXNlUG9zaXRpb24pLG15T2Zmc2V0PWdldE9mZnNldHMob2Zmc2V0cy5teSxlbGVtLm91dGVyV2lkdGgoKSxlbGVtLm91dGVySGVpZ2h0KCkpO2lmKG9wdGlvbnMubXlbMF09PT0icmlnaHQiKXtwb3NpdGlvbi5sZWZ0LT1lbGVtV2lkdGg7fWVsc2UgaWYob3B0aW9ucy5teVswXT09PSJjZW50ZXIiKXtwb3NpdGlvbi5sZWZ0LT1lbGVtV2lkdGgvMjt9CmlmKG9wdGlvbnMubXlbMV09PT0iYm90dG9tIil7cG9zaXRpb24udG9wLT1lbGVtSGVpZ2h0O31lbHNlIGlmKG9wdGlvbnMubXlbMV09PT0iY2VudGVyIil7cG9zaXRpb24udG9wLT1lbGVtSGVpZ2h0LzI7fQpwb3NpdGlvbi5sZWZ0Kz1teU9mZnNldFswXTtwb3NpdGlvbi50b3ArPW15T2Zmc2V0WzFdO2lmKCEkLnN1cHBvcnQub2Zmc2V0RnJhY3Rpb25zKXtwb3NpdGlvbi5sZWZ0PXJvdW5kKHBvc2l0aW9uLmxlZnQpO3Bvc2l0aW9uLnRvcD1yb3VuZChwb3NpdGlvbi50b3ApO30KY29sbGlzaW9uUG9zaXRpb249e21hcmdpbkxlZnQ6bWFyZ2luTGVmdCxtYXJnaW5Ub3A6bWFyZ2luVG9wfTskLmVhY2goWyJsZWZ0IiwidG9wIl0sZnVuY3Rpb24oaSxkaXIpe2lmKCQudWkucG9zaXRpb25bY29sbGlzaW9uW2ldXSl7JC51aS5wb3NpdGlvbltjb2xsaXNpb25baV1dW2Rpcl0ocG9zaXRpb24se3RhcmdldFdpZHRoOnRhcmdldFdpZHRoLHRhcmdldEhlaWdodDp0YXJnZXRIZWlnaHQsZWxlbVdpZHRoOmVsZW1XaWR0aCxlbGVtSGVpZ2h0OmVsZW1IZWlnaHQsY29sbGlzaW9uUG9zaXRpb246Y29sbGlzaW9uUG9zaXRpb24sY29sbGlzaW9uV2lkdGg6Y29sbGlzaW9uV2lkdGgsY29sbGlzaW9uSGVpZ2h0OmNvbGxpc2lvbkhlaWdodCxvZmZzZXQ6W2F0T2Zmc2V0WzBdK215T2Zmc2V0WzBdLGF0T2Zmc2V0WzFdK215T2Zmc2V0WzFdXSxteTpvcHRpb25zLm15LGF0Om9wdGlvbnMuYXQsd2l0aGluOndpdGhpbixlbGVtOmVsZW19KTt9fSk7aWYob3B0aW9ucy51c2luZyl7dXNpbmc9ZnVuY3Rpb24ocHJvcHMpe3ZhciBsZWZ0PXRhcmdldE9mZnNldC5sZWZ0LXBvc2l0aW9uLmxlZnQscmlnaHQ9bGVmdCt0YXJnZXRXaWR0aC1lbGVtV2lkdGgsdG9wPXRhcmdldE9mZnNldC50b3AtcG9zaXRpb24udG9wLGJvdHRvbT10b3ArdGFyZ2V0SGVpZ2h0LWVsZW1IZWlnaHQsZmVlZGJhY2s9e3RhcmdldDp7ZWxlbWVudDp0YXJnZXQsbGVmdDp0YXJnZXRPZmZzZXQubGVmdCx0b3A6dGFyZ2V0T2Zmc2V0LnRvcCx3aWR0aDp0YXJnZXRXaWR0aCxoZWlnaHQ6dGFyZ2V0SGVpZ2h0fSxlbGVtZW50OntlbGVtZW50OmVsZW0sbGVmdDpwb3NpdGlvbi5sZWZ0LHRvcDpwb3NpdGlvbi50b3Asd2lkdGg6ZWxlbVdpZHRoLGhlaWdodDplbGVtSGVpZ2h0fSxob3Jpem9udGFsOnJpZ2h0PDA/ImxlZnQiOmxlZnQ+MD8icmlnaHQiOiJjZW50ZXIiLHZlcnRpY2FsOmJvdHRvbTwwPyJ0b3AiOnRvcD4wPyJib3R0b20iOiJtaWRkbGUifTtpZih0YXJnZXRXaWR0aDxlbGVtV2lkdGgmJmFicyhsZWZ0K3JpZ2h0KTx0YXJnZXRXaWR0aCl7ZmVlZGJhY2suaG9yaXpvbnRhbD0iY2VudGVyIjt9CmlmKHRhcmdldEhlaWdodDxlbGVtSGVpZ2h0JiZhYnModG9wK2JvdHRvbSk8dGFyZ2V0SGVpZ2h0KXtmZWVkYmFjay52ZXJ0aWNhbD0ibWlkZGxlIjt9CmlmKG1heChhYnMobGVmdCksYWJzKHJpZ2h0KSk+bWF4KGFicyh0b3ApLGFicyhib3R0b20pKSl7ZmVlZGJhY2suaW1wb3J0YW50PSJob3Jpem9udGFsIjt9ZWxzZXtmZWVkYmFjay5pbXBvcnRhbnQ9InZlcnRpY2FsIjt9Cm9wdGlvbnMudXNpbmcuY2FsbCh0aGlzLHByb3BzLGZlZWRiYWNrKTt9O30KZWxlbS5vZmZzZXQoJC5leHRlbmQocG9zaXRpb24se3VzaW5nOnVzaW5nfSkpO30pO307JC51aS5wb3NpdGlvbj17Zml0OntsZWZ0OmZ1bmN0aW9uKHBvc2l0aW9uLGRhdGEpe3ZhciB3aXRoaW49ZGF0YS53aXRoaW4sd2l0aGluT2Zmc2V0PXdpdGhpbi5pc1dpbmRvdz93aXRoaW4uc2Nyb2xsTGVmdDp3aXRoaW4ub2Zmc2V0LmxlZnQsb3V0ZXJXaWR0aD13aXRoaW4ud2lkdGgsY29sbGlzaW9uUG9zTGVmdD1wb3NpdGlvbi5sZWZ0LWRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCxvdmVyTGVmdD13aXRoaW5PZmZzZXQtY29sbGlzaW9uUG9zTGVmdCxvdmVyUmlnaHQ9Y29sbGlzaW9uUG9zTGVmdCtkYXRhLmNvbGxpc2lvbldpZHRoLW91dGVyV2lkdGgtd2l0aGluT2Zmc2V0LG5ld092ZXJSaWdodDtpZihkYXRhLmNvbGxpc2lvbldpZHRoPm91dGVyV2lkdGgpe2lmKG92ZXJMZWZ0PjAmJm92ZXJSaWdodDw9MCl7bmV3T3ZlclJpZ2h0PXBvc2l0aW9uLmxlZnQrb3ZlckxlZnQrZGF0YS5jb2xsaXNpb25XaWR0aC1vdXRlcldpZHRoLXdpdGhpbk9mZnNldDtwb3NpdGlvbi5sZWZ0Kz1vdmVyTGVmdC1uZXdPdmVyUmlnaHQ7fWVsc2UgaWYob3ZlclJpZ2h0PjAmJm92ZXJMZWZ0PD0wKXtwb3NpdGlvbi5sZWZ0PXdpdGhpbk9mZnNldDt9ZWxzZXtpZihvdmVyTGVmdD5vdmVyUmlnaHQpe3Bvc2l0aW9uLmxlZnQ9d2l0aGluT2Zmc2V0K291dGVyV2lkdGgtZGF0YS5jb2xsaXNpb25XaWR0aDt9ZWxzZXtwb3NpdGlvbi5sZWZ0PXdpdGhpbk9mZnNldDt9fX1lbHNlIGlmKG92ZXJMZWZ0PjApe3Bvc2l0aW9uLmxlZnQrPW92ZXJMZWZ0O31lbHNlIGlmKG92ZXJSaWdodD4wKXtwb3NpdGlvbi5sZWZ0LT1vdmVyUmlnaHQ7fWVsc2V7cG9zaXRpb24ubGVmdD1tYXgocG9zaXRpb24ubGVmdC1jb2xsaXNpb25Qb3NMZWZ0LHBvc2l0aW9uLmxlZnQpO319LHRvcDpmdW5jdGlvbihwb3NpdGlvbixkYXRhKXt2YXIgd2l0aGluPWRhdGEud2l0aGluLHdpdGhpbk9mZnNldD13aXRoaW4uaXNXaW5kb3c/d2l0aGluLnNjcm9sbFRvcDp3aXRoaW4ub2Zmc2V0LnRvcCxvdXRlckhlaWdodD1kYXRhLndpdGhpbi5oZWlnaHQsY29sbGlzaW9uUG9zVG9wPXBvc2l0aW9uLnRvcC1kYXRhLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpblRvcCxvdmVyVG9wPXdpdGhpbk9mZnNldC1jb2xsaXNpb25Qb3NUb3Asb3ZlckJvdHRvbT1jb2xsaXNpb25Qb3NUb3ArZGF0YS5jb2xsaXNpb25IZWlnaHQtb3V0ZXJIZWlnaHQtd2l0aGluT2Zmc2V0LG5ld092ZXJCb3R0b207aWYoZGF0YS5jb2xsaXNpb25IZWlnaHQ+b3V0ZXJIZWlnaHQpe2lmKG92ZXJUb3A+MCYmb3ZlckJvdHRvbTw9MCl7bmV3T3ZlckJvdHRvbT1wb3NpdGlvbi50b3Arb3ZlclRvcCtkYXRhLmNvbGxpc2lvbkhlaWdodC1vdXRlckhlaWdodC13aXRoaW5PZmZzZXQ7cG9zaXRpb24udG9wKz1vdmVyVG9wLW5ld092ZXJCb3R0b207fWVsc2UgaWYob3ZlckJvdHRvbT4wJiZvdmVyVG9wPD0wKXtwb3NpdGlvbi50b3A9d2l0aGluT2Zmc2V0O31lbHNle2lmKG92ZXJUb3A+b3ZlckJvdHRvbSl7cG9zaXRpb24udG9wPXdpdGhpbk9mZnNldCtvdXRlckhlaWdodC1kYXRhLmNvbGxpc2lvbkhlaWdodDt9ZWxzZXtwb3NpdGlvbi50b3A9d2l0aGluT2Zmc2V0O319fWVsc2UgaWYob3ZlclRvcD4wKXtwb3NpdGlvbi50b3ArPW92ZXJUb3A7fWVsc2UgaWYob3ZlckJvdHRvbT4wKXtwb3NpdGlvbi50b3AtPW92ZXJCb3R0b207fWVsc2V7cG9zaXRpb24udG9wPW1heChwb3NpdGlvbi50b3AtY29sbGlzaW9uUG9zVG9wLHBvc2l0aW9uLnRvcCk7fX19LGZsaXA6e2xlZnQ6ZnVuY3Rpb24ocG9zaXRpb24sZGF0YSl7dmFyIHdpdGhpbj1kYXRhLndpdGhpbix3aXRoaW5PZmZzZXQ9d2l0aGluLm9mZnNldC5sZWZ0K3dpdGhpbi5zY3JvbGxMZWZ0LG91dGVyV2lkdGg9d2l0aGluLndpZHRoLG9mZnNldExlZnQ9d2l0aGluLmlzV2luZG93P3dpdGhpbi5zY3JvbGxMZWZ0OndpdGhpbi5vZmZzZXQubGVmdCxjb2xsaXNpb25Qb3NMZWZ0PXBvc2l0aW9uLmxlZnQtZGF0YS5jb2xsaXNpb25Qb3NpdGlvbi5tYXJnaW5MZWZ0LG92ZXJMZWZ0PWNvbGxpc2lvblBvc0xlZnQtb2Zmc2V0TGVmdCxvdmVyUmlnaHQ9Y29sbGlzaW9uUG9zTGVmdCtkYXRhLmNvbGxpc2lvbldpZHRoLW91dGVyV2lkdGgtb2Zmc2V0TGVmdCxteU9mZnNldD1kYXRhLm15WzBdPT09ImxlZnQiPy1kYXRhLmVsZW1XaWR0aDpkYXRhLm15WzBdPT09InJpZ2h0Ij9kYXRhLmVsZW1XaWR0aDowLGF0T2Zmc2V0PWRhdGEuYXRbMF09PT0ibGVmdCI/ZGF0YS50YXJnZXRXaWR0aDpkYXRhLmF0WzBdPT09InJpZ2h0Ij8tZGF0YS50YXJnZXRXaWR0aDowLG9mZnNldD0tMipkYXRhLm9mZnNldFswXSxuZXdPdmVyUmlnaHQsbmV3T3ZlckxlZnQ7aWYob3ZlckxlZnQ8MCl7bmV3T3ZlclJpZ2h0PXBvc2l0aW9uLmxlZnQrbXlPZmZzZXQrYXRPZmZzZXQrb2Zmc2V0K2RhdGEuY29sbGlzaW9uV2lkdGgtb3V0ZXJXaWR0aC13aXRoaW5PZmZzZXQ7aWYobmV3T3ZlclJpZ2h0PDB8fG5ld092ZXJSaWdodDxhYnMob3ZlckxlZnQpKXtwb3NpdGlvbi5sZWZ0Kz1teU9mZnNldCthdE9mZnNldCtvZmZzZXQ7fX0KZWxzZSBpZihvdmVyUmlnaHQ+MCl7bmV3T3ZlckxlZnQ9cG9zaXRpb24ubGVmdC1kYXRhLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpbkxlZnQrbXlPZmZzZXQrYXRPZmZzZXQrb2Zmc2V0LW9mZnNldExlZnQ7aWYobmV3T3ZlckxlZnQ+MHx8YWJzKG5ld092ZXJMZWZ0KTxvdmVyUmlnaHQpe3Bvc2l0aW9uLmxlZnQrPW15T2Zmc2V0K2F0T2Zmc2V0K29mZnNldDt9fX0sdG9wOmZ1bmN0aW9uKHBvc2l0aW9uLGRhdGEpe3ZhciB3aXRoaW49ZGF0YS53aXRoaW4sd2l0aGluT2Zmc2V0PXdpdGhpbi5vZmZzZXQudG9wK3dpdGhpbi5zY3JvbGxUb3Asb3V0ZXJIZWlnaHQ9d2l0aGluLmhlaWdodCxvZmZzZXRUb3A9d2l0aGluLmlzV2luZG93P3dpdGhpbi5zY3JvbGxUb3A6d2l0aGluLm9mZnNldC50b3AsY29sbGlzaW9uUG9zVG9wPXBvc2l0aW9uLnRvcC1kYXRhLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpblRvcCxvdmVyVG9wPWNvbGxpc2lvblBvc1RvcC1vZmZzZXRUb3Asb3ZlckJvdHRvbT1jb2xsaXNpb25Qb3NUb3ArZGF0YS5jb2xsaXNpb25IZWlnaHQtb3V0ZXJIZWlnaHQtb2Zmc2V0VG9wLHRvcD1kYXRhLm15WzFdPT09InRvcCIsbXlPZmZzZXQ9dG9wPy1kYXRhLmVsZW1IZWlnaHQ6ZGF0YS5teVsxXT09PSJib3R0b20iP2RhdGEuZWxlbUhlaWdodDowLGF0T2Zmc2V0PWRhdGEuYXRbMV09PT0idG9wIj9kYXRhLnRhcmdldEhlaWdodDpkYXRhLmF0WzFdPT09ImJvdHRvbSI/LWRhdGEudGFyZ2V0SGVpZ2h0OjAsb2Zmc2V0PS0yKmRhdGEub2Zmc2V0WzFdLG5ld092ZXJUb3AsbmV3T3ZlckJvdHRvbTtpZihvdmVyVG9wPDApe25ld092ZXJCb3R0b209cG9zaXRpb24udG9wK215T2Zmc2V0K2F0T2Zmc2V0K29mZnNldCtkYXRhLmNvbGxpc2lvbkhlaWdodC1vdXRlckhlaWdodC13aXRoaW5PZmZzZXQ7aWYoKHBvc2l0aW9uLnRvcCtteU9mZnNldCthdE9mZnNldCtvZmZzZXQpPm92ZXJUb3AmJihuZXdPdmVyQm90dG9tPDB8fG5ld092ZXJCb3R0b208YWJzKG92ZXJUb3ApKSl7cG9zaXRpb24udG9wKz1teU9mZnNldCthdE9mZnNldCtvZmZzZXQ7fX0KZWxzZSBpZihvdmVyQm90dG9tPjApe25ld092ZXJUb3A9cG9zaXRpb24udG9wLWRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wK215T2Zmc2V0K2F0T2Zmc2V0K29mZnNldC1vZmZzZXRUb3A7aWYoKHBvc2l0aW9uLnRvcCtteU9mZnNldCthdE9mZnNldCtvZmZzZXQpPm92ZXJCb3R0b20mJihuZXdPdmVyVG9wPjB8fGFicyhuZXdPdmVyVG9wKTxvdmVyQm90dG9tKSl7cG9zaXRpb24udG9wKz1teU9mZnNldCthdE9mZnNldCtvZmZzZXQ7fX19fSxmbGlwZml0OntsZWZ0OmZ1bmN0aW9uKCl7JC51aS5wb3NpdGlvbi5mbGlwLmxlZnQuYXBwbHkodGhpcyxhcmd1bWVudHMpOyQudWkucG9zaXRpb24uZml0LmxlZnQuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sdG9wOmZ1bmN0aW9uKCl7JC51aS5wb3NpdGlvbi5mbGlwLnRvcC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7JC51aS5wb3NpdGlvbi5maXQudG9wLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fX07KGZ1bmN0aW9uKCl7dmFyIHRlc3RFbGVtZW50LHRlc3RFbGVtZW50UGFyZW50LHRlc3RFbGVtZW50U3R5bGUsb2Zmc2V0TGVmdCxpLGJvZHk9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImJvZHkiKVswXSxkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7dGVzdEVsZW1lbnQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChib2R5PyJkaXYiOiJib2R5Iik7dGVzdEVsZW1lbnRTdHlsZT17dmlzaWJpbGl0eToiaGlkZGVuIix3aWR0aDowLGhlaWdodDowLGJvcmRlcjowLG1hcmdpbjowLGJhY2tncm91bmQ6Im5vbmUifTtpZihib2R5KXskLmV4dGVuZCh0ZXN0RWxlbWVudFN0eWxlLHtwb3NpdGlvbjoiYWJzb2x1dGUiLGxlZnQ6Ii0xMDAwcHgiLHRvcDoiLTEwMDBweCJ9KTt9CmZvcihpIGluIHRlc3RFbGVtZW50U3R5bGUpe3Rlc3RFbGVtZW50LnN0eWxlW2ldPXRlc3RFbGVtZW50U3R5bGVbaV07fQp0ZXN0RWxlbWVudC5hcHBlbmRDaGlsZChkaXYpO3Rlc3RFbGVtZW50UGFyZW50PWJvZHl8fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDt0ZXN0RWxlbWVudFBhcmVudC5pbnNlcnRCZWZvcmUodGVzdEVsZW1lbnQsdGVzdEVsZW1lbnRQYXJlbnQuZmlyc3RDaGlsZCk7ZGl2LnN0eWxlLmNzc1RleHQ9InBvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogMTAuNzQzMjIyMnB4OyI7b2Zmc2V0TGVmdD0kKGRpdikub2Zmc2V0KCkubGVmdDskLnN1cHBvcnQub2Zmc2V0RnJhY3Rpb25zPW9mZnNldExlZnQ+MTAmJm9mZnNldExlZnQ8MTE7dGVzdEVsZW1lbnQuaW5uZXJIVE1MPSIiO3Rlc3RFbGVtZW50UGFyZW50LnJlbW92ZUNoaWxkKHRlc3RFbGVtZW50KTt9KSgpO30oalF1ZXJ5KSk7KGZ1bmN0aW9uKCQsdW5kZWZpbmVkKXskLndpZGdldCgidWkuYXV0b2NvbXBsZXRlIix7dmVyc2lvbjoiMS4xMC40IixkZWZhdWx0RWxlbWVudDoiPGlucHV0PiIsb3B0aW9uczp7YXBwZW5kVG86bnVsbCxhdXRvRm9jdXM6ZmFsc2UsZGVsYXk6MzAwLG1pbkxlbmd0aDoxLHBvc2l0aW9uOntteToibGVmdCB0b3AiLGF0OiJsZWZ0IGJvdHRvbSIsY29sbGlzaW9uOiJub25lIn0sc291cmNlOm51bGwsY2hhbmdlOm51bGwsY2xvc2U6bnVsbCxmb2N1czpudWxsLG9wZW46bnVsbCxyZXNwb25zZTpudWxsLHNlYXJjaDpudWxsLHNlbGVjdDpudWxsfSxyZXF1ZXN0SW5kZXg6MCxwZW5kaW5nOjAsX2NyZWF0ZTpmdW5jdGlvbigpe3ZhciBzdXBwcmVzc0tleVByZXNzLHN1cHByZXNzS2V5UHJlc3NSZXBlYXQsc3VwcHJlc3NJbnB1dCxub2RlTmFtZT10aGlzLmVsZW1lbnRbMF0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxpc1RleHRhcmVhPW5vZGVOYW1lPT09InRleHRhcmVhIixpc0lucHV0PW5vZGVOYW1lPT09ImlucHV0Ijt0aGlzLmlzTXVsdGlMaW5lPWlzVGV4dGFyZWE/dHJ1ZTppc0lucHV0P2ZhbHNlOnRoaXMuZWxlbWVudC5wcm9wKCJpc0NvbnRlbnRFZGl0YWJsZSIpO3RoaXMudmFsdWVNZXRob2Q9dGhpcy5lbGVtZW50W2lzVGV4dGFyZWF8fGlzSW5wdXQ/InZhbCI6InRleHQiXTt0aGlzLmlzTmV3TWVudT10cnVlO3RoaXMuZWxlbWVudC5hZGRDbGFzcygidWktYXV0b2NvbXBsZXRlLWlucHV0IikuYXR0cigiYXV0b2NvbXBsZXRlIiwib2ZmIik7dGhpcy5fb24odGhpcy5lbGVtZW50LHtrZXlkb3duOmZ1bmN0aW9uKGV2ZW50KXtpZih0aGlzLmVsZW1lbnQucHJvcCgicmVhZE9ubHkiKSl7c3VwcHJlc3NLZXlQcmVzcz10cnVlO3N1cHByZXNzSW5wdXQ9dHJ1ZTtzdXBwcmVzc0tleVByZXNzUmVwZWF0PXRydWU7cmV0dXJuO30Kc3VwcHJlc3NLZXlQcmVzcz1mYWxzZTtzdXBwcmVzc0lucHV0PWZhbHNlO3N1cHByZXNzS2V5UHJlc3NSZXBlYXQ9ZmFsc2U7dmFyIGtleUNvZGU9JC51aS5rZXlDb2RlO3N3aXRjaChldmVudC5rZXlDb2RlKXtjYXNlIGtleUNvZGUuUEFHRV9VUDpzdXBwcmVzc0tleVByZXNzPXRydWU7dGhpcy5fbW92ZSgicHJldmlvdXNQYWdlIixldmVudCk7YnJlYWs7Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjpzdXBwcmVzc0tleVByZXNzPXRydWU7dGhpcy5fbW92ZSgibmV4dFBhZ2UiLGV2ZW50KTticmVhaztjYXNlIGtleUNvZGUuVVA6c3VwcHJlc3NLZXlQcmVzcz10cnVlO3RoaXMuX2tleUV2ZW50KCJwcmV2aW91cyIsZXZlbnQpO2JyZWFrO2Nhc2Uga2V5Q29kZS5ET1dOOnN1cHByZXNzS2V5UHJlc3M9dHJ1ZTt0aGlzLl9rZXlFdmVudCgibmV4dCIsZXZlbnQpO2JyZWFrO2Nhc2Uga2V5Q29kZS5FTlRFUjpjYXNlIGtleUNvZGUuTlVNUEFEX0VOVEVSOmlmKHRoaXMubWVudS5hY3RpdmUpe3N1cHByZXNzS2V5UHJlc3M9dHJ1ZTtldmVudC5wcmV2ZW50RGVmYXVsdCgpO3RoaXMubWVudS5zZWxlY3QoZXZlbnQpO30KYnJlYWs7Y2FzZSBrZXlDb2RlLlRBQjppZih0aGlzLm1lbnUuYWN0aXZlKXt0aGlzLm1lbnUuc2VsZWN0KGV2ZW50KTt9CmJyZWFrO2Nhc2Uga2V5Q29kZS5FU0NBUEU6aWYodGhpcy5tZW51LmVsZW1lbnQuaXMoIjp2aXNpYmxlIikpe3RoaXMuX3ZhbHVlKHRoaXMudGVybSk7dGhpcy5jbG9zZShldmVudCk7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9CmJyZWFrO2RlZmF1bHQ6c3VwcHJlc3NLZXlQcmVzc1JlcGVhdD10cnVlO3RoaXMuX3NlYXJjaFRpbWVvdXQoZXZlbnQpO2JyZWFrO319LGtleXByZXNzOmZ1bmN0aW9uKGV2ZW50KXtpZihzdXBwcmVzc0tleVByZXNzKXtzdXBwcmVzc0tleVByZXNzPWZhbHNlO2lmKCF0aGlzLmlzTXVsdGlMaW5lfHx0aGlzLm1lbnUuZWxlbWVudC5pcygiOnZpc2libGUiKSl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9CnJldHVybjt9CmlmKHN1cHByZXNzS2V5UHJlc3NSZXBlYXQpe3JldHVybjt9CnZhciBrZXlDb2RlPSQudWkua2V5Q29kZTtzd2l0Y2goZXZlbnQua2V5Q29kZSl7Y2FzZSBrZXlDb2RlLlBBR0VfVVA6dGhpcy5fbW92ZSgicHJldmlvdXNQYWdlIixldmVudCk7YnJlYWs7Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjp0aGlzLl9tb3ZlKCJuZXh0UGFnZSIsZXZlbnQpO2JyZWFrO2Nhc2Uga2V5Q29kZS5VUDp0aGlzLl9rZXlFdmVudCgicHJldmlvdXMiLGV2ZW50KTticmVhaztjYXNlIGtleUNvZGUuRE9XTjp0aGlzLl9rZXlFdmVudCgibmV4dCIsZXZlbnQpO2JyZWFrO319LGlucHV0OmZ1bmN0aW9uKGV2ZW50KXtpZihzdXBwcmVzc0lucHV0KXtzdXBwcmVzc0lucHV0PWZhbHNlO2V2ZW50LnByZXZlbnREZWZhdWx0KCk7cmV0dXJuO30KdGhpcy5fc2VhcmNoVGltZW91dChldmVudCk7fSxmb2N1czpmdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWRJdGVtPW51bGw7dGhpcy5wcmV2aW91cz10aGlzLl92YWx1ZSgpO30sYmx1cjpmdW5jdGlvbihldmVudCl7aWYodGhpcy5jYW5jZWxCbHVyKXtkZWxldGUgdGhpcy5jYW5jZWxCbHVyO3JldHVybjt9CmNsZWFyVGltZW91dCh0aGlzLnNlYXJjaGluZyk7dGhpcy5jbG9zZShldmVudCk7dGhpcy5fY2hhbmdlKGV2ZW50KTt9fSk7dGhpcy5faW5pdFNvdXJjZSgpO3RoaXMubWVudT0kKCI8dWw+IikuYWRkQ2xhc3MoInVpLWF1dG9jb21wbGV0ZSB1aS1mcm9udCIpLmFwcGVuZFRvKHRoaXMuX2FwcGVuZFRvKCkpLm1lbnUoe3JvbGU6bnVsbH0pLmhpZGUoKS5kYXRhKCJ1aS1tZW51Iik7dGhpcy5fb24odGhpcy5tZW51LmVsZW1lbnQse21vdXNlZG93bjpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt0aGlzLmNhbmNlbEJsdXI9dHJ1ZTt0aGlzLl9kZWxheShmdW5jdGlvbigpe2RlbGV0ZSB0aGlzLmNhbmNlbEJsdXI7fSk7dmFyIG1lbnVFbGVtZW50PXRoaXMubWVudS5lbGVtZW50WzBdO2lmKCEkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgiLnVpLW1lbnUtaXRlbSIpLmxlbmd0aCl7dGhpcy5fZGVsYXkoZnVuY3Rpb24oKXt2YXIgdGhhdD10aGlzO3RoaXMuZG9jdW1lbnQub25lKCJtb3VzZWRvd24iLGZ1bmN0aW9uKGV2ZW50KXtpZihldmVudC50YXJnZXQhPT10aGF0LmVsZW1lbnRbMF0mJmV2ZW50LnRhcmdldCE9PW1lbnVFbGVtZW50JiYhJC5jb250YWlucyhtZW51RWxlbWVudCxldmVudC50YXJnZXQpKXt0aGF0LmNsb3NlKCk7fX0pO30pO319LG1lbnVmb2N1czpmdW5jdGlvbihldmVudCx1aSl7aWYodGhpcy5pc05ld01lbnUpe3RoaXMuaXNOZXdNZW51PWZhbHNlO2lmKGV2ZW50Lm9yaWdpbmFsRXZlbnQmJi9ebW91c2UvLnRlc3QoZXZlbnQub3JpZ2luYWxFdmVudC50eXBlKSl7dGhpcy5tZW51LmJsdXIoKTt0aGlzLmRvY3VtZW50Lm9uZSgibW91c2Vtb3ZlIixmdW5jdGlvbigpeyQoZXZlbnQudGFyZ2V0KS50cmlnZ2VyKGV2ZW50Lm9yaWdpbmFsRXZlbnQpO30pO3JldHVybjt9fQp2YXIgaXRlbT11aS5pdGVtLmRhdGEoInVpLWF1dG9jb21wbGV0ZS1pdGVtIik7aWYoZmFsc2UhPT10aGlzLl90cmlnZ2VyKCJmb2N1cyIsZXZlbnQse2l0ZW06aXRlbX0pKXtpZihldmVudC5vcmlnaW5hbEV2ZW50JiYvXmtleS8udGVzdChldmVudC5vcmlnaW5hbEV2ZW50LnR5cGUpKXt0aGlzLl92YWx1ZShpdGVtLnZhbHVlKTt9fWVsc2V7dGhpcy5saXZlUmVnaW9uLnRleHQoaXRlbS52YWx1ZSk7fX0sbWVudXNlbGVjdDpmdW5jdGlvbihldmVudCx1aSl7dmFyIGl0ZW09dWkuaXRlbS5kYXRhKCJ1aS1hdXRvY29tcGxldGUtaXRlbSIpLHByZXZpb3VzPXRoaXMucHJldmlvdXM7aWYodGhpcy5lbGVtZW50WzBdIT09dGhpcy5kb2N1bWVudFswXS5hY3RpdmVFbGVtZW50KXt0aGlzLmVsZW1lbnQuZm9jdXMoKTt0aGlzLnByZXZpb3VzPXByZXZpb3VzO3RoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5wcmV2aW91cz1wcmV2aW91czt0aGlzLnNlbGVjdGVkSXRlbT1pdGVtO30pO30KaWYoZmFsc2UhPT10aGlzLl90cmlnZ2VyKCJzZWxlY3QiLGV2ZW50LHtpdGVtOml0ZW19KSl7dGhpcy5fdmFsdWUoaXRlbS52YWx1ZSk7fQp0aGlzLnRlcm09dGhpcy5fdmFsdWUoKTt0aGlzLmNsb3NlKGV2ZW50KTt0aGlzLnNlbGVjdGVkSXRlbT1pdGVtO319KTt0aGlzLmxpdmVSZWdpb249JCgiPHNwYW4+Iix7cm9sZToic3RhdHVzIiwiYXJpYS1saXZlIjoicG9saXRlIn0pLmFkZENsYXNzKCJ1aS1oZWxwZXItaGlkZGVuLWFjY2Vzc2libGUiKS5pbnNlcnRCZWZvcmUodGhpcy5lbGVtZW50KTt0aGlzLl9vbih0aGlzLndpbmRvdyx7YmVmb3JldW5sb2FkOmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoImF1dG9jb21wbGV0ZSIpO319KTt9LF9kZXN0cm95OmZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRoaXMuc2VhcmNoaW5nKTt0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoInVpLWF1dG9jb21wbGV0ZS1pbnB1dCIpLnJlbW92ZUF0dHIoImF1dG9jb21wbGV0ZSIpO3RoaXMubWVudS5lbGVtZW50LnJlbW92ZSgpO3RoaXMubGl2ZVJlZ2lvbi5yZW1vdmUoKTt9LF9zZXRPcHRpb246ZnVuY3Rpb24oa2V5LHZhbHVlKXt0aGlzLl9zdXBlcihrZXksdmFsdWUpO2lmKGtleT09PSJzb3VyY2UiKXt0aGlzLl9pbml0U291cmNlKCk7fQppZihrZXk9PT0iYXBwZW5kVG8iKXt0aGlzLm1lbnUuZWxlbWVudC5hcHBlbmRUbyh0aGlzLl9hcHBlbmRUbygpKTt9CmlmKGtleT09PSJkaXNhYmxlZCImJnZhbHVlJiZ0aGlzLnhocil7dGhpcy54aHIuYWJvcnQoKTt9fSxfYXBwZW5kVG86ZnVuY3Rpb24oKXt2YXIgZWxlbWVudD10aGlzLm9wdGlvbnMuYXBwZW5kVG87aWYoZWxlbWVudCl7ZWxlbWVudD1lbGVtZW50LmpxdWVyeXx8ZWxlbWVudC5ub2RlVHlwZT8kKGVsZW1lbnQpOnRoaXMuZG9jdW1lbnQuZmluZChlbGVtZW50KS5lcSgwKTt9CmlmKCFlbGVtZW50KXtlbGVtZW50PXRoaXMuZWxlbWVudC5jbG9zZXN0KCIudWktZnJvbnQiKTt9CmlmKCFlbGVtZW50Lmxlbmd0aCl7ZWxlbWVudD10aGlzLmRvY3VtZW50WzBdLmJvZHk7fQpyZXR1cm4gZWxlbWVudDt9LF9pbml0U291cmNlOmZ1bmN0aW9uKCl7dmFyIGFycmF5LHVybCx0aGF0PXRoaXM7aWYoJC5pc0FycmF5KHRoaXMub3B0aW9ucy5zb3VyY2UpKXthcnJheT10aGlzLm9wdGlvbnMuc291cmNlO3RoaXMuc291cmNlPWZ1bmN0aW9uKHJlcXVlc3QscmVzcG9uc2Upe3Jlc3BvbnNlKCQudWkuYXV0b2NvbXBsZXRlLmZpbHRlcihhcnJheSxyZXF1ZXN0LnRlcm0pKTt9O31lbHNlIGlmKHR5cGVvZiB0aGlzLm9wdGlvbnMuc291cmNlPT09InN0cmluZyIpe3VybD10aGlzLm9wdGlvbnMuc291cmNlO3RoaXMuc291cmNlPWZ1bmN0aW9uKHJlcXVlc3QscmVzcG9uc2Upe2lmKHRoYXQueGhyKXt0aGF0Lnhoci5hYm9ydCgpO30KdGhhdC54aHI9JC5hamF4KHt1cmw6dXJsLGRhdGE6cmVxdWVzdCxkYXRhVHlwZToianNvbiIsc3VjY2VzczpmdW5jdGlvbihkYXRhKXtyZXNwb25zZShkYXRhKTt9LGVycm9yOmZ1bmN0aW9uKCl7cmVzcG9uc2UoW10pO319KTt9O31lbHNle3RoaXMuc291cmNlPXRoaXMub3B0aW9ucy5zb3VyY2U7fX0sX3NlYXJjaFRpbWVvdXQ6ZnVuY3Rpb24oZXZlbnQpe2NsZWFyVGltZW91dCh0aGlzLnNlYXJjaGluZyk7dGhpcy5zZWFyY2hpbmc9dGhpcy5fZGVsYXkoZnVuY3Rpb24oKXtpZih0aGlzLnRlcm0hPT10aGlzLl92YWx1ZSgpKXt0aGlzLnNlbGVjdGVkSXRlbT1udWxsO3RoaXMuc2VhcmNoKG51bGwsZXZlbnQpO319LHRoaXMub3B0aW9ucy5kZWxheSk7fSxzZWFyY2g6ZnVuY3Rpb24odmFsdWUsZXZlbnQpe3ZhbHVlPXZhbHVlIT1udWxsP3ZhbHVlOnRoaXMuX3ZhbHVlKCk7dGhpcy50ZXJtPXRoaXMuX3ZhbHVlKCk7aWYodmFsdWUubGVuZ3RoPHRoaXMub3B0aW9ucy5taW5MZW5ndGgpe3JldHVybiB0aGlzLmNsb3NlKGV2ZW50KTt9CmlmKHRoaXMuX3RyaWdnZXIoInNlYXJjaCIsZXZlbnQpPT09ZmFsc2Upe3JldHVybjt9CnJldHVybiB0aGlzLl9zZWFyY2godmFsdWUpO30sX3NlYXJjaDpmdW5jdGlvbih2YWx1ZSl7dGhpcy5wZW5kaW5nKys7dGhpcy5lbGVtZW50LmFkZENsYXNzKCJ1aS1hdXRvY29tcGxldGUtbG9hZGluZyIpO3RoaXMuY2FuY2VsU2VhcmNoPWZhbHNlO3RoaXMuc291cmNlKHt0ZXJtOnZhbHVlfSx0aGlzLl9yZXNwb25zZSgpKTt9LF9yZXNwb25zZTpmdW5jdGlvbigpe3ZhciBpbmRleD0rK3RoaXMucmVxdWVzdEluZGV4O3JldHVybiAkLnByb3h5KGZ1bmN0aW9uKGNvbnRlbnQpe2lmKGluZGV4PT09dGhpcy5yZXF1ZXN0SW5kZXgpe3RoaXMuX19yZXNwb25zZShjb250ZW50KTt9CnRoaXMucGVuZGluZy0tO2lmKCF0aGlzLnBlbmRpbmcpe3RoaXMuZWxlbWVudC5yZW1vdmVDbGFzcygidWktYXV0b2NvbXBsZXRlLWxvYWRpbmciKTt9fSx0aGlzKTt9LF9fcmVzcG9uc2U6ZnVuY3Rpb24oY29udGVudCl7aWYoY29udGVudCl7Y29udGVudD10aGlzLl9ub3JtYWxpemUoY29udGVudCk7fQp0aGlzLl90cmlnZ2VyKCJyZXNwb25zZSIsbnVsbCx7Y29udGVudDpjb250ZW50fSk7aWYoIXRoaXMub3B0aW9ucy5kaXNhYmxlZCYmY29udGVudCYmY29udGVudC5sZW5ndGgmJiF0aGlzLmNhbmNlbFNlYXJjaCl7dGhpcy5fc3VnZ2VzdChjb250ZW50KTt0aGlzLl90cmlnZ2VyKCJvcGVuIik7fWVsc2V7dGhpcy5fY2xvc2UoKTt9fSxjbG9zZTpmdW5jdGlvbihldmVudCl7dGhpcy5jYW5jZWxTZWFyY2g9dHJ1ZTt0aGlzLl9jbG9zZShldmVudCk7fSxfY2xvc2U6ZnVuY3Rpb24oZXZlbnQpe2lmKHRoaXMubWVudS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpKXt0aGlzLm1lbnUuZWxlbWVudC5oaWRlKCk7dGhpcy5tZW51LmJsdXIoKTt0aGlzLmlzTmV3TWVudT10cnVlO3RoaXMuX3RyaWdnZXIoImNsb3NlIixldmVudCk7fX0sX2NoYW5nZTpmdW5jdGlvbihldmVudCl7aWYodGhpcy5wcmV2aW91cyE9PXRoaXMuX3ZhbHVlKCkpe3RoaXMuX3RyaWdnZXIoImNoYW5nZSIsZXZlbnQse2l0ZW06dGhpcy5zZWxlY3RlZEl0ZW19KTt9fSxfbm9ybWFsaXplOmZ1bmN0aW9uKGl0ZW1zKXtpZihpdGVtcy5sZW5ndGgmJml0ZW1zWzBdLmxhYmVsJiZpdGVtc1swXS52YWx1ZSl7cmV0dXJuIGl0ZW1zO30KcmV0dXJuICQubWFwKGl0ZW1zLGZ1bmN0aW9uKGl0ZW0pe2lmKHR5cGVvZiBpdGVtPT09InN0cmluZyIpe3JldHVybntsYWJlbDppdGVtLHZhbHVlOml0ZW19O30KcmV0dXJuICQuZXh0ZW5kKHtsYWJlbDppdGVtLmxhYmVsfHxpdGVtLnZhbHVlLHZhbHVlOml0ZW0udmFsdWV8fGl0ZW0ubGFiZWx9LGl0ZW0pO30pO30sX3N1Z2dlc3Q6ZnVuY3Rpb24oaXRlbXMpe3ZhciB1bD10aGlzLm1lbnUuZWxlbWVudC5lbXB0eSgpO3RoaXMuX3JlbmRlck1lbnUodWwsaXRlbXMpO3RoaXMuaXNOZXdNZW51PXRydWU7dGhpcy5tZW51LnJlZnJlc2goKTt1bC5zaG93KCk7dGhpcy5fcmVzaXplTWVudSgpO3VsLnBvc2l0aW9uKCQuZXh0ZW5kKHtvZjp0aGlzLmVsZW1lbnR9LHRoaXMub3B0aW9ucy5wb3NpdGlvbikpO2lmKHRoaXMub3B0aW9ucy5hdXRvRm9jdXMpe3RoaXMubWVudS5uZXh0KCk7fX0sX3Jlc2l6ZU1lbnU6ZnVuY3Rpb24oKXt2YXIgdWw9dGhpcy5tZW51LmVsZW1lbnQ7dWwub3V0ZXJXaWR0aChNYXRoLm1heCh1bC53aWR0aCgiIikub3V0ZXJXaWR0aCgpKzEsdGhpcy5lbGVtZW50Lm91dGVyV2lkdGgoKSkpO30sX3JlbmRlck1lbnU6ZnVuY3Rpb24odWwsaXRlbXMpe3ZhciB0aGF0PXRoaXM7JC5lYWNoKGl0ZW1zLGZ1bmN0aW9uKGluZGV4LGl0ZW0pe3RoYXQuX3JlbmRlckl0ZW1EYXRhKHVsLGl0ZW0pO30pO30sX3JlbmRlckl0ZW1EYXRhOmZ1bmN0aW9uKHVsLGl0ZW0pe3JldHVybiB0aGlzLl9yZW5kZXJJdGVtKHVsLGl0ZW0pLmRhdGEoInVpLWF1dG9jb21wbGV0ZS1pdGVtIixpdGVtKTt9LF9yZW5kZXJJdGVtOmZ1bmN0aW9uKHVsLGl0ZW0pe3JldHVybiAkKCI8bGk+IikuYXBwZW5kKCQoIjxhPiIpLnRleHQoaXRlbS5sYWJlbCkpLmFwcGVuZFRvKHVsKTt9LF9tb3ZlOmZ1bmN0aW9uKGRpcmVjdGlvbixldmVudCl7aWYoIXRoaXMubWVudS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpKXt0aGlzLnNlYXJjaChudWxsLGV2ZW50KTtyZXR1cm47fQppZih0aGlzLm1lbnUuaXNGaXJzdEl0ZW0oKSYmL15wcmV2aW91cy8udGVzdChkaXJlY3Rpb24pfHx0aGlzLm1lbnUuaXNMYXN0SXRlbSgpJiYvXm5leHQvLnRlc3QoZGlyZWN0aW9uKSl7dGhpcy5fdmFsdWUodGhpcy50ZXJtKTt0aGlzLm1lbnUuYmx1cigpO3JldHVybjt9CnRoaXMubWVudVtkaXJlY3Rpb25dKGV2ZW50KTt9LHdpZGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1lbnUuZWxlbWVudDt9LF92YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbHVlTWV0aG9kLmFwcGx5KHRoaXMuZWxlbWVudCxhcmd1bWVudHMpO30sX2tleUV2ZW50OmZ1bmN0aW9uKGtleUV2ZW50LGV2ZW50KXtpZighdGhpcy5pc011bHRpTGluZXx8dGhpcy5tZW51LmVsZW1lbnQuaXMoIjp2aXNpYmxlIikpe3RoaXMuX21vdmUoa2V5RXZlbnQsZXZlbnQpO2V2ZW50LnByZXZlbnREZWZhdWx0KCk7fX19KTskLmV4dGVuZCgkLnVpLmF1dG9jb21wbGV0ZSx7ZXNjYXBlUmVnZXg6ZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZS5yZXBsYWNlKC9bXC1cW1xde30oKSorPy4sXFxcXiR8I1xzXS9nLCJcXCQmIik7fSxmaWx0ZXI6ZnVuY3Rpb24oYXJyYXksdGVybSl7dmFyIG1hdGNoZXI9bmV3IFJlZ0V4cCgkLnVpLmF1dG9jb21wbGV0ZS5lc2NhcGVSZWdleCh0ZXJtKSwiaSIpO3JldHVybiAkLmdyZXAoYXJyYXksZnVuY3Rpb24odmFsdWUpe3JldHVybiBtYXRjaGVyLnRlc3QodmFsdWUubGFiZWx8fHZhbHVlLnZhbHVlfHx2YWx1ZSk7fSk7fX0pOyQud2lkZ2V0KCJ1aS5hdXRvY29tcGxldGUiLCQudWkuYXV0b2NvbXBsZXRlLHtvcHRpb25zOnttZXNzYWdlczp7bm9SZXN1bHRzOiJObyBzZWFyY2ggcmVzdWx0cy4iLHJlc3VsdHM6ZnVuY3Rpb24oYW1vdW50KXtyZXR1cm4gYW1vdW50KyhhbW91bnQ+MT8iIHJlc3VsdHMgYXJlIjoiIHJlc3VsdCBpcyIpKyIgYXZhaWxhYmxlLCB1c2UgdXAgYW5kIGRvd24gYXJyb3cga2V5cyB0byBuYXZpZ2F0ZS4iO319fSxfX3Jlc3BvbnNlOmZ1bmN0aW9uKGNvbnRlbnQpe3ZhciBtZXNzYWdlO3RoaXMuX3N1cGVyQXBwbHkoYXJndW1lbnRzKTtpZih0aGlzLm9wdGlvbnMuZGlzYWJsZWR8fHRoaXMuY2FuY2VsU2VhcmNoKXtyZXR1cm47fQppZihjb250ZW50JiZjb250ZW50Lmxlbmd0aCl7bWVzc2FnZT10aGlzLm9wdGlvbnMubWVzc2FnZXMucmVzdWx0cyhjb250ZW50Lmxlbmd0aCk7fWVsc2V7bWVzc2FnZT10aGlzLm9wdGlvbnMubWVzc2FnZXMubm9SZXN1bHRzO30KdGhpcy5saXZlUmVnaW9uLnRleHQobWVzc2FnZSk7fX0pO30oalF1ZXJ5KSk7KGZ1bmN0aW9uKCQsdW5kZWZpbmVkKXskLndpZGdldCgidWkubWVudSIse3ZlcnNpb246IjEuMTAuNCIsZGVmYXVsdEVsZW1lbnQ6Ijx1bD4iLGRlbGF5OjMwMCxvcHRpb25zOntpY29uczp7c3VibWVudToidWktaWNvbi1jYXJhdC0xLWUifSxtZW51czoidWwiLHBvc2l0aW9uOntteToibGVmdCB0b3AiLGF0OiJyaWdodCB0b3AifSxyb2xlOiJtZW51IixibHVyOm51bGwsZm9jdXM6bnVsbCxzZWxlY3Q6bnVsbH0sX2NyZWF0ZTpmdW5jdGlvbigpe3RoaXMuYWN0aXZlTWVudT10aGlzLmVsZW1lbnQ7dGhpcy5tb3VzZUhhbmRsZWQ9ZmFsc2U7dGhpcy5lbGVtZW50LnVuaXF1ZUlkKCkuYWRkQ2xhc3MoInVpLW1lbnUgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwiKS50b2dnbGVDbGFzcygidWktbWVudS1pY29ucyIsISF0aGlzLmVsZW1lbnQuZmluZCgiLnVpLWljb24iKS5sZW5ndGgpLmF0dHIoe3JvbGU6dGhpcy5vcHRpb25zLnJvbGUsdGFiSW5kZXg6MH0pLmJpbmQoImNsaWNrIit0aGlzLmV2ZW50TmFtZXNwYWNlLCQucHJveHkoZnVuY3Rpb24oZXZlbnQpe2lmKHRoaXMub3B0aW9ucy5kaXNhYmxlZCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9fSx0aGlzKSk7aWYodGhpcy5vcHRpb25zLmRpc2FibGVkKXt0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoInVpLXN0YXRlLWRpc2FibGVkIikuYXR0cigiYXJpYS1kaXNhYmxlZCIsInRydWUiKTt9CnRoaXMuX29uKHsibW91c2Vkb3duIC51aS1tZW51LWl0ZW0gPiBhIjpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9LCJjbGljayAudWktc3RhdGUtZGlzYWJsZWQgPiBhIjpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9LCJjbGljayAudWktbWVudS1pdGVtOmhhcyhhKSI6ZnVuY3Rpb24oZXZlbnQpe3ZhciB0YXJnZXQ9JChldmVudC50YXJnZXQpLmNsb3Nlc3QoIi51aS1tZW51LWl0ZW0iKTtpZighdGhpcy5tb3VzZUhhbmRsZWQmJnRhcmdldC5ub3QoIi51aS1zdGF0ZS1kaXNhYmxlZCIpLmxlbmd0aCl7dGhpcy5zZWxlY3QoZXZlbnQpO2lmKCFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKXt0aGlzLm1vdXNlSGFuZGxlZD10cnVlO30KaWYodGFyZ2V0LmhhcygiLnVpLW1lbnUiKS5sZW5ndGgpe3RoaXMuZXhwYW5kKGV2ZW50KTt9ZWxzZSBpZighdGhpcy5lbGVtZW50LmlzKCI6Zm9jdXMiKSYmJCh0aGlzLmRvY3VtZW50WzBdLmFjdGl2ZUVsZW1lbnQpLmNsb3Nlc3QoIi51aS1tZW51IikubGVuZ3RoKXt0aGlzLmVsZW1lbnQudHJpZ2dlcigiZm9jdXMiLFt0cnVlXSk7aWYodGhpcy5hY3RpdmUmJnRoaXMuYWN0aXZlLnBhcmVudHMoIi51aS1tZW51IikubGVuZ3RoPT09MSl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO319fX0sIm1vdXNlZW50ZXIgLnVpLW1lbnUtaXRlbSI6ZnVuY3Rpb24oZXZlbnQpe3ZhciB0YXJnZXQ9JChldmVudC5jdXJyZW50VGFyZ2V0KTt0YXJnZXQuc2libGluZ3MoKS5jaGlsZHJlbigiLnVpLXN0YXRlLWFjdGl2ZSIpLnJlbW92ZUNsYXNzKCJ1aS1zdGF0ZS1hY3RpdmUiKTt0aGlzLmZvY3VzKGV2ZW50LHRhcmdldCk7fSxtb3VzZWxlYXZlOiJjb2xsYXBzZUFsbCIsIm1vdXNlbGVhdmUgLnVpLW1lbnUiOiJjb2xsYXBzZUFsbCIsZm9jdXM6ZnVuY3Rpb24oZXZlbnQsa2VlcEFjdGl2ZUl0ZW0pe3ZhciBpdGVtPXRoaXMuYWN0aXZlfHx0aGlzLmVsZW1lbnQuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0iKS5lcSgwKTtpZigha2VlcEFjdGl2ZUl0ZW0pe3RoaXMuZm9jdXMoZXZlbnQsaXRlbSk7fX0sYmx1cjpmdW5jdGlvbihldmVudCl7dGhpcy5fZGVsYXkoZnVuY3Rpb24oKXtpZighJC5jb250YWlucyh0aGlzLmVsZW1lbnRbMF0sdGhpcy5kb2N1bWVudFswXS5hY3RpdmVFbGVtZW50KSl7dGhpcy5jb2xsYXBzZUFsbChldmVudCk7fX0pO30sa2V5ZG93bjoiX2tleWRvd24ifSk7dGhpcy5yZWZyZXNoKCk7dGhpcy5fb24odGhpcy5kb2N1bWVudCx7Y2xpY2s6ZnVuY3Rpb24oZXZlbnQpe2lmKCEkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgiLnVpLW1lbnUiKS5sZW5ndGgpe3RoaXMuY29sbGFwc2VBbGwoZXZlbnQpO30KdGhpcy5tb3VzZUhhbmRsZWQ9ZmFsc2U7fX0pO30sX2Rlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cigiYXJpYS1hY3RpdmVkZXNjZW5kYW50IikuZmluZCgiLnVpLW1lbnUiKS5hZGRCYWNrKCkucmVtb3ZlQ2xhc3MoInVpLW1lbnUgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwgdWktbWVudS1pY29ucyIpLnJlbW92ZUF0dHIoInJvbGUiKS5yZW1vdmVBdHRyKCJ0YWJJbmRleCIpLnJlbW92ZUF0dHIoImFyaWEtbGFiZWxsZWRieSIpLnJlbW92ZUF0dHIoImFyaWEtZXhwYW5kZWQiKS5yZW1vdmVBdHRyKCJhcmlhLWhpZGRlbiIpLnJlbW92ZUF0dHIoImFyaWEtZGlzYWJsZWQiKS5yZW1vdmVVbmlxdWVJZCgpLnNob3coKTt0aGlzLmVsZW1lbnQuZmluZCgiLnVpLW1lbnUtaXRlbSIpLnJlbW92ZUNsYXNzKCJ1aS1tZW51LWl0ZW0iKS5yZW1vdmVBdHRyKCJyb2xlIikucmVtb3ZlQXR0cigiYXJpYS1kaXNhYmxlZCIpLmNoaWxkcmVuKCJhIikucmVtb3ZlVW5pcXVlSWQoKS5yZW1vdmVDbGFzcygidWktY29ybmVyLWFsbCB1aS1zdGF0ZS1ob3ZlciIpLnJlbW92ZUF0dHIoInRhYkluZGV4IikucmVtb3ZlQXR0cigicm9sZSIpLnJlbW92ZUF0dHIoImFyaWEtaGFzcG9wdXAiKS5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24oKXt2YXIgZWxlbT0kKHRoaXMpO2lmKGVsZW0uZGF0YSgidWktbWVudS1zdWJtZW51LWNhcmF0Iikpe2VsZW0ucmVtb3ZlKCk7fX0pO3RoaXMuZWxlbWVudC5maW5kKCIudWktbWVudS1kaXZpZGVyIikucmVtb3ZlQ2xhc3MoInVpLW1lbnUtZGl2aWRlciB1aS13aWRnZXQtY29udGVudCIpO30sX2tleWRvd246ZnVuY3Rpb24oZXZlbnQpe3ZhciBtYXRjaCxwcmV2LGNoYXJhY3Rlcixza2lwLHJlZ2V4LHByZXZlbnREZWZhdWx0PXRydWU7ZnVuY3Rpb24gZXNjYXBlKHZhbHVlKXtyZXR1cm4gdmFsdWUucmVwbGFjZSgvW1wtXFtcXXt9KCkqKz8uLFxcXF4kfCNcc10vZywiXFwkJiIpO30Kc3dpdGNoKGV2ZW50LmtleUNvZGUpe2Nhc2UgJC51aS5rZXlDb2RlLlBBR0VfVVA6dGhpcy5wcmV2aW91c1BhZ2UoZXZlbnQpO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLlBBR0VfRE9XTjp0aGlzLm5leHRQYWdlKGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5IT01FOnRoaXMuX21vdmUoImZpcnN0IiwiZmlyc3QiLGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5FTkQ6dGhpcy5fbW92ZSgibGFzdCIsImxhc3QiLGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5VUDp0aGlzLnByZXZpb3VzKGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5ET1dOOnRoaXMubmV4dChldmVudCk7YnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuTEVGVDp0aGlzLmNvbGxhcHNlKGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5SSUdIVDppZih0aGlzLmFjdGl2ZSYmIXRoaXMuYWN0aXZlLmlzKCIudWktc3RhdGUtZGlzYWJsZWQiKSl7dGhpcy5leHBhbmQoZXZlbnQpO30KYnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuRU5URVI6Y2FzZSAkLnVpLmtleUNvZGUuU1BBQ0U6dGhpcy5fYWN0aXZhdGUoZXZlbnQpO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkVTQ0FQRTp0aGlzLmNvbGxhcHNlKGV2ZW50KTticmVhaztkZWZhdWx0OnByZXZlbnREZWZhdWx0PWZhbHNlO3ByZXY9dGhpcy5wcmV2aW91c0ZpbHRlcnx8IiI7Y2hhcmFjdGVyPVN0cmluZy5mcm9tQ2hhckNvZGUoZXZlbnQua2V5Q29kZSk7c2tpcD1mYWxzZTtjbGVhclRpbWVvdXQodGhpcy5maWx0ZXJUaW1lcik7aWYoY2hhcmFjdGVyPT09cHJldil7c2tpcD10cnVlO31lbHNle2NoYXJhY3Rlcj1wcmV2K2NoYXJhY3Rlcjt9CnJlZ2V4PW5ldyBSZWdFeHAoIl4iK2VzY2FwZShjaGFyYWN0ZXIpLCJpIik7bWF0Y2g9dGhpcy5hY3RpdmVNZW51LmNoaWxkcmVuKCIudWktbWVudS1pdGVtIikuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHJlZ2V4LnRlc3QoJCh0aGlzKS5jaGlsZHJlbigiYSIpLnRleHQoKSk7fSk7bWF0Y2g9c2tpcCYmbWF0Y2guaW5kZXgodGhpcy5hY3RpdmUubmV4dCgpKSE9PS0xP3RoaXMuYWN0aXZlLm5leHRBbGwoIi51aS1tZW51LWl0ZW0iKTptYXRjaDtpZighbWF0Y2gubGVuZ3RoKXtjaGFyYWN0ZXI9U3RyaW5nLmZyb21DaGFyQ29kZShldmVudC5rZXlDb2RlKTtyZWdleD1uZXcgUmVnRXhwKCJeIitlc2NhcGUoY2hhcmFjdGVyKSwiaSIpO21hdGNoPXRoaXMuYWN0aXZlTWVudS5jaGlsZHJlbigiLnVpLW1lbnUtaXRlbSIpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiByZWdleC50ZXN0KCQodGhpcykuY2hpbGRyZW4oImEiKS50ZXh0KCkpO30pO30KaWYobWF0Y2gubGVuZ3RoKXt0aGlzLmZvY3VzKGV2ZW50LG1hdGNoKTtpZihtYXRjaC5sZW5ndGg+MSl7dGhpcy5wcmV2aW91c0ZpbHRlcj1jaGFyYWN0ZXI7dGhpcy5maWx0ZXJUaW1lcj10aGlzLl9kZWxheShmdW5jdGlvbigpe2RlbGV0ZSB0aGlzLnByZXZpb3VzRmlsdGVyO30sMTAwMCk7fWVsc2V7ZGVsZXRlIHRoaXMucHJldmlvdXNGaWx0ZXI7fX1lbHNle2RlbGV0ZSB0aGlzLnByZXZpb3VzRmlsdGVyO319CmlmKHByZXZlbnREZWZhdWx0KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO319LF9hY3RpdmF0ZTpmdW5jdGlvbihldmVudCl7aWYoIXRoaXMuYWN0aXZlLmlzKCIudWktc3RhdGUtZGlzYWJsZWQiKSl7aWYodGhpcy5hY3RpdmUuY2hpbGRyZW4oImFbYXJpYS1oYXNwb3B1cD0ndHJ1ZSddIikubGVuZ3RoKXt0aGlzLmV4cGFuZChldmVudCk7fWVsc2V7dGhpcy5zZWxlY3QoZXZlbnQpO319fSxyZWZyZXNoOmZ1bmN0aW9uKCl7dmFyIG1lbnVzLGljb249dGhpcy5vcHRpb25zLmljb25zLnN1Ym1lbnUsc3VibWVudXM9dGhpcy5lbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLm1lbnVzKTt0aGlzLmVsZW1lbnQudG9nZ2xlQ2xhc3MoInVpLW1lbnUtaWNvbnMiLCEhdGhpcy5lbGVtZW50LmZpbmQoIi51aS1pY29uIikubGVuZ3RoKTtzdWJtZW51cy5maWx0ZXIoIjpub3QoLnVpLW1lbnUpIikuYWRkQ2xhc3MoInVpLW1lbnUgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwiKS5oaWRlKCkuYXR0cih7cm9sZTp0aGlzLm9wdGlvbnMucm9sZSwiYXJpYS1oaWRkZW4iOiJ0cnVlIiwiYXJpYS1leHBhbmRlZCI6ImZhbHNlIn0pLmVhY2goZnVuY3Rpb24oKXt2YXIgbWVudT0kKHRoaXMpLGl0ZW09bWVudS5wcmV2KCJhIiksc3VibWVudUNhcmF0PSQoIjxzcGFuPiIpLmFkZENsYXNzKCJ1aS1tZW51LWljb24gdWktaWNvbiAiK2ljb24pLmRhdGEoInVpLW1lbnUtc3VibWVudS1jYXJhdCIsdHJ1ZSk7aXRlbS5hdHRyKCJhcmlhLWhhc3BvcHVwIiwidHJ1ZSIpLnByZXBlbmQoc3VibWVudUNhcmF0KTttZW51LmF0dHIoImFyaWEtbGFiZWxsZWRieSIsaXRlbS5hdHRyKCJpZCIpKTt9KTttZW51cz1zdWJtZW51cy5hZGQodGhpcy5lbGVtZW50KTttZW51cy5jaGlsZHJlbigiOm5vdCgudWktbWVudS1pdGVtKTpoYXMoYSkiKS5hZGRDbGFzcygidWktbWVudS1pdGVtIikuYXR0cigicm9sZSIsInByZXNlbnRhdGlvbiIpLmNoaWxkcmVuKCJhIikudW5pcXVlSWQoKS5hZGRDbGFzcygidWktY29ybmVyLWFsbCIpLmF0dHIoe3RhYkluZGV4Oi0xLHJvbGU6dGhpcy5faXRlbVJvbGUoKX0pO21lbnVzLmNoaWxkcmVuKCI6bm90KC51aS1tZW51LWl0ZW0pIikuZWFjaChmdW5jdGlvbigpe3ZhciBpdGVtPSQodGhpcyk7aWYoIS9bXlwtXHUyMDE0XHUyMDEzXHNdLy50ZXN0KGl0ZW0udGV4dCgpKSl7aXRlbS5hZGRDbGFzcygidWktd2lkZ2V0LWNvbnRlbnQgdWktbWVudS1kaXZpZGVyIik7fX0pO21lbnVzLmNoaWxkcmVuKCIudWktc3RhdGUtZGlzYWJsZWQiKS5hdHRyKCJhcmlhLWRpc2FibGVkIiwidHJ1ZSIpO2lmKHRoaXMuYWN0aXZlJiYhJC5jb250YWlucyh0aGlzLmVsZW1lbnRbMF0sdGhpcy5hY3RpdmVbMF0pKXt0aGlzLmJsdXIoKTt9fSxfaXRlbVJvbGU6ZnVuY3Rpb24oKXtyZXR1cm57bWVudToibWVudWl0ZW0iLGxpc3Rib3g6Im9wdGlvbiJ9W3RoaXMub3B0aW9ucy5yb2xlXTt9LF9zZXRPcHRpb246ZnVuY3Rpb24oa2V5LHZhbHVlKXtpZihrZXk9PT0iaWNvbnMiKXt0aGlzLmVsZW1lbnQuZmluZCgiLnVpLW1lbnUtaWNvbiIpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5pY29ucy5zdWJtZW51KS5hZGRDbGFzcyh2YWx1ZS5zdWJtZW51KTt9CnRoaXMuX3N1cGVyKGtleSx2YWx1ZSk7fSxmb2N1czpmdW5jdGlvbihldmVudCxpdGVtKXt2YXIgbmVzdGVkLGZvY3VzZWQ7dGhpcy5ibHVyKGV2ZW50LGV2ZW50JiZldmVudC50eXBlPT09ImZvY3VzIik7dGhpcy5fc2Nyb2xsSW50b1ZpZXcoaXRlbSk7dGhpcy5hY3RpdmU9aXRlbS5maXJzdCgpO2ZvY3VzZWQ9dGhpcy5hY3RpdmUuY2hpbGRyZW4oImEiKS5hZGRDbGFzcygidWktc3RhdGUtZm9jdXMiKTtpZih0aGlzLm9wdGlvbnMucm9sZSl7dGhpcy5lbGVtZW50LmF0dHIoImFyaWEtYWN0aXZlZGVzY2VuZGFudCIsZm9jdXNlZC5hdHRyKCJpZCIpKTt9CnRoaXMuYWN0aXZlLnBhcmVudCgpLmNsb3Nlc3QoIi51aS1tZW51LWl0ZW0iKS5jaGlsZHJlbigiYTpmaXJzdCIpLmFkZENsYXNzKCJ1aS1zdGF0ZS1hY3RpdmUiKTtpZihldmVudCYmZXZlbnQudHlwZT09PSJrZXlkb3duIil7dGhpcy5fY2xvc2UoKTt9ZWxzZXt0aGlzLnRpbWVyPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5fY2xvc2UoKTt9LHRoaXMuZGVsYXkpO30KbmVzdGVkPWl0ZW0uY2hpbGRyZW4oIi51aS1tZW51Iik7aWYobmVzdGVkLmxlbmd0aCYmZXZlbnQmJigvXm1vdXNlLy50ZXN0KGV2ZW50LnR5cGUpKSl7dGhpcy5fc3RhcnRPcGVuaW5nKG5lc3RlZCk7fQp0aGlzLmFjdGl2ZU1lbnU9aXRlbS5wYXJlbnQoKTt0aGlzLl90cmlnZ2VyKCJmb2N1cyIsZXZlbnQse2l0ZW06aXRlbX0pO30sX3Njcm9sbEludG9WaWV3OmZ1bmN0aW9uKGl0ZW0pe3ZhciBib3JkZXJUb3AscGFkZGluZ1RvcCxvZmZzZXQsc2Nyb2xsLGVsZW1lbnRIZWlnaHQsaXRlbUhlaWdodDtpZih0aGlzLl9oYXNTY3JvbGwoKSl7Ym9yZGVyVG9wPXBhcnNlRmxvYXQoJC5jc3ModGhpcy5hY3RpdmVNZW51WzBdLCJib3JkZXJUb3BXaWR0aCIpKXx8MDtwYWRkaW5nVG9wPXBhcnNlRmxvYXQoJC5jc3ModGhpcy5hY3RpdmVNZW51WzBdLCJwYWRkaW5nVG9wIikpfHwwO29mZnNldD1pdGVtLm9mZnNldCgpLnRvcC10aGlzLmFjdGl2ZU1lbnUub2Zmc2V0KCkudG9wLWJvcmRlclRvcC1wYWRkaW5nVG9wO3Njcm9sbD10aGlzLmFjdGl2ZU1lbnUuc2Nyb2xsVG9wKCk7ZWxlbWVudEhlaWdodD10aGlzLmFjdGl2ZU1lbnUuaGVpZ2h0KCk7aXRlbUhlaWdodD1pdGVtLmhlaWdodCgpO2lmKG9mZnNldDwwKXt0aGlzLmFjdGl2ZU1lbnUuc2Nyb2xsVG9wKHNjcm9sbCtvZmZzZXQpO31lbHNlIGlmKG9mZnNldCtpdGVtSGVpZ2h0PmVsZW1lbnRIZWlnaHQpe3RoaXMuYWN0aXZlTWVudS5zY3JvbGxUb3Aoc2Nyb2xsK29mZnNldC1lbGVtZW50SGVpZ2h0K2l0ZW1IZWlnaHQpO319fSxibHVyOmZ1bmN0aW9uKGV2ZW50LGZyb21Gb2N1cyl7aWYoIWZyb21Gb2N1cyl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO30KaWYoIXRoaXMuYWN0aXZlKXtyZXR1cm47fQp0aGlzLmFjdGl2ZS5jaGlsZHJlbigiYSIpLnJlbW92ZUNsYXNzKCJ1aS1zdGF0ZS1mb2N1cyIpO3RoaXMuYWN0aXZlPW51bGw7dGhpcy5fdHJpZ2dlcigiYmx1ciIsZXZlbnQse2l0ZW06dGhpcy5hY3RpdmV9KTt9LF9zdGFydE9wZW5pbmc6ZnVuY3Rpb24oc3VibWVudSl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO2lmKHN1Ym1lbnUuYXR0cigiYXJpYS1oaWRkZW4iKSE9PSJ0cnVlIil7cmV0dXJuO30KdGhpcy50aW1lcj10aGlzLl9kZWxheShmdW5jdGlvbigpe3RoaXMuX2Nsb3NlKCk7dGhpcy5fb3BlbihzdWJtZW51KTt9LHRoaXMuZGVsYXkpO30sX29wZW46ZnVuY3Rpb24oc3VibWVudSl7dmFyIHBvc2l0aW9uPSQuZXh0ZW5kKHtvZjp0aGlzLmFjdGl2ZX0sdGhpcy5vcHRpb25zLnBvc2l0aW9uKTtjbGVhclRpbWVvdXQodGhpcy50aW1lcik7dGhpcy5lbGVtZW50LmZpbmQoIi51aS1tZW51Iikubm90KHN1Ym1lbnUucGFyZW50cygiLnVpLW1lbnUiKSkuaGlkZSgpLmF0dHIoImFyaWEtaGlkZGVuIiwidHJ1ZSIpO3N1Ym1lbnUuc2hvdygpLnJlbW92ZUF0dHIoImFyaWEtaGlkZGVuIikuYXR0cigiYXJpYS1leHBhbmRlZCIsInRydWUiKS5wb3NpdGlvbihwb3NpdGlvbik7fSxjb2xsYXBzZUFsbDpmdW5jdGlvbihldmVudCxhbGwpe2NsZWFyVGltZW91dCh0aGlzLnRpbWVyKTt0aGlzLnRpbWVyPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dmFyIGN1cnJlbnRNZW51PWFsbD90aGlzLmVsZW1lbnQ6JChldmVudCYmZXZlbnQudGFyZ2V0KS5jbG9zZXN0KHRoaXMuZWxlbWVudC5maW5kKCIudWktbWVudSIpKTtpZighY3VycmVudE1lbnUubGVuZ3RoKXtjdXJyZW50TWVudT10aGlzLmVsZW1lbnQ7fQp0aGlzLl9jbG9zZShjdXJyZW50TWVudSk7dGhpcy5ibHVyKGV2ZW50KTt0aGlzLmFjdGl2ZU1lbnU9Y3VycmVudE1lbnU7fSx0aGlzLmRlbGF5KTt9LF9jbG9zZTpmdW5jdGlvbihzdGFydE1lbnUpe2lmKCFzdGFydE1lbnUpe3N0YXJ0TWVudT10aGlzLmFjdGl2ZT90aGlzLmFjdGl2ZS5wYXJlbnQoKTp0aGlzLmVsZW1lbnQ7fQpzdGFydE1lbnUuZmluZCgiLnVpLW1lbnUiKS5oaWRlKCkuYXR0cigiYXJpYS1oaWRkZW4iLCJ0cnVlIikuYXR0cigiYXJpYS1leHBhbmRlZCIsImZhbHNlIikuZW5kKCkuZmluZCgiYS51aS1zdGF0ZS1hY3RpdmUiKS5yZW1vdmVDbGFzcygidWktc3RhdGUtYWN0aXZlIik7fSxjb2xsYXBzZTpmdW5jdGlvbihldmVudCl7dmFyIG5ld0l0ZW09dGhpcy5hY3RpdmUmJnRoaXMuYWN0aXZlLnBhcmVudCgpLmNsb3Nlc3QoIi51aS1tZW51LWl0ZW0iLHRoaXMuZWxlbWVudCk7aWYobmV3SXRlbSYmbmV3SXRlbS5sZW5ndGgpe3RoaXMuX2Nsb3NlKCk7dGhpcy5mb2N1cyhldmVudCxuZXdJdGVtKTt9fSxleHBhbmQ6ZnVuY3Rpb24oZXZlbnQpe3ZhciBuZXdJdGVtPXRoaXMuYWN0aXZlJiZ0aGlzLmFjdGl2ZS5jaGlsZHJlbigiLnVpLW1lbnUgIikuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0iKS5maXJzdCgpO2lmKG5ld0l0ZW0mJm5ld0l0ZW0ubGVuZ3RoKXt0aGlzLl9vcGVuKG5ld0l0ZW0ucGFyZW50KCkpO3RoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5mb2N1cyhldmVudCxuZXdJdGVtKTt9KTt9fSxuZXh0OmZ1bmN0aW9uKGV2ZW50KXt0aGlzLl9tb3ZlKCJuZXh0IiwiZmlyc3QiLGV2ZW50KTt9LHByZXZpb3VzOmZ1bmN0aW9uKGV2ZW50KXt0aGlzLl9tb3ZlKCJwcmV2IiwibGFzdCIsZXZlbnQpO30saXNGaXJzdEl0ZW06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hY3RpdmUmJiF0aGlzLmFjdGl2ZS5wcmV2QWxsKCIudWktbWVudS1pdGVtIikubGVuZ3RoO30saXNMYXN0SXRlbTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFjdGl2ZSYmIXRoaXMuYWN0aXZlLm5leHRBbGwoIi51aS1tZW51LWl0ZW0iKS5sZW5ndGg7fSxfbW92ZTpmdW5jdGlvbihkaXJlY3Rpb24sZmlsdGVyLGV2ZW50KXt2YXIgbmV4dDtpZih0aGlzLmFjdGl2ZSl7aWYoZGlyZWN0aW9uPT09ImZpcnN0Inx8ZGlyZWN0aW9uPT09Imxhc3QiKXtuZXh0PXRoaXMuYWN0aXZlCltkaXJlY3Rpb249PT0iZmlyc3QiPyJwcmV2QWxsIjoibmV4dEFsbCJdKCIudWktbWVudS1pdGVtIikuZXEoLTEpO31lbHNle25leHQ9dGhpcy5hY3RpdmUKW2RpcmVjdGlvbisiQWxsIl0oIi51aS1tZW51LWl0ZW0iKS5lcSgwKTt9fQppZighbmV4dHx8IW5leHQubGVuZ3RofHwhdGhpcy5hY3RpdmUpe25leHQ9dGhpcy5hY3RpdmVNZW51LmNoaWxkcmVuKCIudWktbWVudS1pdGVtIilbZmlsdGVyXSgpO30KdGhpcy5mb2N1cyhldmVudCxuZXh0KTt9LG5leHRQYWdlOmZ1bmN0aW9uKGV2ZW50KXt2YXIgaXRlbSxiYXNlLGhlaWdodDtpZighdGhpcy5hY3RpdmUpe3RoaXMubmV4dChldmVudCk7cmV0dXJuO30KaWYodGhpcy5pc0xhc3RJdGVtKCkpe3JldHVybjt9CmlmKHRoaXMuX2hhc1Njcm9sbCgpKXtiYXNlPXRoaXMuYWN0aXZlLm9mZnNldCgpLnRvcDtoZWlnaHQ9dGhpcy5lbGVtZW50LmhlaWdodCgpO3RoaXMuYWN0aXZlLm5leHRBbGwoIi51aS1tZW51LWl0ZW0iKS5lYWNoKGZ1bmN0aW9uKCl7aXRlbT0kKHRoaXMpO3JldHVybiBpdGVtLm9mZnNldCgpLnRvcC1iYXNlLWhlaWdodDwwO30pO3RoaXMuZm9jdXMoZXZlbnQsaXRlbSk7fWVsc2V7dGhpcy5mb2N1cyhldmVudCx0aGlzLmFjdGl2ZU1lbnUuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0iKQpbIXRoaXMuYWN0aXZlPyJmaXJzdCI6Imxhc3QiXSgpKTt9fSxwcmV2aW91c1BhZ2U6ZnVuY3Rpb24oZXZlbnQpe3ZhciBpdGVtLGJhc2UsaGVpZ2h0O2lmKCF0aGlzLmFjdGl2ZSl7dGhpcy5uZXh0KGV2ZW50KTtyZXR1cm47fQppZih0aGlzLmlzRmlyc3RJdGVtKCkpe3JldHVybjt9CmlmKHRoaXMuX2hhc1Njcm9sbCgpKXtiYXNlPXRoaXMuYWN0aXZlLm9mZnNldCgpLnRvcDtoZWlnaHQ9dGhpcy5lbGVtZW50LmhlaWdodCgpO3RoaXMuYWN0aXZlLnByZXZBbGwoIi51aS1tZW51LWl0ZW0iKS5lYWNoKGZ1bmN0aW9uKCl7aXRlbT0kKHRoaXMpO3JldHVybiBpdGVtLm9mZnNldCgpLnRvcC1iYXNlK2hlaWdodD4wO30pO3RoaXMuZm9jdXMoZXZlbnQsaXRlbSk7fWVsc2V7dGhpcy5mb2N1cyhldmVudCx0aGlzLmFjdGl2ZU1lbnUuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0iKS5maXJzdCgpKTt9fSxfaGFzU2Nyb2xsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpPHRoaXMuZWxlbWVudC5wcm9wKCJzY3JvbGxIZWlnaHQiKTt9LHNlbGVjdDpmdW5jdGlvbihldmVudCl7dGhpcy5hY3RpdmU9dGhpcy5hY3RpdmV8fCQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KCIudWktbWVudS1pdGVtIik7dmFyIHVpPXtpdGVtOnRoaXMuYWN0aXZlfTtpZighdGhpcy5hY3RpdmUuaGFzKCIudWktbWVudSIpLmxlbmd0aCl7dGhpcy5jb2xsYXBzZUFsbChldmVudCx0cnVlKTt9CnRoaXMuX3RyaWdnZXIoInNlbGVjdCIsZXZlbnQsdWkpO319KTt9KGpRdWVyeSkpOyhmdW5jdGlvbigpe3ZhciByb290PXRoaXM7dmFyIHByZXZpb3VzVW5kZXJzY29yZT1yb290Ll87dmFyIGJyZWFrZXI9e307dmFyIEFycmF5UHJvdG89QXJyYXkucHJvdG90eXBlLE9ialByb3RvPU9iamVjdC5wcm90b3R5cGUsRnVuY1Byb3RvPUZ1bmN0aW9uLnByb3RvdHlwZTt2YXIKcHVzaD1BcnJheVByb3RvLnB1c2gsc2xpY2U9QXJyYXlQcm90by5zbGljZSxjb25jYXQ9QXJyYXlQcm90by5jb25jYXQsdG9TdHJpbmc9T2JqUHJvdG8udG9TdHJpbmcsaGFzT3duUHJvcGVydHk9T2JqUHJvdG8uaGFzT3duUHJvcGVydHk7dmFyCm5hdGl2ZUZvckVhY2g9QXJyYXlQcm90by5mb3JFYWNoLG5hdGl2ZU1hcD1BcnJheVByb3RvLm1hcCxuYXRpdmVSZWR1Y2U9QXJyYXlQcm90by5yZWR1Y2UsbmF0aXZlUmVkdWNlUmlnaHQ9QXJyYXlQcm90by5yZWR1Y2VSaWdodCxuYXRpdmVGaWx0ZXI9QXJyYXlQcm90by5maWx0ZXIsbmF0aXZlRXZlcnk9QXJyYXlQcm90by5ldmVyeSxuYXRpdmVTb21lPUFycmF5UHJvdG8uc29tZSxuYXRpdmVJbmRleE9mPUFycmF5UHJvdG8uaW5kZXhPZixuYXRpdmVMYXN0SW5kZXhPZj1BcnJheVByb3RvLmxhc3RJbmRleE9mLG5hdGl2ZUlzQXJyYXk9QXJyYXkuaXNBcnJheSxuYXRpdmVLZXlzPU9iamVjdC5rZXlzLG5hdGl2ZUJpbmQ9RnVuY1Byb3RvLmJpbmQ7dmFyIF89ZnVuY3Rpb24ob2JqKXtpZihvYmogaW5zdGFuY2VvZiBfKXJldHVybiBvYmo7aWYoISh0aGlzIGluc3RhbmNlb2YgXykpcmV0dXJuIG5ldyBfKG9iaik7dGhpcy5fd3JhcHBlZD1vYmo7fTtpZih0eXBlb2YgZXhwb3J0cyE9PSd1bmRlZmluZWQnKXtpZih0eXBlb2YgbW9kdWxlIT09J3VuZGVmaW5lZCcmJm1vZHVsZS5leHBvcnRzKXtleHBvcnRzPW1vZHVsZS5leHBvcnRzPV87fQpleHBvcnRzLl89Xzt9ZWxzZXtyb290Ll89Xzt9Cl8uVkVSU0lPTj0nMS41LjInO3ZhciBlYWNoPV8uZWFjaD1fLmZvckVhY2g9ZnVuY3Rpb24ob2JqLGl0ZXJhdG9yLGNvbnRleHQpe2lmKG9iaj09bnVsbClyZXR1cm47aWYobmF0aXZlRm9yRWFjaCYmb2JqLmZvckVhY2g9PT1uYXRpdmVGb3JFYWNoKXtvYmouZm9yRWFjaChpdGVyYXRvcixjb250ZXh0KTt9ZWxzZSBpZihvYmoubGVuZ3RoPT09K29iai5sZW5ndGgpe2Zvcih2YXIgaT0wLGxlbmd0aD1vYmoubGVuZ3RoO2k8bGVuZ3RoO2krKyl7aWYoaXRlcmF0b3IuY2FsbChjb250ZXh0LG9ialtpXSxpLG9iaik9PT1icmVha2VyKXJldHVybjt9fWVsc2V7dmFyIGtleXM9Xy5rZXlzKG9iaik7Zm9yKHZhciBpPTAsbGVuZ3RoPWtleXMubGVuZ3RoO2k8bGVuZ3RoO2krKyl7aWYoaXRlcmF0b3IuY2FsbChjb250ZXh0LG9ialtrZXlzW2ldXSxrZXlzW2ldLG9iaik9PT1icmVha2VyKXJldHVybjt9fX07Xy5tYXA9Xy5jb2xsZWN0PWZ1bmN0aW9uKG9iaixpdGVyYXRvcixjb250ZXh0KXt2YXIgcmVzdWx0cz1bXTtpZihvYmo9PW51bGwpcmV0dXJuIHJlc3VsdHM7aWYobmF0aXZlTWFwJiZvYmoubWFwPT09bmF0aXZlTWFwKXJldHVybiBvYmoubWFwKGl0ZXJhdG9yLGNvbnRleHQpO2VhY2gob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe3Jlc3VsdHMucHVzaChpdGVyYXRvci5jYWxsKGNvbnRleHQsdmFsdWUsaW5kZXgsbGlzdCkpO30pO3JldHVybiByZXN1bHRzO307dmFyIHJlZHVjZUVycm9yPSdSZWR1Y2Ugb2YgZW1wdHkgYXJyYXkgd2l0aCBubyBpbml0aWFsIHZhbHVlJztfLnJlZHVjZT1fLmZvbGRsPV8uaW5qZWN0PWZ1bmN0aW9uKG9iaixpdGVyYXRvcixtZW1vLGNvbnRleHQpe3ZhciBpbml0aWFsPWFyZ3VtZW50cy5sZW5ndGg+MjtpZihvYmo9PW51bGwpb2JqPVtdO2lmKG5hdGl2ZVJlZHVjZSYmb2JqLnJlZHVjZT09PW5hdGl2ZVJlZHVjZSl7aWYoY29udGV4dClpdGVyYXRvcj1fLmJpbmQoaXRlcmF0b3IsY29udGV4dCk7cmV0dXJuIGluaXRpYWw/b2JqLnJlZHVjZShpdGVyYXRvcixtZW1vKTpvYmoucmVkdWNlKGl0ZXJhdG9yKTt9CmVhY2gob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe2lmKCFpbml0aWFsKXttZW1vPXZhbHVlO2luaXRpYWw9dHJ1ZTt9ZWxzZXttZW1vPWl0ZXJhdG9yLmNhbGwoY29udGV4dCxtZW1vLHZhbHVlLGluZGV4LGxpc3QpO319KTtpZighaW5pdGlhbCl0aHJvdyBuZXcgVHlwZUVycm9yKHJlZHVjZUVycm9yKTtyZXR1cm4gbWVtbzt9O18ucmVkdWNlUmlnaHQ9Xy5mb2xkcj1mdW5jdGlvbihvYmosaXRlcmF0b3IsbWVtbyxjb250ZXh0KXt2YXIgaW5pdGlhbD1hcmd1bWVudHMubGVuZ3RoPjI7aWYob2JqPT1udWxsKW9iaj1bXTtpZihuYXRpdmVSZWR1Y2VSaWdodCYmb2JqLnJlZHVjZVJpZ2h0PT09bmF0aXZlUmVkdWNlUmlnaHQpe2lmKGNvbnRleHQpaXRlcmF0b3I9Xy5iaW5kKGl0ZXJhdG9yLGNvbnRleHQpO3JldHVybiBpbml0aWFsP29iai5yZWR1Y2VSaWdodChpdGVyYXRvcixtZW1vKTpvYmoucmVkdWNlUmlnaHQoaXRlcmF0b3IpO30KdmFyIGxlbmd0aD1vYmoubGVuZ3RoO2lmKGxlbmd0aCE9PStsZW5ndGgpe3ZhciBrZXlzPV8ua2V5cyhvYmopO2xlbmd0aD1rZXlzLmxlbmd0aDt9CmVhY2gob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe2luZGV4PWtleXM/a2V5c1stLWxlbmd0aF06LS1sZW5ndGg7aWYoIWluaXRpYWwpe21lbW89b2JqW2luZGV4XTtpbml0aWFsPXRydWU7fWVsc2V7bWVtbz1pdGVyYXRvci5jYWxsKGNvbnRleHQsbWVtbyxvYmpbaW5kZXhdLGluZGV4LGxpc3QpO319KTtpZighaW5pdGlhbCl0aHJvdyBuZXcgVHlwZUVycm9yKHJlZHVjZUVycm9yKTtyZXR1cm4gbWVtbzt9O18uZmluZD1fLmRldGVjdD1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7dmFyIHJlc3VsdDthbnkob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe2lmKGl0ZXJhdG9yLmNhbGwoY29udGV4dCx2YWx1ZSxpbmRleCxsaXN0KSl7cmVzdWx0PXZhbHVlO3JldHVybiB0cnVlO319KTtyZXR1cm4gcmVzdWx0O307Xy5maWx0ZXI9Xy5zZWxlY3Q9ZnVuY3Rpb24ob2JqLGl0ZXJhdG9yLGNvbnRleHQpe3ZhciByZXN1bHRzPVtdO2lmKG9iaj09bnVsbClyZXR1cm4gcmVzdWx0cztpZihuYXRpdmVGaWx0ZXImJm9iai5maWx0ZXI9PT1uYXRpdmVGaWx0ZXIpcmV0dXJuIG9iai5maWx0ZXIoaXRlcmF0b3IsY29udGV4dCk7ZWFjaChvYmosZnVuY3Rpb24odmFsdWUsaW5kZXgsbGlzdCl7aWYoaXRlcmF0b3IuY2FsbChjb250ZXh0LHZhbHVlLGluZGV4LGxpc3QpKXJlc3VsdHMucHVzaCh2YWx1ZSk7fSk7cmV0dXJuIHJlc3VsdHM7fTtfLnJlamVjdD1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7cmV0dXJuIF8uZmlsdGVyKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCxsaXN0KXtyZXR1cm4haXRlcmF0b3IuY2FsbChjb250ZXh0LHZhbHVlLGluZGV4LGxpc3QpO30sY29udGV4dCk7fTtfLmV2ZXJ5PV8uYWxsPWZ1bmN0aW9uKG9iaixpdGVyYXRvcixjb250ZXh0KXtpdGVyYXRvcnx8KGl0ZXJhdG9yPV8uaWRlbnRpdHkpO3ZhciByZXN1bHQ9dHJ1ZTtpZihvYmo9PW51bGwpcmV0dXJuIHJlc3VsdDtpZihuYXRpdmVFdmVyeSYmb2JqLmV2ZXJ5PT09bmF0aXZlRXZlcnkpcmV0dXJuIG9iai5ldmVyeShpdGVyYXRvcixjb250ZXh0KTtlYWNoKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCxsaXN0KXtpZighKHJlc3VsdD1yZXN1bHQmJml0ZXJhdG9yLmNhbGwoY29udGV4dCx2YWx1ZSxpbmRleCxsaXN0KSkpcmV0dXJuIGJyZWFrZXI7fSk7cmV0dXJuISFyZXN1bHQ7fTt2YXIgYW55PV8uc29tZT1fLmFueT1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7aXRlcmF0b3J8fChpdGVyYXRvcj1fLmlkZW50aXR5KTt2YXIgcmVzdWx0PWZhbHNlO2lmKG9iaj09bnVsbClyZXR1cm4gcmVzdWx0O2lmKG5hdGl2ZVNvbWUmJm9iai5zb21lPT09bmF0aXZlU29tZSlyZXR1cm4gb2JqLnNvbWUoaXRlcmF0b3IsY29udGV4dCk7ZWFjaChvYmosZnVuY3Rpb24odmFsdWUsaW5kZXgsbGlzdCl7aWYocmVzdWx0fHwocmVzdWx0PWl0ZXJhdG9yLmNhbGwoY29udGV4dCx2YWx1ZSxpbmRleCxsaXN0KSkpcmV0dXJuIGJyZWFrZXI7fSk7cmV0dXJuISFyZXN1bHQ7fTtfLmNvbnRhaW5zPV8uaW5jbHVkZT1mdW5jdGlvbihvYmosdGFyZ2V0KXtpZihvYmo9PW51bGwpcmV0dXJuIGZhbHNlO2lmKG5hdGl2ZUluZGV4T2YmJm9iai5pbmRleE9mPT09bmF0aXZlSW5kZXhPZilyZXR1cm4gb2JqLmluZGV4T2YodGFyZ2V0KSE9LTE7cmV0dXJuIGFueShvYmosZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZT09PXRhcmdldDt9KTt9O18uaW52b2tlPWZ1bmN0aW9uKG9iaixtZXRob2Qpe3ZhciBhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3ZhciBpc0Z1bmM9Xy5pc0Z1bmN0aW9uKG1ldGhvZCk7cmV0dXJuIF8ubWFwKG9iaixmdW5jdGlvbih2YWx1ZSl7cmV0dXJuKGlzRnVuYz9tZXRob2Q6dmFsdWVbbWV0aG9kXSkuYXBwbHkodmFsdWUsYXJncyk7fSk7fTtfLnBsdWNrPWZ1bmN0aW9uKG9iaixrZXkpe3JldHVybiBfLm1hcChvYmosZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZVtrZXldO30pO307Xy53aGVyZT1mdW5jdGlvbihvYmosYXR0cnMsZmlyc3Qpe2lmKF8uaXNFbXB0eShhdHRycykpcmV0dXJuIGZpcnN0P3ZvaWQgMDpbXTtyZXR1cm4gX1tmaXJzdD8nZmluZCc6J2ZpbHRlciddKG9iaixmdW5jdGlvbih2YWx1ZSl7Zm9yKHZhciBrZXkgaW4gYXR0cnMpe2lmKGF0dHJzW2tleV0hPT12YWx1ZVtrZXldKXJldHVybiBmYWxzZTt9CnJldHVybiB0cnVlO30pO307Xy5maW5kV2hlcmU9ZnVuY3Rpb24ob2JqLGF0dHJzKXtyZXR1cm4gXy53aGVyZShvYmosYXR0cnMsdHJ1ZSk7fTtfLm1heD1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7aWYoIWl0ZXJhdG9yJiZfLmlzQXJyYXkob2JqKSYmb2JqWzBdPT09K29ialswXSYmb2JqLmxlbmd0aDw2NTUzNSl7cmV0dXJuIE1hdGgubWF4LmFwcGx5KE1hdGgsb2JqKTt9CmlmKCFpdGVyYXRvciYmXy5pc0VtcHR5KG9iaikpcmV0dXJuLUluZmluaXR5O3ZhciByZXN1bHQ9e2NvbXB1dGVkOi1JbmZpbml0eSx2YWx1ZTotSW5maW5pdHl9O2VhY2gob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe3ZhciBjb21wdXRlZD1pdGVyYXRvcj9pdGVyYXRvci5jYWxsKGNvbnRleHQsdmFsdWUsaW5kZXgsbGlzdCk6dmFsdWU7Y29tcHV0ZWQ+cmVzdWx0LmNvbXB1dGVkJiYocmVzdWx0PXt2YWx1ZTp2YWx1ZSxjb21wdXRlZDpjb21wdXRlZH0pO30pO3JldHVybiByZXN1bHQudmFsdWU7fTtfLm1pbj1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7aWYoIWl0ZXJhdG9yJiZfLmlzQXJyYXkob2JqKSYmb2JqWzBdPT09K29ialswXSYmb2JqLmxlbmd0aDw2NTUzNSl7cmV0dXJuIE1hdGgubWluLmFwcGx5KE1hdGgsb2JqKTt9CmlmKCFpdGVyYXRvciYmXy5pc0VtcHR5KG9iaikpcmV0dXJuIEluZmluaXR5O3ZhciByZXN1bHQ9e2NvbXB1dGVkOkluZmluaXR5LHZhbHVlOkluZmluaXR5fTtlYWNoKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCxsaXN0KXt2YXIgY29tcHV0ZWQ9aXRlcmF0b3I/aXRlcmF0b3IuY2FsbChjb250ZXh0LHZhbHVlLGluZGV4LGxpc3QpOnZhbHVlO2NvbXB1dGVkPHJlc3VsdC5jb21wdXRlZCYmKHJlc3VsdD17dmFsdWU6dmFsdWUsY29tcHV0ZWQ6Y29tcHV0ZWR9KTt9KTtyZXR1cm4gcmVzdWx0LnZhbHVlO307Xy5zaHVmZmxlPWZ1bmN0aW9uKG9iail7dmFyIHJhbmQ7dmFyIGluZGV4PTA7dmFyIHNodWZmbGVkPVtdO2VhY2gob2JqLGZ1bmN0aW9uKHZhbHVlKXtyYW5kPV8ucmFuZG9tKGluZGV4KyspO3NodWZmbGVkW2luZGV4LTFdPXNodWZmbGVkW3JhbmRdO3NodWZmbGVkW3JhbmRdPXZhbHVlO30pO3JldHVybiBzaHVmZmxlZDt9O18uc2FtcGxlPWZ1bmN0aW9uKG9iaixuLGd1YXJkKXtpZihhcmd1bWVudHMubGVuZ3RoPDJ8fGd1YXJkKXtyZXR1cm4gb2JqW18ucmFuZG9tKG9iai5sZW5ndGgtMSldO30KcmV0dXJuIF8uc2h1ZmZsZShvYmopLnNsaWNlKDAsTWF0aC5tYXgoMCxuKSk7fTt2YXIgbG9va3VwSXRlcmF0b3I9ZnVuY3Rpb24odmFsdWUpe3JldHVybiBfLmlzRnVuY3Rpb24odmFsdWUpP3ZhbHVlOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9ialt2YWx1ZV07fTt9O18uc29ydEJ5PWZ1bmN0aW9uKG9iaix2YWx1ZSxjb250ZXh0KXt2YXIgaXRlcmF0b3I9bG9va3VwSXRlcmF0b3IodmFsdWUpO3JldHVybiBfLnBsdWNrKF8ubWFwKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCxsaXN0KXtyZXR1cm57dmFsdWU6dmFsdWUsaW5kZXg6aW5kZXgsY3JpdGVyaWE6aXRlcmF0b3IuY2FsbChjb250ZXh0LHZhbHVlLGluZGV4LGxpc3QpfTt9KS5zb3J0KGZ1bmN0aW9uKGxlZnQscmlnaHQpe3ZhciBhPWxlZnQuY3JpdGVyaWE7dmFyIGI9cmlnaHQuY3JpdGVyaWE7aWYoYSE9PWIpe2lmKGE+Ynx8YT09PXZvaWQgMClyZXR1cm4gMTtpZihhPGJ8fGI9PT12b2lkIDApcmV0dXJuLTE7fQpyZXR1cm4gbGVmdC5pbmRleC1yaWdodC5pbmRleDt9KSwndmFsdWUnKTt9O3ZhciBncm91cD1mdW5jdGlvbihiZWhhdmlvcil7cmV0dXJuIGZ1bmN0aW9uKG9iaix2YWx1ZSxjb250ZXh0KXt2YXIgcmVzdWx0PXt9O3ZhciBpdGVyYXRvcj12YWx1ZT09bnVsbD9fLmlkZW50aXR5Omxvb2t1cEl0ZXJhdG9yKHZhbHVlKTtlYWNoKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCl7dmFyIGtleT1pdGVyYXRvci5jYWxsKGNvbnRleHQsdmFsdWUsaW5kZXgsb2JqKTtiZWhhdmlvcihyZXN1bHQsa2V5LHZhbHVlKTt9KTtyZXR1cm4gcmVzdWx0O307fTtfLmdyb3VwQnk9Z3JvdXAoZnVuY3Rpb24ocmVzdWx0LGtleSx2YWx1ZSl7KF8uaGFzKHJlc3VsdCxrZXkpP3Jlc3VsdFtrZXldOihyZXN1bHRba2V5XT1bXSkpLnB1c2godmFsdWUpO30pO18uaW5kZXhCeT1ncm91cChmdW5jdGlvbihyZXN1bHQsa2V5LHZhbHVlKXtyZXN1bHRba2V5XT12YWx1ZTt9KTtfLmNvdW50Qnk9Z3JvdXAoZnVuY3Rpb24ocmVzdWx0LGtleSl7Xy5oYXMocmVzdWx0LGtleSk/cmVzdWx0W2tleV0rKzpyZXN1bHRba2V5XT0xO30pO18uc29ydGVkSW5kZXg9ZnVuY3Rpb24oYXJyYXksb2JqLGl0ZXJhdG9yLGNvbnRleHQpe2l0ZXJhdG9yPWl0ZXJhdG9yPT1udWxsP18uaWRlbnRpdHk6bG9va3VwSXRlcmF0b3IoaXRlcmF0b3IpO3ZhciB2YWx1ZT1pdGVyYXRvci5jYWxsKGNvbnRleHQsb2JqKTt2YXIgbG93PTAsaGlnaD1hcnJheS5sZW5ndGg7d2hpbGUobG93PGhpZ2gpe3ZhciBtaWQ9KGxvdytoaWdoKT4+PjE7aXRlcmF0b3IuY2FsbChjb250ZXh0LGFycmF5W21pZF0pPHZhbHVlP2xvdz1taWQrMTpoaWdoPW1pZDt9CnJldHVybiBsb3c7fTtfLnRvQXJyYXk9ZnVuY3Rpb24ob2JqKXtpZighb2JqKXJldHVybltdO2lmKF8uaXNBcnJheShvYmopKXJldHVybiBzbGljZS5jYWxsKG9iaik7aWYob2JqLmxlbmd0aD09PStvYmoubGVuZ3RoKXJldHVybiBfLm1hcChvYmosXy5pZGVudGl0eSk7cmV0dXJuIF8udmFsdWVzKG9iaik7fTtfLnNpemU9ZnVuY3Rpb24ob2JqKXtpZihvYmo9PW51bGwpcmV0dXJuIDA7cmV0dXJuKG9iai5sZW5ndGg9PT0rb2JqLmxlbmd0aCk/b2JqLmxlbmd0aDpfLmtleXMob2JqKS5sZW5ndGg7fTtfLmZpcnN0PV8uaGVhZD1fLnRha2U9ZnVuY3Rpb24oYXJyYXksbixndWFyZCl7aWYoYXJyYXk9PW51bGwpcmV0dXJuIHZvaWQgMDtyZXR1cm4obj09bnVsbCl8fGd1YXJkP2FycmF5WzBdOnNsaWNlLmNhbGwoYXJyYXksMCxuKTt9O18uaW5pdGlhbD1mdW5jdGlvbihhcnJheSxuLGd1YXJkKXtyZXR1cm4gc2xpY2UuY2FsbChhcnJheSwwLGFycmF5Lmxlbmd0aC0oKG49PW51bGwpfHxndWFyZD8xOm4pKTt9O18ubGFzdD1mdW5jdGlvbihhcnJheSxuLGd1YXJkKXtpZihhcnJheT09bnVsbClyZXR1cm4gdm9pZCAwO2lmKChuPT1udWxsKXx8Z3VhcmQpe3JldHVybiBhcnJheVthcnJheS5sZW5ndGgtMV07fWVsc2V7cmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksTWF0aC5tYXgoYXJyYXkubGVuZ3RoLW4sMCkpO319O18ucmVzdD1fLnRhaWw9Xy5kcm9wPWZ1bmN0aW9uKGFycmF5LG4sZ3VhcmQpe3JldHVybiBzbGljZS5jYWxsKGFycmF5LChuPT1udWxsKXx8Z3VhcmQ/MTpuKTt9O18uY29tcGFjdD1mdW5jdGlvbihhcnJheSl7cmV0dXJuIF8uZmlsdGVyKGFycmF5LF8uaWRlbnRpdHkpO307dmFyIGZsYXR0ZW49ZnVuY3Rpb24oaW5wdXQsc2hhbGxvdyxvdXRwdXQpe2lmKHNoYWxsb3cmJl8uZXZlcnkoaW5wdXQsXy5pc0FycmF5KSl7cmV0dXJuIGNvbmNhdC5hcHBseShvdXRwdXQsaW5wdXQpO30KZWFjaChpbnB1dCxmdW5jdGlvbih2YWx1ZSl7aWYoXy5pc0FycmF5KHZhbHVlKXx8Xy5pc0FyZ3VtZW50cyh2YWx1ZSkpe3NoYWxsb3c/cHVzaC5hcHBseShvdXRwdXQsdmFsdWUpOmZsYXR0ZW4odmFsdWUsc2hhbGxvdyxvdXRwdXQpO31lbHNle291dHB1dC5wdXNoKHZhbHVlKTt9fSk7cmV0dXJuIG91dHB1dDt9O18uZmxhdHRlbj1mdW5jdGlvbihhcnJheSxzaGFsbG93KXtyZXR1cm4gZmxhdHRlbihhcnJheSxzaGFsbG93LFtdKTt9O18ud2l0aG91dD1mdW5jdGlvbihhcnJheSl7cmV0dXJuIF8uZGlmZmVyZW5jZShhcnJheSxzbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7fTtfLnVuaXE9Xy51bmlxdWU9ZnVuY3Rpb24oYXJyYXksaXNTb3J0ZWQsaXRlcmF0b3IsY29udGV4dCl7aWYoXy5pc0Z1bmN0aW9uKGlzU29ydGVkKSl7Y29udGV4dD1pdGVyYXRvcjtpdGVyYXRvcj1pc1NvcnRlZDtpc1NvcnRlZD1mYWxzZTt9CnZhciBpbml0aWFsPWl0ZXJhdG9yP18ubWFwKGFycmF5LGl0ZXJhdG9yLGNvbnRleHQpOmFycmF5O3ZhciByZXN1bHRzPVtdO3ZhciBzZWVuPVtdO2VhY2goaW5pdGlhbCxmdW5jdGlvbih2YWx1ZSxpbmRleCl7aWYoaXNTb3J0ZWQ/KCFpbmRleHx8c2VlbltzZWVuLmxlbmd0aC0xXSE9PXZhbHVlKTohXy5jb250YWlucyhzZWVuLHZhbHVlKSl7c2Vlbi5wdXNoKHZhbHVlKTtyZXN1bHRzLnB1c2goYXJyYXlbaW5kZXhdKTt9fSk7cmV0dXJuIHJlc3VsdHM7fTtfLnVuaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIF8udW5pcShfLmZsYXR0ZW4oYXJndW1lbnRzLHRydWUpKTt9O18uaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGFycmF5KXt2YXIgcmVzdD1zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtyZXR1cm4gXy5maWx0ZXIoXy51bmlxKGFycmF5KSxmdW5jdGlvbihpdGVtKXtyZXR1cm4gXy5ldmVyeShyZXN0LGZ1bmN0aW9uKG90aGVyKXtyZXR1cm4gXy5pbmRleE9mKG90aGVyLGl0ZW0pPj0wO30pO30pO307Xy5kaWZmZXJlbmNlPWZ1bmN0aW9uKGFycmF5KXt2YXIgcmVzdD1jb25jYXQuYXBwbHkoQXJyYXlQcm90byxzbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7cmV0dXJuIF8uZmlsdGVyKGFycmF5LGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4hXy5jb250YWlucyhyZXN0LHZhbHVlKTt9KTt9O18uemlwPWZ1bmN0aW9uKCl7dmFyIGxlbmd0aD1fLm1heChfLnBsdWNrKGFyZ3VtZW50cywibGVuZ3RoIikuY29uY2F0KDApKTt2YXIgcmVzdWx0cz1uZXcgQXJyYXkobGVuZ3RoKTtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3Jlc3VsdHNbaV09Xy5wbHVjayhhcmd1bWVudHMsJycraSk7fQpyZXR1cm4gcmVzdWx0czt9O18ub2JqZWN0PWZ1bmN0aW9uKGxpc3QsdmFsdWVzKXtpZihsaXN0PT1udWxsKXJldHVybnt9O3ZhciByZXN1bHQ9e307Zm9yKHZhciBpPTAsbGVuZ3RoPWxpc3QubGVuZ3RoO2k8bGVuZ3RoO2krKyl7aWYodmFsdWVzKXtyZXN1bHRbbGlzdFtpXV09dmFsdWVzW2ldO31lbHNle3Jlc3VsdFtsaXN0W2ldWzBdXT1saXN0W2ldWzFdO319CnJldHVybiByZXN1bHQ7fTtfLmluZGV4T2Y9ZnVuY3Rpb24oYXJyYXksaXRlbSxpc1NvcnRlZCl7aWYoYXJyYXk9PW51bGwpcmV0dXJuLTE7dmFyIGk9MCxsZW5ndGg9YXJyYXkubGVuZ3RoO2lmKGlzU29ydGVkKXtpZih0eXBlb2YgaXNTb3J0ZWQ9PSdudW1iZXInKXtpPShpc1NvcnRlZDwwP01hdGgubWF4KDAsbGVuZ3RoK2lzU29ydGVkKTppc1NvcnRlZCk7fWVsc2V7aT1fLnNvcnRlZEluZGV4KGFycmF5LGl0ZW0pO3JldHVybiBhcnJheVtpXT09PWl0ZW0/aTotMTt9fQppZihuYXRpdmVJbmRleE9mJiZhcnJheS5pbmRleE9mPT09bmF0aXZlSW5kZXhPZilyZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtLGlzU29ydGVkKTtmb3IoO2k8bGVuZ3RoO2krKylpZihhcnJheVtpXT09PWl0ZW0pcmV0dXJuIGk7cmV0dXJuLTE7fTtfLmxhc3RJbmRleE9mPWZ1bmN0aW9uKGFycmF5LGl0ZW0sZnJvbSl7aWYoYXJyYXk9PW51bGwpcmV0dXJuLTE7dmFyIGhhc0luZGV4PWZyb20hPW51bGw7aWYobmF0aXZlTGFzdEluZGV4T2YmJmFycmF5Lmxhc3RJbmRleE9mPT09bmF0aXZlTGFzdEluZGV4T2Ype3JldHVybiBoYXNJbmRleD9hcnJheS5sYXN0SW5kZXhPZihpdGVtLGZyb20pOmFycmF5Lmxhc3RJbmRleE9mKGl0ZW0pO30KdmFyIGk9KGhhc0luZGV4P2Zyb206YXJyYXkubGVuZ3RoKTt3aGlsZShpLS0paWYoYXJyYXlbaV09PT1pdGVtKXJldHVybiBpO3JldHVybi0xO307Xy5yYW5nZT1mdW5jdGlvbihzdGFydCxzdG9wLHN0ZXApe2lmKGFyZ3VtZW50cy5sZW5ndGg8PTEpe3N0b3A9c3RhcnR8fDA7c3RhcnQ9MDt9CnN0ZXA9YXJndW1lbnRzWzJdfHwxO3ZhciBsZW5ndGg9TWF0aC5tYXgoTWF0aC5jZWlsKChzdG9wLXN0YXJ0KS9zdGVwKSwwKTt2YXIgaWR4PTA7dmFyIHJhbmdlPW5ldyBBcnJheShsZW5ndGgpO3doaWxlKGlkeDxsZW5ndGgpe3JhbmdlW2lkeCsrXT1zdGFydDtzdGFydCs9c3RlcDt9CnJldHVybiByYW5nZTt9O3ZhciBjdG9yPWZ1bmN0aW9uKCl7fTtfLmJpbmQ9ZnVuY3Rpb24oZnVuYyxjb250ZXh0KXt2YXIgYXJncyxib3VuZDtpZihuYXRpdmVCaW5kJiZmdW5jLmJpbmQ9PT1uYXRpdmVCaW5kKXJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2lmKCFfLmlzRnVuY3Rpb24oZnVuYykpdGhyb3cgbmV3IFR5cGVFcnJvcjthcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBib3VuZD1mdW5jdGlvbigpe2lmKCEodGhpcyBpbnN0YW5jZW9mIGJvdW5kKSlyZXR1cm4gZnVuYy5hcHBseShjb250ZXh0LGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO2N0b3IucHJvdG90eXBlPWZ1bmMucHJvdG90eXBlO3ZhciBzZWxmPW5ldyBjdG9yO2N0b3IucHJvdG90eXBlPW51bGw7dmFyIHJlc3VsdD1mdW5jLmFwcGx5KHNlbGYsYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7aWYoT2JqZWN0KHJlc3VsdCk9PT1yZXN1bHQpcmV0dXJuIHJlc3VsdDtyZXR1cm4gc2VsZjt9O307Xy5wYXJ0aWFsPWZ1bmN0aW9uKGZ1bmMpe3ZhciBhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBmdW5jLmFwcGx5KHRoaXMsYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7fTt9O18uYmluZEFsbD1mdW5jdGlvbihvYmope3ZhciBmdW5jcz1zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtpZihmdW5jcy5sZW5ndGg9PT0wKXRocm93IG5ldyBFcnJvcigiYmluZEFsbCBtdXN0IGJlIHBhc3NlZCBmdW5jdGlvbiBuYW1lcyIpO2VhY2goZnVuY3MsZnVuY3Rpb24oZil7b2JqW2ZdPV8uYmluZChvYmpbZl0sb2JqKTt9KTtyZXR1cm4gb2JqO307Xy5tZW1vaXplPWZ1bmN0aW9uKGZ1bmMsaGFzaGVyKXt2YXIgbWVtbz17fTtoYXNoZXJ8fChoYXNoZXI9Xy5pZGVudGl0eSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGtleT1oYXNoZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiBfLmhhcyhtZW1vLGtleSk/bWVtb1trZXldOihtZW1vW2tleV09ZnVuYy5hcHBseSh0aGlzLGFyZ3VtZW50cykpO307fTtfLmRlbGF5PWZ1bmN0aW9uKGZ1bmMsd2FpdCl7dmFyIGFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtyZXR1cm4gZnVuYy5hcHBseShudWxsLGFyZ3MpO30sd2FpdCk7fTtfLmRlZmVyPWZ1bmN0aW9uKGZ1bmMpe3JldHVybiBfLmRlbGF5LmFwcGx5KF8sW2Z1bmMsMV0uY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKSk7fTtfLnRocm90dGxlPWZ1bmN0aW9uKGZ1bmMsd2FpdCxvcHRpb25zKXt2YXIgY29udGV4dCxhcmdzLHJlc3VsdDt2YXIgdGltZW91dD1udWxsO3ZhciBwcmV2aW91cz0wO29wdGlvbnN8fChvcHRpb25zPXt9KTt2YXIgbGF0ZXI9ZnVuY3Rpb24oKXtwcmV2aW91cz1vcHRpb25zLmxlYWRpbmc9PT1mYWxzZT8wOm5ldyBEYXRlO3RpbWVvdXQ9bnVsbDtyZXN1bHQ9ZnVuYy5hcHBseShjb250ZXh0LGFyZ3MpO307cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIG5vdz1uZXcgRGF0ZTtpZighcHJldmlvdXMmJm9wdGlvbnMubGVhZGluZz09PWZhbHNlKXByZXZpb3VzPW5vdzt2YXIgcmVtYWluaW5nPXdhaXQtKG5vdy1wcmV2aW91cyk7Y29udGV4dD10aGlzO2FyZ3M9YXJndW1lbnRzO2lmKHJlbWFpbmluZzw9MCl7Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO3RpbWVvdXQ9bnVsbDtwcmV2aW91cz1ub3c7cmVzdWx0PWZ1bmMuYXBwbHkoY29udGV4dCxhcmdzKTt9ZWxzZSBpZighdGltZW91dCYmb3B0aW9ucy50cmFpbGluZyE9PWZhbHNlKXt0aW1lb3V0PXNldFRpbWVvdXQobGF0ZXIscmVtYWluaW5nKTt9CnJldHVybiByZXN1bHQ7fTt9O18uZGVib3VuY2U9ZnVuY3Rpb24oZnVuYyx3YWl0LGltbWVkaWF0ZSl7dmFyIHRpbWVvdXQsYXJncyxjb250ZXh0LHRpbWVzdGFtcCxyZXN1bHQ7cmV0dXJuIGZ1bmN0aW9uKCl7Y29udGV4dD10aGlzO2FyZ3M9YXJndW1lbnRzO3RpbWVzdGFtcD1uZXcgRGF0ZSgpO3ZhciBsYXRlcj1mdW5jdGlvbigpe3ZhciBsYXN0PShuZXcgRGF0ZSgpKS10aW1lc3RhbXA7aWYobGFzdDx3YWl0KXt0aW1lb3V0PXNldFRpbWVvdXQobGF0ZXIsd2FpdC1sYXN0KTt9ZWxzZXt0aW1lb3V0PW51bGw7aWYoIWltbWVkaWF0ZSlyZXN1bHQ9ZnVuYy5hcHBseShjb250ZXh0LGFyZ3MpO319O3ZhciBjYWxsTm93PWltbWVkaWF0ZSYmIXRpbWVvdXQ7aWYoIXRpbWVvdXQpe3RpbWVvdXQ9c2V0VGltZW91dChsYXRlcix3YWl0KTt9CmlmKGNhbGxOb3cpcmVzdWx0PWZ1bmMuYXBwbHkoY29udGV4dCxhcmdzKTtyZXR1cm4gcmVzdWx0O307fTtfLm9uY2U9ZnVuY3Rpb24oZnVuYyl7dmFyIHJhbj1mYWxzZSxtZW1vO3JldHVybiBmdW5jdGlvbigpe2lmKHJhbilyZXR1cm4gbWVtbztyYW49dHJ1ZTttZW1vPWZ1bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpO2Z1bmM9bnVsbDtyZXR1cm4gbWVtbzt9O307Xy53cmFwPWZ1bmN0aW9uKGZ1bmMsd3JhcHBlcil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGFyZ3M9W2Z1bmNdO3B1c2guYXBwbHkoYXJncyxhcmd1bWVudHMpO3JldHVybiB3cmFwcGVyLmFwcGx5KHRoaXMsYXJncyk7fTt9O18uY29tcG9zZT1mdW5jdGlvbigpe3ZhciBmdW5jcz1hcmd1bWVudHM7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGFyZ3M9YXJndW1lbnRzO2Zvcih2YXIgaT1mdW5jcy5sZW5ndGgtMTtpPj0wO2ktLSl7YXJncz1bZnVuY3NbaV0uYXBwbHkodGhpcyxhcmdzKV07fQpyZXR1cm4gYXJnc1swXTt9O307Xy5hZnRlcj1mdW5jdGlvbih0aW1lcyxmdW5jKXtyZXR1cm4gZnVuY3Rpb24oKXtpZigtLXRpbWVzPDEpe3JldHVybiBmdW5jLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTt9O18ua2V5cz1uYXRpdmVLZXlzfHxmdW5jdGlvbihvYmope2lmKG9iaiE9PU9iamVjdChvYmopKXRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgb2JqZWN0Jyk7dmFyIGtleXM9W107Zm9yKHZhciBrZXkgaW4gb2JqKWlmKF8uaGFzKG9iaixrZXkpKWtleXMucHVzaChrZXkpO3JldHVybiBrZXlzO307Xy52YWx1ZXM9ZnVuY3Rpb24ob2JqKXt2YXIga2V5cz1fLmtleXMob2JqKTt2YXIgbGVuZ3RoPWtleXMubGVuZ3RoO3ZhciB2YWx1ZXM9bmV3IEFycmF5KGxlbmd0aCk7Zm9yKHZhciBpPTA7aTxsZW5ndGg7aSsrKXt2YWx1ZXNbaV09b2JqW2tleXNbaV1dO30KcmV0dXJuIHZhbHVlczt9O18ucGFpcnM9ZnVuY3Rpb24ob2JqKXt2YXIga2V5cz1fLmtleXMob2JqKTt2YXIgbGVuZ3RoPWtleXMubGVuZ3RoO3ZhciBwYWlycz1uZXcgQXJyYXkobGVuZ3RoKTtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3BhaXJzW2ldPVtrZXlzW2ldLG9ialtrZXlzW2ldXV07fQpyZXR1cm4gcGFpcnM7fTtfLmludmVydD1mdW5jdGlvbihvYmope3ZhciByZXN1bHQ9e307dmFyIGtleXM9Xy5rZXlzKG9iaik7Zm9yKHZhciBpPTAsbGVuZ3RoPWtleXMubGVuZ3RoO2k8bGVuZ3RoO2krKyl7cmVzdWx0W29ialtrZXlzW2ldXV09a2V5c1tpXTt9CnJldHVybiByZXN1bHQ7fTtfLmZ1bmN0aW9ucz1fLm1ldGhvZHM9ZnVuY3Rpb24ob2JqKXt2YXIgbmFtZXM9W107Zm9yKHZhciBrZXkgaW4gb2JqKXtpZihfLmlzRnVuY3Rpb24ob2JqW2tleV0pKW5hbWVzLnB1c2goa2V5KTt9CnJldHVybiBuYW1lcy5zb3J0KCk7fTtfLmV4dGVuZD1mdW5jdGlvbihvYmope2VhY2goc2xpY2UuY2FsbChhcmd1bWVudHMsMSksZnVuY3Rpb24oc291cmNlKXtpZihzb3VyY2Upe2Zvcih2YXIgcHJvcCBpbiBzb3VyY2Upe29ialtwcm9wXT1zb3VyY2VbcHJvcF07fX19KTtyZXR1cm4gb2JqO307Xy5waWNrPWZ1bmN0aW9uKG9iail7dmFyIGNvcHk9e307dmFyIGtleXM9Y29uY2F0LmFwcGx5KEFycmF5UHJvdG8sc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2VhY2goa2V5cyxmdW5jdGlvbihrZXkpe2lmKGtleSBpbiBvYmopY29weVtrZXldPW9ialtrZXldO30pO3JldHVybiBjb3B5O307Xy5vbWl0PWZ1bmN0aW9uKG9iail7dmFyIGNvcHk9e307dmFyIGtleXM9Y29uY2F0LmFwcGx5KEFycmF5UHJvdG8sc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2Zvcih2YXIga2V5IGluIG9iail7aWYoIV8uY29udGFpbnMoa2V5cyxrZXkpKWNvcHlba2V5XT1vYmpba2V5XTt9CnJldHVybiBjb3B5O307Xy5kZWZhdWx0cz1mdW5jdGlvbihvYmope2VhY2goc2xpY2UuY2FsbChhcmd1bWVudHMsMSksZnVuY3Rpb24oc291cmNlKXtpZihzb3VyY2Upe2Zvcih2YXIgcHJvcCBpbiBzb3VyY2Upe2lmKG9ialtwcm9wXT09PXZvaWQgMClvYmpbcHJvcF09c291cmNlW3Byb3BdO319fSk7cmV0dXJuIG9iajt9O18uY2xvbmU9ZnVuY3Rpb24ob2JqKXtpZighXy5pc09iamVjdChvYmopKXJldHVybiBvYmo7cmV0dXJuIF8uaXNBcnJheShvYmopP29iai5zbGljZSgpOl8uZXh0ZW5kKHt9LG9iaik7fTtfLnRhcD1mdW5jdGlvbihvYmosaW50ZXJjZXB0b3Ipe2ludGVyY2VwdG9yKG9iaik7cmV0dXJuIG9iajt9O3ZhciBlcT1mdW5jdGlvbihhLGIsYVN0YWNrLGJTdGFjayl7aWYoYT09PWIpcmV0dXJuIGEhPT0wfHwxL2E9PTEvYjtpZihhPT1udWxsfHxiPT1udWxsKXJldHVybiBhPT09YjtpZihhIGluc3RhbmNlb2YgXylhPWEuX3dyYXBwZWQ7aWYoYiBpbnN0YW5jZW9mIF8pYj1iLl93cmFwcGVkO3ZhciBjbGFzc05hbWU9dG9TdHJpbmcuY2FsbChhKTtpZihjbGFzc05hbWUhPXRvU3RyaW5nLmNhbGwoYikpcmV0dXJuIGZhbHNlO3N3aXRjaChjbGFzc05hbWUpe2Nhc2UnW29iamVjdCBTdHJpbmddJzpyZXR1cm4gYT09U3RyaW5nKGIpO2Nhc2UnW29iamVjdCBOdW1iZXJdJzpyZXR1cm4gYSE9K2E/YiE9K2I6KGE9PTA/MS9hPT0xL2I6YT09K2IpO2Nhc2UnW29iamVjdCBEYXRlXSc6Y2FzZSdbb2JqZWN0IEJvb2xlYW5dJzpyZXR1cm4rYT09K2I7Y2FzZSdbb2JqZWN0IFJlZ0V4cF0nOnJldHVybiBhLnNvdXJjZT09Yi5zb3VyY2UmJmEuZ2xvYmFsPT1iLmdsb2JhbCYmYS5tdWx0aWxpbmU9PWIubXVsdGlsaW5lJiZhLmlnbm9yZUNhc2U9PWIuaWdub3JlQ2FzZTt9CmlmKHR5cGVvZiBhIT0nb2JqZWN0J3x8dHlwZW9mIGIhPSdvYmplY3QnKXJldHVybiBmYWxzZTt2YXIgbGVuZ3RoPWFTdGFjay5sZW5ndGg7d2hpbGUobGVuZ3RoLS0pe2lmKGFTdGFja1tsZW5ndGhdPT1hKXJldHVybiBiU3RhY2tbbGVuZ3RoXT09Yjt9CnZhciBhQ3Rvcj1hLmNvbnN0cnVjdG9yLGJDdG9yPWIuY29uc3RydWN0b3I7aWYoYUN0b3IhPT1iQ3RvciYmIShfLmlzRnVuY3Rpb24oYUN0b3IpJiYoYUN0b3IgaW5zdGFuY2VvZiBhQ3RvcikmJl8uaXNGdW5jdGlvbihiQ3RvcikmJihiQ3RvciBpbnN0YW5jZW9mIGJDdG9yKSkpe3JldHVybiBmYWxzZTt9CmFTdGFjay5wdXNoKGEpO2JTdGFjay5wdXNoKGIpO3ZhciBzaXplPTAscmVzdWx0PXRydWU7aWYoY2xhc3NOYW1lPT0nW29iamVjdCBBcnJheV0nKXtzaXplPWEubGVuZ3RoO3Jlc3VsdD1zaXplPT1iLmxlbmd0aDtpZihyZXN1bHQpe3doaWxlKHNpemUtLSl7aWYoIShyZXN1bHQ9ZXEoYVtzaXplXSxiW3NpemVdLGFTdGFjayxiU3RhY2spKSlicmVhazt9fX1lbHNle2Zvcih2YXIga2V5IGluIGEpe2lmKF8uaGFzKGEsa2V5KSl7c2l6ZSsrO2lmKCEocmVzdWx0PV8uaGFzKGIsa2V5KSYmZXEoYVtrZXldLGJba2V5XSxhU3RhY2ssYlN0YWNrKSkpYnJlYWs7fX0KaWYocmVzdWx0KXtmb3Ioa2V5IGluIGIpe2lmKF8uaGFzKGIsa2V5KSYmIShzaXplLS0pKWJyZWFrO30KcmVzdWx0PSFzaXplO319CmFTdGFjay5wb3AoKTtiU3RhY2sucG9wKCk7cmV0dXJuIHJlc3VsdDt9O18uaXNFcXVhbD1mdW5jdGlvbihhLGIpe3JldHVybiBlcShhLGIsW10sW10pO307Xy5pc0VtcHR5PWZ1bmN0aW9uKG9iail7aWYob2JqPT1udWxsKXJldHVybiB0cnVlO2lmKF8uaXNBcnJheShvYmopfHxfLmlzU3RyaW5nKG9iaikpcmV0dXJuIG9iai5sZW5ndGg9PT0wO2Zvcih2YXIga2V5IGluIG9iailpZihfLmhhcyhvYmosa2V5KSlyZXR1cm4gZmFsc2U7cmV0dXJuIHRydWU7fTtfLmlzRWxlbWVudD1mdW5jdGlvbihvYmope3JldHVybiEhKG9iaiYmb2JqLm5vZGVUeXBlPT09MSk7fTtfLmlzQXJyYXk9bmF0aXZlSXNBcnJheXx8ZnVuY3Rpb24ob2JqKXtyZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopPT0nW29iamVjdCBBcnJheV0nO307Xy5pc09iamVjdD1mdW5jdGlvbihvYmope3JldHVybiBvYmo9PT1PYmplY3Qob2JqKTt9O2VhY2goWydBcmd1bWVudHMnLCdGdW5jdGlvbicsJ1N0cmluZycsJ051bWJlcicsJ0RhdGUnLCdSZWdFeHAnXSxmdW5jdGlvbihuYW1lKXtfWydpcycrbmFtZV09ZnVuY3Rpb24ob2JqKXtyZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopPT0nW29iamVjdCAnK25hbWUrJ10nO307fSk7aWYoIV8uaXNBcmd1bWVudHMoYXJndW1lbnRzKSl7Xy5pc0FyZ3VtZW50cz1mdW5jdGlvbihvYmope3JldHVybiEhKG9iaiYmXy5oYXMob2JqLCdjYWxsZWUnKSk7fTt9CmlmKHR5cGVvZigvLi8pIT09J2Z1bmN0aW9uJyl7Xy5pc0Z1bmN0aW9uPWZ1bmN0aW9uKG9iail7cmV0dXJuIHR5cGVvZiBvYmo9PT0nZnVuY3Rpb24nO307fQpfLmlzRmluaXRlPWZ1bmN0aW9uKG9iail7cmV0dXJuIGlzRmluaXRlKG9iaikmJiFpc05hTihwYXJzZUZsb2F0KG9iaikpO307Xy5pc05hTj1mdW5jdGlvbihvYmope3JldHVybiBfLmlzTnVtYmVyKG9iaikmJm9iaiE9K29iajt9O18uaXNCb29sZWFuPWZ1bmN0aW9uKG9iail7cmV0dXJuIG9iaj09PXRydWV8fG9iaj09PWZhbHNlfHx0b1N0cmluZy5jYWxsKG9iaik9PSdbb2JqZWN0IEJvb2xlYW5dJzt9O18uaXNOdWxsPWZ1bmN0aW9uKG9iail7cmV0dXJuIG9iaj09PW51bGw7fTtfLmlzVW5kZWZpbmVkPWZ1bmN0aW9uKG9iail7cmV0dXJuIG9iaj09PXZvaWQgMDt9O18uaGFzPWZ1bmN0aW9uKG9iaixrZXkpe3JldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaixrZXkpO307Xy5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cm9vdC5fPXByZXZpb3VzVW5kZXJzY29yZTtyZXR1cm4gdGhpczt9O18uaWRlbnRpdHk9ZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZTt9O18udGltZXM9ZnVuY3Rpb24obixpdGVyYXRvcixjb250ZXh0KXt2YXIgYWNjdW09QXJyYXkoTWF0aC5tYXgoMCxuKSk7Zm9yKHZhciBpPTA7aTxuO2krKylhY2N1bVtpXT1pdGVyYXRvci5jYWxsKGNvbnRleHQsaSk7cmV0dXJuIGFjY3VtO307Xy5yYW5kb209ZnVuY3Rpb24obWluLG1heCl7aWYobWF4PT1udWxsKXttYXg9bWluO21pbj0wO30KcmV0dXJuIG1pbitNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKG1heC1taW4rMSkpO307dmFyIGVudGl0eU1hcD17ZXNjYXBlOnsnJic6JyZhbXA7JywnPCc6JyZsdDsnLCc+JzonJmd0OycsJyInOicmcXVvdDsnLCInIjonJiN4Mjc7J319O2VudGl0eU1hcC51bmVzY2FwZT1fLmludmVydChlbnRpdHlNYXAuZXNjYXBlKTt2YXIgZW50aXR5UmVnZXhlcz17ZXNjYXBlOm5ldyBSZWdFeHAoJ1snK18ua2V5cyhlbnRpdHlNYXAuZXNjYXBlKS5qb2luKCcnKSsnXScsJ2cnKSx1bmVzY2FwZTpuZXcgUmVnRXhwKCcoJytfLmtleXMoZW50aXR5TWFwLnVuZXNjYXBlKS5qb2luKCd8JykrJyknLCdnJyl9O18uZWFjaChbJ2VzY2FwZScsJ3VuZXNjYXBlJ10sZnVuY3Rpb24obWV0aG9kKXtfW21ldGhvZF09ZnVuY3Rpb24oc3RyaW5nKXtpZihzdHJpbmc9PW51bGwpcmV0dXJuJyc7cmV0dXJuKCcnK3N0cmluZykucmVwbGFjZShlbnRpdHlSZWdleGVzW21ldGhvZF0sZnVuY3Rpb24obWF0Y2gpe3JldHVybiBlbnRpdHlNYXBbbWV0aG9kXVttYXRjaF07fSk7fTt9KTtfLnJlc3VsdD1mdW5jdGlvbihvYmplY3QscHJvcGVydHkpe2lmKG9iamVjdD09bnVsbClyZXR1cm4gdm9pZCAwO3ZhciB2YWx1ZT1vYmplY3RbcHJvcGVydHldO3JldHVybiBfLmlzRnVuY3Rpb24odmFsdWUpP3ZhbHVlLmNhbGwob2JqZWN0KTp2YWx1ZTt9O18ubWl4aW49ZnVuY3Rpb24ob2JqKXtlYWNoKF8uZnVuY3Rpb25zKG9iaiksZnVuY3Rpb24obmFtZSl7dmFyIGZ1bmM9X1tuYW1lXT1vYmpbbmFtZV07Xy5wcm90b3R5cGVbbmFtZV09ZnVuY3Rpb24oKXt2YXIgYXJncz1bdGhpcy5fd3JhcHBlZF07cHVzaC5hcHBseShhcmdzLGFyZ3VtZW50cyk7cmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsZnVuYy5hcHBseShfLGFyZ3MpKTt9O30pO307dmFyIGlkQ291bnRlcj0wO18udW5pcXVlSWQ9ZnVuY3Rpb24ocHJlZml4KXt2YXIgaWQ9KytpZENvdW50ZXIrJyc7cmV0dXJuIHByZWZpeD9wcmVmaXgraWQ6aWQ7fTtfLnRlbXBsYXRlU2V0dGluZ3M9e2V2YWx1YXRlOi88JShbXHNcU10rPyklPi9nLGludGVycG9sYXRlOi88JT0oW1xzXFNdKz8pJT4vZyxlc2NhcGU6LzwlLShbXHNcU10rPyklPi9nfTt2YXIgbm9NYXRjaD0vKC4pXi87dmFyIGVzY2FwZXM9eyInIjoiJyIsJ1xcJzonXFwnLCdccic6J3InLCdcbic6J24nLCdcdCc6J3QnLCdcdTIwMjgnOid1MjAyOCcsJ1x1MjAyOSc6J3UyMDI5J307dmFyIGVzY2FwZXI9L1xcfCd8XHJ8XG58XHR8XHUyMDI4fFx1MjAyOS9nO18udGVtcGxhdGU9ZnVuY3Rpb24odGV4dCxkYXRhLHNldHRpbmdzKXt2YXIgcmVuZGVyO3NldHRpbmdzPV8uZGVmYXVsdHMoe30sc2V0dGluZ3MsXy50ZW1wbGF0ZVNldHRpbmdzKTt2YXIgbWF0Y2hlcj1uZXcgUmVnRXhwKFsoc2V0dGluZ3MuZXNjYXBlfHxub01hdGNoKS5zb3VyY2UsKHNldHRpbmdzLmludGVycG9sYXRlfHxub01hdGNoKS5zb3VyY2UsKHNldHRpbmdzLmV2YWx1YXRlfHxub01hdGNoKS5zb3VyY2VdLmpvaW4oJ3wnKSsnfCQnLCdnJyk7dmFyIGluZGV4PTA7dmFyIHNvdXJjZT0iX19wKz0nIjt0ZXh0LnJlcGxhY2UobWF0Y2hlcixmdW5jdGlvbihtYXRjaCxlc2NhcGUsaW50ZXJwb2xhdGUsZXZhbHVhdGUsb2Zmc2V0KXtzb3VyY2UrPXRleHQuc2xpY2UoaW5kZXgsb2Zmc2V0KS5yZXBsYWNlKGVzY2FwZXIsZnVuY3Rpb24obWF0Y2gpe3JldHVybidcXCcrZXNjYXBlc1ttYXRjaF07fSk7aWYoZXNjYXBlKXtzb3VyY2UrPSInK1xuKChfX3Q9KCIrZXNjYXBlKyIpKT09bnVsbD8nJzpfLmVzY2FwZShfX3QpKStcbiciO30KaWYoaW50ZXJwb2xhdGUpe3NvdXJjZSs9IicrXG4oKF9fdD0oIitpbnRlcnBvbGF0ZSsiKSk9PW51bGw/Jyc6X190KStcbiciO30KaWYoZXZhbHVhdGUpe3NvdXJjZSs9Iic7XG4iK2V2YWx1YXRlKyJcbl9fcCs9JyI7fQppbmRleD1vZmZzZXQrbWF0Y2gubGVuZ3RoO3JldHVybiBtYXRjaDt9KTtzb3VyY2UrPSInO1xuIjtpZighc2V0dGluZ3MudmFyaWFibGUpc291cmNlPSd3aXRoKG9ianx8e30pe1xuJytzb3VyY2UrJ31cbic7c291cmNlPSJ2YXIgX190LF9fcD0nJyxfX2o9QXJyYXkucHJvdG90eXBlLmpvaW4sIisicHJpbnQ9ZnVuY3Rpb24oKXtfX3ArPV9fai5jYWxsKGFyZ3VtZW50cywnJyk7fTtcbiIrCnNvdXJjZSsicmV0dXJuIF9fcDtcbiI7dHJ5e3JlbmRlcj1uZXcgRnVuY3Rpb24oc2V0dGluZ3MudmFyaWFibGV8fCdvYmonLCdfJyxzb3VyY2UpO31jYXRjaChlKXtlLnNvdXJjZT1zb3VyY2U7dGhyb3cgZTt9CmlmKGRhdGEpcmV0dXJuIHJlbmRlcihkYXRhLF8pO3ZhciB0ZW1wbGF0ZT1mdW5jdGlvbihkYXRhKXtyZXR1cm4gcmVuZGVyLmNhbGwodGhpcyxkYXRhLF8pO307dGVtcGxhdGUuc291cmNlPSdmdW5jdGlvbignKyhzZXR0aW5ncy52YXJpYWJsZXx8J29iaicpKycpe1xuJytzb3VyY2UrJ30nO3JldHVybiB0ZW1wbGF0ZTt9O18uY2hhaW49ZnVuY3Rpb24ob2JqKXtyZXR1cm4gXyhvYmopLmNoYWluKCk7fTt2YXIgcmVzdWx0PWZ1bmN0aW9uKG9iail7cmV0dXJuIHRoaXMuX2NoYWluP18ob2JqKS5jaGFpbigpOm9iajt9O18ubWl4aW4oXyk7ZWFjaChbJ3BvcCcsJ3B1c2gnLCdyZXZlcnNlJywnc2hpZnQnLCdzb3J0Jywnc3BsaWNlJywndW5zaGlmdCddLGZ1bmN0aW9uKG5hbWUpe3ZhciBtZXRob2Q9QXJyYXlQcm90b1tuYW1lXTtfLnByb3RvdHlwZVtuYW1lXT1mdW5jdGlvbigpe3ZhciBvYmo9dGhpcy5fd3JhcHBlZDttZXRob2QuYXBwbHkob2JqLGFyZ3VtZW50cyk7aWYoKG5hbWU9PSdzaGlmdCd8fG5hbWU9PSdzcGxpY2UnKSYmb2JqLmxlbmd0aD09PTApZGVsZXRlIG9ialswXTtyZXR1cm4gcmVzdWx0LmNhbGwodGhpcyxvYmopO307fSk7ZWFjaChbJ2NvbmNhdCcsJ2pvaW4nLCdzbGljZSddLGZ1bmN0aW9uKG5hbWUpe3ZhciBtZXRob2Q9QXJyYXlQcm90b1tuYW1lXTtfLnByb3RvdHlwZVtuYW1lXT1mdW5jdGlvbigpe3JldHVybiByZXN1bHQuY2FsbCh0aGlzLG1ldGhvZC5hcHBseSh0aGlzLl93cmFwcGVkLGFyZ3VtZW50cykpO307fSk7Xy5leHRlbmQoXy5wcm90b3R5cGUse2NoYWluOmZ1bmN0aW9uKCl7dGhpcy5fY2hhaW49dHJ1ZTtyZXR1cm4gdGhpczt9LHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dyYXBwZWQ7fX0pO30pLmNhbGwodGhpcyk7KGZ1bmN0aW9uKCl7dmFyIHJvb3Q9dGhpczt2YXIgcHJldmlvdXNCYWNrYm9uZT1yb290LkJhY2tib25lO3ZhciBhcnJheT1bXTt2YXIgcHVzaD1hcnJheS5wdXNoO3ZhciBzbGljZT1hcnJheS5zbGljZTt2YXIgc3BsaWNlPWFycmF5LnNwbGljZTt2YXIgQmFja2JvbmU7aWYodHlwZW9mIGV4cG9ydHMhPT0ndW5kZWZpbmVkJyl7QmFja2JvbmU9ZXhwb3J0czt9ZWxzZXtCYWNrYm9uZT1yb290LkJhY2tib25lPXt9O30KQmFja2JvbmUuVkVSU0lPTj0nMS4xLjAnO3ZhciBfPXJvb3QuXztpZighXyYmKHR5cGVvZiByZXF1aXJlIT09J3VuZGVmaW5lZCcpKV89cmVxdWlyZSgndW5kZXJzY29yZScpO0JhY2tib25lLiQ9cm9vdC5qUXVlcnl8fHJvb3QuWmVwdG98fHJvb3QuZW5kZXJ8fHJvb3QuJDtCYWNrYm9uZS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cm9vdC5CYWNrYm9uZT1wcmV2aW91c0JhY2tib25lO3JldHVybiB0aGlzO307QmFja2JvbmUuZW11bGF0ZUhUVFA9ZmFsc2U7QmFja2JvbmUuZW11bGF0ZUpTT049ZmFsc2U7dmFyIEV2ZW50cz1CYWNrYm9uZS5FdmVudHM9e29uOmZ1bmN0aW9uKG5hbWUsY2FsbGJhY2ssY29udGV4dCl7aWYoIWV2ZW50c0FwaSh0aGlzLCdvbicsbmFtZSxbY2FsbGJhY2ssY29udGV4dF0pfHwhY2FsbGJhY2spcmV0dXJuIHRoaXM7dGhpcy5fZXZlbnRzfHwodGhpcy5fZXZlbnRzPXt9KTt2YXIgZXZlbnRzPXRoaXMuX2V2ZW50c1tuYW1lXXx8KHRoaXMuX2V2ZW50c1tuYW1lXT1bXSk7ZXZlbnRzLnB1c2goe2NhbGxiYWNrOmNhbGxiYWNrLGNvbnRleHQ6Y29udGV4dCxjdHg6Y29udGV4dHx8dGhpc30pO3JldHVybiB0aGlzO30sb25jZTpmdW5jdGlvbihuYW1lLGNhbGxiYWNrLGNvbnRleHQpe2lmKCFldmVudHNBcGkodGhpcywnb25jZScsbmFtZSxbY2FsbGJhY2ssY29udGV4dF0pfHwhY2FsbGJhY2spcmV0dXJuIHRoaXM7dmFyIHNlbGY9dGhpczt2YXIgb25jZT1fLm9uY2UoZnVuY3Rpb24oKXtzZWxmLm9mZihuYW1lLG9uY2UpO2NhbGxiYWNrLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9KTtvbmNlLl9jYWxsYmFjaz1jYWxsYmFjaztyZXR1cm4gdGhpcy5vbihuYW1lLG9uY2UsY29udGV4dCk7fSxvZmY6ZnVuY3Rpb24obmFtZSxjYWxsYmFjayxjb250ZXh0KXt2YXIgcmV0YWluLGV2LGV2ZW50cyxuYW1lcyxpLGwsaixrO2lmKCF0aGlzLl9ldmVudHN8fCFldmVudHNBcGkodGhpcywnb2ZmJyxuYW1lLFtjYWxsYmFjayxjb250ZXh0XSkpcmV0dXJuIHRoaXM7aWYoIW5hbWUmJiFjYWxsYmFjayYmIWNvbnRleHQpe3RoaXMuX2V2ZW50cz17fTtyZXR1cm4gdGhpczt9Cm5hbWVzPW5hbWU/W25hbWVdOl8ua2V5cyh0aGlzLl9ldmVudHMpO2ZvcihpPTAsbD1uYW1lcy5sZW5ndGg7aTxsO2krKyl7bmFtZT1uYW1lc1tpXTtpZihldmVudHM9dGhpcy5fZXZlbnRzW25hbWVdKXt0aGlzLl9ldmVudHNbbmFtZV09cmV0YWluPVtdO2lmKGNhbGxiYWNrfHxjb250ZXh0KXtmb3Ioaj0wLGs9ZXZlbnRzLmxlbmd0aDtqPGs7aisrKXtldj1ldmVudHNbal07aWYoKGNhbGxiYWNrJiZjYWxsYmFjayE9PWV2LmNhbGxiYWNrJiZjYWxsYmFjayE9PWV2LmNhbGxiYWNrLl9jYWxsYmFjayl8fChjb250ZXh0JiZjb250ZXh0IT09ZXYuY29udGV4dCkpe3JldGFpbi5wdXNoKGV2KTt9fX0KaWYoIXJldGFpbi5sZW5ndGgpZGVsZXRlIHRoaXMuX2V2ZW50c1tuYW1lXTt9fQpyZXR1cm4gdGhpczt9LHRyaWdnZXI6ZnVuY3Rpb24obmFtZSl7aWYoIXRoaXMuX2V2ZW50cylyZXR1cm4gdGhpczt2YXIgYXJncz1zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtpZighZXZlbnRzQXBpKHRoaXMsJ3RyaWdnZXInLG5hbWUsYXJncykpcmV0dXJuIHRoaXM7dmFyIGV2ZW50cz10aGlzLl9ldmVudHNbbmFtZV07dmFyIGFsbEV2ZW50cz10aGlzLl9ldmVudHMuYWxsO2lmKGV2ZW50cyl0cmlnZ2VyRXZlbnRzKGV2ZW50cyxhcmdzKTtpZihhbGxFdmVudHMpdHJpZ2dlckV2ZW50cyhhbGxFdmVudHMsYXJndW1lbnRzKTtyZXR1cm4gdGhpczt9LHN0b3BMaXN0ZW5pbmc6ZnVuY3Rpb24ob2JqLG5hbWUsY2FsbGJhY2spe3ZhciBsaXN0ZW5pbmdUbz10aGlzLl9saXN0ZW5pbmdUbztpZighbGlzdGVuaW5nVG8pcmV0dXJuIHRoaXM7dmFyIHJlbW92ZT0hbmFtZSYmIWNhbGxiYWNrO2lmKCFjYWxsYmFjayYmdHlwZW9mIG5hbWU9PT0nb2JqZWN0JyljYWxsYmFjaz10aGlzO2lmKG9iaikobGlzdGVuaW5nVG89e30pW29iai5fbGlzdGVuSWRdPW9iajtmb3IodmFyIGlkIGluIGxpc3RlbmluZ1RvKXtvYmo9bGlzdGVuaW5nVG9baWRdO29iai5vZmYobmFtZSxjYWxsYmFjayx0aGlzKTtpZihyZW1vdmV8fF8uaXNFbXB0eShvYmouX2V2ZW50cykpZGVsZXRlIHRoaXMuX2xpc3RlbmluZ1RvW2lkXTt9CnJldHVybiB0aGlzO319O3ZhciBldmVudFNwbGl0dGVyPS9ccysvO3ZhciBldmVudHNBcGk9ZnVuY3Rpb24ob2JqLGFjdGlvbixuYW1lLHJlc3Qpe2lmKCFuYW1lKXJldHVybiB0cnVlO2lmKHR5cGVvZiBuYW1lPT09J29iamVjdCcpe2Zvcih2YXIga2V5IGluIG5hbWUpe29ialthY3Rpb25dLmFwcGx5KG9iaixba2V5LG5hbWVba2V5XV0uY29uY2F0KHJlc3QpKTt9CnJldHVybiBmYWxzZTt9CmlmKGV2ZW50U3BsaXR0ZXIudGVzdChuYW1lKSl7dmFyIG5hbWVzPW5hbWUuc3BsaXQoZXZlbnRTcGxpdHRlcik7Zm9yKHZhciBpPTAsbD1uYW1lcy5sZW5ndGg7aTxsO2krKyl7b2JqW2FjdGlvbl0uYXBwbHkob2JqLFtuYW1lc1tpXV0uY29uY2F0KHJlc3QpKTt9CnJldHVybiBmYWxzZTt9CnJldHVybiB0cnVlO307dmFyIHRyaWdnZXJFdmVudHM9ZnVuY3Rpb24oZXZlbnRzLGFyZ3Mpe3ZhciBldixpPS0xLGw9ZXZlbnRzLmxlbmd0aCxhMT1hcmdzWzBdLGEyPWFyZ3NbMV0sYTM9YXJnc1syXTtzd2l0Y2goYXJncy5sZW5ndGgpe2Nhc2UgMDp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCk7cmV0dXJuO2Nhc2UgMTp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSk7cmV0dXJuO2Nhc2UgMjp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSxhMik7cmV0dXJuO2Nhc2UgMzp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSxhMixhMyk7cmV0dXJuO2RlZmF1bHQ6d2hpbGUoKytpPGwpKGV2PWV2ZW50c1tpXSkuY2FsbGJhY2suYXBwbHkoZXYuY3R4LGFyZ3MpO319O3ZhciBsaXN0ZW5NZXRob2RzPXtsaXN0ZW5Ubzonb24nLGxpc3RlblRvT25jZTonb25jZSd9O18uZWFjaChsaXN0ZW5NZXRob2RzLGZ1bmN0aW9uKGltcGxlbWVudGF0aW9uLG1ldGhvZCl7RXZlbnRzW21ldGhvZF09ZnVuY3Rpb24ob2JqLG5hbWUsY2FsbGJhY2spe3ZhciBsaXN0ZW5pbmdUbz10aGlzLl9saXN0ZW5pbmdUb3x8KHRoaXMuX2xpc3RlbmluZ1RvPXt9KTt2YXIgaWQ9b2JqLl9saXN0ZW5JZHx8KG9iai5fbGlzdGVuSWQ9Xy51bmlxdWVJZCgnbCcpKTtsaXN0ZW5pbmdUb1tpZF09b2JqO2lmKCFjYWxsYmFjayYmdHlwZW9mIG5hbWU9PT0nb2JqZWN0JyljYWxsYmFjaz10aGlzO29ialtpbXBsZW1lbnRhdGlvbl0obmFtZSxjYWxsYmFjayx0aGlzKTtyZXR1cm4gdGhpczt9O30pO0V2ZW50cy5iaW5kPUV2ZW50cy5vbjtFdmVudHMudW5iaW5kPUV2ZW50cy5vZmY7Xy5leHRlbmQoQmFja2JvbmUsRXZlbnRzKTt2YXIgTW9kZWw9QmFja2JvbmUuTW9kZWw9ZnVuY3Rpb24oYXR0cmlidXRlcyxvcHRpb25zKXt2YXIgYXR0cnM9YXR0cmlidXRlc3x8e307b3B0aW9uc3x8KG9wdGlvbnM9e30pO3RoaXMuY2lkPV8udW5pcXVlSWQoJ2MnKTt0aGlzLmF0dHJpYnV0ZXM9e307aWYob3B0aW9ucy5jb2xsZWN0aW9uKXRoaXMuY29sbGVjdGlvbj1vcHRpb25zLmNvbGxlY3Rpb247aWYob3B0aW9ucy5wYXJzZSlhdHRycz10aGlzLnBhcnNlKGF0dHJzLG9wdGlvbnMpfHx7fTthdHRycz1fLmRlZmF1bHRzKHt9LGF0dHJzLF8ucmVzdWx0KHRoaXMsJ2RlZmF1bHRzJykpO3RoaXMuc2V0KGF0dHJzLG9wdGlvbnMpO3RoaXMuY2hhbmdlZD17fTt0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO307Xy5leHRlbmQoTW9kZWwucHJvdG90eXBlLEV2ZW50cyx7Y2hhbmdlZDpudWxsLHZhbGlkYXRpb25FcnJvcjpudWxsLGlkQXR0cmlidXRlOidpZCcsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sdG9KU09OOmZ1bmN0aW9uKG9wdGlvbnMpe3JldHVybiBfLmNsb25lKHRoaXMuYXR0cmlidXRlcyk7fSxzeW5jOmZ1bmN0aW9uKCl7cmV0dXJuIEJhY2tib25lLnN5bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sZ2V0OmZ1bmN0aW9uKGF0dHIpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cl07fSxlc2NhcGU6ZnVuY3Rpb24oYXR0cil7cmV0dXJuIF8uZXNjYXBlKHRoaXMuZ2V0KGF0dHIpKTt9LGhhczpmdW5jdGlvbihhdHRyKXtyZXR1cm4gdGhpcy5nZXQoYXR0cikhPW51bGw7fSxzZXQ6ZnVuY3Rpb24oa2V5LHZhbCxvcHRpb25zKXt2YXIgYXR0cixhdHRycyx1bnNldCxjaGFuZ2VzLHNpbGVudCxjaGFuZ2luZyxwcmV2LGN1cnJlbnQ7aWYoa2V5PT1udWxsKXJldHVybiB0aGlzO2lmKHR5cGVvZiBrZXk9PT0nb2JqZWN0Jyl7YXR0cnM9a2V5O29wdGlvbnM9dmFsO31lbHNleyhhdHRycz17fSlba2V5XT12YWw7fQpvcHRpb25zfHwob3B0aW9ucz17fSk7aWYoIXRoaXMuX3ZhbGlkYXRlKGF0dHJzLG9wdGlvbnMpKXJldHVybiBmYWxzZTt1bnNldD1vcHRpb25zLnVuc2V0O3NpbGVudD1vcHRpb25zLnNpbGVudDtjaGFuZ2VzPVtdO2NoYW5naW5nPXRoaXMuX2NoYW5naW5nO3RoaXMuX2NoYW5naW5nPXRydWU7aWYoIWNoYW5naW5nKXt0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM9Xy5jbG9uZSh0aGlzLmF0dHJpYnV0ZXMpO3RoaXMuY2hhbmdlZD17fTt9CmN1cnJlbnQ9dGhpcy5hdHRyaWJ1dGVzLHByZXY9dGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzO2lmKHRoaXMuaWRBdHRyaWJ1dGUgaW4gYXR0cnMpdGhpcy5pZD1hdHRyc1t0aGlzLmlkQXR0cmlidXRlXTtmb3IoYXR0ciBpbiBhdHRycyl7dmFsPWF0dHJzW2F0dHJdO2lmKCFfLmlzRXF1YWwoY3VycmVudFthdHRyXSx2YWwpKWNoYW5nZXMucHVzaChhdHRyKTtpZighXy5pc0VxdWFsKHByZXZbYXR0cl0sdmFsKSl7dGhpcy5jaGFuZ2VkW2F0dHJdPXZhbDt9ZWxzZXtkZWxldGUgdGhpcy5jaGFuZ2VkW2F0dHJdO30KdW5zZXQ/ZGVsZXRlIGN1cnJlbnRbYXR0cl06Y3VycmVudFthdHRyXT12YWw7fQppZighc2lsZW50KXtpZihjaGFuZ2VzLmxlbmd0aCl0aGlzLl9wZW5kaW5nPXRydWU7Zm9yKHZhciBpPTAsbD1jaGFuZ2VzLmxlbmd0aDtpPGw7aSsrKXt0aGlzLnRyaWdnZXIoJ2NoYW5nZTonK2NoYW5nZXNbaV0sdGhpcyxjdXJyZW50W2NoYW5nZXNbaV1dLG9wdGlvbnMpO319CmlmKGNoYW5naW5nKXJldHVybiB0aGlzO2lmKCFzaWxlbnQpe3doaWxlKHRoaXMuX3BlbmRpbmcpe3RoaXMuX3BlbmRpbmc9ZmFsc2U7dGhpcy50cmlnZ2VyKCdjaGFuZ2UnLHRoaXMsb3B0aW9ucyk7fX0KdGhpcy5fcGVuZGluZz1mYWxzZTt0aGlzLl9jaGFuZ2luZz1mYWxzZTtyZXR1cm4gdGhpczt9LHVuc2V0OmZ1bmN0aW9uKGF0dHIsb3B0aW9ucyl7cmV0dXJuIHRoaXMuc2V0KGF0dHIsdm9pZCAwLF8uZXh0ZW5kKHt9LG9wdGlvbnMse3Vuc2V0OnRydWV9KSk7fSxjbGVhcjpmdW5jdGlvbihvcHRpb25zKXt2YXIgYXR0cnM9e307Zm9yKHZhciBrZXkgaW4gdGhpcy5hdHRyaWJ1dGVzKWF0dHJzW2tleV09dm9pZCAwO3JldHVybiB0aGlzLnNldChhdHRycyxfLmV4dGVuZCh7fSxvcHRpb25zLHt1bnNldDp0cnVlfSkpO30saGFzQ2hhbmdlZDpmdW5jdGlvbihhdHRyKXtpZihhdHRyPT1udWxsKXJldHVybiFfLmlzRW1wdHkodGhpcy5jaGFuZ2VkKTtyZXR1cm4gXy5oYXModGhpcy5jaGFuZ2VkLGF0dHIpO30sY2hhbmdlZEF0dHJpYnV0ZXM6ZnVuY3Rpb24oZGlmZil7aWYoIWRpZmYpcmV0dXJuIHRoaXMuaGFzQ2hhbmdlZCgpP18uY2xvbmUodGhpcy5jaGFuZ2VkKTpmYWxzZTt2YXIgdmFsLGNoYW5nZWQ9ZmFsc2U7dmFyIG9sZD10aGlzLl9jaGFuZ2luZz90aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM6dGhpcy5hdHRyaWJ1dGVzO2Zvcih2YXIgYXR0ciBpbiBkaWZmKXtpZihfLmlzRXF1YWwob2xkW2F0dHJdLCh2YWw9ZGlmZlthdHRyXSkpKWNvbnRpbnVlOyhjaGFuZ2VkfHwoY2hhbmdlZD17fSkpW2F0dHJdPXZhbDt9CnJldHVybiBjaGFuZ2VkO30scHJldmlvdXM6ZnVuY3Rpb24oYXR0cil7aWYoYXR0cj09bnVsbHx8IXRoaXMuX3ByZXZpb3VzQXR0cmlidXRlcylyZXR1cm4gbnVsbDtyZXR1cm4gdGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzW2F0dHJdO30scHJldmlvdXNBdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7cmV0dXJuIF8uY2xvbmUodGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzKTt9LGZldGNoOmZ1bmN0aW9uKG9wdGlvbnMpe29wdGlvbnM9b3B0aW9ucz9fLmNsb25lKG9wdGlvbnMpOnt9O2lmKG9wdGlvbnMucGFyc2U9PT12b2lkIDApb3B0aW9ucy5wYXJzZT10cnVlO3ZhciBtb2RlbD10aGlzO3ZhciBzdWNjZXNzPW9wdGlvbnMuc3VjY2VzcztvcHRpb25zLnN1Y2Nlc3M9ZnVuY3Rpb24ocmVzcCl7aWYoIW1vZGVsLnNldChtb2RlbC5wYXJzZShyZXNwLG9wdGlvbnMpLG9wdGlvbnMpKXJldHVybiBmYWxzZTtpZihzdWNjZXNzKXN1Y2Nlc3MobW9kZWwscmVzcCxvcHRpb25zKTttb2RlbC50cmlnZ2VyKCdzeW5jJyxtb2RlbCxyZXNwLG9wdGlvbnMpO307d3JhcEVycm9yKHRoaXMsb3B0aW9ucyk7cmV0dXJuIHRoaXMuc3luYygncmVhZCcsdGhpcyxvcHRpb25zKTt9LHNhdmU6ZnVuY3Rpb24oa2V5LHZhbCxvcHRpb25zKXt2YXIgYXR0cnMsbWV0aG9kLHhocixhdHRyaWJ1dGVzPXRoaXMuYXR0cmlidXRlcztpZihrZXk9PW51bGx8fHR5cGVvZiBrZXk9PT0nb2JqZWN0Jyl7YXR0cnM9a2V5O29wdGlvbnM9dmFsO31lbHNleyhhdHRycz17fSlba2V5XT12YWw7fQpvcHRpb25zPV8uZXh0ZW5kKHt2YWxpZGF0ZTp0cnVlfSxvcHRpb25zKTtpZihhdHRycyYmIW9wdGlvbnMud2FpdCl7aWYoIXRoaXMuc2V0KGF0dHJzLG9wdGlvbnMpKXJldHVybiBmYWxzZTt9ZWxzZXtpZighdGhpcy5fdmFsaWRhdGUoYXR0cnMsb3B0aW9ucykpcmV0dXJuIGZhbHNlO30KaWYoYXR0cnMmJm9wdGlvbnMud2FpdCl7dGhpcy5hdHRyaWJ1dGVzPV8uZXh0ZW5kKHt9LGF0dHJpYnV0ZXMsYXR0cnMpO30KaWYob3B0aW9ucy5wYXJzZT09PXZvaWQgMClvcHRpb25zLnBhcnNlPXRydWU7dmFyIG1vZGVsPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihyZXNwKXttb2RlbC5hdHRyaWJ1dGVzPWF0dHJpYnV0ZXM7dmFyIHNlcnZlckF0dHJzPW1vZGVsLnBhcnNlKHJlc3Asb3B0aW9ucyk7aWYob3B0aW9ucy53YWl0KXNlcnZlckF0dHJzPV8uZXh0ZW5kKGF0dHJzfHx7fSxzZXJ2ZXJBdHRycyk7aWYoXy5pc09iamVjdChzZXJ2ZXJBdHRycykmJiFtb2RlbC5zZXQoc2VydmVyQXR0cnMsb3B0aW9ucykpe3JldHVybiBmYWxzZTt9CmlmKHN1Y2Nlc3Mpc3VjY2Vzcyhtb2RlbCxyZXNwLG9wdGlvbnMpO21vZGVsLnRyaWdnZXIoJ3N5bmMnLG1vZGVsLHJlc3Asb3B0aW9ucyk7fTt3cmFwRXJyb3IodGhpcyxvcHRpb25zKTttZXRob2Q9dGhpcy5pc05ldygpPydjcmVhdGUnOihvcHRpb25zLnBhdGNoPydwYXRjaCc6J3VwZGF0ZScpO2lmKG1ldGhvZD09PSdwYXRjaCcpb3B0aW9ucy5hdHRycz1hdHRyczt4aHI9dGhpcy5zeW5jKG1ldGhvZCx0aGlzLG9wdGlvbnMpO2lmKGF0dHJzJiZvcHRpb25zLndhaXQpdGhpcy5hdHRyaWJ1dGVzPWF0dHJpYnV0ZXM7cmV0dXJuIHhocjt9LGRlc3Ryb3k6ZnVuY3Rpb24ob3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307dmFyIG1vZGVsPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO3ZhciBkZXN0cm95PWZ1bmN0aW9uKCl7bW9kZWwudHJpZ2dlcignZGVzdHJveScsbW9kZWwsbW9kZWwuY29sbGVjdGlvbixvcHRpb25zKTt9O29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihyZXNwKXtpZihvcHRpb25zLndhaXR8fG1vZGVsLmlzTmV3KCkpZGVzdHJveSgpO2lmKHN1Y2Nlc3Mpc3VjY2Vzcyhtb2RlbCxyZXNwLG9wdGlvbnMpO2lmKCFtb2RlbC5pc05ldygpKW1vZGVsLnRyaWdnZXIoJ3N5bmMnLG1vZGVsLHJlc3Asb3B0aW9ucyk7fTtpZih0aGlzLmlzTmV3KCkpe29wdGlvbnMuc3VjY2VzcygpO3JldHVybiBmYWxzZTt9CndyYXBFcnJvcih0aGlzLG9wdGlvbnMpO3ZhciB4aHI9dGhpcy5zeW5jKCdkZWxldGUnLHRoaXMsb3B0aW9ucyk7aWYoIW9wdGlvbnMud2FpdClkZXN0cm95KCk7cmV0dXJuIHhocjt9LHVybDpmdW5jdGlvbigpe3ZhciBiYXNlPV8ucmVzdWx0KHRoaXMsJ3VybFJvb3QnKXx8Xy5yZXN1bHQodGhpcy5jb2xsZWN0aW9uLCd1cmwnKXx8dXJsRXJyb3IoKTtpZih0aGlzLmlzTmV3KCkpcmV0dXJuIGJhc2U7cmV0dXJuIGJhc2UrKGJhc2UuY2hhckF0KGJhc2UubGVuZ3RoLTEpPT09Jy8nPycnOicvJykrZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuaWQpO30scGFyc2U6ZnVuY3Rpb24ocmVzcCxvcHRpb25zKXtyZXR1cm4gcmVzcDt9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuYXR0cmlidXRlcyk7fSxpc05ldzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlkPT1udWxsO30saXNWYWxpZDpmdW5jdGlvbihvcHRpb25zKXtyZXR1cm4gdGhpcy5fdmFsaWRhdGUoe30sXy5leHRlbmQob3B0aW9uc3x8e30se3ZhbGlkYXRlOnRydWV9KSk7fSxfdmFsaWRhdGU6ZnVuY3Rpb24oYXR0cnMsb3B0aW9ucyl7aWYoIW9wdGlvbnMudmFsaWRhdGV8fCF0aGlzLnZhbGlkYXRlKXJldHVybiB0cnVlO2F0dHJzPV8uZXh0ZW5kKHt9LHRoaXMuYXR0cmlidXRlcyxhdHRycyk7dmFyIGVycm9yPXRoaXMudmFsaWRhdGlvbkVycm9yPXRoaXMudmFsaWRhdGUoYXR0cnMsb3B0aW9ucyl8fG51bGw7aWYoIWVycm9yKXJldHVybiB0cnVlO3RoaXMudHJpZ2dlcignaW52YWxpZCcsdGhpcyxlcnJvcixfLmV4dGVuZChvcHRpb25zLHt2YWxpZGF0aW9uRXJyb3I6ZXJyb3J9KSk7cmV0dXJuIGZhbHNlO319KTt2YXIgbW9kZWxNZXRob2RzPVsna2V5cycsJ3ZhbHVlcycsJ3BhaXJzJywnaW52ZXJ0JywncGljaycsJ29taXQnXTtfLmVhY2gobW9kZWxNZXRob2RzLGZ1bmN0aW9uKG1ldGhvZCl7TW9kZWwucHJvdG90eXBlW21ldGhvZF09ZnVuY3Rpb24oKXt2YXIgYXJncz1zbGljZS5jYWxsKGFyZ3VtZW50cyk7YXJncy51bnNoaWZ0KHRoaXMuYXR0cmlidXRlcyk7cmV0dXJuIF9bbWV0aG9kXS5hcHBseShfLGFyZ3MpO307fSk7dmFyIENvbGxlY3Rpb249QmFja2JvbmUuQ29sbGVjdGlvbj1mdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7b3B0aW9uc3x8KG9wdGlvbnM9e30pO2lmKG9wdGlvbnMubW9kZWwpdGhpcy5tb2RlbD1vcHRpb25zLm1vZGVsO2lmKG9wdGlvbnMuY29tcGFyYXRvciE9PXZvaWQgMCl0aGlzLmNvbXBhcmF0b3I9b3B0aW9ucy5jb21wYXJhdG9yO3RoaXMuX3Jlc2V0KCk7dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihtb2RlbHMpdGhpcy5yZXNldChtb2RlbHMsXy5leHRlbmQoe3NpbGVudDp0cnVlfSxvcHRpb25zKSk7fTt2YXIgc2V0T3B0aW9ucz17YWRkOnRydWUscmVtb3ZlOnRydWUsbWVyZ2U6dHJ1ZX07dmFyIGFkZE9wdGlvbnM9e2FkZDp0cnVlLHJlbW92ZTpmYWxzZX07Xy5leHRlbmQoQ29sbGVjdGlvbi5wcm90b3R5cGUsRXZlbnRzLHttb2RlbDpNb2RlbCxpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSx0b0pTT046ZnVuY3Rpb24ob3B0aW9ucyl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKG1vZGVsKXtyZXR1cm4gbW9kZWwudG9KU09OKG9wdGlvbnMpO30pO30sc3luYzpmdW5jdGlvbigpe3JldHVybiBCYWNrYm9uZS5zeW5jLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGFkZDpmdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7cmV0dXJuIHRoaXMuc2V0KG1vZGVscyxfLmV4dGVuZCh7bWVyZ2U6ZmFsc2V9LG9wdGlvbnMsYWRkT3B0aW9ucykpO30scmVtb3ZlOmZ1bmN0aW9uKG1vZGVscyxvcHRpb25zKXt2YXIgc2luZ3VsYXI9IV8uaXNBcnJheShtb2RlbHMpO21vZGVscz1zaW5ndWxhcj9bbW9kZWxzXTpfLmNsb25lKG1vZGVscyk7b3B0aW9uc3x8KG9wdGlvbnM9e30pO3ZhciBpLGwsaW5kZXgsbW9kZWw7Zm9yKGk9MCxsPW1vZGVscy5sZW5ndGg7aTxsO2krKyl7bW9kZWw9bW9kZWxzW2ldPXRoaXMuZ2V0KG1vZGVsc1tpXSk7aWYoIW1vZGVsKWNvbnRpbnVlO2RlbGV0ZSB0aGlzLl9ieUlkW21vZGVsLmlkXTtkZWxldGUgdGhpcy5fYnlJZFttb2RlbC5jaWRdO2luZGV4PXRoaXMuaW5kZXhPZihtb2RlbCk7dGhpcy5tb2RlbHMuc3BsaWNlKGluZGV4LDEpO3RoaXMubGVuZ3RoLS07aWYoIW9wdGlvbnMuc2lsZW50KXtvcHRpb25zLmluZGV4PWluZGV4O21vZGVsLnRyaWdnZXIoJ3JlbW92ZScsbW9kZWwsdGhpcyxvcHRpb25zKTt9CnRoaXMuX3JlbW92ZVJlZmVyZW5jZShtb2RlbCk7fQpyZXR1cm4gc2luZ3VsYXI/bW9kZWxzWzBdOm1vZGVsczt9LHNldDpmdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7b3B0aW9ucz1fLmRlZmF1bHRzKHt9LG9wdGlvbnMsc2V0T3B0aW9ucyk7aWYob3B0aW9ucy5wYXJzZSltb2RlbHM9dGhpcy5wYXJzZShtb2RlbHMsb3B0aW9ucyk7dmFyIHNpbmd1bGFyPSFfLmlzQXJyYXkobW9kZWxzKTttb2RlbHM9c2luZ3VsYXI/KG1vZGVscz9bbW9kZWxzXTpbXSk6Xy5jbG9uZShtb2RlbHMpO3ZhciBpLGwsaWQsbW9kZWwsYXR0cnMsZXhpc3Rpbmcsc29ydDt2YXIgYXQ9b3B0aW9ucy5hdDt2YXIgdGFyZ2V0TW9kZWw9dGhpcy5tb2RlbDt2YXIgc29ydGFibGU9dGhpcy5jb21wYXJhdG9yJiYoYXQ9PW51bGwpJiZvcHRpb25zLnNvcnQhPT1mYWxzZTt2YXIgc29ydEF0dHI9Xy5pc1N0cmluZyh0aGlzLmNvbXBhcmF0b3IpP3RoaXMuY29tcGFyYXRvcjpudWxsO3ZhciB0b0FkZD1bXSx0b1JlbW92ZT1bXSxtb2RlbE1hcD17fTt2YXIgYWRkPW9wdGlvbnMuYWRkLG1lcmdlPW9wdGlvbnMubWVyZ2UscmVtb3ZlPW9wdGlvbnMucmVtb3ZlO3ZhciBvcmRlcj0hc29ydGFibGUmJmFkZCYmcmVtb3ZlP1tdOmZhbHNlO2ZvcihpPTAsbD1tb2RlbHMubGVuZ3RoO2k8bDtpKyspe2F0dHJzPW1vZGVsc1tpXTtpZihhdHRycyBpbnN0YW5jZW9mIE1vZGVsKXtpZD1tb2RlbD1hdHRyczt9ZWxzZXtpZD1hdHRyc1t0YXJnZXRNb2RlbC5wcm90b3R5cGUuaWRBdHRyaWJ1dGVdO30KaWYoZXhpc3Rpbmc9dGhpcy5nZXQoaWQpKXtpZihyZW1vdmUpbW9kZWxNYXBbZXhpc3RpbmcuY2lkXT10cnVlO2lmKG1lcmdlKXthdHRycz1hdHRycz09PW1vZGVsP21vZGVsLmF0dHJpYnV0ZXM6YXR0cnM7aWYob3B0aW9ucy5wYXJzZSlhdHRycz1leGlzdGluZy5wYXJzZShhdHRycyxvcHRpb25zKTtleGlzdGluZy5zZXQoYXR0cnMsb3B0aW9ucyk7aWYoc29ydGFibGUmJiFzb3J0JiZleGlzdGluZy5oYXNDaGFuZ2VkKHNvcnRBdHRyKSlzb3J0PXRydWU7fQptb2RlbHNbaV09ZXhpc3Rpbmc7fWVsc2UgaWYoYWRkKXttb2RlbD1tb2RlbHNbaV09dGhpcy5fcHJlcGFyZU1vZGVsKGF0dHJzLG9wdGlvbnMpO2lmKCFtb2RlbCljb250aW51ZTt0b0FkZC5wdXNoKG1vZGVsKTttb2RlbC5vbignYWxsJyx0aGlzLl9vbk1vZGVsRXZlbnQsdGhpcyk7dGhpcy5fYnlJZFttb2RlbC5jaWRdPW1vZGVsO2lmKG1vZGVsLmlkIT1udWxsKXRoaXMuX2J5SWRbbW9kZWwuaWRdPW1vZGVsO30KaWYob3JkZXIpb3JkZXIucHVzaChleGlzdGluZ3x8bW9kZWwpO30KaWYocmVtb3ZlKXtmb3IoaT0wLGw9dGhpcy5sZW5ndGg7aTxsOysraSl7aWYoIW1vZGVsTWFwWyhtb2RlbD10aGlzLm1vZGVsc1tpXSkuY2lkXSl0b1JlbW92ZS5wdXNoKG1vZGVsKTt9CmlmKHRvUmVtb3ZlLmxlbmd0aCl0aGlzLnJlbW92ZSh0b1JlbW92ZSxvcHRpb25zKTt9CmlmKHRvQWRkLmxlbmd0aHx8KG9yZGVyJiZvcmRlci5sZW5ndGgpKXtpZihzb3J0YWJsZSlzb3J0PXRydWU7dGhpcy5sZW5ndGgrPXRvQWRkLmxlbmd0aDtpZihhdCE9bnVsbCl7Zm9yKGk9MCxsPXRvQWRkLmxlbmd0aDtpPGw7aSsrKXt0aGlzLm1vZGVscy5zcGxpY2UoYXQraSwwLHRvQWRkW2ldKTt9fWVsc2V7aWYob3JkZXIpdGhpcy5tb2RlbHMubGVuZ3RoPTA7dmFyIG9yZGVyZWRNb2RlbHM9b3JkZXJ8fHRvQWRkO2ZvcihpPTAsbD1vcmRlcmVkTW9kZWxzLmxlbmd0aDtpPGw7aSsrKXt0aGlzLm1vZGVscy5wdXNoKG9yZGVyZWRNb2RlbHNbaV0pO319fQppZihzb3J0KXRoaXMuc29ydCh7c2lsZW50OnRydWV9KTtpZighb3B0aW9ucy5zaWxlbnQpe2ZvcihpPTAsbD10b0FkZC5sZW5ndGg7aTxsO2krKyl7KG1vZGVsPXRvQWRkW2ldKS50cmlnZ2VyKCdhZGQnLG1vZGVsLHRoaXMsb3B0aW9ucyk7fQppZihzb3J0fHwob3JkZXImJm9yZGVyLmxlbmd0aCkpdGhpcy50cmlnZ2VyKCdzb3J0Jyx0aGlzLG9wdGlvbnMpO30KcmV0dXJuIHNpbmd1bGFyP21vZGVsc1swXTptb2RlbHM7fSxyZXNldDpmdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7b3B0aW9uc3x8KG9wdGlvbnM9e30pO2Zvcih2YXIgaT0wLGw9dGhpcy5tb2RlbHMubGVuZ3RoO2k8bDtpKyspe3RoaXMuX3JlbW92ZVJlZmVyZW5jZSh0aGlzLm1vZGVsc1tpXSk7fQpvcHRpb25zLnByZXZpb3VzTW9kZWxzPXRoaXMubW9kZWxzO3RoaXMuX3Jlc2V0KCk7bW9kZWxzPXRoaXMuYWRkKG1vZGVscyxfLmV4dGVuZCh7c2lsZW50OnRydWV9LG9wdGlvbnMpKTtpZighb3B0aW9ucy5zaWxlbnQpdGhpcy50cmlnZ2VyKCdyZXNldCcsdGhpcyxvcHRpb25zKTtyZXR1cm4gbW9kZWxzO30scHVzaDpmdW5jdGlvbihtb2RlbCxvcHRpb25zKXtyZXR1cm4gdGhpcy5hZGQobW9kZWwsXy5leHRlbmQoe2F0OnRoaXMubGVuZ3RofSxvcHRpb25zKSk7fSxwb3A6ZnVuY3Rpb24ob3B0aW9ucyl7dmFyIG1vZGVsPXRoaXMuYXQodGhpcy5sZW5ndGgtMSk7dGhpcy5yZW1vdmUobW9kZWwsb3B0aW9ucyk7cmV0dXJuIG1vZGVsO30sdW5zaGlmdDpmdW5jdGlvbihtb2RlbCxvcHRpb25zKXtyZXR1cm4gdGhpcy5hZGQobW9kZWwsXy5leHRlbmQoe2F0OjB9LG9wdGlvbnMpKTt9LHNoaWZ0OmZ1bmN0aW9uKG9wdGlvbnMpe3ZhciBtb2RlbD10aGlzLmF0KDApO3RoaXMucmVtb3ZlKG1vZGVsLG9wdGlvbnMpO3JldHVybiBtb2RlbDt9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHNsaWNlLmFwcGx5KHRoaXMubW9kZWxzLGFyZ3VtZW50cyk7fSxnZXQ6ZnVuY3Rpb24ob2JqKXtpZihvYmo9PW51bGwpcmV0dXJuIHZvaWQgMDtyZXR1cm4gdGhpcy5fYnlJZFtvYmouaWRdfHx0aGlzLl9ieUlkW29iai5jaWRdfHx0aGlzLl9ieUlkW29ial07fSxhdDpmdW5jdGlvbihpbmRleCl7cmV0dXJuIHRoaXMubW9kZWxzW2luZGV4XTt9LHdoZXJlOmZ1bmN0aW9uKGF0dHJzLGZpcnN0KXtpZihfLmlzRW1wdHkoYXR0cnMpKXJldHVybiBmaXJzdD92b2lkIDA6W107cmV0dXJuIHRoaXNbZmlyc3Q/J2ZpbmQnOidmaWx0ZXInXShmdW5jdGlvbihtb2RlbCl7Zm9yKHZhciBrZXkgaW4gYXR0cnMpe2lmKGF0dHJzW2tleV0hPT1tb2RlbC5nZXQoa2V5KSlyZXR1cm4gZmFsc2U7fQpyZXR1cm4gdHJ1ZTt9KTt9LGZpbmRXaGVyZTpmdW5jdGlvbihhdHRycyl7cmV0dXJuIHRoaXMud2hlcmUoYXR0cnMsdHJ1ZSk7fSxzb3J0OmZ1bmN0aW9uKG9wdGlvbnMpe2lmKCF0aGlzLmNvbXBhcmF0b3IpdGhyb3cgbmV3IEVycm9yKCdDYW5ub3Qgc29ydCBhIHNldCB3aXRob3V0IGEgY29tcGFyYXRvcicpO29wdGlvbnN8fChvcHRpb25zPXt9KTtpZihfLmlzU3RyaW5nKHRoaXMuY29tcGFyYXRvcil8fHRoaXMuY29tcGFyYXRvci5sZW5ndGg9PT0xKXt0aGlzLm1vZGVscz10aGlzLnNvcnRCeSh0aGlzLmNvbXBhcmF0b3IsdGhpcyk7fWVsc2V7dGhpcy5tb2RlbHMuc29ydChfLmJpbmQodGhpcy5jb21wYXJhdG9yLHRoaXMpKTt9CmlmKCFvcHRpb25zLnNpbGVudCl0aGlzLnRyaWdnZXIoJ3NvcnQnLHRoaXMsb3B0aW9ucyk7cmV0dXJuIHRoaXM7fSxwbHVjazpmdW5jdGlvbihhdHRyKXtyZXR1cm4gXy5pbnZva2UodGhpcy5tb2RlbHMsJ2dldCcsYXR0cik7fSxmZXRjaDpmdW5jdGlvbihvcHRpb25zKXtvcHRpb25zPW9wdGlvbnM/Xy5jbG9uZShvcHRpb25zKTp7fTtpZihvcHRpb25zLnBhcnNlPT09dm9pZCAwKW9wdGlvbnMucGFyc2U9dHJ1ZTt2YXIgc3VjY2Vzcz1vcHRpb25zLnN1Y2Nlc3M7dmFyIGNvbGxlY3Rpb249dGhpcztvcHRpb25zLnN1Y2Nlc3M9ZnVuY3Rpb24ocmVzcCl7dmFyIG1ldGhvZD1vcHRpb25zLnJlc2V0PydyZXNldCc6J3NldCc7Y29sbGVjdGlvblttZXRob2RdKHJlc3Asb3B0aW9ucyk7aWYoc3VjY2VzcylzdWNjZXNzKGNvbGxlY3Rpb24scmVzcCxvcHRpb25zKTtjb2xsZWN0aW9uLnRyaWdnZXIoJ3N5bmMnLGNvbGxlY3Rpb24scmVzcCxvcHRpb25zKTt9O3dyYXBFcnJvcih0aGlzLG9wdGlvbnMpO3JldHVybiB0aGlzLnN5bmMoJ3JlYWQnLHRoaXMsb3B0aW9ucyk7fSxjcmVhdGU6ZnVuY3Rpb24obW9kZWwsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307aWYoIShtb2RlbD10aGlzLl9wcmVwYXJlTW9kZWwobW9kZWwsb3B0aW9ucykpKXJldHVybiBmYWxzZTtpZighb3B0aW9ucy53YWl0KXRoaXMuYWRkKG1vZGVsLG9wdGlvbnMpO3ZhciBjb2xsZWN0aW9uPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihtb2RlbCxyZXNwLG9wdGlvbnMpe2lmKG9wdGlvbnMud2FpdCljb2xsZWN0aW9uLmFkZChtb2RlbCxvcHRpb25zKTtpZihzdWNjZXNzKXN1Y2Nlc3MobW9kZWwscmVzcCxvcHRpb25zKTt9O21vZGVsLnNhdmUobnVsbCxvcHRpb25zKTtyZXR1cm4gbW9kZWw7fSxwYXJzZTpmdW5jdGlvbihyZXNwLG9wdGlvbnMpe3JldHVybiByZXNwO30sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5tb2RlbHMpO30sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5sZW5ndGg9MDt0aGlzLm1vZGVscz1bXTt0aGlzLl9ieUlkPXt9O30sX3ByZXBhcmVNb2RlbDpmdW5jdGlvbihhdHRycyxvcHRpb25zKXtpZihhdHRycyBpbnN0YW5jZW9mIE1vZGVsKXtpZighYXR0cnMuY29sbGVjdGlvbilhdHRycy5jb2xsZWN0aW9uPXRoaXM7cmV0dXJuIGF0dHJzO30Kb3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307b3B0aW9ucy5jb2xsZWN0aW9uPXRoaXM7dmFyIG1vZGVsPW5ldyB0aGlzLm1vZGVsKGF0dHJzLG9wdGlvbnMpO2lmKCFtb2RlbC52YWxpZGF0aW9uRXJyb3IpcmV0dXJuIG1vZGVsO3RoaXMudHJpZ2dlcignaW52YWxpZCcsdGhpcyxtb2RlbC52YWxpZGF0aW9uRXJyb3Isb3B0aW9ucyk7cmV0dXJuIGZhbHNlO30sX3JlbW92ZVJlZmVyZW5jZTpmdW5jdGlvbihtb2RlbCl7aWYodGhpcz09PW1vZGVsLmNvbGxlY3Rpb24pZGVsZXRlIG1vZGVsLmNvbGxlY3Rpb247bW9kZWwub2ZmKCdhbGwnLHRoaXMuX29uTW9kZWxFdmVudCx0aGlzKTt9LF9vbk1vZGVsRXZlbnQ6ZnVuY3Rpb24oZXZlbnQsbW9kZWwsY29sbGVjdGlvbixvcHRpb25zKXtpZigoZXZlbnQ9PT0nYWRkJ3x8ZXZlbnQ9PT0ncmVtb3ZlJykmJmNvbGxlY3Rpb24hPT10aGlzKXJldHVybjtpZihldmVudD09PSdkZXN0cm95Jyl0aGlzLnJlbW92ZShtb2RlbCxvcHRpb25zKTtpZihtb2RlbCYmZXZlbnQ9PT0nY2hhbmdlOicrbW9kZWwuaWRBdHRyaWJ1dGUpe2RlbGV0ZSB0aGlzLl9ieUlkW21vZGVsLnByZXZpb3VzKG1vZGVsLmlkQXR0cmlidXRlKV07aWYobW9kZWwuaWQhPW51bGwpdGhpcy5fYnlJZFttb2RlbC5pZF09bW9kZWw7fQp0aGlzLnRyaWdnZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319KTt2YXIgbWV0aG9kcz1bJ2ZvckVhY2gnLCdlYWNoJywnbWFwJywnY29sbGVjdCcsJ3JlZHVjZScsJ2ZvbGRsJywnaW5qZWN0JywncmVkdWNlUmlnaHQnLCdmb2xkcicsJ2ZpbmQnLCdkZXRlY3QnLCdmaWx0ZXInLCdzZWxlY3QnLCdyZWplY3QnLCdldmVyeScsJ2FsbCcsJ3NvbWUnLCdhbnknLCdpbmNsdWRlJywnY29udGFpbnMnLCdpbnZva2UnLCdtYXgnLCdtaW4nLCd0b0FycmF5Jywnc2l6ZScsJ2ZpcnN0JywnaGVhZCcsJ3Rha2UnLCdpbml0aWFsJywncmVzdCcsJ3RhaWwnLCdkcm9wJywnbGFzdCcsJ3dpdGhvdXQnLCdkaWZmZXJlbmNlJywnaW5kZXhPZicsJ3NodWZmbGUnLCdsYXN0SW5kZXhPZicsJ2lzRW1wdHknLCdjaGFpbiddO18uZWFjaChtZXRob2RzLGZ1bmN0aW9uKG1ldGhvZCl7Q29sbGVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXT1mdW5jdGlvbigpe3ZhciBhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzKTthcmdzLnVuc2hpZnQodGhpcy5tb2RlbHMpO3JldHVybiBfW21ldGhvZF0uYXBwbHkoXyxhcmdzKTt9O30pO3ZhciBhdHRyaWJ1dGVNZXRob2RzPVsnZ3JvdXBCeScsJ2NvdW50QnknLCdzb3J0QnknXTtfLmVhY2goYXR0cmlidXRlTWV0aG9kcyxmdW5jdGlvbihtZXRob2Qpe0NvbGxlY3Rpb24ucHJvdG90eXBlW21ldGhvZF09ZnVuY3Rpb24odmFsdWUsY29udGV4dCl7dmFyIGl0ZXJhdG9yPV8uaXNGdW5jdGlvbih2YWx1ZSk/dmFsdWU6ZnVuY3Rpb24obW9kZWwpe3JldHVybiBtb2RlbC5nZXQodmFsdWUpO307cmV0dXJuIF9bbWV0aG9kXSh0aGlzLm1vZGVscyxpdGVyYXRvcixjb250ZXh0KTt9O30pO3ZhciBWaWV3PUJhY2tib25lLlZpZXc9ZnVuY3Rpb24ob3B0aW9ucyl7dGhpcy5jaWQ9Xy51bmlxdWVJZCgndmlldycpO29wdGlvbnN8fChvcHRpb25zPXt9KTtfLmV4dGVuZCh0aGlzLF8ucGljayhvcHRpb25zLHZpZXdPcHRpb25zKSk7dGhpcy5fZW5zdXJlRWxlbWVudCgpO3RoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5kZWxlZ2F0ZUV2ZW50cygpO307dmFyIGRlbGVnYXRlRXZlbnRTcGxpdHRlcj0vXihcUyspXHMqKC4qKSQvO3ZhciB2aWV3T3B0aW9ucz1bJ21vZGVsJywnY29sbGVjdGlvbicsJ2VsJywnaWQnLCdhdHRyaWJ1dGVzJywnY2xhc3NOYW1lJywndGFnTmFtZScsJ2V2ZW50cyddO18uZXh0ZW5kKFZpZXcucHJvdG90eXBlLEV2ZW50cyx7dGFnTmFtZTonZGl2JywkOmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4gdGhpcy4kZWwuZmluZChzZWxlY3Rvcik7fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpczt9LHJlbW92ZTpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZSgpO3RoaXMuc3RvcExpc3RlbmluZygpO3JldHVybiB0aGlzO30sc2V0RWxlbWVudDpmdW5jdGlvbihlbGVtZW50LGRlbGVnYXRlKXtpZih0aGlzLiRlbCl0aGlzLnVuZGVsZWdhdGVFdmVudHMoKTt0aGlzLiRlbD1lbGVtZW50IGluc3RhbmNlb2YgQmFja2JvbmUuJD9lbGVtZW50OkJhY2tib25lLiQoZWxlbWVudCk7dGhpcy5lbD10aGlzLiRlbFswXTtpZihkZWxlZ2F0ZSE9PWZhbHNlKXRoaXMuZGVsZWdhdGVFdmVudHMoKTtyZXR1cm4gdGhpczt9LGRlbGVnYXRlRXZlbnRzOmZ1bmN0aW9uKGV2ZW50cyl7aWYoIShldmVudHN8fChldmVudHM9Xy5yZXN1bHQodGhpcywnZXZlbnRzJykpKSlyZXR1cm4gdGhpczt0aGlzLnVuZGVsZWdhdGVFdmVudHMoKTtmb3IodmFyIGtleSBpbiBldmVudHMpe3ZhciBtZXRob2Q9ZXZlbnRzW2tleV07aWYoIV8uaXNGdW5jdGlvbihtZXRob2QpKW1ldGhvZD10aGlzW2V2ZW50c1trZXldXTtpZighbWV0aG9kKWNvbnRpbnVlO3ZhciBtYXRjaD1rZXkubWF0Y2goZGVsZWdhdGVFdmVudFNwbGl0dGVyKTt2YXIgZXZlbnROYW1lPW1hdGNoWzFdLHNlbGVjdG9yPW1hdGNoWzJdO21ldGhvZD1fLmJpbmQobWV0aG9kLHRoaXMpO2V2ZW50TmFtZSs9Jy5kZWxlZ2F0ZUV2ZW50cycrdGhpcy5jaWQ7aWYoc2VsZWN0b3I9PT0nJyl7dGhpcy4kZWwub24oZXZlbnROYW1lLG1ldGhvZCk7fWVsc2V7dGhpcy4kZWwub24oZXZlbnROYW1lLHNlbGVjdG9yLG1ldGhvZCk7fX0KcmV0dXJuIHRoaXM7fSx1bmRlbGVnYXRlRXZlbnRzOmZ1bmN0aW9uKCl7dGhpcy4kZWwub2ZmKCcuZGVsZWdhdGVFdmVudHMnK3RoaXMuY2lkKTtyZXR1cm4gdGhpczt9LF9lbnN1cmVFbGVtZW50OmZ1bmN0aW9uKCl7aWYoIXRoaXMuZWwpe3ZhciBhdHRycz1fLmV4dGVuZCh7fSxfLnJlc3VsdCh0aGlzLCdhdHRyaWJ1dGVzJykpO2lmKHRoaXMuaWQpYXR0cnMuaWQ9Xy5yZXN1bHQodGhpcywnaWQnKTtpZih0aGlzLmNsYXNzTmFtZSlhdHRyc1snY2xhc3MnXT1fLnJlc3VsdCh0aGlzLCdjbGFzc05hbWUnKTt2YXIgJGVsPUJhY2tib25lLiQoJzwnK18ucmVzdWx0KHRoaXMsJ3RhZ05hbWUnKSsnPicpLmF0dHIoYXR0cnMpO3RoaXMuc2V0RWxlbWVudCgkZWwsZmFsc2UpO31lbHNle3RoaXMuc2V0RWxlbWVudChfLnJlc3VsdCh0aGlzLCdlbCcpLGZhbHNlKTt9fX0pO0JhY2tib25lLnN5bmM9ZnVuY3Rpb24obWV0aG9kLG1vZGVsLG9wdGlvbnMpe3ZhciB0eXBlPW1ldGhvZE1hcFttZXRob2RdO18uZGVmYXVsdHMob3B0aW9uc3x8KG9wdGlvbnM9e30pLHtlbXVsYXRlSFRUUDpCYWNrYm9uZS5lbXVsYXRlSFRUUCxlbXVsYXRlSlNPTjpCYWNrYm9uZS5lbXVsYXRlSlNPTn0pO3ZhciBwYXJhbXM9e3R5cGU6dHlwZSxkYXRhVHlwZTonanNvbid9O2lmKCFvcHRpb25zLnVybCl7cGFyYW1zLnVybD1fLnJlc3VsdChtb2RlbCwndXJsJyl8fHVybEVycm9yKCk7fQppZihvcHRpb25zLmRhdGE9PW51bGwmJm1vZGVsJiYobWV0aG9kPT09J2NyZWF0ZSd8fG1ldGhvZD09PSd1cGRhdGUnfHxtZXRob2Q9PT0ncGF0Y2gnKSl7cGFyYW1zLmNvbnRlbnRUeXBlPSdhcHBsaWNhdGlvbi9qc29uJztwYXJhbXMuZGF0YT1KU09OLnN0cmluZ2lmeShvcHRpb25zLmF0dHJzfHxtb2RlbC50b0pTT04ob3B0aW9ucykpO30KaWYob3B0aW9ucy5lbXVsYXRlSlNPTil7cGFyYW1zLmNvbnRlbnRUeXBlPSdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnO3BhcmFtcy5kYXRhPXBhcmFtcy5kYXRhP3ttb2RlbDpwYXJhbXMuZGF0YX06e307fQppZihvcHRpb25zLmVtdWxhdGVIVFRQJiYodHlwZT09PSdQVVQnfHx0eXBlPT09J0RFTEVURSd8fHR5cGU9PT0nUEFUQ0gnKSl7cGFyYW1zLnR5cGU9J1BPU1QnO2lmKG9wdGlvbnMuZW11bGF0ZUpTT04pcGFyYW1zLmRhdGEuX21ldGhvZD10eXBlO3ZhciBiZWZvcmVTZW5kPW9wdGlvbnMuYmVmb3JlU2VuZDtvcHRpb25zLmJlZm9yZVNlbmQ9ZnVuY3Rpb24oeGhyKXt4aHIuc2V0UmVxdWVzdEhlYWRlcignWC1IVFRQLU1ldGhvZC1PdmVycmlkZScsdHlwZSk7aWYoYmVmb3JlU2VuZClyZXR1cm4gYmVmb3JlU2VuZC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTt9CmlmKHBhcmFtcy50eXBlIT09J0dFVCcmJiFvcHRpb25zLmVtdWxhdGVKU09OKXtwYXJhbXMucHJvY2Vzc0RhdGE9ZmFsc2U7fQppZihwYXJhbXMudHlwZT09PSdQQVRDSCcmJm5vWGhyUGF0Y2gpe3BhcmFtcy54aHI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7fTt9CnZhciB4aHI9b3B0aW9ucy54aHI9QmFja2JvbmUuYWpheChfLmV4dGVuZChwYXJhbXMsb3B0aW9ucykpO21vZGVsLnRyaWdnZXIoJ3JlcXVlc3QnLG1vZGVsLHhocixvcHRpb25zKTtyZXR1cm4geGhyO307dmFyIG5vWGhyUGF0Y2g9dHlwZW9mIHdpbmRvdyE9PSd1bmRlZmluZWQnJiYhIXdpbmRvdy5BY3RpdmVYT2JqZWN0JiYhKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCYmKG5ldyBYTUxIdHRwUmVxdWVzdCkuZGlzcGF0Y2hFdmVudCk7dmFyIG1ldGhvZE1hcD17J2NyZWF0ZSc6J1BPU1QnLCd1cGRhdGUnOidQVVQnLCdwYXRjaCc6J1BBVENIJywnZGVsZXRlJzonREVMRVRFJywncmVhZCc6J0dFVCd9O0JhY2tib25lLmFqYXg9ZnVuY3Rpb24oKXtyZXR1cm4gQmFja2JvbmUuJC5hamF4LmFwcGx5KEJhY2tib25lLiQsYXJndW1lbnRzKTt9O3ZhciBSb3V0ZXI9QmFja2JvbmUuUm91dGVyPWZ1bmN0aW9uKG9wdGlvbnMpe29wdGlvbnN8fChvcHRpb25zPXt9KTtpZihvcHRpb25zLnJvdXRlcyl0aGlzLnJvdXRlcz1vcHRpb25zLnJvdXRlczt0aGlzLl9iaW5kUm91dGVzKCk7dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O3ZhciBvcHRpb25hbFBhcmFtPS9cKCguKj8pXCkvZzt2YXIgbmFtZWRQYXJhbT0vKFwoXD8pPzpcdysvZzt2YXIgc3BsYXRQYXJhbT0vXCpcdysvZzt2YXIgZXNjYXBlUmVnRXhwPS9bXC17fVxbXF0rPy4sXFxcXiR8I1xzXS9nO18uZXh0ZW5kKFJvdXRlci5wcm90b3R5cGUsRXZlbnRzLHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSxyb3V0ZTpmdW5jdGlvbihyb3V0ZSxuYW1lLGNhbGxiYWNrKXtpZighXy5pc1JlZ0V4cChyb3V0ZSkpcm91dGU9dGhpcy5fcm91dGVUb1JlZ0V4cChyb3V0ZSk7aWYoXy5pc0Z1bmN0aW9uKG5hbWUpKXtjYWxsYmFjaz1uYW1lO25hbWU9Jyc7fQppZighY2FsbGJhY2spY2FsbGJhY2s9dGhpc1tuYW1lXTt2YXIgcm91dGVyPXRoaXM7QmFja2JvbmUuaGlzdG9yeS5yb3V0ZShyb3V0ZSxmdW5jdGlvbihmcmFnbWVudCl7dmFyIGFyZ3M9cm91dGVyLl9leHRyYWN0UGFyYW1ldGVycyhyb3V0ZSxmcmFnbWVudCk7Y2FsbGJhY2smJmNhbGxiYWNrLmFwcGx5KHJvdXRlcixhcmdzKTtyb3V0ZXIudHJpZ2dlci5hcHBseShyb3V0ZXIsWydyb3V0ZTonK25hbWVdLmNvbmNhdChhcmdzKSk7cm91dGVyLnRyaWdnZXIoJ3JvdXRlJyxuYW1lLGFyZ3MpO0JhY2tib25lLmhpc3RvcnkudHJpZ2dlcigncm91dGUnLHJvdXRlcixuYW1lLGFyZ3MpO30pO3JldHVybiB0aGlzO30sbmF2aWdhdGU6ZnVuY3Rpb24oZnJhZ21lbnQsb3B0aW9ucyl7QmFja2JvbmUuaGlzdG9yeS5uYXZpZ2F0ZShmcmFnbWVudCxvcHRpb25zKTtyZXR1cm4gdGhpczt9LF9iaW5kUm91dGVzOmZ1bmN0aW9uKCl7aWYoIXRoaXMucm91dGVzKXJldHVybjt0aGlzLnJvdXRlcz1fLnJlc3VsdCh0aGlzLCdyb3V0ZXMnKTt2YXIgcm91dGUscm91dGVzPV8ua2V5cyh0aGlzLnJvdXRlcyk7d2hpbGUoKHJvdXRlPXJvdXRlcy5wb3AoKSkhPW51bGwpe3RoaXMucm91dGUocm91dGUsdGhpcy5yb3V0ZXNbcm91dGVdKTt9fSxfcm91dGVUb1JlZ0V4cDpmdW5jdGlvbihyb3V0ZSl7cm91dGU9cm91dGUucmVwbGFjZShlc2NhcGVSZWdFeHAsJ1xcJCYnKS5yZXBsYWNlKG9wdGlvbmFsUGFyYW0sJyg/OiQxKT8nKS5yZXBsYWNlKG5hbWVkUGFyYW0sZnVuY3Rpb24obWF0Y2gsb3B0aW9uYWwpe3JldHVybiBvcHRpb25hbD9tYXRjaDonKFteXC9dKyknO30pLnJlcGxhY2Uoc3BsYXRQYXJhbSwnKC4qPyknKTtyZXR1cm4gbmV3IFJlZ0V4cCgnXicrcm91dGUrJyQnKTt9LF9leHRyYWN0UGFyYW1ldGVyczpmdW5jdGlvbihyb3V0ZSxmcmFnbWVudCl7dmFyIHBhcmFtcz1yb3V0ZS5leGVjKGZyYWdtZW50KS5zbGljZSgxKTtyZXR1cm4gXy5tYXAocGFyYW1zLGZ1bmN0aW9uKHBhcmFtKXtyZXR1cm4gcGFyYW0/ZGVjb2RlVVJJQ29tcG9uZW50KHBhcmFtKTpudWxsO30pO319KTt2YXIgSGlzdG9yeT1CYWNrYm9uZS5IaXN0b3J5PWZ1bmN0aW9uKCl7dGhpcy5oYW5kbGVycz1bXTtfLmJpbmRBbGwodGhpcywnY2hlY2tVcmwnKTtpZih0eXBlb2Ygd2luZG93IT09J3VuZGVmaW5lZCcpe3RoaXMubG9jYXRpb249d2luZG93LmxvY2F0aW9uO3RoaXMuaGlzdG9yeT13aW5kb3cuaGlzdG9yeTt9fTt2YXIgcm91dGVTdHJpcHBlcj0vXlsjXC9dfFxzKyQvZzt2YXIgcm9vdFN0cmlwcGVyPS9eXC8rfFwvKyQvZzt2YXIgaXNFeHBsb3Jlcj0vbXNpZSBbXHcuXSsvO3ZhciB0cmFpbGluZ1NsYXNoPS9cLyQvO3ZhciBwYXRoU3RyaXBwZXI9L1s/I10uKiQvO0hpc3Rvcnkuc3RhcnRlZD1mYWxzZTtfLmV4dGVuZChIaXN0b3J5LnByb3RvdHlwZSxFdmVudHMse2ludGVydmFsOjUwLGdldEhhc2g6ZnVuY3Rpb24od2luZG93KXt2YXIgbWF0Y2g9KHdpbmRvd3x8dGhpcykubG9jYXRpb24uaHJlZi5tYXRjaCgvIyguKikkLyk7cmV0dXJuIG1hdGNoP21hdGNoWzFdOicnO30sZ2V0RnJhZ21lbnQ6ZnVuY3Rpb24oZnJhZ21lbnQsZm9yY2VQdXNoU3RhdGUpe2lmKGZyYWdtZW50PT1udWxsKXtpZih0aGlzLl9oYXNQdXNoU3RhdGV8fCF0aGlzLl93YW50c0hhc2hDaGFuZ2V8fGZvcmNlUHVzaFN0YXRlKXtmcmFnbWVudD10aGlzLmxvY2F0aW9uLnBhdGhuYW1lO3ZhciByb290PXRoaXMucm9vdC5yZXBsYWNlKHRyYWlsaW5nU2xhc2gsJycpO2lmKCFmcmFnbWVudC5pbmRleE9mKHJvb3QpKWZyYWdtZW50PWZyYWdtZW50LnNsaWNlKHJvb3QubGVuZ3RoKTt9ZWxzZXtmcmFnbWVudD10aGlzLmdldEhhc2goKTt9fQpyZXR1cm4gZnJhZ21lbnQucmVwbGFjZShyb3V0ZVN0cmlwcGVyLCcnKTt9LHN0YXJ0OmZ1bmN0aW9uKG9wdGlvbnMpe2lmKEhpc3Rvcnkuc3RhcnRlZCl0aHJvdyBuZXcgRXJyb3IoIkJhY2tib25lLmhpc3RvcnkgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIik7SGlzdG9yeS5zdGFydGVkPXRydWU7dGhpcy5vcHRpb25zPV8uZXh0ZW5kKHtyb290OicvJ30sdGhpcy5vcHRpb25zLG9wdGlvbnMpO3RoaXMucm9vdD10aGlzLm9wdGlvbnMucm9vdDt0aGlzLl93YW50c0hhc2hDaGFuZ2U9dGhpcy5vcHRpb25zLmhhc2hDaGFuZ2UhPT1mYWxzZTt0aGlzLl93YW50c1B1c2hTdGF0ZT0hIXRoaXMub3B0aW9ucy5wdXNoU3RhdGU7dGhpcy5faGFzUHVzaFN0YXRlPSEhKHRoaXMub3B0aW9ucy5wdXNoU3RhdGUmJnRoaXMuaGlzdG9yeSYmdGhpcy5oaXN0b3J5LnB1c2hTdGF0ZSk7dmFyIGZyYWdtZW50PXRoaXMuZ2V0RnJhZ21lbnQoKTt2YXIgZG9jTW9kZT1kb2N1bWVudC5kb2N1bWVudE1vZGU7dmFyIG9sZElFPShpc0V4cGxvcmVyLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKSYmKCFkb2NNb2RlfHxkb2NNb2RlPD03KSk7dGhpcy5yb290PSgnLycrdGhpcy5yb290KycvJykucmVwbGFjZShyb290U3RyaXBwZXIsJy8nKTtpZihvbGRJRSYmdGhpcy5fd2FudHNIYXNoQ2hhbmdlKXt0aGlzLmlmcmFtZT1CYWNrYm9uZS4kKCc8aWZyYW1lIHNyYz0iamF2YXNjcmlwdDowIiB0YWJpbmRleD0iLTEiIC8+JykuaGlkZSgpLmFwcGVuZFRvKCdib2R5JylbMF0uY29udGVudFdpbmRvdzt0aGlzLm5hdmlnYXRlKGZyYWdtZW50KTt9CmlmKHRoaXMuX2hhc1B1c2hTdGF0ZSl7QmFja2JvbmUuJCh3aW5kb3cpLm9uKCdwb3BzdGF0ZScsdGhpcy5jaGVja1VybCk7fWVsc2UgaWYodGhpcy5fd2FudHNIYXNoQ2hhbmdlJiYoJ29uaGFzaGNoYW5nZSdpbiB3aW5kb3cpJiYhb2xkSUUpe0JhY2tib25lLiQod2luZG93KS5vbignaGFzaGNoYW5nZScsdGhpcy5jaGVja1VybCk7fWVsc2UgaWYodGhpcy5fd2FudHNIYXNoQ2hhbmdlKXt0aGlzLl9jaGVja1VybEludGVydmFsPXNldEludGVydmFsKHRoaXMuY2hlY2tVcmwsdGhpcy5pbnRlcnZhbCk7fQp0aGlzLmZyYWdtZW50PWZyYWdtZW50O3ZhciBsb2M9dGhpcy5sb2NhdGlvbjt2YXIgYXRSb290PWxvYy5wYXRobmFtZS5yZXBsYWNlKC9bXlwvXSQvLCckJi8nKT09PXRoaXMucm9vdDtpZih0aGlzLl93YW50c0hhc2hDaGFuZ2UmJnRoaXMuX3dhbnRzUHVzaFN0YXRlKXtpZighdGhpcy5faGFzUHVzaFN0YXRlJiYhYXRSb290KXt0aGlzLmZyYWdtZW50PXRoaXMuZ2V0RnJhZ21lbnQobnVsbCx0cnVlKTt0aGlzLmxvY2F0aW9uLnJlcGxhY2UodGhpcy5yb290K3RoaXMubG9jYXRpb24uc2VhcmNoKycjJyt0aGlzLmZyYWdtZW50KTtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzLl9oYXNQdXNoU3RhdGUmJmF0Um9vdCYmbG9jLmhhc2gpe3RoaXMuZnJhZ21lbnQ9dGhpcy5nZXRIYXNoKCkucmVwbGFjZShyb3V0ZVN0cmlwcGVyLCcnKTt0aGlzLmhpc3RvcnkucmVwbGFjZVN0YXRlKHt9LGRvY3VtZW50LnRpdGxlLHRoaXMucm9vdCt0aGlzLmZyYWdtZW50K2xvYy5zZWFyY2gpO319CmlmKCF0aGlzLm9wdGlvbnMuc2lsZW50KXJldHVybiB0aGlzLmxvYWRVcmwoKTt9LHN0b3A6ZnVuY3Rpb24oKXtCYWNrYm9uZS4kKHdpbmRvdykub2ZmKCdwb3BzdGF0ZScsdGhpcy5jaGVja1VybCkub2ZmKCdoYXNoY2hhbmdlJyx0aGlzLmNoZWNrVXJsKTtjbGVhckludGVydmFsKHRoaXMuX2NoZWNrVXJsSW50ZXJ2YWwpO0hpc3Rvcnkuc3RhcnRlZD1mYWxzZTt9LHJvdXRlOmZ1bmN0aW9uKHJvdXRlLGNhbGxiYWNrKXt0aGlzLmhhbmRsZXJzLnVuc2hpZnQoe3JvdXRlOnJvdXRlLGNhbGxiYWNrOmNhbGxiYWNrfSk7fSxjaGVja1VybDpmdW5jdGlvbihlKXt2YXIgY3VycmVudD10aGlzLmdldEZyYWdtZW50KCk7aWYoY3VycmVudD09PXRoaXMuZnJhZ21lbnQmJnRoaXMuaWZyYW1lKXtjdXJyZW50PXRoaXMuZ2V0RnJhZ21lbnQodGhpcy5nZXRIYXNoKHRoaXMuaWZyYW1lKSk7fQppZihjdXJyZW50PT09dGhpcy5mcmFnbWVudClyZXR1cm4gZmFsc2U7aWYodGhpcy5pZnJhbWUpdGhpcy5uYXZpZ2F0ZShjdXJyZW50KTt0aGlzLmxvYWRVcmwoKTt9LGxvYWRVcmw6ZnVuY3Rpb24oZnJhZ21lbnQpe2ZyYWdtZW50PXRoaXMuZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudChmcmFnbWVudCk7cmV0dXJuIF8uYW55KHRoaXMuaGFuZGxlcnMsZnVuY3Rpb24oaGFuZGxlcil7aWYoaGFuZGxlci5yb3V0ZS50ZXN0KGZyYWdtZW50KSl7aGFuZGxlci5jYWxsYmFjayhmcmFnbWVudCk7cmV0dXJuIHRydWU7fX0pO30sbmF2aWdhdGU6ZnVuY3Rpb24oZnJhZ21lbnQsb3B0aW9ucyl7aWYoIUhpc3Rvcnkuc3RhcnRlZClyZXR1cm4gZmFsc2U7aWYoIW9wdGlvbnN8fG9wdGlvbnM9PT10cnVlKW9wdGlvbnM9e3RyaWdnZXI6ISFvcHRpb25zfTt2YXIgdXJsPXRoaXMucm9vdCsoZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudChmcmFnbWVudHx8JycpKTtmcmFnbWVudD1mcmFnbWVudC5yZXBsYWNlKHBhdGhTdHJpcHBlciwnJyk7aWYodGhpcy5mcmFnbWVudD09PWZyYWdtZW50KXJldHVybjt0aGlzLmZyYWdtZW50PWZyYWdtZW50O2lmKGZyYWdtZW50PT09JycmJnVybCE9PScvJyl1cmw9dXJsLnNsaWNlKDAsLTEpO2lmKHRoaXMuX2hhc1B1c2hTdGF0ZSl7dGhpcy5oaXN0b3J5W29wdGlvbnMucmVwbGFjZT8ncmVwbGFjZVN0YXRlJzoncHVzaFN0YXRlJ10oe30sZG9jdW1lbnQudGl0bGUsdXJsKTt9ZWxzZSBpZih0aGlzLl93YW50c0hhc2hDaGFuZ2Upe3RoaXMuX3VwZGF0ZUhhc2godGhpcy5sb2NhdGlvbixmcmFnbWVudCxvcHRpb25zLnJlcGxhY2UpO2lmKHRoaXMuaWZyYW1lJiYoZnJhZ21lbnQhPT10aGlzLmdldEZyYWdtZW50KHRoaXMuZ2V0SGFzaCh0aGlzLmlmcmFtZSkpKSl7aWYoIW9wdGlvbnMucmVwbGFjZSl0aGlzLmlmcmFtZS5kb2N1bWVudC5vcGVuKCkuY2xvc2UoKTt0aGlzLl91cGRhdGVIYXNoKHRoaXMuaWZyYW1lLmxvY2F0aW9uLGZyYWdtZW50LG9wdGlvbnMucmVwbGFjZSk7fX1lbHNle3JldHVybiB0aGlzLmxvY2F0aW9uLmFzc2lnbih1cmwpO30KaWYob3B0aW9ucy50cmlnZ2VyKXJldHVybiB0aGlzLmxvYWRVcmwoZnJhZ21lbnQpO30sX3VwZGF0ZUhhc2g6ZnVuY3Rpb24obG9jYXRpb24sZnJhZ21lbnQscmVwbGFjZSl7aWYocmVwbGFjZSl7dmFyIGhyZWY9bG9jYXRpb24uaHJlZi5yZXBsYWNlKC8oamF2YXNjcmlwdDp8IykuKiQvLCcnKTtsb2NhdGlvbi5yZXBsYWNlKGhyZWYrJyMnK2ZyYWdtZW50KTt9ZWxzZXtsb2NhdGlvbi5oYXNoPScjJytmcmFnbWVudDt9fX0pO0JhY2tib25lLmhpc3Rvcnk9bmV3IEhpc3Rvcnk7dmFyIGV4dGVuZD1mdW5jdGlvbihwcm90b1Byb3BzLHN0YXRpY1Byb3BzKXt2YXIgcGFyZW50PXRoaXM7dmFyIGNoaWxkO2lmKHByb3RvUHJvcHMmJl8uaGFzKHByb3RvUHJvcHMsJ2NvbnN0cnVjdG9yJykpe2NoaWxkPXByb3RvUHJvcHMuY29uc3RydWN0b3I7fWVsc2V7Y2hpbGQ9ZnVuY3Rpb24oKXtyZXR1cm4gcGFyZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O30KXy5leHRlbmQoY2hpbGQscGFyZW50LHN0YXRpY1Byb3BzKTt2YXIgU3Vycm9nYXRlPWZ1bmN0aW9uKCl7dGhpcy5jb25zdHJ1Y3Rvcj1jaGlsZDt9O1N1cnJvZ2F0ZS5wcm90b3R5cGU9cGFyZW50LnByb3RvdHlwZTtjaGlsZC5wcm90b3R5cGU9bmV3IFN1cnJvZ2F0ZTtpZihwcm90b1Byb3BzKV8uZXh0ZW5kKGNoaWxkLnByb3RvdHlwZSxwcm90b1Byb3BzKTtjaGlsZC5fX3N1cGVyX189cGFyZW50LnByb3RvdHlwZTtyZXR1cm4gY2hpbGQ7fTtNb2RlbC5leHRlbmQ9Q29sbGVjdGlvbi5leHRlbmQ9Um91dGVyLmV4dGVuZD1WaWV3LmV4dGVuZD1IaXN0b3J5LmV4dGVuZD1leHRlbmQ7dmFyIHVybEVycm9yPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCdBICJ1cmwiIHByb3BlcnR5IG9yIGZ1bmN0aW9uIG11c3QgYmUgc3BlY2lmaWVkJyk7fTt2YXIgd3JhcEVycm9yPWZ1bmN0aW9uKG1vZGVsLG9wdGlvbnMpe3ZhciBlcnJvcj1vcHRpb25zLmVycm9yO29wdGlvbnMuZXJyb3I9ZnVuY3Rpb24ocmVzcCl7aWYoZXJyb3IpZXJyb3IobW9kZWwscmVzcCxvcHRpb25zKTttb2RlbC50cmlnZ2VyKCdlcnJvcicsbW9kZWwscmVzcCxvcHRpb25zKTt9O307fSkuY2FsbCh0aGlzKTs=",
                "body": "CihmdW5jdGlvbihnbG9iYWwsZmFjdG9yeSl7aWYodHlwZW9mIG1vZHVsZT09PSJvYmplY3QiJiZ0eXBlb2YgbW9kdWxlLmV4cG9ydHM9PT0ib2JqZWN0Iil7bW9kdWxlLmV4cG9ydHM9Z2xvYmFsLmRvY3VtZW50P2ZhY3RvcnkoZ2xvYmFsLHRydWUpOmZ1bmN0aW9uKHcpe2lmKCF3LmRvY3VtZW50KXt0aHJvdyBuZXcgRXJyb3IoImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnQiKTt9CnJldHVybiBmYWN0b3J5KHcpO307fWVsc2V7ZmFjdG9yeShnbG9iYWwpO319KHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIj93aW5kb3c6dGhpcyxmdW5jdGlvbih3aW5kb3csbm9HbG9iYWwpe3ZhciBkZWxldGVkSWRzPVtdO3ZhciBzbGljZT1kZWxldGVkSWRzLnNsaWNlO3ZhciBjb25jYXQ9ZGVsZXRlZElkcy5jb25jYXQ7dmFyIHB1c2g9ZGVsZXRlZElkcy5wdXNoO3ZhciBpbmRleE9mPWRlbGV0ZWRJZHMuaW5kZXhPZjt2YXIgY2xhc3MydHlwZT17fTt2YXIgdG9TdHJpbmc9Y2xhc3MydHlwZS50b1N0cmluZzt2YXIgaGFzT3duPWNsYXNzMnR5cGUuaGFzT3duUHJvcGVydHk7dmFyIHRyaW09IiIudHJpbTt2YXIgc3VwcG9ydD17fTt2YXIKdmVyc2lvbj0iMS4xMS4wIixqUXVlcnk9ZnVuY3Rpb24oc2VsZWN0b3IsY29udGV4dCl7cmV0dXJuIG5ldyBqUXVlcnkuZm4uaW5pdChzZWxlY3Rvcixjb250ZXh0KTt9LHJ0cmltPS9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZyxybXNQcmVmaXg9L14tbXMtLyxyZGFzaEFscGhhPS8tKFtcZGEtel0pL2dpLGZjYW1lbENhc2U9ZnVuY3Rpb24oYWxsLGxldHRlcil7cmV0dXJuIGxldHRlci50b1VwcGVyQ2FzZSgpO307alF1ZXJ5LmZuPWpRdWVyeS5wcm90b3R5cGU9e2pxdWVyeTp2ZXJzaW9uLGNvbnN0cnVjdG9yOmpRdWVyeSxzZWxlY3RvcjoiIixsZW5ndGg6MCx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHNsaWNlLmNhbGwodGhpcyk7fSxnZXQ6ZnVuY3Rpb24obnVtKXtyZXR1cm4gbnVtIT1udWxsPyhudW08MD90aGlzW251bSt0aGlzLmxlbmd0aF06dGhpc1tudW1dKTpzbGljZS5jYWxsKHRoaXMpO30scHVzaFN0YWNrOmZ1bmN0aW9uKGVsZW1zKXt2YXIgcmV0PWpRdWVyeS5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksZWxlbXMpO3JldC5wcmV2T2JqZWN0PXRoaXM7cmV0LmNvbnRleHQ9dGhpcy5jb250ZXh0O3JldHVybiByZXQ7fSxlYWNoOmZ1bmN0aW9uKGNhbGxiYWNrLGFyZ3Mpe3JldHVybiBqUXVlcnkuZWFjaCh0aGlzLGNhbGxiYWNrLGFyZ3MpO30sbWFwOmZ1bmN0aW9uKGNhbGxiYWNrKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soalF1ZXJ5Lm1hcCh0aGlzLGZ1bmN0aW9uKGVsZW0saSl7cmV0dXJuIGNhbGxiYWNrLmNhbGwoZWxlbSxpLGVsZW0pO30pKTt9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHNsaWNlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSk7fSxmaXJzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKDApO30sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKTt9LGVxOmZ1bmN0aW9uKGkpe3ZhciBsZW49dGhpcy5sZW5ndGgsaj0raSsoaTwwP2xlbjowKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soaj49MCYmajxsZW4/W3RoaXNbal1dOltdKTt9LGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXZPYmplY3R8fHRoaXMuY29uc3RydWN0b3IobnVsbCk7fSxwdXNoOnB1c2gsc29ydDpkZWxldGVkSWRzLnNvcnQsc3BsaWNlOmRlbGV0ZWRJZHMuc3BsaWNlfTtqUXVlcnkuZXh0ZW5kPWpRdWVyeS5mbi5leHRlbmQ9ZnVuY3Rpb24oKXt2YXIgc3JjLGNvcHlJc0FycmF5LGNvcHksbmFtZSxvcHRpb25zLGNsb25lLHRhcmdldD1hcmd1bWVudHNbMF18fHt9LGk9MSxsZW5ndGg9YXJndW1lbnRzLmxlbmd0aCxkZWVwPWZhbHNlO2lmKHR5cGVvZiB0YXJnZXQ9PT0iYm9vbGVhbiIpe2RlZXA9dGFyZ2V0O3RhcmdldD1hcmd1bWVudHNbaV18fHt9O2krKzt9CmlmKHR5cGVvZiB0YXJnZXQhPT0ib2JqZWN0IiYmIWpRdWVyeS5pc0Z1bmN0aW9uKHRhcmdldCkpe3RhcmdldD17fTt9CmlmKGk9PT1sZW5ndGgpe3RhcmdldD10aGlzO2ktLTt9CmZvcig7aTxsZW5ndGg7aSsrKXtpZigob3B0aW9ucz1hcmd1bWVudHNbaV0pIT1udWxsKXtmb3IobmFtZSBpbiBvcHRpb25zKXtzcmM9dGFyZ2V0W25hbWVdO2NvcHk9b3B0aW9uc1tuYW1lXTtpZih0YXJnZXQ9PT1jb3B5KXtjb250aW51ZTt9CmlmKGRlZXAmJmNvcHkmJihqUXVlcnkuaXNQbGFpbk9iamVjdChjb3B5KXx8KGNvcHlJc0FycmF5PWpRdWVyeS5pc0FycmF5KGNvcHkpKSkpe2lmKGNvcHlJc0FycmF5KXtjb3B5SXNBcnJheT1mYWxzZTtjbG9uZT1zcmMmJmpRdWVyeS5pc0FycmF5KHNyYyk/c3JjOltdO31lbHNle2Nsb25lPXNyYyYmalF1ZXJ5LmlzUGxhaW5PYmplY3Qoc3JjKT9zcmM6e307fQp0YXJnZXRbbmFtZV09alF1ZXJ5LmV4dGVuZChkZWVwLGNsb25lLGNvcHkpO31lbHNlIGlmKGNvcHkhPT11bmRlZmluZWQpe3RhcmdldFtuYW1lXT1jb3B5O319fX0KcmV0dXJuIHRhcmdldDt9O2pRdWVyeS5leHRlbmQoe2V4cGFuZG86ImpRdWVyeSIrKHZlcnNpb24rTWF0aC5yYW5kb20oKSkucmVwbGFjZSgvXEQvZywiIiksaXNSZWFkeTp0cnVlLGVycm9yOmZ1bmN0aW9uKG1zZyl7dGhyb3cgbmV3IEVycm9yKG1zZyk7fSxub29wOmZ1bmN0aW9uKCl7fSxpc0Z1bmN0aW9uOmZ1bmN0aW9uKG9iail7cmV0dXJuIGpRdWVyeS50eXBlKG9iaik9PT0iZnVuY3Rpb24iO30saXNBcnJheTpBcnJheS5pc0FycmF5fHxmdW5jdGlvbihvYmope3JldHVybiBqUXVlcnkudHlwZShvYmopPT09ImFycmF5Ijt9LGlzV2luZG93OmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iaiE9bnVsbCYmb2JqPT1vYmoud2luZG93O30saXNOdW1lcmljOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai1wYXJzZUZsb2F0KG9iaik+PTA7fSxpc0VtcHR5T2JqZWN0OmZ1bmN0aW9uKG9iail7dmFyIG5hbWU7Zm9yKG5hbWUgaW4gb2JqKXtyZXR1cm4gZmFsc2U7fQpyZXR1cm4gdHJ1ZTt9LGlzUGxhaW5PYmplY3Q6ZnVuY3Rpb24ob2JqKXt2YXIga2V5O2lmKCFvYmp8fGpRdWVyeS50eXBlKG9iaikhPT0ib2JqZWN0Inx8b2JqLm5vZGVUeXBlfHxqUXVlcnkuaXNXaW5kb3cob2JqKSl7cmV0dXJuIGZhbHNlO30KdHJ5e2lmKG9iai5jb25zdHJ1Y3RvciYmIWhhc093bi5jYWxsKG9iaiwiY29uc3RydWN0b3IiKSYmIWhhc093bi5jYWxsKG9iai5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsImlzUHJvdG90eXBlT2YiKSl7cmV0dXJuIGZhbHNlO319Y2F0Y2goZSl7cmV0dXJuIGZhbHNlO30KaWYoc3VwcG9ydC5vd25MYXN0KXtmb3Ioa2V5IGluIG9iail7cmV0dXJuIGhhc093bi5jYWxsKG9iaixrZXkpO319CmZvcihrZXkgaW4gb2JqKXt9CnJldHVybiBrZXk9PT11bmRlZmluZWR8fGhhc093bi5jYWxsKG9iaixrZXkpO30sdHlwZTpmdW5jdGlvbihvYmope2lmKG9iaj09bnVsbCl7cmV0dXJuIG9iaisiIjt9CnJldHVybiB0eXBlb2Ygb2JqPT09Im9iamVjdCJ8fHR5cGVvZiBvYmo9PT0iZnVuY3Rpb24iP2NsYXNzMnR5cGVbdG9TdHJpbmcuY2FsbChvYmopXXx8Im9iamVjdCI6dHlwZW9mIG9iajt9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oZGF0YSl7aWYoZGF0YSYmalF1ZXJ5LnRyaW0oZGF0YSkpeyh3aW5kb3cuZXhlY1NjcmlwdHx8ZnVuY3Rpb24oZGF0YSl7d2luZG93WyJldmFsIl0uY2FsbCh3aW5kb3csZGF0YSk7fSkoZGF0YSk7fX0sY2FtZWxDYXNlOmZ1bmN0aW9uKHN0cmluZyl7cmV0dXJuIHN0cmluZy5yZXBsYWNlKHJtc1ByZWZpeCwibXMtIikucmVwbGFjZShyZGFzaEFscGhhLGZjYW1lbENhc2UpO30sbm9kZU5hbWU6ZnVuY3Rpb24oZWxlbSxuYW1lKXtyZXR1cm4gZWxlbS5ub2RlTmFtZSYmZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09bmFtZS50b0xvd2VyQ2FzZSgpO30sZWFjaDpmdW5jdGlvbihvYmosY2FsbGJhY2ssYXJncyl7dmFyIHZhbHVlLGk9MCxsZW5ndGg9b2JqLmxlbmd0aCxpc0FycmF5PWlzQXJyYXlsaWtlKG9iaik7aWYoYXJncyl7aWYoaXNBcnJheSl7Zm9yKDtpPGxlbmd0aDtpKyspe3ZhbHVlPWNhbGxiYWNrLmFwcGx5KG9ialtpXSxhcmdzKTtpZih2YWx1ZT09PWZhbHNlKXticmVhazt9fX1lbHNle2ZvcihpIGluIG9iail7dmFsdWU9Y2FsbGJhY2suYXBwbHkob2JqW2ldLGFyZ3MpO2lmKHZhbHVlPT09ZmFsc2Upe2JyZWFrO319fX1lbHNle2lmKGlzQXJyYXkpe2Zvcig7aTxsZW5ndGg7aSsrKXt2YWx1ZT1jYWxsYmFjay5jYWxsKG9ialtpXSxpLG9ialtpXSk7aWYodmFsdWU9PT1mYWxzZSl7YnJlYWs7fX19ZWxzZXtmb3IoaSBpbiBvYmope3ZhbHVlPWNhbGxiYWNrLmNhbGwob2JqW2ldLGksb2JqW2ldKTtpZih2YWx1ZT09PWZhbHNlKXticmVhazt9fX19CnJldHVybiBvYmo7fSx0cmltOnRyaW0mJiF0cmltLmNhbGwoIlx1RkVGRlx4QTAiKT9mdW5jdGlvbih0ZXh0KXtyZXR1cm4gdGV4dD09bnVsbD8iIjp0cmltLmNhbGwodGV4dCk7fTpmdW5jdGlvbih0ZXh0KXtyZXR1cm4gdGV4dD09bnVsbD8iIjoodGV4dCsiIikucmVwbGFjZShydHJpbSwiIik7fSxtYWtlQXJyYXk6ZnVuY3Rpb24oYXJyLHJlc3VsdHMpe3ZhciByZXQ9cmVzdWx0c3x8W107aWYoYXJyIT1udWxsKXtpZihpc0FycmF5bGlrZShPYmplY3QoYXJyKSkpe2pRdWVyeS5tZXJnZShyZXQsdHlwZW9mIGFycj09PSJzdHJpbmciP1thcnJdOmFycik7fWVsc2V7cHVzaC5jYWxsKHJldCxhcnIpO319CnJldHVybiByZXQ7fSxpbkFycmF5OmZ1bmN0aW9uKGVsZW0sYXJyLGkpe3ZhciBsZW47aWYoYXJyKXtpZihpbmRleE9mKXtyZXR1cm4gaW5kZXhPZi5jYWxsKGFycixlbGVtLGkpO30KbGVuPWFyci5sZW5ndGg7aT1pP2k8MD9NYXRoLm1heCgwLGxlbitpKTppOjA7Zm9yKDtpPGxlbjtpKyspe2lmKGkgaW4gYXJyJiZhcnJbaV09PT1lbGVtKXtyZXR1cm4gaTt9fX0KcmV0dXJuLTE7fSxtZXJnZTpmdW5jdGlvbihmaXJzdCxzZWNvbmQpe3ZhciBsZW49K3NlY29uZC5sZW5ndGgsaj0wLGk9Zmlyc3QubGVuZ3RoO3doaWxlKGo8bGVuKXtmaXJzdFtpKytdPXNlY29uZFtqKytdO30KaWYobGVuIT09bGVuKXt3aGlsZShzZWNvbmRbal0hPT11bmRlZmluZWQpe2ZpcnN0W2krK109c2Vjb25kW2orK107fX0KZmlyc3QubGVuZ3RoPWk7cmV0dXJuIGZpcnN0O30sZ3JlcDpmdW5jdGlvbihlbGVtcyxjYWxsYmFjayxpbnZlcnQpe3ZhciBjYWxsYmFja0ludmVyc2UsbWF0Y2hlcz1bXSxpPTAsbGVuZ3RoPWVsZW1zLmxlbmd0aCxjYWxsYmFja0V4cGVjdD0haW52ZXJ0O2Zvcig7aTxsZW5ndGg7aSsrKXtjYWxsYmFja0ludmVyc2U9IWNhbGxiYWNrKGVsZW1zW2ldLGkpO2lmKGNhbGxiYWNrSW52ZXJzZSE9PWNhbGxiYWNrRXhwZWN0KXttYXRjaGVzLnB1c2goZWxlbXNbaV0pO319CnJldHVybiBtYXRjaGVzO30sbWFwOmZ1bmN0aW9uKGVsZW1zLGNhbGxiYWNrLGFyZyl7dmFyIHZhbHVlLGk9MCxsZW5ndGg9ZWxlbXMubGVuZ3RoLGlzQXJyYXk9aXNBcnJheWxpa2UoZWxlbXMpLHJldD1bXTtpZihpc0FycmF5KXtmb3IoO2k8bGVuZ3RoO2krKyl7dmFsdWU9Y2FsbGJhY2soZWxlbXNbaV0saSxhcmcpO2lmKHZhbHVlIT1udWxsKXtyZXQucHVzaCh2YWx1ZSk7fX19ZWxzZXtmb3IoaSBpbiBlbGVtcyl7dmFsdWU9Y2FsbGJhY2soZWxlbXNbaV0saSxhcmcpO2lmKHZhbHVlIT1udWxsKXtyZXQucHVzaCh2YWx1ZSk7fX19CnJldHVybiBjb25jYXQuYXBwbHkoW10scmV0KTt9LGd1aWQ6MSxwcm94eTpmdW5jdGlvbihmbixjb250ZXh0KXt2YXIgYXJncyxwcm94eSx0bXA7aWYodHlwZW9mIGNvbnRleHQ9PT0ic3RyaW5nIil7dG1wPWZuW2NvbnRleHRdO2NvbnRleHQ9Zm47Zm49dG1wO30KaWYoIWpRdWVyeS5pc0Z1bmN0aW9uKGZuKSl7cmV0dXJuIHVuZGVmaW5lZDt9CmFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMsMik7cHJveHk9ZnVuY3Rpb24oKXtyZXR1cm4gZm4uYXBwbHkoY29udGV4dHx8dGhpcyxhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTt9O3Byb3h5Lmd1aWQ9Zm4uZ3VpZD1mbi5ndWlkfHxqUXVlcnkuZ3VpZCsrO3JldHVybiBwcm94eTt9LG5vdzpmdW5jdGlvbigpe3JldHVybisobmV3IERhdGUoKSk7fSxzdXBwb3J0OnN1cHBvcnR9KTtqUXVlcnkuZWFjaCgiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvciIuc3BsaXQoIiAiKSxmdW5jdGlvbihpLG5hbWUpe2NsYXNzMnR5cGVbIltvYmplY3QgIituYW1lKyJdIl09bmFtZS50b0xvd2VyQ2FzZSgpO30pO2Z1bmN0aW9uIGlzQXJyYXlsaWtlKG9iail7dmFyIGxlbmd0aD1vYmoubGVuZ3RoLHR5cGU9alF1ZXJ5LnR5cGUob2JqKTtpZih0eXBlPT09ImZ1bmN0aW9uInx8alF1ZXJ5LmlzV2luZG93KG9iaikpe3JldHVybiBmYWxzZTt9CmlmKG9iai5ub2RlVHlwZT09PTEmJmxlbmd0aCl7cmV0dXJuIHRydWU7fQpyZXR1cm4gdHlwZT09PSJhcnJheSJ8fGxlbmd0aD09PTB8fHR5cGVvZiBsZW5ndGg9PT0ibnVtYmVyIiYmbGVuZ3RoPjAmJihsZW5ndGgtMSlpbiBvYmo7fQp2YXIgU2l6emxlPShmdW5jdGlvbih3aW5kb3cpe3ZhciBpLHN1cHBvcnQsRXhwcixnZXRUZXh0LGlzWE1MLGNvbXBpbGUsb3V0ZXJtb3N0Q29udGV4dCxzb3J0SW5wdXQsaGFzRHVwbGljYXRlLHNldERvY3VtZW50LGRvY3VtZW50LGRvY0VsZW0sZG9jdW1lbnRJc0hUTUwscmJ1Z2d5UVNBLHJidWdneU1hdGNoZXMsbWF0Y2hlcyxjb250YWlucyxleHBhbmRvPSJzaXp6bGUiKy0obmV3IERhdGUoKSkscHJlZmVycmVkRG9jPXdpbmRvdy5kb2N1bWVudCxkaXJydW5zPTAsZG9uZT0wLGNsYXNzQ2FjaGU9Y3JlYXRlQ2FjaGUoKSx0b2tlbkNhY2hlPWNyZWF0ZUNhY2hlKCksY29tcGlsZXJDYWNoZT1jcmVhdGVDYWNoZSgpLHNvcnRPcmRlcj1mdW5jdGlvbihhLGIpe2lmKGE9PT1iKXtoYXNEdXBsaWNhdGU9dHJ1ZTt9CnJldHVybiAwO30sc3RydW5kZWZpbmVkPXR5cGVvZiB1bmRlZmluZWQsTUFYX05FR0FUSVZFPTE8PDMxLGhhc093bj0oe30pLmhhc093blByb3BlcnR5LGFycj1bXSxwb3A9YXJyLnBvcCxwdXNoX25hdGl2ZT1hcnIucHVzaCxwdXNoPWFyci5wdXNoLHNsaWNlPWFyci5zbGljZSxpbmRleE9mPWFyci5pbmRleE9mfHxmdW5jdGlvbihlbGVtKXt2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDtmb3IoO2k8bGVuO2krKyl7aWYodGhpc1tpXT09PWVsZW0pe3JldHVybiBpO319CnJldHVybi0xO30sYm9vbGVhbnM9ImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxpc21hcHxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkIix3aGl0ZXNwYWNlPSJbXFx4MjBcXHRcXHJcXG5cXGZdIixjaGFyYWN0ZXJFbmNvZGluZz0iKD86XFxcXC58W1xcdy1dfFteXFx4MDAtXFx4YTBdKSsiLGlkZW50aWZpZXI9Y2hhcmFjdGVyRW5jb2RpbmcucmVwbGFjZSgidyIsIncjIiksYXR0cmlidXRlcz0iXFxbIit3aGl0ZXNwYWNlKyIqKCIrY2hhcmFjdGVyRW5jb2RpbmcrIikiK3doaXRlc3BhY2UrIiooPzooWypeJHwhfl0/PSkiK3doaXRlc3BhY2UrIiooPzooWydcIl0pKCg/OlxcXFwufFteXFxcXF0pKj8pXFwzfCgiK2lkZW50aWZpZXIrIil8KXwpIit3aGl0ZXNwYWNlKyIqXFxdIixwc2V1ZG9zPSI6KCIrY2hhcmFjdGVyRW5jb2RpbmcrIikoPzpcXCgoKFsnXCJdKSgoPzpcXFxcLnxbXlxcXFxdKSo/KVxcM3woKD86XFxcXC58W15cXFxcKClbXFxdXXwiK2F0dHJpYnV0ZXMucmVwbGFjZSgzLDgpKyIpKil8LiopXFwpfCkiLHJ0cmltPW5ldyBSZWdFeHAoIl4iK3doaXRlc3BhY2UrIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIrd2hpdGVzcGFjZSsiKyQiLCJnIikscmNvbW1hPW5ldyBSZWdFeHAoIl4iK3doaXRlc3BhY2UrIiosIit3aGl0ZXNwYWNlKyIqIikscmNvbWJpbmF0b3JzPW5ldyBSZWdFeHAoIl4iK3doaXRlc3BhY2UrIiooWz4rfl18Iit3aGl0ZXNwYWNlKyIpIit3aGl0ZXNwYWNlKyIqIikscmF0dHJpYnV0ZVF1b3Rlcz1uZXcgUmVnRXhwKCI9Iit3aGl0ZXNwYWNlKyIqKFteXFxdJ1wiXSo/KSIrd2hpdGVzcGFjZSsiKlxcXSIsImciKSxycHNldWRvPW5ldyBSZWdFeHAocHNldWRvcykscmlkZW50aWZpZXI9bmV3IFJlZ0V4cCgiXiIraWRlbnRpZmllcisiJCIpLG1hdGNoRXhwcj17IklEIjpuZXcgUmVnRXhwKCJeIygiK2NoYXJhY3RlckVuY29kaW5nKyIpIiksIkNMQVNTIjpuZXcgUmVnRXhwKCJeXFwuKCIrY2hhcmFjdGVyRW5jb2RpbmcrIikiKSwiVEFHIjpuZXcgUmVnRXhwKCJeKCIrY2hhcmFjdGVyRW5jb2RpbmcucmVwbGFjZSgidyIsIncqIikrIikiKSwiQVRUUiI6bmV3IFJlZ0V4cCgiXiIrYXR0cmlidXRlcyksIlBTRVVETyI6bmV3IFJlZ0V4cCgiXiIrcHNldWRvcyksIkNISUxEIjpuZXcgUmVnRXhwKCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXCgiK3doaXRlc3BhY2UrIiooZXZlbnxvZGR8KChbKy1dfCkoXFxkKilufCkiK3doaXRlc3BhY2UrIiooPzooWystXXwpIit3aGl0ZXNwYWNlKyIqKFxcZCspfCkpIit3aGl0ZXNwYWNlKyIqXFwpfCkiLCJpIiksImJvb2wiOm5ldyBSZWdFeHAoIl4oPzoiK2Jvb2xlYW5zKyIpJCIsImkiKSwibmVlZHNDb250ZXh0IjpuZXcgUmVnRXhwKCJeIit3aGl0ZXNwYWNlKyIqWz4rfl18OihldmVufG9kZHxlcXxndHxsdHxudGh8Zmlyc3R8bGFzdCkoPzpcXCgiKwp3aGl0ZXNwYWNlKyIqKCg/Oi1cXGQpP1xcZCopIit3aGl0ZXNwYWNlKyIqXFwpfCkoPz1bXi1dfCQpIiwiaSIpfSxyaW5wdXRzPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2kscmhlYWRlcj0vXmhcZCQvaSxybmF0aXZlPS9eW157XStce1xzKlxbbmF0aXZlIFx3LyxycXVpY2tFeHByPS9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8scnNpYmxpbmc9L1srfl0vLHJlc2NhcGU9Lyd8XFwvZyxydW5lc2NhcGU9bmV3IFJlZ0V4cCgiXFxcXChbXFxkYS1mXXsxLDZ9Iit3aGl0ZXNwYWNlKyI/fCgiK3doaXRlc3BhY2UrIil8LikiLCJpZyIpLGZ1bmVzY2FwZT1mdW5jdGlvbihfLGVzY2FwZWQsZXNjYXBlZFdoaXRlc3BhY2Upe3ZhciBoaWdoPSIweCIrZXNjYXBlZC0weDEwMDAwO3JldHVybiBoaWdoIT09aGlnaHx8ZXNjYXBlZFdoaXRlc3BhY2U/ZXNjYXBlZDpoaWdoPDA/U3RyaW5nLmZyb21DaGFyQ29kZShoaWdoKzB4MTAwMDApOlN0cmluZy5mcm9tQ2hhckNvZGUoaGlnaD4+MTB8MHhEODAwLGhpZ2gmMHgzRkZ8MHhEQzAwKTt9O3RyeXtwdXNoLmFwcGx5KChhcnI9c2xpY2UuY2FsbChwcmVmZXJyZWREb2MuY2hpbGROb2RlcykpLHByZWZlcnJlZERvYy5jaGlsZE5vZGVzKTthcnJbcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMubGVuZ3RoXS5ub2RlVHlwZTt9Y2F0Y2goZSl7cHVzaD17YXBwbHk6YXJyLmxlbmd0aD9mdW5jdGlvbih0YXJnZXQsZWxzKXtwdXNoX25hdGl2ZS5hcHBseSh0YXJnZXQsc2xpY2UuY2FsbChlbHMpKTt9OmZ1bmN0aW9uKHRhcmdldCxlbHMpe3ZhciBqPXRhcmdldC5sZW5ndGgsaT0wO3doaWxlKCh0YXJnZXRbaisrXT1lbHNbaSsrXSkpe30KdGFyZ2V0Lmxlbmd0aD1qLTE7fX07fQpmdW5jdGlvbiBTaXp6bGUoc2VsZWN0b3IsY29udGV4dCxyZXN1bHRzLHNlZWQpe3ZhciBtYXRjaCxlbGVtLG0sbm9kZVR5cGUsaSxncm91cHMsb2xkLG5pZCxuZXdDb250ZXh0LG5ld1NlbGVjdG9yO2lmKChjb250ZXh0P2NvbnRleHQub3duZXJEb2N1bWVudHx8Y29udGV4dDpwcmVmZXJyZWREb2MpIT09ZG9jdW1lbnQpe3NldERvY3VtZW50KGNvbnRleHQpO30KY29udGV4dD1jb250ZXh0fHxkb2N1bWVudDtyZXN1bHRzPXJlc3VsdHN8fFtdO2lmKCFzZWxlY3Rvcnx8dHlwZW9mIHNlbGVjdG9yIT09InN0cmluZyIpe3JldHVybiByZXN1bHRzO30KaWYoKG5vZGVUeXBlPWNvbnRleHQubm9kZVR5cGUpIT09MSYmbm9kZVR5cGUhPT05KXtyZXR1cm5bXTt9CmlmKGRvY3VtZW50SXNIVE1MJiYhc2VlZCl7aWYoKG1hdGNoPXJxdWlja0V4cHIuZXhlYyhzZWxlY3RvcikpKXtpZigobT1tYXRjaFsxXSkpe2lmKG5vZGVUeXBlPT09OSl7ZWxlbT1jb250ZXh0LmdldEVsZW1lbnRCeUlkKG0pO2lmKGVsZW0mJmVsZW0ucGFyZW50Tm9kZSl7aWYoZWxlbS5pZD09PW0pe3Jlc3VsdHMucHVzaChlbGVtKTtyZXR1cm4gcmVzdWx0czt9fWVsc2V7cmV0dXJuIHJlc3VsdHM7fX1lbHNle2lmKGNvbnRleHQub3duZXJEb2N1bWVudCYmKGVsZW09Y29udGV4dC5vd25lckRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG0pKSYmY29udGFpbnMoY29udGV4dCxlbGVtKSYmZWxlbS5pZD09PW0pe3Jlc3VsdHMucHVzaChlbGVtKTtyZXR1cm4gcmVzdWx0czt9fX1lbHNlIGlmKG1hdGNoWzJdKXtwdXNoLmFwcGx5KHJlc3VsdHMsY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZShzZWxlY3RvcikpO3JldHVybiByZXN1bHRzO31lbHNlIGlmKChtPW1hdGNoWzNdKSYmc3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUpe3B1c2guYXBwbHkocmVzdWx0cyxjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUobSkpO3JldHVybiByZXN1bHRzO319CmlmKHN1cHBvcnQucXNhJiYoIXJidWdneVFTQXx8IXJidWdneVFTQS50ZXN0KHNlbGVjdG9yKSkpe25pZD1vbGQ9ZXhwYW5kbztuZXdDb250ZXh0PWNvbnRleHQ7bmV3U2VsZWN0b3I9bm9kZVR5cGU9PT05JiZzZWxlY3RvcjtpZihub2RlVHlwZT09PTEmJmNvbnRleHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSE9PSJvYmplY3QiKXtncm91cHM9dG9rZW5pemUoc2VsZWN0b3IpO2lmKChvbGQ9Y29udGV4dC5nZXRBdHRyaWJ1dGUoImlkIikpKXtuaWQ9b2xkLnJlcGxhY2UocmVzY2FwZSwiXFwkJiIpO31lbHNle2NvbnRleHQuc2V0QXR0cmlidXRlKCJpZCIsbmlkKTt9Cm5pZD0iW2lkPSciK25pZCsiJ10gIjtpPWdyb3Vwcy5sZW5ndGg7d2hpbGUoaS0tKXtncm91cHNbaV09bmlkK3RvU2VsZWN0b3IoZ3JvdXBzW2ldKTt9Cm5ld0NvbnRleHQ9cnNpYmxpbmcudGVzdChzZWxlY3RvcikmJnRlc3RDb250ZXh0KGNvbnRleHQucGFyZW50Tm9kZSl8fGNvbnRleHQ7bmV3U2VsZWN0b3I9Z3JvdXBzLmpvaW4oIiwiKTt9CmlmKG5ld1NlbGVjdG9yKXt0cnl7cHVzaC5hcHBseShyZXN1bHRzLG5ld0NvbnRleHQucXVlcnlTZWxlY3RvckFsbChuZXdTZWxlY3RvcikpO3JldHVybiByZXN1bHRzO31jYXRjaChxc2FFcnJvcil7fWZpbmFsbHl7aWYoIW9sZCl7Y29udGV4dC5yZW1vdmVBdHRyaWJ1dGUoImlkIik7fX19fX0KcmV0dXJuIHNlbGVjdChzZWxlY3Rvci5yZXBsYWNlKHJ0cmltLCIkMSIpLGNvbnRleHQscmVzdWx0cyxzZWVkKTt9CmZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCl7dmFyIGtleXM9W107ZnVuY3Rpb24gY2FjaGUoa2V5LHZhbHVlKXtpZihrZXlzLnB1c2goa2V5KyIgIik+RXhwci5jYWNoZUxlbmd0aCl7ZGVsZXRlIGNhY2hlW2tleXMuc2hpZnQoKV07fQpyZXR1cm4oY2FjaGVba2V5KyIgIl09dmFsdWUpO30KcmV0dXJuIGNhY2hlO30KZnVuY3Rpb24gbWFya0Z1bmN0aW9uKGZuKXtmbltleHBhbmRvXT10cnVlO3JldHVybiBmbjt9CmZ1bmN0aW9uIGFzc2VydChmbil7dmFyIGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTt0cnl7cmV0dXJuISFmbihkaXYpO31jYXRjaChlKXtyZXR1cm4gZmFsc2U7fWZpbmFsbHl7aWYoZGl2LnBhcmVudE5vZGUpe2Rpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRpdik7fQpkaXY9bnVsbDt9fQpmdW5jdGlvbiBhZGRIYW5kbGUoYXR0cnMsaGFuZGxlcil7dmFyIGFycj1hdHRycy5zcGxpdCgifCIpLGk9YXR0cnMubGVuZ3RoO3doaWxlKGktLSl7RXhwci5hdHRySGFuZGxlW2FycltpXV09aGFuZGxlcjt9fQpmdW5jdGlvbiBzaWJsaW5nQ2hlY2soYSxiKXt2YXIgY3VyPWImJmEsZGlmZj1jdXImJmEubm9kZVR5cGU9PT0xJiZiLm5vZGVUeXBlPT09MSYmKH5iLnNvdXJjZUluZGV4fHxNQVhfTkVHQVRJVkUpLQoofmEuc291cmNlSW5kZXh8fE1BWF9ORUdBVElWRSk7aWYoZGlmZil7cmV0dXJuIGRpZmY7fQppZihjdXIpe3doaWxlKChjdXI9Y3VyLm5leHRTaWJsaW5nKSl7aWYoY3VyPT09Yil7cmV0dXJuLTE7fX19CnJldHVybiBhPzE6LTE7fQpmdW5jdGlvbiBjcmVhdGVJbnB1dFBzZXVkbyh0eXBlKXtyZXR1cm4gZnVuY3Rpb24oZWxlbSl7dmFyIG5hbWU9ZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybiBuYW1lPT09ImlucHV0IiYmZWxlbS50eXBlPT09dHlwZTt9O30KZnVuY3Rpb24gY3JlYXRlQnV0dG9uUHNldWRvKHR5cGUpe3JldHVybiBmdW5jdGlvbihlbGVtKXt2YXIgbmFtZT1lbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKG5hbWU9PT0iaW5wdXQifHxuYW1lPT09ImJ1dHRvbiIpJiZlbGVtLnR5cGU9PT10eXBlO307fQpmdW5jdGlvbiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZuKXtyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKGFyZ3VtZW50KXthcmd1bWVudD0rYXJndW1lbnQ7cmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbihzZWVkLG1hdGNoZXMpe3ZhciBqLG1hdGNoSW5kZXhlcz1mbihbXSxzZWVkLmxlbmd0aCxhcmd1bWVudCksaT1tYXRjaEluZGV4ZXMubGVuZ3RoO3doaWxlKGktLSl7aWYoc2VlZFsoaj1tYXRjaEluZGV4ZXNbaV0pXSl7c2VlZFtqXT0hKG1hdGNoZXNbal09c2VlZFtqXSk7fX19KTt9KTt9CmZ1bmN0aW9uIHRlc3RDb250ZXh0KGNvbnRleHQpe3JldHVybiBjb250ZXh0JiZ0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSE9PXN0cnVuZGVmaW5lZCYmY29udGV4dDt9CnN1cHBvcnQ9U2l6emxlLnN1cHBvcnQ9e307aXNYTUw9U2l6emxlLmlzWE1MPWZ1bmN0aW9uKGVsZW0pe3ZhciBkb2N1bWVudEVsZW1lbnQ9ZWxlbSYmKGVsZW0ub3duZXJEb2N1bWVudHx8ZWxlbSkuZG9jdW1lbnRFbGVtZW50O3JldHVybiBkb2N1bWVudEVsZW1lbnQ/ZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lIT09IkhUTUwiOmZhbHNlO307c2V0RG9jdW1lbnQ9U2l6emxlLnNldERvY3VtZW50PWZ1bmN0aW9uKG5vZGUpe3ZhciBoYXNDb21wYXJlLGRvYz1ub2RlP25vZGUub3duZXJEb2N1bWVudHx8bm9kZTpwcmVmZXJyZWREb2MscGFyZW50PWRvYy5kZWZhdWx0VmlldztpZihkb2M9PT1kb2N1bWVudHx8ZG9jLm5vZGVUeXBlIT09OXx8IWRvYy5kb2N1bWVudEVsZW1lbnQpe3JldHVybiBkb2N1bWVudDt9CmRvY3VtZW50PWRvYztkb2NFbGVtPWRvYy5kb2N1bWVudEVsZW1lbnQ7ZG9jdW1lbnRJc0hUTUw9IWlzWE1MKGRvYyk7aWYocGFyZW50JiZwYXJlbnQhPT1wYXJlbnQudG9wKXtpZihwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcil7cGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoInVubG9hZCIsZnVuY3Rpb24oKXtzZXREb2N1bWVudCgpO30sZmFsc2UpO31lbHNlIGlmKHBhcmVudC5hdHRhY2hFdmVudCl7cGFyZW50LmF0dGFjaEV2ZW50KCJvbnVubG9hZCIsZnVuY3Rpb24oKXtzZXREb2N1bWVudCgpO30pO319CnN1cHBvcnQuYXR0cmlidXRlcz1hc3NlcnQoZnVuY3Rpb24oZGl2KXtkaXYuY2xhc3NOYW1lPSJpIjtyZXR1cm4hZGl2LmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIik7fSk7c3VwcG9ydC5nZXRFbGVtZW50c0J5VGFnTmFtZT1hc3NlcnQoZnVuY3Rpb24oZGl2KXtkaXYuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZUNvbW1lbnQoIiIpKTtyZXR1cm4hZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RoO30pO3N1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT1ybmF0aXZlLnRlc3QoZG9jLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpJiZhc3NlcnQoZnVuY3Rpb24oZGl2KXtkaXYuaW5uZXJIVE1MPSI8ZGl2IGNsYXNzPSdhJz48L2Rpdj48ZGl2IGNsYXNzPSdhIGknPjwvZGl2PiI7ZGl2LmZpcnN0Q2hpbGQuY2xhc3NOYW1lPSJpIjtyZXR1cm4gZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImkiKS5sZW5ndGg9PT0yO30pO3N1cHBvcnQuZ2V0QnlJZD1hc3NlcnQoZnVuY3Rpb24oZGl2KXtkb2NFbGVtLmFwcGVuZENoaWxkKGRpdikuaWQ9ZXhwYW5kbztyZXR1cm4hZG9jLmdldEVsZW1lbnRzQnlOYW1lfHwhZG9jLmdldEVsZW1lbnRzQnlOYW1lKGV4cGFuZG8pLmxlbmd0aDt9KTtpZihzdXBwb3J0LmdldEJ5SWQpe0V4cHIuZmluZFsiSUQiXT1mdW5jdGlvbihpZCxjb250ZXh0KXtpZih0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50QnlJZCE9PXN0cnVuZGVmaW5lZCYmZG9jdW1lbnRJc0hUTUwpe3ZhciBtPWNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoaWQpO3JldHVybiBtJiZtLnBhcmVudE5vZGU/W21dOltdO319O0V4cHIuZmlsdGVyWyJJRCJdPWZ1bmN0aW9uKGlkKXt2YXIgYXR0cklkPWlkLnJlcGxhY2UocnVuZXNjYXBlLGZ1bmVzY2FwZSk7cmV0dXJuIGZ1bmN0aW9uKGVsZW0pe3JldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgiaWQiKT09PWF0dHJJZDt9O307fWVsc2V7ZGVsZXRlIEV4cHIuZmluZFsiSUQiXTtFeHByLmZpbHRlclsiSUQiXT1mdW5jdGlvbihpZCl7dmFyIGF0dHJJZD1pZC5yZXBsYWNlKHJ1bmVzY2FwZSxmdW5lc2NhcGUpO3JldHVybiBmdW5jdGlvbihlbGVtKXt2YXIgbm9kZT10eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlIT09c3RydW5kZWZpbmVkJiZlbGVtLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7cmV0dXJuIG5vZGUmJm5vZGUudmFsdWU9PT1hdHRySWQ7fTt9O30KRXhwci5maW5kWyJUQUciXT1zdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lP2Z1bmN0aW9uKHRhZyxjb250ZXh0KXtpZih0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSE9PXN0cnVuZGVmaW5lZCl7cmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnKTt9fTpmdW5jdGlvbih0YWcsY29udGV4dCl7dmFyIGVsZW0sdG1wPVtdLGk9MCxyZXN1bHRzPWNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnKTtpZih0YWc9PT0iKiIpe3doaWxlKChlbGVtPXJlc3VsdHNbaSsrXSkpe2lmKGVsZW0ubm9kZVR5cGU9PT0xKXt0bXAucHVzaChlbGVtKTt9fQpyZXR1cm4gdG1wO30KcmV0dXJuIHJlc3VsdHM7fTtFeHByLmZpbmRbIkNMQVNTIl09c3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZmdW5jdGlvbihjbGFzc05hbWUsY29udGV4dCl7aWYodHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSE9PXN0cnVuZGVmaW5lZCYmZG9jdW1lbnRJc0hUTUwpe3JldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoY2xhc3NOYW1lKTt9fTtyYnVnZ3lNYXRjaGVzPVtdO3JidWdneVFTQT1bXTtpZigoc3VwcG9ydC5xc2E9cm5hdGl2ZS50ZXN0KGRvYy5xdWVyeVNlbGVjdG9yQWxsKSkpe2Fzc2VydChmdW5jdGlvbihkaXYpe2Rpdi5pbm5lckhUTUw9IjxzZWxlY3QgdD0nJz48b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PiI7aWYoZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIlt0Xj0nJ10iKS5sZW5ndGgpe3JidWdneVFTQS5wdXNoKCJbKl4kXT0iK3doaXRlc3BhY2UrIiooPzonJ3xcIlwiKSIpO30KaWYoIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RoKXtyYnVnZ3lRU0EucHVzaCgiXFxbIit3aGl0ZXNwYWNlKyIqKD86dmFsdWV8Iitib29sZWFucysiKSIpO30KaWYoIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aCl7cmJ1Z2d5UVNBLnB1c2goIjpjaGVja2VkIik7fX0pO2Fzc2VydChmdW5jdGlvbihkaXYpe3ZhciBpbnB1dD1kb2MuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTtpbnB1dC5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKTtkaXYuYXBwZW5kQ2hpbGQoaW5wdXQpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKTtpZihkaXYucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9ZF0iKS5sZW5ndGgpe3JidWdneVFTQS5wdXNoKCJuYW1lIit3aGl0ZXNwYWNlKyIqWypeJHwhfl0/PSIpO30KaWYoIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aCl7cmJ1Z2d5UVNBLnB1c2goIjplbmFibGVkIiwiOmRpc2FibGVkIik7fQpkaXYucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpO3JidWdneVFTQS5wdXNoKCIsLio6Iik7fSk7fQppZigoc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3I9cm5hdGl2ZS50ZXN0KChtYXRjaGVzPWRvY0VsZW0ud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxkb2NFbGVtLm1vek1hdGNoZXNTZWxlY3Rvcnx8ZG9jRWxlbS5vTWF0Y2hlc1NlbGVjdG9yfHxkb2NFbGVtLm1zTWF0Y2hlc1NlbGVjdG9yKSkpKXthc3NlcnQoZnVuY3Rpb24oZGl2KXtzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoPW1hdGNoZXMuY2FsbChkaXYsImRpdiIpO21hdGNoZXMuY2FsbChkaXYsIltzIT0nJ106eCIpO3JidWdneU1hdGNoZXMucHVzaCgiIT0iLHBzZXVkb3MpO30pO30KcmJ1Z2d5UVNBPXJidWdneVFTQS5sZW5ndGgmJm5ldyBSZWdFeHAocmJ1Z2d5UVNBLmpvaW4oInwiKSk7cmJ1Z2d5TWF0Y2hlcz1yYnVnZ3lNYXRjaGVzLmxlbmd0aCYmbmV3IFJlZ0V4cChyYnVnZ3lNYXRjaGVzLmpvaW4oInwiKSk7aGFzQ29tcGFyZT1ybmF0aXZlLnRlc3QoZG9jRWxlbS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbik7Y29udGFpbnM9aGFzQ29tcGFyZXx8cm5hdGl2ZS50ZXN0KGRvY0VsZW0uY29udGFpbnMpP2Z1bmN0aW9uKGEsYil7dmFyIGFkb3duPWEubm9kZVR5cGU9PT05P2EuZG9jdW1lbnRFbGVtZW50OmEsYnVwPWImJmIucGFyZW50Tm9kZTtyZXR1cm4gYT09PWJ1cHx8ISEoYnVwJiZidXAubm9kZVR5cGU9PT0xJiYoYWRvd24uY29udGFpbnM/YWRvd24uY29udGFpbnMoYnVwKTphLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiZhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGJ1cCkmMTYpKTt9OmZ1bmN0aW9uKGEsYil7aWYoYil7d2hpbGUoKGI9Yi5wYXJlbnROb2RlKSl7aWYoYj09PWEpe3JldHVybiB0cnVlO319fQpyZXR1cm4gZmFsc2U7fTtzb3J0T3JkZXI9aGFzQ29tcGFyZT9mdW5jdGlvbihhLGIpe2lmKGE9PT1iKXtoYXNEdXBsaWNhdGU9dHJ1ZTtyZXR1cm4gMDt9CnZhciBjb21wYXJlPSFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uLSFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO2lmKGNvbXBhcmUpe3JldHVybiBjb21wYXJlO30KY29tcGFyZT0oYS5vd25lckRvY3VtZW50fHxhKT09PShiLm93bmVyRG9jdW1lbnR8fGIpP2EuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYik6MTtpZihjb21wYXJlJjF8fCghc3VwcG9ydC5zb3J0RGV0YWNoZWQmJmIuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYSk9PT1jb21wYXJlKSl7aWYoYT09PWRvY3x8YS5vd25lckRvY3VtZW50PT09cHJlZmVycmVkRG9jJiZjb250YWlucyhwcmVmZXJyZWREb2MsYSkpe3JldHVybi0xO30KaWYoYj09PWRvY3x8Yi5vd25lckRvY3VtZW50PT09cHJlZmVycmVkRG9jJiZjb250YWlucyhwcmVmZXJyZWREb2MsYikpe3JldHVybiAxO30KcmV0dXJuIHNvcnRJbnB1dD8oaW5kZXhPZi5jYWxsKHNvcnRJbnB1dCxhKS1pbmRleE9mLmNhbGwoc29ydElucHV0LGIpKTowO30KcmV0dXJuIGNvbXBhcmUmND8tMToxO306ZnVuY3Rpb24oYSxiKXtpZihhPT09Yil7aGFzRHVwbGljYXRlPXRydWU7cmV0dXJuIDA7fQp2YXIgY3VyLGk9MCxhdXA9YS5wYXJlbnROb2RlLGJ1cD1iLnBhcmVudE5vZGUsYXA9W2FdLGJwPVtiXTtpZighYXVwfHwhYnVwKXtyZXR1cm4gYT09PWRvYz8tMTpiPT09ZG9jPzE6YXVwPy0xOmJ1cD8xOnNvcnRJbnB1dD8oaW5kZXhPZi5jYWxsKHNvcnRJbnB1dCxhKS1pbmRleE9mLmNhbGwoc29ydElucHV0LGIpKTowO31lbHNlIGlmKGF1cD09PWJ1cCl7cmV0dXJuIHNpYmxpbmdDaGVjayhhLGIpO30KY3VyPWE7d2hpbGUoKGN1cj1jdXIucGFyZW50Tm9kZSkpe2FwLnVuc2hpZnQoY3VyKTt9CmN1cj1iO3doaWxlKChjdXI9Y3VyLnBhcmVudE5vZGUpKXticC51bnNoaWZ0KGN1cik7fQp3aGlsZShhcFtpXT09PWJwW2ldKXtpKys7fQpyZXR1cm4gaT9zaWJsaW5nQ2hlY2soYXBbaV0sYnBbaV0pOmFwW2ldPT09cHJlZmVycmVkRG9jPy0xOmJwW2ldPT09cHJlZmVycmVkRG9jPzE6MDt9O3JldHVybiBkb2M7fTtTaXp6bGUubWF0Y2hlcz1mdW5jdGlvbihleHByLGVsZW1lbnRzKXtyZXR1cm4gU2l6emxlKGV4cHIsbnVsbCxudWxsLGVsZW1lbnRzKTt9O1NpenpsZS5tYXRjaGVzU2VsZWN0b3I9ZnVuY3Rpb24oZWxlbSxleHByKXtpZigoZWxlbS5vd25lckRvY3VtZW50fHxlbGVtKSE9PWRvY3VtZW50KXtzZXREb2N1bWVudChlbGVtKTt9CmV4cHI9ZXhwci5yZXBsYWNlKHJhdHRyaWJ1dGVRdW90ZXMsIj0nJDEnXSIpO2lmKHN1cHBvcnQubWF0Y2hlc1NlbGVjdG9yJiZkb2N1bWVudElzSFRNTCYmKCFyYnVnZ3lNYXRjaGVzfHwhcmJ1Z2d5TWF0Y2hlcy50ZXN0KGV4cHIpKSYmKCFyYnVnZ3lRU0F8fCFyYnVnZ3lRU0EudGVzdChleHByKSkpe3RyeXt2YXIgcmV0PW1hdGNoZXMuY2FsbChlbGVtLGV4cHIpO2lmKHJldHx8c3VwcG9ydC5kaXNjb25uZWN0ZWRNYXRjaHx8ZWxlbS5kb2N1bWVudCYmZWxlbS5kb2N1bWVudC5ub2RlVHlwZSE9PTExKXtyZXR1cm4gcmV0O319Y2F0Y2goZSl7fX0KcmV0dXJuIFNpenpsZShleHByLGRvY3VtZW50LG51bGwsW2VsZW1dKS5sZW5ndGg+MDt9O1NpenpsZS5jb250YWlucz1mdW5jdGlvbihjb250ZXh0LGVsZW0pe2lmKChjb250ZXh0Lm93bmVyRG9jdW1lbnR8fGNvbnRleHQpIT09ZG9jdW1lbnQpe3NldERvY3VtZW50KGNvbnRleHQpO30KcmV0dXJuIGNvbnRhaW5zKGNvbnRleHQsZWxlbSk7fTtTaXp6bGUuYXR0cj1mdW5jdGlvbihlbGVtLG5hbWUpe2lmKChlbGVtLm93bmVyRG9jdW1lbnR8fGVsZW0pIT09ZG9jdW1lbnQpe3NldERvY3VtZW50KGVsZW0pO30KdmFyIGZuPUV4cHIuYXR0ckhhbmRsZVtuYW1lLnRvTG93ZXJDYXNlKCldLHZhbD1mbiYmaGFzT3duLmNhbGwoRXhwci5hdHRySGFuZGxlLG5hbWUudG9Mb3dlckNhc2UoKSk/Zm4oZWxlbSxuYW1lLCFkb2N1bWVudElzSFRNTCk6dW5kZWZpbmVkO3JldHVybiB2YWwhPT11bmRlZmluZWQ/dmFsOnN1cHBvcnQuYXR0cmlidXRlc3x8IWRvY3VtZW50SXNIVE1MP2VsZW0uZ2V0QXR0cmlidXRlKG5hbWUpOih2YWw9ZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKG5hbWUpKSYmdmFsLnNwZWNpZmllZD92YWwudmFsdWU6bnVsbDt9O1NpenpsZS5lcnJvcj1mdW5jdGlvbihtc2cpe3Rocm93IG5ldyBFcnJvcigiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIittc2cpO307U2l6emxlLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24ocmVzdWx0cyl7dmFyIGVsZW0sZHVwbGljYXRlcz1bXSxqPTAsaT0wO2hhc0R1cGxpY2F0ZT0hc3VwcG9ydC5kZXRlY3REdXBsaWNhdGVzO3NvcnRJbnB1dD0hc3VwcG9ydC5zb3J0U3RhYmxlJiZyZXN1bHRzLnNsaWNlKDApO3Jlc3VsdHMuc29ydChzb3J0T3JkZXIpO2lmKGhhc0R1cGxpY2F0ZSl7d2hpbGUoKGVsZW09cmVzdWx0c1tpKytdKSl7aWYoZWxlbT09PXJlc3VsdHNbaV0pe2o9ZHVwbGljYXRlcy5wdXNoKGkpO319CndoaWxlKGotLSl7cmVzdWx0cy5zcGxpY2UoZHVwbGljYXRlc1tqXSwxKTt9fQpzb3J0SW5wdXQ9bnVsbDtyZXR1cm4gcmVzdWx0czt9O2dldFRleHQ9U2l6emxlLmdldFRleHQ9ZnVuY3Rpb24oZWxlbSl7dmFyIG5vZGUscmV0PSIiLGk9MCxub2RlVHlwZT1lbGVtLm5vZGVUeXBlO2lmKCFub2RlVHlwZSl7d2hpbGUoKG5vZGU9ZWxlbVtpKytdKSl7cmV0Kz1nZXRUZXh0KG5vZGUpO319ZWxzZSBpZihub2RlVHlwZT09PTF8fG5vZGVUeXBlPT09OXx8bm9kZVR5cGU9PT0xMSl7aWYodHlwZW9mIGVsZW0udGV4dENvbnRlbnQ9PT0ic3RyaW5nIil7cmV0dXJuIGVsZW0udGV4dENvbnRlbnQ7fWVsc2V7Zm9yKGVsZW09ZWxlbS5maXJzdENoaWxkO2VsZW07ZWxlbT1lbGVtLm5leHRTaWJsaW5nKXtyZXQrPWdldFRleHQoZWxlbSk7fX19ZWxzZSBpZihub2RlVHlwZT09PTN8fG5vZGVUeXBlPT09NCl7cmV0dXJuIGVsZW0ubm9kZVZhbHVlO30KcmV0dXJuIHJldDt9O0V4cHI9U2l6emxlLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOm1hcmtGdW5jdGlvbixtYXRjaDptYXRjaEV4cHIsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6dHJ1ZX0sIiAiOntkaXI6InBhcmVudE5vZGUifSwiKyI6e2RpcjoicHJldmlvdXNTaWJsaW5nIixmaXJzdDp0cnVlfSwifiI6e2RpcjoicHJldmlvdXNTaWJsaW5nIn19LHByZUZpbHRlcjp7IkFUVFIiOmZ1bmN0aW9uKG1hdGNoKXttYXRjaFsxXT1tYXRjaFsxXS5yZXBsYWNlKHJ1bmVzY2FwZSxmdW5lc2NhcGUpO21hdGNoWzNdPShtYXRjaFs0XXx8bWF0Y2hbNV18fCIiKS5yZXBsYWNlKHJ1bmVzY2FwZSxmdW5lc2NhcGUpO2lmKG1hdGNoWzJdPT09In49Iil7bWF0Y2hbM109IiAiK21hdGNoWzNdKyIgIjt9CnJldHVybiBtYXRjaC5zbGljZSgwLDQpO30sIkNISUxEIjpmdW5jdGlvbihtYXRjaCl7bWF0Y2hbMV09bWF0Y2hbMV0udG9Mb3dlckNhc2UoKTtpZihtYXRjaFsxXS5zbGljZSgwLDMpPT09Im50aCIpe2lmKCFtYXRjaFszXSl7U2l6emxlLmVycm9yKG1hdGNoWzBdKTt9Cm1hdGNoWzRdPSsobWF0Y2hbNF0/bWF0Y2hbNV0rKG1hdGNoWzZdfHwxKToyKihtYXRjaFszXT09PSJldmVuInx8bWF0Y2hbM109PT0ib2RkIikpO21hdGNoWzVdPSsoKG1hdGNoWzddK21hdGNoWzhdKXx8bWF0Y2hbM109PT0ib2RkIik7fWVsc2UgaWYobWF0Y2hbM10pe1NpenpsZS5lcnJvcihtYXRjaFswXSk7fQpyZXR1cm4gbWF0Y2g7fSwiUFNFVURPIjpmdW5jdGlvbihtYXRjaCl7dmFyIGV4Y2Vzcyx1bnF1b3RlZD0hbWF0Y2hbNV0mJm1hdGNoWzJdO2lmKG1hdGNoRXhwclsiQ0hJTEQiXS50ZXN0KG1hdGNoWzBdKSl7cmV0dXJuIG51bGw7fQppZihtYXRjaFszXSYmbWF0Y2hbNF0hPT11bmRlZmluZWQpe21hdGNoWzJdPW1hdGNoWzRdO31lbHNlIGlmKHVucXVvdGVkJiZycHNldWRvLnRlc3QodW5xdW90ZWQpJiYoZXhjZXNzPXRva2VuaXplKHVucXVvdGVkLHRydWUpKSYmKGV4Y2Vzcz11bnF1b3RlZC5pbmRleE9mKCIpIix1bnF1b3RlZC5sZW5ndGgtZXhjZXNzKS11bnF1b3RlZC5sZW5ndGgpKXttYXRjaFswXT1tYXRjaFswXS5zbGljZSgwLGV4Y2Vzcyk7bWF0Y2hbMl09dW5xdW90ZWQuc2xpY2UoMCxleGNlc3MpO30KcmV0dXJuIG1hdGNoLnNsaWNlKDAsMyk7fX0sZmlsdGVyOnsiVEFHIjpmdW5jdGlvbihub2RlTmFtZVNlbGVjdG9yKXt2YXIgbm9kZU5hbWU9bm9kZU5hbWVTZWxlY3Rvci5yZXBsYWNlKHJ1bmVzY2FwZSxmdW5lc2NhcGUpLnRvTG93ZXJDYXNlKCk7cmV0dXJuIG5vZGVOYW1lU2VsZWN0b3I9PT0iKiI/ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9OmZ1bmN0aW9uKGVsZW0pe3JldHVybiBlbGVtLm5vZGVOYW1lJiZlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1ub2RlTmFtZTt9O30sIkNMQVNTIjpmdW5jdGlvbihjbGFzc05hbWUpe3ZhciBwYXR0ZXJuPWNsYXNzQ2FjaGVbY2xhc3NOYW1lKyIgIl07cmV0dXJuIHBhdHRlcm58fChwYXR0ZXJuPW5ldyBSZWdFeHAoIihefCIrd2hpdGVzcGFjZSsiKSIrY2xhc3NOYW1lKyIoIit3aGl0ZXNwYWNlKyJ8JCkiKSkmJmNsYXNzQ2FjaGUoY2xhc3NOYW1lLGZ1bmN0aW9uKGVsZW0pe3JldHVybiBwYXR0ZXJuLnRlc3QodHlwZW9mIGVsZW0uY2xhc3NOYW1lPT09InN0cmluZyImJmVsZW0uY2xhc3NOYW1lfHx0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGUhPT1zdHJ1bmRlZmluZWQmJmVsZW0uZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIik7fSk7fSwiQVRUUiI6ZnVuY3Rpb24obmFtZSxvcGVyYXRvcixjaGVjayl7cmV0dXJuIGZ1bmN0aW9uKGVsZW0pe3ZhciByZXN1bHQ9U2l6emxlLmF0dHIoZWxlbSxuYW1lKTtpZihyZXN1bHQ9PW51bGwpe3JldHVybiBvcGVyYXRvcj09PSIhPSI7fQppZighb3BlcmF0b3Ipe3JldHVybiB0cnVlO30KcmVzdWx0Kz0iIjtyZXR1cm4gb3BlcmF0b3I9PT0iPSI/cmVzdWx0PT09Y2hlY2s6b3BlcmF0b3I9PT0iIT0iP3Jlc3VsdCE9PWNoZWNrOm9wZXJhdG9yPT09Il49Ij9jaGVjayYmcmVzdWx0LmluZGV4T2YoY2hlY2spPT09MDpvcGVyYXRvcj09PSIqPSI/Y2hlY2smJnJlc3VsdC5pbmRleE9mKGNoZWNrKT4tMTpvcGVyYXRvcj09PSIkPSI/Y2hlY2smJnJlc3VsdC5zbGljZSgtY2hlY2subGVuZ3RoKT09PWNoZWNrOm9wZXJhdG9yPT09In49Ij8oIiAiK3Jlc3VsdCsiICIpLmluZGV4T2YoY2hlY2spPi0xOm9wZXJhdG9yPT09Inw9Ij9yZXN1bHQ9PT1jaGVja3x8cmVzdWx0LnNsaWNlKDAsY2hlY2subGVuZ3RoKzEpPT09Y2hlY2srIi0iOmZhbHNlO307fSwiQ0hJTEQiOmZ1bmN0aW9uKHR5cGUsd2hhdCxhcmd1bWVudCxmaXJzdCxsYXN0KXt2YXIgc2ltcGxlPXR5cGUuc2xpY2UoMCwzKSE9PSJudGgiLGZvcndhcmQ9dHlwZS5zbGljZSgtNCkhPT0ibGFzdCIsb2ZUeXBlPXdoYXQ9PT0ib2YtdHlwZSI7cmV0dXJuIGZpcnN0PT09MSYmbGFzdD09PTA/ZnVuY3Rpb24oZWxlbSl7cmV0dXJuISFlbGVtLnBhcmVudE5vZGU7fTpmdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXt2YXIgY2FjaGUsb3V0ZXJDYWNoZSxub2RlLGRpZmYsbm9kZUluZGV4LHN0YXJ0LGRpcj1zaW1wbGUhPT1mb3J3YXJkPyJuZXh0U2libGluZyI6InByZXZpb3VzU2libGluZyIscGFyZW50PWVsZW0ucGFyZW50Tm9kZSxuYW1lPW9mVHlwZSYmZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLHVzZUNhY2hlPSF4bWwmJiFvZlR5cGU7aWYocGFyZW50KXtpZihzaW1wbGUpe3doaWxlKGRpcil7bm9kZT1lbGVtO3doaWxlKChub2RlPW5vZGVbZGlyXSkpe2lmKG9mVHlwZT9ub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1uYW1lOm5vZGUubm9kZVR5cGU9PT0xKXtyZXR1cm4gZmFsc2U7fX0Kc3RhcnQ9ZGlyPXR5cGU9PT0ib25seSImJiFzdGFydCYmIm5leHRTaWJsaW5nIjt9CnJldHVybiB0cnVlO30Kc3RhcnQ9W2ZvcndhcmQ/cGFyZW50LmZpcnN0Q2hpbGQ6cGFyZW50Lmxhc3RDaGlsZF07aWYoZm9yd2FyZCYmdXNlQ2FjaGUpe291dGVyQ2FjaGU9cGFyZW50W2V4cGFuZG9dfHwocGFyZW50W2V4cGFuZG9dPXt9KTtjYWNoZT1vdXRlckNhY2hlW3R5cGVdfHxbXTtub2RlSW5kZXg9Y2FjaGVbMF09PT1kaXJydW5zJiZjYWNoZVsxXTtkaWZmPWNhY2hlWzBdPT09ZGlycnVucyYmY2FjaGVbMl07bm9kZT1ub2RlSW5kZXgmJnBhcmVudC5jaGlsZE5vZGVzW25vZGVJbmRleF07d2hpbGUoKG5vZGU9Kytub2RlSW5kZXgmJm5vZGUmJm5vZGVbZGlyXXx8KGRpZmY9bm9kZUluZGV4PTApfHxzdGFydC5wb3AoKSkpe2lmKG5vZGUubm9kZVR5cGU9PT0xJiYrK2RpZmYmJm5vZGU9PT1lbGVtKXtvdXRlckNhY2hlW3R5cGVdPVtkaXJydW5zLG5vZGVJbmRleCxkaWZmXTticmVhazt9fX1lbHNlIGlmKHVzZUNhY2hlJiYoY2FjaGU9KGVsZW1bZXhwYW5kb118fChlbGVtW2V4cGFuZG9dPXt9KSlbdHlwZV0pJiZjYWNoZVswXT09PWRpcnJ1bnMpe2RpZmY9Y2FjaGVbMV07fWVsc2V7d2hpbGUoKG5vZGU9Kytub2RlSW5kZXgmJm5vZGUmJm5vZGVbZGlyXXx8KGRpZmY9bm9kZUluZGV4PTApfHxzdGFydC5wb3AoKSkpe2lmKChvZlR5cGU/bm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09bmFtZTpub2RlLm5vZGVUeXBlPT09MSkmJisrZGlmZil7aWYodXNlQ2FjaGUpeyhub2RlW2V4cGFuZG9dfHwobm9kZVtleHBhbmRvXT17fSkpW3R5cGVdPVtkaXJydW5zLGRpZmZdO30KaWYobm9kZT09PWVsZW0pe2JyZWFrO319fX0KZGlmZi09bGFzdDtyZXR1cm4gZGlmZj09PWZpcnN0fHwoZGlmZiVmaXJzdD09PTAmJmRpZmYvZmlyc3Q+PTApO319O30sIlBTRVVETyI6ZnVuY3Rpb24ocHNldWRvLGFyZ3VtZW50KXt2YXIgYXJncyxmbj1FeHByLnBzZXVkb3NbcHNldWRvXXx8RXhwci5zZXRGaWx0ZXJzW3BzZXVkby50b0xvd2VyQ2FzZSgpXXx8U2l6emxlLmVycm9yKCJ1bnN1cHBvcnRlZCBwc2V1ZG86ICIrcHNldWRvKTtpZihmbltleHBhbmRvXSl7cmV0dXJuIGZuKGFyZ3VtZW50KTt9CmlmKGZuLmxlbmd0aD4xKXthcmdzPVtwc2V1ZG8scHNldWRvLCIiLGFyZ3VtZW50XTtyZXR1cm4gRXhwci5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KHBzZXVkby50b0xvd2VyQ2FzZSgpKT9tYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VlZCxtYXRjaGVzKXt2YXIgaWR4LG1hdGNoZWQ9Zm4oc2VlZCxhcmd1bWVudCksaT1tYXRjaGVkLmxlbmd0aDt3aGlsZShpLS0pe2lkeD1pbmRleE9mLmNhbGwoc2VlZCxtYXRjaGVkW2ldKTtzZWVkW2lkeF09IShtYXRjaGVzW2lkeF09bWF0Y2hlZFtpXSk7fX0pOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBmbihlbGVtLDAsYXJncyk7fTt9CnJldHVybiBmbjt9fSxwc2V1ZG9zOnsibm90IjptYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VsZWN0b3Ipe3ZhciBpbnB1dD1bXSxyZXN1bHRzPVtdLG1hdGNoZXI9Y29tcGlsZShzZWxlY3Rvci5yZXBsYWNlKHJ0cmltLCIkMSIpKTtyZXR1cm4gbWF0Y2hlcltleHBhbmRvXT9tYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VlZCxtYXRjaGVzLGNvbnRleHQseG1sKXt2YXIgZWxlbSx1bm1hdGNoZWQ9bWF0Y2hlcihzZWVkLG51bGwseG1sLFtdKSxpPXNlZWQubGVuZ3RoO3doaWxlKGktLSl7aWYoKGVsZW09dW5tYXRjaGVkW2ldKSl7c2VlZFtpXT0hKG1hdGNoZXNbaV09ZWxlbSk7fX19KTpmdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXtpbnB1dFswXT1lbGVtO21hdGNoZXIoaW5wdXQsbnVsbCx4bWwscmVzdWx0cyk7cmV0dXJuIXJlc3VsdHMucG9wKCk7fTt9KSwiaGFzIjptYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VsZWN0b3Ipe3JldHVybiBmdW5jdGlvbihlbGVtKXtyZXR1cm4gU2l6emxlKHNlbGVjdG9yLGVsZW0pLmxlbmd0aD4wO307fSksImNvbnRhaW5zIjptYXJrRnVuY3Rpb24oZnVuY3Rpb24odGV4dCl7cmV0dXJuIGZ1bmN0aW9uKGVsZW0pe3JldHVybihlbGVtLnRleHRDb250ZW50fHxlbGVtLmlubmVyVGV4dHx8Z2V0VGV4dChlbGVtKSkuaW5kZXhPZih0ZXh0KT4tMTt9O30pLCJsYW5nIjptYXJrRnVuY3Rpb24oZnVuY3Rpb24obGFuZyl7aWYoIXJpZGVudGlmaWVyLnRlc3QobGFuZ3x8IiIpKXtTaXp6bGUuZXJyb3IoInVuc3VwcG9ydGVkIGxhbmc6ICIrbGFuZyk7fQpsYW5nPWxhbmcucmVwbGFjZShydW5lc2NhcGUsZnVuZXNjYXBlKS50b0xvd2VyQ2FzZSgpO3JldHVybiBmdW5jdGlvbihlbGVtKXt2YXIgZWxlbUxhbmc7ZG97aWYoKGVsZW1MYW5nPWRvY3VtZW50SXNIVE1MP2VsZW0ubGFuZzplbGVtLmdldEF0dHJpYnV0ZSgieG1sOmxhbmciKXx8ZWxlbS5nZXRBdHRyaWJ1dGUoImxhbmciKSkpe2VsZW1MYW5nPWVsZW1MYW5nLnRvTG93ZXJDYXNlKCk7cmV0dXJuIGVsZW1MYW5nPT09bGFuZ3x8ZWxlbUxhbmcuaW5kZXhPZihsYW5nKyItIik9PT0wO319d2hpbGUoKGVsZW09ZWxlbS5wYXJlbnROb2RlKSYmZWxlbS5ub2RlVHlwZT09PTEpO3JldHVybiBmYWxzZTt9O30pLCJ0YXJnZXQiOmZ1bmN0aW9uKGVsZW0pe3ZhciBoYXNoPXdpbmRvdy5sb2NhdGlvbiYmd2luZG93LmxvY2F0aW9uLmhhc2g7cmV0dXJuIGhhc2gmJmhhc2guc2xpY2UoMSk9PT1lbGVtLmlkO30sInJvb3QiOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBlbGVtPT09ZG9jRWxlbTt9LCJmb2N1cyI6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGVsZW09PT1kb2N1bWVudC5hY3RpdmVFbGVtZW50JiYoIWRvY3VtZW50Lmhhc0ZvY3VzfHxkb2N1bWVudC5oYXNGb2N1cygpKSYmISEoZWxlbS50eXBlfHxlbGVtLmhyZWZ8fH5lbGVtLnRhYkluZGV4KTt9LCJlbmFibGVkIjpmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5kaXNhYmxlZD09PWZhbHNlO30sImRpc2FibGVkIjpmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5kaXNhYmxlZD09PXRydWU7fSwiY2hlY2tlZCI6ZnVuY3Rpb24oZWxlbSl7dmFyIG5vZGVOYW1lPWVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4obm9kZU5hbWU9PT0iaW5wdXQiJiYhIWVsZW0uY2hlY2tlZCl8fChub2RlTmFtZT09PSJvcHRpb24iJiYhIWVsZW0uc2VsZWN0ZWQpO30sInNlbGVjdGVkIjpmdW5jdGlvbihlbGVtKXtpZihlbGVtLnBhcmVudE5vZGUpe2VsZW0ucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4O30KcmV0dXJuIGVsZW0uc2VsZWN0ZWQ9PT10cnVlO30sImVtcHR5IjpmdW5jdGlvbihlbGVtKXtmb3IoZWxlbT1lbGVtLmZpcnN0Q2hpbGQ7ZWxlbTtlbGVtPWVsZW0ubmV4dFNpYmxpbmcpe2lmKGVsZW0ubm9kZVR5cGU8Nil7cmV0dXJuIGZhbHNlO319CnJldHVybiB0cnVlO30sInBhcmVudCI6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIUV4cHIucHNldWRvc1siZW1wdHkiXShlbGVtKTt9LCJoZWFkZXIiOmZ1bmN0aW9uKGVsZW0pe3JldHVybiByaGVhZGVyLnRlc3QoZWxlbS5ub2RlTmFtZSk7fSwiaW5wdXQiOmZ1bmN0aW9uKGVsZW0pe3JldHVybiByaW5wdXRzLnRlc3QoZWxlbS5ub2RlTmFtZSk7fSwiYnV0dG9uIjpmdW5jdGlvbihlbGVtKXt2YXIgbmFtZT1lbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuIG5hbWU9PT0iaW5wdXQiJiZlbGVtLnR5cGU9PT0iYnV0dG9uInx8bmFtZT09PSJidXR0b24iO30sInRleHQiOmZ1bmN0aW9uKGVsZW0pe3ZhciBhdHRyO3JldHVybiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT0iaW5wdXQiJiZlbGVtLnR5cGU9PT0idGV4dCImJigoYXR0cj1lbGVtLmdldEF0dHJpYnV0ZSgidHlwZSIpKT09bnVsbHx8YXR0ci50b0xvd2VyQ2FzZSgpPT09InRleHQiKTt9LCJmaXJzdCI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbigpe3JldHVyblswXTt9KSwibGFzdCI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsbGVuZ3RoKXtyZXR1cm5bbGVuZ3RoLTFdO30pLCJlcSI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsbGVuZ3RoLGFyZ3VtZW50KXtyZXR1cm5bYXJndW1lbnQ8MD9hcmd1bWVudCtsZW5ndGg6YXJndW1lbnRdO30pLCJldmVuIjpjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKG1hdGNoSW5kZXhlcyxsZW5ndGgpe3ZhciBpPTA7Zm9yKDtpPGxlbmd0aDtpKz0yKXttYXRjaEluZGV4ZXMucHVzaChpKTt9CnJldHVybiBtYXRjaEluZGV4ZXM7fSksIm9kZCI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsbGVuZ3RoKXt2YXIgaT0xO2Zvcig7aTxsZW5ndGg7aSs9Mil7bWF0Y2hJbmRleGVzLnB1c2goaSk7fQpyZXR1cm4gbWF0Y2hJbmRleGVzO30pLCJsdCI6Y3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsbGVuZ3RoLGFyZ3VtZW50KXt2YXIgaT1hcmd1bWVudDwwP2FyZ3VtZW50K2xlbmd0aDphcmd1bWVudDtmb3IoOy0taT49MDspe21hdGNoSW5kZXhlcy5wdXNoKGkpO30KcmV0dXJuIG1hdGNoSW5kZXhlczt9KSwiZ3QiOmNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24obWF0Y2hJbmRleGVzLGxlbmd0aCxhcmd1bWVudCl7dmFyIGk9YXJndW1lbnQ8MD9hcmd1bWVudCtsZW5ndGg6YXJndW1lbnQ7Zm9yKDsrK2k8bGVuZ3RoOyl7bWF0Y2hJbmRleGVzLnB1c2goaSk7fQpyZXR1cm4gbWF0Y2hJbmRleGVzO30pfX07RXhwci5wc2V1ZG9zWyJudGgiXT1FeHByLnBzZXVkb3NbImVxIl07Zm9yKGkgaW57cmFkaW86dHJ1ZSxjaGVja2JveDp0cnVlLGZpbGU6dHJ1ZSxwYXNzd29yZDp0cnVlLGltYWdlOnRydWV9KXtFeHByLnBzZXVkb3NbaV09Y3JlYXRlSW5wdXRQc2V1ZG8oaSk7fQpmb3IoaSBpbntzdWJtaXQ6dHJ1ZSxyZXNldDp0cnVlfSl7RXhwci5wc2V1ZG9zW2ldPWNyZWF0ZUJ1dHRvblBzZXVkbyhpKTt9CmZ1bmN0aW9uIHNldEZpbHRlcnMoKXt9CnNldEZpbHRlcnMucHJvdG90eXBlPUV4cHIuZmlsdGVycz1FeHByLnBzZXVkb3M7RXhwci5zZXRGaWx0ZXJzPW5ldyBzZXRGaWx0ZXJzKCk7ZnVuY3Rpb24gdG9rZW5pemUoc2VsZWN0b3IscGFyc2VPbmx5KXt2YXIgbWF0Y2hlZCxtYXRjaCx0b2tlbnMsdHlwZSxzb0Zhcixncm91cHMscHJlRmlsdGVycyxjYWNoZWQ9dG9rZW5DYWNoZVtzZWxlY3RvcisiICJdO2lmKGNhY2hlZCl7cmV0dXJuIHBhcnNlT25seT8wOmNhY2hlZC5zbGljZSgwKTt9CnNvRmFyPXNlbGVjdG9yO2dyb3Vwcz1bXTtwcmVGaWx0ZXJzPUV4cHIucHJlRmlsdGVyO3doaWxlKHNvRmFyKXtpZighbWF0Y2hlZHx8KG1hdGNoPXJjb21tYS5leGVjKHNvRmFyKSkpe2lmKG1hdGNoKXtzb0Zhcj1zb0Zhci5zbGljZShtYXRjaFswXS5sZW5ndGgpfHxzb0Zhcjt9Cmdyb3Vwcy5wdXNoKCh0b2tlbnM9W10pKTt9Cm1hdGNoZWQ9ZmFsc2U7aWYoKG1hdGNoPXJjb21iaW5hdG9ycy5leGVjKHNvRmFyKSkpe21hdGNoZWQ9bWF0Y2guc2hpZnQoKTt0b2tlbnMucHVzaCh7dmFsdWU6bWF0Y2hlZCx0eXBlOm1hdGNoWzBdLnJlcGxhY2UocnRyaW0sIiAiKX0pO3NvRmFyPXNvRmFyLnNsaWNlKG1hdGNoZWQubGVuZ3RoKTt9CmZvcih0eXBlIGluIEV4cHIuZmlsdGVyKXtpZigobWF0Y2g9bWF0Y2hFeHByW3R5cGVdLmV4ZWMoc29GYXIpKSYmKCFwcmVGaWx0ZXJzW3R5cGVdfHwobWF0Y2g9cHJlRmlsdGVyc1t0eXBlXShtYXRjaCkpKSl7bWF0Y2hlZD1tYXRjaC5zaGlmdCgpO3Rva2Vucy5wdXNoKHt2YWx1ZTptYXRjaGVkLHR5cGU6dHlwZSxtYXRjaGVzOm1hdGNofSk7c29GYXI9c29GYXIuc2xpY2UobWF0Y2hlZC5sZW5ndGgpO319CmlmKCFtYXRjaGVkKXticmVhazt9fQpyZXR1cm4gcGFyc2VPbmx5P3NvRmFyLmxlbmd0aDpzb0Zhcj9TaXp6bGUuZXJyb3Ioc2VsZWN0b3IpOnRva2VuQ2FjaGUoc2VsZWN0b3IsZ3JvdXBzKS5zbGljZSgwKTt9CmZ1bmN0aW9uIHRvU2VsZWN0b3IodG9rZW5zKXt2YXIgaT0wLGxlbj10b2tlbnMubGVuZ3RoLHNlbGVjdG9yPSIiO2Zvcig7aTxsZW47aSsrKXtzZWxlY3Rvcis9dG9rZW5zW2ldLnZhbHVlO30KcmV0dXJuIHNlbGVjdG9yO30KZnVuY3Rpb24gYWRkQ29tYmluYXRvcihtYXRjaGVyLGNvbWJpbmF0b3IsYmFzZSl7dmFyIGRpcj1jb21iaW5hdG9yLmRpcixjaGVja05vbkVsZW1lbnRzPWJhc2UmJmRpcj09PSJwYXJlbnROb2RlIixkb25lTmFtZT1kb25lKys7cmV0dXJuIGNvbWJpbmF0b3IuZmlyc3Q/ZnVuY3Rpb24oZWxlbSxjb250ZXh0LHhtbCl7d2hpbGUoKGVsZW09ZWxlbVtkaXJdKSl7aWYoZWxlbS5ub2RlVHlwZT09PTF8fGNoZWNrTm9uRWxlbWVudHMpe3JldHVybiBtYXRjaGVyKGVsZW0sY29udGV4dCx4bWwpO319fTpmdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXt2YXIgb2xkQ2FjaGUsb3V0ZXJDYWNoZSxuZXdDYWNoZT1bZGlycnVucyxkb25lTmFtZV07aWYoeG1sKXt3aGlsZSgoZWxlbT1lbGVtW2Rpcl0pKXtpZihlbGVtLm5vZGVUeXBlPT09MXx8Y2hlY2tOb25FbGVtZW50cyl7aWYobWF0Y2hlcihlbGVtLGNvbnRleHQseG1sKSl7cmV0dXJuIHRydWU7fX19fWVsc2V7d2hpbGUoKGVsZW09ZWxlbVtkaXJdKSl7aWYoZWxlbS5ub2RlVHlwZT09PTF8fGNoZWNrTm9uRWxlbWVudHMpe291dGVyQ2FjaGU9ZWxlbVtleHBhbmRvXXx8KGVsZW1bZXhwYW5kb109e30pO2lmKChvbGRDYWNoZT1vdXRlckNhY2hlW2Rpcl0pJiZvbGRDYWNoZVswXT09PWRpcnJ1bnMmJm9sZENhY2hlWzFdPT09ZG9uZU5hbWUpe3JldHVybihuZXdDYWNoZVsyXT1vbGRDYWNoZVsyXSk7fWVsc2V7b3V0ZXJDYWNoZVtkaXJdPW5ld0NhY2hlO2lmKChuZXdDYWNoZVsyXT1tYXRjaGVyKGVsZW0sY29udGV4dCx4bWwpKSl7cmV0dXJuIHRydWU7fX19fX19O30KZnVuY3Rpb24gZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpe3JldHVybiBtYXRjaGVycy5sZW5ndGg+MT9mdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXt2YXIgaT1tYXRjaGVycy5sZW5ndGg7d2hpbGUoaS0tKXtpZighbWF0Y2hlcnNbaV0oZWxlbSxjb250ZXh0LHhtbCkpe3JldHVybiBmYWxzZTt9fQpyZXR1cm4gdHJ1ZTt9Om1hdGNoZXJzWzBdO30KZnVuY3Rpb24gY29uZGVuc2UodW5tYXRjaGVkLG1hcCxmaWx0ZXIsY29udGV4dCx4bWwpe3ZhciBlbGVtLG5ld1VubWF0Y2hlZD1bXSxpPTAsbGVuPXVubWF0Y2hlZC5sZW5ndGgsbWFwcGVkPW1hcCE9bnVsbDtmb3IoO2k8bGVuO2krKyl7aWYoKGVsZW09dW5tYXRjaGVkW2ldKSl7aWYoIWZpbHRlcnx8ZmlsdGVyKGVsZW0sY29udGV4dCx4bWwpKXtuZXdVbm1hdGNoZWQucHVzaChlbGVtKTtpZihtYXBwZWQpe21hcC5wdXNoKGkpO319fX0KcmV0dXJuIG5ld1VubWF0Y2hlZDt9CmZ1bmN0aW9uIHNldE1hdGNoZXIocHJlRmlsdGVyLHNlbGVjdG9yLG1hdGNoZXIscG9zdEZpbHRlcixwb3N0RmluZGVyLHBvc3RTZWxlY3Rvcil7aWYocG9zdEZpbHRlciYmIXBvc3RGaWx0ZXJbZXhwYW5kb10pe3Bvc3RGaWx0ZXI9c2V0TWF0Y2hlcihwb3N0RmlsdGVyKTt9CmlmKHBvc3RGaW5kZXImJiFwb3N0RmluZGVyW2V4cGFuZG9dKXtwb3N0RmluZGVyPXNldE1hdGNoZXIocG9zdEZpbmRlcixwb3N0U2VsZWN0b3IpO30KcmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbihzZWVkLHJlc3VsdHMsY29udGV4dCx4bWwpe3ZhciB0ZW1wLGksZWxlbSxwcmVNYXA9W10scG9zdE1hcD1bXSxwcmVleGlzdGluZz1yZXN1bHRzLmxlbmd0aCxlbGVtcz1zZWVkfHxtdWx0aXBsZUNvbnRleHRzKHNlbGVjdG9yfHwiKiIsY29udGV4dC5ub2RlVHlwZT9bY29udGV4dF06Y29udGV4dCxbXSksbWF0Y2hlckluPXByZUZpbHRlciYmKHNlZWR8fCFzZWxlY3Rvcik/Y29uZGVuc2UoZWxlbXMscHJlTWFwLHByZUZpbHRlcixjb250ZXh0LHhtbCk6ZWxlbXMsbWF0Y2hlck91dD1tYXRjaGVyP3Bvc3RGaW5kZXJ8fChzZWVkP3ByZUZpbHRlcjpwcmVleGlzdGluZ3x8cG9zdEZpbHRlcik/W106cmVzdWx0czptYXRjaGVySW47aWYobWF0Y2hlcil7bWF0Y2hlcihtYXRjaGVySW4sbWF0Y2hlck91dCxjb250ZXh0LHhtbCk7fQppZihwb3N0RmlsdGVyKXt0ZW1wPWNvbmRlbnNlKG1hdGNoZXJPdXQscG9zdE1hcCk7cG9zdEZpbHRlcih0ZW1wLFtdLGNvbnRleHQseG1sKTtpPXRlbXAubGVuZ3RoO3doaWxlKGktLSl7aWYoKGVsZW09dGVtcFtpXSkpe21hdGNoZXJPdXRbcG9zdE1hcFtpXV09IShtYXRjaGVySW5bcG9zdE1hcFtpXV09ZWxlbSk7fX19CmlmKHNlZWQpe2lmKHBvc3RGaW5kZXJ8fHByZUZpbHRlcil7aWYocG9zdEZpbmRlcil7dGVtcD1bXTtpPW1hdGNoZXJPdXQubGVuZ3RoO3doaWxlKGktLSl7aWYoKGVsZW09bWF0Y2hlck91dFtpXSkpe3RlbXAucHVzaCgobWF0Y2hlckluW2ldPWVsZW0pKTt9fQpwb3N0RmluZGVyKG51bGwsKG1hdGNoZXJPdXQ9W10pLHRlbXAseG1sKTt9Cmk9bWF0Y2hlck91dC5sZW5ndGg7d2hpbGUoaS0tKXtpZigoZWxlbT1tYXRjaGVyT3V0W2ldKSYmKHRlbXA9cG9zdEZpbmRlcj9pbmRleE9mLmNhbGwoc2VlZCxlbGVtKTpwcmVNYXBbaV0pPi0xKXtzZWVkW3RlbXBdPSEocmVzdWx0c1t0ZW1wXT1lbGVtKTt9fX19ZWxzZXttYXRjaGVyT3V0PWNvbmRlbnNlKG1hdGNoZXJPdXQ9PT1yZXN1bHRzP21hdGNoZXJPdXQuc3BsaWNlKHByZWV4aXN0aW5nLG1hdGNoZXJPdXQubGVuZ3RoKTptYXRjaGVyT3V0KTtpZihwb3N0RmluZGVyKXtwb3N0RmluZGVyKG51bGwscmVzdWx0cyxtYXRjaGVyT3V0LHhtbCk7fWVsc2V7cHVzaC5hcHBseShyZXN1bHRzLG1hdGNoZXJPdXQpO319fSk7fQpmdW5jdGlvbiBtYXRjaGVyRnJvbVRva2Vucyh0b2tlbnMpe3ZhciBjaGVja0NvbnRleHQsbWF0Y2hlcixqLGxlbj10b2tlbnMubGVuZ3RoLGxlYWRpbmdSZWxhdGl2ZT1FeHByLnJlbGF0aXZlW3Rva2Vuc1swXS50eXBlXSxpbXBsaWNpdFJlbGF0aXZlPWxlYWRpbmdSZWxhdGl2ZXx8RXhwci5yZWxhdGl2ZVsiICJdLGk9bGVhZGluZ1JlbGF0aXZlPzE6MCxtYXRjaENvbnRleHQ9YWRkQ29tYmluYXRvcihmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbT09PWNoZWNrQ29udGV4dDt9LGltcGxpY2l0UmVsYXRpdmUsdHJ1ZSksbWF0Y2hBbnlDb250ZXh0PWFkZENvbWJpbmF0b3IoZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGluZGV4T2YuY2FsbChjaGVja0NvbnRleHQsZWxlbSk+LTE7fSxpbXBsaWNpdFJlbGF0aXZlLHRydWUpLG1hdGNoZXJzPVtmdW5jdGlvbihlbGVtLGNvbnRleHQseG1sKXtyZXR1cm4oIWxlYWRpbmdSZWxhdGl2ZSYmKHhtbHx8Y29udGV4dCE9PW91dGVybW9zdENvbnRleHQpKXx8KChjaGVja0NvbnRleHQ9Y29udGV4dCkubm9kZVR5cGU/bWF0Y2hDb250ZXh0KGVsZW0sY29udGV4dCx4bWwpOm1hdGNoQW55Q29udGV4dChlbGVtLGNvbnRleHQseG1sKSk7fV07Zm9yKDtpPGxlbjtpKyspe2lmKChtYXRjaGVyPUV4cHIucmVsYXRpdmVbdG9rZW5zW2ldLnR5cGVdKSl7bWF0Y2hlcnM9W2FkZENvbWJpbmF0b3IoZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpLG1hdGNoZXIpXTt9ZWxzZXttYXRjaGVyPUV4cHIuZmlsdGVyW3Rva2Vuc1tpXS50eXBlXS5hcHBseShudWxsLHRva2Vuc1tpXS5tYXRjaGVzKTtpZihtYXRjaGVyW2V4cGFuZG9dKXtqPSsraTtmb3IoO2o8bGVuO2orKyl7aWYoRXhwci5yZWxhdGl2ZVt0b2tlbnNbal0udHlwZV0pe2JyZWFrO319CnJldHVybiBzZXRNYXRjaGVyKGk+MSYmZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpLGk+MSYmdG9TZWxlY3Rvcih0b2tlbnMuc2xpY2UoMCxpLTEpLmNvbmNhdCh7dmFsdWU6dG9rZW5zW2ktMl0udHlwZT09PSIgIj8iKiI6IiJ9KSkucmVwbGFjZShydHJpbSwiJDEiKSxtYXRjaGVyLGk8aiYmbWF0Y2hlckZyb21Ub2tlbnModG9rZW5zLnNsaWNlKGksaikpLGo8bGVuJiZtYXRjaGVyRnJvbVRva2VucygodG9rZW5zPXRva2Vucy5zbGljZShqKSkpLGo8bGVuJiZ0b1NlbGVjdG9yKHRva2VucykpO30KbWF0Y2hlcnMucHVzaChtYXRjaGVyKTt9fQpyZXR1cm4gZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpO30KZnVuY3Rpb24gbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKGVsZW1lbnRNYXRjaGVycyxzZXRNYXRjaGVycyl7dmFyIGJ5U2V0PXNldE1hdGNoZXJzLmxlbmd0aD4wLGJ5RWxlbWVudD1lbGVtZW50TWF0Y2hlcnMubGVuZ3RoPjAsc3VwZXJNYXRjaGVyPWZ1bmN0aW9uKHNlZWQsY29udGV4dCx4bWwscmVzdWx0cyxvdXRlcm1vc3Qpe3ZhciBlbGVtLGosbWF0Y2hlcixtYXRjaGVkQ291bnQ9MCxpPSIwIix1bm1hdGNoZWQ9c2VlZCYmW10sc2V0TWF0Y2hlZD1bXSxjb250ZXh0QmFja3VwPW91dGVybW9zdENvbnRleHQsZWxlbXM9c2VlZHx8YnlFbGVtZW50JiZFeHByLmZpbmRbIlRBRyJdKCIqIixvdXRlcm1vc3QpLGRpcnJ1bnNVbmlxdWU9KGRpcnJ1bnMrPWNvbnRleHRCYWNrdXA9PW51bGw/MTpNYXRoLnJhbmRvbSgpfHwwLjEpLGxlbj1lbGVtcy5sZW5ndGg7aWYob3V0ZXJtb3N0KXtvdXRlcm1vc3RDb250ZXh0PWNvbnRleHQhPT1kb2N1bWVudCYmY29udGV4dDt9CmZvcig7aSE9PWxlbiYmKGVsZW09ZWxlbXNbaV0pIT1udWxsO2krKyl7aWYoYnlFbGVtZW50JiZlbGVtKXtqPTA7d2hpbGUoKG1hdGNoZXI9ZWxlbWVudE1hdGNoZXJzW2orK10pKXtpZihtYXRjaGVyKGVsZW0sY29udGV4dCx4bWwpKXtyZXN1bHRzLnB1c2goZWxlbSk7YnJlYWs7fX0KaWYob3V0ZXJtb3N0KXtkaXJydW5zPWRpcnJ1bnNVbmlxdWU7fX0KaWYoYnlTZXQpe2lmKChlbGVtPSFtYXRjaGVyJiZlbGVtKSl7bWF0Y2hlZENvdW50LS07fQppZihzZWVkKXt1bm1hdGNoZWQucHVzaChlbGVtKTt9fX0KbWF0Y2hlZENvdW50Kz1pO2lmKGJ5U2V0JiZpIT09bWF0Y2hlZENvdW50KXtqPTA7d2hpbGUoKG1hdGNoZXI9c2V0TWF0Y2hlcnNbaisrXSkpe21hdGNoZXIodW5tYXRjaGVkLHNldE1hdGNoZWQsY29udGV4dCx4bWwpO30KaWYoc2VlZCl7aWYobWF0Y2hlZENvdW50PjApe3doaWxlKGktLSl7aWYoISh1bm1hdGNoZWRbaV18fHNldE1hdGNoZWRbaV0pKXtzZXRNYXRjaGVkW2ldPXBvcC5jYWxsKHJlc3VsdHMpO319fQpzZXRNYXRjaGVkPWNvbmRlbnNlKHNldE1hdGNoZWQpO30KcHVzaC5hcHBseShyZXN1bHRzLHNldE1hdGNoZWQpO2lmKG91dGVybW9zdCYmIXNlZWQmJnNldE1hdGNoZWQubGVuZ3RoPjAmJihtYXRjaGVkQ291bnQrc2V0TWF0Y2hlcnMubGVuZ3RoKT4xKXtTaXp6bGUudW5pcXVlU29ydChyZXN1bHRzKTt9fQppZihvdXRlcm1vc3Qpe2RpcnJ1bnM9ZGlycnVuc1VuaXF1ZTtvdXRlcm1vc3RDb250ZXh0PWNvbnRleHRCYWNrdXA7fQpyZXR1cm4gdW5tYXRjaGVkO307cmV0dXJuIGJ5U2V0P21hcmtGdW5jdGlvbihzdXBlck1hdGNoZXIpOnN1cGVyTWF0Y2hlcjt9CmNvbXBpbGU9U2l6emxlLmNvbXBpbGU9ZnVuY3Rpb24oc2VsZWN0b3IsZ3JvdXApe3ZhciBpLHNldE1hdGNoZXJzPVtdLGVsZW1lbnRNYXRjaGVycz1bXSxjYWNoZWQ9Y29tcGlsZXJDYWNoZVtzZWxlY3RvcisiICJdO2lmKCFjYWNoZWQpe2lmKCFncm91cCl7Z3JvdXA9dG9rZW5pemUoc2VsZWN0b3IpO30KaT1ncm91cC5sZW5ndGg7d2hpbGUoaS0tKXtjYWNoZWQ9bWF0Y2hlckZyb21Ub2tlbnMoZ3JvdXBbaV0pO2lmKGNhY2hlZFtleHBhbmRvXSl7c2V0TWF0Y2hlcnMucHVzaChjYWNoZWQpO31lbHNle2VsZW1lbnRNYXRjaGVycy5wdXNoKGNhY2hlZCk7fX0KY2FjaGVkPWNvbXBpbGVyQ2FjaGUoc2VsZWN0b3IsbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKGVsZW1lbnRNYXRjaGVycyxzZXRNYXRjaGVycykpO30KcmV0dXJuIGNhY2hlZDt9O2Z1bmN0aW9uIG11bHRpcGxlQ29udGV4dHMoc2VsZWN0b3IsY29udGV4dHMscmVzdWx0cyl7dmFyIGk9MCxsZW49Y29udGV4dHMubGVuZ3RoO2Zvcig7aTxsZW47aSsrKXtTaXp6bGUoc2VsZWN0b3IsY29udGV4dHNbaV0scmVzdWx0cyk7fQpyZXR1cm4gcmVzdWx0czt9CmZ1bmN0aW9uIHNlbGVjdChzZWxlY3Rvcixjb250ZXh0LHJlc3VsdHMsc2VlZCl7dmFyIGksdG9rZW5zLHRva2VuLHR5cGUsZmluZCxtYXRjaD10b2tlbml6ZShzZWxlY3Rvcik7aWYoIXNlZWQpe2lmKG1hdGNoLmxlbmd0aD09PTEpe3Rva2Vucz1tYXRjaFswXT1tYXRjaFswXS5zbGljZSgwKTtpZih0b2tlbnMubGVuZ3RoPjImJih0b2tlbj10b2tlbnNbMF0pLnR5cGU9PT0iSUQiJiZzdXBwb3J0LmdldEJ5SWQmJmNvbnRleHQubm9kZVR5cGU9PT05JiZkb2N1bWVudElzSFRNTCYmRXhwci5yZWxhdGl2ZVt0b2tlbnNbMV0udHlwZV0pe2NvbnRleHQ9KEV4cHIuZmluZFsiSUQiXSh0b2tlbi5tYXRjaGVzWzBdLnJlcGxhY2UocnVuZXNjYXBlLGZ1bmVzY2FwZSksY29udGV4dCl8fFtdKVswXTtpZighY29udGV4dCl7cmV0dXJuIHJlc3VsdHM7fQpzZWxlY3Rvcj1zZWxlY3Rvci5zbGljZSh0b2tlbnMuc2hpZnQoKS52YWx1ZS5sZW5ndGgpO30KaT1tYXRjaEV4cHJbIm5lZWRzQ29udGV4dCJdLnRlc3Qoc2VsZWN0b3IpPzA6dG9rZW5zLmxlbmd0aDt3aGlsZShpLS0pe3Rva2VuPXRva2Vuc1tpXTtpZihFeHByLnJlbGF0aXZlWyh0eXBlPXRva2VuLnR5cGUpXSl7YnJlYWs7fQppZigoZmluZD1FeHByLmZpbmRbdHlwZV0pKXtpZigoc2VlZD1maW5kKHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZShydW5lc2NhcGUsZnVuZXNjYXBlKSxyc2libGluZy50ZXN0KHRva2Vuc1swXS50eXBlKSYmdGVzdENvbnRleHQoY29udGV4dC5wYXJlbnROb2RlKXx8Y29udGV4dCkpKXt0b2tlbnMuc3BsaWNlKGksMSk7c2VsZWN0b3I9c2VlZC5sZW5ndGgmJnRvU2VsZWN0b3IodG9rZW5zKTtpZighc2VsZWN0b3Ipe3B1c2guYXBwbHkocmVzdWx0cyxzZWVkKTtyZXR1cm4gcmVzdWx0czt9CmJyZWFrO319fX19CmNvbXBpbGUoc2VsZWN0b3IsbWF0Y2gpKHNlZWQsY29udGV4dCwhZG9jdW1lbnRJc0hUTUwscmVzdWx0cyxyc2libGluZy50ZXN0KHNlbGVjdG9yKSYmdGVzdENvbnRleHQoY29udGV4dC5wYXJlbnROb2RlKXx8Y29udGV4dCk7cmV0dXJuIHJlc3VsdHM7fQpzdXBwb3J0LnNvcnRTdGFibGU9ZXhwYW5kby5zcGxpdCgiIikuc29ydChzb3J0T3JkZXIpLmpvaW4oIiIpPT09ZXhwYW5kbztzdXBwb3J0LmRldGVjdER1cGxpY2F0ZXM9ISFoYXNEdXBsaWNhdGU7c2V0RG9jdW1lbnQoKTtzdXBwb3J0LnNvcnREZXRhY2hlZD1hc3NlcnQoZnVuY3Rpb24oZGl2MSl7cmV0dXJuIGRpdjEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpJjE7fSk7aWYoIWFzc2VydChmdW5jdGlvbihkaXYpe2Rpdi5pbm5lckhUTUw9IjxhIGhyZWY9JyMnPjwvYT4iO3JldHVybiBkaXYuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYiKT09PSIjIjt9KSl7YWRkSGFuZGxlKCJ0eXBlfGhyZWZ8aGVpZ2h0fHdpZHRoIixmdW5jdGlvbihlbGVtLG5hbWUsaXNYTUwpe2lmKCFpc1hNTCl7cmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKG5hbWUsbmFtZS50b0xvd2VyQ2FzZSgpPT09InR5cGUiPzE6Mik7fX0pO30KaWYoIXN1cHBvcnQuYXR0cmlidXRlc3x8IWFzc2VydChmdW5jdGlvbihkaXYpe2Rpdi5pbm5lckhUTUw9IjxpbnB1dC8+IjtkaXYuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwiIik7cmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgidmFsdWUiKT09PSIiO30pKXthZGRIYW5kbGUoInZhbHVlIixmdW5jdGlvbihlbGVtLG5hbWUsaXNYTUwpe2lmKCFpc1hNTCYmZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09ImlucHV0Iil7cmV0dXJuIGVsZW0uZGVmYXVsdFZhbHVlO319KTt9CmlmKCFhc3NlcnQoZnVuY3Rpb24oZGl2KXtyZXR1cm4gZGl2LmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKT09bnVsbDt9KSl7YWRkSGFuZGxlKGJvb2xlYW5zLGZ1bmN0aW9uKGVsZW0sbmFtZSxpc1hNTCl7dmFyIHZhbDtpZighaXNYTUwpe3JldHVybiBlbGVtW25hbWVdPT09dHJ1ZT9uYW1lLnRvTG93ZXJDYXNlKCk6KHZhbD1lbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpJiZ2YWwuc3BlY2lmaWVkP3ZhbC52YWx1ZTpudWxsO319KTt9CnJldHVybiBTaXp6bGU7fSkod2luZG93KTtqUXVlcnkuZmluZD1TaXp6bGU7alF1ZXJ5LmV4cHI9U2l6emxlLnNlbGVjdG9ycztqUXVlcnkuZXhwclsiOiJdPWpRdWVyeS5leHByLnBzZXVkb3M7alF1ZXJ5LnVuaXF1ZT1TaXp6bGUudW5pcXVlU29ydDtqUXVlcnkudGV4dD1TaXp6bGUuZ2V0VGV4dDtqUXVlcnkuaXNYTUxEb2M9U2l6emxlLmlzWE1MO2pRdWVyeS5jb250YWlucz1TaXp6bGUuY29udGFpbnM7dmFyIHJuZWVkc0NvbnRleHQ9alF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0O3ZhciByc2luZ2xlVGFnPSgvXjwoXHcrKVxzKlwvPz4oPzo8XC9cMT58KSQvKTt2YXIgcmlzU2ltcGxlPS9eLlteOiNcW1wuLF0qJC87ZnVuY3Rpb24gd2lubm93KGVsZW1lbnRzLHF1YWxpZmllcixub3Qpe2lmKGpRdWVyeS5pc0Z1bmN0aW9uKHF1YWxpZmllcikpe3JldHVybiBqUXVlcnkuZ3JlcChlbGVtZW50cyxmdW5jdGlvbihlbGVtLGkpe3JldHVybiEhcXVhbGlmaWVyLmNhbGwoZWxlbSxpLGVsZW0pIT09bm90O30pO30KaWYocXVhbGlmaWVyLm5vZGVUeXBlKXtyZXR1cm4galF1ZXJ5LmdyZXAoZWxlbWVudHMsZnVuY3Rpb24oZWxlbSl7cmV0dXJuKGVsZW09PT1xdWFsaWZpZXIpIT09bm90O30pO30KaWYodHlwZW9mIHF1YWxpZmllcj09PSJzdHJpbmciKXtpZihyaXNTaW1wbGUudGVzdChxdWFsaWZpZXIpKXtyZXR1cm4galF1ZXJ5LmZpbHRlcihxdWFsaWZpZXIsZWxlbWVudHMsbm90KTt9CnF1YWxpZmllcj1qUXVlcnkuZmlsdGVyKHF1YWxpZmllcixlbGVtZW50cyk7fQpyZXR1cm4galF1ZXJ5LmdyZXAoZWxlbWVudHMsZnVuY3Rpb24oZWxlbSl7cmV0dXJuKGpRdWVyeS5pbkFycmF5KGVsZW0scXVhbGlmaWVyKT49MCkhPT1ub3Q7fSk7fQpqUXVlcnkuZmlsdGVyPWZ1bmN0aW9uKGV4cHIsZWxlbXMsbm90KXt2YXIgZWxlbT1lbGVtc1swXTtpZihub3Qpe2V4cHI9Ijpub3QoIitleHByKyIpIjt9CnJldHVybiBlbGVtcy5sZW5ndGg9PT0xJiZlbGVtLm5vZGVUeXBlPT09MT9qUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoZWxlbSxleHByKT9bZWxlbV06W106alF1ZXJ5LmZpbmQubWF0Y2hlcyhleHByLGpRdWVyeS5ncmVwKGVsZW1zLGZ1bmN0aW9uKGVsZW0pe3JldHVybiBlbGVtLm5vZGVUeXBlPT09MTt9KSk7fTtqUXVlcnkuZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKHNlbGVjdG9yKXt2YXIgaSxyZXQ9W10sc2VsZj10aGlzLGxlbj1zZWxmLmxlbmd0aDtpZih0eXBlb2Ygc2VsZWN0b3IhPT0ic3RyaW5nIil7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGpRdWVyeShzZWxlY3RvcikuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKGk9MDtpPGxlbjtpKyspe2lmKGpRdWVyeS5jb250YWlucyhzZWxmW2ldLHRoaXMpKXtyZXR1cm4gdHJ1ZTt9fX0pKTt9CmZvcihpPTA7aTxsZW47aSsrKXtqUXVlcnkuZmluZChzZWxlY3RvcixzZWxmW2ldLHJldCk7fQpyZXQ9dGhpcy5wdXNoU3RhY2sobGVuPjE/alF1ZXJ5LnVuaXF1ZShyZXQpOnJldCk7cmV0LnNlbGVjdG9yPXRoaXMuc2VsZWN0b3I/dGhpcy5zZWxlY3RvcisiICIrc2VsZWN0b3I6c2VsZWN0b3I7cmV0dXJuIHJldDt9LGZpbHRlcjpmdW5jdGlvbihzZWxlY3Rvcil7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHdpbm5vdyh0aGlzLHNlbGVjdG9yfHxbXSxmYWxzZSkpO30sbm90OmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sod2lubm93KHRoaXMsc2VsZWN0b3J8fFtdLHRydWUpKTt9LGlzOmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4hIXdpbm5vdyh0aGlzLHR5cGVvZiBzZWxlY3Rvcj09PSJzdHJpbmciJiZybmVlZHNDb250ZXh0LnRlc3Qoc2VsZWN0b3IpP2pRdWVyeShzZWxlY3Rvcik6c2VsZWN0b3J8fFtdLGZhbHNlKS5sZW5ndGg7fX0pO3ZhciByb290alF1ZXJ5LGRvY3VtZW50PXdpbmRvdy5kb2N1bWVudCxycXVpY2tFeHByPS9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKikpJC8saW5pdD1qUXVlcnkuZm4uaW5pdD1mdW5jdGlvbihzZWxlY3Rvcixjb250ZXh0KXt2YXIgbWF0Y2gsZWxlbTtpZighc2VsZWN0b3Ipe3JldHVybiB0aGlzO30KaWYodHlwZW9mIHNlbGVjdG9yPT09InN0cmluZyIpe2lmKHNlbGVjdG9yLmNoYXJBdCgwKT09PSI8IiYmc2VsZWN0b3IuY2hhckF0KHNlbGVjdG9yLmxlbmd0aC0xKT09PSI+IiYmc2VsZWN0b3IubGVuZ3RoPj0zKXttYXRjaD1bbnVsbCxzZWxlY3RvcixudWxsXTt9ZWxzZXttYXRjaD1ycXVpY2tFeHByLmV4ZWMoc2VsZWN0b3IpO30KaWYobWF0Y2gmJihtYXRjaFsxXXx8IWNvbnRleHQpKXtpZihtYXRjaFsxXSl7Y29udGV4dD1jb250ZXh0IGluc3RhbmNlb2YgalF1ZXJ5P2NvbnRleHRbMF06Y29udGV4dDtqUXVlcnkubWVyZ2UodGhpcyxqUXVlcnkucGFyc2VIVE1MKG1hdGNoWzFdLGNvbnRleHQmJmNvbnRleHQubm9kZVR5cGU/Y29udGV4dC5vd25lckRvY3VtZW50fHxjb250ZXh0OmRvY3VtZW50LHRydWUpKTtpZihyc2luZ2xlVGFnLnRlc3QobWF0Y2hbMV0pJiZqUXVlcnkuaXNQbGFpbk9iamVjdChjb250ZXh0KSl7Zm9yKG1hdGNoIGluIGNvbnRleHQpe2lmKGpRdWVyeS5pc0Z1bmN0aW9uKHRoaXNbbWF0Y2hdKSl7dGhpc1ttYXRjaF0oY29udGV4dFttYXRjaF0pO31lbHNle3RoaXMuYXR0cihtYXRjaCxjb250ZXh0W21hdGNoXSk7fX19CnJldHVybiB0aGlzO31lbHNle2VsZW09ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWF0Y2hbMl0pO2lmKGVsZW0mJmVsZW0ucGFyZW50Tm9kZSl7aWYoZWxlbS5pZCE9PW1hdGNoWzJdKXtyZXR1cm4gcm9vdGpRdWVyeS5maW5kKHNlbGVjdG9yKTt9CnRoaXMubGVuZ3RoPTE7dGhpc1swXT1lbGVtO30KdGhpcy5jb250ZXh0PWRvY3VtZW50O3RoaXMuc2VsZWN0b3I9c2VsZWN0b3I7cmV0dXJuIHRoaXM7fX1lbHNlIGlmKCFjb250ZXh0fHxjb250ZXh0LmpxdWVyeSl7cmV0dXJuKGNvbnRleHR8fHJvb3RqUXVlcnkpLmZpbmQoc2VsZWN0b3IpO31lbHNle3JldHVybiB0aGlzLmNvbnN0cnVjdG9yKGNvbnRleHQpLmZpbmQoc2VsZWN0b3IpO319ZWxzZSBpZihzZWxlY3Rvci5ub2RlVHlwZSl7dGhpcy5jb250ZXh0PXRoaXNbMF09c2VsZWN0b3I7dGhpcy5sZW5ndGg9MTtyZXR1cm4gdGhpczt9ZWxzZSBpZihqUXVlcnkuaXNGdW5jdGlvbihzZWxlY3Rvcikpe3JldHVybiB0eXBlb2Ygcm9vdGpRdWVyeS5yZWFkeSE9PSJ1bmRlZmluZWQiP3Jvb3RqUXVlcnkucmVhZHkoc2VsZWN0b3IpOnNlbGVjdG9yKGpRdWVyeSk7fQppZihzZWxlY3Rvci5zZWxlY3RvciE9PXVuZGVmaW5lZCl7dGhpcy5zZWxlY3Rvcj1zZWxlY3Rvci5zZWxlY3Rvcjt0aGlzLmNvbnRleHQ9c2VsZWN0b3IuY29udGV4dDt9CnJldHVybiBqUXVlcnkubWFrZUFycmF5KHNlbGVjdG9yLHRoaXMpO307aW5pdC5wcm90b3R5cGU9alF1ZXJ5LmZuO3Jvb3RqUXVlcnk9alF1ZXJ5KGRvY3VtZW50KTt2YXIgcnBhcmVudHNwcmV2PS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLGd1YXJhbnRlZWRVbmlxdWU9e2NoaWxkcmVuOnRydWUsY29udGVudHM6dHJ1ZSxuZXh0OnRydWUscHJldjp0cnVlfTtqUXVlcnkuZXh0ZW5kKHtkaXI6ZnVuY3Rpb24oZWxlbSxkaXIsdW50aWwpe3ZhciBtYXRjaGVkPVtdLGN1cj1lbGVtW2Rpcl07d2hpbGUoY3VyJiZjdXIubm9kZVR5cGUhPT05JiYodW50aWw9PT11bmRlZmluZWR8fGN1ci5ub2RlVHlwZSE9PTF8fCFqUXVlcnkoY3VyKS5pcyh1bnRpbCkpKXtpZihjdXIubm9kZVR5cGU9PT0xKXttYXRjaGVkLnB1c2goY3VyKTt9CmN1cj1jdXJbZGlyXTt9CnJldHVybiBtYXRjaGVkO30sc2libGluZzpmdW5jdGlvbihuLGVsZW0pe3ZhciByPVtdO2Zvcig7bjtuPW4ubmV4dFNpYmxpbmcpe2lmKG4ubm9kZVR5cGU9PT0xJiZuIT09ZWxlbSl7ci5wdXNoKG4pO319CnJldHVybiByO319KTtqUXVlcnkuZm4uZXh0ZW5kKHtoYXM6ZnVuY3Rpb24odGFyZ2V0KXt2YXIgaSx0YXJnZXRzPWpRdWVyeSh0YXJnZXQsdGhpcyksbGVuPXRhcmdldHMubGVuZ3RoO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2ZvcihpPTA7aTxsZW47aSsrKXtpZihqUXVlcnkuY29udGFpbnModGhpcyx0YXJnZXRzW2ldKSl7cmV0dXJuIHRydWU7fX19KTt9LGNsb3Nlc3Q6ZnVuY3Rpb24oc2VsZWN0b3JzLGNvbnRleHQpe3ZhciBjdXIsaT0wLGw9dGhpcy5sZW5ndGgsbWF0Y2hlZD1bXSxwb3M9cm5lZWRzQ29udGV4dC50ZXN0KHNlbGVjdG9ycyl8fHR5cGVvZiBzZWxlY3RvcnMhPT0ic3RyaW5nIj9qUXVlcnkoc2VsZWN0b3JzLGNvbnRleHR8fHRoaXMuY29udGV4dCk6MDtmb3IoO2k8bDtpKyspe2ZvcihjdXI9dGhpc1tpXTtjdXImJmN1ciE9PWNvbnRleHQ7Y3VyPWN1ci5wYXJlbnROb2RlKXtpZihjdXIubm9kZVR5cGU8MTEmJihwb3M/cG9zLmluZGV4KGN1cik+LTE6Y3VyLm5vZGVUeXBlPT09MSYmalF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGN1cixzZWxlY3RvcnMpKSl7bWF0Y2hlZC5wdXNoKGN1cik7YnJlYWs7fX19CnJldHVybiB0aGlzLnB1c2hTdGFjayhtYXRjaGVkLmxlbmd0aD4xP2pRdWVyeS51bmlxdWUobWF0Y2hlZCk6bWF0Y2hlZCk7fSxpbmRleDpmdW5jdGlvbihlbGVtKXtpZighZWxlbSl7cmV0dXJuKHRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZSk/dGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGg6LTE7fQppZih0eXBlb2YgZWxlbT09PSJzdHJpbmciKXtyZXR1cm4galF1ZXJ5LmluQXJyYXkodGhpc1swXSxqUXVlcnkoZWxlbSkpO30KcmV0dXJuIGpRdWVyeS5pbkFycmF5KGVsZW0uanF1ZXJ5P2VsZW1bMF06ZWxlbSx0aGlzKTt9LGFkZDpmdW5jdGlvbihzZWxlY3Rvcixjb250ZXh0KXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soalF1ZXJ5LnVuaXF1ZShqUXVlcnkubWVyZ2UodGhpcy5nZXQoKSxqUXVlcnkoc2VsZWN0b3IsY29udGV4dCkpKSk7fSxhZGRCYWNrOmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4gdGhpcy5hZGQoc2VsZWN0b3I9PW51bGw/dGhpcy5wcmV2T2JqZWN0OnRoaXMucHJldk9iamVjdC5maWx0ZXIoc2VsZWN0b3IpKTt9fSk7ZnVuY3Rpb24gc2libGluZyhjdXIsZGlyKXtkb3tjdXI9Y3VyW2Rpcl07fXdoaWxlKGN1ciYmY3VyLm5vZGVUeXBlIT09MSk7cmV0dXJuIGN1cjt9CmpRdWVyeS5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oZWxlbSl7dmFyIHBhcmVudD1lbGVtLnBhcmVudE5vZGU7cmV0dXJuIHBhcmVudCYmcGFyZW50Lm5vZGVUeXBlIT09MTE/cGFyZW50Om51bGw7fSxwYXJlbnRzOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sInBhcmVudE5vZGUiKTt9LHBhcmVudHNVbnRpbDpmdW5jdGlvbihlbGVtLGksdW50aWwpe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sInBhcmVudE5vZGUiLHVudGlsKTt9LG5leHQ6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIHNpYmxpbmcoZWxlbSwibmV4dFNpYmxpbmciKTt9LHByZXY6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIHNpYmxpbmcoZWxlbSwicHJldmlvdXNTaWJsaW5nIik7fSxuZXh0QWxsOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sIm5leHRTaWJsaW5nIik7fSxwcmV2QWxsOmZ1bmN0aW9uKGVsZW0pe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sInByZXZpb3VzU2libGluZyIpO30sbmV4dFVudGlsOmZ1bmN0aW9uKGVsZW0saSx1bnRpbCl7cmV0dXJuIGpRdWVyeS5kaXIoZWxlbSwibmV4dFNpYmxpbmciLHVudGlsKTt9LHByZXZVbnRpbDpmdW5jdGlvbihlbGVtLGksdW50aWwpe3JldHVybiBqUXVlcnkuZGlyKGVsZW0sInByZXZpb3VzU2libGluZyIsdW50aWwpO30sc2libGluZ3M6ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGpRdWVyeS5zaWJsaW5nKChlbGVtLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGVsZW0pO30sY2hpbGRyZW46ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGpRdWVyeS5zaWJsaW5nKGVsZW0uZmlyc3RDaGlsZCk7fSxjb250ZW50czpmdW5jdGlvbihlbGVtKXtyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKGVsZW0sImlmcmFtZSIpP2VsZW0uY29udGVudERvY3VtZW50fHxlbGVtLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ6alF1ZXJ5Lm1lcmdlKFtdLGVsZW0uY2hpbGROb2Rlcyk7fX0sZnVuY3Rpb24obmFtZSxmbil7alF1ZXJ5LmZuW25hbWVdPWZ1bmN0aW9uKHVudGlsLHNlbGVjdG9yKXt2YXIgcmV0PWpRdWVyeS5tYXAodGhpcyxmbix1bnRpbCk7aWYobmFtZS5zbGljZSgtNSkhPT0iVW50aWwiKXtzZWxlY3Rvcj11bnRpbDt9CmlmKHNlbGVjdG9yJiZ0eXBlb2Ygc2VsZWN0b3I9PT0ic3RyaW5nIil7cmV0PWpRdWVyeS5maWx0ZXIoc2VsZWN0b3IscmV0KTt9CmlmKHRoaXMubGVuZ3RoPjEpe2lmKCFndWFyYW50ZWVkVW5pcXVlW25hbWVdKXtyZXQ9alF1ZXJ5LnVuaXF1ZShyZXQpO30KaWYocnBhcmVudHNwcmV2LnRlc3QobmFtZSkpe3JldD1yZXQucmV2ZXJzZSgpO319CnJldHVybiB0aGlzLnB1c2hTdGFjayhyZXQpO307fSk7dmFyIHJub3R3aGl0ZT0oL1xTKy9nKTt2YXIgb3B0aW9uc0NhY2hlPXt9O2Z1bmN0aW9uIGNyZWF0ZU9wdGlvbnMob3B0aW9ucyl7dmFyIG9iamVjdD1vcHRpb25zQ2FjaGVbb3B0aW9uc109e307alF1ZXJ5LmVhY2gob3B0aW9ucy5tYXRjaChybm90d2hpdGUpfHxbXSxmdW5jdGlvbihfLGZsYWcpe29iamVjdFtmbGFnXT10cnVlO30pO3JldHVybiBvYmplY3Q7fQpqUXVlcnkuQ2FsbGJhY2tzPWZ1bmN0aW9uKG9wdGlvbnMpe29wdGlvbnM9dHlwZW9mIG9wdGlvbnM9PT0ic3RyaW5nIj8ob3B0aW9uc0NhY2hlW29wdGlvbnNdfHxjcmVhdGVPcHRpb25zKG9wdGlvbnMpKTpqUXVlcnkuZXh0ZW5kKHt9LG9wdGlvbnMpO3ZhcgpmaXJpbmcsbWVtb3J5LGZpcmVkLGZpcmluZ0xlbmd0aCxmaXJpbmdJbmRleCxmaXJpbmdTdGFydCxsaXN0PVtdLHN0YWNrPSFvcHRpb25zLm9uY2UmJltdLGZpcmU9ZnVuY3Rpb24oZGF0YSl7bWVtb3J5PW9wdGlvbnMubWVtb3J5JiZkYXRhO2ZpcmVkPXRydWU7ZmlyaW5nSW5kZXg9ZmlyaW5nU3RhcnR8fDA7ZmlyaW5nU3RhcnQ9MDtmaXJpbmdMZW5ndGg9bGlzdC5sZW5ndGg7ZmlyaW5nPXRydWU7Zm9yKDtsaXN0JiZmaXJpbmdJbmRleDxmaXJpbmdMZW5ndGg7ZmlyaW5nSW5kZXgrKyl7aWYobGlzdFtmaXJpbmdJbmRleF0uYXBwbHkoZGF0YVswXSxkYXRhWzFdKT09PWZhbHNlJiZvcHRpb25zLnN0b3BPbkZhbHNlKXttZW1vcnk9ZmFsc2U7YnJlYWs7fX0KZmlyaW5nPWZhbHNlO2lmKGxpc3Qpe2lmKHN0YWNrKXtpZihzdGFjay5sZW5ndGgpe2ZpcmUoc3RhY2suc2hpZnQoKSk7fX1lbHNlIGlmKG1lbW9yeSl7bGlzdD1bXTt9ZWxzZXtzZWxmLmRpc2FibGUoKTt9fX0sc2VsZj17YWRkOmZ1bmN0aW9uKCl7aWYobGlzdCl7dmFyIHN0YXJ0PWxpc3QubGVuZ3RoOyhmdW5jdGlvbiBhZGQoYXJncyl7alF1ZXJ5LmVhY2goYXJncyxmdW5jdGlvbihfLGFyZyl7dmFyIHR5cGU9alF1ZXJ5LnR5cGUoYXJnKTtpZih0eXBlPT09ImZ1bmN0aW9uIil7aWYoIW9wdGlvbnMudW5pcXVlfHwhc2VsZi5oYXMoYXJnKSl7bGlzdC5wdXNoKGFyZyk7fX1lbHNlIGlmKGFyZyYmYXJnLmxlbmd0aCYmdHlwZSE9PSJzdHJpbmciKXthZGQoYXJnKTt9fSk7fSkoYXJndW1lbnRzKTtpZihmaXJpbmcpe2ZpcmluZ0xlbmd0aD1saXN0Lmxlbmd0aDt9ZWxzZSBpZihtZW1vcnkpe2ZpcmluZ1N0YXJ0PXN0YXJ0O2ZpcmUobWVtb3J5KTt9fQpyZXR1cm4gdGhpczt9LHJlbW92ZTpmdW5jdGlvbigpe2lmKGxpc3Qpe2pRdWVyeS5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbihfLGFyZyl7dmFyIGluZGV4O3doaWxlKChpbmRleD1qUXVlcnkuaW5BcnJheShhcmcsbGlzdCxpbmRleCkpPi0xKXtsaXN0LnNwbGljZShpbmRleCwxKTtpZihmaXJpbmcpe2lmKGluZGV4PD1maXJpbmdMZW5ndGgpe2ZpcmluZ0xlbmd0aC0tO30KaWYoaW5kZXg8PWZpcmluZ0luZGV4KXtmaXJpbmdJbmRleC0tO319fX0pO30KcmV0dXJuIHRoaXM7fSxoYXM6ZnVuY3Rpb24oZm4pe3JldHVybiBmbj9qUXVlcnkuaW5BcnJheShmbixsaXN0KT4tMTohIShsaXN0JiZsaXN0Lmxlbmd0aCk7fSxlbXB0eTpmdW5jdGlvbigpe2xpc3Q9W107ZmlyaW5nTGVuZ3RoPTA7cmV0dXJuIHRoaXM7fSxkaXNhYmxlOmZ1bmN0aW9uKCl7bGlzdD1zdGFjaz1tZW1vcnk9dW5kZWZpbmVkO3JldHVybiB0aGlzO30sZGlzYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hbGlzdDt9LGxvY2s6ZnVuY3Rpb24oKXtzdGFjaz11bmRlZmluZWQ7aWYoIW1lbW9yeSl7c2VsZi5kaXNhYmxlKCk7fQpyZXR1cm4gdGhpczt9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiFzdGFjazt9LGZpcmVXaXRoOmZ1bmN0aW9uKGNvbnRleHQsYXJncyl7aWYobGlzdCYmKCFmaXJlZHx8c3RhY2spKXthcmdzPWFyZ3N8fFtdO2FyZ3M9W2NvbnRleHQsYXJncy5zbGljZT9hcmdzLnNsaWNlKCk6YXJnc107aWYoZmlyaW5nKXtzdGFjay5wdXNoKGFyZ3MpO31lbHNle2ZpcmUoYXJncyk7fX0KcmV0dXJuIHRoaXM7fSxmaXJlOmZ1bmN0aW9uKCl7c2VsZi5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXM7fSxmaXJlZDpmdW5jdGlvbigpe3JldHVybiEhZmlyZWQ7fX07cmV0dXJuIHNlbGY7fTtqUXVlcnkuZXh0ZW5kKHtEZWZlcnJlZDpmdW5jdGlvbihmdW5jKXt2YXIgdHVwbGVzPVtbInJlc29sdmUiLCJkb25lIixqUXVlcnkuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLCJyZXNvbHZlZCJdLFsicmVqZWN0IiwiZmFpbCIsalF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwicmVqZWN0ZWQiXSxbIm5vdGlmeSIsInByb2dyZXNzIixqUXVlcnkuQ2FsbGJhY2tzKCJtZW1vcnkiKV1dLHN0YXRlPSJwZW5kaW5nIixwcm9taXNlPXtzdGF0ZTpmdW5jdGlvbigpe3JldHVybiBzdGF0ZTt9LGFsd2F5czpmdW5jdGlvbigpe2RlZmVycmVkLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyk7cmV0dXJuIHRoaXM7fSx0aGVuOmZ1bmN0aW9uKCl7dmFyIGZucz1hcmd1bWVudHM7cmV0dXJuIGpRdWVyeS5EZWZlcnJlZChmdW5jdGlvbihuZXdEZWZlcil7alF1ZXJ5LmVhY2godHVwbGVzLGZ1bmN0aW9uKGksdHVwbGUpe3ZhciBmbj1qUXVlcnkuaXNGdW5jdGlvbihmbnNbaV0pJiZmbnNbaV07ZGVmZXJyZWRbdHVwbGVbMV1dKGZ1bmN0aW9uKCl7dmFyIHJldHVybmVkPWZuJiZmbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYocmV0dXJuZWQmJmpRdWVyeS5pc0Z1bmN0aW9uKHJldHVybmVkLnByb21pc2UpKXtyZXR1cm5lZC5wcm9taXNlKCkuZG9uZShuZXdEZWZlci5yZXNvbHZlKS5mYWlsKG5ld0RlZmVyLnJlamVjdCkucHJvZ3Jlc3MobmV3RGVmZXIubm90aWZ5KTt9ZWxzZXtuZXdEZWZlclt0dXBsZVswXSsiV2l0aCJdKHRoaXM9PT1wcm9taXNlP25ld0RlZmVyLnByb21pc2UoKTp0aGlzLGZuP1tyZXR1cm5lZF06YXJndW1lbnRzKTt9fSk7fSk7Zm5zPW51bGw7fSkucHJvbWlzZSgpO30scHJvbWlzZTpmdW5jdGlvbihvYmope3JldHVybiBvYmohPW51bGw/alF1ZXJ5LmV4dGVuZChvYmoscHJvbWlzZSk6cHJvbWlzZTt9fSxkZWZlcnJlZD17fTtwcm9taXNlLnBpcGU9cHJvbWlzZS50aGVuO2pRdWVyeS5lYWNoKHR1cGxlcyxmdW5jdGlvbihpLHR1cGxlKXt2YXIgbGlzdD10dXBsZVsyXSxzdGF0ZVN0cmluZz10dXBsZVszXTtwcm9taXNlW3R1cGxlWzFdXT1saXN0LmFkZDtpZihzdGF0ZVN0cmluZyl7bGlzdC5hZGQoZnVuY3Rpb24oKXtzdGF0ZT1zdGF0ZVN0cmluZzt9LHR1cGxlc1tpXjFdWzJdLmRpc2FibGUsdHVwbGVzWzJdWzJdLmxvY2spO30KZGVmZXJyZWRbdHVwbGVbMF1dPWZ1bmN0aW9uKCl7ZGVmZXJyZWRbdHVwbGVbMF0rIldpdGgiXSh0aGlzPT09ZGVmZXJyZWQ/cHJvbWlzZTp0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXM7fTtkZWZlcnJlZFt0dXBsZVswXSsiV2l0aCJdPWxpc3QuZmlyZVdpdGg7fSk7cHJvbWlzZS5wcm9taXNlKGRlZmVycmVkKTtpZihmdW5jKXtmdW5jLmNhbGwoZGVmZXJyZWQsZGVmZXJyZWQpO30KcmV0dXJuIGRlZmVycmVkO30sd2hlbjpmdW5jdGlvbihzdWJvcmRpbmF0ZSl7dmFyIGk9MCxyZXNvbHZlVmFsdWVzPXNsaWNlLmNhbGwoYXJndW1lbnRzKSxsZW5ndGg9cmVzb2x2ZVZhbHVlcy5sZW5ndGgscmVtYWluaW5nPWxlbmd0aCE9PTF8fChzdWJvcmRpbmF0ZSYmalF1ZXJ5LmlzRnVuY3Rpb24oc3Vib3JkaW5hdGUucHJvbWlzZSkpP2xlbmd0aDowLGRlZmVycmVkPXJlbWFpbmluZz09PTE/c3Vib3JkaW5hdGU6alF1ZXJ5LkRlZmVycmVkKCksdXBkYXRlRnVuYz1mdW5jdGlvbihpLGNvbnRleHRzLHZhbHVlcyl7cmV0dXJuIGZ1bmN0aW9uKHZhbHVlKXtjb250ZXh0c1tpXT10aGlzO3ZhbHVlc1tpXT1hcmd1bWVudHMubGVuZ3RoPjE/c2xpY2UuY2FsbChhcmd1bWVudHMpOnZhbHVlO2lmKHZhbHVlcz09PXByb2dyZXNzVmFsdWVzKXtkZWZlcnJlZC5ub3RpZnlXaXRoKGNvbnRleHRzLHZhbHVlcyk7fWVsc2UgaWYoISgtLXJlbWFpbmluZykpe2RlZmVycmVkLnJlc29sdmVXaXRoKGNvbnRleHRzLHZhbHVlcyk7fX07fSxwcm9ncmVzc1ZhbHVlcyxwcm9ncmVzc0NvbnRleHRzLHJlc29sdmVDb250ZXh0cztpZihsZW5ndGg+MSl7cHJvZ3Jlc3NWYWx1ZXM9bmV3IEFycmF5KGxlbmd0aCk7cHJvZ3Jlc3NDb250ZXh0cz1uZXcgQXJyYXkobGVuZ3RoKTtyZXNvbHZlQ29udGV4dHM9bmV3IEFycmF5KGxlbmd0aCk7Zm9yKDtpPGxlbmd0aDtpKyspe2lmKHJlc29sdmVWYWx1ZXNbaV0mJmpRdWVyeS5pc0Z1bmN0aW9uKHJlc29sdmVWYWx1ZXNbaV0ucHJvbWlzZSkpe3Jlc29sdmVWYWx1ZXNbaV0ucHJvbWlzZSgpLmRvbmUodXBkYXRlRnVuYyhpLHJlc29sdmVDb250ZXh0cyxyZXNvbHZlVmFsdWVzKSkuZmFpbChkZWZlcnJlZC5yZWplY3QpLnByb2dyZXNzKHVwZGF0ZUZ1bmMoaSxwcm9ncmVzc0NvbnRleHRzLHByb2dyZXNzVmFsdWVzKSk7fWVsc2V7LS1yZW1haW5pbmc7fX19CmlmKCFyZW1haW5pbmcpe2RlZmVycmVkLnJlc29sdmVXaXRoKHJlc29sdmVDb250ZXh0cyxyZXNvbHZlVmFsdWVzKTt9CnJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7fX0pO3ZhciByZWFkeUxpc3Q7alF1ZXJ5LmZuLnJlYWR5PWZ1bmN0aW9uKGZuKXtqUXVlcnkucmVhZHkucHJvbWlzZSgpLmRvbmUoZm4pO3JldHVybiB0aGlzO307alF1ZXJ5LmV4dGVuZCh7aXNSZWFkeTpmYWxzZSxyZWFkeVdhaXQ6MSxob2xkUmVhZHk6ZnVuY3Rpb24oaG9sZCl7aWYoaG9sZCl7alF1ZXJ5LnJlYWR5V2FpdCsrO31lbHNle2pRdWVyeS5yZWFkeSh0cnVlKTt9fSxyZWFkeTpmdW5jdGlvbih3YWl0KXtpZih3YWl0PT09dHJ1ZT8tLWpRdWVyeS5yZWFkeVdhaXQ6alF1ZXJ5LmlzUmVhZHkpe3JldHVybjt9CmlmKCFkb2N1bWVudC5ib2R5KXtyZXR1cm4gc2V0VGltZW91dChqUXVlcnkucmVhZHkpO30KalF1ZXJ5LmlzUmVhZHk9dHJ1ZTtpZih3YWl0IT09dHJ1ZSYmLS1qUXVlcnkucmVhZHlXYWl0PjApe3JldHVybjt9CnJlYWR5TGlzdC5yZXNvbHZlV2l0aChkb2N1bWVudCxbalF1ZXJ5XSk7aWYoalF1ZXJ5LmZuLnRyaWdnZXIpe2pRdWVyeShkb2N1bWVudCkudHJpZ2dlcigicmVhZHkiKS5vZmYoInJlYWR5Iik7fX19KTtmdW5jdGlvbiBkZXRhY2goKXtpZihkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixjb21wbGV0ZWQsZmFsc2UpO3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixjb21wbGV0ZWQsZmFsc2UpO31lbHNle2RvY3VtZW50LmRldGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLGNvbXBsZXRlZCk7d2luZG93LmRldGFjaEV2ZW50KCJvbmxvYWQiLGNvbXBsZXRlZCk7fX0KZnVuY3Rpb24gY29tcGxldGVkKCl7aWYoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcnx8ZXZlbnQudHlwZT09PSJsb2FkInx8ZG9jdW1lbnQucmVhZHlTdGF0ZT09PSJjb21wbGV0ZSIpe2RldGFjaCgpO2pRdWVyeS5yZWFkeSgpO319CmpRdWVyeS5yZWFkeS5wcm9taXNlPWZ1bmN0aW9uKG9iail7aWYoIXJlYWR5TGlzdCl7cmVhZHlMaXN0PWpRdWVyeS5EZWZlcnJlZCgpO2lmKGRvY3VtZW50LnJlYWR5U3RhdGU9PT0iY29tcGxldGUiKXtzZXRUaW1lb3V0KGpRdWVyeS5yZWFkeSk7fWVsc2UgaWYoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcil7ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsY29tcGxldGVkLGZhbHNlKTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsY29tcGxldGVkLGZhbHNlKTt9ZWxzZXtkb2N1bWVudC5hdHRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIixjb21wbGV0ZWQpO3dpbmRvdy5hdHRhY2hFdmVudCgib25sb2FkIixjb21wbGV0ZWQpO3ZhciB0b3A9ZmFsc2U7dHJ5e3RvcD13aW5kb3cuZnJhbWVFbGVtZW50PT1udWxsJiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7fWNhdGNoKGUpe30KaWYodG9wJiZ0b3AuZG9TY3JvbGwpeyhmdW5jdGlvbiBkb1Njcm9sbENoZWNrKCl7aWYoIWpRdWVyeS5pc1JlYWR5KXt0cnl7dG9wLmRvU2Nyb2xsKCJsZWZ0Iik7fWNhdGNoKGUpe3JldHVybiBzZXRUaW1lb3V0KGRvU2Nyb2xsQ2hlY2ssNTApO30KZGV0YWNoKCk7alF1ZXJ5LnJlYWR5KCk7fX0pKCk7fX19CnJldHVybiByZWFkeUxpc3QucHJvbWlzZShvYmopO307dmFyIHN0cnVuZGVmaW5lZD10eXBlb2YgdW5kZWZpbmVkO3ZhciBpO2ZvcihpIGluIGpRdWVyeShzdXBwb3J0KSl7YnJlYWs7fQpzdXBwb3J0Lm93bkxhc3Q9aSE9PSIwIjtzdXBwb3J0LmlubGluZUJsb2NrTmVlZHNMYXlvdXQ9ZmFsc2U7alF1ZXJ5KGZ1bmN0aW9uKCl7dmFyIGNvbnRhaW5lcixkaXYsYm9keT1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdO2lmKCFib2R5KXtyZXR1cm47fQpjb250YWluZXI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Y29udGFpbmVyLnN0eWxlLmNzc1RleHQ9ImJvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDotOTk5OXB4O21hcmdpbi10b3A6MXB4IjtkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Ym9keS5hcHBlbmRDaGlsZChjb250YWluZXIpLmFwcGVuZENoaWxkKGRpdik7aWYodHlwZW9mIGRpdi5zdHlsZS56b29tIT09c3RydW5kZWZpbmVkKXtkaXYuc3R5bGUuY3NzVGV4dD0iYm9yZGVyOjA7bWFyZ2luOjA7d2lkdGg6MXB4O3BhZGRpbmc6MXB4O2Rpc3BsYXk6aW5saW5lO3pvb206MSI7aWYoKHN1cHBvcnQuaW5saW5lQmxvY2tOZWVkc0xheW91dD0oZGl2Lm9mZnNldFdpZHRoPT09MykpKXtib2R5LnN0eWxlLnpvb209MTt9fQpib2R5LnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7Y29udGFpbmVyPWRpdj1udWxsO30pOyhmdW5jdGlvbigpe3ZhciBkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7aWYoc3VwcG9ydC5kZWxldGVFeHBhbmRvPT1udWxsKXtzdXBwb3J0LmRlbGV0ZUV4cGFuZG89dHJ1ZTt0cnl7ZGVsZXRlIGRpdi50ZXN0O31jYXRjaChlKXtzdXBwb3J0LmRlbGV0ZUV4cGFuZG89ZmFsc2U7fX0KZGl2PW51bGw7fSkoKTtqUXVlcnkuYWNjZXB0RGF0YT1mdW5jdGlvbihlbGVtKXt2YXIgbm9EYXRhPWpRdWVyeS5ub0RhdGFbKGVsZW0ubm9kZU5hbWUrIiAiKS50b0xvd2VyQ2FzZSgpXSxub2RlVHlwZT0rZWxlbS5ub2RlVHlwZXx8MTtyZXR1cm4gbm9kZVR5cGUhPT0xJiZub2RlVHlwZSE9PTk/ZmFsc2U6IW5vRGF0YXx8bm9EYXRhIT09dHJ1ZSYmZWxlbS5nZXRBdHRyaWJ1dGUoImNsYXNzaWQiKT09PW5vRGF0YTt9O3ZhciByYnJhY2U9L14oPzpce1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLyxybXVsdGlEYXNoPS8oW0EtWl0pL2c7ZnVuY3Rpb24gZGF0YUF0dHIoZWxlbSxrZXksZGF0YSl7aWYoZGF0YT09PXVuZGVmaW5lZCYmZWxlbS5ub2RlVHlwZT09PTEpe3ZhciBuYW1lPSJkYXRhLSIra2V5LnJlcGxhY2Uocm11bHRpRGFzaCwiLSQxIikudG9Mb3dlckNhc2UoKTtkYXRhPWVsZW0uZ2V0QXR0cmlidXRlKG5hbWUpO2lmKHR5cGVvZiBkYXRhPT09InN0cmluZyIpe3RyeXtkYXRhPWRhdGE9PT0idHJ1ZSI/dHJ1ZTpkYXRhPT09ImZhbHNlIj9mYWxzZTpkYXRhPT09Im51bGwiP251bGw6K2RhdGErIiI9PT1kYXRhPytkYXRhOnJicmFjZS50ZXN0KGRhdGEpP2pRdWVyeS5wYXJzZUpTT04oZGF0YSk6ZGF0YTt9Y2F0Y2goZSl7fQpqUXVlcnkuZGF0YShlbGVtLGtleSxkYXRhKTt9ZWxzZXtkYXRhPXVuZGVmaW5lZDt9fQpyZXR1cm4gZGF0YTt9CmZ1bmN0aW9uIGlzRW1wdHlEYXRhT2JqZWN0KG9iail7dmFyIG5hbWU7Zm9yKG5hbWUgaW4gb2JqKXtpZihuYW1lPT09ImRhdGEiJiZqUXVlcnkuaXNFbXB0eU9iamVjdChvYmpbbmFtZV0pKXtjb250aW51ZTt9CmlmKG5hbWUhPT0idG9KU09OIil7cmV0dXJuIGZhbHNlO319CnJldHVybiB0cnVlO30KZnVuY3Rpb24gaW50ZXJuYWxEYXRhKGVsZW0sbmFtZSxkYXRhLHB2dCl7aWYoIWpRdWVyeS5hY2NlcHREYXRhKGVsZW0pKXtyZXR1cm47fQp2YXIgcmV0LHRoaXNDYWNoZSxpbnRlcm5hbEtleT1qUXVlcnkuZXhwYW5kbyxpc05vZGU9ZWxlbS5ub2RlVHlwZSxjYWNoZT1pc05vZGU/alF1ZXJ5LmNhY2hlOmVsZW0saWQ9aXNOb2RlP2VsZW1baW50ZXJuYWxLZXldOmVsZW1baW50ZXJuYWxLZXldJiZpbnRlcm5hbEtleTtpZigoIWlkfHwhY2FjaGVbaWRdfHwoIXB2dCYmIWNhY2hlW2lkXS5kYXRhKSkmJmRhdGE9PT11bmRlZmluZWQmJnR5cGVvZiBuYW1lPT09InN0cmluZyIpe3JldHVybjt9CmlmKCFpZCl7aWYoaXNOb2RlKXtpZD1lbGVtW2ludGVybmFsS2V5XT1kZWxldGVkSWRzLnBvcCgpfHxqUXVlcnkuZ3VpZCsrO31lbHNle2lkPWludGVybmFsS2V5O319CmlmKCFjYWNoZVtpZF0pe2NhY2hlW2lkXT1pc05vZGU/e306e3RvSlNPTjpqUXVlcnkubm9vcH07fQppZih0eXBlb2YgbmFtZT09PSJvYmplY3QifHx0eXBlb2YgbmFtZT09PSJmdW5jdGlvbiIpe2lmKHB2dCl7Y2FjaGVbaWRdPWpRdWVyeS5leHRlbmQoY2FjaGVbaWRdLG5hbWUpO31lbHNle2NhY2hlW2lkXS5kYXRhPWpRdWVyeS5leHRlbmQoY2FjaGVbaWRdLmRhdGEsbmFtZSk7fX0KdGhpc0NhY2hlPWNhY2hlW2lkXTtpZighcHZ0KXtpZighdGhpc0NhY2hlLmRhdGEpe3RoaXNDYWNoZS5kYXRhPXt9O30KdGhpc0NhY2hlPXRoaXNDYWNoZS5kYXRhO30KaWYoZGF0YSE9PXVuZGVmaW5lZCl7dGhpc0NhY2hlW2pRdWVyeS5jYW1lbENhc2UobmFtZSldPWRhdGE7fQppZih0eXBlb2YgbmFtZT09PSJzdHJpbmciKXtyZXQ9dGhpc0NhY2hlW25hbWVdO2lmKHJldD09bnVsbCl7cmV0PXRoaXNDYWNoZVtqUXVlcnkuY2FtZWxDYXNlKG5hbWUpXTt9fWVsc2V7cmV0PXRoaXNDYWNoZTt9CnJldHVybiByZXQ7fQpmdW5jdGlvbiBpbnRlcm5hbFJlbW92ZURhdGEoZWxlbSxuYW1lLHB2dCl7aWYoIWpRdWVyeS5hY2NlcHREYXRhKGVsZW0pKXtyZXR1cm47fQp2YXIgdGhpc0NhY2hlLGksaXNOb2RlPWVsZW0ubm9kZVR5cGUsY2FjaGU9aXNOb2RlP2pRdWVyeS5jYWNoZTplbGVtLGlkPWlzTm9kZT9lbGVtW2pRdWVyeS5leHBhbmRvXTpqUXVlcnkuZXhwYW5kbztpZighY2FjaGVbaWRdKXtyZXR1cm47fQppZihuYW1lKXt0aGlzQ2FjaGU9cHZ0P2NhY2hlW2lkXTpjYWNoZVtpZF0uZGF0YTtpZih0aGlzQ2FjaGUpe2lmKCFqUXVlcnkuaXNBcnJheShuYW1lKSl7aWYobmFtZSBpbiB0aGlzQ2FjaGUpe25hbWU9W25hbWVdO31lbHNle25hbWU9alF1ZXJ5LmNhbWVsQ2FzZShuYW1lKTtpZihuYW1lIGluIHRoaXNDYWNoZSl7bmFtZT1bbmFtZV07fWVsc2V7bmFtZT1uYW1lLnNwbGl0KCIgIik7fX19ZWxzZXtuYW1lPW5hbWUuY29uY2F0KGpRdWVyeS5tYXAobmFtZSxqUXVlcnkuY2FtZWxDYXNlKSk7fQppPW5hbWUubGVuZ3RoO3doaWxlKGktLSl7ZGVsZXRlIHRoaXNDYWNoZVtuYW1lW2ldXTt9CmlmKHB2dD8haXNFbXB0eURhdGFPYmplY3QodGhpc0NhY2hlKTohalF1ZXJ5LmlzRW1wdHlPYmplY3QodGhpc0NhY2hlKSl7cmV0dXJuO319fQppZighcHZ0KXtkZWxldGUgY2FjaGVbaWRdLmRhdGE7aWYoIWlzRW1wdHlEYXRhT2JqZWN0KGNhY2hlW2lkXSkpe3JldHVybjt9fQppZihpc05vZGUpe2pRdWVyeS5jbGVhbkRhdGEoW2VsZW1dLHRydWUpO31lbHNlIGlmKHN1cHBvcnQuZGVsZXRlRXhwYW5kb3x8Y2FjaGUhPWNhY2hlLndpbmRvdyl7ZGVsZXRlIGNhY2hlW2lkXTt9ZWxzZXtjYWNoZVtpZF09bnVsbDt9fQpqUXVlcnkuZXh0ZW5kKHtjYWNoZTp7fSxub0RhdGE6eyJhcHBsZXQgIjp0cnVlLCJlbWJlZCAiOnRydWUsIm9iamVjdCAiOiJjbHNpZDpEMjdDREI2RS1BRTZELTExY2YtOTZCOC00NDQ1NTM1NDAwMDAifSxoYXNEYXRhOmZ1bmN0aW9uKGVsZW0pe2VsZW09ZWxlbS5ub2RlVHlwZT9qUXVlcnkuY2FjaGVbZWxlbVtqUXVlcnkuZXhwYW5kb11dOmVsZW1balF1ZXJ5LmV4cGFuZG9dO3JldHVybiEhZWxlbSYmIWlzRW1wdHlEYXRhT2JqZWN0KGVsZW0pO30sZGF0YTpmdW5jdGlvbihlbGVtLG5hbWUsZGF0YSl7cmV0dXJuIGludGVybmFsRGF0YShlbGVtLG5hbWUsZGF0YSk7fSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGVsZW0sbmFtZSl7cmV0dXJuIGludGVybmFsUmVtb3ZlRGF0YShlbGVtLG5hbWUpO30sX2RhdGE6ZnVuY3Rpb24oZWxlbSxuYW1lLGRhdGEpe3JldHVybiBpbnRlcm5hbERhdGEoZWxlbSxuYW1lLGRhdGEsdHJ1ZSk7fSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihlbGVtLG5hbWUpe3JldHVybiBpbnRlcm5hbFJlbW92ZURhdGEoZWxlbSxuYW1lLHRydWUpO319KTtqUXVlcnkuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGtleSx2YWx1ZSl7dmFyIGksbmFtZSxkYXRhLGVsZW09dGhpc1swXSxhdHRycz1lbGVtJiZlbGVtLmF0dHJpYnV0ZXM7aWYoa2V5PT09dW5kZWZpbmVkKXtpZih0aGlzLmxlbmd0aCl7ZGF0YT1qUXVlcnkuZGF0YShlbGVtKTtpZihlbGVtLm5vZGVUeXBlPT09MSYmIWpRdWVyeS5fZGF0YShlbGVtLCJwYXJzZWRBdHRycyIpKXtpPWF0dHJzLmxlbmd0aDt3aGlsZShpLS0pe25hbWU9YXR0cnNbaV0ubmFtZTtpZihuYW1lLmluZGV4T2YoImRhdGEtIik9PT0wKXtuYW1lPWpRdWVyeS5jYW1lbENhc2UobmFtZS5zbGljZSg1KSk7ZGF0YUF0dHIoZWxlbSxuYW1lLGRhdGFbbmFtZV0pO319CmpRdWVyeS5fZGF0YShlbGVtLCJwYXJzZWRBdHRycyIsdHJ1ZSk7fX0KcmV0dXJuIGRhdGE7fQppZih0eXBlb2Yga2V5PT09Im9iamVjdCIpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkuZGF0YSh0aGlzLGtleSk7fSk7fQpyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4xP3RoaXMuZWFjaChmdW5jdGlvbigpe2pRdWVyeS5kYXRhKHRoaXMsa2V5LHZhbHVlKTt9KTplbGVtP2RhdGFBdHRyKGVsZW0sa2V5LGpRdWVyeS5kYXRhKGVsZW0sa2V5KSk6dW5kZWZpbmVkO30scmVtb3ZlRGF0YTpmdW5jdGlvbihrZXkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkucmVtb3ZlRGF0YSh0aGlzLGtleSk7fSk7fX0pO2pRdWVyeS5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGVsZW0sdHlwZSxkYXRhKXt2YXIgcXVldWU7aWYoZWxlbSl7dHlwZT0odHlwZXx8ImZ4IikrInF1ZXVlIjtxdWV1ZT1qUXVlcnkuX2RhdGEoZWxlbSx0eXBlKTtpZihkYXRhKXtpZighcXVldWV8fGpRdWVyeS5pc0FycmF5KGRhdGEpKXtxdWV1ZT1qUXVlcnkuX2RhdGEoZWxlbSx0eXBlLGpRdWVyeS5tYWtlQXJyYXkoZGF0YSkpO31lbHNle3F1ZXVlLnB1c2goZGF0YSk7fX0KcmV0dXJuIHF1ZXVlfHxbXTt9fSxkZXF1ZXVlOmZ1bmN0aW9uKGVsZW0sdHlwZSl7dHlwZT10eXBlfHwiZngiO3ZhciBxdWV1ZT1qUXVlcnkucXVldWUoZWxlbSx0eXBlKSxzdGFydExlbmd0aD1xdWV1ZS5sZW5ndGgsZm49cXVldWUuc2hpZnQoKSxob29rcz1qUXVlcnkuX3F1ZXVlSG9va3MoZWxlbSx0eXBlKSxuZXh0PWZ1bmN0aW9uKCl7alF1ZXJ5LmRlcXVldWUoZWxlbSx0eXBlKTt9O2lmKGZuPT09ImlucHJvZ3Jlc3MiKXtmbj1xdWV1ZS5zaGlmdCgpO3N0YXJ0TGVuZ3RoLS07fQppZihmbil7aWYodHlwZT09PSJmeCIpe3F1ZXVlLnVuc2hpZnQoImlucHJvZ3Jlc3MiKTt9CmRlbGV0ZSBob29rcy5zdG9wO2ZuLmNhbGwoZWxlbSxuZXh0LGhvb2tzKTt9CmlmKCFzdGFydExlbmd0aCYmaG9va3Mpe2hvb2tzLmVtcHR5LmZpcmUoKTt9fSxfcXVldWVIb29rczpmdW5jdGlvbihlbGVtLHR5cGUpe3ZhciBrZXk9dHlwZSsicXVldWVIb29rcyI7cmV0dXJuIGpRdWVyeS5fZGF0YShlbGVtLGtleSl8fGpRdWVyeS5fZGF0YShlbGVtLGtleSx7ZW1wdHk6alF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKS5hZGQoZnVuY3Rpb24oKXtqUXVlcnkuX3JlbW92ZURhdGEoZWxlbSx0eXBlKyJxdWV1ZSIpO2pRdWVyeS5fcmVtb3ZlRGF0YShlbGVtLGtleSk7fSl9KTt9fSk7alF1ZXJ5LmZuLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24odHlwZSxkYXRhKXt2YXIgc2V0dGVyPTI7aWYodHlwZW9mIHR5cGUhPT0ic3RyaW5nIil7ZGF0YT10eXBlO3R5cGU9ImZ4IjtzZXR0ZXItLTt9CmlmKGFyZ3VtZW50cy5sZW5ndGg8c2V0dGVyKXtyZXR1cm4galF1ZXJ5LnF1ZXVlKHRoaXNbMF0sdHlwZSk7fQpyZXR1cm4gZGF0YT09PXVuZGVmaW5lZD90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBxdWV1ZT1qUXVlcnkucXVldWUodGhpcyx0eXBlLGRhdGEpO2pRdWVyeS5fcXVldWVIb29rcyh0aGlzLHR5cGUpO2lmKHR5cGU9PT0iZngiJiZxdWV1ZVswXSE9PSJpbnByb2dyZXNzIil7alF1ZXJ5LmRlcXVldWUodGhpcyx0eXBlKTt9fSk7fSxkZXF1ZXVlOmZ1bmN0aW9uKHR5cGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkuZGVxdWV1ZSh0aGlzLHR5cGUpO30pO30sY2xlYXJRdWV1ZTpmdW5jdGlvbih0eXBlKXtyZXR1cm4gdGhpcy5xdWV1ZSh0eXBlfHwiZngiLFtdKTt9LHByb21pc2U6ZnVuY3Rpb24odHlwZSxvYmope3ZhciB0bXAsY291bnQ9MSxkZWZlcj1qUXVlcnkuRGVmZXJyZWQoKSxlbGVtZW50cz10aGlzLGk9dGhpcy5sZW5ndGgscmVzb2x2ZT1mdW5jdGlvbigpe2lmKCEoLS1jb3VudCkpe2RlZmVyLnJlc29sdmVXaXRoKGVsZW1lbnRzLFtlbGVtZW50c10pO319O2lmKHR5cGVvZiB0eXBlIT09InN0cmluZyIpe29iaj10eXBlO3R5cGU9dW5kZWZpbmVkO30KdHlwZT10eXBlfHwiZngiO3doaWxlKGktLSl7dG1wPWpRdWVyeS5fZGF0YShlbGVtZW50c1tpXSx0eXBlKyJxdWV1ZUhvb2tzIik7aWYodG1wJiZ0bXAuZW1wdHkpe2NvdW50Kys7dG1wLmVtcHR5LmFkZChyZXNvbHZlKTt9fQpyZXNvbHZlKCk7cmV0dXJuIGRlZmVyLnByb21pc2Uob2JqKTt9fSk7dmFyIHBudW09KC9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8pLnNvdXJjZTt2YXIgY3NzRXhwYW5kPVsiVG9wIiwiUmlnaHQiLCJCb3R0b20iLCJMZWZ0Il07dmFyIGlzSGlkZGVuPWZ1bmN0aW9uKGVsZW0sZWwpe2VsZW09ZWx8fGVsZW07cmV0dXJuIGpRdWVyeS5jc3MoZWxlbSwiZGlzcGxheSIpPT09Im5vbmUifHwhalF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCxlbGVtKTt9O3ZhciBhY2Nlc3M9alF1ZXJ5LmFjY2Vzcz1mdW5jdGlvbihlbGVtcyxmbixrZXksdmFsdWUsY2hhaW5hYmxlLGVtcHR5R2V0LHJhdyl7dmFyIGk9MCxsZW5ndGg9ZWxlbXMubGVuZ3RoLGJ1bGs9a2V5PT1udWxsO2lmKGpRdWVyeS50eXBlKGtleSk9PT0ib2JqZWN0Iil7Y2hhaW5hYmxlPXRydWU7Zm9yKGkgaW4ga2V5KXtqUXVlcnkuYWNjZXNzKGVsZW1zLGZuLGksa2V5W2ldLHRydWUsZW1wdHlHZXQscmF3KTt9fWVsc2UgaWYodmFsdWUhPT11bmRlZmluZWQpe2NoYWluYWJsZT10cnVlO2lmKCFqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpe3Jhdz10cnVlO30KaWYoYnVsayl7aWYocmF3KXtmbi5jYWxsKGVsZW1zLHZhbHVlKTtmbj1udWxsO31lbHNle2J1bGs9Zm47Zm49ZnVuY3Rpb24oZWxlbSxrZXksdmFsdWUpe3JldHVybiBidWxrLmNhbGwoalF1ZXJ5KGVsZW0pLHZhbHVlKTt9O319CmlmKGZuKXtmb3IoO2k8bGVuZ3RoO2krKyl7Zm4oZWxlbXNbaV0sa2V5LHJhdz92YWx1ZTp2YWx1ZS5jYWxsKGVsZW1zW2ldLGksZm4oZWxlbXNbaV0sa2V5KSkpO319fQpyZXR1cm4gY2hhaW5hYmxlP2VsZW1zOmJ1bGs/Zm4uY2FsbChlbGVtcyk6bGVuZ3RoP2ZuKGVsZW1zWzBdLGtleSk6ZW1wdHlHZXQ7fTt2YXIgcmNoZWNrYWJsZVR5cGU9KC9eKD86Y2hlY2tib3h8cmFkaW8pJC9pKTsoZnVuY3Rpb24oKXt2YXIgZnJhZ21lbnQ9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxpbnB1dD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO2Rpdi5zZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIsInQiKTtkaXYuaW5uZXJIVE1MPSIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT4iO3N1cHBvcnQubGVhZGluZ1doaXRlc3BhY2U9ZGl2LmZpcnN0Q2hpbGQubm9kZVR5cGU9PT0zO3N1cHBvcnQudGJvZHk9IWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGJvZHkiKS5sZW5ndGg7c3VwcG9ydC5odG1sU2VyaWFsaXplPSEhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJsaW5rIikubGVuZ3RoO3N1cHBvcnQuaHRtbDVDbG9uZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJuYXYiKS5jbG9uZU5vZGUodHJ1ZSkub3V0ZXJIVE1MIT09Ijw6bmF2PjwvOm5hdj4iO2lucHV0LnR5cGU9ImNoZWNrYm94IjtpbnB1dC5jaGVja2VkPXRydWU7ZnJhZ21lbnQuYXBwZW5kQ2hpbGQoaW5wdXQpO3N1cHBvcnQuYXBwZW5kQ2hlY2tlZD1pbnB1dC5jaGVja2VkO2Rpdi5pbm5lckhUTUw9Ijx0ZXh0YXJlYT54PC90ZXh0YXJlYT4iO3N1cHBvcnQubm9DbG9uZUNoZWNrZWQ9ISFkaXYuY2xvbmVOb2RlKHRydWUpLmxhc3RDaGlsZC5kZWZhdWx0VmFsdWU7ZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZGl2KTtkaXYuaW5uZXJIVE1MPSI8aW5wdXQgdHlwZT0ncmFkaW8nIGNoZWNrZWQ9J2NoZWNrZWQnIG5hbWU9J3QnLz4iO3N1cHBvcnQuY2hlY2tDbG9uZT1kaXYuY2xvbmVOb2RlKHRydWUpLmNsb25lTm9kZSh0cnVlKS5sYXN0Q2hpbGQuY2hlY2tlZDtzdXBwb3J0Lm5vQ2xvbmVFdmVudD10cnVlO2lmKGRpdi5hdHRhY2hFdmVudCl7ZGl2LmF0dGFjaEV2ZW50KCJvbmNsaWNrIixmdW5jdGlvbigpe3N1cHBvcnQubm9DbG9uZUV2ZW50PWZhbHNlO30pO2Rpdi5jbG9uZU5vZGUodHJ1ZSkuY2xpY2soKTt9CmlmKHN1cHBvcnQuZGVsZXRlRXhwYW5kbz09bnVsbCl7c3VwcG9ydC5kZWxldGVFeHBhbmRvPXRydWU7dHJ5e2RlbGV0ZSBkaXYudGVzdDt9Y2F0Y2goZSl7c3VwcG9ydC5kZWxldGVFeHBhbmRvPWZhbHNlO319CmZyYWdtZW50PWRpdj1pbnB1dD1udWxsO30pKCk7KGZ1bmN0aW9uKCl7dmFyIGksZXZlbnROYW1lLGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtmb3IoaSBpbntzdWJtaXQ6dHJ1ZSxjaGFuZ2U6dHJ1ZSxmb2N1c2luOnRydWV9KXtldmVudE5hbWU9Im9uIitpO2lmKCEoc3VwcG9ydFtpKyJCdWJibGVzIl09ZXZlbnROYW1lIGluIHdpbmRvdykpe2Rpdi5zZXRBdHRyaWJ1dGUoZXZlbnROYW1lLCJ0Iik7c3VwcG9ydFtpKyJCdWJibGVzIl09ZGl2LmF0dHJpYnV0ZXNbZXZlbnROYW1lXS5leHBhbmRvPT09ZmFsc2U7fX0KZGl2PW51bGw7fSkoKTt2YXIgcmZvcm1FbGVtcz0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYSkkL2kscmtleUV2ZW50PS9ea2V5LyxybW91c2VFdmVudD0vXig/Om1vdXNlfGNvbnRleHRtZW51KXxjbGljay8scmZvY3VzTW9ycGg9L14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLHJ0eXBlbmFtZXNwYWNlPS9eKFteLl0qKSg/OlwuKC4rKXwpJC87ZnVuY3Rpb24gcmV0dXJuVHJ1ZSgpe3JldHVybiB0cnVlO30KZnVuY3Rpb24gcmV0dXJuRmFsc2UoKXtyZXR1cm4gZmFsc2U7fQpmdW5jdGlvbiBzYWZlQWN0aXZlRWxlbWVudCgpe3RyeXtyZXR1cm4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDt9Y2F0Y2goZXJyKXt9fQpqUXVlcnkuZXZlbnQ9e2dsb2JhbDp7fSxhZGQ6ZnVuY3Rpb24oZWxlbSx0eXBlcyxoYW5kbGVyLGRhdGEsc2VsZWN0b3Ipe3ZhciB0bXAsZXZlbnRzLHQsaGFuZGxlT2JqSW4sc3BlY2lhbCxldmVudEhhbmRsZSxoYW5kbGVPYmosaGFuZGxlcnMsdHlwZSxuYW1lc3BhY2VzLG9yaWdUeXBlLGVsZW1EYXRhPWpRdWVyeS5fZGF0YShlbGVtKTtpZighZWxlbURhdGEpe3JldHVybjt9CmlmKGhhbmRsZXIuaGFuZGxlcil7aGFuZGxlT2JqSW49aGFuZGxlcjtoYW5kbGVyPWhhbmRsZU9iakluLmhhbmRsZXI7c2VsZWN0b3I9aGFuZGxlT2JqSW4uc2VsZWN0b3I7fQppZighaGFuZGxlci5ndWlkKXtoYW5kbGVyLmd1aWQ9alF1ZXJ5Lmd1aWQrKzt9CmlmKCEoZXZlbnRzPWVsZW1EYXRhLmV2ZW50cykpe2V2ZW50cz1lbGVtRGF0YS5ldmVudHM9e307fQppZighKGV2ZW50SGFuZGxlPWVsZW1EYXRhLmhhbmRsZSkpe2V2ZW50SGFuZGxlPWVsZW1EYXRhLmhhbmRsZT1mdW5jdGlvbihlKXtyZXR1cm4gdHlwZW9mIGpRdWVyeSE9PXN0cnVuZGVmaW5lZCYmKCFlfHxqUXVlcnkuZXZlbnQudHJpZ2dlcmVkIT09ZS50eXBlKT9qUXVlcnkuZXZlbnQuZGlzcGF0Y2guYXBwbHkoZXZlbnRIYW5kbGUuZWxlbSxhcmd1bWVudHMpOnVuZGVmaW5lZDt9O2V2ZW50SGFuZGxlLmVsZW09ZWxlbTt9CnR5cGVzPSh0eXBlc3x8IiIpLm1hdGNoKHJub3R3aGl0ZSl8fFsiIl07dD10eXBlcy5sZW5ndGg7d2hpbGUodC0tKXt0bXA9cnR5cGVuYW1lc3BhY2UuZXhlYyh0eXBlc1t0XSl8fFtdO3R5cGU9b3JpZ1R5cGU9dG1wWzFdO25hbWVzcGFjZXM9KHRtcFsyXXx8IiIpLnNwbGl0KCIuIikuc29ydCgpO2lmKCF0eXBlKXtjb250aW51ZTt9CnNwZWNpYWw9alF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV18fHt9O3R5cGU9KHNlbGVjdG9yP3NwZWNpYWwuZGVsZWdhdGVUeXBlOnNwZWNpYWwuYmluZFR5cGUpfHx0eXBlO3NwZWNpYWw9alF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV18fHt9O2hhbmRsZU9iaj1qUXVlcnkuZXh0ZW5kKHt0eXBlOnR5cGUsb3JpZ1R5cGU6b3JpZ1R5cGUsZGF0YTpkYXRhLGhhbmRsZXI6aGFuZGxlcixndWlkOmhhbmRsZXIuZ3VpZCxzZWxlY3RvcjpzZWxlY3RvcixuZWVkc0NvbnRleHQ6c2VsZWN0b3ImJmpRdWVyeS5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KHNlbGVjdG9yKSxuYW1lc3BhY2U6bmFtZXNwYWNlcy5qb2luKCIuIil9LGhhbmRsZU9iakluKTtpZighKGhhbmRsZXJzPWV2ZW50c1t0eXBlXSkpe2hhbmRsZXJzPWV2ZW50c1t0eXBlXT1bXTtoYW5kbGVycy5kZWxlZ2F0ZUNvdW50PTA7aWYoIXNwZWNpYWwuc2V0dXB8fHNwZWNpYWwuc2V0dXAuY2FsbChlbGVtLGRhdGEsbmFtZXNwYWNlcyxldmVudEhhbmRsZSk9PT1mYWxzZSl7aWYoZWxlbS5hZGRFdmVudExpc3RlbmVyKXtlbGVtLmFkZEV2ZW50TGlzdGVuZXIodHlwZSxldmVudEhhbmRsZSxmYWxzZSk7fWVsc2UgaWYoZWxlbS5hdHRhY2hFdmVudCl7ZWxlbS5hdHRhY2hFdmVudCgib24iK3R5cGUsZXZlbnRIYW5kbGUpO319fQppZihzcGVjaWFsLmFkZCl7c3BlY2lhbC5hZGQuY2FsbChlbGVtLGhhbmRsZU9iaik7aWYoIWhhbmRsZU9iai5oYW5kbGVyLmd1aWQpe2hhbmRsZU9iai5oYW5kbGVyLmd1aWQ9aGFuZGxlci5ndWlkO319CmlmKHNlbGVjdG9yKXtoYW5kbGVycy5zcGxpY2UoaGFuZGxlcnMuZGVsZWdhdGVDb3VudCsrLDAsaGFuZGxlT2JqKTt9ZWxzZXtoYW5kbGVycy5wdXNoKGhhbmRsZU9iaik7fQpqUXVlcnkuZXZlbnQuZ2xvYmFsW3R5cGVdPXRydWU7fQplbGVtPW51bGw7fSxyZW1vdmU6ZnVuY3Rpb24oZWxlbSx0eXBlcyxoYW5kbGVyLHNlbGVjdG9yLG1hcHBlZFR5cGVzKXt2YXIgaixoYW5kbGVPYmosdG1wLG9yaWdDb3VudCx0LGV2ZW50cyxzcGVjaWFsLGhhbmRsZXJzLHR5cGUsbmFtZXNwYWNlcyxvcmlnVHlwZSxlbGVtRGF0YT1qUXVlcnkuaGFzRGF0YShlbGVtKSYmalF1ZXJ5Ll9kYXRhKGVsZW0pO2lmKCFlbGVtRGF0YXx8IShldmVudHM9ZWxlbURhdGEuZXZlbnRzKSl7cmV0dXJuO30KdHlwZXM9KHR5cGVzfHwiIikubWF0Y2gocm5vdHdoaXRlKXx8WyIiXTt0PXR5cGVzLmxlbmd0aDt3aGlsZSh0LS0pe3RtcD1ydHlwZW5hbWVzcGFjZS5leGVjKHR5cGVzW3RdKXx8W107dHlwZT1vcmlnVHlwZT10bXBbMV07bmFtZXNwYWNlcz0odG1wWzJdfHwiIikuc3BsaXQoIi4iKS5zb3J0KCk7aWYoIXR5cGUpe2Zvcih0eXBlIGluIGV2ZW50cyl7alF1ZXJ5LmV2ZW50LnJlbW92ZShlbGVtLHR5cGUrdHlwZXNbdF0saGFuZGxlcixzZWxlY3Rvcix0cnVlKTt9CmNvbnRpbnVlO30Kc3BlY2lhbD1qUXVlcnkuZXZlbnQuc3BlY2lhbFt0eXBlXXx8e307dHlwZT0oc2VsZWN0b3I/c3BlY2lhbC5kZWxlZ2F0ZVR5cGU6c3BlY2lhbC5iaW5kVHlwZSl8fHR5cGU7aGFuZGxlcnM9ZXZlbnRzW3R5cGVdfHxbXTt0bXA9dG1wWzJdJiZuZXcgUmVnRXhwKCIoXnxcXC4pIituYW1lc3BhY2VzLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpO29yaWdDb3VudD1qPWhhbmRsZXJzLmxlbmd0aDt3aGlsZShqLS0pe2hhbmRsZU9iaj1oYW5kbGVyc1tqXTtpZigobWFwcGVkVHlwZXN8fG9yaWdUeXBlPT09aGFuZGxlT2JqLm9yaWdUeXBlKSYmKCFoYW5kbGVyfHxoYW5kbGVyLmd1aWQ9PT1oYW5kbGVPYmouZ3VpZCkmJighdG1wfHx0bXAudGVzdChoYW5kbGVPYmoubmFtZXNwYWNlKSkmJighc2VsZWN0b3J8fHNlbGVjdG9yPT09aGFuZGxlT2JqLnNlbGVjdG9yfHxzZWxlY3Rvcj09PSIqKiImJmhhbmRsZU9iai5zZWxlY3Rvcikpe2hhbmRsZXJzLnNwbGljZShqLDEpO2lmKGhhbmRsZU9iai5zZWxlY3Rvcil7aGFuZGxlcnMuZGVsZWdhdGVDb3VudC0tO30KaWYoc3BlY2lhbC5yZW1vdmUpe3NwZWNpYWwucmVtb3ZlLmNhbGwoZWxlbSxoYW5kbGVPYmopO319fQppZihvcmlnQ291bnQmJiFoYW5kbGVycy5sZW5ndGgpe2lmKCFzcGVjaWFsLnRlYXJkb3dufHxzcGVjaWFsLnRlYXJkb3duLmNhbGwoZWxlbSxuYW1lc3BhY2VzLGVsZW1EYXRhLmhhbmRsZSk9PT1mYWxzZSl7alF1ZXJ5LnJlbW92ZUV2ZW50KGVsZW0sdHlwZSxlbGVtRGF0YS5oYW5kbGUpO30KZGVsZXRlIGV2ZW50c1t0eXBlXTt9fQppZihqUXVlcnkuaXNFbXB0eU9iamVjdChldmVudHMpKXtkZWxldGUgZWxlbURhdGEuaGFuZGxlO2pRdWVyeS5fcmVtb3ZlRGF0YShlbGVtLCJldmVudHMiKTt9fSx0cmlnZ2VyOmZ1bmN0aW9uKGV2ZW50LGRhdGEsZWxlbSxvbmx5SGFuZGxlcnMpe3ZhciBoYW5kbGUsb250eXBlLGN1cixidWJibGVUeXBlLHNwZWNpYWwsdG1wLGksZXZlbnRQYXRoPVtlbGVtfHxkb2N1bWVudF0sdHlwZT1oYXNPd24uY2FsbChldmVudCwidHlwZSIpP2V2ZW50LnR5cGU6ZXZlbnQsbmFtZXNwYWNlcz1oYXNPd24uY2FsbChldmVudCwibmFtZXNwYWNlIik/ZXZlbnQubmFtZXNwYWNlLnNwbGl0KCIuIik6W107Y3VyPXRtcD1lbGVtPWVsZW18fGRvY3VtZW50O2lmKGVsZW0ubm9kZVR5cGU9PT0zfHxlbGVtLm5vZGVUeXBlPT09OCl7cmV0dXJuO30KaWYocmZvY3VzTW9ycGgudGVzdCh0eXBlK2pRdWVyeS5ldmVudC50cmlnZ2VyZWQpKXtyZXR1cm47fQppZih0eXBlLmluZGV4T2YoIi4iKT49MCl7bmFtZXNwYWNlcz10eXBlLnNwbGl0KCIuIik7dHlwZT1uYW1lc3BhY2VzLnNoaWZ0KCk7bmFtZXNwYWNlcy5zb3J0KCk7fQpvbnR5cGU9dHlwZS5pbmRleE9mKCI6Iik8MCYmIm9uIit0eXBlO2V2ZW50PWV2ZW50W2pRdWVyeS5leHBhbmRvXT9ldmVudDpuZXcgalF1ZXJ5LkV2ZW50KHR5cGUsdHlwZW9mIGV2ZW50PT09Im9iamVjdCImJmV2ZW50KTtldmVudC5pc1RyaWdnZXI9b25seUhhbmRsZXJzPzI6MztldmVudC5uYW1lc3BhY2U9bmFtZXNwYWNlcy5qb2luKCIuIik7ZXZlbnQubmFtZXNwYWNlX3JlPWV2ZW50Lm5hbWVzcGFjZT9uZXcgUmVnRXhwKCIoXnxcXC4pIituYW1lc3BhY2VzLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpOm51bGw7ZXZlbnQucmVzdWx0PXVuZGVmaW5lZDtpZighZXZlbnQudGFyZ2V0KXtldmVudC50YXJnZXQ9ZWxlbTt9CmRhdGE9ZGF0YT09bnVsbD9bZXZlbnRdOmpRdWVyeS5tYWtlQXJyYXkoZGF0YSxbZXZlbnRdKTtzcGVjaWFsPWpRdWVyeS5ldmVudC5zcGVjaWFsW3R5cGVdfHx7fTtpZighb25seUhhbmRsZXJzJiZzcGVjaWFsLnRyaWdnZXImJnNwZWNpYWwudHJpZ2dlci5hcHBseShlbGVtLGRhdGEpPT09ZmFsc2Upe3JldHVybjt9CmlmKCFvbmx5SGFuZGxlcnMmJiFzcGVjaWFsLm5vQnViYmxlJiYhalF1ZXJ5LmlzV2luZG93KGVsZW0pKXtidWJibGVUeXBlPXNwZWNpYWwuZGVsZWdhdGVUeXBlfHx0eXBlO2lmKCFyZm9jdXNNb3JwaC50ZXN0KGJ1YmJsZVR5cGUrdHlwZSkpe2N1cj1jdXIucGFyZW50Tm9kZTt9CmZvcig7Y3VyO2N1cj1jdXIucGFyZW50Tm9kZSl7ZXZlbnRQYXRoLnB1c2goY3VyKTt0bXA9Y3VyO30KaWYodG1wPT09KGVsZW0ub3duZXJEb2N1bWVudHx8ZG9jdW1lbnQpKXtldmVudFBhdGgucHVzaCh0bXAuZGVmYXVsdFZpZXd8fHRtcC5wYXJlbnRXaW5kb3d8fHdpbmRvdyk7fX0KaT0wO3doaWxlKChjdXI9ZXZlbnRQYXRoW2krK10pJiYhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSl7ZXZlbnQudHlwZT1pPjE/YnViYmxlVHlwZTpzcGVjaWFsLmJpbmRUeXBlfHx0eXBlO2hhbmRsZT0oalF1ZXJ5Ll9kYXRhKGN1ciwiZXZlbnRzIil8fHt9KVtldmVudC50eXBlXSYmalF1ZXJ5Ll9kYXRhKGN1ciwiaGFuZGxlIik7aWYoaGFuZGxlKXtoYW5kbGUuYXBwbHkoY3VyLGRhdGEpO30KaGFuZGxlPW9udHlwZSYmY3VyW29udHlwZV07aWYoaGFuZGxlJiZoYW5kbGUuYXBwbHkmJmpRdWVyeS5hY2NlcHREYXRhKGN1cikpe2V2ZW50LnJlc3VsdD1oYW5kbGUuYXBwbHkoY3VyLGRhdGEpO2lmKGV2ZW50LnJlc3VsdD09PWZhbHNlKXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO319fQpldmVudC50eXBlPXR5cGU7aWYoIW9ubHlIYW5kbGVycyYmIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKXtpZigoIXNwZWNpYWwuX2RlZmF1bHR8fHNwZWNpYWwuX2RlZmF1bHQuYXBwbHkoZXZlbnRQYXRoLnBvcCgpLGRhdGEpPT09ZmFsc2UpJiZqUXVlcnkuYWNjZXB0RGF0YShlbGVtKSl7aWYob250eXBlJiZlbGVtW3R5cGVdJiYhalF1ZXJ5LmlzV2luZG93KGVsZW0pKXt0bXA9ZWxlbVtvbnR5cGVdO2lmKHRtcCl7ZWxlbVtvbnR5cGVdPW51bGw7fQpqUXVlcnkuZXZlbnQudHJpZ2dlcmVkPXR5cGU7dHJ5e2VsZW1bdHlwZV0oKTt9Y2F0Y2goZSl7fQpqUXVlcnkuZXZlbnQudHJpZ2dlcmVkPXVuZGVmaW5lZDtpZih0bXApe2VsZW1bb250eXBlXT10bXA7fX19fQpyZXR1cm4gZXZlbnQucmVzdWx0O30sZGlzcGF0Y2g6ZnVuY3Rpb24oZXZlbnQpe2V2ZW50PWpRdWVyeS5ldmVudC5maXgoZXZlbnQpO3ZhciBpLHJldCxoYW5kbGVPYmosbWF0Y2hlZCxqLGhhbmRsZXJRdWV1ZT1bXSxhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzKSxoYW5kbGVycz0oalF1ZXJ5Ll9kYXRhKHRoaXMsImV2ZW50cyIpfHx7fSlbZXZlbnQudHlwZV18fFtdLHNwZWNpYWw9alF1ZXJ5LmV2ZW50LnNwZWNpYWxbZXZlbnQudHlwZV18fHt9O2FyZ3NbMF09ZXZlbnQ7ZXZlbnQuZGVsZWdhdGVUYXJnZXQ9dGhpcztpZihzcGVjaWFsLnByZURpc3BhdGNoJiZzcGVjaWFsLnByZURpc3BhdGNoLmNhbGwodGhpcyxldmVudCk9PT1mYWxzZSl7cmV0dXJuO30KaGFuZGxlclF1ZXVlPWpRdWVyeS5ldmVudC5oYW5kbGVycy5jYWxsKHRoaXMsZXZlbnQsaGFuZGxlcnMpO2k9MDt3aGlsZSgobWF0Y2hlZD1oYW5kbGVyUXVldWVbaSsrXSkmJiFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKXtldmVudC5jdXJyZW50VGFyZ2V0PW1hdGNoZWQuZWxlbTtqPTA7d2hpbGUoKGhhbmRsZU9iaj1tYXRjaGVkLmhhbmRsZXJzW2orK10pJiYhZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSl7aWYoIWV2ZW50Lm5hbWVzcGFjZV9yZXx8ZXZlbnQubmFtZXNwYWNlX3JlLnRlc3QoaGFuZGxlT2JqLm5hbWVzcGFjZSkpe2V2ZW50LmhhbmRsZU9iaj1oYW5kbGVPYmo7ZXZlbnQuZGF0YT1oYW5kbGVPYmouZGF0YTtyZXQ9KChqUXVlcnkuZXZlbnQuc3BlY2lhbFtoYW5kbGVPYmoub3JpZ1R5cGVdfHx7fSkuaGFuZGxlfHxoYW5kbGVPYmouaGFuZGxlcikuYXBwbHkobWF0Y2hlZC5lbGVtLGFyZ3MpO2lmKHJldCE9PXVuZGVmaW5lZCl7aWYoKGV2ZW50LnJlc3VsdD1yZXQpPT09ZmFsc2Upe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7fX19fX0KaWYoc3BlY2lhbC5wb3N0RGlzcGF0Y2gpe3NwZWNpYWwucG9zdERpc3BhdGNoLmNhbGwodGhpcyxldmVudCk7fQpyZXR1cm4gZXZlbnQucmVzdWx0O30saGFuZGxlcnM6ZnVuY3Rpb24oZXZlbnQsaGFuZGxlcnMpe3ZhciBzZWwsaGFuZGxlT2JqLG1hdGNoZXMsaSxoYW5kbGVyUXVldWU9W10sZGVsZWdhdGVDb3VudD1oYW5kbGVycy5kZWxlZ2F0ZUNvdW50LGN1cj1ldmVudC50YXJnZXQ7aWYoZGVsZWdhdGVDb3VudCYmY3VyLm5vZGVUeXBlJiYoIWV2ZW50LmJ1dHRvbnx8ZXZlbnQudHlwZSE9PSJjbGljayIpKXtmb3IoO2N1ciE9dGhpcztjdXI9Y3VyLnBhcmVudE5vZGV8fHRoaXMpe2lmKGN1ci5ub2RlVHlwZT09PTEmJihjdXIuZGlzYWJsZWQhPT10cnVlfHxldmVudC50eXBlIT09ImNsaWNrIikpe21hdGNoZXM9W107Zm9yKGk9MDtpPGRlbGVnYXRlQ291bnQ7aSsrKXtoYW5kbGVPYmo9aGFuZGxlcnNbaV07c2VsPWhhbmRsZU9iai5zZWxlY3RvcisiICI7aWYobWF0Y2hlc1tzZWxdPT09dW5kZWZpbmVkKXttYXRjaGVzW3NlbF09aGFuZGxlT2JqLm5lZWRzQ29udGV4dD9qUXVlcnkoc2VsLHRoaXMpLmluZGV4KGN1cik+PTA6alF1ZXJ5LmZpbmQoc2VsLHRoaXMsbnVsbCxbY3VyXSkubGVuZ3RoO30KaWYobWF0Y2hlc1tzZWxdKXttYXRjaGVzLnB1c2goaGFuZGxlT2JqKTt9fQppZihtYXRjaGVzLmxlbmd0aCl7aGFuZGxlclF1ZXVlLnB1c2goe2VsZW06Y3VyLGhhbmRsZXJzOm1hdGNoZXN9KTt9fX19CmlmKGRlbGVnYXRlQ291bnQ8aGFuZGxlcnMubGVuZ3RoKXtoYW5kbGVyUXVldWUucHVzaCh7ZWxlbTp0aGlzLGhhbmRsZXJzOmhhbmRsZXJzLnNsaWNlKGRlbGVnYXRlQ291bnQpfSk7fQpyZXR1cm4gaGFuZGxlclF1ZXVlO30sZml4OmZ1bmN0aW9uKGV2ZW50KXtpZihldmVudFtqUXVlcnkuZXhwYW5kb10pe3JldHVybiBldmVudDt9CnZhciBpLHByb3AsY29weSx0eXBlPWV2ZW50LnR5cGUsb3JpZ2luYWxFdmVudD1ldmVudCxmaXhIb29rPXRoaXMuZml4SG9va3NbdHlwZV07aWYoIWZpeEhvb2spe3RoaXMuZml4SG9va3NbdHlwZV09Zml4SG9vaz1ybW91c2VFdmVudC50ZXN0KHR5cGUpP3RoaXMubW91c2VIb29rczpya2V5RXZlbnQudGVzdCh0eXBlKT90aGlzLmtleUhvb2tzOnt9O30KY29weT1maXhIb29rLnByb3BzP3RoaXMucHJvcHMuY29uY2F0KGZpeEhvb2sucHJvcHMpOnRoaXMucHJvcHM7ZXZlbnQ9bmV3IGpRdWVyeS5FdmVudChvcmlnaW5hbEV2ZW50KTtpPWNvcHkubGVuZ3RoO3doaWxlKGktLSl7cHJvcD1jb3B5W2ldO2V2ZW50W3Byb3BdPW9yaWdpbmFsRXZlbnRbcHJvcF07fQppZighZXZlbnQudGFyZ2V0KXtldmVudC50YXJnZXQ9b3JpZ2luYWxFdmVudC5zcmNFbGVtZW50fHxkb2N1bWVudDt9CmlmKGV2ZW50LnRhcmdldC5ub2RlVHlwZT09PTMpe2V2ZW50LnRhcmdldD1ldmVudC50YXJnZXQucGFyZW50Tm9kZTt9CmV2ZW50Lm1ldGFLZXk9ISFldmVudC5tZXRhS2V5O3JldHVybiBmaXhIb29rLmZpbHRlcj9maXhIb29rLmZpbHRlcihldmVudCxvcmlnaW5hbEV2ZW50KTpldmVudDt9LHByb3BzOiJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2giLnNwbGl0KCIgIiksZml4SG9va3M6e30sa2V5SG9va3M6e3Byb3BzOiJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlIi5zcGxpdCgiICIpLGZpbHRlcjpmdW5jdGlvbihldmVudCxvcmlnaW5hbCl7aWYoZXZlbnQud2hpY2g9PW51bGwpe2V2ZW50LndoaWNoPW9yaWdpbmFsLmNoYXJDb2RlIT1udWxsP29yaWdpbmFsLmNoYXJDb2RlOm9yaWdpbmFsLmtleUNvZGU7fQpyZXR1cm4gZXZlbnQ7fX0sbW91c2VIb29rczp7cHJvcHM6ImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBmcm9tRWxlbWVudCBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudCIuc3BsaXQoIiAiKSxmaWx0ZXI6ZnVuY3Rpb24oZXZlbnQsb3JpZ2luYWwpe3ZhciBib2R5LGV2ZW50RG9jLGRvYyxidXR0b249b3JpZ2luYWwuYnV0dG9uLGZyb21FbGVtZW50PW9yaWdpbmFsLmZyb21FbGVtZW50O2lmKGV2ZW50LnBhZ2VYPT1udWxsJiZvcmlnaW5hbC5jbGllbnRYIT1udWxsKXtldmVudERvYz1ldmVudC50YXJnZXQub3duZXJEb2N1bWVudHx8ZG9jdW1lbnQ7ZG9jPWV2ZW50RG9jLmRvY3VtZW50RWxlbWVudDtib2R5PWV2ZW50RG9jLmJvZHk7ZXZlbnQucGFnZVg9b3JpZ2luYWwuY2xpZW50WCsoZG9jJiZkb2Muc2Nyb2xsTGVmdHx8Ym9keSYmYm9keS5zY3JvbGxMZWZ0fHwwKS0oZG9jJiZkb2MuY2xpZW50TGVmdHx8Ym9keSYmYm9keS5jbGllbnRMZWZ0fHwwKTtldmVudC5wYWdlWT1vcmlnaW5hbC5jbGllbnRZKyhkb2MmJmRvYy5zY3JvbGxUb3B8fGJvZHkmJmJvZHkuc2Nyb2xsVG9wfHwwKS0oZG9jJiZkb2MuY2xpZW50VG9wfHxib2R5JiZib2R5LmNsaWVudFRvcHx8MCk7fQppZighZXZlbnQucmVsYXRlZFRhcmdldCYmZnJvbUVsZW1lbnQpe2V2ZW50LnJlbGF0ZWRUYXJnZXQ9ZnJvbUVsZW1lbnQ9PT1ldmVudC50YXJnZXQ/b3JpZ2luYWwudG9FbGVtZW50OmZyb21FbGVtZW50O30KaWYoIWV2ZW50LndoaWNoJiZidXR0b24hPT11bmRlZmluZWQpe2V2ZW50LndoaWNoPShidXR0b24mMT8xOihidXR0b24mMj8zOihidXR0b24mND8yOjApKSk7fQpyZXR1cm4gZXZlbnQ7fX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6dHJ1ZX0sZm9jdXM6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZih0aGlzIT09c2FmZUFjdGl2ZUVsZW1lbnQoKSYmdGhpcy5mb2N1cyl7dHJ5e3RoaXMuZm9jdXMoKTtyZXR1cm4gZmFsc2U7fWNhdGNoKGUpe319fSxkZWxlZ2F0ZVR5cGU6ImZvY3VzaW4ifSxibHVyOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYodGhpcz09PXNhZmVBY3RpdmVFbGVtZW50KCkmJnRoaXMuYmx1cil7dGhpcy5ibHVyKCk7cmV0dXJuIGZhbHNlO319LGRlbGVnYXRlVHlwZToiZm9jdXNvdXQifSxjbGljazp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKGpRdWVyeS5ub2RlTmFtZSh0aGlzLCJpbnB1dCIpJiZ0aGlzLnR5cGU9PT0iY2hlY2tib3giJiZ0aGlzLmNsaWNrKXt0aGlzLmNsaWNrKCk7cmV0dXJuIGZhbHNlO319LF9kZWZhdWx0OmZ1bmN0aW9uKGV2ZW50KXtyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKGV2ZW50LnRhcmdldCwiYSIpO319LGJlZm9yZXVubG9hZDp7cG9zdERpc3BhdGNoOmZ1bmN0aW9uKGV2ZW50KXtpZihldmVudC5yZXN1bHQhPT11bmRlZmluZWQpe2V2ZW50Lm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWU9ZXZlbnQucmVzdWx0O319fX0sc2ltdWxhdGU6ZnVuY3Rpb24odHlwZSxlbGVtLGV2ZW50LGJ1YmJsZSl7dmFyIGU9alF1ZXJ5LmV4dGVuZChuZXcgalF1ZXJ5LkV2ZW50KCksZXZlbnQse3R5cGU6dHlwZSxpc1NpbXVsYXRlZDp0cnVlLG9yaWdpbmFsRXZlbnQ6e319KTtpZihidWJibGUpe2pRdWVyeS5ldmVudC50cmlnZ2VyKGUsbnVsbCxlbGVtKTt9ZWxzZXtqUXVlcnkuZXZlbnQuZGlzcGF0Y2guY2FsbChlbGVtLGUpO30KaWYoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9fX07alF1ZXJ5LnJlbW92ZUV2ZW50PWRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXI/ZnVuY3Rpb24oZWxlbSx0eXBlLGhhbmRsZSl7aWYoZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKXtlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSxoYW5kbGUsZmFsc2UpO319OmZ1bmN0aW9uKGVsZW0sdHlwZSxoYW5kbGUpe3ZhciBuYW1lPSJvbiIrdHlwZTtpZihlbGVtLmRldGFjaEV2ZW50KXtpZih0eXBlb2YgZWxlbVtuYW1lXT09PXN0cnVuZGVmaW5lZCl7ZWxlbVtuYW1lXT1udWxsO30KZWxlbS5kZXRhY2hFdmVudChuYW1lLGhhbmRsZSk7fX07alF1ZXJ5LkV2ZW50PWZ1bmN0aW9uKHNyYyxwcm9wcyl7aWYoISh0aGlzIGluc3RhbmNlb2YgalF1ZXJ5LkV2ZW50KSl7cmV0dXJuIG5ldyBqUXVlcnkuRXZlbnQoc3JjLHByb3BzKTt9CmlmKHNyYyYmc3JjLnR5cGUpe3RoaXMub3JpZ2luYWxFdmVudD1zcmM7dGhpcy50eXBlPXNyYy50eXBlO3RoaXMuaXNEZWZhdWx0UHJldmVudGVkPXNyYy5kZWZhdWx0UHJldmVudGVkfHxzcmMuZGVmYXVsdFByZXZlbnRlZD09PXVuZGVmaW5lZCYmKHNyYy5yZXR1cm5WYWx1ZT09PWZhbHNlfHxzcmMuZ2V0UHJldmVudERlZmF1bHQmJnNyYy5nZXRQcmV2ZW50RGVmYXVsdCgpKT9yZXR1cm5UcnVlOnJldHVybkZhbHNlO31lbHNle3RoaXMudHlwZT1zcmM7fQppZihwcm9wcyl7alF1ZXJ5LmV4dGVuZCh0aGlzLHByb3BzKTt9CnRoaXMudGltZVN0YW1wPXNyYyYmc3JjLnRpbWVTdGFtcHx8alF1ZXJ5Lm5vdygpO3RoaXNbalF1ZXJ5LmV4cGFuZG9dPXRydWU7fTtqUXVlcnkuRXZlbnQucHJvdG90eXBlPXtpc0RlZmF1bHRQcmV2ZW50ZWQ6cmV0dXJuRmFsc2UsaXNQcm9wYWdhdGlvblN0b3BwZWQ6cmV0dXJuRmFsc2UsaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6cmV0dXJuRmFsc2UscHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9cmV0dXJuVHJ1ZTtpZighZSl7cmV0dXJuO30KaWYoZS5wcmV2ZW50RGVmYXVsdCl7ZS5wcmV2ZW50RGVmYXVsdCgpO31lbHNle2UucmV0dXJuVmFsdWU9ZmFsc2U7fX0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQ9cmV0dXJuVHJ1ZTtpZighZSl7cmV0dXJuO30KaWYoZS5zdG9wUHJvcGFnYXRpb24pe2Uuc3RvcFByb3BhZ2F0aW9uKCk7fQplLmNhbmNlbEJ1YmJsZT10cnVlO30sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1yZXR1cm5UcnVlO3RoaXMuc3RvcFByb3BhZ2F0aW9uKCk7fX07alF1ZXJ5LmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQifSxmdW5jdGlvbihvcmlnLGZpeCl7alF1ZXJ5LmV2ZW50LnNwZWNpYWxbb3JpZ109e2RlbGVnYXRlVHlwZTpmaXgsYmluZFR5cGU6Zml4LGhhbmRsZTpmdW5jdGlvbihldmVudCl7dmFyIHJldCx0YXJnZXQ9dGhpcyxyZWxhdGVkPWV2ZW50LnJlbGF0ZWRUYXJnZXQsaGFuZGxlT2JqPWV2ZW50LmhhbmRsZU9iajtpZighcmVsYXRlZHx8KHJlbGF0ZWQhPT10YXJnZXQmJiFqUXVlcnkuY29udGFpbnModGFyZ2V0LHJlbGF0ZWQpKSl7ZXZlbnQudHlwZT1oYW5kbGVPYmoub3JpZ1R5cGU7cmV0PWhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtldmVudC50eXBlPWZpeDt9CnJldHVybiByZXQ7fX07fSk7aWYoIXN1cHBvcnQuc3VibWl0QnViYmxlcyl7alF1ZXJ5LmV2ZW50LnNwZWNpYWwuc3VibWl0PXtzZXR1cDpmdW5jdGlvbigpe2lmKGpRdWVyeS5ub2RlTmFtZSh0aGlzLCJmb3JtIikpe3JldHVybiBmYWxzZTt9CmpRdWVyeS5ldmVudC5hZGQodGhpcywiY2xpY2suX3N1Ym1pdCBrZXlwcmVzcy5fc3VibWl0IixmdW5jdGlvbihlKXt2YXIgZWxlbT1lLnRhcmdldCxmb3JtPWpRdWVyeS5ub2RlTmFtZShlbGVtLCJpbnB1dCIpfHxqUXVlcnkubm9kZU5hbWUoZWxlbSwiYnV0dG9uIik/ZWxlbS5mb3JtOnVuZGVmaW5lZDtpZihmb3JtJiYhalF1ZXJ5Ll9kYXRhKGZvcm0sInN1Ym1pdEJ1YmJsZXMiKSl7alF1ZXJ5LmV2ZW50LmFkZChmb3JtLCJzdWJtaXQuX3N1Ym1pdCIsZnVuY3Rpb24oZXZlbnQpe2V2ZW50Ll9zdWJtaXRfYnViYmxlPXRydWU7fSk7alF1ZXJ5Ll9kYXRhKGZvcm0sInN1Ym1pdEJ1YmJsZXMiLHRydWUpO319KTt9LHBvc3REaXNwYXRjaDpmdW5jdGlvbihldmVudCl7aWYoZXZlbnQuX3N1Ym1pdF9idWJibGUpe2RlbGV0ZSBldmVudC5fc3VibWl0X2J1YmJsZTtpZih0aGlzLnBhcmVudE5vZGUmJiFldmVudC5pc1RyaWdnZXIpe2pRdWVyeS5ldmVudC5zaW11bGF0ZSgic3VibWl0Iix0aGlzLnBhcmVudE5vZGUsZXZlbnQsdHJ1ZSk7fX19LHRlYXJkb3duOmZ1bmN0aW9uKCl7aWYoalF1ZXJ5Lm5vZGVOYW1lKHRoaXMsImZvcm0iKSl7cmV0dXJuIGZhbHNlO30KalF1ZXJ5LmV2ZW50LnJlbW92ZSh0aGlzLCIuX3N1Ym1pdCIpO319O30KaWYoIXN1cHBvcnQuY2hhbmdlQnViYmxlcyl7alF1ZXJ5LmV2ZW50LnNwZWNpYWwuY2hhbmdlPXtzZXR1cDpmdW5jdGlvbigpe2lmKHJmb3JtRWxlbXMudGVzdCh0aGlzLm5vZGVOYW1lKSl7aWYodGhpcy50eXBlPT09ImNoZWNrYm94Inx8dGhpcy50eXBlPT09InJhZGlvIil7alF1ZXJ5LmV2ZW50LmFkZCh0aGlzLCJwcm9wZXJ0eWNoYW5nZS5fY2hhbmdlIixmdW5jdGlvbihldmVudCl7aWYoZXZlbnQub3JpZ2luYWxFdmVudC5wcm9wZXJ0eU5hbWU9PT0iY2hlY2tlZCIpe3RoaXMuX2p1c3RfY2hhbmdlZD10cnVlO319KTtqUXVlcnkuZXZlbnQuYWRkKHRoaXMsImNsaWNrLl9jaGFuZ2UiLGZ1bmN0aW9uKGV2ZW50KXtpZih0aGlzLl9qdXN0X2NoYW5nZWQmJiFldmVudC5pc1RyaWdnZXIpe3RoaXMuX2p1c3RfY2hhbmdlZD1mYWxzZTt9CmpRdWVyeS5ldmVudC5zaW11bGF0ZSgiY2hhbmdlIix0aGlzLGV2ZW50LHRydWUpO30pO30KcmV0dXJuIGZhbHNlO30KalF1ZXJ5LmV2ZW50LmFkZCh0aGlzLCJiZWZvcmVhY3RpdmF0ZS5fY2hhbmdlIixmdW5jdGlvbihlKXt2YXIgZWxlbT1lLnRhcmdldDtpZihyZm9ybUVsZW1zLnRlc3QoZWxlbS5ub2RlTmFtZSkmJiFqUXVlcnkuX2RhdGEoZWxlbSwiY2hhbmdlQnViYmxlcyIpKXtqUXVlcnkuZXZlbnQuYWRkKGVsZW0sImNoYW5nZS5fY2hhbmdlIixmdW5jdGlvbihldmVudCl7aWYodGhpcy5wYXJlbnROb2RlJiYhZXZlbnQuaXNTaW11bGF0ZWQmJiFldmVudC5pc1RyaWdnZXIpe2pRdWVyeS5ldmVudC5zaW11bGF0ZSgiY2hhbmdlIix0aGlzLnBhcmVudE5vZGUsZXZlbnQsdHJ1ZSk7fX0pO2pRdWVyeS5fZGF0YShlbGVtLCJjaGFuZ2VCdWJibGVzIix0cnVlKTt9fSk7fSxoYW5kbGU6ZnVuY3Rpb24oZXZlbnQpe3ZhciBlbGVtPWV2ZW50LnRhcmdldDtpZih0aGlzIT09ZWxlbXx8ZXZlbnQuaXNTaW11bGF0ZWR8fGV2ZW50LmlzVHJpZ2dlcnx8KGVsZW0udHlwZSE9PSJyYWRpbyImJmVsZW0udHlwZSE9PSJjaGVja2JveCIpKXtyZXR1cm4gZXZlbnQuaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319LHRlYXJkb3duOmZ1bmN0aW9uKCl7alF1ZXJ5LmV2ZW50LnJlbW92ZSh0aGlzLCIuX2NoYW5nZSIpO3JldHVybiFyZm9ybUVsZW1zLnRlc3QodGhpcy5ub2RlTmFtZSk7fX07fQppZighc3VwcG9ydC5mb2N1c2luQnViYmxlcyl7alF1ZXJ5LmVhY2goe2ZvY3VzOiJmb2N1c2luIixibHVyOiJmb2N1c291dCJ9LGZ1bmN0aW9uKG9yaWcsZml4KXt2YXIgaGFuZGxlcj1mdW5jdGlvbihldmVudCl7alF1ZXJ5LmV2ZW50LnNpbXVsYXRlKGZpeCxldmVudC50YXJnZXQsalF1ZXJ5LmV2ZW50LmZpeChldmVudCksdHJ1ZSk7fTtqUXVlcnkuZXZlbnQuc3BlY2lhbFtmaXhdPXtzZXR1cDpmdW5jdGlvbigpe3ZhciBkb2M9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGF0dGFjaGVzPWpRdWVyeS5fZGF0YShkb2MsZml4KTtpZighYXR0YWNoZXMpe2RvYy5hZGRFdmVudExpc3RlbmVyKG9yaWcsaGFuZGxlcix0cnVlKTt9CmpRdWVyeS5fZGF0YShkb2MsZml4LChhdHRhY2hlc3x8MCkrMSk7fSx0ZWFyZG93bjpmdW5jdGlvbigpe3ZhciBkb2M9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGF0dGFjaGVzPWpRdWVyeS5fZGF0YShkb2MsZml4KS0xO2lmKCFhdHRhY2hlcyl7ZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIob3JpZyxoYW5kbGVyLHRydWUpO2pRdWVyeS5fcmVtb3ZlRGF0YShkb2MsZml4KTt9ZWxzZXtqUXVlcnkuX2RhdGEoZG9jLGZpeCxhdHRhY2hlcyk7fX19O30pO30KalF1ZXJ5LmZuLmV4dGVuZCh7b246ZnVuY3Rpb24odHlwZXMsc2VsZWN0b3IsZGF0YSxmbixvbmUpe3ZhciB0eXBlLG9yaWdGbjtpZih0eXBlb2YgdHlwZXM9PT0ib2JqZWN0Iil7aWYodHlwZW9mIHNlbGVjdG9yIT09InN0cmluZyIpe2RhdGE9ZGF0YXx8c2VsZWN0b3I7c2VsZWN0b3I9dW5kZWZpbmVkO30KZm9yKHR5cGUgaW4gdHlwZXMpe3RoaXMub24odHlwZSxzZWxlY3RvcixkYXRhLHR5cGVzW3R5cGVdLG9uZSk7fQpyZXR1cm4gdGhpczt9CmlmKGRhdGE9PW51bGwmJmZuPT1udWxsKXtmbj1zZWxlY3RvcjtkYXRhPXNlbGVjdG9yPXVuZGVmaW5lZDt9ZWxzZSBpZihmbj09bnVsbCl7aWYodHlwZW9mIHNlbGVjdG9yPT09InN0cmluZyIpe2ZuPWRhdGE7ZGF0YT11bmRlZmluZWQ7fWVsc2V7Zm49ZGF0YTtkYXRhPXNlbGVjdG9yO3NlbGVjdG9yPXVuZGVmaW5lZDt9fQppZihmbj09PWZhbHNlKXtmbj1yZXR1cm5GYWxzZTt9ZWxzZSBpZighZm4pe3JldHVybiB0aGlzO30KaWYob25lPT09MSl7b3JpZ0ZuPWZuO2ZuPWZ1bmN0aW9uKGV2ZW50KXtqUXVlcnkoKS5vZmYoZXZlbnQpO3JldHVybiBvcmlnRm4uYXBwbHkodGhpcyxhcmd1bWVudHMpO307Zm4uZ3VpZD1vcmlnRm4uZ3VpZHx8KG9yaWdGbi5ndWlkPWpRdWVyeS5ndWlkKyspO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2pRdWVyeS5ldmVudC5hZGQodGhpcyx0eXBlcyxmbixkYXRhLHNlbGVjdG9yKTt9KTt9LG9uZTpmdW5jdGlvbih0eXBlcyxzZWxlY3RvcixkYXRhLGZuKXtyZXR1cm4gdGhpcy5vbih0eXBlcyxzZWxlY3RvcixkYXRhLGZuLDEpO30sb2ZmOmZ1bmN0aW9uKHR5cGVzLHNlbGVjdG9yLGZuKXt2YXIgaGFuZGxlT2JqLHR5cGU7aWYodHlwZXMmJnR5cGVzLnByZXZlbnREZWZhdWx0JiZ0eXBlcy5oYW5kbGVPYmope2hhbmRsZU9iaj10eXBlcy5oYW5kbGVPYmo7alF1ZXJ5KHR5cGVzLmRlbGVnYXRlVGFyZ2V0KS5vZmYoaGFuZGxlT2JqLm5hbWVzcGFjZT9oYW5kbGVPYmoub3JpZ1R5cGUrIi4iK2hhbmRsZU9iai5uYW1lc3BhY2U6aGFuZGxlT2JqLm9yaWdUeXBlLGhhbmRsZU9iai5zZWxlY3RvcixoYW5kbGVPYmouaGFuZGxlcik7cmV0dXJuIHRoaXM7fQppZih0eXBlb2YgdHlwZXM9PT0ib2JqZWN0Iil7Zm9yKHR5cGUgaW4gdHlwZXMpe3RoaXMub2ZmKHR5cGUsc2VsZWN0b3IsdHlwZXNbdHlwZV0pO30KcmV0dXJuIHRoaXM7fQppZihzZWxlY3Rvcj09PWZhbHNlfHx0eXBlb2Ygc2VsZWN0b3I9PT0iZnVuY3Rpb24iKXtmbj1zZWxlY3RvcjtzZWxlY3Rvcj11bmRlZmluZWQ7fQppZihmbj09PWZhbHNlKXtmbj1yZXR1cm5GYWxzZTt9CnJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkuZXZlbnQucmVtb3ZlKHRoaXMsdHlwZXMsZm4sc2VsZWN0b3IpO30pO30sdHJpZ2dlcjpmdW5jdGlvbih0eXBlLGRhdGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtqUXVlcnkuZXZlbnQudHJpZ2dlcih0eXBlLGRhdGEsdGhpcyk7fSk7fSx0cmlnZ2VySGFuZGxlcjpmdW5jdGlvbih0eXBlLGRhdGEpe3ZhciBlbGVtPXRoaXNbMF07aWYoZWxlbSl7cmV0dXJuIGpRdWVyeS5ldmVudC50cmlnZ2VyKHR5cGUsZGF0YSxlbGVtLHRydWUpO319fSk7ZnVuY3Rpb24gY3JlYXRlU2FmZUZyYWdtZW50KGRvY3VtZW50KXt2YXIgbGlzdD1ub2RlTmFtZXMuc3BsaXQoInwiKSxzYWZlRnJhZz1kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7aWYoc2FmZUZyYWcuY3JlYXRlRWxlbWVudCl7d2hpbGUobGlzdC5sZW5ndGgpe3NhZmVGcmFnLmNyZWF0ZUVsZW1lbnQobGlzdC5wb3AoKSk7fX0KcmV0dXJuIHNhZmVGcmFnO30KdmFyIG5vZGVOYW1lcz0iYWJicnxhcnRpY2xlfGFzaWRlfGF1ZGlvfGJkaXxjYW52YXN8ZGF0YXxkYXRhbGlzdHxkZXRhaWxzfGZpZ2NhcHRpb258ZmlndXJlfGZvb3RlcnwiKyJoZWFkZXJ8aGdyb3VwfG1hcmt8bWV0ZXJ8bmF2fG91dHB1dHxwcm9ncmVzc3xzZWN0aW9ufHN1bW1hcnl8dGltZXx2aWRlbyIscmlubGluZWpRdWVyeT0vIGpRdWVyeVxkKz0iKD86bnVsbHxcZCspIi9nLHJub3NoaW1jYWNoZT1uZXcgUmVnRXhwKCI8KD86Iitub2RlTmFtZXMrIilbXFxzLz5dIiwiaSIpLHJsZWFkaW5nV2hpdGVzcGFjZT0vXlxzKy8scnhodG1sVGFnPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcdzpdKylbXj5dKilcLz4vZ2kscnRhZ05hbWU9LzwoW1x3Ol0rKS8scnRib2R5PS88dGJvZHkvaSxyaHRtbD0vPHwmIz9cdys7Lyxybm9Jbm5lcmh0bWw9LzwoPzpzY3JpcHR8c3R5bGV8bGluaykvaSxyY2hlY2tlZD0vY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSxyc2NyaXB0VHlwZT0vXiR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2kscnNjcmlwdFR5cGVNYXNrZWQ9L150cnVlXC8oLiopLyxyY2xlYW5TY3JpcHQ9L15ccyo8ISg/OlxbQ0RBVEFcW3wtLSl8KD86XF1cXXwtLSk+XHMqJC9nLHdyYXBNYXA9e29wdGlvbjpbMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdLGxlZ2VuZDpbMSwiPGZpZWxkc2V0PiIsIjwvZmllbGRzZXQ+Il0sYXJlYTpbMSwiPG1hcD4iLCI8L21hcD4iXSxwYXJhbTpbMSwiPG9iamVjdD4iLCI8L29iamVjdD4iXSx0aGVhZDpbMSwiPHRhYmxlPiIsIjwvdGFibGU+Il0sdHI6WzIsIjx0YWJsZT48dGJvZHk+IiwiPC90Ym9keT48L3RhYmxlPiJdLGNvbDpbMiwiPHRhYmxlPjx0Ym9keT48L3Rib2R5Pjxjb2xncm91cD4iLCI8L2NvbGdyb3VwPjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLF9kZWZhdWx0OnN1cHBvcnQuaHRtbFNlcmlhbGl6ZT9bMCwiIiwiIl06WzEsIlg8ZGl2PiIsIjwvZGl2PiJdfSxzYWZlRnJhZ21lbnQ9Y3JlYXRlU2FmZUZyYWdtZW50KGRvY3VtZW50KSxmcmFnbWVudERpdj1zYWZlRnJhZ21lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpO3dyYXBNYXAub3B0Z3JvdXA9d3JhcE1hcC5vcHRpb247d3JhcE1hcC50Ym9keT13cmFwTWFwLnRmb290PXdyYXBNYXAuY29sZ3JvdXA9d3JhcE1hcC5jYXB0aW9uPXdyYXBNYXAudGhlYWQ7d3JhcE1hcC50aD13cmFwTWFwLnRkO2Z1bmN0aW9uIGdldEFsbChjb250ZXh0LHRhZyl7dmFyIGVsZW1zLGVsZW0saT0wLGZvdW5kPXR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lIT09c3RydW5kZWZpbmVkP2NvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnfHwiKiIpOnR5cGVvZiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwhPT1zdHJ1bmRlZmluZWQ/Y29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKHRhZ3x8IioiKTp1bmRlZmluZWQ7aWYoIWZvdW5kKXtmb3IoZm91bmQ9W10sZWxlbXM9Y29udGV4dC5jaGlsZE5vZGVzfHxjb250ZXh0OyhlbGVtPWVsZW1zW2ldKSE9bnVsbDtpKyspe2lmKCF0YWd8fGpRdWVyeS5ub2RlTmFtZShlbGVtLHRhZykpe2ZvdW5kLnB1c2goZWxlbSk7fWVsc2V7alF1ZXJ5Lm1lcmdlKGZvdW5kLGdldEFsbChlbGVtLHRhZykpO319fQpyZXR1cm4gdGFnPT09dW5kZWZpbmVkfHx0YWcmJmpRdWVyeS5ub2RlTmFtZShjb250ZXh0LHRhZyk/alF1ZXJ5Lm1lcmdlKFtjb250ZXh0XSxmb3VuZCk6Zm91bmQ7fQpmdW5jdGlvbiBmaXhEZWZhdWx0Q2hlY2tlZChlbGVtKXtpZihyY2hlY2thYmxlVHlwZS50ZXN0KGVsZW0udHlwZSkpe2VsZW0uZGVmYXVsdENoZWNrZWQ9ZWxlbS5jaGVja2VkO319CmZ1bmN0aW9uIG1hbmlwdWxhdGlvblRhcmdldChlbGVtLGNvbnRlbnQpe3JldHVybiBqUXVlcnkubm9kZU5hbWUoZWxlbSwidGFibGUiKSYmalF1ZXJ5Lm5vZGVOYW1lKGNvbnRlbnQubm9kZVR5cGUhPT0xMT9jb250ZW50OmNvbnRlbnQuZmlyc3RDaGlsZCwidHIiKT9lbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdfHxlbGVtLmFwcGVuZENoaWxkKGVsZW0ub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpKTplbGVtO30KZnVuY3Rpb24gZGlzYWJsZVNjcmlwdChlbGVtKXtlbGVtLnR5cGU9KGpRdWVyeS5maW5kLmF0dHIoZWxlbSwidHlwZSIpIT09bnVsbCkrIi8iK2VsZW0udHlwZTtyZXR1cm4gZWxlbTt9CmZ1bmN0aW9uIHJlc3RvcmVTY3JpcHQoZWxlbSl7dmFyIG1hdGNoPXJzY3JpcHRUeXBlTWFza2VkLmV4ZWMoZWxlbS50eXBlKTtpZihtYXRjaCl7ZWxlbS50eXBlPW1hdGNoWzFdO31lbHNle2VsZW0ucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIik7fQpyZXR1cm4gZWxlbTt9CmZ1bmN0aW9uIHNldEdsb2JhbEV2YWwoZWxlbXMscmVmRWxlbWVudHMpe3ZhciBlbGVtLGk9MDtmb3IoOyhlbGVtPWVsZW1zW2ldKSE9bnVsbDtpKyspe2pRdWVyeS5fZGF0YShlbGVtLCJnbG9iYWxFdmFsIiwhcmVmRWxlbWVudHN8fGpRdWVyeS5fZGF0YShyZWZFbGVtZW50c1tpXSwiZ2xvYmFsRXZhbCIpKTt9fQpmdW5jdGlvbiBjbG9uZUNvcHlFdmVudChzcmMsZGVzdCl7aWYoZGVzdC5ub2RlVHlwZSE9PTF8fCFqUXVlcnkuaGFzRGF0YShzcmMpKXtyZXR1cm47fQp2YXIgdHlwZSxpLGwsb2xkRGF0YT1qUXVlcnkuX2RhdGEoc3JjKSxjdXJEYXRhPWpRdWVyeS5fZGF0YShkZXN0LG9sZERhdGEpLGV2ZW50cz1vbGREYXRhLmV2ZW50cztpZihldmVudHMpe2RlbGV0ZSBjdXJEYXRhLmhhbmRsZTtjdXJEYXRhLmV2ZW50cz17fTtmb3IodHlwZSBpbiBldmVudHMpe2ZvcihpPTAsbD1ldmVudHNbdHlwZV0ubGVuZ3RoO2k8bDtpKyspe2pRdWVyeS5ldmVudC5hZGQoZGVzdCx0eXBlLGV2ZW50c1t0eXBlXVtpXSk7fX19CmlmKGN1ckRhdGEuZGF0YSl7Y3VyRGF0YS5kYXRhPWpRdWVyeS5leHRlbmQoe30sY3VyRGF0YS5kYXRhKTt9fQpmdW5jdGlvbiBmaXhDbG9uZU5vZGVJc3N1ZXMoc3JjLGRlc3Qpe3ZhciBub2RlTmFtZSxlLGRhdGE7aWYoZGVzdC5ub2RlVHlwZSE9PTEpe3JldHVybjt9Cm5vZGVOYW1lPWRlc3Qubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtpZighc3VwcG9ydC5ub0Nsb25lRXZlbnQmJmRlc3RbalF1ZXJ5LmV4cGFuZG9dKXtkYXRhPWpRdWVyeS5fZGF0YShkZXN0KTtmb3IoZSBpbiBkYXRhLmV2ZW50cyl7alF1ZXJ5LnJlbW92ZUV2ZW50KGRlc3QsZSxkYXRhLmhhbmRsZSk7fQpkZXN0LnJlbW92ZUF0dHJpYnV0ZShqUXVlcnkuZXhwYW5kbyk7fQppZihub2RlTmFtZT09PSJzY3JpcHQiJiZkZXN0LnRleHQhPT1zcmMudGV4dCl7ZGlzYWJsZVNjcmlwdChkZXN0KS50ZXh0PXNyYy50ZXh0O3Jlc3RvcmVTY3JpcHQoZGVzdCk7fWVsc2UgaWYobm9kZU5hbWU9PT0ib2JqZWN0Iil7aWYoZGVzdC5wYXJlbnROb2RlKXtkZXN0Lm91dGVySFRNTD1zcmMub3V0ZXJIVE1MO30KaWYoc3VwcG9ydC5odG1sNUNsb25lJiYoc3JjLmlubmVySFRNTCYmIWpRdWVyeS50cmltKGRlc3QuaW5uZXJIVE1MKSkpe2Rlc3QuaW5uZXJIVE1MPXNyYy5pbm5lckhUTUw7fX1lbHNlIGlmKG5vZGVOYW1lPT09ImlucHV0IiYmcmNoZWNrYWJsZVR5cGUudGVzdChzcmMudHlwZSkpe2Rlc3QuZGVmYXVsdENoZWNrZWQ9ZGVzdC5jaGVja2VkPXNyYy5jaGVja2VkO2lmKGRlc3QudmFsdWUhPT1zcmMudmFsdWUpe2Rlc3QudmFsdWU9c3JjLnZhbHVlO319ZWxzZSBpZihub2RlTmFtZT09PSJvcHRpb24iKXtkZXN0LmRlZmF1bHRTZWxlY3RlZD1kZXN0LnNlbGVjdGVkPXNyYy5kZWZhdWx0U2VsZWN0ZWQ7fWVsc2UgaWYobm9kZU5hbWU9PT0iaW5wdXQifHxub2RlTmFtZT09PSJ0ZXh0YXJlYSIpe2Rlc3QuZGVmYXVsdFZhbHVlPXNyYy5kZWZhdWx0VmFsdWU7fX0KalF1ZXJ5LmV4dGVuZCh7Y2xvbmU6ZnVuY3Rpb24oZWxlbSxkYXRhQW5kRXZlbnRzLGRlZXBEYXRhQW5kRXZlbnRzKXt2YXIgZGVzdEVsZW1lbnRzLG5vZGUsY2xvbmUsaSxzcmNFbGVtZW50cyxpblBhZ2U9alF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCxlbGVtKTtpZihzdXBwb3J0Lmh0bWw1Q2xvbmV8fGpRdWVyeS5pc1hNTERvYyhlbGVtKXx8IXJub3NoaW1jYWNoZS50ZXN0KCI8IitlbGVtLm5vZGVOYW1lKyI+Iikpe2Nsb25lPWVsZW0uY2xvbmVOb2RlKHRydWUpO31lbHNle2ZyYWdtZW50RGl2LmlubmVySFRNTD1lbGVtLm91dGVySFRNTDtmcmFnbWVudERpdi5yZW1vdmVDaGlsZChjbG9uZT1mcmFnbWVudERpdi5maXJzdENoaWxkKTt9CmlmKCghc3VwcG9ydC5ub0Nsb25lRXZlbnR8fCFzdXBwb3J0Lm5vQ2xvbmVDaGVja2VkKSYmKGVsZW0ubm9kZVR5cGU9PT0xfHxlbGVtLm5vZGVUeXBlPT09MTEpJiYhalF1ZXJ5LmlzWE1MRG9jKGVsZW0pKXtkZXN0RWxlbWVudHM9Z2V0QWxsKGNsb25lKTtzcmNFbGVtZW50cz1nZXRBbGwoZWxlbSk7Zm9yKGk9MDsobm9kZT1zcmNFbGVtZW50c1tpXSkhPW51bGw7KytpKXtpZihkZXN0RWxlbWVudHNbaV0pe2ZpeENsb25lTm9kZUlzc3Vlcyhub2RlLGRlc3RFbGVtZW50c1tpXSk7fX19CmlmKGRhdGFBbmRFdmVudHMpe2lmKGRlZXBEYXRhQW5kRXZlbnRzKXtzcmNFbGVtZW50cz1zcmNFbGVtZW50c3x8Z2V0QWxsKGVsZW0pO2Rlc3RFbGVtZW50cz1kZXN0RWxlbWVudHN8fGdldEFsbChjbG9uZSk7Zm9yKGk9MDsobm9kZT1zcmNFbGVtZW50c1tpXSkhPW51bGw7aSsrKXtjbG9uZUNvcHlFdmVudChub2RlLGRlc3RFbGVtZW50c1tpXSk7fX1lbHNle2Nsb25lQ29weUV2ZW50KGVsZW0sY2xvbmUpO319CmRlc3RFbGVtZW50cz1nZXRBbGwoY2xvbmUsInNjcmlwdCIpO2lmKGRlc3RFbGVtZW50cy5sZW5ndGg+MCl7c2V0R2xvYmFsRXZhbChkZXN0RWxlbWVudHMsIWluUGFnZSYmZ2V0QWxsKGVsZW0sInNjcmlwdCIpKTt9CmRlc3RFbGVtZW50cz1zcmNFbGVtZW50cz1ub2RlPW51bGw7cmV0dXJuIGNsb25lO30sYnVpbGRGcmFnbWVudDpmdW5jdGlvbihlbGVtcyxjb250ZXh0LHNjcmlwdHMsc2VsZWN0aW9uKXt2YXIgaixlbGVtLGNvbnRhaW5zLHRtcCx0YWcsdGJvZHksd3JhcCxsPWVsZW1zLmxlbmd0aCxzYWZlPWNyZWF0ZVNhZmVGcmFnbWVudChjb250ZXh0KSxub2Rlcz1bXSxpPTA7Zm9yKDtpPGw7aSsrKXtlbGVtPWVsZW1zW2ldO2lmKGVsZW18fGVsZW09PT0wKXtpZihqUXVlcnkudHlwZShlbGVtKT09PSJvYmplY3QiKXtqUXVlcnkubWVyZ2Uobm9kZXMsZWxlbS5ub2RlVHlwZT9bZWxlbV06ZWxlbSk7fWVsc2UgaWYoIXJodG1sLnRlc3QoZWxlbSkpe25vZGVzLnB1c2goY29udGV4dC5jcmVhdGVUZXh0Tm9kZShlbGVtKSk7fWVsc2V7dG1wPXRtcHx8c2FmZS5hcHBlbmRDaGlsZChjb250ZXh0LmNyZWF0ZUVsZW1lbnQoImRpdiIpKTt0YWc9KHJ0YWdOYW1lLmV4ZWMoZWxlbSl8fFsiIiwiIl0pWzFdLnRvTG93ZXJDYXNlKCk7d3JhcD13cmFwTWFwW3RhZ118fHdyYXBNYXAuX2RlZmF1bHQ7dG1wLmlubmVySFRNTD13cmFwWzFdK2VsZW0ucmVwbGFjZShyeGh0bWxUYWcsIjwkMT48LyQyPiIpK3dyYXBbMl07aj13cmFwWzBdO3doaWxlKGotLSl7dG1wPXRtcC5sYXN0Q2hpbGQ7fQppZighc3VwcG9ydC5sZWFkaW5nV2hpdGVzcGFjZSYmcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QoZWxlbSkpe25vZGVzLnB1c2goY29udGV4dC5jcmVhdGVUZXh0Tm9kZShybGVhZGluZ1doaXRlc3BhY2UuZXhlYyhlbGVtKVswXSkpO30KaWYoIXN1cHBvcnQudGJvZHkpe2VsZW09dGFnPT09InRhYmxlIiYmIXJ0Ym9keS50ZXN0KGVsZW0pP3RtcC5maXJzdENoaWxkOndyYXBbMV09PT0iPHRhYmxlPiImJiFydGJvZHkudGVzdChlbGVtKT90bXA6MDtqPWVsZW0mJmVsZW0uY2hpbGROb2Rlcy5sZW5ndGg7d2hpbGUoai0tKXtpZihqUXVlcnkubm9kZU5hbWUoKHRib2R5PWVsZW0uY2hpbGROb2Rlc1tqXSksInRib2R5IikmJiF0Ym9keS5jaGlsZE5vZGVzLmxlbmd0aCl7ZWxlbS5yZW1vdmVDaGlsZCh0Ym9keSk7fX19CmpRdWVyeS5tZXJnZShub2Rlcyx0bXAuY2hpbGROb2Rlcyk7dG1wLnRleHRDb250ZW50PSIiO3doaWxlKHRtcC5maXJzdENoaWxkKXt0bXAucmVtb3ZlQ2hpbGQodG1wLmZpcnN0Q2hpbGQpO30KdG1wPXNhZmUubGFzdENoaWxkO319fQppZih0bXApe3NhZmUucmVtb3ZlQ2hpbGQodG1wKTt9CmlmKCFzdXBwb3J0LmFwcGVuZENoZWNrZWQpe2pRdWVyeS5ncmVwKGdldEFsbChub2RlcywiaW5wdXQiKSxmaXhEZWZhdWx0Q2hlY2tlZCk7fQppPTA7d2hpbGUoKGVsZW09bm9kZXNbaSsrXSkpe2lmKHNlbGVjdGlvbiYmalF1ZXJ5LmluQXJyYXkoZWxlbSxzZWxlY3Rpb24pIT09LTEpe2NvbnRpbnVlO30KY29udGFpbnM9alF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCxlbGVtKTt0bXA9Z2V0QWxsKHNhZmUuYXBwZW5kQ2hpbGQoZWxlbSksInNjcmlwdCIpO2lmKGNvbnRhaW5zKXtzZXRHbG9iYWxFdmFsKHRtcCk7fQppZihzY3JpcHRzKXtqPTA7d2hpbGUoKGVsZW09dG1wW2orK10pKXtpZihyc2NyaXB0VHlwZS50ZXN0KGVsZW0udHlwZXx8IiIpKXtzY3JpcHRzLnB1c2goZWxlbSk7fX19fQp0bXA9bnVsbDtyZXR1cm4gc2FmZTt9LGNsZWFuRGF0YTpmdW5jdGlvbihlbGVtcyxhY2NlcHREYXRhKXt2YXIgZWxlbSx0eXBlLGlkLGRhdGEsaT0wLGludGVybmFsS2V5PWpRdWVyeS5leHBhbmRvLGNhY2hlPWpRdWVyeS5jYWNoZSxkZWxldGVFeHBhbmRvPXN1cHBvcnQuZGVsZXRlRXhwYW5kbyxzcGVjaWFsPWpRdWVyeS5ldmVudC5zcGVjaWFsO2Zvcig7KGVsZW09ZWxlbXNbaV0pIT1udWxsO2krKyl7aWYoYWNjZXB0RGF0YXx8alF1ZXJ5LmFjY2VwdERhdGEoZWxlbSkpe2lkPWVsZW1baW50ZXJuYWxLZXldO2RhdGE9aWQmJmNhY2hlW2lkXTtpZihkYXRhKXtpZihkYXRhLmV2ZW50cyl7Zm9yKHR5cGUgaW4gZGF0YS5ldmVudHMpe2lmKHNwZWNpYWxbdHlwZV0pe2pRdWVyeS5ldmVudC5yZW1vdmUoZWxlbSx0eXBlKTt9ZWxzZXtqUXVlcnkucmVtb3ZlRXZlbnQoZWxlbSx0eXBlLGRhdGEuaGFuZGxlKTt9fX0KaWYoY2FjaGVbaWRdKXtkZWxldGUgY2FjaGVbaWRdO2lmKGRlbGV0ZUV4cGFuZG8pe2RlbGV0ZSBlbGVtW2ludGVybmFsS2V5XTt9ZWxzZSBpZih0eXBlb2YgZWxlbS5yZW1vdmVBdHRyaWJ1dGUhPT1zdHJ1bmRlZmluZWQpe2VsZW0ucmVtb3ZlQXR0cmlidXRlKGludGVybmFsS2V5KTt9ZWxzZXtlbGVtW2ludGVybmFsS2V5XT1udWxsO30KZGVsZXRlZElkcy5wdXNoKGlkKTt9fX19fX0pO2pRdWVyeS5mbi5leHRlbmQoe3RleHQ6ZnVuY3Rpb24odmFsdWUpe3JldHVybiBhY2Nlc3ModGhpcyxmdW5jdGlvbih2YWx1ZSl7cmV0dXJuIHZhbHVlPT09dW5kZWZpbmVkP2pRdWVyeS50ZXh0KHRoaXMpOnRoaXMuZW1wdHkoKS5hcHBlbmQoKHRoaXNbMF0mJnRoaXNbMF0ub3duZXJEb2N1bWVudHx8ZG9jdW1lbnQpLmNyZWF0ZVRleHROb2RlKHZhbHVlKSk7fSxudWxsLHZhbHVlLGFyZ3VtZW50cy5sZW5ndGgpO30sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2lmKHRoaXMubm9kZVR5cGU9PT0xfHx0aGlzLm5vZGVUeXBlPT09MTF8fHRoaXMubm9kZVR5cGU9PT05KXt2YXIgdGFyZ2V0PW1hbmlwdWxhdGlvblRhcmdldCh0aGlzLGVsZW0pO3RhcmdldC5hcHBlbmRDaGlsZChlbGVtKTt9fSk7fSxwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2lmKHRoaXMubm9kZVR5cGU9PT0xfHx0aGlzLm5vZGVUeXBlPT09MTF8fHRoaXMubm9kZVR5cGU9PT05KXt2YXIgdGFyZ2V0PW1hbmlwdWxhdGlvblRhcmdldCh0aGlzLGVsZW0pO3RhcmdldC5pbnNlcnRCZWZvcmUoZWxlbSx0YXJnZXQuZmlyc3RDaGlsZCk7fX0pO30sYmVmb3JlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2lmKHRoaXMucGFyZW50Tm9kZSl7dGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtLHRoaXMpO319KTt9LGFmdGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2lmKHRoaXMucGFyZW50Tm9kZSl7dGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtLHRoaXMubmV4dFNpYmxpbmcpO319KTt9LHJlbW92ZTpmdW5jdGlvbihzZWxlY3RvcixrZWVwRGF0YSl7dmFyIGVsZW0sZWxlbXM9c2VsZWN0b3I/alF1ZXJ5LmZpbHRlcihzZWxlY3Rvcix0aGlzKTp0aGlzLGk9MDtmb3IoOyhlbGVtPWVsZW1zW2ldKSE9bnVsbDtpKyspe2lmKCFrZWVwRGF0YSYmZWxlbS5ub2RlVHlwZT09PTEpe2pRdWVyeS5jbGVhbkRhdGEoZ2V0QWxsKGVsZW0pKTt9CmlmKGVsZW0ucGFyZW50Tm9kZSl7aWYoa2VlcERhdGEmJmpRdWVyeS5jb250YWlucyhlbGVtLm93bmVyRG9jdW1lbnQsZWxlbSkpe3NldEdsb2JhbEV2YWwoZ2V0QWxsKGVsZW0sInNjcmlwdCIpKTt9CmVsZW0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtKTt9fQpyZXR1cm4gdGhpczt9LGVtcHR5OmZ1bmN0aW9uKCl7dmFyIGVsZW0saT0wO2Zvcig7KGVsZW09dGhpc1tpXSkhPW51bGw7aSsrKXtpZihlbGVtLm5vZGVUeXBlPT09MSl7alF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwoZWxlbSxmYWxzZSkpO30Kd2hpbGUoZWxlbS5maXJzdENoaWxkKXtlbGVtLnJlbW92ZUNoaWxkKGVsZW0uZmlyc3RDaGlsZCk7fQppZihlbGVtLm9wdGlvbnMmJmpRdWVyeS5ub2RlTmFtZShlbGVtLCJzZWxlY3QiKSl7ZWxlbS5vcHRpb25zLmxlbmd0aD0wO319CnJldHVybiB0aGlzO30sY2xvbmU6ZnVuY3Rpb24oZGF0YUFuZEV2ZW50cyxkZWVwRGF0YUFuZEV2ZW50cyl7ZGF0YUFuZEV2ZW50cz1kYXRhQW5kRXZlbnRzPT1udWxsP2ZhbHNlOmRhdGFBbmRFdmVudHM7ZGVlcERhdGFBbmRFdmVudHM9ZGVlcERhdGFBbmRFdmVudHM9PW51bGw/ZGF0YUFuZEV2ZW50czpkZWVwRGF0YUFuZEV2ZW50cztyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4galF1ZXJ5LmNsb25lKHRoaXMsZGF0YUFuZEV2ZW50cyxkZWVwRGF0YUFuZEV2ZW50cyk7fSk7fSxodG1sOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gYWNjZXNzKHRoaXMsZnVuY3Rpb24odmFsdWUpe3ZhciBlbGVtPXRoaXNbMF18fHt9LGk9MCxsPXRoaXMubGVuZ3RoO2lmKHZhbHVlPT09dW5kZWZpbmVkKXtyZXR1cm4gZWxlbS5ub2RlVHlwZT09PTE/ZWxlbS5pbm5lckhUTUwucmVwbGFjZShyaW5saW5lalF1ZXJ5LCIiKTp1bmRlZmluZWQ7fQppZih0eXBlb2YgdmFsdWU9PT0ic3RyaW5nIiYmIXJub0lubmVyaHRtbC50ZXN0KHZhbHVlKSYmKHN1cHBvcnQuaHRtbFNlcmlhbGl6ZXx8IXJub3NoaW1jYWNoZS50ZXN0KHZhbHVlKSkmJihzdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlfHwhcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QodmFsdWUpKSYmIXdyYXBNYXBbKHJ0YWdOYW1lLmV4ZWModmFsdWUpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7dmFsdWU9dmFsdWUucmVwbGFjZShyeGh0bWxUYWcsIjwkMT48LyQyPiIpO3RyeXtmb3IoO2k8bDtpKyspe2VsZW09dGhpc1tpXXx8e307aWYoZWxlbS5ub2RlVHlwZT09PTEpe2pRdWVyeS5jbGVhbkRhdGEoZ2V0QWxsKGVsZW0sZmFsc2UpKTtlbGVtLmlubmVySFRNTD12YWx1ZTt9fQplbGVtPTA7fWNhdGNoKGUpe319CmlmKGVsZW0pe3RoaXMuZW1wdHkoKS5hcHBlbmQodmFsdWUpO319LG51bGwsdmFsdWUsYXJndW1lbnRzLmxlbmd0aCk7fSxyZXBsYWNlV2l0aDpmdW5jdGlvbigpe3ZhciBhcmc9YXJndW1lbnRzWzBdO3RoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGVsZW0pe2FyZz10aGlzLnBhcmVudE5vZGU7alF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwodGhpcykpO2lmKGFyZyl7YXJnLnJlcGxhY2VDaGlsZChlbGVtLHRoaXMpO319KTtyZXR1cm4gYXJnJiYoYXJnLmxlbmd0aHx8YXJnLm5vZGVUeXBlKT90aGlzOnRoaXMucmVtb3ZlKCk7fSxkZXRhY2g6ZnVuY3Rpb24oc2VsZWN0b3Ipe3JldHVybiB0aGlzLnJlbW92ZShzZWxlY3Rvcix0cnVlKTt9LGRvbU1hbmlwOmZ1bmN0aW9uKGFyZ3MsY2FsbGJhY2spe2FyZ3M9Y29uY2F0LmFwcGx5KFtdLGFyZ3MpO3ZhciBmaXJzdCxub2RlLGhhc1NjcmlwdHMsc2NyaXB0cyxkb2MsZnJhZ21lbnQsaT0wLGw9dGhpcy5sZW5ndGgsc2V0PXRoaXMsaU5vQ2xvbmU9bC0xLHZhbHVlPWFyZ3NbMF0saXNGdW5jdGlvbj1qUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSk7aWYoaXNGdW5jdGlvbnx8KGw+MSYmdHlwZW9mIHZhbHVlPT09InN0cmluZyImJiFzdXBwb3J0LmNoZWNrQ2xvbmUmJnJjaGVja2VkLnRlc3QodmFsdWUpKSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpbmRleCl7dmFyIHNlbGY9c2V0LmVxKGluZGV4KTtpZihpc0Z1bmN0aW9uKXthcmdzWzBdPXZhbHVlLmNhbGwodGhpcyxpbmRleCxzZWxmLmh0bWwoKSk7fQpzZWxmLmRvbU1hbmlwKGFyZ3MsY2FsbGJhY2spO30pO30KaWYobCl7ZnJhZ21lbnQ9alF1ZXJ5LmJ1aWxkRnJhZ21lbnQoYXJncyx0aGlzWzBdLm93bmVyRG9jdW1lbnQsZmFsc2UsdGhpcyk7Zmlyc3Q9ZnJhZ21lbnQuZmlyc3RDaGlsZDtpZihmcmFnbWVudC5jaGlsZE5vZGVzLmxlbmd0aD09PTEpe2ZyYWdtZW50PWZpcnN0O30KaWYoZmlyc3Qpe3NjcmlwdHM9alF1ZXJ5Lm1hcChnZXRBbGwoZnJhZ21lbnQsInNjcmlwdCIpLGRpc2FibGVTY3JpcHQpO2hhc1NjcmlwdHM9c2NyaXB0cy5sZW5ndGg7Zm9yKDtpPGw7aSsrKXtub2RlPWZyYWdtZW50O2lmKGkhPT1pTm9DbG9uZSl7bm9kZT1qUXVlcnkuY2xvbmUobm9kZSx0cnVlLHRydWUpO2lmKGhhc1NjcmlwdHMpe2pRdWVyeS5tZXJnZShzY3JpcHRzLGdldEFsbChub2RlLCJzY3JpcHQiKSk7fX0KY2FsbGJhY2suY2FsbCh0aGlzW2ldLG5vZGUsaSk7fQppZihoYXNTY3JpcHRzKXtkb2M9c2NyaXB0c1tzY3JpcHRzLmxlbmd0aC0xXS5vd25lckRvY3VtZW50O2pRdWVyeS5tYXAoc2NyaXB0cyxyZXN0b3JlU2NyaXB0KTtmb3IoaT0wO2k8aGFzU2NyaXB0cztpKyspe25vZGU9c2NyaXB0c1tpXTtpZihyc2NyaXB0VHlwZS50ZXN0KG5vZGUudHlwZXx8IiIpJiYhalF1ZXJ5Ll9kYXRhKG5vZGUsImdsb2JhbEV2YWwiKSYmalF1ZXJ5LmNvbnRhaW5zKGRvYyxub2RlKSl7aWYobm9kZS5zcmMpe2lmKGpRdWVyeS5fZXZhbFVybCl7alF1ZXJ5Ll9ldmFsVXJsKG5vZGUuc3JjKTt9fWVsc2V7alF1ZXJ5Lmdsb2JhbEV2YWwoKG5vZGUudGV4dHx8bm9kZS50ZXh0Q29udGVudHx8bm9kZS5pbm5lckhUTUx8fCIiKS5yZXBsYWNlKHJjbGVhblNjcmlwdCwiIikpO319fX0KZnJhZ21lbnQ9Zmlyc3Q9bnVsbDt9fQpyZXR1cm4gdGhpczt9fSk7alF1ZXJ5LmVhY2goe2FwcGVuZFRvOiJhcHBlbmQiLHByZXBlbmRUbzoicHJlcGVuZCIsaW5zZXJ0QmVmb3JlOiJiZWZvcmUiLGluc2VydEFmdGVyOiJhZnRlciIscmVwbGFjZUFsbDoicmVwbGFjZVdpdGgifSxmdW5jdGlvbihuYW1lLG9yaWdpbmFsKXtqUXVlcnkuZm5bbmFtZV09ZnVuY3Rpb24oc2VsZWN0b3Ipe3ZhciBlbGVtcyxpPTAscmV0PVtdLGluc2VydD1qUXVlcnkoc2VsZWN0b3IpLGxhc3Q9aW5zZXJ0Lmxlbmd0aC0xO2Zvcig7aTw9bGFzdDtpKyspe2VsZW1zPWk9PT1sYXN0P3RoaXM6dGhpcy5jbG9uZSh0cnVlKTtqUXVlcnkoaW5zZXJ0W2ldKVtvcmlnaW5hbF0oZWxlbXMpO3B1c2guYXBwbHkocmV0LGVsZW1zLmdldCgpKTt9CnJldHVybiB0aGlzLnB1c2hTdGFjayhyZXQpO307fSk7dmFyIGlmcmFtZSxlbGVtZGlzcGxheT17fTtmdW5jdGlvbiBhY3R1YWxEaXNwbGF5KG5hbWUsZG9jKXt2YXIgZWxlbT1qUXVlcnkoZG9jLmNyZWF0ZUVsZW1lbnQobmFtZSkpLmFwcGVuZFRvKGRvYy5ib2R5KSxkaXNwbGF5PXdpbmRvdy5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZT93aW5kb3cuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUoZWxlbVswXSkuZGlzcGxheTpqUXVlcnkuY3NzKGVsZW1bMF0sImRpc3BsYXkiKTtlbGVtLmRldGFjaCgpO3JldHVybiBkaXNwbGF5O30KZnVuY3Rpb24gZGVmYXVsdERpc3BsYXkobm9kZU5hbWUpe3ZhciBkb2M9ZG9jdW1lbnQsZGlzcGxheT1lbGVtZGlzcGxheVtub2RlTmFtZV07aWYoIWRpc3BsYXkpe2Rpc3BsYXk9YWN0dWFsRGlzcGxheShub2RlTmFtZSxkb2MpO2lmKGRpc3BsYXk9PT0ibm9uZSJ8fCFkaXNwbGF5KXtpZnJhbWU9KGlmcmFtZXx8alF1ZXJ5KCI8aWZyYW1lIGZyYW1lYm9yZGVyPScwJyB3aWR0aD0nMCcgaGVpZ2h0PScwJy8+IikpLmFwcGVuZFRvKGRvYy5kb2N1bWVudEVsZW1lbnQpO2RvYz0oaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3d8fGlmcmFtZVswXS5jb250ZW50RG9jdW1lbnQpLmRvY3VtZW50O2RvYy53cml0ZSgpO2RvYy5jbG9zZSgpO2Rpc3BsYXk9YWN0dWFsRGlzcGxheShub2RlTmFtZSxkb2MpO2lmcmFtZS5kZXRhY2goKTt9CmVsZW1kaXNwbGF5W25vZGVOYW1lXT1kaXNwbGF5O30KcmV0dXJuIGRpc3BsYXk7fQooZnVuY3Rpb24oKXt2YXIgYSxzaHJpbmtXcmFwQmxvY2tzVmFsLGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxkaXZSZXNldD0iLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94Oy1tb3otYm94LXNpemluZzpjb250ZW50LWJveDtib3gtc2l6aW5nOmNvbnRlbnQtYm94OyIrImRpc3BsYXk6YmxvY2s7cGFkZGluZzowO21hcmdpbjowO2JvcmRlcjowIjtkaXYuaW5uZXJIVE1MPSIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iO2E9ZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJhIilbMF07YS5zdHlsZS5jc3NUZXh0PSJmbG9hdDpsZWZ0O29wYWNpdHk6LjUiO3N1cHBvcnQub3BhY2l0eT0vXjAuNS8udGVzdChhLnN0eWxlLm9wYWNpdHkpO3N1cHBvcnQuY3NzRmxvYXQ9ISFhLnN0eWxlLmNzc0Zsb2F0O2Rpdi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iY29udGVudC1ib3giO2Rpdi5jbG9uZU5vZGUodHJ1ZSkuc3R5bGUuYmFja2dyb3VuZENsaXA9IiI7c3VwcG9ydC5jbGVhckNsb25lU3R5bGU9ZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwPT09ImNvbnRlbnQtYm94IjthPWRpdj1udWxsO3N1cHBvcnQuc2hyaW5rV3JhcEJsb2Nrcz1mdW5jdGlvbigpe3ZhciBib2R5LGNvbnRhaW5lcixkaXYsY29udGFpbmVyU3R5bGVzO2lmKHNocmlua1dyYXBCbG9ja3NWYWw9PW51bGwpe2JvZHk9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImJvZHkiKVswXTtpZighYm9keSl7cmV0dXJuO30KY29udGFpbmVyU3R5bGVzPSJib3JkZXI6MDt3aWR0aDowO2hlaWdodDowO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6LTk5OTlweCI7Y29udGFpbmVyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2Rpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcikuYXBwZW5kQ2hpbGQoZGl2KTtzaHJpbmtXcmFwQmxvY2tzVmFsPWZhbHNlO2lmKHR5cGVvZiBkaXYuc3R5bGUuem9vbSE9PXN0cnVuZGVmaW5lZCl7ZGl2LnN0eWxlLmNzc1RleHQ9ZGl2UmVzZXQrIjt3aWR0aDoxcHg7cGFkZGluZzoxcHg7em9vbToxIjtkaXYuaW5uZXJIVE1MPSI8ZGl2PjwvZGl2PiI7ZGl2LmZpcnN0Q2hpbGQuc3R5bGUud2lkdGg9IjVweCI7c2hyaW5rV3JhcEJsb2Nrc1ZhbD1kaXYub2Zmc2V0V2lkdGghPT0zO30KYm9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO2JvZHk9Y29udGFpbmVyPWRpdj1udWxsO30KcmV0dXJuIHNocmlua1dyYXBCbG9ja3NWYWw7fTt9KSgpO3ZhciBybWFyZ2luPSgvXm1hcmdpbi8pO3ZhciBybnVtbm9ucHg9bmV3IFJlZ0V4cCgiXigiK3BudW0rIikoPyFweClbYS16JV0rJCIsImkiKTt2YXIgZ2V0U3R5bGVzLGN1ckNTUyxycG9zaXRpb249L14odG9wfHJpZ2h0fGJvdHRvbXxsZWZ0KSQvO2lmKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKXtnZXRTdHlsZXM9ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZW0sbnVsbCk7fTtjdXJDU1M9ZnVuY3Rpb24oZWxlbSxuYW1lLGNvbXB1dGVkKXt2YXIgd2lkdGgsbWluV2lkdGgsbWF4V2lkdGgscmV0LHN0eWxlPWVsZW0uc3R5bGU7Y29tcHV0ZWQ9Y29tcHV0ZWR8fGdldFN0eWxlcyhlbGVtKTtyZXQ9Y29tcHV0ZWQ/Y29tcHV0ZWQuZ2V0UHJvcGVydHlWYWx1ZShuYW1lKXx8Y29tcHV0ZWRbbmFtZV06dW5kZWZpbmVkO2lmKGNvbXB1dGVkKXtpZihyZXQ9PT0iIiYmIWpRdWVyeS5jb250YWlucyhlbGVtLm93bmVyRG9jdW1lbnQsZWxlbSkpe3JldD1qUXVlcnkuc3R5bGUoZWxlbSxuYW1lKTt9CmlmKHJudW1ub25weC50ZXN0KHJldCkmJnJtYXJnaW4udGVzdChuYW1lKSl7d2lkdGg9c3R5bGUud2lkdGg7bWluV2lkdGg9c3R5bGUubWluV2lkdGg7bWF4V2lkdGg9c3R5bGUubWF4V2lkdGg7c3R5bGUubWluV2lkdGg9c3R5bGUubWF4V2lkdGg9c3R5bGUud2lkdGg9cmV0O3JldD1jb21wdXRlZC53aWR0aDtzdHlsZS53aWR0aD13aWR0aDtzdHlsZS5taW5XaWR0aD1taW5XaWR0aDtzdHlsZS5tYXhXaWR0aD1tYXhXaWR0aDt9fQpyZXR1cm4gcmV0PT09dW5kZWZpbmVkP3JldDpyZXQrIiI7fTt9ZWxzZSBpZihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlKXtnZXRTdHlsZXM9ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGVsZW0uY3VycmVudFN0eWxlO307Y3VyQ1NTPWZ1bmN0aW9uKGVsZW0sbmFtZSxjb21wdXRlZCl7dmFyIGxlZnQscnMscnNMZWZ0LHJldCxzdHlsZT1lbGVtLnN0eWxlO2NvbXB1dGVkPWNvbXB1dGVkfHxnZXRTdHlsZXMoZWxlbSk7cmV0PWNvbXB1dGVkP2NvbXB1dGVkW25hbWVdOnVuZGVmaW5lZDtpZihyZXQ9PW51bGwmJnN0eWxlJiZzdHlsZVtuYW1lXSl7cmV0PXN0eWxlW25hbWVdO30KaWYocm51bW5vbnB4LnRlc3QocmV0KSYmIXJwb3NpdGlvbi50ZXN0KG5hbWUpKXtsZWZ0PXN0eWxlLmxlZnQ7cnM9ZWxlbS5ydW50aW1lU3R5bGU7cnNMZWZ0PXJzJiZycy5sZWZ0O2lmKHJzTGVmdCl7cnMubGVmdD1lbGVtLmN1cnJlbnRTdHlsZS5sZWZ0O30Kc3R5bGUubGVmdD1uYW1lPT09ImZvbnRTaXplIj8iMWVtIjpyZXQ7cmV0PXN0eWxlLnBpeGVsTGVmdCsicHgiO3N0eWxlLmxlZnQ9bGVmdDtpZihyc0xlZnQpe3JzLmxlZnQ9cnNMZWZ0O319CnJldHVybiByZXQ9PT11bmRlZmluZWQ/cmV0OnJldCsiInx8ImF1dG8iO307fQpmdW5jdGlvbiBhZGRHZXRIb29rSWYoY29uZGl0aW9uRm4saG9va0ZuKXtyZXR1cm57Z2V0OmZ1bmN0aW9uKCl7dmFyIGNvbmRpdGlvbj1jb25kaXRpb25GbigpO2lmKGNvbmRpdGlvbj09bnVsbCl7cmV0dXJuO30KaWYoY29uZGl0aW9uKXtkZWxldGUgdGhpcy5nZXQ7cmV0dXJuO30KcmV0dXJuKHRoaXMuZ2V0PWhvb2tGbikuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O30KKGZ1bmN0aW9uKCl7dmFyIGEscmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsLGJveFNpemluZ1ZhbCxib3hTaXppbmdSZWxpYWJsZVZhbCxwaXhlbFBvc2l0aW9uVmFsLHJlbGlhYmxlTWFyZ2luUmlnaHRWYWwsZGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLGNvbnRhaW5lclN0eWxlcz0iYm9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0Oi05OTk5cHgiLGRpdlJlc2V0PSItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94O2JveC1zaXppbmc6Y29udGVudC1ib3g7IisiZGlzcGxheTpibG9jaztwYWRkaW5nOjA7bWFyZ2luOjA7Ym9yZGVyOjAiO2Rpdi5pbm5lckhUTUw9IiAgPGxpbmsvPjx0YWJsZT48L3RhYmxlPjxhIGhyZWY9Jy9hJz5hPC9hPjxpbnB1dCB0eXBlPSdjaGVja2JveCcvPiI7YT1kaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImEiKVswXTthLnN0eWxlLmNzc1RleHQ9ImZsb2F0OmxlZnQ7b3BhY2l0eTouNSI7c3VwcG9ydC5vcGFjaXR5PS9eMC41Ly50ZXN0KGEuc3R5bGUub3BhY2l0eSk7c3VwcG9ydC5jc3NGbG9hdD0hIWEuc3R5bGUuY3NzRmxvYXQ7ZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwPSJjb250ZW50LWJveCI7ZGl2LmNsb25lTm9kZSh0cnVlKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iIjtzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZT1kaXYuc3R5bGUuYmFja2dyb3VuZENsaXA9PT0iY29udGVudC1ib3giO2E9ZGl2PW51bGw7alF1ZXJ5LmV4dGVuZChzdXBwb3J0LHtyZWxpYWJsZUhpZGRlbk9mZnNldHM6ZnVuY3Rpb24oKXtpZihyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwhPW51bGwpe3JldHVybiByZWxpYWJsZUhpZGRlbk9mZnNldHNWYWw7fQp2YXIgY29udGFpbmVyLHRkcyxpc1N1cHBvcnRlZCxkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksYm9keT1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdO2lmKCFib2R5KXtyZXR1cm47fQpkaXYuc2V0QXR0cmlidXRlKCJjbGFzc05hbWUiLCJ0Iik7ZGl2LmlubmVySFRNTD0iICA8bGluay8+PHRhYmxlPjwvdGFibGU+PGEgaHJlZj0nL2EnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+Ijtjb250YWluZXI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Y29udGFpbmVyLnN0eWxlLmNzc1RleHQ9Y29udGFpbmVyU3R5bGVzO2JvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKS5hcHBlbmRDaGlsZChkaXYpO2Rpdi5pbm5lckhUTUw9Ijx0YWJsZT48dHI+PHRkPjwvdGQ+PHRkPnQ8L3RkPjwvdHI+PC90YWJsZT4iO3Rkcz1kaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRkIik7dGRzWzBdLnN0eWxlLmNzc1RleHQ9InBhZGRpbmc6MDttYXJnaW46MDtib3JkZXI6MDtkaXNwbGF5Om5vbmUiO2lzU3VwcG9ydGVkPSh0ZHNbMF0ub2Zmc2V0SGVpZ2h0PT09MCk7dGRzWzBdLnN0eWxlLmRpc3BsYXk9IiI7dGRzWzFdLnN0eWxlLmRpc3BsYXk9Im5vbmUiO3JlbGlhYmxlSGlkZGVuT2Zmc2V0c1ZhbD1pc1N1cHBvcnRlZCYmKHRkc1swXS5vZmZzZXRIZWlnaHQ9PT0wKTtib2R5LnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7ZGl2PWJvZHk9bnVsbDtyZXR1cm4gcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsO30sYm94U2l6aW5nOmZ1bmN0aW9uKCl7aWYoYm94U2l6aW5nVmFsPT1udWxsKXtjb21wdXRlU3R5bGVUZXN0cygpO30KcmV0dXJuIGJveFNpemluZ1ZhbDt9LGJveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7aWYoYm94U2l6aW5nUmVsaWFibGVWYWw9PW51bGwpe2NvbXB1dGVTdHlsZVRlc3RzKCk7fQpyZXR1cm4gYm94U2l6aW5nUmVsaWFibGVWYWw7fSxwaXhlbFBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYocGl4ZWxQb3NpdGlvblZhbD09bnVsbCl7Y29tcHV0ZVN0eWxlVGVzdHMoKTt9CnJldHVybiBwaXhlbFBvc2l0aW9uVmFsO30scmVsaWFibGVNYXJnaW5SaWdodDpmdW5jdGlvbigpe3ZhciBib2R5LGNvbnRhaW5lcixkaXYsbWFyZ2luRGl2O2lmKHJlbGlhYmxlTWFyZ2luUmlnaHRWYWw9PW51bGwmJndpbmRvdy5nZXRDb21wdXRlZFN0eWxlKXtib2R5PWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07aWYoIWJvZHkpe3JldHVybjt9CmNvbnRhaW5lcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7Y29udGFpbmVyLnN0eWxlLmNzc1RleHQ9Y29udGFpbmVyU3R5bGVzO2JvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKS5hcHBlbmRDaGlsZChkaXYpO21hcmdpbkRpdj1kaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpO21hcmdpbkRpdi5zdHlsZS5jc3NUZXh0PWRpdi5zdHlsZS5jc3NUZXh0PWRpdlJlc2V0O21hcmdpbkRpdi5zdHlsZS5tYXJnaW5SaWdodD1tYXJnaW5EaXYuc3R5bGUud2lkdGg9IjAiO2Rpdi5zdHlsZS53aWR0aD0iMXB4IjtyZWxpYWJsZU1hcmdpblJpZ2h0VmFsPSFwYXJzZUZsb2F0KCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShtYXJnaW5EaXYsbnVsbCl8fHt9KS5tYXJnaW5SaWdodCk7Ym9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO30KcmV0dXJuIHJlbGlhYmxlTWFyZ2luUmlnaHRWYWw7fX0pO2Z1bmN0aW9uIGNvbXB1dGVTdHlsZVRlc3RzKCl7dmFyIGNvbnRhaW5lcixkaXYsYm9keT1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdO2lmKCFib2R5KXtyZXR1cm47fQpjb250YWluZXI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7ZGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2NvbnRhaW5lci5zdHlsZS5jc3NUZXh0PWNvbnRhaW5lclN0eWxlcztib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcikuYXBwZW5kQ2hpbGQoZGl2KTtkaXYuc3R5bGUuY3NzVGV4dD0iLXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7LW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94OyIrInBvc2l0aW9uOmFic29sdXRlO2Rpc3BsYXk6YmxvY2s7cGFkZGluZzoxcHg7Ym9yZGVyOjFweDt3aWR0aDo0cHg7IisibWFyZ2luLXRvcDoxJTt0b3A6MSUiO2pRdWVyeS5zd2FwKGJvZHksYm9keS5zdHlsZS56b29tIT1udWxsP3t6b29tOjF9Ont9LGZ1bmN0aW9uKCl7Ym94U2l6aW5nVmFsPWRpdi5vZmZzZXRXaWR0aD09PTQ7fSk7Ym94U2l6aW5nUmVsaWFibGVWYWw9dHJ1ZTtwaXhlbFBvc2l0aW9uVmFsPWZhbHNlO3JlbGlhYmxlTWFyZ2luUmlnaHRWYWw9dHJ1ZTtpZih3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSl7cGl4ZWxQb3NpdGlvblZhbD0od2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2LG51bGwpfHx7fSkudG9wIT09IjElIjtib3hTaXppbmdSZWxpYWJsZVZhbD0od2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2LG51bGwpfHx7d2lkdGg6IjRweCJ9KS53aWR0aD09PSI0cHgiO30KYm9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO2Rpdj1ib2R5PW51bGw7fX0pKCk7alF1ZXJ5LnN3YXA9ZnVuY3Rpb24oZWxlbSxvcHRpb25zLGNhbGxiYWNrLGFyZ3Mpe3ZhciByZXQsbmFtZSxvbGQ9e307Zm9yKG5hbWUgaW4gb3B0aW9ucyl7b2xkW25hbWVdPWVsZW0uc3R5bGVbbmFtZV07ZWxlbS5zdHlsZVtuYW1lXT1vcHRpb25zW25hbWVdO30KcmV0PWNhbGxiYWNrLmFwcGx5KGVsZW0sYXJnc3x8W10pO2ZvcihuYW1lIGluIG9wdGlvbnMpe2VsZW0uc3R5bGVbbmFtZV09b2xkW25hbWVdO30KcmV0dXJuIHJldDt9O3ZhcgpyYWxwaGE9L2FscGhhXChbXildKlwpL2kscm9wYWNpdHk9L29wYWNpdHlccyo9XHMqKFteKV0qKS8scmRpc3BsYXlzd2FwPS9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLyxybnVtc3BsaXQ9bmV3IFJlZ0V4cCgiXigiK3BudW0rIikoLiopJCIsImkiKSxycmVsTnVtPW5ldyBSZWdFeHAoIl4oWystXSk9KCIrcG51bSsiKSIsImkiKSxjc3NTaG93PXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxjc3NOb3JtYWxUcmFuc2Zvcm09e2xldHRlclNwYWNpbmc6MCxmb250V2VpZ2h0OjQwMH0sY3NzUHJlZml4ZXM9WyJXZWJraXQiLCJPIiwiTW96IiwibXMiXTtmdW5jdGlvbiB2ZW5kb3JQcm9wTmFtZShzdHlsZSxuYW1lKXtpZihuYW1lIGluIHN0eWxlKXtyZXR1cm4gbmFtZTt9CnZhciBjYXBOYW1lPW5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrbmFtZS5zbGljZSgxKSxvcmlnTmFtZT1uYW1lLGk9Y3NzUHJlZml4ZXMubGVuZ3RoO3doaWxlKGktLSl7bmFtZT1jc3NQcmVmaXhlc1tpXStjYXBOYW1lO2lmKG5hbWUgaW4gc3R5bGUpe3JldHVybiBuYW1lO319CnJldHVybiBvcmlnTmFtZTt9CmZ1bmN0aW9uIHNob3dIaWRlKGVsZW1lbnRzLHNob3cpe3ZhciBkaXNwbGF5LGVsZW0saGlkZGVuLHZhbHVlcz1bXSxpbmRleD0wLGxlbmd0aD1lbGVtZW50cy5sZW5ndGg7Zm9yKDtpbmRleDxsZW5ndGg7aW5kZXgrKyl7ZWxlbT1lbGVtZW50c1tpbmRleF07aWYoIWVsZW0uc3R5bGUpe2NvbnRpbnVlO30KdmFsdWVzW2luZGV4XT1qUXVlcnkuX2RhdGEoZWxlbSwib2xkZGlzcGxheSIpO2Rpc3BsYXk9ZWxlbS5zdHlsZS5kaXNwbGF5O2lmKHNob3cpe2lmKCF2YWx1ZXNbaW5kZXhdJiZkaXNwbGF5PT09Im5vbmUiKXtlbGVtLnN0eWxlLmRpc3BsYXk9IiI7fQppZihlbGVtLnN0eWxlLmRpc3BsYXk9PT0iIiYmaXNIaWRkZW4oZWxlbSkpe3ZhbHVlc1tpbmRleF09alF1ZXJ5Ll9kYXRhKGVsZW0sIm9sZGRpc3BsYXkiLGRlZmF1bHREaXNwbGF5KGVsZW0ubm9kZU5hbWUpKTt9fWVsc2V7aWYoIXZhbHVlc1tpbmRleF0pe2hpZGRlbj1pc0hpZGRlbihlbGVtKTtpZihkaXNwbGF5JiZkaXNwbGF5IT09Im5vbmUifHwhaGlkZGVuKXtqUXVlcnkuX2RhdGEoZWxlbSwib2xkZGlzcGxheSIsaGlkZGVuP2Rpc3BsYXk6alF1ZXJ5LmNzcyhlbGVtLCJkaXNwbGF5IikpO319fX0KZm9yKGluZGV4PTA7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe2VsZW09ZWxlbWVudHNbaW5kZXhdO2lmKCFlbGVtLnN0eWxlKXtjb250aW51ZTt9CmlmKCFzaG93fHxlbGVtLnN0eWxlLmRpc3BsYXk9PT0ibm9uZSJ8fGVsZW0uc3R5bGUuZGlzcGxheT09PSIiKXtlbGVtLnN0eWxlLmRpc3BsYXk9c2hvdz92YWx1ZXNbaW5kZXhdfHwiIjoibm9uZSI7fX0KcmV0dXJuIGVsZW1lbnRzO30KZnVuY3Rpb24gc2V0UG9zaXRpdmVOdW1iZXIoZWxlbSx2YWx1ZSxzdWJ0cmFjdCl7dmFyIG1hdGNoZXM9cm51bXNwbGl0LmV4ZWModmFsdWUpO3JldHVybiBtYXRjaGVzP01hdGgubWF4KDAsbWF0Y2hlc1sxXS0oc3VidHJhY3R8fDApKSsobWF0Y2hlc1syXXx8InB4Iik6dmFsdWU7fQpmdW5jdGlvbiBhdWdtZW50V2lkdGhPckhlaWdodChlbGVtLG5hbWUsZXh0cmEsaXNCb3JkZXJCb3gsc3R5bGVzKXt2YXIgaT1leHRyYT09PShpc0JvcmRlckJveD8iYm9yZGVyIjoiY29udGVudCIpPzQ6bmFtZT09PSJ3aWR0aCI/MTowLHZhbD0wO2Zvcig7aTw0O2krPTIpe2lmKGV4dHJhPT09Im1hcmdpbiIpe3ZhbCs9alF1ZXJ5LmNzcyhlbGVtLGV4dHJhK2Nzc0V4cGFuZFtpXSx0cnVlLHN0eWxlcyk7fQppZihpc0JvcmRlckJveCl7aWYoZXh0cmE9PT0iY29udGVudCIpe3ZhbC09alF1ZXJ5LmNzcyhlbGVtLCJwYWRkaW5nIitjc3NFeHBhbmRbaV0sdHJ1ZSxzdHlsZXMpO30KaWYoZXh0cmEhPT0ibWFyZ2luIil7dmFsLT1qUXVlcnkuY3NzKGVsZW0sImJvcmRlciIrY3NzRXhwYW5kW2ldKyJXaWR0aCIsdHJ1ZSxzdHlsZXMpO319ZWxzZXt2YWwrPWpRdWVyeS5jc3MoZWxlbSwicGFkZGluZyIrY3NzRXhwYW5kW2ldLHRydWUsc3R5bGVzKTtpZihleHRyYSE9PSJwYWRkaW5nIil7dmFsKz1qUXVlcnkuY3NzKGVsZW0sImJvcmRlciIrY3NzRXhwYW5kW2ldKyJXaWR0aCIsdHJ1ZSxzdHlsZXMpO319fQpyZXR1cm4gdmFsO30KZnVuY3Rpb24gZ2V0V2lkdGhPckhlaWdodChlbGVtLG5hbWUsZXh0cmEpe3ZhciB2YWx1ZUlzQm9yZGVyQm94PXRydWUsdmFsPW5hbWU9PT0id2lkdGgiP2VsZW0ub2Zmc2V0V2lkdGg6ZWxlbS5vZmZzZXRIZWlnaHQsc3R5bGVzPWdldFN0eWxlcyhlbGVtKSxpc0JvcmRlckJveD1zdXBwb3J0LmJveFNpemluZygpJiZqUXVlcnkuY3NzKGVsZW0sImJveFNpemluZyIsZmFsc2Usc3R5bGVzKT09PSJib3JkZXItYm94IjtpZih2YWw8PTB8fHZhbD09bnVsbCl7dmFsPWN1ckNTUyhlbGVtLG5hbWUsc3R5bGVzKTtpZih2YWw8MHx8dmFsPT1udWxsKXt2YWw9ZWxlbS5zdHlsZVtuYW1lXTt9CmlmKHJudW1ub25weC50ZXN0KHZhbCkpe3JldHVybiB2YWw7fQp2YWx1ZUlzQm9yZGVyQm94PWlzQm9yZGVyQm94JiYoc3VwcG9ydC5ib3hTaXppbmdSZWxpYWJsZSgpfHx2YWw9PT1lbGVtLnN0eWxlW25hbWVdKTt2YWw9cGFyc2VGbG9hdCh2YWwpfHwwO30KcmV0dXJuKHZhbCsKYXVnbWVudFdpZHRoT3JIZWlnaHQoZWxlbSxuYW1lLGV4dHJhfHwoaXNCb3JkZXJCb3g/ImJvcmRlciI6ImNvbnRlbnQiKSx2YWx1ZUlzQm9yZGVyQm94LHN0eWxlcykpKyJweCI7fQpqUXVlcnkuZXh0ZW5kKHtjc3NIb29rczp7b3BhY2l0eTp7Z2V0OmZ1bmN0aW9uKGVsZW0sY29tcHV0ZWQpe2lmKGNvbXB1dGVkKXt2YXIgcmV0PWN1ckNTUyhlbGVtLCJvcGFjaXR5Iik7cmV0dXJuIHJldD09PSIiPyIxIjpyZXQ7fX19fSxjc3NOdW1iZXI6eyJjb2x1bW5Db3VudCI6dHJ1ZSwiZmlsbE9wYWNpdHkiOnRydWUsImZvbnRXZWlnaHQiOnRydWUsImxpbmVIZWlnaHQiOnRydWUsIm9wYWNpdHkiOnRydWUsIm9yZGVyIjp0cnVlLCJvcnBoYW5zIjp0cnVlLCJ3aWRvd3MiOnRydWUsInpJbmRleCI6dHJ1ZSwiem9vbSI6dHJ1ZX0sY3NzUHJvcHM6eyJmbG9hdCI6c3VwcG9ydC5jc3NGbG9hdD8iY3NzRmxvYXQiOiJzdHlsZUZsb2F0In0sc3R5bGU6ZnVuY3Rpb24oZWxlbSxuYW1lLHZhbHVlLGV4dHJhKXtpZighZWxlbXx8ZWxlbS5ub2RlVHlwZT09PTN8fGVsZW0ubm9kZVR5cGU9PT04fHwhZWxlbS5zdHlsZSl7cmV0dXJuO30KdmFyIHJldCx0eXBlLGhvb2tzLG9yaWdOYW1lPWpRdWVyeS5jYW1lbENhc2UobmFtZSksc3R5bGU9ZWxlbS5zdHlsZTtuYW1lPWpRdWVyeS5jc3NQcm9wc1tvcmlnTmFtZV18fChqUXVlcnkuY3NzUHJvcHNbb3JpZ05hbWVdPXZlbmRvclByb3BOYW1lKHN0eWxlLG9yaWdOYW1lKSk7aG9va3M9alF1ZXJ5LmNzc0hvb2tzW25hbWVdfHxqUXVlcnkuY3NzSG9va3Nbb3JpZ05hbWVdO2lmKHZhbHVlIT09dW5kZWZpbmVkKXt0eXBlPXR5cGVvZiB2YWx1ZTtpZih0eXBlPT09InN0cmluZyImJihyZXQ9cnJlbE51bS5leGVjKHZhbHVlKSkpe3ZhbHVlPShyZXRbMV0rMSkqcmV0WzJdK3BhcnNlRmxvYXQoalF1ZXJ5LmNzcyhlbGVtLG5hbWUpKTt0eXBlPSJudW1iZXIiO30KaWYodmFsdWU9PW51bGx8fHZhbHVlIT09dmFsdWUpe3JldHVybjt9CmlmKHR5cGU9PT0ibnVtYmVyIiYmIWpRdWVyeS5jc3NOdW1iZXJbb3JpZ05hbWVdKXt2YWx1ZSs9InB4Ijt9CmlmKCFzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZSYmdmFsdWU9PT0iIiYmbmFtZS5pbmRleE9mKCJiYWNrZ3JvdW5kIik9PT0wKXtzdHlsZVtuYW1lXT0iaW5oZXJpdCI7fQppZighaG9va3N8fCEoInNldCJpbiBob29rcyl8fCh2YWx1ZT1ob29rcy5zZXQoZWxlbSx2YWx1ZSxleHRyYSkpIT09dW5kZWZpbmVkKXt0cnl7c3R5bGVbbmFtZV09IiI7c3R5bGVbbmFtZV09dmFsdWU7fWNhdGNoKGUpe319fWVsc2V7aWYoaG9va3MmJiJnZXQiaW4gaG9va3MmJihyZXQ9aG9va3MuZ2V0KGVsZW0sZmFsc2UsZXh0cmEpKSE9PXVuZGVmaW5lZCl7cmV0dXJuIHJldDt9CnJldHVybiBzdHlsZVtuYW1lXTt9fSxjc3M6ZnVuY3Rpb24oZWxlbSxuYW1lLGV4dHJhLHN0eWxlcyl7dmFyIG51bSx2YWwsaG9va3Msb3JpZ05hbWU9alF1ZXJ5LmNhbWVsQ2FzZShuYW1lKTtuYW1lPWpRdWVyeS5jc3NQcm9wc1tvcmlnTmFtZV18fChqUXVlcnkuY3NzUHJvcHNbb3JpZ05hbWVdPXZlbmRvclByb3BOYW1lKGVsZW0uc3R5bGUsb3JpZ05hbWUpKTtob29rcz1qUXVlcnkuY3NzSG9va3NbbmFtZV18fGpRdWVyeS5jc3NIb29rc1tvcmlnTmFtZV07aWYoaG9va3MmJiJnZXQiaW4gaG9va3Mpe3ZhbD1ob29rcy5nZXQoZWxlbSx0cnVlLGV4dHJhKTt9CmlmKHZhbD09PXVuZGVmaW5lZCl7dmFsPWN1ckNTUyhlbGVtLG5hbWUsc3R5bGVzKTt9CmlmKHZhbD09PSJub3JtYWwiJiZuYW1lIGluIGNzc05vcm1hbFRyYW5zZm9ybSl7dmFsPWNzc05vcm1hbFRyYW5zZm9ybVtuYW1lXTt9CmlmKGV4dHJhPT09IiJ8fGV4dHJhKXtudW09cGFyc2VGbG9hdCh2YWwpO3JldHVybiBleHRyYT09PXRydWV8fGpRdWVyeS5pc051bWVyaWMobnVtKT9udW18fDA6dmFsO30KcmV0dXJuIHZhbDt9fSk7alF1ZXJ5LmVhY2goWyJoZWlnaHQiLCJ3aWR0aCJdLGZ1bmN0aW9uKGksbmFtZSl7alF1ZXJ5LmNzc0hvb2tzW25hbWVdPXtnZXQ6ZnVuY3Rpb24oZWxlbSxjb21wdXRlZCxleHRyYSl7aWYoY29tcHV0ZWQpe3JldHVybiBlbGVtLm9mZnNldFdpZHRoPT09MCYmcmRpc3BsYXlzd2FwLnRlc3QoalF1ZXJ5LmNzcyhlbGVtLCJkaXNwbGF5IikpP2pRdWVyeS5zd2FwKGVsZW0sY3NzU2hvdyxmdW5jdGlvbigpe3JldHVybiBnZXRXaWR0aE9ySGVpZ2h0KGVsZW0sbmFtZSxleHRyYSk7fSk6Z2V0V2lkdGhPckhlaWdodChlbGVtLG5hbWUsZXh0cmEpO319LHNldDpmdW5jdGlvbihlbGVtLHZhbHVlLGV4dHJhKXt2YXIgc3R5bGVzPWV4dHJhJiZnZXRTdHlsZXMoZWxlbSk7cmV0dXJuIHNldFBvc2l0aXZlTnVtYmVyKGVsZW0sdmFsdWUsZXh0cmE/YXVnbWVudFdpZHRoT3JIZWlnaHQoZWxlbSxuYW1lLGV4dHJhLHN1cHBvcnQuYm94U2l6aW5nKCkmJmpRdWVyeS5jc3MoZWxlbSwiYm94U2l6aW5nIixmYWxzZSxzdHlsZXMpPT09ImJvcmRlci1ib3giLHN0eWxlcyk6MCk7fX07fSk7aWYoIXN1cHBvcnQub3BhY2l0eSl7alF1ZXJ5LmNzc0hvb2tzLm9wYWNpdHk9e2dldDpmdW5jdGlvbihlbGVtLGNvbXB1dGVkKXtyZXR1cm4gcm9wYWNpdHkudGVzdCgoY29tcHV0ZWQmJmVsZW0uY3VycmVudFN0eWxlP2VsZW0uY3VycmVudFN0eWxlLmZpbHRlcjplbGVtLnN0eWxlLmZpbHRlcil8fCIiKT8oMC4wMSpwYXJzZUZsb2F0KFJlZ0V4cC4kMSkpKyIiOmNvbXB1dGVkPyIxIjoiIjt9LHNldDpmdW5jdGlvbihlbGVtLHZhbHVlKXt2YXIgc3R5bGU9ZWxlbS5zdHlsZSxjdXJyZW50U3R5bGU9ZWxlbS5jdXJyZW50U3R5bGUsb3BhY2l0eT1qUXVlcnkuaXNOdW1lcmljKHZhbHVlKT8iYWxwaGEob3BhY2l0eT0iK3ZhbHVlKjEwMCsiKSI6IiIsZmlsdGVyPWN1cnJlbnRTdHlsZSYmY3VycmVudFN0eWxlLmZpbHRlcnx8c3R5bGUuZmlsdGVyfHwiIjtzdHlsZS56b29tPTE7aWYoKHZhbHVlPj0xfHx2YWx1ZT09PSIiKSYmalF1ZXJ5LnRyaW0oZmlsdGVyLnJlcGxhY2UocmFscGhhLCIiKSk9PT0iIiYmc3R5bGUucmVtb3ZlQXR0cmlidXRlKXtzdHlsZS5yZW1vdmVBdHRyaWJ1dGUoImZpbHRlciIpO2lmKHZhbHVlPT09IiJ8fGN1cnJlbnRTdHlsZSYmIWN1cnJlbnRTdHlsZS5maWx0ZXIpe3JldHVybjt9fQpzdHlsZS5maWx0ZXI9cmFscGhhLnRlc3QoZmlsdGVyKT9maWx0ZXIucmVwbGFjZShyYWxwaGEsb3BhY2l0eSk6ZmlsdGVyKyIgIitvcGFjaXR5O319O30KalF1ZXJ5LmNzc0hvb2tzLm1hcmdpblJpZ2h0PWFkZEdldEhvb2tJZihzdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmlnaHQsZnVuY3Rpb24oZWxlbSxjb21wdXRlZCl7aWYoY29tcHV0ZWQpe3JldHVybiBqUXVlcnkuc3dhcChlbGVtLHsiZGlzcGxheSI6ImlubGluZS1ibG9jayJ9LGN1ckNTUyxbZWxlbSwibWFyZ2luUmlnaHQiXSk7fX0pO2pRdWVyeS5lYWNoKHttYXJnaW46IiIscGFkZGluZzoiIixib3JkZXI6IldpZHRoIn0sZnVuY3Rpb24ocHJlZml4LHN1ZmZpeCl7alF1ZXJ5LmNzc0hvb2tzW3ByZWZpeCtzdWZmaXhdPXtleHBhbmQ6ZnVuY3Rpb24odmFsdWUpe3ZhciBpPTAsZXhwYW5kZWQ9e30scGFydHM9dHlwZW9mIHZhbHVlPT09InN0cmluZyI/dmFsdWUuc3BsaXQoIiAiKTpbdmFsdWVdO2Zvcig7aTw0O2krKyl7ZXhwYW5kZWRbcHJlZml4K2Nzc0V4cGFuZFtpXStzdWZmaXhdPXBhcnRzW2ldfHxwYXJ0c1tpLTJdfHxwYXJ0c1swXTt9CnJldHVybiBleHBhbmRlZDt9fTtpZighcm1hcmdpbi50ZXN0KHByZWZpeCkpe2pRdWVyeS5jc3NIb29rc1twcmVmaXgrc3VmZml4XS5zZXQ9c2V0UG9zaXRpdmVOdW1iZXI7fX0pO2pRdWVyeS5mbi5leHRlbmQoe2NzczpmdW5jdGlvbihuYW1lLHZhbHVlKXtyZXR1cm4gYWNjZXNzKHRoaXMsZnVuY3Rpb24oZWxlbSxuYW1lLHZhbHVlKXt2YXIgc3R5bGVzLGxlbixtYXA9e30saT0wO2lmKGpRdWVyeS5pc0FycmF5KG5hbWUpKXtzdHlsZXM9Z2V0U3R5bGVzKGVsZW0pO2xlbj1uYW1lLmxlbmd0aDtmb3IoO2k8bGVuO2krKyl7bWFwW25hbWVbaV1dPWpRdWVyeS5jc3MoZWxlbSxuYW1lW2ldLGZhbHNlLHN0eWxlcyk7fQpyZXR1cm4gbWFwO30KcmV0dXJuIHZhbHVlIT09dW5kZWZpbmVkP2pRdWVyeS5zdHlsZShlbGVtLG5hbWUsdmFsdWUpOmpRdWVyeS5jc3MoZWxlbSxuYW1lKTt9LG5hbWUsdmFsdWUsYXJndW1lbnRzLmxlbmd0aD4xKTt9LHNob3c6ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd0hpZGUodGhpcyx0cnVlKTt9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd0hpZGUodGhpcyk7fSx0b2dnbGU6ZnVuY3Rpb24oc3RhdGUpe2lmKHR5cGVvZiBzdGF0ZT09PSJib29sZWFuIil7cmV0dXJuIHN0YXRlP3RoaXMuc2hvdygpOnRoaXMuaGlkZSgpO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKGlzSGlkZGVuKHRoaXMpKXtqUXVlcnkodGhpcykuc2hvdygpO31lbHNle2pRdWVyeSh0aGlzKS5oaWRlKCk7fX0pO319KTtmdW5jdGlvbiBUd2VlbihlbGVtLG9wdGlvbnMscHJvcCxlbmQsZWFzaW5nKXtyZXR1cm4gbmV3IFR3ZWVuLnByb3RvdHlwZS5pbml0KGVsZW0sb3B0aW9ucyxwcm9wLGVuZCxlYXNpbmcpO30KalF1ZXJ5LlR3ZWVuPVR3ZWVuO1R3ZWVuLnByb3RvdHlwZT17Y29uc3RydWN0b3I6VHdlZW4saW5pdDpmdW5jdGlvbihlbGVtLG9wdGlvbnMscHJvcCxlbmQsZWFzaW5nLHVuaXQpe3RoaXMuZWxlbT1lbGVtO3RoaXMucHJvcD1wcm9wO3RoaXMuZWFzaW5nPWVhc2luZ3x8InN3aW5nIjt0aGlzLm9wdGlvbnM9b3B0aW9uczt0aGlzLnN0YXJ0PXRoaXMubm93PXRoaXMuY3VyKCk7dGhpcy5lbmQ9ZW5kO3RoaXMudW5pdD11bml0fHwoalF1ZXJ5LmNzc051bWJlcltwcm9wXT8iIjoicHgiKTt9LGN1cjpmdW5jdGlvbigpe3ZhciBob29rcz1Ud2Vlbi5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gaG9va3MmJmhvb2tzLmdldD9ob29rcy5nZXQodGhpcyk6VHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKTt9LHJ1bjpmdW5jdGlvbihwZXJjZW50KXt2YXIgZWFzZWQsaG9va3M9VHdlZW4ucHJvcEhvb2tzW3RoaXMucHJvcF07aWYodGhpcy5vcHRpb25zLmR1cmF0aW9uKXt0aGlzLnBvcz1lYXNlZD1qUXVlcnkuZWFzaW5nW3RoaXMuZWFzaW5nXShwZXJjZW50LHRoaXMub3B0aW9ucy5kdXJhdGlvbipwZXJjZW50LDAsMSx0aGlzLm9wdGlvbnMuZHVyYXRpb24pO31lbHNle3RoaXMucG9zPWVhc2VkPXBlcmNlbnQ7fQp0aGlzLm5vdz0odGhpcy5lbmQtdGhpcy5zdGFydCkqZWFzZWQrdGhpcy5zdGFydDtpZih0aGlzLm9wdGlvbnMuc3RlcCl7dGhpcy5vcHRpb25zLnN0ZXAuY2FsbCh0aGlzLmVsZW0sdGhpcy5ub3csdGhpcyk7fQppZihob29rcyYmaG9va3Muc2V0KXtob29rcy5zZXQodGhpcyk7fWVsc2V7VHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKTt9CnJldHVybiB0aGlzO319O1R3ZWVuLnByb3RvdHlwZS5pbml0LnByb3RvdHlwZT1Ud2Vlbi5wcm90b3R5cGU7VHdlZW4ucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKHR3ZWVuKXt2YXIgcmVzdWx0O2lmKHR3ZWVuLmVsZW1bdHdlZW4ucHJvcF0hPW51bGwmJighdHdlZW4uZWxlbS5zdHlsZXx8dHdlZW4uZWxlbS5zdHlsZVt0d2Vlbi5wcm9wXT09bnVsbCkpe3JldHVybiB0d2Vlbi5lbGVtW3R3ZWVuLnByb3BdO30KcmVzdWx0PWpRdWVyeS5jc3ModHdlZW4uZWxlbSx0d2Vlbi5wcm9wLCIiKTtyZXR1cm4hcmVzdWx0fHxyZXN1bHQ9PT0iYXV0byI/MDpyZXN1bHQ7fSxzZXQ6ZnVuY3Rpb24odHdlZW4pe2lmKGpRdWVyeS5meC5zdGVwW3R3ZWVuLnByb3BdKXtqUXVlcnkuZnguc3RlcFt0d2Vlbi5wcm9wXSh0d2Vlbik7fWVsc2UgaWYodHdlZW4uZWxlbS5zdHlsZSYmKHR3ZWVuLmVsZW0uc3R5bGVbalF1ZXJ5LmNzc1Byb3BzW3R3ZWVuLnByb3BdXSE9bnVsbHx8alF1ZXJ5LmNzc0hvb2tzW3R3ZWVuLnByb3BdKSl7alF1ZXJ5LnN0eWxlKHR3ZWVuLmVsZW0sdHdlZW4ucHJvcCx0d2Vlbi5ub3crdHdlZW4udW5pdCk7fWVsc2V7dHdlZW4uZWxlbVt0d2Vlbi5wcm9wXT10d2Vlbi5ub3c7fX19fTtUd2Vlbi5wcm9wSG9va3Muc2Nyb2xsVG9wPVR3ZWVuLnByb3BIb29rcy5zY3JvbGxMZWZ0PXtzZXQ6ZnVuY3Rpb24odHdlZW4pe2lmKHR3ZWVuLmVsZW0ubm9kZVR5cGUmJnR3ZWVuLmVsZW0ucGFyZW50Tm9kZSl7dHdlZW4uZWxlbVt0d2Vlbi5wcm9wXT10d2Vlbi5ub3c7fX19O2pRdWVyeS5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihwKXtyZXR1cm4gcDt9LHN3aW5nOmZ1bmN0aW9uKHApe3JldHVybiAwLjUtTWF0aC5jb3MocCpNYXRoLlBJKS8yO319O2pRdWVyeS5meD1Ud2Vlbi5wcm90b3R5cGUuaW5pdDtqUXVlcnkuZnguc3RlcD17fTt2YXIKZnhOb3csdGltZXJJZCxyZnh0eXBlcz0vXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8scmZ4bnVtPW5ldyBSZWdFeHAoIl4oPzooWystXSk9fCkoIitwbnVtKyIpKFthLXolXSopJCIsImkiKSxycnVuPS9xdWV1ZUhvb2tzJC8sYW5pbWF0aW9uUHJlZmlsdGVycz1bZGVmYXVsdFByZWZpbHRlcl0sdHdlZW5lcnM9eyIqIjpbZnVuY3Rpb24ocHJvcCx2YWx1ZSl7dmFyIHR3ZWVuPXRoaXMuY3JlYXRlVHdlZW4ocHJvcCx2YWx1ZSksdGFyZ2V0PXR3ZWVuLmN1cigpLHBhcnRzPXJmeG51bS5leGVjKHZhbHVlKSx1bml0PXBhcnRzJiZwYXJ0c1szXXx8KGpRdWVyeS5jc3NOdW1iZXJbcHJvcF0/IiI6InB4Iiksc3RhcnQ9KGpRdWVyeS5jc3NOdW1iZXJbcHJvcF18fHVuaXQhPT0icHgiJiYrdGFyZ2V0KSYmcmZ4bnVtLmV4ZWMoalF1ZXJ5LmNzcyh0d2Vlbi5lbGVtLHByb3ApKSxzY2FsZT0xLG1heEl0ZXJhdGlvbnM9MjA7aWYoc3RhcnQmJnN0YXJ0WzNdIT09dW5pdCl7dW5pdD11bml0fHxzdGFydFszXTtwYXJ0cz1wYXJ0c3x8W107c3RhcnQ9K3RhcmdldHx8MTtkb3tzY2FsZT1zY2FsZXx8Ii41IjtzdGFydD1zdGFydC9zY2FsZTtqUXVlcnkuc3R5bGUodHdlZW4uZWxlbSxwcm9wLHN0YXJ0K3VuaXQpO313aGlsZShzY2FsZSE9PShzY2FsZT10d2Vlbi5jdXIoKS90YXJnZXQpJiZzY2FsZSE9PTEmJi0tbWF4SXRlcmF0aW9ucyk7fQppZihwYXJ0cyl7c3RhcnQ9dHdlZW4uc3RhcnQ9K3N0YXJ0fHwrdGFyZ2V0fHwwO3R3ZWVuLnVuaXQ9dW5pdDt0d2Vlbi5lbmQ9cGFydHNbMV0/c3RhcnQrKHBhcnRzWzFdKzEpKnBhcnRzWzJdOitwYXJ0c1syXTt9CnJldHVybiB0d2Vlbjt9XX07ZnVuY3Rpb24gY3JlYXRlRnhOb3coKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZnhOb3c9dW5kZWZpbmVkO30pO3JldHVybihmeE5vdz1qUXVlcnkubm93KCkpO30KZnVuY3Rpb24gZ2VuRngodHlwZSxpbmNsdWRlV2lkdGgpe3ZhciB3aGljaCxhdHRycz17aGVpZ2h0OnR5cGV9LGk9MDtpbmNsdWRlV2lkdGg9aW5jbHVkZVdpZHRoPzE6MDtmb3IoO2k8NDtpKz0yLWluY2x1ZGVXaWR0aCl7d2hpY2g9Y3NzRXhwYW5kW2ldO2F0dHJzWyJtYXJnaW4iK3doaWNoXT1hdHRyc1sicGFkZGluZyIrd2hpY2hdPXR5cGU7fQppZihpbmNsdWRlV2lkdGgpe2F0dHJzLm9wYWNpdHk9YXR0cnMud2lkdGg9dHlwZTt9CnJldHVybiBhdHRyczt9CmZ1bmN0aW9uIGNyZWF0ZVR3ZWVuKHZhbHVlLHByb3AsYW5pbWF0aW9uKXt2YXIgdHdlZW4sY29sbGVjdGlvbj0odHdlZW5lcnNbcHJvcF18fFtdKS5jb25jYXQodHdlZW5lcnNbIioiXSksaW5kZXg9MCxsZW5ndGg9Y29sbGVjdGlvbi5sZW5ndGg7Zm9yKDtpbmRleDxsZW5ndGg7aW5kZXgrKyl7aWYoKHR3ZWVuPWNvbGxlY3Rpb25baW5kZXhdLmNhbGwoYW5pbWF0aW9uLHByb3AsdmFsdWUpKSl7cmV0dXJuIHR3ZWVuO319fQpmdW5jdGlvbiBkZWZhdWx0UHJlZmlsdGVyKGVsZW0scHJvcHMsb3B0cyl7dmFyIHByb3AsdmFsdWUsdG9nZ2xlLHR3ZWVuLGhvb2tzLG9sZGZpcmUsZGlzcGxheSxkRGlzcGxheSxhbmltPXRoaXMsb3JpZz17fSxzdHlsZT1lbGVtLnN0eWxlLGhpZGRlbj1lbGVtLm5vZGVUeXBlJiZpc0hpZGRlbihlbGVtKSxkYXRhU2hvdz1qUXVlcnkuX2RhdGEoZWxlbSwiZnhzaG93Iik7aWYoIW9wdHMucXVldWUpe2hvb2tzPWpRdWVyeS5fcXVldWVIb29rcyhlbGVtLCJmeCIpO2lmKGhvb2tzLnVucXVldWVkPT1udWxsKXtob29rcy51bnF1ZXVlZD0wO29sZGZpcmU9aG9va3MuZW1wdHkuZmlyZTtob29rcy5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7aWYoIWhvb2tzLnVucXVldWVkKXtvbGRmaXJlKCk7fX07fQpob29rcy51bnF1ZXVlZCsrO2FuaW0uYWx3YXlzKGZ1bmN0aW9uKCl7YW5pbS5hbHdheXMoZnVuY3Rpb24oKXtob29rcy51bnF1ZXVlZC0tO2lmKCFqUXVlcnkucXVldWUoZWxlbSwiZngiKS5sZW5ndGgpe2hvb2tzLmVtcHR5LmZpcmUoKTt9fSk7fSk7fQppZihlbGVtLm5vZGVUeXBlPT09MSYmKCJoZWlnaHQiaW4gcHJvcHN8fCJ3aWR0aCJpbiBwcm9wcykpe29wdHMub3ZlcmZsb3c9W3N0eWxlLm92ZXJmbG93LHN0eWxlLm92ZXJmbG93WCxzdHlsZS5vdmVyZmxvd1ldO2Rpc3BsYXk9alF1ZXJ5LmNzcyhlbGVtLCJkaXNwbGF5Iik7ZERpc3BsYXk9ZGVmYXVsdERpc3BsYXkoZWxlbS5ub2RlTmFtZSk7aWYoZGlzcGxheT09PSJub25lIil7ZGlzcGxheT1kRGlzcGxheTt9CmlmKGRpc3BsYXk9PT0iaW5saW5lIiYmalF1ZXJ5LmNzcyhlbGVtLCJmbG9hdCIpPT09Im5vbmUiKXtpZighc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0fHxkRGlzcGxheT09PSJpbmxpbmUiKXtzdHlsZS5kaXNwbGF5PSJpbmxpbmUtYmxvY2siO31lbHNle3N0eWxlLnpvb209MTt9fX0KaWYob3B0cy5vdmVyZmxvdyl7c3R5bGUub3ZlcmZsb3c9ImhpZGRlbiI7aWYoIXN1cHBvcnQuc2hyaW5rV3JhcEJsb2NrcygpKXthbmltLmFsd2F5cyhmdW5jdGlvbigpe3N0eWxlLm92ZXJmbG93PW9wdHMub3ZlcmZsb3dbMF07c3R5bGUub3ZlcmZsb3dYPW9wdHMub3ZlcmZsb3dbMV07c3R5bGUub3ZlcmZsb3dZPW9wdHMub3ZlcmZsb3dbMl07fSk7fX0KZm9yKHByb3AgaW4gcHJvcHMpe3ZhbHVlPXByb3BzW3Byb3BdO2lmKHJmeHR5cGVzLmV4ZWModmFsdWUpKXtkZWxldGUgcHJvcHNbcHJvcF07dG9nZ2xlPXRvZ2dsZXx8dmFsdWU9PT0idG9nZ2xlIjtpZih2YWx1ZT09PShoaWRkZW4/ImhpZGUiOiJzaG93Iikpe2lmKHZhbHVlPT09InNob3ciJiZkYXRhU2hvdyYmZGF0YVNob3dbcHJvcF0hPT11bmRlZmluZWQpe2hpZGRlbj10cnVlO31lbHNle2NvbnRpbnVlO319Cm9yaWdbcHJvcF09ZGF0YVNob3cmJmRhdGFTaG93W3Byb3BdfHxqUXVlcnkuc3R5bGUoZWxlbSxwcm9wKTt9fQppZighalF1ZXJ5LmlzRW1wdHlPYmplY3Qob3JpZykpe2lmKGRhdGFTaG93KXtpZigiaGlkZGVuImluIGRhdGFTaG93KXtoaWRkZW49ZGF0YVNob3cuaGlkZGVuO319ZWxzZXtkYXRhU2hvdz1qUXVlcnkuX2RhdGEoZWxlbSwiZnhzaG93Iix7fSk7fQppZih0b2dnbGUpe2RhdGFTaG93LmhpZGRlbj0haGlkZGVuO30KaWYoaGlkZGVuKXtqUXVlcnkoZWxlbSkuc2hvdygpO31lbHNle2FuaW0uZG9uZShmdW5jdGlvbigpe2pRdWVyeShlbGVtKS5oaWRlKCk7fSk7fQphbmltLmRvbmUoZnVuY3Rpb24oKXt2YXIgcHJvcDtqUXVlcnkuX3JlbW92ZURhdGEoZWxlbSwiZnhzaG93Iik7Zm9yKHByb3AgaW4gb3JpZyl7alF1ZXJ5LnN0eWxlKGVsZW0scHJvcCxvcmlnW3Byb3BdKTt9fSk7Zm9yKHByb3AgaW4gb3JpZyl7dHdlZW49Y3JlYXRlVHdlZW4oaGlkZGVuP2RhdGFTaG93W3Byb3BdOjAscHJvcCxhbmltKTtpZighKHByb3AgaW4gZGF0YVNob3cpKXtkYXRhU2hvd1twcm9wXT10d2Vlbi5zdGFydDtpZihoaWRkZW4pe3R3ZWVuLmVuZD10d2Vlbi5zdGFydDt0d2Vlbi5zdGFydD1wcm9wPT09IndpZHRoInx8cHJvcD09PSJoZWlnaHQiPzE6MDt9fX19fQpmdW5jdGlvbiBwcm9wRmlsdGVyKHByb3BzLHNwZWNpYWxFYXNpbmcpe3ZhciBpbmRleCxuYW1lLGVhc2luZyx2YWx1ZSxob29rcztmb3IoaW5kZXggaW4gcHJvcHMpe25hbWU9alF1ZXJ5LmNhbWVsQ2FzZShpbmRleCk7ZWFzaW5nPXNwZWNpYWxFYXNpbmdbbmFtZV07dmFsdWU9cHJvcHNbaW5kZXhdO2lmKGpRdWVyeS5pc0FycmF5KHZhbHVlKSl7ZWFzaW5nPXZhbHVlWzFdO3ZhbHVlPXByb3BzW2luZGV4XT12YWx1ZVswXTt9CmlmKGluZGV4IT09bmFtZSl7cHJvcHNbbmFtZV09dmFsdWU7ZGVsZXRlIHByb3BzW2luZGV4XTt9Cmhvb2tzPWpRdWVyeS5jc3NIb29rc1tuYW1lXTtpZihob29rcyYmImV4cGFuZCJpbiBob29rcyl7dmFsdWU9aG9va3MuZXhwYW5kKHZhbHVlKTtkZWxldGUgcHJvcHNbbmFtZV07Zm9yKGluZGV4IGluIHZhbHVlKXtpZighKGluZGV4IGluIHByb3BzKSl7cHJvcHNbaW5kZXhdPXZhbHVlW2luZGV4XTtzcGVjaWFsRWFzaW5nW2luZGV4XT1lYXNpbmc7fX19ZWxzZXtzcGVjaWFsRWFzaW5nW25hbWVdPWVhc2luZzt9fX0KZnVuY3Rpb24gQW5pbWF0aW9uKGVsZW0scHJvcGVydGllcyxvcHRpb25zKXt2YXIgcmVzdWx0LHN0b3BwZWQsaW5kZXg9MCxsZW5ndGg9YW5pbWF0aW9uUHJlZmlsdGVycy5sZW5ndGgsZGVmZXJyZWQ9alF1ZXJ5LkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIHRpY2suZWxlbTt9KSx0aWNrPWZ1bmN0aW9uKCl7aWYoc3RvcHBlZCl7cmV0dXJuIGZhbHNlO30KdmFyIGN1cnJlbnRUaW1lPWZ4Tm93fHxjcmVhdGVGeE5vdygpLHJlbWFpbmluZz1NYXRoLm1heCgwLGFuaW1hdGlvbi5zdGFydFRpbWUrYW5pbWF0aW9uLmR1cmF0aW9uLWN1cnJlbnRUaW1lKSx0ZW1wPXJlbWFpbmluZy9hbmltYXRpb24uZHVyYXRpb258fDAscGVyY2VudD0xLXRlbXAsaW5kZXg9MCxsZW5ndGg9YW5pbWF0aW9uLnR3ZWVucy5sZW5ndGg7Zm9yKDtpbmRleDxsZW5ndGg7aW5kZXgrKyl7YW5pbWF0aW9uLnR3ZWVuc1tpbmRleF0ucnVuKHBlcmNlbnQpO30KZGVmZXJyZWQubm90aWZ5V2l0aChlbGVtLFthbmltYXRpb24scGVyY2VudCxyZW1haW5pbmddKTtpZihwZXJjZW50PDEmJmxlbmd0aCl7cmV0dXJuIHJlbWFpbmluZzt9ZWxzZXtkZWZlcnJlZC5yZXNvbHZlV2l0aChlbGVtLFthbmltYXRpb25dKTtyZXR1cm4gZmFsc2U7fX0sYW5pbWF0aW9uPWRlZmVycmVkLnByb21pc2Uoe2VsZW06ZWxlbSxwcm9wczpqUXVlcnkuZXh0ZW5kKHt9LHByb3BlcnRpZXMpLG9wdHM6alF1ZXJ5LmV4dGVuZCh0cnVlLHtzcGVjaWFsRWFzaW5nOnt9fSxvcHRpb25zKSxvcmlnaW5hbFByb3BlcnRpZXM6cHJvcGVydGllcyxvcmlnaW5hbE9wdGlvbnM6b3B0aW9ucyxzdGFydFRpbWU6ZnhOb3d8fGNyZWF0ZUZ4Tm93KCksZHVyYXRpb246b3B0aW9ucy5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24ocHJvcCxlbmQpe3ZhciB0d2Vlbj1qUXVlcnkuVHdlZW4oZWxlbSxhbmltYXRpb24ub3B0cyxwcm9wLGVuZCxhbmltYXRpb24ub3B0cy5zcGVjaWFsRWFzaW5nW3Byb3BdfHxhbmltYXRpb24ub3B0cy5lYXNpbmcpO2FuaW1hdGlvbi50d2VlbnMucHVzaCh0d2Vlbik7cmV0dXJuIHR3ZWVuO30sc3RvcDpmdW5jdGlvbihnb3RvRW5kKXt2YXIgaW5kZXg9MCxsZW5ndGg9Z290b0VuZD9hbmltYXRpb24udHdlZW5zLmxlbmd0aDowO2lmKHN0b3BwZWQpe3JldHVybiB0aGlzO30Kc3RvcHBlZD10cnVlO2Zvcig7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe2FuaW1hdGlvbi50d2VlbnNbaW5kZXhdLnJ1bigxKTt9CmlmKGdvdG9FbmQpe2RlZmVycmVkLnJlc29sdmVXaXRoKGVsZW0sW2FuaW1hdGlvbixnb3RvRW5kXSk7fWVsc2V7ZGVmZXJyZWQucmVqZWN0V2l0aChlbGVtLFthbmltYXRpb24sZ290b0VuZF0pO30KcmV0dXJuIHRoaXM7fX0pLHByb3BzPWFuaW1hdGlvbi5wcm9wcztwcm9wRmlsdGVyKHByb3BzLGFuaW1hdGlvbi5vcHRzLnNwZWNpYWxFYXNpbmcpO2Zvcig7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe3Jlc3VsdD1hbmltYXRpb25QcmVmaWx0ZXJzW2luZGV4XS5jYWxsKGFuaW1hdGlvbixlbGVtLHByb3BzLGFuaW1hdGlvbi5vcHRzKTtpZihyZXN1bHQpe3JldHVybiByZXN1bHQ7fX0KalF1ZXJ5Lm1hcChwcm9wcyxjcmVhdGVUd2VlbixhbmltYXRpb24pO2lmKGpRdWVyeS5pc0Z1bmN0aW9uKGFuaW1hdGlvbi5vcHRzLnN0YXJ0KSl7YW5pbWF0aW9uLm9wdHMuc3RhcnQuY2FsbChlbGVtLGFuaW1hdGlvbik7fQpqUXVlcnkuZngudGltZXIoalF1ZXJ5LmV4dGVuZCh0aWNrLHtlbGVtOmVsZW0sYW5pbTphbmltYXRpb24scXVldWU6YW5pbWF0aW9uLm9wdHMucXVldWV9KSk7cmV0dXJuIGFuaW1hdGlvbi5wcm9ncmVzcyhhbmltYXRpb24ub3B0cy5wcm9ncmVzcykuZG9uZShhbmltYXRpb24ub3B0cy5kb25lLGFuaW1hdGlvbi5vcHRzLmNvbXBsZXRlKS5mYWlsKGFuaW1hdGlvbi5vcHRzLmZhaWwpLmFsd2F5cyhhbmltYXRpb24ub3B0cy5hbHdheXMpO30KalF1ZXJ5LkFuaW1hdGlvbj1qUXVlcnkuZXh0ZW5kKEFuaW1hdGlvbix7dHdlZW5lcjpmdW5jdGlvbihwcm9wcyxjYWxsYmFjayl7aWYoalF1ZXJ5LmlzRnVuY3Rpb24ocHJvcHMpKXtjYWxsYmFjaz1wcm9wcztwcm9wcz1bIioiXTt9ZWxzZXtwcm9wcz1wcm9wcy5zcGxpdCgiICIpO30KdmFyIHByb3AsaW5kZXg9MCxsZW5ndGg9cHJvcHMubGVuZ3RoO2Zvcig7aW5kZXg8bGVuZ3RoO2luZGV4Kyspe3Byb3A9cHJvcHNbaW5kZXhdO3R3ZWVuZXJzW3Byb3BdPXR3ZWVuZXJzW3Byb3BdfHxbXTt0d2VlbmVyc1twcm9wXS51bnNoaWZ0KGNhbGxiYWNrKTt9fSxwcmVmaWx0ZXI6ZnVuY3Rpb24oY2FsbGJhY2sscHJlcGVuZCl7aWYocHJlcGVuZCl7YW5pbWF0aW9uUHJlZmlsdGVycy51bnNoaWZ0KGNhbGxiYWNrKTt9ZWxzZXthbmltYXRpb25QcmVmaWx0ZXJzLnB1c2goY2FsbGJhY2spO319fSk7alF1ZXJ5LnNwZWVkPWZ1bmN0aW9uKHNwZWVkLGVhc2luZyxmbil7dmFyIG9wdD1zcGVlZCYmdHlwZW9mIHNwZWVkPT09Im9iamVjdCI/alF1ZXJ5LmV4dGVuZCh7fSxzcGVlZCk6e2NvbXBsZXRlOmZufHwhZm4mJmVhc2luZ3x8alF1ZXJ5LmlzRnVuY3Rpb24oc3BlZWQpJiZzcGVlZCxkdXJhdGlvbjpzcGVlZCxlYXNpbmc6Zm4mJmVhc2luZ3x8ZWFzaW5nJiYhalF1ZXJ5LmlzRnVuY3Rpb24oZWFzaW5nKSYmZWFzaW5nfTtvcHQuZHVyYXRpb249alF1ZXJ5LmZ4Lm9mZj8wOnR5cGVvZiBvcHQuZHVyYXRpb249PT0ibnVtYmVyIj9vcHQuZHVyYXRpb246b3B0LmR1cmF0aW9uIGluIGpRdWVyeS5meC5zcGVlZHM/alF1ZXJ5LmZ4LnNwZWVkc1tvcHQuZHVyYXRpb25dOmpRdWVyeS5meC5zcGVlZHMuX2RlZmF1bHQ7aWYob3B0LnF1ZXVlPT1udWxsfHxvcHQucXVldWU9PT10cnVlKXtvcHQucXVldWU9ImZ4Ijt9Cm9wdC5vbGQ9b3B0LmNvbXBsZXRlO29wdC5jb21wbGV0ZT1mdW5jdGlvbigpe2lmKGpRdWVyeS5pc0Z1bmN0aW9uKG9wdC5vbGQpKXtvcHQub2xkLmNhbGwodGhpcyk7fQppZihvcHQucXVldWUpe2pRdWVyeS5kZXF1ZXVlKHRoaXMsb3B0LnF1ZXVlKTt9fTtyZXR1cm4gb3B0O307alF1ZXJ5LmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKHNwZWVkLHRvLGVhc2luZyxjYWxsYmFjayl7cmV0dXJuIHRoaXMuZmlsdGVyKGlzSGlkZGVuKS5jc3MoIm9wYWNpdHkiLDApLnNob3coKS5lbmQoKS5hbmltYXRlKHtvcGFjaXR5OnRvfSxzcGVlZCxlYXNpbmcsY2FsbGJhY2spO30sYW5pbWF0ZTpmdW5jdGlvbihwcm9wLHNwZWVkLGVhc2luZyxjYWxsYmFjayl7dmFyIGVtcHR5PWpRdWVyeS5pc0VtcHR5T2JqZWN0KHByb3ApLG9wdGFsbD1qUXVlcnkuc3BlZWQoc3BlZWQsZWFzaW5nLGNhbGxiYWNrKSxkb0FuaW1hdGlvbj1mdW5jdGlvbigpe3ZhciBhbmltPUFuaW1hdGlvbih0aGlzLGpRdWVyeS5leHRlbmQoe30scHJvcCksb3B0YWxsKTtpZihlbXB0eXx8alF1ZXJ5Ll9kYXRhKHRoaXMsImZpbmlzaCIpKXthbmltLnN0b3AodHJ1ZSk7fX07ZG9BbmltYXRpb24uZmluaXNoPWRvQW5pbWF0aW9uO3JldHVybiBlbXB0eXx8b3B0YWxsLnF1ZXVlPT09ZmFsc2U/dGhpcy5lYWNoKGRvQW5pbWF0aW9uKTp0aGlzLnF1ZXVlKG9wdGFsbC5xdWV1ZSxkb0FuaW1hdGlvbik7fSxzdG9wOmZ1bmN0aW9uKHR5cGUsY2xlYXJRdWV1ZSxnb3RvRW5kKXt2YXIgc3RvcFF1ZXVlPWZ1bmN0aW9uKGhvb2tzKXt2YXIgc3RvcD1ob29rcy5zdG9wO2RlbGV0ZSBob29rcy5zdG9wO3N0b3AoZ290b0VuZCk7fTtpZih0eXBlb2YgdHlwZSE9PSJzdHJpbmciKXtnb3RvRW5kPWNsZWFyUXVldWU7Y2xlYXJRdWV1ZT10eXBlO3R5cGU9dW5kZWZpbmVkO30KaWYoY2xlYXJRdWV1ZSYmdHlwZSE9PWZhbHNlKXt0aGlzLnF1ZXVlKHR5cGV8fCJmeCIsW10pO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBkZXF1ZXVlPXRydWUsaW5kZXg9dHlwZSE9bnVsbCYmdHlwZSsicXVldWVIb29rcyIsdGltZXJzPWpRdWVyeS50aW1lcnMsZGF0YT1qUXVlcnkuX2RhdGEodGhpcyk7aWYoaW5kZXgpe2lmKGRhdGFbaW5kZXhdJiZkYXRhW2luZGV4XS5zdG9wKXtzdG9wUXVldWUoZGF0YVtpbmRleF0pO319ZWxzZXtmb3IoaW5kZXggaW4gZGF0YSl7aWYoZGF0YVtpbmRleF0mJmRhdGFbaW5kZXhdLnN0b3AmJnJydW4udGVzdChpbmRleCkpe3N0b3BRdWV1ZShkYXRhW2luZGV4XSk7fX19CmZvcihpbmRleD10aW1lcnMubGVuZ3RoO2luZGV4LS07KXtpZih0aW1lcnNbaW5kZXhdLmVsZW09PT10aGlzJiYodHlwZT09bnVsbHx8dGltZXJzW2luZGV4XS5xdWV1ZT09PXR5cGUpKXt0aW1lcnNbaW5kZXhdLmFuaW0uc3RvcChnb3RvRW5kKTtkZXF1ZXVlPWZhbHNlO3RpbWVycy5zcGxpY2UoaW5kZXgsMSk7fX0KaWYoZGVxdWV1ZXx8IWdvdG9FbmQpe2pRdWVyeS5kZXF1ZXVlKHRoaXMsdHlwZSk7fX0pO30sZmluaXNoOmZ1bmN0aW9uKHR5cGUpe2lmKHR5cGUhPT1mYWxzZSl7dHlwZT10eXBlfHwiZngiO30KcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBpbmRleCxkYXRhPWpRdWVyeS5fZGF0YSh0aGlzKSxxdWV1ZT1kYXRhW3R5cGUrInF1ZXVlIl0saG9va3M9ZGF0YVt0eXBlKyJxdWV1ZUhvb2tzIl0sdGltZXJzPWpRdWVyeS50aW1lcnMsbGVuZ3RoPXF1ZXVlP3F1ZXVlLmxlbmd0aDowO2RhdGEuZmluaXNoPXRydWU7alF1ZXJ5LnF1ZXVlKHRoaXMsdHlwZSxbXSk7aWYoaG9va3MmJmhvb2tzLnN0b3Ape2hvb2tzLnN0b3AuY2FsbCh0aGlzLHRydWUpO30KZm9yKGluZGV4PXRpbWVycy5sZW5ndGg7aW5kZXgtLTspe2lmKHRpbWVyc1tpbmRleF0uZWxlbT09PXRoaXMmJnRpbWVyc1tpbmRleF0ucXVldWU9PT10eXBlKXt0aW1lcnNbaW5kZXhdLmFuaW0uc3RvcCh0cnVlKTt0aW1lcnMuc3BsaWNlKGluZGV4LDEpO319CmZvcihpbmRleD0wO2luZGV4PGxlbmd0aDtpbmRleCsrKXtpZihxdWV1ZVtpbmRleF0mJnF1ZXVlW2luZGV4XS5maW5pc2gpe3F1ZXVlW2luZGV4XS5maW5pc2guY2FsbCh0aGlzKTt9fQpkZWxldGUgZGF0YS5maW5pc2g7fSk7fX0pO2pRdWVyeS5lYWNoKFsidG9nZ2xlIiwic2hvdyIsImhpZGUiXSxmdW5jdGlvbihpLG5hbWUpe3ZhciBjc3NGbj1qUXVlcnkuZm5bbmFtZV07alF1ZXJ5LmZuW25hbWVdPWZ1bmN0aW9uKHNwZWVkLGVhc2luZyxjYWxsYmFjayl7cmV0dXJuIHNwZWVkPT1udWxsfHx0eXBlb2Ygc3BlZWQ9PT0iYm9vbGVhbiI/Y3NzRm4uYXBwbHkodGhpcyxhcmd1bWVudHMpOnRoaXMuYW5pbWF0ZShnZW5GeChuYW1lLHRydWUpLHNwZWVkLGVhc2luZyxjYWxsYmFjayk7fTt9KTtqUXVlcnkuZWFjaCh7c2xpZGVEb3duOmdlbkZ4KCJzaG93Iiksc2xpZGVVcDpnZW5GeCgiaGlkZSIpLHNsaWRlVG9nZ2xlOmdlbkZ4KCJ0b2dnbGUiKSxmYWRlSW46e29wYWNpdHk6InNob3cifSxmYWRlT3V0OntvcGFjaXR5OiJoaWRlIn0sZmFkZVRvZ2dsZTp7b3BhY2l0eToidG9nZ2xlIn19LGZ1bmN0aW9uKG5hbWUscHJvcHMpe2pRdWVyeS5mbltuYW1lXT1mdW5jdGlvbihzcGVlZCxlYXNpbmcsY2FsbGJhY2spe3JldHVybiB0aGlzLmFuaW1hdGUocHJvcHMsc3BlZWQsZWFzaW5nLGNhbGxiYWNrKTt9O30pO2pRdWVyeS50aW1lcnM9W107alF1ZXJ5LmZ4LnRpY2s9ZnVuY3Rpb24oKXt2YXIgdGltZXIsdGltZXJzPWpRdWVyeS50aW1lcnMsaT0wO2Z4Tm93PWpRdWVyeS5ub3coKTtmb3IoO2k8dGltZXJzLmxlbmd0aDtpKyspe3RpbWVyPXRpbWVyc1tpXTtpZighdGltZXIoKSYmdGltZXJzW2ldPT09dGltZXIpe3RpbWVycy5zcGxpY2UoaS0tLDEpO319CmlmKCF0aW1lcnMubGVuZ3RoKXtqUXVlcnkuZnguc3RvcCgpO30KZnhOb3c9dW5kZWZpbmVkO307alF1ZXJ5LmZ4LnRpbWVyPWZ1bmN0aW9uKHRpbWVyKXtqUXVlcnkudGltZXJzLnB1c2godGltZXIpO2lmKHRpbWVyKCkpe2pRdWVyeS5meC5zdGFydCgpO31lbHNle2pRdWVyeS50aW1lcnMucG9wKCk7fX07alF1ZXJ5LmZ4LmludGVydmFsPTEzO2pRdWVyeS5meC5zdGFydD1mdW5jdGlvbigpe2lmKCF0aW1lcklkKXt0aW1lcklkPXNldEludGVydmFsKGpRdWVyeS5meC50aWNrLGpRdWVyeS5meC5pbnRlcnZhbCk7fX07alF1ZXJ5LmZ4LnN0b3A9ZnVuY3Rpb24oKXtjbGVhckludGVydmFsKHRpbWVySWQpO3RpbWVySWQ9bnVsbDt9O2pRdWVyeS5meC5zcGVlZHM9e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH07alF1ZXJ5LmZuLmRlbGF5PWZ1bmN0aW9uKHRpbWUsdHlwZSl7dGltZT1qUXVlcnkuZng/alF1ZXJ5LmZ4LnNwZWVkc1t0aW1lXXx8dGltZTp0aW1lO3R5cGU9dHlwZXx8ImZ4IjtyZXR1cm4gdGhpcy5xdWV1ZSh0eXBlLGZ1bmN0aW9uKG5leHQsaG9va3Mpe3ZhciB0aW1lb3V0PXNldFRpbWVvdXQobmV4dCx0aW1lKTtob29rcy5zdG9wPWZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO307fSk7fTsoZnVuY3Rpb24oKXt2YXIgYSxpbnB1dCxzZWxlY3Qsb3B0LGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtkaXYuc2V0QXR0cmlidXRlKCJjbGFzc05hbWUiLCJ0Iik7ZGl2LmlubmVySFRNTD0iICA8bGluay8+PHRhYmxlPjwvdGFibGU+PGEgaHJlZj0nL2EnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+IjthPWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpWzBdO3NlbGVjdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKTtvcHQ9c2VsZWN0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpKTtpbnB1dD1kaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IilbMF07YS5zdHlsZS5jc3NUZXh0PSJ0b3A6MXB4IjtzdXBwb3J0LmdldFNldEF0dHJpYnV0ZT1kaXYuY2xhc3NOYW1lIT09InQiO3N1cHBvcnQuc3R5bGU9L3RvcC8udGVzdChhLmdldEF0dHJpYnV0ZSgic3R5bGUiKSk7c3VwcG9ydC5ocmVmTm9ybWFsaXplZD1hLmdldEF0dHJpYnV0ZSgiaHJlZiIpPT09Ii9hIjtzdXBwb3J0LmNoZWNrT249ISFpbnB1dC52YWx1ZTtzdXBwb3J0Lm9wdFNlbGVjdGVkPW9wdC5zZWxlY3RlZDtzdXBwb3J0LmVuY3R5cGU9ISFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJmb3JtIikuZW5jdHlwZTtzZWxlY3QuZGlzYWJsZWQ9dHJ1ZTtzdXBwb3J0Lm9wdERpc2FibGVkPSFvcHQuZGlzYWJsZWQ7aW5wdXQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTtpbnB1dC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwiIik7c3VwcG9ydC5pbnB1dD1pbnB1dC5nZXRBdHRyaWJ1dGUoInZhbHVlIik9PT0iIjtpbnB1dC52YWx1ZT0idCI7aW5wdXQuc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKTtzdXBwb3J0LnJhZGlvVmFsdWU9aW5wdXQudmFsdWU9PT0idCI7YT1pbnB1dD1zZWxlY3Q9b3B0PWRpdj1udWxsO30pKCk7dmFyIHJyZXR1cm49L1xyL2c7alF1ZXJ5LmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKHZhbHVlKXt2YXIgaG9va3MscmV0LGlzRnVuY3Rpb24sZWxlbT10aGlzWzBdO2lmKCFhcmd1bWVudHMubGVuZ3RoKXtpZihlbGVtKXtob29rcz1qUXVlcnkudmFsSG9va3NbZWxlbS50eXBlXXx8alF1ZXJ5LnZhbEhvb2tzW2VsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKV07aWYoaG9va3MmJiJnZXQiaW4gaG9va3MmJihyZXQ9aG9va3MuZ2V0KGVsZW0sInZhbHVlIikpIT09dW5kZWZpbmVkKXtyZXR1cm4gcmV0O30KcmV0PWVsZW0udmFsdWU7cmV0dXJuIHR5cGVvZiByZXQ9PT0ic3RyaW5nIj9yZXQucmVwbGFjZShycmV0dXJuLCIiKTpyZXQ9PW51bGw/IiI6cmV0O30KcmV0dXJuO30KaXNGdW5jdGlvbj1qUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKXt2YXIgdmFsO2lmKHRoaXMubm9kZVR5cGUhPT0xKXtyZXR1cm47fQppZihpc0Z1bmN0aW9uKXt2YWw9dmFsdWUuY2FsbCh0aGlzLGksalF1ZXJ5KHRoaXMpLnZhbCgpKTt9ZWxzZXt2YWw9dmFsdWU7fQppZih2YWw9PW51bGwpe3ZhbD0iIjt9ZWxzZSBpZih0eXBlb2YgdmFsPT09Im51bWJlciIpe3ZhbCs9IiI7fWVsc2UgaWYoalF1ZXJ5LmlzQXJyYXkodmFsKSl7dmFsPWpRdWVyeS5tYXAodmFsLGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdmFsdWU9PW51bGw/IiI6dmFsdWUrIiI7fSk7fQpob29rcz1qUXVlcnkudmFsSG9va3NbdGhpcy50eXBlXXx8alF1ZXJ5LnZhbEhvb2tzW3RoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKV07aWYoIWhvb2tzfHwhKCJzZXQiaW4gaG9va3MpfHxob29rcy5zZXQodGhpcyx2YWwsInZhbHVlIik9PT11bmRlZmluZWQpe3RoaXMudmFsdWU9dmFsO319KTt9fSk7alF1ZXJ5LmV4dGVuZCh7dmFsSG9va3M6e29wdGlvbjp7Z2V0OmZ1bmN0aW9uKGVsZW0pe3ZhciB2YWw9alF1ZXJ5LmZpbmQuYXR0cihlbGVtLCJ2YWx1ZSIpO3JldHVybiB2YWwhPW51bGw/dmFsOmpRdWVyeS50ZXh0KGVsZW0pO319LHNlbGVjdDp7Z2V0OmZ1bmN0aW9uKGVsZW0pe3ZhciB2YWx1ZSxvcHRpb24sb3B0aW9ucz1lbGVtLm9wdGlvbnMsaW5kZXg9ZWxlbS5zZWxlY3RlZEluZGV4LG9uZT1lbGVtLnR5cGU9PT0ic2VsZWN0LW9uZSJ8fGluZGV4PDAsdmFsdWVzPW9uZT9udWxsOltdLG1heD1vbmU/aW5kZXgrMTpvcHRpb25zLmxlbmd0aCxpPWluZGV4PDA/bWF4Om9uZT9pbmRleDowO2Zvcig7aTxtYXg7aSsrKXtvcHRpb249b3B0aW9uc1tpXTtpZigob3B0aW9uLnNlbGVjdGVkfHxpPT09aW5kZXgpJiYoc3VwcG9ydC5vcHREaXNhYmxlZD8hb3B0aW9uLmRpc2FibGVkOm9wdGlvbi5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIik9PT1udWxsKSYmKCFvcHRpb24ucGFyZW50Tm9kZS5kaXNhYmxlZHx8IWpRdWVyeS5ub2RlTmFtZShvcHRpb24ucGFyZW50Tm9kZSwib3B0Z3JvdXAiKSkpe3ZhbHVlPWpRdWVyeShvcHRpb24pLnZhbCgpO2lmKG9uZSl7cmV0dXJuIHZhbHVlO30KdmFsdWVzLnB1c2godmFsdWUpO319CnJldHVybiB2YWx1ZXM7fSxzZXQ6ZnVuY3Rpb24oZWxlbSx2YWx1ZSl7dmFyIG9wdGlvblNldCxvcHRpb24sb3B0aW9ucz1lbGVtLm9wdGlvbnMsdmFsdWVzPWpRdWVyeS5tYWtlQXJyYXkodmFsdWUpLGk9b3B0aW9ucy5sZW5ndGg7d2hpbGUoaS0tKXtvcHRpb249b3B0aW9uc1tpXTtpZihqUXVlcnkuaW5BcnJheShqUXVlcnkudmFsSG9va3Mub3B0aW9uLmdldChvcHRpb24pLHZhbHVlcyk+PTApe3RyeXtvcHRpb24uc2VsZWN0ZWQ9b3B0aW9uU2V0PXRydWU7fWNhdGNoKF8pe29wdGlvbi5zY3JvbGxIZWlnaHQ7fX1lbHNle29wdGlvbi5zZWxlY3RlZD1mYWxzZTt9fQppZighb3B0aW9uU2V0KXtlbGVtLnNlbGVjdGVkSW5kZXg9LTE7fQpyZXR1cm4gb3B0aW9uczt9fX19KTtqUXVlcnkuZWFjaChbInJhZGlvIiwiY2hlY2tib3giXSxmdW5jdGlvbigpe2pRdWVyeS52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGVsZW0sdmFsdWUpe2lmKGpRdWVyeS5pc0FycmF5KHZhbHVlKSl7cmV0dXJuKGVsZW0uY2hlY2tlZD1qUXVlcnkuaW5BcnJheShqUXVlcnkoZWxlbSkudmFsKCksdmFsdWUpPj0wKTt9fX07aWYoIXN1cHBvcnQuY2hlY2tPbil7alF1ZXJ5LnZhbEhvb2tzW3RoaXNdLmdldD1mdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoInZhbHVlIik9PT1udWxsPyJvbiI6ZWxlbS52YWx1ZTt9O319KTt2YXIgbm9kZUhvb2ssYm9vbEhvb2ssYXR0ckhhbmRsZT1qUXVlcnkuZXhwci5hdHRySGFuZGxlLHJ1c2VEZWZhdWx0PS9eKD86Y2hlY2tlZHxzZWxlY3RlZCkkL2ksZ2V0U2V0QXR0cmlidXRlPXN1cHBvcnQuZ2V0U2V0QXR0cmlidXRlLGdldFNldElucHV0PXN1cHBvcnQuaW5wdXQ7alF1ZXJ5LmZuLmV4dGVuZCh7YXR0cjpmdW5jdGlvbihuYW1lLHZhbHVlKXtyZXR1cm4gYWNjZXNzKHRoaXMsalF1ZXJ5LmF0dHIsbmFtZSx2YWx1ZSxhcmd1bWVudHMubGVuZ3RoPjEpO30scmVtb3ZlQXR0cjpmdW5jdGlvbihuYW1lKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7alF1ZXJ5LnJlbW92ZUF0dHIodGhpcyxuYW1lKTt9KTt9fSk7alF1ZXJ5LmV4dGVuZCh7YXR0cjpmdW5jdGlvbihlbGVtLG5hbWUsdmFsdWUpe3ZhciBob29rcyxyZXQsblR5cGU9ZWxlbS5ub2RlVHlwZTtpZighZWxlbXx8blR5cGU9PT0zfHxuVHlwZT09PTh8fG5UeXBlPT09Mil7cmV0dXJuO30KaWYodHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlPT09c3RydW5kZWZpbmVkKXtyZXR1cm4galF1ZXJ5LnByb3AoZWxlbSxuYW1lLHZhbHVlKTt9CmlmKG5UeXBlIT09MXx8IWpRdWVyeS5pc1hNTERvYyhlbGVtKSl7bmFtZT1uYW1lLnRvTG93ZXJDYXNlKCk7aG9va3M9alF1ZXJ5LmF0dHJIb29rc1tuYW1lXXx8KGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdChuYW1lKT9ib29sSG9vazpub2RlSG9vayk7fQppZih2YWx1ZSE9PXVuZGVmaW5lZCl7aWYodmFsdWU9PT1udWxsKXtqUXVlcnkucmVtb3ZlQXR0cihlbGVtLG5hbWUpO31lbHNlIGlmKGhvb2tzJiYic2V0ImluIGhvb2tzJiYocmV0PWhvb2tzLnNldChlbGVtLHZhbHVlLG5hbWUpKSE9PXVuZGVmaW5lZCl7cmV0dXJuIHJldDt9ZWxzZXtlbGVtLnNldEF0dHJpYnV0ZShuYW1lLHZhbHVlKyIiKTtyZXR1cm4gdmFsdWU7fX1lbHNlIGlmKGhvb2tzJiYiZ2V0ImluIGhvb2tzJiYocmV0PWhvb2tzLmdldChlbGVtLG5hbWUpKSE9PW51bGwpe3JldHVybiByZXQ7fWVsc2V7cmV0PWpRdWVyeS5maW5kLmF0dHIoZWxlbSxuYW1lKTtyZXR1cm4gcmV0PT1udWxsP3VuZGVmaW5lZDpyZXQ7fX0scmVtb3ZlQXR0cjpmdW5jdGlvbihlbGVtLHZhbHVlKXt2YXIgbmFtZSxwcm9wTmFtZSxpPTAsYXR0ck5hbWVzPXZhbHVlJiZ2YWx1ZS5tYXRjaChybm90d2hpdGUpO2lmKGF0dHJOYW1lcyYmZWxlbS5ub2RlVHlwZT09PTEpe3doaWxlKChuYW1lPWF0dHJOYW1lc1tpKytdKSl7cHJvcE5hbWU9alF1ZXJ5LnByb3BGaXhbbmFtZV18fG5hbWU7aWYoalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KG5hbWUpKXtpZihnZXRTZXRJbnB1dCYmZ2V0U2V0QXR0cmlidXRlfHwhcnVzZURlZmF1bHQudGVzdChuYW1lKSl7ZWxlbVtwcm9wTmFtZV09ZmFsc2U7fWVsc2V7ZWxlbVtqUXVlcnkuY2FtZWxDYXNlKCJkZWZhdWx0LSIrbmFtZSldPWVsZW1bcHJvcE5hbWVdPWZhbHNlO319ZWxzZXtqUXVlcnkuYXR0cihlbGVtLG5hbWUsIiIpO30KZWxlbS5yZW1vdmVBdHRyaWJ1dGUoZ2V0U2V0QXR0cmlidXRlP25hbWU6cHJvcE5hbWUpO319fSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihlbGVtLHZhbHVlKXtpZighc3VwcG9ydC5yYWRpb1ZhbHVlJiZ2YWx1ZT09PSJyYWRpbyImJmpRdWVyeS5ub2RlTmFtZShlbGVtLCJpbnB1dCIpKXt2YXIgdmFsPWVsZW0udmFsdWU7ZWxlbS5zZXRBdHRyaWJ1dGUoInR5cGUiLHZhbHVlKTtpZih2YWwpe2VsZW0udmFsdWU9dmFsO30KcmV0dXJuIHZhbHVlO319fX19KTtib29sSG9vaz17c2V0OmZ1bmN0aW9uKGVsZW0sdmFsdWUsbmFtZSl7aWYodmFsdWU9PT1mYWxzZSl7alF1ZXJ5LnJlbW92ZUF0dHIoZWxlbSxuYW1lKTt9ZWxzZSBpZihnZXRTZXRJbnB1dCYmZ2V0U2V0QXR0cmlidXRlfHwhcnVzZURlZmF1bHQudGVzdChuYW1lKSl7ZWxlbS5zZXRBdHRyaWJ1dGUoIWdldFNldEF0dHJpYnV0ZSYmalF1ZXJ5LnByb3BGaXhbbmFtZV18fG5hbWUsbmFtZSk7fWVsc2V7ZWxlbVtqUXVlcnkuY2FtZWxDYXNlKCJkZWZhdWx0LSIrbmFtZSldPWVsZW1bbmFtZV09dHJ1ZTt9CnJldHVybiBuYW1lO319O2pRdWVyeS5lYWNoKGpRdWVyeS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksZnVuY3Rpb24oaSxuYW1lKXt2YXIgZ2V0dGVyPWF0dHJIYW5kbGVbbmFtZV18fGpRdWVyeS5maW5kLmF0dHI7YXR0ckhhbmRsZVtuYW1lXT1nZXRTZXRJbnB1dCYmZ2V0U2V0QXR0cmlidXRlfHwhcnVzZURlZmF1bHQudGVzdChuYW1lKT9mdW5jdGlvbihlbGVtLG5hbWUsaXNYTUwpe3ZhciByZXQsaGFuZGxlO2lmKCFpc1hNTCl7aGFuZGxlPWF0dHJIYW5kbGVbbmFtZV07YXR0ckhhbmRsZVtuYW1lXT1yZXQ7cmV0PWdldHRlcihlbGVtLG5hbWUsaXNYTUwpIT1udWxsP25hbWUudG9Mb3dlckNhc2UoKTpudWxsO2F0dHJIYW5kbGVbbmFtZV09aGFuZGxlO30KcmV0dXJuIHJldDt9OmZ1bmN0aW9uKGVsZW0sbmFtZSxpc1hNTCl7aWYoIWlzWE1MKXtyZXR1cm4gZWxlbVtqUXVlcnkuY2FtZWxDYXNlKCJkZWZhdWx0LSIrbmFtZSldP25hbWUudG9Mb3dlckNhc2UoKTpudWxsO319O30pO2lmKCFnZXRTZXRJbnB1dHx8IWdldFNldEF0dHJpYnV0ZSl7alF1ZXJ5LmF0dHJIb29rcy52YWx1ZT17c2V0OmZ1bmN0aW9uKGVsZW0sdmFsdWUsbmFtZSl7aWYoalF1ZXJ5Lm5vZGVOYW1lKGVsZW0sImlucHV0Iikpe2VsZW0uZGVmYXVsdFZhbHVlPXZhbHVlO31lbHNle3JldHVybiBub2RlSG9vayYmbm9kZUhvb2suc2V0KGVsZW0sdmFsdWUsbmFtZSk7fX19O30KaWYoIWdldFNldEF0dHJpYnV0ZSl7bm9kZUhvb2s9e3NldDpmdW5jdGlvbihlbGVtLHZhbHVlLG5hbWUpe3ZhciByZXQ9ZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKG5hbWUpO2lmKCFyZXQpe2VsZW0uc2V0QXR0cmlidXRlTm9kZSgocmV0PWVsZW0ub3duZXJEb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUobmFtZSkpKTt9CnJldC52YWx1ZT12YWx1ZSs9IiI7aWYobmFtZT09PSJ2YWx1ZSJ8fHZhbHVlPT09ZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSkpe3JldHVybiB2YWx1ZTt9fX07YXR0ckhhbmRsZS5pZD1hdHRySGFuZGxlLm5hbWU9YXR0ckhhbmRsZS5jb29yZHM9ZnVuY3Rpb24oZWxlbSxuYW1lLGlzWE1MKXt2YXIgcmV0O2lmKCFpc1hNTCl7cmV0dXJuKHJldD1lbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpJiZyZXQudmFsdWUhPT0iIj9yZXQudmFsdWU6bnVsbDt9fTtqUXVlcnkudmFsSG9va3MuYnV0dG9uPXtnZXQ6ZnVuY3Rpb24oZWxlbSxuYW1lKXt2YXIgcmV0PWVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKTtpZihyZXQmJnJldC5zcGVjaWZpZWQpe3JldHVybiByZXQudmFsdWU7fX0sc2V0Om5vZGVIb29rLnNldH07alF1ZXJ5LmF0dHJIb29rcy5jb250ZW50ZWRpdGFibGU9e3NldDpmdW5jdGlvbihlbGVtLHZhbHVlLG5hbWUpe25vZGVIb29rLnNldChlbGVtLHZhbHVlPT09IiI/ZmFsc2U6dmFsdWUsbmFtZSk7fX07alF1ZXJ5LmVhY2goWyJ3aWR0aCIsImhlaWdodCJdLGZ1bmN0aW9uKGksbmFtZSl7alF1ZXJ5LmF0dHJIb29rc1tuYW1lXT17c2V0OmZ1bmN0aW9uKGVsZW0sdmFsdWUpe2lmKHZhbHVlPT09IiIpe2VsZW0uc2V0QXR0cmlidXRlKG5hbWUsImF1dG8iKTtyZXR1cm4gdmFsdWU7fX19O30pO30KaWYoIXN1cHBvcnQuc3R5bGUpe2pRdWVyeS5hdHRySG9va3Muc3R5bGU9e2dldDpmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5zdHlsZS5jc3NUZXh0fHx1bmRlZmluZWQ7fSxzZXQ6ZnVuY3Rpb24oZWxlbSx2YWx1ZSl7cmV0dXJuKGVsZW0uc3R5bGUuY3NzVGV4dD12YWx1ZSsiIik7fX07fQp2YXIgcmZvY3VzYWJsZT0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvaSxyY2xpY2thYmxlPS9eKD86YXxhcmVhKSQvaTtqUXVlcnkuZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKG5hbWUsdmFsdWUpe3JldHVybiBhY2Nlc3ModGhpcyxqUXVlcnkucHJvcCxuYW1lLHZhbHVlLGFyZ3VtZW50cy5sZW5ndGg+MSk7fSxyZW1vdmVQcm9wOmZ1bmN0aW9uKG5hbWUpe25hbWU9alF1ZXJ5LnByb3BGaXhbbmFtZV18fG5hbWU7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3RyeXt0aGlzW25hbWVdPXVuZGVmaW5lZDtkZWxldGUgdGhpc1tuYW1lXTt9Y2F0Y2goZSl7fX0pO319KTtqUXVlcnkuZXh0ZW5kKHtwcm9wRml4OnsiZm9yIjoiaHRtbEZvciIsImNsYXNzIjoiY2xhc3NOYW1lIn0scHJvcDpmdW5jdGlvbihlbGVtLG5hbWUsdmFsdWUpe3ZhciByZXQsaG9va3Msbm90eG1sLG5UeXBlPWVsZW0ubm9kZVR5cGU7aWYoIWVsZW18fG5UeXBlPT09M3x8blR5cGU9PT04fHxuVHlwZT09PTIpe3JldHVybjt9Cm5vdHhtbD1uVHlwZSE9PTF8fCFqUXVlcnkuaXNYTUxEb2MoZWxlbSk7aWYobm90eG1sKXtuYW1lPWpRdWVyeS5wcm9wRml4W25hbWVdfHxuYW1lO2hvb2tzPWpRdWVyeS5wcm9wSG9va3NbbmFtZV07fQppZih2YWx1ZSE9PXVuZGVmaW5lZCl7cmV0dXJuIGhvb2tzJiYic2V0ImluIGhvb2tzJiYocmV0PWhvb2tzLnNldChlbGVtLHZhbHVlLG5hbWUpKSE9PXVuZGVmaW5lZD9yZXQ6KGVsZW1bbmFtZV09dmFsdWUpO31lbHNle3JldHVybiBob29rcyYmImdldCJpbiBob29rcyYmKHJldD1ob29rcy5nZXQoZWxlbSxuYW1lKSkhPT1udWxsP3JldDplbGVtW25hbWVdO319LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihlbGVtKXt2YXIgdGFiaW5kZXg9alF1ZXJ5LmZpbmQuYXR0cihlbGVtLCJ0YWJpbmRleCIpO3JldHVybiB0YWJpbmRleD9wYXJzZUludCh0YWJpbmRleCwxMCk6cmZvY3VzYWJsZS50ZXN0KGVsZW0ubm9kZU5hbWUpfHxyY2xpY2thYmxlLnRlc3QoZWxlbS5ub2RlTmFtZSkmJmVsZW0uaHJlZj8wOi0xO319fX0pO2lmKCFzdXBwb3J0LmhyZWZOb3JtYWxpemVkKXtqUXVlcnkuZWFjaChbImhyZWYiLCJzcmMiXSxmdW5jdGlvbihpLG5hbWUpe2pRdWVyeS5wcm9wSG9va3NbbmFtZV09e2dldDpmdW5jdGlvbihlbGVtKXtyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSw0KTt9fTt9KTt9CmlmKCFzdXBwb3J0Lm9wdFNlbGVjdGVkKXtqUXVlcnkucHJvcEhvb2tzLnNlbGVjdGVkPXtnZXQ6ZnVuY3Rpb24oZWxlbSl7dmFyIHBhcmVudD1lbGVtLnBhcmVudE5vZGU7aWYocGFyZW50KXtwYXJlbnQuc2VsZWN0ZWRJbmRleDtpZihwYXJlbnQucGFyZW50Tm9kZSl7cGFyZW50LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDt9fQpyZXR1cm4gbnVsbDt9fTt9CmpRdWVyeS5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXtqUXVlcnkucHJvcEZpeFt0aGlzLnRvTG93ZXJDYXNlKCldPXRoaXM7fSk7aWYoIXN1cHBvcnQuZW5jdHlwZSl7alF1ZXJ5LnByb3BGaXguZW5jdHlwZT0iZW5jb2RpbmciO30KdmFyIHJjbGFzcz0vW1x0XHJcblxmXS9nO2pRdWVyeS5mbi5leHRlbmQoe2FkZENsYXNzOmZ1bmN0aW9uKHZhbHVlKXt2YXIgY2xhc3NlcyxlbGVtLGN1cixjbGF6eixqLGZpbmFsVmFsdWUsaT0wLGxlbj10aGlzLmxlbmd0aCxwcm9jZWVkPXR5cGVvZiB2YWx1ZT09PSJzdHJpbmciJiZ2YWx1ZTtpZihqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oail7alF1ZXJ5KHRoaXMpLmFkZENsYXNzKHZhbHVlLmNhbGwodGhpcyxqLHRoaXMuY2xhc3NOYW1lKSk7fSk7fQppZihwcm9jZWVkKXtjbGFzc2VzPSh2YWx1ZXx8IiIpLm1hdGNoKHJub3R3aGl0ZSl8fFtdO2Zvcig7aTxsZW47aSsrKXtlbGVtPXRoaXNbaV07Y3VyPWVsZW0ubm9kZVR5cGU9PT0xJiYoZWxlbS5jbGFzc05hbWU/KCIgIitlbGVtLmNsYXNzTmFtZSsiICIpLnJlcGxhY2UocmNsYXNzLCIgIik6IiAiKTtpZihjdXIpe2o9MDt3aGlsZSgoY2xheno9Y2xhc3Nlc1tqKytdKSl7aWYoY3VyLmluZGV4T2YoIiAiK2NsYXp6KyIgIik8MCl7Y3VyKz1jbGF6eisiICI7fX0KZmluYWxWYWx1ZT1qUXVlcnkudHJpbShjdXIpO2lmKGVsZW0uY2xhc3NOYW1lIT09ZmluYWxWYWx1ZSl7ZWxlbS5jbGFzc05hbWU9ZmluYWxWYWx1ZTt9fX19CnJldHVybiB0aGlzO30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24odmFsdWUpe3ZhciBjbGFzc2VzLGVsZW0sY3VyLGNsYXp6LGosZmluYWxWYWx1ZSxpPTAsbGVuPXRoaXMubGVuZ3RoLHByb2NlZWQ9YXJndW1lbnRzLmxlbmd0aD09PTB8fHR5cGVvZiB2YWx1ZT09PSJzdHJpbmciJiZ2YWx1ZTtpZihqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oail7alF1ZXJ5KHRoaXMpLnJlbW92ZUNsYXNzKHZhbHVlLmNhbGwodGhpcyxqLHRoaXMuY2xhc3NOYW1lKSk7fSk7fQppZihwcm9jZWVkKXtjbGFzc2VzPSh2YWx1ZXx8IiIpLm1hdGNoKHJub3R3aGl0ZSl8fFtdO2Zvcig7aTxsZW47aSsrKXtlbGVtPXRoaXNbaV07Y3VyPWVsZW0ubm9kZVR5cGU9PT0xJiYoZWxlbS5jbGFzc05hbWU/KCIgIitlbGVtLmNsYXNzTmFtZSsiICIpLnJlcGxhY2UocmNsYXNzLCIgIik6IiIpO2lmKGN1cil7aj0wO3doaWxlKChjbGF6ej1jbGFzc2VzW2orK10pKXt3aGlsZShjdXIuaW5kZXhPZigiICIrY2xhenorIiAiKT49MCl7Y3VyPWN1ci5yZXBsYWNlKCIgIitjbGF6eisiICIsIiAiKTt9fQpmaW5hbFZhbHVlPXZhbHVlP2pRdWVyeS50cmltKGN1cik6IiI7aWYoZWxlbS5jbGFzc05hbWUhPT1maW5hbFZhbHVlKXtlbGVtLmNsYXNzTmFtZT1maW5hbFZhbHVlO319fX0KcmV0dXJuIHRoaXM7fSx0b2dnbGVDbGFzczpmdW5jdGlvbih2YWx1ZSxzdGF0ZVZhbCl7dmFyIHR5cGU9dHlwZW9mIHZhbHVlO2lmKHR5cGVvZiBzdGF0ZVZhbD09PSJib29sZWFuIiYmdHlwZT09PSJzdHJpbmciKXtyZXR1cm4gc3RhdGVWYWw/dGhpcy5hZGRDbGFzcyh2YWx1ZSk6dGhpcy5yZW1vdmVDbGFzcyh2YWx1ZSk7fQppZihqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSl7alF1ZXJ5KHRoaXMpLnRvZ2dsZUNsYXNzKHZhbHVlLmNhbGwodGhpcyxpLHRoaXMuY2xhc3NOYW1lLHN0YXRlVmFsKSxzdGF0ZVZhbCk7fSk7fQpyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7aWYodHlwZT09PSJzdHJpbmciKXt2YXIgY2xhc3NOYW1lLGk9MCxzZWxmPWpRdWVyeSh0aGlzKSxjbGFzc05hbWVzPXZhbHVlLm1hdGNoKHJub3R3aGl0ZSl8fFtdO3doaWxlKChjbGFzc05hbWU9Y2xhc3NOYW1lc1tpKytdKSl7aWYoc2VsZi5oYXNDbGFzcyhjbGFzc05hbWUpKXtzZWxmLnJlbW92ZUNsYXNzKGNsYXNzTmFtZSk7fWVsc2V7c2VsZi5hZGRDbGFzcyhjbGFzc05hbWUpO319fWVsc2UgaWYodHlwZT09PXN0cnVuZGVmaW5lZHx8dHlwZT09PSJib29sZWFuIil7aWYodGhpcy5jbGFzc05hbWUpe2pRdWVyeS5fZGF0YSh0aGlzLCJfX2NsYXNzTmFtZV9fIix0aGlzLmNsYXNzTmFtZSk7fQp0aGlzLmNsYXNzTmFtZT10aGlzLmNsYXNzTmFtZXx8dmFsdWU9PT1mYWxzZT8iIjpqUXVlcnkuX2RhdGEodGhpcywiX19jbGFzc05hbWVfXyIpfHwiIjt9fSk7fSxoYXNDbGFzczpmdW5jdGlvbihzZWxlY3Rvcil7dmFyIGNsYXNzTmFtZT0iICIrc2VsZWN0b3IrIiAiLGk9MCxsPXRoaXMubGVuZ3RoO2Zvcig7aTxsO2krKyl7aWYodGhpc1tpXS5ub2RlVHlwZT09PTEmJigiICIrdGhpc1tpXS5jbGFzc05hbWUrIiAiKS5yZXBsYWNlKHJjbGFzcywiICIpLmluZGV4T2YoY2xhc3NOYW1lKT49MCl7cmV0dXJuIHRydWU7fX0KcmV0dXJuIGZhbHNlO319KTtqUXVlcnkuZWFjaCgoImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCBsb2FkIHJlc2l6ZSBzY3JvbGwgdW5sb2FkIGNsaWNrIGRibGNsaWNrICIrIm1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlICIrImNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnUiKS5zcGxpdCgiICIpLGZ1bmN0aW9uKGksbmFtZSl7alF1ZXJ5LmZuW25hbWVdPWZ1bmN0aW9uKGRhdGEsZm4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPjA/dGhpcy5vbihuYW1lLG51bGwsZGF0YSxmbik6dGhpcy50cmlnZ2VyKG5hbWUpO307fSk7alF1ZXJ5LmZuLmV4dGVuZCh7aG92ZXI6ZnVuY3Rpb24oZm5PdmVyLGZuT3V0KXtyZXR1cm4gdGhpcy5tb3VzZWVudGVyKGZuT3ZlcikubW91c2VsZWF2ZShmbk91dHx8Zm5PdmVyKTt9LGJpbmQ6ZnVuY3Rpb24odHlwZXMsZGF0YSxmbil7cmV0dXJuIHRoaXMub24odHlwZXMsbnVsbCxkYXRhLGZuKTt9LHVuYmluZDpmdW5jdGlvbih0eXBlcyxmbil7cmV0dXJuIHRoaXMub2ZmKHR5cGVzLG51bGwsZm4pO30sZGVsZWdhdGU6ZnVuY3Rpb24oc2VsZWN0b3IsdHlwZXMsZGF0YSxmbil7cmV0dXJuIHRoaXMub24odHlwZXMsc2VsZWN0b3IsZGF0YSxmbik7fSx1bmRlbGVnYXRlOmZ1bmN0aW9uKHNlbGVjdG9yLHR5cGVzLGZuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD09PTE/dGhpcy5vZmYoc2VsZWN0b3IsIioqIik6dGhpcy5vZmYodHlwZXMsc2VsZWN0b3J8fCIqKiIsZm4pO319KTt2YXIgbm9uY2U9alF1ZXJ5Lm5vdygpO3ZhciBycXVlcnk9KC9cPy8pO3ZhciBydmFsaWR0b2tlbnM9LygsKXwoXFt8eyl8KH18XSl8Iig/OlteIlxcXHJcbl18XFxbIlxcXC9iZm5ydF18XFx1W1xkYS1mQS1GXXs0fSkqIlxzKjo/fHRydWV8ZmFsc2V8bnVsbHwtPyg/ITBcZClcZCsoPzpcLlxkK3wpKD86W2VFXVsrLV0/XGQrfCkvZztqUXVlcnkucGFyc2VKU09OPWZ1bmN0aW9uKGRhdGEpe2lmKHdpbmRvdy5KU09OJiZ3aW5kb3cuSlNPTi5wYXJzZSl7cmV0dXJuIHdpbmRvdy5KU09OLnBhcnNlKGRhdGErIiIpO30KdmFyIHJlcXVpcmVOb25Db21tYSxkZXB0aD1udWxsLHN0cj1qUXVlcnkudHJpbShkYXRhKyIiKTtyZXR1cm4gc3RyJiYhalF1ZXJ5LnRyaW0oc3RyLnJlcGxhY2UocnZhbGlkdG9rZW5zLGZ1bmN0aW9uKHRva2VuLGNvbW1hLG9wZW4sY2xvc2Upe2lmKHJlcXVpcmVOb25Db21tYSYmY29tbWEpe2RlcHRoPTA7fQppZihkZXB0aD09PTApe3JldHVybiB0b2tlbjt9CnJlcXVpcmVOb25Db21tYT1vcGVufHxjb21tYTtkZXB0aCs9IWNsb3NlLSFvcGVuO3JldHVybiIiO30pKT8oRnVuY3Rpb24oInJldHVybiAiK3N0cikpKCk6alF1ZXJ5LmVycm9yKCJJbnZhbGlkIEpTT046ICIrZGF0YSk7fTtqUXVlcnkucGFyc2VYTUw9ZnVuY3Rpb24oZGF0YSl7dmFyIHhtbCx0bXA7aWYoIWRhdGF8fHR5cGVvZiBkYXRhIT09InN0cmluZyIpe3JldHVybiBudWxsO30KdHJ5e2lmKHdpbmRvdy5ET01QYXJzZXIpe3RtcD1uZXcgRE9NUGFyc2VyKCk7eG1sPXRtcC5wYXJzZUZyb21TdHJpbmcoZGF0YSwidGV4dC94bWwiKTt9ZWxzZXt4bWw9bmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKTt4bWwuYXN5bmM9ImZhbHNlIjt4bWwubG9hZFhNTChkYXRhKTt9fWNhdGNoKGUpe3htbD11bmRlZmluZWQ7fQppZigheG1sfHwheG1sLmRvY3VtZW50RWxlbWVudHx8eG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwYXJzZXJlcnJvciIpLmxlbmd0aCl7alF1ZXJ5LmVycm9yKCJJbnZhbGlkIFhNTDogIitkYXRhKTt9CnJldHVybiB4bWw7fTt2YXIKYWpheExvY1BhcnRzLGFqYXhMb2NhdGlvbixyaGFzaD0vIy4qJC8scnRzPS8oWz8mXSlfPVteJl0qLyxyaGVhZGVycz0vXiguKj8pOlsgXHRdKihbXlxyXG5dKilccj8kL21nLHJsb2NhbFByb3RvY29sPS9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLHJub0NvbnRlbnQ9L14oPzpHRVR8SEVBRCkkLyxycHJvdG9jb2w9L15cL1wvLyxydXJsPS9eKFtcdy4rLV0rOikoPzpcL1wvKD86W15cLz8jXSpAfCkoW15cLz8jOl0qKSg/OjooXGQrKXwpfCkvLHByZWZpbHRlcnM9e30sdHJhbnNwb3J0cz17fSxhbGxUeXBlcz0iKi8iLmNvbmNhdCgiKiIpO3RyeXthamF4TG9jYXRpb249bG9jYXRpb24uaHJlZjt9Y2F0Y2goZSl7YWpheExvY2F0aW9uPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTthamF4TG9jYXRpb24uaHJlZj0iIjthamF4TG9jYXRpb249YWpheExvY2F0aW9uLmhyZWY7fQphamF4TG9jUGFydHM9cnVybC5leGVjKGFqYXhMb2NhdGlvbi50b0xvd2VyQ2FzZSgpKXx8W107ZnVuY3Rpb24gYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHN0cnVjdHVyZSl7cmV0dXJuIGZ1bmN0aW9uKGRhdGFUeXBlRXhwcmVzc2lvbixmdW5jKXtpZih0eXBlb2YgZGF0YVR5cGVFeHByZXNzaW9uIT09InN0cmluZyIpe2Z1bmM9ZGF0YVR5cGVFeHByZXNzaW9uO2RhdGFUeXBlRXhwcmVzc2lvbj0iKiI7fQp2YXIgZGF0YVR5cGUsaT0wLGRhdGFUeXBlcz1kYXRhVHlwZUV4cHJlc3Npb24udG9Mb3dlckNhc2UoKS5tYXRjaChybm90d2hpdGUpfHxbXTtpZihqUXVlcnkuaXNGdW5jdGlvbihmdW5jKSl7d2hpbGUoKGRhdGFUeXBlPWRhdGFUeXBlc1tpKytdKSl7aWYoZGF0YVR5cGUuY2hhckF0KDApPT09IisiKXtkYXRhVHlwZT1kYXRhVHlwZS5zbGljZSgxKXx8IioiOyhzdHJ1Y3R1cmVbZGF0YVR5cGVdPXN0cnVjdHVyZVtkYXRhVHlwZV18fFtdKS51bnNoaWZ0KGZ1bmMpO31lbHNleyhzdHJ1Y3R1cmVbZGF0YVR5cGVdPXN0cnVjdHVyZVtkYXRhVHlwZV18fFtdKS5wdXNoKGZ1bmMpO319fX07fQpmdW5jdGlvbiBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyhzdHJ1Y3R1cmUsb3B0aW9ucyxvcmlnaW5hbE9wdGlvbnMsanFYSFIpe3ZhciBpbnNwZWN0ZWQ9e30sc2Vla2luZ1RyYW5zcG9ydD0oc3RydWN0dXJlPT09dHJhbnNwb3J0cyk7ZnVuY3Rpb24gaW5zcGVjdChkYXRhVHlwZSl7dmFyIHNlbGVjdGVkO2luc3BlY3RlZFtkYXRhVHlwZV09dHJ1ZTtqUXVlcnkuZWFjaChzdHJ1Y3R1cmVbZGF0YVR5cGVdfHxbXSxmdW5jdGlvbihfLHByZWZpbHRlck9yRmFjdG9yeSl7dmFyIGRhdGFUeXBlT3JUcmFuc3BvcnQ9cHJlZmlsdGVyT3JGYWN0b3J5KG9wdGlvbnMsb3JpZ2luYWxPcHRpb25zLGpxWEhSKTtpZih0eXBlb2YgZGF0YVR5cGVPclRyYW5zcG9ydD09PSJzdHJpbmciJiYhc2Vla2luZ1RyYW5zcG9ydCYmIWluc3BlY3RlZFtkYXRhVHlwZU9yVHJhbnNwb3J0XSl7b3B0aW9ucy5kYXRhVHlwZXMudW5zaGlmdChkYXRhVHlwZU9yVHJhbnNwb3J0KTtpbnNwZWN0KGRhdGFUeXBlT3JUcmFuc3BvcnQpO3JldHVybiBmYWxzZTt9ZWxzZSBpZihzZWVraW5nVHJhbnNwb3J0KXtyZXR1cm4hKHNlbGVjdGVkPWRhdGFUeXBlT3JUcmFuc3BvcnQpO319KTtyZXR1cm4gc2VsZWN0ZWQ7fQpyZXR1cm4gaW5zcGVjdChvcHRpb25zLmRhdGFUeXBlc1swXSl8fCFpbnNwZWN0ZWRbIioiXSYmaW5zcGVjdCgiKiIpO30KZnVuY3Rpb24gYWpheEV4dGVuZCh0YXJnZXQsc3JjKXt2YXIgZGVlcCxrZXksZmxhdE9wdGlvbnM9alF1ZXJ5LmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKGtleSBpbiBzcmMpe2lmKHNyY1trZXldIT09dW5kZWZpbmVkKXsoZmxhdE9wdGlvbnNba2V5XT90YXJnZXQ6KGRlZXB8fChkZWVwPXt9KSkpW2tleV09c3JjW2tleV07fX0KaWYoZGVlcCl7alF1ZXJ5LmV4dGVuZCh0cnVlLHRhcmdldCxkZWVwKTt9CnJldHVybiB0YXJnZXQ7fQpmdW5jdGlvbiBhamF4SGFuZGxlUmVzcG9uc2VzKHMsanFYSFIscmVzcG9uc2VzKXt2YXIgZmlyc3REYXRhVHlwZSxjdCxmaW5hbERhdGFUeXBlLHR5cGUsY29udGVudHM9cy5jb250ZW50cyxkYXRhVHlwZXM9cy5kYXRhVHlwZXM7d2hpbGUoZGF0YVR5cGVzWzBdPT09IioiKXtkYXRhVHlwZXMuc2hpZnQoKTtpZihjdD09PXVuZGVmaW5lZCl7Y3Q9cy5taW1lVHlwZXx8anFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpO319CmlmKGN0KXtmb3IodHlwZSBpbiBjb250ZW50cyl7aWYoY29udGVudHNbdHlwZV0mJmNvbnRlbnRzW3R5cGVdLnRlc3QoY3QpKXtkYXRhVHlwZXMudW5zaGlmdCh0eXBlKTticmVhazt9fX0KaWYoZGF0YVR5cGVzWzBdaW4gcmVzcG9uc2VzKXtmaW5hbERhdGFUeXBlPWRhdGFUeXBlc1swXTt9ZWxzZXtmb3IodHlwZSBpbiByZXNwb25zZXMpe2lmKCFkYXRhVHlwZXNbMF18fHMuY29udmVydGVyc1t0eXBlKyIgIitkYXRhVHlwZXNbMF1dKXtmaW5hbERhdGFUeXBlPXR5cGU7YnJlYWs7fQppZighZmlyc3REYXRhVHlwZSl7Zmlyc3REYXRhVHlwZT10eXBlO319CmZpbmFsRGF0YVR5cGU9ZmluYWxEYXRhVHlwZXx8Zmlyc3REYXRhVHlwZTt9CmlmKGZpbmFsRGF0YVR5cGUpe2lmKGZpbmFsRGF0YVR5cGUhPT1kYXRhVHlwZXNbMF0pe2RhdGFUeXBlcy51bnNoaWZ0KGZpbmFsRGF0YVR5cGUpO30KcmV0dXJuIHJlc3BvbnNlc1tmaW5hbERhdGFUeXBlXTt9fQpmdW5jdGlvbiBhamF4Q29udmVydChzLHJlc3BvbnNlLGpxWEhSLGlzU3VjY2Vzcyl7dmFyIGNvbnYyLGN1cnJlbnQsY29udix0bXAscHJldixjb252ZXJ0ZXJzPXt9LGRhdGFUeXBlcz1zLmRhdGFUeXBlcy5zbGljZSgpO2lmKGRhdGFUeXBlc1sxXSl7Zm9yKGNvbnYgaW4gcy5jb252ZXJ0ZXJzKXtjb252ZXJ0ZXJzW2NvbnYudG9Mb3dlckNhc2UoKV09cy5jb252ZXJ0ZXJzW2NvbnZdO319CmN1cnJlbnQ9ZGF0YVR5cGVzLnNoaWZ0KCk7d2hpbGUoY3VycmVudCl7aWYocy5yZXNwb25zZUZpZWxkc1tjdXJyZW50XSl7anFYSFJbcy5yZXNwb25zZUZpZWxkc1tjdXJyZW50XV09cmVzcG9uc2U7fQppZighcHJldiYmaXNTdWNjZXNzJiZzLmRhdGFGaWx0ZXIpe3Jlc3BvbnNlPXMuZGF0YUZpbHRlcihyZXNwb25zZSxzLmRhdGFUeXBlKTt9CnByZXY9Y3VycmVudDtjdXJyZW50PWRhdGFUeXBlcy5zaGlmdCgpO2lmKGN1cnJlbnQpe2lmKGN1cnJlbnQ9PT0iKiIpe2N1cnJlbnQ9cHJldjt9ZWxzZSBpZihwcmV2IT09IioiJiZwcmV2IT09Y3VycmVudCl7Y29udj1jb252ZXJ0ZXJzW3ByZXYrIiAiK2N1cnJlbnRdfHxjb252ZXJ0ZXJzWyIqICIrY3VycmVudF07aWYoIWNvbnYpe2Zvcihjb252MiBpbiBjb252ZXJ0ZXJzKXt0bXA9Y29udjIuc3BsaXQoIiAiKTtpZih0bXBbMV09PT1jdXJyZW50KXtjb252PWNvbnZlcnRlcnNbcHJldisiICIrdG1wWzBdXXx8Y29udmVydGVyc1siKiAiK3RtcFswXV07aWYoY29udil7aWYoY29udj09PXRydWUpe2NvbnY9Y29udmVydGVyc1tjb252Ml07fWVsc2UgaWYoY29udmVydGVyc1tjb252Ml0hPT10cnVlKXtjdXJyZW50PXRtcFswXTtkYXRhVHlwZXMudW5zaGlmdCh0bXBbMV0pO30KYnJlYWs7fX19fQppZihjb252IT09dHJ1ZSl7aWYoY29udiYmc1sidGhyb3dzIl0pe3Jlc3BvbnNlPWNvbnYocmVzcG9uc2UpO31lbHNle3RyeXtyZXNwb25zZT1jb252KHJlc3BvbnNlKTt9Y2F0Y2goZSl7cmV0dXJue3N0YXRlOiJwYXJzZXJlcnJvciIsZXJyb3I6Y29udj9lOiJObyBjb252ZXJzaW9uIGZyb20gIitwcmV2KyIgdG8gIitjdXJyZW50fTt9fX19fX0KcmV0dXJue3N0YXRlOiJzdWNjZXNzIixkYXRhOnJlc3BvbnNlfTt9CmpRdWVyeS5leHRlbmQoe2FjdGl2ZTowLGxhc3RNb2RpZmllZDp7fSxldGFnOnt9LGFqYXhTZXR0aW5nczp7dXJsOmFqYXhMb2NhdGlvbix0eXBlOiJHRVQiLGlzTG9jYWw6cmxvY2FsUHJvdG9jb2wudGVzdChhamF4TG9jUGFydHNbMV0pLGdsb2JhbDp0cnVlLHByb2Nlc3NEYXRhOnRydWUsYXN5bmM6dHJ1ZSxjb250ZW50VHlwZToiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IixhY2NlcHRzOnsiKiI6YWxsVHlwZXMsdGV4dDoidGV4dC9wbGFpbiIsaHRtbDoidGV4dC9odG1sIix4bWw6ImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLGpzb246ImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCJ9LGNvbnRlbnRzOnt4bWw6L3htbC8saHRtbDovaHRtbC8sanNvbjovanNvbi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjp0cnVlLCJ0ZXh0IGpzb24iOmpRdWVyeS5wYXJzZUpTT04sInRleHQgeG1sIjpqUXVlcnkucGFyc2VYTUx9LGZsYXRPcHRpb25zOnt1cmw6dHJ1ZSxjb250ZXh0OnRydWV9fSxhamF4U2V0dXA6ZnVuY3Rpb24odGFyZ2V0LHNldHRpbmdzKXtyZXR1cm4gc2V0dGluZ3M/YWpheEV4dGVuZChhamF4RXh0ZW5kKHRhcmdldCxqUXVlcnkuYWpheFNldHRpbmdzKSxzZXR0aW5ncyk6YWpheEV4dGVuZChqUXVlcnkuYWpheFNldHRpbmdzLHRhcmdldCk7fSxhamF4UHJlZmlsdGVyOmFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyhwcmVmaWx0ZXJzKSxhamF4VHJhbnNwb3J0OmFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyh0cmFuc3BvcnRzKSxhamF4OmZ1bmN0aW9uKHVybCxvcHRpb25zKXtpZih0eXBlb2YgdXJsPT09Im9iamVjdCIpe29wdGlvbnM9dXJsO3VybD11bmRlZmluZWQ7fQpvcHRpb25zPW9wdGlvbnN8fHt9O3ZhcgpwYXJ0cyxpLGNhY2hlVVJMLHJlc3BvbnNlSGVhZGVyc1N0cmluZyx0aW1lb3V0VGltZXIsZmlyZUdsb2JhbHMsdHJhbnNwb3J0LHJlc3BvbnNlSGVhZGVycyxzPWpRdWVyeS5hamF4U2V0dXAoe30sb3B0aW9ucyksY2FsbGJhY2tDb250ZXh0PXMuY29udGV4dHx8cyxnbG9iYWxFdmVudENvbnRleHQ9cy5jb250ZXh0JiYoY2FsbGJhY2tDb250ZXh0Lm5vZGVUeXBlfHxjYWxsYmFja0NvbnRleHQuanF1ZXJ5KT9qUXVlcnkoY2FsbGJhY2tDb250ZXh0KTpqUXVlcnkuZXZlbnQsZGVmZXJyZWQ9alF1ZXJ5LkRlZmVycmVkKCksY29tcGxldGVEZWZlcnJlZD1qUXVlcnkuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHN0YXR1c0NvZGU9cy5zdGF0dXNDb2RlfHx7fSxyZXF1ZXN0SGVhZGVycz17fSxyZXF1ZXN0SGVhZGVyc05hbWVzPXt9LHN0YXRlPTAsc3RyQWJvcnQ9ImNhbmNlbGVkIixqcVhIUj17cmVhZHlTdGF0ZTowLGdldFJlc3BvbnNlSGVhZGVyOmZ1bmN0aW9uKGtleSl7dmFyIG1hdGNoO2lmKHN0YXRlPT09Mil7aWYoIXJlc3BvbnNlSGVhZGVycyl7cmVzcG9uc2VIZWFkZXJzPXt9O3doaWxlKChtYXRjaD1yaGVhZGVycy5leGVjKHJlc3BvbnNlSGVhZGVyc1N0cmluZykpKXtyZXNwb25zZUhlYWRlcnNbbWF0Y2hbMV0udG9Mb3dlckNhc2UoKV09bWF0Y2hbMl07fX0KbWF0Y2g9cmVzcG9uc2VIZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXTt9CnJldHVybiBtYXRjaD09bnVsbD9udWxsOm1hdGNoO30sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIHN0YXRlPT09Mj9yZXNwb25zZUhlYWRlcnNTdHJpbmc6bnVsbDt9LHNldFJlcXVlc3RIZWFkZXI6ZnVuY3Rpb24obmFtZSx2YWx1ZSl7dmFyIGxuYW1lPW5hbWUudG9Mb3dlckNhc2UoKTtpZighc3RhdGUpe25hbWU9cmVxdWVzdEhlYWRlcnNOYW1lc1tsbmFtZV09cmVxdWVzdEhlYWRlcnNOYW1lc1tsbmFtZV18fG5hbWU7cmVxdWVzdEhlYWRlcnNbbmFtZV09dmFsdWU7fQpyZXR1cm4gdGhpczt9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24odHlwZSl7aWYoIXN0YXRlKXtzLm1pbWVUeXBlPXR5cGU7fQpyZXR1cm4gdGhpczt9LHN0YXR1c0NvZGU6ZnVuY3Rpb24obWFwKXt2YXIgY29kZTtpZihtYXApe2lmKHN0YXRlPDIpe2Zvcihjb2RlIGluIG1hcCl7c3RhdHVzQ29kZVtjb2RlXT1bc3RhdHVzQ29kZVtjb2RlXSxtYXBbY29kZV1dO319ZWxzZXtqcVhIUi5hbHdheXMobWFwW2pxWEhSLnN0YXR1c10pO319CnJldHVybiB0aGlzO30sYWJvcnQ6ZnVuY3Rpb24oc3RhdHVzVGV4dCl7dmFyIGZpbmFsVGV4dD1zdGF0dXNUZXh0fHxzdHJBYm9ydDtpZih0cmFuc3BvcnQpe3RyYW5zcG9ydC5hYm9ydChmaW5hbFRleHQpO30KZG9uZSgwLGZpbmFsVGV4dCk7cmV0dXJuIHRoaXM7fX07ZGVmZXJyZWQucHJvbWlzZShqcVhIUikuY29tcGxldGU9Y29tcGxldGVEZWZlcnJlZC5hZGQ7anFYSFIuc3VjY2Vzcz1qcVhIUi5kb25lO2pxWEhSLmVycm9yPWpxWEhSLmZhaWw7cy51cmw9KCh1cmx8fHMudXJsfHxhamF4TG9jYXRpb24pKyIiKS5yZXBsYWNlKHJoYXNoLCIiKS5yZXBsYWNlKHJwcm90b2NvbCxhamF4TG9jUGFydHNbMV0rIi8vIik7cy50eXBlPW9wdGlvbnMubWV0aG9kfHxvcHRpb25zLnR5cGV8fHMubWV0aG9kfHxzLnR5cGU7cy5kYXRhVHlwZXM9alF1ZXJ5LnRyaW0ocy5kYXRhVHlwZXx8IioiKS50b0xvd2VyQ2FzZSgpLm1hdGNoKHJub3R3aGl0ZSl8fFsiIl07aWYocy5jcm9zc0RvbWFpbj09bnVsbCl7cGFydHM9cnVybC5leGVjKHMudXJsLnRvTG93ZXJDYXNlKCkpO3MuY3Jvc3NEb21haW49ISEocGFydHMmJihwYXJ0c1sxXSE9PWFqYXhMb2NQYXJ0c1sxXXx8cGFydHNbMl0hPT1hamF4TG9jUGFydHNbMl18fChwYXJ0c1szXXx8KHBhcnRzWzFdPT09Imh0dHA6Ij8iODAiOiI0NDMiKSkhPT0oYWpheExvY1BhcnRzWzNdfHwoYWpheExvY1BhcnRzWzFdPT09Imh0dHA6Ij8iODAiOiI0NDMiKSkpKTt9CmlmKHMuZGF0YSYmcy5wcm9jZXNzRGF0YSYmdHlwZW9mIHMuZGF0YSE9PSJzdHJpbmciKXtzLmRhdGE9alF1ZXJ5LnBhcmFtKHMuZGF0YSxzLnRyYWRpdGlvbmFsKTt9Cmluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHByZWZpbHRlcnMscyxvcHRpb25zLGpxWEhSKTtpZihzdGF0ZT09PTIpe3JldHVybiBqcVhIUjt9CmZpcmVHbG9iYWxzPXMuZ2xvYmFsO2lmKGZpcmVHbG9iYWxzJiZqUXVlcnkuYWN0aXZlKys9PT0wKXtqUXVlcnkuZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0Iik7fQpzLnR5cGU9cy50eXBlLnRvVXBwZXJDYXNlKCk7cy5oYXNDb250ZW50PSFybm9Db250ZW50LnRlc3Qocy50eXBlKTtjYWNoZVVSTD1zLnVybDtpZighcy5oYXNDb250ZW50KXtpZihzLmRhdGEpe2NhY2hlVVJMPShzLnVybCs9KHJxdWVyeS50ZXN0KGNhY2hlVVJMKT8iJiI6Ij8iKStzLmRhdGEpO2RlbGV0ZSBzLmRhdGE7fQppZihzLmNhY2hlPT09ZmFsc2Upe3MudXJsPXJ0cy50ZXN0KGNhY2hlVVJMKT9jYWNoZVVSTC5yZXBsYWNlKHJ0cywiJDFfPSIrbm9uY2UrKyk6Y2FjaGVVUkwrKHJxdWVyeS50ZXN0KGNhY2hlVVJMKT8iJiI6Ij8iKSsiXz0iK25vbmNlKys7fX0KaWYocy5pZk1vZGlmaWVkKXtpZihqUXVlcnkubGFzdE1vZGlmaWVkW2NhY2hlVVJMXSl7anFYSFIuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLGpRdWVyeS5sYXN0TW9kaWZpZWRbY2FjaGVVUkxdKTt9CmlmKGpRdWVyeS5ldGFnW2NhY2hlVVJMXSl7anFYSFIuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsalF1ZXJ5LmV0YWdbY2FjaGVVUkxdKTt9fQppZihzLmRhdGEmJnMuaGFzQ29udGVudCYmcy5jb250ZW50VHlwZSE9PWZhbHNlfHxvcHRpb25zLmNvbnRlbnRUeXBlKXtqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLHMuY29udGVudFR5cGUpO30KanFYSFIuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IixzLmRhdGFUeXBlc1swXSYmcy5hY2NlcHRzW3MuZGF0YVR5cGVzWzBdXT9zLmFjY2VwdHNbcy5kYXRhVHlwZXNbMF1dKyhzLmRhdGFUeXBlc1swXSE9PSIqIj8iLCAiK2FsbFR5cGVzKyI7IHE9MC4wMSI6IiIpOnMuYWNjZXB0c1siKiJdKTtmb3IoaSBpbiBzLmhlYWRlcnMpe2pxWEhSLnNldFJlcXVlc3RIZWFkZXIoaSxzLmhlYWRlcnNbaV0pO30KaWYocy5iZWZvcmVTZW5kJiYocy5iZWZvcmVTZW5kLmNhbGwoY2FsbGJhY2tDb250ZXh0LGpxWEhSLHMpPT09ZmFsc2V8fHN0YXRlPT09Mikpe3JldHVybiBqcVhIUi5hYm9ydCgpO30Kc3RyQWJvcnQ9ImFib3J0Ijtmb3IoaSBpbntzdWNjZXNzOjEsZXJyb3I6MSxjb21wbGV0ZToxfSl7anFYSFJbaV0oc1tpXSk7fQp0cmFuc3BvcnQ9aW5zcGVjdFByZWZpbHRlcnNPclRyYW5zcG9ydHModHJhbnNwb3J0cyxzLG9wdGlvbnMsanFYSFIpO2lmKCF0cmFuc3BvcnQpe2RvbmUoLTEsIk5vIFRyYW5zcG9ydCIpO31lbHNle2pxWEhSLnJlYWR5U3RhdGU9MTtpZihmaXJlR2xvYmFscyl7Z2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoImFqYXhTZW5kIixbanFYSFIsc10pO30KaWYocy5hc3luYyYmcy50aW1lb3V0PjApe3RpbWVvdXRUaW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7anFYSFIuYWJvcnQoInRpbWVvdXQiKTt9LHMudGltZW91dCk7fQp0cnl7c3RhdGU9MTt0cmFuc3BvcnQuc2VuZChyZXF1ZXN0SGVhZGVycyxkb25lKTt9Y2F0Y2goZSl7aWYoc3RhdGU8Mil7ZG9uZSgtMSxlKTt9ZWxzZXt0aHJvdyBlO319fQpmdW5jdGlvbiBkb25lKHN0YXR1cyxuYXRpdmVTdGF0dXNUZXh0LHJlc3BvbnNlcyxoZWFkZXJzKXt2YXIgaXNTdWNjZXNzLHN1Y2Nlc3MsZXJyb3IscmVzcG9uc2UsbW9kaWZpZWQsc3RhdHVzVGV4dD1uYXRpdmVTdGF0dXNUZXh0O2lmKHN0YXRlPT09Mil7cmV0dXJuO30Kc3RhdGU9MjtpZih0aW1lb3V0VGltZXIpe2NsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpO30KdHJhbnNwb3J0PXVuZGVmaW5lZDtyZXNwb25zZUhlYWRlcnNTdHJpbmc9aGVhZGVyc3x8IiI7anFYSFIucmVhZHlTdGF0ZT1zdGF0dXM+MD80OjA7aXNTdWNjZXNzPXN0YXR1cz49MjAwJiZzdGF0dXM8MzAwfHxzdGF0dXM9PT0zMDQ7aWYocmVzcG9uc2VzKXtyZXNwb25zZT1hamF4SGFuZGxlUmVzcG9uc2VzKHMsanFYSFIscmVzcG9uc2VzKTt9CnJlc3BvbnNlPWFqYXhDb252ZXJ0KHMscmVzcG9uc2UsanFYSFIsaXNTdWNjZXNzKTtpZihpc1N1Y2Nlc3Mpe2lmKHMuaWZNb2RpZmllZCl7bW9kaWZpZWQ9anFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKTtpZihtb2RpZmllZCl7alF1ZXJ5Lmxhc3RNb2RpZmllZFtjYWNoZVVSTF09bW9kaWZpZWQ7fQptb2RpZmllZD1qcVhIUi5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpO2lmKG1vZGlmaWVkKXtqUXVlcnkuZXRhZ1tjYWNoZVVSTF09bW9kaWZpZWQ7fX0KaWYoc3RhdHVzPT09MjA0fHxzLnR5cGU9PT0iSEVBRCIpe3N0YXR1c1RleHQ9Im5vY29udGVudCI7fWVsc2UgaWYoc3RhdHVzPT09MzA0KXtzdGF0dXNUZXh0PSJub3Rtb2RpZmllZCI7fWVsc2V7c3RhdHVzVGV4dD1yZXNwb25zZS5zdGF0ZTtzdWNjZXNzPXJlc3BvbnNlLmRhdGE7ZXJyb3I9cmVzcG9uc2UuZXJyb3I7aXNTdWNjZXNzPSFlcnJvcjt9fWVsc2V7ZXJyb3I9c3RhdHVzVGV4dDtpZihzdGF0dXN8fCFzdGF0dXNUZXh0KXtzdGF0dXNUZXh0PSJlcnJvciI7aWYoc3RhdHVzPDApe3N0YXR1cz0wO319fQpqcVhIUi5zdGF0dXM9c3RhdHVzO2pxWEhSLnN0YXR1c1RleHQ9KG5hdGl2ZVN0YXR1c1RleHR8fHN0YXR1c1RleHQpKyIiO2lmKGlzU3VjY2Vzcyl7ZGVmZXJyZWQucmVzb2x2ZVdpdGgoY2FsbGJhY2tDb250ZXh0LFtzdWNjZXNzLHN0YXR1c1RleHQsanFYSFJdKTt9ZWxzZXtkZWZlcnJlZC5yZWplY3RXaXRoKGNhbGxiYWNrQ29udGV4dCxbanFYSFIsc3RhdHVzVGV4dCxlcnJvcl0pO30KanFYSFIuc3RhdHVzQ29kZShzdGF0dXNDb2RlKTtzdGF0dXNDb2RlPXVuZGVmaW5lZDtpZihmaXJlR2xvYmFscyl7Z2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoaXNTdWNjZXNzPyJhamF4U3VjY2VzcyI6ImFqYXhFcnJvciIsW2pxWEhSLHMsaXNTdWNjZXNzP3N1Y2Nlc3M6ZXJyb3JdKTt9CmNvbXBsZXRlRGVmZXJyZWQuZmlyZVdpdGgoY2FsbGJhY2tDb250ZXh0LFtqcVhIUixzdGF0dXNUZXh0XSk7aWYoZmlyZUdsb2JhbHMpe2dsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCJhamF4Q29tcGxldGUiLFtqcVhIUixzXSk7aWYoISgtLWpRdWVyeS5hY3RpdmUpKXtqUXVlcnkuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKTt9fX0KcmV0dXJuIGpxWEhSO30sZ2V0SlNPTjpmdW5jdGlvbih1cmwsZGF0YSxjYWxsYmFjayl7cmV0dXJuIGpRdWVyeS5nZXQodXJsLGRhdGEsY2FsbGJhY2ssImpzb24iKTt9LGdldFNjcmlwdDpmdW5jdGlvbih1cmwsY2FsbGJhY2spe3JldHVybiBqUXVlcnkuZ2V0KHVybCx1bmRlZmluZWQsY2FsbGJhY2ssInNjcmlwdCIpO319KTtqUXVlcnkuZWFjaChbImdldCIsInBvc3QiXSxmdW5jdGlvbihpLG1ldGhvZCl7alF1ZXJ5W21ldGhvZF09ZnVuY3Rpb24odXJsLGRhdGEsY2FsbGJhY2ssdHlwZSl7aWYoalF1ZXJ5LmlzRnVuY3Rpb24oZGF0YSkpe3R5cGU9dHlwZXx8Y2FsbGJhY2s7Y2FsbGJhY2s9ZGF0YTtkYXRhPXVuZGVmaW5lZDt9CnJldHVybiBqUXVlcnkuYWpheCh7dXJsOnVybCx0eXBlOm1ldGhvZCxkYXRhVHlwZTp0eXBlLGRhdGE6ZGF0YSxzdWNjZXNzOmNhbGxiYWNrfSk7fTt9KTtqUXVlcnkuZWFjaChbImFqYXhTdGFydCIsImFqYXhTdG9wIiwiYWpheENvbXBsZXRlIiwiYWpheEVycm9yIiwiYWpheFN1Y2Nlc3MiLCJhamF4U2VuZCJdLGZ1bmN0aW9uKGksdHlwZSl7alF1ZXJ5LmZuW3R5cGVdPWZ1bmN0aW9uKGZuKXtyZXR1cm4gdGhpcy5vbih0eXBlLGZuKTt9O30pO2pRdWVyeS5fZXZhbFVybD1mdW5jdGlvbih1cmwpe3JldHVybiBqUXVlcnkuYWpheCh7dXJsOnVybCx0eXBlOiJHRVQiLGRhdGFUeXBlOiJzY3JpcHQiLGFzeW5jOmZhbHNlLGdsb2JhbDpmYWxzZSwidGhyb3dzIjp0cnVlfSk7fTtqUXVlcnkuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGh0bWwpe2lmKGpRdWVyeS5pc0Z1bmN0aW9uKGh0bWwpKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGkpe2pRdWVyeSh0aGlzKS53cmFwQWxsKGh0bWwuY2FsbCh0aGlzLGkpKTt9KTt9CmlmKHRoaXNbMF0pe3ZhciB3cmFwPWpRdWVyeShodG1sLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUodHJ1ZSk7aWYodGhpc1swXS5wYXJlbnROb2RlKXt3cmFwLmluc2VydEJlZm9yZSh0aGlzWzBdKTt9CndyYXAubWFwKGZ1bmN0aW9uKCl7dmFyIGVsZW09dGhpczt3aGlsZShlbGVtLmZpcnN0Q2hpbGQmJmVsZW0uZmlyc3RDaGlsZC5ub2RlVHlwZT09PTEpe2VsZW09ZWxlbS5maXJzdENoaWxkO30KcmV0dXJuIGVsZW07fSkuYXBwZW5kKHRoaXMpO30KcmV0dXJuIHRoaXM7fSx3cmFwSW5uZXI6ZnVuY3Rpb24oaHRtbCl7aWYoalF1ZXJ5LmlzRnVuY3Rpb24oaHRtbCkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSl7alF1ZXJ5KHRoaXMpLndyYXBJbm5lcihodG1sLmNhbGwodGhpcyxpKSk7fSk7fQpyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHNlbGY9alF1ZXJ5KHRoaXMpLGNvbnRlbnRzPXNlbGYuY29udGVudHMoKTtpZihjb250ZW50cy5sZW5ndGgpe2NvbnRlbnRzLndyYXBBbGwoaHRtbCk7fWVsc2V7c2VsZi5hcHBlbmQoaHRtbCk7fX0pO30sd3JhcDpmdW5jdGlvbihodG1sKXt2YXIgaXNGdW5jdGlvbj1qUXVlcnkuaXNGdW5jdGlvbihodG1sKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGkpe2pRdWVyeSh0aGlzKS53cmFwQWxsKGlzRnVuY3Rpb24/aHRtbC5jYWxsKHRoaXMsaSk6aHRtbCk7fSk7fSx1bndyYXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQoKS5lYWNoKGZ1bmN0aW9uKCl7aWYoIWpRdWVyeS5ub2RlTmFtZSh0aGlzLCJib2R5Iikpe2pRdWVyeSh0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpO319KS5lbmQoKTt9fSk7alF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW49ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGVsZW0ub2Zmc2V0V2lkdGg8PTAmJmVsZW0ub2Zmc2V0SGVpZ2h0PD0wfHwoIXN1cHBvcnQucmVsaWFibGVIaWRkZW5PZmZzZXRzKCkmJigoZWxlbS5zdHlsZSYmZWxlbS5zdHlsZS5kaXNwbGF5KXx8alF1ZXJ5LmNzcyhlbGVtLCJkaXNwbGF5IikpPT09Im5vbmUiKTt9O2pRdWVyeS5leHByLmZpbHRlcnMudmlzaWJsZT1mdW5jdGlvbihlbGVtKXtyZXR1cm4halF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4oZWxlbSk7fTt2YXIgcjIwPS8lMjAvZyxyYnJhY2tldD0vXFtcXSQvLHJDUkxGPS9ccj9cbi9nLHJzdWJtaXR0ZXJUeXBlcz0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2kscnN1Ym1pdHRhYmxlPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTtmdW5jdGlvbiBidWlsZFBhcmFtcyhwcmVmaXgsb2JqLHRyYWRpdGlvbmFsLGFkZCl7dmFyIG5hbWU7aWYoalF1ZXJ5LmlzQXJyYXkob2JqKSl7alF1ZXJ5LmVhY2gob2JqLGZ1bmN0aW9uKGksdil7aWYodHJhZGl0aW9uYWx8fHJicmFja2V0LnRlc3QocHJlZml4KSl7YWRkKHByZWZpeCx2KTt9ZWxzZXtidWlsZFBhcmFtcyhwcmVmaXgrIlsiKyh0eXBlb2Ygdj09PSJvYmplY3QiP2k6IiIpKyJdIix2LHRyYWRpdGlvbmFsLGFkZCk7fX0pO31lbHNlIGlmKCF0cmFkaXRpb25hbCYmalF1ZXJ5LnR5cGUob2JqKT09PSJvYmplY3QiKXtmb3IobmFtZSBpbiBvYmope2J1aWxkUGFyYW1zKHByZWZpeCsiWyIrbmFtZSsiXSIsb2JqW25hbWVdLHRyYWRpdGlvbmFsLGFkZCk7fX1lbHNle2FkZChwcmVmaXgsb2JqKTt9fQpqUXVlcnkucGFyYW09ZnVuY3Rpb24oYSx0cmFkaXRpb25hbCl7dmFyIHByZWZpeCxzPVtdLGFkZD1mdW5jdGlvbihrZXksdmFsdWUpe3ZhbHVlPWpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKT92YWx1ZSgpOih2YWx1ZT09bnVsbD8iIjp2YWx1ZSk7c1tzLmxlbmd0aF09ZW5jb2RlVVJJQ29tcG9uZW50KGtleSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7fTtpZih0cmFkaXRpb25hbD09PXVuZGVmaW5lZCl7dHJhZGl0aW9uYWw9alF1ZXJ5LmFqYXhTZXR0aW5ncyYmalF1ZXJ5LmFqYXhTZXR0aW5ncy50cmFkaXRpb25hbDt9CmlmKGpRdWVyeS5pc0FycmF5KGEpfHwoYS5qcXVlcnkmJiFqUXVlcnkuaXNQbGFpbk9iamVjdChhKSkpe2pRdWVyeS5lYWNoKGEsZnVuY3Rpb24oKXthZGQodGhpcy5uYW1lLHRoaXMudmFsdWUpO30pO31lbHNle2ZvcihwcmVmaXggaW4gYSl7YnVpbGRQYXJhbXMocHJlZml4LGFbcHJlZml4XSx0cmFkaXRpb25hbCxhZGQpO319CnJldHVybiBzLmpvaW4oIiYiKS5yZXBsYWNlKHIyMCwiKyIpO307alF1ZXJ5LmZuLmV4dGVuZCh7c2VyaWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIGpRdWVyeS5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpO30sc2VyaWFsaXplQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgZWxlbWVudHM9alF1ZXJ5LnByb3AodGhpcywiZWxlbWVudHMiKTtyZXR1cm4gZWxlbWVudHM/alF1ZXJ5Lm1ha2VBcnJheShlbGVtZW50cyk6dGhpczt9KS5maWx0ZXIoZnVuY3Rpb24oKXt2YXIgdHlwZT10aGlzLnR5cGU7cmV0dXJuIHRoaXMubmFtZSYmIWpRdWVyeSh0aGlzKS5pcygiOmRpc2FibGVkIikmJnJzdWJtaXR0YWJsZS50ZXN0KHRoaXMubm9kZU5hbWUpJiYhcnN1Ym1pdHRlclR5cGVzLnRlc3QodHlwZSkmJih0aGlzLmNoZWNrZWR8fCFyY2hlY2thYmxlVHlwZS50ZXN0KHR5cGUpKTt9KS5tYXAoZnVuY3Rpb24oaSxlbGVtKXt2YXIgdmFsPWpRdWVyeSh0aGlzKS52YWwoKTtyZXR1cm4gdmFsPT1udWxsP251bGw6alF1ZXJ5LmlzQXJyYXkodmFsKT9qUXVlcnkubWFwKHZhbCxmdW5jdGlvbih2YWwpe3JldHVybntuYW1lOmVsZW0ubmFtZSx2YWx1ZTp2YWwucmVwbGFjZShyQ1JMRiwiXHJcbiIpfTt9KTp7bmFtZTplbGVtLm5hbWUsdmFsdWU6dmFsLnJlcGxhY2UockNSTEYsIlxyXG4iKX07fSkuZ2V0KCk7fX0pO2pRdWVyeS5hamF4U2V0dGluZ3MueGhyPXdpbmRvdy5BY3RpdmVYT2JqZWN0IT09dW5kZWZpbmVkP2Z1bmN0aW9uKCl7cmV0dXJuIXRoaXMuaXNMb2NhbCYmL14oZ2V0fHBvc3R8aGVhZHxwdXR8ZGVsZXRlfG9wdGlvbnMpJC9pLnRlc3QodGhpcy50eXBlKSYmY3JlYXRlU3RhbmRhcmRYSFIoKXx8Y3JlYXRlQWN0aXZlWEhSKCk7fTpjcmVhdGVTdGFuZGFyZFhIUjt2YXIgeGhySWQ9MCx4aHJDYWxsYmFja3M9e30seGhyU3VwcG9ydGVkPWpRdWVyeS5hamF4U2V0dGluZ3MueGhyKCk7aWYod2luZG93LkFjdGl2ZVhPYmplY3Qpe2pRdWVyeSh3aW5kb3cpLm9uKCJ1bmxvYWQiLGZ1bmN0aW9uKCl7Zm9yKHZhciBrZXkgaW4geGhyQ2FsbGJhY2tzKXt4aHJDYWxsYmFja3Nba2V5XSh1bmRlZmluZWQsdHJ1ZSk7fX0pO30Kc3VwcG9ydC5jb3JzPSEheGhyU3VwcG9ydGVkJiYoIndpdGhDcmVkZW50aWFscyJpbiB4aHJTdXBwb3J0ZWQpO3hoclN1cHBvcnRlZD1zdXBwb3J0LmFqYXg9ISF4aHJTdXBwb3J0ZWQ7aWYoeGhyU3VwcG9ydGVkKXtqUXVlcnkuYWpheFRyYW5zcG9ydChmdW5jdGlvbihvcHRpb25zKXtpZighb3B0aW9ucy5jcm9zc0RvbWFpbnx8c3VwcG9ydC5jb3JzKXt2YXIgY2FsbGJhY2s7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oaGVhZGVycyxjb21wbGV0ZSl7dmFyIGkseGhyPW9wdGlvbnMueGhyKCksaWQ9Kyt4aHJJZDt4aHIub3BlbihvcHRpb25zLnR5cGUsb3B0aW9ucy51cmwsb3B0aW9ucy5hc3luYyxvcHRpb25zLnVzZXJuYW1lLG9wdGlvbnMucGFzc3dvcmQpO2lmKG9wdGlvbnMueGhyRmllbGRzKXtmb3IoaSBpbiBvcHRpb25zLnhockZpZWxkcyl7eGhyW2ldPW9wdGlvbnMueGhyRmllbGRzW2ldO319CmlmKG9wdGlvbnMubWltZVR5cGUmJnhoci5vdmVycmlkZU1pbWVUeXBlKXt4aHIub3ZlcnJpZGVNaW1lVHlwZShvcHRpb25zLm1pbWVUeXBlKTt9CmlmKCFvcHRpb25zLmNyb3NzRG9tYWluJiYhaGVhZGVyc1siWC1SZXF1ZXN0ZWQtV2l0aCJdKXtoZWFkZXJzWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0Ijt9CmZvcihpIGluIGhlYWRlcnMpe2lmKGhlYWRlcnNbaV0hPT11bmRlZmluZWQpe3hoci5zZXRSZXF1ZXN0SGVhZGVyKGksaGVhZGVyc1tpXSsiIik7fX0KeGhyLnNlbmQoKG9wdGlvbnMuaGFzQ29udGVudCYmb3B0aW9ucy5kYXRhKXx8bnVsbCk7Y2FsbGJhY2s9ZnVuY3Rpb24oXyxpc0Fib3J0KXt2YXIgc3RhdHVzLHN0YXR1c1RleHQscmVzcG9uc2VzO2lmKGNhbGxiYWNrJiYoaXNBYm9ydHx8eGhyLnJlYWR5U3RhdGU9PT00KSl7ZGVsZXRlIHhockNhbGxiYWNrc1tpZF07Y2FsbGJhY2s9dW5kZWZpbmVkO3hoci5vbnJlYWR5c3RhdGVjaGFuZ2U9alF1ZXJ5Lm5vb3A7aWYoaXNBYm9ydCl7aWYoeGhyLnJlYWR5U3RhdGUhPT00KXt4aHIuYWJvcnQoKTt9fWVsc2V7cmVzcG9uc2VzPXt9O3N0YXR1cz14aHIuc3RhdHVzO2lmKHR5cGVvZiB4aHIucmVzcG9uc2VUZXh0PT09InN0cmluZyIpe3Jlc3BvbnNlcy50ZXh0PXhoci5yZXNwb25zZVRleHQ7fQp0cnl7c3RhdHVzVGV4dD14aHIuc3RhdHVzVGV4dDt9Y2F0Y2goZSl7c3RhdHVzVGV4dD0iIjt9CmlmKCFzdGF0dXMmJm9wdGlvbnMuaXNMb2NhbCYmIW9wdGlvbnMuY3Jvc3NEb21haW4pe3N0YXR1cz1yZXNwb25zZXMudGV4dD8yMDA6NDA0O31lbHNlIGlmKHN0YXR1cz09PTEyMjMpe3N0YXR1cz0yMDQ7fX19CmlmKHJlc3BvbnNlcyl7Y29tcGxldGUoc3RhdHVzLHN0YXR1c1RleHQscmVzcG9uc2VzLHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSk7fX07aWYoIW9wdGlvbnMuYXN5bmMpe2NhbGxiYWNrKCk7fWVsc2UgaWYoeGhyLnJlYWR5U3RhdGU9PT00KXtzZXRUaW1lb3V0KGNhbGxiYWNrKTt9ZWxzZXt4aHIub25yZWFkeXN0YXRlY2hhbmdlPXhockNhbGxiYWNrc1tpZF09Y2FsbGJhY2s7fX0sYWJvcnQ6ZnVuY3Rpb24oKXtpZihjYWxsYmFjayl7Y2FsbGJhY2sodW5kZWZpbmVkLHRydWUpO319fTt9fSk7fQpmdW5jdGlvbiBjcmVhdGVTdGFuZGFyZFhIUigpe3RyeXtyZXR1cm4gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCgpO31jYXRjaChlKXt9fQpmdW5jdGlvbiBjcmVhdGVBY3RpdmVYSFIoKXt0cnl7cmV0dXJuIG5ldyB3aW5kb3cuQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKTt9Y2F0Y2goZSl7fX0KalF1ZXJ5LmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6Lyg/OmphdmF8ZWNtYSlzY3JpcHQvfSxjb252ZXJ0ZXJzOnsidGV4dCBzY3JpcHQiOmZ1bmN0aW9uKHRleHQpe2pRdWVyeS5nbG9iYWxFdmFsKHRleHQpO3JldHVybiB0ZXh0O319fSk7alF1ZXJ5LmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsZnVuY3Rpb24ocyl7aWYocy5jYWNoZT09PXVuZGVmaW5lZCl7cy5jYWNoZT1mYWxzZTt9CmlmKHMuY3Jvc3NEb21haW4pe3MudHlwZT0iR0VUIjtzLmdsb2JhbD1mYWxzZTt9fSk7alF1ZXJ5LmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24ocyl7aWYocy5jcm9zc0RvbWFpbil7dmFyIHNjcmlwdCxoZWFkPWRvY3VtZW50LmhlYWR8fGpRdWVyeSgiaGVhZCIpWzBdfHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oXyxjYWxsYmFjayl7c2NyaXB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO3NjcmlwdC5hc3luYz10cnVlO2lmKHMuc2NyaXB0Q2hhcnNldCl7c2NyaXB0LmNoYXJzZXQ9cy5zY3JpcHRDaGFyc2V0O30Kc2NyaXB0LnNyYz1zLnVybDtzY3JpcHQub25sb2FkPXNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oXyxpc0Fib3J0KXtpZihpc0Fib3J0fHwhc2NyaXB0LnJlYWR5U3RhdGV8fC9sb2FkZWR8Y29tcGxldGUvLnRlc3Qoc2NyaXB0LnJlYWR5U3RhdGUpKXtzY3JpcHQub25sb2FkPXNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDtpZihzY3JpcHQucGFyZW50Tm9kZSl7c2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0KTt9CnNjcmlwdD1udWxsO2lmKCFpc0Fib3J0KXtjYWxsYmFjaygyMDAsInN1Y2Nlc3MiKTt9fX07aGVhZC5pbnNlcnRCZWZvcmUoc2NyaXB0LGhlYWQuZmlyc3RDaGlsZCk7fSxhYm9ydDpmdW5jdGlvbigpe2lmKHNjcmlwdCl7c2NyaXB0Lm9ubG9hZCh1bmRlZmluZWQsdHJ1ZSk7fX19O319KTt2YXIgb2xkQ2FsbGJhY2tzPVtdLHJqc29ucD0vKD0pXD8oPz0mfCQpfFw/XD8vO2pRdWVyeS5hamF4U2V0dXAoe2pzb25wOiJjYWxsYmFjayIsanNvbnBDYWxsYmFjazpmdW5jdGlvbigpe3ZhciBjYWxsYmFjaz1vbGRDYWxsYmFja3MucG9wKCl8fChqUXVlcnkuZXhwYW5kbysiXyIrKG5vbmNlKyspKTt0aGlzW2NhbGxiYWNrXT10cnVlO3JldHVybiBjYWxsYmFjazt9fSk7alF1ZXJ5LmFqYXhQcmVmaWx0ZXIoImpzb24ganNvbnAiLGZ1bmN0aW9uKHMsb3JpZ2luYWxTZXR0aW5ncyxqcVhIUil7dmFyIGNhbGxiYWNrTmFtZSxvdmVyd3JpdHRlbixyZXNwb25zZUNvbnRhaW5lcixqc29uUHJvcD1zLmpzb25wIT09ZmFsc2UmJihyanNvbnAudGVzdChzLnVybCk/InVybCI6dHlwZW9mIHMuZGF0YT09PSJzdHJpbmciJiYhKHMuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmcmpzb25wLnRlc3Qocy5kYXRhKSYmImRhdGEiKTtpZihqc29uUHJvcHx8cy5kYXRhVHlwZXNbMF09PT0ianNvbnAiKXtjYWxsYmFja05hbWU9cy5qc29ucENhbGxiYWNrPWpRdWVyeS5pc0Z1bmN0aW9uKHMuanNvbnBDYWxsYmFjayk/cy5qc29ucENhbGxiYWNrKCk6cy5qc29ucENhbGxiYWNrO2lmKGpzb25Qcm9wKXtzW2pzb25Qcm9wXT1zW2pzb25Qcm9wXS5yZXBsYWNlKHJqc29ucCwiJDEiK2NhbGxiYWNrTmFtZSk7fWVsc2UgaWYocy5qc29ucCE9PWZhbHNlKXtzLnVybCs9KHJxdWVyeS50ZXN0KHMudXJsKT8iJiI6Ij8iKStzLmpzb25wKyI9IitjYWxsYmFja05hbWU7fQpzLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl09ZnVuY3Rpb24oKXtpZighcmVzcG9uc2VDb250YWluZXIpe2pRdWVyeS5lcnJvcihjYWxsYmFja05hbWUrIiB3YXMgbm90IGNhbGxlZCIpO30KcmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWzBdO307cy5kYXRhVHlwZXNbMF09Impzb24iO292ZXJ3cml0dGVuPXdpbmRvd1tjYWxsYmFja05hbWVdO3dpbmRvd1tjYWxsYmFja05hbWVdPWZ1bmN0aW9uKCl7cmVzcG9uc2VDb250YWluZXI9YXJndW1lbnRzO307anFYSFIuYWx3YXlzKGZ1bmN0aW9uKCl7d2luZG93W2NhbGxiYWNrTmFtZV09b3ZlcndyaXR0ZW47aWYoc1tjYWxsYmFja05hbWVdKXtzLmpzb25wQ2FsbGJhY2s9b3JpZ2luYWxTZXR0aW5ncy5qc29ucENhbGxiYWNrO29sZENhbGxiYWNrcy5wdXNoKGNhbGxiYWNrTmFtZSk7fQppZihyZXNwb25zZUNvbnRhaW5lciYmalF1ZXJ5LmlzRnVuY3Rpb24ob3ZlcndyaXR0ZW4pKXtvdmVyd3JpdHRlbihyZXNwb25zZUNvbnRhaW5lclswXSk7fQpyZXNwb25zZUNvbnRhaW5lcj1vdmVyd3JpdHRlbj11bmRlZmluZWQ7fSk7cmV0dXJuInNjcmlwdCI7fX0pO2pRdWVyeS5wYXJzZUhUTUw9ZnVuY3Rpb24oZGF0YSxjb250ZXh0LGtlZXBTY3JpcHRzKXtpZighZGF0YXx8dHlwZW9mIGRhdGEhPT0ic3RyaW5nIil7cmV0dXJuIG51bGw7fQppZih0eXBlb2YgY29udGV4dD09PSJib29sZWFuIil7a2VlcFNjcmlwdHM9Y29udGV4dDtjb250ZXh0PWZhbHNlO30KY29udGV4dD1jb250ZXh0fHxkb2N1bWVudDt2YXIgcGFyc2VkPXJzaW5nbGVUYWcuZXhlYyhkYXRhKSxzY3JpcHRzPSFrZWVwU2NyaXB0cyYmW107aWYocGFyc2VkKXtyZXR1cm5bY29udGV4dC5jcmVhdGVFbGVtZW50KHBhcnNlZFsxXSldO30KcGFyc2VkPWpRdWVyeS5idWlsZEZyYWdtZW50KFtkYXRhXSxjb250ZXh0LHNjcmlwdHMpO2lmKHNjcmlwdHMmJnNjcmlwdHMubGVuZ3RoKXtqUXVlcnkoc2NyaXB0cykucmVtb3ZlKCk7fQpyZXR1cm4galF1ZXJ5Lm1lcmdlKFtdLHBhcnNlZC5jaGlsZE5vZGVzKTt9O3ZhciBfbG9hZD1qUXVlcnkuZm4ubG9hZDtqUXVlcnkuZm4ubG9hZD1mdW5jdGlvbih1cmwscGFyYW1zLGNhbGxiYWNrKXtpZih0eXBlb2YgdXJsIT09InN0cmluZyImJl9sb2FkKXtyZXR1cm4gX2xvYWQuYXBwbHkodGhpcyxhcmd1bWVudHMpO30KdmFyIHNlbGVjdG9yLHJlc3BvbnNlLHR5cGUsc2VsZj10aGlzLG9mZj11cmwuaW5kZXhPZigiICIpO2lmKG9mZj49MCl7c2VsZWN0b3I9dXJsLnNsaWNlKG9mZix1cmwubGVuZ3RoKTt1cmw9dXJsLnNsaWNlKDAsb2ZmKTt9CmlmKGpRdWVyeS5pc0Z1bmN0aW9uKHBhcmFtcykpe2NhbGxiYWNrPXBhcmFtcztwYXJhbXM9dW5kZWZpbmVkO31lbHNlIGlmKHBhcmFtcyYmdHlwZW9mIHBhcmFtcz09PSJvYmplY3QiKXt0eXBlPSJQT1NUIjt9CmlmKHNlbGYubGVuZ3RoPjApe2pRdWVyeS5hamF4KHt1cmw6dXJsLHR5cGU6dHlwZSxkYXRhVHlwZToiaHRtbCIsZGF0YTpwYXJhbXN9KS5kb25lKGZ1bmN0aW9uKHJlc3BvbnNlVGV4dCl7cmVzcG9uc2U9YXJndW1lbnRzO3NlbGYuaHRtbChzZWxlY3Rvcj9qUXVlcnkoIjxkaXY+IikuYXBwZW5kKGpRdWVyeS5wYXJzZUhUTUwocmVzcG9uc2VUZXh0KSkuZmluZChzZWxlY3Rvcik6cmVzcG9uc2VUZXh0KTt9KS5jb21wbGV0ZShjYWxsYmFjayYmZnVuY3Rpb24oanFYSFIsc3RhdHVzKXtzZWxmLmVhY2goY2FsbGJhY2sscmVzcG9uc2V8fFtqcVhIUi5yZXNwb25zZVRleHQsc3RhdHVzLGpxWEhSXSk7fSk7fQpyZXR1cm4gdGhpczt9O2pRdWVyeS5leHByLmZpbHRlcnMuYW5pbWF0ZWQ9ZnVuY3Rpb24oZWxlbSl7cmV0dXJuIGpRdWVyeS5ncmVwKGpRdWVyeS50aW1lcnMsZnVuY3Rpb24oZm4pe3JldHVybiBlbGVtPT09Zm4uZWxlbTt9KS5sZW5ndGg7fTt2YXIgZG9jRWxlbT13aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O2Z1bmN0aW9uIGdldFdpbmRvdyhlbGVtKXtyZXR1cm4galF1ZXJ5LmlzV2luZG93KGVsZW0pP2VsZW06ZWxlbS5ub2RlVHlwZT09PTk/ZWxlbS5kZWZhdWx0Vmlld3x8ZWxlbS5wYXJlbnRXaW5kb3c6ZmFsc2U7fQpqUXVlcnkub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oZWxlbSxvcHRpb25zLGkpe3ZhciBjdXJQb3NpdGlvbixjdXJMZWZ0LGN1ckNTU1RvcCxjdXJUb3AsY3VyT2Zmc2V0LGN1ckNTU0xlZnQsY2FsY3VsYXRlUG9zaXRpb24scG9zaXRpb249alF1ZXJ5LmNzcyhlbGVtLCJwb3NpdGlvbiIpLGN1ckVsZW09alF1ZXJ5KGVsZW0pLHByb3BzPXt9O2lmKHBvc2l0aW9uPT09InN0YXRpYyIpe2VsZW0uc3R5bGUucG9zaXRpb249InJlbGF0aXZlIjt9CmN1ck9mZnNldD1jdXJFbGVtLm9mZnNldCgpO2N1ckNTU1RvcD1qUXVlcnkuY3NzKGVsZW0sInRvcCIpO2N1ckNTU0xlZnQ9alF1ZXJ5LmNzcyhlbGVtLCJsZWZ0Iik7Y2FsY3VsYXRlUG9zaXRpb249KHBvc2l0aW9uPT09ImFic29sdXRlInx8cG9zaXRpb249PT0iZml4ZWQiKSYmalF1ZXJ5LmluQXJyYXkoImF1dG8iLFtjdXJDU1NUb3AsY3VyQ1NTTGVmdF0pPi0xO2lmKGNhbGN1bGF0ZVBvc2l0aW9uKXtjdXJQb3NpdGlvbj1jdXJFbGVtLnBvc2l0aW9uKCk7Y3VyVG9wPWN1clBvc2l0aW9uLnRvcDtjdXJMZWZ0PWN1clBvc2l0aW9uLmxlZnQ7fWVsc2V7Y3VyVG9wPXBhcnNlRmxvYXQoY3VyQ1NTVG9wKXx8MDtjdXJMZWZ0PXBhcnNlRmxvYXQoY3VyQ1NTTGVmdCl8fDA7fQppZihqUXVlcnkuaXNGdW5jdGlvbihvcHRpb25zKSl7b3B0aW9ucz1vcHRpb25zLmNhbGwoZWxlbSxpLGN1ck9mZnNldCk7fQppZihvcHRpb25zLnRvcCE9bnVsbCl7cHJvcHMudG9wPShvcHRpb25zLnRvcC1jdXJPZmZzZXQudG9wKStjdXJUb3A7fQppZihvcHRpb25zLmxlZnQhPW51bGwpe3Byb3BzLmxlZnQ9KG9wdGlvbnMubGVmdC1jdXJPZmZzZXQubGVmdCkrY3VyTGVmdDt9CmlmKCJ1c2luZyJpbiBvcHRpb25zKXtvcHRpb25zLnVzaW5nLmNhbGwoZWxlbSxwcm9wcyk7fWVsc2V7Y3VyRWxlbS5jc3MocHJvcHMpO319fTtqUXVlcnkuZm4uZXh0ZW5kKHtvZmZzZXQ6ZnVuY3Rpb24ob3B0aW9ucyl7aWYoYXJndW1lbnRzLmxlbmd0aCl7cmV0dXJuIG9wdGlvbnM9PT11bmRlZmluZWQ/dGhpczp0aGlzLmVhY2goZnVuY3Rpb24oaSl7alF1ZXJ5Lm9mZnNldC5zZXRPZmZzZXQodGhpcyxvcHRpb25zLGkpO30pO30KdmFyIGRvY0VsZW0sd2luLGJveD17dG9wOjAsbGVmdDowfSxlbGVtPXRoaXNbMF0sZG9jPWVsZW0mJmVsZW0ub3duZXJEb2N1bWVudDtpZighZG9jKXtyZXR1cm47fQpkb2NFbGVtPWRvYy5kb2N1bWVudEVsZW1lbnQ7aWYoIWpRdWVyeS5jb250YWlucyhkb2NFbGVtLGVsZW0pKXtyZXR1cm4gYm94O30KaWYodHlwZW9mIGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0IT09c3RydW5kZWZpbmVkKXtib3g9ZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTt9Cndpbj1nZXRXaW5kb3coZG9jKTtyZXR1cm57dG9wOmJveC50b3ArKHdpbi5wYWdlWU9mZnNldHx8ZG9jRWxlbS5zY3JvbGxUb3ApLShkb2NFbGVtLmNsaWVudFRvcHx8MCksbGVmdDpib3gubGVmdCsod2luLnBhZ2VYT2Zmc2V0fHxkb2NFbGVtLnNjcm9sbExlZnQpLShkb2NFbGVtLmNsaWVudExlZnR8fDApfTt9LHBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYoIXRoaXNbMF0pe3JldHVybjt9CnZhciBvZmZzZXRQYXJlbnQsb2Zmc2V0LHBhcmVudE9mZnNldD17dG9wOjAsbGVmdDowfSxlbGVtPXRoaXNbMF07aWYoalF1ZXJ5LmNzcyhlbGVtLCJwb3NpdGlvbiIpPT09ImZpeGVkIil7b2Zmc2V0PWVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7fWVsc2V7b2Zmc2V0UGFyZW50PXRoaXMub2Zmc2V0UGFyZW50KCk7b2Zmc2V0PXRoaXMub2Zmc2V0KCk7aWYoIWpRdWVyeS5ub2RlTmFtZShvZmZzZXRQYXJlbnRbMF0sImh0bWwiKSl7cGFyZW50T2Zmc2V0PW9mZnNldFBhcmVudC5vZmZzZXQoKTt9CnBhcmVudE9mZnNldC50b3ArPWpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50WzBdLCJib3JkZXJUb3BXaWR0aCIsdHJ1ZSk7cGFyZW50T2Zmc2V0LmxlZnQrPWpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50WzBdLCJib3JkZXJMZWZ0V2lkdGgiLHRydWUpO30KcmV0dXJue3RvcDpvZmZzZXQudG9wLXBhcmVudE9mZnNldC50b3AtalF1ZXJ5LmNzcyhlbGVtLCJtYXJnaW5Ub3AiLHRydWUpLGxlZnQ6b2Zmc2V0LmxlZnQtcGFyZW50T2Zmc2V0LmxlZnQtalF1ZXJ5LmNzcyhlbGVtLCJtYXJnaW5MZWZ0Iix0cnVlKX07fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgb2Zmc2V0UGFyZW50PXRoaXMub2Zmc2V0UGFyZW50fHxkb2NFbGVtO3doaWxlKG9mZnNldFBhcmVudCYmKCFqUXVlcnkubm9kZU5hbWUob2Zmc2V0UGFyZW50LCJodG1sIikmJmpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50LCJwb3NpdGlvbiIpPT09InN0YXRpYyIpKXtvZmZzZXRQYXJlbnQ9b2Zmc2V0UGFyZW50Lm9mZnNldFBhcmVudDt9CnJldHVybiBvZmZzZXRQYXJlbnR8fGRvY0VsZW07fSk7fX0pO2pRdWVyeS5lYWNoKHtzY3JvbGxMZWZ0OiJwYWdlWE9mZnNldCIsc2Nyb2xsVG9wOiJwYWdlWU9mZnNldCJ9LGZ1bmN0aW9uKG1ldGhvZCxwcm9wKXt2YXIgdG9wPS9ZLy50ZXN0KHByb3ApO2pRdWVyeS5mblttZXRob2RdPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIGFjY2Vzcyh0aGlzLGZ1bmN0aW9uKGVsZW0sbWV0aG9kLHZhbCl7dmFyIHdpbj1nZXRXaW5kb3coZWxlbSk7aWYodmFsPT09dW5kZWZpbmVkKXtyZXR1cm4gd2luPyhwcm9wIGluIHdpbik/d2luW3Byb3BdOndpbi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbbWV0aG9kXTplbGVtW21ldGhvZF07fQppZih3aW4pe3dpbi5zY3JvbGxUbyghdG9wP3ZhbDpqUXVlcnkod2luKS5zY3JvbGxMZWZ0KCksdG9wP3ZhbDpqUXVlcnkod2luKS5zY3JvbGxUb3AoKSk7fWVsc2V7ZWxlbVttZXRob2RdPXZhbDt9fSxtZXRob2QsdmFsLGFyZ3VtZW50cy5sZW5ndGgsbnVsbCk7fTt9KTtqUXVlcnkuZWFjaChbInRvcCIsImxlZnQiXSxmdW5jdGlvbihpLHByb3Ape2pRdWVyeS5jc3NIb29rc1twcm9wXT1hZGRHZXRIb29rSWYoc3VwcG9ydC5waXhlbFBvc2l0aW9uLGZ1bmN0aW9uKGVsZW0sY29tcHV0ZWQpe2lmKGNvbXB1dGVkKXtjb21wdXRlZD1jdXJDU1MoZWxlbSxwcm9wKTtyZXR1cm4gcm51bW5vbnB4LnRlc3QoY29tcHV0ZWQpP2pRdWVyeShlbGVtKS5wb3NpdGlvbigpW3Byb3BdKyJweCI6Y29tcHV0ZWQ7fX0pO30pO2pRdWVyeS5lYWNoKHtIZWlnaHQ6ImhlaWdodCIsV2lkdGg6IndpZHRoIn0sZnVuY3Rpb24obmFtZSx0eXBlKXtqUXVlcnkuZWFjaCh7cGFkZGluZzoiaW5uZXIiK25hbWUsY29udGVudDp0eXBlLCIiOiJvdXRlciIrbmFtZX0sZnVuY3Rpb24oZGVmYXVsdEV4dHJhLGZ1bmNOYW1lKXtqUXVlcnkuZm5bZnVuY05hbWVdPWZ1bmN0aW9uKG1hcmdpbix2YWx1ZSl7dmFyIGNoYWluYWJsZT1hcmd1bWVudHMubGVuZ3RoJiYoZGVmYXVsdEV4dHJhfHx0eXBlb2YgbWFyZ2luIT09ImJvb2xlYW4iKSxleHRyYT1kZWZhdWx0RXh0cmF8fChtYXJnaW49PT10cnVlfHx2YWx1ZT09PXRydWU/Im1hcmdpbiI6ImJvcmRlciIpO3JldHVybiBhY2Nlc3ModGhpcyxmdW5jdGlvbihlbGVtLHR5cGUsdmFsdWUpe3ZhciBkb2M7aWYoalF1ZXJ5LmlzV2luZG93KGVsZW0pKXtyZXR1cm4gZWxlbS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrbmFtZV07fQppZihlbGVtLm5vZGVUeXBlPT09OSl7ZG9jPWVsZW0uZG9jdW1lbnRFbGVtZW50O3JldHVybiBNYXRoLm1heChlbGVtLmJvZHlbInNjcm9sbCIrbmFtZV0sZG9jWyJzY3JvbGwiK25hbWVdLGVsZW0uYm9keVsib2Zmc2V0IituYW1lXSxkb2NbIm9mZnNldCIrbmFtZV0sZG9jWyJjbGllbnQiK25hbWVdKTt9CnJldHVybiB2YWx1ZT09PXVuZGVmaW5lZD9qUXVlcnkuY3NzKGVsZW0sdHlwZSxleHRyYSk6alF1ZXJ5LnN0eWxlKGVsZW0sdHlwZSx2YWx1ZSxleHRyYSk7fSx0eXBlLGNoYWluYWJsZT9tYXJnaW46dW5kZWZpbmVkLGNoYWluYWJsZSxudWxsKTt9O30pO30pO2pRdWVyeS5mbi5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RoO307alF1ZXJ5LmZuLmFuZFNlbGY9alF1ZXJ5LmZuLmFkZEJhY2s7aWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZSgianF1ZXJ5IixbXSxmdW5jdGlvbigpe3JldHVybiBqUXVlcnk7fSk7fQp2YXIKX2pRdWVyeT13aW5kb3cualF1ZXJ5LF8kPXdpbmRvdy4kO2pRdWVyeS5ub0NvbmZsaWN0PWZ1bmN0aW9uKGRlZXApe2lmKHdpbmRvdy4kPT09alF1ZXJ5KXt3aW5kb3cuJD1fJDt9CmlmKGRlZXAmJndpbmRvdy5qUXVlcnk9PT1qUXVlcnkpe3dpbmRvdy5qUXVlcnk9X2pRdWVyeTt9CnJldHVybiBqUXVlcnk7fTtpZih0eXBlb2Ygbm9HbG9iYWw9PT1zdHJ1bmRlZmluZWQpe3dpbmRvdy5qUXVlcnk9d2luZG93LiQ9alF1ZXJ5O30KcmV0dXJuIGpRdWVyeTt9KSk7KGZ1bmN0aW9uKCQsdW5kZWZpbmVkKXt2YXIgdXVpZD0wLHJ1bmlxdWVJZD0vXnVpLWlkLVxkKyQvOyQudWk9JC51aXx8e307JC5leHRlbmQoJC51aSx7dmVyc2lvbjoiMS4xMC40IixrZXlDb2RlOntCQUNLU1BBQ0U6OCxDT01NQToxODgsREVMRVRFOjQ2LERPV046NDAsRU5EOjM1LEVOVEVSOjEzLEVTQ0FQRToyNyxIT01FOjM2LExFRlQ6MzcsTlVNUEFEX0FERDoxMDcsTlVNUEFEX0RFQ0lNQUw6MTEwLE5VTVBBRF9ESVZJREU6MTExLE5VTVBBRF9FTlRFUjoxMDgsTlVNUEFEX01VTFRJUExZOjEwNixOVU1QQURfU1VCVFJBQ1Q6MTA5LFBBR0VfRE9XTjozNCxQQUdFX1VQOjMzLFBFUklPRDoxOTAsUklHSFQ6MzksU1BBQ0U6MzIsVEFCOjksVVA6Mzh9fSk7JC5mbi5leHRlbmQoe2ZvY3VzOihmdW5jdGlvbihvcmlnKXtyZXR1cm4gZnVuY3Rpb24oZGVsYXksZm4pe3JldHVybiB0eXBlb2YgZGVsYXk9PT0ibnVtYmVyIj90aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgZWxlbT10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXskKGVsZW0pLmZvY3VzKCk7aWYoZm4pe2ZuLmNhbGwoZWxlbSk7fX0sZGVsYXkpO30pOm9yaWcuYXBwbHkodGhpcyxhcmd1bWVudHMpO307fSkoJC5mbi5mb2N1cyksc2Nyb2xsUGFyZW50OmZ1bmN0aW9uKCl7dmFyIHNjcm9sbFBhcmVudDtpZigoJC51aS5pZSYmKC8oc3RhdGljfHJlbGF0aXZlKS8pLnRlc3QodGhpcy5jc3MoInBvc2l0aW9uIikpKXx8KC9hYnNvbHV0ZS8pLnRlc3QodGhpcy5jc3MoInBvc2l0aW9uIikpKXtzY3JvbGxQYXJlbnQ9dGhpcy5wYXJlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuKC8ocmVsYXRpdmV8YWJzb2x1dGV8Zml4ZWQpLykudGVzdCgkLmNzcyh0aGlzLCJwb3NpdGlvbiIpKSYmKC8oYXV0b3xzY3JvbGwpLykudGVzdCgkLmNzcyh0aGlzLCJvdmVyZmxvdyIpKyQuY3NzKHRoaXMsIm92ZXJmbG93LXkiKSskLmNzcyh0aGlzLCJvdmVyZmxvdy14IikpO30pLmVxKDApO31lbHNle3Njcm9sbFBhcmVudD10aGlzLnBhcmVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4oLyhhdXRvfHNjcm9sbCkvKS50ZXN0KCQuY3NzKHRoaXMsIm92ZXJmbG93IikrJC5jc3ModGhpcywib3ZlcmZsb3cteSIpKyQuY3NzKHRoaXMsIm92ZXJmbG93LXgiKSk7fSkuZXEoMCk7fQpyZXR1cm4oL2ZpeGVkLykudGVzdCh0aGlzLmNzcygicG9zaXRpb24iKSl8fCFzY3JvbGxQYXJlbnQubGVuZ3RoPyQoZG9jdW1lbnQpOnNjcm9sbFBhcmVudDt9LHpJbmRleDpmdW5jdGlvbih6SW5kZXgpe2lmKHpJbmRleCE9PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuY3NzKCJ6SW5kZXgiLHpJbmRleCk7fQppZih0aGlzLmxlbmd0aCl7dmFyIGVsZW09JCh0aGlzWzBdKSxwb3NpdGlvbix2YWx1ZTt3aGlsZShlbGVtLmxlbmd0aCYmZWxlbVswXSE9PWRvY3VtZW50KXtwb3NpdGlvbj1lbGVtLmNzcygicG9zaXRpb24iKTtpZihwb3NpdGlvbj09PSJhYnNvbHV0ZSJ8fHBvc2l0aW9uPT09InJlbGF0aXZlInx8cG9zaXRpb249PT0iZml4ZWQiKXt2YWx1ZT1wYXJzZUludChlbGVtLmNzcygiekluZGV4IiksMTApO2lmKCFpc05hTih2YWx1ZSkmJnZhbHVlIT09MCl7cmV0dXJuIHZhbHVlO319CmVsZW09ZWxlbS5wYXJlbnQoKTt9fQpyZXR1cm4gMDt9LHVuaXF1ZUlkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKCF0aGlzLmlkKXt0aGlzLmlkPSJ1aS1pZC0iKygrK3V1aWQpO319KTt9LHJlbW92ZVVuaXF1ZUlkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKHJ1bmlxdWVJZC50ZXN0KHRoaXMuaWQpKXskKHRoaXMpLnJlbW92ZUF0dHIoImlkIik7fX0pO319KTtmdW5jdGlvbiBmb2N1c2FibGUoZWxlbWVudCxpc1RhYkluZGV4Tm90TmFOKXt2YXIgbWFwLG1hcE5hbWUsaW1nLG5vZGVOYW1lPWVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtpZigiYXJlYSI9PT1ub2RlTmFtZSl7bWFwPWVsZW1lbnQucGFyZW50Tm9kZTttYXBOYW1lPW1hcC5uYW1lO2lmKCFlbGVtZW50LmhyZWZ8fCFtYXBOYW1lfHxtYXAubm9kZU5hbWUudG9Mb3dlckNhc2UoKSE9PSJtYXAiKXtyZXR1cm4gZmFsc2U7fQppbWc9JCgiaW1nW3VzZW1hcD0jIittYXBOYW1lKyJdIilbMF07cmV0dXJuISFpbWcmJnZpc2libGUoaW1nKTt9CnJldHVybigvaW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbnxvYmplY3QvLnRlc3Qobm9kZU5hbWUpPyFlbGVtZW50LmRpc2FibGVkOiJhIj09PW5vZGVOYW1lP2VsZW1lbnQuaHJlZnx8aXNUYWJJbmRleE5vdE5hTjppc1RhYkluZGV4Tm90TmFOKSYmdmlzaWJsZShlbGVtZW50KTt9CmZ1bmN0aW9uIHZpc2libGUoZWxlbWVudCl7cmV0dXJuICQuZXhwci5maWx0ZXJzLnZpc2libGUoZWxlbWVudCkmJiEkKGVsZW1lbnQpLnBhcmVudHMoKS5hZGRCYWNrKCkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuICQuY3NzKHRoaXMsInZpc2liaWxpdHkiKT09PSJoaWRkZW4iO30pLmxlbmd0aDt9CiQuZXh0ZW5kKCQuZXhwclsiOiJdLHtkYXRhOiQuZXhwci5jcmVhdGVQc2V1ZG8/JC5leHByLmNyZWF0ZVBzZXVkbyhmdW5jdGlvbihkYXRhTmFtZSl7cmV0dXJuIGZ1bmN0aW9uKGVsZW0pe3JldHVybiEhJC5kYXRhKGVsZW0sZGF0YU5hbWUpO307fSk6ZnVuY3Rpb24oZWxlbSxpLG1hdGNoKXtyZXR1cm4hISQuZGF0YShlbGVtLG1hdGNoWzNdKTt9LGZvY3VzYWJsZTpmdW5jdGlvbihlbGVtZW50KXtyZXR1cm4gZm9jdXNhYmxlKGVsZW1lbnQsIWlzTmFOKCQuYXR0cihlbGVtZW50LCJ0YWJpbmRleCIpKSk7fSx0YWJiYWJsZTpmdW5jdGlvbihlbGVtZW50KXt2YXIgdGFiSW5kZXg9JC5hdHRyKGVsZW1lbnQsInRhYmluZGV4IiksaXNUYWJJbmRleE5hTj1pc05hTih0YWJJbmRleCk7cmV0dXJuKGlzVGFiSW5kZXhOYU58fHRhYkluZGV4Pj0wKSYmZm9jdXNhYmxlKGVsZW1lbnQsIWlzVGFiSW5kZXhOYU4pO319KTtpZighJCgiPGE+Iikub3V0ZXJXaWR0aCgxKS5qcXVlcnkpeyQuZWFjaChbIldpZHRoIiwiSGVpZ2h0Il0sZnVuY3Rpb24oaSxuYW1lKXt2YXIgc2lkZT1uYW1lPT09IldpZHRoIj9bIkxlZnQiLCJSaWdodCJdOlsiVG9wIiwiQm90dG9tIl0sdHlwZT1uYW1lLnRvTG93ZXJDYXNlKCksb3JpZz17aW5uZXJXaWR0aDokLmZuLmlubmVyV2lkdGgsaW5uZXJIZWlnaHQ6JC5mbi5pbm5lckhlaWdodCxvdXRlcldpZHRoOiQuZm4ub3V0ZXJXaWR0aCxvdXRlckhlaWdodDokLmZuLm91dGVySGVpZ2h0fTtmdW5jdGlvbiByZWR1Y2UoZWxlbSxzaXplLGJvcmRlcixtYXJnaW4peyQuZWFjaChzaWRlLGZ1bmN0aW9uKCl7c2l6ZS09cGFyc2VGbG9hdCgkLmNzcyhlbGVtLCJwYWRkaW5nIit0aGlzKSl8fDA7aWYoYm9yZGVyKXtzaXplLT1wYXJzZUZsb2F0KCQuY3NzKGVsZW0sImJvcmRlciIrdGhpcysiV2lkdGgiKSl8fDA7fQppZihtYXJnaW4pe3NpemUtPXBhcnNlRmxvYXQoJC5jc3MoZWxlbSwibWFyZ2luIit0aGlzKSl8fDA7fX0pO3JldHVybiBzaXplO30KJC5mblsiaW5uZXIiK25hbWVdPWZ1bmN0aW9uKHNpemUpe2lmKHNpemU9PT11bmRlZmluZWQpe3JldHVybiBvcmlnWyJpbm5lciIrbmFtZV0uY2FsbCh0aGlzKTt9CnJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXskKHRoaXMpLmNzcyh0eXBlLHJlZHVjZSh0aGlzLHNpemUpKyJweCIpO30pO307JC5mblsib3V0ZXIiK25hbWVdPWZ1bmN0aW9uKHNpemUsbWFyZ2luKXtpZih0eXBlb2Ygc2l6ZSE9PSJudW1iZXIiKXtyZXR1cm4gb3JpZ1sib3V0ZXIiK25hbWVdLmNhbGwodGhpcyxzaXplKTt9CnJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXskKHRoaXMpLmNzcyh0eXBlLHJlZHVjZSh0aGlzLHNpemUsdHJ1ZSxtYXJnaW4pKyJweCIpO30pO307fSk7fQppZighJC5mbi5hZGRCYWNrKXskLmZuLmFkZEJhY2s9ZnVuY3Rpb24oc2VsZWN0b3Ipe3JldHVybiB0aGlzLmFkZChzZWxlY3Rvcj09bnVsbD90aGlzLnByZXZPYmplY3Q6dGhpcy5wcmV2T2JqZWN0LmZpbHRlcihzZWxlY3RvcikpO307fQppZigkKCI8YT4iKS5kYXRhKCJhLWIiLCJhIikucmVtb3ZlRGF0YSgiYS1iIikuZGF0YSgiYS1iIikpeyQuZm4ucmVtb3ZlRGF0YT0oZnVuY3Rpb24ocmVtb3ZlRGF0YSl7cmV0dXJuIGZ1bmN0aW9uKGtleSl7aWYoYXJndW1lbnRzLmxlbmd0aCl7cmV0dXJuIHJlbW92ZURhdGEuY2FsbCh0aGlzLCQuY2FtZWxDYXNlKGtleSkpO31lbHNle3JldHVybiByZW1vdmVEYXRhLmNhbGwodGhpcyk7fX07fSkoJC5mbi5yZW1vdmVEYXRhKTt9CiQudWkuaWU9ISEvbXNpZSBbXHcuXSsvLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKTskLnN1cHBvcnQuc2VsZWN0c3RhcnQ9Im9uc2VsZWN0c3RhcnQiaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7JC5mbi5leHRlbmQoe2Rpc2FibGVTZWxlY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iaW5kKCgkLnN1cHBvcnQuc2VsZWN0c3RhcnQ/InNlbGVjdHN0YXJ0IjoibW91c2Vkb3duIikrIi51aS1kaXNhYmxlU2VsZWN0aW9uIixmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9KTt9LGVuYWJsZVNlbGVjdGlvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnVuYmluZCgiLnVpLWRpc2FibGVTZWxlY3Rpb24iKTt9fSk7JC5leHRlbmQoJC51aSx7cGx1Z2luOnthZGQ6ZnVuY3Rpb24obW9kdWxlLG9wdGlvbixzZXQpe3ZhciBpLHByb3RvPSQudWlbbW9kdWxlXS5wcm90b3R5cGU7Zm9yKGkgaW4gc2V0KXtwcm90by5wbHVnaW5zW2ldPXByb3RvLnBsdWdpbnNbaV18fFtdO3Byb3RvLnBsdWdpbnNbaV0ucHVzaChbb3B0aW9uLHNldFtpXV0pO319LGNhbGw6ZnVuY3Rpb24oaW5zdGFuY2UsbmFtZSxhcmdzKXt2YXIgaSxzZXQ9aW5zdGFuY2UucGx1Z2luc1tuYW1lXTtpZighc2V0fHwhaW5zdGFuY2UuZWxlbWVudFswXS5wYXJlbnROb2RlfHxpbnN0YW5jZS5lbGVtZW50WzBdLnBhcmVudE5vZGUubm9kZVR5cGU9PT0xMSl7cmV0dXJuO30KZm9yKGk9MDtpPHNldC5sZW5ndGg7aSsrKXtpZihpbnN0YW5jZS5vcHRpb25zW3NldFtpXVswXV0pe3NldFtpXVsxXS5hcHBseShpbnN0YW5jZS5lbGVtZW50LGFyZ3MpO319fX0saGFzU2Nyb2xsOmZ1bmN0aW9uKGVsLGEpe2lmKCQoZWwpLmNzcygib3ZlcmZsb3ciKT09PSJoaWRkZW4iKXtyZXR1cm4gZmFsc2U7fQp2YXIgc2Nyb2xsPShhJiZhPT09ImxlZnQiKT8ic2Nyb2xsTGVmdCI6InNjcm9sbFRvcCIsaGFzPWZhbHNlO2lmKGVsW3Njcm9sbF0+MCl7cmV0dXJuIHRydWU7fQplbFtzY3JvbGxdPTE7aGFzPShlbFtzY3JvbGxdPjApO2VsW3Njcm9sbF09MDtyZXR1cm4gaGFzO319KTt9KShqUXVlcnkpOyhmdW5jdGlvbigkLHVuZGVmaW5lZCl7dmFyIHV1aWQ9MCxzbGljZT1BcnJheS5wcm90b3R5cGUuc2xpY2UsX2NsZWFuRGF0YT0kLmNsZWFuRGF0YTskLmNsZWFuRGF0YT1mdW5jdGlvbihlbGVtcyl7Zm9yKHZhciBpPTAsZWxlbTsoZWxlbT1lbGVtc1tpXSkhPW51bGw7aSsrKXt0cnl7JChlbGVtKS50cmlnZ2VySGFuZGxlcigicmVtb3ZlIik7fWNhdGNoKGUpe319Cl9jbGVhbkRhdGEoZWxlbXMpO307JC53aWRnZXQ9ZnVuY3Rpb24obmFtZSxiYXNlLHByb3RvdHlwZSl7dmFyIGZ1bGxOYW1lLGV4aXN0aW5nQ29uc3RydWN0b3IsY29uc3RydWN0b3IsYmFzZVByb3RvdHlwZSxwcm94aWVkUHJvdG90eXBlPXt9LG5hbWVzcGFjZT1uYW1lLnNwbGl0KCIuIilbMF07bmFtZT1uYW1lLnNwbGl0KCIuIilbMV07ZnVsbE5hbWU9bmFtZXNwYWNlKyItIituYW1lO2lmKCFwcm90b3R5cGUpe3Byb3RvdHlwZT1iYXNlO2Jhc2U9JC5XaWRnZXQ7fQokLmV4cHJbIjoiXVtmdWxsTmFtZS50b0xvd2VyQ2FzZSgpXT1mdW5jdGlvbihlbGVtKXtyZXR1cm4hISQuZGF0YShlbGVtLGZ1bGxOYW1lKTt9OyRbbmFtZXNwYWNlXT0kW25hbWVzcGFjZV18fHt9O2V4aXN0aW5nQ29uc3RydWN0b3I9JFtuYW1lc3BhY2VdW25hbWVdO2NvbnN0cnVjdG9yPSRbbmFtZXNwYWNlXVtuYW1lXT1mdW5jdGlvbihvcHRpb25zLGVsZW1lbnQpe2lmKCF0aGlzLl9jcmVhdGVXaWRnZXQpe3JldHVybiBuZXcgY29uc3RydWN0b3Iob3B0aW9ucyxlbGVtZW50KTt9CmlmKGFyZ3VtZW50cy5sZW5ndGgpe3RoaXMuX2NyZWF0ZVdpZGdldChvcHRpb25zLGVsZW1lbnQpO319OyQuZXh0ZW5kKGNvbnN0cnVjdG9yLGV4aXN0aW5nQ29uc3RydWN0b3Ise3ZlcnNpb246cHJvdG90eXBlLnZlcnNpb24sX3Byb3RvOiQuZXh0ZW5kKHt9LHByb3RvdHlwZSksX2NoaWxkQ29uc3RydWN0b3JzOltdfSk7YmFzZVByb3RvdHlwZT1uZXcgYmFzZSgpO2Jhc2VQcm90b3R5cGUub3B0aW9ucz0kLndpZGdldC5leHRlbmQoe30sYmFzZVByb3RvdHlwZS5vcHRpb25zKTskLmVhY2gocHJvdG90eXBlLGZ1bmN0aW9uKHByb3AsdmFsdWUpe2lmKCEkLmlzRnVuY3Rpb24odmFsdWUpKXtwcm94aWVkUHJvdG90eXBlW3Byb3BdPXZhbHVlO3JldHVybjt9CnByb3hpZWRQcm90b3R5cGVbcHJvcF09KGZ1bmN0aW9uKCl7dmFyIF9zdXBlcj1mdW5jdGlvbigpe3JldHVybiBiYXNlLnByb3RvdHlwZVtwcm9wXS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fSxfc3VwZXJBcHBseT1mdW5jdGlvbihhcmdzKXtyZXR1cm4gYmFzZS5wcm90b3R5cGVbcHJvcF0uYXBwbHkodGhpcyxhcmdzKTt9O3JldHVybiBmdW5jdGlvbigpe3ZhciBfX3N1cGVyPXRoaXMuX3N1cGVyLF9fc3VwZXJBcHBseT10aGlzLl9zdXBlckFwcGx5LHJldHVyblZhbHVlO3RoaXMuX3N1cGVyPV9zdXBlcjt0aGlzLl9zdXBlckFwcGx5PV9zdXBlckFwcGx5O3JldHVyblZhbHVlPXZhbHVlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9zdXBlcj1fX3N1cGVyO3RoaXMuX3N1cGVyQXBwbHk9X19zdXBlckFwcGx5O3JldHVybiByZXR1cm5WYWx1ZTt9O30pKCk7fSk7Y29uc3RydWN0b3IucHJvdG90eXBlPSQud2lkZ2V0LmV4dGVuZChiYXNlUHJvdG90eXBlLHt3aWRnZXRFdmVudFByZWZpeDpleGlzdGluZ0NvbnN0cnVjdG9yPyhiYXNlUHJvdG90eXBlLndpZGdldEV2ZW50UHJlZml4fHxuYW1lKTpuYW1lfSxwcm94aWVkUHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjpjb25zdHJ1Y3RvcixuYW1lc3BhY2U6bmFtZXNwYWNlLHdpZGdldE5hbWU6bmFtZSx3aWRnZXRGdWxsTmFtZTpmdWxsTmFtZX0pO2lmKGV4aXN0aW5nQ29uc3RydWN0b3IpeyQuZWFjaChleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycyxmdW5jdGlvbihpLGNoaWxkKXt2YXIgY2hpbGRQcm90b3R5cGU9Y2hpbGQucHJvdG90eXBlOyQud2lkZ2V0KGNoaWxkUHJvdG90eXBlLm5hbWVzcGFjZSsiLiIrY2hpbGRQcm90b3R5cGUud2lkZ2V0TmFtZSxjb25zdHJ1Y3RvcixjaGlsZC5fcHJvdG8pO30pO2RlbGV0ZSBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9yczt9ZWxzZXtiYXNlLl9jaGlsZENvbnN0cnVjdG9ycy5wdXNoKGNvbnN0cnVjdG9yKTt9CiQud2lkZ2V0LmJyaWRnZShuYW1lLGNvbnN0cnVjdG9yKTt9OyQud2lkZ2V0LmV4dGVuZD1mdW5jdGlvbih0YXJnZXQpe3ZhciBpbnB1dD1zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxpbnB1dEluZGV4PTAsaW5wdXRMZW5ndGg9aW5wdXQubGVuZ3RoLGtleSx2YWx1ZTtmb3IoO2lucHV0SW5kZXg8aW5wdXRMZW5ndGg7aW5wdXRJbmRleCsrKXtmb3Ioa2V5IGluIGlucHV0W2lucHV0SW5kZXhdKXt2YWx1ZT1pbnB1dFtpbnB1dEluZGV4XVtrZXldO2lmKGlucHV0W2lucHV0SW5kZXhdLmhhc093blByb3BlcnR5KGtleSkmJnZhbHVlIT09dW5kZWZpbmVkKXtpZigkLmlzUGxhaW5PYmplY3QodmFsdWUpKXt0YXJnZXRba2V5XT0kLmlzUGxhaW5PYmplY3QodGFyZ2V0W2tleV0pPyQud2lkZ2V0LmV4dGVuZCh7fSx0YXJnZXRba2V5XSx2YWx1ZSk6JC53aWRnZXQuZXh0ZW5kKHt9LHZhbHVlKTt9ZWxzZXt0YXJnZXRba2V5XT12YWx1ZTt9fX19CnJldHVybiB0YXJnZXQ7fTskLndpZGdldC5icmlkZ2U9ZnVuY3Rpb24obmFtZSxvYmplY3Qpe3ZhciBmdWxsTmFtZT1vYmplY3QucHJvdG90eXBlLndpZGdldEZ1bGxOYW1lfHxuYW1lOyQuZm5bbmFtZV09ZnVuY3Rpb24ob3B0aW9ucyl7dmFyIGlzTWV0aG9kQ2FsbD10eXBlb2Ygb3B0aW9ucz09PSJzdHJpbmciLGFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMsMSkscmV0dXJuVmFsdWU9dGhpcztvcHRpb25zPSFpc01ldGhvZENhbGwmJmFyZ3MubGVuZ3RoPyQud2lkZ2V0LmV4dGVuZC5hcHBseShudWxsLFtvcHRpb25zXS5jb25jYXQoYXJncykpOm9wdGlvbnM7aWYoaXNNZXRob2RDYWxsKXt0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgbWV0aG9kVmFsdWUsaW5zdGFuY2U9JC5kYXRhKHRoaXMsZnVsbE5hbWUpO2lmKCFpbnN0YW5jZSl7cmV0dXJuICQuZXJyb3IoImNhbm5vdCBjYWxsIG1ldGhvZHMgb24gIituYW1lKyIgcHJpb3IgdG8gaW5pdGlhbGl6YXRpb247ICIrImF0dGVtcHRlZCB0byBjYWxsIG1ldGhvZCAnIitvcHRpb25zKyInIik7fQppZighJC5pc0Z1bmN0aW9uKGluc3RhbmNlW29wdGlvbnNdKXx8b3B0aW9ucy5jaGFyQXQoMCk9PT0iXyIpe3JldHVybiAkLmVycm9yKCJubyBzdWNoIG1ldGhvZCAnIitvcHRpb25zKyInIGZvciAiK25hbWUrIiB3aWRnZXQgaW5zdGFuY2UiKTt9Cm1ldGhvZFZhbHVlPWluc3RhbmNlW29wdGlvbnNdLmFwcGx5KGluc3RhbmNlLGFyZ3MpO2lmKG1ldGhvZFZhbHVlIT09aW5zdGFuY2UmJm1ldGhvZFZhbHVlIT09dW5kZWZpbmVkKXtyZXR1cm5WYWx1ZT1tZXRob2RWYWx1ZSYmbWV0aG9kVmFsdWUuanF1ZXJ5P3JldHVyblZhbHVlLnB1c2hTdGFjayhtZXRob2RWYWx1ZS5nZXQoKSk6bWV0aG9kVmFsdWU7cmV0dXJuIGZhbHNlO319KTt9ZWxzZXt0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgaW5zdGFuY2U9JC5kYXRhKHRoaXMsZnVsbE5hbWUpO2lmKGluc3RhbmNlKXtpbnN0YW5jZS5vcHRpb24ob3B0aW9uc3x8e30pLl9pbml0KCk7fWVsc2V7JC5kYXRhKHRoaXMsZnVsbE5hbWUsbmV3IG9iamVjdChvcHRpb25zLHRoaXMpKTt9fSk7fQpyZXR1cm4gcmV0dXJuVmFsdWU7fTt9OyQuV2lkZ2V0PWZ1bmN0aW9uKCl7fTskLldpZGdldC5fY2hpbGRDb25zdHJ1Y3RvcnM9W107JC5XaWRnZXQucHJvdG90eXBlPXt3aWRnZXROYW1lOiJ3aWRnZXQiLHdpZGdldEV2ZW50UHJlZml4OiIiLGRlZmF1bHRFbGVtZW50OiI8ZGl2PiIsb3B0aW9uczp7ZGlzYWJsZWQ6ZmFsc2UsY3JlYXRlOm51bGx9LF9jcmVhdGVXaWRnZXQ6ZnVuY3Rpb24ob3B0aW9ucyxlbGVtZW50KXtlbGVtZW50PSQoZWxlbWVudHx8dGhpcy5kZWZhdWx0RWxlbWVudHx8dGhpcylbMF07dGhpcy5lbGVtZW50PSQoZWxlbWVudCk7dGhpcy51dWlkPXV1aWQrKzt0aGlzLmV2ZW50TmFtZXNwYWNlPSIuIit0aGlzLndpZGdldE5hbWUrdGhpcy51dWlkO3RoaXMub3B0aW9ucz0kLndpZGdldC5leHRlbmQoe30sdGhpcy5vcHRpb25zLHRoaXMuX2dldENyZWF0ZU9wdGlvbnMoKSxvcHRpb25zKTt0aGlzLmJpbmRpbmdzPSQoKTt0aGlzLmhvdmVyYWJsZT0kKCk7dGhpcy5mb2N1c2FibGU9JCgpO2lmKGVsZW1lbnQhPT10aGlzKXskLmRhdGEoZWxlbWVudCx0aGlzLndpZGdldEZ1bGxOYW1lLHRoaXMpO3RoaXMuX29uKHRydWUsdGhpcy5lbGVtZW50LHtyZW1vdmU6ZnVuY3Rpb24oZXZlbnQpe2lmKGV2ZW50LnRhcmdldD09PWVsZW1lbnQpe3RoaXMuZGVzdHJveSgpO319fSk7dGhpcy5kb2N1bWVudD0kKGVsZW1lbnQuc3R5bGU/ZWxlbWVudC5vd25lckRvY3VtZW50OmVsZW1lbnQuZG9jdW1lbnR8fGVsZW1lbnQpO3RoaXMud2luZG93PSQodGhpcy5kb2N1bWVudFswXS5kZWZhdWx0Vmlld3x8dGhpcy5kb2N1bWVudFswXS5wYXJlbnRXaW5kb3cpO30KdGhpcy5fY3JlYXRlKCk7dGhpcy5fdHJpZ2dlcigiY3JlYXRlIixudWxsLHRoaXMuX2dldENyZWF0ZUV2ZW50RGF0YSgpKTt0aGlzLl9pbml0KCk7fSxfZ2V0Q3JlYXRlT3B0aW9uczokLm5vb3AsX2dldENyZWF0ZUV2ZW50RGF0YTokLm5vb3AsX2NyZWF0ZTokLm5vb3AsX2luaXQ6JC5ub29wLGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLl9kZXN0cm95KCk7dGhpcy5lbGVtZW50LnVuYmluZCh0aGlzLmV2ZW50TmFtZXNwYWNlKS5yZW1vdmVEYXRhKHRoaXMud2lkZ2V0TmFtZSkucmVtb3ZlRGF0YSh0aGlzLndpZGdldEZ1bGxOYW1lKS5yZW1vdmVEYXRhKCQuY2FtZWxDYXNlKHRoaXMud2lkZ2V0RnVsbE5hbWUpKTt0aGlzLndpZGdldCgpLnVuYmluZCh0aGlzLmV2ZW50TmFtZXNwYWNlKS5yZW1vdmVBdHRyKCJhcmlhLWRpc2FibGVkIikucmVtb3ZlQ2xhc3ModGhpcy53aWRnZXRGdWxsTmFtZSsiLWRpc2FibGVkICIrInVpLXN0YXRlLWRpc2FibGVkIik7dGhpcy5iaW5kaW5ncy51bmJpbmQodGhpcy5ldmVudE5hbWVzcGFjZSk7dGhpcy5ob3ZlcmFibGUucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWhvdmVyIik7dGhpcy5mb2N1c2FibGUucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWZvY3VzIik7fSxfZGVzdHJveTokLm5vb3Asd2lkZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudDt9LG9wdGlvbjpmdW5jdGlvbihrZXksdmFsdWUpe3ZhciBvcHRpb25zPWtleSxwYXJ0cyxjdXJPcHRpb24saTtpZihhcmd1bWVudHMubGVuZ3RoPT09MCl7cmV0dXJuICQud2lkZ2V0LmV4dGVuZCh7fSx0aGlzLm9wdGlvbnMpO30KaWYodHlwZW9mIGtleT09PSJzdHJpbmciKXtvcHRpb25zPXt9O3BhcnRzPWtleS5zcGxpdCgiLiIpO2tleT1wYXJ0cy5zaGlmdCgpO2lmKHBhcnRzLmxlbmd0aCl7Y3VyT3B0aW9uPW9wdGlvbnNba2V5XT0kLndpZGdldC5leHRlbmQoe30sdGhpcy5vcHRpb25zW2tleV0pO2ZvcihpPTA7aTxwYXJ0cy5sZW5ndGgtMTtpKyspe2N1ck9wdGlvbltwYXJ0c1tpXV09Y3VyT3B0aW9uW3BhcnRzW2ldXXx8e307Y3VyT3B0aW9uPWN1ck9wdGlvbltwYXJ0c1tpXV07fQprZXk9cGFydHMucG9wKCk7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiBjdXJPcHRpb25ba2V5XT09PXVuZGVmaW5lZD9udWxsOmN1ck9wdGlvbltrZXldO30KY3VyT3B0aW9uW2tleV09dmFsdWU7fWVsc2V7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLm9wdGlvbnNba2V5XT09PXVuZGVmaW5lZD9udWxsOnRoaXMub3B0aW9uc1trZXldO30Kb3B0aW9uc1trZXldPXZhbHVlO319CnRoaXMuX3NldE9wdGlvbnMob3B0aW9ucyk7cmV0dXJuIHRoaXM7fSxfc2V0T3B0aW9uczpmdW5jdGlvbihvcHRpb25zKXt2YXIga2V5O2ZvcihrZXkgaW4gb3B0aW9ucyl7dGhpcy5fc2V0T3B0aW9uKGtleSxvcHRpb25zW2tleV0pO30KcmV0dXJuIHRoaXM7fSxfc2V0T3B0aW9uOmZ1bmN0aW9uKGtleSx2YWx1ZSl7dGhpcy5vcHRpb25zW2tleV09dmFsdWU7aWYoa2V5PT09ImRpc2FibGVkIil7dGhpcy53aWRnZXQoKS50b2dnbGVDbGFzcyh0aGlzLndpZGdldEZ1bGxOYW1lKyItZGlzYWJsZWQgdWktc3RhdGUtZGlzYWJsZWQiLCEhdmFsdWUpLmF0dHIoImFyaWEtZGlzYWJsZWQiLHZhbHVlKTt0aGlzLmhvdmVyYWJsZS5yZW1vdmVDbGFzcygidWktc3RhdGUtaG92ZXIiKTt0aGlzLmZvY3VzYWJsZS5yZW1vdmVDbGFzcygidWktc3RhdGUtZm9jdXMiKTt9CnJldHVybiB0aGlzO30sZW5hYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NldE9wdGlvbigiZGlzYWJsZWQiLGZhbHNlKTt9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2V0T3B0aW9uKCJkaXNhYmxlZCIsdHJ1ZSk7fSxfb246ZnVuY3Rpb24oc3VwcHJlc3NEaXNhYmxlZENoZWNrLGVsZW1lbnQsaGFuZGxlcnMpe3ZhciBkZWxlZ2F0ZUVsZW1lbnQsaW5zdGFuY2U9dGhpcztpZih0eXBlb2Ygc3VwcHJlc3NEaXNhYmxlZENoZWNrIT09ImJvb2xlYW4iKXtoYW5kbGVycz1lbGVtZW50O2VsZW1lbnQ9c3VwcHJlc3NEaXNhYmxlZENoZWNrO3N1cHByZXNzRGlzYWJsZWRDaGVjaz1mYWxzZTt9CmlmKCFoYW5kbGVycyl7aGFuZGxlcnM9ZWxlbWVudDtlbGVtZW50PXRoaXMuZWxlbWVudDtkZWxlZ2F0ZUVsZW1lbnQ9dGhpcy53aWRnZXQoKTt9ZWxzZXtlbGVtZW50PWRlbGVnYXRlRWxlbWVudD0kKGVsZW1lbnQpO3RoaXMuYmluZGluZ3M9dGhpcy5iaW5kaW5ncy5hZGQoZWxlbWVudCk7fQokLmVhY2goaGFuZGxlcnMsZnVuY3Rpb24oZXZlbnQsaGFuZGxlcil7ZnVuY3Rpb24gaGFuZGxlclByb3h5KCl7aWYoIXN1cHByZXNzRGlzYWJsZWRDaGVjayYmKGluc3RhbmNlLm9wdGlvbnMuZGlzYWJsZWQ9PT10cnVlfHwkKHRoaXMpLmhhc0NsYXNzKCJ1aS1zdGF0ZS1kaXNhYmxlZCIpKSl7cmV0dXJuO30KcmV0dXJuKHR5cGVvZiBoYW5kbGVyPT09InN0cmluZyI/aW5zdGFuY2VbaGFuZGxlcl06aGFuZGxlcikuYXBwbHkoaW5zdGFuY2UsYXJndW1lbnRzKTt9CmlmKHR5cGVvZiBoYW5kbGVyIT09InN0cmluZyIpe2hhbmRsZXJQcm94eS5ndWlkPWhhbmRsZXIuZ3VpZD1oYW5kbGVyLmd1aWR8fGhhbmRsZXJQcm94eS5ndWlkfHwkLmd1aWQrKzt9CnZhciBtYXRjaD1ldmVudC5tYXRjaCgvXihcdyspXHMqKC4qKSQvKSxldmVudE5hbWU9bWF0Y2hbMV0raW5zdGFuY2UuZXZlbnROYW1lc3BhY2Usc2VsZWN0b3I9bWF0Y2hbMl07aWYoc2VsZWN0b3Ipe2RlbGVnYXRlRWxlbWVudC5kZWxlZ2F0ZShzZWxlY3RvcixldmVudE5hbWUsaGFuZGxlclByb3h5KTt9ZWxzZXtlbGVtZW50LmJpbmQoZXZlbnROYW1lLGhhbmRsZXJQcm94eSk7fX0pO30sX29mZjpmdW5jdGlvbihlbGVtZW50LGV2ZW50TmFtZSl7ZXZlbnROYW1lPShldmVudE5hbWV8fCIiKS5zcGxpdCgiICIpLmpvaW4odGhpcy5ldmVudE5hbWVzcGFjZSsiICIpK3RoaXMuZXZlbnROYW1lc3BhY2U7ZWxlbWVudC51bmJpbmQoZXZlbnROYW1lKS51bmRlbGVnYXRlKGV2ZW50TmFtZSk7fSxfZGVsYXk6ZnVuY3Rpb24oaGFuZGxlcixkZWxheSl7ZnVuY3Rpb24gaGFuZGxlclByb3h5KCl7cmV0dXJuKHR5cGVvZiBoYW5kbGVyPT09InN0cmluZyI/aW5zdGFuY2VbaGFuZGxlcl06aGFuZGxlcikuYXBwbHkoaW5zdGFuY2UsYXJndW1lbnRzKTt9CnZhciBpbnN0YW5jZT10aGlzO3JldHVybiBzZXRUaW1lb3V0KGhhbmRsZXJQcm94eSxkZWxheXx8MCk7fSxfaG92ZXJhYmxlOmZ1bmN0aW9uKGVsZW1lbnQpe3RoaXMuaG92ZXJhYmxlPXRoaXMuaG92ZXJhYmxlLmFkZChlbGVtZW50KTt0aGlzLl9vbihlbGVtZW50LHttb3VzZWVudGVyOmZ1bmN0aW9uKGV2ZW50KXskKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmFkZENsYXNzKCJ1aS1zdGF0ZS1ob3ZlciIpO30sbW91c2VsZWF2ZTpmdW5jdGlvbihldmVudCl7JChldmVudC5jdXJyZW50VGFyZ2V0KS5yZW1vdmVDbGFzcygidWktc3RhdGUtaG92ZXIiKTt9fSk7fSxfZm9jdXNhYmxlOmZ1bmN0aW9uKGVsZW1lbnQpe3RoaXMuZm9jdXNhYmxlPXRoaXMuZm9jdXNhYmxlLmFkZChlbGVtZW50KTt0aGlzLl9vbihlbGVtZW50LHtmb2N1c2luOmZ1bmN0aW9uKGV2ZW50KXskKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmFkZENsYXNzKCJ1aS1zdGF0ZS1mb2N1cyIpO30sZm9jdXNvdXQ6ZnVuY3Rpb24oZXZlbnQpeyQoZXZlbnQuY3VycmVudFRhcmdldCkucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWZvY3VzIik7fX0pO30sX3RyaWdnZXI6ZnVuY3Rpb24odHlwZSxldmVudCxkYXRhKXt2YXIgcHJvcCxvcmlnLGNhbGxiYWNrPXRoaXMub3B0aW9uc1t0eXBlXTtkYXRhPWRhdGF8fHt9O2V2ZW50PSQuRXZlbnQoZXZlbnQpO2V2ZW50LnR5cGU9KHR5cGU9PT10aGlzLndpZGdldEV2ZW50UHJlZml4P3R5cGU6dGhpcy53aWRnZXRFdmVudFByZWZpeCt0eXBlKS50b0xvd2VyQ2FzZSgpO2V2ZW50LnRhcmdldD10aGlzLmVsZW1lbnRbMF07b3JpZz1ldmVudC5vcmlnaW5hbEV2ZW50O2lmKG9yaWcpe2Zvcihwcm9wIGluIG9yaWcpe2lmKCEocHJvcCBpbiBldmVudCkpe2V2ZW50W3Byb3BdPW9yaWdbcHJvcF07fX19CnRoaXMuZWxlbWVudC50cmlnZ2VyKGV2ZW50LGRhdGEpO3JldHVybiEoJC5pc0Z1bmN0aW9uKGNhbGxiYWNrKSYmY2FsbGJhY2suYXBwbHkodGhpcy5lbGVtZW50WzBdLFtldmVudF0uY29uY2F0KGRhdGEpKT09PWZhbHNlfHxldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSk7fX07JC5lYWNoKHtzaG93OiJmYWRlSW4iLGhpZGU6ImZhZGVPdXQifSxmdW5jdGlvbihtZXRob2QsZGVmYXVsdEVmZmVjdCl7JC5XaWRnZXQucHJvdG90eXBlWyJfIittZXRob2RdPWZ1bmN0aW9uKGVsZW1lbnQsb3B0aW9ucyxjYWxsYmFjayl7aWYodHlwZW9mIG9wdGlvbnM9PT0ic3RyaW5nIil7b3B0aW9ucz17ZWZmZWN0Om9wdGlvbnN9O30KdmFyIGhhc09wdGlvbnMsZWZmZWN0TmFtZT0hb3B0aW9ucz9tZXRob2Q6b3B0aW9ucz09PXRydWV8fHR5cGVvZiBvcHRpb25zPT09Im51bWJlciI/ZGVmYXVsdEVmZmVjdDpvcHRpb25zLmVmZmVjdHx8ZGVmYXVsdEVmZmVjdDtvcHRpb25zPW9wdGlvbnN8fHt9O2lmKHR5cGVvZiBvcHRpb25zPT09Im51bWJlciIpe29wdGlvbnM9e2R1cmF0aW9uOm9wdGlvbnN9O30KaGFzT3B0aW9ucz0hJC5pc0VtcHR5T2JqZWN0KG9wdGlvbnMpO29wdGlvbnMuY29tcGxldGU9Y2FsbGJhY2s7aWYob3B0aW9ucy5kZWxheSl7ZWxlbWVudC5kZWxheShvcHRpb25zLmRlbGF5KTt9CmlmKGhhc09wdGlvbnMmJiQuZWZmZWN0cyYmJC5lZmZlY3RzLmVmZmVjdFtlZmZlY3ROYW1lXSl7ZWxlbWVudFttZXRob2RdKG9wdGlvbnMpO31lbHNlIGlmKGVmZmVjdE5hbWUhPT1tZXRob2QmJmVsZW1lbnRbZWZmZWN0TmFtZV0pe2VsZW1lbnRbZWZmZWN0TmFtZV0ob3B0aW9ucy5kdXJhdGlvbixvcHRpb25zLmVhc2luZyxjYWxsYmFjayk7fWVsc2V7ZWxlbWVudC5xdWV1ZShmdW5jdGlvbihuZXh0KXskKHRoaXMpW21ldGhvZF0oKTtpZihjYWxsYmFjayl7Y2FsbGJhY2suY2FsbChlbGVtZW50WzBdKTt9Cm5leHQoKTt9KTt9fTt9KTt9KShqUXVlcnkpOyhmdW5jdGlvbigkLHVuZGVmaW5lZCl7JC51aT0kLnVpfHx7fTt2YXIgY2FjaGVkU2Nyb2xsYmFyV2lkdGgsbWF4PU1hdGgubWF4LGFicz1NYXRoLmFicyxyb3VuZD1NYXRoLnJvdW5kLHJob3Jpem9udGFsPS9sZWZ0fGNlbnRlcnxyaWdodC8scnZlcnRpY2FsPS90b3B8Y2VudGVyfGJvdHRvbS8scm9mZnNldD0vW1wrXC1dXGQrKFwuW1xkXSspPyU/LyxycG9zaXRpb249L15cdysvLHJwZXJjZW50PS8lJC8sX3Bvc2l0aW9uPSQuZm4ucG9zaXRpb247ZnVuY3Rpb24gZ2V0T2Zmc2V0cyhvZmZzZXRzLHdpZHRoLGhlaWdodCl7cmV0dXJuW3BhcnNlRmxvYXQob2Zmc2V0c1swXSkqKHJwZXJjZW50LnRlc3Qob2Zmc2V0c1swXSk/d2lkdGgvMTAwOjEpLHBhcnNlRmxvYXQob2Zmc2V0c1sxXSkqKHJwZXJjZW50LnRlc3Qob2Zmc2V0c1sxXSk/aGVpZ2h0LzEwMDoxKV07fQpmdW5jdGlvbiBwYXJzZUNzcyhlbGVtZW50LHByb3BlcnR5KXtyZXR1cm4gcGFyc2VJbnQoJC5jc3MoZWxlbWVudCxwcm9wZXJ0eSksMTApfHwwO30KZnVuY3Rpb24gZ2V0RGltZW5zaW9ucyhlbGVtKXt2YXIgcmF3PWVsZW1bMF07aWYocmF3Lm5vZGVUeXBlPT09OSl7cmV0dXJue3dpZHRoOmVsZW0ud2lkdGgoKSxoZWlnaHQ6ZWxlbS5oZWlnaHQoKSxvZmZzZXQ6e3RvcDowLGxlZnQ6MH19O30KaWYoJC5pc1dpbmRvdyhyYXcpKXtyZXR1cm57d2lkdGg6ZWxlbS53aWR0aCgpLGhlaWdodDplbGVtLmhlaWdodCgpLG9mZnNldDp7dG9wOmVsZW0uc2Nyb2xsVG9wKCksbGVmdDplbGVtLnNjcm9sbExlZnQoKX19O30KaWYocmF3LnByZXZlbnREZWZhdWx0KXtyZXR1cm57d2lkdGg6MCxoZWlnaHQ6MCxvZmZzZXQ6e3RvcDpyYXcucGFnZVksbGVmdDpyYXcucGFnZVh9fTt9CnJldHVybnt3aWR0aDplbGVtLm91dGVyV2lkdGgoKSxoZWlnaHQ6ZWxlbS5vdXRlckhlaWdodCgpLG9mZnNldDplbGVtLm9mZnNldCgpfTt9CiQucG9zaXRpb249e3Njcm9sbGJhcldpZHRoOmZ1bmN0aW9uKCl7aWYoY2FjaGVkU2Nyb2xsYmFyV2lkdGghPT11bmRlZmluZWQpe3JldHVybiBjYWNoZWRTY3JvbGxiYXJXaWR0aDt9CnZhciB3MSx3MixkaXY9JCgiPGRpdiBzdHlsZT0nZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDo1MHB4O2hlaWdodDo1MHB4O292ZXJmbG93OmhpZGRlbjsnPjxkaXYgc3R5bGU9J2hlaWdodDoxMDBweDt3aWR0aDphdXRvOyc+PC9kaXY+PC9kaXY+IiksaW5uZXJEaXY9ZGl2LmNoaWxkcmVuKClbMF07JCgiYm9keSIpLmFwcGVuZChkaXYpO3cxPWlubmVyRGl2Lm9mZnNldFdpZHRoO2Rpdi5jc3MoIm92ZXJmbG93Iiwic2Nyb2xsIik7dzI9aW5uZXJEaXYub2Zmc2V0V2lkdGg7aWYodzE9PT13Mil7dzI9ZGl2WzBdLmNsaWVudFdpZHRoO30KZGl2LnJlbW92ZSgpO3JldHVybihjYWNoZWRTY3JvbGxiYXJXaWR0aD13MS13Mik7fSxnZXRTY3JvbGxJbmZvOmZ1bmN0aW9uKHdpdGhpbil7dmFyIG92ZXJmbG93WD13aXRoaW4uaXNXaW5kb3d8fHdpdGhpbi5pc0RvY3VtZW50PyIiOndpdGhpbi5lbGVtZW50LmNzcygib3ZlcmZsb3cteCIpLG92ZXJmbG93WT13aXRoaW4uaXNXaW5kb3d8fHdpdGhpbi5pc0RvY3VtZW50PyIiOndpdGhpbi5lbGVtZW50LmNzcygib3ZlcmZsb3cteSIpLGhhc092ZXJmbG93WD1vdmVyZmxvd1g9PT0ic2Nyb2xsInx8KG92ZXJmbG93WD09PSJhdXRvIiYmd2l0aGluLndpZHRoPHdpdGhpbi5lbGVtZW50WzBdLnNjcm9sbFdpZHRoKSxoYXNPdmVyZmxvd1k9b3ZlcmZsb3dZPT09InNjcm9sbCJ8fChvdmVyZmxvd1k9PT0iYXV0byImJndpdGhpbi5oZWlnaHQ8d2l0aGluLmVsZW1lbnRbMF0uc2Nyb2xsSGVpZ2h0KTtyZXR1cm57d2lkdGg6aGFzT3ZlcmZsb3dZPyQucG9zaXRpb24uc2Nyb2xsYmFyV2lkdGgoKTowLGhlaWdodDpoYXNPdmVyZmxvd1g/JC5wb3NpdGlvbi5zY3JvbGxiYXJXaWR0aCgpOjB9O30sZ2V0V2l0aGluSW5mbzpmdW5jdGlvbihlbGVtZW50KXt2YXIgd2l0aGluRWxlbWVudD0kKGVsZW1lbnR8fHdpbmRvdyksaXNXaW5kb3c9JC5pc1dpbmRvdyh3aXRoaW5FbGVtZW50WzBdKSxpc0RvY3VtZW50PSEhd2l0aGluRWxlbWVudFswXSYmd2l0aGluRWxlbWVudFswXS5ub2RlVHlwZT09PTk7cmV0dXJue2VsZW1lbnQ6d2l0aGluRWxlbWVudCxpc1dpbmRvdzppc1dpbmRvdyxpc0RvY3VtZW50OmlzRG9jdW1lbnQsb2Zmc2V0OndpdGhpbkVsZW1lbnQub2Zmc2V0KCl8fHtsZWZ0OjAsdG9wOjB9LHNjcm9sbExlZnQ6d2l0aGluRWxlbWVudC5zY3JvbGxMZWZ0KCksc2Nyb2xsVG9wOndpdGhpbkVsZW1lbnQuc2Nyb2xsVG9wKCksd2lkdGg6aXNXaW5kb3c/d2l0aGluRWxlbWVudC53aWR0aCgpOndpdGhpbkVsZW1lbnQub3V0ZXJXaWR0aCgpLGhlaWdodDppc1dpbmRvdz93aXRoaW5FbGVtZW50LmhlaWdodCgpOndpdGhpbkVsZW1lbnQub3V0ZXJIZWlnaHQoKX07fX07JC5mbi5wb3NpdGlvbj1mdW5jdGlvbihvcHRpb25zKXtpZighb3B0aW9uc3x8IW9wdGlvbnMub2Ype3JldHVybiBfcG9zaXRpb24uYXBwbHkodGhpcyxhcmd1bWVudHMpO30Kb3B0aW9ucz0kLmV4dGVuZCh7fSxvcHRpb25zKTt2YXIgYXRPZmZzZXQsdGFyZ2V0V2lkdGgsdGFyZ2V0SGVpZ2h0LHRhcmdldE9mZnNldCxiYXNlUG9zaXRpb24sZGltZW5zaW9ucyx0YXJnZXQ9JChvcHRpb25zLm9mKSx3aXRoaW49JC5wb3NpdGlvbi5nZXRXaXRoaW5JbmZvKG9wdGlvbnMud2l0aGluKSxzY3JvbGxJbmZvPSQucG9zaXRpb24uZ2V0U2Nyb2xsSW5mbyh3aXRoaW4pLGNvbGxpc2lvbj0ob3B0aW9ucy5jb2xsaXNpb258fCJmbGlwIikuc3BsaXQoIiAiKSxvZmZzZXRzPXt9O2RpbWVuc2lvbnM9Z2V0RGltZW5zaW9ucyh0YXJnZXQpO2lmKHRhcmdldFswXS5wcmV2ZW50RGVmYXVsdCl7b3B0aW9ucy5hdD0ibGVmdCB0b3AiO30KdGFyZ2V0V2lkdGg9ZGltZW5zaW9ucy53aWR0aDt0YXJnZXRIZWlnaHQ9ZGltZW5zaW9ucy5oZWlnaHQ7dGFyZ2V0T2Zmc2V0PWRpbWVuc2lvbnMub2Zmc2V0O2Jhc2VQb3NpdGlvbj0kLmV4dGVuZCh7fSx0YXJnZXRPZmZzZXQpOyQuZWFjaChbIm15IiwiYXQiXSxmdW5jdGlvbigpe3ZhciBwb3M9KG9wdGlvbnNbdGhpc118fCIiKS5zcGxpdCgiICIpLGhvcml6b250YWxPZmZzZXQsdmVydGljYWxPZmZzZXQ7aWYocG9zLmxlbmd0aD09PTEpe3Bvcz1yaG9yaXpvbnRhbC50ZXN0KHBvc1swXSk/cG9zLmNvbmNhdChbImNlbnRlciJdKTpydmVydGljYWwudGVzdChwb3NbMF0pP1siY2VudGVyIl0uY29uY2F0KHBvcyk6WyJjZW50ZXIiLCJjZW50ZXIiXTt9CnBvc1swXT1yaG9yaXpvbnRhbC50ZXN0KHBvc1swXSk/cG9zWzBdOiJjZW50ZXIiO3Bvc1sxXT1ydmVydGljYWwudGVzdChwb3NbMV0pP3Bvc1sxXToiY2VudGVyIjtob3Jpem9udGFsT2Zmc2V0PXJvZmZzZXQuZXhlYyhwb3NbMF0pO3ZlcnRpY2FsT2Zmc2V0PXJvZmZzZXQuZXhlYyhwb3NbMV0pO29mZnNldHNbdGhpc109W2hvcml6b250YWxPZmZzZXQ/aG9yaXpvbnRhbE9mZnNldFswXTowLHZlcnRpY2FsT2Zmc2V0P3ZlcnRpY2FsT2Zmc2V0WzBdOjBdO29wdGlvbnNbdGhpc109W3Jwb3NpdGlvbi5leGVjKHBvc1swXSlbMF0scnBvc2l0aW9uLmV4ZWMocG9zWzFdKVswXV07fSk7aWYoY29sbGlzaW9uLmxlbmd0aD09PTEpe2NvbGxpc2lvblsxXT1jb2xsaXNpb25bMF07fQppZihvcHRpb25zLmF0WzBdPT09InJpZ2h0Iil7YmFzZVBvc2l0aW9uLmxlZnQrPXRhcmdldFdpZHRoO31lbHNlIGlmKG9wdGlvbnMuYXRbMF09PT0iY2VudGVyIil7YmFzZVBvc2l0aW9uLmxlZnQrPXRhcmdldFdpZHRoLzI7fQppZihvcHRpb25zLmF0WzFdPT09ImJvdHRvbSIpe2Jhc2VQb3NpdGlvbi50b3ArPXRhcmdldEhlaWdodDt9ZWxzZSBpZihvcHRpb25zLmF0WzFdPT09ImNlbnRlciIpe2Jhc2VQb3NpdGlvbi50b3ArPXRhcmdldEhlaWdodC8yO30KYXRPZmZzZXQ9Z2V0T2Zmc2V0cyhvZmZzZXRzLmF0LHRhcmdldFdpZHRoLHRhcmdldEhlaWdodCk7YmFzZVBvc2l0aW9uLmxlZnQrPWF0T2Zmc2V0WzBdO2Jhc2VQb3NpdGlvbi50b3ArPWF0T2Zmc2V0WzFdO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgY29sbGlzaW9uUG9zaXRpb24sdXNpbmcsZWxlbT0kKHRoaXMpLGVsZW1XaWR0aD1lbGVtLm91dGVyV2lkdGgoKSxlbGVtSGVpZ2h0PWVsZW0ub3V0ZXJIZWlnaHQoKSxtYXJnaW5MZWZ0PXBhcnNlQ3NzKHRoaXMsIm1hcmdpbkxlZnQiKSxtYXJnaW5Ub3A9cGFyc2VDc3ModGhpcywibWFyZ2luVG9wIiksY29sbGlzaW9uV2lkdGg9ZWxlbVdpZHRoK21hcmdpbkxlZnQrcGFyc2VDc3ModGhpcywibWFyZ2luUmlnaHQiKStzY3JvbGxJbmZvLndpZHRoLGNvbGxpc2lvbkhlaWdodD1lbGVtSGVpZ2h0K21hcmdpblRvcCtwYXJzZUNzcyh0aGlzLCJtYXJnaW5Cb3R0b20iKStzY3JvbGxJbmZvLmhlaWdodCxwb3NpdGlvbj0kLmV4dGVuZCh7fSxiYXNlUG9zaXRpb24pLG15T2Zmc2V0PWdldE9mZnNldHMob2Zmc2V0cy5teSxlbGVtLm91dGVyV2lkdGgoKSxlbGVtLm91dGVySGVpZ2h0KCkpO2lmKG9wdGlvbnMubXlbMF09PT0icmlnaHQiKXtwb3NpdGlvbi5sZWZ0LT1lbGVtV2lkdGg7fWVsc2UgaWYob3B0aW9ucy5teVswXT09PSJjZW50ZXIiKXtwb3NpdGlvbi5sZWZ0LT1lbGVtV2lkdGgvMjt9CmlmKG9wdGlvbnMubXlbMV09PT0iYm90dG9tIil7cG9zaXRpb24udG9wLT1lbGVtSGVpZ2h0O31lbHNlIGlmKG9wdGlvbnMubXlbMV09PT0iY2VudGVyIil7cG9zaXRpb24udG9wLT1lbGVtSGVpZ2h0LzI7fQpwb3NpdGlvbi5sZWZ0Kz1teU9mZnNldFswXTtwb3NpdGlvbi50b3ArPW15T2Zmc2V0WzFdO2lmKCEkLnN1cHBvcnQub2Zmc2V0RnJhY3Rpb25zKXtwb3NpdGlvbi5sZWZ0PXJvdW5kKHBvc2l0aW9uLmxlZnQpO3Bvc2l0aW9uLnRvcD1yb3VuZChwb3NpdGlvbi50b3ApO30KY29sbGlzaW9uUG9zaXRpb249e21hcmdpbkxlZnQ6bWFyZ2luTGVmdCxtYXJnaW5Ub3A6bWFyZ2luVG9wfTskLmVhY2goWyJsZWZ0IiwidG9wIl0sZnVuY3Rpb24oaSxkaXIpe2lmKCQudWkucG9zaXRpb25bY29sbGlzaW9uW2ldXSl7JC51aS5wb3NpdGlvbltjb2xsaXNpb25baV1dW2Rpcl0ocG9zaXRpb24se3RhcmdldFdpZHRoOnRhcmdldFdpZHRoLHRhcmdldEhlaWdodDp0YXJnZXRIZWlnaHQsZWxlbVdpZHRoOmVsZW1XaWR0aCxlbGVtSGVpZ2h0OmVsZW1IZWlnaHQsY29sbGlzaW9uUG9zaXRpb246Y29sbGlzaW9uUG9zaXRpb24sY29sbGlzaW9uV2lkdGg6Y29sbGlzaW9uV2lkdGgsY29sbGlzaW9uSGVpZ2h0OmNvbGxpc2lvbkhlaWdodCxvZmZzZXQ6W2F0T2Zmc2V0WzBdK215T2Zmc2V0WzBdLGF0T2Zmc2V0WzFdK215T2Zmc2V0WzFdXSxteTpvcHRpb25zLm15LGF0Om9wdGlvbnMuYXQsd2l0aGluOndpdGhpbixlbGVtOmVsZW19KTt9fSk7aWYob3B0aW9ucy51c2luZyl7dXNpbmc9ZnVuY3Rpb24ocHJvcHMpe3ZhciBsZWZ0PXRhcmdldE9mZnNldC5sZWZ0LXBvc2l0aW9uLmxlZnQscmlnaHQ9bGVmdCt0YXJnZXRXaWR0aC1lbGVtV2lkdGgsdG9wPXRhcmdldE9mZnNldC50b3AtcG9zaXRpb24udG9wLGJvdHRvbT10b3ArdGFyZ2V0SGVpZ2h0LWVsZW1IZWlnaHQsZmVlZGJhY2s9e3RhcmdldDp7ZWxlbWVudDp0YXJnZXQsbGVmdDp0YXJnZXRPZmZzZXQubGVmdCx0b3A6dGFyZ2V0T2Zmc2V0LnRvcCx3aWR0aDp0YXJnZXRXaWR0aCxoZWlnaHQ6dGFyZ2V0SGVpZ2h0fSxlbGVtZW50OntlbGVtZW50OmVsZW0sbGVmdDpwb3NpdGlvbi5sZWZ0LHRvcDpwb3NpdGlvbi50b3Asd2lkdGg6ZWxlbVdpZHRoLGhlaWdodDplbGVtSGVpZ2h0fSxob3Jpem9udGFsOnJpZ2h0PDA/ImxlZnQiOmxlZnQ+MD8icmlnaHQiOiJjZW50ZXIiLHZlcnRpY2FsOmJvdHRvbTwwPyJ0b3AiOnRvcD4wPyJib3R0b20iOiJtaWRkbGUifTtpZih0YXJnZXRXaWR0aDxlbGVtV2lkdGgmJmFicyhsZWZ0K3JpZ2h0KTx0YXJnZXRXaWR0aCl7ZmVlZGJhY2suaG9yaXpvbnRhbD0iY2VudGVyIjt9CmlmKHRhcmdldEhlaWdodDxlbGVtSGVpZ2h0JiZhYnModG9wK2JvdHRvbSk8dGFyZ2V0SGVpZ2h0KXtmZWVkYmFjay52ZXJ0aWNhbD0ibWlkZGxlIjt9CmlmKG1heChhYnMobGVmdCksYWJzKHJpZ2h0KSk+bWF4KGFicyh0b3ApLGFicyhib3R0b20pKSl7ZmVlZGJhY2suaW1wb3J0YW50PSJob3Jpem9udGFsIjt9ZWxzZXtmZWVkYmFjay5pbXBvcnRhbnQ9InZlcnRpY2FsIjt9Cm9wdGlvbnMudXNpbmcuY2FsbCh0aGlzLHByb3BzLGZlZWRiYWNrKTt9O30KZWxlbS5vZmZzZXQoJC5leHRlbmQocG9zaXRpb24se3VzaW5nOnVzaW5nfSkpO30pO307JC51aS5wb3NpdGlvbj17Zml0OntsZWZ0OmZ1bmN0aW9uKHBvc2l0aW9uLGRhdGEpe3ZhciB3aXRoaW49ZGF0YS53aXRoaW4sd2l0aGluT2Zmc2V0PXdpdGhpbi5pc1dpbmRvdz93aXRoaW4uc2Nyb2xsTGVmdDp3aXRoaW4ub2Zmc2V0LmxlZnQsb3V0ZXJXaWR0aD13aXRoaW4ud2lkdGgsY29sbGlzaW9uUG9zTGVmdD1wb3NpdGlvbi5sZWZ0LWRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCxvdmVyTGVmdD13aXRoaW5PZmZzZXQtY29sbGlzaW9uUG9zTGVmdCxvdmVyUmlnaHQ9Y29sbGlzaW9uUG9zTGVmdCtkYXRhLmNvbGxpc2lvbldpZHRoLW91dGVyV2lkdGgtd2l0aGluT2Zmc2V0LG5ld092ZXJSaWdodDtpZihkYXRhLmNvbGxpc2lvbldpZHRoPm91dGVyV2lkdGgpe2lmKG92ZXJMZWZ0PjAmJm92ZXJSaWdodDw9MCl7bmV3T3ZlclJpZ2h0PXBvc2l0aW9uLmxlZnQrb3ZlckxlZnQrZGF0YS5jb2xsaXNpb25XaWR0aC1vdXRlcldpZHRoLXdpdGhpbk9mZnNldDtwb3NpdGlvbi5sZWZ0Kz1vdmVyTGVmdC1uZXdPdmVyUmlnaHQ7fWVsc2UgaWYob3ZlclJpZ2h0PjAmJm92ZXJMZWZ0PD0wKXtwb3NpdGlvbi5sZWZ0PXdpdGhpbk9mZnNldDt9ZWxzZXtpZihvdmVyTGVmdD5vdmVyUmlnaHQpe3Bvc2l0aW9uLmxlZnQ9d2l0aGluT2Zmc2V0K291dGVyV2lkdGgtZGF0YS5jb2xsaXNpb25XaWR0aDt9ZWxzZXtwb3NpdGlvbi5sZWZ0PXdpdGhpbk9mZnNldDt9fX1lbHNlIGlmKG92ZXJMZWZ0PjApe3Bvc2l0aW9uLmxlZnQrPW92ZXJMZWZ0O31lbHNlIGlmKG92ZXJSaWdodD4wKXtwb3NpdGlvbi5sZWZ0LT1vdmVyUmlnaHQ7fWVsc2V7cG9zaXRpb24ubGVmdD1tYXgocG9zaXRpb24ubGVmdC1jb2xsaXNpb25Qb3NMZWZ0LHBvc2l0aW9uLmxlZnQpO319LHRvcDpmdW5jdGlvbihwb3NpdGlvbixkYXRhKXt2YXIgd2l0aGluPWRhdGEud2l0aGluLHdpdGhpbk9mZnNldD13aXRoaW4uaXNXaW5kb3c/d2l0aGluLnNjcm9sbFRvcDp3aXRoaW4ub2Zmc2V0LnRvcCxvdXRlckhlaWdodD1kYXRhLndpdGhpbi5oZWlnaHQsY29sbGlzaW9uUG9zVG9wPXBvc2l0aW9uLnRvcC1kYXRhLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpblRvcCxvdmVyVG9wPXdpdGhpbk9mZnNldC1jb2xsaXNpb25Qb3NUb3Asb3ZlckJvdHRvbT1jb2xsaXNpb25Qb3NUb3ArZGF0YS5jb2xsaXNpb25IZWlnaHQtb3V0ZXJIZWlnaHQtd2l0aGluT2Zmc2V0LG5ld092ZXJCb3R0b207aWYoZGF0YS5jb2xsaXNpb25IZWlnaHQ+b3V0ZXJIZWlnaHQpe2lmKG92ZXJUb3A+MCYmb3ZlckJvdHRvbTw9MCl7bmV3T3ZlckJvdHRvbT1wb3NpdGlvbi50b3Arb3ZlclRvcCtkYXRhLmNvbGxpc2lvbkhlaWdodC1vdXRlckhlaWdodC13aXRoaW5PZmZzZXQ7cG9zaXRpb24udG9wKz1vdmVyVG9wLW5ld092ZXJCb3R0b207fWVsc2UgaWYob3ZlckJvdHRvbT4wJiZvdmVyVG9wPD0wKXtwb3NpdGlvbi50b3A9d2l0aGluT2Zmc2V0O31lbHNle2lmKG92ZXJUb3A+b3ZlckJvdHRvbSl7cG9zaXRpb24udG9wPXdpdGhpbk9mZnNldCtvdXRlckhlaWdodC1kYXRhLmNvbGxpc2lvbkhlaWdodDt9ZWxzZXtwb3NpdGlvbi50b3A9d2l0aGluT2Zmc2V0O319fWVsc2UgaWYob3ZlclRvcD4wKXtwb3NpdGlvbi50b3ArPW92ZXJUb3A7fWVsc2UgaWYob3ZlckJvdHRvbT4wKXtwb3NpdGlvbi50b3AtPW92ZXJCb3R0b207fWVsc2V7cG9zaXRpb24udG9wPW1heChwb3NpdGlvbi50b3AtY29sbGlzaW9uUG9zVG9wLHBvc2l0aW9uLnRvcCk7fX19LGZsaXA6e2xlZnQ6ZnVuY3Rpb24ocG9zaXRpb24sZGF0YSl7dmFyIHdpdGhpbj1kYXRhLndpdGhpbix3aXRoaW5PZmZzZXQ9d2l0aGluLm9mZnNldC5sZWZ0K3dpdGhpbi5zY3JvbGxMZWZ0LG91dGVyV2lkdGg9d2l0aGluLndpZHRoLG9mZnNldExlZnQ9d2l0aGluLmlzV2luZG93P3dpdGhpbi5zY3JvbGxMZWZ0OndpdGhpbi5vZmZzZXQubGVmdCxjb2xsaXNpb25Qb3NMZWZ0PXBvc2l0aW9uLmxlZnQtZGF0YS5jb2xsaXNpb25Qb3NpdGlvbi5tYXJnaW5MZWZ0LG92ZXJMZWZ0PWNvbGxpc2lvblBvc0xlZnQtb2Zmc2V0TGVmdCxvdmVyUmlnaHQ9Y29sbGlzaW9uUG9zTGVmdCtkYXRhLmNvbGxpc2lvbldpZHRoLW91dGVyV2lkdGgtb2Zmc2V0TGVmdCxteU9mZnNldD1kYXRhLm15WzBdPT09ImxlZnQiPy1kYXRhLmVsZW1XaWR0aDpkYXRhLm15WzBdPT09InJpZ2h0Ij9kYXRhLmVsZW1XaWR0aDowLGF0T2Zmc2V0PWRhdGEuYXRbMF09PT0ibGVmdCI/ZGF0YS50YXJnZXRXaWR0aDpkYXRhLmF0WzBdPT09InJpZ2h0Ij8tZGF0YS50YXJnZXRXaWR0aDowLG9mZnNldD0tMipkYXRhLm9mZnNldFswXSxuZXdPdmVyUmlnaHQsbmV3T3ZlckxlZnQ7aWYob3ZlckxlZnQ8MCl7bmV3T3ZlclJpZ2h0PXBvc2l0aW9uLmxlZnQrbXlPZmZzZXQrYXRPZmZzZXQrb2Zmc2V0K2RhdGEuY29sbGlzaW9uV2lkdGgtb3V0ZXJXaWR0aC13aXRoaW5PZmZzZXQ7aWYobmV3T3ZlclJpZ2h0PDB8fG5ld092ZXJSaWdodDxhYnMob3ZlckxlZnQpKXtwb3NpdGlvbi5sZWZ0Kz1teU9mZnNldCthdE9mZnNldCtvZmZzZXQ7fX0KZWxzZSBpZihvdmVyUmlnaHQ+MCl7bmV3T3ZlckxlZnQ9cG9zaXRpb24ubGVmdC1kYXRhLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpbkxlZnQrbXlPZmZzZXQrYXRPZmZzZXQrb2Zmc2V0LW9mZnNldExlZnQ7aWYobmV3T3ZlckxlZnQ+MHx8YWJzKG5ld092ZXJMZWZ0KTxvdmVyUmlnaHQpe3Bvc2l0aW9uLmxlZnQrPW15T2Zmc2V0K2F0T2Zmc2V0K29mZnNldDt9fX0sdG9wOmZ1bmN0aW9uKHBvc2l0aW9uLGRhdGEpe3ZhciB3aXRoaW49ZGF0YS53aXRoaW4sd2l0aGluT2Zmc2V0PXdpdGhpbi5vZmZzZXQudG9wK3dpdGhpbi5zY3JvbGxUb3Asb3V0ZXJIZWlnaHQ9d2l0aGluLmhlaWdodCxvZmZzZXRUb3A9d2l0aGluLmlzV2luZG93P3dpdGhpbi5zY3JvbGxUb3A6d2l0aGluLm9mZnNldC50b3AsY29sbGlzaW9uUG9zVG9wPXBvc2l0aW9uLnRvcC1kYXRhLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpblRvcCxvdmVyVG9wPWNvbGxpc2lvblBvc1RvcC1vZmZzZXRUb3Asb3ZlckJvdHRvbT1jb2xsaXNpb25Qb3NUb3ArZGF0YS5jb2xsaXNpb25IZWlnaHQtb3V0ZXJIZWlnaHQtb2Zmc2V0VG9wLHRvcD1kYXRhLm15WzFdPT09InRvcCIsbXlPZmZzZXQ9dG9wPy1kYXRhLmVsZW1IZWlnaHQ6ZGF0YS5teVsxXT09PSJib3R0b20iP2RhdGEuZWxlbUhlaWdodDowLGF0T2Zmc2V0PWRhdGEuYXRbMV09PT0idG9wIj9kYXRhLnRhcmdldEhlaWdodDpkYXRhLmF0WzFdPT09ImJvdHRvbSI/LWRhdGEudGFyZ2V0SGVpZ2h0OjAsb2Zmc2V0PS0yKmRhdGEub2Zmc2V0WzFdLG5ld092ZXJUb3AsbmV3T3ZlckJvdHRvbTtpZihvdmVyVG9wPDApe25ld092ZXJCb3R0b209cG9zaXRpb24udG9wK215T2Zmc2V0K2F0T2Zmc2V0K29mZnNldCtkYXRhLmNvbGxpc2lvbkhlaWdodC1vdXRlckhlaWdodC13aXRoaW5PZmZzZXQ7aWYoKHBvc2l0aW9uLnRvcCtteU9mZnNldCthdE9mZnNldCtvZmZzZXQpPm92ZXJUb3AmJihuZXdPdmVyQm90dG9tPDB8fG5ld092ZXJCb3R0b208YWJzKG92ZXJUb3ApKSl7cG9zaXRpb24udG9wKz1teU9mZnNldCthdE9mZnNldCtvZmZzZXQ7fX0KZWxzZSBpZihvdmVyQm90dG9tPjApe25ld092ZXJUb3A9cG9zaXRpb24udG9wLWRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wK215T2Zmc2V0K2F0T2Zmc2V0K29mZnNldC1vZmZzZXRUb3A7aWYoKHBvc2l0aW9uLnRvcCtteU9mZnNldCthdE9mZnNldCtvZmZzZXQpPm92ZXJCb3R0b20mJihuZXdPdmVyVG9wPjB8fGFicyhuZXdPdmVyVG9wKTxvdmVyQm90dG9tKSl7cG9zaXRpb24udG9wKz1teU9mZnNldCthdE9mZnNldCtvZmZzZXQ7fX19fSxmbGlwZml0OntsZWZ0OmZ1bmN0aW9uKCl7JC51aS5wb3NpdGlvbi5mbGlwLmxlZnQuYXBwbHkodGhpcyxhcmd1bWVudHMpOyQudWkucG9zaXRpb24uZml0LmxlZnQuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sdG9wOmZ1bmN0aW9uKCl7JC51aS5wb3NpdGlvbi5mbGlwLnRvcC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7JC51aS5wb3NpdGlvbi5maXQudG9wLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fX07KGZ1bmN0aW9uKCl7dmFyIHRlc3RFbGVtZW50LHRlc3RFbGVtZW50UGFyZW50LHRlc3RFbGVtZW50U3R5bGUsb2Zmc2V0TGVmdCxpLGJvZHk9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImJvZHkiKVswXSxkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7dGVzdEVsZW1lbnQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChib2R5PyJkaXYiOiJib2R5Iik7dGVzdEVsZW1lbnRTdHlsZT17dmlzaWJpbGl0eToiaGlkZGVuIix3aWR0aDowLGhlaWdodDowLGJvcmRlcjowLG1hcmdpbjowLGJhY2tncm91bmQ6Im5vbmUifTtpZihib2R5KXskLmV4dGVuZCh0ZXN0RWxlbWVudFN0eWxlLHtwb3NpdGlvbjoiYWJzb2x1dGUiLGxlZnQ6Ii0xMDAwcHgiLHRvcDoiLTEwMDBweCJ9KTt9CmZvcihpIGluIHRlc3RFbGVtZW50U3R5bGUpe3Rlc3RFbGVtZW50LnN0eWxlW2ldPXRlc3RFbGVtZW50U3R5bGVbaV07fQp0ZXN0RWxlbWVudC5hcHBlbmRDaGlsZChkaXYpO3Rlc3RFbGVtZW50UGFyZW50PWJvZHl8fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDt0ZXN0RWxlbWVudFBhcmVudC5pbnNlcnRCZWZvcmUodGVzdEVsZW1lbnQsdGVzdEVsZW1lbnRQYXJlbnQuZmlyc3RDaGlsZCk7ZGl2LnN0eWxlLmNzc1RleHQ9InBvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogMTAuNzQzMjIyMnB4OyI7b2Zmc2V0TGVmdD0kKGRpdikub2Zmc2V0KCkubGVmdDskLnN1cHBvcnQub2Zmc2V0RnJhY3Rpb25zPW9mZnNldExlZnQ+MTAmJm9mZnNldExlZnQ8MTE7dGVzdEVsZW1lbnQuaW5uZXJIVE1MPSIiO3Rlc3RFbGVtZW50UGFyZW50LnJlbW92ZUNoaWxkKHRlc3RFbGVtZW50KTt9KSgpO30oalF1ZXJ5KSk7KGZ1bmN0aW9uKCQsdW5kZWZpbmVkKXskLndpZGdldCgidWkuYXV0b2NvbXBsZXRlIix7dmVyc2lvbjoiMS4xMC40IixkZWZhdWx0RWxlbWVudDoiPGlucHV0PiIsb3B0aW9uczp7YXBwZW5kVG86bnVsbCxhdXRvRm9jdXM6ZmFsc2UsZGVsYXk6MzAwLG1pbkxlbmd0aDoxLHBvc2l0aW9uOntteToibGVmdCB0b3AiLGF0OiJsZWZ0IGJvdHRvbSIsY29sbGlzaW9uOiJub25lIn0sc291cmNlOm51bGwsY2hhbmdlOm51bGwsY2xvc2U6bnVsbCxmb2N1czpudWxsLG9wZW46bnVsbCxyZXNwb25zZTpudWxsLHNlYXJjaDpudWxsLHNlbGVjdDpudWxsfSxyZXF1ZXN0SW5kZXg6MCxwZW5kaW5nOjAsX2NyZWF0ZTpmdW5jdGlvbigpe3ZhciBzdXBwcmVzc0tleVByZXNzLHN1cHByZXNzS2V5UHJlc3NSZXBlYXQsc3VwcHJlc3NJbnB1dCxub2RlTmFtZT10aGlzLmVsZW1lbnRbMF0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxpc1RleHRhcmVhPW5vZGVOYW1lPT09InRleHRhcmVhIixpc0lucHV0PW5vZGVOYW1lPT09ImlucHV0Ijt0aGlzLmlzTXVsdGlMaW5lPWlzVGV4dGFyZWE/dHJ1ZTppc0lucHV0P2ZhbHNlOnRoaXMuZWxlbWVudC5wcm9wKCJpc0NvbnRlbnRFZGl0YWJsZSIpO3RoaXMudmFsdWVNZXRob2Q9dGhpcy5lbGVtZW50W2lzVGV4dGFyZWF8fGlzSW5wdXQ/InZhbCI6InRleHQiXTt0aGlzLmlzTmV3TWVudT10cnVlO3RoaXMuZWxlbWVudC5hZGRDbGFzcygidWktYXV0b2NvbXBsZXRlLWlucHV0IikuYXR0cigiYXV0b2NvbXBsZXRlIiwib2ZmIik7dGhpcy5fb24odGhpcy5lbGVtZW50LHtrZXlkb3duOmZ1bmN0aW9uKGV2ZW50KXtpZih0aGlzLmVsZW1lbnQucHJvcCgicmVhZE9ubHkiKSl7c3VwcHJlc3NLZXlQcmVzcz10cnVlO3N1cHByZXNzSW5wdXQ9dHJ1ZTtzdXBwcmVzc0tleVByZXNzUmVwZWF0PXRydWU7cmV0dXJuO30Kc3VwcHJlc3NLZXlQcmVzcz1mYWxzZTtzdXBwcmVzc0lucHV0PWZhbHNlO3N1cHByZXNzS2V5UHJlc3NSZXBlYXQ9ZmFsc2U7dmFyIGtleUNvZGU9JC51aS5rZXlDb2RlO3N3aXRjaChldmVudC5rZXlDb2RlKXtjYXNlIGtleUNvZGUuUEFHRV9VUDpzdXBwcmVzc0tleVByZXNzPXRydWU7dGhpcy5fbW92ZSgicHJldmlvdXNQYWdlIixldmVudCk7YnJlYWs7Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjpzdXBwcmVzc0tleVByZXNzPXRydWU7dGhpcy5fbW92ZSgibmV4dFBhZ2UiLGV2ZW50KTticmVhaztjYXNlIGtleUNvZGUuVVA6c3VwcHJlc3NLZXlQcmVzcz10cnVlO3RoaXMuX2tleUV2ZW50KCJwcmV2aW91cyIsZXZlbnQpO2JyZWFrO2Nhc2Uga2V5Q29kZS5ET1dOOnN1cHByZXNzS2V5UHJlc3M9dHJ1ZTt0aGlzLl9rZXlFdmVudCgibmV4dCIsZXZlbnQpO2JyZWFrO2Nhc2Uga2V5Q29kZS5FTlRFUjpjYXNlIGtleUNvZGUuTlVNUEFEX0VOVEVSOmlmKHRoaXMubWVudS5hY3RpdmUpe3N1cHByZXNzS2V5UHJlc3M9dHJ1ZTtldmVudC5wcmV2ZW50RGVmYXVsdCgpO3RoaXMubWVudS5zZWxlY3QoZXZlbnQpO30KYnJlYWs7Y2FzZSBrZXlDb2RlLlRBQjppZih0aGlzLm1lbnUuYWN0aXZlKXt0aGlzLm1lbnUuc2VsZWN0KGV2ZW50KTt9CmJyZWFrO2Nhc2Uga2V5Q29kZS5FU0NBUEU6aWYodGhpcy5tZW51LmVsZW1lbnQuaXMoIjp2aXNpYmxlIikpe3RoaXMuX3ZhbHVlKHRoaXMudGVybSk7dGhpcy5jbG9zZShldmVudCk7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9CmJyZWFrO2RlZmF1bHQ6c3VwcHJlc3NLZXlQcmVzc1JlcGVhdD10cnVlO3RoaXMuX3NlYXJjaFRpbWVvdXQoZXZlbnQpO2JyZWFrO319LGtleXByZXNzOmZ1bmN0aW9uKGV2ZW50KXtpZihzdXBwcmVzc0tleVByZXNzKXtzdXBwcmVzc0tleVByZXNzPWZhbHNlO2lmKCF0aGlzLmlzTXVsdGlMaW5lfHx0aGlzLm1lbnUuZWxlbWVudC5pcygiOnZpc2libGUiKSl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9CnJldHVybjt9CmlmKHN1cHByZXNzS2V5UHJlc3NSZXBlYXQpe3JldHVybjt9CnZhciBrZXlDb2RlPSQudWkua2V5Q29kZTtzd2l0Y2goZXZlbnQua2V5Q29kZSl7Y2FzZSBrZXlDb2RlLlBBR0VfVVA6dGhpcy5fbW92ZSgicHJldmlvdXNQYWdlIixldmVudCk7YnJlYWs7Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjp0aGlzLl9tb3ZlKCJuZXh0UGFnZSIsZXZlbnQpO2JyZWFrO2Nhc2Uga2V5Q29kZS5VUDp0aGlzLl9rZXlFdmVudCgicHJldmlvdXMiLGV2ZW50KTticmVhaztjYXNlIGtleUNvZGUuRE9XTjp0aGlzLl9rZXlFdmVudCgibmV4dCIsZXZlbnQpO2JyZWFrO319LGlucHV0OmZ1bmN0aW9uKGV2ZW50KXtpZihzdXBwcmVzc0lucHV0KXtzdXBwcmVzc0lucHV0PWZhbHNlO2V2ZW50LnByZXZlbnREZWZhdWx0KCk7cmV0dXJuO30KdGhpcy5fc2VhcmNoVGltZW91dChldmVudCk7fSxmb2N1czpmdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWRJdGVtPW51bGw7dGhpcy5wcmV2aW91cz10aGlzLl92YWx1ZSgpO30sYmx1cjpmdW5jdGlvbihldmVudCl7aWYodGhpcy5jYW5jZWxCbHVyKXtkZWxldGUgdGhpcy5jYW5jZWxCbHVyO3JldHVybjt9CmNsZWFyVGltZW91dCh0aGlzLnNlYXJjaGluZyk7dGhpcy5jbG9zZShldmVudCk7dGhpcy5fY2hhbmdlKGV2ZW50KTt9fSk7dGhpcy5faW5pdFNvdXJjZSgpO3RoaXMubWVudT0kKCI8dWw+IikuYWRkQ2xhc3MoInVpLWF1dG9jb21wbGV0ZSB1aS1mcm9udCIpLmFwcGVuZFRvKHRoaXMuX2FwcGVuZFRvKCkpLm1lbnUoe3JvbGU6bnVsbH0pLmhpZGUoKS5kYXRhKCJ1aS1tZW51Iik7dGhpcy5fb24odGhpcy5tZW51LmVsZW1lbnQse21vdXNlZG93bjpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt0aGlzLmNhbmNlbEJsdXI9dHJ1ZTt0aGlzLl9kZWxheShmdW5jdGlvbigpe2RlbGV0ZSB0aGlzLmNhbmNlbEJsdXI7fSk7dmFyIG1lbnVFbGVtZW50PXRoaXMubWVudS5lbGVtZW50WzBdO2lmKCEkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgiLnVpLW1lbnUtaXRlbSIpLmxlbmd0aCl7dGhpcy5fZGVsYXkoZnVuY3Rpb24oKXt2YXIgdGhhdD10aGlzO3RoaXMuZG9jdW1lbnQub25lKCJtb3VzZWRvd24iLGZ1bmN0aW9uKGV2ZW50KXtpZihldmVudC50YXJnZXQhPT10aGF0LmVsZW1lbnRbMF0mJmV2ZW50LnRhcmdldCE9PW1lbnVFbGVtZW50JiYhJC5jb250YWlucyhtZW51RWxlbWVudCxldmVudC50YXJnZXQpKXt0aGF0LmNsb3NlKCk7fX0pO30pO319LG1lbnVmb2N1czpmdW5jdGlvbihldmVudCx1aSl7aWYodGhpcy5pc05ld01lbnUpe3RoaXMuaXNOZXdNZW51PWZhbHNlO2lmKGV2ZW50Lm9yaWdpbmFsRXZlbnQmJi9ebW91c2UvLnRlc3QoZXZlbnQub3JpZ2luYWxFdmVudC50eXBlKSl7dGhpcy5tZW51LmJsdXIoKTt0aGlzLmRvY3VtZW50Lm9uZSgibW91c2Vtb3ZlIixmdW5jdGlvbigpeyQoZXZlbnQudGFyZ2V0KS50cmlnZ2VyKGV2ZW50Lm9yaWdpbmFsRXZlbnQpO30pO3JldHVybjt9fQp2YXIgaXRlbT11aS5pdGVtLmRhdGEoInVpLWF1dG9jb21wbGV0ZS1pdGVtIik7aWYoZmFsc2UhPT10aGlzLl90cmlnZ2VyKCJmb2N1cyIsZXZlbnQse2l0ZW06aXRlbX0pKXtpZihldmVudC5vcmlnaW5hbEV2ZW50JiYvXmtleS8udGVzdChldmVudC5vcmlnaW5hbEV2ZW50LnR5cGUpKXt0aGlzLl92YWx1ZShpdGVtLnZhbHVlKTt9fWVsc2V7dGhpcy5saXZlUmVnaW9uLnRleHQoaXRlbS52YWx1ZSk7fX0sbWVudXNlbGVjdDpmdW5jdGlvbihldmVudCx1aSl7dmFyIGl0ZW09dWkuaXRlbS5kYXRhKCJ1aS1hdXRvY29tcGxldGUtaXRlbSIpLHByZXZpb3VzPXRoaXMucHJldmlvdXM7aWYodGhpcy5lbGVtZW50WzBdIT09dGhpcy5kb2N1bWVudFswXS5hY3RpdmVFbGVtZW50KXt0aGlzLmVsZW1lbnQuZm9jdXMoKTt0aGlzLnByZXZpb3VzPXByZXZpb3VzO3RoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5wcmV2aW91cz1wcmV2aW91czt0aGlzLnNlbGVjdGVkSXRlbT1pdGVtO30pO30KaWYoZmFsc2UhPT10aGlzLl90cmlnZ2VyKCJzZWxlY3QiLGV2ZW50LHtpdGVtOml0ZW19KSl7dGhpcy5fdmFsdWUoaXRlbS52YWx1ZSk7fQp0aGlzLnRlcm09dGhpcy5fdmFsdWUoKTt0aGlzLmNsb3NlKGV2ZW50KTt0aGlzLnNlbGVjdGVkSXRlbT1pdGVtO319KTt0aGlzLmxpdmVSZWdpb249JCgiPHNwYW4+Iix7cm9sZToic3RhdHVzIiwiYXJpYS1saXZlIjoicG9saXRlIn0pLmFkZENsYXNzKCJ1aS1oZWxwZXItaGlkZGVuLWFjY2Vzc2libGUiKS5pbnNlcnRCZWZvcmUodGhpcy5lbGVtZW50KTt0aGlzLl9vbih0aGlzLndpbmRvdyx7YmVmb3JldW5sb2FkOmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoImF1dG9jb21wbGV0ZSIpO319KTt9LF9kZXN0cm95OmZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRoaXMuc2VhcmNoaW5nKTt0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoInVpLWF1dG9jb21wbGV0ZS1pbnB1dCIpLnJlbW92ZUF0dHIoImF1dG9jb21wbGV0ZSIpO3RoaXMubWVudS5lbGVtZW50LnJlbW92ZSgpO3RoaXMubGl2ZVJlZ2lvbi5yZW1vdmUoKTt9LF9zZXRPcHRpb246ZnVuY3Rpb24oa2V5LHZhbHVlKXt0aGlzLl9zdXBlcihrZXksdmFsdWUpO2lmKGtleT09PSJzb3VyY2UiKXt0aGlzLl9pbml0U291cmNlKCk7fQppZihrZXk9PT0iYXBwZW5kVG8iKXt0aGlzLm1lbnUuZWxlbWVudC5hcHBlbmRUbyh0aGlzLl9hcHBlbmRUbygpKTt9CmlmKGtleT09PSJkaXNhYmxlZCImJnZhbHVlJiZ0aGlzLnhocil7dGhpcy54aHIuYWJvcnQoKTt9fSxfYXBwZW5kVG86ZnVuY3Rpb24oKXt2YXIgZWxlbWVudD10aGlzLm9wdGlvbnMuYXBwZW5kVG87aWYoZWxlbWVudCl7ZWxlbWVudD1lbGVtZW50LmpxdWVyeXx8ZWxlbWVudC5ub2RlVHlwZT8kKGVsZW1lbnQpOnRoaXMuZG9jdW1lbnQuZmluZChlbGVtZW50KS5lcSgwKTt9CmlmKCFlbGVtZW50KXtlbGVtZW50PXRoaXMuZWxlbWVudC5jbG9zZXN0KCIudWktZnJvbnQiKTt9CmlmKCFlbGVtZW50Lmxlbmd0aCl7ZWxlbWVudD10aGlzLmRvY3VtZW50WzBdLmJvZHk7fQpyZXR1cm4gZWxlbWVudDt9LF9pbml0U291cmNlOmZ1bmN0aW9uKCl7dmFyIGFycmF5LHVybCx0aGF0PXRoaXM7aWYoJC5pc0FycmF5KHRoaXMub3B0aW9ucy5zb3VyY2UpKXthcnJheT10aGlzLm9wdGlvbnMuc291cmNlO3RoaXMuc291cmNlPWZ1bmN0aW9uKHJlcXVlc3QscmVzcG9uc2Upe3Jlc3BvbnNlKCQudWkuYXV0b2NvbXBsZXRlLmZpbHRlcihhcnJheSxyZXF1ZXN0LnRlcm0pKTt9O31lbHNlIGlmKHR5cGVvZiB0aGlzLm9wdGlvbnMuc291cmNlPT09InN0cmluZyIpe3VybD10aGlzLm9wdGlvbnMuc291cmNlO3RoaXMuc291cmNlPWZ1bmN0aW9uKHJlcXVlc3QscmVzcG9uc2Upe2lmKHRoYXQueGhyKXt0aGF0Lnhoci5hYm9ydCgpO30KdGhhdC54aHI9JC5hamF4KHt1cmw6dXJsLGRhdGE6cmVxdWVzdCxkYXRhVHlwZToianNvbiIsc3VjY2VzczpmdW5jdGlvbihkYXRhKXtyZXNwb25zZShkYXRhKTt9LGVycm9yOmZ1bmN0aW9uKCl7cmVzcG9uc2UoW10pO319KTt9O31lbHNle3RoaXMuc291cmNlPXRoaXMub3B0aW9ucy5zb3VyY2U7fX0sX3NlYXJjaFRpbWVvdXQ6ZnVuY3Rpb24oZXZlbnQpe2NsZWFyVGltZW91dCh0aGlzLnNlYXJjaGluZyk7dGhpcy5zZWFyY2hpbmc9dGhpcy5fZGVsYXkoZnVuY3Rpb24oKXtpZih0aGlzLnRlcm0hPT10aGlzLl92YWx1ZSgpKXt0aGlzLnNlbGVjdGVkSXRlbT1udWxsO3RoaXMuc2VhcmNoKG51bGwsZXZlbnQpO319LHRoaXMub3B0aW9ucy5kZWxheSk7fSxzZWFyY2g6ZnVuY3Rpb24odmFsdWUsZXZlbnQpe3ZhbHVlPXZhbHVlIT1udWxsP3ZhbHVlOnRoaXMuX3ZhbHVlKCk7dGhpcy50ZXJtPXRoaXMuX3ZhbHVlKCk7aWYodmFsdWUubGVuZ3RoPHRoaXMub3B0aW9ucy5taW5MZW5ndGgpe3JldHVybiB0aGlzLmNsb3NlKGV2ZW50KTt9CmlmKHRoaXMuX3RyaWdnZXIoInNlYXJjaCIsZXZlbnQpPT09ZmFsc2Upe3JldHVybjt9CnJldHVybiB0aGlzLl9zZWFyY2godmFsdWUpO30sX3NlYXJjaDpmdW5jdGlvbih2YWx1ZSl7dGhpcy5wZW5kaW5nKys7dGhpcy5lbGVtZW50LmFkZENsYXNzKCJ1aS1hdXRvY29tcGxldGUtbG9hZGluZyIpO3RoaXMuY2FuY2VsU2VhcmNoPWZhbHNlO3RoaXMuc291cmNlKHt0ZXJtOnZhbHVlfSx0aGlzLl9yZXNwb25zZSgpKTt9LF9yZXNwb25zZTpmdW5jdGlvbigpe3ZhciBpbmRleD0rK3RoaXMucmVxdWVzdEluZGV4O3JldHVybiAkLnByb3h5KGZ1bmN0aW9uKGNvbnRlbnQpe2lmKGluZGV4PT09dGhpcy5yZXF1ZXN0SW5kZXgpe3RoaXMuX19yZXNwb25zZShjb250ZW50KTt9CnRoaXMucGVuZGluZy0tO2lmKCF0aGlzLnBlbmRpbmcpe3RoaXMuZWxlbWVudC5yZW1vdmVDbGFzcygidWktYXV0b2NvbXBsZXRlLWxvYWRpbmciKTt9fSx0aGlzKTt9LF9fcmVzcG9uc2U6ZnVuY3Rpb24oY29udGVudCl7aWYoY29udGVudCl7Y29udGVudD10aGlzLl9ub3JtYWxpemUoY29udGVudCk7fQp0aGlzLl90cmlnZ2VyKCJyZXNwb25zZSIsbnVsbCx7Y29udGVudDpjb250ZW50fSk7aWYoIXRoaXMub3B0aW9ucy5kaXNhYmxlZCYmY29udGVudCYmY29udGVudC5sZW5ndGgmJiF0aGlzLmNhbmNlbFNlYXJjaCl7dGhpcy5fc3VnZ2VzdChjb250ZW50KTt0aGlzLl90cmlnZ2VyKCJvcGVuIik7fWVsc2V7dGhpcy5fY2xvc2UoKTt9fSxjbG9zZTpmdW5jdGlvbihldmVudCl7dGhpcy5jYW5jZWxTZWFyY2g9dHJ1ZTt0aGlzLl9jbG9zZShldmVudCk7fSxfY2xvc2U6ZnVuY3Rpb24oZXZlbnQpe2lmKHRoaXMubWVudS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpKXt0aGlzLm1lbnUuZWxlbWVudC5oaWRlKCk7dGhpcy5tZW51LmJsdXIoKTt0aGlzLmlzTmV3TWVudT10cnVlO3RoaXMuX3RyaWdnZXIoImNsb3NlIixldmVudCk7fX0sX2NoYW5nZTpmdW5jdGlvbihldmVudCl7aWYodGhpcy5wcmV2aW91cyE9PXRoaXMuX3ZhbHVlKCkpe3RoaXMuX3RyaWdnZXIoImNoYW5nZSIsZXZlbnQse2l0ZW06dGhpcy5zZWxlY3RlZEl0ZW19KTt9fSxfbm9ybWFsaXplOmZ1bmN0aW9uKGl0ZW1zKXtpZihpdGVtcy5sZW5ndGgmJml0ZW1zWzBdLmxhYmVsJiZpdGVtc1swXS52YWx1ZSl7cmV0dXJuIGl0ZW1zO30KcmV0dXJuICQubWFwKGl0ZW1zLGZ1bmN0aW9uKGl0ZW0pe2lmKHR5cGVvZiBpdGVtPT09InN0cmluZyIpe3JldHVybntsYWJlbDppdGVtLHZhbHVlOml0ZW19O30KcmV0dXJuICQuZXh0ZW5kKHtsYWJlbDppdGVtLmxhYmVsfHxpdGVtLnZhbHVlLHZhbHVlOml0ZW0udmFsdWV8fGl0ZW0ubGFiZWx9LGl0ZW0pO30pO30sX3N1Z2dlc3Q6ZnVuY3Rpb24oaXRlbXMpe3ZhciB1bD10aGlzLm1lbnUuZWxlbWVudC5lbXB0eSgpO3RoaXMuX3JlbmRlck1lbnUodWwsaXRlbXMpO3RoaXMuaXNOZXdNZW51PXRydWU7dGhpcy5tZW51LnJlZnJlc2goKTt1bC5zaG93KCk7dGhpcy5fcmVzaXplTWVudSgpO3VsLnBvc2l0aW9uKCQuZXh0ZW5kKHtvZjp0aGlzLmVsZW1lbnR9LHRoaXMub3B0aW9ucy5wb3NpdGlvbikpO2lmKHRoaXMub3B0aW9ucy5hdXRvRm9jdXMpe3RoaXMubWVudS5uZXh0KCk7fX0sX3Jlc2l6ZU1lbnU6ZnVuY3Rpb24oKXt2YXIgdWw9dGhpcy5tZW51LmVsZW1lbnQ7dWwub3V0ZXJXaWR0aChNYXRoLm1heCh1bC53aWR0aCgiIikub3V0ZXJXaWR0aCgpKzEsdGhpcy5lbGVtZW50Lm91dGVyV2lkdGgoKSkpO30sX3JlbmRlck1lbnU6ZnVuY3Rpb24odWwsaXRlbXMpe3ZhciB0aGF0PXRoaXM7JC5lYWNoKGl0ZW1zLGZ1bmN0aW9uKGluZGV4LGl0ZW0pe3RoYXQuX3JlbmRlckl0ZW1EYXRhKHVsLGl0ZW0pO30pO30sX3JlbmRlckl0ZW1EYXRhOmZ1bmN0aW9uKHVsLGl0ZW0pe3JldHVybiB0aGlzLl9yZW5kZXJJdGVtKHVsLGl0ZW0pLmRhdGEoInVpLWF1dG9jb21wbGV0ZS1pdGVtIixpdGVtKTt9LF9yZW5kZXJJdGVtOmZ1bmN0aW9uKHVsLGl0ZW0pe3JldHVybiAkKCI8bGk+IikuYXBwZW5kKCQoIjxhPiIpLnRleHQoaXRlbS5sYWJlbCkpLmFwcGVuZFRvKHVsKTt9LF9tb3ZlOmZ1bmN0aW9uKGRpcmVjdGlvbixldmVudCl7aWYoIXRoaXMubWVudS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpKXt0aGlzLnNlYXJjaChudWxsLGV2ZW50KTtyZXR1cm47fQppZih0aGlzLm1lbnUuaXNGaXJzdEl0ZW0oKSYmL15wcmV2aW91cy8udGVzdChkaXJlY3Rpb24pfHx0aGlzLm1lbnUuaXNMYXN0SXRlbSgpJiYvXm5leHQvLnRlc3QoZGlyZWN0aW9uKSl7dGhpcy5fdmFsdWUodGhpcy50ZXJtKTt0aGlzLm1lbnUuYmx1cigpO3JldHVybjt9CnRoaXMubWVudVtkaXJlY3Rpb25dKGV2ZW50KTt9LHdpZGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1lbnUuZWxlbWVudDt9LF92YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbHVlTWV0aG9kLmFwcGx5KHRoaXMuZWxlbWVudCxhcmd1bWVudHMpO30sX2tleUV2ZW50OmZ1bmN0aW9uKGtleUV2ZW50LGV2ZW50KXtpZighdGhpcy5pc011bHRpTGluZXx8dGhpcy5tZW51LmVsZW1lbnQuaXMoIjp2aXNpYmxlIikpe3RoaXMuX21vdmUoa2V5RXZlbnQsZXZlbnQpO2V2ZW50LnByZXZlbnREZWZhdWx0KCk7fX19KTskLmV4dGVuZCgkLnVpLmF1dG9jb21wbGV0ZSx7ZXNjYXBlUmVnZXg6ZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZS5yZXBsYWNlKC9bXC1cW1xde30oKSorPy4sXFxcXiR8I1xzXS9nLCJcXCQmIik7fSxmaWx0ZXI6ZnVuY3Rpb24oYXJyYXksdGVybSl7dmFyIG1hdGNoZXI9bmV3IFJlZ0V4cCgkLnVpLmF1dG9jb21wbGV0ZS5lc2NhcGVSZWdleCh0ZXJtKSwiaSIpO3JldHVybiAkLmdyZXAoYXJyYXksZnVuY3Rpb24odmFsdWUpe3JldHVybiBtYXRjaGVyLnRlc3QodmFsdWUubGFiZWx8fHZhbHVlLnZhbHVlfHx2YWx1ZSk7fSk7fX0pOyQud2lkZ2V0KCJ1aS5hdXRvY29tcGxldGUiLCQudWkuYXV0b2NvbXBsZXRlLHtvcHRpb25zOnttZXNzYWdlczp7bm9SZXN1bHRzOiJObyBzZWFyY2ggcmVzdWx0cy4iLHJlc3VsdHM6ZnVuY3Rpb24oYW1vdW50KXtyZXR1cm4gYW1vdW50KyhhbW91bnQ+MT8iIHJlc3VsdHMgYXJlIjoiIHJlc3VsdCBpcyIpKyIgYXZhaWxhYmxlLCB1c2UgdXAgYW5kIGRvd24gYXJyb3cga2V5cyB0byBuYXZpZ2F0ZS4iO319fSxfX3Jlc3BvbnNlOmZ1bmN0aW9uKGNvbnRlbnQpe3ZhciBtZXNzYWdlO3RoaXMuX3N1cGVyQXBwbHkoYXJndW1lbnRzKTtpZih0aGlzLm9wdGlvbnMuZGlzYWJsZWR8fHRoaXMuY2FuY2VsU2VhcmNoKXtyZXR1cm47fQppZihjb250ZW50JiZjb250ZW50Lmxlbmd0aCl7bWVzc2FnZT10aGlzLm9wdGlvbnMubWVzc2FnZXMucmVzdWx0cyhjb250ZW50Lmxlbmd0aCk7fWVsc2V7bWVzc2FnZT10aGlzLm9wdGlvbnMubWVzc2FnZXMubm9SZXN1bHRzO30KdGhpcy5saXZlUmVnaW9uLnRleHQobWVzc2FnZSk7fX0pO30oalF1ZXJ5KSk7KGZ1bmN0aW9uKCQsdW5kZWZpbmVkKXskLndpZGdldCgidWkubWVudSIse3ZlcnNpb246IjEuMTAuNCIsZGVmYXVsdEVsZW1lbnQ6Ijx1bD4iLGRlbGF5OjMwMCxvcHRpb25zOntpY29uczp7c3VibWVudToidWktaWNvbi1jYXJhdC0xLWUifSxtZW51czoidWwiLHBvc2l0aW9uOntteToibGVmdCB0b3AiLGF0OiJyaWdodCB0b3AifSxyb2xlOiJtZW51IixibHVyOm51bGwsZm9jdXM6bnVsbCxzZWxlY3Q6bnVsbH0sX2NyZWF0ZTpmdW5jdGlvbigpe3RoaXMuYWN0aXZlTWVudT10aGlzLmVsZW1lbnQ7dGhpcy5tb3VzZUhhbmRsZWQ9ZmFsc2U7dGhpcy5lbGVtZW50LnVuaXF1ZUlkKCkuYWRkQ2xhc3MoInVpLW1lbnUgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwiKS50b2dnbGVDbGFzcygidWktbWVudS1pY29ucyIsISF0aGlzLmVsZW1lbnQuZmluZCgiLnVpLWljb24iKS5sZW5ndGgpLmF0dHIoe3JvbGU6dGhpcy5vcHRpb25zLnJvbGUsdGFiSW5kZXg6MH0pLmJpbmQoImNsaWNrIit0aGlzLmV2ZW50TmFtZXNwYWNlLCQucHJveHkoZnVuY3Rpb24oZXZlbnQpe2lmKHRoaXMub3B0aW9ucy5kaXNhYmxlZCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9fSx0aGlzKSk7aWYodGhpcy5vcHRpb25zLmRpc2FibGVkKXt0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoInVpLXN0YXRlLWRpc2FibGVkIikuYXR0cigiYXJpYS1kaXNhYmxlZCIsInRydWUiKTt9CnRoaXMuX29uKHsibW91c2Vkb3duIC51aS1tZW51LWl0ZW0gPiBhIjpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9LCJjbGljayAudWktc3RhdGUtZGlzYWJsZWQgPiBhIjpmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTt9LCJjbGljayAudWktbWVudS1pdGVtOmhhcyhhKSI6ZnVuY3Rpb24oZXZlbnQpe3ZhciB0YXJnZXQ9JChldmVudC50YXJnZXQpLmNsb3Nlc3QoIi51aS1tZW51LWl0ZW0iKTtpZighdGhpcy5tb3VzZUhhbmRsZWQmJnRhcmdldC5ub3QoIi51aS1zdGF0ZS1kaXNhYmxlZCIpLmxlbmd0aCl7dGhpcy5zZWxlY3QoZXZlbnQpO2lmKCFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKXt0aGlzLm1vdXNlSGFuZGxlZD10cnVlO30KaWYodGFyZ2V0LmhhcygiLnVpLW1lbnUiKS5sZW5ndGgpe3RoaXMuZXhwYW5kKGV2ZW50KTt9ZWxzZSBpZighdGhpcy5lbGVtZW50LmlzKCI6Zm9jdXMiKSYmJCh0aGlzLmRvY3VtZW50WzBdLmFjdGl2ZUVsZW1lbnQpLmNsb3Nlc3QoIi51aS1tZW51IikubGVuZ3RoKXt0aGlzLmVsZW1lbnQudHJpZ2dlcigiZm9jdXMiLFt0cnVlXSk7aWYodGhpcy5hY3RpdmUmJnRoaXMuYWN0aXZlLnBhcmVudHMoIi51aS1tZW51IikubGVuZ3RoPT09MSl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO319fX0sIm1vdXNlZW50ZXIgLnVpLW1lbnUtaXRlbSI6ZnVuY3Rpb24oZXZlbnQpe3ZhciB0YXJnZXQ9JChldmVudC5jdXJyZW50VGFyZ2V0KTt0YXJnZXQuc2libGluZ3MoKS5jaGlsZHJlbigiLnVpLXN0YXRlLWFjdGl2ZSIpLnJlbW92ZUNsYXNzKCJ1aS1zdGF0ZS1hY3RpdmUiKTt0aGlzLmZvY3VzKGV2ZW50LHRhcmdldCk7fSxtb3VzZWxlYXZlOiJjb2xsYXBzZUFsbCIsIm1vdXNlbGVhdmUgLnVpLW1lbnUiOiJjb2xsYXBzZUFsbCIsZm9jdXM6ZnVuY3Rpb24oZXZlbnQsa2VlcEFjdGl2ZUl0ZW0pe3ZhciBpdGVtPXRoaXMuYWN0aXZlfHx0aGlzLmVsZW1lbnQuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0iKS5lcSgwKTtpZigha2VlcEFjdGl2ZUl0ZW0pe3RoaXMuZm9jdXMoZXZlbnQsaXRlbSk7fX0sYmx1cjpmdW5jdGlvbihldmVudCl7dGhpcy5fZGVsYXkoZnVuY3Rpb24oKXtpZighJC5jb250YWlucyh0aGlzLmVsZW1lbnRbMF0sdGhpcy5kb2N1bWVudFswXS5hY3RpdmVFbGVtZW50KSl7dGhpcy5jb2xsYXBzZUFsbChldmVudCk7fX0pO30sa2V5ZG93bjoiX2tleWRvd24ifSk7dGhpcy5yZWZyZXNoKCk7dGhpcy5fb24odGhpcy5kb2N1bWVudCx7Y2xpY2s6ZnVuY3Rpb24oZXZlbnQpe2lmKCEkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgiLnVpLW1lbnUiKS5sZW5ndGgpe3RoaXMuY29sbGFwc2VBbGwoZXZlbnQpO30KdGhpcy5tb3VzZUhhbmRsZWQ9ZmFsc2U7fX0pO30sX2Rlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cigiYXJpYS1hY3RpdmVkZXNjZW5kYW50IikuZmluZCgiLnVpLW1lbnUiKS5hZGRCYWNrKCkucmVtb3ZlQ2xhc3MoInVpLW1lbnUgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwgdWktbWVudS1pY29ucyIpLnJlbW92ZUF0dHIoInJvbGUiKS5yZW1vdmVBdHRyKCJ0YWJJbmRleCIpLnJlbW92ZUF0dHIoImFyaWEtbGFiZWxsZWRieSIpLnJlbW92ZUF0dHIoImFyaWEtZXhwYW5kZWQiKS5yZW1vdmVBdHRyKCJhcmlhLWhpZGRlbiIpLnJlbW92ZUF0dHIoImFyaWEtZGlzYWJsZWQiKS5yZW1vdmVVbmlxdWVJZCgpLnNob3coKTt0aGlzLmVsZW1lbnQuZmluZCgiLnVpLW1lbnUtaXRlbSIpLnJlbW92ZUNsYXNzKCJ1aS1tZW51LWl0ZW0iKS5yZW1vdmVBdHRyKCJyb2xlIikucmVtb3ZlQXR0cigiYXJpYS1kaXNhYmxlZCIpLmNoaWxkcmVuKCJhIikucmVtb3ZlVW5pcXVlSWQoKS5yZW1vdmVDbGFzcygidWktY29ybmVyLWFsbCB1aS1zdGF0ZS1ob3ZlciIpLnJlbW92ZUF0dHIoInRhYkluZGV4IikucmVtb3ZlQXR0cigicm9sZSIpLnJlbW92ZUF0dHIoImFyaWEtaGFzcG9wdXAiKS5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24oKXt2YXIgZWxlbT0kKHRoaXMpO2lmKGVsZW0uZGF0YSgidWktbWVudS1zdWJtZW51LWNhcmF0Iikpe2VsZW0ucmVtb3ZlKCk7fX0pO3RoaXMuZWxlbWVudC5maW5kKCIudWktbWVudS1kaXZpZGVyIikucmVtb3ZlQ2xhc3MoInVpLW1lbnUtZGl2aWRlciB1aS13aWRnZXQtY29udGVudCIpO30sX2tleWRvd246ZnVuY3Rpb24oZXZlbnQpe3ZhciBtYXRjaCxwcmV2LGNoYXJhY3Rlcixza2lwLHJlZ2V4LHByZXZlbnREZWZhdWx0PXRydWU7ZnVuY3Rpb24gZXNjYXBlKHZhbHVlKXtyZXR1cm4gdmFsdWUucmVwbGFjZSgvW1wtXFtcXXt9KCkqKz8uLFxcXF4kfCNcc10vZywiXFwkJiIpO30Kc3dpdGNoKGV2ZW50LmtleUNvZGUpe2Nhc2UgJC51aS5rZXlDb2RlLlBBR0VfVVA6dGhpcy5wcmV2aW91c1BhZ2UoZXZlbnQpO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLlBBR0VfRE9XTjp0aGlzLm5leHRQYWdlKGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5IT01FOnRoaXMuX21vdmUoImZpcnN0IiwiZmlyc3QiLGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5FTkQ6dGhpcy5fbW92ZSgibGFzdCIsImxhc3QiLGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5VUDp0aGlzLnByZXZpb3VzKGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5ET1dOOnRoaXMubmV4dChldmVudCk7YnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuTEVGVDp0aGlzLmNvbGxhcHNlKGV2ZW50KTticmVhaztjYXNlICQudWkua2V5Q29kZS5SSUdIVDppZih0aGlzLmFjdGl2ZSYmIXRoaXMuYWN0aXZlLmlzKCIudWktc3RhdGUtZGlzYWJsZWQiKSl7dGhpcy5leHBhbmQoZXZlbnQpO30KYnJlYWs7Y2FzZSAkLnVpLmtleUNvZGUuRU5URVI6Y2FzZSAkLnVpLmtleUNvZGUuU1BBQ0U6dGhpcy5fYWN0aXZhdGUoZXZlbnQpO2JyZWFrO2Nhc2UgJC51aS5rZXlDb2RlLkVTQ0FQRTp0aGlzLmNvbGxhcHNlKGV2ZW50KTticmVhaztkZWZhdWx0OnByZXZlbnREZWZhdWx0PWZhbHNlO3ByZXY9dGhpcy5wcmV2aW91c0ZpbHRlcnx8IiI7Y2hhcmFjdGVyPVN0cmluZy5mcm9tQ2hhckNvZGUoZXZlbnQua2V5Q29kZSk7c2tpcD1mYWxzZTtjbGVhclRpbWVvdXQodGhpcy5maWx0ZXJUaW1lcik7aWYoY2hhcmFjdGVyPT09cHJldil7c2tpcD10cnVlO31lbHNle2NoYXJhY3Rlcj1wcmV2K2NoYXJhY3Rlcjt9CnJlZ2V4PW5ldyBSZWdFeHAoIl4iK2VzY2FwZShjaGFyYWN0ZXIpLCJpIik7bWF0Y2g9dGhpcy5hY3RpdmVNZW51LmNoaWxkcmVuKCIudWktbWVudS1pdGVtIikuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHJlZ2V4LnRlc3QoJCh0aGlzKS5jaGlsZHJlbigiYSIpLnRleHQoKSk7fSk7bWF0Y2g9c2tpcCYmbWF0Y2guaW5kZXgodGhpcy5hY3RpdmUubmV4dCgpKSE9PS0xP3RoaXMuYWN0aXZlLm5leHRBbGwoIi51aS1tZW51LWl0ZW0iKTptYXRjaDtpZighbWF0Y2gubGVuZ3RoKXtjaGFyYWN0ZXI9U3RyaW5nLmZyb21DaGFyQ29kZShldmVudC5rZXlDb2RlKTtyZWdleD1uZXcgUmVnRXhwKCJeIitlc2NhcGUoY2hhcmFjdGVyKSwiaSIpO21hdGNoPXRoaXMuYWN0aXZlTWVudS5jaGlsZHJlbigiLnVpLW1lbnUtaXRlbSIpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiByZWdleC50ZXN0KCQodGhpcykuY2hpbGRyZW4oImEiKS50ZXh0KCkpO30pO30KaWYobWF0Y2gubGVuZ3RoKXt0aGlzLmZvY3VzKGV2ZW50LG1hdGNoKTtpZihtYXRjaC5sZW5ndGg+MSl7dGhpcy5wcmV2aW91c0ZpbHRlcj1jaGFyYWN0ZXI7dGhpcy5maWx0ZXJUaW1lcj10aGlzLl9kZWxheShmdW5jdGlvbigpe2RlbGV0ZSB0aGlzLnByZXZpb3VzRmlsdGVyO30sMTAwMCk7fWVsc2V7ZGVsZXRlIHRoaXMucHJldmlvdXNGaWx0ZXI7fX1lbHNle2RlbGV0ZSB0aGlzLnByZXZpb3VzRmlsdGVyO319CmlmKHByZXZlbnREZWZhdWx0KXtldmVudC5wcmV2ZW50RGVmYXVsdCgpO319LF9hY3RpdmF0ZTpmdW5jdGlvbihldmVudCl7aWYoIXRoaXMuYWN0aXZlLmlzKCIudWktc3RhdGUtZGlzYWJsZWQiKSl7aWYodGhpcy5hY3RpdmUuY2hpbGRyZW4oImFbYXJpYS1oYXNwb3B1cD0ndHJ1ZSddIikubGVuZ3RoKXt0aGlzLmV4cGFuZChldmVudCk7fWVsc2V7dGhpcy5zZWxlY3QoZXZlbnQpO319fSxyZWZyZXNoOmZ1bmN0aW9uKCl7dmFyIG1lbnVzLGljb249dGhpcy5vcHRpb25zLmljb25zLnN1Ym1lbnUsc3VibWVudXM9dGhpcy5lbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLm1lbnVzKTt0aGlzLmVsZW1lbnQudG9nZ2xlQ2xhc3MoInVpLW1lbnUtaWNvbnMiLCEhdGhpcy5lbGVtZW50LmZpbmQoIi51aS1pY29uIikubGVuZ3RoKTtzdWJtZW51cy5maWx0ZXIoIjpub3QoLnVpLW1lbnUpIikuYWRkQ2xhc3MoInVpLW1lbnUgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwiKS5oaWRlKCkuYXR0cih7cm9sZTp0aGlzLm9wdGlvbnMucm9sZSwiYXJpYS1oaWRkZW4iOiJ0cnVlIiwiYXJpYS1leHBhbmRlZCI6ImZhbHNlIn0pLmVhY2goZnVuY3Rpb24oKXt2YXIgbWVudT0kKHRoaXMpLGl0ZW09bWVudS5wcmV2KCJhIiksc3VibWVudUNhcmF0PSQoIjxzcGFuPiIpLmFkZENsYXNzKCJ1aS1tZW51LWljb24gdWktaWNvbiAiK2ljb24pLmRhdGEoInVpLW1lbnUtc3VibWVudS1jYXJhdCIsdHJ1ZSk7aXRlbS5hdHRyKCJhcmlhLWhhc3BvcHVwIiwidHJ1ZSIpLnByZXBlbmQoc3VibWVudUNhcmF0KTttZW51LmF0dHIoImFyaWEtbGFiZWxsZWRieSIsaXRlbS5hdHRyKCJpZCIpKTt9KTttZW51cz1zdWJtZW51cy5hZGQodGhpcy5lbGVtZW50KTttZW51cy5jaGlsZHJlbigiOm5vdCgudWktbWVudS1pdGVtKTpoYXMoYSkiKS5hZGRDbGFzcygidWktbWVudS1pdGVtIikuYXR0cigicm9sZSIsInByZXNlbnRhdGlvbiIpLmNoaWxkcmVuKCJhIikudW5pcXVlSWQoKS5hZGRDbGFzcygidWktY29ybmVyLWFsbCIpLmF0dHIoe3RhYkluZGV4Oi0xLHJvbGU6dGhpcy5faXRlbVJvbGUoKX0pO21lbnVzLmNoaWxkcmVuKCI6bm90KC51aS1tZW51LWl0ZW0pIikuZWFjaChmdW5jdGlvbigpe3ZhciBpdGVtPSQodGhpcyk7aWYoIS9bXlwtXHUyMDE0XHUyMDEzXHNdLy50ZXN0KGl0ZW0udGV4dCgpKSl7aXRlbS5hZGRDbGFzcygidWktd2lkZ2V0LWNvbnRlbnQgdWktbWVudS1kaXZpZGVyIik7fX0pO21lbnVzLmNoaWxkcmVuKCIudWktc3RhdGUtZGlzYWJsZWQiKS5hdHRyKCJhcmlhLWRpc2FibGVkIiwidHJ1ZSIpO2lmKHRoaXMuYWN0aXZlJiYhJC5jb250YWlucyh0aGlzLmVsZW1lbnRbMF0sdGhpcy5hY3RpdmVbMF0pKXt0aGlzLmJsdXIoKTt9fSxfaXRlbVJvbGU6ZnVuY3Rpb24oKXtyZXR1cm57bWVudToibWVudWl0ZW0iLGxpc3Rib3g6Im9wdGlvbiJ9W3RoaXMub3B0aW9ucy5yb2xlXTt9LF9zZXRPcHRpb246ZnVuY3Rpb24oa2V5LHZhbHVlKXtpZihrZXk9PT0iaWNvbnMiKXt0aGlzLmVsZW1lbnQuZmluZCgiLnVpLW1lbnUtaWNvbiIpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5pY29ucy5zdWJtZW51KS5hZGRDbGFzcyh2YWx1ZS5zdWJtZW51KTt9CnRoaXMuX3N1cGVyKGtleSx2YWx1ZSk7fSxmb2N1czpmdW5jdGlvbihldmVudCxpdGVtKXt2YXIgbmVzdGVkLGZvY3VzZWQ7dGhpcy5ibHVyKGV2ZW50LGV2ZW50JiZldmVudC50eXBlPT09ImZvY3VzIik7dGhpcy5fc2Nyb2xsSW50b1ZpZXcoaXRlbSk7dGhpcy5hY3RpdmU9aXRlbS5maXJzdCgpO2ZvY3VzZWQ9dGhpcy5hY3RpdmUuY2hpbGRyZW4oImEiKS5hZGRDbGFzcygidWktc3RhdGUtZm9jdXMiKTtpZih0aGlzLm9wdGlvbnMucm9sZSl7dGhpcy5lbGVtZW50LmF0dHIoImFyaWEtYWN0aXZlZGVzY2VuZGFudCIsZm9jdXNlZC5hdHRyKCJpZCIpKTt9CnRoaXMuYWN0aXZlLnBhcmVudCgpLmNsb3Nlc3QoIi51aS1tZW51LWl0ZW0iKS5jaGlsZHJlbigiYTpmaXJzdCIpLmFkZENsYXNzKCJ1aS1zdGF0ZS1hY3RpdmUiKTtpZihldmVudCYmZXZlbnQudHlwZT09PSJrZXlkb3duIil7dGhpcy5fY2xvc2UoKTt9ZWxzZXt0aGlzLnRpbWVyPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5fY2xvc2UoKTt9LHRoaXMuZGVsYXkpO30KbmVzdGVkPWl0ZW0uY2hpbGRyZW4oIi51aS1tZW51Iik7aWYobmVzdGVkLmxlbmd0aCYmZXZlbnQmJigvXm1vdXNlLy50ZXN0KGV2ZW50LnR5cGUpKSl7dGhpcy5fc3RhcnRPcGVuaW5nKG5lc3RlZCk7fQp0aGlzLmFjdGl2ZU1lbnU9aXRlbS5wYXJlbnQoKTt0aGlzLl90cmlnZ2VyKCJmb2N1cyIsZXZlbnQse2l0ZW06aXRlbX0pO30sX3Njcm9sbEludG9WaWV3OmZ1bmN0aW9uKGl0ZW0pe3ZhciBib3JkZXJUb3AscGFkZGluZ1RvcCxvZmZzZXQsc2Nyb2xsLGVsZW1lbnRIZWlnaHQsaXRlbUhlaWdodDtpZih0aGlzLl9oYXNTY3JvbGwoKSl7Ym9yZGVyVG9wPXBhcnNlRmxvYXQoJC5jc3ModGhpcy5hY3RpdmVNZW51WzBdLCJib3JkZXJUb3BXaWR0aCIpKXx8MDtwYWRkaW5nVG9wPXBhcnNlRmxvYXQoJC5jc3ModGhpcy5hY3RpdmVNZW51WzBdLCJwYWRkaW5nVG9wIikpfHwwO29mZnNldD1pdGVtLm9mZnNldCgpLnRvcC10aGlzLmFjdGl2ZU1lbnUub2Zmc2V0KCkudG9wLWJvcmRlclRvcC1wYWRkaW5nVG9wO3Njcm9sbD10aGlzLmFjdGl2ZU1lbnUuc2Nyb2xsVG9wKCk7ZWxlbWVudEhlaWdodD10aGlzLmFjdGl2ZU1lbnUuaGVpZ2h0KCk7aXRlbUhlaWdodD1pdGVtLmhlaWdodCgpO2lmKG9mZnNldDwwKXt0aGlzLmFjdGl2ZU1lbnUuc2Nyb2xsVG9wKHNjcm9sbCtvZmZzZXQpO31lbHNlIGlmKG9mZnNldCtpdGVtSGVpZ2h0PmVsZW1lbnRIZWlnaHQpe3RoaXMuYWN0aXZlTWVudS5zY3JvbGxUb3Aoc2Nyb2xsK29mZnNldC1lbGVtZW50SGVpZ2h0K2l0ZW1IZWlnaHQpO319fSxibHVyOmZ1bmN0aW9uKGV2ZW50LGZyb21Gb2N1cyl7aWYoIWZyb21Gb2N1cyl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO30KaWYoIXRoaXMuYWN0aXZlKXtyZXR1cm47fQp0aGlzLmFjdGl2ZS5jaGlsZHJlbigiYSIpLnJlbW92ZUNsYXNzKCJ1aS1zdGF0ZS1mb2N1cyIpO3RoaXMuYWN0aXZlPW51bGw7dGhpcy5fdHJpZ2dlcigiYmx1ciIsZXZlbnQse2l0ZW06dGhpcy5hY3RpdmV9KTt9LF9zdGFydE9wZW5pbmc6ZnVuY3Rpb24oc3VibWVudSl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO2lmKHN1Ym1lbnUuYXR0cigiYXJpYS1oaWRkZW4iKSE9PSJ0cnVlIil7cmV0dXJuO30KdGhpcy50aW1lcj10aGlzLl9kZWxheShmdW5jdGlvbigpe3RoaXMuX2Nsb3NlKCk7dGhpcy5fb3BlbihzdWJtZW51KTt9LHRoaXMuZGVsYXkpO30sX29wZW46ZnVuY3Rpb24oc3VibWVudSl7dmFyIHBvc2l0aW9uPSQuZXh0ZW5kKHtvZjp0aGlzLmFjdGl2ZX0sdGhpcy5vcHRpb25zLnBvc2l0aW9uKTtjbGVhclRpbWVvdXQodGhpcy50aW1lcik7dGhpcy5lbGVtZW50LmZpbmQoIi51aS1tZW51Iikubm90KHN1Ym1lbnUucGFyZW50cygiLnVpLW1lbnUiKSkuaGlkZSgpLmF0dHIoImFyaWEtaGlkZGVuIiwidHJ1ZSIpO3N1Ym1lbnUuc2hvdygpLnJlbW92ZUF0dHIoImFyaWEtaGlkZGVuIikuYXR0cigiYXJpYS1leHBhbmRlZCIsInRydWUiKS5wb3NpdGlvbihwb3NpdGlvbik7fSxjb2xsYXBzZUFsbDpmdW5jdGlvbihldmVudCxhbGwpe2NsZWFyVGltZW91dCh0aGlzLnRpbWVyKTt0aGlzLnRpbWVyPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dmFyIGN1cnJlbnRNZW51PWFsbD90aGlzLmVsZW1lbnQ6JChldmVudCYmZXZlbnQudGFyZ2V0KS5jbG9zZXN0KHRoaXMuZWxlbWVudC5maW5kKCIudWktbWVudSIpKTtpZighY3VycmVudE1lbnUubGVuZ3RoKXtjdXJyZW50TWVudT10aGlzLmVsZW1lbnQ7fQp0aGlzLl9jbG9zZShjdXJyZW50TWVudSk7dGhpcy5ibHVyKGV2ZW50KTt0aGlzLmFjdGl2ZU1lbnU9Y3VycmVudE1lbnU7fSx0aGlzLmRlbGF5KTt9LF9jbG9zZTpmdW5jdGlvbihzdGFydE1lbnUpe2lmKCFzdGFydE1lbnUpe3N0YXJ0TWVudT10aGlzLmFjdGl2ZT90aGlzLmFjdGl2ZS5wYXJlbnQoKTp0aGlzLmVsZW1lbnQ7fQpzdGFydE1lbnUuZmluZCgiLnVpLW1lbnUiKS5oaWRlKCkuYXR0cigiYXJpYS1oaWRkZW4iLCJ0cnVlIikuYXR0cigiYXJpYS1leHBhbmRlZCIsImZhbHNlIikuZW5kKCkuZmluZCgiYS51aS1zdGF0ZS1hY3RpdmUiKS5yZW1vdmVDbGFzcygidWktc3RhdGUtYWN0aXZlIik7fSxjb2xsYXBzZTpmdW5jdGlvbihldmVudCl7dmFyIG5ld0l0ZW09dGhpcy5hY3RpdmUmJnRoaXMuYWN0aXZlLnBhcmVudCgpLmNsb3Nlc3QoIi51aS1tZW51LWl0ZW0iLHRoaXMuZWxlbWVudCk7aWYobmV3SXRlbSYmbmV3SXRlbS5sZW5ndGgpe3RoaXMuX2Nsb3NlKCk7dGhpcy5mb2N1cyhldmVudCxuZXdJdGVtKTt9fSxleHBhbmQ6ZnVuY3Rpb24oZXZlbnQpe3ZhciBuZXdJdGVtPXRoaXMuYWN0aXZlJiZ0aGlzLmFjdGl2ZS5jaGlsZHJlbigiLnVpLW1lbnUgIikuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0iKS5maXJzdCgpO2lmKG5ld0l0ZW0mJm5ld0l0ZW0ubGVuZ3RoKXt0aGlzLl9vcGVuKG5ld0l0ZW0ucGFyZW50KCkpO3RoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5mb2N1cyhldmVudCxuZXdJdGVtKTt9KTt9fSxuZXh0OmZ1bmN0aW9uKGV2ZW50KXt0aGlzLl9tb3ZlKCJuZXh0IiwiZmlyc3QiLGV2ZW50KTt9LHByZXZpb3VzOmZ1bmN0aW9uKGV2ZW50KXt0aGlzLl9tb3ZlKCJwcmV2IiwibGFzdCIsZXZlbnQpO30saXNGaXJzdEl0ZW06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hY3RpdmUmJiF0aGlzLmFjdGl2ZS5wcmV2QWxsKCIudWktbWVudS1pdGVtIikubGVuZ3RoO30saXNMYXN0SXRlbTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFjdGl2ZSYmIXRoaXMuYWN0aXZlLm5leHRBbGwoIi51aS1tZW51LWl0ZW0iKS5sZW5ndGg7fSxfbW92ZTpmdW5jdGlvbihkaXJlY3Rpb24sZmlsdGVyLGV2ZW50KXt2YXIgbmV4dDtpZih0aGlzLmFjdGl2ZSl7aWYoZGlyZWN0aW9uPT09ImZpcnN0Inx8ZGlyZWN0aW9uPT09Imxhc3QiKXtuZXh0PXRoaXMuYWN0aXZlCltkaXJlY3Rpb249PT0iZmlyc3QiPyJwcmV2QWxsIjoibmV4dEFsbCJdKCIudWktbWVudS1pdGVtIikuZXEoLTEpO31lbHNle25leHQ9dGhpcy5hY3RpdmUKW2RpcmVjdGlvbisiQWxsIl0oIi51aS1tZW51LWl0ZW0iKS5lcSgwKTt9fQppZighbmV4dHx8IW5leHQubGVuZ3RofHwhdGhpcy5hY3RpdmUpe25leHQ9dGhpcy5hY3RpdmVNZW51LmNoaWxkcmVuKCIudWktbWVudS1pdGVtIilbZmlsdGVyXSgpO30KdGhpcy5mb2N1cyhldmVudCxuZXh0KTt9LG5leHRQYWdlOmZ1bmN0aW9uKGV2ZW50KXt2YXIgaXRlbSxiYXNlLGhlaWdodDtpZighdGhpcy5hY3RpdmUpe3RoaXMubmV4dChldmVudCk7cmV0dXJuO30KaWYodGhpcy5pc0xhc3RJdGVtKCkpe3JldHVybjt9CmlmKHRoaXMuX2hhc1Njcm9sbCgpKXtiYXNlPXRoaXMuYWN0aXZlLm9mZnNldCgpLnRvcDtoZWlnaHQ9dGhpcy5lbGVtZW50LmhlaWdodCgpO3RoaXMuYWN0aXZlLm5leHRBbGwoIi51aS1tZW51LWl0ZW0iKS5lYWNoKGZ1bmN0aW9uKCl7aXRlbT0kKHRoaXMpO3JldHVybiBpdGVtLm9mZnNldCgpLnRvcC1iYXNlLWhlaWdodDwwO30pO3RoaXMuZm9jdXMoZXZlbnQsaXRlbSk7fWVsc2V7dGhpcy5mb2N1cyhldmVudCx0aGlzLmFjdGl2ZU1lbnUuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0iKQpbIXRoaXMuYWN0aXZlPyJmaXJzdCI6Imxhc3QiXSgpKTt9fSxwcmV2aW91c1BhZ2U6ZnVuY3Rpb24oZXZlbnQpe3ZhciBpdGVtLGJhc2UsaGVpZ2h0O2lmKCF0aGlzLmFjdGl2ZSl7dGhpcy5uZXh0KGV2ZW50KTtyZXR1cm47fQppZih0aGlzLmlzRmlyc3RJdGVtKCkpe3JldHVybjt9CmlmKHRoaXMuX2hhc1Njcm9sbCgpKXtiYXNlPXRoaXMuYWN0aXZlLm9mZnNldCgpLnRvcDtoZWlnaHQ9dGhpcy5lbGVtZW50LmhlaWdodCgpO3RoaXMuYWN0aXZlLnByZXZBbGwoIi51aS1tZW51LWl0ZW0iKS5lYWNoKGZ1bmN0aW9uKCl7aXRlbT0kKHRoaXMpO3JldHVybiBpdGVtLm9mZnNldCgpLnRvcC1iYXNlK2hlaWdodD4wO30pO3RoaXMuZm9jdXMoZXZlbnQsaXRlbSk7fWVsc2V7dGhpcy5mb2N1cyhldmVudCx0aGlzLmFjdGl2ZU1lbnUuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0iKS5maXJzdCgpKTt9fSxfaGFzU2Nyb2xsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpPHRoaXMuZWxlbWVudC5wcm9wKCJzY3JvbGxIZWlnaHQiKTt9LHNlbGVjdDpmdW5jdGlvbihldmVudCl7dGhpcy5hY3RpdmU9dGhpcy5hY3RpdmV8fCQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KCIudWktbWVudS1pdGVtIik7dmFyIHVpPXtpdGVtOnRoaXMuYWN0aXZlfTtpZighdGhpcy5hY3RpdmUuaGFzKCIudWktbWVudSIpLmxlbmd0aCl7dGhpcy5jb2xsYXBzZUFsbChldmVudCx0cnVlKTt9CnRoaXMuX3RyaWdnZXIoInNlbGVjdCIsZXZlbnQsdWkpO319KTt9KGpRdWVyeSkpOyhmdW5jdGlvbigpe3ZhciByb290PXRoaXM7dmFyIHByZXZpb3VzVW5kZXJzY29yZT1yb290Ll87dmFyIGJyZWFrZXI9e307dmFyIEFycmF5UHJvdG89QXJyYXkucHJvdG90eXBlLE9ialByb3RvPU9iamVjdC5wcm90b3R5cGUsRnVuY1Byb3RvPUZ1bmN0aW9uLnByb3RvdHlwZTt2YXIKcHVzaD1BcnJheVByb3RvLnB1c2gsc2xpY2U9QXJyYXlQcm90by5zbGljZSxjb25jYXQ9QXJyYXlQcm90by5jb25jYXQsdG9TdHJpbmc9T2JqUHJvdG8udG9TdHJpbmcsaGFzT3duUHJvcGVydHk9T2JqUHJvdG8uaGFzT3duUHJvcGVydHk7dmFyCm5hdGl2ZUZvckVhY2g9QXJyYXlQcm90by5mb3JFYWNoLG5hdGl2ZU1hcD1BcnJheVByb3RvLm1hcCxuYXRpdmVSZWR1Y2U9QXJyYXlQcm90by5yZWR1Y2UsbmF0aXZlUmVkdWNlUmlnaHQ9QXJyYXlQcm90by5yZWR1Y2VSaWdodCxuYXRpdmVGaWx0ZXI9QXJyYXlQcm90by5maWx0ZXIsbmF0aXZlRXZlcnk9QXJyYXlQcm90by5ldmVyeSxuYXRpdmVTb21lPUFycmF5UHJvdG8uc29tZSxuYXRpdmVJbmRleE9mPUFycmF5UHJvdG8uaW5kZXhPZixuYXRpdmVMYXN0SW5kZXhPZj1BcnJheVByb3RvLmxhc3RJbmRleE9mLG5hdGl2ZUlzQXJyYXk9QXJyYXkuaXNBcnJheSxuYXRpdmVLZXlzPU9iamVjdC5rZXlzLG5hdGl2ZUJpbmQ9RnVuY1Byb3RvLmJpbmQ7dmFyIF89ZnVuY3Rpb24ob2JqKXtpZihvYmogaW5zdGFuY2VvZiBfKXJldHVybiBvYmo7aWYoISh0aGlzIGluc3RhbmNlb2YgXykpcmV0dXJuIG5ldyBfKG9iaik7dGhpcy5fd3JhcHBlZD1vYmo7fTtpZih0eXBlb2YgZXhwb3J0cyE9PSd1bmRlZmluZWQnKXtpZih0eXBlb2YgbW9kdWxlIT09J3VuZGVmaW5lZCcmJm1vZHVsZS5leHBvcnRzKXtleHBvcnRzPW1vZHVsZS5leHBvcnRzPV87fQpleHBvcnRzLl89Xzt9ZWxzZXtyb290Ll89Xzt9Cl8uVkVSU0lPTj0nMS41LjInO3ZhciBlYWNoPV8uZWFjaD1fLmZvckVhY2g9ZnVuY3Rpb24ob2JqLGl0ZXJhdG9yLGNvbnRleHQpe2lmKG9iaj09bnVsbClyZXR1cm47aWYobmF0aXZlRm9yRWFjaCYmb2JqLmZvckVhY2g9PT1uYXRpdmVGb3JFYWNoKXtvYmouZm9yRWFjaChpdGVyYXRvcixjb250ZXh0KTt9ZWxzZSBpZihvYmoubGVuZ3RoPT09K29iai5sZW5ndGgpe2Zvcih2YXIgaT0wLGxlbmd0aD1vYmoubGVuZ3RoO2k8bGVuZ3RoO2krKyl7aWYoaXRlcmF0b3IuY2FsbChjb250ZXh0LG9ialtpXSxpLG9iaik9PT1icmVha2VyKXJldHVybjt9fWVsc2V7dmFyIGtleXM9Xy5rZXlzKG9iaik7Zm9yKHZhciBpPTAsbGVuZ3RoPWtleXMubGVuZ3RoO2k8bGVuZ3RoO2krKyl7aWYoaXRlcmF0b3IuY2FsbChjb250ZXh0LG9ialtrZXlzW2ldXSxrZXlzW2ldLG9iaik9PT1icmVha2VyKXJldHVybjt9fX07Xy5tYXA9Xy5jb2xsZWN0PWZ1bmN0aW9uKG9iaixpdGVyYXRvcixjb250ZXh0KXt2YXIgcmVzdWx0cz1bXTtpZihvYmo9PW51bGwpcmV0dXJuIHJlc3VsdHM7aWYobmF0aXZlTWFwJiZvYmoubWFwPT09bmF0aXZlTWFwKXJldHVybiBvYmoubWFwKGl0ZXJhdG9yLGNvbnRleHQpO2VhY2gob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe3Jlc3VsdHMucHVzaChpdGVyYXRvci5jYWxsKGNvbnRleHQsdmFsdWUsaW5kZXgsbGlzdCkpO30pO3JldHVybiByZXN1bHRzO307dmFyIHJlZHVjZUVycm9yPSdSZWR1Y2Ugb2YgZW1wdHkgYXJyYXkgd2l0aCBubyBpbml0aWFsIHZhbHVlJztfLnJlZHVjZT1fLmZvbGRsPV8uaW5qZWN0PWZ1bmN0aW9uKG9iaixpdGVyYXRvcixtZW1vLGNvbnRleHQpe3ZhciBpbml0aWFsPWFyZ3VtZW50cy5sZW5ndGg+MjtpZihvYmo9PW51bGwpb2JqPVtdO2lmKG5hdGl2ZVJlZHVjZSYmb2JqLnJlZHVjZT09PW5hdGl2ZVJlZHVjZSl7aWYoY29udGV4dClpdGVyYXRvcj1fLmJpbmQoaXRlcmF0b3IsY29udGV4dCk7cmV0dXJuIGluaXRpYWw/b2JqLnJlZHVjZShpdGVyYXRvcixtZW1vKTpvYmoucmVkdWNlKGl0ZXJhdG9yKTt9CmVhY2gob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe2lmKCFpbml0aWFsKXttZW1vPXZhbHVlO2luaXRpYWw9dHJ1ZTt9ZWxzZXttZW1vPWl0ZXJhdG9yLmNhbGwoY29udGV4dCxtZW1vLHZhbHVlLGluZGV4LGxpc3QpO319KTtpZighaW5pdGlhbCl0aHJvdyBuZXcgVHlwZUVycm9yKHJlZHVjZUVycm9yKTtyZXR1cm4gbWVtbzt9O18ucmVkdWNlUmlnaHQ9Xy5mb2xkcj1mdW5jdGlvbihvYmosaXRlcmF0b3IsbWVtbyxjb250ZXh0KXt2YXIgaW5pdGlhbD1hcmd1bWVudHMubGVuZ3RoPjI7aWYob2JqPT1udWxsKW9iaj1bXTtpZihuYXRpdmVSZWR1Y2VSaWdodCYmb2JqLnJlZHVjZVJpZ2h0PT09bmF0aXZlUmVkdWNlUmlnaHQpe2lmKGNvbnRleHQpaXRlcmF0b3I9Xy5iaW5kKGl0ZXJhdG9yLGNvbnRleHQpO3JldHVybiBpbml0aWFsP29iai5yZWR1Y2VSaWdodChpdGVyYXRvcixtZW1vKTpvYmoucmVkdWNlUmlnaHQoaXRlcmF0b3IpO30KdmFyIGxlbmd0aD1vYmoubGVuZ3RoO2lmKGxlbmd0aCE9PStsZW5ndGgpe3ZhciBrZXlzPV8ua2V5cyhvYmopO2xlbmd0aD1rZXlzLmxlbmd0aDt9CmVhY2gob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe2luZGV4PWtleXM/a2V5c1stLWxlbmd0aF06LS1sZW5ndGg7aWYoIWluaXRpYWwpe21lbW89b2JqW2luZGV4XTtpbml0aWFsPXRydWU7fWVsc2V7bWVtbz1pdGVyYXRvci5jYWxsKGNvbnRleHQsbWVtbyxvYmpbaW5kZXhdLGluZGV4LGxpc3QpO319KTtpZighaW5pdGlhbCl0aHJvdyBuZXcgVHlwZUVycm9yKHJlZHVjZUVycm9yKTtyZXR1cm4gbWVtbzt9O18uZmluZD1fLmRldGVjdD1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7dmFyIHJlc3VsdDthbnkob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe2lmKGl0ZXJhdG9yLmNhbGwoY29udGV4dCx2YWx1ZSxpbmRleCxsaXN0KSl7cmVzdWx0PXZhbHVlO3JldHVybiB0cnVlO319KTtyZXR1cm4gcmVzdWx0O307Xy5maWx0ZXI9Xy5zZWxlY3Q9ZnVuY3Rpb24ob2JqLGl0ZXJhdG9yLGNvbnRleHQpe3ZhciByZXN1bHRzPVtdO2lmKG9iaj09bnVsbClyZXR1cm4gcmVzdWx0cztpZihuYXRpdmVGaWx0ZXImJm9iai5maWx0ZXI9PT1uYXRpdmVGaWx0ZXIpcmV0dXJuIG9iai5maWx0ZXIoaXRlcmF0b3IsY29udGV4dCk7ZWFjaChvYmosZnVuY3Rpb24odmFsdWUsaW5kZXgsbGlzdCl7aWYoaXRlcmF0b3IuY2FsbChjb250ZXh0LHZhbHVlLGluZGV4LGxpc3QpKXJlc3VsdHMucHVzaCh2YWx1ZSk7fSk7cmV0dXJuIHJlc3VsdHM7fTtfLnJlamVjdD1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7cmV0dXJuIF8uZmlsdGVyKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCxsaXN0KXtyZXR1cm4haXRlcmF0b3IuY2FsbChjb250ZXh0LHZhbHVlLGluZGV4LGxpc3QpO30sY29udGV4dCk7fTtfLmV2ZXJ5PV8uYWxsPWZ1bmN0aW9uKG9iaixpdGVyYXRvcixjb250ZXh0KXtpdGVyYXRvcnx8KGl0ZXJhdG9yPV8uaWRlbnRpdHkpO3ZhciByZXN1bHQ9dHJ1ZTtpZihvYmo9PW51bGwpcmV0dXJuIHJlc3VsdDtpZihuYXRpdmVFdmVyeSYmb2JqLmV2ZXJ5PT09bmF0aXZlRXZlcnkpcmV0dXJuIG9iai5ldmVyeShpdGVyYXRvcixjb250ZXh0KTtlYWNoKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCxsaXN0KXtpZighKHJlc3VsdD1yZXN1bHQmJml0ZXJhdG9yLmNhbGwoY29udGV4dCx2YWx1ZSxpbmRleCxsaXN0KSkpcmV0dXJuIGJyZWFrZXI7fSk7cmV0dXJuISFyZXN1bHQ7fTt2YXIgYW55PV8uc29tZT1fLmFueT1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7aXRlcmF0b3J8fChpdGVyYXRvcj1fLmlkZW50aXR5KTt2YXIgcmVzdWx0PWZhbHNlO2lmKG9iaj09bnVsbClyZXR1cm4gcmVzdWx0O2lmKG5hdGl2ZVNvbWUmJm9iai5zb21lPT09bmF0aXZlU29tZSlyZXR1cm4gb2JqLnNvbWUoaXRlcmF0b3IsY29udGV4dCk7ZWFjaChvYmosZnVuY3Rpb24odmFsdWUsaW5kZXgsbGlzdCl7aWYocmVzdWx0fHwocmVzdWx0PWl0ZXJhdG9yLmNhbGwoY29udGV4dCx2YWx1ZSxpbmRleCxsaXN0KSkpcmV0dXJuIGJyZWFrZXI7fSk7cmV0dXJuISFyZXN1bHQ7fTtfLmNvbnRhaW5zPV8uaW5jbHVkZT1mdW5jdGlvbihvYmosdGFyZ2V0KXtpZihvYmo9PW51bGwpcmV0dXJuIGZhbHNlO2lmKG5hdGl2ZUluZGV4T2YmJm9iai5pbmRleE9mPT09bmF0aXZlSW5kZXhPZilyZXR1cm4gb2JqLmluZGV4T2YodGFyZ2V0KSE9LTE7cmV0dXJuIGFueShvYmosZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZT09PXRhcmdldDt9KTt9O18uaW52b2tlPWZ1bmN0aW9uKG9iaixtZXRob2Qpe3ZhciBhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3ZhciBpc0Z1bmM9Xy5pc0Z1bmN0aW9uKG1ldGhvZCk7cmV0dXJuIF8ubWFwKG9iaixmdW5jdGlvbih2YWx1ZSl7cmV0dXJuKGlzRnVuYz9tZXRob2Q6dmFsdWVbbWV0aG9kXSkuYXBwbHkodmFsdWUsYXJncyk7fSk7fTtfLnBsdWNrPWZ1bmN0aW9uKG9iaixrZXkpe3JldHVybiBfLm1hcChvYmosZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZVtrZXldO30pO307Xy53aGVyZT1mdW5jdGlvbihvYmosYXR0cnMsZmlyc3Qpe2lmKF8uaXNFbXB0eShhdHRycykpcmV0dXJuIGZpcnN0P3ZvaWQgMDpbXTtyZXR1cm4gX1tmaXJzdD8nZmluZCc6J2ZpbHRlciddKG9iaixmdW5jdGlvbih2YWx1ZSl7Zm9yKHZhciBrZXkgaW4gYXR0cnMpe2lmKGF0dHJzW2tleV0hPT12YWx1ZVtrZXldKXJldHVybiBmYWxzZTt9CnJldHVybiB0cnVlO30pO307Xy5maW5kV2hlcmU9ZnVuY3Rpb24ob2JqLGF0dHJzKXtyZXR1cm4gXy53aGVyZShvYmosYXR0cnMsdHJ1ZSk7fTtfLm1heD1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7aWYoIWl0ZXJhdG9yJiZfLmlzQXJyYXkob2JqKSYmb2JqWzBdPT09K29ialswXSYmb2JqLmxlbmd0aDw2NTUzNSl7cmV0dXJuIE1hdGgubWF4LmFwcGx5KE1hdGgsb2JqKTt9CmlmKCFpdGVyYXRvciYmXy5pc0VtcHR5KG9iaikpcmV0dXJuLUluZmluaXR5O3ZhciByZXN1bHQ9e2NvbXB1dGVkOi1JbmZpbml0eSx2YWx1ZTotSW5maW5pdHl9O2VhY2gob2JqLGZ1bmN0aW9uKHZhbHVlLGluZGV4LGxpc3Qpe3ZhciBjb21wdXRlZD1pdGVyYXRvcj9pdGVyYXRvci5jYWxsKGNvbnRleHQsdmFsdWUsaW5kZXgsbGlzdCk6dmFsdWU7Y29tcHV0ZWQ+cmVzdWx0LmNvbXB1dGVkJiYocmVzdWx0PXt2YWx1ZTp2YWx1ZSxjb21wdXRlZDpjb21wdXRlZH0pO30pO3JldHVybiByZXN1bHQudmFsdWU7fTtfLm1pbj1mdW5jdGlvbihvYmosaXRlcmF0b3IsY29udGV4dCl7aWYoIWl0ZXJhdG9yJiZfLmlzQXJyYXkob2JqKSYmb2JqWzBdPT09K29ialswXSYmb2JqLmxlbmd0aDw2NTUzNSl7cmV0dXJuIE1hdGgubWluLmFwcGx5KE1hdGgsb2JqKTt9CmlmKCFpdGVyYXRvciYmXy5pc0VtcHR5KG9iaikpcmV0dXJuIEluZmluaXR5O3ZhciByZXN1bHQ9e2NvbXB1dGVkOkluZmluaXR5LHZhbHVlOkluZmluaXR5fTtlYWNoKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCxsaXN0KXt2YXIgY29tcHV0ZWQ9aXRlcmF0b3I/aXRlcmF0b3IuY2FsbChjb250ZXh0LHZhbHVlLGluZGV4LGxpc3QpOnZhbHVlO2NvbXB1dGVkPHJlc3VsdC5jb21wdXRlZCYmKHJlc3VsdD17dmFsdWU6dmFsdWUsY29tcHV0ZWQ6Y29tcHV0ZWR9KTt9KTtyZXR1cm4gcmVzdWx0LnZhbHVlO307Xy5zaHVmZmxlPWZ1bmN0aW9uKG9iail7dmFyIHJhbmQ7dmFyIGluZGV4PTA7dmFyIHNodWZmbGVkPVtdO2VhY2gob2JqLGZ1bmN0aW9uKHZhbHVlKXtyYW5kPV8ucmFuZG9tKGluZGV4KyspO3NodWZmbGVkW2luZGV4LTFdPXNodWZmbGVkW3JhbmRdO3NodWZmbGVkW3JhbmRdPXZhbHVlO30pO3JldHVybiBzaHVmZmxlZDt9O18uc2FtcGxlPWZ1bmN0aW9uKG9iaixuLGd1YXJkKXtpZihhcmd1bWVudHMubGVuZ3RoPDJ8fGd1YXJkKXtyZXR1cm4gb2JqW18ucmFuZG9tKG9iai5sZW5ndGgtMSldO30KcmV0dXJuIF8uc2h1ZmZsZShvYmopLnNsaWNlKDAsTWF0aC5tYXgoMCxuKSk7fTt2YXIgbG9va3VwSXRlcmF0b3I9ZnVuY3Rpb24odmFsdWUpe3JldHVybiBfLmlzRnVuY3Rpb24odmFsdWUpP3ZhbHVlOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9ialt2YWx1ZV07fTt9O18uc29ydEJ5PWZ1bmN0aW9uKG9iaix2YWx1ZSxjb250ZXh0KXt2YXIgaXRlcmF0b3I9bG9va3VwSXRlcmF0b3IodmFsdWUpO3JldHVybiBfLnBsdWNrKF8ubWFwKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCxsaXN0KXtyZXR1cm57dmFsdWU6dmFsdWUsaW5kZXg6aW5kZXgsY3JpdGVyaWE6aXRlcmF0b3IuY2FsbChjb250ZXh0LHZhbHVlLGluZGV4LGxpc3QpfTt9KS5zb3J0KGZ1bmN0aW9uKGxlZnQscmlnaHQpe3ZhciBhPWxlZnQuY3JpdGVyaWE7dmFyIGI9cmlnaHQuY3JpdGVyaWE7aWYoYSE9PWIpe2lmKGE+Ynx8YT09PXZvaWQgMClyZXR1cm4gMTtpZihhPGJ8fGI9PT12b2lkIDApcmV0dXJuLTE7fQpyZXR1cm4gbGVmdC5pbmRleC1yaWdodC5pbmRleDt9KSwndmFsdWUnKTt9O3ZhciBncm91cD1mdW5jdGlvbihiZWhhdmlvcil7cmV0dXJuIGZ1bmN0aW9uKG9iaix2YWx1ZSxjb250ZXh0KXt2YXIgcmVzdWx0PXt9O3ZhciBpdGVyYXRvcj12YWx1ZT09bnVsbD9fLmlkZW50aXR5Omxvb2t1cEl0ZXJhdG9yKHZhbHVlKTtlYWNoKG9iaixmdW5jdGlvbih2YWx1ZSxpbmRleCl7dmFyIGtleT1pdGVyYXRvci5jYWxsKGNvbnRleHQsdmFsdWUsaW5kZXgsb2JqKTtiZWhhdmlvcihyZXN1bHQsa2V5LHZhbHVlKTt9KTtyZXR1cm4gcmVzdWx0O307fTtfLmdyb3VwQnk9Z3JvdXAoZnVuY3Rpb24ocmVzdWx0LGtleSx2YWx1ZSl7KF8uaGFzKHJlc3VsdCxrZXkpP3Jlc3VsdFtrZXldOihyZXN1bHRba2V5XT1bXSkpLnB1c2godmFsdWUpO30pO18uaW5kZXhCeT1ncm91cChmdW5jdGlvbihyZXN1bHQsa2V5LHZhbHVlKXtyZXN1bHRba2V5XT12YWx1ZTt9KTtfLmNvdW50Qnk9Z3JvdXAoZnVuY3Rpb24ocmVzdWx0LGtleSl7Xy5oYXMocmVzdWx0LGtleSk/cmVzdWx0W2tleV0rKzpyZXN1bHRba2V5XT0xO30pO18uc29ydGVkSW5kZXg9ZnVuY3Rpb24oYXJyYXksb2JqLGl0ZXJhdG9yLGNvbnRleHQpe2l0ZXJhdG9yPWl0ZXJhdG9yPT1udWxsP18uaWRlbnRpdHk6bG9va3VwSXRlcmF0b3IoaXRlcmF0b3IpO3ZhciB2YWx1ZT1pdGVyYXRvci5jYWxsKGNvbnRleHQsb2JqKTt2YXIgbG93PTAsaGlnaD1hcnJheS5sZW5ndGg7d2hpbGUobG93PGhpZ2gpe3ZhciBtaWQ9KGxvdytoaWdoKT4+PjE7aXRlcmF0b3IuY2FsbChjb250ZXh0LGFycmF5W21pZF0pPHZhbHVlP2xvdz1taWQrMTpoaWdoPW1pZDt9CnJldHVybiBsb3c7fTtfLnRvQXJyYXk9ZnVuY3Rpb24ob2JqKXtpZighb2JqKXJldHVybltdO2lmKF8uaXNBcnJheShvYmopKXJldHVybiBzbGljZS5jYWxsKG9iaik7aWYob2JqLmxlbmd0aD09PStvYmoubGVuZ3RoKXJldHVybiBfLm1hcChvYmosXy5pZGVudGl0eSk7cmV0dXJuIF8udmFsdWVzKG9iaik7fTtfLnNpemU9ZnVuY3Rpb24ob2JqKXtpZihvYmo9PW51bGwpcmV0dXJuIDA7cmV0dXJuKG9iai5sZW5ndGg9PT0rb2JqLmxlbmd0aCk/b2JqLmxlbmd0aDpfLmtleXMob2JqKS5sZW5ndGg7fTtfLmZpcnN0PV8uaGVhZD1fLnRha2U9ZnVuY3Rpb24oYXJyYXksbixndWFyZCl7aWYoYXJyYXk9PW51bGwpcmV0dXJuIHZvaWQgMDtyZXR1cm4obj09bnVsbCl8fGd1YXJkP2FycmF5WzBdOnNsaWNlLmNhbGwoYXJyYXksMCxuKTt9O18uaW5pdGlhbD1mdW5jdGlvbihhcnJheSxuLGd1YXJkKXtyZXR1cm4gc2xpY2UuY2FsbChhcnJheSwwLGFycmF5Lmxlbmd0aC0oKG49PW51bGwpfHxndWFyZD8xOm4pKTt9O18ubGFzdD1mdW5jdGlvbihhcnJheSxuLGd1YXJkKXtpZihhcnJheT09bnVsbClyZXR1cm4gdm9pZCAwO2lmKChuPT1udWxsKXx8Z3VhcmQpe3JldHVybiBhcnJheVthcnJheS5sZW5ndGgtMV07fWVsc2V7cmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksTWF0aC5tYXgoYXJyYXkubGVuZ3RoLW4sMCkpO319O18ucmVzdD1fLnRhaWw9Xy5kcm9wPWZ1bmN0aW9uKGFycmF5LG4sZ3VhcmQpe3JldHVybiBzbGljZS5jYWxsKGFycmF5LChuPT1udWxsKXx8Z3VhcmQ/MTpuKTt9O18uY29tcGFjdD1mdW5jdGlvbihhcnJheSl7cmV0dXJuIF8uZmlsdGVyKGFycmF5LF8uaWRlbnRpdHkpO307dmFyIGZsYXR0ZW49ZnVuY3Rpb24oaW5wdXQsc2hhbGxvdyxvdXRwdXQpe2lmKHNoYWxsb3cmJl8uZXZlcnkoaW5wdXQsXy5pc0FycmF5KSl7cmV0dXJuIGNvbmNhdC5hcHBseShvdXRwdXQsaW5wdXQpO30KZWFjaChpbnB1dCxmdW5jdGlvbih2YWx1ZSl7aWYoXy5pc0FycmF5KHZhbHVlKXx8Xy5pc0FyZ3VtZW50cyh2YWx1ZSkpe3NoYWxsb3c/cHVzaC5hcHBseShvdXRwdXQsdmFsdWUpOmZsYXR0ZW4odmFsdWUsc2hhbGxvdyxvdXRwdXQpO31lbHNle291dHB1dC5wdXNoKHZhbHVlKTt9fSk7cmV0dXJuIG91dHB1dDt9O18uZmxhdHRlbj1mdW5jdGlvbihhcnJheSxzaGFsbG93KXtyZXR1cm4gZmxhdHRlbihhcnJheSxzaGFsbG93LFtdKTt9O18ud2l0aG91dD1mdW5jdGlvbihhcnJheSl7cmV0dXJuIF8uZGlmZmVyZW5jZShhcnJheSxzbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7fTtfLnVuaXE9Xy51bmlxdWU9ZnVuY3Rpb24oYXJyYXksaXNTb3J0ZWQsaXRlcmF0b3IsY29udGV4dCl7aWYoXy5pc0Z1bmN0aW9uKGlzU29ydGVkKSl7Y29udGV4dD1pdGVyYXRvcjtpdGVyYXRvcj1pc1NvcnRlZDtpc1NvcnRlZD1mYWxzZTt9CnZhciBpbml0aWFsPWl0ZXJhdG9yP18ubWFwKGFycmF5LGl0ZXJhdG9yLGNvbnRleHQpOmFycmF5O3ZhciByZXN1bHRzPVtdO3ZhciBzZWVuPVtdO2VhY2goaW5pdGlhbCxmdW5jdGlvbih2YWx1ZSxpbmRleCl7aWYoaXNTb3J0ZWQ/KCFpbmRleHx8c2VlbltzZWVuLmxlbmd0aC0xXSE9PXZhbHVlKTohXy5jb250YWlucyhzZWVuLHZhbHVlKSl7c2Vlbi5wdXNoKHZhbHVlKTtyZXN1bHRzLnB1c2goYXJyYXlbaW5kZXhdKTt9fSk7cmV0dXJuIHJlc3VsdHM7fTtfLnVuaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIF8udW5pcShfLmZsYXR0ZW4oYXJndW1lbnRzLHRydWUpKTt9O18uaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGFycmF5KXt2YXIgcmVzdD1zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtyZXR1cm4gXy5maWx0ZXIoXy51bmlxKGFycmF5KSxmdW5jdGlvbihpdGVtKXtyZXR1cm4gXy5ldmVyeShyZXN0LGZ1bmN0aW9uKG90aGVyKXtyZXR1cm4gXy5pbmRleE9mKG90aGVyLGl0ZW0pPj0wO30pO30pO307Xy5kaWZmZXJlbmNlPWZ1bmN0aW9uKGFycmF5KXt2YXIgcmVzdD1jb25jYXQuYXBwbHkoQXJyYXlQcm90byxzbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7cmV0dXJuIF8uZmlsdGVyKGFycmF5LGZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4hXy5jb250YWlucyhyZXN0LHZhbHVlKTt9KTt9O18uemlwPWZ1bmN0aW9uKCl7dmFyIGxlbmd0aD1fLm1heChfLnBsdWNrKGFyZ3VtZW50cywibGVuZ3RoIikuY29uY2F0KDApKTt2YXIgcmVzdWx0cz1uZXcgQXJyYXkobGVuZ3RoKTtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3Jlc3VsdHNbaV09Xy5wbHVjayhhcmd1bWVudHMsJycraSk7fQpyZXR1cm4gcmVzdWx0czt9O18ub2JqZWN0PWZ1bmN0aW9uKGxpc3QsdmFsdWVzKXtpZihsaXN0PT1udWxsKXJldHVybnt9O3ZhciByZXN1bHQ9e307Zm9yKHZhciBpPTAsbGVuZ3RoPWxpc3QubGVuZ3RoO2k8bGVuZ3RoO2krKyl7aWYodmFsdWVzKXtyZXN1bHRbbGlzdFtpXV09dmFsdWVzW2ldO31lbHNle3Jlc3VsdFtsaXN0W2ldWzBdXT1saXN0W2ldWzFdO319CnJldHVybiByZXN1bHQ7fTtfLmluZGV4T2Y9ZnVuY3Rpb24oYXJyYXksaXRlbSxpc1NvcnRlZCl7aWYoYXJyYXk9PW51bGwpcmV0dXJuLTE7dmFyIGk9MCxsZW5ndGg9YXJyYXkubGVuZ3RoO2lmKGlzU29ydGVkKXtpZih0eXBlb2YgaXNTb3J0ZWQ9PSdudW1iZXInKXtpPShpc1NvcnRlZDwwP01hdGgubWF4KDAsbGVuZ3RoK2lzU29ydGVkKTppc1NvcnRlZCk7fWVsc2V7aT1fLnNvcnRlZEluZGV4KGFycmF5LGl0ZW0pO3JldHVybiBhcnJheVtpXT09PWl0ZW0/aTotMTt9fQppZihuYXRpdmVJbmRleE9mJiZhcnJheS5pbmRleE9mPT09bmF0aXZlSW5kZXhPZilyZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtLGlzU29ydGVkKTtmb3IoO2k8bGVuZ3RoO2krKylpZihhcnJheVtpXT09PWl0ZW0pcmV0dXJuIGk7cmV0dXJuLTE7fTtfLmxhc3RJbmRleE9mPWZ1bmN0aW9uKGFycmF5LGl0ZW0sZnJvbSl7aWYoYXJyYXk9PW51bGwpcmV0dXJuLTE7dmFyIGhhc0luZGV4PWZyb20hPW51bGw7aWYobmF0aXZlTGFzdEluZGV4T2YmJmFycmF5Lmxhc3RJbmRleE9mPT09bmF0aXZlTGFzdEluZGV4T2Ype3JldHVybiBoYXNJbmRleD9hcnJheS5sYXN0SW5kZXhPZihpdGVtLGZyb20pOmFycmF5Lmxhc3RJbmRleE9mKGl0ZW0pO30KdmFyIGk9KGhhc0luZGV4P2Zyb206YXJyYXkubGVuZ3RoKTt3aGlsZShpLS0paWYoYXJyYXlbaV09PT1pdGVtKXJldHVybiBpO3JldHVybi0xO307Xy5yYW5nZT1mdW5jdGlvbihzdGFydCxzdG9wLHN0ZXApe2lmKGFyZ3VtZW50cy5sZW5ndGg8PTEpe3N0b3A9c3RhcnR8fDA7c3RhcnQ9MDt9CnN0ZXA9YXJndW1lbnRzWzJdfHwxO3ZhciBsZW5ndGg9TWF0aC5tYXgoTWF0aC5jZWlsKChzdG9wLXN0YXJ0KS9zdGVwKSwwKTt2YXIgaWR4PTA7dmFyIHJhbmdlPW5ldyBBcnJheShsZW5ndGgpO3doaWxlKGlkeDxsZW5ndGgpe3JhbmdlW2lkeCsrXT1zdGFydDtzdGFydCs9c3RlcDt9CnJldHVybiByYW5nZTt9O3ZhciBjdG9yPWZ1bmN0aW9uKCl7fTtfLmJpbmQ9ZnVuY3Rpb24oZnVuYyxjb250ZXh0KXt2YXIgYXJncyxib3VuZDtpZihuYXRpdmVCaW5kJiZmdW5jLmJpbmQ9PT1uYXRpdmVCaW5kKXJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2lmKCFfLmlzRnVuY3Rpb24oZnVuYykpdGhyb3cgbmV3IFR5cGVFcnJvcjthcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBib3VuZD1mdW5jdGlvbigpe2lmKCEodGhpcyBpbnN0YW5jZW9mIGJvdW5kKSlyZXR1cm4gZnVuYy5hcHBseShjb250ZXh0LGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO2N0b3IucHJvdG90eXBlPWZ1bmMucHJvdG90eXBlO3ZhciBzZWxmPW5ldyBjdG9yO2N0b3IucHJvdG90eXBlPW51bGw7dmFyIHJlc3VsdD1mdW5jLmFwcGx5KHNlbGYsYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7aWYoT2JqZWN0KHJlc3VsdCk9PT1yZXN1bHQpcmV0dXJuIHJlc3VsdDtyZXR1cm4gc2VsZjt9O307Xy5wYXJ0aWFsPWZ1bmN0aW9uKGZ1bmMpe3ZhciBhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBmdW5jLmFwcGx5KHRoaXMsYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7fTt9O18uYmluZEFsbD1mdW5jdGlvbihvYmope3ZhciBmdW5jcz1zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtpZihmdW5jcy5sZW5ndGg9PT0wKXRocm93IG5ldyBFcnJvcigiYmluZEFsbCBtdXN0IGJlIHBhc3NlZCBmdW5jdGlvbiBuYW1lcyIpO2VhY2goZnVuY3MsZnVuY3Rpb24oZil7b2JqW2ZdPV8uYmluZChvYmpbZl0sb2JqKTt9KTtyZXR1cm4gb2JqO307Xy5tZW1vaXplPWZ1bmN0aW9uKGZ1bmMsaGFzaGVyKXt2YXIgbWVtbz17fTtoYXNoZXJ8fChoYXNoZXI9Xy5pZGVudGl0eSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGtleT1oYXNoZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiBfLmhhcyhtZW1vLGtleSk/bWVtb1trZXldOihtZW1vW2tleV09ZnVuYy5hcHBseSh0aGlzLGFyZ3VtZW50cykpO307fTtfLmRlbGF5PWZ1bmN0aW9uKGZ1bmMsd2FpdCl7dmFyIGFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtyZXR1cm4gZnVuYy5hcHBseShudWxsLGFyZ3MpO30sd2FpdCk7fTtfLmRlZmVyPWZ1bmN0aW9uKGZ1bmMpe3JldHVybiBfLmRlbGF5LmFwcGx5KF8sW2Z1bmMsMV0uY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKSk7fTtfLnRocm90dGxlPWZ1bmN0aW9uKGZ1bmMsd2FpdCxvcHRpb25zKXt2YXIgY29udGV4dCxhcmdzLHJlc3VsdDt2YXIgdGltZW91dD1udWxsO3ZhciBwcmV2aW91cz0wO29wdGlvbnN8fChvcHRpb25zPXt9KTt2YXIgbGF0ZXI9ZnVuY3Rpb24oKXtwcmV2aW91cz1vcHRpb25zLmxlYWRpbmc9PT1mYWxzZT8wOm5ldyBEYXRlO3RpbWVvdXQ9bnVsbDtyZXN1bHQ9ZnVuYy5hcHBseShjb250ZXh0LGFyZ3MpO307cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIG5vdz1uZXcgRGF0ZTtpZighcHJldmlvdXMmJm9wdGlvbnMubGVhZGluZz09PWZhbHNlKXByZXZpb3VzPW5vdzt2YXIgcmVtYWluaW5nPXdhaXQtKG5vdy1wcmV2aW91cyk7Y29udGV4dD10aGlzO2FyZ3M9YXJndW1lbnRzO2lmKHJlbWFpbmluZzw9MCl7Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO3RpbWVvdXQ9bnVsbDtwcmV2aW91cz1ub3c7cmVzdWx0PWZ1bmMuYXBwbHkoY29udGV4dCxhcmdzKTt9ZWxzZSBpZighdGltZW91dCYmb3B0aW9ucy50cmFpbGluZyE9PWZhbHNlKXt0aW1lb3V0PXNldFRpbWVvdXQobGF0ZXIscmVtYWluaW5nKTt9CnJldHVybiByZXN1bHQ7fTt9O18uZGVib3VuY2U9ZnVuY3Rpb24oZnVuYyx3YWl0LGltbWVkaWF0ZSl7dmFyIHRpbWVvdXQsYXJncyxjb250ZXh0LHRpbWVzdGFtcCxyZXN1bHQ7cmV0dXJuIGZ1bmN0aW9uKCl7Y29udGV4dD10aGlzO2FyZ3M9YXJndW1lbnRzO3RpbWVzdGFtcD1uZXcgRGF0ZSgpO3ZhciBsYXRlcj1mdW5jdGlvbigpe3ZhciBsYXN0PShuZXcgRGF0ZSgpKS10aW1lc3RhbXA7aWYobGFzdDx3YWl0KXt0aW1lb3V0PXNldFRpbWVvdXQobGF0ZXIsd2FpdC1sYXN0KTt9ZWxzZXt0aW1lb3V0PW51bGw7aWYoIWltbWVkaWF0ZSlyZXN1bHQ9ZnVuYy5hcHBseShjb250ZXh0LGFyZ3MpO319O3ZhciBjYWxsTm93PWltbWVkaWF0ZSYmIXRpbWVvdXQ7aWYoIXRpbWVvdXQpe3RpbWVvdXQ9c2V0VGltZW91dChsYXRlcix3YWl0KTt9CmlmKGNhbGxOb3cpcmVzdWx0PWZ1bmMuYXBwbHkoY29udGV4dCxhcmdzKTtyZXR1cm4gcmVzdWx0O307fTtfLm9uY2U9ZnVuY3Rpb24oZnVuYyl7dmFyIHJhbj1mYWxzZSxtZW1vO3JldHVybiBmdW5jdGlvbigpe2lmKHJhbilyZXR1cm4gbWVtbztyYW49dHJ1ZTttZW1vPWZ1bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpO2Z1bmM9bnVsbDtyZXR1cm4gbWVtbzt9O307Xy53cmFwPWZ1bmN0aW9uKGZ1bmMsd3JhcHBlcil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGFyZ3M9W2Z1bmNdO3B1c2guYXBwbHkoYXJncyxhcmd1bWVudHMpO3JldHVybiB3cmFwcGVyLmFwcGx5KHRoaXMsYXJncyk7fTt9O18uY29tcG9zZT1mdW5jdGlvbigpe3ZhciBmdW5jcz1hcmd1bWVudHM7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGFyZ3M9YXJndW1lbnRzO2Zvcih2YXIgaT1mdW5jcy5sZW5ndGgtMTtpPj0wO2ktLSl7YXJncz1bZnVuY3NbaV0uYXBwbHkodGhpcyxhcmdzKV07fQpyZXR1cm4gYXJnc1swXTt9O307Xy5hZnRlcj1mdW5jdGlvbih0aW1lcyxmdW5jKXtyZXR1cm4gZnVuY3Rpb24oKXtpZigtLXRpbWVzPDEpe3JldHVybiBmdW5jLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTt9O18ua2V5cz1uYXRpdmVLZXlzfHxmdW5jdGlvbihvYmope2lmKG9iaiE9PU9iamVjdChvYmopKXRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgb2JqZWN0Jyk7dmFyIGtleXM9W107Zm9yKHZhciBrZXkgaW4gb2JqKWlmKF8uaGFzKG9iaixrZXkpKWtleXMucHVzaChrZXkpO3JldHVybiBrZXlzO307Xy52YWx1ZXM9ZnVuY3Rpb24ob2JqKXt2YXIga2V5cz1fLmtleXMob2JqKTt2YXIgbGVuZ3RoPWtleXMubGVuZ3RoO3ZhciB2YWx1ZXM9bmV3IEFycmF5KGxlbmd0aCk7Zm9yKHZhciBpPTA7aTxsZW5ndGg7aSsrKXt2YWx1ZXNbaV09b2JqW2tleXNbaV1dO30KcmV0dXJuIHZhbHVlczt9O18ucGFpcnM9ZnVuY3Rpb24ob2JqKXt2YXIga2V5cz1fLmtleXMob2JqKTt2YXIgbGVuZ3RoPWtleXMubGVuZ3RoO3ZhciBwYWlycz1uZXcgQXJyYXkobGVuZ3RoKTtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3BhaXJzW2ldPVtrZXlzW2ldLG9ialtrZXlzW2ldXV07fQpyZXR1cm4gcGFpcnM7fTtfLmludmVydD1mdW5jdGlvbihvYmope3ZhciByZXN1bHQ9e307dmFyIGtleXM9Xy5rZXlzKG9iaik7Zm9yKHZhciBpPTAsbGVuZ3RoPWtleXMubGVuZ3RoO2k8bGVuZ3RoO2krKyl7cmVzdWx0W29ialtrZXlzW2ldXV09a2V5c1tpXTt9CnJldHVybiByZXN1bHQ7fTtfLmZ1bmN0aW9ucz1fLm1ldGhvZHM9ZnVuY3Rpb24ob2JqKXt2YXIgbmFtZXM9W107Zm9yKHZhciBrZXkgaW4gb2JqKXtpZihfLmlzRnVuY3Rpb24ob2JqW2tleV0pKW5hbWVzLnB1c2goa2V5KTt9CnJldHVybiBuYW1lcy5zb3J0KCk7fTtfLmV4dGVuZD1mdW5jdGlvbihvYmope2VhY2goc2xpY2UuY2FsbChhcmd1bWVudHMsMSksZnVuY3Rpb24oc291cmNlKXtpZihzb3VyY2Upe2Zvcih2YXIgcHJvcCBpbiBzb3VyY2Upe29ialtwcm9wXT1zb3VyY2VbcHJvcF07fX19KTtyZXR1cm4gb2JqO307Xy5waWNrPWZ1bmN0aW9uKG9iail7dmFyIGNvcHk9e307dmFyIGtleXM9Y29uY2F0LmFwcGx5KEFycmF5UHJvdG8sc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2VhY2goa2V5cyxmdW5jdGlvbihrZXkpe2lmKGtleSBpbiBvYmopY29weVtrZXldPW9ialtrZXldO30pO3JldHVybiBjb3B5O307Xy5vbWl0PWZ1bmN0aW9uKG9iail7dmFyIGNvcHk9e307dmFyIGtleXM9Y29uY2F0LmFwcGx5KEFycmF5UHJvdG8sc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2Zvcih2YXIga2V5IGluIG9iail7aWYoIV8uY29udGFpbnMoa2V5cyxrZXkpKWNvcHlba2V5XT1vYmpba2V5XTt9CnJldHVybiBjb3B5O307Xy5kZWZhdWx0cz1mdW5jdGlvbihvYmope2VhY2goc2xpY2UuY2FsbChhcmd1bWVudHMsMSksZnVuY3Rpb24oc291cmNlKXtpZihzb3VyY2Upe2Zvcih2YXIgcHJvcCBpbiBzb3VyY2Upe2lmKG9ialtwcm9wXT09PXZvaWQgMClvYmpbcHJvcF09c291cmNlW3Byb3BdO319fSk7cmV0dXJuIG9iajt9O18uY2xvbmU9ZnVuY3Rpb24ob2JqKXtpZighXy5pc09iamVjdChvYmopKXJldHVybiBvYmo7cmV0dXJuIF8uaXNBcnJheShvYmopP29iai5zbGljZSgpOl8uZXh0ZW5kKHt9LG9iaik7fTtfLnRhcD1mdW5jdGlvbihvYmosaW50ZXJjZXB0b3Ipe2ludGVyY2VwdG9yKG9iaik7cmV0dXJuIG9iajt9O3ZhciBlcT1mdW5jdGlvbihhLGIsYVN0YWNrLGJTdGFjayl7aWYoYT09PWIpcmV0dXJuIGEhPT0wfHwxL2E9PTEvYjtpZihhPT1udWxsfHxiPT1udWxsKXJldHVybiBhPT09YjtpZihhIGluc3RhbmNlb2YgXylhPWEuX3dyYXBwZWQ7aWYoYiBpbnN0YW5jZW9mIF8pYj1iLl93cmFwcGVkO3ZhciBjbGFzc05hbWU9dG9TdHJpbmcuY2FsbChhKTtpZihjbGFzc05hbWUhPXRvU3RyaW5nLmNhbGwoYikpcmV0dXJuIGZhbHNlO3N3aXRjaChjbGFzc05hbWUpe2Nhc2UnW29iamVjdCBTdHJpbmddJzpyZXR1cm4gYT09U3RyaW5nKGIpO2Nhc2UnW29iamVjdCBOdW1iZXJdJzpyZXR1cm4gYSE9K2E/YiE9K2I6KGE9PTA/MS9hPT0xL2I6YT09K2IpO2Nhc2UnW29iamVjdCBEYXRlXSc6Y2FzZSdbb2JqZWN0IEJvb2xlYW5dJzpyZXR1cm4rYT09K2I7Y2FzZSdbb2JqZWN0IFJlZ0V4cF0nOnJldHVybiBhLnNvdXJjZT09Yi5zb3VyY2UmJmEuZ2xvYmFsPT1iLmdsb2JhbCYmYS5tdWx0aWxpbmU9PWIubXVsdGlsaW5lJiZhLmlnbm9yZUNhc2U9PWIuaWdub3JlQ2FzZTt9CmlmKHR5cGVvZiBhIT0nb2JqZWN0J3x8dHlwZW9mIGIhPSdvYmplY3QnKXJldHVybiBmYWxzZTt2YXIgbGVuZ3RoPWFTdGFjay5sZW5ndGg7d2hpbGUobGVuZ3RoLS0pe2lmKGFTdGFja1tsZW5ndGhdPT1hKXJldHVybiBiU3RhY2tbbGVuZ3RoXT09Yjt9CnZhciBhQ3Rvcj1hLmNvbnN0cnVjdG9yLGJDdG9yPWIuY29uc3RydWN0b3I7aWYoYUN0b3IhPT1iQ3RvciYmIShfLmlzRnVuY3Rpb24oYUN0b3IpJiYoYUN0b3IgaW5zdGFuY2VvZiBhQ3RvcikmJl8uaXNGdW5jdGlvbihiQ3RvcikmJihiQ3RvciBpbnN0YW5jZW9mIGJDdG9yKSkpe3JldHVybiBmYWxzZTt9CmFTdGFjay5wdXNoKGEpO2JTdGFjay5wdXNoKGIpO3ZhciBzaXplPTAscmVzdWx0PXRydWU7aWYoY2xhc3NOYW1lPT0nW29iamVjdCBBcnJheV0nKXtzaXplPWEubGVuZ3RoO3Jlc3VsdD1zaXplPT1iLmxlbmd0aDtpZihyZXN1bHQpe3doaWxlKHNpemUtLSl7aWYoIShyZXN1bHQ9ZXEoYVtzaXplXSxiW3NpemVdLGFTdGFjayxiU3RhY2spKSlicmVhazt9fX1lbHNle2Zvcih2YXIga2V5IGluIGEpe2lmKF8uaGFzKGEsa2V5KSl7c2l6ZSsrO2lmKCEocmVzdWx0PV8uaGFzKGIsa2V5KSYmZXEoYVtrZXldLGJba2V5XSxhU3RhY2ssYlN0YWNrKSkpYnJlYWs7fX0KaWYocmVzdWx0KXtmb3Ioa2V5IGluIGIpe2lmKF8uaGFzKGIsa2V5KSYmIShzaXplLS0pKWJyZWFrO30KcmVzdWx0PSFzaXplO319CmFTdGFjay5wb3AoKTtiU3RhY2sucG9wKCk7cmV0dXJuIHJlc3VsdDt9O18uaXNFcXVhbD1mdW5jdGlvbihhLGIpe3JldHVybiBlcShhLGIsW10sW10pO307Xy5pc0VtcHR5PWZ1bmN0aW9uKG9iail7aWYob2JqPT1udWxsKXJldHVybiB0cnVlO2lmKF8uaXNBcnJheShvYmopfHxfLmlzU3RyaW5nKG9iaikpcmV0dXJuIG9iai5sZW5ndGg9PT0wO2Zvcih2YXIga2V5IGluIG9iailpZihfLmhhcyhvYmosa2V5KSlyZXR1cm4gZmFsc2U7cmV0dXJuIHRydWU7fTtfLmlzRWxlbWVudD1mdW5jdGlvbihvYmope3JldHVybiEhKG9iaiYmb2JqLm5vZGVUeXBlPT09MSk7fTtfLmlzQXJyYXk9bmF0aXZlSXNBcnJheXx8ZnVuY3Rpb24ob2JqKXtyZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopPT0nW29iamVjdCBBcnJheV0nO307Xy5pc09iamVjdD1mdW5jdGlvbihvYmope3JldHVybiBvYmo9PT1PYmplY3Qob2JqKTt9O2VhY2goWydBcmd1bWVudHMnLCdGdW5jdGlvbicsJ1N0cmluZycsJ051bWJlcicsJ0RhdGUnLCdSZWdFeHAnXSxmdW5jdGlvbihuYW1lKXtfWydpcycrbmFtZV09ZnVuY3Rpb24ob2JqKXtyZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopPT0nW29iamVjdCAnK25hbWUrJ10nO307fSk7aWYoIV8uaXNBcmd1bWVudHMoYXJndW1lbnRzKSl7Xy5pc0FyZ3VtZW50cz1mdW5jdGlvbihvYmope3JldHVybiEhKG9iaiYmXy5oYXMob2JqLCdjYWxsZWUnKSk7fTt9CmlmKHR5cGVvZigvLi8pIT09J2Z1bmN0aW9uJyl7Xy5pc0Z1bmN0aW9uPWZ1bmN0aW9uKG9iail7cmV0dXJuIHR5cGVvZiBvYmo9PT0nZnVuY3Rpb24nO307fQpfLmlzRmluaXRlPWZ1bmN0aW9uKG9iail7cmV0dXJuIGlzRmluaXRlKG9iaikmJiFpc05hTihwYXJzZUZsb2F0KG9iaikpO307Xy5pc05hTj1mdW5jdGlvbihvYmope3JldHVybiBfLmlzTnVtYmVyKG9iaikmJm9iaiE9K29iajt9O18uaXNCb29sZWFuPWZ1bmN0aW9uKG9iail7cmV0dXJuIG9iaj09PXRydWV8fG9iaj09PWZhbHNlfHx0b1N0cmluZy5jYWxsKG9iaik9PSdbb2JqZWN0IEJvb2xlYW5dJzt9O18uaXNOdWxsPWZ1bmN0aW9uKG9iail7cmV0dXJuIG9iaj09PW51bGw7fTtfLmlzVW5kZWZpbmVkPWZ1bmN0aW9uKG9iail7cmV0dXJuIG9iaj09PXZvaWQgMDt9O18uaGFzPWZ1bmN0aW9uKG9iaixrZXkpe3JldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaixrZXkpO307Xy5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cm9vdC5fPXByZXZpb3VzVW5kZXJzY29yZTtyZXR1cm4gdGhpczt9O18uaWRlbnRpdHk9ZnVuY3Rpb24odmFsdWUpe3JldHVybiB2YWx1ZTt9O18udGltZXM9ZnVuY3Rpb24obixpdGVyYXRvcixjb250ZXh0KXt2YXIgYWNjdW09QXJyYXkoTWF0aC5tYXgoMCxuKSk7Zm9yKHZhciBpPTA7aTxuO2krKylhY2N1bVtpXT1pdGVyYXRvci5jYWxsKGNvbnRleHQsaSk7cmV0dXJuIGFjY3VtO307Xy5yYW5kb209ZnVuY3Rpb24obWluLG1heCl7aWYobWF4PT1udWxsKXttYXg9bWluO21pbj0wO30KcmV0dXJuIG1pbitNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKG1heC1taW4rMSkpO307dmFyIGVudGl0eU1hcD17ZXNjYXBlOnsnJic6JyZhbXA7JywnPCc6JyZsdDsnLCc+JzonJmd0OycsJyInOicmcXVvdDsnLCInIjonJiN4Mjc7J319O2VudGl0eU1hcC51bmVzY2FwZT1fLmludmVydChlbnRpdHlNYXAuZXNjYXBlKTt2YXIgZW50aXR5UmVnZXhlcz17ZXNjYXBlOm5ldyBSZWdFeHAoJ1snK18ua2V5cyhlbnRpdHlNYXAuZXNjYXBlKS5qb2luKCcnKSsnXScsJ2cnKSx1bmVzY2FwZTpuZXcgUmVnRXhwKCcoJytfLmtleXMoZW50aXR5TWFwLnVuZXNjYXBlKS5qb2luKCd8JykrJyknLCdnJyl9O18uZWFjaChbJ2VzY2FwZScsJ3VuZXNjYXBlJ10sZnVuY3Rpb24obWV0aG9kKXtfW21ldGhvZF09ZnVuY3Rpb24oc3RyaW5nKXtpZihzdHJpbmc9PW51bGwpcmV0dXJuJyc7cmV0dXJuKCcnK3N0cmluZykucmVwbGFjZShlbnRpdHlSZWdleGVzW21ldGhvZF0sZnVuY3Rpb24obWF0Y2gpe3JldHVybiBlbnRpdHlNYXBbbWV0aG9kXVttYXRjaF07fSk7fTt9KTtfLnJlc3VsdD1mdW5jdGlvbihvYmplY3QscHJvcGVydHkpe2lmKG9iamVjdD09bnVsbClyZXR1cm4gdm9pZCAwO3ZhciB2YWx1ZT1vYmplY3RbcHJvcGVydHldO3JldHVybiBfLmlzRnVuY3Rpb24odmFsdWUpP3ZhbHVlLmNhbGwob2JqZWN0KTp2YWx1ZTt9O18ubWl4aW49ZnVuY3Rpb24ob2JqKXtlYWNoKF8uZnVuY3Rpb25zKG9iaiksZnVuY3Rpb24obmFtZSl7dmFyIGZ1bmM9X1tuYW1lXT1vYmpbbmFtZV07Xy5wcm90b3R5cGVbbmFtZV09ZnVuY3Rpb24oKXt2YXIgYXJncz1bdGhpcy5fd3JhcHBlZF07cHVzaC5hcHBseShhcmdzLGFyZ3VtZW50cyk7cmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsZnVuYy5hcHBseShfLGFyZ3MpKTt9O30pO307dmFyIGlkQ291bnRlcj0wO18udW5pcXVlSWQ9ZnVuY3Rpb24ocHJlZml4KXt2YXIgaWQ9KytpZENvdW50ZXIrJyc7cmV0dXJuIHByZWZpeD9wcmVmaXgraWQ6aWQ7fTtfLnRlbXBsYXRlU2V0dGluZ3M9e2V2YWx1YXRlOi88JShbXHNcU10rPyklPi9nLGludGVycG9sYXRlOi88JT0oW1xzXFNdKz8pJT4vZyxlc2NhcGU6LzwlLShbXHNcU10rPyklPi9nfTt2YXIgbm9NYXRjaD0vKC4pXi87dmFyIGVzY2FwZXM9eyInIjoiJyIsJ1xcJzonXFwnLCdccic6J3InLCdcbic6J24nLCdcdCc6J3QnLCdcdTIwMjgnOid1MjAyOCcsJ1x1MjAyOSc6J3UyMDI5J307dmFyIGVzY2FwZXI9L1xcfCd8XHJ8XG58XHR8XHUyMDI4fFx1MjAyOS9nO18udGVtcGxhdGU9ZnVuY3Rpb24odGV4dCxkYXRhLHNldHRpbmdzKXt2YXIgcmVuZGVyO3NldHRpbmdzPV8uZGVmYXVsdHMoe30sc2V0dGluZ3MsXy50ZW1wbGF0ZVNldHRpbmdzKTt2YXIgbWF0Y2hlcj1uZXcgUmVnRXhwKFsoc2V0dGluZ3MuZXNjYXBlfHxub01hdGNoKS5zb3VyY2UsKHNldHRpbmdzLmludGVycG9sYXRlfHxub01hdGNoKS5zb3VyY2UsKHNldHRpbmdzLmV2YWx1YXRlfHxub01hdGNoKS5zb3VyY2VdLmpvaW4oJ3wnKSsnfCQnLCdnJyk7dmFyIGluZGV4PTA7dmFyIHNvdXJjZT0iX19wKz0nIjt0ZXh0LnJlcGxhY2UobWF0Y2hlcixmdW5jdGlvbihtYXRjaCxlc2NhcGUsaW50ZXJwb2xhdGUsZXZhbHVhdGUsb2Zmc2V0KXtzb3VyY2UrPXRleHQuc2xpY2UoaW5kZXgsb2Zmc2V0KS5yZXBsYWNlKGVzY2FwZXIsZnVuY3Rpb24obWF0Y2gpe3JldHVybidcXCcrZXNjYXBlc1ttYXRjaF07fSk7aWYoZXNjYXBlKXtzb3VyY2UrPSInK1xuKChfX3Q9KCIrZXNjYXBlKyIpKT09bnVsbD8nJzpfLmVzY2FwZShfX3QpKStcbiciO30KaWYoaW50ZXJwb2xhdGUpe3NvdXJjZSs9IicrXG4oKF9fdD0oIitpbnRlcnBvbGF0ZSsiKSk9PW51bGw/Jyc6X190KStcbiciO30KaWYoZXZhbHVhdGUpe3NvdXJjZSs9Iic7XG4iK2V2YWx1YXRlKyJcbl9fcCs9JyI7fQppbmRleD1vZmZzZXQrbWF0Y2gubGVuZ3RoO3JldHVybiBtYXRjaDt9KTtzb3VyY2UrPSInO1xuIjtpZighc2V0dGluZ3MudmFyaWFibGUpc291cmNlPSd3aXRoKG9ianx8e30pe1xuJytzb3VyY2UrJ31cbic7c291cmNlPSJ2YXIgX190LF9fcD0nJyxfX2o9QXJyYXkucHJvdG90eXBlLmpvaW4sIisicHJpbnQ9ZnVuY3Rpb24oKXtfX3ArPV9fai5jYWxsKGFyZ3VtZW50cywnJyk7fTtcbiIrCnNvdXJjZSsicmV0dXJuIF9fcDtcbiI7dHJ5e3JlbmRlcj1uZXcgRnVuY3Rpb24oc2V0dGluZ3MudmFyaWFibGV8fCdvYmonLCdfJyxzb3VyY2UpO31jYXRjaChlKXtlLnNvdXJjZT1zb3VyY2U7dGhyb3cgZTt9CmlmKGRhdGEpcmV0dXJuIHJlbmRlcihkYXRhLF8pO3ZhciB0ZW1wbGF0ZT1mdW5jdGlvbihkYXRhKXtyZXR1cm4gcmVuZGVyLmNhbGwodGhpcyxkYXRhLF8pO307dGVtcGxhdGUuc291cmNlPSdmdW5jdGlvbignKyhzZXR0aW5ncy52YXJpYWJsZXx8J29iaicpKycpe1xuJytzb3VyY2UrJ30nO3JldHVybiB0ZW1wbGF0ZTt9O18uY2hhaW49ZnVuY3Rpb24ob2JqKXtyZXR1cm4gXyhvYmopLmNoYWluKCk7fTt2YXIgcmVzdWx0PWZ1bmN0aW9uKG9iail7cmV0dXJuIHRoaXMuX2NoYWluP18ob2JqKS5jaGFpbigpOm9iajt9O18ubWl4aW4oXyk7ZWFjaChbJ3BvcCcsJ3B1c2gnLCdyZXZlcnNlJywnc2hpZnQnLCdzb3J0Jywnc3BsaWNlJywndW5zaGlmdCddLGZ1bmN0aW9uKG5hbWUpe3ZhciBtZXRob2Q9QXJyYXlQcm90b1tuYW1lXTtfLnByb3RvdHlwZVtuYW1lXT1mdW5jdGlvbigpe3ZhciBvYmo9dGhpcy5fd3JhcHBlZDttZXRob2QuYXBwbHkob2JqLGFyZ3VtZW50cyk7aWYoKG5hbWU9PSdzaGlmdCd8fG5hbWU9PSdzcGxpY2UnKSYmb2JqLmxlbmd0aD09PTApZGVsZXRlIG9ialswXTtyZXR1cm4gcmVzdWx0LmNhbGwodGhpcyxvYmopO307fSk7ZWFjaChbJ2NvbmNhdCcsJ2pvaW4nLCdzbGljZSddLGZ1bmN0aW9uKG5hbWUpe3ZhciBtZXRob2Q9QXJyYXlQcm90b1tuYW1lXTtfLnByb3RvdHlwZVtuYW1lXT1mdW5jdGlvbigpe3JldHVybiByZXN1bHQuY2FsbCh0aGlzLG1ldGhvZC5hcHBseSh0aGlzLl93cmFwcGVkLGFyZ3VtZW50cykpO307fSk7Xy5leHRlbmQoXy5wcm90b3R5cGUse2NoYWluOmZ1bmN0aW9uKCl7dGhpcy5fY2hhaW49dHJ1ZTtyZXR1cm4gdGhpczt9LHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dyYXBwZWQ7fX0pO30pLmNhbGwodGhpcyk7KGZ1bmN0aW9uKCl7dmFyIHJvb3Q9dGhpczt2YXIgcHJldmlvdXNCYWNrYm9uZT1yb290LkJhY2tib25lO3ZhciBhcnJheT1bXTt2YXIgcHVzaD1hcnJheS5wdXNoO3ZhciBzbGljZT1hcnJheS5zbGljZTt2YXIgc3BsaWNlPWFycmF5LnNwbGljZTt2YXIgQmFja2JvbmU7aWYodHlwZW9mIGV4cG9ydHMhPT0ndW5kZWZpbmVkJyl7QmFja2JvbmU9ZXhwb3J0czt9ZWxzZXtCYWNrYm9uZT1yb290LkJhY2tib25lPXt9O30KQmFja2JvbmUuVkVSU0lPTj0nMS4xLjAnO3ZhciBfPXJvb3QuXztpZighXyYmKHR5cGVvZiByZXF1aXJlIT09J3VuZGVmaW5lZCcpKV89cmVxdWlyZSgndW5kZXJzY29yZScpO0JhY2tib25lLiQ9cm9vdC5qUXVlcnl8fHJvb3QuWmVwdG98fHJvb3QuZW5kZXJ8fHJvb3QuJDtCYWNrYm9uZS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cm9vdC5CYWNrYm9uZT1wcmV2aW91c0JhY2tib25lO3JldHVybiB0aGlzO307QmFja2JvbmUuZW11bGF0ZUhUVFA9ZmFsc2U7QmFja2JvbmUuZW11bGF0ZUpTT049ZmFsc2U7dmFyIEV2ZW50cz1CYWNrYm9uZS5FdmVudHM9e29uOmZ1bmN0aW9uKG5hbWUsY2FsbGJhY2ssY29udGV4dCl7aWYoIWV2ZW50c0FwaSh0aGlzLCdvbicsbmFtZSxbY2FsbGJhY2ssY29udGV4dF0pfHwhY2FsbGJhY2spcmV0dXJuIHRoaXM7dGhpcy5fZXZlbnRzfHwodGhpcy5fZXZlbnRzPXt9KTt2YXIgZXZlbnRzPXRoaXMuX2V2ZW50c1tuYW1lXXx8KHRoaXMuX2V2ZW50c1tuYW1lXT1bXSk7ZXZlbnRzLnB1c2goe2NhbGxiYWNrOmNhbGxiYWNrLGNvbnRleHQ6Y29udGV4dCxjdHg6Y29udGV4dHx8dGhpc30pO3JldHVybiB0aGlzO30sb25jZTpmdW5jdGlvbihuYW1lLGNhbGxiYWNrLGNvbnRleHQpe2lmKCFldmVudHNBcGkodGhpcywnb25jZScsbmFtZSxbY2FsbGJhY2ssY29udGV4dF0pfHwhY2FsbGJhY2spcmV0dXJuIHRoaXM7dmFyIHNlbGY9dGhpczt2YXIgb25jZT1fLm9uY2UoZnVuY3Rpb24oKXtzZWxmLm9mZihuYW1lLG9uY2UpO2NhbGxiYWNrLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9KTtvbmNlLl9jYWxsYmFjaz1jYWxsYmFjaztyZXR1cm4gdGhpcy5vbihuYW1lLG9uY2UsY29udGV4dCk7fSxvZmY6ZnVuY3Rpb24obmFtZSxjYWxsYmFjayxjb250ZXh0KXt2YXIgcmV0YWluLGV2LGV2ZW50cyxuYW1lcyxpLGwsaixrO2lmKCF0aGlzLl9ldmVudHN8fCFldmVudHNBcGkodGhpcywnb2ZmJyxuYW1lLFtjYWxsYmFjayxjb250ZXh0XSkpcmV0dXJuIHRoaXM7aWYoIW5hbWUmJiFjYWxsYmFjayYmIWNvbnRleHQpe3RoaXMuX2V2ZW50cz17fTtyZXR1cm4gdGhpczt9Cm5hbWVzPW5hbWU/W25hbWVdOl8ua2V5cyh0aGlzLl9ldmVudHMpO2ZvcihpPTAsbD1uYW1lcy5sZW5ndGg7aTxsO2krKyl7bmFtZT1uYW1lc1tpXTtpZihldmVudHM9dGhpcy5fZXZlbnRzW25hbWVdKXt0aGlzLl9ldmVudHNbbmFtZV09cmV0YWluPVtdO2lmKGNhbGxiYWNrfHxjb250ZXh0KXtmb3Ioaj0wLGs9ZXZlbnRzLmxlbmd0aDtqPGs7aisrKXtldj1ldmVudHNbal07aWYoKGNhbGxiYWNrJiZjYWxsYmFjayE9PWV2LmNhbGxiYWNrJiZjYWxsYmFjayE9PWV2LmNhbGxiYWNrLl9jYWxsYmFjayl8fChjb250ZXh0JiZjb250ZXh0IT09ZXYuY29udGV4dCkpe3JldGFpbi5wdXNoKGV2KTt9fX0KaWYoIXJldGFpbi5sZW5ndGgpZGVsZXRlIHRoaXMuX2V2ZW50c1tuYW1lXTt9fQpyZXR1cm4gdGhpczt9LHRyaWdnZXI6ZnVuY3Rpb24obmFtZSl7aWYoIXRoaXMuX2V2ZW50cylyZXR1cm4gdGhpczt2YXIgYXJncz1zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtpZighZXZlbnRzQXBpKHRoaXMsJ3RyaWdnZXInLG5hbWUsYXJncykpcmV0dXJuIHRoaXM7dmFyIGV2ZW50cz10aGlzLl9ldmVudHNbbmFtZV07dmFyIGFsbEV2ZW50cz10aGlzLl9ldmVudHMuYWxsO2lmKGV2ZW50cyl0cmlnZ2VyRXZlbnRzKGV2ZW50cyxhcmdzKTtpZihhbGxFdmVudHMpdHJpZ2dlckV2ZW50cyhhbGxFdmVudHMsYXJndW1lbnRzKTtyZXR1cm4gdGhpczt9LHN0b3BMaXN0ZW5pbmc6ZnVuY3Rpb24ob2JqLG5hbWUsY2FsbGJhY2spe3ZhciBsaXN0ZW5pbmdUbz10aGlzLl9saXN0ZW5pbmdUbztpZighbGlzdGVuaW5nVG8pcmV0dXJuIHRoaXM7dmFyIHJlbW92ZT0hbmFtZSYmIWNhbGxiYWNrO2lmKCFjYWxsYmFjayYmdHlwZW9mIG5hbWU9PT0nb2JqZWN0JyljYWxsYmFjaz10aGlzO2lmKG9iaikobGlzdGVuaW5nVG89e30pW29iai5fbGlzdGVuSWRdPW9iajtmb3IodmFyIGlkIGluIGxpc3RlbmluZ1RvKXtvYmo9bGlzdGVuaW5nVG9baWRdO29iai5vZmYobmFtZSxjYWxsYmFjayx0aGlzKTtpZihyZW1vdmV8fF8uaXNFbXB0eShvYmouX2V2ZW50cykpZGVsZXRlIHRoaXMuX2xpc3RlbmluZ1RvW2lkXTt9CnJldHVybiB0aGlzO319O3ZhciBldmVudFNwbGl0dGVyPS9ccysvO3ZhciBldmVudHNBcGk9ZnVuY3Rpb24ob2JqLGFjdGlvbixuYW1lLHJlc3Qpe2lmKCFuYW1lKXJldHVybiB0cnVlO2lmKHR5cGVvZiBuYW1lPT09J29iamVjdCcpe2Zvcih2YXIga2V5IGluIG5hbWUpe29ialthY3Rpb25dLmFwcGx5KG9iaixba2V5LG5hbWVba2V5XV0uY29uY2F0KHJlc3QpKTt9CnJldHVybiBmYWxzZTt9CmlmKGV2ZW50U3BsaXR0ZXIudGVzdChuYW1lKSl7dmFyIG5hbWVzPW5hbWUuc3BsaXQoZXZlbnRTcGxpdHRlcik7Zm9yKHZhciBpPTAsbD1uYW1lcy5sZW5ndGg7aTxsO2krKyl7b2JqW2FjdGlvbl0uYXBwbHkob2JqLFtuYW1lc1tpXV0uY29uY2F0KHJlc3QpKTt9CnJldHVybiBmYWxzZTt9CnJldHVybiB0cnVlO307dmFyIHRyaWdnZXJFdmVudHM9ZnVuY3Rpb24oZXZlbnRzLGFyZ3Mpe3ZhciBldixpPS0xLGw9ZXZlbnRzLmxlbmd0aCxhMT1hcmdzWzBdLGEyPWFyZ3NbMV0sYTM9YXJnc1syXTtzd2l0Y2goYXJncy5sZW5ndGgpe2Nhc2UgMDp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCk7cmV0dXJuO2Nhc2UgMTp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSk7cmV0dXJuO2Nhc2UgMjp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSxhMik7cmV0dXJuO2Nhc2UgMzp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSxhMixhMyk7cmV0dXJuO2RlZmF1bHQ6d2hpbGUoKytpPGwpKGV2PWV2ZW50c1tpXSkuY2FsbGJhY2suYXBwbHkoZXYuY3R4LGFyZ3MpO319O3ZhciBsaXN0ZW5NZXRob2RzPXtsaXN0ZW5Ubzonb24nLGxpc3RlblRvT25jZTonb25jZSd9O18uZWFjaChsaXN0ZW5NZXRob2RzLGZ1bmN0aW9uKGltcGxlbWVudGF0aW9uLG1ldGhvZCl7RXZlbnRzW21ldGhvZF09ZnVuY3Rpb24ob2JqLG5hbWUsY2FsbGJhY2spe3ZhciBsaXN0ZW5pbmdUbz10aGlzLl9saXN0ZW5pbmdUb3x8KHRoaXMuX2xpc3RlbmluZ1RvPXt9KTt2YXIgaWQ9b2JqLl9saXN0ZW5JZHx8KG9iai5fbGlzdGVuSWQ9Xy51bmlxdWVJZCgnbCcpKTtsaXN0ZW5pbmdUb1tpZF09b2JqO2lmKCFjYWxsYmFjayYmdHlwZW9mIG5hbWU9PT0nb2JqZWN0JyljYWxsYmFjaz10aGlzO29ialtpbXBsZW1lbnRhdGlvbl0obmFtZSxjYWxsYmFjayx0aGlzKTtyZXR1cm4gdGhpczt9O30pO0V2ZW50cy5iaW5kPUV2ZW50cy5vbjtFdmVudHMudW5iaW5kPUV2ZW50cy5vZmY7Xy5leHRlbmQoQmFja2JvbmUsRXZlbnRzKTt2YXIgTW9kZWw9QmFja2JvbmUuTW9kZWw9ZnVuY3Rpb24oYXR0cmlidXRlcyxvcHRpb25zKXt2YXIgYXR0cnM9YXR0cmlidXRlc3x8e307b3B0aW9uc3x8KG9wdGlvbnM9e30pO3RoaXMuY2lkPV8udW5pcXVlSWQoJ2MnKTt0aGlzLmF0dHJpYnV0ZXM9e307aWYob3B0aW9ucy5jb2xsZWN0aW9uKXRoaXMuY29sbGVjdGlvbj1vcHRpb25zLmNvbGxlY3Rpb247aWYob3B0aW9ucy5wYXJzZSlhdHRycz10aGlzLnBhcnNlKGF0dHJzLG9wdGlvbnMpfHx7fTthdHRycz1fLmRlZmF1bHRzKHt9LGF0dHJzLF8ucmVzdWx0KHRoaXMsJ2RlZmF1bHRzJykpO3RoaXMuc2V0KGF0dHJzLG9wdGlvbnMpO3RoaXMuY2hhbmdlZD17fTt0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO307Xy5leHRlbmQoTW9kZWwucHJvdG90eXBlLEV2ZW50cyx7Y2hhbmdlZDpudWxsLHZhbGlkYXRpb25FcnJvcjpudWxsLGlkQXR0cmlidXRlOidpZCcsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sdG9KU09OOmZ1bmN0aW9uKG9wdGlvbnMpe3JldHVybiBfLmNsb25lKHRoaXMuYXR0cmlidXRlcyk7fSxzeW5jOmZ1bmN0aW9uKCl7cmV0dXJuIEJhY2tib25lLnN5bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpO30sZ2V0OmZ1bmN0aW9uKGF0dHIpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cl07fSxlc2NhcGU6ZnVuY3Rpb24oYXR0cil7cmV0dXJuIF8uZXNjYXBlKHRoaXMuZ2V0KGF0dHIpKTt9LGhhczpmdW5jdGlvbihhdHRyKXtyZXR1cm4gdGhpcy5nZXQoYXR0cikhPW51bGw7fSxzZXQ6ZnVuY3Rpb24oa2V5LHZhbCxvcHRpb25zKXt2YXIgYXR0cixhdHRycyx1bnNldCxjaGFuZ2VzLHNpbGVudCxjaGFuZ2luZyxwcmV2LGN1cnJlbnQ7aWYoa2V5PT1udWxsKXJldHVybiB0aGlzO2lmKHR5cGVvZiBrZXk9PT0nb2JqZWN0Jyl7YXR0cnM9a2V5O29wdGlvbnM9dmFsO31lbHNleyhhdHRycz17fSlba2V5XT12YWw7fQpvcHRpb25zfHwob3B0aW9ucz17fSk7aWYoIXRoaXMuX3ZhbGlkYXRlKGF0dHJzLG9wdGlvbnMpKXJldHVybiBmYWxzZTt1bnNldD1vcHRpb25zLnVuc2V0O3NpbGVudD1vcHRpb25zLnNpbGVudDtjaGFuZ2VzPVtdO2NoYW5naW5nPXRoaXMuX2NoYW5naW5nO3RoaXMuX2NoYW5naW5nPXRydWU7aWYoIWNoYW5naW5nKXt0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM9Xy5jbG9uZSh0aGlzLmF0dHJpYnV0ZXMpO3RoaXMuY2hhbmdlZD17fTt9CmN1cnJlbnQ9dGhpcy5hdHRyaWJ1dGVzLHByZXY9dGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzO2lmKHRoaXMuaWRBdHRyaWJ1dGUgaW4gYXR0cnMpdGhpcy5pZD1hdHRyc1t0aGlzLmlkQXR0cmlidXRlXTtmb3IoYXR0ciBpbiBhdHRycyl7dmFsPWF0dHJzW2F0dHJdO2lmKCFfLmlzRXF1YWwoY3VycmVudFthdHRyXSx2YWwpKWNoYW5nZXMucHVzaChhdHRyKTtpZighXy5pc0VxdWFsKHByZXZbYXR0cl0sdmFsKSl7dGhpcy5jaGFuZ2VkW2F0dHJdPXZhbDt9ZWxzZXtkZWxldGUgdGhpcy5jaGFuZ2VkW2F0dHJdO30KdW5zZXQ/ZGVsZXRlIGN1cnJlbnRbYXR0cl06Y3VycmVudFthdHRyXT12YWw7fQppZighc2lsZW50KXtpZihjaGFuZ2VzLmxlbmd0aCl0aGlzLl9wZW5kaW5nPXRydWU7Zm9yKHZhciBpPTAsbD1jaGFuZ2VzLmxlbmd0aDtpPGw7aSsrKXt0aGlzLnRyaWdnZXIoJ2NoYW5nZTonK2NoYW5nZXNbaV0sdGhpcyxjdXJyZW50W2NoYW5nZXNbaV1dLG9wdGlvbnMpO319CmlmKGNoYW5naW5nKXJldHVybiB0aGlzO2lmKCFzaWxlbnQpe3doaWxlKHRoaXMuX3BlbmRpbmcpe3RoaXMuX3BlbmRpbmc9ZmFsc2U7dGhpcy50cmlnZ2VyKCdjaGFuZ2UnLHRoaXMsb3B0aW9ucyk7fX0KdGhpcy5fcGVuZGluZz1mYWxzZTt0aGlzLl9jaGFuZ2luZz1mYWxzZTtyZXR1cm4gdGhpczt9LHVuc2V0OmZ1bmN0aW9uKGF0dHIsb3B0aW9ucyl7cmV0dXJuIHRoaXMuc2V0KGF0dHIsdm9pZCAwLF8uZXh0ZW5kKHt9LG9wdGlvbnMse3Vuc2V0OnRydWV9KSk7fSxjbGVhcjpmdW5jdGlvbihvcHRpb25zKXt2YXIgYXR0cnM9e307Zm9yKHZhciBrZXkgaW4gdGhpcy5hdHRyaWJ1dGVzKWF0dHJzW2tleV09dm9pZCAwO3JldHVybiB0aGlzLnNldChhdHRycyxfLmV4dGVuZCh7fSxvcHRpb25zLHt1bnNldDp0cnVlfSkpO30saGFzQ2hhbmdlZDpmdW5jdGlvbihhdHRyKXtpZihhdHRyPT1udWxsKXJldHVybiFfLmlzRW1wdHkodGhpcy5jaGFuZ2VkKTtyZXR1cm4gXy5oYXModGhpcy5jaGFuZ2VkLGF0dHIpO30sY2hhbmdlZEF0dHJpYnV0ZXM6ZnVuY3Rpb24oZGlmZil7aWYoIWRpZmYpcmV0dXJuIHRoaXMuaGFzQ2hhbmdlZCgpP18uY2xvbmUodGhpcy5jaGFuZ2VkKTpmYWxzZTt2YXIgdmFsLGNoYW5nZWQ9ZmFsc2U7dmFyIG9sZD10aGlzLl9jaGFuZ2luZz90aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM6dGhpcy5hdHRyaWJ1dGVzO2Zvcih2YXIgYXR0ciBpbiBkaWZmKXtpZihfLmlzRXF1YWwob2xkW2F0dHJdLCh2YWw9ZGlmZlthdHRyXSkpKWNvbnRpbnVlOyhjaGFuZ2VkfHwoY2hhbmdlZD17fSkpW2F0dHJdPXZhbDt9CnJldHVybiBjaGFuZ2VkO30scHJldmlvdXM6ZnVuY3Rpb24oYXR0cil7aWYoYXR0cj09bnVsbHx8IXRoaXMuX3ByZXZpb3VzQXR0cmlidXRlcylyZXR1cm4gbnVsbDtyZXR1cm4gdGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzW2F0dHJdO30scHJldmlvdXNBdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7cmV0dXJuIF8uY2xvbmUodGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzKTt9LGZldGNoOmZ1bmN0aW9uKG9wdGlvbnMpe29wdGlvbnM9b3B0aW9ucz9fLmNsb25lKG9wdGlvbnMpOnt9O2lmKG9wdGlvbnMucGFyc2U9PT12b2lkIDApb3B0aW9ucy5wYXJzZT10cnVlO3ZhciBtb2RlbD10aGlzO3ZhciBzdWNjZXNzPW9wdGlvbnMuc3VjY2VzcztvcHRpb25zLnN1Y2Nlc3M9ZnVuY3Rpb24ocmVzcCl7aWYoIW1vZGVsLnNldChtb2RlbC5wYXJzZShyZXNwLG9wdGlvbnMpLG9wdGlvbnMpKXJldHVybiBmYWxzZTtpZihzdWNjZXNzKXN1Y2Nlc3MobW9kZWwscmVzcCxvcHRpb25zKTttb2RlbC50cmlnZ2VyKCdzeW5jJyxtb2RlbCxyZXNwLG9wdGlvbnMpO307d3JhcEVycm9yKHRoaXMsb3B0aW9ucyk7cmV0dXJuIHRoaXMuc3luYygncmVhZCcsdGhpcyxvcHRpb25zKTt9LHNhdmU6ZnVuY3Rpb24oa2V5LHZhbCxvcHRpb25zKXt2YXIgYXR0cnMsbWV0aG9kLHhocixhdHRyaWJ1dGVzPXRoaXMuYXR0cmlidXRlcztpZihrZXk9PW51bGx8fHR5cGVvZiBrZXk9PT0nb2JqZWN0Jyl7YXR0cnM9a2V5O29wdGlvbnM9dmFsO31lbHNleyhhdHRycz17fSlba2V5XT12YWw7fQpvcHRpb25zPV8uZXh0ZW5kKHt2YWxpZGF0ZTp0cnVlfSxvcHRpb25zKTtpZihhdHRycyYmIW9wdGlvbnMud2FpdCl7aWYoIXRoaXMuc2V0KGF0dHJzLG9wdGlvbnMpKXJldHVybiBmYWxzZTt9ZWxzZXtpZighdGhpcy5fdmFsaWRhdGUoYXR0cnMsb3B0aW9ucykpcmV0dXJuIGZhbHNlO30KaWYoYXR0cnMmJm9wdGlvbnMud2FpdCl7dGhpcy5hdHRyaWJ1dGVzPV8uZXh0ZW5kKHt9LGF0dHJpYnV0ZXMsYXR0cnMpO30KaWYob3B0aW9ucy5wYXJzZT09PXZvaWQgMClvcHRpb25zLnBhcnNlPXRydWU7dmFyIG1vZGVsPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihyZXNwKXttb2RlbC5hdHRyaWJ1dGVzPWF0dHJpYnV0ZXM7dmFyIHNlcnZlckF0dHJzPW1vZGVsLnBhcnNlKHJlc3Asb3B0aW9ucyk7aWYob3B0aW9ucy53YWl0KXNlcnZlckF0dHJzPV8uZXh0ZW5kKGF0dHJzfHx7fSxzZXJ2ZXJBdHRycyk7aWYoXy5pc09iamVjdChzZXJ2ZXJBdHRycykmJiFtb2RlbC5zZXQoc2VydmVyQXR0cnMsb3B0aW9ucykpe3JldHVybiBmYWxzZTt9CmlmKHN1Y2Nlc3Mpc3VjY2Vzcyhtb2RlbCxyZXNwLG9wdGlvbnMpO21vZGVsLnRyaWdnZXIoJ3N5bmMnLG1vZGVsLHJlc3Asb3B0aW9ucyk7fTt3cmFwRXJyb3IodGhpcyxvcHRpb25zKTttZXRob2Q9dGhpcy5pc05ldygpPydjcmVhdGUnOihvcHRpb25zLnBhdGNoPydwYXRjaCc6J3VwZGF0ZScpO2lmKG1ldGhvZD09PSdwYXRjaCcpb3B0aW9ucy5hdHRycz1hdHRyczt4aHI9dGhpcy5zeW5jKG1ldGhvZCx0aGlzLG9wdGlvbnMpO2lmKGF0dHJzJiZvcHRpb25zLndhaXQpdGhpcy5hdHRyaWJ1dGVzPWF0dHJpYnV0ZXM7cmV0dXJuIHhocjt9LGRlc3Ryb3k6ZnVuY3Rpb24ob3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307dmFyIG1vZGVsPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO3ZhciBkZXN0cm95PWZ1bmN0aW9uKCl7bW9kZWwudHJpZ2dlcignZGVzdHJveScsbW9kZWwsbW9kZWwuY29sbGVjdGlvbixvcHRpb25zKTt9O29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihyZXNwKXtpZihvcHRpb25zLndhaXR8fG1vZGVsLmlzTmV3KCkpZGVzdHJveSgpO2lmKHN1Y2Nlc3Mpc3VjY2Vzcyhtb2RlbCxyZXNwLG9wdGlvbnMpO2lmKCFtb2RlbC5pc05ldygpKW1vZGVsLnRyaWdnZXIoJ3N5bmMnLG1vZGVsLHJlc3Asb3B0aW9ucyk7fTtpZih0aGlzLmlzTmV3KCkpe29wdGlvbnMuc3VjY2VzcygpO3JldHVybiBmYWxzZTt9CndyYXBFcnJvcih0aGlzLG9wdGlvbnMpO3ZhciB4aHI9dGhpcy5zeW5jKCdkZWxldGUnLHRoaXMsb3B0aW9ucyk7aWYoIW9wdGlvbnMud2FpdClkZXN0cm95KCk7cmV0dXJuIHhocjt9LHVybDpmdW5jdGlvbigpe3ZhciBiYXNlPV8ucmVzdWx0KHRoaXMsJ3VybFJvb3QnKXx8Xy5yZXN1bHQodGhpcy5jb2xsZWN0aW9uLCd1cmwnKXx8dXJsRXJyb3IoKTtpZih0aGlzLmlzTmV3KCkpcmV0dXJuIGJhc2U7cmV0dXJuIGJhc2UrKGJhc2UuY2hhckF0KGJhc2UubGVuZ3RoLTEpPT09Jy8nPycnOicvJykrZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuaWQpO30scGFyc2U6ZnVuY3Rpb24ocmVzcCxvcHRpb25zKXtyZXR1cm4gcmVzcDt9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuYXR0cmlidXRlcyk7fSxpc05ldzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlkPT1udWxsO30saXNWYWxpZDpmdW5jdGlvbihvcHRpb25zKXtyZXR1cm4gdGhpcy5fdmFsaWRhdGUoe30sXy5leHRlbmQob3B0aW9uc3x8e30se3ZhbGlkYXRlOnRydWV9KSk7fSxfdmFsaWRhdGU6ZnVuY3Rpb24oYXR0cnMsb3B0aW9ucyl7aWYoIW9wdGlvbnMudmFsaWRhdGV8fCF0aGlzLnZhbGlkYXRlKXJldHVybiB0cnVlO2F0dHJzPV8uZXh0ZW5kKHt9LHRoaXMuYXR0cmlidXRlcyxhdHRycyk7dmFyIGVycm9yPXRoaXMudmFsaWRhdGlvbkVycm9yPXRoaXMudmFsaWRhdGUoYXR0cnMsb3B0aW9ucyl8fG51bGw7aWYoIWVycm9yKXJldHVybiB0cnVlO3RoaXMudHJpZ2dlcignaW52YWxpZCcsdGhpcyxlcnJvcixfLmV4dGVuZChvcHRpb25zLHt2YWxpZGF0aW9uRXJyb3I6ZXJyb3J9KSk7cmV0dXJuIGZhbHNlO319KTt2YXIgbW9kZWxNZXRob2RzPVsna2V5cycsJ3ZhbHVlcycsJ3BhaXJzJywnaW52ZXJ0JywncGljaycsJ29taXQnXTtfLmVhY2gobW9kZWxNZXRob2RzLGZ1bmN0aW9uKG1ldGhvZCl7TW9kZWwucHJvdG90eXBlW21ldGhvZF09ZnVuY3Rpb24oKXt2YXIgYXJncz1zbGljZS5jYWxsKGFyZ3VtZW50cyk7YXJncy51bnNoaWZ0KHRoaXMuYXR0cmlidXRlcyk7cmV0dXJuIF9bbWV0aG9kXS5hcHBseShfLGFyZ3MpO307fSk7dmFyIENvbGxlY3Rpb249QmFja2JvbmUuQ29sbGVjdGlvbj1mdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7b3B0aW9uc3x8KG9wdGlvbnM9e30pO2lmKG9wdGlvbnMubW9kZWwpdGhpcy5tb2RlbD1vcHRpb25zLm1vZGVsO2lmKG9wdGlvbnMuY29tcGFyYXRvciE9PXZvaWQgMCl0aGlzLmNvbXBhcmF0b3I9b3B0aW9ucy5jb21wYXJhdG9yO3RoaXMuX3Jlc2V0KCk7dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihtb2RlbHMpdGhpcy5yZXNldChtb2RlbHMsXy5leHRlbmQoe3NpbGVudDp0cnVlfSxvcHRpb25zKSk7fTt2YXIgc2V0T3B0aW9ucz17YWRkOnRydWUscmVtb3ZlOnRydWUsbWVyZ2U6dHJ1ZX07dmFyIGFkZE9wdGlvbnM9e2FkZDp0cnVlLHJlbW92ZTpmYWxzZX07Xy5leHRlbmQoQ29sbGVjdGlvbi5wcm90b3R5cGUsRXZlbnRzLHttb2RlbDpNb2RlbCxpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSx0b0pTT046ZnVuY3Rpb24ob3B0aW9ucyl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKG1vZGVsKXtyZXR1cm4gbW9kZWwudG9KU09OKG9wdGlvbnMpO30pO30sc3luYzpmdW5jdGlvbigpe3JldHVybiBCYWNrYm9uZS5zeW5jLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9LGFkZDpmdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7cmV0dXJuIHRoaXMuc2V0KG1vZGVscyxfLmV4dGVuZCh7bWVyZ2U6ZmFsc2V9LG9wdGlvbnMsYWRkT3B0aW9ucykpO30scmVtb3ZlOmZ1bmN0aW9uKG1vZGVscyxvcHRpb25zKXt2YXIgc2luZ3VsYXI9IV8uaXNBcnJheShtb2RlbHMpO21vZGVscz1zaW5ndWxhcj9bbW9kZWxzXTpfLmNsb25lKG1vZGVscyk7b3B0aW9uc3x8KG9wdGlvbnM9e30pO3ZhciBpLGwsaW5kZXgsbW9kZWw7Zm9yKGk9MCxsPW1vZGVscy5sZW5ndGg7aTxsO2krKyl7bW9kZWw9bW9kZWxzW2ldPXRoaXMuZ2V0KG1vZGVsc1tpXSk7aWYoIW1vZGVsKWNvbnRpbnVlO2RlbGV0ZSB0aGlzLl9ieUlkW21vZGVsLmlkXTtkZWxldGUgdGhpcy5fYnlJZFttb2RlbC5jaWRdO2luZGV4PXRoaXMuaW5kZXhPZihtb2RlbCk7dGhpcy5tb2RlbHMuc3BsaWNlKGluZGV4LDEpO3RoaXMubGVuZ3RoLS07aWYoIW9wdGlvbnMuc2lsZW50KXtvcHRpb25zLmluZGV4PWluZGV4O21vZGVsLnRyaWdnZXIoJ3JlbW92ZScsbW9kZWwsdGhpcyxvcHRpb25zKTt9CnRoaXMuX3JlbW92ZVJlZmVyZW5jZShtb2RlbCk7fQpyZXR1cm4gc2luZ3VsYXI/bW9kZWxzWzBdOm1vZGVsczt9LHNldDpmdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7b3B0aW9ucz1fLmRlZmF1bHRzKHt9LG9wdGlvbnMsc2V0T3B0aW9ucyk7aWYob3B0aW9ucy5wYXJzZSltb2RlbHM9dGhpcy5wYXJzZShtb2RlbHMsb3B0aW9ucyk7dmFyIHNpbmd1bGFyPSFfLmlzQXJyYXkobW9kZWxzKTttb2RlbHM9c2luZ3VsYXI/KG1vZGVscz9bbW9kZWxzXTpbXSk6Xy5jbG9uZShtb2RlbHMpO3ZhciBpLGwsaWQsbW9kZWwsYXR0cnMsZXhpc3Rpbmcsc29ydDt2YXIgYXQ9b3B0aW9ucy5hdDt2YXIgdGFyZ2V0TW9kZWw9dGhpcy5tb2RlbDt2YXIgc29ydGFibGU9dGhpcy5jb21wYXJhdG9yJiYoYXQ9PW51bGwpJiZvcHRpb25zLnNvcnQhPT1mYWxzZTt2YXIgc29ydEF0dHI9Xy5pc1N0cmluZyh0aGlzLmNvbXBhcmF0b3IpP3RoaXMuY29tcGFyYXRvcjpudWxsO3ZhciB0b0FkZD1bXSx0b1JlbW92ZT1bXSxtb2RlbE1hcD17fTt2YXIgYWRkPW9wdGlvbnMuYWRkLG1lcmdlPW9wdGlvbnMubWVyZ2UscmVtb3ZlPW9wdGlvbnMucmVtb3ZlO3ZhciBvcmRlcj0hc29ydGFibGUmJmFkZCYmcmVtb3ZlP1tdOmZhbHNlO2ZvcihpPTAsbD1tb2RlbHMubGVuZ3RoO2k8bDtpKyspe2F0dHJzPW1vZGVsc1tpXTtpZihhdHRycyBpbnN0YW5jZW9mIE1vZGVsKXtpZD1tb2RlbD1hdHRyczt9ZWxzZXtpZD1hdHRyc1t0YXJnZXRNb2RlbC5wcm90b3R5cGUuaWRBdHRyaWJ1dGVdO30KaWYoZXhpc3Rpbmc9dGhpcy5nZXQoaWQpKXtpZihyZW1vdmUpbW9kZWxNYXBbZXhpc3RpbmcuY2lkXT10cnVlO2lmKG1lcmdlKXthdHRycz1hdHRycz09PW1vZGVsP21vZGVsLmF0dHJpYnV0ZXM6YXR0cnM7aWYob3B0aW9ucy5wYXJzZSlhdHRycz1leGlzdGluZy5wYXJzZShhdHRycyxvcHRpb25zKTtleGlzdGluZy5zZXQoYXR0cnMsb3B0aW9ucyk7aWYoc29ydGFibGUmJiFzb3J0JiZleGlzdGluZy5oYXNDaGFuZ2VkKHNvcnRBdHRyKSlzb3J0PXRydWU7fQptb2RlbHNbaV09ZXhpc3Rpbmc7fWVsc2UgaWYoYWRkKXttb2RlbD1tb2RlbHNbaV09dGhpcy5fcHJlcGFyZU1vZGVsKGF0dHJzLG9wdGlvbnMpO2lmKCFtb2RlbCljb250aW51ZTt0b0FkZC5wdXNoKG1vZGVsKTttb2RlbC5vbignYWxsJyx0aGlzLl9vbk1vZGVsRXZlbnQsdGhpcyk7dGhpcy5fYnlJZFttb2RlbC5jaWRdPW1vZGVsO2lmKG1vZGVsLmlkIT1udWxsKXRoaXMuX2J5SWRbbW9kZWwuaWRdPW1vZGVsO30KaWYob3JkZXIpb3JkZXIucHVzaChleGlzdGluZ3x8bW9kZWwpO30KaWYocmVtb3ZlKXtmb3IoaT0wLGw9dGhpcy5sZW5ndGg7aTxsOysraSl7aWYoIW1vZGVsTWFwWyhtb2RlbD10aGlzLm1vZGVsc1tpXSkuY2lkXSl0b1JlbW92ZS5wdXNoKG1vZGVsKTt9CmlmKHRvUmVtb3ZlLmxlbmd0aCl0aGlzLnJlbW92ZSh0b1JlbW92ZSxvcHRpb25zKTt9CmlmKHRvQWRkLmxlbmd0aHx8KG9yZGVyJiZvcmRlci5sZW5ndGgpKXtpZihzb3J0YWJsZSlzb3J0PXRydWU7dGhpcy5sZW5ndGgrPXRvQWRkLmxlbmd0aDtpZihhdCE9bnVsbCl7Zm9yKGk9MCxsPXRvQWRkLmxlbmd0aDtpPGw7aSsrKXt0aGlzLm1vZGVscy5zcGxpY2UoYXQraSwwLHRvQWRkW2ldKTt9fWVsc2V7aWYob3JkZXIpdGhpcy5tb2RlbHMubGVuZ3RoPTA7dmFyIG9yZGVyZWRNb2RlbHM9b3JkZXJ8fHRvQWRkO2ZvcihpPTAsbD1vcmRlcmVkTW9kZWxzLmxlbmd0aDtpPGw7aSsrKXt0aGlzLm1vZGVscy5wdXNoKG9yZGVyZWRNb2RlbHNbaV0pO319fQppZihzb3J0KXRoaXMuc29ydCh7c2lsZW50OnRydWV9KTtpZighb3B0aW9ucy5zaWxlbnQpe2ZvcihpPTAsbD10b0FkZC5sZW5ndGg7aTxsO2krKyl7KG1vZGVsPXRvQWRkW2ldKS50cmlnZ2VyKCdhZGQnLG1vZGVsLHRoaXMsb3B0aW9ucyk7fQppZihzb3J0fHwob3JkZXImJm9yZGVyLmxlbmd0aCkpdGhpcy50cmlnZ2VyKCdzb3J0Jyx0aGlzLG9wdGlvbnMpO30KcmV0dXJuIHNpbmd1bGFyP21vZGVsc1swXTptb2RlbHM7fSxyZXNldDpmdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7b3B0aW9uc3x8KG9wdGlvbnM9e30pO2Zvcih2YXIgaT0wLGw9dGhpcy5tb2RlbHMubGVuZ3RoO2k8bDtpKyspe3RoaXMuX3JlbW92ZVJlZmVyZW5jZSh0aGlzLm1vZGVsc1tpXSk7fQpvcHRpb25zLnByZXZpb3VzTW9kZWxzPXRoaXMubW9kZWxzO3RoaXMuX3Jlc2V0KCk7bW9kZWxzPXRoaXMuYWRkKG1vZGVscyxfLmV4dGVuZCh7c2lsZW50OnRydWV9LG9wdGlvbnMpKTtpZighb3B0aW9ucy5zaWxlbnQpdGhpcy50cmlnZ2VyKCdyZXNldCcsdGhpcyxvcHRpb25zKTtyZXR1cm4gbW9kZWxzO30scHVzaDpmdW5jdGlvbihtb2RlbCxvcHRpb25zKXtyZXR1cm4gdGhpcy5hZGQobW9kZWwsXy5leHRlbmQoe2F0OnRoaXMubGVuZ3RofSxvcHRpb25zKSk7fSxwb3A6ZnVuY3Rpb24ob3B0aW9ucyl7dmFyIG1vZGVsPXRoaXMuYXQodGhpcy5sZW5ndGgtMSk7dGhpcy5yZW1vdmUobW9kZWwsb3B0aW9ucyk7cmV0dXJuIG1vZGVsO30sdW5zaGlmdDpmdW5jdGlvbihtb2RlbCxvcHRpb25zKXtyZXR1cm4gdGhpcy5hZGQobW9kZWwsXy5leHRlbmQoe2F0OjB9LG9wdGlvbnMpKTt9LHNoaWZ0OmZ1bmN0aW9uKG9wdGlvbnMpe3ZhciBtb2RlbD10aGlzLmF0KDApO3RoaXMucmVtb3ZlKG1vZGVsLG9wdGlvbnMpO3JldHVybiBtb2RlbDt9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHNsaWNlLmFwcGx5KHRoaXMubW9kZWxzLGFyZ3VtZW50cyk7fSxnZXQ6ZnVuY3Rpb24ob2JqKXtpZihvYmo9PW51bGwpcmV0dXJuIHZvaWQgMDtyZXR1cm4gdGhpcy5fYnlJZFtvYmouaWRdfHx0aGlzLl9ieUlkW29iai5jaWRdfHx0aGlzLl9ieUlkW29ial07fSxhdDpmdW5jdGlvbihpbmRleCl7cmV0dXJuIHRoaXMubW9kZWxzW2luZGV4XTt9LHdoZXJlOmZ1bmN0aW9uKGF0dHJzLGZpcnN0KXtpZihfLmlzRW1wdHkoYXR0cnMpKXJldHVybiBmaXJzdD92b2lkIDA6W107cmV0dXJuIHRoaXNbZmlyc3Q/J2ZpbmQnOidmaWx0ZXInXShmdW5jdGlvbihtb2RlbCl7Zm9yKHZhciBrZXkgaW4gYXR0cnMpe2lmKGF0dHJzW2tleV0hPT1tb2RlbC5nZXQoa2V5KSlyZXR1cm4gZmFsc2U7fQpyZXR1cm4gdHJ1ZTt9KTt9LGZpbmRXaGVyZTpmdW5jdGlvbihhdHRycyl7cmV0dXJuIHRoaXMud2hlcmUoYXR0cnMsdHJ1ZSk7fSxzb3J0OmZ1bmN0aW9uKG9wdGlvbnMpe2lmKCF0aGlzLmNvbXBhcmF0b3IpdGhyb3cgbmV3IEVycm9yKCdDYW5ub3Qgc29ydCBhIHNldCB3aXRob3V0IGEgY29tcGFyYXRvcicpO29wdGlvbnN8fChvcHRpb25zPXt9KTtpZihfLmlzU3RyaW5nKHRoaXMuY29tcGFyYXRvcil8fHRoaXMuY29tcGFyYXRvci5sZW5ndGg9PT0xKXt0aGlzLm1vZGVscz10aGlzLnNvcnRCeSh0aGlzLmNvbXBhcmF0b3IsdGhpcyk7fWVsc2V7dGhpcy5tb2RlbHMuc29ydChfLmJpbmQodGhpcy5jb21wYXJhdG9yLHRoaXMpKTt9CmlmKCFvcHRpb25zLnNpbGVudCl0aGlzLnRyaWdnZXIoJ3NvcnQnLHRoaXMsb3B0aW9ucyk7cmV0dXJuIHRoaXM7fSxwbHVjazpmdW5jdGlvbihhdHRyKXtyZXR1cm4gXy5pbnZva2UodGhpcy5tb2RlbHMsJ2dldCcsYXR0cik7fSxmZXRjaDpmdW5jdGlvbihvcHRpb25zKXtvcHRpb25zPW9wdGlvbnM/Xy5jbG9uZShvcHRpb25zKTp7fTtpZihvcHRpb25zLnBhcnNlPT09dm9pZCAwKW9wdGlvbnMucGFyc2U9dHJ1ZTt2YXIgc3VjY2Vzcz1vcHRpb25zLnN1Y2Nlc3M7dmFyIGNvbGxlY3Rpb249dGhpcztvcHRpb25zLnN1Y2Nlc3M9ZnVuY3Rpb24ocmVzcCl7dmFyIG1ldGhvZD1vcHRpb25zLnJlc2V0PydyZXNldCc6J3NldCc7Y29sbGVjdGlvblttZXRob2RdKHJlc3Asb3B0aW9ucyk7aWYoc3VjY2VzcylzdWNjZXNzKGNvbGxlY3Rpb24scmVzcCxvcHRpb25zKTtjb2xsZWN0aW9uLnRyaWdnZXIoJ3N5bmMnLGNvbGxlY3Rpb24scmVzcCxvcHRpb25zKTt9O3dyYXBFcnJvcih0aGlzLG9wdGlvbnMpO3JldHVybiB0aGlzLnN5bmMoJ3JlYWQnLHRoaXMsb3B0aW9ucyk7fSxjcmVhdGU6ZnVuY3Rpb24obW9kZWwsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307aWYoIShtb2RlbD10aGlzLl9wcmVwYXJlTW9kZWwobW9kZWwsb3B0aW9ucykpKXJldHVybiBmYWxzZTtpZighb3B0aW9ucy53YWl0KXRoaXMuYWRkKG1vZGVsLG9wdGlvbnMpO3ZhciBjb2xsZWN0aW9uPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihtb2RlbCxyZXNwLG9wdGlvbnMpe2lmKG9wdGlvbnMud2FpdCljb2xsZWN0aW9uLmFkZChtb2RlbCxvcHRpb25zKTtpZihzdWNjZXNzKXN1Y2Nlc3MobW9kZWwscmVzcCxvcHRpb25zKTt9O21vZGVsLnNhdmUobnVsbCxvcHRpb25zKTtyZXR1cm4gbW9kZWw7fSxwYXJzZTpmdW5jdGlvbihyZXNwLG9wdGlvbnMpe3JldHVybiByZXNwO30sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5tb2RlbHMpO30sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5sZW5ndGg9MDt0aGlzLm1vZGVscz1bXTt0aGlzLl9ieUlkPXt9O30sX3ByZXBhcmVNb2RlbDpmdW5jdGlvbihhdHRycyxvcHRpb25zKXtpZihhdHRycyBpbnN0YW5jZW9mIE1vZGVsKXtpZighYXR0cnMuY29sbGVjdGlvbilhdHRycy5jb2xsZWN0aW9uPXRoaXM7cmV0dXJuIGF0dHJzO30Kb3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307b3B0aW9ucy5jb2xsZWN0aW9uPXRoaXM7dmFyIG1vZGVsPW5ldyB0aGlzLm1vZGVsKGF0dHJzLG9wdGlvbnMpO2lmKCFtb2RlbC52YWxpZGF0aW9uRXJyb3IpcmV0dXJuIG1vZGVsO3RoaXMudHJpZ2dlcignaW52YWxpZCcsdGhpcyxtb2RlbC52YWxpZGF0aW9uRXJyb3Isb3B0aW9ucyk7cmV0dXJuIGZhbHNlO30sX3JlbW92ZVJlZmVyZW5jZTpmdW5jdGlvbihtb2RlbCl7aWYodGhpcz09PW1vZGVsLmNvbGxlY3Rpb24pZGVsZXRlIG1vZGVsLmNvbGxlY3Rpb247bW9kZWwub2ZmKCdhbGwnLHRoaXMuX29uTW9kZWxFdmVudCx0aGlzKTt9LF9vbk1vZGVsRXZlbnQ6ZnVuY3Rpb24oZXZlbnQsbW9kZWwsY29sbGVjdGlvbixvcHRpb25zKXtpZigoZXZlbnQ9PT0nYWRkJ3x8ZXZlbnQ9PT0ncmVtb3ZlJykmJmNvbGxlY3Rpb24hPT10aGlzKXJldHVybjtpZihldmVudD09PSdkZXN0cm95Jyl0aGlzLnJlbW92ZShtb2RlbCxvcHRpb25zKTtpZihtb2RlbCYmZXZlbnQ9PT0nY2hhbmdlOicrbW9kZWwuaWRBdHRyaWJ1dGUpe2RlbGV0ZSB0aGlzLl9ieUlkW21vZGVsLnByZXZpb3VzKG1vZGVsLmlkQXR0cmlidXRlKV07aWYobW9kZWwuaWQhPW51bGwpdGhpcy5fYnlJZFttb2RlbC5pZF09bW9kZWw7fQp0aGlzLnRyaWdnZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319KTt2YXIgbWV0aG9kcz1bJ2ZvckVhY2gnLCdlYWNoJywnbWFwJywnY29sbGVjdCcsJ3JlZHVjZScsJ2ZvbGRsJywnaW5qZWN0JywncmVkdWNlUmlnaHQnLCdmb2xkcicsJ2ZpbmQnLCdkZXRlY3QnLCdmaWx0ZXInLCdzZWxlY3QnLCdyZWplY3QnLCdldmVyeScsJ2FsbCcsJ3NvbWUnLCdhbnknLCdpbmNsdWRlJywnY29udGFpbnMnLCdpbnZva2UnLCdtYXgnLCdtaW4nLCd0b0FycmF5Jywnc2l6ZScsJ2ZpcnN0JywnaGVhZCcsJ3Rha2UnLCdpbml0aWFsJywncmVzdCcsJ3RhaWwnLCdkcm9wJywnbGFzdCcsJ3dpdGhvdXQnLCdkaWZmZXJlbmNlJywnaW5kZXhPZicsJ3NodWZmbGUnLCdsYXN0SW5kZXhPZicsJ2lzRW1wdHknLCdjaGFpbiddO18uZWFjaChtZXRob2RzLGZ1bmN0aW9uKG1ldGhvZCl7Q29sbGVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXT1mdW5jdGlvbigpe3ZhciBhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzKTthcmdzLnVuc2hpZnQodGhpcy5tb2RlbHMpO3JldHVybiBfW21ldGhvZF0uYXBwbHkoXyxhcmdzKTt9O30pO3ZhciBhdHRyaWJ1dGVNZXRob2RzPVsnZ3JvdXBCeScsJ2NvdW50QnknLCdzb3J0QnknXTtfLmVhY2goYXR0cmlidXRlTWV0aG9kcyxmdW5jdGlvbihtZXRob2Qpe0NvbGxlY3Rpb24ucHJvdG90eXBlW21ldGhvZF09ZnVuY3Rpb24odmFsdWUsY29udGV4dCl7dmFyIGl0ZXJhdG9yPV8uaXNGdW5jdGlvbih2YWx1ZSk/dmFsdWU6ZnVuY3Rpb24obW9kZWwpe3JldHVybiBtb2RlbC5nZXQodmFsdWUpO307cmV0dXJuIF9bbWV0aG9kXSh0aGlzLm1vZGVscyxpdGVyYXRvcixjb250ZXh0KTt9O30pO3ZhciBWaWV3PUJhY2tib25lLlZpZXc9ZnVuY3Rpb24ob3B0aW9ucyl7dGhpcy5jaWQ9Xy51bmlxdWVJZCgndmlldycpO29wdGlvbnN8fChvcHRpb25zPXt9KTtfLmV4dGVuZCh0aGlzLF8ucGljayhvcHRpb25zLHZpZXdPcHRpb25zKSk7dGhpcy5fZW5zdXJlRWxlbWVudCgpO3RoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5kZWxlZ2F0ZUV2ZW50cygpO307dmFyIGRlbGVnYXRlRXZlbnRTcGxpdHRlcj0vXihcUyspXHMqKC4qKSQvO3ZhciB2aWV3T3B0aW9ucz1bJ21vZGVsJywnY29sbGVjdGlvbicsJ2VsJywnaWQnLCdhdHRyaWJ1dGVzJywnY2xhc3NOYW1lJywndGFnTmFtZScsJ2V2ZW50cyddO18uZXh0ZW5kKFZpZXcucHJvdG90eXBlLEV2ZW50cyx7dGFnTmFtZTonZGl2JywkOmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4gdGhpcy4kZWwuZmluZChzZWxlY3Rvcik7fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpczt9LHJlbW92ZTpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZSgpO3RoaXMuc3RvcExpc3RlbmluZygpO3JldHVybiB0aGlzO30sc2V0RWxlbWVudDpmdW5jdGlvbihlbGVtZW50LGRlbGVnYXRlKXtpZih0aGlzLiRlbCl0aGlzLnVuZGVsZWdhdGVFdmVudHMoKTt0aGlzLiRlbD1lbGVtZW50IGluc3RhbmNlb2YgQmFja2JvbmUuJD9lbGVtZW50OkJhY2tib25lLiQoZWxlbWVudCk7dGhpcy5lbD10aGlzLiRlbFswXTtpZihkZWxlZ2F0ZSE9PWZhbHNlKXRoaXMuZGVsZWdhdGVFdmVudHMoKTtyZXR1cm4gdGhpczt9LGRlbGVnYXRlRXZlbnRzOmZ1bmN0aW9uKGV2ZW50cyl7aWYoIShldmVudHN8fChldmVudHM9Xy5yZXN1bHQodGhpcywnZXZlbnRzJykpKSlyZXR1cm4gdGhpczt0aGlzLnVuZGVsZWdhdGVFdmVudHMoKTtmb3IodmFyIGtleSBpbiBldmVudHMpe3ZhciBtZXRob2Q9ZXZlbnRzW2tleV07aWYoIV8uaXNGdW5jdGlvbihtZXRob2QpKW1ldGhvZD10aGlzW2V2ZW50c1trZXldXTtpZighbWV0aG9kKWNvbnRpbnVlO3ZhciBtYXRjaD1rZXkubWF0Y2goZGVsZWdhdGVFdmVudFNwbGl0dGVyKTt2YXIgZXZlbnROYW1lPW1hdGNoWzFdLHNlbGVjdG9yPW1hdGNoWzJdO21ldGhvZD1fLmJpbmQobWV0aG9kLHRoaXMpO2V2ZW50TmFtZSs9Jy5kZWxlZ2F0ZUV2ZW50cycrdGhpcy5jaWQ7aWYoc2VsZWN0b3I9PT0nJyl7dGhpcy4kZWwub24oZXZlbnROYW1lLG1ldGhvZCk7fWVsc2V7dGhpcy4kZWwub24oZXZlbnROYW1lLHNlbGVjdG9yLG1ldGhvZCk7fX0KcmV0dXJuIHRoaXM7fSx1bmRlbGVnYXRlRXZlbnRzOmZ1bmN0aW9uKCl7dGhpcy4kZWwub2ZmKCcuZGVsZWdhdGVFdmVudHMnK3RoaXMuY2lkKTtyZXR1cm4gdGhpczt9LF9lbnN1cmVFbGVtZW50OmZ1bmN0aW9uKCl7aWYoIXRoaXMuZWwpe3ZhciBhdHRycz1fLmV4dGVuZCh7fSxfLnJlc3VsdCh0aGlzLCdhdHRyaWJ1dGVzJykpO2lmKHRoaXMuaWQpYXR0cnMuaWQ9Xy5yZXN1bHQodGhpcywnaWQnKTtpZih0aGlzLmNsYXNzTmFtZSlhdHRyc1snY2xhc3MnXT1fLnJlc3VsdCh0aGlzLCdjbGFzc05hbWUnKTt2YXIgJGVsPUJhY2tib25lLiQoJzwnK18ucmVzdWx0KHRoaXMsJ3RhZ05hbWUnKSsnPicpLmF0dHIoYXR0cnMpO3RoaXMuc2V0RWxlbWVudCgkZWwsZmFsc2UpO31lbHNle3RoaXMuc2V0RWxlbWVudChfLnJlc3VsdCh0aGlzLCdlbCcpLGZhbHNlKTt9fX0pO0JhY2tib25lLnN5bmM9ZnVuY3Rpb24obWV0aG9kLG1vZGVsLG9wdGlvbnMpe3ZhciB0eXBlPW1ldGhvZE1hcFttZXRob2RdO18uZGVmYXVsdHMob3B0aW9uc3x8KG9wdGlvbnM9e30pLHtlbXVsYXRlSFRUUDpCYWNrYm9uZS5lbXVsYXRlSFRUUCxlbXVsYXRlSlNPTjpCYWNrYm9uZS5lbXVsYXRlSlNPTn0pO3ZhciBwYXJhbXM9e3R5cGU6dHlwZSxkYXRhVHlwZTonanNvbid9O2lmKCFvcHRpb25zLnVybCl7cGFyYW1zLnVybD1fLnJlc3VsdChtb2RlbCwndXJsJyl8fHVybEVycm9yKCk7fQppZihvcHRpb25zLmRhdGE9PW51bGwmJm1vZGVsJiYobWV0aG9kPT09J2NyZWF0ZSd8fG1ldGhvZD09PSd1cGRhdGUnfHxtZXRob2Q9PT0ncGF0Y2gnKSl7cGFyYW1zLmNvbnRlbnRUeXBlPSdhcHBsaWNhdGlvbi9qc29uJztwYXJhbXMuZGF0YT1KU09OLnN0cmluZ2lmeShvcHRpb25zLmF0dHJzfHxtb2RlbC50b0pTT04ob3B0aW9ucykpO30KaWYob3B0aW9ucy5lbXVsYXRlSlNPTil7cGFyYW1zLmNvbnRlbnRUeXBlPSdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnO3BhcmFtcy5kYXRhPXBhcmFtcy5kYXRhP3ttb2RlbDpwYXJhbXMuZGF0YX06e307fQppZihvcHRpb25zLmVtdWxhdGVIVFRQJiYodHlwZT09PSdQVVQnfHx0eXBlPT09J0RFTEVURSd8fHR5cGU9PT0nUEFUQ0gnKSl7cGFyYW1zLnR5cGU9J1BPU1QnO2lmKG9wdGlvbnMuZW11bGF0ZUpTT04pcGFyYW1zLmRhdGEuX21ldGhvZD10eXBlO3ZhciBiZWZvcmVTZW5kPW9wdGlvbnMuYmVmb3JlU2VuZDtvcHRpb25zLmJlZm9yZVNlbmQ9ZnVuY3Rpb24oeGhyKXt4aHIuc2V0UmVxdWVzdEhlYWRlcignWC1IVFRQLU1ldGhvZC1PdmVycmlkZScsdHlwZSk7aWYoYmVmb3JlU2VuZClyZXR1cm4gYmVmb3JlU2VuZC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTt9CmlmKHBhcmFtcy50eXBlIT09J0dFVCcmJiFvcHRpb25zLmVtdWxhdGVKU09OKXtwYXJhbXMucHJvY2Vzc0RhdGE9ZmFsc2U7fQppZihwYXJhbXMudHlwZT09PSdQQVRDSCcmJm5vWGhyUGF0Y2gpe3BhcmFtcy54aHI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7fTt9CnZhciB4aHI9b3B0aW9ucy54aHI9QmFja2JvbmUuYWpheChfLmV4dGVuZChwYXJhbXMsb3B0aW9ucykpO21vZGVsLnRyaWdnZXIoJ3JlcXVlc3QnLG1vZGVsLHhocixvcHRpb25zKTtyZXR1cm4geGhyO307dmFyIG5vWGhyUGF0Y2g9dHlwZW9mIHdpbmRvdyE9PSd1bmRlZmluZWQnJiYhIXdpbmRvdy5BY3RpdmVYT2JqZWN0JiYhKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCYmKG5ldyBYTUxIdHRwUmVxdWVzdCkuZGlzcGF0Y2hFdmVudCk7dmFyIG1ldGhvZE1hcD17J2NyZWF0ZSc6J1BPU1QnLCd1cGRhdGUnOidQVVQnLCdwYXRjaCc6J1BBVENIJywnZGVsZXRlJzonREVMRVRFJywncmVhZCc6J0dFVCd9O0JhY2tib25lLmFqYXg9ZnVuY3Rpb24oKXtyZXR1cm4gQmFja2JvbmUuJC5hamF4LmFwcGx5KEJhY2tib25lLiQsYXJndW1lbnRzKTt9O3ZhciBSb3V0ZXI9QmFja2JvbmUuUm91dGVyPWZ1bmN0aW9uKG9wdGlvbnMpe29wdGlvbnN8fChvcHRpb25zPXt9KTtpZihvcHRpb25zLnJvdXRlcyl0aGlzLnJvdXRlcz1vcHRpb25zLnJvdXRlczt0aGlzLl9iaW5kUm91dGVzKCk7dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O3ZhciBvcHRpb25hbFBhcmFtPS9cKCguKj8pXCkvZzt2YXIgbmFtZWRQYXJhbT0vKFwoXD8pPzpcdysvZzt2YXIgc3BsYXRQYXJhbT0vXCpcdysvZzt2YXIgZXNjYXBlUmVnRXhwPS9bXC17fVxbXF0rPy4sXFxcXiR8I1xzXS9nO18uZXh0ZW5kKFJvdXRlci5wcm90b3R5cGUsRXZlbnRzLHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSxyb3V0ZTpmdW5jdGlvbihyb3V0ZSxuYW1lLGNhbGxiYWNrKXtpZighXy5pc1JlZ0V4cChyb3V0ZSkpcm91dGU9dGhpcy5fcm91dGVUb1JlZ0V4cChyb3V0ZSk7aWYoXy5pc0Z1bmN0aW9uKG5hbWUpKXtjYWxsYmFjaz1uYW1lO25hbWU9Jyc7fQppZighY2FsbGJhY2spY2FsbGJhY2s9dGhpc1tuYW1lXTt2YXIgcm91dGVyPXRoaXM7QmFja2JvbmUuaGlzdG9yeS5yb3V0ZShyb3V0ZSxmdW5jdGlvbihmcmFnbWVudCl7dmFyIGFyZ3M9cm91dGVyLl9leHRyYWN0UGFyYW1ldGVycyhyb3V0ZSxmcmFnbWVudCk7Y2FsbGJhY2smJmNhbGxiYWNrLmFwcGx5KHJvdXRlcixhcmdzKTtyb3V0ZXIudHJpZ2dlci5hcHBseShyb3V0ZXIsWydyb3V0ZTonK25hbWVdLmNvbmNhdChhcmdzKSk7cm91dGVyLnRyaWdnZXIoJ3JvdXRlJyxuYW1lLGFyZ3MpO0JhY2tib25lLmhpc3RvcnkudHJpZ2dlcigncm91dGUnLHJvdXRlcixuYW1lLGFyZ3MpO30pO3JldHVybiB0aGlzO30sbmF2aWdhdGU6ZnVuY3Rpb24oZnJhZ21lbnQsb3B0aW9ucyl7QmFja2JvbmUuaGlzdG9yeS5uYXZpZ2F0ZShmcmFnbWVudCxvcHRpb25zKTtyZXR1cm4gdGhpczt9LF9iaW5kUm91dGVzOmZ1bmN0aW9uKCl7aWYoIXRoaXMucm91dGVzKXJldHVybjt0aGlzLnJvdXRlcz1fLnJlc3VsdCh0aGlzLCdyb3V0ZXMnKTt2YXIgcm91dGUscm91dGVzPV8ua2V5cyh0aGlzLnJvdXRlcyk7d2hpbGUoKHJvdXRlPXJvdXRlcy5wb3AoKSkhPW51bGwpe3RoaXMucm91dGUocm91dGUsdGhpcy5yb3V0ZXNbcm91dGVdKTt9fSxfcm91dGVUb1JlZ0V4cDpmdW5jdGlvbihyb3V0ZSl7cm91dGU9cm91dGUucmVwbGFjZShlc2NhcGVSZWdFeHAsJ1xcJCYnKS5yZXBsYWNlKG9wdGlvbmFsUGFyYW0sJyg/OiQxKT8nKS5yZXBsYWNlKG5hbWVkUGFyYW0sZnVuY3Rpb24obWF0Y2gsb3B0aW9uYWwpe3JldHVybiBvcHRpb25hbD9tYXRjaDonKFteXC9dKyknO30pLnJlcGxhY2Uoc3BsYXRQYXJhbSwnKC4qPyknKTtyZXR1cm4gbmV3IFJlZ0V4cCgnXicrcm91dGUrJyQnKTt9LF9leHRyYWN0UGFyYW1ldGVyczpmdW5jdGlvbihyb3V0ZSxmcmFnbWVudCl7dmFyIHBhcmFtcz1yb3V0ZS5leGVjKGZyYWdtZW50KS5zbGljZSgxKTtyZXR1cm4gXy5tYXAocGFyYW1zLGZ1bmN0aW9uKHBhcmFtKXtyZXR1cm4gcGFyYW0/ZGVjb2RlVVJJQ29tcG9uZW50KHBhcmFtKTpudWxsO30pO319KTt2YXIgSGlzdG9yeT1CYWNrYm9uZS5IaXN0b3J5PWZ1bmN0aW9uKCl7dGhpcy5oYW5kbGVycz1bXTtfLmJpbmRBbGwodGhpcywnY2hlY2tVcmwnKTtpZih0eXBlb2Ygd2luZG93IT09J3VuZGVmaW5lZCcpe3RoaXMubG9jYXRpb249d2luZG93LmxvY2F0aW9uO3RoaXMuaGlzdG9yeT13aW5kb3cuaGlzdG9yeTt9fTt2YXIgcm91dGVTdHJpcHBlcj0vXlsjXC9dfFxzKyQvZzt2YXIgcm9vdFN0cmlwcGVyPS9eXC8rfFwvKyQvZzt2YXIgaXNFeHBsb3Jlcj0vbXNpZSBbXHcuXSsvO3ZhciB0cmFpbGluZ1NsYXNoPS9cLyQvO3ZhciBwYXRoU3RyaXBwZXI9L1s/I10uKiQvO0hpc3Rvcnkuc3RhcnRlZD1mYWxzZTtfLmV4dGVuZChIaXN0b3J5LnByb3RvdHlwZSxFdmVudHMse2ludGVydmFsOjUwLGdldEhhc2g6ZnVuY3Rpb24od2luZG93KXt2YXIgbWF0Y2g9KHdpbmRvd3x8dGhpcykubG9jYXRpb24uaHJlZi5tYXRjaCgvIyguKikkLyk7cmV0dXJuIG1hdGNoP21hdGNoWzFdOicnO30sZ2V0RnJhZ21lbnQ6ZnVuY3Rpb24oZnJhZ21lbnQsZm9yY2VQdXNoU3RhdGUpe2lmKGZyYWdtZW50PT1udWxsKXtpZih0aGlzLl9oYXNQdXNoU3RhdGV8fCF0aGlzLl93YW50c0hhc2hDaGFuZ2V8fGZvcmNlUHVzaFN0YXRlKXtmcmFnbWVudD10aGlzLmxvY2F0aW9uLnBhdGhuYW1lO3ZhciByb290PXRoaXMucm9vdC5yZXBsYWNlKHRyYWlsaW5nU2xhc2gsJycpO2lmKCFmcmFnbWVudC5pbmRleE9mKHJvb3QpKWZyYWdtZW50PWZyYWdtZW50LnNsaWNlKHJvb3QubGVuZ3RoKTt9ZWxzZXtmcmFnbWVudD10aGlzLmdldEhhc2goKTt9fQpyZXR1cm4gZnJhZ21lbnQucmVwbGFjZShyb3V0ZVN0cmlwcGVyLCcnKTt9LHN0YXJ0OmZ1bmN0aW9uKG9wdGlvbnMpe2lmKEhpc3Rvcnkuc3RhcnRlZCl0aHJvdyBuZXcgRXJyb3IoIkJhY2tib25lLmhpc3RvcnkgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIik7SGlzdG9yeS5zdGFydGVkPXRydWU7dGhpcy5vcHRpb25zPV8uZXh0ZW5kKHtyb290OicvJ30sdGhpcy5vcHRpb25zLG9wdGlvbnMpO3RoaXMucm9vdD10aGlzLm9wdGlvbnMucm9vdDt0aGlzLl93YW50c0hhc2hDaGFuZ2U9dGhpcy5vcHRpb25zLmhhc2hDaGFuZ2UhPT1mYWxzZTt0aGlzLl93YW50c1B1c2hTdGF0ZT0hIXRoaXMub3B0aW9ucy5wdXNoU3RhdGU7dGhpcy5faGFzUHVzaFN0YXRlPSEhKHRoaXMub3B0aW9ucy5wdXNoU3RhdGUmJnRoaXMuaGlzdG9yeSYmdGhpcy5oaXN0b3J5LnB1c2hTdGF0ZSk7dmFyIGZyYWdtZW50PXRoaXMuZ2V0RnJhZ21lbnQoKTt2YXIgZG9jTW9kZT1kb2N1bWVudC5kb2N1bWVudE1vZGU7dmFyIG9sZElFPShpc0V4cGxvcmVyLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKSYmKCFkb2NNb2RlfHxkb2NNb2RlPD03KSk7dGhpcy5yb290PSgnLycrdGhpcy5yb290KycvJykucmVwbGFjZShyb290U3RyaXBwZXIsJy8nKTtpZihvbGRJRSYmdGhpcy5fd2FudHNIYXNoQ2hhbmdlKXt0aGlzLmlmcmFtZT1CYWNrYm9uZS4kKCc8aWZyYW1lIHNyYz0iamF2YXNjcmlwdDowIiB0YWJpbmRleD0iLTEiIC8+JykuaGlkZSgpLmFwcGVuZFRvKCdib2R5JylbMF0uY29udGVudFdpbmRvdzt0aGlzLm5hdmlnYXRlKGZyYWdtZW50KTt9CmlmKHRoaXMuX2hhc1B1c2hTdGF0ZSl7QmFja2JvbmUuJCh3aW5kb3cpLm9uKCdwb3BzdGF0ZScsdGhpcy5jaGVja1VybCk7fWVsc2UgaWYodGhpcy5fd2FudHNIYXNoQ2hhbmdlJiYoJ29uaGFzaGNoYW5nZSdpbiB3aW5kb3cpJiYhb2xkSUUpe0JhY2tib25lLiQod2luZG93KS5vbignaGFzaGNoYW5nZScsdGhpcy5jaGVja1VybCk7fWVsc2UgaWYodGhpcy5fd2FudHNIYXNoQ2hhbmdlKXt0aGlzLl9jaGVja1VybEludGVydmFsPXNldEludGVydmFsKHRoaXMuY2hlY2tVcmwsdGhpcy5pbnRlcnZhbCk7fQp0aGlzLmZyYWdtZW50PWZyYWdtZW50O3ZhciBsb2M9dGhpcy5sb2NhdGlvbjt2YXIgYXRSb290PWxvYy5wYXRobmFtZS5yZXBsYWNlKC9bXlwvXSQvLCckJi8nKT09PXRoaXMucm9vdDtpZih0aGlzLl93YW50c0hhc2hDaGFuZ2UmJnRoaXMuX3dhbnRzUHVzaFN0YXRlKXtpZighdGhpcy5faGFzUHVzaFN0YXRlJiYhYXRSb290KXt0aGlzLmZyYWdtZW50PXRoaXMuZ2V0RnJhZ21lbnQobnVsbCx0cnVlKTt0aGlzLmxvY2F0aW9uLnJlcGxhY2UodGhpcy5yb290K3RoaXMubG9jYXRpb24uc2VhcmNoKycjJyt0aGlzLmZyYWdtZW50KTtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzLl9oYXNQdXNoU3RhdGUmJmF0Um9vdCYmbG9jLmhhc2gpe3RoaXMuZnJhZ21lbnQ9dGhpcy5nZXRIYXNoKCkucmVwbGFjZShyb3V0ZVN0cmlwcGVyLCcnKTt0aGlzLmhpc3RvcnkucmVwbGFjZVN0YXRlKHt9LGRvY3VtZW50LnRpdGxlLHRoaXMucm9vdCt0aGlzLmZyYWdtZW50K2xvYy5zZWFyY2gpO319CmlmKCF0aGlzLm9wdGlvbnMuc2lsZW50KXJldHVybiB0aGlzLmxvYWRVcmwoKTt9LHN0b3A6ZnVuY3Rpb24oKXtCYWNrYm9uZS4kKHdpbmRvdykub2ZmKCdwb3BzdGF0ZScsdGhpcy5jaGVja1VybCkub2ZmKCdoYXNoY2hhbmdlJyx0aGlzLmNoZWNrVXJsKTtjbGVhckludGVydmFsKHRoaXMuX2NoZWNrVXJsSW50ZXJ2YWwpO0hpc3Rvcnkuc3RhcnRlZD1mYWxzZTt9LHJvdXRlOmZ1bmN0aW9uKHJvdXRlLGNhbGxiYWNrKXt0aGlzLmhhbmRsZXJzLnVuc2hpZnQoe3JvdXRlOnJvdXRlLGNhbGxiYWNrOmNhbGxiYWNrfSk7fSxjaGVja1VybDpmdW5jdGlvbihlKXt2YXIgY3VycmVudD10aGlzLmdldEZyYWdtZW50KCk7aWYoY3VycmVudD09PXRoaXMuZnJhZ21lbnQmJnRoaXMuaWZyYW1lKXtjdXJyZW50PXRoaXMuZ2V0RnJhZ21lbnQodGhpcy5nZXRIYXNoKHRoaXMuaWZyYW1lKSk7fQppZihjdXJyZW50PT09dGhpcy5mcmFnbWVudClyZXR1cm4gZmFsc2U7aWYodGhpcy5pZnJhbWUpdGhpcy5uYXZpZ2F0ZShjdXJyZW50KTt0aGlzLmxvYWRVcmwoKTt9LGxvYWRVcmw6ZnVuY3Rpb24oZnJhZ21lbnQpe2ZyYWdtZW50PXRoaXMuZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudChmcmFnbWVudCk7cmV0dXJuIF8uYW55KHRoaXMuaGFuZGxlcnMsZnVuY3Rpb24oaGFuZGxlcil7aWYoaGFuZGxlci5yb3V0ZS50ZXN0KGZyYWdtZW50KSl7aGFuZGxlci5jYWxsYmFjayhmcmFnbWVudCk7cmV0dXJuIHRydWU7fX0pO30sbmF2aWdhdGU6ZnVuY3Rpb24oZnJhZ21lbnQsb3B0aW9ucyl7aWYoIUhpc3Rvcnkuc3RhcnRlZClyZXR1cm4gZmFsc2U7aWYoIW9wdGlvbnN8fG9wdGlvbnM9PT10cnVlKW9wdGlvbnM9e3RyaWdnZXI6ISFvcHRpb25zfTt2YXIgdXJsPXRoaXMucm9vdCsoZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudChmcmFnbWVudHx8JycpKTtmcmFnbWVudD1mcmFnbWVudC5yZXBsYWNlKHBhdGhTdHJpcHBlciwnJyk7aWYodGhpcy5mcmFnbWVudD09PWZyYWdtZW50KXJldHVybjt0aGlzLmZyYWdtZW50PWZyYWdtZW50O2lmKGZyYWdtZW50PT09JycmJnVybCE9PScvJyl1cmw9dXJsLnNsaWNlKDAsLTEpO2lmKHRoaXMuX2hhc1B1c2hTdGF0ZSl7dGhpcy5oaXN0b3J5W29wdGlvbnMucmVwbGFjZT8ncmVwbGFjZVN0YXRlJzoncHVzaFN0YXRlJ10oe30sZG9jdW1lbnQudGl0bGUsdXJsKTt9ZWxzZSBpZih0aGlzLl93YW50c0hhc2hDaGFuZ2Upe3RoaXMuX3VwZGF0ZUhhc2godGhpcy5sb2NhdGlvbixmcmFnbWVudCxvcHRpb25zLnJlcGxhY2UpO2lmKHRoaXMuaWZyYW1lJiYoZnJhZ21lbnQhPT10aGlzLmdldEZyYWdtZW50KHRoaXMuZ2V0SGFzaCh0aGlzLmlmcmFtZSkpKSl7aWYoIW9wdGlvbnMucmVwbGFjZSl0aGlzLmlmcmFtZS5kb2N1bWVudC5vcGVuKCkuY2xvc2UoKTt0aGlzLl91cGRhdGVIYXNoKHRoaXMuaWZyYW1lLmxvY2F0aW9uLGZyYWdtZW50LG9wdGlvbnMucmVwbGFjZSk7fX1lbHNle3JldHVybiB0aGlzLmxvY2F0aW9uLmFzc2lnbih1cmwpO30KaWYob3B0aW9ucy50cmlnZ2VyKXJldHVybiB0aGlzLmxvYWRVcmwoZnJhZ21lbnQpO30sX3VwZGF0ZUhhc2g6ZnVuY3Rpb24obG9jYXRpb24sZnJhZ21lbnQscmVwbGFjZSl7aWYocmVwbGFjZSl7dmFyIGhyZWY9bG9jYXRpb24uaHJlZi5yZXBsYWNlKC8oamF2YXNjcmlwdDp8IykuKiQvLCcnKTtsb2NhdGlvbi5yZXBsYWNlKGhyZWYrJyMnK2ZyYWdtZW50KTt9ZWxzZXtsb2NhdGlvbi5oYXNoPScjJytmcmFnbWVudDt9fX0pO0JhY2tib25lLmhpc3Rvcnk9bmV3IEhpc3Rvcnk7dmFyIGV4dGVuZD1mdW5jdGlvbihwcm90b1Byb3BzLHN0YXRpY1Byb3BzKXt2YXIgcGFyZW50PXRoaXM7dmFyIGNoaWxkO2lmKHByb3RvUHJvcHMmJl8uaGFzKHByb3RvUHJvcHMsJ2NvbnN0cnVjdG9yJykpe2NoaWxkPXByb3RvUHJvcHMuY29uc3RydWN0b3I7fWVsc2V7Y2hpbGQ9ZnVuY3Rpb24oKXtyZXR1cm4gcGFyZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O30KXy5leHRlbmQoY2hpbGQscGFyZW50LHN0YXRpY1Byb3BzKTt2YXIgU3Vycm9nYXRlPWZ1bmN0aW9uKCl7dGhpcy5jb25zdHJ1Y3Rvcj1jaGlsZDt9O1N1cnJvZ2F0ZS5wcm90b3R5cGU9cGFyZW50LnByb3RvdHlwZTtjaGlsZC5wcm90b3R5cGU9bmV3IFN1cnJvZ2F0ZTtpZihwcm90b1Byb3BzKV8uZXh0ZW5kKGNoaWxkLnByb3RvdHlwZSxwcm90b1Byb3BzKTtjaGlsZC5fX3N1cGVyX189cGFyZW50LnByb3RvdHlwZTtyZXR1cm4gY2hpbGQ7fTtNb2RlbC5leHRlbmQ9Q29sbGVjdGlvbi5leHRlbmQ9Um91dGVyLmV4dGVuZD1WaWV3LmV4dGVuZD1IaXN0b3J5LmV4dGVuZD1leHRlbmQ7dmFyIHVybEVycm9yPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCdBICJ1cmwiIHByb3BlcnR5IG9yIGZ1bmN0aW9uIG11c3QgYmUgc3BlY2lmaWVkJyk7fTt2YXIgd3JhcEVycm9yPWZ1bmN0aW9uKG1vZGVsLG9wdGlvbnMpe3ZhciBlcnJvcj1vcHRpb25zLmVycm9yO29wdGlvbnMuZXJyb3I9ZnVuY3Rpb24ocmVzcCl7aWYoZXJyb3IpZXJyb3IobW9kZWwscmVzcCxvcHRpb25zKTttb2RlbC50cmlnZ2VyKCdlcnJvcicsbW9kZWwscmVzcCxvcHRpb25zKTt9O307fSkuY2FsbCh0aGlzKTs=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sun, 09 Nov 2014 01:53:23 GMT",
                    "Content-Length": "243785",
                    "Date": "Sun, 09 Nov 2014 01:53:23 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}