{
    "url": "http://localhost:9999/seyDoggy/rFrame/demo/files/jquery.rframe.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>location</b> and written to <b>$()</b> via the following statement:<ul><li>rframe.reference = $(location).attr('href');</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/seyDoggy/rFrame/demo/files/jquery.rframe.js",
                "path": "/seyDoggy/rFrame/demo/files/jquery.rframe.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9zZXlEb2dneS9yRnJhbWUvZGVtby9maWxlcy9qcXVlcnkucmZyYW1lLmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjUyNA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAwMzozMDoyMCBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMDM6MzA6MjAgR01UDQoNCi8qKgogKiByRnJhbWUKICogQSByZXNwb25zaXZlIGZyYW1lIHRvIGFpZCB3aXRoIG1vYmlsZSBkZXZlbG9wbWVudAogKiAKICogTGF0ZXN0IHZlcnNpb246IGh0dHBzOi8vZ2l0aHViLmNvbS9zZXlEb2dneS9yRnJhbWUKICogCiAqIExpY2Vuc2UgPGh0dHBzOi8vZ2l0aHViLmNvbS9zZXlEb2dneS9yRnJhbWUvYmxvYi9tYXN0ZXIvTElDRU5TRS50eHQ+CiAqLwo7KGZ1bmN0aW9uKCQsIHVuZGVmaW5lZCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBwbHVnaW5OYW1lID0gJ3JGcmFtZScsCgkJcGx1Z2luVmVyc2lvbiA9ICcwLjAuMyc7CgoJJC5yRnJhbWUgPSBmdW5jdGlvbihvcHRpb25zKSB7CgkJLyoKCQkgKiBPUFRJT05TCgkJICovCgkJdmFyIHJmcmFtZSA9ICQuZXh0ZW5kKHsKCQkJYmFja2dyb3VuZCA6ICcjZGVkZWRlJywKCQkJY29sb3IgOiAnI2RlZGVkZScsCgkJCXRvb2xiYXJfYmc6ICcjMzMzJywKCQkJYnRuX2JnOiAnIzNlOGVjMCcsCgkJCWJ0bl9jb2xvcjogJyNmZmYnLAoJCQlmb250OiAnVmVyZGFuYScsCgkJCWRldmljZTonaVBob25lNScsCgkJCWRldmljZV9jb2xvciA6ICcjZDBkMGQwJywKCQkJdmlldyA6IDAsCgkJCWZvcmttZTogdHJ1ZSwKCQkJd2lkdGggOiAzMjAsCgkJCWhlaWdodCA6IDU2OCwKCQkJdG9wbWFyZ2luOjEwMCwKCQkJcmlnaHRzaWRlcGFkOjI3LAoJCQlsZWZ0c2lkZXBhZDoyNywKCQkJdG9wcGFkOjEyNSwKCQkJYm90dG9tcGFkOjEyNSwKCQkJcmFkaXVzOjUwLAoJCQloYXNoOndpbmRvdy5sb2NhdGlvbi5oYXNoLAoJCQlmb3JrbWVfY29kZTogJCgnPGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL3NleURvZ2d5L3JGcmFtZSIgc3R5bGU9InBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAwOyByaWdodDogMmVtOyBib3JkZXI6IDA7Ij48aW1nIHN0eWxlPSJib3JkZXI6IDA7IiBzcmM9Imh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9naXRodWIvcmliYm9ucy9mb3JrbWVfcmlnaHRfcmVkX2FhMDAwMC5wbmciIGFsdD0iRm9yayBtZSBvbiBHaXRIdWIiPjwvYT4nKSwKCQkJcmVmZXJlbmNlOm51bGwsCgkJCXdyYXBwZXI6bnVsbCwKCQkJc2VsZWN0ZGV2aWNlOm51bGwsCgkJCXNlbGVjdHZpZXc6bnVsbCwKCQkJckZyYW1lOm51bGwsCgkJCXRvb2xiYXI6bnVsbCwKCQkJaUZyYW1lOm51bGwsCgkJCXJlaGFzaDogZnVuY3Rpb24gKCkgewoJCQkJd2luZG93LmxvY2F0aW9uLmhhc2ggPSAnJzsKCQkJCSQuYWpheCh7CgkJCQkJdXJsOiAiIiwKCQkJCQljb250ZXh0OiBkb2N1bWVudC5ib2R5LAoJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHMseCl7CgkJCQkJCSQodGhpcykuaHRtbChzKTsKCQkJCQkJJC5yRnJhbWUoewoJCQkJCQkJYmFja2dyb3VuZDpyZnJhbWUuYmFja2dyb3VuZCwKCQkJCQkJCWNvbG9yOnJmcmFtZS5jb2xvciwKCQkJCQkJCXRvb2xiYXJfYmc6cmZyYW1lLnRvb2xiYXJfYmcsCgkJCQkJCQlidG5fYmc6cmZyYW1lLmJ0bl9iZywKCQkJCQkJCWJ0bl9jb2xvcjpyZnJhbWUuYnRuX2NvbG9yLAoJCQkJCQkJZm9udDpyZnJhbWUuZm9udCwKCQkJCQkJCWRldmljZTpyZnJhbWUuZGV2aWNlLAoJCQkJCQkJZGV2aWNlX2NvbG9yOnJmcmFtZS5kZXZpY2VfY29sb3IsCgkJCQkJCQl2aWV3OnJmcmFtZS52aWV3LAoJCQkJCQkJZm9ya21lOnJmcmFtZS5mb3JrbWUKCQkJCQkJfSk7CgkJCQkJfQoJCQkJfSk7CgkJCX0sCgkJCXNldFNlbGVjdDogZnVuY3Rpb24gKCkgewoJCQkJJCgnI3JGcmFtZSBvcHRpb25bdmFsdWU9IicgKyByZnJhbWUuZGV2aWNlICsgJyJdJykuYXR0cignc2VsZWN0ZWQnLCdzZWxlY3RlZCcpOwoJCQl9CgkJfSwgb3B0aW9ucyk7CgoJCWlmIChyZnJhbWUuaGFzaCAhPSAiI3JGcmFtZSIpIHsKCQkJLyoKCQkJICogU2V0IGhhc2ggdG8gcHJldmVudCBmdXJ0aGVyIHJGcmFtZSBleGVjdXRpb24KCQkJICovCgkJCXdpbmRvdy5sb2NhdGlvbi5oYXNoID0gIiNyRnJhbWUiOwoJCQkvKgoJCQkgKglTZXQgY3VycmVudCBocmVmIGFzIHJlZmVyZW5jZSBmb3IgaUZyYW1lCgkJCSAqLwoJCQlyZnJhbWUucmVmZXJlbmNlID0gJChsb2NhdGlvbikuYXR0cignaHJlZicpOwoJCQkvKgoJCQkgKiBVdGlsaXplIHNlbGVjdCBkZXZpY2UgbWVudQoJCQkgKi8KCQkJcmZyYW1lLnNlbGVjdGRldmljZSA9ICQoJzxzZWxlY3QgaWQ9ImRldmljZV9zZWxlY3QiPicgCiAgCQkJCSsgJzxvcHRpb24gdmFsdWU9ImlQaG9uZTUiPmlQaG9uZTU8L29wdGlvbj4nIAogIAkJCQkrICc8b3B0aW9uIHZhbHVlPSJpUGhvbmU0Ij5pUGhvbmU0PC9vcHRpb24+JyAKICAJCQkJKyAnPG9wdGlvbiB2YWx1ZT0iQW5kcm9pZCI+QW5kcm9pZDwvb3B0aW9uPicgCiAgCQkJCSsgJzxvcHRpb24gdmFsdWU9ImlQYWQiPmlQYWQ8L29wdGlvbj4nCiAgCQkJCSsgJzxvcHRpb24gdmFsdWU9IktpbmRsZSI+S2luZGxlPC9vcHRpb24+JwogIAkJCQkrICc8b3B0aW9uIHZhbHVlPSJPZmYiPk9mZjwvb3B0aW9uPicKCQkJCSsgJzwvc2VsZWN0PicpLm9uKCdjaGFuZ2UnLGZ1bmN0aW9uICgpIHsKCQkJCQlpZiAoJCh0aGlzKS52YWwoKSAhPSAnbnVsbCcgJiYgJCh0aGlzKS52YWwoKSAhPSAnT2ZmJykgewoJCQkJCQlzd2l0Y2goJCh0aGlzKS52YWwoKSkgewoJCQkJCQkJY2FzZSAnaVBob25lNSc6CgkJCQkJCQkJcmZyYW1lLmRldmljZSA9ICdpUGhvbmU1JzsKCQkJCQkJCQlicmVhazsKCQkJCQkJCWNhc2UgJ2lQaG9uZTQnOgoJCQkJCQkJCXJmcmFtZS5kZXZpY2UgPSAnaVBob25lNCc7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICdBbmRyb2lkJzoKCQkJCQkJCQlyZnJhbWUuZGV2aWNlID0gJ0FuZHJvaWQnOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnaVBhZCc6CgkJCQkJCQkJcmZyYW1lLmRldmljZSA9ICdpUGFkJzsKCQkJCQkJCQlicmVhazsKCQkJCQkJCWNhc2UgJ0tpbmRsZSc6CgkJCQkJCQkJcmZyYW1lLmRldmljZSA9ICdLaW5kbGUnOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJCXJmcmFtZS5yZWhhc2goKTsKCQkJCQl9IGVsc2UgewoJCQkJCQl3aW5kb3cubG9jYXRpb24uaGFzaCA9ICdyRnJhbWUnOwoJCQkJCQl3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CgkJCQkJfQoJCQkJfSk7CgkJCS8qCgkJCSAqIFV0aWxpemUgc2VsZWN0IGRldmljZSBtZW51CgkJCSAqLwoJCQlyZnJhbWUuc2VsZWN0dmlldyA9ICQoJzxhIGhyZWY9IiMiIHRpdGxlPSJTZWxlY3QgdGhlIGRldmljZSBvcmllbnRhdGlvbi4iLz4nKS50ZXh0KGZ1bmN0aW9uICgpIHsKCQkJCWlmIChyZnJhbWUudmlldyA9PSAwKSB7CgkJCQkJJCh0aGlzKS5odG1sKCdQb3J0cmFpdCcpOwoJCQkJfSBlbHNlIHsKCQkJCQkkKHRoaXMpLmh0bWwoJ0xhbmRzY2FwZScpOwoJCQkJfQoJCQl9KS5jc3MoewoJCQkJJ3RleHQtZGVjb3JhdGlvbic6J25vbmUnLAoJCQkJJ2JhY2tncm91bmQtY29sb3InOnJmcmFtZS5idG5fYmcsCgkJCQknY29sb3InOnJmcmFtZS5idG5fY29sb3IsCgkJCQkncGFkZGluZyc6JzAuNWVtIDFlbScsCgkJCQknbWFyZ2luLWxlZnQnOicyZW0nCgkJCX0pLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCWlmIChyZnJhbWUudmlldyA9PSAwKSB7CgkJCQkJcmZyYW1lLnZpZXcgPSAxOwoJCQkJCXJmcmFtZS5yZWhhc2goKTsKCQkJCX0gZWxzZSB7CgkJCQkJcmZyYW1lLnZpZXcgPSAwOwoJCQkJCXJmcmFtZS5yZWhhc2goKTsKCQkJCX0KCQkJfSk7CgkJCS8qCgkJCSAqIFNldCBkZXZpY2Ugc2V0dGluZ3MKCQkJICovCgkJCWlmIChyZnJhbWUuZGV2aWNlICE9ICdpUGhvbmU1JykgewoJCQkJc3dpdGNoKHJmcmFtZS5kZXZpY2UpIHsKCQkJCQljYXNlICdpUGhvbmU0JzoKCQkJCQkJcmZyYW1lLmhlaWdodCA9IDQ4MDsKCQkJCQkJYnJlYWs7CgoJCQkJCWNhc2UgJ2lQYWQnOgoJCQkJCQlyZnJhbWUud2lkdGggPSA3Njg7CgkJCQkJCXJmcmFtZS5oZWlnaHQgPSAxMDI0OwoJCQkJCQlyZnJhbWUucmlnaHRzaWRlcGFkID0gMTAwOwoJCQkJCQlyZnJhbWUubGVmdHNpZGVwYWQgPSByZnJhbWUucmlnaHRzaWRlcGFkOwoJCQkJCQlyZnJhbWUudG9wcGFkID0gMTAwOwoJCQkJCQlyZnJhbWUuYm90dG9tcGFkID0gcmZyYW1lLnRvcHBhZDsKCQkJCQkJYnJlYWs7CgoJCQkJCWNhc2UgJ0FuZHJvaWQnOgoJCQkJCQlyZnJhbWUud2lkdGggPSAzODA7CgkJCQkJCXJmcmFtZS5oZWlnaHQgPSA2ODU7CgkJCQkJCXJmcmFtZS50b3BwYWQgPSA4MDsKCQkJCQkJcmZyYW1lLmJvdHRvbXBhZCA9IDkwOwoJCQkJCQlyZnJhbWUucmFkaXVzID0gODU7CgkJCQkJCWJyZWFrOwoKCQkJCQljYXNlICdLaW5kbGUnOgoJCQkJCQlyZnJhbWUud2lkdGggPSA2MDA7CgkJCQkJCXJmcmFtZS5oZWlnaHQgPSAxMDI0OwoJCQkJCQlyZnJhbWUucmlnaHRzaWRlcGFkID0gMTAwOwoJCQkJCQlyZnJhbWUubGVmdHNpZGVwYWQgPSByZnJhbWUucmlnaHRzaWRlcGFkOwoJCQkJCQlyZnJhbWUudG9wcGFkID0gODQ7CgkJCQkJCXJmcmFtZS5ib3R0b21wYWQgPSAxNDY7CgkJCQkJCXJmcmFtZS5yYWRpdXMgPSA1MDsKCQkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQkJLyoKCQkJICogU2V0IGRldmljZSBvcmllbnRhdGlvbgoJCQkgKi8KCQkJaWYgKHJmcmFtZS52aWV3ID09IDEpIHsKCQkJCXZhciB0ZW1wID0gcmZyYW1lLndpZHRoOwoJCQkJcmZyYW1lLndpZHRoID0gcmZyYW1lLmhlaWdodDsKCQkJCXJmcmFtZS5oZWlnaHQgPSB0ZW1wOwoJCQkJdGVtcCA9IHJmcmFtZS5yaWdodHNpZGVwYWQ7CgkJCQlyZnJhbWUucmlnaHRzaWRlcGFkID0gcmZyYW1lLmJvdHRvbXBhZDsKCQkJCXJmcmFtZS5ib3R0b21wYWQgPSB0ZW1wOwoJCQkJdGVtcCA9IHJmcmFtZS5sZWZ0c2lkZXBhZDsKCQkJCXJmcmFtZS5sZWZ0c2lkZXBhZCA9IHJmcmFtZS50b3BwYWQ7CgkJCQlyZnJhbWUudG9wcGFkID0gdGVtcDsKCgkJCX0KCQkJLyoKCQkJICogU2V0IGRldmljZSBwb3NpdGlvbgoJCQkgKi8KCQkJaWYgKChyZnJhbWUuaGVpZ2h0ICsgcmZyYW1lLnRvcHBhZCArIHJmcmFtZS5ib3R0b21wYWQpIDwgJCh3aW5kb3cpLmhlaWdodCgpKSB7CgkJCQlyZnJhbWUudG9wbWFyZ2luID0gKCgkKHdpbmRvdykuaGVpZ2h0KCkgLSAocmZyYW1lLmhlaWdodCArIHJmcmFtZS50b3BwYWQgKyByZnJhbWUuYm90dG9tcGFkKSkvMikgKyAyNTsKCQkJfQoJCQkvKgoJCQkgKiBDcmVhdGUgckZyYW1lIHdyYXBwZXIgb3ZlcmxheSAKCQkJICovCgkJCXJmcmFtZS53cmFwcGVyID0gJCgnPGRpdiBpZD0ickZyYW1lIi8+JykuY3NzKHsKCQkJCSdiYWNrZ3JvdW5kLWNvbG9yJzpyZnJhbWUuYmFja2dyb3VuZCwKCQkJCSdwb3NpdGlvbic6J2Fic29sdXRlJywKCQkJCSd0b3AnOjAsCgkJCQknbGVmdCc6MCwKCQkJCSdoZWlnaHQnOiQoJ2h0bWwnKS5oZWlnaHQoKSwKCQkJCSdtaW4taGVpZ2h0JzonMTAwJScsCgkJCQknbWluLXdpZHRoJzonMTAwJScKCQkJfSk7CgkJCS8qCgkJCSAqIENyZWF0ZSBpRnJhbWUgYXMgcGVyIHRoZSBvcHRpb25zCgkJCSAqLwoJCQlyZnJhbWUuaUZyYW1lID0gJCgnPGlmcmFtZSBzcmM9IicgKyByZnJhbWUucmVmZXJlbmNlICsgJyIvPicpLmNzcyh7CgkJCQknYmFja2dyb3VuZC1jb2xvcic6cmZyYW1lLmRldmljZV9jb2xvciwKCQkJCSdib3JkZXInOidub25lJywKCQkJCSdib3JkZXItcmFkaXVzJzogcmZyYW1lLnJhZGl1cyArICdweCcsCgkJCQknZGlzcGxheSc6ICdibG9jaycsCgkJCQknaGVpZ2h0JzpyZnJhbWUuaGVpZ2h0LAoJCQkJJ21hcmdpbic6IHJmcmFtZS50b3BtYXJnaW4gKyAncHggYXV0byAwJywKCQkJCSdwYWRkaW5nJzogcmZyYW1lLnRvcHBhZCArICdweCAnICsgcmZyYW1lLnJpZ2h0c2lkZXBhZCArICdweCAnICsgcmZyYW1lLmJvdHRvbXBhZCArICdweCAnKyByZnJhbWUubGVmdHNpZGVwYWQgKyAncHgnLAoJCQkJJ3dpZHRoJzpyZnJhbWUud2lkdGgsCgkJCX0pOwoJCQkvKgoJCQkgKiBDcmVhdGUgdG9vbGJhcgoJCQkgKi8KCQkJcmZyYW1lLnRvb2xiYXIgPSAkKCc8ZGl2IGlkPSJyRnJhbWUtdG9vbGJhciIvPicpLmNzcyh7CgkJCQkncGFkZGluZyc6JzFlbScsCgkJCQkncG9zaXRpb24nOidmaXhlZCcsCgkJCQknY29sb3InOnJmcmFtZS5jb2xvciwKCQkJCSdmb250LWZhbWlseSc6IHJmcmFtZS5mb250LAoJCQkJJ2JhY2tncm91bmQtY29sb3InOnJmcmFtZS50b29sYmFyX2JnLAoJCQkJJ3otaW5kZXgnOicxMDAwMDAwJywKCQkJCSd3aWR0aCc6JzEwMCUnCgkJCX0pLmFwcGVuZCgKCQkJCXJmcmFtZS5mb3JrbWUgPT0gdHJ1ZSA/IHJmcmFtZS5mb3JrbWVfY29kZSA6ICcnLAoJCQkJcmZyYW1lLnNlbGVjdGRldmljZSwKCQkJCXJmcmFtZS5zZWxlY3R2aWV3CgkJCSk7CgkJCS8qCgkJCSAqIFNtYXNoIHRoZSBET00gZWxlbWVudHMgdG9nZXRoZXIKCQkJICovCgkJCXJmcmFtZS5yRnJhbWUgPSByZnJhbWUud3JhcHBlci5hcHBlbmQocmZyYW1lLnRvb2xiYXIscmZyYW1lLmlGcmFtZSk7CgkJCS8qIAoJCQkgKiBJbXBsZW1lbnQKCQkJICovIAoJCQkkKCdib2R5JykuaHRtbChyZnJhbWUuckZyYW1lKTsKCQkJcmZyYW1lLnNldFNlbGVjdCgpOwoJCX0KCX07Cn0pKGpRdWVyeSk7",
                "body": "LyoqCiAqIHJGcmFtZQogKiBBIHJlc3BvbnNpdmUgZnJhbWUgdG8gYWlkIHdpdGggbW9iaWxlIGRldmVsb3BtZW50CiAqIAogKiBMYXRlc3QgdmVyc2lvbjogaHR0cHM6Ly9naXRodWIuY29tL3NleURvZ2d5L3JGcmFtZQogKiAKICogTGljZW5zZSA8aHR0cHM6Ly9naXRodWIuY29tL3NleURvZ2d5L3JGcmFtZS9ibG9iL21hc3Rlci9MSUNFTlNFLnR4dD4KICovCjsoZnVuY3Rpb24oJCwgdW5kZWZpbmVkKSB7CgkndXNlIHN0cmljdCc7CgoJdmFyIHBsdWdpbk5hbWUgPSAnckZyYW1lJywKCQlwbHVnaW5WZXJzaW9uID0gJzAuMC4zJzsKCgkkLnJGcmFtZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkvKgoJCSAqIE9QVElPTlMKCQkgKi8KCQl2YXIgcmZyYW1lID0gJC5leHRlbmQoewoJCQliYWNrZ3JvdW5kIDogJyNkZWRlZGUnLAoJCQljb2xvciA6ICcjZGVkZWRlJywKCQkJdG9vbGJhcl9iZzogJyMzMzMnLAoJCQlidG5fYmc6ICcjM2U4ZWMwJywKCQkJYnRuX2NvbG9yOiAnI2ZmZicsCgkJCWZvbnQ6ICdWZXJkYW5hJywKCQkJZGV2aWNlOidpUGhvbmU1JywKCQkJZGV2aWNlX2NvbG9yIDogJyNkMGQwZDAnLAoJCQl2aWV3IDogMCwKCQkJZm9ya21lOiB0cnVlLAoJCQl3aWR0aCA6IDMyMCwKCQkJaGVpZ2h0IDogNTY4LAoJCQl0b3BtYXJnaW46MTAwLAoJCQlyaWdodHNpZGVwYWQ6MjcsCgkJCWxlZnRzaWRlcGFkOjI3LAoJCQl0b3BwYWQ6MTI1LAoJCQlib3R0b21wYWQ6MTI1LAoJCQlyYWRpdXM6NTAsCgkJCWhhc2g6d2luZG93LmxvY2F0aW9uLmhhc2gsCgkJCWZvcmttZV9jb2RlOiAkKCc8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vc2V5RG9nZ3kvckZyYW1lIiBzdHlsZT0icG9zaXRpb246IGFic29sdXRlOyB0b3A6IDA7IHJpZ2h0OiAyZW07IGJvcmRlcjogMDsiPjxpbWcgc3R5bGU9ImJvcmRlcjogMDsiIHNyYz0iaHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tL2dpdGh1Yi9yaWJib25zL2ZvcmttZV9yaWdodF9yZWRfYWEwMDAwLnBuZyIgYWx0PSJGb3JrIG1lIG9uIEdpdEh1YiI+PC9hPicpLAoJCQlyZWZlcmVuY2U6bnVsbCwKCQkJd3JhcHBlcjpudWxsLAoJCQlzZWxlY3RkZXZpY2U6bnVsbCwKCQkJc2VsZWN0dmlldzpudWxsLAoJCQlyRnJhbWU6bnVsbCwKCQkJdG9vbGJhcjpudWxsLAoJCQlpRnJhbWU6bnVsbCwKCQkJcmVoYXNoOiBmdW5jdGlvbiAoKSB7CgkJCQl3aW5kb3cubG9jYXRpb24uaGFzaCA9ICcnOwoJCQkJJC5hamF4KHsKCQkJCQl1cmw6ICIiLAoJCQkJCWNvbnRleHQ6IGRvY3VtZW50LmJvZHksCgkJCQkJc3VjY2VzczogZnVuY3Rpb24ocyx4KXsKCQkJCQkJJCh0aGlzKS5odG1sKHMpOwoJCQkJCQkkLnJGcmFtZSh7CgkJCQkJCQliYWNrZ3JvdW5kOnJmcmFtZS5iYWNrZ3JvdW5kLAoJCQkJCQkJY29sb3I6cmZyYW1lLmNvbG9yLAoJCQkJCQkJdG9vbGJhcl9iZzpyZnJhbWUudG9vbGJhcl9iZywKCQkJCQkJCWJ0bl9iZzpyZnJhbWUuYnRuX2JnLAoJCQkJCQkJYnRuX2NvbG9yOnJmcmFtZS5idG5fY29sb3IsCgkJCQkJCQlmb250OnJmcmFtZS5mb250LAoJCQkJCQkJZGV2aWNlOnJmcmFtZS5kZXZpY2UsCgkJCQkJCQlkZXZpY2VfY29sb3I6cmZyYW1lLmRldmljZV9jb2xvciwKCQkJCQkJCXZpZXc6cmZyYW1lLnZpZXcsCgkJCQkJCQlmb3JrbWU6cmZyYW1lLmZvcmttZQoJCQkJCQl9KTsKCQkJCQl9CgkJCQl9KTsKCQkJfSwKCQkJc2V0U2VsZWN0OiBmdW5jdGlvbiAoKSB7CgkJCQkkKCcjckZyYW1lIG9wdGlvblt2YWx1ZT0iJyArIHJmcmFtZS5kZXZpY2UgKyAnIl0nKS5hdHRyKCdzZWxlY3RlZCcsJ3NlbGVjdGVkJyk7CgkJCX0KCQl9LCBvcHRpb25zKTsKCgkJaWYgKHJmcmFtZS5oYXNoICE9ICIjckZyYW1lIikgewoJCQkvKgoJCQkgKiBTZXQgaGFzaCB0byBwcmV2ZW50IGZ1cnRoZXIgckZyYW1lIGV4ZWN1dGlvbgoJCQkgKi8KCQkJd2luZG93LmxvY2F0aW9uLmhhc2ggPSAiI3JGcmFtZSI7CgkJCS8qCgkJCSAqCVNldCBjdXJyZW50IGhyZWYgYXMgcmVmZXJlbmNlIGZvciBpRnJhbWUKCQkJICovCgkJCXJmcmFtZS5yZWZlcmVuY2UgPSAkKGxvY2F0aW9uKS5hdHRyKCdocmVmJyk7CgkJCS8qCgkJCSAqIFV0aWxpemUgc2VsZWN0IGRldmljZSBtZW51CgkJCSAqLwoJCQlyZnJhbWUuc2VsZWN0ZGV2aWNlID0gJCgnPHNlbGVjdCBpZD0iZGV2aWNlX3NlbGVjdCI+JyAKICAJCQkJKyAnPG9wdGlvbiB2YWx1ZT0iaVBob25lNSI+aVBob25lNTwvb3B0aW9uPicgCiAgCQkJCSsgJzxvcHRpb24gdmFsdWU9ImlQaG9uZTQiPmlQaG9uZTQ8L29wdGlvbj4nIAogIAkJCQkrICc8b3B0aW9uIHZhbHVlPSJBbmRyb2lkIj5BbmRyb2lkPC9vcHRpb24+JyAKICAJCQkJKyAnPG9wdGlvbiB2YWx1ZT0iaVBhZCI+aVBhZDwvb3B0aW9uPicKICAJCQkJKyAnPG9wdGlvbiB2YWx1ZT0iS2luZGxlIj5LaW5kbGU8L29wdGlvbj4nCiAgCQkJCSsgJzxvcHRpb24gdmFsdWU9Ik9mZiI+T2ZmPC9vcHRpb24+JwoJCQkJKyAnPC9zZWxlY3Q+Jykub24oJ2NoYW5nZScsZnVuY3Rpb24gKCkgewoJCQkJCWlmICgkKHRoaXMpLnZhbCgpICE9ICdudWxsJyAmJiAkKHRoaXMpLnZhbCgpICE9ICdPZmYnKSB7CgkJCQkJCXN3aXRjaCgkKHRoaXMpLnZhbCgpKSB7CgkJCQkJCQljYXNlICdpUGhvbmU1JzoKCQkJCQkJCQlyZnJhbWUuZGV2aWNlID0gJ2lQaG9uZTUnOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnaVBob25lNCc6CgkJCQkJCQkJcmZyYW1lLmRldmljZSA9ICdpUGhvbmU0JzsKCQkJCQkJCQlicmVhazsKCQkJCQkJCWNhc2UgJ0FuZHJvaWQnOgoJCQkJCQkJCXJmcmFtZS5kZXZpY2UgPSAnQW5kcm9pZCc7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICdpUGFkJzoKCQkJCQkJCQlyZnJhbWUuZGV2aWNlID0gJ2lQYWQnOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnS2luZGxlJzoKCQkJCQkJCQlyZnJhbWUuZGV2aWNlID0gJ0tpbmRsZSc7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQkJcmZyYW1lLnJlaGFzaCgpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJ3JGcmFtZSc7CgkJCQkJCXdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKCQkJCQl9CgkJCQl9KTsKCQkJLyoKCQkJICogVXRpbGl6ZSBzZWxlY3QgZGV2aWNlIG1lbnUKCQkJICovCgkJCXJmcmFtZS5zZWxlY3R2aWV3ID0gJCgnPGEgaHJlZj0iIyIgdGl0bGU9IlNlbGVjdCB0aGUgZGV2aWNlIG9yaWVudGF0aW9uLiIvPicpLnRleHQoZnVuY3Rpb24gKCkgewoJCQkJaWYgKHJmcmFtZS52aWV3ID09IDApIHsKCQkJCQkkKHRoaXMpLmh0bWwoJ1BvcnRyYWl0Jyk7CgkJCQl9IGVsc2UgewoJCQkJCSQodGhpcykuaHRtbCgnTGFuZHNjYXBlJyk7CgkJCQl9CgkJCX0pLmNzcyh7CgkJCQkndGV4dC1kZWNvcmF0aW9uJzonbm9uZScsCgkJCQknYmFja2dyb3VuZC1jb2xvcic6cmZyYW1lLmJ0bl9iZywKCQkJCSdjb2xvcic6cmZyYW1lLmJ0bl9jb2xvciwKCQkJCSdwYWRkaW5nJzonMC41ZW0gMWVtJywKCQkJCSdtYXJnaW4tbGVmdCc6JzJlbScKCQkJfSkub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJaWYgKHJmcmFtZS52aWV3ID09IDApIHsKCQkJCQlyZnJhbWUudmlldyA9IDE7CgkJCQkJcmZyYW1lLnJlaGFzaCgpOwoJCQkJfSBlbHNlIHsKCQkJCQlyZnJhbWUudmlldyA9IDA7CgkJCQkJcmZyYW1lLnJlaGFzaCgpOwoJCQkJfQoJCQl9KTsKCQkJLyoKCQkJICogU2V0IGRldmljZSBzZXR0aW5ncwoJCQkgKi8KCQkJaWYgKHJmcmFtZS5kZXZpY2UgIT0gJ2lQaG9uZTUnKSB7CgkJCQlzd2l0Y2gocmZyYW1lLmRldmljZSkgewoJCQkJCWNhc2UgJ2lQaG9uZTQnOgoJCQkJCQlyZnJhbWUuaGVpZ2h0ID0gNDgwOwoJCQkJCQlicmVhazsKCgkJCQkJY2FzZSAnaVBhZCc6CgkJCQkJCXJmcmFtZS53aWR0aCA9IDc2ODsKCQkJCQkJcmZyYW1lLmhlaWdodCA9IDEwMjQ7CgkJCQkJCXJmcmFtZS5yaWdodHNpZGVwYWQgPSAxMDA7CgkJCQkJCXJmcmFtZS5sZWZ0c2lkZXBhZCA9IHJmcmFtZS5yaWdodHNpZGVwYWQ7CgkJCQkJCXJmcmFtZS50b3BwYWQgPSAxMDA7CgkJCQkJCXJmcmFtZS5ib3R0b21wYWQgPSByZnJhbWUudG9wcGFkOwoJCQkJCQlicmVhazsKCgkJCQkJY2FzZSAnQW5kcm9pZCc6CgkJCQkJCXJmcmFtZS53aWR0aCA9IDM4MDsKCQkJCQkJcmZyYW1lLmhlaWdodCA9IDY4NTsKCQkJCQkJcmZyYW1lLnRvcHBhZCA9IDgwOwoJCQkJCQlyZnJhbWUuYm90dG9tcGFkID0gOTA7CgkJCQkJCXJmcmFtZS5yYWRpdXMgPSA4NTsKCQkJCQkJYnJlYWs7CgoJCQkJCWNhc2UgJ0tpbmRsZSc6CgkJCQkJCXJmcmFtZS53aWR0aCA9IDYwMDsKCQkJCQkJcmZyYW1lLmhlaWdodCA9IDEwMjQ7CgkJCQkJCXJmcmFtZS5yaWdodHNpZGVwYWQgPSAxMDA7CgkJCQkJCXJmcmFtZS5sZWZ0c2lkZXBhZCA9IHJmcmFtZS5yaWdodHNpZGVwYWQ7CgkJCQkJCXJmcmFtZS50b3BwYWQgPSA4NDsKCQkJCQkJcmZyYW1lLmJvdHRvbXBhZCA9IDE0NjsKCQkJCQkJcmZyYW1lLnJhZGl1cyA9IDUwOwoJCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCQkvKgoJCQkgKiBTZXQgZGV2aWNlIG9yaWVudGF0aW9uCgkJCSAqLwoJCQlpZiAocmZyYW1lLnZpZXcgPT0gMSkgewoJCQkJdmFyIHRlbXAgPSByZnJhbWUud2lkdGg7CgkJCQlyZnJhbWUud2lkdGggPSByZnJhbWUuaGVpZ2h0OwoJCQkJcmZyYW1lLmhlaWdodCA9IHRlbXA7CgkJCQl0ZW1wID0gcmZyYW1lLnJpZ2h0c2lkZXBhZDsKCQkJCXJmcmFtZS5yaWdodHNpZGVwYWQgPSByZnJhbWUuYm90dG9tcGFkOwoJCQkJcmZyYW1lLmJvdHRvbXBhZCA9IHRlbXA7CgkJCQl0ZW1wID0gcmZyYW1lLmxlZnRzaWRlcGFkOwoJCQkJcmZyYW1lLmxlZnRzaWRlcGFkID0gcmZyYW1lLnRvcHBhZDsKCQkJCXJmcmFtZS50b3BwYWQgPSB0ZW1wOwoKCQkJfQoJCQkvKgoJCQkgKiBTZXQgZGV2aWNlIHBvc2l0aW9uCgkJCSAqLwoJCQlpZiAoKHJmcmFtZS5oZWlnaHQgKyByZnJhbWUudG9wcGFkICsgcmZyYW1lLmJvdHRvbXBhZCkgPCAkKHdpbmRvdykuaGVpZ2h0KCkpIHsKCQkJCXJmcmFtZS50b3BtYXJnaW4gPSAoKCQod2luZG93KS5oZWlnaHQoKSAtIChyZnJhbWUuaGVpZ2h0ICsgcmZyYW1lLnRvcHBhZCArIHJmcmFtZS5ib3R0b21wYWQpKS8yKSArIDI1OwoJCQl9CgkJCS8qCgkJCSAqIENyZWF0ZSByRnJhbWUgd3JhcHBlciBvdmVybGF5IAoJCQkgKi8KCQkJcmZyYW1lLndyYXBwZXIgPSAkKCc8ZGl2IGlkPSJyRnJhbWUiLz4nKS5jc3MoewoJCQkJJ2JhY2tncm91bmQtY29sb3InOnJmcmFtZS5iYWNrZ3JvdW5kLAoJCQkJJ3Bvc2l0aW9uJzonYWJzb2x1dGUnLAoJCQkJJ3RvcCc6MCwKCQkJCSdsZWZ0JzowLAoJCQkJJ2hlaWdodCc6JCgnaHRtbCcpLmhlaWdodCgpLAoJCQkJJ21pbi1oZWlnaHQnOicxMDAlJywKCQkJCSdtaW4td2lkdGgnOicxMDAlJwoJCQl9KTsKCQkJLyoKCQkJICogQ3JlYXRlIGlGcmFtZSBhcyBwZXIgdGhlIG9wdGlvbnMKCQkJICovCgkJCXJmcmFtZS5pRnJhbWUgPSAkKCc8aWZyYW1lIHNyYz0iJyArIHJmcmFtZS5yZWZlcmVuY2UgKyAnIi8+JykuY3NzKHsKCQkJCSdiYWNrZ3JvdW5kLWNvbG9yJzpyZnJhbWUuZGV2aWNlX2NvbG9yLAoJCQkJJ2JvcmRlcic6J25vbmUnLAoJCQkJJ2JvcmRlci1yYWRpdXMnOiByZnJhbWUucmFkaXVzICsgJ3B4JywKCQkJCSdkaXNwbGF5JzogJ2Jsb2NrJywKCQkJCSdoZWlnaHQnOnJmcmFtZS5oZWlnaHQsCgkJCQknbWFyZ2luJzogcmZyYW1lLnRvcG1hcmdpbiArICdweCBhdXRvIDAnLAoJCQkJJ3BhZGRpbmcnOiByZnJhbWUudG9wcGFkICsgJ3B4ICcgKyByZnJhbWUucmlnaHRzaWRlcGFkICsgJ3B4ICcgKyByZnJhbWUuYm90dG9tcGFkICsgJ3B4ICcrIHJmcmFtZS5sZWZ0c2lkZXBhZCArICdweCcsCgkJCQknd2lkdGgnOnJmcmFtZS53aWR0aCwKCQkJfSk7CgkJCS8qCgkJCSAqIENyZWF0ZSB0b29sYmFyCgkJCSAqLwoJCQlyZnJhbWUudG9vbGJhciA9ICQoJzxkaXYgaWQ9InJGcmFtZS10b29sYmFyIi8+JykuY3NzKHsKCQkJCSdwYWRkaW5nJzonMWVtJywKCQkJCSdwb3NpdGlvbic6J2ZpeGVkJywKCQkJCSdjb2xvcic6cmZyYW1lLmNvbG9yLAoJCQkJJ2ZvbnQtZmFtaWx5JzogcmZyYW1lLmZvbnQsCgkJCQknYmFja2dyb3VuZC1jb2xvcic6cmZyYW1lLnRvb2xiYXJfYmcsCgkJCQknei1pbmRleCc6JzEwMDAwMDAnLAoJCQkJJ3dpZHRoJzonMTAwJScKCQkJfSkuYXBwZW5kKAoJCQkJcmZyYW1lLmZvcmttZSA9PSB0cnVlID8gcmZyYW1lLmZvcmttZV9jb2RlIDogJycsCgkJCQlyZnJhbWUuc2VsZWN0ZGV2aWNlLAoJCQkJcmZyYW1lLnNlbGVjdHZpZXcKCQkJKTsKCQkJLyoKCQkJICogU21hc2ggdGhlIERPTSBlbGVtZW50cyB0b2dldGhlcgoJCQkgKi8KCQkJcmZyYW1lLnJGcmFtZSA9IHJmcmFtZS53cmFwcGVyLmFwcGVuZChyZnJhbWUudG9vbGJhcixyZnJhbWUuaUZyYW1lKTsKCQkJLyogCgkJCSAqIEltcGxlbWVudAoJCQkgKi8gCgkJCSQoJ2JvZHknKS5odG1sKHJmcmFtZS5yRnJhbWUpOwoJCQlyZnJhbWUuc2V0U2VsZWN0KCk7CgkJfQoJfTsKfSkoalF1ZXJ5KTs=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 03:30:20 GMT",
                    "Content-Length": "6524",
                    "Date": "Sat, 08 Nov 2014 03:30:20 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}