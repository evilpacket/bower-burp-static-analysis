{
    "url": "http://localhost:9999/lautr/asfar/source/asfar.jquery.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>location.hash</b> and written to <b>location.href</b> via the following statement:<ul><li>location.href = location.hash.substring(2);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/lautr/asfar/source/asfar.jquery.js",
                "path": "/lautr/asfar/source/asfar.jquery.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9sYXV0ci9hc2Zhci9zb3VyY2UvYXNmYXIuanF1ZXJ5LmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjQ1Ng0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAxMDo0NDoyOCBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMTA6NDQ6MjcgR01UDQoNCi8qKgogKiBhc2ZhcgogKiBhamF4IHN1YnN0aXR1dGUgZm9yIGFsbCByZXF1ZXN0cwogKgogKiBhIGRyb3AgaW4gdG9vbCB0byB0cmFuc2Zvcm0gYW55IHJlZ3VsYXIgR0VUIFJlcXVlc3QgaW50IGFvIGFuIGFqYXggcmVxdWVzdCBhbmQgcGxhY2UgdGhlIHJlc3BvbnNlIGluIHRvIHRoZSBwYWdlLAogKiBhbGxvd2luZyB0aGUgdXNlIG9mIGNhbGxiYWNrIGZ1bmN0aW9ucyB0byBkZWZpbmUgYW55IGtpbmQgb2YgZWZmZWN0IHdoaWxlIGtlZXBpbmcgdGhlIGhpc3RvcnkgbGVnaXQKICoKICogQHZlcnNpb24gMS4yLjIKICogQGF1dGhvciAgam9oYW5uZXMgbGF1dGVyICggaGFubmVzQGxhdXRyLmNvbSApCiAqIEBzZWUgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9sYXV0ci9hc2ZhcgogKi8KOyhmdW5jdGlvbigkLCBkb2MsIHdpbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciBuYW1lID0gJ2pzLWFzZmFyJzsKCiAgICBmdW5jdGlvbiBBc2ZhcihlbCwgb3B0cywgdGFyZ2V0KSB7CiAgICAgICAgdGhpcy4kZWwgID0gJChlbCk7CiAgICAgICAgdGhpcy5wYWdlY291bnQgPSAwOwogICAgICAgIHRoaXMuY3VycmVudEhhc2ggPSBudWxsOwoKICAgICAgICB0aGlzLmRlZmF1bHQgPSB7CiAgICAgICAgICAgICdzZWxlY3Rvcic6ICAgICAgICAnYVtocmVmKj0iJyArIGRvY3VtZW50LmxvY2F0aW9uLmhvc3QgKyAnIl0sIGFbaHJlZl49Ii8iXSwgYTpub3QoW2hyZWZePSJodHRwOi8vIl0pJywKICAgICAgICAgICAgJ3RhcmdldCc6ICAgICAgICAgICB0YXJnZXQsCiAgICAgICAgICAgICdzaGVCYW5nRmFsbGJhY2snOiB0cnVlLAogICAgICAgICAgICAnc2hlQmFuZ0ludGVydmFsJzogMTUwLAogICAgICAgICAgICAnaHRtbDVTdXBwb3J0JzogICAgIHRydWUsCiAgICAgICAgICAgICdmaWx0ZXJSZXNwb25zZSc6ICBmdW5jdGlvbiAocmVwb25zZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlcG9uc2U7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdiZWZvcmUnOiAgICAgICAgICAgZnVuY3Rpb24gKHVybEZyYWdtZW50LCB0YXJnZXQpIHt9LAogICAgICAgICAgICAnc3VjY2Vzcyc6ICAgICAgICAgIGZ1bmN0aW9uICh1cmxGcmFnbWVudCwgdGFyZ2V0KSB7fSwKICAgICAgICAgICAgJ2FmdGVyJzogICAgICAgICAgICBmdW5jdGlvbiAodXJsRnJhZ21lbnQsIHRhcmdldCkge30sCiAgICAgICAgICAgICdlcnJvcic6ICAgICAgICAgICAgZnVuY3Rpb24gKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgdXJsRnJhZ21lbnQsIHRhcmdldCkge30sCiAgICAgICAgICAgICdpbnNlcnQnOiAgICAgICAgICAgZnVuY3Rpb24gKHVybEZyYWdtZW50LCB0YXJnZXQsIGRhdGEpIHsKICAgICAgICAgICAgICAgICQodGFyZ2V0KS5odG1sKGRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgdGhpcy5vcHRzID0gJC5leHRlbmQodGhpcy5kZWZhdWx0LCBvcHRzKTsKCiAgICAgICAgdGhpcy4kZWwuZGF0YShuYW1lLCB0aGlzKTsKCiAgICAgICAgdGhpcy4kc2VsZWN0b3IgPSAkKHRoaXMub3B0cy5zZWxlY3Rvcik7CgogICAgICAgIHRoaXMuaW5pdCgpOwogICAgfQoKICAgIEFzZmFyLnByb3RvdHlwZS5wdXNoU3RhdGUgPSBmdW5jdGlvbiAodXJsRnJhZ21lbnQsIGZpcnN0KSB7CgogICAgICAgIGlmICh0aGlzLm9wdHMuaHRtbDVTdXBwb3J0KSB7CiAgICAgICAgICAgIGhpc3RvcnkucHVzaFN0YXRlKHt0eXBlOiAnYWpheCd9LCAidGl0bGUgIiArIHRoaXMucGFnZWNvdW50LHVybEZyYWdtZW50KTsKICAgICAgICAgICAgdGhpcy5wYWdlY291bnQrKzsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgbG9jYXRpb24uaGFzaCA9ICcjIScgKyB1cmxGcmFnbWVudDsKICAgICAgICAgICAgdGhpcy5jdXJyZW50SGFzaCA9IGxvY2F0aW9uLmhhc2g7CiAgICAgICAgfQogICAgfQoKICAgIEFzZmFyLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24odXJsRnJhZ21lbnQsIHRhcmdldCwgaXNIaXN0b3J5KSB7CiAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgICAvLyByZW1vdmUgb3JpZ2luIGZyb20gdXJsIGZyYWdtZW50IHRvIG1ha2Ugc3VyZSBpdHMgYWx3YXlzIGp1c3QgcGF0aCwgbm90IHRoZSBmdWxsIHVybAogICAgICAgIHVybEZyYWdtZW50ID0gdXJsRnJhZ21lbnQucmVwbGFjZShsb2NhdGlvbi5vcmlnaW4sICcnKTsKCiAgICAgICAgc2VsZi5vcHRzLmJlZm9yZSh1cmxGcmFnbWVudCwgdGFyZ2V0KTsKCiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgY2FjaGU6IHRydWUsCiAgICAgICAgICAgIGFzeW5jOiB0cnVlLAogICAgICAgICAgICB0eXBlOiAnR0VUJywKICAgICAgICAgICAgZGF0YVR5cGU6ICJodG1sIiwKICAgICAgICAgICAgdXJsOiB1cmxGcmFnbWVudCwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0byB3cmFwIGl0LCBvdGhlcndpc2Ugd2UgY2FuJ3Qgc2VsZWN0IGl0IGlmIGJvZHkgaXMgdGhlIHBhcmVudAogICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlSHRtbCA9ICc8c2VjdGlvbiBpZD0iYXNmYXItZmFrZSI+JyArIGRhdGEgKyAnPC9zZWN0aW9uPic7CgogICAgICAgICAgICAgICAgcmVzcG9uc2VIdG1sID0gc2VsZi5vcHRzLmZpbHRlclJlc3BvbnNlKHJlc3BvbnNlSHRtbCk7CgogICAgICAgICAgICAgICAgaWYgKDAgIT09ICQocmVzcG9uc2VIdG1sKS5maW5kKHRhcmdldCkucGFyZW50KCkuc2l6ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YSA9ICQocmVzcG9uc2VIdG1sKS5maW5kKHRhcmdldCkuaHRtbCgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGRhdGEgPSAnPCEtLSBhc2ZhciAtLT4nICsgZGF0YSArICc8IS0tIGVuZCBvZiBhc2ZhciAtLT4nOwogICAgICAgICAgICAgICAgc2VsZi5vcHRzLmluc2VydCh1cmxGcmFnbWVudCwgdGFyZ2V0LCBkYXRhKTsKCiAgICAgICAgICAgICAgICBpZiAodHJ1ZSAhPT0gaXNIaXN0b3J5KSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5wdXNoU3RhdGUodXJsRnJhZ21lbnQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHNlbGYub3B0cy5zdWNjZXNzKHVybEZyYWdtZW50LCB0YXJnZXQpOwoKICAgICAgICAgICAgICAgICQodGFyZ2V0KS50cmlnZ2VyKCdhc2ZhcicsIFt1cmxGcmFnbWVudF0pOwogICAgICAgICAgICB9LAogICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKXsKICAgICAgICAgICAgICAgIHNlbGYub3B0cy5lcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24sIHVybEZyYWdtZW50LCB0YXJnZXQpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vIGlzIHRoYXQgcmVhbGx5IHVzZWZ1bGw/CiAgICAgICAgc2VsZi5vcHRzLmFmdGVyKHVybEZyYWdtZW50LCB0YXJnZXQpOwogICAgfQoKICAgIC8qKgogICAgICogQHRvZG8gY2hlY2sgdmlhYmlsaXR5IG9mIGRlbGVnYXRpb24KICAgICAqLwogICAgQXNmYXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgICAgIC8vIG5vIG1hdHRlciBpZiB5b3Ugd2FudCBodG1sNSBzdXBwb3J0IG9yIG5vdCwgaWYgaXQgYWluJ3QgdGhlcmUgaXQgYWluJ3QgZ29ubmEgaGFwcGVuCiAgICAgICAgaWYgKHR5cGVvZiBoaXN0b3J5LnB1c2hTdGF0ZSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgdGhpcy5vcHRzLmh0bWw1U3VwcG9ydCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8gbm8gaHRtbDUgLCBubyBzaGUgYmFuZyBmYWxsYmFjaywgbm8gYXNmYXIgKnNhZGZhY2UqCiAgICAgICAgaWYgKCF0aGlzLm9wdHMuaHRtbDVTdXBwb3J0ICYmICF0aGlzLm9wdHMuc2hlQmFuZ0ZhbGxiYWNrKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICghdGhpcy5vcHRzLmh0bWw1U3VwcG9ydCkgewogICAgICAgICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAoJycgPT09IGxvY2F0aW9uLmhhc2gpIHsKICAgICAgICAgICAgICAgICAgICAvLyBzdGFydAogICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBzZWxmLmN1cnJlbnRIYXNoKXsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxsKGxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDIpLCBzZWxmLm9wdHMudGFyZ2V0LCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50SGFzaCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24uaGFzaCAhPT0gc2VsZi5jdXJyZW50SGFzaCkgewogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGwobG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMiksIHNlbGYub3B0cy50YXJnZXQsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBzZWxmLm9wdHMuc2hlQmFuZ0ludGVydmFsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgaWYgKGV2ZW50LnN0YXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCJhamF4IiA9PT0gZXZlbnQuc3RhdGUudHlwZSkgewogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGwoZG9jdW1lbnQubG9jYXRpb24uaHJlZiwgc2VsZi5vcHRzLnRhcmdldCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgLy8gdGhpcyBjYW4gYmUgY29waWVkIGluIHRvIHRoZSBoZWFkZXIgb2YgdGhlIGh0bWwgZG9jdW1lbnQgdG8gaW5jcmVhc2Ugc3BlZWQKICAgICAgICBpZiAoIXRoaXMub3B0cy5odG1sNVN1cHBvcnQgJiYgJyMhJyA9PT0gbG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMCwyKSkgewogICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gbG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMik7CiAgICAgICAgfQoKICAgICAgICAkKHRoaXMub3B0cy5zZWxlY3Rvcikub24oJ2NsaWNrLicgKyBuYW1lICsgJy1wYWdlLXdpZGUnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgICAgIHNlbGYuY2FsbCgkKGUudGFyZ2V0KS5hdHRyKCdocmVmJyksIHNlbGYub3B0cy50YXJnZXQsIGZhbHNlKTsKICAgICAgICB9KTsKCiAgICAgICAgLy8gbm90IHJlYWxseSBoYXBweSB3aXRoIHRoaXMsIGJ1dCBvbmx5IHdheSBzbyBmYXIgdG8gYWRkIGEgbGlzdGVuZSBydG8gYWxsIGxpbmtzIGluIHRoZSBib2R5IGJ1dCBvbmx5IGFwcGx5CiAgICAgICAgLy8gZGVsZWdhdGlvbiBpbiB0aGUgdGFyZ2V0IGFyZWEKICAgICAgICAkKHNlbGYub3B0cy50YXJnZXQpLmZpbmQodGhpcy5vcHRzLnNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICQodGhpcykudW5iaW5kKCdjbGljay4nICsgbmFtZSArICctcGFnZS13aWRlJyk7CiAgICAgICAgfSk7CgogICAgICAgICQoc2VsZi5vcHRzLnRhcmdldCkub24oJ2NsaWNrLicgKyBuYW1lLCB0aGlzLm9wdHMuc2VsZWN0b3IsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgICAgc2VsZi5jYWxsKCQoZS50YXJnZXQpLmF0dHIoJ2hyZWYnKSwgc2VsZi5vcHRzLnRhcmdldCwgZmFsc2UpOwogICAgICAgIH0pOwoKICAgICAgICBpZiAodGhpcy5vcHRzLmh0bWw1U3VwcG9ydCkgewogICAgICAgICAgICBzZWxmLnB1c2hTdGF0ZShkb2N1bWVudC5sb2NhdGlvbi5ocmVmKTsKICAgICAgICB9CiAgICB9OwoKICAgIEFzZmFyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdGhpcy4kc2VsZWN0b3Iub2ZmKCcuJyArIG5hbWUpOwoKICAgICAgICB0aGlzLiRlbC5yZW1vdmVEYXRhKG5hbWUpOwogICAgICAgIHRoaXMuJGVsID0gbnVsbDsKICAgIH07CgogICAgJC5mbi5hc2ZhciA9IGZ1bmN0aW9uKG9wdHMpIHsKICAgICAgICB2YXIgdGFyZ2V0ID0gJCh0aGlzKS5zZWxlY3RvcjsKCiAgICAgICAgLy8geW91IGNhbiBub3QgaW5pdGlhdGUgbW9yZSB0aGVuIG9uZSBhc2ZhciBpbnN0YW5jZSBhdCBhIHRpbWUgYmVjYXVzZSB5b3Ugd291bGQgbmVlZCBhIHVuaXF1ZSBzZWxlY3RvciAoYSBlbGVtZW50cyBmb3IgZWFjaCBhc2ZhciBjb250ZW50IGFyZWEpCiAgICAgICAgaWYgKDEgPT09ICQodGhpcykuc2l6ZSgpKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgQXNmYXIodGhpcywgb3B0cywgdGFyZ2V0KTsKICAgICAgICB9CgogICAgfTsKCn0pKGpRdWVyeSwgZG9jdW1lbnQsIHdpbmRvdyk7Cg==",
                "body": "LyoqCiAqIGFzZmFyCiAqIGFqYXggc3Vic3RpdHV0ZSBmb3IgYWxsIHJlcXVlc3RzCiAqCiAqIGEgZHJvcCBpbiB0b29sIHRvIHRyYW5zZm9ybSBhbnkgcmVndWxhciBHRVQgUmVxdWVzdCBpbnQgYW8gYW4gYWpheCByZXF1ZXN0IGFuZCBwbGFjZSB0aGUgcmVzcG9uc2UgaW4gdG8gdGhlIHBhZ2UsCiAqIGFsbG93aW5nIHRoZSB1c2Ugb2YgY2FsbGJhY2sgZnVuY3Rpb25zIHRvIGRlZmluZSBhbnkga2luZCBvZiBlZmZlY3Qgd2hpbGUga2VlcGluZyB0aGUgaGlzdG9yeSBsZWdpdAogKgogKiBAdmVyc2lvbiAxLjIuMgogKiBAYXV0aG9yICBqb2hhbm5lcyBsYXV0ZXIgKCBoYW5uZXNAbGF1dHIuY29tICkKICogQHNlZSAgICAgaHR0cHM6Ly9naXRodWIuY29tL2xhdXRyL2FzZmFyCiAqLwo7KGZ1bmN0aW9uKCQsIGRvYywgd2luKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIG5hbWUgPSAnanMtYXNmYXInOwoKICAgIGZ1bmN0aW9uIEFzZmFyKGVsLCBvcHRzLCB0YXJnZXQpIHsKICAgICAgICB0aGlzLiRlbCAgPSAkKGVsKTsKICAgICAgICB0aGlzLnBhZ2Vjb3VudCA9IDA7CiAgICAgICAgdGhpcy5jdXJyZW50SGFzaCA9IG51bGw7CgogICAgICAgIHRoaXMuZGVmYXVsdCA9IHsKICAgICAgICAgICAgJ3NlbGVjdG9yJzogICAgICAgICdhW2hyZWYqPSInICsgZG9jdW1lbnQubG9jYXRpb24uaG9zdCArICciXSwgYVtocmVmXj0iLyJdLCBhOm5vdChbaHJlZl49Imh0dHA6Ly8iXSknLAogICAgICAgICAgICAndGFyZ2V0JzogICAgICAgICAgIHRhcmdldCwKICAgICAgICAgICAgJ3NoZUJhbmdGYWxsYmFjayc6IHRydWUsCiAgICAgICAgICAgICdzaGVCYW5nSW50ZXJ2YWwnOiAxNTAsCiAgICAgICAgICAgICdodG1sNVN1cHBvcnQnOiAgICAgdHJ1ZSwKICAgICAgICAgICAgJ2ZpbHRlclJlc3BvbnNlJzogIGZ1bmN0aW9uIChyZXBvbnNlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVwb25zZTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ2JlZm9yZSc6ICAgICAgICAgICBmdW5jdGlvbiAodXJsRnJhZ21lbnQsIHRhcmdldCkge30sCiAgICAgICAgICAgICdzdWNjZXNzJzogICAgICAgICAgZnVuY3Rpb24gKHVybEZyYWdtZW50LCB0YXJnZXQpIHt9LAogICAgICAgICAgICAnYWZ0ZXInOiAgICAgICAgICAgIGZ1bmN0aW9uICh1cmxGcmFnbWVudCwgdGFyZ2V0KSB7fSwKICAgICAgICAgICAgJ2Vycm9yJzogICAgICAgICAgICBmdW5jdGlvbiAoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duLCB1cmxGcmFnbWVudCwgdGFyZ2V0KSB7fSwKICAgICAgICAgICAgJ2luc2VydCc6ICAgICAgICAgICBmdW5jdGlvbiAodXJsRnJhZ21lbnQsIHRhcmdldCwgZGF0YSkgewogICAgICAgICAgICAgICAgJCh0YXJnZXQpLmh0bWwoZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB0aGlzLm9wdHMgPSAkLmV4dGVuZCh0aGlzLmRlZmF1bHQsIG9wdHMpOwoKICAgICAgICB0aGlzLiRlbC5kYXRhKG5hbWUsIHRoaXMpOwoKICAgICAgICB0aGlzLiRzZWxlY3RvciA9ICQodGhpcy5vcHRzLnNlbGVjdG9yKTsKCiAgICAgICAgdGhpcy5pbml0KCk7CiAgICB9CgogICAgQXNmYXIucHJvdG90eXBlLnB1c2hTdGF0ZSA9IGZ1bmN0aW9uICh1cmxGcmFnbWVudCwgZmlyc3QpIHsKCiAgICAgICAgaWYgKHRoaXMub3B0cy5odG1sNVN1cHBvcnQpIHsKICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUoe3R5cGU6ICdhamF4J30sICJ0aXRsZSAiICsgdGhpcy5wYWdlY291bnQsdXJsRnJhZ21lbnQpOwogICAgICAgICAgICB0aGlzLnBhZ2Vjb3VudCsrOwogICAgICAgIH1lbHNlewogICAgICAgICAgICBsb2NhdGlvbi5oYXNoID0gJyMhJyArIHVybEZyYWdtZW50OwogICAgICAgICAgICB0aGlzLmN1cnJlbnRIYXNoID0gbG9jYXRpb24uaGFzaDsKICAgICAgICB9CiAgICB9CgogICAgQXNmYXIucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbih1cmxGcmFnbWVudCwgdGFyZ2V0LCBpc0hpc3RvcnkpIHsKICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgICAgIC8vIHJlbW92ZSBvcmlnaW4gZnJvbSB1cmwgZnJhZ21lbnQgdG8gbWFrZSBzdXJlIGl0cyBhbHdheXMganVzdCBwYXRoLCBub3QgdGhlIGZ1bGwgdXJsCiAgICAgICAgdXJsRnJhZ21lbnQgPSB1cmxGcmFnbWVudC5yZXBsYWNlKGxvY2F0aW9uLm9yaWdpbiwgJycpOwoKICAgICAgICBzZWxmLm9wdHMuYmVmb3JlKHVybEZyYWdtZW50LCB0YXJnZXQpOwoKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICBjYWNoZTogdHJ1ZSwKICAgICAgICAgICAgYXN5bmM6IHRydWUsCiAgICAgICAgICAgIHR5cGU6ICdHRVQnLAogICAgICAgICAgICBkYXRhVHlwZTogImh0bWwiLAogICAgICAgICAgICB1cmw6IHVybEZyYWdtZW50LAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHdyYXAgaXQsIG90aGVyd2lzZSB3ZSBjYW4ndCBzZWxlY3QgaXQgaWYgYm9keSBpcyB0aGUgcGFyZW50CiAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VIdG1sID0gJzxzZWN0aW9uIGlkPSJhc2Zhci1mYWtlIj4nICsgZGF0YSArICc8L3NlY3Rpb24+JzsKCiAgICAgICAgICAgICAgICByZXNwb25zZUh0bWwgPSBzZWxmLm9wdHMuZmlsdGVyUmVzcG9uc2UocmVzcG9uc2VIdG1sKTsKCiAgICAgICAgICAgICAgICBpZiAoMCAhPT0gJChyZXNwb25zZUh0bWwpLmZpbmQodGFyZ2V0KS5wYXJlbnQoKS5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBkYXRhID0gJChyZXNwb25zZUh0bWwpLmZpbmQodGFyZ2V0KS5odG1sKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZGF0YSA9ICc8IS0tIGFzZmFyIC0tPicgKyBkYXRhICsgJzwhLS0gZW5kIG9mIGFzZmFyIC0tPic7CiAgICAgICAgICAgICAgICBzZWxmLm9wdHMuaW5zZXJ0KHVybEZyYWdtZW50LCB0YXJnZXQsIGRhdGEpOwoKICAgICAgICAgICAgICAgIGlmICh0cnVlICE9PSBpc0hpc3RvcnkpIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLnB1c2hTdGF0ZSh1cmxGcmFnbWVudCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgc2VsZi5vcHRzLnN1Y2Nlc3ModXJsRnJhZ21lbnQsIHRhcmdldCk7CgogICAgICAgICAgICAgICAgJCh0YXJnZXQpLnRyaWdnZXIoJ2FzZmFyJywgW3VybEZyYWdtZW50XSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pewogICAgICAgICAgICAgICAgc2VsZi5vcHRzLmVycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgdXJsRnJhZ21lbnQsIHRhcmdldCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8gaXMgdGhhdCByZWFsbHkgdXNlZnVsbD8KICAgICAgICBzZWxmLm9wdHMuYWZ0ZXIodXJsRnJhZ21lbnQsIHRhcmdldCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAdG9kbyBjaGVjayB2aWFiaWxpdHkgb2YgZGVsZWdhdGlvbgogICAgICovCiAgICBBc2Zhci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgICAgLy8gbm8gbWF0dGVyIGlmIHlvdSB3YW50IGh0bWw1IHN1cHBvcnQgb3Igbm90LCBpZiBpdCBhaW4ndCB0aGVyZSBpdCBhaW4ndCBnb25uYSBoYXBwZW4KICAgICAgICBpZiAodHlwZW9mIGhpc3RvcnkucHVzaFN0YXRlID09PSAndW5kZWZpbmVkJykgewogICAgICAgICAgICB0aGlzLm9wdHMuaHRtbDVTdXBwb3J0ID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvLyBubyBodG1sNSAsIG5vIHNoZSBiYW5nIGZhbGxiYWNrLCBubyBhc2ZhciAqc2FkZmFjZSoKICAgICAgICBpZiAoIXRoaXMub3B0cy5odG1sNVN1cHBvcnQgJiYgIXRoaXMub3B0cy5zaGVCYW5nRmFsbGJhY2spIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF0aGlzLm9wdHMuaHRtbDVTdXBwb3J0KSB7CiAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGlmICgnJyA9PT0gbG9jYXRpb24uaGFzaCkgewogICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0CiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IHNlbGYuY3VycmVudEhhc2gpewogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGwobG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMiksIHNlbGYub3B0cy50YXJnZXQsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRIYXNoID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbi5oYXNoICE9PSBzZWxmLmN1cnJlbnRIYXNoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsbChsb2NhdGlvbi5oYXNoLnN1YnN0cmluZygyKSwgc2VsZi5vcHRzLnRhcmdldCwgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHNlbGYub3B0cy5zaGVCYW5nSW50ZXJ2YWwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHdpbmRvdy5vbnBvcHN0YXRlID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuc3RhdGUgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoImFqYXgiID09PSBldmVudC5zdGF0ZS50eXBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsbChkb2N1bWVudC5sb2NhdGlvbi5ocmVmLCBzZWxmLm9wdHMudGFyZ2V0LCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICAvLyB0aGlzIGNhbiBiZSBjb3BpZWQgaW4gdG8gdGhlIGhlYWRlciBvZiB0aGUgaHRtbCBkb2N1bWVudCB0byBpbmNyZWFzZSBzcGVlZAogICAgICAgIGlmICghdGhpcy5vcHRzLmh0bWw1U3VwcG9ydCAmJiAnIyEnID09PSBsb2NhdGlvbi5oYXNoLnN1YnN0cmluZygwLDIpKSB7CiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBsb2NhdGlvbi5oYXNoLnN1YnN0cmluZygyKTsKICAgICAgICB9CgogICAgICAgICQodGhpcy5vcHRzLnNlbGVjdG9yKS5vbignY2xpY2suJyArIG5hbWUgKyAnLXBhZ2Utd2lkZScsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgICAgc2VsZi5jYWxsKCQoZS50YXJnZXQpLmF0dHIoJ2hyZWYnKSwgc2VsZi5vcHRzLnRhcmdldCwgZmFsc2UpOwogICAgICAgIH0pOwoKICAgICAgICAvLyBub3QgcmVhbGx5IGhhcHB5IHdpdGggdGhpcywgYnV0IG9ubHkgd2F5IHNvIGZhciB0byBhZGQgYSBsaXN0ZW5lIHJ0byBhbGwgbGlua3MgaW4gdGhlIGJvZHkgYnV0IG9ubHkgYXBwbHkKICAgICAgICAvLyBkZWxlZ2F0aW9uIGluIHRoZSB0YXJnZXQgYXJlYQogICAgICAgICQoc2VsZi5vcHRzLnRhcmdldCkuZmluZCh0aGlzLm9wdHMuc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oKXsKICAgICAgICAgICAgJCh0aGlzKS51bmJpbmQoJ2NsaWNrLicgKyBuYW1lICsgJy1wYWdlLXdpZGUnKTsKICAgICAgICB9KTsKCiAgICAgICAgJChzZWxmLm9wdHMudGFyZ2V0KS5vbignY2xpY2suJyArIG5hbWUsIHRoaXMub3B0cy5zZWxlY3RvciwgZnVuY3Rpb24oZSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICBzZWxmLmNhbGwoJChlLnRhcmdldCkuYXR0cignaHJlZicpLCBzZWxmLm9wdHMudGFyZ2V0LCBmYWxzZSk7CiAgICAgICAgfSk7CgogICAgICAgIGlmICh0aGlzLm9wdHMuaHRtbDVTdXBwb3J0KSB7CiAgICAgICAgICAgIHNlbGYucHVzaFN0YXRlKGRvY3VtZW50LmxvY2F0aW9uLmhyZWYpOwogICAgICAgIH0KICAgIH07CgogICAgQXNmYXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLiRzZWxlY3Rvci5vZmYoJy4nICsgbmFtZSk7CgogICAgICAgIHRoaXMuJGVsLnJlbW92ZURhdGEobmFtZSk7CiAgICAgICAgdGhpcy4kZWwgPSBudWxsOwogICAgfTsKCiAgICAkLmZuLmFzZmFyID0gZnVuY3Rpb24ob3B0cykgewogICAgICAgIHZhciB0YXJnZXQgPSAkKHRoaXMpLnNlbGVjdG9yOwoKICAgICAgICAvLyB5b3UgY2FuIG5vdCBpbml0aWF0ZSBtb3JlIHRoZW4gb25lIGFzZmFyIGluc3RhbmNlIGF0IGEgdGltZSBiZWNhdXNlIHlvdSB3b3VsZCBuZWVkIGEgdW5pcXVlIHNlbGVjdG9yIChhIGVsZW1lbnRzIGZvciBlYWNoIGFzZmFyIGNvbnRlbnQgYXJlYSkKICAgICAgICBpZiAoMSA9PT0gJCh0aGlzKS5zaXplKCkpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBBc2Zhcih0aGlzLCBvcHRzLCB0YXJnZXQpOwogICAgICAgIH0KCiAgICB9OwoKfSkoalF1ZXJ5LCBkb2N1bWVudCwgd2luZG93KTsK",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 10:44:27 GMT",
                    "Content-Length": "6456",
                    "Date": "Thu, 06 Nov 2014 10:44:28 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}