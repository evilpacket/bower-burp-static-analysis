{
    "url": "http://localhost:9999/Mottie/tablesorter/docs/js/docs.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>window.location.hash</b> and written to <b>$()</b> via the following statements:<ul><li>var prop, $t, wo, h = window.location.hash;</li><li>prop = $(h);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/Mottie/tablesorter/docs/js/docs.js",
                "path": "/Mottie/tablesorter/docs/js/docs.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9Nb3R0aWUvdGFibGVzb3J0ZXIvZG9jcy9qcy9kb2NzLmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjMzMA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAwNzoxMjoxOSBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMDc6MTI6MTkgR01UDQoNCi8qanNoaW50IGJyb3dzZXI6dHJ1ZSwganF1ZXJ5OnRydWUsIHVudXNlZDpmYWxzZSAqLwovKmdsb2JhbCBwcmV0dHlQcmludDpmYWxzZSAqLwooZnVuY3Rpb24oJCl7CgkkKGZ1bmN0aW9uKCl7CgkJdmFyICR0LCB0LCB2LCBhbmltYXRpbmcsIGNsaWNrZWQsCgoJCWNsZWFudXBDb2RlID0gZnVuY3Rpb24oY29kZSl7CgkJCXJldHVybiBjb2RlLnJlcGxhY2UoL1s8PlwiXCdcdFxuXS9nLCBmdW5jdGlvbihtKSB7IHJldHVybiB7CgkJCQknPCcgOiAnJmx0OycsCgkJCQknPicgOiAnJmd0OycsCgkJCQkiJyIgOiAnJiMzOTsnLAoJCQkJJyInIDogJyZxdW90OycsCgkJCQknXHQnOiAnICAnLAoJCQkJJ1xuJzogJzxici8+JyAvLyBuZWVkZWQgZm9yIElFCgkJCX1bbV07fSk7CgkJfTsKCgkJJCgiYS5leHRlcm5hbCIpLmVhY2goZnVuY3Rpb24oKXt0aGlzLnRhcmdldCA9ICdfbmV3Jzt9KTsKCgkJLy8gZ2V0IGphdmFzY3JpcHQgc291cmNlCgkJaWYgKCQoIiNqcyIpLmxlbmd0aCkgewoJCQkkKCIjamF2YXNjcmlwdCBwcmUiKS5hZGRDbGFzcygnbW9kJykuaHRtbCggY2xlYW51cENvZGUoICQoIiNqcyIpLmh0bWwoKSApICk7CgkJfQoJCWlmICgkKCIjY3NzIikubGVuZ3RoKSB7CgkJCSQoInByZS5sYW5nLWNzcyIpLmFkZENsYXNzKCdtb2QnKS5odG1sKCBjbGVhbnVwQ29kZSggJCgiI2NzcyIpLmh0bWwoKSApICk7CgkJfQoJCWlmICgkKCIjZGVtbyIpLmxlbmd0aCAmJiAkKCIjaHRtbCBwcmUiKS5sZW5ndGgpIHsKCQkJJCgiI2h0bWwgcHJlIikuYWRkQ2xhc3MoJ21vZCcpLmh0bWwoIGNsZWFudXBDb2RlKCAkKCIjZGVtbyIpLmh0bWwoKSApICk7CgkJfQoKCQkvLyBhcHBseSB0byBhbHJlYWR5IHByZS1mb3JtYXR0ZWQgYmxvY2tzIHRvIGFkZCA8YnI+IGZvciBJRQoJCSQoJ3ByZS5wcmV0dHlwcmludDpub3QoLm1vZCknKS5lYWNoKGZ1bmN0aW9uKCl7CgkJCSR0ID0gJCh0aGlzKTsKCQkJJHQuaHRtbCggY2xlYW51cENvZGUoICR0Lmh0bWwoKSApICk7CgkJfSk7CgoJCWlmICh0eXBlb2YgcHJldHR5UHJpbnQgIT09ICd1bmRlZmluZWQnKSB7IHByZXR0eVByaW50KCk7IH0KCgkJLy8gaGlkZSBjaGlsZCByb3dzCgkJJCgnI3Jvb3QgLnRhYmxlc29ydGVyLWNoaWxkUm93JykuaGlkZSgpOwoJCS8vIHRvZ2dsZSBjaGlsZCByb3cgY29udGVudCwgbm90IGhpZGluZyB0aGUgcm93IHNpbmNlIHdlIGFyZSB1c2luZyByb3dzcGFuCgkJJCgnI3Jvb3QgLnRvZ2dsZScpLmNsaWNrKGZ1bmN0aW9uKCl7CgkJCSQodGhpcykuY2xvc2VzdCgndHInKS5uZXh0VW50aWwoJ3RyOm5vdCgudGFibGVzb3J0ZXItY2hpbGRSb3cpJykudG9nZ2xlKCk7CgkJCXJldHVybiBmYWxzZTsKCQl9KTsKCgkJYW5pbWF0aW5nID0gZmFsc2U7CgkJY2xpY2tlZCA9IGZhbHNlOwoJCSQoJy5jb2xsYXBzaWJsZScpLmhpZGUoKTsKCgkJJCgnYS5wZXJtYWxpbmsnKS5jbGljayhmdW5jdGlvbigpewoJCQl2YXIgJGVsID0gJCh0aGlzKTsKCQkJc2V0VGltZW91dChmdW5jdGlvbigpewoJCQkJaWYgKCFhbmltYXRpbmcgJiYgIWNsaWNrZWQpIHsKCQkJCQlhbmltYXRpbmcgPSB0cnVlOwoJCQkJCSRlbC5jbG9zZXN0KCd0cicpLmZpbmQoJy5jb2xsYXBzaWJsZScpLnNsaWRlVG9nZ2xlKCk7CgkJCQkJc2V0VGltZW91dChmdW5jdGlvbigpeyBhbmltYXRpbmcgPSBmYWxzZTsgfSwgMjAwKTsKCQkJCX0KCQkJfSwgMjAwKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX0pOwoJCSQoJyNyb290IC5wZXJtYWxpbmsnKS5kYmxjbGljayhmdW5jdGlvbigpewoJCQljbGlja2VkID0gdHJ1ZTsKCQkJd2luZG93LmxvY2F0aW9uLmhhc2ggPSAnIycgKyAkKHRoaXMpLmNsb3Nlc3QoJ3RyJylbMF0uaWQ7CgkJCXNob3dQcm9wZXJ0eSgpOwoJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IGNsaWNrZWQgPSBmYWxzZTsgfSwgNTAwKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX0pOwoKCQkkKCcudG9nZ2xlQWxsLCAuc2hvd0FsbCwgLmhpZGVBbGwnKS5jbGljayhmdW5jdGlvbigpewoJCQl0ID0gJC50cmltKCQodGhpcykudGV4dCgpKTsKCQkJLy8gdXNlIG5leHRBbGwgdG8gaWdub3JlIGFueSA8YnI+IG9yIG90aGVyIGVsZW1lbnRzIGJldHdlZW4gdGhpcyBsaW5rIGFuZCB0aGUgdGFibGUKCQkJJCh0aGlzKS5wYXJlbnQoKS5uZXh0QWxsKCd0YWJsZTpmaXJzdCcpLmZpbmQoJy5jb2xsYXBzaWJsZScpW3RdKCk7CgkJCXJldHVybiBmYWxzZTsKCQl9KTsKCgkJLy8gdXBkYXRlIHZlcnNpb24gbnVtYmVyCgkJJHQgPSAkKCcuY3VycmVudC12ZXJzaW9uJyk7CgkJaWYgKCR0Lmxlbmd0aCkgewoJCQkkdC5odG1sKCQudGFibGVzb3J0ZXIudmVyc2lvbik7CgkJfQoKCQkvLyBhZGQgaGlnaCB2aXNpYmlsaXR5IHRhZ3MgZm9yIG5ld2VzdCB2ZXJzaW9ucyAoanVzdCBncmFiIHRoZSBtYWpvciByZXZpc2lvbiBudW1iZXIgMi4xMC4wIC0+IDEwCgkJdCA9ICQudGFibGVzb3J0ZXIudmVyc2lvbi5yZXBsYWNlKC8odnx2ZXJzaW9ufFwrKS9nLCAnJykuc3BsaXQoJy4nKTsKCQl2ID0gWyBwYXJzZUludCh0WzBdLCAxMCkgfHwgMSwgcGFyc2VJbnQodFsxXSwgMTApIHx8IDAgXTsKCQkkKCcudmVyc2lvbicpLmVhY2goZnVuY3Rpb24oKXsKCQkJdmFyIGk7CgkJCSR0ID0gJCh0aGlzKTsKCQkJaSA9ICR0LnRleHQoKS5yZXBsYWNlKC8odnx2ZXJzaW9ufFwrKS9nLCAnJykuc3BsaXQoJy4nKTsKCQkJdCA9IFsgcGFyc2VJbnQoaVswXSwgMTApIHx8IDEsIHBhcnNlSW50KGlbMV0sIDEwKSB8fCAwIF07CgkJCWlmICh0WzBdID09PSB2WzBdICYmIHRbMV0gPj0gdlsxXSAtIDEgKSB7CgkJCQkkdC5wcmVwZW5kKCc8c3BhbiBjbGFzcz0ibGFiZWwgJyArICggdFswXSA9PT0gdlswXSAmJiB0WzFdIDwgdlsxXSA/ICcgbGFiZWwtZGVmYXVsdCcgOiAnIGxhYmVsLXN1Y2Nlc3MnICkgKwoJCQkJCSciPicrICgkdC5oYXNDbGFzcygndXBkYXRlZCcpID8gJ1VwZGF0ZWQnIDogJ05ldycpICsgJzwvc3Bhbj4gJyk7CgkJCX0KCQl9KTsKCgkJJHQgPSAkKCcuYWNjb3JkaW9uJyk7CgkJaWYgKCR0Lmxlbmd0aCkgewoJCQl2YXIgaWQsIGhhc2hJZCwKCQkJCWhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaDsKCQkJLy8gYWRkIGFjY29kaW9uIGlkcwoJCQkkdC5lYWNoKGZ1bmN0aW9uKGkpewoJCQkJJCh0aGlzKS5jaGlsZHJlbignaDMnKS5lYWNoKGZ1bmN0aW9uKGkpewoJCQkJCXZhciB0eHQgPSAkKHRoaXMpLmZpbmQoJ2EnKS50ZXh0KCkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bLTooKVwiXS9nLCcnKS5yZXBsYWNlKC9bXHMrXC9dL2csJ18nKTsKCQkJCQl0aGlzLmlkID0gdHh0OwoJCQkJCWlmIChoYXNoICYmIHR4dCA9PT0gaGFzaC5zbGljZSgxKSkgewoJCQkJCQloYXNoSWQgPSBpOwoJCQkJCX0KCQkJCX0pOwoJCQl9KTsKCQkJLy8gc2V0IHVwIGFjY29yZGlvbnMKCQkJJHQuZWFjaChmdW5jdGlvbihpKXsKCQkJCXZhciAkdGhpcyA9ICQodGhpcyk7CgkJCQkkdGhpcy5hY2NvcmRpb24oewoJCQkJCWFjdGl2ZTogaGFzaElkLAoJCQkJCWFuaW1hdGU6IGZhbHNlLAoJCQkJCWhlaWdodFN0eWxlOiAnY29udGVudCcsCgkJCQkJY29sbGFwc2libGU6IHRydWUsCgkJCQkJY3JlYXRlOiBmdW5jdGlvbigpIHsKCQkJCQkJJHRoaXMuY2hpbGRyZW4oJ2gzJykuZWFjaChmdW5jdGlvbihpKXsKCQkJCQkJCXRoaXMuaWQgPSAkKHRoaXMpLmZpbmQoJ2EnKS50ZXh0KCkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bLTooKVwiXS9nLCcnKS5yZXBsYWNlKC9bXHMrXC9dL2csJ18nKTsKCQkJCQkJCSQodGhpcykuYmVmb3JlKCc8YSBjbGFzcz0iYWNjb3JkaW9uLWxpbmsgbGluayIgZGF0YS1pbmRleD0iJyArIGkgKyAnIiBocmVmPSIjJyArIHRoaXMuaWQgKyAnIj48L2E+Jyk7CgkJCQkJCX0pOwoJCQkJCQkkdGhpcy5maW5kKCcuYWNjb3JkaW9uLWxpbmsnKS5jbGljayhmdW5jdGlvbigpewoJCQkJCQkJJHRoaXMuYWNjb3JkaW9uKCAib3B0aW9uIiwgImFjdGl2ZSIsICQodGhpcykuZGF0YSgnaW5kZXgnKSApOwoJCQkJCQl9KTsKCQkJCQl9LAoJCQkJCWFjdGl2YXRlOiBmdW5jdGlvbihlLCB1aSkgewoJCQkJCQkvLyByZWZyZXNoIHplYnJhIHdpZGdldCB3aGVuIHJvd3MgYXJlIHZpc2libGUKCQkJCQkJdWkubmV3UGFuZWwuZmluZCgndGFibGUnKS50cmlnZ2VyKCdhcHBseVdpZGdldHMnKTsKCQkJCQl9CgkJCQl9KTsKCQkJCS8vIG9wZW4gcGFyZW50IGFjY29yZGlvbiBvZiBuZXN0ZWQgYWNjb3JkaW9uCgkJCQlpZiAoICR0aGlzLmZpbmQoaGFzaCkubGVuZ3RoICYmICEkdGhpcy5jaGlsZHJlbihoYXNoKS5sZW5ndGggKSB7CgkJCQkJLy8gZGl2IHNob3VsZCBoYXZlIGFuIGlkIG9mIHVpLWFjY29yZGlvbi0jLXBhbmVsLSMKCQkJCQlpZCA9ICQoaGFzaCkuY2xvc2VzdCgnLnVpLWFjY29yZGlvbi1jb250ZW50JykuYXR0cignaWQnKS5tYXRjaCgvXGQrJC8pOwoJCQkJCWlmIChpZCAmJiBpZC5sZW5ndGgpIHsKCQkJCQkJJHRoaXMuYWNjb3JkaW9uKCdvcHRpb24nLCAnYWN0aXZlJywgTnVtYmVyKGlkWzBdKSAtIDEpOwoJCQkJCX0KCgkJCQkvLyBvcGVuIHRhYmxlIHJvdyBvZiBuZXN0ZWQgYWNjb3JkaW9uCgkJCQl9IGVsc2UgaWYgKCAoJHRoaXMuZmluZChoYXNoKS5jbG9zZXN0KCd0cicpLmF0dHIoJ2lkJykgfHwgJycpICE9PSAnJykgewoJCQkJCXQgPSAkdGhpcy5maW5kKGhhc2gpLmNsb3Nlc3QoJ3RyJyk7CgkJCQkJdC5maW5kKCcuY29sbGFwc2libGUnKS5zaG93KCk7CgkJCQkJaWYgKHQuY2xvc2VzdCgndGFibGUnKS5oYXNDbGFzcygnaGFzU3RpY2t5SGVhZGVycycpKSB7CgkJCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKXsKCQkJCQkJCXdpbmRvdy5zY3JvbGxUbyggMCwgdC5vZmZzZXQoKS50b3AgLSAyNyApOwoJCQkJCQl9LCAyMDApOwoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJfQoKCX0pOwoKCWZ1bmN0aW9uIHNob3dQcm9wZXJ0eSgpewoJCXZhciBwcm9wLCAkdCwgd28sIGggPSB3aW5kb3cubG9jYXRpb24uaGFzaDsKCQlpZiAoaCkgewoJCQlwcm9wID0gJChoKTsKCQkJaWYgKHByb3AubGVuZ3RoICYmICEvaDN8YXx0YWJsZS9pLnRlc3QocHJvcFswXS50YWdOYW1lKSkgewoJCQkJcHJvcC5maW5kKCcuY29sbGFwc2libGUnKS5zaG93KCk7CgkJCQlpZiAoaCA9PT0gJyNjc3NjaGlsZHJvdycpIHsKCQkJCQkkKCcjcm9vdCAudGFibGVzb3J0ZXItY2hpbGRSb3cnKS5zaG93KCk7CgkJCQl9CgkJCQkvLyBtb3ZlIGJlbG93IHN0aWNreSBoZWFkZXI7IGFkZGVkIGRlbGF5IGFzIHRoZXJlIGNvdWxkIGJlIHNvbWUgbGFnCgkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CgkJCQkJJHQgPSBwcm9wLmNsb3Nlc3QoJ3RhYmxlJyk7CgkJCQkJaWYgKCR0Lmxlbmd0aCkgewoJCQkJCQl3byA9ICR0WzBdLmNvbmZpZy53aWRnZXRPcHRpb25zOwoJCQkJCQloID0gKCB3by4kc3RpY2t5ID8gd28uJHN0aWNreS5oZWlnaHQoKSA6ICcnICkgfHwgJHQuaGFzQ2xhc3MoJ2hhc1N0aWNrSGVhZGVycycpID8gMjcgOiAwOwoJCQkJCQlpZiAoJHQuaGFzQ2xhc3MoJ29wdGlvbnMnKSB8fCAkdC5oYXNDbGFzcygnYXBpJykpIHsKCQkJCQkJCXdpbmRvdy5zY3JvbGxUbyggMCwgcHJvcC5vZmZzZXQoKS50b3AgLSBoICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9LCAyMDApOwoJCQl9CgkJfQoJfQoKCSQod2luZG93KS5sb2FkKGZ1bmN0aW9uKCl7CgkJaWYgKCQoJyNyb290JykubGVuZ3RoKSB7CgkJCSQod2luZG93KS5iaW5kKCdoYXNoY2hhbmdlJywgZnVuY3Rpb24oKXsKCQkJCXNob3dQcm9wZXJ0eSgpOwoJCQl9KTsKCQkJc2hvd1Byb3BlcnR5KCk7CgkJfQoJfSk7CgoJLy8gYXBwZW5kIGhpZGRlbiBwYXJzZWQgdmFsdWUgdG8gY2VsbAoJLy8gdXNlZCBieSBmZWV0LWluY2gtZnJhY3Rpb24gJiBtZXRyaWMgcGFyc2VyIGRlbW9zCgl3aW5kb3cuYWRkUGFyc2VkVmFsdWVzID0gZnVuY3Rpb24oJHQsIGNvbHMsIGZvcm1hdCl7CgkJdmFyIHIsCgkJCSRyID0gJHQuZmluZCgndGJvZHkgdHInKSwKCQkJYyA9ICR0WzBdLmNvbmZpZy5jYWNoZVswXS5ub3JtYWxpemVkOwoJCSRyLmVhY2goZnVuY3Rpb24oaSl7CgkJCXIgPSB0aGlzOwoJCQkkLmVhY2goY29scywgZnVuY3Rpb24odixqKXsKCQkJCXIuY2VsbHNbal0uaW5uZXJIVE1MICs9ICcgPHNwYW4gY2xhc3M9InZhbCBoaWRkZW4gcmVtb3ZlbWUiPig8c3BhbiBjbGFzcz0icmVzdWx0cyI+JyArIChmb3JtYXQgPyBmb3JtYXQoY1tpXVtqXSkgOiBjW2ldW2pdKSArICc8L3NwYW4+KTwvc3Bhbj4nOwoJCQl9KTsKCQl9KTsKCgkJJCgnLnRvZ2dsZXBhcnNlZHZhbHVlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXsKCQkJJCgnLnZhbCcpLnRvZ2dsZUNsYXNzKCdoaWRkZW4nKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX0pOwoJfTsKCn0pKGpRdWVyeSk7Cg==",
                "body": "Lypqc2hpbnQgYnJvd3Nlcjp0cnVlLCBqcXVlcnk6dHJ1ZSwgdW51c2VkOmZhbHNlICovCi8qZ2xvYmFsIHByZXR0eVByaW50OmZhbHNlICovCihmdW5jdGlvbigkKXsKCSQoZnVuY3Rpb24oKXsKCQl2YXIgJHQsIHQsIHYsIGFuaW1hdGluZywgY2xpY2tlZCwKCgkJY2xlYW51cENvZGUgPSBmdW5jdGlvbihjb2RlKXsKCQkJcmV0dXJuIGNvZGUucmVwbGFjZSgvWzw+XCJcJ1x0XG5dL2csIGZ1bmN0aW9uKG0pIHsgcmV0dXJuIHsKCQkJCSc8JyA6ICcmbHQ7JywKCQkJCSc+JyA6ICcmZ3Q7JywKCQkJCSInIiA6ICcmIzM5OycsCgkJCQknIicgOiAnJnF1b3Q7JywKCQkJCSdcdCc6ICcgICcsCgkJCQknXG4nOiAnPGJyLz4nIC8vIG5lZWRlZCBmb3IgSUUKCQkJfVttXTt9KTsKCQl9OwoKCQkkKCJhLmV4dGVybmFsIikuZWFjaChmdW5jdGlvbigpe3RoaXMudGFyZ2V0ID0gJ19uZXcnO30pOwoKCQkvLyBnZXQgamF2YXNjcmlwdCBzb3VyY2UKCQlpZiAoJCgiI2pzIikubGVuZ3RoKSB7CgkJCSQoIiNqYXZhc2NyaXB0IHByZSIpLmFkZENsYXNzKCdtb2QnKS5odG1sKCBjbGVhbnVwQ29kZSggJCgiI2pzIikuaHRtbCgpICkgKTsKCQl9CgkJaWYgKCQoIiNjc3MiKS5sZW5ndGgpIHsKCQkJJCgicHJlLmxhbmctY3NzIikuYWRkQ2xhc3MoJ21vZCcpLmh0bWwoIGNsZWFudXBDb2RlKCAkKCIjY3NzIikuaHRtbCgpICkgKTsKCQl9CgkJaWYgKCQoIiNkZW1vIikubGVuZ3RoICYmICQoIiNodG1sIHByZSIpLmxlbmd0aCkgewoJCQkkKCIjaHRtbCBwcmUiKS5hZGRDbGFzcygnbW9kJykuaHRtbCggY2xlYW51cENvZGUoICQoIiNkZW1vIikuaHRtbCgpICkgKTsKCQl9CgoJCS8vIGFwcGx5IHRvIGFscmVhZHkgcHJlLWZvcm1hdHRlZCBibG9ja3MgdG8gYWRkIDxicj4gZm9yIElFCgkJJCgncHJlLnByZXR0eXByaW50Om5vdCgubW9kKScpLmVhY2goZnVuY3Rpb24oKXsKCQkJJHQgPSAkKHRoaXMpOwoJCQkkdC5odG1sKCBjbGVhbnVwQ29kZSggJHQuaHRtbCgpICkgKTsKCQl9KTsKCgkJaWYgKHR5cGVvZiBwcmV0dHlQcmludCAhPT0gJ3VuZGVmaW5lZCcpIHsgcHJldHR5UHJpbnQoKTsgfQoKCQkvLyBoaWRlIGNoaWxkIHJvd3MKCQkkKCcjcm9vdCAudGFibGVzb3J0ZXItY2hpbGRSb3cnKS5oaWRlKCk7CgkJLy8gdG9nZ2xlIGNoaWxkIHJvdyBjb250ZW50LCBub3QgaGlkaW5nIHRoZSByb3cgc2luY2Ugd2UgYXJlIHVzaW5nIHJvd3NwYW4KCQkkKCcjcm9vdCAudG9nZ2xlJykuY2xpY2soZnVuY3Rpb24oKXsKCQkJJCh0aGlzKS5jbG9zZXN0KCd0cicpLm5leHRVbnRpbCgndHI6bm90KC50YWJsZXNvcnRlci1jaGlsZFJvdyknKS50b2dnbGUoKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX0pOwoKCQlhbmltYXRpbmcgPSBmYWxzZTsKCQljbGlja2VkID0gZmFsc2U7CgkJJCgnLmNvbGxhcHNpYmxlJykuaGlkZSgpOwoKCQkkKCdhLnBlcm1hbGluaycpLmNsaWNrKGZ1bmN0aW9uKCl7CgkJCXZhciAkZWwgPSAkKHRoaXMpOwoJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CgkJCQlpZiAoIWFuaW1hdGluZyAmJiAhY2xpY2tlZCkgewoJCQkJCWFuaW1hdGluZyA9IHRydWU7CgkJCQkJJGVsLmNsb3Nlc3QoJ3RyJykuZmluZCgnLmNvbGxhcHNpYmxlJykuc2xpZGVUb2dnbGUoKTsKCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IGFuaW1hdGluZyA9IGZhbHNlOyB9LCAyMDApOwoJCQkJfQoJCQl9LCAyMDApOwoJCQlyZXR1cm4gZmFsc2U7CgkJfSk7CgkJJCgnI3Jvb3QgLnBlcm1hbGluaycpLmRibGNsaWNrKGZ1bmN0aW9uKCl7CgkJCWNsaWNrZWQgPSB0cnVlOwoJCQl3aW5kb3cubG9jYXRpb24uaGFzaCA9ICcjJyArICQodGhpcykuY2xvc2VzdCgndHInKVswXS5pZDsKCQkJc2hvd1Byb3BlcnR5KCk7CgkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKXsgY2xpY2tlZCA9IGZhbHNlOyB9LCA1MDApOwoJCQlyZXR1cm4gZmFsc2U7CgkJfSk7CgoJCSQoJy50b2dnbGVBbGwsIC5zaG93QWxsLCAuaGlkZUFsbCcpLmNsaWNrKGZ1bmN0aW9uKCl7CgkJCXQgPSAkLnRyaW0oJCh0aGlzKS50ZXh0KCkpOwoJCQkvLyB1c2UgbmV4dEFsbCB0byBpZ25vcmUgYW55IDxicj4gb3Igb3RoZXIgZWxlbWVudHMgYmV0d2VlbiB0aGlzIGxpbmsgYW5kIHRoZSB0YWJsZQoJCQkkKHRoaXMpLnBhcmVudCgpLm5leHRBbGwoJ3RhYmxlOmZpcnN0JykuZmluZCgnLmNvbGxhcHNpYmxlJylbdF0oKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX0pOwoKCQkvLyB1cGRhdGUgdmVyc2lvbiBudW1iZXIKCQkkdCA9ICQoJy5jdXJyZW50LXZlcnNpb24nKTsKCQlpZiAoJHQubGVuZ3RoKSB7CgkJCSR0Lmh0bWwoJC50YWJsZXNvcnRlci52ZXJzaW9uKTsKCQl9CgoJCS8vIGFkZCBoaWdoIHZpc2liaWxpdHkgdGFncyBmb3IgbmV3ZXN0IHZlcnNpb25zIChqdXN0IGdyYWIgdGhlIG1ham9yIHJldmlzaW9uIG51bWJlciAyLjEwLjAgLT4gMTAKCQl0ID0gJC50YWJsZXNvcnRlci52ZXJzaW9uLnJlcGxhY2UoLyh2fHZlcnNpb258XCspL2csICcnKS5zcGxpdCgnLicpOwoJCXYgPSBbIHBhcnNlSW50KHRbMF0sIDEwKSB8fCAxLCBwYXJzZUludCh0WzFdLCAxMCkgfHwgMCBdOwoJCSQoJy52ZXJzaW9uJykuZWFjaChmdW5jdGlvbigpewoJCQl2YXIgaTsKCQkJJHQgPSAkKHRoaXMpOwoJCQlpID0gJHQudGV4dCgpLnJlcGxhY2UoLyh2fHZlcnNpb258XCspL2csICcnKS5zcGxpdCgnLicpOwoJCQl0ID0gWyBwYXJzZUludChpWzBdLCAxMCkgfHwgMSwgcGFyc2VJbnQoaVsxXSwgMTApIHx8IDAgXTsKCQkJaWYgKHRbMF0gPT09IHZbMF0gJiYgdFsxXSA+PSB2WzFdIC0gMSApIHsKCQkJCSR0LnByZXBlbmQoJzxzcGFuIGNsYXNzPSJsYWJlbCAnICsgKCB0WzBdID09PSB2WzBdICYmIHRbMV0gPCB2WzFdID8gJyBsYWJlbC1kZWZhdWx0JyA6ICcgbGFiZWwtc3VjY2VzcycgKSArCgkJCQkJJyI+JysgKCR0Lmhhc0NsYXNzKCd1cGRhdGVkJykgPyAnVXBkYXRlZCcgOiAnTmV3JykgKyAnPC9zcGFuPiAnKTsKCQkJfQoJCX0pOwoKCQkkdCA9ICQoJy5hY2NvcmRpb24nKTsKCQlpZiAoJHQubGVuZ3RoKSB7CgkJCXZhciBpZCwgaGFzaElkLAoJCQkJaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOwoJCQkvLyBhZGQgYWNjb2Rpb24gaWRzCgkJCSR0LmVhY2goZnVuY3Rpb24oaSl7CgkJCQkkKHRoaXMpLmNoaWxkcmVuKCdoMycpLmVhY2goZnVuY3Rpb24oaSl7CgkJCQkJdmFyIHR4dCA9ICQodGhpcykuZmluZCgnYScpLnRleHQoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1stOigpXCJdL2csJycpLnJlcGxhY2UoL1tccytcL10vZywnXycpOwoJCQkJCXRoaXMuaWQgPSB0eHQ7CgkJCQkJaWYgKGhhc2ggJiYgdHh0ID09PSBoYXNoLnNsaWNlKDEpKSB7CgkJCQkJCWhhc2hJZCA9IGk7CgkJCQkJfQoJCQkJfSk7CgkJCX0pOwoJCQkvLyBzZXQgdXAgYWNjb3JkaW9ucwoJCQkkdC5lYWNoKGZ1bmN0aW9uKGkpewoJCQkJdmFyICR0aGlzID0gJCh0aGlzKTsKCQkJCSR0aGlzLmFjY29yZGlvbih7CgkJCQkJYWN0aXZlOiBoYXNoSWQsCgkJCQkJYW5pbWF0ZTogZmFsc2UsCgkJCQkJaGVpZ2h0U3R5bGU6ICdjb250ZW50JywKCQkJCQljb2xsYXBzaWJsZTogdHJ1ZSwKCQkJCQljcmVhdGU6IGZ1bmN0aW9uKCkgewoJCQkJCQkkdGhpcy5jaGlsZHJlbignaDMnKS5lYWNoKGZ1bmN0aW9uKGkpewoJCQkJCQkJdGhpcy5pZCA9ICQodGhpcykuZmluZCgnYScpLnRleHQoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1stOigpXCJdL2csJycpLnJlcGxhY2UoL1tccytcL10vZywnXycpOwoJCQkJCQkJJCh0aGlzKS5iZWZvcmUoJzxhIGNsYXNzPSJhY2NvcmRpb24tbGluayBsaW5rIiBkYXRhLWluZGV4PSInICsgaSArICciIGhyZWY9IiMnICsgdGhpcy5pZCArICciPjwvYT4nKTsKCQkJCQkJfSk7CgkJCQkJCSR0aGlzLmZpbmQoJy5hY2NvcmRpb24tbGluaycpLmNsaWNrKGZ1bmN0aW9uKCl7CgkJCQkJCQkkdGhpcy5hY2NvcmRpb24oICJvcHRpb24iLCAiYWN0aXZlIiwgJCh0aGlzKS5kYXRhKCdpbmRleCcpICk7CgkJCQkJCX0pOwoJCQkJCX0sCgkJCQkJYWN0aXZhdGU6IGZ1bmN0aW9uKGUsIHVpKSB7CgkJCQkJCS8vIHJlZnJlc2ggemVicmEgd2lkZ2V0IHdoZW4gcm93cyBhcmUgdmlzaWJsZQoJCQkJCQl1aS5uZXdQYW5lbC5maW5kKCd0YWJsZScpLnRyaWdnZXIoJ2FwcGx5V2lkZ2V0cycpOwoJCQkJCX0KCQkJCX0pOwoJCQkJLy8gb3BlbiBwYXJlbnQgYWNjb3JkaW9uIG9mIG5lc3RlZCBhY2NvcmRpb24KCQkJCWlmICggJHRoaXMuZmluZChoYXNoKS5sZW5ndGggJiYgISR0aGlzLmNoaWxkcmVuKGhhc2gpLmxlbmd0aCApIHsKCQkJCQkvLyBkaXYgc2hvdWxkIGhhdmUgYW4gaWQgb2YgdWktYWNjb3JkaW9uLSMtcGFuZWwtIwoJCQkJCWlkID0gJChoYXNoKS5jbG9zZXN0KCcudWktYWNjb3JkaW9uLWNvbnRlbnQnKS5hdHRyKCdpZCcpLm1hdGNoKC9cZCskLyk7CgkJCQkJaWYgKGlkICYmIGlkLmxlbmd0aCkgewoJCQkJCQkkdGhpcy5hY2NvcmRpb24oJ29wdGlvbicsICdhY3RpdmUnLCBOdW1iZXIoaWRbMF0pIC0gMSk7CgkJCQkJfQoKCQkJCS8vIG9wZW4gdGFibGUgcm93IG9mIG5lc3RlZCBhY2NvcmRpb24KCQkJCX0gZWxzZSBpZiAoICgkdGhpcy5maW5kKGhhc2gpLmNsb3Nlc3QoJ3RyJykuYXR0cignaWQnKSB8fCAnJykgIT09ICcnKSB7CgkJCQkJdCA9ICR0aGlzLmZpbmQoaGFzaCkuY2xvc2VzdCgndHInKTsKCQkJCQl0LmZpbmQoJy5jb2xsYXBzaWJsZScpLnNob3coKTsKCQkJCQlpZiAodC5jbG9zZXN0KCd0YWJsZScpLmhhc0NsYXNzKCdoYXNTdGlja3lIZWFkZXJzJykpIHsKCQkJCQkJc2V0VGltZW91dChmdW5jdGlvbigpewoJCQkJCQkJd2luZG93LnNjcm9sbFRvKCAwLCB0Lm9mZnNldCgpLnRvcCAtIDI3ICk7CgkJCQkJCX0sIDIwMCk7CgkJCQkJfQoJCQkJfQoJCQl9KTsKCQl9CgoJfSk7CgoJZnVuY3Rpb24gc2hvd1Byb3BlcnR5KCl7CgkJdmFyIHByb3AsICR0LCB3bywgaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOwoJCWlmIChoKSB7CgkJCXByb3AgPSAkKGgpOwoJCQlpZiAocHJvcC5sZW5ndGggJiYgIS9oM3xhfHRhYmxlL2kudGVzdChwcm9wWzBdLnRhZ05hbWUpKSB7CgkJCQlwcm9wLmZpbmQoJy5jb2xsYXBzaWJsZScpLnNob3coKTsKCQkJCWlmIChoID09PSAnI2Nzc2NoaWxkcm93JykgewoJCQkJCSQoJyNyb290IC50YWJsZXNvcnRlci1jaGlsZFJvdycpLnNob3coKTsKCQkJCX0KCQkJCS8vIG1vdmUgYmVsb3cgc3RpY2t5IGhlYWRlcjsgYWRkZWQgZGVsYXkgYXMgdGhlcmUgY291bGQgYmUgc29tZSBsYWcKCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKXsKCQkJCQkkdCA9IHByb3AuY2xvc2VzdCgndGFibGUnKTsKCQkJCQlpZiAoJHQubGVuZ3RoKSB7CgkJCQkJCXdvID0gJHRbMF0uY29uZmlnLndpZGdldE9wdGlvbnM7CgkJCQkJCWggPSAoIHdvLiRzdGlja3kgPyB3by4kc3RpY2t5LmhlaWdodCgpIDogJycgKSB8fCAkdC5oYXNDbGFzcygnaGFzU3RpY2tIZWFkZXJzJykgPyAyNyA6IDA7CgkJCQkJCWlmICgkdC5oYXNDbGFzcygnb3B0aW9ucycpIHx8ICR0Lmhhc0NsYXNzKCdhcGknKSkgewoJCQkJCQkJd2luZG93LnNjcm9sbFRvKCAwLCBwcm9wLm9mZnNldCgpLnRvcCAtIGggKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0sIDIwMCk7CgkJCX0KCQl9Cgl9CgoJJCh3aW5kb3cpLmxvYWQoZnVuY3Rpb24oKXsKCQlpZiAoJCgnI3Jvb3QnKS5sZW5ndGgpIHsKCQkJJCh3aW5kb3cpLmJpbmQoJ2hhc2hjaGFuZ2UnLCBmdW5jdGlvbigpewoJCQkJc2hvd1Byb3BlcnR5KCk7CgkJCX0pOwoJCQlzaG93UHJvcGVydHkoKTsKCQl9Cgl9KTsKCgkvLyBhcHBlbmQgaGlkZGVuIHBhcnNlZCB2YWx1ZSB0byBjZWxsCgkvLyB1c2VkIGJ5IGZlZXQtaW5jaC1mcmFjdGlvbiAmIG1ldHJpYyBwYXJzZXIgZGVtb3MKCXdpbmRvdy5hZGRQYXJzZWRWYWx1ZXMgPSBmdW5jdGlvbigkdCwgY29scywgZm9ybWF0KXsKCQl2YXIgciwKCQkJJHIgPSAkdC5maW5kKCd0Ym9keSB0cicpLAoJCQljID0gJHRbMF0uY29uZmlnLmNhY2hlWzBdLm5vcm1hbGl6ZWQ7CgkJJHIuZWFjaChmdW5jdGlvbihpKXsKCQkJciA9IHRoaXM7CgkJCSQuZWFjaChjb2xzLCBmdW5jdGlvbih2LGopewoJCQkJci5jZWxsc1tqXS5pbm5lckhUTUwgKz0gJyA8c3BhbiBjbGFzcz0idmFsIGhpZGRlbiByZW1vdmVtZSI+KDxzcGFuIGNsYXNzPSJyZXN1bHRzIj4nICsgKGZvcm1hdCA/IGZvcm1hdChjW2ldW2pdKSA6IGNbaV1bal0pICsgJzwvc3Bhbj4pPC9zcGFuPic7CgkJCX0pOwoJCX0pOwoKCQkkKCcudG9nZ2xlcGFyc2VkdmFsdWUnKS5vbignY2xpY2snLCBmdW5jdGlvbigpewoJCQkkKCcudmFsJykudG9nZ2xlQ2xhc3MoJ2hpZGRlbicpOwoJCQlyZXR1cm4gZmFsc2U7CgkJfSk7Cgl9OwoKfSkoalF1ZXJ5KTsK",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 07:12:19 GMT",
                    "Content-Length": "6330",
                    "Date": "Fri, 07 Nov 2014 07:12:19 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}