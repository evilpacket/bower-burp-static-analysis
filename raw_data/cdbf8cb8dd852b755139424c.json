{
    "url": "http://localhost:9999/uikit/bower-uikit/js/components/sticky.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>location.hash</b> and written to <b>$()</b> via the following statement:<ul><li>var $target = $(location.hash);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/uikit/bower-uikit/js/components/sticky.js",
                "path": "/uikit/bower-uikit/js/components/sticky.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC91aWtpdC9ib3dlci11aWtpdC9qcy9jb21wb25lbnRzL3N0aWNreS5qcyBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODE0MA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogU3VuLCAwOSBOb3YgMjAxNCAwMDozNDoyMyBHTVQNCkxhc3QtTW9kaWZpZWQ6IFN1biwgMDkgTm92IDIwMTQgMDA6MzQ6MjMgR01UDQoNCi8qISBVSWtpdCAyLjEyLjAgfCBodHRwOi8vd3d3LmdldHVpa2l0LmNvbSB8IChjKSAyMDE0IFlPT3RoZW1lIHwgTUlUIExpY2Vuc2UgKi8KKGZ1bmN0aW9uKGFkZG9uKSB7CgogICAgdmFyIGNvbXBvbmVudDsKCiAgICBpZiAoalF1ZXJ5ICYmIGpRdWVyeS5VSWtpdCkgewogICAgICAgIGNvbXBvbmVudCA9IGFkZG9uKGpRdWVyeSwgalF1ZXJ5LlVJa2l0KTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGRlZmluZSA9PSAiZnVuY3Rpb24iICYmIGRlZmluZS5hbWQpIHsKICAgICAgICBkZWZpbmUoInVpa2l0LXN0aWNreSIsIFsidWlraXQiXSwgZnVuY3Rpb24oKXsKICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudCB8fCBhZGRvbihqUXVlcnksIGpRdWVyeS5VSWtpdCk7CiAgICAgICAgfSk7CiAgICB9Cgp9KShmdW5jdGlvbigkLCBVSSl7CgogICAgdmFyICR3aW4gICAgICAgICA9IFVJLiR3aW4sCiAgICAgICAgJGRvYyAgICAgICAgID0gVUkuJGRvYywKICAgICAgICBzdGlja2VkICAgICAgPSBbXTsKCiAgICBVSS5jb21wb25lbnQoJ3N0aWNreScsIHsKCiAgICAgICAgZGVmYXVsdHM6IHsKICAgICAgICAgICAgdG9wICAgICAgICAgIDogMCwKICAgICAgICAgICAgYm90dG9tICAgICAgIDogMCwKICAgICAgICAgICAgYW5pbWF0aW9uICAgIDogJycsCiAgICAgICAgICAgIGNsc2luaXQgICAgICA6ICd1ay1zdGlja3ktaW5pdCcsCiAgICAgICAgICAgIGNsc2FjdGl2ZSAgICA6ICd1ay1hY3RpdmUnLAogICAgICAgICAgICBnZXRXaWR0aEZyb20gOiAnJywKICAgICAgICAgICAgbWVkaWEgICAgICAgIDogZmFsc2UsCiAgICAgICAgICAgIHRhcmdldCAgICAgICA6IGZhbHNlCiAgICAgICAgfSwKCiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7CgogICAgICAgICAgICB2YXIgd3JhcHBlciAgPSAkKCc8ZGl2IGNsYXNzPSJ1ay1zdGlja3ktcGxhY2Vob2xkZXIiPjwvZGl2PicpLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICdoZWlnaHQnIDogdGhpcy5lbGVtZW50LmNzcygncG9zaXRpb24nKSAhPSAnYWJzb2x1dGUnID8gdGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCkgOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2Zsb2F0JyAgOiB0aGlzLmVsZW1lbnQuY3NzKCJmbG9hdCIpICE9ICJub25lIiA/IHRoaXMuZWxlbWVudC5jc3MoImZsb2F0IikgOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ21hcmdpbicgOiB0aGlzLmVsZW1lbnQuY3NzKCJtYXJnaW4iKQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICB3cmFwcGVyID0gdGhpcy5lbGVtZW50LmNzcygnbWFyZ2luJywgMCkud3JhcCh3cmFwcGVyKS5wYXJlbnQoKTsKCiAgICAgICAgICAgIHRoaXMuc3RpY2t5ID0gewogICAgICAgICAgICAgICAgb3B0aW9ucyAgICAgIDogdGhpcy5vcHRpb25zLAogICAgICAgICAgICAgICAgZWxlbWVudCAgICAgIDogdGhpcy5lbGVtZW50LAogICAgICAgICAgICAgICAgY3VycmVudFRvcCAgIDogbnVsbCwKICAgICAgICAgICAgICAgIHdyYXBwZXIgICAgICA6IHdyYXBwZXIsCiAgICAgICAgICAgICAgICBpbml0ICAgICAgICAgOiBmYWxzZSwKICAgICAgICAgICAgICAgIGdldFdpZHRoRnJvbSA6IHRoaXMub3B0aW9ucy5nZXRXaWR0aEZyb20gfHwgd3JhcHBlciwKICAgICAgICAgICAgICAgIHJlc2V0ICAgICAgICA6IGZ1bmN0aW9uKGZvcmNlKSB7CgogICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuY3NzKHsicG9zaXRpb24iOiIiLCAidG9wIjoiIiwgIndpZHRoIjoiIiwgImxlZnQiOiIiLCAibWFyZ2luIjoiMCJ9KTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKFt0aGlzLm9wdGlvbnMuYW5pbWF0aW9uLCAndWstYW5pbWF0aW9uLXJldmVyc2UnLCB0aGlzLm9wdGlvbnMuY2xzYWN0aXZlXS5qb2luKCcgJykpOwoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VG9wID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hbmltYXRlICAgID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpOwoKCiAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3JjZSAmJiB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uICYmIFVJLnN1cHBvcnQuYW5pbWF0aW9uKSB7CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGUgPSB0cnVlOwoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5hbmltYXRpb24pLm9uZShVSS5zdXBwb3J0LmFuaW1hdGlvbi5lbmQsIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbGl6ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB9KS53aWR0aCgpOyAvLyBmb3JjZSByZWRyYXcKCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYW5pbWF0aW9uKycgJysndWstYW5pbWF0aW9uLXJldmVyc2UnKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBmaW5hbGl6ZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjaGVjazogZnVuY3Rpb24oKSB7CgogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMubWVkaWEpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCh0eXBlb2YodGhpcy5vcHRpb25zLm1lZGlhKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCB0aGlzLm9wdGlvbnMubWVkaWEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0cmluZyc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5tYXRjaE1lZGlhICYmICF3aW5kb3cubWF0Y2hNZWRpYSh0aGlzLm9wdGlvbnMubWVkaWEpLm1hdGNoZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCAgICAgID0gJHdpbi5zY3JvbGxUb3AoKSwKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRIZWlnaHQgPSAkZG9jLmhlaWdodCgpLAogICAgICAgICAgICAgICAgICAgICAgICBkd2ggICAgICAgICAgICA9IGRvY3VtZW50SGVpZ2h0IC0gJHdpbi5oZWlnaHQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmEgICAgICAgICAgPSAoc2Nyb2xsVG9wID4gZHdoKSA/IGR3aCAtIHNjcm9sbFRvcCA6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRUb3AgICAgID0gdGhpcy53cmFwcGVyLm9mZnNldCgpLnRvcCwKICAgICAgICAgICAgICAgICAgICAgICAgZXRzZSAgICAgICAgICAgPSBlbGVtZW50VG9wIC0gdGhpcy5vcHRpb25zLnRvcCAtIGV4dHJhOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHNjcm9sbFRvcCAgPj0gZXRzZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBzdGlja2VkLnB1c2godGhpcy5zdGlja3kpOwogICAgICAgIH0sCgogICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHNjcm9sbGVyKCk7CiAgICAgICAgfQogICAgfSk7CgogICAgZnVuY3Rpb24gc2Nyb2xsZXIoKSB7CgogICAgICAgIGlmICghc3RpY2tlZC5sZW5ndGgpIHJldHVybjsKCiAgICAgICAgdmFyIHNjcm9sbFRvcCAgICAgICA9ICR3aW4uc2Nyb2xsVG9wKCksCiAgICAgICAgICAgIGRvY3VtZW50SGVpZ2h0ICA9ICRkb2MuaGVpZ2h0KCksCiAgICAgICAgICAgIGR3aCAgICAgICAgICAgICA9IGRvY3VtZW50SGVpZ2h0IC0gJHdpbi5oZWlnaHQoKSwKICAgICAgICAgICAgZXh0cmEgICAgICAgICAgID0gKHNjcm9sbFRvcCA+IGR3aCkgPyBkd2ggLSBzY3JvbGxUb3AgOiAwLAogICAgICAgICAgICBjbHMsIG5ld1RvcDsKCiAgICAgICAgaWYoc2Nyb2xsVG9wIDwgMCkgcmV0dXJuOwoKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGlja2VkLmxlbmd0aDsgaSsrKSB7CgogICAgICAgICAgICBpZiAoIXN0aWNrZWRbaV0uZWxlbWVudC5pcygiOnZpc2libGUiKSB8fCBzdGlja2VkW2ldLmFuaW1hdGUpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgc3RpY2t5ID0gc3RpY2tlZFtpXTsKCiAgICAgICAgICAgIGlmICghc3RpY2t5LmNoZWNrKCkpIHsKCiAgICAgICAgICAgICAgICBpZiAoc3RpY2t5LmN1cnJlbnRUb3AgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBzdGlja3kucmVzZXQoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgaWYgKHN0aWNreS5vcHRpb25zLnRvcCA8IDApIHsKICAgICAgICAgICAgICAgICAgICBuZXdUb3AgPSAwOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBuZXdUb3AgPSBkb2N1bWVudEhlaWdodCAtIHN0aWNreS5lbGVtZW50Lm91dGVySGVpZ2h0KCkgLSBzdGlja3kub3B0aW9ucy50b3AgLSBzdGlja3kub3B0aW9ucy5ib3R0b20gLSBzY3JvbGxUb3AgLSBleHRyYTsKICAgICAgICAgICAgICAgICAgICBuZXdUb3AgPSBuZXdUb3AgPCAwID8gbmV3VG9wICsgc3RpY2t5Lm9wdGlvbnMudG9wIDogc3RpY2t5Lm9wdGlvbnMudG9wOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzdGlja3kuY3VycmVudFRvcCAhPSBuZXdUb3ApIHsKCiAgICAgICAgICAgICAgICAgICAgc3RpY2t5LmVsZW1lbnQuY3NzKHsKICAgICAgICAgICAgICAgICAgICAgICAgInBvc2l0aW9uIiA6ICJmaXhlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ0b3AiICAgICAgOiBuZXdUb3AsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCIgICAgOiAodHlwZW9mIHN0aWNreS5nZXRXaWR0aEZyb20gIT09ICd1bmRlZmluZWQnKSA/ICQoc3RpY2t5LmdldFdpZHRoRnJvbSkud2lkdGgoKSA6IHN0aWNreS5lbGVtZW50LndpZHRoKCksCiAgICAgICAgICAgICAgICAgICAgICAgICJsZWZ0IiAgICAgOiBzdGlja3kud3JhcHBlci5vZmZzZXQoKS5sZWZ0CiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIGlmICghc3RpY2t5LmluaXQpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgIHN0aWNreS5lbGVtZW50LmFkZENsYXNzKHN0aWNreS5vcHRpb25zLmNsc2luaXQpOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uLmhhc2ggJiYgc2Nyb2xsVG9wID4gMCAmJiBzdGlja3kub3B0aW9ucy50YXJnZXQpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHRhcmdldCA9ICQobG9jYXRpb24uaGFzaCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR0YXJnZXQubGVuZ3RoKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCR0YXJnZXQsIHN0aWNreSl7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RpY2t5LmVsZW1lbnQud2lkdGgoKTsgLy8gZm9yY2UgcmVkcmF3CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldCAgICAgICA9ICR0YXJnZXQub2Zmc2V0KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4b2Zmc2V0ICAgID0gb2Zmc2V0LnRvcCArICR0YXJnZXQub3V0ZXJIZWlnaHQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGlja3lPZmZzZXQgPSBzdGlja3kuZWxlbWVudC5vZmZzZXQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGlja3lIZWlnaHQgPSBzdGlja3kuZWxlbWVudC5vdXRlckhlaWdodCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0aWNreU1heE9mZnNldCA9IHN0aWNreU9mZnNldC50b3AgKyBzdGlja3lIZWlnaHQ7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0aWNreU9mZnNldC50b3AgPCBtYXhvZmZzZXQgJiYgb2Zmc2V0LnRvcCA8IHN0aWNreU1heE9mZnNldCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcCA9IG9mZnNldC50b3AgLSBzdGlja3lIZWlnaHQgLSBzdGlja3kub3B0aW9ucy50YXJnZXQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIHNjcm9sbFRvcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKCR0YXJnZXQsIHN0aWNreSksIDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBzdGlja3kuZWxlbWVudC5hZGRDbGFzcyhzdGlja3kub3B0aW9ucy5jbHNhY3RpdmUpOwogICAgICAgICAgICAgICAgICAgIHN0aWNreS5lbGVtZW50LmNzcygnbWFyZ2luJywgJycpOwoKICAgICAgICAgICAgICAgICAgICBpZiAoc3RpY2t5Lm9wdGlvbnMuYW5pbWF0aW9uICYmIHN0aWNreS5pbml0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0aWNreS5lbGVtZW50LmFkZENsYXNzKHN0aWNreS5vcHRpb25zLmFuaW1hdGlvbik7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBzdGlja3kuY3VycmVudFRvcCA9IG5ld1RvcDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3RpY2t5LmluaXQgPSB0cnVlOwogICAgICAgIH0KCiAgICB9CgogICAgLy8gc2hvdWxkIGJlIG1vcmUgZWZmaWNpZW50IHRoYW4gdXNpbmcgJHdpbi5zY3JvbGwoc2Nyb2xsZXIpOgogICAgJGRvYy5vbigndWstc2Nyb2xsJywgc2Nyb2xsZXIpOwogICAgJHdpbi5vbigncmVzaXplIG9yaWVudGF0aW9uY2hhbmdlJywgVUkuVXRpbHMuZGVib3VuY2UoZnVuY3Rpb24oKSB7CgogICAgICAgIGlmICghc3RpY2tlZC5sZW5ndGgpIHJldHVybjsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGlja2VkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHN0aWNrZWRbaV0ucmVzZXQodHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICBzY3JvbGxlcigpOwogICAgfSwgMTAwKSk7CgogICAgLy8gaW5pdCBjb2RlCiAgICBVSS5yZWFkeShmdW5jdGlvbihjb250ZXh0KSB7CgogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKCiAgICAgICAgICAgICQoIltkYXRhLXVrLXN0aWNreV0iLCBjb250ZXh0KS5lYWNoKGZ1bmN0aW9uKCl7CgogICAgICAgICAgICAgICAgdmFyICRlbGUgPSAkKHRoaXMpOwoKICAgICAgICAgICAgICAgIGlmKCEkZWxlLmRhdGEoInN0aWNreSIpKSB7CiAgICAgICAgICAgICAgICAgICAgVUkuc3RpY2t5KCRlbGUsIFVJLlV0aWxzLm9wdGlvbnMoJGVsZS5hdHRyKCdkYXRhLXVrLXN0aWNreScpKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgc2Nyb2xsZXIoKTsKICAgICAgICB9LCAwKTsKICAgIH0pOwoKICAgIHJldHVybiAkLmZuLnVrc3RpY2t5Owp9KTs=",
                "body": "LyohIFVJa2l0IDIuMTIuMCB8IGh0dHA6Ly93d3cuZ2V0dWlraXQuY29tIHwgKGMpIDIwMTQgWU9PdGhlbWUgfCBNSVQgTGljZW5zZSAqLwooZnVuY3Rpb24oYWRkb24pIHsKCiAgICB2YXIgY29tcG9uZW50OwoKICAgIGlmIChqUXVlcnkgJiYgalF1ZXJ5LlVJa2l0KSB7CiAgICAgICAgY29tcG9uZW50ID0gYWRkb24oalF1ZXJ5LCBqUXVlcnkuVUlraXQpOwogICAgfQoKICAgIGlmICh0eXBlb2YgZGVmaW5lID09ICJmdW5jdGlvbiIgJiYgZGVmaW5lLmFtZCkgewogICAgICAgIGRlZmluZSgidWlraXQtc3RpY2t5IiwgWyJ1aWtpdCJdLCBmdW5jdGlvbigpewogICAgICAgICAgICByZXR1cm4gY29tcG9uZW50IHx8IGFkZG9uKGpRdWVyeSwgalF1ZXJ5LlVJa2l0KTsKICAgICAgICB9KTsKICAgIH0KCn0pKGZ1bmN0aW9uKCQsIFVJKXsKCiAgICB2YXIgJHdpbiAgICAgICAgID0gVUkuJHdpbiwKICAgICAgICAkZG9jICAgICAgICAgPSBVSS4kZG9jLAogICAgICAgIHN0aWNrZWQgICAgICA9IFtdOwoKICAgIFVJLmNvbXBvbmVudCgnc3RpY2t5JywgewoKICAgICAgICBkZWZhdWx0czogewogICAgICAgICAgICB0b3AgICAgICAgICAgOiAwLAogICAgICAgICAgICBib3R0b20gICAgICAgOiAwLAogICAgICAgICAgICBhbmltYXRpb24gICAgOiAnJywKICAgICAgICAgICAgY2xzaW5pdCAgICAgIDogJ3VrLXN0aWNreS1pbml0JywKICAgICAgICAgICAgY2xzYWN0aXZlICAgIDogJ3VrLWFjdGl2ZScsCiAgICAgICAgICAgIGdldFdpZHRoRnJvbSA6ICcnLAogICAgICAgICAgICBtZWRpYSAgICAgICAgOiBmYWxzZSwKICAgICAgICAgICAgdGFyZ2V0ICAgICAgIDogZmFsc2UKICAgICAgICB9LAoKICAgICAgICBpbml0OiBmdW5jdGlvbigpIHsKCiAgICAgICAgICAgIHZhciB3cmFwcGVyICA9ICQoJzxkaXYgY2xhc3M9InVrLXN0aWNreS1wbGFjZWhvbGRlciI+PC9kaXY+JykuY3NzKHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCcgOiB0aGlzLmVsZW1lbnQuY3NzKCdwb3NpdGlvbicpICE9ICdhYnNvbHV0ZScgPyB0aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKSA6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAnZmxvYXQnICA6IHRoaXMuZWxlbWVudC5jc3MoImZsb2F0IikgIT0gIm5vbmUiID8gdGhpcy5lbGVtZW50LmNzcygiZmxvYXQiKSA6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAnbWFyZ2luJyA6IHRoaXMuZWxlbWVudC5jc3MoIm1hcmdpbiIpCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHdyYXBwZXIgPSB0aGlzLmVsZW1lbnQuY3NzKCdtYXJnaW4nLCAwKS53cmFwKHdyYXBwZXIpLnBhcmVudCgpOwoKICAgICAgICAgICAgdGhpcy5zdGlja3kgPSB7CiAgICAgICAgICAgICAgICBvcHRpb25zICAgICAgOiB0aGlzLm9wdGlvbnMsCiAgICAgICAgICAgICAgICBlbGVtZW50ICAgICAgOiB0aGlzLmVsZW1lbnQsCiAgICAgICAgICAgICAgICBjdXJyZW50VG9wICAgOiBudWxsLAogICAgICAgICAgICAgICAgd3JhcHBlciAgICAgIDogd3JhcHBlciwKICAgICAgICAgICAgICAgIGluaXQgICAgICAgICA6IGZhbHNlLAogICAgICAgICAgICAgICAgZ2V0V2lkdGhGcm9tIDogdGhpcy5vcHRpb25zLmdldFdpZHRoRnJvbSB8fCB3cmFwcGVyLAogICAgICAgICAgICAgICAgcmVzZXQgICAgICAgIDogZnVuY3Rpb24oZm9yY2UpIHsKCiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsaXplID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jc3MoeyJwb3NpdGlvbiI6IiIsICJ0b3AiOiIiLCAid2lkdGgiOiIiLCAibGVmdCI6IiIsICJtYXJnaW4iOiIwIn0pOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoW3RoaXMub3B0aW9ucy5hbmltYXRpb24sICd1ay1hbmltYXRpb24tcmV2ZXJzZScsIHRoaXMub3B0aW9ucy5jbHNhY3RpdmVdLmpvaW4oJyAnKSk7CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUb3AgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGUgICAgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyk7CgoKICAgICAgICAgICAgICAgICAgICBpZiAoIWZvcmNlICYmIHRoaXMub3B0aW9ucy5hbmltYXRpb24gJiYgVUkuc3VwcG9ydC5hbmltYXRpb24pIHsKCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSA9IHRydWU7CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmFuaW1hdGlvbikub25lKFVJLnN1cHBvcnQuYW5pbWF0aW9uLmVuZCwgZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsaXplKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLndpZHRoKCk7IC8vIGZvcmNlIHJlZHJhdwoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZENsYXNzKHRoaXMub3B0aW9ucy5hbmltYXRpb24rJyAnKyd1ay1hbmltYXRpb24tcmV2ZXJzZScpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsaXplKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNoZWNrOiBmdW5jdGlvbigpIHsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5tZWRpYSkgewoKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKHR5cGVvZih0aGlzLm9wdGlvbnMubWVkaWEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdudW1iZXInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IHRoaXMub3B0aW9ucy5tZWRpYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3RyaW5nJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93Lm1hdGNoTWVkaWEgJiYgIXdpbmRvdy5tYXRjaE1lZGlhKHRoaXMub3B0aW9ucy5tZWRpYSkubWF0Y2hlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsVG9wICAgICAgPSAkd2luLnNjcm9sbFRvcCgpLAogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudEhlaWdodCA9ICRkb2MuaGVpZ2h0KCksCiAgICAgICAgICAgICAgICAgICAgICAgIGR3aCAgICAgICAgICAgID0gZG9jdW1lbnRIZWlnaHQgLSAkd2luLmhlaWdodCgpLAogICAgICAgICAgICAgICAgICAgICAgICBleHRyYSAgICAgICAgICA9IChzY3JvbGxUb3AgPiBkd2gpID8gZHdoIC0gc2Nyb2xsVG9wIDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFRvcCAgICAgPSB0aGlzLndyYXBwZXIub2Zmc2V0KCkudG9wLAogICAgICAgICAgICAgICAgICAgICAgICBldHNlICAgICAgICAgICA9IGVsZW1lbnRUb3AgLSB0aGlzLm9wdGlvbnMudG9wIC0gZXh0cmE7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiAoc2Nyb2xsVG9wICA+PSBldHNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHN0aWNrZWQucHVzaCh0aGlzLnN0aWNreSk7CiAgICAgICAgfSwKCiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2Nyb2xsZXIoKTsKICAgICAgICB9CiAgICB9KTsKCiAgICBmdW5jdGlvbiBzY3JvbGxlcigpIHsKCiAgICAgICAgaWYgKCFzdGlja2VkLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgICB2YXIgc2Nyb2xsVG9wICAgICAgID0gJHdpbi5zY3JvbGxUb3AoKSwKICAgICAgICAgICAgZG9jdW1lbnRIZWlnaHQgID0gJGRvYy5oZWlnaHQoKSwKICAgICAgICAgICAgZHdoICAgICAgICAgICAgID0gZG9jdW1lbnRIZWlnaHQgLSAkd2luLmhlaWdodCgpLAogICAgICAgICAgICBleHRyYSAgICAgICAgICAgPSAoc2Nyb2xsVG9wID4gZHdoKSA/IGR3aCAtIHNjcm9sbFRvcCA6IDAsCiAgICAgICAgICAgIGNscywgbmV3VG9wOwoKICAgICAgICBpZihzY3JvbGxUb3AgPCAwKSByZXR1cm47CgoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0aWNrZWQubGVuZ3RoOyBpKyspIHsKCiAgICAgICAgICAgIGlmICghc3RpY2tlZFtpXS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpIHx8IHN0aWNrZWRbaV0uYW5pbWF0ZSkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBzdGlja3kgPSBzdGlja2VkW2ldOwoKICAgICAgICAgICAgaWYgKCFzdGlja3kuY2hlY2soKSkgewoKICAgICAgICAgICAgICAgIGlmIChzdGlja3kuY3VycmVudFRvcCAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHN0aWNreS5yZXNldCgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICBpZiAoc3RpY2t5Lm9wdGlvbnMudG9wIDwgMCkgewogICAgICAgICAgICAgICAgICAgIG5ld1RvcCA9IDA7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG5ld1RvcCA9IGRvY3VtZW50SGVpZ2h0IC0gc3RpY2t5LmVsZW1lbnQub3V0ZXJIZWlnaHQoKSAtIHN0aWNreS5vcHRpb25zLnRvcCAtIHN0aWNreS5vcHRpb25zLmJvdHRvbSAtIHNjcm9sbFRvcCAtIGV4dHJhOwogICAgICAgICAgICAgICAgICAgIG5ld1RvcCA9IG5ld1RvcCA8IDAgPyBuZXdUb3AgKyBzdGlja3kub3B0aW9ucy50b3AgOiBzdGlja3kub3B0aW9ucy50b3A7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHN0aWNreS5jdXJyZW50VG9wICE9IG5ld1RvcCkgewoKICAgICAgICAgICAgICAgICAgICBzdGlja3kuZWxlbWVudC5jc3MoewogICAgICAgICAgICAgICAgICAgICAgICAicG9zaXRpb24iIDogImZpeGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgInRvcCIgICAgICA6IG5ld1RvcCwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIiAgICA6ICh0eXBlb2Ygc3RpY2t5LmdldFdpZHRoRnJvbSAhPT0gJ3VuZGVmaW5lZCcpID8gJChzdGlja3kuZ2V0V2lkdGhGcm9tKS53aWR0aCgpIDogc3RpY2t5LmVsZW1lbnQud2lkdGgoKSwKICAgICAgICAgICAgICAgICAgICAgICAgImxlZnQiICAgICA6IHN0aWNreS53cmFwcGVyLm9mZnNldCgpLmxlZnQKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGlja3kuaW5pdCkgewoKICAgICAgICAgICAgICAgICAgICAgICAgc3RpY2t5LmVsZW1lbnQuYWRkQ2xhc3Moc3RpY2t5Lm9wdGlvbnMuY2xzaW5pdCk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24uaGFzaCAmJiBzY3JvbGxUb3AgPiAwICYmIHN0aWNreS5vcHRpb25zLnRhcmdldCkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdGFyZ2V0ID0gJChsb2NhdGlvbi5oYXNoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHRhcmdldC5sZW5ndGgpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoZnVuY3Rpb24oJHRhcmdldCwgc3RpY2t5KXsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGlja3kuZWxlbWVudC53aWR0aCgpOyAvLyBmb3JjZSByZWRyYXcKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ICAgICAgID0gJHRhcmdldC5vZmZzZXQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhvZmZzZXQgICAgPSBvZmZzZXQudG9wICsgJHRhcmdldC5vdXRlckhlaWdodCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0aWNreU9mZnNldCA9IHN0aWNreS5lbGVtZW50Lm9mZnNldCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0aWNreUhlaWdodCA9IHN0aWNreS5lbGVtZW50Lm91dGVySGVpZ2h0KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RpY2t5TWF4T2Zmc2V0ID0gc3RpY2t5T2Zmc2V0LnRvcCArIHN0aWNreUhlaWdodDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RpY2t5T2Zmc2V0LnRvcCA8IG1heG9mZnNldCAmJiBvZmZzZXQudG9wIDwgc3RpY2t5TWF4T2Zmc2V0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9wID0gb2Zmc2V0LnRvcCAtIHN0aWNreUhlaWdodCAtIHN0aWNreS5vcHRpb25zLnRhcmdldDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgc2Nyb2xsVG9wKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkoJHRhcmdldCwgc3RpY2t5KSwgMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHN0aWNreS5lbGVtZW50LmFkZENsYXNzKHN0aWNreS5vcHRpb25zLmNsc2FjdGl2ZSk7CiAgICAgICAgICAgICAgICAgICAgc3RpY2t5LmVsZW1lbnQuY3NzKCdtYXJnaW4nLCAnJyk7CgogICAgICAgICAgICAgICAgICAgIGlmIChzdGlja3kub3B0aW9ucy5hbmltYXRpb24gJiYgc3RpY2t5LmluaXQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RpY2t5LmVsZW1lbnQuYWRkQ2xhc3Moc3RpY2t5Lm9wdGlvbnMuYW5pbWF0aW9uKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHN0aWNreS5jdXJyZW50VG9wID0gbmV3VG9wOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBzdGlja3kuaW5pdCA9IHRydWU7CiAgICAgICAgfQoKICAgIH0KCiAgICAvLyBzaG91bGQgYmUgbW9yZSBlZmZpY2llbnQgdGhhbiB1c2luZyAkd2luLnNjcm9sbChzY3JvbGxlcik6CiAgICAkZG9jLm9uKCd1ay1zY3JvbGwnLCBzY3JvbGxlcik7CiAgICAkd2luLm9uKCdyZXNpemUgb3JpZW50YXRpb25jaGFuZ2UnLCBVSS5VdGlscy5kZWJvdW5jZShmdW5jdGlvbigpIHsKCiAgICAgICAgaWYgKCFzdGlja2VkLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0aWNrZWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgc3RpY2tlZFtpXS5yZXNldCh0cnVlKTsKICAgICAgICB9CgogICAgICAgIHNjcm9sbGVyKCk7CiAgICB9LCAxMDApKTsKCiAgICAvLyBpbml0IGNvZGUKICAgIFVJLnJlYWR5KGZ1bmN0aW9uKGNvbnRleHQpIHsKCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpewoKICAgICAgICAgICAgJCgiW2RhdGEtdWstc3RpY2t5XSIsIGNvbnRleHQpLmVhY2goZnVuY3Rpb24oKXsKCiAgICAgICAgICAgICAgICB2YXIgJGVsZSA9ICQodGhpcyk7CgogICAgICAgICAgICAgICAgaWYoISRlbGUuZGF0YSgic3RpY2t5IikpIHsKICAgICAgICAgICAgICAgICAgICBVSS5zdGlja3koJGVsZSwgVUkuVXRpbHMub3B0aW9ucygkZWxlLmF0dHIoJ2RhdGEtdWstc3RpY2t5JykpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBzY3JvbGxlcigpOwogICAgICAgIH0sIDApOwogICAgfSk7CgogICAgcmV0dXJuICQuZm4udWtzdGlja3k7Cn0pOw==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sun, 09 Nov 2014 00:34:23 GMT",
                    "Content-Length": "8140",
                    "Date": "Sun, 09 Nov 2014 00:34:23 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}