{
    "url": "http://localhost:9999/stevenrskelton/sortable-table/examples/project-docs.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>document.location.href</b> and written to <b>document.location.href</b> via the following statements:<ul><li>var href = document.location.href;</li><li>href = href.substring(0, href.lastIndexOf('/examples/') + 10) + link;</li><li>document.location.href= href;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/stevenrskelton/sortable-table/examples/project-docs.html",
                "path": "/stevenrskelton/sortable-table/examples/project-docs.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9zdGV2ZW5yc2tlbHRvbi9zb3J0YWJsZS10YWJsZS9leGFtcGxlcy9wcm9qZWN0LWRvY3MuaHRtbCBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjc0NA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBTYXQsIDA4IE5vdiAyMDE0IDA1OjExOjM2IEdNVA0KTGFzdC1Nb2RpZmllZDogU2F0LCAwOCBOb3YgMjAxNCAwNToxMTozNiBHTVQNCg0KPGxpbmsgcmVsPSJpbXBvcnQiIGhyZWY9Ii4uLy4uL3BvbHltZXIvcG9seW1lci5odG1sIj4KPGxpbmsgcmVsPSJpbXBvcnQiIGhyZWY9Ii4uLy4uL2NvcmUtc2NhZmZvbGQvY29yZS1zY2FmZm9sZC5odG1sIj4KPGxpbmsgcmVsPSJpbXBvcnQiIGhyZWY9Ii4uLy4uL2NvcmUtbWVudS9jb3JlLW1lbnUuaHRtbCI+CjxsaW5rIHJlbD0iaW1wb3J0IiBocmVmPSIuLi8uLi9jb3JlLW1lbnUvY29yZS1zdWJtZW51Lmh0bWwiPgo8bGluayByZWw9ImltcG9ydCIgaHJlZj0iLi4vLi4vY29yZS1pdGVtL2NvcmUtaXRlbS5odG1sIj4KCjxwb2x5bWVyLWVsZW1lbnQgbmFtZT0icHJvamVjdC1kb2NzIiBleHRlbmRzPSJib2R5IiBhdHRyaWJ1dGVzPSJyYXciPgo8c3R5bGUgc2hpbS1zaGFkb3dkb20+CgkjZHJhd2VyIGNvcmUtdG9vbGJhciB7CgkJYmFja2dyb3VuZC1jb2xvcjogI0NGRDhEQzsKCQljb2xvcjogYmxhY2s7Cgl9Cgl0YWJsZS5kb2NzIHsKCQlib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOwoJCWJhY2tncm91bmQtY29sb3I6IHdoaXRlOwoJfQoJdGFibGUuZG9jcyB0ZCwgCgl0YWJsZS5kb2NzIHRoIHsKCQlwYWRkaW5nOiA2cHggMTNweDsKCQlib3JkZXI6IDFweCBzb2xpZCAjREREOwoJfQoJdGFibGUuZG9jcyBjb2RlIHsKCQlwYWRkaW5nOiAwLjJlbSAwcHg7CgkJbWFyZ2luOiAwcHg7CgkJZm9udC1zaXplOiA4NSU7CgkJYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjA0KTsKCQlib3JkZXItcmFkaXVzOiAzcHg7CgkJZm9udDogMTJweCBDb25zb2xhcywiTGliZXJhdGlvbiBNb25vIixNZW5sbyxDb3VyaWVyLG1vbm9zcGFjZTsKCX0KPC9zdHlsZT4KPHRlbXBsYXRlPgoJPGNvcmUtc2NhZmZvbGQ+CgkJPGNvcmUtaGVhZGVyLXBhbmVsIG5hdmlnYXRpb24gZmxleCBtb2RlPSJzZWFtZWQiPgoJCQk8Y29yZS10b29sYmFyPjxkaXYgc3R5bGU9IndpZHRoOjEwMCU7cGFkZGluZy1yaWdodDoyMHB4O3RleHQtYWxpZ246Y2VudGVyOyI+PHN0cm9uZz4mbHQ7c29ydGFibGUtdGFibGUmZ3Q7PC9zdHJvbmc+PGJyPkRvY3VtZW50YXRpb248L2Rpdj48L2NvcmUtdG9vbGJhcj4KCQkJPGNvcmUtbWVudSBvbi1jb3JlLXNlbGVjdD0ie3tjaGFuZ2VQYWdlfX0iIGlkPSJkb2NtZW51Ij4KCQkJCTxjb3JlLWl0ZW0gbGluaz0iaW5kZXguaHRtbCIgbGFiZWw9IkdldHRpbmcgU3RhcnRlZCIgaWNvbj0iaGVscCI+PC9jb3JlLWl0ZW0+CgkJCQk8Y29yZS1zdWJtZW51IG9uLXRhcD0ie3tzdWJtZW51Y2xpY2t9fSIgbGFiZWw9IlRoZW1lcyIgaWNvbj0iZHJpdmUtZm9ybSI+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJ0aGVtZXMvaW5kZXguaHRtbCIgbGFiZWw9IkJhc2ljIFNldHVwIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InRoZW1lcy9ib290c3RyYXAuaHRtbCIgbGFiZWw9IkJvb3RzdHJhcCI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJ0aGVtZXMvZXh0anM0Lmh0bWwiIGxhYmVsPSJFeHRKUyA0Ij48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJBbHQuIFRoZW1lcyIgaWNvbj0iZHJpdmUtc3ByZWFkc2hlZXQiPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0idGhlbWVzL2FsdC5odG1sIiBsYWJlbD0iQmFzaWMgU2V0dXAiPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0idGhlbWVzL2FydGljbGUuaHRtbCIgbGFiZWw9IkFydGljbGUiPjwvY29yZS1pdGVtPgoJCQkJPC9jb3JlLXN1Ym1lbnU+CgkJCQk8Y29yZS1zdWJtZW51IG9uLXRhcD0ie3tzdWJtZW51Y2xpY2t9fSIgbGFiZWw9IlRlbXBsYXRlcyIgaWNvbj0iZHJpdmUtZHJhd2luZyI+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJ0ZW1wbGF0ZXMuaHRtbCIgbGFiZWw9IlZhcmlhYmxlcyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJjc3MuaHRtbCIgbGFiZWw9IkNTUyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJ0YWJsZS10ZW1wbGF0ZXMuaHRtbCIgbGFiZWw9IkhlYWRlciwgRm9vdGVyIFRlbXBsYXRlcyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJyb3ctdGVtcGxhdGVzLmh0bWwiIGxhYmVsPSJSb3cgVGVtcGxhdGVzIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9ImRvbS1lbGVtZW50cy5odG1sIiBsYWJlbD0iRE9NIEVsZW1lbnRzIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9ImR5bmFtaWMtY29sdW1ucy5odG1sIiBsYWJlbD0iRHluYW1pYyBDb2x1bW5zIj48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJEYXRhIiBpY29uPSJkcml2ZS10ZXh0Ij4KCQkJCQk8Y29yZS1pdGVtIGxpbms9ImRhdGEtZm9ybWF0cy5odG1sIiBsYWJlbD0iSW5wdXQgRm9ybWF0cyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJwb2x5bWVyLWZpbHRlcnMuaHRtbCIgbGFiZWw9IkZpbHRlcnMsIEZvcm1hdHRpbmciPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0iYXV0b2dlbmVyYXRlZC1jb2x1bW5zLmh0bWwiIGxhYmVsPSJBdXRvIENvbHVtbnMiPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0icmVmcmVzaGluZy1kYXRhLmh0bWwiIGxhYmVsPSJSZWZyZXNoaW5nIERhdGEiPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0ibGFyZ2UtZGF0YXNldC5odG1sIiBsYWJlbD0iTGFyZ2VyIERhdGFzZXRzIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9Im5lc3RlZC10YWJsZXMuaHRtbCIgbGFiZWw9Ik5lc3RpbmcgVGFibGVzIGluIENlbGxzIj48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJTZXJ2ZXItU2lkZSIgaWNvbj0iY2xvdWQtY2lyY2xlIj4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InNlcnZlcnNpZGUvaW5kZXguaHRtbCIgbGFiZWw9IkFQSSBTdXBwb3J0Ij48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InNlcnZlcnNpZGUvZGF0YXRhYmxlcy1hamF4Lmh0bWwiIGxhYmVsPSJEYXRhVGFibGVzLm5ldCBBSkFYIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InNlcnZlcnNpZGUvZXh0anMtYWpheC5odG1sIiBsYWJlbD0iRXh0SlMgUkVTVCBBSkFYIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InNlcnZlcnNpZGUvZmxpY2tyLWpzb25wLmh0bWwiIGxhYmVsPSJKU09OUCI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJzZXJ2ZXJzaWRlL2luZGV4ZWRkYi1mcnVpdC5odG1sIiBsYWJlbD0iSW5kZXhlZERCIj48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJGZWF0dXJlcyIgaWNvbj0iZHJpdmUta2VlcCI+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJmZWF0dXJlcy5odG1sIiBsYWJlbD0iSW5kZXgiPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0icm93LWVkaXRvci5odG1sIiBsYWJlbD0iUm93IEVkaXRvciI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJhcmdzLmh0bWwiIGxhYmVsPSJBZGRpdGlvbmFsIEFyZ3VtZW50cyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJzZWxlY3RlZC1yb3dzLmh0bWwiIGxhYmVsPSJTZWxlY3RlZCBSb3dzIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InBhZ2luZy5odG1sIiBsYWJlbD0iUGFnaW5nLCBUb3AgTiBSb3dzIj48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPCEtLQoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJEZW1vcyIgaWNvbj0ibGF1bmNoIj4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJLS0+CgkJCTwvY29yZS1tZW51PgoJCTwvY29yZS1oZWFkZXItcGFuZWw+CgoJCTx0ZW1wbGF0ZSBpZj0ie3tyYXd9fSI+CgkJCTxzdHlsZT4KCQkJCSNvdXRlckNvbnRhaW5lciBjb3JlLXRvb2xiYXIgeyBkaXNwbGF5OiBub25lOyB9CgkJCTwvc3R5bGU+CgkJPC90ZW1wbGF0ZT4KCQk8dGVtcGxhdGUgaWY9Int7IXJhd319Ij4KCQkJPGRpdiB0b29sIGZsZXg+PGNvbnRlbnQgc2VsZWN0PSJoMSI+PC9jb250ZW50PjwvZGl2PgoJCQk8ZGl2IHRvb2wgc3R5bGU9ImZsb2F0OnJpZ2h0Ij4KCQkJCTxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9zdGV2ZW5yc2tlbHRvbi9zb3J0YWJsZS10YWJsZSIgdGl0bGU9IlZpZXcgb24gR2l0SHViIiB0YXJnZXQ9Il9ibGFuayI+CgkJCQkJPGltZyBzcmM9IkdpdEh1Yi1NYXJrLTY0cHgucG5nIiBhbHQ9IkdpdEh1YiIgaGVpZ2h0PSI1MCI+CgkJCQk8L2E+CgkJCTwvZGl2PgoJCTwvdGVtcGxhdGU+CgoJCTxkaXYgY2xhc3M9ImNvbnRlbnQiIHN0eWxlPSJ7eyFyYXcgPyAnbWFyZ2luOjE1cHg7JyA6ICcnfX0iPjxjb250ZW50PjwvY29udGVudD48L2Rpdj4KCgk8L2NvcmUtc2NhZmZvbGQ+CjwvdGVtcGxhdGU+CjxzY3JpcHQ+CglQb2x5bWVyKHsKCQlyYXc6IGZhbHNlLAoJCWluaXQ6IGZhbHNlLAoJCWNoYW5nZVBhZ2U6IGZ1bmN0aW9uKGUsb2JqKXsKCQkJdmFyIGxpbmsgPSBvYmouaXRlbS5nZXRBdHRyaWJ1dGUoJ2xpbmsnKTsKCQkJaWYodGhpcy5pbml0ICYmIG9iai5pc1NlbGVjdGVkICYmIGxpbmspewoJCQkJdmFyIGhyZWYgPSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmOwoJCQkJaHJlZiA9IGhyZWYuc3Vic3RyaW5nKDAsIGhyZWYubGFzdEluZGV4T2YoJy9leGFtcGxlcy8nKSArIDEwKSArIGxpbms7CgkJCQlpZihocmVmICE9PSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmKSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmPSBocmVmOwoJCQl9CgkJfSwKCQlzdWJtZW51Y2xpY2s6IGZ1bmN0aW9uKGUsIG9iail7CgkJCXZhciBocmVmID0gdGhpcy5nZXRIcmVmKCk7CgkJCWlmKCFlLmN1cnJlbnRUYXJnZXQub3BlbmVkKXsKCQkJCXZhciBmID0gdGhpcy50cnlTZWxlY3RJdGVtKGhyZWYpOwoJCQkJW10uZm9yRWFjaC5jYWxsKGUuY3VycmVudFRhcmdldC5jaGlsZHJlbiwgZik7CgkJCX0KCQkJaWYoW10uZXZlcnkuY2FsbCh0aGlzLiQuZG9jbWVudS5xdWVyeVNlbGVjdG9yQWxsKCcqJyksIGZ1bmN0aW9uKGVsZW1lbnQpeyByZXR1cm4gIWVsZW1lbnQub3BlbmVkOyB9KSl7CgkJCQl2YXIgcCA9IGUuY3VycmVudFRhcmdldC5wYXJlbnRFbGVtZW50OwoJCQkJcC5zZWxlY3RlZCA9IG51bGw7CgkJCQkvKgoJCQkJZm9yKHZhciBpPTA7aTxwLmNoaWxkcmVuLmxlbmd0aDtpKyspewoJCQkJCWlmKCFbXS5ldmVyeS5jYWxsKHAuY2hpbGRyZW5baV0uY2hpbGRyZW4sIGZ1bmN0aW9uKGUyKXsgcmV0dXJuIGUyLmdldEF0dHJpYnV0ZSgnbGluaycpICE9PSBocmVmOyB9KSl7CgkJCQkJCWZvcih2YXIgaj0wO2o8cC5jaGlsZHJlbltpXS5jaGlsZHJlbi5sZW5ndGg7aisrKXsKCQkJCQkJCWlmKHAuY2hpbGRyZW5baV0uY2hpbGRyZW5bal0uZ2V0QXR0cmlidXRlKCdsaW5rJyk9PT1ocmVmKXsKCQkJCQkJCQlwLmNoaWxkcmVuW2ldLnNlbGVjdGVkID0gajsKCQkJCQkJCQlwLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IHRydWU7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJLy9wLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IHRydWU7CgkJCQkJCS8vcC5zZWxlY3RlZCA9IGk7CgkJCQkJfWVsc2V7CgkJCQkJCS8vcC5jaGlsZHJlbltpXS51bnNlbGVjdEFsbEl0ZW1zKCk7CgkJCQkJCXAuY2hpbGRyZW5baV0uYWN0aXZlID0gZmFsc2U7CgkJCQkJfQoJCQkJfSovCgkJCX0KCQl9LAoJCXJlYWR5OiBmdW5jdGlvbigpewoJCQl2YXIgaHJlZiA9IHRoaXMuZ2V0SHJlZigpOwoJCQl2YXIgZiA9IHRoaXMudHJ5U2VsZWN0SXRlbShocmVmKTsKCQkJW10uZm9yRWFjaC5jYWxsKHRoaXMuJC5kb2NtZW51LnF1ZXJ5U2VsZWN0b3JBbGwoJyonKSwgZik7CgkJCXZhciBzZWxmID0gdGhpczsKCQkJdGhpcy5hc3luYyhmdW5jdGlvbigpeyBzZWxmLmluaXQgPSB0cnVlOyB9KTsKCQl9LAoJCWdldEhyZWY6IGZ1bmN0aW9uKCl7CgkJCXZhciBocmVmID0gZG9jdW1lbnQubG9jYXRpb24uaHJlZjsKCQkJaHJlZiA9IGhyZWYuc3Vic3RyaW5nKGhyZWYubGFzdEluZGV4T2YoJy9leGFtcGxlcy8nKSArIDEwKTsKCQkJaWYoaHJlZi5sZW5ndGg9PTApIGhyZWYgPSAnaW5kZXguaHRtbCc7CgkJCXJldHVybiBocmVmOwoJCX0sCgkJdHJ5U2VsZWN0SXRlbTogZnVuY3Rpb24oaHJlZil7CgkJCXJldHVybiBmdW5jdGlvbihlbGVtZW50KSB7CgkJCQlpZihlbGVtZW50LmdldEF0dHJpYnV0ZSgnbGluaycpID09PSBocmVmKXsKCQkJCQl3aGlsZShlbGVtZW50Lm5vZGVOYW1lID09PSAnQ09SRS1JVEVNJyB8fCBlbGVtZW50Lm5vZGVOYW1lID09PSAnQ09SRS1TVUJNRU5VJyl7CgkJCQkJCXZhciBwID0gZWxlbWVudC5wYXJlbnRFbGVtZW50OwoJCQkJCQlmb3IodmFyIGk9MDtpPHAuY2hpbGRyZW4ubGVuZ3RoO2krKyl7CgkJCQkJCQlpZihwLmNoaWxkcmVuW2ldPT09ZWxlbWVudCkgcC5zZWxlY3RlZCA9IGk7CgkJCQkJCX0KCQkJCQkJaWYoIXAub3BlbmVkKSBwLm9wZW5lZCA9IHRydWU7CgkJCQkJCWVsZW1lbnQgPSBwOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCX0pOwo8L3NjcmlwdD4KPC9wb2x5bWVyLWVsZW1lbnQ+",
                "body": "PGxpbmsgcmVsPSJpbXBvcnQiIGhyZWY9Ii4uLy4uL3BvbHltZXIvcG9seW1lci5odG1sIj4KPGxpbmsgcmVsPSJpbXBvcnQiIGhyZWY9Ii4uLy4uL2NvcmUtc2NhZmZvbGQvY29yZS1zY2FmZm9sZC5odG1sIj4KPGxpbmsgcmVsPSJpbXBvcnQiIGhyZWY9Ii4uLy4uL2NvcmUtbWVudS9jb3JlLW1lbnUuaHRtbCI+CjxsaW5rIHJlbD0iaW1wb3J0IiBocmVmPSIuLi8uLi9jb3JlLW1lbnUvY29yZS1zdWJtZW51Lmh0bWwiPgo8bGluayByZWw9ImltcG9ydCIgaHJlZj0iLi4vLi4vY29yZS1pdGVtL2NvcmUtaXRlbS5odG1sIj4KCjxwb2x5bWVyLWVsZW1lbnQgbmFtZT0icHJvamVjdC1kb2NzIiBleHRlbmRzPSJib2R5IiBhdHRyaWJ1dGVzPSJyYXciPgo8c3R5bGUgc2hpbS1zaGFkb3dkb20+CgkjZHJhd2VyIGNvcmUtdG9vbGJhciB7CgkJYmFja2dyb3VuZC1jb2xvcjogI0NGRDhEQzsKCQljb2xvcjogYmxhY2s7Cgl9Cgl0YWJsZS5kb2NzIHsKCQlib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOwoJCWJhY2tncm91bmQtY29sb3I6IHdoaXRlOwoJfQoJdGFibGUuZG9jcyB0ZCwgCgl0YWJsZS5kb2NzIHRoIHsKCQlwYWRkaW5nOiA2cHggMTNweDsKCQlib3JkZXI6IDFweCBzb2xpZCAjREREOwoJfQoJdGFibGUuZG9jcyBjb2RlIHsKCQlwYWRkaW5nOiAwLjJlbSAwcHg7CgkJbWFyZ2luOiAwcHg7CgkJZm9udC1zaXplOiA4NSU7CgkJYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjA0KTsKCQlib3JkZXItcmFkaXVzOiAzcHg7CgkJZm9udDogMTJweCBDb25zb2xhcywiTGliZXJhdGlvbiBNb25vIixNZW5sbyxDb3VyaWVyLG1vbm9zcGFjZTsKCX0KPC9zdHlsZT4KPHRlbXBsYXRlPgoJPGNvcmUtc2NhZmZvbGQ+CgkJPGNvcmUtaGVhZGVyLXBhbmVsIG5hdmlnYXRpb24gZmxleCBtb2RlPSJzZWFtZWQiPgoJCQk8Y29yZS10b29sYmFyPjxkaXYgc3R5bGU9IndpZHRoOjEwMCU7cGFkZGluZy1yaWdodDoyMHB4O3RleHQtYWxpZ246Y2VudGVyOyI+PHN0cm9uZz4mbHQ7c29ydGFibGUtdGFibGUmZ3Q7PC9zdHJvbmc+PGJyPkRvY3VtZW50YXRpb248L2Rpdj48L2NvcmUtdG9vbGJhcj4KCQkJPGNvcmUtbWVudSBvbi1jb3JlLXNlbGVjdD0ie3tjaGFuZ2VQYWdlfX0iIGlkPSJkb2NtZW51Ij4KCQkJCTxjb3JlLWl0ZW0gbGluaz0iaW5kZXguaHRtbCIgbGFiZWw9IkdldHRpbmcgU3RhcnRlZCIgaWNvbj0iaGVscCI+PC9jb3JlLWl0ZW0+CgkJCQk8Y29yZS1zdWJtZW51IG9uLXRhcD0ie3tzdWJtZW51Y2xpY2t9fSIgbGFiZWw9IlRoZW1lcyIgaWNvbj0iZHJpdmUtZm9ybSI+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJ0aGVtZXMvaW5kZXguaHRtbCIgbGFiZWw9IkJhc2ljIFNldHVwIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InRoZW1lcy9ib290c3RyYXAuaHRtbCIgbGFiZWw9IkJvb3RzdHJhcCI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJ0aGVtZXMvZXh0anM0Lmh0bWwiIGxhYmVsPSJFeHRKUyA0Ij48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJBbHQuIFRoZW1lcyIgaWNvbj0iZHJpdmUtc3ByZWFkc2hlZXQiPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0idGhlbWVzL2FsdC5odG1sIiBsYWJlbD0iQmFzaWMgU2V0dXAiPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0idGhlbWVzL2FydGljbGUuaHRtbCIgbGFiZWw9IkFydGljbGUiPjwvY29yZS1pdGVtPgoJCQkJPC9jb3JlLXN1Ym1lbnU+CgkJCQk8Y29yZS1zdWJtZW51IG9uLXRhcD0ie3tzdWJtZW51Y2xpY2t9fSIgbGFiZWw9IlRlbXBsYXRlcyIgaWNvbj0iZHJpdmUtZHJhd2luZyI+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJ0ZW1wbGF0ZXMuaHRtbCIgbGFiZWw9IlZhcmlhYmxlcyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJjc3MuaHRtbCIgbGFiZWw9IkNTUyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJ0YWJsZS10ZW1wbGF0ZXMuaHRtbCIgbGFiZWw9IkhlYWRlciwgRm9vdGVyIFRlbXBsYXRlcyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJyb3ctdGVtcGxhdGVzLmh0bWwiIGxhYmVsPSJSb3cgVGVtcGxhdGVzIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9ImRvbS1lbGVtZW50cy5odG1sIiBsYWJlbD0iRE9NIEVsZW1lbnRzIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9ImR5bmFtaWMtY29sdW1ucy5odG1sIiBsYWJlbD0iRHluYW1pYyBDb2x1bW5zIj48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJEYXRhIiBpY29uPSJkcml2ZS10ZXh0Ij4KCQkJCQk8Y29yZS1pdGVtIGxpbms9ImRhdGEtZm9ybWF0cy5odG1sIiBsYWJlbD0iSW5wdXQgRm9ybWF0cyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJwb2x5bWVyLWZpbHRlcnMuaHRtbCIgbGFiZWw9IkZpbHRlcnMsIEZvcm1hdHRpbmciPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0iYXV0b2dlbmVyYXRlZC1jb2x1bW5zLmh0bWwiIGxhYmVsPSJBdXRvIENvbHVtbnMiPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0icmVmcmVzaGluZy1kYXRhLmh0bWwiIGxhYmVsPSJSZWZyZXNoaW5nIERhdGEiPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0ibGFyZ2UtZGF0YXNldC5odG1sIiBsYWJlbD0iTGFyZ2VyIERhdGFzZXRzIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9Im5lc3RlZC10YWJsZXMuaHRtbCIgbGFiZWw9Ik5lc3RpbmcgVGFibGVzIGluIENlbGxzIj48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJTZXJ2ZXItU2lkZSIgaWNvbj0iY2xvdWQtY2lyY2xlIj4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InNlcnZlcnNpZGUvaW5kZXguaHRtbCIgbGFiZWw9IkFQSSBTdXBwb3J0Ij48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InNlcnZlcnNpZGUvZGF0YXRhYmxlcy1hamF4Lmh0bWwiIGxhYmVsPSJEYXRhVGFibGVzLm5ldCBBSkFYIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InNlcnZlcnNpZGUvZXh0anMtYWpheC5odG1sIiBsYWJlbD0iRXh0SlMgUkVTVCBBSkFYIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InNlcnZlcnNpZGUvZmxpY2tyLWpzb25wLmh0bWwiIGxhYmVsPSJKU09OUCI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJzZXJ2ZXJzaWRlL2luZGV4ZWRkYi1mcnVpdC5odG1sIiBsYWJlbD0iSW5kZXhlZERCIj48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJGZWF0dXJlcyIgaWNvbj0iZHJpdmUta2VlcCI+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJmZWF0dXJlcy5odG1sIiBsYWJlbD0iSW5kZXgiPjwvY29yZS1pdGVtPgoJCQkJCTxjb3JlLWl0ZW0gbGluaz0icm93LWVkaXRvci5odG1sIiBsYWJlbD0iUm93IEVkaXRvciI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJhcmdzLmh0bWwiIGxhYmVsPSJBZGRpdGlvbmFsIEFyZ3VtZW50cyI+PC9jb3JlLWl0ZW0+CgkJCQkJPGNvcmUtaXRlbSBsaW5rPSJzZWxlY3RlZC1yb3dzLmh0bWwiIGxhYmVsPSJTZWxlY3RlZCBSb3dzIj48L2NvcmUtaXRlbT4KCQkJCQk8Y29yZS1pdGVtIGxpbms9InBhZ2luZy5odG1sIiBsYWJlbD0iUGFnaW5nLCBUb3AgTiBSb3dzIj48L2NvcmUtaXRlbT4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJPCEtLQoJCQkJPGNvcmUtc3VibWVudSBvbi10YXA9Int7c3VibWVudWNsaWNrfX0iIGxhYmVsPSJEZW1vcyIgaWNvbj0ibGF1bmNoIj4KCQkJCTwvY29yZS1zdWJtZW51PgoJCQkJLS0+CgkJCTwvY29yZS1tZW51PgoJCTwvY29yZS1oZWFkZXItcGFuZWw+CgoJCTx0ZW1wbGF0ZSBpZj0ie3tyYXd9fSI+CgkJCTxzdHlsZT4KCQkJCSNvdXRlckNvbnRhaW5lciBjb3JlLXRvb2xiYXIgeyBkaXNwbGF5OiBub25lOyB9CgkJCTwvc3R5bGU+CgkJPC90ZW1wbGF0ZT4KCQk8dGVtcGxhdGUgaWY9Int7IXJhd319Ij4KCQkJPGRpdiB0b29sIGZsZXg+PGNvbnRlbnQgc2VsZWN0PSJoMSI+PC9jb250ZW50PjwvZGl2PgoJCQk8ZGl2IHRvb2wgc3R5bGU9ImZsb2F0OnJpZ2h0Ij4KCQkJCTxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9zdGV2ZW5yc2tlbHRvbi9zb3J0YWJsZS10YWJsZSIgdGl0bGU9IlZpZXcgb24gR2l0SHViIiB0YXJnZXQ9Il9ibGFuayI+CgkJCQkJPGltZyBzcmM9IkdpdEh1Yi1NYXJrLTY0cHgucG5nIiBhbHQ9IkdpdEh1YiIgaGVpZ2h0PSI1MCI+CgkJCQk8L2E+CgkJCTwvZGl2PgoJCTwvdGVtcGxhdGU+CgoJCTxkaXYgY2xhc3M9ImNvbnRlbnQiIHN0eWxlPSJ7eyFyYXcgPyAnbWFyZ2luOjE1cHg7JyA6ICcnfX0iPjxjb250ZW50PjwvY29udGVudD48L2Rpdj4KCgk8L2NvcmUtc2NhZmZvbGQ+CjwvdGVtcGxhdGU+CjxzY3JpcHQ+CglQb2x5bWVyKHsKCQlyYXc6IGZhbHNlLAoJCWluaXQ6IGZhbHNlLAoJCWNoYW5nZVBhZ2U6IGZ1bmN0aW9uKGUsb2JqKXsKCQkJdmFyIGxpbmsgPSBvYmouaXRlbS5nZXRBdHRyaWJ1dGUoJ2xpbmsnKTsKCQkJaWYodGhpcy5pbml0ICYmIG9iai5pc1NlbGVjdGVkICYmIGxpbmspewoJCQkJdmFyIGhyZWYgPSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmOwoJCQkJaHJlZiA9IGhyZWYuc3Vic3RyaW5nKDAsIGhyZWYubGFzdEluZGV4T2YoJy9leGFtcGxlcy8nKSArIDEwKSArIGxpbms7CgkJCQlpZihocmVmICE9PSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmKSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmPSBocmVmOwoJCQl9CgkJfSwKCQlzdWJtZW51Y2xpY2s6IGZ1bmN0aW9uKGUsIG9iail7CgkJCXZhciBocmVmID0gdGhpcy5nZXRIcmVmKCk7CgkJCWlmKCFlLmN1cnJlbnRUYXJnZXQub3BlbmVkKXsKCQkJCXZhciBmID0gdGhpcy50cnlTZWxlY3RJdGVtKGhyZWYpOwoJCQkJW10uZm9yRWFjaC5jYWxsKGUuY3VycmVudFRhcmdldC5jaGlsZHJlbiwgZik7CgkJCX0KCQkJaWYoW10uZXZlcnkuY2FsbCh0aGlzLiQuZG9jbWVudS5xdWVyeVNlbGVjdG9yQWxsKCcqJyksIGZ1bmN0aW9uKGVsZW1lbnQpeyByZXR1cm4gIWVsZW1lbnQub3BlbmVkOyB9KSl7CgkJCQl2YXIgcCA9IGUuY3VycmVudFRhcmdldC5wYXJlbnRFbGVtZW50OwoJCQkJcC5zZWxlY3RlZCA9IG51bGw7CgkJCQkvKgoJCQkJZm9yKHZhciBpPTA7aTxwLmNoaWxkcmVuLmxlbmd0aDtpKyspewoJCQkJCWlmKCFbXS5ldmVyeS5jYWxsKHAuY2hpbGRyZW5baV0uY2hpbGRyZW4sIGZ1bmN0aW9uKGUyKXsgcmV0dXJuIGUyLmdldEF0dHJpYnV0ZSgnbGluaycpICE9PSBocmVmOyB9KSl7CgkJCQkJCWZvcih2YXIgaj0wO2o8cC5jaGlsZHJlbltpXS5jaGlsZHJlbi5sZW5ndGg7aisrKXsKCQkJCQkJCWlmKHAuY2hpbGRyZW5baV0uY2hpbGRyZW5bal0uZ2V0QXR0cmlidXRlKCdsaW5rJyk9PT1ocmVmKXsKCQkJCQkJCQlwLmNoaWxkcmVuW2ldLnNlbGVjdGVkID0gajsKCQkJCQkJCQlwLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IHRydWU7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJLy9wLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IHRydWU7CgkJCQkJCS8vcC5zZWxlY3RlZCA9IGk7CgkJCQkJfWVsc2V7CgkJCQkJCS8vcC5jaGlsZHJlbltpXS51bnNlbGVjdEFsbEl0ZW1zKCk7CgkJCQkJCXAuY2hpbGRyZW5baV0uYWN0aXZlID0gZmFsc2U7CgkJCQkJfQoJCQkJfSovCgkJCX0KCQl9LAoJCXJlYWR5OiBmdW5jdGlvbigpewoJCQl2YXIgaHJlZiA9IHRoaXMuZ2V0SHJlZigpOwoJCQl2YXIgZiA9IHRoaXMudHJ5U2VsZWN0SXRlbShocmVmKTsKCQkJW10uZm9yRWFjaC5jYWxsKHRoaXMuJC5kb2NtZW51LnF1ZXJ5U2VsZWN0b3JBbGwoJyonKSwgZik7CgkJCXZhciBzZWxmID0gdGhpczsKCQkJdGhpcy5hc3luYyhmdW5jdGlvbigpeyBzZWxmLmluaXQgPSB0cnVlOyB9KTsKCQl9LAoJCWdldEhyZWY6IGZ1bmN0aW9uKCl7CgkJCXZhciBocmVmID0gZG9jdW1lbnQubG9jYXRpb24uaHJlZjsKCQkJaHJlZiA9IGhyZWYuc3Vic3RyaW5nKGhyZWYubGFzdEluZGV4T2YoJy9leGFtcGxlcy8nKSArIDEwKTsKCQkJaWYoaHJlZi5sZW5ndGg9PTApIGhyZWYgPSAnaW5kZXguaHRtbCc7CgkJCXJldHVybiBocmVmOwoJCX0sCgkJdHJ5U2VsZWN0SXRlbTogZnVuY3Rpb24oaHJlZil7CgkJCXJldHVybiBmdW5jdGlvbihlbGVtZW50KSB7CgkJCQlpZihlbGVtZW50LmdldEF0dHJpYnV0ZSgnbGluaycpID09PSBocmVmKXsKCQkJCQl3aGlsZShlbGVtZW50Lm5vZGVOYW1lID09PSAnQ09SRS1JVEVNJyB8fCBlbGVtZW50Lm5vZGVOYW1lID09PSAnQ09SRS1TVUJNRU5VJyl7CgkJCQkJCXZhciBwID0gZWxlbWVudC5wYXJlbnRFbGVtZW50OwoJCQkJCQlmb3IodmFyIGk9MDtpPHAuY2hpbGRyZW4ubGVuZ3RoO2krKyl7CgkJCQkJCQlpZihwLmNoaWxkcmVuW2ldPT09ZWxlbWVudCkgcC5zZWxlY3RlZCA9IGk7CgkJCQkJCX0KCQkJCQkJaWYoIXAub3BlbmVkKSBwLm9wZW5lZCA9IHRydWU7CgkJCQkJCWVsZW1lbnQgPSBwOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCX0pOwo8L3NjcmlwdD4KPC9wb2x5bWVyLWVsZW1lbnQ+",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 05:11:36 GMT",
                    "Content-Length": "6744",
                    "Date": "Sat, 08 Nov 2014 05:11:36 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}