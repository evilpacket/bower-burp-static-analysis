{
    "url": "http://localhost:9999/DataTables/DataTables/media/unit_testing/unit_test.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "HTML5 storage manipulation (DOM-based)",
    "issueType": 5246720,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based HTML5 storage manipulation occurs when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and stores this data in the HTML5 storage of the web browser (either localStorage or sessionStorage). An attacker may be able to use this behavior to construct a URL which, if visited by another application user, will cause the user's browser to store attacker-controllable data.<br><br>This behavior does not in itself constitute a security vulnerability. However, if the application later reads the data back from storage and processes it in an unsafe way, then an attacker may be able to leverage the storage mechanism to deliver other DOM-based attacks, such as cross-site scripting and JavaScript injection.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>You should also review the ways in which the wider application uses data that is retrieved from HTML5 storage. If the data is never handled in an unsafe manner, then this behavior may not constitute any kind of vulnerability.<br><br>The most effective way to avoid DOM-based HTML5 storage manipulation is not to place in HTML5 storage any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored.",
    "issueDetail": "The application may be vulnerable to DOM-based HTML5 storage manipulation. Data is read from <b>window.location.pathname</b> and written to <b>localStorage.setItem()</b> via the following statement:<ul><li>localStorage.setItem( 'DataTables_'+s.sInstance+'_'+window.location.pathname, null );</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/DataTables/DataTables/media/unit_testing/unit_test.js",
                "path": "/DataTables/DataTables/media/unit_testing/unit_test.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9EYXRhVGFibGVzL0RhdGFUYWJsZXMvbWVkaWEvdW5pdF90ZXN0aW5nL3VuaXRfdGVzdC5qcyBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODY4Nw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAyMDowNjoxMCBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMjA6MDY6MDkgR01UDQoNCi8qCiAqIEZpbGU6ICAgICAgICB1bml0X3Rlc3QuanMKICogVmVyc2lvbjogICAgIDAuMC4xCiAqIENWUzogICAgICAgICAkSWQkCiAqIERlc2NyaXB0aW9uOiBVbml0IHRlc3QgZnJhbWV3b3JrCiAqIEF1dGhvcjogICAgICBBbGxhbiBKYXJkaW5lICh3d3cuc3ByeW1lZGlhLmNvLnVrKQogKiBDcmVhdGVkOiAgICAgU3VuIE1hciAgOCAyMjowMjo0OSBHTVQgMjAwOQogKiBNb2RpZmllZDogICAgJERhdGUkIGJ5ICRBdXRob3IkCiAqIExhbmd1YWdlOiAgICBKYXZhc2NyaXB0CiAqIExpY2Vuc2U6ICAgICBHUEwgdjIgb3IgQlNEIDMgcG9pbnQgc3R5bGUKICogUHJvamVjdDogICAgIERhdGFUYWJsZXMKICogQ29udGFjdDogICAgIGFsbGFuLmphcmRpbmVAc3ByeW1lZGlhLmNvLnVrCiAqIAogKiBDb3B5cmlnaHQgMjAwOSBBbGxhbiBKYXJkaW5lLCBhbGwgcmlnaHRzIHJlc2VydmVkLgogKgogKiBEZXNjcmlwdGlvbjoKICogVGhpcyBpcyBhIGphdmFzY3JpcHQgbGlicmFyeSBzdWl0YWJsZSBmb3IgdXNlIGFzIGEgdW5pdCB0ZXN0aW5nIGZyYW1ld29yay4gRW1wbG95aW5nIGEgcXVldWluZwogKiBtZWNoYW5pc2ltIHRvIHRha2UgYWNjb3VudCBvZiBhc3luYyBldmVudHMgaW4gamF2YXNjcmlwdCwgdGhpcyBsaWJyYXJ5IHdpbGwgY29tbXVuaWNhdGVzIHdpdGgKICogYSBjb250cm9sbGVyIGZyYW1lICh0byByZXBvcnQgaW5kaXZpZHVhbCB0ZXN0IHN0YXR1cykuCiAqIAogKi8KCgp2YXIgb1Rlc3QgPSB7CgkvKiBCbG9jayBmdXJ0aGVyIHRlc3RzIGZyb20gb2NjdXJpbmcgLSBtaWdodCBiZSBlbmQgb2YgdGVzdHMgb3IgZHVlIHRvIGFzeW5jIHdhaXQgKi8KCWJCbG9jazogZmFsc2UsCgkKCS8qIE51bWJlciBvZiB0aW1lcyB0byB0cnkgcmV0ZXN0aW5nIGZvciBhIGJsb2NraW5nIHRlc3QgKi8KCWlSZVRlc3RMaW1pdDogMjAsCgkKCS8qIEFtb3VudCBvZiB0aW1lIHRvIHdhaXQgYmV0d2VlbiB0cnlpbmcgZm9yIGFuIGFzeW5jIHRlc3QgKi8KCWlSZVRlc3REZWxheTogMTUwLAoJCgkvKiBFbmQgdGVzdHMgLSBleHRlcm5hbCBjb250cm9sICovCgliRW5kOiBmYWxzZSwKCQoJLyogSW50ZXJuYWwgdmFyaWFibGVzICovCglfYW9RdWV1ZTogW10sCglfaVJlVGVzdDogMCwKCV9iRmluaXNoZWQ6IGZhbHNlLAoJCgkKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgoJICogUmVjb21tZW5lZCBwdWJsaWMgZnVuY3Rpb25zCgkgKi8KCQoJLyoKCSAqIEZ1bmN0aW9uOiBmblRlc3QKCSAqIFB1cnBvc2U6ICBBZGQgYSB0ZXN0IHRvIHRoZSBxdWV1ZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICBzdHJpbmc6c01lc3NhZ2UgLSBuYW1lIG9mIHRoZSB0ZXN0CgkgKiAgICAgICAgICAgZnVuY3Rpb246Zm5UZXN0IC0gZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBldmFsdWRhdGVkIHRvIGdldCB0aGUgdGVzdCByZXN1bHQKCSAqLwoJImZuVGVzdCI6IGZ1bmN0aW9uICggc01lc3NhZ2UsIGZuU2V0dXAsIGZuVGVzdCApCgl7CgkJdGhpcy5fYW9RdWV1ZS5wdXNoKCB7CgkJCSJzTWVzc2FnZSI6IHNNZXNzYWdlLAoJCQkiZm5TZXR1cCI6IGZuU2V0dXAsCgkJCSJmblRlc3QiOiBmblRlc3QsCgkJCSJiUG9sbCI6IGZhbHNlCgkJfSApOwoJCXRoaXMuX2ZuTmV4dCgpOwoJfSwKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmbldhaXRUZXN0CgkgKiBQdXJwb3NlOiAgQWRkIGEgdGVzdCB0byB0aGUgcXVldWUgd2hpY2ggaGFzIGEgcmUtdGVzdCBjeWNsZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICBzdHJpbmc6c01lc3NhZ2UgLSBuYW1lIG9mIHRoZSB0ZXN0CgkgKiAgICAgICAgICAgZnVuY3Rpb246Zm5UZXN0IC0gZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBldmFsdWRhdGVkIHRvIGdldCB0aGUgdGVzdCByZXN1bHQKCSAqLwoJImZuV2FpdFRlc3QiOiBmdW5jdGlvbiAoIHNNZXNzYWdlLCBmblNldHVwLCBmblRlc3QgKQoJewoJCXRoaXMuX2FvUXVldWUucHVzaCggewoJCQkic01lc3NhZ2UiOiBzTWVzc2FnZSwKCQkJImZuU2V0dXAiOiBmblNldHVwLAoJCQkiZm5UZXN0IjogZm5UZXN0LAoJCQkiYlBvbGwiOiB0cnVlCgkJfSApOwoJCXRoaXMuX2ZuTmV4dCgpOwoJfSwKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmblN0YXJ0CgkgKiBQdXJwb3NlOiAgSW5kaWNhdGUgdGhhdCB0aGlzIGlzIGEgbmV3IHVuaXQgYW5kIHdoYXQgaXQgaXMgdGVzdGluZyAobWVzc2FnZSB0byBlbmQgdXNlcikKCSAqIFJldHVybnM6ICAtCgkgKiBJbnB1dHM6ICAgc3RyaW5nOnNNZXNzYWdlIC0gbWVzc2FnZSB0byBnaXZlIHRvIHRoZSB1c2VyIGFib3V0IHRoaXMgdW5pdAoJICovCgkiZm5TdGFydCI6IGZ1bmN0aW9uICggc01lc3NhZ2UgKQoJewoJCXdpbmRvdy5wYXJlbnQuY29udHJvbGxlci5mblN0YXJ0TWVzc2FnZSggc01lc3NhZ2UgKTsKCX0sCgkKCS8qCgkgKiBGdW5jdGlvbjogZm5Db21wbGV0ZQoJICogUHVycG9zZTogIFRlbGwgdGhlIGNvbnRyb2xsZXIgdGhhdCB3ZSBhcmUgYWxsIGRvbmUgaGVyZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICAtCgkgKi8KCSJmbkNvbXBsZXRlIjogZnVuY3Rpb24gKCkKCXsKCQl0aGlzLl9iRmluaXNoZWQgPSB0cnVlOwoJCXRoaXMuX2ZuTmV4dCgpOwoJfSwKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmbkNvb2tpZURlc3Ryb3kKCSAqIFB1cnBvc2U6ICBEZXN0cm95IGEgY29va2llIG9mIGEgZ2l2ZW4gbmFtZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICAtCgkgKi8KCSJmbkNvb2tpZURlc3Ryb3kiOiBmdW5jdGlvbiAoIG9UYWJsZSApCgl7CgkJdmFyIHMgPSBvVGFibGUuZm5TZXR0aW5ncygpOwoKCQlsb2NhbFN0b3JhZ2Uuc2V0SXRlbSggJ0RhdGFUYWJsZXNfJytzLnNJbnN0YW5jZSsnXycrd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLCBudWxsICk7Cgl9LAoJCgkKCQoJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBJbnRlcm5hbCBmdW5jdGlvbnMKCSAqLwoJCgkKCSJfZm5SZVRlc3QiOiBmdW5jdGlvbiAoIG9UZXN0SW5mbyApCgl7CgkJdmFyIGJSZXN1bHQgPSBvVGVzdEluZm8uZm5UZXN0KCApOwoJCWlmICggYlJlc3VsdCApCgkJewoJCQkvKiBUZXN0IHBhc3NlZCBvbiByZXRyeSAqLwoJCQl0aGlzLl9mblJlc3VsdCggdHJ1ZSApOwoJCQl0aGlzLl9mbk5leHQoKTsKCQl9CgkJZWxzZQoJCXsKCQkJaWYgKCB0aGlzLl9pUmVUZXN0IDwgdGhpcy5pUmVUZXN0TGltaXQgKQoJCQl7CgkJCQl0aGlzLl9pUmVUZXN0Kys7CgkJCQlzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsKCQkJCQlvVGVzdC5fZm5SZVRlc3QoIG9UZXN0SW5mbyApOwoJCQkJfSwgdGhpcy5pUmVUZXN0RGVsYXkgKTsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCXRoaXMuX2ZuUmVzdWx0KCBmYWxzZSApOwoJCQl9CgkJfQoJfSwKCQoJIl9mbk5leHQiOiBmdW5jdGlvbiAoKQoJewoJCWlmICggdGhpcy5iRW5kICkKCQl7CgkJCXJldHVybjsKCQl9CgkJCgkJaWYgKCAhdGhpcy5iQmxvY2sgJiYgdGhpcy5fYW9RdWV1ZS5sZW5ndGggPiAwICkKCQl7CgkJCXZhciBvTmV4dFRlc3QgPSB0aGlzLl9hb1F1ZXVlLnNoaWZ0KCk7CgkJCXdpbmRvdy5wYXJlbnQuY29udHJvbGxlci5mblRlc3RTdGFydCggb05leHRUZXN0LnNNZXNzYWdlICk7CgkJCXRoaXMuYkJsb2NrID0gdHJ1ZTsKCQkJCgkJCWlmICggdHlwZW9mIG9OZXh0VGVzdC5mblNldHVwID09ICdmdW5jdGlvbicgKQoJCQl7CgkJCQlvTmV4dFRlc3QuZm5TZXR1cCggKTsKCQkJfQoJCQl2YXIgYlJlc3VsdCA9IG9OZXh0VGVzdC5mblRlc3QoICk7CgkJCS8vYlJlc3VsdCA9IGZhbHNlOwoJCQkKCQkJaWYgKCBvTmV4dFRlc3QuYlBvbGwgKQoJCQl7CgkJCQlpZiAoIGJSZXN1bHQgKQoJCQkJewoJCQkJCXRoaXMuX2ZuUmVzdWx0KCB0cnVlICk7CgkJCQkJdGhpcy5fZm5OZXh0KCk7CgkJCQl9CgkJCQllbHNlCgkJCQl7CgkJCQkJX2lSZVRlc3QgPSAwOwoJCQkJCXNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJCQkJCQlvVGVzdC5fZm5SZVRlc3QoIG9OZXh0VGVzdCApOwoJCQkJCX0sIHRoaXMuaVJlVGVzdERlbGF5ICk7CgkJCQl9CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQl0aGlzLl9mblJlc3VsdCggYlJlc3VsdCApOwoJCQkJdGhpcy5fZm5OZXh0KCk7CgkJCX0KCQl9CgkJZWxzZSBpZiAoICF0aGlzLmJCbG9jayAmJiB0aGlzLl9hb1F1ZXVlLmxlbmd0aCA9PSAwICYmIHRoaXMuX2JGaW5pc2hlZCApCgkJewoJCQl3aW5kb3cucGFyZW50LmNvbnRyb2xsZXIuZm5Vbml0Q29tcGxldGUoICk7CgkJfQoJfSwKCQoJIl9mblJlc3VsdCI6IGZ1bmN0aW9uICggYiApCgl7CgkJd2luZG93LnBhcmVudC5jb250cm9sbGVyLmZuVGVzdFJlc3VsdCggYiApOwoJCXRoaXMuYkJsb2NrID0gZmFsc2U7CgkJaWYgKCAhYiApCgkJewoJCQl0aGlzLmJFbmQgPSB0cnVlOwoJCX0KCX0KfTsKCgp2YXIgb0Rpc3BhY2hlciA9IHsKCSJjbGljayI6IGZ1bmN0aW9uICggbk5vZGUsIG9TcGVjaWFsICkKCXsKCQl2YXIgZXZ0ID0gdGhpcy5mbkNyZWF0ZUV2ZW50KCAnY2xpY2snLCBuTm9kZSwgb1NwZWNpYWwgKTsKCQlpZiAoIG5Ob2RlLmRpc3BhdGNoRXZlbnQgKQoJCQluTm9kZS5kaXNwYXRjaEV2ZW50KGV2dCk7CgkJZWxzZQoJCQluTm9kZS5maXJlRXZlbnQoJ29uY2xpY2snLCBldnQpOwoJfSwKCQoJImNoYW5nZSI6IGZ1bmN0aW9uICggbk5vZGUgKQoJewoJCXZhciBldnQgPSB0aGlzLmZuQ3JlYXRlRXZlbnQoICdjaGFuZ2UnLCBuTm9kZSApOwoJCWlmICggbk5vZGUuZGlzcGF0Y2hFdmVudCApCgkJbk5vZGUuZGlzcGF0Y2hFdmVudChldnQpOwoJCWVsc2UKCQkJbk5vZGUuZmlyZUV2ZW50KCdvbmNoYW5nZScsIGV2dCk7Cgl9LAoJCgkKCS8qCgkgKiBGdW5jdGlvbjogZm5DcmVhdGVFdmVudAoJICogUHVycG9zZTogIENyZWF0ZSBhbiBldmVudCBvamVjdCBiYXNlZCBvbiB0aGUgdHlwZSB0byB0cmlnZ2VyIGFuIGV2ZW50IC0geC1wbGF0Zm9ybQoJICogUmV0dXJuczogIGV2ZW50OmV2dAoJICogSW5wdXRzOiAgIHN0cmluZzpzVHlwZSAtIHR5cGUgb2YgZXZlbnQKCSAqICAgICAgICAgICBub2RlOm5UYXJnZXQgLSB0YXJnZXQgbm9kZSBvZiB0aGUgZXZlbnQKCSAqLwoJZm5DcmVhdGVFdmVudDogZnVuY3Rpb24oIHNUeXBlLCBuVGFyZ2V0LCBvU3BlY2lhbCApCgl7CgkJdmFyIGV2dCA9IG51bGw7CgkJdmFyIG9UYXJnZXRQb3MgPSB0aGlzLl9mbkdldFBvcyggblRhcmdldCApOwoJCXZhciBzVHlwZUdyb3VwID0gdGhpcy5fZm5FdmVudFR5cGVHcm91cCggc1R5cGUgKTsKCQlpZiAoIHR5cGVvZiBvU3BlY2lhbCA9PSAndW5kZWZpbmVkJyApCgkJewoJCQlvU3BlY2lhbCA9IHt9OwoJCX0KCQkKCQl2YXIgY3RybEtleSA9IGZhbHNlOwoJCXZhciBhbHRLZXkgPSBmYWxzZTsKCQl2YXIgc2hpZnRLZXkgPSAodHlwZW9mIG9TcGVjaWFsLnNoaWZ0ICE9ICd1bmRlZmluZWQnKSA/IG9TcGVjaWFsLnNoaWZ0IDogZmFsc2U7CgkJdmFyIG1ldGFLZXkgPSBmYWxzZTsKCQl2YXIgYnV0dG9uID0gZmFsc2U7CgkJCgkJaWYgKCBkb2N1bWVudC5jcmVhdGVFdmVudCApCgkJewoJCQlzd2l0Y2ggKCBzVHlwZUdyb3VwICkKCQkJewoJCQkJY2FzZSAnbW91c2UnOgoJCQkJCWV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCAiTW91c2VFdmVudHMiICk7CgkJCQkJZXZ0LmluaXRNb3VzZUV2ZW50KCBzVHlwZSwgdHJ1ZSwgdHJ1ZSwgd2luZG93LCAwLCBvVGFyZ2V0UG9zWzBdLCBvVGFyZ2V0UG9zWzFdLCAKCQkJCQkJb1RhcmdldFBvc1swXSwgb1RhcmdldFBvc1sxXSwgY3RybEtleSwgYWx0S2V5LCBzaGlmdEtleSwgCgkJCQkJCW1ldGFLZXksIGJ1dHRvbiwgbnVsbCApOwoJCQkJCWJyZWFrOwoJCQkJCgkJCQljYXNlICdodG1sJzoKCQkJCQlldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCggIkhUTUxFdmVudHMiICk7CgkJCQkJZXZ0LmluaXRFdmVudCggc1R5cGUsIHRydWUsIHRydWUgKTsKCQkJCQlicmVhazsKCQkJCQkKCQkJCWNhc2UgJ3VpJzoKCQkJCQlldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCggIlVJRXZlbnRzIiApOwoJCQkJCWV2dC5pbml0VUlFdmVudCggc1R5cGUsIHRydWUsIHRydWUsIHdpbmRvdywgMCApOwoJCQkJCWJyZWFrOwoJCQkJCgkJCQlkZWZhdWx0OgoJCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWVsc2UgaWYgKCBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCApCgkJewoJCQlzd2l0Y2ggKCBzVHlwZUdyb3VwICkKCQkJewoJCQkJY2FzZSAnbW91c2UnOgoJCQkJCWV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7CgkJCQkJZXZ0LnNjcmVlblggPSBvVGFyZ2V0UG9zWzBdOwoJCQkJCWV2dC5zY3JlZW5YID0gb1RhcmdldFBvc1sxXTsKCQkJCQlldnQuY2xpZW50WCA9IG9UYXJnZXRQb3NbMF07CgkJCQkJZXZ0LmNsaWVudFkgPSBvVGFyZ2V0UG9zWzFdOwoJCQkJCWV2dC5jdHJsS2V5ID0gY3RybEtleTsKCQkJCQlldnQuYWx0S2V5ID0gYWx0S2V5OwoJCQkJCWV2dC5zaGlmdEtleSA9IHNoaWZ0S2V5OwoJCQkJCWV2dC5tZXRhS2V5ID0gbWV0YUtleTsKCQkJCQlldnQuYnV0dG9uID0gYnV0dG9uOwoJCQkJCWV2dC5yZWxhdGVkVGFyZ2V0ID0gbnVsbDsKCQkJCQlicmVhazsKCQkJCQoJCQkJY2FzZSAnaHRtbCc6CgkJCQkJLyogZmFsbCB0aHJvdWdoIHRvIGJhc2ljIGV2ZW50IG9iamVjdCAqLwoJCQkJCQoJCQkJY2FzZSAndWknOgoJCQkJCWV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7CgkJCQkJYnJlYWs7CgkJCQkKCQkJCWRlZmF1bHQ6CgkJCQkJYnJlYWs7CgkJCX0KCQl9CgkJCgkJcmV0dXJuIGV2dDsKCX0sCgkKCS8qIAoJICogRnVuY3Rpb246IERlc2lnbkNvcmUuZm5HZXRQb3MKCSAqIFB1cnBvc2U6ICBHZXQgdGhlIHBvc2l0aW9uIG9mIGFuIGVsZW1lbnQgb24gdGhlIHBhZ2UKCSAqIFJldHVybnM6ICBhcnJheVsgMC1pbnQ6bGVmdCwgMS1pbnQ6dG9wIF0KCSAqIElucHV0czogICBub2RlOm9iaiAtIG5vZGUgdG8gYW5hbHlzZQoJICovCglfZm5HZXRQb3M6IGZ1bmN0aW9uICggb2JqICkgCgl7CgkJdmFyIGN1cmxlZnQgPSAwOwoJCXZhciBjdXJ0b3AgPSAwOwoJCQoJCWlmIChvYmoub2Zmc2V0UGFyZW50KSAKCQl7CgkJCWN1cmxlZnQgPSBvYmoub2Zmc2V0TGVmdDsKCQkJY3VydG9wID0gb2JqLm9mZnNldFRvcDsKCQkJd2hpbGUgKG9iaiA9IG9iai5vZmZzZXRQYXJlbnQgKSAKCQkJewoJCQkJY3VybGVmdCArPSBvYmoub2Zmc2V0TGVmdDsKCQkJCWN1cnRvcCArPSBvYmoub2Zmc2V0VG9wOwoJCQl9CgkJfQoJCXJldHVybiBbY3VybGVmdCxjdXJ0b3BdOwoJfSwKCQoJCgkvKgoJICogRnVuY3Rpb246IF9mbkV2ZW50VHlwZUdyb3VwCgkgKiBQdXJwb3NlOiAgR3JvdXAgdGhlIGV2ZW50IHR5cGVzIGFzIHBlciB3M2MgZ3JvdXBpbmdzCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIHN0cmluZzpzVHlwZQoJICovCglfZm5FdmVudFR5cGVHcm91cDogZnVuY3Rpb24gKCBzVHlwZSApCgl7CgkJc3dpdGNoICggc1R5cGUgKQoJCXsKCQkJY2FzZSAnY2xpY2snOgoJCQljYXNlICdkYmxjbGljayc6CgkJCWNhc2UgJ21vdXNlZG93bic6CgkJCWNhc2UgJ21vdXNlbW92ZSc6CgkJCWNhc2UgJ21vdXNlb3V0JzoKCQkJY2FzZSAnbW91c2VvdmVyJzoKCQkJY2FzZSAnbW91c2V1cCc6CgkJCQlyZXR1cm4gJ21vdXNlJzsKCQkJCgkJCWNhc2UgJ2NoYW5nZSc6CgkJCWNhc2UgJ2ZvY3VzJzoKCQkJY2FzZSAnYmx1cic6CgkJCWNhc2UgJ3NlbGVjdCc6CgkJCWNhc2UgJ3N1Ym1pdCc6CgkJCQlyZXR1cm4gJ2h0bWwnOwoJCQkJCgkJCWNhc2UgJ2tleWRvd24nOgoJCQljYXNlICdrZXlwcmVzcyc6CgkJCWNhc2UgJ2tleXVwJzoKCQkJY2FzZSAnbG9hZCc6CgkJCWNhc2UgJ3VubG9hZCc6CgkJCQlyZXR1cm4gJ3VpJzsKCQkJCgkJCWRlZmF1bHQ6CgkJCQlyZXR1cm4gJ2N1c3RvbSc7CgkJfQoJfQp9CgoKdmFyIG9TZXNzaW9uID0gewoJblRhYmxlOiBudWxsLAoJCglmbkNhY2hlOiBmdW5jdGlvbiAoKQoJewoJCXRoaXMublRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlbW8nKS5jbG9uZU5vZGUodHJ1ZSk7Cgl9LAoJCglmblJlc3RvcmU6IGZ1bmN0aW9uICgpCgl7CgkJd2hpbGUoICQuZm4uZGF0YVRhYmxlU2V0dGluZ3MubGVuZ3RoID4gMCApCgkJewoJCQl0cnkgewoJCQkJJC5mbi5kYXRhVGFibGVTZXR0aW5nc1swXS5vSW5zdGFuY2UuZm5EZXN0cm95KCk7CgkJCX0gY2F0Y2ggKGUpIHsKCQkJCSQuZm4uZGF0YVRhYmxlU2V0dGluZ3Muc3BsaWNlKCAwLCAxICk7CgkJCX0KCQl9CgkJLy8kLmZuLmRhdGFUYWJsZVNldHRpbmdzLnNwbGljZSggMCwgJC5mbi5kYXRhVGFibGVTZXR0aW5ncy5sZW5ndGggKTsKCQl2YXIgbkRlbW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVtbycpOwoJCW5EZW1vLmlubmVySFRNTCA9ICIiOwoJCWZvciAoIHZhciBpPTAsIGlMZW49dGhpcy5uVGFibGUuY2hpbGROb2Rlcy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCXsKCQkJbkRlbW8uYXBwZW5kQ2hpbGQoIHRoaXMublRhYmxlLmNoaWxkTm9kZXNbMF0gKTsKCQl9CgkJdGhpcy5mbkNhY2hlKCk7Cgl9Cn0KCiQoZG9jdW1lbnQpLnJlYWR5KCBmdW5jdGlvbiAoKSB7CglvU2Vzc2lvbi5mbkNhY2hlKCk7Cn0gKTsK",
                "body": "LyoKICogRmlsZTogICAgICAgIHVuaXRfdGVzdC5qcwogKiBWZXJzaW9uOiAgICAgMC4wLjEKICogQ1ZTOiAgICAgICAgICRJZCQKICogRGVzY3JpcHRpb246IFVuaXQgdGVzdCBmcmFtZXdvcmsKICogQXV0aG9yOiAgICAgIEFsbGFuIEphcmRpbmUgKHd3dy5zcHJ5bWVkaWEuY28udWspCiAqIENyZWF0ZWQ6ICAgICBTdW4gTWFyICA4IDIyOjAyOjQ5IEdNVCAyMDA5CiAqIE1vZGlmaWVkOiAgICAkRGF0ZSQgYnkgJEF1dGhvciQKICogTGFuZ3VhZ2U6ICAgIEphdmFzY3JpcHQKICogTGljZW5zZTogICAgIEdQTCB2MiBvciBCU0QgMyBwb2ludCBzdHlsZQogKiBQcm9qZWN0OiAgICAgRGF0YVRhYmxlcwogKiBDb250YWN0OiAgICAgYWxsYW4uamFyZGluZUBzcHJ5bWVkaWEuY28udWsKICogCiAqIENvcHlyaWdodCAyMDA5IEFsbGFuIEphcmRpbmUsIGFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIERlc2NyaXB0aW9uOgogKiBUaGlzIGlzIGEgamF2YXNjcmlwdCBsaWJyYXJ5IHN1aXRhYmxlIGZvciB1c2UgYXMgYSB1bml0IHRlc3RpbmcgZnJhbWV3b3JrLiBFbXBsb3lpbmcgYSBxdWV1aW5nCiAqIG1lY2hhbmlzaW0gdG8gdGFrZSBhY2NvdW50IG9mIGFzeW5jIGV2ZW50cyBpbiBqYXZhc2NyaXB0LCB0aGlzIGxpYnJhcnkgd2lsbCBjb21tdW5pY2F0ZXMgd2l0aAogKiBhIGNvbnRyb2xsZXIgZnJhbWUgKHRvIHJlcG9ydCBpbmRpdmlkdWFsIHRlc3Qgc3RhdHVzKS4KICogCiAqLwoKCnZhciBvVGVzdCA9IHsKCS8qIEJsb2NrIGZ1cnRoZXIgdGVzdHMgZnJvbSBvY2N1cmluZyAtIG1pZ2h0IGJlIGVuZCBvZiB0ZXN0cyBvciBkdWUgdG8gYXN5bmMgd2FpdCAqLwoJYkJsb2NrOiBmYWxzZSwKCQoJLyogTnVtYmVyIG9mIHRpbWVzIHRvIHRyeSByZXRlc3RpbmcgZm9yIGEgYmxvY2tpbmcgdGVzdCAqLwoJaVJlVGVzdExpbWl0OiAyMCwKCQoJLyogQW1vdW50IG9mIHRpbWUgdG8gd2FpdCBiZXR3ZWVuIHRyeWluZyBmb3IgYW4gYXN5bmMgdGVzdCAqLwoJaVJlVGVzdERlbGF5OiAxNTAsCgkKCS8qIEVuZCB0ZXN0cyAtIGV4dGVybmFsIGNvbnRyb2wgKi8KCWJFbmQ6IGZhbHNlLAoJCgkvKiBJbnRlcm5hbCB2YXJpYWJsZXMgKi8KCV9hb1F1ZXVlOiBbXSwKCV9pUmVUZXN0OiAwLAoJX2JGaW5pc2hlZDogZmFsc2UsCgkKCQoJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBSZWNvbW1lbmVkIHB1YmxpYyBmdW5jdGlvbnMKCSAqLwoJCgkvKgoJICogRnVuY3Rpb246IGZuVGVzdAoJICogUHVycG9zZTogIEFkZCBhIHRlc3QgdG8gdGhlIHF1ZXVlCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIHN0cmluZzpzTWVzc2FnZSAtIG5hbWUgb2YgdGhlIHRlc3QKCSAqICAgICAgICAgICBmdW5jdGlvbjpmblRlc3QgLSBmdW5jdGlvbiB3aGljaCB3aWxsIGJlIGV2YWx1ZGF0ZWQgdG8gZ2V0IHRoZSB0ZXN0IHJlc3VsdAoJICovCgkiZm5UZXN0IjogZnVuY3Rpb24gKCBzTWVzc2FnZSwgZm5TZXR1cCwgZm5UZXN0ICkKCXsKCQl0aGlzLl9hb1F1ZXVlLnB1c2goIHsKCQkJInNNZXNzYWdlIjogc01lc3NhZ2UsCgkJCSJmblNldHVwIjogZm5TZXR1cCwKCQkJImZuVGVzdCI6IGZuVGVzdCwKCQkJImJQb2xsIjogZmFsc2UKCQl9ICk7CgkJdGhpcy5fZm5OZXh0KCk7Cgl9LAoJCgkvKgoJICogRnVuY3Rpb246IGZuV2FpdFRlc3QKCSAqIFB1cnBvc2U6ICBBZGQgYSB0ZXN0IHRvIHRoZSBxdWV1ZSB3aGljaCBoYXMgYSByZS10ZXN0IGN5Y2xlCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIHN0cmluZzpzTWVzc2FnZSAtIG5hbWUgb2YgdGhlIHRlc3QKCSAqICAgICAgICAgICBmdW5jdGlvbjpmblRlc3QgLSBmdW5jdGlvbiB3aGljaCB3aWxsIGJlIGV2YWx1ZGF0ZWQgdG8gZ2V0IHRoZSB0ZXN0IHJlc3VsdAoJICovCgkiZm5XYWl0VGVzdCI6IGZ1bmN0aW9uICggc01lc3NhZ2UsIGZuU2V0dXAsIGZuVGVzdCApCgl7CgkJdGhpcy5fYW9RdWV1ZS5wdXNoKCB7CgkJCSJzTWVzc2FnZSI6IHNNZXNzYWdlLAoJCQkiZm5TZXR1cCI6IGZuU2V0dXAsCgkJCSJmblRlc3QiOiBmblRlc3QsCgkJCSJiUG9sbCI6IHRydWUKCQl9ICk7CgkJdGhpcy5fZm5OZXh0KCk7Cgl9LAoJCgkvKgoJICogRnVuY3Rpb246IGZuU3RhcnQKCSAqIFB1cnBvc2U6ICBJbmRpY2F0ZSB0aGF0IHRoaXMgaXMgYSBuZXcgdW5pdCBhbmQgd2hhdCBpdCBpcyB0ZXN0aW5nIChtZXNzYWdlIHRvIGVuZCB1c2VyKQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICBzdHJpbmc6c01lc3NhZ2UgLSBtZXNzYWdlIHRvIGdpdmUgdG8gdGhlIHVzZXIgYWJvdXQgdGhpcyB1bml0CgkgKi8KCSJmblN0YXJ0IjogZnVuY3Rpb24gKCBzTWVzc2FnZSApCgl7CgkJd2luZG93LnBhcmVudC5jb250cm9sbGVyLmZuU3RhcnRNZXNzYWdlKCBzTWVzc2FnZSApOwoJfSwKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmbkNvbXBsZXRlCgkgKiBQdXJwb3NlOiAgVGVsbCB0aGUgY29udHJvbGxlciB0aGF0IHdlIGFyZSBhbGwgZG9uZSBoZXJlCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIC0KCSAqLwoJImZuQ29tcGxldGUiOiBmdW5jdGlvbiAoKQoJewoJCXRoaXMuX2JGaW5pc2hlZCA9IHRydWU7CgkJdGhpcy5fZm5OZXh0KCk7Cgl9LAoJCgkvKgoJICogRnVuY3Rpb246IGZuQ29va2llRGVzdHJveQoJICogUHVycG9zZTogIERlc3Ryb3kgYSBjb29raWUgb2YgYSBnaXZlbiBuYW1lCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIC0KCSAqLwoJImZuQ29va2llRGVzdHJveSI6IGZ1bmN0aW9uICggb1RhYmxlICkKCXsKCQl2YXIgcyA9IG9UYWJsZS5mblNldHRpbmdzKCk7CgoJCWxvY2FsU3RvcmFnZS5zZXRJdGVtKCAnRGF0YVRhYmxlc18nK3Muc0luc3RhbmNlKydfJyt3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUsIG51bGwgKTsKCX0sCgkKCQoJCgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCSAqIEludGVybmFsIGZ1bmN0aW9ucwoJICovCgkKCQoJIl9mblJlVGVzdCI6IGZ1bmN0aW9uICggb1Rlc3RJbmZvICkKCXsKCQl2YXIgYlJlc3VsdCA9IG9UZXN0SW5mby5mblRlc3QoICk7CgkJaWYgKCBiUmVzdWx0ICkKCQl7CgkJCS8qIFRlc3QgcGFzc2VkIG9uIHJldHJ5ICovCgkJCXRoaXMuX2ZuUmVzdWx0KCB0cnVlICk7CgkJCXRoaXMuX2ZuTmV4dCgpOwoJCX0KCQllbHNlCgkJewoJCQlpZiAoIHRoaXMuX2lSZVRlc3QgPCB0aGlzLmlSZVRlc3RMaW1pdCApCgkJCXsKCQkJCXRoaXMuX2lSZVRlc3QrKzsKCQkJCXNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJCQkJCW9UZXN0Ll9mblJlVGVzdCggb1Rlc3RJbmZvICk7CgkJCQl9LCB0aGlzLmlSZVRlc3REZWxheSApOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJdGhpcy5fZm5SZXN1bHQoIGZhbHNlICk7CgkJCX0KCQl9Cgl9LAoJCgkiX2ZuTmV4dCI6IGZ1bmN0aW9uICgpCgl7CgkJaWYgKCB0aGlzLmJFbmQgKQoJCXsKCQkJcmV0dXJuOwoJCX0KCQkKCQlpZiAoICF0aGlzLmJCbG9jayAmJiB0aGlzLl9hb1F1ZXVlLmxlbmd0aCA+IDAgKQoJCXsKCQkJdmFyIG9OZXh0VGVzdCA9IHRoaXMuX2FvUXVldWUuc2hpZnQoKTsKCQkJd2luZG93LnBhcmVudC5jb250cm9sbGVyLmZuVGVzdFN0YXJ0KCBvTmV4dFRlc3Quc01lc3NhZ2UgKTsKCQkJdGhpcy5iQmxvY2sgPSB0cnVlOwoJCQkKCQkJaWYgKCB0eXBlb2Ygb05leHRUZXN0LmZuU2V0dXAgPT0gJ2Z1bmN0aW9uJyApCgkJCXsKCQkJCW9OZXh0VGVzdC5mblNldHVwKCApOwoJCQl9CgkJCXZhciBiUmVzdWx0ID0gb05leHRUZXN0LmZuVGVzdCggKTsKCQkJLy9iUmVzdWx0ID0gZmFsc2U7CgkJCQoJCQlpZiAoIG9OZXh0VGVzdC5iUG9sbCApCgkJCXsKCQkJCWlmICggYlJlc3VsdCApCgkJCQl7CgkJCQkJdGhpcy5fZm5SZXN1bHQoIHRydWUgKTsKCQkJCQl0aGlzLl9mbk5leHQoKTsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQlfaVJlVGVzdCA9IDA7CgkJCQkJc2V0VGltZW91dCggZnVuY3Rpb24oKSB7CgkJCQkJCW9UZXN0Ll9mblJlVGVzdCggb05leHRUZXN0ICk7CgkJCQkJfSwgdGhpcy5pUmVUZXN0RGVsYXkgKTsKCQkJCX0KCQkJfQoJCQllbHNlCgkJCXsKCQkJCXRoaXMuX2ZuUmVzdWx0KCBiUmVzdWx0ICk7CgkJCQl0aGlzLl9mbk5leHQoKTsKCQkJfQoJCX0KCQllbHNlIGlmICggIXRoaXMuYkJsb2NrICYmIHRoaXMuX2FvUXVldWUubGVuZ3RoID09IDAgJiYgdGhpcy5fYkZpbmlzaGVkICkKCQl7CgkJCXdpbmRvdy5wYXJlbnQuY29udHJvbGxlci5mblVuaXRDb21wbGV0ZSggKTsKCQl9Cgl9LAoJCgkiX2ZuUmVzdWx0IjogZnVuY3Rpb24gKCBiICkKCXsKCQl3aW5kb3cucGFyZW50LmNvbnRyb2xsZXIuZm5UZXN0UmVzdWx0KCBiICk7CgkJdGhpcy5iQmxvY2sgPSBmYWxzZTsKCQlpZiAoICFiICkKCQl7CgkJCXRoaXMuYkVuZCA9IHRydWU7CgkJfQoJfQp9OwoKCnZhciBvRGlzcGFjaGVyID0gewoJImNsaWNrIjogZnVuY3Rpb24gKCBuTm9kZSwgb1NwZWNpYWwgKQoJewoJCXZhciBldnQgPSB0aGlzLmZuQ3JlYXRlRXZlbnQoICdjbGljaycsIG5Ob2RlLCBvU3BlY2lhbCApOwoJCWlmICggbk5vZGUuZGlzcGF0Y2hFdmVudCApCgkJCW5Ob2RlLmRpc3BhdGNoRXZlbnQoZXZ0KTsKCQllbHNlCgkJCW5Ob2RlLmZpcmVFdmVudCgnb25jbGljaycsIGV2dCk7Cgl9LAoJCgkiY2hhbmdlIjogZnVuY3Rpb24gKCBuTm9kZSApCgl7CgkJdmFyIGV2dCA9IHRoaXMuZm5DcmVhdGVFdmVudCggJ2NoYW5nZScsIG5Ob2RlICk7CgkJaWYgKCBuTm9kZS5kaXNwYXRjaEV2ZW50ICkKCQluTm9kZS5kaXNwYXRjaEV2ZW50KGV2dCk7CgkJZWxzZQoJCQluTm9kZS5maXJlRXZlbnQoJ29uY2hhbmdlJywgZXZ0KTsKCX0sCgkKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmbkNyZWF0ZUV2ZW50CgkgKiBQdXJwb3NlOiAgQ3JlYXRlIGFuIGV2ZW50IG9qZWN0IGJhc2VkIG9uIHRoZSB0eXBlIHRvIHRyaWdnZXIgYW4gZXZlbnQgLSB4LXBsYXRmb3JtCgkgKiBSZXR1cm5zOiAgZXZlbnQ6ZXZ0CgkgKiBJbnB1dHM6ICAgc3RyaW5nOnNUeXBlIC0gdHlwZSBvZiBldmVudAoJICogICAgICAgICAgIG5vZGU6blRhcmdldCAtIHRhcmdldCBub2RlIG9mIHRoZSBldmVudAoJICovCglmbkNyZWF0ZUV2ZW50OiBmdW5jdGlvbiggc1R5cGUsIG5UYXJnZXQsIG9TcGVjaWFsICkKCXsKCQl2YXIgZXZ0ID0gbnVsbDsKCQl2YXIgb1RhcmdldFBvcyA9IHRoaXMuX2ZuR2V0UG9zKCBuVGFyZ2V0ICk7CgkJdmFyIHNUeXBlR3JvdXAgPSB0aGlzLl9mbkV2ZW50VHlwZUdyb3VwKCBzVHlwZSApOwoJCWlmICggdHlwZW9mIG9TcGVjaWFsID09ICd1bmRlZmluZWQnICkKCQl7CgkJCW9TcGVjaWFsID0ge307CgkJfQoJCQoJCXZhciBjdHJsS2V5ID0gZmFsc2U7CgkJdmFyIGFsdEtleSA9IGZhbHNlOwoJCXZhciBzaGlmdEtleSA9ICh0eXBlb2Ygb1NwZWNpYWwuc2hpZnQgIT0gJ3VuZGVmaW5lZCcpID8gb1NwZWNpYWwuc2hpZnQgOiBmYWxzZTsKCQl2YXIgbWV0YUtleSA9IGZhbHNlOwoJCXZhciBidXR0b24gPSBmYWxzZTsKCQkKCQlpZiAoIGRvY3VtZW50LmNyZWF0ZUV2ZW50ICkKCQl7CgkJCXN3aXRjaCAoIHNUeXBlR3JvdXAgKQoJCQl7CgkJCQljYXNlICdtb3VzZSc6CgkJCQkJZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoICJNb3VzZUV2ZW50cyIgKTsKCQkJCQlldnQuaW5pdE1vdXNlRXZlbnQoIHNUeXBlLCB0cnVlLCB0cnVlLCB3aW5kb3csIDAsIG9UYXJnZXRQb3NbMF0sIG9UYXJnZXRQb3NbMV0sIAoJCQkJCQlvVGFyZ2V0UG9zWzBdLCBvVGFyZ2V0UG9zWzFdLCBjdHJsS2V5LCBhbHRLZXksIHNoaWZ0S2V5LCAKCQkJCQkJbWV0YUtleSwgYnV0dG9uLCBudWxsICk7CgkJCQkJYnJlYWs7CgkJCQkKCQkJCWNhc2UgJ2h0bWwnOgoJCQkJCWV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCAiSFRNTEV2ZW50cyIgKTsKCQkJCQlldnQuaW5pdEV2ZW50KCBzVHlwZSwgdHJ1ZSwgdHJ1ZSApOwoJCQkJCWJyZWFrOwoJCQkJCQoJCQkJY2FzZSAndWknOgoJCQkJCWV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCAiVUlFdmVudHMiICk7CgkJCQkJZXZ0LmluaXRVSUV2ZW50KCBzVHlwZSwgdHJ1ZSwgdHJ1ZSwgd2luZG93LCAwICk7CgkJCQkJYnJlYWs7CgkJCQkKCQkJCWRlZmF1bHQ6CgkJCQkJYnJlYWs7CgkJCX0KCQl9CgkJZWxzZSBpZiAoIGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0ICkKCQl7CgkJCXN3aXRjaCAoIHNUeXBlR3JvdXAgKQoJCQl7CgkJCQljYXNlICdtb3VzZSc6CgkJCQkJZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTsKCQkJCQlldnQuc2NyZWVuWCA9IG9UYXJnZXRQb3NbMF07CgkJCQkJZXZ0LnNjcmVlblggPSBvVGFyZ2V0UG9zWzFdOwoJCQkJCWV2dC5jbGllbnRYID0gb1RhcmdldFBvc1swXTsKCQkJCQlldnQuY2xpZW50WSA9IG9UYXJnZXRQb3NbMV07CgkJCQkJZXZ0LmN0cmxLZXkgPSBjdHJsS2V5OwoJCQkJCWV2dC5hbHRLZXkgPSBhbHRLZXk7CgkJCQkJZXZ0LnNoaWZ0S2V5ID0gc2hpZnRLZXk7CgkJCQkJZXZ0Lm1ldGFLZXkgPSBtZXRhS2V5OwoJCQkJCWV2dC5idXR0b24gPSBidXR0b247CgkJCQkJZXZ0LnJlbGF0ZWRUYXJnZXQgPSBudWxsOwoJCQkJCWJyZWFrOwoJCQkJCgkJCQljYXNlICdodG1sJzoKCQkJCQkvKiBmYWxsIHRocm91Z2ggdG8gYmFzaWMgZXZlbnQgb2JqZWN0ICovCgkJCQkJCgkJCQljYXNlICd1aSc6CgkJCQkJZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTsKCQkJCQlicmVhazsKCQkJCQoJCQkJZGVmYXVsdDoKCQkJCQlicmVhazsKCQkJfQoJCX0KCQkKCQlyZXR1cm4gZXZ0OwoJfSwKCQoJLyogCgkgKiBGdW5jdGlvbjogRGVzaWduQ29yZS5mbkdldFBvcwoJICogUHVycG9zZTogIEdldCB0aGUgcG9zaXRpb24gb2YgYW4gZWxlbWVudCBvbiB0aGUgcGFnZQoJICogUmV0dXJuczogIGFycmF5WyAwLWludDpsZWZ0LCAxLWludDp0b3AgXQoJICogSW5wdXRzOiAgIG5vZGU6b2JqIC0gbm9kZSB0byBhbmFseXNlCgkgKi8KCV9mbkdldFBvczogZnVuY3Rpb24gKCBvYmogKSAKCXsKCQl2YXIgY3VybGVmdCA9IDA7CgkJdmFyIGN1cnRvcCA9IDA7CgkJCgkJaWYgKG9iai5vZmZzZXRQYXJlbnQpIAoJCXsKCQkJY3VybGVmdCA9IG9iai5vZmZzZXRMZWZ0OwoJCQljdXJ0b3AgPSBvYmoub2Zmc2V0VG9wOwoJCQl3aGlsZSAob2JqID0gb2JqLm9mZnNldFBhcmVudCApIAoJCQl7CgkJCQljdXJsZWZ0ICs9IG9iai5vZmZzZXRMZWZ0OwoJCQkJY3VydG9wICs9IG9iai5vZmZzZXRUb3A7CgkJCX0KCQl9CgkJcmV0dXJuIFtjdXJsZWZ0LGN1cnRvcF07Cgl9LAoJCgkKCS8qCgkgKiBGdW5jdGlvbjogX2ZuRXZlbnRUeXBlR3JvdXAKCSAqIFB1cnBvc2U6ICBHcm91cCB0aGUgZXZlbnQgdHlwZXMgYXMgcGVyIHczYyBncm91cGluZ3MKCSAqIFJldHVybnM6ICAtCgkgKiBJbnB1dHM6ICAgc3RyaW5nOnNUeXBlCgkgKi8KCV9mbkV2ZW50VHlwZUdyb3VwOiBmdW5jdGlvbiAoIHNUeXBlICkKCXsKCQlzd2l0Y2ggKCBzVHlwZSApCgkJewoJCQljYXNlICdjbGljayc6CgkJCWNhc2UgJ2RibGNsaWNrJzoKCQkJY2FzZSAnbW91c2Vkb3duJzoKCQkJY2FzZSAnbW91c2Vtb3ZlJzoKCQkJY2FzZSAnbW91c2VvdXQnOgoJCQljYXNlICdtb3VzZW92ZXInOgoJCQljYXNlICdtb3VzZXVwJzoKCQkJCXJldHVybiAnbW91c2UnOwoJCQkKCQkJY2FzZSAnY2hhbmdlJzoKCQkJY2FzZSAnZm9jdXMnOgoJCQljYXNlICdibHVyJzoKCQkJY2FzZSAnc2VsZWN0JzoKCQkJY2FzZSAnc3VibWl0JzoKCQkJCXJldHVybiAnaHRtbCc7CgkJCQkKCQkJY2FzZSAna2V5ZG93bic6CgkJCWNhc2UgJ2tleXByZXNzJzoKCQkJY2FzZSAna2V5dXAnOgoJCQljYXNlICdsb2FkJzoKCQkJY2FzZSAndW5sb2FkJzoKCQkJCXJldHVybiAndWknOwoJCQkKCQkJZGVmYXVsdDoKCQkJCXJldHVybiAnY3VzdG9tJzsKCQl9Cgl9Cn0KCgp2YXIgb1Nlc3Npb24gPSB7CgluVGFibGU6IG51bGwsCgkKCWZuQ2FjaGU6IGZ1bmN0aW9uICgpCgl7CgkJdGhpcy5uVGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVtbycpLmNsb25lTm9kZSh0cnVlKTsKCX0sCgkKCWZuUmVzdG9yZTogZnVuY3Rpb24gKCkKCXsKCQl3aGlsZSggJC5mbi5kYXRhVGFibGVTZXR0aW5ncy5sZW5ndGggPiAwICkKCQl7CgkJCXRyeSB7CgkJCQkkLmZuLmRhdGFUYWJsZVNldHRpbmdzWzBdLm9JbnN0YW5jZS5mbkRlc3Ryb3koKTsKCQkJfSBjYXRjaCAoZSkgewoJCQkJJC5mbi5kYXRhVGFibGVTZXR0aW5ncy5zcGxpY2UoIDAsIDEgKTsKCQkJfQoJCX0KCQkvLyQuZm4uZGF0YVRhYmxlU2V0dGluZ3Muc3BsaWNlKCAwLCAkLmZuLmRhdGFUYWJsZVNldHRpbmdzLmxlbmd0aCApOwoJCXZhciBuRGVtbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZW1vJyk7CgkJbkRlbW8uaW5uZXJIVE1MID0gIiI7CgkJZm9yICggdmFyIGk9MCwgaUxlbj10aGlzLm5UYWJsZS5jaGlsZE5vZGVzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJewoJCQluRGVtby5hcHBlbmRDaGlsZCggdGhpcy5uVGFibGUuY2hpbGROb2Rlc1swXSApOwoJCX0KCQl0aGlzLmZuQ2FjaGUoKTsKCX0KfQoKJChkb2N1bWVudCkucmVhZHkoIGZ1bmN0aW9uICgpIHsKCW9TZXNzaW9uLmZuQ2FjaGUoKTsKfSApOwo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 20:06:09 GMT",
                    "Content-Length": "8687",
                    "Date": "Thu, 06 Nov 2014 20:06:10 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}