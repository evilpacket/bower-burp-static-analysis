{
    "url": "http://localhost:9999/azamara/cornerstone-framework-dist/lib/lawnchair-0.6.1.min.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Client-side JSON injection (DOM-based)",
    "issueType": 2098032,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based JSON injection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and incorporates this into a string that is parsed as a JSON data structure and then processed by the application. An attacker may be able to use this behavior to construct a URL which, if visited by another application user, will cause arbitrary JSON data to be processed. Depending on the purpose for which this data is used, it may be possible to subvert the application's logic, or cause unintended actions on behalf of the user.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based JSON injection vulnerabilities is not to parse as JSON any string containing data that originated from an untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from modifying the JSON structure in inappropriate ways. This may involve strict validation of specific items to ensure they do not contain any characters that may interfere with the structure of the JSON when it is parsed.",
    "issueDetail": "The application may be vulnerable to DOM-based client-side JSON injection. Data is read from <b>top.name</b> and written to <b>JSON.parse()</b> via the following statement:<ul><li>var d=window.top.name?JSON.parse(window.top.name):{};</li></ul><b>Note:</b> The name of the current window is a valid attack vector for DOM-based vulnerabilities. An attacker can directly control the name of the targeted application's window by using code on their own domain to load the targeted page using either window.open() or an iframe tag, and specifying the desired window name. ",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/azamara/cornerstone-framework-dist/lib/lawnchair-0.6.1.min.js",
                "path": "/azamara/cornerstone-framework-dist/lib/lawnchair-0.6.1.min.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9hemFtYXJhL2Nvcm5lcnN0b25lLWZyYW1ld29yay1kaXN0L2xpYi9sYXduY2hhaXItMC42LjEubWluLmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNTU4Mg0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAxODo0MzowMCBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMTg6NDI6NTcgR01UDQoNCnZhciBMYXduY2hhaXI9ZnVuY3Rpb24oYyxmKXtpZighKHRoaXMgaW5zdGFuY2VvZiBMYXduY2hhaXIpKXJldHVybiBuZXcgTGF3bmNoYWlyKGMsZik7aWYoIUpTT04pdGhyb3ciSlNPTiB1bmF2YWlsYWJsZSEgSW5jbHVkZSBodHRwOi8vd3d3Lmpzb24ub3JnL2pzb24yLmpzIHRvIGZpeC4iO2lmKGFyZ3VtZW50cy5sZW5ndGg8PTImJmFyZ3VtZW50cy5sZW5ndGg+MCl7Zj10eXBlb2YgYXJndW1lbnRzWzBdPT09ImZ1bmN0aW9uIj9hcmd1bWVudHNbMF06YXJndW1lbnRzWzFdO2M9dHlwZW9mIGFyZ3VtZW50c1swXT09PSJmdW5jdGlvbiI/e306YXJndW1lbnRzWzBdfWVsc2UgdGhyb3ciSW5jb3JyZWN0ICMgb2YgY3RvciBhcmdzISI7aWYodHlwZW9mIGYhPT0iZnVuY3Rpb24iKXRocm93Ik5vIGNhbGxiYWNrIHdhcyBwcm92aWRlZCI7dGhpcy5yZWNvcmQ9Yy5yZWNvcmR8fCJyZWNvcmQiO3RoaXMubmFtZT1jLm5hbWV8fCJyZWNvcmRzIjt2YXIgZDtpZihjLmFkYXB0ZXIpZm9yKHZhciBhPQowLGI9TGF3bmNoYWlyLmFkYXB0ZXJzLmxlbmd0aDthPGI7YSsrKXtpZihMYXduY2hhaXIuYWRhcHRlcnNbYV0uYWRhcHRlcj09PWMuYWRhcHRlcil7ZD1MYXduY2hhaXIuYWRhcHRlcnNbYV0udmFsaWQoKT9MYXduY2hhaXIuYWRhcHRlcnNbYV06dW5kZWZpbmVkO2JyZWFrfX1lbHNle2E9MDtmb3IoYj1MYXduY2hhaXIuYWRhcHRlcnMubGVuZ3RoO2E8YjthKyspaWYoZD1MYXduY2hhaXIuYWRhcHRlcnNbYV0udmFsaWQoKT9MYXduY2hhaXIuYWRhcHRlcnNbYV06dW5kZWZpbmVkKWJyZWFrfWlmKCFkKXRocm93Ik5vIHZhbGlkIGFkYXB0ZXIuIjtmb3IodmFyIGUgaW4gZCl0aGlzW2VdPWRbZV07YT0wO2ZvcihiPUxhd25jaGFpci5wbHVnaW5zLmxlbmd0aDthPGI7YSsrKUxhd25jaGFpci5wbHVnaW5zW2FdLmNhbGwodGhpcyk7dGhpcy5pbml0KGMsZil9O0xhd25jaGFpci5hZGFwdGVycz1bXTsKTGF3bmNoYWlyLmFkYXB0ZXI9ZnVuY3Rpb24oYyxmKXtmLmFkYXB0ZXI9Yzt2YXIgZD0iYWRhcHRlciB2YWxpZCBpbml0IGtleXMgc2F2ZSBiYXRjaCBnZXQgZXhpc3RzIGFsbCByZW1vdmUgbnVrZSIuc3BsaXQoIiAiKSxhPXRoaXMucHJvdG90eXBlLmluZGV4T2YsYjtmb3IoYiBpbiBmKWlmKGEoZCxiKT09PS0xKXRocm93IkludmFsaWQgYWRhcHRlciEgTm9uc3RhbmRhcmQgbWV0aG9kOiAiK2I7TGF3bmNoYWlyLmFkYXB0ZXJzLnNwbGljZSgwLDAsZil9O0xhd25jaGFpci5wbHVnaW5zPVtdO0xhd25jaGFpci5wbHVnaW49ZnVuY3Rpb24oYyl7Zm9yKHZhciBmIGluIGMpZj09PSJpbml0Ij9MYXduY2hhaXIucGx1Z2lucy5wdXNoKGNbZl0pOnRoaXMucHJvdG90eXBlW2ZdPWNbZl19OwpMYXduY2hhaXIucHJvdG90eXBlPXtpc0FycmF5OkFycmF5LmlzQXJyYXl8fGZ1bmN0aW9uKGMpe3JldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYyk9PT0iW29iamVjdCBBcnJheV0ifSxpbmRleE9mOmZ1bmN0aW9uKGMsZixkLGEpe2lmKGMuaW5kZXhPZilyZXR1cm4gYy5pbmRleE9mKGYpO2Q9MDtmb3IoYT1jLmxlbmd0aDtkPGE7ZCsrKWlmKGNbZF09PT1mKXJldHVybiBkO3JldHVybi0xfSxsYW1iZGE6ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZm4odGhpcy5yZWNvcmQsYyl9LGZuOmZ1bmN0aW9uKGMsZil7cmV0dXJuIHR5cGVvZiBmPT0ic3RyaW5nIj9uZXcgRnVuY3Rpb24oYyxmKTpmfSx1dWlkOmZ1bmN0aW9uKCl7dmFyIGM9ZnVuY3Rpb24oKXtyZXR1cm4oKDErTWF0aC5yYW5kb20oKSkqNjU1MzZ8MCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKX07cmV0dXJuIGMoKStjKCkrIi0iK2MoKSsiLSIrYygpKyItIitjKCkrIi0iK2MoKStjKCkrYygpfSxlYWNoOmZ1bmN0aW9uKGMpe3ZhciBmPQp0aGlzLmxhbWJkYShjKTtpZih0aGlzLl9fcmVzdWx0cyl7Yz0wO2Zvcih2YXIgZD10aGlzLl9fcmVzdWx0cy5sZW5ndGg7YzxkO2MrKylmLmNhbGwodGhpcyx0aGlzLl9fcmVzdWx0c1tjXSxjKX1lbHNlIHRoaXMuYWxsKGZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGU9YS5sZW5ndGg7YjxlO2IrKylmLmNhbGwodGhpcyxhW2JdLGIpfSk7cmV0dXJuIHRoaXN9fTsKTGF3bmNoYWlyLmFkYXB0ZXIoImRvbSIsZnVuY3Rpb24oKXt2YXIgYz13aW5kb3cubG9jYWxTdG9yYWdlLGY9ZnVuY3Rpb24oZCl7cmV0dXJue2tleTpkKyIuX2luZGV4XyIsYWxsOmZ1bmN0aW9uKCl7dmFyIGE9Yy5nZXRJdGVtKHRoaXMua2V5KTtpZihhKWE9SlNPTi5wYXJzZShhKTthPT09bnVsbCYmYy5zZXRJdGVtKHRoaXMua2V5LEpTT04uc3RyaW5naWZ5KFtdKSk7cmV0dXJuIEpTT04ucGFyc2UoYy5nZXRJdGVtKHRoaXMua2V5KSl9LGFkZDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmFsbCgpO2IucHVzaChhKTtjLnNldEl0ZW0odGhpcy5rZXksSlNPTi5zdHJpbmdpZnkoYikpfSxkZWw6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuYWxsKCksZT1bXSxnPTAsaD1iLmxlbmd0aDtnPGg7ZysrKWJbZ10hPWEmJmUucHVzaChiW2ddKTtjLnNldEl0ZW0odGhpcy5rZXksSlNPTi5zdHJpbmdpZnkoZSkpfSxmaW5kOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmFsbCgpLGU9MCxnPQpiLmxlbmd0aDtlPGc7ZSsrKWlmKGE9PT1iW2VdKXJldHVybiBlO3JldHVybiBmYWxzZX19fTtyZXR1cm57dmFsaWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIWN9LGluaXQ6ZnVuY3Rpb24oZCxhKXt0aGlzLmluZGV4ZXI9Zih0aGlzLm5hbWUpO2EmJnRoaXMuZm4odGhpcy5uYW1lLGEpLmNhbGwodGhpcyx0aGlzKX0sc2F2ZTpmdW5jdGlvbihkLGEpe3ZhciBiPWQua2V5P3RoaXMubmFtZSsiLiIrZC5rZXk6dGhpcy5uYW1lKyIuIit0aGlzLnV1aWQoKTt0aGlzLmluZGV4ZXIuZmluZChiKT09PWZhbHNlJiZ0aGlzLmluZGV4ZXIuYWRkKGIpO2RlbGV0ZSBkLmtleTtjLnNldEl0ZW0oYixKU09OLnN0cmluZ2lmeShkKSk7ZC5rZXk9Yi5zbGljZSh0aGlzLm5hbWUubGVuZ3RoKzEpO2EmJnRoaXMubGFtYmRhKGEpLmNhbGwodGhpcyxkKTtyZXR1cm4gdGhpc30sYmF0Y2g6ZnVuY3Rpb24oZCxhKXtmb3IodmFyIGI9W10sZT0wLGc9ZC5sZW5ndGg7ZTxnO2UrKyl0aGlzLnNhdmUoZFtlXSxmdW5jdGlvbihoKXtiLnB1c2goaCl9KTsKYSYmdGhpcy5sYW1iZGEoYSkuY2FsbCh0aGlzLGIpO3JldHVybiB0aGlzfSxrZXlzOmZ1bmN0aW9uKGQpe2lmKGQpe3ZhciBhPXRoaXMubmFtZSxiPXRoaXMuaW5kZXhlci5hbGwoKS5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVwbGFjZShhKyIuIiwiIil9KTt0aGlzLmZuKCJrZXlzIixkKS5jYWxsKHRoaXMsYil9cmV0dXJuIHRoaXN9LGdldDpmdW5jdGlvbihkLGEpe2lmKHRoaXMuaXNBcnJheShkKSl7Zm9yKHZhciBiPVtdLGU9MCxnPWQubGVuZ3RoO2U8ZztlKyspe3ZhciBoPXRoaXMubmFtZSsiLiIrZFtlXTtpZihoPWMuZ2V0SXRlbShoKSl7aD1KU09OLnBhcnNlKGgpO2gua2V5PWRbZV07Yi5wdXNoKGgpfX1hJiZ0aGlzLmxhbWJkYShhKS5jYWxsKHRoaXMsYil9ZWxzZXtoPXRoaXMubmFtZSsiLiIrZDtpZihoPWMuZ2V0SXRlbShoKSl7aD1KU09OLnBhcnNlKGgpO2gua2V5PWR9YSYmdGhpcy5sYW1iZGEoYSkuY2FsbCh0aGlzLGgpfXJldHVybiB0aGlzfSxleGlzdHM6ZnVuY3Rpb24oZCwKYSl7dmFyIGI9dGhpcy5pbmRleGVyLmZpbmQodGhpcy5uYW1lKyIuIitkKT09PWZhbHNlP2ZhbHNlOnRydWU7dGhpcy5sYW1iZGEoYSkuY2FsbCh0aGlzLGIpO3JldHVybiB0aGlzfSxhbGw6ZnVuY3Rpb24oZCl7Zm9yKHZhciBhPXRoaXMuaW5kZXhlci5hbGwoKSxiPVtdLGUsZyxoPTAsaT1hLmxlbmd0aDtoPGk7aCsrKXtnPWFbaF07ZT1KU09OLnBhcnNlKGMuZ2V0SXRlbShnKSk7ZS5rZXk9Zy5yZXBsYWNlKHRoaXMubmFtZSsiLiIsIiIpO2IucHVzaChlKX1kJiZ0aGlzLmZuKHRoaXMubmFtZSxkKS5jYWxsKHRoaXMsYik7cmV0dXJuIHRoaXN9LHJlbW92ZTpmdW5jdGlvbihkLGEpe3ZhciBiPXRoaXMubmFtZSsiLiIrKGQua2V5P2Qua2V5OmQpO3RoaXMuaW5kZXhlci5kZWwoYik7Yy5yZW1vdmVJdGVtKGIpO2EmJnRoaXMubGFtYmRhKGEpLmNhbGwodGhpcyk7cmV0dXJuIHRoaXN9LG51a2U6ZnVuY3Rpb24oZCl7dGhpcy5hbGwoZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsZT1hLmxlbmd0aDtiPAplO2IrKyl0aGlzLnJlbW92ZShhW2JdKTtkJiZ0aGlzLmxhbWJkYShkKS5jYWxsKHRoaXMpfSk7cmV0dXJuIHRoaXN9fX0oKSk7Ckxhd25jaGFpci5hZGFwdGVyKCJ3aW5kb3ctbmFtZSIsZnVuY3Rpb24oYyxmKXt2YXIgZD13aW5kb3cudG9wLm5hbWU/SlNPTi5wYXJzZSh3aW5kb3cudG9wLm5hbWUpOnt9O3JldHVybnt2YWxpZDpmdW5jdGlvbigpe3JldHVybiB0eXBlb2Ygd2luZG93LnRvcC5uYW1lIT0idW5kZWZpbmVkIn0saW5pdDpmdW5jdGlvbihhLGIpe2RbdGhpcy5uYW1lXT1kW3RoaXMubmFtZV18fHtpbmRleDpbXSxzdG9yZTp7fX07Yz1kW3RoaXMubmFtZV0uaW5kZXg7Zj1kW3RoaXMubmFtZV0uc3RvcmU7dGhpcy5mbih0aGlzLm5hbWUsYikuY2FsbCh0aGlzLHRoaXMpfSxrZXlzOmZ1bmN0aW9uKGEpe3RoaXMuZm4oImtleXMiLGEpLmNhbGwodGhpcyxjKTtyZXR1cm4gdGhpc30sc2F2ZTpmdW5jdGlvbihhLGIpe3ZhciBlPWEua2V5fHx0aGlzLnV1aWQoKTthLmtleSYmZGVsZXRlIGEua2V5O3RoaXMuZXhpc3RzKGUsZnVuY3Rpb24oZyl7Z3x8Yy5wdXNoKGUpO2ZbZV09YTt3aW5kb3cudG9wLm5hbWU9SlNPTi5zdHJpbmdpZnkoZCk7CmEua2V5PWU7YiYmdGhpcy5sYW1iZGEoYikuY2FsbCh0aGlzLGEpfSk7cmV0dXJuIHRoaXN9LGJhdGNoOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBlPVtdLGc9MCxoPWEubGVuZ3RoO2c8aDtnKyspdGhpcy5zYXZlKGFbZ10sZnVuY3Rpb24oaSl7ZS5wdXNoKGkpfSk7YiYmdGhpcy5sYW1iZGEoYikuY2FsbCh0aGlzLGUpO3JldHVybiB0aGlzfSxnZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgZTtpZih0aGlzLmlzQXJyYXkoYSkpe2U9W107Zm9yKHZhciBnPTAsaD1hLmxlbmd0aDtnPGg7ZysrKWUucHVzaChmW2FbZ11dKX1lbHNlIGlmKGU9ZlthXSllLmtleT1hO2ImJnRoaXMubGFtYmRhKGIpLmNhbGwodGhpcyxlKTtyZXR1cm4gdGhpc30sZXhpc3RzOmZ1bmN0aW9uKGEsYil7dGhpcy5sYW1iZGEoYikuY2FsbCh0aGlzLCEhZlthXSk7cmV0dXJuIHRoaXN9LGFsbDpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sZT0wLGc9Yy5sZW5ndGg7ZTxnO2UrKyl7dmFyIGg9ZltjW2VdXTtoLmtleT1jW2VdOwpiLnB1c2goaCl9dGhpcy5mbih0aGlzLm5hbWUsYSkuY2FsbCh0aGlzLGIpO3JldHVybiB0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGU9dGhpcy5pc0FycmF5KGEpP2E6W2FdLGc9MCxoPWUubGVuZ3RoO2c8aDtnKyspe2RlbGV0ZSBmW2VbZ11dO2Muc3BsaWNlKHRoaXMuaW5kZXhPZihjLGVbZ10pLDEpfXdpbmRvdy50b3AubmFtZT1KU09OLnN0cmluZ2lmeShkKTtiJiZ0aGlzLmxhbWJkYShiKS5jYWxsKHRoaXMpO3JldHVybiB0aGlzfSxudWtlOmZ1bmN0aW9uKGEpe3N0b3JhZ2U9e307Yz1bXTt3aW5kb3cudG9wLm5hbWU9SlNPTi5zdHJpbmdpZnkoZCk7YSYmdGhpcy5sYW1iZGEoYSkuY2FsbCh0aGlzKTtyZXR1cm4gdGhpc319fSgpKTsK",
                "body": "dmFyIExhd25jaGFpcj1mdW5jdGlvbihjLGYpe2lmKCEodGhpcyBpbnN0YW5jZW9mIExhd25jaGFpcikpcmV0dXJuIG5ldyBMYXduY2hhaXIoYyxmKTtpZighSlNPTil0aHJvdyJKU09OIHVuYXZhaWxhYmxlISBJbmNsdWRlIGh0dHA6Ly93d3cuanNvbi5vcmcvanNvbjIuanMgdG8gZml4LiI7aWYoYXJndW1lbnRzLmxlbmd0aDw9MiYmYXJndW1lbnRzLmxlbmd0aD4wKXtmPXR5cGVvZiBhcmd1bWVudHNbMF09PT0iZnVuY3Rpb24iP2FyZ3VtZW50c1swXTphcmd1bWVudHNbMV07Yz10eXBlb2YgYXJndW1lbnRzWzBdPT09ImZ1bmN0aW9uIj97fTphcmd1bWVudHNbMF19ZWxzZSB0aHJvdyJJbmNvcnJlY3QgIyBvZiBjdG9yIGFyZ3MhIjtpZih0eXBlb2YgZiE9PSJmdW5jdGlvbiIpdGhyb3ciTm8gY2FsbGJhY2sgd2FzIHByb3ZpZGVkIjt0aGlzLnJlY29yZD1jLnJlY29yZHx8InJlY29yZCI7dGhpcy5uYW1lPWMubmFtZXx8InJlY29yZHMiO3ZhciBkO2lmKGMuYWRhcHRlcilmb3IodmFyIGE9CjAsYj1MYXduY2hhaXIuYWRhcHRlcnMubGVuZ3RoO2E8YjthKyspe2lmKExhd25jaGFpci5hZGFwdGVyc1thXS5hZGFwdGVyPT09Yy5hZGFwdGVyKXtkPUxhd25jaGFpci5hZGFwdGVyc1thXS52YWxpZCgpP0xhd25jaGFpci5hZGFwdGVyc1thXTp1bmRlZmluZWQ7YnJlYWt9fWVsc2V7YT0wO2ZvcihiPUxhd25jaGFpci5hZGFwdGVycy5sZW5ndGg7YTxiO2ErKylpZihkPUxhd25jaGFpci5hZGFwdGVyc1thXS52YWxpZCgpP0xhd25jaGFpci5hZGFwdGVyc1thXTp1bmRlZmluZWQpYnJlYWt9aWYoIWQpdGhyb3ciTm8gdmFsaWQgYWRhcHRlci4iO2Zvcih2YXIgZSBpbiBkKXRoaXNbZV09ZFtlXTthPTA7Zm9yKGI9TGF3bmNoYWlyLnBsdWdpbnMubGVuZ3RoO2E8YjthKyspTGF3bmNoYWlyLnBsdWdpbnNbYV0uY2FsbCh0aGlzKTt0aGlzLmluaXQoYyxmKX07TGF3bmNoYWlyLmFkYXB0ZXJzPVtdOwpMYXduY2hhaXIuYWRhcHRlcj1mdW5jdGlvbihjLGYpe2YuYWRhcHRlcj1jO3ZhciBkPSJhZGFwdGVyIHZhbGlkIGluaXQga2V5cyBzYXZlIGJhdGNoIGdldCBleGlzdHMgYWxsIHJlbW92ZSBudWtlIi5zcGxpdCgiICIpLGE9dGhpcy5wcm90b3R5cGUuaW5kZXhPZixiO2ZvcihiIGluIGYpaWYoYShkLGIpPT09LTEpdGhyb3ciSW52YWxpZCBhZGFwdGVyISBOb25zdGFuZGFyZCBtZXRob2Q6ICIrYjtMYXduY2hhaXIuYWRhcHRlcnMuc3BsaWNlKDAsMCxmKX07TGF3bmNoYWlyLnBsdWdpbnM9W107TGF3bmNoYWlyLnBsdWdpbj1mdW5jdGlvbihjKXtmb3IodmFyIGYgaW4gYylmPT09ImluaXQiP0xhd25jaGFpci5wbHVnaW5zLnB1c2goY1tmXSk6dGhpcy5wcm90b3R5cGVbZl09Y1tmXX07Ckxhd25jaGFpci5wcm90b3R5cGU9e2lzQXJyYXk6QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24oYyl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChjKT09PSJbb2JqZWN0IEFycmF5XSJ9LGluZGV4T2Y6ZnVuY3Rpb24oYyxmLGQsYSl7aWYoYy5pbmRleE9mKXJldHVybiBjLmluZGV4T2YoZik7ZD0wO2ZvcihhPWMubGVuZ3RoO2Q8YTtkKyspaWYoY1tkXT09PWYpcmV0dXJuIGQ7cmV0dXJuLTF9LGxhbWJkYTpmdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5mbih0aGlzLnJlY29yZCxjKX0sZm46ZnVuY3Rpb24oYyxmKXtyZXR1cm4gdHlwZW9mIGY9PSJzdHJpbmciP25ldyBGdW5jdGlvbihjLGYpOmZ9LHV1aWQ6ZnVuY3Rpb24oKXt2YXIgYz1mdW5jdGlvbigpe3JldHVybigoMStNYXRoLnJhbmRvbSgpKSo2NTUzNnwwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpfTtyZXR1cm4gYygpK2MoKSsiLSIrYygpKyItIitjKCkrIi0iK2MoKSsiLSIrYygpK2MoKStjKCl9LGVhY2g6ZnVuY3Rpb24oYyl7dmFyIGY9CnRoaXMubGFtYmRhKGMpO2lmKHRoaXMuX19yZXN1bHRzKXtjPTA7Zm9yKHZhciBkPXRoaXMuX19yZXN1bHRzLmxlbmd0aDtjPGQ7YysrKWYuY2FsbCh0aGlzLHRoaXMuX19yZXN1bHRzW2NdLGMpfWVsc2UgdGhpcy5hbGwoZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsZT1hLmxlbmd0aDtiPGU7YisrKWYuY2FsbCh0aGlzLGFbYl0sYil9KTtyZXR1cm4gdGhpc319OwpMYXduY2hhaXIuYWRhcHRlcigiZG9tIixmdW5jdGlvbigpe3ZhciBjPXdpbmRvdy5sb2NhbFN0b3JhZ2UsZj1mdW5jdGlvbihkKXtyZXR1cm57a2V5OmQrIi5faW5kZXhfIixhbGw6ZnVuY3Rpb24oKXt2YXIgYT1jLmdldEl0ZW0odGhpcy5rZXkpO2lmKGEpYT1KU09OLnBhcnNlKGEpO2E9PT1udWxsJiZjLnNldEl0ZW0odGhpcy5rZXksSlNPTi5zdHJpbmdpZnkoW10pKTtyZXR1cm4gSlNPTi5wYXJzZShjLmdldEl0ZW0odGhpcy5rZXkpKX0sYWRkOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYWxsKCk7Yi5wdXNoKGEpO2Muc2V0SXRlbSh0aGlzLmtleSxKU09OLnN0cmluZ2lmeShiKSl9LGRlbDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5hbGwoKSxlPVtdLGc9MCxoPWIubGVuZ3RoO2c8aDtnKyspYltnXSE9YSYmZS5wdXNoKGJbZ10pO2Muc2V0SXRlbSh0aGlzLmtleSxKU09OLnN0cmluZ2lmeShlKSl9LGZpbmQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuYWxsKCksZT0wLGc9CmIubGVuZ3RoO2U8ZztlKyspaWYoYT09PWJbZV0pcmV0dXJuIGU7cmV0dXJuIGZhbHNlfX19O3JldHVybnt2YWxpZDpmdW5jdGlvbigpe3JldHVybiEhY30saW5pdDpmdW5jdGlvbihkLGEpe3RoaXMuaW5kZXhlcj1mKHRoaXMubmFtZSk7YSYmdGhpcy5mbih0aGlzLm5hbWUsYSkuY2FsbCh0aGlzLHRoaXMpfSxzYXZlOmZ1bmN0aW9uKGQsYSl7dmFyIGI9ZC5rZXk/dGhpcy5uYW1lKyIuIitkLmtleTp0aGlzLm5hbWUrIi4iK3RoaXMudXVpZCgpO3RoaXMuaW5kZXhlci5maW5kKGIpPT09ZmFsc2UmJnRoaXMuaW5kZXhlci5hZGQoYik7ZGVsZXRlIGQua2V5O2Muc2V0SXRlbShiLEpTT04uc3RyaW5naWZ5KGQpKTtkLmtleT1iLnNsaWNlKHRoaXMubmFtZS5sZW5ndGgrMSk7YSYmdGhpcy5sYW1iZGEoYSkuY2FsbCh0aGlzLGQpO3JldHVybiB0aGlzfSxiYXRjaDpmdW5jdGlvbihkLGEpe2Zvcih2YXIgYj1bXSxlPTAsZz1kLmxlbmd0aDtlPGc7ZSsrKXRoaXMuc2F2ZShkW2VdLGZ1bmN0aW9uKGgpe2IucHVzaChoKX0pOwphJiZ0aGlzLmxhbWJkYShhKS5jYWxsKHRoaXMsYik7cmV0dXJuIHRoaXN9LGtleXM6ZnVuY3Rpb24oZCl7aWYoZCl7dmFyIGE9dGhpcy5uYW1lLGI9dGhpcy5pbmRleGVyLmFsbCgpLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZS5yZXBsYWNlKGErIi4iLCIiKX0pO3RoaXMuZm4oImtleXMiLGQpLmNhbGwodGhpcyxiKX1yZXR1cm4gdGhpc30sZ2V0OmZ1bmN0aW9uKGQsYSl7aWYodGhpcy5pc0FycmF5KGQpKXtmb3IodmFyIGI9W10sZT0wLGc9ZC5sZW5ndGg7ZTxnO2UrKyl7dmFyIGg9dGhpcy5uYW1lKyIuIitkW2VdO2lmKGg9Yy5nZXRJdGVtKGgpKXtoPUpTT04ucGFyc2UoaCk7aC5rZXk9ZFtlXTtiLnB1c2goaCl9fWEmJnRoaXMubGFtYmRhKGEpLmNhbGwodGhpcyxiKX1lbHNle2g9dGhpcy5uYW1lKyIuIitkO2lmKGg9Yy5nZXRJdGVtKGgpKXtoPUpTT04ucGFyc2UoaCk7aC5rZXk9ZH1hJiZ0aGlzLmxhbWJkYShhKS5jYWxsKHRoaXMsaCl9cmV0dXJuIHRoaXN9LGV4aXN0czpmdW5jdGlvbihkLAphKXt2YXIgYj10aGlzLmluZGV4ZXIuZmluZCh0aGlzLm5hbWUrIi4iK2QpPT09ZmFsc2U/ZmFsc2U6dHJ1ZTt0aGlzLmxhbWJkYShhKS5jYWxsKHRoaXMsYik7cmV0dXJuIHRoaXN9LGFsbDpmdW5jdGlvbihkKXtmb3IodmFyIGE9dGhpcy5pbmRleGVyLmFsbCgpLGI9W10sZSxnLGg9MCxpPWEubGVuZ3RoO2g8aTtoKyspe2c9YVtoXTtlPUpTT04ucGFyc2UoYy5nZXRJdGVtKGcpKTtlLmtleT1nLnJlcGxhY2UodGhpcy5uYW1lKyIuIiwiIik7Yi5wdXNoKGUpfWQmJnRoaXMuZm4odGhpcy5uYW1lLGQpLmNhbGwodGhpcyxiKTtyZXR1cm4gdGhpc30scmVtb3ZlOmZ1bmN0aW9uKGQsYSl7dmFyIGI9dGhpcy5uYW1lKyIuIisoZC5rZXk/ZC5rZXk6ZCk7dGhpcy5pbmRleGVyLmRlbChiKTtjLnJlbW92ZUl0ZW0oYik7YSYmdGhpcy5sYW1iZGEoYSkuY2FsbCh0aGlzKTtyZXR1cm4gdGhpc30sbnVrZTpmdW5jdGlvbihkKXt0aGlzLmFsbChmdW5jdGlvbihhKXtmb3IodmFyIGI9MCxlPWEubGVuZ3RoO2I8CmU7YisrKXRoaXMucmVtb3ZlKGFbYl0pO2QmJnRoaXMubGFtYmRhKGQpLmNhbGwodGhpcyl9KTtyZXR1cm4gdGhpc319fSgpKTsKTGF3bmNoYWlyLmFkYXB0ZXIoIndpbmRvdy1uYW1lIixmdW5jdGlvbihjLGYpe3ZhciBkPXdpbmRvdy50b3AubmFtZT9KU09OLnBhcnNlKHdpbmRvdy50b3AubmFtZSk6e307cmV0dXJue3ZhbGlkOmZ1bmN0aW9uKCl7cmV0dXJuIHR5cGVvZiB3aW5kb3cudG9wLm5hbWUhPSJ1bmRlZmluZWQifSxpbml0OmZ1bmN0aW9uKGEsYil7ZFt0aGlzLm5hbWVdPWRbdGhpcy5uYW1lXXx8e2luZGV4OltdLHN0b3JlOnt9fTtjPWRbdGhpcy5uYW1lXS5pbmRleDtmPWRbdGhpcy5uYW1lXS5zdG9yZTt0aGlzLmZuKHRoaXMubmFtZSxiKS5jYWxsKHRoaXMsdGhpcyl9LGtleXM6ZnVuY3Rpb24oYSl7dGhpcy5mbigia2V5cyIsYSkuY2FsbCh0aGlzLGMpO3JldHVybiB0aGlzfSxzYXZlOmZ1bmN0aW9uKGEsYil7dmFyIGU9YS5rZXl8fHRoaXMudXVpZCgpO2Eua2V5JiZkZWxldGUgYS5rZXk7dGhpcy5leGlzdHMoZSxmdW5jdGlvbihnKXtnfHxjLnB1c2goZSk7ZltlXT1hO3dpbmRvdy50b3AubmFtZT1KU09OLnN0cmluZ2lmeShkKTsKYS5rZXk9ZTtiJiZ0aGlzLmxhbWJkYShiKS5jYWxsKHRoaXMsYSl9KTtyZXR1cm4gdGhpc30sYmF0Y2g6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGU9W10sZz0wLGg9YS5sZW5ndGg7ZzxoO2crKyl0aGlzLnNhdmUoYVtnXSxmdW5jdGlvbihpKXtlLnB1c2goaSl9KTtiJiZ0aGlzLmxhbWJkYShiKS5jYWxsKHRoaXMsZSk7cmV0dXJuIHRoaXN9LGdldDpmdW5jdGlvbihhLGIpe3ZhciBlO2lmKHRoaXMuaXNBcnJheShhKSl7ZT1bXTtmb3IodmFyIGc9MCxoPWEubGVuZ3RoO2c8aDtnKyspZS5wdXNoKGZbYVtnXV0pfWVsc2UgaWYoZT1mW2FdKWUua2V5PWE7YiYmdGhpcy5sYW1iZGEoYikuY2FsbCh0aGlzLGUpO3JldHVybiB0aGlzfSxleGlzdHM6ZnVuY3Rpb24oYSxiKXt0aGlzLmxhbWJkYShiKS5jYWxsKHRoaXMsISFmW2FdKTtyZXR1cm4gdGhpc30sYWxsOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxlPTAsZz1jLmxlbmd0aDtlPGc7ZSsrKXt2YXIgaD1mW2NbZV1dO2gua2V5PWNbZV07CmIucHVzaChoKX10aGlzLmZuKHRoaXMubmFtZSxhKS5jYWxsKHRoaXMsYik7cmV0dXJuIHRoaXN9LHJlbW92ZTpmdW5jdGlvbihhLGIpe2Zvcih2YXIgZT10aGlzLmlzQXJyYXkoYSk/YTpbYV0sZz0wLGg9ZS5sZW5ndGg7ZzxoO2crKyl7ZGVsZXRlIGZbZVtnXV07Yy5zcGxpY2UodGhpcy5pbmRleE9mKGMsZVtnXSksMSl9d2luZG93LnRvcC5uYW1lPUpTT04uc3RyaW5naWZ5KGQpO2ImJnRoaXMubGFtYmRhKGIpLmNhbGwodGhpcyk7cmV0dXJuIHRoaXN9LG51a2U6ZnVuY3Rpb24oYSl7c3RvcmFnZT17fTtjPVtdO3dpbmRvdy50b3AubmFtZT1KU09OLnN0cmluZ2lmeShkKTthJiZ0aGlzLmxhbWJkYShhKS5jYWxsKHRoaXMpO3JldHVybiB0aGlzfX19KCkpOwo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 18:42:57 GMT",
                    "Content-Length": "5582",
                    "Date": "Thu, 06 Nov 2014 18:43:00 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}