{
    "url": "http://localhost:9999/pisi/Reel/test/tests.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>location.href</b> and written to <b>location.href</b> via the following statements:<ul><li>url= location.href.replace( /jq=[0-9.a-z\\-]+/, 'jq=' + version );</li><li>location.href= url;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/pisi/Reel/test/tests.js",
                "path": "/pisi/Reel/test/tests.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9waXNpL1JlZWwvdGVzdC90ZXN0cy5qcyBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjgwOA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAwNzowMDowNSBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMDc6MDA6MDMgR01UDQoNCi8qKgogKiAucmVlbCBVbml0IFRlc3QKICovCiggZnVuY3Rpb24gcnVuKCl7CiAgCiAgdmFyCiAgICB0ZXN0X3N1YmplY3RzX3NuYXBzaG90LAogICAgZGVmYXVsdF9qcXVlcnkgPSAnMS4xMC4yJywKICAgIGpxdWVyeV92ZXJzaW9ucyA9IFsKICAgICAgJzIuMS4wLWJldGExJywKICAgICAgJzIuMC4zJywKICAgICAgJzIuMC4yJywKICAgICAgJzIuMC4xJywKICAgICAgJzIuMC4wJywKICAgICAgJzEuMTEuMC1iZXRhMScsCiAgICAgICcxLjEwLjInLAogICAgICAnMS4xMC4xJywKICAgICAgJzEuMTAuMCcsCiAgICAgICcxLjkuMScsCiAgICAgICcxLjkuMCcsCiAgICAgICcxLjguMycsCiAgICAgICcxLjguMicsCiAgICAgICcxLjguMScsCiAgICAgICcxLjguMCcsCiAgICAgICcxLjcuMicsCiAgICAgICcxLjcuMScsCiAgICAgICcxLjcnLAogICAgICAnMS42LjQnLAogICAgICAnMS42LjMnLAogICAgICAnMS42LjInLAogICAgICAnYWxsJwogICAgXSwKICAgIHZlcnNpb24gPSBsb2NhdGlvbi5wYXJhbXMuanEsCiAgICB2ZXJzaW9uID0gaXNOYU4oK3ZlcnNpb24pIHx8IHZlcnNpb24gPCBqcXVlcnlfdmVyc2lvbnMubGVuZ3RoID8gdmVyc2lvbiA6IDEsCiAgICB1c2VfanF1ZXJ5ID0gaXNOYU4oK3ZlcnNpb24pID8gdmVyc2lvbiA6IGpxdWVyeV92ZXJzaW9uc1t2ZXJzaW9uIC0gMV0KCiAgeWVwbm9wZSggewogICAgbG9hZDogWwogICAgICAnaHR0cDovL2NvZGUuanF1ZXJ5LmNvbS9qcXVlcnktJysodXNlX2pxdWVyeSB8fCBkZWZhdWx0X2pxdWVyeSkrJy5taW4uanMnLAogICAgICAnbGliL3ZlbmRvci9qcXVlcnkueGRvbWFpbnJlcXVlc3QuanMnLAogICAgICAnLi4vanF1ZXJ5LnJlZWwuanM/JysoK25ldyBEYXRlKCkpLAogICAgICAnbGliL3ZlbmRvci9qcXVlcnkubW91c2V3aGVlbC1taW4uanMnLAoKICAgICAgJ2xpYi92ZW5kb3IvcXVuaXQuanMnLAogICAgICAnbGliL3ZlbmRvci9qcXVlcnkuY29va2llLW1pbi5qcycsCiAgICAgICdsaWIvcXVueS5qcycsCgogICAgICAndW5pdC9zcHJpdGUuanM/JysoK25ldyBEYXRlKCkpLAogICAgICAndW5pdC9zZWxlY3Rvci5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L3JlbmRlcmluZy5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L29wdGlvbnMuanM/JysoK25ldyBEYXRlKCkpLAogICAgICAndW5pdC9pc3N1ZXMuanM/JysoK25ldyBEYXRlKCkpLAogICAgICAndW5pdC9pbnRlcmFjdGlvbi5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L2V2ZW50cy5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L2RhdGEuanM/JysoK25ldyBEYXRlKCkpLAogICAgICAndW5pdC9jb21wdXRhdGlvbi5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L2FwaS5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L2Fubm90YXRpb25zLmpzPycrKCtuZXcgRGF0ZSgpKSwKICAgICAgJ3VuaXQvYW5pbWF0aW9uLmpzPycrKCtuZXcgRGF0ZSgpKQogICAgXSwKICAgIGNvbXBsZXRlOiBmdW5jdGlvbigpewoKICAgICAgdmFyCiAgICAgICAgZGF3bj0gK25ldyBEYXRlKCksCiAgICAgICAgYmFkcz0gMCwKICAgICAgICBjb3VudHM9IDAKCiAgICAgIHRlc3Rfc3ViamVjdHNfc25hcHNob3Q9ICQoJyNCb2R5JykuaHRtbCgpOwoKICAgICAgUVVuaXQubG9hZCgpOwogICAgICBRVW5pdC5zdG9wKCk7CgogICAgICBRVW5pdC50ZXN0RG9uZSA9IGZ1bmN0aW9uKHRlc3ROYW1lLCBiYWQsIGNvdW50KSB7CiAgICAgICAgYmFkICYmIChiYWRzKz0gYmFkKTsKICAgICAgICBjb3VudHMrPSBjb3VudDsKICAgICAgICAkKCcjcXVuaXQtYmFubmVyIC5wYXNzJykudGV4dChjb3VudHMgLSBiYWRzKTsKICAgICAgICAkKCcjcXVuaXQtYmFubmVyIC5mYWlsJykudGV4dChiYWRzIHx8ICcnKTsKICAgICAgfQoKICAgICAgUVVuaXQuZG9uZSA9IGZ1bmN0aW9uKGZhaWx1cmVzLCB0b3RhbCwgY29uZmlnKSB7CiAgICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdkb25lJyk7CiAgICAgICAgaWYgKGZhaWx1cmVzKXsKICAgICAgICAgIGxvY2F0aW9uLnBhcmFtcy5yZXNwYXduICYmICQoJyNxdW5pdC1maWx0ZXItcGFzcycpLmNsaWNrKCk7CiAgICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ2ZhaWx1cmUnKTsKICAgICAgICAgICQoJyNjYWxsIGgyIC5udW1iZXInKS50ZXh0KGZhaWx1cmVzKTsKICAgICAgICAgIGZhaWx1cmVzIDw9IDEgJiYgJCgnI2ZhaWx1cmUgaDIgLnBsdXJhbCcpLmhpZGUoKTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnc3VjY2VzcycpOwogICAgICAgIH0KICAgICAgICAkKCcjcXVuaXQtdGVzdHJ1bm5lci10b29sYmFyJykuc2hvdygpOwoKICAgICAgICAvKgogICAgICAgICAqIFJlc3VsdHMgb2YgdGhlIGp1c3QgZmluaXNoZWQgdGVzdHJ1biBhcmUgYXV0b21hdGljYWxseSBzdWJtaXR0ZWQKICAgICAgICAgKiBhbmQgY29sbGVjdGVkIG9uIHRoZSBSZWVsIHdlYnNlcnZlciBhcyBhIGtpbmQgb2YgZGlzdHJpYnV0ZWQKICAgICAgICAgKiB0ZXN0aW5nIGVmZm9ydC4gVGhhbmtzIGZvciBiZWluZyBhIHBhcnQgb2YgaXQhCiAgICAgICAgICoKICAgICAgICAgKiBEYXRhIGNvbGxlY3RlZDoKICAgICAgICAgKiAtIHRpbWVzdGFtcAogICAgICAgICAqIC0gY291bnRzICh0b3RhbCBudW1iZXIgb2YgdGVzdHMsIGZhaWxzIGFuZCBwYXNzZXMpCiAgICAgICAgICogLSBmYWlsdXJlcyB0aGVtc2VsdmVzCiAgICAgICAgICogLSB2ZXJzaW9ucyAodmVyc2lvbiBvZiBqUXVlcnkgYW5kIFJlZWwpCiAgICAgICAgICogLSB0aGUgcmVzdWx0cyBzdW1tYXJ5IGxpbmUgd2l0aCBkdXJhdGlvbgogICAgICAgICAqIC0gdXNlciBhZ2VudCBzdHJpbmcgKHlvdXIgYnJvd3NlciBuYW1lIGFuZCBpdHMgdmVyc2lvbihzKSkKICAgICAgICAgKiAtIHRlc3QgaG9zdCBkb21haW4KICAgICAgICAgKi8KICAgICAgICB2YXIKICAgICAgICAgIC8vc2VydmVyPSAnaHR0cDovL2F1OjQ1NjcnLAogICAgICAgICAgc2VydmVyPSAnaHR0cDovL3JlZWwzNjAub3JnJywKICAgICAgICAgIHRpbWVzdGFtcD0gK25ldyBEYXRlKCksCiAgICAgICAgICByZXBvcnQ9IHsKICAgICAgICAgICAgdGltZXN0YW1wOiAgdGltZXN0YW1wLAogICAgICAgICAgICBkdXJhdGlvbjogICBxdW5pdF9jb21wbGV0ZWRfaW4sCiAgICAgICAgICAgIGhvc3Q6ICAgICAgIGxvY2F0aW9uLmhvc3QsCiAgICAgICAgICAgIGZpbHRlcjogICAgIGNvbmZpZy5maWx0ZXJzLAogICAgICAgICAgICBjb3VudDogewogICAgICAgICAgICAgIHRvdGFsOiAgICB0b3RhbCwKICAgICAgICAgICAgICBwYXNzOiAgICAgdG90YWwgLSBmYWlsdXJlcywKICAgICAgICAgICAgICBmYWlsOiAgICAgZmFpbHVyZXMKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZmFpbHM6ICAgICAgZHVtcCgkKCcjcXVuaXQtdGVzdHMgbGkuZmFpbCcpKSwKICAgICAgICAgICAgdmVyc2lvbjogewogICAgICAgICAgICAgIGpxdWVyeTogICAkKCkuanF1ZXJ5LAogICAgICAgICAgICAgIHJlZWw6ICAgICAkLnJlZWwudmVyc2lvbgogICAgICAgICAgICB9LAogICAgICAgICAgICByZXN1bHRzOiAgICAkKCcjcXVuaXQtdGVzdHJlc3VsdCcpLmh0bWwoKSwKICAgICAgICAgICAgYWdlbnQ6ICAgICAgJCgnI3F1bml0LXVzZXJBZ2VudCcpLmh0bWwoKQogICAgICAgICAgfQoKICAgICAgICAkKCc8YS8+JywgeyBuYW1lOiAncmVjZWlwdCcgfSkuYXBwZW5kVG8oJyNxdW5pdC10ZXN0cmVzdWx0Jyk7CiAgICAgICAgZm9ybWF0dGVkKHJlcG9ydCwgJ1N1bW1hcnknKS5hcHBlbmRUbyggJCgnPHVsLz4nKS5hcHBlbmRUbygnI3JlY2VpcHQnKSApOwoKICAgICAgICAkLmFqYXgoewogICAgICAgICAgdXJsOiBzZXJ2ZXIrJy9jb2xsZWN0L3JlZWwvdGVzdHJ1bi9yZXN1bHRzJywKICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgZGF0YVR5cGU6ICdqc29uJywKICAgICAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgICAgIGRhdGE6IHJlcG9ydAogICAgICAgIH0pOwoKICAgICAgICBpZiAoIWlzTmFOKCt2ZXJzaW9uKSAmJiAhZmFpbHVyZXMpewogICAgICAgICAgaWYgKCsrdmVyc2lvbiA8IGpxdWVyeV92ZXJzaW9ucy5sZW5ndGgpewogICAgICAgICAgICB2YXIgdXJsPSBsb2NhdGlvbi5ocmVmLnJlcGxhY2UoIC9qcT1bMC05LmEtelwtXSsvLCAnanE9JyArIHZlcnNpb24gKTsKICAgICAgICAgICAgdmFyIGludGVydmFsPSA1MDAwOwogICAgICAgICAgfQogICAgICAgIH1lbHNlIGlmIChsb2NhdGlvbi5wYXJhbXMucmVzcGF3bil7CiAgICAgICAgICB2YXIgdXJsPSBsb2NhdGlvbi5ocmVmOwogICAgICAgICAgdmFyIGludGVydmFsPSA2MDAwMDsKICAgICAgICB9CgogICAgICAgIHVybCAmJiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICAgICAgICBsb2NhdGlvbi5ocmVmPSB1cmw7CiAgICAgICAgfSwgaW50ZXJ2YWwpOwoKICAgICAgICBmdW5jdGlvbiBmb3JtYXR0ZWQoIGJpdCwgbGFiZWwgKXsKICAgICAgICAgIHZhciAkcmVzdWx0PSAkKCc8bGkvPicpCiAgICAgICAgICBpZiggdHlwZW9mIGJpdCA9PSAnb2JqZWN0JyApewogICAgICAgICAgICBpZiggdHlwZW9mIGJpdC5sZW5ndGggIT0gJ251bWJlcicgfHwgYml0Lmxlbmd0aCA+IDAgKXsgLy8gT2JqZWN0L0FycmF5CiAgICAgICAgICAgICAgJHJlc3VsdC50ZXh0KCBsYWJlbCsnOicgKTsKICAgICAgICAgICAgICB2YXIgJGxpc3Q9ICQoJzx1bC8+JykuYXBwZW5kVG8oICRyZXN1bHQgKQogICAgICAgICAgICAgICQuZWFjaCggYml0LCBmdW5jdGlvbiggbGFiZWwsIHZhbHVlICl7CiAgICAgICAgICAgICAgICAkbGlzdC5hcHBlbmQoIGZvcm1hdHRlZCh2YWx1ZSwgbGFiZWwpICk7CiAgICAgICAgICAgICAgfSApOwogICAgICAgICAgICB9CiAgICAgICAgICB9ZWxzZXsgLy8gVmFsdWUKICAgICAgICAgICAgJHJlc3VsdC5odG1sKCBsYWJlbCsnOiAnK2JpdCApOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuICRyZXN1bHQKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGR1bXAoJGNvbGxlY3Rpb24pewogICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBbXTsKICAgICAgICAgICRjb2xsZWN0aW9uLmVhY2goZnVuY3Rpb24oKXsKICAgICAgICAgICAgY29sbGVjdGlvbi5wdXNoKCQodGhpcykuaHRtbCgpKQogICAgICAgICAgfSkKICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uOwogICAgICAgIH0KICAgICAgfQoKICAgICAgJC5lYWNoKGpxdWVyeV92ZXJzaW9ucywgZnVuY3Rpb24oaXgsIHZlcnNpb24pewogICAgICAgICQoJzxvcHRpb24+JywgeyB2YWx1ZTogdmVyc2lvbiwgdGV4dDogdmVyc2lvbiB9KS5hcHBlbmRUbygnI2FnYWluc3QtanF1ZXJ5LXZlcnNpb25zJyk7CiAgICAgIH0pOwoKICAgICAgJCgnI2FnYWluc3QtanF1ZXJ5LXZlcnNpb25zJykKICAgICAgLnZhbCggdXNlX2pxdWVyeSApCiAgICAgIC5jaGFuZ2UoIGZ1bmN0aW9uKCl7CiAgICAgICAgdmFyIHVybD0gJyc7CiAgICAgICAgdmFyIHZlcnNpb249ICQodGhpcykudmFsKCkgPT0gJ2FsbCcgPyAxIDogJCh0aGlzKS52YWwoKTsKICAgICAgICBpZiggbG9jYXRpb24ucGFyYW1zLmpxID09PSB1bmRlZmluZWQgKXsKICAgICAgICAgIGlmKCBsb2NhdGlvbi5zZWFyY2ggPT09ICcnICl7CiAgICAgICAgICAgIHVybD0gbG9jYXRpb24uaHJlZi5yZXBsYWNlKCAvXD8kLywgJycgKSArICc/anE9JyArIHZlcnNpb24KICAgICAgICAgIH1lbHNlewogICAgICAgICAgICB1cmw9IGxvY2F0aW9uLmhyZWYgKyAnJmpxPScgKyB2ZXJzaW9uCiAgICAgICAgICB9CiAgICAgICAgfWVsc2V7CiAgICAgICAgICB1cmw9IGxvY2F0aW9uLmhyZWYucmVwbGFjZSggL2pxPVswLTkuYS16XC1dKy8sICdqcT0nICsgdmVyc2lvbiApOwogICAgICAgIH0KICAgICAgICBsb2NhdGlvbi5ocmVmPSB1cmw7CiAgICAgIH0gKQoKICAgICAgdmFyIG9sZHN0YXJ0PSB3aW5kb3cuc3RhcnQ7CiAgICAgIHdpbmRvdy5zdGFydD0gZnVuY3Rpb24oKXsKICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoJy50ZXN0Jyk7CiAgICAgICAgb2xkc3RhcnQoKTsKICAgICAgfQoKICAgIH0KICB9ICk7CgogIHJlZWxfdGVzdF9tb2R1bGVfcm91dGluZT0gewogICAgc2V0dXA6IGZ1bmN0aW9uKCl7CiAgICAgICQucmVlbC5pbnRlbnNlPSB0cnVlOwogICAgfSwKICAgIHRlYXJkb3duOiBmdW5jdGlvbigpewogICAgICAkKCcjQm9keSAqJykuYWRkKGRvY3VtZW50KS51bmJpbmQoJy50ZXN0Jyk7CiAgICAgICQucmVlbC5pbnN0YW5jZXMudW5yZWVsKCk7CiAgICAgICQoJyNteV9kYXRhX2NvbmZpZ3VyZWRfaW1hZ2UnKS5yZW1vdmUoKTsKICAgICAgJCgnI0JvZHkgLm5vX2lkJykucmVtb3ZlQXR0cignaWQnKTsKCiAgICAgIC8vIFZlcmlmeSB0aGUgaW50ZWdyaXR5IG9mIHRlc3Qgc2FtcGxlcwogICAgICBRVW5pdC5zdG9wKCk7CiAgICAgIGlmICgkKCcjQm9keScpLmh0bWwoKSA9PT0gdGVzdF9zdWJqZWN0c19zbmFwc2hvdCl7CiAgICAgICAgUVVuaXQuc3RhcnQoKTsKICAgICAgfWVsc2V7CiAgICAgICAgY29uc29sZS5lcnJvcignVGVzdCBzdWJqZWN0cyBpbnRlcmdyaXR5IGhhcyBiZWVuIGNvbXByb21pc2VkOicpOwogICAgICAgIGNvbnNvbGUuaW5mbyggJCgnI0JvZHknKS5odG1sKCkgKTsKICAgICAgICBjb25zb2xlLndhcm4oJy4uLiBzaG91bGQgaGF2ZSByZWFkOicpOwogICAgICAgIGNvbnNvbGUuaW5mbyggdGVzdF9zdWJqZWN0c19zbmFwc2hvdCApOwogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhbiBub3QgY29udGludWUuLi4nKTsKICAgICAgfQogICAgfQogIH0KCn0gKSgpOwo=",
                "body": "LyoqCiAqIC5yZWVsIFVuaXQgVGVzdAogKi8KKCBmdW5jdGlvbiBydW4oKXsKICAKICB2YXIKICAgIHRlc3Rfc3ViamVjdHNfc25hcHNob3QsCiAgICBkZWZhdWx0X2pxdWVyeSA9ICcxLjEwLjInLAogICAganF1ZXJ5X3ZlcnNpb25zID0gWwogICAgICAnMi4xLjAtYmV0YTEnLAogICAgICAnMi4wLjMnLAogICAgICAnMi4wLjInLAogICAgICAnMi4wLjEnLAogICAgICAnMi4wLjAnLAogICAgICAnMS4xMS4wLWJldGExJywKICAgICAgJzEuMTAuMicsCiAgICAgICcxLjEwLjEnLAogICAgICAnMS4xMC4wJywKICAgICAgJzEuOS4xJywKICAgICAgJzEuOS4wJywKICAgICAgJzEuOC4zJywKICAgICAgJzEuOC4yJywKICAgICAgJzEuOC4xJywKICAgICAgJzEuOC4wJywKICAgICAgJzEuNy4yJywKICAgICAgJzEuNy4xJywKICAgICAgJzEuNycsCiAgICAgICcxLjYuNCcsCiAgICAgICcxLjYuMycsCiAgICAgICcxLjYuMicsCiAgICAgICdhbGwnCiAgICBdLAogICAgdmVyc2lvbiA9IGxvY2F0aW9uLnBhcmFtcy5qcSwKICAgIHZlcnNpb24gPSBpc05hTigrdmVyc2lvbikgfHwgdmVyc2lvbiA8IGpxdWVyeV92ZXJzaW9ucy5sZW5ndGggPyB2ZXJzaW9uIDogMSwKICAgIHVzZV9qcXVlcnkgPSBpc05hTigrdmVyc2lvbikgPyB2ZXJzaW9uIDoganF1ZXJ5X3ZlcnNpb25zW3ZlcnNpb24gLSAxXQoKICB5ZXBub3BlKCB7CiAgICBsb2FkOiBbCiAgICAgICdodHRwOi8vY29kZS5qcXVlcnkuY29tL2pxdWVyeS0nKyh1c2VfanF1ZXJ5IHx8IGRlZmF1bHRfanF1ZXJ5KSsnLm1pbi5qcycsCiAgICAgICdsaWIvdmVuZG9yL2pxdWVyeS54ZG9tYWlucmVxdWVzdC5qcycsCiAgICAgICcuLi9qcXVlcnkucmVlbC5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICdsaWIvdmVuZG9yL2pxdWVyeS5tb3VzZXdoZWVsLW1pbi5qcycsCgogICAgICAnbGliL3ZlbmRvci9xdW5pdC5qcycsCiAgICAgICdsaWIvdmVuZG9yL2pxdWVyeS5jb29raWUtbWluLmpzJywKICAgICAgJ2xpYi9xdW55LmpzJywKCiAgICAgICd1bml0L3Nwcml0ZS5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L3NlbGVjdG9yLmpzPycrKCtuZXcgRGF0ZSgpKSwKICAgICAgJ3VuaXQvcmVuZGVyaW5nLmpzPycrKCtuZXcgRGF0ZSgpKSwKICAgICAgJ3VuaXQvb3B0aW9ucy5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L2lzc3Vlcy5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L2ludGVyYWN0aW9uLmpzPycrKCtuZXcgRGF0ZSgpKSwKICAgICAgJ3VuaXQvZXZlbnRzLmpzPycrKCtuZXcgRGF0ZSgpKSwKICAgICAgJ3VuaXQvZGF0YS5qcz8nKygrbmV3IERhdGUoKSksCiAgICAgICd1bml0L2NvbXB1dGF0aW9uLmpzPycrKCtuZXcgRGF0ZSgpKSwKICAgICAgJ3VuaXQvYXBpLmpzPycrKCtuZXcgRGF0ZSgpKSwKICAgICAgJ3VuaXQvYW5ub3RhdGlvbnMuanM/JysoK25ldyBEYXRlKCkpLAogICAgICAndW5pdC9hbmltYXRpb24uanM/JysoK25ldyBEYXRlKCkpCiAgICBdLAogICAgY29tcGxldGU6IGZ1bmN0aW9uKCl7CgogICAgICB2YXIKICAgICAgICBkYXduPSArbmV3IERhdGUoKSwKICAgICAgICBiYWRzPSAwLAogICAgICAgIGNvdW50cz0gMAoKICAgICAgdGVzdF9zdWJqZWN0c19zbmFwc2hvdD0gJCgnI0JvZHknKS5odG1sKCk7CgogICAgICBRVW5pdC5sb2FkKCk7CiAgICAgIFFVbml0LnN0b3AoKTsKCiAgICAgIFFVbml0LnRlc3REb25lID0gZnVuY3Rpb24odGVzdE5hbWUsIGJhZCwgY291bnQpIHsKICAgICAgICBiYWQgJiYgKGJhZHMrPSBiYWQpOwogICAgICAgIGNvdW50cys9IGNvdW50OwogICAgICAgICQoJyNxdW5pdC1iYW5uZXIgLnBhc3MnKS50ZXh0KGNvdW50cyAtIGJhZHMpOwogICAgICAgICQoJyNxdW5pdC1iYW5uZXIgLmZhaWwnKS50ZXh0KGJhZHMgfHwgJycpOwogICAgICB9CgogICAgICBRVW5pdC5kb25lID0gZnVuY3Rpb24oZmFpbHVyZXMsIHRvdGFsLCBjb25maWcpIHsKICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ2RvbmUnKTsKICAgICAgICBpZiAoZmFpbHVyZXMpewogICAgICAgICAgbG9jYXRpb24ucGFyYW1zLnJlc3Bhd24gJiYgJCgnI3F1bml0LWZpbHRlci1wYXNzJykuY2xpY2soKTsKICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnZmFpbHVyZScpOwogICAgICAgICAgJCgnI2NhbGwgaDIgLm51bWJlcicpLnRleHQoZmFpbHVyZXMpOwogICAgICAgICAgZmFpbHVyZXMgPD0gMSAmJiAkKCcjZmFpbHVyZSBoMiAucGx1cmFsJykuaGlkZSgpOwogICAgICAgIH1lbHNlewogICAgICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdzdWNjZXNzJyk7CiAgICAgICAgfQogICAgICAgICQoJyNxdW5pdC10ZXN0cnVubmVyLXRvb2xiYXInKS5zaG93KCk7CgogICAgICAgIC8qCiAgICAgICAgICogUmVzdWx0cyBvZiB0aGUganVzdCBmaW5pc2hlZCB0ZXN0cnVuIGFyZSBhdXRvbWF0aWNhbGx5IHN1Ym1pdHRlZAogICAgICAgICAqIGFuZCBjb2xsZWN0ZWQgb24gdGhlIFJlZWwgd2Vic2VydmVyIGFzIGEga2luZCBvZiBkaXN0cmlidXRlZAogICAgICAgICAqIHRlc3RpbmcgZWZmb3J0LiBUaGFua3MgZm9yIGJlaW5nIGEgcGFydCBvZiBpdCEKICAgICAgICAgKgogICAgICAgICAqIERhdGEgY29sbGVjdGVkOgogICAgICAgICAqIC0gdGltZXN0YW1wCiAgICAgICAgICogLSBjb3VudHMgKHRvdGFsIG51bWJlciBvZiB0ZXN0cywgZmFpbHMgYW5kIHBhc3NlcykKICAgICAgICAgKiAtIGZhaWx1cmVzIHRoZW1zZWx2ZXMKICAgICAgICAgKiAtIHZlcnNpb25zICh2ZXJzaW9uIG9mIGpRdWVyeSBhbmQgUmVlbCkKICAgICAgICAgKiAtIHRoZSByZXN1bHRzIHN1bW1hcnkgbGluZSB3aXRoIGR1cmF0aW9uCiAgICAgICAgICogLSB1c2VyIGFnZW50IHN0cmluZyAoeW91ciBicm93c2VyIG5hbWUgYW5kIGl0cyB2ZXJzaW9uKHMpKQogICAgICAgICAqIC0gdGVzdCBob3N0IGRvbWFpbgogICAgICAgICAqLwogICAgICAgIHZhcgogICAgICAgICAgLy9zZXJ2ZXI9ICdodHRwOi8vYXU6NDU2NycsCiAgICAgICAgICBzZXJ2ZXI9ICdodHRwOi8vcmVlbDM2MC5vcmcnLAogICAgICAgICAgdGltZXN0YW1wPSArbmV3IERhdGUoKSwKICAgICAgICAgIHJlcG9ydD0gewogICAgICAgICAgICB0aW1lc3RhbXA6ICB0aW1lc3RhbXAsCiAgICAgICAgICAgIGR1cmF0aW9uOiAgIHF1bml0X2NvbXBsZXRlZF9pbiwKICAgICAgICAgICAgaG9zdDogICAgICAgbG9jYXRpb24uaG9zdCwKICAgICAgICAgICAgZmlsdGVyOiAgICAgY29uZmlnLmZpbHRlcnMsCiAgICAgICAgICAgIGNvdW50OiB7CiAgICAgICAgICAgICAgdG90YWw6ICAgIHRvdGFsLAogICAgICAgICAgICAgIHBhc3M6ICAgICB0b3RhbCAtIGZhaWx1cmVzLAogICAgICAgICAgICAgIGZhaWw6ICAgICBmYWlsdXJlcwogICAgICAgICAgICB9LAogICAgICAgICAgICBmYWlsczogICAgICBkdW1wKCQoJyNxdW5pdC10ZXN0cyBsaS5mYWlsJykpLAogICAgICAgICAgICB2ZXJzaW9uOiB7CiAgICAgICAgICAgICAganF1ZXJ5OiAgICQoKS5qcXVlcnksCiAgICAgICAgICAgICAgcmVlbDogICAgICQucmVlbC52ZXJzaW9uCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlc3VsdHM6ICAgICQoJyNxdW5pdC10ZXN0cmVzdWx0JykuaHRtbCgpLAogICAgICAgICAgICBhZ2VudDogICAgICAkKCcjcXVuaXQtdXNlckFnZW50JykuaHRtbCgpCiAgICAgICAgICB9CgogICAgICAgICQoJzxhLz4nLCB7IG5hbWU6ICdyZWNlaXB0JyB9KS5hcHBlbmRUbygnI3F1bml0LXRlc3RyZXN1bHQnKTsKICAgICAgICBmb3JtYXR0ZWQocmVwb3J0LCAnU3VtbWFyeScpLmFwcGVuZFRvKCAkKCc8dWwvPicpLmFwcGVuZFRvKCcjcmVjZWlwdCcpICk7CgogICAgICAgICQuYWpheCh7CiAgICAgICAgICB1cmw6IHNlcnZlcisnL2NvbGxlY3QvcmVlbC90ZXN0cnVuL3Jlc3VsdHMnLAogICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgICAgY2FjaGU6IGZhbHNlLAogICAgICAgICAgZGF0YTogcmVwb3J0CiAgICAgICAgfSk7CgogICAgICAgIGlmICghaXNOYU4oK3ZlcnNpb24pICYmICFmYWlsdXJlcyl7CiAgICAgICAgICBpZiAoKyt2ZXJzaW9uIDwganF1ZXJ5X3ZlcnNpb25zLmxlbmd0aCl7CiAgICAgICAgICAgIHZhciB1cmw9IGxvY2F0aW9uLmhyZWYucmVwbGFjZSggL2pxPVswLTkuYS16XC1dKy8sICdqcT0nICsgdmVyc2lvbiApOwogICAgICAgICAgICB2YXIgaW50ZXJ2YWw9IDUwMDA7CiAgICAgICAgICB9CiAgICAgICAgfWVsc2UgaWYgKGxvY2F0aW9uLnBhcmFtcy5yZXNwYXduKXsKICAgICAgICAgIHZhciB1cmw9IGxvY2F0aW9uLmhyZWY7CiAgICAgICAgICB2YXIgaW50ZXJ2YWw9IDYwMDAwOwogICAgICAgIH0KCiAgICAgICAgdXJsICYmIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgICAgIGxvY2F0aW9uLmhyZWY9IHVybDsKICAgICAgICB9LCBpbnRlcnZhbCk7CgogICAgICAgIGZ1bmN0aW9uIGZvcm1hdHRlZCggYml0LCBsYWJlbCApewogICAgICAgICAgdmFyICRyZXN1bHQ9ICQoJzxsaS8+JykKICAgICAgICAgIGlmKCB0eXBlb2YgYml0ID09ICdvYmplY3QnICl7CiAgICAgICAgICAgIGlmKCB0eXBlb2YgYml0Lmxlbmd0aCAhPSAnbnVtYmVyJyB8fCBiaXQubGVuZ3RoID4gMCApeyAvLyBPYmplY3QvQXJyYXkKICAgICAgICAgICAgICAkcmVzdWx0LnRleHQoIGxhYmVsKyc6JyApOwogICAgICAgICAgICAgIHZhciAkbGlzdD0gJCgnPHVsLz4nKS5hcHBlbmRUbyggJHJlc3VsdCApCiAgICAgICAgICAgICAgJC5lYWNoKCBiaXQsIGZ1bmN0aW9uKCBsYWJlbCwgdmFsdWUgKXsKICAgICAgICAgICAgICAgICRsaXN0LmFwcGVuZCggZm9ybWF0dGVkKHZhbHVlLCBsYWJlbCkgKTsKICAgICAgICAgICAgICB9ICk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH1lbHNleyAvLyBWYWx1ZQogICAgICAgICAgICAkcmVzdWx0Lmh0bWwoIGxhYmVsKyc6ICcrYml0ICk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gJHJlc3VsdAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZHVtcCgkY29sbGVjdGlvbil7CiAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IFtdOwogICAgICAgICAgJGNvbGxlY3Rpb24uZWFjaChmdW5jdGlvbigpewogICAgICAgICAgICBjb2xsZWN0aW9uLnB1c2goJCh0aGlzKS5odG1sKCkpCiAgICAgICAgICB9KQogICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247CiAgICAgICAgfQogICAgICB9CgogICAgICAkLmVhY2goanF1ZXJ5X3ZlcnNpb25zLCBmdW5jdGlvbihpeCwgdmVyc2lvbil7CiAgICAgICAgJCgnPG9wdGlvbj4nLCB7IHZhbHVlOiB2ZXJzaW9uLCB0ZXh0OiB2ZXJzaW9uIH0pLmFwcGVuZFRvKCcjYWdhaW5zdC1qcXVlcnktdmVyc2lvbnMnKTsKICAgICAgfSk7CgogICAgICAkKCcjYWdhaW5zdC1qcXVlcnktdmVyc2lvbnMnKQogICAgICAudmFsKCB1c2VfanF1ZXJ5ICkKICAgICAgLmNoYW5nZSggZnVuY3Rpb24oKXsKICAgICAgICB2YXIgdXJsPSAnJzsKICAgICAgICB2YXIgdmVyc2lvbj0gJCh0aGlzKS52YWwoKSA9PSAnYWxsJyA/IDEgOiAkKHRoaXMpLnZhbCgpOwogICAgICAgIGlmKCBsb2NhdGlvbi5wYXJhbXMuanEgPT09IHVuZGVmaW5lZCApewogICAgICAgICAgaWYoIGxvY2F0aW9uLnNlYXJjaCA9PT0gJycgKXsKICAgICAgICAgICAgdXJsPSBsb2NhdGlvbi5ocmVmLnJlcGxhY2UoIC9cPyQvLCAnJyApICsgJz9qcT0nICsgdmVyc2lvbgogICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIHVybD0gbG9jYXRpb24uaHJlZiArICcmanE9JyArIHZlcnNpb24KICAgICAgICAgIH0KICAgICAgICB9ZWxzZXsKICAgICAgICAgIHVybD0gbG9jYXRpb24uaHJlZi5yZXBsYWNlKCAvanE9WzAtOS5hLXpcLV0rLywgJ2pxPScgKyB2ZXJzaW9uICk7CiAgICAgICAgfQogICAgICAgIGxvY2F0aW9uLmhyZWY9IHVybDsKICAgICAgfSApCgogICAgICB2YXIgb2xkc3RhcnQ9IHdpbmRvdy5zdGFydDsKICAgICAgd2luZG93LnN0YXJ0PSBmdW5jdGlvbigpewogICAgICAgICQoZG9jdW1lbnQpLnVuYmluZCgnLnRlc3QnKTsKICAgICAgICBvbGRzdGFydCgpOwogICAgICB9CgogICAgfQogIH0gKTsKCiAgcmVlbF90ZXN0X21vZHVsZV9yb3V0aW5lPSB7CiAgICBzZXR1cDogZnVuY3Rpb24oKXsKICAgICAgJC5yZWVsLmludGVuc2U9IHRydWU7CiAgICB9LAogICAgdGVhcmRvd246IGZ1bmN0aW9uKCl7CiAgICAgICQoJyNCb2R5IConKS5hZGQoZG9jdW1lbnQpLnVuYmluZCgnLnRlc3QnKTsKICAgICAgJC5yZWVsLmluc3RhbmNlcy51bnJlZWwoKTsKICAgICAgJCgnI215X2RhdGFfY29uZmlndXJlZF9pbWFnZScpLnJlbW92ZSgpOwogICAgICAkKCcjQm9keSAubm9faWQnKS5yZW1vdmVBdHRyKCdpZCcpOwoKICAgICAgLy8gVmVyaWZ5IHRoZSBpbnRlZ3JpdHkgb2YgdGVzdCBzYW1wbGVzCiAgICAgIFFVbml0LnN0b3AoKTsKICAgICAgaWYgKCQoJyNCb2R5JykuaHRtbCgpID09PSB0ZXN0X3N1YmplY3RzX3NuYXBzaG90KXsKICAgICAgICBRVW5pdC5zdGFydCgpOwogICAgICB9ZWxzZXsKICAgICAgICBjb25zb2xlLmVycm9yKCdUZXN0IHN1YmplY3RzIGludGVyZ3JpdHkgaGFzIGJlZW4gY29tcHJvbWlzZWQ6Jyk7CiAgICAgICAgY29uc29sZS5pbmZvKCAkKCcjQm9keScpLmh0bWwoKSApOwogICAgICAgIGNvbnNvbGUud2FybignLi4uIHNob3VsZCBoYXZlIHJlYWQ6Jyk7CiAgICAgICAgY29uc29sZS5pbmZvKCB0ZXN0X3N1YmplY3RzX3NuYXBzaG90ICk7CiAgICAgICAgY29uc29sZS5lcnJvcignQ2FuIG5vdCBjb250aW51ZS4uLicpOwogICAgICB9CiAgICB9CiAgfQoKfSApKCk7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 07:00:03 GMT",
                    "Content-Length": "6808",
                    "Date": "Fri, 07 Nov 2014 07:00:05 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}