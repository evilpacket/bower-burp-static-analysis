{
    "url": "http://localhost:9999/oieduardorabelo/sawpf/src/libs/mootools/1.3.0.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>document.location.pathname</b> and written to <b>the 'open()' function of an XMLHttpRequest object</b> via the following statements:<ul><li>e=document.location.pathname;</li><li>e=e.substr(0,h);</li><li>m.open(d.toUpperCase(),e,this.options.async,this.options.user,this.options.password);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/oieduardorabelo/sawpf/src/libs/mootools/1.3.0.js",
                "path": "/oieduardorabelo/sawpf/src/libs/mootools/1.3.0.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9vaWVkdWFyZG9yYWJlbG8vc2F3cGYvc3JjL2xpYnMvbW9vdG9vbHMvMS4zLjAuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODYyMzgNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkRhdGU6IFNhdCwgMDggTm92IDIwMTQgMDM6NTU6NDEgR01UDQpMYXN0LU1vZGlmaWVkOiBTYXQsIDA4IE5vdiAyMDE0IDAzOjU1OjAwIEdNVA0KDQovKgotLS0KTW9vVG9vbHM6IHRoZSBqYXZhc2NyaXB0IGZyYW1ld29yawoKd2ViIGJ1aWxkOgogLSBodHRwOi8vbW9vdG9vbHMubmV0L2NvcmUvN2M1NmNmZWY5ZGRkY2YxNzBhNWQ2OGUzZmI2MWNmZDcKCnBhY2thZ2VyIGJ1aWxkOgogLSBwYWNrYWdlciBidWlsZCBDb3JlL0NvcmUgQ29yZS9BcnJheSBDb3JlL1N0cmluZyBDb3JlL051bWJlciBDb3JlL0Z1bmN0aW9uIENvcmUvT2JqZWN0IENvcmUvRXZlbnQgQ29yZS9Ccm93c2VyIENvcmUvQ2xhc3MgQ29yZS9DbGFzcy5FeHRyYXMgQ29yZS9TbGljay5QYXJzZXIgQ29yZS9TbGljay5GaW5kZXIgQ29yZS9FbGVtZW50IENvcmUvRWxlbWVudC5TdHlsZSBDb3JlL0VsZW1lbnQuRXZlbnQgQ29yZS9FbGVtZW50LkRpbWVuc2lvbnMgQ29yZS9GeCBDb3JlL0Z4LkNTUyBDb3JlL0Z4LlR3ZWVuIENvcmUvRnguTW9ycGggQ29yZS9GeC5UcmFuc2l0aW9ucyBDb3JlL1JlcXVlc3QgQ29yZS9SZXF1ZXN0LkhUTUwgQ29yZS9SZXF1ZXN0LkpTT04gQ29yZS9Db29raWUgQ29yZS9KU09OIENvcmUvRE9NUmVhZHkgQ29yZS9Td2lmZgoKY29weXJpZ2h0czoKICAtIFtNb29Ub29sc10oaHR0cDovL21vb3Rvb2xzLm5ldCkKCmxpY2Vuc2VzOgogIC0gW01JVCBMaWNlbnNlXShodHRwOi8vbW9vdG9vbHMubmV0L2xpY2Vuc2UudHh0KQouLi4KKi8KKGZ1bmN0aW9uKCl7dGhpcy5Nb29Ub29scz17dmVyc2lvbjoiMS4zIixidWlsZDoiYTNlZWQ2OTJkZDg1MDUwZDgwMTY4ZWMyYzcwOGVmZTkwMWJiN2RiMyJ9O3ZhciBlPXRoaXMudHlwZU9mPWZ1bmN0aW9uKGkpe2lmKGk9PW51bGwpe3JldHVybiJudWxsIjt9aWYoaS4kZmFtaWx5KXtyZXR1cm4gaS4kZmFtaWx5KCk7Cn1pZihpLm5vZGVOYW1lKXtpZihpLm5vZGVUeXBlPT0xKXtyZXR1cm4iZWxlbWVudCI7fWlmKGkubm9kZVR5cGU9PTMpe3JldHVybigvXFMvKS50ZXN0KGkubm9kZVZhbHVlKT8idGV4dG5vZGUiOiJ3aGl0ZXNwYWNlIjt9fWVsc2V7aWYodHlwZW9mIGkubGVuZ3RoPT0ibnVtYmVyIil7aWYoaS5jYWxsZWUpe3JldHVybiJhcmd1bWVudHMiOwp9aWYoIml0ZW0iIGluIGkpe3JldHVybiJjb2xsZWN0aW9uIjt9fX1yZXR1cm4gdHlwZW9mIGk7fTt2YXIgdD10aGlzLmluc3RhbmNlT2Y9ZnVuY3Rpb24odixpKXtpZih2PT1udWxsKXtyZXR1cm4gZmFsc2U7fXZhciB1PXYuJGNvbnN0cnVjdG9yfHx2LmNvbnN0cnVjdG9yOwp3aGlsZSh1KXtpZih1PT09aSl7cmV0dXJuIHRydWU7fXU9dS5wYXJlbnQ7fXJldHVybiB2IGluc3RhbmNlb2YgaTt9O3ZhciBmPXRoaXMuRnVuY3Rpb247dmFyIHE9dHJ1ZTtmb3IodmFyIHAgaW4ge3RvU3RyaW5nOjF9KXtxPW51bGw7fWlmKHEpe3E9WyJoYXNPd25Qcm9wZXJ0eSIsInZhbHVlT2YiLCJpc1Byb3RvdHlwZU9mIiwicHJvcGVydHlJc0VudW1lcmFibGUiLCJ0b0xvY2FsZVN0cmluZyIsInRvU3RyaW5nIiwiY29uc3RydWN0b3IiXTsKfWYucHJvdG90eXBlLm92ZXJsb2FkU2V0dGVyPWZ1bmN0aW9uKHUpe3ZhciBpPXRoaXM7cmV0dXJuIGZ1bmN0aW9uKHcsdil7aWYodz09bnVsbCl7cmV0dXJuIHRoaXM7fWlmKHV8fHR5cGVvZiB3IT0ic3RyaW5nIil7Zm9yKHZhciB4IGluIHcpe2kuY2FsbCh0aGlzLHgsd1t4XSk7Cn1pZihxKXtmb3IodmFyIHk9cS5sZW5ndGg7eS0tOyl7eD1xW3ldO2lmKHcuaGFzT3duUHJvcGVydHkoeCkpe2kuY2FsbCh0aGlzLHgsd1t4XSk7fX19fWVsc2V7aS5jYWxsKHRoaXMsdyx2KTt9cmV0dXJuIHRoaXM7fTt9O2YucHJvdG90eXBlLm92ZXJsb2FkR2V0dGVyPWZ1bmN0aW9uKHUpe3ZhciBpPXRoaXM7CnJldHVybiBmdW5jdGlvbih3KXt2YXIgeCx2O2lmKHV8fHR5cGVvZiB3IT0ic3RyaW5nIil7eD13O31lbHNle2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7eD1hcmd1bWVudHM7fX1pZih4KXt2PXt9O2Zvcih2YXIgeT0wO3k8eC5sZW5ndGg7eSsrKXt2W3hbeV1dPWkuY2FsbCh0aGlzLHhbeV0pOwp9fWVsc2V7dj1pLmNhbGwodGhpcyx3KTt9cmV0dXJuIHY7fTt9O2YucHJvdG90eXBlLmV4dGVuZD1mdW5jdGlvbihpLHUpe3RoaXNbaV09dTt9Lm92ZXJsb2FkU2V0dGVyKCk7Zi5wcm90b3R5cGUuaW1wbGVtZW50PWZ1bmN0aW9uKGksdSl7dGhpcy5wcm90b3R5cGVbaV09dTsKfS5vdmVybG9hZFNldHRlcigpO3ZhciBuPUFycmF5LnByb3RvdHlwZS5zbGljZTtmLmZyb209ZnVuY3Rpb24oaSl7cmV0dXJuKGUoaSk9PSJmdW5jdGlvbiIpP2k6ZnVuY3Rpb24oKXtyZXR1cm4gaTt9O307QXJyYXkuZnJvbT1mdW5jdGlvbihpKXtpZihpPT1udWxsKXtyZXR1cm5bXTsKfXJldHVybihrLmlzRW51bWVyYWJsZShpKSYmdHlwZW9mIGkhPSJzdHJpbmciKT8oZShpKT09ImFycmF5Iik/aTpuLmNhbGwoaSk6W2ldO307TnVtYmVyLmZyb209ZnVuY3Rpb24odSl7dmFyIGk9cGFyc2VGbG9hdCh1KTtyZXR1cm4gaXNGaW5pdGUoaSk/aTpudWxsOwp9O1N0cmluZy5mcm9tPWZ1bmN0aW9uKGkpe3JldHVybiBpKyIiO307Zi5pbXBsZW1lbnQoe2hpZGU6ZnVuY3Rpb24oKXt0aGlzLiRoaWRkZW49dHJ1ZTtyZXR1cm4gdGhpczt9LHByb3RlY3Q6ZnVuY3Rpb24oKXt0aGlzLiRwcm90ZWN0ZWQ9dHJ1ZTtyZXR1cm4gdGhpczsKfX0pO3ZhciBrPXRoaXMuVHlwZT1mdW5jdGlvbih3LHYpe2lmKHcpe3ZhciB1PXcudG9Mb3dlckNhc2UoKTt2YXIgaT1mdW5jdGlvbih4KXtyZXR1cm4oZSh4KT09dSk7fTtrWyJpcyIrd109aTtpZih2IT1udWxsKXt2LnByb3RvdHlwZS4kZmFtaWx5PShmdW5jdGlvbigpe3JldHVybiB1Owp9KS5oaWRlKCk7di50eXBlPWk7fX1pZih2PT1udWxsKXtyZXR1cm4gbnVsbDt9di5leHRlbmQodGhpcyk7di4kY29uc3RydWN0b3I9azt2LnByb3RvdHlwZS4kY29uc3RydWN0b3I9djtyZXR1cm4gdjt9O3ZhciBvPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7ay5pc0VudW1lcmFibGU9ZnVuY3Rpb24oaSl7cmV0dXJuKGkhPW51bGwmJnR5cGVvZiBpLmxlbmd0aD09Im51bWJlciImJm8uY2FsbChpKSE9IltvYmplY3QgRnVuY3Rpb25dIik7Cn07dmFyIGI9e307dmFyIGQ9ZnVuY3Rpb24oaSl7dmFyIHU9ZShpLnByb3RvdHlwZSk7cmV0dXJuIGJbdV18fChiW3VdPVtdKTt9O3ZhciBoPWZ1bmN0aW9uKHYseil7aWYoeiYmei4kaGlkZGVuKXtyZXR1cm4gdGhpczt9dmFyIHU9ZCh0aGlzKTtmb3IodmFyIHc9MDsKdzx1Lmxlbmd0aDt3Kyspe3ZhciB5PXVbd107aWYoZSh5KT09InR5cGUiKXtoLmNhbGwoeSx2LHopO31lbHNle3kuY2FsbCh0aGlzLHYseik7fX12YXIgeD10aGlzLnByb3RvdHlwZVt2XTtpZih4PT1udWxsfHwheC4kcHJvdGVjdGVkKXt0aGlzLnByb3RvdHlwZVt2XT16Owp9aWYodGhpc1t2XT09bnVsbCYmZSh6KT09ImZ1bmN0aW9uIil7cy5jYWxsKHRoaXMsdixmdW5jdGlvbihpKXtyZXR1cm4gei5hcHBseShpLG4uY2FsbChhcmd1bWVudHMsMSkpO30pO31yZXR1cm4gdGhpczt9O3ZhciBzPWZ1bmN0aW9uKGksdil7aWYodiYmdi4kaGlkZGVuKXtyZXR1cm4gdGhpczsKfXZhciB1PXRoaXNbaV07aWYodT09bnVsbHx8IXUuJHByb3RlY3RlZCl7dGhpc1tpXT12O31yZXR1cm4gdGhpczt9O2suaW1wbGVtZW50KHtpbXBsZW1lbnQ6aC5vdmVybG9hZFNldHRlcigpLGV4dGVuZDpzLm92ZXJsb2FkU2V0dGVyKCksYWxpYXM6ZnVuY3Rpb24oaSx1KXtoLmNhbGwodGhpcyxpLHRoaXMucHJvdG90eXBlW3VdKTsKfS5vdmVybG9hZFNldHRlcigpLG1pcnJvcjpmdW5jdGlvbihpKXtkKHRoaXMpLnB1c2goaSk7cmV0dXJuIHRoaXM7fX0pO25ldyBrKCJUeXBlIixrKTt2YXIgYz1mdW5jdGlvbih1LHksdyl7dmFyIHY9KHkhPU9iamVjdCksQz15LnByb3RvdHlwZTtpZih2KXt5PW5ldyBrKHUseSk7Cn1mb3IodmFyIHo9MCx4PXcubGVuZ3RoO3o8eDt6Kyspe3ZhciBEPXdbel0sQj15W0RdLEE9Q1tEXTtpZihCKXtCLnByb3RlY3QoKTt9aWYodiYmQSl7ZGVsZXRlIENbRF07Q1tEXT1BLnByb3RlY3QoKTt9fWlmKHYpe3kuaW1wbGVtZW50KEMpO31yZXR1cm4gYzt9O2MoIlN0cmluZyIsU3RyaW5nLFsiY2hhckF0IiwiY2hhckNvZGVBdCIsImNvbmNhdCIsImluZGV4T2YiLCJsYXN0SW5kZXhPZiIsIm1hdGNoIiwicXVvdGUiLCJyZXBsYWNlIiwic2VhcmNoIiwic2xpY2UiLCJzcGxpdCIsInN1YnN0ciIsInN1YnN0cmluZyIsInRvTG93ZXJDYXNlIiwidG9VcHBlckNhc2UiXSkoIkFycmF5IixBcnJheSxbInBvcCIsInB1c2giLCJyZXZlcnNlIiwic2hpZnQiLCJzb3J0Iiwic3BsaWNlIiwidW5zaGlmdCIsImNvbmNhdCIsImpvaW4iLCJzbGljZSIsImluZGV4T2YiLCJsYXN0SW5kZXhPZiIsImZpbHRlciIsImZvckVhY2giLCJldmVyeSIsIm1hcCIsInNvbWUiLCJyZWR1Y2UiLCJyZWR1Y2VSaWdodCJdKSgiTnVtYmVyIixOdW1iZXIsWyJ0b0V4cG9uZW50aWFsIiwidG9GaXhlZCIsInRvTG9jYWxlU3RyaW5nIiwidG9QcmVjaXNpb24iXSkoIkZ1bmN0aW9uIixmLFsiYXBwbHkiLCJjYWxsIiwiYmluZCJdKSgiUmVnRXhwIixSZWdFeHAsWyJleGVjIiwidGVzdCJdKSgiT2JqZWN0IixPYmplY3QsWyJjcmVhdGUiLCJkZWZpbmVQcm9wZXJ0eSIsImRlZmluZVByb3BlcnRpZXMiLCJrZXlzIiwiZ2V0UHJvdG90eXBlT2YiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwicHJldmVudEV4dGVuc2lvbnMiLCJpc0V4dGVuc2libGUiLCJzZWFsIiwiaXNTZWFsZWQiLCJmcmVlemUiLCJpc0Zyb3plbiJdKSgiRGF0ZSIsRGF0ZSxbIm5vdyJdKTsKT2JqZWN0LmV4dGVuZD1zLm92ZXJsb2FkU2V0dGVyKCk7RGF0ZS5leHRlbmQoIm5vdyIsZnVuY3Rpb24oKXtyZXR1cm4gKyhuZXcgRGF0ZSk7fSk7bmV3IGsoIkJvb2xlYW4iLEJvb2xlYW4pO051bWJlci5wcm90b3R5cGUuJGZhbWlseT1mdW5jdGlvbigpe3JldHVybiBpc0Zpbml0ZSh0aGlzKT8ibnVtYmVyIjoibnVsbCI7Cn0uaGlkZSgpO051bWJlci5leHRlbmQoInJhbmRvbSIsZnVuY3Rpb24odSxpKXtyZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihpLXUrMSkrdSk7fSk7T2JqZWN0LmV4dGVuZCgiZm9yRWFjaCIsZnVuY3Rpb24oaSx2LHcpe2Zvcih2YXIgdSBpbiBpKXtpZihpLmhhc093blByb3BlcnR5KHUpKXt2LmNhbGwodyxpW3VdLHUsaSk7Cn19fSk7T2JqZWN0LmVhY2g9T2JqZWN0LmZvckVhY2g7QXJyYXkuaW1wbGVtZW50KHtmb3JFYWNoOmZ1bmN0aW9uKHcseCl7Zm9yKHZhciB2PTAsdT10aGlzLmxlbmd0aDt2PHU7disrKXtpZih2IGluIHRoaXMpe3cuY2FsbCh4LHRoaXNbdl0sdix0aGlzKTt9fX0sZWFjaDpmdW5jdGlvbihpLHUpe0FycmF5LmZvckVhY2godGhpcyxpLHUpOwpyZXR1cm4gdGhpczt9fSk7dmFyIHI9ZnVuY3Rpb24oaSl7c3dpdGNoKGUoaSkpe2Nhc2UiYXJyYXkiOnJldHVybiBpLmNsb25lKCk7Y2FzZSJvYmplY3QiOnJldHVybiBPYmplY3QuY2xvbmUoaSk7ZGVmYXVsdDpyZXR1cm4gaTt9fTtBcnJheS5pbXBsZW1lbnQoImNsb25lIixmdW5jdGlvbigpe3ZhciB1PXRoaXMubGVuZ3RoLHY9bmV3IEFycmF5KHUpOwp3aGlsZSh1LS0pe3ZbdV09cih0aGlzW3VdKTt9cmV0dXJuIHY7fSk7dmFyIGE9ZnVuY3Rpb24odSxpLHYpe3N3aXRjaChlKHYpKXtjYXNlIm9iamVjdCI6aWYoZSh1W2ldKT09Im9iamVjdCIpe09iamVjdC5tZXJnZSh1W2ldLHYpO31lbHNle3VbaV09T2JqZWN0LmNsb25lKHYpOwp9YnJlYWs7Y2FzZSJhcnJheSI6dVtpXT12LmNsb25lKCk7YnJlYWs7ZGVmYXVsdDp1W2ldPXY7fXJldHVybiB1O307T2JqZWN0LmV4dGVuZCh7bWVyZ2U6ZnVuY3Rpb24oQix4LHcpe2lmKGUoeCk9PSJzdHJpbmciKXtyZXR1cm4gYShCLHgsdyk7fWZvcih2YXIgQT0xLHU9YXJndW1lbnRzLmxlbmd0aDsKQTx1O0ErKyl7dmFyIHk9YXJndW1lbnRzW0FdO2Zvcih2YXIgeiBpbiB5KXthKEIseix5W3pdKTt9fXJldHVybiBCO30sY2xvbmU6ZnVuY3Rpb24oaSl7dmFyIHY9e307Zm9yKHZhciB1IGluIGkpe3ZbdV09cihpW3VdKTt9cmV0dXJuIHY7fSxhcHBlbmQ6ZnVuY3Rpb24oeSl7Zm9yKHZhciB4PTEsdj1hcmd1bWVudHMubGVuZ3RoOwp4PHY7eCsrKXt2YXIgdT1hcmd1bWVudHNbeF18fHt9O2Zvcih2YXIgdyBpbiB1KXt5W3ddPXVbd107fX1yZXR1cm4geTt9fSk7WyJPYmplY3QiLCJXaGl0ZVNwYWNlIiwiVGV4dE5vZGUiLCJDb2xsZWN0aW9uIiwiQXJndW1lbnRzIl0uZWFjaChmdW5jdGlvbihpKXtuZXcgayhpKTsKfSk7dmFyIGo9RGF0ZS5ub3coKTtTdHJpbmcuZXh0ZW5kKCJ1bmlxdWVJRCIsZnVuY3Rpb24oKXtyZXR1cm4oaisrKS50b1N0cmluZygzNik7fSk7dmFyIGc9dGhpcy5IYXNoPW5ldyBrKCJIYXNoIixmdW5jdGlvbihpKXtpZihlKGkpPT0iaGFzaCIpe2k9T2JqZWN0LmNsb25lKGkuZ2V0Q2xlYW4oKSk7Cn1mb3IodmFyIHUgaW4gaSl7dGhpc1t1XT1pW3VdO31yZXR1cm4gdGhpczt9KTtnLmltcGxlbWVudCh7Zm9yRWFjaDpmdW5jdGlvbihpLHUpe09iamVjdC5mb3JFYWNoKHRoaXMsaSx1KTt9LGdldENsZWFuOmZ1bmN0aW9uKCl7dmFyIHU9e307Zm9yKHZhciBpIGluIHRoaXMpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoaSkpe3VbaV09dGhpc1tpXTsKfX1yZXR1cm4gdTt9LGdldExlbmd0aDpmdW5jdGlvbigpe3ZhciB1PTA7Zm9yKHZhciBpIGluIHRoaXMpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoaSkpe3UrKzt9fXJldHVybiB1O319KTtnLmFsaWFzKCJlYWNoIiwiZm9yRWFjaCIpO09iamVjdC50eXBlPWsuaXNPYmplY3Q7CnZhciBtPXRoaXMuTmF0aXZlPWZ1bmN0aW9uKGkpe3JldHVybiBuZXcgayhpLm5hbWUsaS5pbml0aWFsaXplKTt9O20udHlwZT1rLnR5cGU7bS5pbXBsZW1lbnQ9ZnVuY3Rpb24odyx1KXtmb3IodmFyIHY9MDt2PHcubGVuZ3RoO3YrKyl7d1t2XS5pbXBsZW1lbnQodSk7Cn1yZXR1cm4gbTt9O3ZhciBsPUFycmF5LnR5cGU7QXJyYXkudHlwZT1mdW5jdGlvbihpKXtyZXR1cm4gdChpLEFycmF5KXx8bChpKTt9O3RoaXMuJEE9ZnVuY3Rpb24oaSl7cmV0dXJuIEFycmF5LmZyb20oaSkuc2xpY2UoKTt9O3RoaXMuJGFyZ3VtZW50cz1mdW5jdGlvbih1KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzW3VdOwp9O307dGhpcy4kY2hrPWZ1bmN0aW9uKGkpe3JldHVybiAhIShpfHxpPT09MCk7fTt0aGlzLiRjbGVhcj1mdW5jdGlvbihpKXtjbGVhclRpbWVvdXQoaSk7Y2xlYXJJbnRlcnZhbChpKTtyZXR1cm4gbnVsbDt9O3RoaXMuJGRlZmluZWQ9ZnVuY3Rpb24oaSl7cmV0dXJuKGkhPW51bGwpOwp9O3RoaXMuJGVhY2g9ZnVuY3Rpb24odix1LHcpe3ZhciBpPWUodik7KChpPT0iYXJndW1lbnRzInx8aT09ImNvbGxlY3Rpb24ifHxpPT0iYXJyYXkifHxpPT0iZWxlbWVudHMiKT9BcnJheTpPYmplY3QpLmVhY2godix1LHcpO307dGhpcy4kZW1wdHk9ZnVuY3Rpb24oKXt9Owp0aGlzLiRleHRlbmQ9ZnVuY3Rpb24odSxpKXtyZXR1cm4gT2JqZWN0LmFwcGVuZCh1LGkpO307dGhpcy4kSD1mdW5jdGlvbihpKXtyZXR1cm4gbmV3IGcoaSk7fTt0aGlzLiRtZXJnZT1mdW5jdGlvbigpe3ZhciBpPUFycmF5LnNsaWNlKGFyZ3VtZW50cyk7aS51bnNoaWZ0KHt9KTsKcmV0dXJuIE9iamVjdC5tZXJnZS5hcHBseShudWxsLGkpO307dGhpcy4kbGFtYmRhPWYuZnJvbTt0aGlzLiRtaXhpbj1PYmplY3QubWVyZ2U7dGhpcy4kcmFuZG9tPU51bWJlci5yYW5kb207dGhpcy4kc3BsYXQ9QXJyYXkuZnJvbTt0aGlzLiR0aW1lPURhdGUubm93Owp0aGlzLiR0eXBlPWZ1bmN0aW9uKGkpe3ZhciB1PWUoaSk7aWYodT09ImVsZW1lbnRzIil7cmV0dXJuImFycmF5Ijt9cmV0dXJuKHU9PSJudWxsIik/ZmFsc2U6dTt9O3RoaXMuJHVubGluaz1mdW5jdGlvbihpKXtzd2l0Y2goZShpKSl7Y2FzZSJvYmplY3QiOnJldHVybiBPYmplY3QuY2xvbmUoaSk7CmNhc2UiYXJyYXkiOnJldHVybiBBcnJheS5jbG9uZShpKTtjYXNlImhhc2giOnJldHVybiBuZXcgZyhpKTtkZWZhdWx0OnJldHVybiBpO319O30pKCk7QXJyYXkuaW1wbGVtZW50KHtpbnZva2U6ZnVuY3Rpb24oYSl7dmFyIGI9QXJyYXkuc2xpY2UoYXJndW1lbnRzLDEpOwpyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oYyl7cmV0dXJuIGNbYV0uYXBwbHkoYyxiKTt9KTt9LGV2ZXJ5OmZ1bmN0aW9uKGMsZCl7Zm9yKHZhciBiPTAsYT10aGlzLmxlbmd0aDtiPGE7YisrKXtpZigoYiBpbiB0aGlzKSYmIWMuY2FsbChkLHRoaXNbYl0sYix0aGlzKSl7cmV0dXJuIGZhbHNlOwp9fXJldHVybiB0cnVlO30sZmlsdGVyOmZ1bmN0aW9uKGQsZSl7dmFyIGM9W107Zm9yKHZhciBiPTAsYT10aGlzLmxlbmd0aDtiPGE7YisrKXtpZigoYiBpbiB0aGlzKSYmZC5jYWxsKGUsdGhpc1tiXSxiLHRoaXMpKXtjLnB1c2godGhpc1tiXSk7fX1yZXR1cm4gYzt9LGNsZWFuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKGEpe3JldHVybiBhIT1udWxsOwp9KTt9LGluZGV4T2Y6ZnVuY3Rpb24oYyxkKXt2YXIgYT10aGlzLmxlbmd0aDtmb3IodmFyIGI9KGQ8MCk/TWF0aC5tYXgoMCxhK2QpOmR8fDA7YjxhO2IrKyl7aWYodGhpc1tiXT09PWMpe3JldHVybiBiO319cmV0dXJuIC0xO30sbWFwOmZ1bmN0aW9uKGQsZSl7dmFyIGM9W107CmZvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7aWYoYiBpbiB0aGlzKXtjW2JdPWQuY2FsbChlLHRoaXNbYl0sYix0aGlzKTt9fXJldHVybiBjO30sc29tZTpmdW5jdGlvbihjLGQpe2Zvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7aWYoKGIgaW4gdGhpcykmJmMuY2FsbChkLHRoaXNbYl0sYix0aGlzKSl7cmV0dXJuIHRydWU7Cn19cmV0dXJuIGZhbHNlO30sYXNzb2NpYXRlOmZ1bmN0aW9uKGMpe3ZhciBkPXt9LGI9TWF0aC5taW4odGhpcy5sZW5ndGgsYy5sZW5ndGgpO2Zvcih2YXIgYT0wO2E8YjthKyspe2RbY1thXV09dGhpc1thXTt9cmV0dXJuIGQ7fSxsaW5rOmZ1bmN0aW9uKGMpe3ZhciBhPXt9Owpmb3IodmFyIGU9MCxiPXRoaXMubGVuZ3RoO2U8YjtlKyspe2Zvcih2YXIgZCBpbiBjKXtpZihjW2RdKHRoaXNbZV0pKXthW2RdPXRoaXNbZV07ZGVsZXRlIGNbZF07YnJlYWs7fX19cmV0dXJuIGE7fSxjb250YWluczpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmluZGV4T2YoYSxiKSE9LTE7Cn0sYXBwZW5kOmZ1bmN0aW9uKGEpe3RoaXMucHVzaC5hcHBseSh0aGlzLGEpO3JldHVybiB0aGlzO30sZ2V0TGFzdDpmdW5jdGlvbigpe3JldHVybih0aGlzLmxlbmd0aCk/dGhpc1t0aGlzLmxlbmd0aC0xXTpudWxsO30sZ2V0UmFuZG9tOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMubGVuZ3RoKT90aGlzW051bWJlci5yYW5kb20oMCx0aGlzLmxlbmd0aC0xKV06bnVsbDsKfSxpbmNsdWRlOmZ1bmN0aW9uKGEpe2lmKCF0aGlzLmNvbnRhaW5zKGEpKXt0aGlzLnB1c2goYSk7fXJldHVybiB0aGlzO30sY29tYmluZTpmdW5jdGlvbihjKXtmb3IodmFyIGI9MCxhPWMubGVuZ3RoO2I8YTtiKyspe3RoaXMuaW5jbHVkZShjW2JdKTt9cmV0dXJuIHRoaXM7Cn0sZXJhc2U6ZnVuY3Rpb24oYil7Zm9yKHZhciBhPXRoaXMubGVuZ3RoO2EtLTspe2lmKHRoaXNbYV09PT1iKXt0aGlzLnNwbGljZShhLDEpO319cmV0dXJuIHRoaXM7fSxlbXB0eTpmdW5jdGlvbigpe3RoaXMubGVuZ3RoPTA7cmV0dXJuIHRoaXM7fSxmbGF0dGVuOmZ1bmN0aW9uKCl7dmFyIGQ9W107CmZvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7dmFyIGM9dHlwZU9mKHRoaXNbYl0pO2lmKGM9PSJudWxsIil7Y29udGludWU7fWQ9ZC5jb25jYXQoKGM9PSJhcnJheSJ8fGM9PSJjb2xsZWN0aW9uInx8Yz09ImFyZ3VtZW50cyJ8fGluc3RhbmNlT2YodGhpc1tiXSxBcnJheSkpP0FycmF5LmZsYXR0ZW4odGhpc1tiXSk6dGhpc1tiXSk7Cn1yZXR1cm4gZDt9LHBpY2s6ZnVuY3Rpb24oKXtmb3IodmFyIGI9MCxhPXRoaXMubGVuZ3RoO2I8YTtiKyspe2lmKHRoaXNbYl0hPW51bGwpe3JldHVybiB0aGlzW2JdO319cmV0dXJuIG51bGw7fSxoZXhUb1JnYjpmdW5jdGlvbihiKXtpZih0aGlzLmxlbmd0aCE9Myl7cmV0dXJuIG51bGw7Cn12YXIgYT10aGlzLm1hcChmdW5jdGlvbihjKXtpZihjLmxlbmd0aD09MSl7Yys9Yzt9cmV0dXJuIGMudG9JbnQoMTYpO30pO3JldHVybihiKT9hOiJyZ2IoIithKyIpIjt9LHJnYlRvSGV4OmZ1bmN0aW9uKGQpe2lmKHRoaXMubGVuZ3RoPDMpe3JldHVybiBudWxsO31pZih0aGlzLmxlbmd0aD09NCYmdGhpc1szXT09MCYmIWQpe3JldHVybiJ0cmFuc3BhcmVudCI7Cn12YXIgYj1bXTtmb3IodmFyIGE9MDthPDM7YSsrKXt2YXIgYz0odGhpc1thXS0wKS50b1N0cmluZygxNik7Yi5wdXNoKChjLmxlbmd0aD09MSk/IjAiK2M6Yyk7fXJldHVybihkKT9iOiIjIitiLmpvaW4oIiIpO319KTtBcnJheS5hbGlhcygiZXh0ZW5kIiwiYXBwZW5kIik7CnZhciAkcGljaz1mdW5jdGlvbigpe3JldHVybiBBcnJheS5mcm9tKGFyZ3VtZW50cykucGljaygpO307U3RyaW5nLmltcGxlbWVudCh7dGVzdDpmdW5jdGlvbihhLGIpe3JldHVybigodHlwZU9mKGEpPT0icmVnZXhwIik/YTpuZXcgUmVnRXhwKCIiK2EsYikpLnRlc3QodGhpcyk7Cn0sY29udGFpbnM6ZnVuY3Rpb24oYSxiKXtyZXR1cm4oYik/KGIrdGhpcytiKS5pbmRleE9mKGIrYStiKT4tMTp0aGlzLmluZGV4T2YoYSk+LTE7fSx0cmltOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXlxzK3xccyskL2csIiIpO30sY2xlYW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC9ccysvZywiICIpLnRyaW0oKTsKfSxjYW1lbENhc2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC8tXEQvZyxmdW5jdGlvbihhKXtyZXR1cm4gYS5jaGFyQXQoMSkudG9VcHBlckNhc2UoKTt9KTt9LGh5cGhlbmF0ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoL1tBLVpdL2csZnVuY3Rpb24oYSl7cmV0dXJuKCItIithLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpKTsKfSk7fSxjYXBpdGFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXGJbYS16XS9nLGZ1bmN0aW9uKGEpe3JldHVybiBhLnRvVXBwZXJDYXNlKCk7fSk7fSxlc2NhcGVSZWdFeHA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC8oWy0uKis/XiR7fSgpfFtcXVwvXFxdKS9nLCJcXCQxIik7Cn0sdG9JbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHBhcnNlSW50KHRoaXMsYXx8MTApO30sdG9GbG9hdDpmdW5jdGlvbigpe3JldHVybiBwYXJzZUZsb2F0KHRoaXMpO30saGV4VG9SZ2I6ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy5tYXRjaCgvXiM/KFx3ezEsMn0pKFx3ezEsMn0pKFx3ezEsMn0pJC8pOwpyZXR1cm4oYSk/YS5zbGljZSgxKS5oZXhUb1JnYihiKTpudWxsO30scmdiVG9IZXg6ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy5tYXRjaCgvXGR7MSwzfS9nKTtyZXR1cm4oYSk/YS5yZ2JUb0hleChiKTpudWxsO30sc3Vic3RpdHV0ZTpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnJlcGxhY2UoYnx8KC9cXD9ceyhbXnt9XSspXH0vZyksZnVuY3Rpb24oZCxjKXtpZihkLmNoYXJBdCgwKT09IlxcIil7cmV0dXJuIGQuc2xpY2UoMSk7Cn1yZXR1cm4oYVtjXSE9bnVsbCk/YVtjXToiIjt9KTt9fSk7TnVtYmVyLmltcGxlbWVudCh7bGltaXQ6ZnVuY3Rpb24oYixhKXtyZXR1cm4gTWF0aC5taW4oYSxNYXRoLm1heChiLHRoaXMpKTt9LHJvdW5kOmZ1bmN0aW9uKGEpe2E9TWF0aC5wb3coMTAsYXx8MCkudG9GaXhlZChhPDA/LWE6MCk7CnJldHVybiBNYXRoLnJvdW5kKHRoaXMqYSkvYTt9LHRpbWVzOmZ1bmN0aW9uKGIsYyl7Zm9yKHZhciBhPTA7YTx0aGlzO2ErKyl7Yi5jYWxsKGMsYSx0aGlzKTt9fSx0b0Zsb2F0OmZ1bmN0aW9uKCl7cmV0dXJuIHBhcnNlRmxvYXQodGhpcyk7fSx0b0ludDpmdW5jdGlvbihhKXtyZXR1cm4gcGFyc2VJbnQodGhpcyxhfHwxMCk7Cn19KTtOdW1iZXIuYWxpYXMoImVhY2giLCJ0aW1lcyIpOyhmdW5jdGlvbihiKXt2YXIgYT17fTtiLmVhY2goZnVuY3Rpb24oYyl7aWYoIU51bWJlcltjXSl7YVtjXT1mdW5jdGlvbigpe3JldHVybiBNYXRoW2NdLmFwcGx5KG51bGwsW3RoaXNdLmNvbmNhdChBcnJheS5mcm9tKGFyZ3VtZW50cykpKTsKfTt9fSk7TnVtYmVyLmltcGxlbWVudChhKTt9KShbImFicyIsImFjb3MiLCJhc2luIiwiYXRhbiIsImF0YW4yIiwiY2VpbCIsImNvcyIsImV4cCIsImZsb29yIiwibG9nIiwibWF4IiwibWluIiwicG93Iiwic2luIiwic3FydCIsInRhbiJdKTtGdW5jdGlvbi5leHRlbmQoe2F0dGVtcHQ6ZnVuY3Rpb24oKXtmb3IodmFyIGI9MCxhPWFyZ3VtZW50cy5sZW5ndGg7CmI8YTtiKyspe3RyeXtyZXR1cm4gYXJndW1lbnRzW2JdKCk7fWNhdGNoKGMpe319cmV0dXJuIG51bGw7fX0pO0Z1bmN0aW9uLmltcGxlbWVudCh7YXR0ZW1wdDpmdW5jdGlvbihhLGMpe3RyeXtyZXR1cm4gdGhpcy5hcHBseShjLEFycmF5LmZyb20oYSkpO31jYXRjaChiKXt9cmV0dXJuIG51bGw7Cn0sYmluZDpmdW5jdGlvbihjKXt2YXIgYT10aGlzLGI9KGFyZ3VtZW50cy5sZW5ndGg+MSk/QXJyYXkuc2xpY2UoYXJndW1lbnRzLDEpOm51bGw7cmV0dXJuIGZ1bmN0aW9uKCl7aWYoIWImJiFhcmd1bWVudHMubGVuZ3RoKXtyZXR1cm4gYS5jYWxsKGMpO31pZihiJiZhcmd1bWVudHMubGVuZ3RoKXtyZXR1cm4gYS5hcHBseShjLGIuY29uY2F0KEFycmF5LmZyb20oYXJndW1lbnRzKSkpOwp9cmV0dXJuIGEuYXBwbHkoYyxifHxhcmd1bWVudHMpO307fSxwYXNzOmZ1bmN0aW9uKGIsYyl7dmFyIGE9dGhpcztpZihiIT1udWxsKXtiPUFycmF5LmZyb20oYik7fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGMsYnx8YXJndW1lbnRzKTt9O30sZGVsYXk6ZnVuY3Rpb24oYixjLGEpe3JldHVybiBzZXRUaW1lb3V0KHRoaXMucGFzcyhhLGMpLGIpOwp9LHBlcmlvZGljYWw6ZnVuY3Rpb24oYyxiLGEpe3JldHVybiBzZXRJbnRlcnZhbCh0aGlzLnBhc3MoYSxiKSxjKTt9fSk7ZGVsZXRlIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kO0Z1bmN0aW9uLmltcGxlbWVudCh7Y3JlYXRlOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXM7CmI9Ynx8e307cmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBjPWIuYXJndW1lbnRzO2M9KGMhPW51bGwpP0FycmF5LmZyb20oYyk6QXJyYXkuc2xpY2UoYXJndW1lbnRzLChiLmV2ZW50KT8xOjApO2lmKGIuZXZlbnQpe2M9W2R8fHdpbmRvdy5ldmVudF0uZXh0ZW5kKGMpO312YXIgZT1mdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGIuYmluZHx8bnVsbCxjKTsKfTtpZihiLmRlbGF5KXtyZXR1cm4gc2V0VGltZW91dChlLGIuZGVsYXkpO31pZihiLnBlcmlvZGljYWwpe3JldHVybiBzZXRJbnRlcnZhbChlLGIucGVyaW9kaWNhbCk7fWlmKGIuYXR0ZW1wdCl7cmV0dXJuIEZ1bmN0aW9uLmF0dGVtcHQoZSk7fXJldHVybiBlKCk7fTsKfSxiaW5kOmZ1bmN0aW9uKGMsYil7dmFyIGE9dGhpcztpZihiIT1udWxsKXtiPUFycmF5LmZyb20oYik7fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGMsYnx8YXJndW1lbnRzKTt9O30sYmluZFdpdGhFdmVudDpmdW5jdGlvbihjLGIpe3ZhciBhPXRoaXM7CmlmKGIhPW51bGwpe2I9QXJyYXkuZnJvbShiKTt9cmV0dXJuIGZ1bmN0aW9uKGQpe3JldHVybiBhLmFwcGx5KGMsKGI9PW51bGwpP2FyZ3VtZW50czpbZF0uY29uY2F0KGIpKTt9O30scnVuOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuYXBwbHkoYixBcnJheS5mcm9tKGEpKTsKfX0pO3ZhciAkdHJ5PUZ1bmN0aW9uLmF0dGVtcHQ7T2JqZWN0LmV4dGVuZCh7c3Vic2V0OmZ1bmN0aW9uKGMsZil7dmFyIGU9e307Zm9yKHZhciBkPTAsYT1mLmxlbmd0aDtkPGE7ZCsrKXt2YXIgYj1mW2RdO2VbYl09Y1tiXTt9cmV0dXJuIGU7fSxtYXA6ZnVuY3Rpb24oYSxkLGUpe3ZhciBjPXt9Owpmb3IodmFyIGIgaW4gYSl7aWYoYS5oYXNPd25Qcm9wZXJ0eShiKSl7Y1tiXT1kLmNhbGwoZSxhW2JdLGIsYSk7fX1yZXR1cm4gYzt9LGZpbHRlcjpmdW5jdGlvbihhLGMsZCl7dmFyIGI9e307T2JqZWN0LmVhY2goYSxmdW5jdGlvbihmLGUpe2lmKGMuY2FsbChkLGYsZSxhKSl7YltlXT1mOwp9fSk7cmV0dXJuIGI7fSxldmVyeTpmdW5jdGlvbihhLGMsZCl7Zm9yKHZhciBiIGluIGEpe2lmKGEuaGFzT3duUHJvcGVydHkoYikmJiFjLmNhbGwoZCxhW2JdLGIpKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTt9LHNvbWU6ZnVuY3Rpb24oYSxjLGQpe2Zvcih2YXIgYiBpbiBhKXtpZihhLmhhc093blByb3BlcnR5KGIpJiZjLmNhbGwoZCxhW2JdLGIpKXtyZXR1cm4gdHJ1ZTsKfX1yZXR1cm4gZmFsc2U7fSxrZXlzOmZ1bmN0aW9uKGEpe3ZhciBjPVtdO2Zvcih2YXIgYiBpbiBhKXtpZihhLmhhc093blByb3BlcnR5KGIpKXtjLnB1c2goYik7fX1yZXR1cm4gYzt9LHZhbHVlczpmdW5jdGlvbihiKXt2YXIgYT1bXTtmb3IodmFyIGMgaW4gYil7aWYoYi5oYXNPd25Qcm9wZXJ0eShjKSl7YS5wdXNoKGJbY10pOwp9fXJldHVybiBhO30sZ2V0TGVuZ3RoOmZ1bmN0aW9uKGEpe3JldHVybiBPYmplY3Qua2V5cyhhKS5sZW5ndGg7fSxrZXlPZjpmdW5jdGlvbihhLGMpe2Zvcih2YXIgYiBpbiBhKXtpZihhLmhhc093blByb3BlcnR5KGIpJiZhW2JdPT09Yyl7cmV0dXJuIGI7fX1yZXR1cm4gbnVsbDsKfSxjb250YWluczpmdW5jdGlvbihhLGIpe3JldHVybiBPYmplY3Qua2V5T2YoYSxiKSE9bnVsbDt9LHRvUXVlcnlTdHJpbmc6ZnVuY3Rpb24oYSxiKXt2YXIgYz1bXTtPYmplY3QuZWFjaChhLGZ1bmN0aW9uKGcsZil7aWYoYil7Zj1iKyJbIitmKyJdIjt9dmFyIGU7c3dpdGNoKHR5cGVPZihnKSl7Y2FzZSJvYmplY3QiOmU9T2JqZWN0LnRvUXVlcnlTdHJpbmcoZyxmKTsKYnJlYWs7Y2FzZSJhcnJheSI6dmFyIGQ9e307Zy5lYWNoKGZ1bmN0aW9uKGosaCl7ZFtoXT1qO30pO2U9T2JqZWN0LnRvUXVlcnlTdHJpbmcoZCxmKTticmVhaztkZWZhdWx0OmU9ZisiPSIrZW5jb2RlVVJJQ29tcG9uZW50KGcpO31pZihnIT1udWxsKXtjLnB1c2goZSk7Cn19KTtyZXR1cm4gYy5qb2luKCImIik7fX0pO0hhc2guaW1wbGVtZW50KHtoYXM6T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxrZXlPZjpmdW5jdGlvbihhKXtyZXR1cm4gT2JqZWN0LmtleU9mKHRoaXMsYSk7fSxoYXNWYWx1ZTpmdW5jdGlvbihhKXtyZXR1cm4gT2JqZWN0LmNvbnRhaW5zKHRoaXMsYSk7Cn0sZXh0ZW5kOmZ1bmN0aW9uKGEpe0hhc2guZWFjaChhfHx7fSxmdW5jdGlvbihjLGIpe0hhc2guc2V0KHRoaXMsYixjKTt9LHRoaXMpO3JldHVybiB0aGlzO30sY29tYmluZTpmdW5jdGlvbihhKXtIYXNoLmVhY2goYXx8e30sZnVuY3Rpb24oYyxiKXtIYXNoLmluY2x1ZGUodGhpcyxiLGMpOwp9LHRoaXMpO3JldHVybiB0aGlzO30sZXJhc2U6ZnVuY3Rpb24oYSl7aWYodGhpcy5oYXNPd25Qcm9wZXJ0eShhKSl7ZGVsZXRlIHRoaXNbYV07fXJldHVybiB0aGlzO30sZ2V0OmZ1bmN0aW9uKGEpe3JldHVybih0aGlzLmhhc093blByb3BlcnR5KGEpKT90aGlzW2FdOm51bGw7Cn0sc2V0OmZ1bmN0aW9uKGEsYil7aWYoIXRoaXNbYV18fHRoaXMuaGFzT3duUHJvcGVydHkoYSkpe3RoaXNbYV09Yjt9cmV0dXJuIHRoaXM7fSxlbXB0eTpmdW5jdGlvbigpe0hhc2guZWFjaCh0aGlzLGZ1bmN0aW9uKGIsYSl7ZGVsZXRlIHRoaXNbYV07fSx0aGlzKTsKcmV0dXJuIHRoaXM7fSxpbmNsdWRlOmZ1bmN0aW9uKGEsYil7aWYodGhpc1thXT09bnVsbCl7dGhpc1thXT1iO31yZXR1cm4gdGhpczt9LG1hcDpmdW5jdGlvbihhLGIpe3JldHVybiBuZXcgSGFzaChPYmplY3QubWFwKHRoaXMsYSxiKSk7fSxmaWx0ZXI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEhhc2goT2JqZWN0LmZpbHRlcih0aGlzLGEsYikpOwp9LGV2ZXJ5OmZ1bmN0aW9uKGEsYil7cmV0dXJuIE9iamVjdC5ldmVyeSh0aGlzLGEsYik7fSxzb21lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIE9iamVjdC5zb21lKHRoaXMsYSxiKTt9LGdldEtleXM6ZnVuY3Rpb24oKXtyZXR1cm4gT2JqZWN0LmtleXModGhpcyk7fSxnZXRWYWx1ZXM6ZnVuY3Rpb24oKXtyZXR1cm4gT2JqZWN0LnZhbHVlcyh0aGlzKTsKfSx0b1F1ZXJ5U3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybiBPYmplY3QudG9RdWVyeVN0cmluZyh0aGlzLGEpO319KTtIYXNoLmV4dGVuZD1PYmplY3QuYXBwZW5kO0hhc2guYWxpYXMoe2luZGV4T2Y6ImtleU9mIixjb250YWluczoiaGFzVmFsdWUifSk7KGZ1bmN0aW9uKCl7dmFyIGw9dGhpcy5kb2N1bWVudDsKdmFyIGo9bC53aW5kb3c9dGhpczt2YXIgYj0xO3RoaXMuJHVpZD0oai5BY3RpdmVYT2JqZWN0KT9mdW5jdGlvbihlKXtyZXR1cm4oZS51aWR8fChlLnVpZD1bYisrXSkpWzBdO306ZnVuY3Rpb24oZSl7cmV0dXJuIGUudWlkfHwoZS51aWQ9YisrKTt9OyR1aWQoaik7JHVpZChsKTsKdmFyIGE9bmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLGM9bmF2aWdhdG9yLnBsYXRmb3JtLnRvTG93ZXJDYXNlKCksaz1hLm1hdGNoKC8ob3BlcmF8aWV8ZmlyZWZveHxjaHJvbWV8dmVyc2lvbilbXHNcLzpdKFtcd1xkXC5dKyk/Lio/KHNhZmFyaXx2ZXJzaW9uW1xzXC86XShbXHdcZFwuXSspfCQpLyl8fFtudWxsLCJ1bmtub3duIiwwXSxnPWtbMV09PSJpZSImJmwuZG9jdW1lbnRNb2RlOwp2YXIgcD10aGlzLkJyb3dzZXI9e2V4dGVuZDpGdW5jdGlvbi5wcm90b3R5cGUuZXh0ZW5kLG5hbWU6KGtbMV09PSJ2ZXJzaW9uIik/a1szXTprWzFdLHZlcnNpb246Z3x8cGFyc2VGbG9hdCgoa1sxXT09Im9wZXJhIiYma1s0XSk/a1s0XTprWzJdKSxQbGF0Zm9ybTp7bmFtZTphLm1hdGNoKC9pcCg/OmFkfG9kfGhvbmUpLyk/ImlvcyI6KGEubWF0Y2goLyg/OndlYm9zfGFuZHJvaWQpLyl8fGMubWF0Y2goL21hY3x3aW58bGludXgvKXx8WyJvdGhlciJdKVswXX0sRmVhdHVyZXM6e3hwYXRoOiEhKGwuZXZhbHVhdGUpLGFpcjohIShqLnJ1bnRpbWUpLHF1ZXJ5OiEhKGwucXVlcnlTZWxlY3RvciksanNvbjohIShqLkpTT04pfSxQbHVnaW5zOnt9fTsKcFtwLm5hbWVdPXRydWU7cFtwLm5hbWUrcGFyc2VJbnQocC52ZXJzaW9uLDEwKV09dHJ1ZTtwLlBsYXRmb3JtW3AuUGxhdGZvcm0ubmFtZV09dHJ1ZTtwLlJlcXVlc3Q9KGZ1bmN0aW9uKCl7dmFyIHI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7Cn07dmFyIHE9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1TWE1MMi5YTUxIVFRQIik7fTt2YXIgZT1mdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKTt9O3JldHVybiBGdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7cigpOwpyZXR1cm4gcjt9LGZ1bmN0aW9uKCl7cSgpO3JldHVybiBxO30sZnVuY3Rpb24oKXtlKCk7cmV0dXJuIGU7fSk7fSkoKTtwLkZlYXR1cmVzLnhocj0hIShwLlJlcXVlc3QpO3ZhciBpPShGdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7cmV0dXJuIG5hdmlnYXRvci5wbHVnaW5zWyJTaG9ja3dhdmUgRmxhc2giXS5kZXNjcmlwdGlvbjsKfSxmdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdCgiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2giKS5HZXRWYXJpYWJsZSgiJHZlcnNpb24iKTt9KXx8IjAgcjAiKS5tYXRjaCgvXGQrL2cpO3AuUGx1Z2lucy5GbGFzaD17dmVyc2lvbjpOdW1iZXIoaVswXXx8IjAuIitpWzFdKXx8MCxidWlsZDpOdW1iZXIoaVsyXSl8fDB9OwpwLmV4ZWM9ZnVuY3Rpb24ocSl7aWYoIXEpe3JldHVybiBxO31pZihqLmV4ZWNTY3JpcHQpe2ouZXhlY1NjcmlwdChxKTt9ZWxzZXt2YXIgZT1sLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO2Uuc2V0QXR0cmlidXRlKCJ0eXBlIiwidGV4dC9qYXZhc2NyaXB0Iik7ZS50ZXh0PXE7CmwuaGVhZC5hcHBlbmRDaGlsZChlKTtsLmhlYWQucmVtb3ZlQ2hpbGQoZSk7fXJldHVybiBxO307U3RyaW5nLmltcGxlbWVudCgic3RyaXBTY3JpcHRzIixmdW5jdGlvbihxKXt2YXIgZT0iIjt2YXIgcj10aGlzLnJlcGxhY2UoLzxzY3JpcHRbXj5dKj4oW1xzXFNdKj8pPFwvc2NyaXB0Pi9naSxmdW5jdGlvbihzLHQpe2UrPXQrIlxuIjsKcmV0dXJuIiI7fSk7aWYocT09PXRydWUpe3AuZXhlYyhlKTt9ZWxzZXtpZih0eXBlT2YocSk9PSJmdW5jdGlvbiIpe3EoZSxyKTt9fXJldHVybiByO30pO3AuZXh0ZW5kKHtEb2N1bWVudDp0aGlzLkRvY3VtZW50LFdpbmRvdzp0aGlzLldpbmRvdyxFbGVtZW50OnRoaXMuRWxlbWVudCxFdmVudDp0aGlzLkV2ZW50fSk7CnRoaXMuV2luZG93PXRoaXMuJGNvbnN0cnVjdG9yPW5ldyBUeXBlKCJXaW5kb3ciLGZ1bmN0aW9uKCl7fSk7dGhpcy4kZmFtaWx5PUZ1bmN0aW9uLmZyb20oIndpbmRvdyIpLmhpZGUoKTtXaW5kb3cubWlycm9yKGZ1bmN0aW9uKGUscSl7altlXT1xO30pO3RoaXMuRG9jdW1lbnQ9bC4kY29uc3RydWN0b3I9bmV3IFR5cGUoIkRvY3VtZW50IixmdW5jdGlvbigpe30pOwpsLiRmYW1pbHk9RnVuY3Rpb24uZnJvbSgiZG9jdW1lbnQiKS5oaWRlKCk7RG9jdW1lbnQubWlycm9yKGZ1bmN0aW9uKGUscSl7bFtlXT1xO30pO2wuaHRtbD1sLmRvY3VtZW50RWxlbWVudDtsLmhlYWQ9bC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdO2lmKGwuZXhlY0NvbW1hbmQpe3RyeXtsLmV4ZWNDb21tYW5kKCJCYWNrZ3JvdW5kSW1hZ2VDYWNoZSIsZmFsc2UsdHJ1ZSk7Cn1jYXRjaChoKXt9fWlmKHRoaXMuYXR0YWNoRXZlbnQmJiF0aGlzLmFkZEV2ZW50TGlzdGVuZXIpe3ZhciBkPWZ1bmN0aW9uKCl7dGhpcy5kZXRhY2hFdmVudCgib251bmxvYWQiLGQpO2wuaGVhZD1sLmh0bWw9bC53aW5kb3c9bnVsbDt9O3RoaXMuYXR0YWNoRXZlbnQoIm9udW5sb2FkIixkKTsKfXZhciBuPUFycmF5LmZyb207dHJ5e24obC5odG1sLmNoaWxkTm9kZXMpO31jYXRjaChoKXtBcnJheS5mcm9tPWZ1bmN0aW9uKHEpe2lmKHR5cGVvZiBxIT0ic3RyaW5nIiYmVHlwZS5pc0VudW1lcmFibGUocSkmJnR5cGVPZihxKSE9ImFycmF5Iil7dmFyIGU9cS5sZW5ndGgscj1uZXcgQXJyYXkoZSk7CndoaWxlKGUtLSl7cltlXT1xW2VdO31yZXR1cm4gcjt9cmV0dXJuIG4ocSk7fTt2YXIgbT1BcnJheS5wcm90b3R5cGUsbz1tLnNsaWNlO1sicG9wIiwicHVzaCIsInJldmVyc2UiLCJzaGlmdCIsInNvcnQiLCJzcGxpY2UiLCJ1bnNoaWZ0IiwiY29uY2F0Iiwiam9pbiIsInNsaWNlIl0uZWFjaChmdW5jdGlvbihlKXt2YXIgcT1tW2VdOwpBcnJheVtlXT1mdW5jdGlvbihyKXtyZXR1cm4gcS5hcHBseShBcnJheS5mcm9tKHIpLG8uY2FsbChhcmd1bWVudHMsMSkpO307fSk7fWlmKHAuUGxhdGZvcm0uaW9zKXtwLlBsYXRmb3JtLmlwb2Q9dHJ1ZTt9cC5FbmdpbmU9e307dmFyIGY9ZnVuY3Rpb24ocSxlKXtwLkVuZ2luZS5uYW1lPXE7CnAuRW5naW5lW3ErZV09dHJ1ZTtwLkVuZ2luZS52ZXJzaW9uPWU7fTtpZihwLmllKXtwLkVuZ2luZS50cmlkZW50PXRydWU7c3dpdGNoKHAudmVyc2lvbil7Y2FzZSA2OmYoInRyaWRlbnQiLDQpO2JyZWFrO2Nhc2UgNzpmKCJ0cmlkZW50Iiw1KTticmVhaztjYXNlIDg6ZigidHJpZGVudCIsNik7Cn19aWYocC5maXJlZm94KXtwLkVuZ2luZS5nZWNrbz10cnVlO2lmKHAudmVyc2lvbj49Myl7ZigiZ2Vja28iLDE5KTt9ZWxzZXtmKCJnZWNrbyIsMTgpO319aWYocC5zYWZhcml8fHAuY2hyb21lKXtwLkVuZ2luZS53ZWJraXQ9dHJ1ZTtzd2l0Y2gocC52ZXJzaW9uKXtjYXNlIDI6Zigid2Via2l0Iiw0MTkpOwpicmVhaztjYXNlIDM6Zigid2Via2l0Iiw0MjApO2JyZWFrO2Nhc2UgNDpmKCJ3ZWJraXQiLDUyNSk7fX1pZihwLm9wZXJhKXtwLkVuZ2luZS5wcmVzdG89dHJ1ZTtpZihwLnZlcnNpb24+PTkuNil7ZigicHJlc3RvIiw5NjApO31lbHNle2lmKHAudmVyc2lvbj49OS41KXtmKCJwcmVzdG8iLDk1MCk7Cn1lbHNle2YoInByZXN0byIsOTI1KTt9fX1pZihwLm5hbWU9PSJ1bmtub3duIil7c3dpdGNoKChhLm1hdGNoKC8oPzp3ZWJraXR8a2h0bWx8Z2Vja28pLyl8fFtdKVswXSl7Y2FzZSJ3ZWJraXQiOmNhc2Uia2h0bWwiOnAuRW5naW5lLndlYmtpdD10cnVlO2JyZWFrO2Nhc2UiZ2Vja28iOnAuRW5naW5lLmdlY2tvPXRydWU7Cn19dGhpcy4kZXhlYz1wLmV4ZWM7fSkoKTt2YXIgRXZlbnQ9bmV3IFR5cGUoIkV2ZW50IixmdW5jdGlvbihhLGkpe2lmKCFpKXtpPXdpbmRvdzt9dmFyIG89aS5kb2N1bWVudDthPWF8fGkuZXZlbnQ7aWYoYS4kZXh0ZW5kZWQpe3JldHVybiBhO310aGlzLiRleHRlbmRlZD10cnVlOwp2YXIgbj1hLnR5cGUsaz1hLnRhcmdldHx8YS5zcmNFbGVtZW50LG09e30sYz17fTt3aGlsZShrJiZrLm5vZGVUeXBlPT0zKXtrPWsucGFyZW50Tm9kZTt9aWYobi5pbmRleE9mKCJrZXkiKSE9LTEpe3ZhciBiPWEud2hpY2h8fGEua2V5Q29kZTt2YXIgcT1PYmplY3Qua2V5T2YoRXZlbnQuS2V5cyxiKTsKaWYobj09ImtleWRvd24iKXt2YXIgZD1iLTExMTtpZihkPjAmJmQ8MTMpe3E9ImYiK2Q7fX1pZighcSl7cT1TdHJpbmcuZnJvbUNoYXJDb2RlKGIpLnRvTG93ZXJDYXNlKCk7fX1lbHNle2lmKG4udGVzdCgvY2xpY2t8bW91c2V8bWVudS9pKSl7bz0oIW8uY29tcGF0TW9kZXx8by5jb21wYXRNb2RlPT0iQ1NTMUNvbXBhdCIpP28uaHRtbDpvLmJvZHk7Cm09e3g6KGEucGFnZVghPW51bGwpP2EucGFnZVg6YS5jbGllbnRYK28uc2Nyb2xsTGVmdCx5OihhLnBhZ2VZIT1udWxsKT9hLnBhZ2VZOmEuY2xpZW50WStvLnNjcm9sbFRvcH07Yz17eDooYS5wYWdlWCE9bnVsbCk/YS5wYWdlWC1pLnBhZ2VYT2Zmc2V0OmEuY2xpZW50WCx5OihhLnBhZ2VZIT1udWxsKT9hLnBhZ2VZLWkucGFnZVlPZmZzZXQ6YS5jbGllbnRZfTsKaWYobi50ZXN0KC9ET01Nb3VzZVNjcm9sbHxtb3VzZXdoZWVsLykpe3ZhciBsPShhLndoZWVsRGVsdGEpP2Eud2hlZWxEZWx0YS8xMjA6LShhLmRldGFpbHx8MCkvMzt9dmFyIGg9KGEud2hpY2g9PTMpfHwoYS5idXR0b249PTIpLHA9bnVsbDtpZihuLnRlc3QoL292ZXJ8b3V0Lykpe3A9YS5yZWxhdGVkVGFyZ2V0fHxhWyhuPT0ibW91c2VvdmVyIj8iZnJvbSI6InRvIikrIkVsZW1lbnQiXTsKdmFyIGo9ZnVuY3Rpb24oKXt3aGlsZShwJiZwLm5vZGVUeXBlPT0zKXtwPXAucGFyZW50Tm9kZTt9cmV0dXJuIHRydWU7fTt2YXIgZz0oQnJvd3Nlci5maXJlZm94Mik/ai5hdHRlbXB0KCk6aigpO3A9KGcpP3A6bnVsbDt9fWVsc2V7aWYobi50ZXN0KC9nZXN0dXJlfHRvdWNoL2kpKXt0aGlzLnJvdGF0aW9uPWEucm90YXRpb247CnRoaXMuc2NhbGU9YS5zY2FsZTt0aGlzLnRhcmdldFRvdWNoZXM9YS50YXJnZXRUb3VjaGVzO3RoaXMuY2hhbmdlZFRvdWNoZXM9YS5jaGFuZ2VkVG91Y2hlczt2YXIgZj10aGlzLnRvdWNoZXM9YS50b3VjaGVzO2lmKGYmJmZbMF0pe3ZhciBlPWZbMF07bT17eDplLnBhZ2VYLHk6ZS5wYWdlWX07CmM9e3g6ZS5jbGllbnRYLHk6ZS5jbGllbnRZfTt9fX19cmV0dXJuIE9iamVjdC5hcHBlbmQodGhpcyx7ZXZlbnQ6YSx0eXBlOm4scGFnZTptLGNsaWVudDpjLHJpZ2h0Q2xpY2s6aCx3aGVlbDpsLHJlbGF0ZWRUYXJnZXQ6ZG9jdW1lbnQuaWQocCksdGFyZ2V0OmRvY3VtZW50LmlkKGspLGNvZGU6YixrZXk6cSxzaGlmdDphLnNoaWZ0S2V5LGNvbnRyb2w6YS5jdHJsS2V5LGFsdDphLmFsdEtleSxtZXRhOmEubWV0YUtleX0pOwp9KTtFdmVudC5LZXlzPXtlbnRlcjoxMyx1cDozOCxkb3duOjQwLGxlZnQ6MzcscmlnaHQ6MzksZXNjOjI3LHNwYWNlOjMyLGJhY2tzcGFjZTo4LHRhYjo5LCJkZWxldGUiOjQ2fTtFdmVudC5LZXlzPW5ldyBIYXNoKEV2ZW50LktleXMpO0V2ZW50LmltcGxlbWVudCh7c3RvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0b3BQcm9wYWdhdGlvbigpLnByZXZlbnREZWZhdWx0KCk7Cn0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7aWYodGhpcy5ldmVudC5zdG9wUHJvcGFnYXRpb24pe3RoaXMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7fWVsc2V7dGhpcy5ldmVudC5jYW5jZWxCdWJibGU9dHJ1ZTt9cmV0dXJuIHRoaXM7fSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe2lmKHRoaXMuZXZlbnQucHJldmVudERlZmF1bHQpe3RoaXMuZXZlbnQucHJldmVudERlZmF1bHQoKTsKfWVsc2V7dGhpcy5ldmVudC5yZXR1cm5WYWx1ZT1mYWxzZTt9cmV0dXJuIHRoaXM7fX0pOyhmdW5jdGlvbigpe3ZhciBhPXRoaXMuQ2xhc3M9bmV3IFR5cGUoIkNsYXNzIixmdW5jdGlvbihoKXtpZihpbnN0YW5jZU9mKGgsRnVuY3Rpb24pKXtoPXtpbml0aWFsaXplOmh9Owp9dmFyIGc9ZnVuY3Rpb24oKXtlKHRoaXMpO2lmKGcuJHByb3RvdHlwaW5nKXtyZXR1cm4gdGhpczt9dGhpcy4kY2FsbGVyPW51bGw7dmFyIGk9KHRoaXMuaW5pdGlhbGl6ZSk/dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzO3RoaXMuJGNhbGxlcj10aGlzLmNhbGxlcj1udWxsOwpyZXR1cm4gaTt9LmV4dGVuZCh0aGlzKS5pbXBsZW1lbnQoaCk7Zy4kY29uc3RydWN0b3I9YTtnLnByb3RvdHlwZS4kY29uc3RydWN0b3I9ZztnLnByb3RvdHlwZS5wYXJlbnQ9YztyZXR1cm4gZzt9KTt2YXIgYz1mdW5jdGlvbigpe2lmKCF0aGlzLiRjYWxsZXIpe3Rocm93IG5ldyBFcnJvcignVGhlIG1ldGhvZCAicGFyZW50IiBjYW5ub3QgYmUgY2FsbGVkLicpOwp9dmFyIGc9dGhpcy4kY2FsbGVyLiRuYW1lLGg9dGhpcy4kY2FsbGVyLiRvd25lci5wYXJlbnQsaT0oaCk/aC5wcm90b3R5cGVbZ106bnVsbDtpZighaSl7dGhyb3cgbmV3IEVycm9yKCdUaGUgbWV0aG9kICInK2crJyIgaGFzIG5vIHBhcmVudC4nKTt9cmV0dXJuIGkuYXBwbHkodGhpcyxhcmd1bWVudHMpOwp9O3ZhciBlPWZ1bmN0aW9uKGcpe2Zvcih2YXIgaCBpbiBnKXt2YXIgaj1nW2hdO3N3aXRjaCh0eXBlT2Yoaikpe2Nhc2Uib2JqZWN0Ijp2YXIgaT1mdW5jdGlvbigpe307aS5wcm90b3R5cGU9ajtnW2hdPWUobmV3IGkpO2JyZWFrO2Nhc2UiYXJyYXkiOmdbaF09ai5jbG9uZSgpOwpicmVhazt9fXJldHVybiBnO307dmFyIGI9ZnVuY3Rpb24oZyxoLGope2lmKGouJG9yaWdpbil7aj1qLiRvcmlnaW47fXZhciBpPWZ1bmN0aW9uKCl7aWYoai4kcHJvdGVjdGVkJiZ0aGlzLiRjYWxsZXI9PW51bGwpe3Rocm93IG5ldyBFcnJvcignVGhlIG1ldGhvZCAiJytoKyciIGNhbm5vdCBiZSBjYWxsZWQuJyk7Cn12YXIgbD10aGlzLmNhbGxlcixtPXRoaXMuJGNhbGxlcjt0aGlzLmNhbGxlcj1tO3RoaXMuJGNhbGxlcj1pO3ZhciBrPWouYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuJGNhbGxlcj1tO3RoaXMuY2FsbGVyPWw7cmV0dXJuIGs7fS5leHRlbmQoeyRvd25lcjpnLCRvcmlnaW46aiwkbmFtZTpofSk7CnJldHVybiBpO307dmFyIGY9ZnVuY3Rpb24oaCxpLGcpe2lmKGEuTXV0YXRvcnMuaGFzT3duUHJvcGVydHkoaCkpe2k9YS5NdXRhdG9yc1toXS5jYWxsKHRoaXMsaSk7aWYoaT09bnVsbCl7cmV0dXJuIHRoaXM7fX1pZih0eXBlT2YoaSk9PSJmdW5jdGlvbiIpe2lmKGkuJGhpZGRlbil7cmV0dXJuIHRoaXM7Cn10aGlzLnByb3RvdHlwZVtoXT0oZyk/aTpiKHRoaXMsaCxpKTt9ZWxzZXtPYmplY3QubWVyZ2UodGhpcy5wcm90b3R5cGUsaCxpKTt9cmV0dXJuIHRoaXM7fTt2YXIgZD1mdW5jdGlvbihnKXtnLiRwcm90b3R5cGluZz10cnVlO3ZhciBoPW5ldyBnO2RlbGV0ZSBnLiRwcm90b3R5cGluZzsKcmV0dXJuIGg7fTthLmltcGxlbWVudCgiaW1wbGVtZW50IixmLm92ZXJsb2FkU2V0dGVyKCkpO2EuTXV0YXRvcnM9e0V4dGVuZHM6ZnVuY3Rpb24oZyl7dGhpcy5wYXJlbnQ9Zzt0aGlzLnByb3RvdHlwZT1kKGcpO30sSW1wbGVtZW50czpmdW5jdGlvbihnKXtBcnJheS5mcm9tKGcpLmVhY2goZnVuY3Rpb24oail7dmFyIGg9bmV3IGo7CmZvcih2YXIgaSBpbiBoKXtmLmNhbGwodGhpcyxpLGhbaV0sdHJ1ZSk7fX0sdGhpcyk7fX07fSkoKTsoZnVuY3Rpb24oKXt0aGlzLkNoYWluPW5ldyBDbGFzcyh7JGNoYWluOltdLGNoYWluOmZ1bmN0aW9uKCl7dGhpcy4kY2hhaW4uYXBwZW5kKEFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKSk7CnJldHVybiB0aGlzO30sY2FsbENoYWluOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuJGNoYWluLmxlbmd0aCk/dGhpcy4kY2hhaW4uc2hpZnQoKS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6ZmFsc2U7fSxjbGVhckNoYWluOmZ1bmN0aW9uKCl7dGhpcy4kY2hhaW4uZW1wdHkoKTsKcmV0dXJuIHRoaXM7fX0pO3ZhciBhPWZ1bmN0aW9uKGIpe3JldHVybiBiLnJlcGxhY2UoL15vbihbQS1aXSkvLGZ1bmN0aW9uKGMsZCl7cmV0dXJuIGQudG9Mb3dlckNhc2UoKTt9KTt9O3RoaXMuRXZlbnRzPW5ldyBDbGFzcyh7JGV2ZW50czp7fSxhZGRFdmVudDpmdW5jdGlvbihkLGMsYil7ZD1hKGQpOwppZihjPT0kZW1wdHkpe3JldHVybiB0aGlzO310aGlzLiRldmVudHNbZF09KHRoaXMuJGV2ZW50c1tkXXx8W10pLmluY2x1ZGUoYyk7aWYoYil7Yy5pbnRlcm5hbD10cnVlO31yZXR1cm4gdGhpczt9LGFkZEV2ZW50czpmdW5jdGlvbihiKXtmb3IodmFyIGMgaW4gYil7dGhpcy5hZGRFdmVudChjLGJbY10pOwp9cmV0dXJuIHRoaXM7fSxmaXJlRXZlbnQ6ZnVuY3Rpb24oZSxjLGIpe2U9YShlKTt2YXIgZD10aGlzLiRldmVudHNbZV07aWYoIWQpe3JldHVybiB0aGlzO31jPUFycmF5LmZyb20oYyk7ZC5lYWNoKGZ1bmN0aW9uKGYpe2lmKGIpe2YuZGVsYXkoYix0aGlzLGMpO31lbHNle2YuYXBwbHkodGhpcyxjKTsKfX0sdGhpcyk7cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudDpmdW5jdGlvbihlLGQpe2U9YShlKTt2YXIgYz10aGlzLiRldmVudHNbZV07aWYoYyYmIWQuaW50ZXJuYWwpe3ZhciBiPWMuaW5kZXhPZihkKTtpZihiIT0tMSl7ZGVsZXRlIGNbYl07fX1yZXR1cm4gdGhpczsKfSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oZCl7dmFyIGU7aWYodHlwZU9mKGQpPT0ib2JqZWN0Iil7Zm9yKGUgaW4gZCl7dGhpcy5yZW1vdmVFdmVudChlLGRbZV0pO31yZXR1cm4gdGhpczt9aWYoZCl7ZD1hKGQpO31mb3IoZSBpbiB0aGlzLiRldmVudHMpe2lmKGQmJmQhPWUpe2NvbnRpbnVlOwp9dmFyIGM9dGhpcy4kZXZlbnRzW2VdO2Zvcih2YXIgYj1jLmxlbmd0aDtiLS07KXt0aGlzLnJlbW92ZUV2ZW50KGUsY1tiXSk7fX1yZXR1cm4gdGhpczt9fSk7dGhpcy5PcHRpb25zPW5ldyBDbGFzcyh7c2V0T3B0aW9uczpmdW5jdGlvbigpe3ZhciBiPXRoaXMub3B0aW9ucz1PYmplY3QubWVyZ2UuYXBwbHkobnVsbCxbe30sdGhpcy5vcHRpb25zXS5hcHBlbmQoYXJndW1lbnRzKSk7CmlmKCF0aGlzLmFkZEV2ZW50KXtyZXR1cm4gdGhpczt9Zm9yKHZhciBjIGluIGIpe2lmKHR5cGVPZihiW2NdKSE9ImZ1bmN0aW9uInx8ISgvXm9uW0EtWl0vKS50ZXN0KGMpKXtjb250aW51ZTt9dGhpcy5hZGRFdmVudChjLGJbY10pO2RlbGV0ZSBiW2NdO31yZXR1cm4gdGhpczsKfX0pO30pKCk7KGZ1bmN0aW9uKCl7dmFyIGssbixsLGcsYT17fSxjPXt9LG09L1xcL2c7dmFyIGU9ZnVuY3Rpb24ocSxwKXtpZihxPT1udWxsKXtyZXR1cm4gbnVsbDt9aWYocS5TbGljaz09PXRydWUpe3JldHVybiBxO31xPSgiIitxKS5yZXBsYWNlKC9eXHMrfFxzKyQvZywiIik7Cmc9ISFwO3ZhciBvPShnKT9jOmE7aWYob1txXSl7cmV0dXJuIG9bcV07fWs9e1NsaWNrOnRydWUsZXhwcmVzc2lvbnM6W10scmF3OnEscmV2ZXJzZTpmdW5jdGlvbigpe3JldHVybiBlKHRoaXMucmF3LHRydWUpO319O249LTE7d2hpbGUocSE9KHE9cS5yZXBsYWNlKGosYikpKXt9ay5sZW5ndGg9ay5leHByZXNzaW9ucy5sZW5ndGg7CnJldHVybiBvW3FdPShnKT9oKGspOms7fTt2YXIgaT1mdW5jdGlvbihvKXtpZihvPT09IiEiKXtyZXR1cm4iICI7fWVsc2V7aWYobz09PSIgIil7cmV0dXJuIiEiO31lbHNle2lmKCgvXiEvKS50ZXN0KG8pKXtyZXR1cm4gby5yZXBsYWNlKC9eIS8sIiIpO31lbHNle3JldHVybiIhIitvOwp9fX19O3ZhciBoPWZ1bmN0aW9uKHUpe3ZhciByPXUuZXhwcmVzc2lvbnM7Zm9yKHZhciBwPTA7cDxyLmxlbmd0aDtwKyspe3ZhciB0PXJbcF07dmFyIHE9e3BhcnRzOltdLHRhZzoiKiIsY29tYmluYXRvcjppKHRbMF0uY29tYmluYXRvcil9O2Zvcih2YXIgbz0wO288dC5sZW5ndGg7Cm8rKyl7dmFyIHM9dFtvXTtpZighcy5yZXZlcnNlQ29tYmluYXRvcil7cy5yZXZlcnNlQ29tYmluYXRvcj0iICI7fXMuY29tYmluYXRvcj1zLnJldmVyc2VDb21iaW5hdG9yO2RlbGV0ZSBzLnJldmVyc2VDb21iaW5hdG9yO310LnJldmVyc2UoKS5wdXNoKHEpO31yZXR1cm4gdTsKfTt2YXIgZj1mdW5jdGlvbihvKXtyZXR1cm4gby5yZXBsYWNlKC9bLVtcXXt9KCkqKz8uXFxeJHwsI1xzXS9nLCJcXCQmIik7fTt2YXIgaj1uZXcgUmVnRXhwKCJeKD86XFxzKigsKVxccyp8XFxzKig8Y29tYmluYXRvcj4rKVxccyp8KFxccyspfCg8dW5pY29kZT4rfFxcKil8XFwjKDx1bmljb2RlPispfFxcLig8dW5pY29kZT4rKXxcXFtcXHMqKDx1bmljb2RlMT4rKSg/OlxccyooWypeJCF+fF0/PSkoPzpcXHMqKD86KFtcIiddPykoLio/KVxcOSkpKT9cXHMqXFxdKD8hXFxdKXw6Kyg8dW5pY29kZT4rKSg/OlxcKCg/Oig/OihbXCInXSkoW15cXDEyXSopXFwxMil8KCg/OlxcKFteKV0rXFwpfFteKCldKikrKSlcXCkpPykiLnJlcGxhY2UoLzxjb21iaW5hdG9yPi8sIlsiK2YoIj4rfmAhQCQlXiY9e31cXDs8LyIpKyJdIikucmVwbGFjZSgvPHVuaWNvZGU+L2csIig/OltcXHdcXHUwMGExLVxcdUZGRkYtXXxcXFxcW15cXHMwLTlhLWZdKSIpLnJlcGxhY2UoLzx1bmljb2RlMT4vZywiKD86WzpcXHdcXHUwMGExLVxcdUZGRkYtXXxcXFxcW15cXHMwLTlhLWZdKSIpKTsKZnVuY3Rpb24gYih4LHMsRCx6LHIsQyxxLEIsQSx5LHUsRix2LHAsdyl7aWYoc3x8bj09PS0xKXtrLmV4cHJlc3Npb25zWysrbl09W107bD0tMTtpZihzKXtyZXR1cm4iIjt9fWlmKER8fHp8fGw9PT0tMSl7RD1EfHwiICI7dmFyIHQ9ay5leHByZXNzaW9uc1tuXTtpZihnJiZ0W2xdKXt0W2xdLnJldmVyc2VDb21iaW5hdG9yPWkoRCk7Cn10WysrbF09e2NvbWJpbmF0b3I6RCx0YWc6IioifTt9dmFyIG89ay5leHByZXNzaW9uc1tuXVtsXTtpZihyKXtvLnRhZz1yLnJlcGxhY2UobSwiIik7fWVsc2V7aWYoQyl7by5pZD1DLnJlcGxhY2UobSwiIik7fWVsc2V7aWYocSl7cT1xLnJlcGxhY2UobSwiIik7aWYoIW8uY2xhc3NMaXN0KXtvLmNsYXNzTGlzdD1bXTsKfWlmKCFvLmNsYXNzZXMpe28uY2xhc3Nlcz1bXTt9by5jbGFzc0xpc3QucHVzaChxKTtvLmNsYXNzZXMucHVzaCh7dmFsdWU6cSxyZWdleHA6bmV3IFJlZ0V4cCgiKF58XFxzKSIrZihxKSsiKFxcc3wkKSIpfSk7fWVsc2V7aWYoRil7dz13fHxwO3c9dz93LnJlcGxhY2UobSwiIik6bnVsbDsKaWYoIW8ucHNldWRvcyl7by5wc2V1ZG9zPVtdO31vLnBzZXVkb3MucHVzaCh7a2V5OkYucmVwbGFjZShtLCIiKSx2YWx1ZTp3fSk7fWVsc2V7aWYoQil7Qj1CLnJlcGxhY2UobSwiIik7dT0odXx8IiIpLnJlcGxhY2UobSwiIik7dmFyIEUsRztzd2l0Y2goQSl7Y2FzZSJePSI6Rz1uZXcgUmVnRXhwKCJeIitmKHUpKTsKYnJlYWs7Y2FzZSIkPSI6Rz1uZXcgUmVnRXhwKGYodSkrIiQiKTticmVhaztjYXNlIn49IjpHPW5ldyBSZWdFeHAoIihefFxccykiK2YodSkrIihcXHN8JCkiKTticmVhaztjYXNlInw9IjpHPW5ldyBSZWdFeHAoIl4iK2YodSkrIigtfCQpIik7YnJlYWs7Y2FzZSI9IjpFPWZ1bmN0aW9uKEgpe3JldHVybiB1PT1IOwp9O2JyZWFrO2Nhc2UiKj0iOkU9ZnVuY3Rpb24oSCl7cmV0dXJuIEgmJkguaW5kZXhPZih1KT4tMTt9O2JyZWFrO2Nhc2UiIT0iOkU9ZnVuY3Rpb24oSCl7cmV0dXJuIHUhPUg7fTticmVhaztkZWZhdWx0OkU9ZnVuY3Rpb24oSCl7cmV0dXJuICEhSDt9O31pZih1PT0iIiYmKC9eWyokXl09JC8pLnRlc3QoQSkpe0U9ZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7Cn07fWlmKCFFKXtFPWZ1bmN0aW9uKEgpe3JldHVybiBIJiZHLnRlc3QoSCk7fTt9aWYoIW8uYXR0cmlidXRlcyl7by5hdHRyaWJ1dGVzPVtdO31vLmF0dHJpYnV0ZXMucHVzaCh7a2V5OkIsb3BlcmF0b3I6QSx2YWx1ZTp1LHRlc3Q6RX0pO319fX19cmV0dXJuIiI7fXZhciBkPSh0aGlzLlNsaWNrfHx7fSk7CmQucGFyc2U9ZnVuY3Rpb24obyl7cmV0dXJuIGUobyk7fTtkLmVzY2FwZVJlZ0V4cD1mO2lmKCF0aGlzLlNsaWNrKXt0aGlzLlNsaWNrPWQ7fX0pLmFwcGx5KCh0eXBlb2YgZXhwb3J0cyE9InVuZGVmaW5lZCIpP2V4cG9ydHM6dGhpcyk7KGZ1bmN0aW9uKCl7dmFyIGI9e307CmIuaXNOYXRpdmVDb2RlPWZ1bmN0aW9uKGMpe3JldHVybigvXHtccypcW25hdGl2ZSBjb2RlXF1ccypcfS8pLnRlc3QoIiIrYyk7fTtiLmlzWE1MPWZ1bmN0aW9uKGMpe3JldHVybighIWMueG1sVmVyc2lvbil8fCghIWMueG1sKXx8KE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChjKT09PSJbb2JqZWN0IFhNTERvY3VtZW50XSIpfHwoYy5ub2RlVHlwZT09PTkmJmMuZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lIT09IkhUTUwiKTsKfTtiLnNldERvY3VtZW50PWZ1bmN0aW9uKG4pe2lmKG4ubm9kZVR5cGU9PT05KXt9ZWxzZXtpZihuLm93bmVyRG9jdW1lbnQpe249bi5vd25lckRvY3VtZW50O31lbHNle2lmKG4ubmF2aWdhdG9yKXtuPW4uZG9jdW1lbnQ7fWVsc2V7cmV0dXJuO319fWlmKHRoaXMuZG9jdW1lbnQ9PT1uKXtyZXR1cm47Cn10aGlzLmRvY3VtZW50PW47dmFyIG89dGhpcy5yb290PW4uZG9jdW1lbnRFbGVtZW50O3RoaXMuaXNYTUxEb2N1bWVudD10aGlzLmlzWE1MKG4pO3RoaXMuYnJva2VuU3RhckdFQlROPXRoaXMuc3RhclNlbGVjdHNDbG9zZWRRU0E9dGhpcy5pZEdldHNOYW1lPXRoaXMuYnJva2VuTWl4ZWRDYXNlUVNBPXRoaXMuYnJva2VuR0VCQ049dGhpcy5icm9rZW5DaGVja2VkUVNBPXRoaXMuYnJva2VuRW1wdHlBdHRyaWJ1dGVRU0E9dGhpcy5pc0hUTUxEb2N1bWVudD1mYWxzZTsKdmFyIGksaixwLGs7dmFyIGwsYzt2YXIgcT1uLmNyZWF0ZUVsZW1lbnQoImRpdiIpO28uYXBwZW5kQ2hpbGQocSk7dHJ5e2M9InNsaWNrX2dldGJ5aWRfdGVzdCI7cS5pbm5lckhUTUw9JzxhIGlkPSInK2MrJyI+PC9hPic7dGhpcy5pc0hUTUxEb2N1bWVudD0hIW4uZ2V0RWxlbWVudEJ5SWQoYyk7Cn1jYXRjaChtKXt9aWYodGhpcy5pc0hUTUxEb2N1bWVudCl7cS5zdHlsZS5kaXNwbGF5PSJub25lIjtxLmFwcGVuZENoaWxkKG4uY3JlYXRlQ29tbWVudCgiIikpO2o9KHEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKS5sZW5ndGg+MCk7dHJ5e3EuaW5uZXJIVE1MPSJmb288L2Zvbz4iOwpsPXEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKTtpPShsJiZsLmxlbmd0aCYmbFswXS5ub2RlTmFtZS5jaGFyQXQoMCk9PSIvIik7fWNhdGNoKG0pe310aGlzLmJyb2tlblN0YXJHRUJUTj1qfHxpO2lmKHEucXVlcnlTZWxlY3RvckFsbCl7dHJ5e3EuaW5uZXJIVE1MPSJmb288L2Zvbz4iOwpsPXEucXVlcnlTZWxlY3RvckFsbCgiKiIpO3RoaXMuc3RhclNlbGVjdHNDbG9zZWRRU0E9KGwmJmwubGVuZ3RoJiZsWzBdLm5vZGVOYW1lLmNoYXJBdCgwKT09Ii8iKTt9Y2F0Y2gobSl7fX10cnl7Yz0ic2xpY2tfaWRfZ2V0c19uYW1lIjtxLmlubmVySFRNTD0nPGEgbmFtZT0iJytjKyciPjwvYT48YiBpZD0iJytjKyciPjwvYj4nOwp0aGlzLmlkR2V0c05hbWU9bi5nZXRFbGVtZW50QnlJZChjKT09PXEuZmlyc3RDaGlsZDt9Y2F0Y2gobSl7fXRyeXtxLmlubmVySFRNTD0nPGEgY2xhc3M9Ik1pWGVkQ2FTZSI+PC9hPic7dGhpcy5icm9rZW5NaXhlZENhc2VRU0E9IXEucXVlcnlTZWxlY3RvckFsbCgiLk1pWGVkQ2FTZSIpLmxlbmd0aDsKfWNhdGNoKG0pe310cnl7cS5pbm5lckhUTUw9JzxhIGNsYXNzPSJmIj48L2E+PGEgY2xhc3M9ImIiPjwvYT4nO3EuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiYiIpLmxlbmd0aDtxLmZpcnN0Q2hpbGQuY2xhc3NOYW1lPSJiIjtrPShxLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImIiKS5sZW5ndGghPTIpOwp9Y2F0Y2gobSl7fXRyeXtxLmlubmVySFRNTD0nPGEgY2xhc3M9ImEiPjwvYT48YSBjbGFzcz0iZiBiIGEiPjwvYT4nO3A9KHEuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiYSIpLmxlbmd0aCE9Mik7fWNhdGNoKG0pe310aGlzLmJyb2tlbkdFQkNOPWt8fHA7dHJ5e3EuaW5uZXJIVE1MPSc8c2VsZWN0PjxvcHRpb24gc2VsZWN0ZWQ9InNlbGVjdGVkIj5hPC9vcHRpb24+PC9zZWxlY3Q+JzsKdGhpcy5icm9rZW5DaGVja2VkUVNBPShxLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RoPT0wKTt9Y2F0Y2gobSl7fXRyeXtxLmlubmVySFRNTD0nPGEgY2xhc3M9IiI+PC9hPic7dGhpcy5icm9rZW5FbXB0eUF0dHJpYnV0ZVFTQT0ocS5xdWVyeVNlbGVjdG9yQWxsKCdbY2xhc3MqPSIiXScpLmxlbmd0aCE9MCk7Cn1jYXRjaChtKXt9fW8ucmVtb3ZlQ2hpbGQocSk7cT1udWxsO3RoaXMuaGFzQXR0cmlidXRlPShvJiZ0aGlzLmlzTmF0aXZlQ29kZShvLmhhc0F0dHJpYnV0ZSkpP2Z1bmN0aW9uKHMscil7cmV0dXJuIHMuaGFzQXR0cmlidXRlKHIpO306ZnVuY3Rpb24ocyxyKXtzPXMuZ2V0QXR0cmlidXRlTm9kZShyKTsKcmV0dXJuICEhKHMmJihzLnNwZWNpZmllZHx8cy5ub2RlVmFsdWUpKTt9O3RoaXMuY29udGFpbnM9KG8mJnRoaXMuaXNOYXRpdmVDb2RlKG8uY29udGFpbnMpKT9mdW5jdGlvbihyLHMpe3JldHVybiByLmNvbnRhaW5zKHMpO306KG8mJm8uY29tcGFyZURvY3VtZW50UG9zaXRpb24pP2Z1bmN0aW9uKHIscyl7cmV0dXJuIHI9PT1zfHwhIShyLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKHMpJjE2KTsKfTpmdW5jdGlvbihyLHMpe2lmKHMpe2Rve2lmKHM9PT1yKXtyZXR1cm4gdHJ1ZTt9fXdoaWxlKChzPXMucGFyZW50Tm9kZSkpO31yZXR1cm4gZmFsc2U7fTt0aGlzLmRvY3VtZW50U29ydGVyPShvLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKT9mdW5jdGlvbihzLHIpe2lmKCFzLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9ufHwhci5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbil7cmV0dXJuIDA7Cn1yZXR1cm4gcy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihyKSY0Py0xOnM9PT1yPzA6MTt9Oigic291cmNlSW5kZXgiIGluIG8pP2Z1bmN0aW9uKHMscil7aWYoIXMuc291cmNlSW5kZXh8fCFyLnNvdXJjZUluZGV4KXtyZXR1cm4gMDt9cmV0dXJuIHMuc291cmNlSW5kZXgtci5zb3VyY2VJbmRleDsKfToobi5jcmVhdGVSYW5nZSk/ZnVuY3Rpb24odSxzKXtpZighdS5vd25lckRvY3VtZW50fHwhcy5vd25lckRvY3VtZW50KXtyZXR1cm4gMDt9dmFyIHQ9dS5vd25lckRvY3VtZW50LmNyZWF0ZVJhbmdlKCkscj1zLm93bmVyRG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTt0LnNldFN0YXJ0KHUsMCk7CnQuc2V0RW5kKHUsMCk7ci5zZXRTdGFydChzLDApO3Iuc2V0RW5kKHMsMCk7cmV0dXJuIHQuY29tcGFyZUJvdW5kYXJ5UG9pbnRzKFJhbmdlLlNUQVJUX1RPX0VORCxyKTt9Om51bGw7dGhpcy5nZXRVSUQ9KHRoaXMuaXNIVE1MRG9jdW1lbnQpP3RoaXMuZ2V0VUlESFRNTDp0aGlzLmdldFVJRFhNTDsKfTtiLnNlYXJjaD1mdW5jdGlvbihrLHgsRixxKXt2YXIgdz10aGlzLmZvdW5kPShxKT9udWxsOihGfHxbXSk7aWYoIWspe3JldHVybiB3O31pZihrLm5hdmlnYXRvcil7az1rLmRvY3VtZW50O31lbHNle2lmKCFrLm5vZGVUeXBlKXtyZXR1cm4gdzt9fXZhciB0LEU7dmFyIG89dGhpcy51bmlxdWVzPXt9OwppZih0aGlzLmRvY3VtZW50IT09KGsub3duZXJEb2N1bWVudHx8aykpe3RoaXMuc2V0RG9jdW1lbnQoayk7fXZhciB5PSEhKEYmJkYubGVuZ3RoKTtpZih5KXtmb3IoRT13Lmxlbmd0aDtFLS07KXt0aGlzLnVuaXF1ZXNbdGhpcy5nZXRVSUQod1tFXSldPXRydWU7fX1pZih0eXBlb2YgeD09InN0cmluZyIpe2ZvcihFPXRoaXMub3ZlcnJpZGVzLmxlbmd0aDsKRS0tOyl7dmFyIHU9dGhpcy5vdmVycmlkZXNbRV07aWYodS5yZWdleHAudGVzdCh4KSl7dmFyIHY9dS5tZXRob2QuY2FsbChrLHgsdyxxKTtpZih2PT09ZmFsc2Upe2NvbnRpbnVlO31pZih2PT09dHJ1ZSl7cmV0dXJuIHc7fXJldHVybiB2O319dD10aGlzLlNsaWNrLnBhcnNlKHgpOwppZighdC5sZW5ndGgpe3JldHVybiB3O319ZWxzZXtpZih4PT1udWxsKXtyZXR1cm4gdzt9ZWxzZXtpZih4LlNsaWNrKXt0PXg7fWVsc2V7aWYodGhpcy5jb250YWlucyhrLmRvY3VtZW50RWxlbWVudHx8ayx4KSl7KHcpP3cucHVzaCh4KTp3PXg7cmV0dXJuIHc7fWVsc2V7cmV0dXJuIHc7Cn19fX10aGlzLnBvc05USD17fTt0aGlzLnBvc05USExhc3Q9e307dGhpcy5wb3NOVEhUeXBlPXt9O3RoaXMucG9zTlRIVHlwZUxhc3Q9e307dGhpcy5wdXNoPSgheSYmKHF8fCh0Lmxlbmd0aD09MSYmdC5leHByZXNzaW9uc1swXS5sZW5ndGg9PTEpKSk/dGhpcy5wdXNoQXJyYXk6dGhpcy5wdXNoVUlEOwppZih3PT1udWxsKXt3PVtdO312YXIgRCxCLEE7dmFyIEMsSyx6LEosRyxzLHA7dmFyIHIsbCxjLEgsST10LmV4cHJlc3Npb25zO3NlYXJjaDpmb3IoRT0wOyhsPUlbRV0pO0UrKyl7Zm9yKEQ9MDsoYz1sW0RdKTtEKyspe0M9ImNvbWJpbmF0b3I6IitjLmNvbWJpbmF0b3I7CmlmKCF0aGlzW0NdKXtjb250aW51ZSBzZWFyY2g7fUs9KHRoaXMuaXNYTUxEb2N1bWVudCk/Yy50YWc6Yy50YWcudG9VcHBlckNhc2UoKTt6PWMuaWQ7Sj1jLmNsYXNzTGlzdDtHPWMuY2xhc3NlcztzPWMuYXR0cmlidXRlcztwPWMucHNldWRvcztIPShEPT09KGwubGVuZ3RoLTEpKTsKdGhpcy5iaXRVbmlxdWVzPXt9O2lmKEgpe3RoaXMudW5pcXVlcz1vO3RoaXMuZm91bmQ9dzt9ZWxzZXt0aGlzLnVuaXF1ZXM9e307dGhpcy5mb3VuZD1bXTt9aWYoRD09PTApe3RoaXNbQ10oayxLLHosRyxzLHAsSik7aWYocSYmSCYmdy5sZW5ndGgpe2JyZWFrIHNlYXJjaDsKfX1lbHNle2lmKHEmJkgpe2ZvcihCPTAsQT1yLmxlbmd0aDtCPEE7QisrKXt0aGlzW0NdKHJbQl0sSyx6LEcscyxwLEopO2lmKHcubGVuZ3RoKXticmVhayBzZWFyY2g7fX19ZWxzZXtmb3IoQj0wLEE9ci5sZW5ndGg7QjxBO0IrKyl7dGhpc1tDXShyW0JdLEsseixHLHMscCxKKTsKfX19cj10aGlzLmZvdW5kO319aWYoeXx8KHQuZXhwcmVzc2lvbnMubGVuZ3RoPjEpKXt0aGlzLnNvcnQodyk7fXJldHVybihxKT8od1swXXx8bnVsbCk6dzt9O2IudWlkeD0xO2IudWlkaz0ic2xpY2s6dW5pcXVlaWQiO2IuZ2V0VUlEWE1MPWZ1bmN0aW9uKGkpe3ZhciBjPWkuZ2V0QXR0cmlidXRlKHRoaXMudWlkayk7CmlmKCFjKXtjPXRoaXMudWlkeCsrO2kuc2V0QXR0cmlidXRlKHRoaXMudWlkayxjKTt9cmV0dXJuIGM7fTtiLmdldFVJREhUTUw9ZnVuY3Rpb24oYyl7cmV0dXJuIGMudW5pcXVlTnVtYmVyfHwoYy51bmlxdWVOdW1iZXI9dGhpcy51aWR4KyspO307Yi5zb3J0PWZ1bmN0aW9uKGMpe2lmKCF0aGlzLmRvY3VtZW50U29ydGVyKXtyZXR1cm4gYzsKfWMuc29ydCh0aGlzLmRvY3VtZW50U29ydGVyKTtyZXR1cm4gYzt9O2IuY2FjaGVOVEg9e307Yi5tYXRjaE5USD0vXihbKy1dP1xkKik/KFthLXpdKyk/KFsrLV1cZCspPyQvO2IucGFyc2VOVEhBcmd1bWVudD1mdW5jdGlvbihsKXt2YXIgaj1sLm1hdGNoKHRoaXMubWF0Y2hOVEgpOwppZighail7cmV0dXJuIGZhbHNlO312YXIgaz1qWzJdfHxmYWxzZTt2YXIgaT1qWzFdfHwxO2lmKGk9PSItIil7aT0tMTt9dmFyIGM9K2pbM118fDA7aj0oaz09Im4iKT97YTppLGI6Y306KGs9PSJvZGQiKT97YToyLGI6MX06KGs9PSJldmVuIik/e2E6MixiOjB9OnthOjAsYjppfTsKcmV0dXJuKHRoaXMuY2FjaGVOVEhbbF09aik7fTtiLmNyZWF0ZU5USFBzZXVkbz1mdW5jdGlvbihrLGksYyxqKXtyZXR1cm4gZnVuY3Rpb24obixsKXt2YXIgcD10aGlzLmdldFVJRChuKTtpZighdGhpc1tjXVtwXSl7dmFyIHY9bi5wYXJlbnROb2RlO2lmKCF2KXtyZXR1cm4gZmFsc2U7Cn12YXIgbT12W2tdLG89MTtpZihqKXt2YXIgdT1uLm5vZGVOYW1lO2Rve2lmKG0ubm9kZU5hbWUhPT11KXtjb250aW51ZTt9dGhpc1tjXVt0aGlzLmdldFVJRChtKV09bysrO313aGlsZSgobT1tW2ldKSk7fWVsc2V7ZG97aWYobS5ub2RlVHlwZSE9PTEpe2NvbnRpbnVlOwp9dGhpc1tjXVt0aGlzLmdldFVJRChtKV09bysrO313aGlsZSgobT1tW2ldKSk7fX1sPWx8fCJuIjt2YXIgcT10aGlzLmNhY2hlTlRIW2xdfHx0aGlzLnBhcnNlTlRIQXJndW1lbnQobCk7aWYoIXEpe3JldHVybiBmYWxzZTt9dmFyIHQ9cS5hLHM9cS5iLHI9dGhpc1tjXVtwXTsKaWYodD09MCl7cmV0dXJuIHM9PXI7fWlmKHQ+MCl7aWYocjxzKXtyZXR1cm4gZmFsc2U7fX1lbHNle2lmKHM8cil7cmV0dXJuIGZhbHNlO319cmV0dXJuKChyLXMpJXQpPT0wO307fTtiLnB1c2hBcnJheT1mdW5jdGlvbihrLGMsbSxqLGksbCl7aWYodGhpcy5tYXRjaFNlbGVjdG9yKGssYyxtLGosaSxsKSl7dGhpcy5mb3VuZC5wdXNoKGspOwp9fTtiLnB1c2hVSUQ9ZnVuY3Rpb24obCxjLG4sayxpLG0pe3ZhciBqPXRoaXMuZ2V0VUlEKGwpO2lmKCF0aGlzLnVuaXF1ZXNbal0mJnRoaXMubWF0Y2hTZWxlY3RvcihsLGMsbixrLGksbSkpe3RoaXMudW5pcXVlc1tqXT10cnVlO3RoaXMuZm91bmQucHVzaChsKTt9fTsKYi5tYXRjaE5vZGU9ZnVuY3Rpb24obixjKXt2YXIgaz10aGlzLlNsaWNrLnBhcnNlKGMpO2lmKCFrKXtyZXR1cm4gdHJ1ZTt9aWYoay5sZW5ndGg9PTEmJmsuZXhwcmVzc2lvbnNbMF0ubGVuZ3RoPT0xKXt2YXIgbz1rLmV4cHJlc3Npb25zWzBdWzBdO3JldHVybiB0aGlzLm1hdGNoU2VsZWN0b3IobiwodGhpcy5pc1hNTERvY3VtZW50KT9vLnRhZzpvLnRhZy50b1VwcGVyQ2FzZSgpLG8uaWQsby5jbGFzc2VzLG8uYXR0cmlidXRlcyxvLnBzZXVkb3MpOwp9dmFyIGo9dGhpcy5zZWFyY2godGhpcy5kb2N1bWVudCxrKTtmb3IodmFyIGw9MCxtO209altsKytdOyl7aWYobT09PW4pe3JldHVybiB0cnVlO319cmV0dXJuIGZhbHNlO307Yi5tYXRjaFBzZXVkbz1mdW5jdGlvbihsLGMsayl7dmFyIGk9InBzZXVkbzoiK2M7aWYodGhpc1tpXSl7cmV0dXJuIHRoaXNbaV0obCxrKTsKfXZhciBqPXRoaXMuZ2V0QXR0cmlidXRlKGwsYyk7cmV0dXJuKGspP2s9PWo6ISFqO307Yi5tYXRjaFNlbGVjdG9yPWZ1bmN0aW9uKGsscSxjLGwsbSxvKXtpZihxKXtpZihxPT0iKiIpe2lmKGsubm9kZU5hbWU8IkAiKXtyZXR1cm4gZmFsc2U7fX1lbHNle2lmKGsubm9kZU5hbWUhPXEpe3JldHVybiBmYWxzZTsKfX19aWYoYyYmay5nZXRBdHRyaWJ1dGUoImlkIikhPWMpe3JldHVybiBmYWxzZTt9dmFyIG4saixwO2lmKGwpe2ZvcihuPWwubGVuZ3RoO24tLTspe3A9KCJjbGFzc05hbWUiIGluIGspP2suY2xhc3NOYW1lOmsuZ2V0QXR0cmlidXRlKCJjbGFzcyIpO2lmKCEocCYmbFtuXS5yZWdleHAudGVzdChwKSkpe3JldHVybiBmYWxzZTsKfX19aWYobSl7Zm9yKG49bS5sZW5ndGg7bi0tOyl7aj1tW25dO2lmKGoub3BlcmF0b3I/IWoudGVzdCh0aGlzLmdldEF0dHJpYnV0ZShrLGoua2V5KSk6IXRoaXMuaGFzQXR0cmlidXRlKGssai5rZXkpKXtyZXR1cm4gZmFsc2U7fX19aWYobyl7Zm9yKG49by5sZW5ndGg7Cm4tLTspe2o9b1tuXTtpZighdGhpcy5tYXRjaFBzZXVkbyhrLGoua2V5LGoudmFsdWUpKXtyZXR1cm4gZmFsc2U7fX19cmV0dXJuIHRydWU7fTt2YXIgYT17IiAiOmZ1bmN0aW9uKGwscixjLG0sbixwLGspe3ZhciBvLHEsajtpZih0aGlzLmlzSFRNTERvY3VtZW50KXtnZXRCeUlkOmlmKGMpe3E9dGhpcy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChjKTsKaWYoKCFxJiZsLmFsbCl8fCh0aGlzLmlkR2V0c05hbWUmJnEmJnEuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS5ub2RlVmFsdWUhPWMpKXtqPWwuYWxsW2NdO2lmKCFqKXtyZXR1cm47fWlmKCFqWzBdKXtqPVtqXTt9Zm9yKG89MDtxPWpbbysrXTspe2lmKHEuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS5ub2RlVmFsdWU9PWMpe3RoaXMucHVzaChxLHIsbnVsbCxtLG4scCk7CmJyZWFrO319cmV0dXJuO31pZighcSl7aWYodGhpcy5jb250YWlucyh0aGlzLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxsKSl7cmV0dXJuO31lbHNle2JyZWFrIGdldEJ5SWQ7fX1lbHNle2lmKHRoaXMuZG9jdW1lbnQhPT1sJiYhdGhpcy5jb250YWlucyhsLHEpKXtyZXR1cm47Cn19dGhpcy5wdXNoKHEscixudWxsLG0sbixwKTtyZXR1cm47fWdldEJ5Q2xhc3M6aWYobSYmbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiYhdGhpcy5icm9rZW5HRUJDTil7aj1sLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoay5qb2luKCIgIikpO2lmKCEoaiYmai5sZW5ndGgpKXticmVhayBnZXRCeUNsYXNzOwp9Zm9yKG89MDtxPWpbbysrXTspe3RoaXMucHVzaChxLHIsYyxudWxsLG4scCk7fXJldHVybjt9fWdldEJ5VGFnOntqPWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUocik7aWYoIShqJiZqLmxlbmd0aCkpe2JyZWFrIGdldEJ5VGFnO31pZighdGhpcy5icm9rZW5TdGFyR0VCVE4pe3I9bnVsbDsKfWZvcihvPTA7cT1qW28rK107KXt0aGlzLnB1c2gocSxyLGMsbSxuLHApO319fSwiPiI6ZnVuY3Rpb24oayxjLG0saixpLGwpe2lmKChrPWsuZmlyc3RDaGlsZCkpe2Rve2lmKGsubm9kZVR5cGU9PT0xKXt0aGlzLnB1c2goayxjLG0saixpLGwpO319d2hpbGUoKGs9ay5uZXh0U2libGluZykpOwp9fSwiKyI6ZnVuY3Rpb24oayxjLG0saixpLGwpe3doaWxlKChrPWsubmV4dFNpYmxpbmcpKXtpZihrLm5vZGVUeXBlPT09MSl7dGhpcy5wdXNoKGssYyxtLGosaSxsKTticmVhazt9fX0sIl4iOmZ1bmN0aW9uKGssYyxtLGosaSxsKXtrPWsuZmlyc3RDaGlsZDtpZihrKXtpZihrLm5vZGVUeXBlPT09MSl7dGhpcy5wdXNoKGssYyxtLGosaSxsKTsKfWVsc2V7dGhpc1siY29tYmluYXRvcjorIl0oayxjLG0saixpLGwpO319fSwifiI6ZnVuY3Rpb24obCxjLG4sayxpLG0pe3doaWxlKChsPWwubmV4dFNpYmxpbmcpKXtpZihsLm5vZGVUeXBlIT09MSl7Y29udGludWU7fXZhciBqPXRoaXMuZ2V0VUlEKGwpO2lmKHRoaXMuYml0VW5pcXVlc1tqXSl7YnJlYWs7Cn10aGlzLmJpdFVuaXF1ZXNbal09dHJ1ZTt0aGlzLnB1c2gobCxjLG4sayxpLG0pO319LCIrKyI6ZnVuY3Rpb24oayxjLG0saixpLGwpe3RoaXNbImNvbWJpbmF0b3I6KyJdKGssYyxtLGosaSxsKTt0aGlzWyJjb21iaW5hdG9yOiErIl0oayxjLG0saixpLGwpO30sIn5+IjpmdW5jdGlvbihrLGMsbSxqLGksbCl7dGhpc1siY29tYmluYXRvcjp+Il0oayxjLG0saixpLGwpOwp0aGlzWyJjb21iaW5hdG9yOiF+Il0oayxjLG0saixpLGwpO30sIiEiOmZ1bmN0aW9uKGssYyxtLGosaSxsKXt3aGlsZSgoaz1rLnBhcmVudE5vZGUpKXtpZihrIT09dGhpcy5kb2N1bWVudCl7dGhpcy5wdXNoKGssYyxtLGosaSxsKTt9fX0sIiE+IjpmdW5jdGlvbihrLGMsbSxqLGksbCl7az1rLnBhcmVudE5vZGU7CmlmKGshPT10aGlzLmRvY3VtZW50KXt0aGlzLnB1c2goayxjLG0saixpLGwpO319LCIhKyI6ZnVuY3Rpb24oayxjLG0saixpLGwpe3doaWxlKChrPWsucHJldmlvdXNTaWJsaW5nKSl7aWYoay5ub2RlVHlwZT09PTEpe3RoaXMucHVzaChrLGMsbSxqLGksbCk7YnJlYWs7Cn19fSwiIV4iOmZ1bmN0aW9uKGssYyxtLGosaSxsKXtrPWsubGFzdENoaWxkO2lmKGspe2lmKGsubm9kZVR5cGU9PT0xKXt0aGlzLnB1c2goayxjLG0saixpLGwpO31lbHNle3RoaXNbImNvbWJpbmF0b3I6ISsiXShrLGMsbSxqLGksbCk7fX19LCIhfiI6ZnVuY3Rpb24obCxjLG4sayxpLG0pe3doaWxlKChsPWwucHJldmlvdXNTaWJsaW5nKSl7aWYobC5ub2RlVHlwZSE9PTEpe2NvbnRpbnVlOwp9dmFyIGo9dGhpcy5nZXRVSUQobCk7aWYodGhpcy5iaXRVbmlxdWVzW2pdKXticmVhazt9dGhpcy5iaXRVbmlxdWVzW2pdPXRydWU7dGhpcy5wdXNoKGwsYyxuLGssaSxtKTt9fX07Zm9yKHZhciBoIGluIGEpe2JbImNvbWJpbmF0b3I6IitoXT1hW2hdO312YXIgZz17ZW1wdHk6ZnVuY3Rpb24oYyl7dmFyIGk9Yy5maXJzdENoaWxkOwpyZXR1cm4gIShpJiZpLm5vZGVUeXBlPT0xKSYmIShjLmlubmVyVGV4dHx8Yy50ZXh0Q29udGVudHx8IiIpLmxlbmd0aDt9LG5vdDpmdW5jdGlvbihjLGkpe3JldHVybiAhdGhpcy5tYXRjaE5vZGUoYyxpKTt9LGNvbnRhaW5zOmZ1bmN0aW9uKGMsaSl7cmV0dXJuKGMuaW5uZXJUZXh0fHxjLnRleHRDb250ZW50fHwiIikuaW5kZXhPZihpKT4tMTsKfSwiZmlyc3QtY2hpbGQiOmZ1bmN0aW9uKGMpe3doaWxlKChjPWMucHJldmlvdXNTaWJsaW5nKSl7aWYoYy5ub2RlVHlwZT09PTEpe3JldHVybiBmYWxzZTt9fXJldHVybiB0cnVlO30sImxhc3QtY2hpbGQiOmZ1bmN0aW9uKGMpe3doaWxlKChjPWMubmV4dFNpYmxpbmcpKXtpZihjLm5vZGVUeXBlPT09MSl7cmV0dXJuIGZhbHNlOwp9fXJldHVybiB0cnVlO30sIm9ubHktY2hpbGQiOmZ1bmN0aW9uKGope3ZhciBpPWo7d2hpbGUoKGk9aS5wcmV2aW91c1NpYmxpbmcpKXtpZihpLm5vZGVUeXBlPT09MSl7cmV0dXJuIGZhbHNlO319dmFyIGM9ajt3aGlsZSgoYz1jLm5leHRTaWJsaW5nKSl7aWYoYy5ub2RlVHlwZT09PTEpe3JldHVybiBmYWxzZTsKfX1yZXR1cm4gdHJ1ZTt9LCJudGgtY2hpbGQiOmIuY3JlYXRlTlRIUHNldWRvKCJmaXJzdENoaWxkIiwibmV4dFNpYmxpbmciLCJwb3NOVEgiKSwibnRoLWxhc3QtY2hpbGQiOmIuY3JlYXRlTlRIUHNldWRvKCJsYXN0Q2hpbGQiLCJwcmV2aW91c1NpYmxpbmciLCJwb3NOVEhMYXN0IiksIm50aC1vZi10eXBlIjpiLmNyZWF0ZU5USFBzZXVkbygiZmlyc3RDaGlsZCIsIm5leHRTaWJsaW5nIiwicG9zTlRIVHlwZSIsdHJ1ZSksIm50aC1sYXN0LW9mLXR5cGUiOmIuY3JlYXRlTlRIUHNldWRvKCJsYXN0Q2hpbGQiLCJwcmV2aW91c1NpYmxpbmciLCJwb3NOVEhUeXBlTGFzdCIsdHJ1ZSksaW5kZXg6ZnVuY3Rpb24oaSxjKXtyZXR1cm4gdGhpc1sicHNldWRvOm50aC1jaGlsZCJdKGksIiIrYysxKTsKfSxldmVuOmZ1bmN0aW9uKGksYyl7cmV0dXJuIHRoaXNbInBzZXVkbzpudGgtY2hpbGQiXShpLCIybiIpO30sb2RkOmZ1bmN0aW9uKGksYyl7cmV0dXJuIHRoaXNbInBzZXVkbzpudGgtY2hpbGQiXShpLCIybisxIik7fSwiZmlyc3Qtb2YtdHlwZSI6ZnVuY3Rpb24oYyl7dmFyIGk9Yy5ub2RlTmFtZTsKd2hpbGUoKGM9Yy5wcmV2aW91c1NpYmxpbmcpKXtpZihjLm5vZGVOYW1lPT09aSl7cmV0dXJuIGZhbHNlO319cmV0dXJuIHRydWU7fSwibGFzdC1vZi10eXBlIjpmdW5jdGlvbihjKXt2YXIgaT1jLm5vZGVOYW1lO3doaWxlKChjPWMubmV4dFNpYmxpbmcpKXtpZihjLm5vZGVOYW1lPT09aSl7cmV0dXJuIGZhbHNlOwp9fXJldHVybiB0cnVlO30sIm9ubHktb2YtdHlwZSI6ZnVuY3Rpb24oail7dmFyIGk9aixrPWoubm9kZU5hbWU7d2hpbGUoKGk9aS5wcmV2aW91c1NpYmxpbmcpKXtpZihpLm5vZGVOYW1lPT09ayl7cmV0dXJuIGZhbHNlO319dmFyIGM9ajt3aGlsZSgoYz1jLm5leHRTaWJsaW5nKSl7aWYoYy5ub2RlTmFtZT09PWspe3JldHVybiBmYWxzZTsKfX1yZXR1cm4gdHJ1ZTt9LGVuYWJsZWQ6ZnVuY3Rpb24oYyl7cmV0dXJuKGMuZGlzYWJsZWQ9PT1mYWxzZSk7fSxkaXNhYmxlZDpmdW5jdGlvbihjKXtyZXR1cm4oYy5kaXNhYmxlZD09PXRydWUpO30sY2hlY2tlZDpmdW5jdGlvbihjKXtyZXR1cm4gYy5jaGVja2VkfHxjLnNlbGVjdGVkOwp9LGZvY3VzOmZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmlzSFRNTERvY3VtZW50JiZ0aGlzLmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ9PT1jJiYoYy5ocmVmfHxjLnR5cGV8fHRoaXMuaGFzQXR0cmlidXRlKGMsInRhYmluZGV4IikpO30scm9vdDpmdW5jdGlvbihjKXtyZXR1cm4oYz09PXRoaXMucm9vdCk7Cn0sc2VsZWN0ZWQ6ZnVuY3Rpb24oYyl7cmV0dXJuIGMuc2VsZWN0ZWQ7fX07Zm9yKHZhciBkIGluIGcpe2JbInBzZXVkbzoiK2RdPWdbZF07fWIuYXR0cmlidXRlR2V0dGVycz17ImNsYXNzIjpmdW5jdGlvbigpe3JldHVybigiY2xhc3NOYW1lIiBpbiB0aGlzKT90aGlzLmNsYXNzTmFtZTp0aGlzLmdldEF0dHJpYnV0ZSgiY2xhc3MiKTsKfSwiZm9yIjpmdW5jdGlvbigpe3JldHVybigiaHRtbEZvciIgaW4gdGhpcyk/dGhpcy5odG1sRm9yOnRoaXMuZ2V0QXR0cmlidXRlKCJmb3IiKTt9LGhyZWY6ZnVuY3Rpb24oKXtyZXR1cm4oImhyZWYiIGluIHRoaXMpP3RoaXMuZ2V0QXR0cmlidXRlKCJocmVmIiwyKTp0aGlzLmdldEF0dHJpYnV0ZSgiaHJlZiIpOwp9LHN0eWxlOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuc3R5bGUpP3RoaXMuc3R5bGUuY3NzVGV4dDp0aGlzLmdldEF0dHJpYnV0ZSgic3R5bGUiKTt9fTtiLmdldEF0dHJpYnV0ZT1mdW5jdGlvbihqLGMpe3ZhciBrPXRoaXMuYXR0cmlidXRlR2V0dGVyc1tjXTtpZihrKXtyZXR1cm4gay5jYWxsKGopOwp9dmFyIGk9ai5nZXRBdHRyaWJ1dGVOb2RlKGMpO3JldHVybiBpP2kubm9kZVZhbHVlOm51bGw7fTtiLm92ZXJyaWRlcz1bXTtiLm92ZXJyaWRlPWZ1bmN0aW9uKGMsaSl7dGhpcy5vdmVycmlkZXMucHVzaCh7cmVnZXhwOmMsbWV0aG9kOml9KTt9O3ZhciBmPS9cWy4qWyokXl09KD86WyInXXsyfSk/XF0vOwpiLm92ZXJyaWRlKC8uLyxmdW5jdGlvbihwLG4sbyl7aWYoIXRoaXMucXVlcnlTZWxlY3RvckFsbHx8dGhpcy5ub2RlVHlwZSE9OXx8IWIuaXNIVE1MRG9jdW1lbnR8fGIuYnJva2VuTWl4ZWRDYXNlUVNBfHwoYi5icm9rZW5DaGVja2VkUVNBJiZwLmluZGV4T2YoIjpjaGVja2VkIik+LTEpfHwoYi5icm9rZW5FbXB0eUF0dHJpYnV0ZVFTQSYmZi50ZXN0KHApKXx8ZS5kaXNhYmxlUVNBKXtyZXR1cm4gZmFsc2U7Cn12YXIgaixtO3RyeXtpZihvKXtyZXR1cm4gdGhpcy5xdWVyeVNlbGVjdG9yKHApfHxudWxsO31lbHNle2o9dGhpcy5xdWVyeVNlbGVjdG9yQWxsKHApO319Y2F0Y2goayl7cmV0dXJuIGZhbHNlO312YXIgbCxjPSEhKG4ubGVuZ3RoKTtpZihiLnN0YXJTZWxlY3RzQ2xvc2VkUVNBKXtmb3IobD0wOwptPWpbbCsrXTspe2lmKG0ubm9kZU5hbWU+IkAiJiYoIWN8fCFiLnVuaXF1ZXNbYi5nZXRVSURIVE1MKG0pXSkpe24ucHVzaChtKTt9fX1lbHNle2ZvcihsPTA7bT1qW2wrK107KXtpZighY3x8IWIudW5pcXVlc1tiLmdldFVJREhUTUwobSldKXtuLnB1c2gobSk7fX19aWYoYyl7Yi5zb3J0KG4pOwp9cmV0dXJuIHRydWU7fSk7Yi5vdmVycmlkZSgvXltcdy1dKyR8XlwqJC8sZnVuY3Rpb24ocCxuLG8pe3ZhciBqPXA7aWYoaj09IioiJiZiLmJyb2tlblN0YXJHRUJUTil7cmV0dXJuIGZhbHNlO312YXIgaz10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKGopO2lmKG8pe3JldHVybiBrWzBdfHxudWxsOwp9dmFyIGwsbSxjPSEhKG4ubGVuZ3RoKTtmb3IobD0wO209a1tsKytdOyl7aWYoIWN8fCFiLnVuaXF1ZXNbYi5nZXRVSUQobSldKXtuLnB1c2gobSk7fX1pZihjKXtiLnNvcnQobik7fXJldHVybiB0cnVlO30pO2Iub3ZlcnJpZGUoL15cLltcdy1dKyQvLGZ1bmN0aW9uKG8scSxtKXtpZighYi5pc0hUTUxEb2N1bWVudHx8KCF0aGlzLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJnRoaXMucXVlcnlTZWxlY3RvckFsbCkpe3JldHVybiBmYWxzZTsKfXZhciBjLGssbCxqPSEhKHEmJnEubGVuZ3RoKSxwPW8uc3Vic3RyaW5nKDEpO2lmKHRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmIWIuYnJva2VuR0VCQ04pe2M9dGhpcy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHApO2lmKG0pe3JldHVybiBjWzBdfHxudWxsOwp9Zm9yKGw9MDtrPWNbbCsrXTspe2lmKCFqfHwhYi51bmlxdWVzW2IuZ2V0VUlESFRNTChrKV0pe3EucHVzaChrKTt9fX1lbHNle3ZhciBuPW5ldyBSZWdFeHAoIihefFxccykiK2UuZXNjYXBlUmVnRXhwKHApKyIoXFxzfCQpIik7Yz10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIik7CmZvcihsPTA7az1jW2wrK107KXtwPWsuY2xhc3NOYW1lO2lmKCFwfHwhbi50ZXN0KHApKXtjb250aW51ZTt9aWYobSl7cmV0dXJuIGs7fWlmKCFqfHwhYi51bmlxdWVzW2IuZ2V0VUlESFRNTChrKV0pe3EucHVzaChrKTt9fX1pZihqKXtiLnNvcnQocSk7fXJldHVybihtKT9udWxsOnRydWU7Cn0pO2Iub3ZlcnJpZGUoL14jW1x3LV0rJC8sZnVuY3Rpb24obCxqLGspe2lmKCFiLmlzSFRNTERvY3VtZW50fHx0aGlzLm5vZGVUeXBlIT05KXtyZXR1cm4gZmFsc2U7fXZhciBtPWwuc3Vic3RyaW5nKDEpLGk9dGhpcy5nZXRFbGVtZW50QnlJZChtKTtpZighaSl7cmV0dXJuIGo7Cn1pZihiLmlkR2V0c05hbWUmJmkuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS5ub2RlVmFsdWUhPW0pe3JldHVybiBmYWxzZTt9aWYoayl7cmV0dXJuIGl8fG51bGw7fXZhciBjPSEhKGoubGVuZ3RoKTtpZighY3x8IWIudW5pcXVlc1tiLmdldFVJREhUTUwoaSldKXtqLnB1c2goaSk7Cn1pZihjKXtiLnNvcnQoaik7fXJldHVybiB0cnVlO30pO2lmKHR5cGVvZiBkb2N1bWVudCE9InVuZGVmaW5lZCIpe2Iuc2V0RG9jdW1lbnQoZG9jdW1lbnQpO312YXIgZT1iLlNsaWNrPSh0aGlzLlNsaWNrfHx7fSk7ZS52ZXJzaW9uPSIwLjlkZXYiO2Uuc2VhcmNoPWZ1bmN0aW9uKGksaixjKXtyZXR1cm4gYi5zZWFyY2goaSxqLGMpOwp9O2UuZmluZD1mdW5jdGlvbihjLGkpe3JldHVybiBiLnNlYXJjaChjLGksbnVsbCx0cnVlKTt9O2UuY29udGFpbnM9ZnVuY3Rpb24oYyxpKXtiLnNldERvY3VtZW50KGMpO3JldHVybiBiLmNvbnRhaW5zKGMsaSk7fTtlLmdldEF0dHJpYnV0ZT1mdW5jdGlvbihpLGMpe3JldHVybiBiLmdldEF0dHJpYnV0ZShpLGMpOwp9O2UubWF0Y2g9ZnVuY3Rpb24oaSxjKXtpZighKGkmJmMpKXtyZXR1cm4gZmFsc2U7fWlmKCFjfHxjPT09aSl7cmV0dXJuIHRydWU7fWlmKHR5cGVvZiBjIT0ic3RyaW5nIil7cmV0dXJuIGZhbHNlO31iLnNldERvY3VtZW50KGkpO3JldHVybiBiLm1hdGNoTm9kZShpLGMpOwp9O2UuZGVmaW5lQXR0cmlidXRlR2V0dGVyPWZ1bmN0aW9uKGMsaSl7Yi5hdHRyaWJ1dGVHZXR0ZXJzW2NdPWk7cmV0dXJuIHRoaXM7fTtlLmxvb2t1cEF0dHJpYnV0ZUdldHRlcj1mdW5jdGlvbihjKXtyZXR1cm4gYi5hdHRyaWJ1dGVHZXR0ZXJzW2NdO307ZS5kZWZpbmVQc2V1ZG89ZnVuY3Rpb24oYyxpKXtiWyJwc2V1ZG86IitjXT1mdW5jdGlvbihrLGope3JldHVybiBpLmNhbGwoayxqKTsKfTtyZXR1cm4gdGhpczt9O2UubG9va3VwUHNldWRvPWZ1bmN0aW9uKGMpe3ZhciBpPWJbInBzZXVkbzoiK2NdO2lmKGkpe3JldHVybiBmdW5jdGlvbihqKXtyZXR1cm4gaS5jYWxsKHRoaXMsaik7fTt9cmV0dXJuIG51bGw7fTtlLm92ZXJyaWRlPWZ1bmN0aW9uKGksYyl7Yi5vdmVycmlkZShpLGMpOwpyZXR1cm4gdGhpczt9O2UuaXNYTUw9Yi5pc1hNTDtlLnVpZE9mPWZ1bmN0aW9uKGMpe3JldHVybiBiLmdldFVJREhUTUwoYyk7fTtpZighdGhpcy5TbGljayl7dGhpcy5TbGljaz1lO319KS5hcHBseSgodHlwZW9mIGV4cG9ydHMhPSJ1bmRlZmluZWQiKT9leHBvcnRzOnRoaXMpOwp2YXIgRWxlbWVudD1mdW5jdGlvbihiLGcpe3ZhciBoPUVsZW1lbnQuQ29uc3RydWN0b3JzW2JdO2lmKGgpe3JldHVybiBoKGcpO31pZih0eXBlb2YgYiE9InN0cmluZyIpe3JldHVybiBkb2N1bWVudC5pZChiKS5zZXQoZyk7fWlmKCFnKXtnPXt9O31pZighYi50ZXN0KC9eW1x3LV0rJC8pKXt2YXIgZT1TbGljay5wYXJzZShiKS5leHByZXNzaW9uc1swXVswXTsKYj0oZS50YWc9PSIqIik/ImRpdiI6ZS50YWc7aWYoZS5pZCYmZy5pZD09bnVsbCl7Zy5pZD1lLmlkO312YXIgZD1lLmF0dHJpYnV0ZXM7aWYoZCl7Zm9yKHZhciBmPTAsYz1kLmxlbmd0aDtmPGM7ZisrKXt2YXIgYT1kW2ZdO2lmKGEudmFsdWUhPW51bGwmJmEub3BlcmF0b3I9PSI9IiYmZ1thLmtleV09PW51bGwpe2dbYS5rZXldPWEudmFsdWU7Cn19fWlmKGUuY2xhc3NMaXN0JiZnWyJjbGFzcyJdPT1udWxsKXtnWyJjbGFzcyJdPWUuY2xhc3NMaXN0LmpvaW4oIiAiKTt9fXJldHVybiBkb2N1bWVudC5uZXdFbGVtZW50KGIsZyk7fTtpZihCcm93c2VyLkVsZW1lbnQpe0VsZW1lbnQucHJvdG90eXBlPUJyb3dzZXIuRWxlbWVudC5wcm90b3R5cGU7Cn1uZXcgVHlwZSgiRWxlbWVudCIsRWxlbWVudCkubWlycm9yKGZ1bmN0aW9uKGEpe2lmKEFycmF5LnByb3RvdHlwZVthXSl7cmV0dXJuO312YXIgYj17fTtiW2FdPWZ1bmN0aW9uKCl7dmFyIGg9W10sZT1hcmd1bWVudHMsaj10cnVlO2Zvcih2YXIgZz0wLGQ9dGhpcy5sZW5ndGg7Cmc8ZDtnKyspe3ZhciBmPXRoaXNbZ10sYz1oW2ddPWZbYV0uYXBwbHkoZixlKTtqPShqJiZ0eXBlT2YoYyk9PSJlbGVtZW50Iik7fXJldHVybihqKT9uZXcgRWxlbWVudHMoaCk6aDt9O0VsZW1lbnRzLmltcGxlbWVudChiKTt9KTtpZighQnJvd3Nlci5FbGVtZW50KXtFbGVtZW50LnBhcmVudD1PYmplY3Q7CkVsZW1lbnQuUHJvdG90eXBlPXsiJGZhbWlseSI6RnVuY3Rpb24uZnJvbSgiZWxlbWVudCIpLmhpZGUoKX07RWxlbWVudC5taXJyb3IoZnVuY3Rpb24oYSxiKXtFbGVtZW50LlByb3RvdHlwZVthXT1iO30pO31FbGVtZW50LkNvbnN0cnVjdG9ycz17fTtFbGVtZW50LkNvbnN0cnVjdG9ycz1uZXcgSGFzaDsKdmFyIElGcmFtZT1uZXcgVHlwZSgiSUZyYW1lIixmdW5jdGlvbigpe3ZhciBlPUFycmF5LmxpbmsoYXJndW1lbnRzLHtwcm9wZXJ0aWVzOlR5cGUuaXNPYmplY3QsaWZyYW1lOmZ1bmN0aW9uKGYpe3JldHVybihmIT1udWxsKTt9fSk7dmFyIGM9ZS5wcm9wZXJ0aWVzfHx7fSxiOwppZihlLmlmcmFtZSl7Yj1kb2N1bWVudC5pZChlLmlmcmFtZSk7fXZhciBkPWMub25sb2FkfHxmdW5jdGlvbigpe307ZGVsZXRlIGMub25sb2FkO2MuaWQ9Yy5uYW1lPVtjLmlkLGMubmFtZSxiPyhiLmlkfHxiLm5hbWUpOiJJRnJhbWVfIitTdHJpbmcudW5pcXVlSUQoKV0ucGljaygpOwpiPW5ldyBFbGVtZW50KGJ8fCJpZnJhbWUiLGMpO3ZhciBhPWZ1bmN0aW9uKCl7ZC5jYWxsKGIuY29udGVudFdpbmRvdyk7fTtpZih3aW5kb3cuZnJhbWVzW2MuaWRdKXthKCk7fWVsc2V7Yi5hZGRMaXN0ZW5lcigibG9hZCIsYSk7fXJldHVybiBiO30pO3ZhciBFbGVtZW50cz10aGlzLkVsZW1lbnRzPWZ1bmN0aW9uKGEpe2lmKGEmJmEubGVuZ3RoKXt2YXIgZT17fSxkOwpmb3IodmFyIGM9MDtkPWFbYysrXTspe3ZhciBiPVNsaWNrLnVpZE9mKGQpO2lmKCFlW2JdKXtlW2JdPXRydWU7dGhpcy5wdXNoKGQpO319fX07RWxlbWVudHMucHJvdG90eXBlPXtsZW5ndGg6MH07RWxlbWVudHMucGFyZW50PUFycmF5O25ldyBUeXBlKCJFbGVtZW50cyIsRWxlbWVudHMpLmltcGxlbWVudCh7ZmlsdGVyOmZ1bmN0aW9uKGEsYil7aWYoIWEpe3JldHVybiB0aGlzOwp9cmV0dXJuIG5ldyBFbGVtZW50cyhBcnJheS5maWx0ZXIodGhpcywodHlwZU9mKGEpPT0ic3RyaW5nIik/ZnVuY3Rpb24oYyl7cmV0dXJuIGMubWF0Y2goYSk7fTphLGIpKTt9LnByb3RlY3QoKSxwdXNoOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5sZW5ndGg7Zm9yKHZhciBiPTAsYT1hcmd1bWVudHMubGVuZ3RoOwpiPGE7YisrKXt2YXIgYz1kb2N1bWVudC5pZChhcmd1bWVudHNbYl0pO2lmKGMpe3RoaXNbZCsrXT1jO319cmV0dXJuKHRoaXMubGVuZ3RoPWQpO30ucHJvdGVjdCgpLGNvbmNhdDpmdW5jdGlvbigpe3ZhciBiPW5ldyBFbGVtZW50cyh0aGlzKTtmb3IodmFyIGM9MCxhPWFyZ3VtZW50cy5sZW5ndGg7CmM8YTtjKyspe3ZhciBkPWFyZ3VtZW50c1tjXTtpZihUeXBlLmlzRW51bWVyYWJsZShkKSl7Yi5hcHBlbmQoZCk7fWVsc2V7Yi5wdXNoKGQpO319cmV0dXJuIGI7fS5wcm90ZWN0KCksYXBwZW5kOmZ1bmN0aW9uKGMpe2Zvcih2YXIgYj0wLGE9Yy5sZW5ndGg7YjxhO2IrKyl7dGhpcy5wdXNoKGNbYl0pOwp9cmV0dXJuIHRoaXM7fS5wcm90ZWN0KCksZW1wdHk6ZnVuY3Rpb24oKXt3aGlsZSh0aGlzLmxlbmd0aCl7ZGVsZXRlIHRoaXNbLS10aGlzLmxlbmd0aF07fXJldHVybiB0aGlzO30ucHJvdGVjdCgpfSk7KGZ1bmN0aW9uKCl7dmFyIGc9QXJyYXkucHJvdG90eXBlLnNwbGljZSxiPXsiMCI6MCwiMSI6MSxsZW5ndGg6Mn07CmcuY2FsbChiLDEsMSk7aWYoYlsxXT09MSl7RWxlbWVudHMuaW1wbGVtZW50KCJzcGxpY2UiLGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5sZW5ndGg7Zy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7d2hpbGUoZT49dGhpcy5sZW5ndGgpe2RlbGV0ZSB0aGlzW2UtLV07fXJldHVybiB0aGlzOwp9LnByb3RlY3QoKSk7fUVsZW1lbnRzLmltcGxlbWVudChBcnJheS5wcm90b3R5cGUpO0FycmF5Lm1pcnJvcihFbGVtZW50cyk7dmFyIGY7dHJ5e3ZhciBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIjxpbnB1dCBuYW1lPXg+Iik7Zj0oYS5uYW1lPT0ieCIpO31jYXRjaChjKXt9dmFyIGQ9ZnVuY3Rpb24oZSl7cmV0dXJuKCIiK2UpLnJlcGxhY2UoLyYvZywiJmFtcDsiKS5yZXBsYWNlKC8iL2csIiZxdW90OyIpOwp9O0RvY3VtZW50LmltcGxlbWVudCh7bmV3RWxlbWVudDpmdW5jdGlvbihlLGgpe2lmKGgmJmguY2hlY2tlZCE9bnVsbCl7aC5kZWZhdWx0Q2hlY2tlZD1oLmNoZWNrZWQ7fWlmKGYmJmgpe2U9IjwiK2U7aWYoaC5uYW1lKXtlKz0nIG5hbWU9IicrZChoLm5hbWUpKyciJzsKfWlmKGgudHlwZSl7ZSs9JyB0eXBlPSInK2QoaC50eXBlKSsnIic7fWUrPSI+IjtkZWxldGUgaC5uYW1lO2RlbGV0ZSBoLnR5cGU7fXJldHVybiB0aGlzLmlkKHRoaXMuY3JlYXRlRWxlbWVudChlKSkuc2V0KGgpO319KTt9KSgpO0RvY3VtZW50LmltcGxlbWVudCh7bmV3VGV4dE5vZGU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlVGV4dE5vZGUoYSk7Cn0sZ2V0RG9jdW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpczt9LGdldFdpbmRvdzpmdW5jdGlvbigpe3JldHVybiB0aGlzLndpbmRvdzt9LGlkOihmdW5jdGlvbigpe3ZhciBhPXtzdHJpbmc6ZnVuY3Rpb24oZCxjLGIpe2Q9U2xpY2suZmluZChiLCIjIitkLnJlcGxhY2UoLyhcVykvZywiXFwkMSIpKTsKcmV0dXJuKGQpP2EuZWxlbWVudChkLGMpOm51bGw7fSxlbGVtZW50OmZ1bmN0aW9uKGIsYyl7JHVpZChiKTtpZighYyYmIWIuJGZhbWlseSYmISgvXm9iamVjdHxlbWJlZCQvaSkudGVzdChiLnRhZ05hbWUpKXtPYmplY3QuYXBwZW5kKGIsRWxlbWVudC5Qcm90b3R5cGUpOwp9cmV0dXJuIGI7fSxvYmplY3Q6ZnVuY3Rpb24oYyxkLGIpe2lmKGMudG9FbGVtZW50KXtyZXR1cm4gYS5lbGVtZW50KGMudG9FbGVtZW50KGIpLGQpO31yZXR1cm4gbnVsbDt9fTthLnRleHRub2RlPWEud2hpdGVzcGFjZT1hLndpbmRvdz1hLmRvY3VtZW50PWZ1bmN0aW9uKGIpe3JldHVybiBiOwp9O3JldHVybiBmdW5jdGlvbihjLGUsZCl7aWYoYyYmYy4kZmFtaWx5JiZjLnVpZCl7cmV0dXJuIGM7fXZhciBiPXR5cGVPZihjKTtyZXR1cm4oYVtiXSk/YVtiXShjLGUsZHx8ZG9jdW1lbnQpOm51bGw7fTt9KSgpfSk7aWYod2luZG93LiQ9PW51bGwpe1dpbmRvdy5pbXBsZW1lbnQoIiQiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGRvY3VtZW50LmlkKGEsYix0aGlzLmRvY3VtZW50KTsKfSk7fVdpbmRvdy5pbXBsZW1lbnQoe2dldERvY3VtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9jdW1lbnQ7fSxnZXRXaW5kb3c6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpczt9fSk7W0RvY3VtZW50LEVsZW1lbnRdLmludm9rZSgiaW1wbGVtZW50Iix7Z2V0RWxlbWVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIFNsaWNrLnNlYXJjaCh0aGlzLGEsbmV3IEVsZW1lbnRzKTsKfSxnZXRFbGVtZW50OmZ1bmN0aW9uKGEpe3JldHVybiBkb2N1bWVudC5pZChTbGljay5maW5kKHRoaXMsYSkpO319KTsoZnVuY3Rpb24oYixkLGEpe3RoaXMuU2VsZWN0b3JzPXt9O3ZhciBlPXRoaXMuU2VsZWN0b3JzLlBzZXVkbz1uZXcgSGFzaCgpO3ZhciBjPWZ1bmN0aW9uKCl7Zm9yKHZhciBmIGluIGUpe2lmKGUuaGFzT3duUHJvcGVydHkoZikpe1NsaWNrLmRlZmluZVBzZXVkbyhmLGVbZl0pOwpkZWxldGUgZVtmXTt9fX07U2xpY2suc2VhcmNoPWZ1bmN0aW9uKGcsaCxmKXtjKCk7cmV0dXJuIGIuY2FsbCh0aGlzLGcsaCxmKTt9O1NsaWNrLmZpbmQ9ZnVuY3Rpb24oZixnKXtjKCk7cmV0dXJuIGQuY2FsbCh0aGlzLGYsZyk7fTtTbGljay5tYXRjaD1mdW5jdGlvbihnLGYpe2MoKTsKcmV0dXJuIGEuY2FsbCh0aGlzLGcsZik7fTt9KShTbGljay5zZWFyY2gsU2xpY2suZmluZCxTbGljay5tYXRjaCk7aWYod2luZG93LiQkPT1udWxsKXtXaW5kb3cuaW1wbGVtZW50KCIkJCIsZnVuY3Rpb24oYSl7dmFyIGY9bmV3IEVsZW1lbnRzO2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEmJnR5cGVvZiBhPT0ic3RyaW5nIil7cmV0dXJuIFNsaWNrLnNlYXJjaCh0aGlzLmRvY3VtZW50LGEsZik7Cn12YXIgYz1BcnJheS5mbGF0dGVuKGFyZ3VtZW50cyk7Zm9yKHZhciBkPTAsYj1jLmxlbmd0aDtkPGI7ZCsrKXt2YXIgZT1jW2RdO3N3aXRjaCh0eXBlT2YoZSkpe2Nhc2UiZWxlbWVudCI6Zi5wdXNoKGUpO2JyZWFrO2Nhc2Uic3RyaW5nIjpTbGljay5zZWFyY2godGhpcy5kb2N1bWVudCxlLGYpOwp9fXJldHVybiBmO30pO31pZih3aW5kb3cuJCQ9PW51bGwpe1dpbmRvdy5pbXBsZW1lbnQoIiQkIixmdW5jdGlvbihhKXtpZihhcmd1bWVudHMubGVuZ3RoPT0xKXtpZih0eXBlb2YgYT09InN0cmluZyIpe3JldHVybiBTbGljay5zZWFyY2godGhpcy5kb2N1bWVudCxhLG5ldyBFbGVtZW50cyk7Cn1lbHNle2lmKFR5cGUuaXNFbnVtZXJhYmxlKGEpKXtyZXR1cm4gbmV3IEVsZW1lbnRzKGEpO319fXJldHVybiBuZXcgRWxlbWVudHMoYXJndW1lbnRzKTt9KTt9KGZ1bmN0aW9uKCl7dmFyIGo9e30saD17fTt2YXIgbD17aW5wdXQ6ImNoZWNrZWQiLG9wdGlvbjoic2VsZWN0ZWQiLHRleHRhcmVhOiJ2YWx1ZSJ9Owp2YXIgZD1mdW5jdGlvbihvKXtyZXR1cm4oaFtvXXx8KGhbb109e30pKTt9O3ZhciBpPWZ1bmN0aW9uKHApe2lmKHAucmVtb3ZlRXZlbnRzKXtwLnJlbW92ZUV2ZW50cygpO31pZihwLmNsZWFyQXR0cmlidXRlcyl7cC5jbGVhckF0dHJpYnV0ZXMoKTt9dmFyIG89cC51aWQ7CmlmKG8hPW51bGwpe2RlbGV0ZSBqW29dO2RlbGV0ZSBoW29dO31yZXR1cm4gcDt9O3ZhciBuPVsiZGVmYXVsdFZhbHVlIiwiYWNjZXNzS2V5IiwiY2VsbFBhZGRpbmciLCJjZWxsU3BhY2luZyIsImNvbFNwYW4iLCJmcmFtZUJvcmRlciIsIm1heExlbmd0aCIsInJlYWRPbmx5Iiwicm93U3BhbiIsInRhYkluZGV4IiwidXNlTWFwIl07CnZhciBjPVsiY29tcGFjdCIsIm5vd3JhcCIsImlzbWFwIiwiZGVjbGFyZSIsIm5vc2hhZGUiLCJjaGVja2VkIiwiZGlzYWJsZWQiLCJyZWFkT25seSIsIm11bHRpcGxlIiwic2VsZWN0ZWQiLCJub3Jlc2l6ZSIsImRlZmVyIl07dmFyIGY9e2h0bWw6ImlubmVySFRNTCIsImNsYXNzIjoiY2xhc3NOYW1lIiwiZm9yIjoiaHRtbEZvciIsdGV4dDooZnVuY3Rpb24oKXt2YXIgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKcmV0dXJuKG8uaW5uZXJUZXh0PT1udWxsKT8idGV4dENvbnRlbnQiOiJpbm5lclRleHQiO30pKCl9O3ZhciBtPVsidHlwZSJdO3ZhciBnPVsidmFsdWUiLCJkZWZhdWx0VmFsdWUiXTt2YXIgaz0vXig/OmhyZWZ8c3JjfHVzZW1hcCkkL2k7Yz1jLmFzc29jaWF0ZShjKTsKbj1uLmFzc29jaWF0ZShuLm1hcChTdHJpbmcudG9Mb3dlckNhc2UpKTttPW0uYXNzb2NpYXRlKG0pO09iamVjdC5hcHBlbmQoZixnLmFzc29jaWF0ZShnKSk7dmFyIGI9e2JlZm9yZTpmdW5jdGlvbihwLG8pe3ZhciBxPW8ucGFyZW50Tm9kZTtpZihxKXtxLmluc2VydEJlZm9yZShwLG8pOwp9fSxhZnRlcjpmdW5jdGlvbihwLG8pe3ZhciBxPW8ucGFyZW50Tm9kZTtpZihxKXtxLmluc2VydEJlZm9yZShwLG8ubmV4dFNpYmxpbmcpO319LGJvdHRvbTpmdW5jdGlvbihwLG8pe28uYXBwZW5kQ2hpbGQocCk7fSx0b3A6ZnVuY3Rpb24ocCxvKXtvLmluc2VydEJlZm9yZShwLG8uZmlyc3RDaGlsZCk7Cn19O2IuaW5zaWRlPWIuYm90dG9tO09iamVjdC5lYWNoKGIsZnVuY3Rpb24ocCxxKXtxPXEuY2FwaXRhbGl6ZSgpO3ZhciBvPXt9O29bImluamVjdCIrcV09ZnVuY3Rpb24ocil7cCh0aGlzLGRvY3VtZW50LmlkKHIsdHJ1ZSkpO3JldHVybiB0aGlzO307b1siZ3JhYiIrcV09ZnVuY3Rpb24ocil7cChkb2N1bWVudC5pZChyLHRydWUpLHRoaXMpOwpyZXR1cm4gdGhpczt9O0VsZW1lbnQuaW1wbGVtZW50KG8pO30pO3ZhciBhPWZ1bmN0aW9uKHIscSl7aWYoIXIpe3JldHVybiBxO31yPVNsaWNrLnBhcnNlKHIpO3ZhciBwPXIuZXhwcmVzc2lvbnM7Zm9yKHZhciBvPXAubGVuZ3RoO28tLTspe3Bbb11bMF0uY29tYmluYXRvcj1xOwp9cmV0dXJuIHI7fTtFbGVtZW50LmltcGxlbWVudCh7c2V0OmZ1bmN0aW9uKHEscCl7dmFyIG89RWxlbWVudC5Qcm9wZXJ0aWVzW3FdOyhvJiZvLnNldCk/by5zZXQuY2FsbCh0aGlzLHApOnRoaXMuc2V0UHJvcGVydHkocSxwKTt9Lm92ZXJsb2FkU2V0dGVyKCksZ2V0OmZ1bmN0aW9uKHApe3ZhciBvPUVsZW1lbnQuUHJvcGVydGllc1twXTsKcmV0dXJuKG8mJm8uZ2V0KT9vLmdldC5hcHBseSh0aGlzKTp0aGlzLmdldFByb3BlcnR5KHApO30ub3ZlcmxvYWRHZXR0ZXIoKSxlcmFzZTpmdW5jdGlvbihwKXt2YXIgbz1FbGVtZW50LlByb3BlcnRpZXNbcF07KG8mJm8uZXJhc2UpP28uZXJhc2UuYXBwbHkodGhpcyk6dGhpcy5yZW1vdmVQcm9wZXJ0eShwKTsKcmV0dXJuIHRoaXM7fSxzZXRQcm9wZXJ0eTpmdW5jdGlvbihwLHEpe3A9bltwXXx8cDtpZihxPT1udWxsKXtyZXR1cm4gdGhpcy5yZW1vdmVQcm9wZXJ0eShwKTt9dmFyIG89ZltwXTsobyk/dGhpc1tvXT1xOihjW3BdKT90aGlzW3BdPSEhcTp0aGlzLnNldEF0dHJpYnV0ZShwLCIiK3EpOwpyZXR1cm4gdGhpczt9LHNldFByb3BlcnRpZXM6ZnVuY3Rpb24obyl7Zm9yKHZhciBwIGluIG8pe3RoaXMuc2V0UHJvcGVydHkocCxvW3BdKTt9cmV0dXJuIHRoaXM7fSxnZXRQcm9wZXJ0eTpmdW5jdGlvbihwKXtwPW5bcF18fHA7dmFyIG89ZltwXXx8bVtwXTtyZXR1cm4obyk/dGhpc1tvXTooY1twXSk/ISF0aGlzW3BdOihrLnRlc3QocCk/dGhpcy5nZXRBdHRyaWJ1dGUocCwyKToobz10aGlzLmdldEF0dHJpYnV0ZU5vZGUocCkpP28ubm9kZVZhbHVlOm51bGwpfHxudWxsOwp9LGdldFByb3BlcnRpZXM6ZnVuY3Rpb24oKXt2YXIgbz1BcnJheS5mcm9tKGFyZ3VtZW50cyk7cmV0dXJuIG8ubWFwKHRoaXMuZ2V0UHJvcGVydHksdGhpcykuYXNzb2NpYXRlKG8pO30scmVtb3ZlUHJvcGVydHk6ZnVuY3Rpb24ocCl7cD1uW3BdfHxwO3ZhciBvPWZbcF07CihvKT90aGlzW29dPSIiOihjW3BdKT90aGlzW3BdPWZhbHNlOnRoaXMucmVtb3ZlQXR0cmlidXRlKHApO3JldHVybiB0aGlzO30scmVtb3ZlUHJvcGVydGllczpmdW5jdGlvbigpe0FycmF5LmVhY2goYXJndW1lbnRzLHRoaXMucmVtb3ZlUHJvcGVydHksdGhpcyk7cmV0dXJuIHRoaXM7Cn0saGFzQ2xhc3M6ZnVuY3Rpb24obyl7cmV0dXJuIHRoaXMuY2xhc3NOYW1lLmNsZWFuKCkuY29udGFpbnMobywiICIpO30sYWRkQ2xhc3M6ZnVuY3Rpb24obyl7aWYoIXRoaXMuaGFzQ2xhc3Mobykpe3RoaXMuY2xhc3NOYW1lPSh0aGlzLmNsYXNzTmFtZSsiICIrbykuY2xlYW4oKTsKfXJldHVybiB0aGlzO30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24obyl7dGhpcy5jbGFzc05hbWU9dGhpcy5jbGFzc05hbWUucmVwbGFjZShuZXcgUmVnRXhwKCIoXnxcXHMpIitvKyIoPzpcXHN8JCkiKSwiJDEiKTtyZXR1cm4gdGhpczt9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKG8scCl7aWYocD09bnVsbCl7cD0hdGhpcy5oYXNDbGFzcyhvKTsKfXJldHVybihwKT90aGlzLmFkZENsYXNzKG8pOnRoaXMucmVtb3ZlQ2xhc3Mobyk7fSxhZG9wdDpmdW5jdGlvbigpe3ZhciByPXRoaXMsbyx0PUFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKSxzPXQubGVuZ3RoO2lmKHM+MSl7cj1vPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsKfWZvcih2YXIgcT0wO3E8cztxKyspe3ZhciBwPWRvY3VtZW50LmlkKHRbcV0sdHJ1ZSk7aWYocCl7ci5hcHBlbmRDaGlsZChwKTt9fWlmKG8pe3RoaXMuYXBwZW5kQ2hpbGQobyk7fXJldHVybiB0aGlzO30sYXBwZW5kVGV4dDpmdW5jdGlvbihwLG8pe3JldHVybiB0aGlzLmdyYWIodGhpcy5nZXREb2N1bWVudCgpLm5ld1RleHROb2RlKHApLG8pOwp9LGdyYWI6ZnVuY3Rpb24ocCxvKXtiW298fCJib3R0b20iXShkb2N1bWVudC5pZChwLHRydWUpLHRoaXMpO3JldHVybiB0aGlzO30saW5qZWN0OmZ1bmN0aW9uKHAsbyl7YltvfHwiYm90dG9tIl0odGhpcyxkb2N1bWVudC5pZChwLHRydWUpKTtyZXR1cm4gdGhpczt9LHJlcGxhY2VzOmZ1bmN0aW9uKG8pe289ZG9jdW1lbnQuaWQobyx0cnVlKTsKby5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCh0aGlzLG8pO3JldHVybiB0aGlzO30sd3JhcHM6ZnVuY3Rpb24ocCxvKXtwPWRvY3VtZW50LmlkKHAsdHJ1ZSk7cmV0dXJuIHRoaXMucmVwbGFjZXMocCkuZ3JhYihwLG8pO30sZ2V0UHJldmlvdXM6ZnVuY3Rpb24obyl7cmV0dXJuIGRvY3VtZW50LmlkKFNsaWNrLmZpbmQodGhpcyxhKG8sIiF+IikpKTsKfSxnZXRBbGxQcmV2aW91czpmdW5jdGlvbihvKXtyZXR1cm4gU2xpY2suc2VhcmNoKHRoaXMsYShvLCIhfiIpLG5ldyBFbGVtZW50cyk7fSxnZXROZXh0OmZ1bmN0aW9uKG8pe3JldHVybiBkb2N1bWVudC5pZChTbGljay5maW5kKHRoaXMsYShvLCJ+IikpKTt9LGdldEFsbE5leHQ6ZnVuY3Rpb24obyl7cmV0dXJuIFNsaWNrLnNlYXJjaCh0aGlzLGEobywifiIpLG5ldyBFbGVtZW50cyk7Cn0sZ2V0Rmlyc3Q6ZnVuY3Rpb24obyl7cmV0dXJuIGRvY3VtZW50LmlkKFNsaWNrLnNlYXJjaCh0aGlzLGEobywiPiIpKVswXSk7fSxnZXRMYXN0OmZ1bmN0aW9uKG8pe3JldHVybiBkb2N1bWVudC5pZChTbGljay5zZWFyY2godGhpcyxhKG8sIj4iKSkuZ2V0TGFzdCgpKTsKfSxnZXRQYXJlbnQ6ZnVuY3Rpb24obyl7cmV0dXJuIGRvY3VtZW50LmlkKFNsaWNrLmZpbmQodGhpcyxhKG8sIiEiKSkpO30sZ2V0UGFyZW50czpmdW5jdGlvbihvKXtyZXR1cm4gU2xpY2suc2VhcmNoKHRoaXMsYShvLCIhIiksbmV3IEVsZW1lbnRzKTt9LGdldFNpYmxpbmdzOmZ1bmN0aW9uKG8pe3JldHVybiBTbGljay5zZWFyY2godGhpcyxhKG8sIn5+IiksbmV3IEVsZW1lbnRzKTsKfSxnZXRDaGlsZHJlbjpmdW5jdGlvbihvKXtyZXR1cm4gU2xpY2suc2VhcmNoKHRoaXMsYShvLCI+IiksbmV3IEVsZW1lbnRzKTt9LGdldFdpbmRvdzpmdW5jdGlvbigpe3JldHVybiB0aGlzLm93bmVyRG9jdW1lbnQud2luZG93O30sZ2V0RG9jdW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vd25lckRvY3VtZW50Owp9LGdldEVsZW1lbnRCeUlkOmZ1bmN0aW9uKG8pe3JldHVybiBkb2N1bWVudC5pZChTbGljay5maW5kKHRoaXMsIiMiKygiIitvKS5yZXBsYWNlKC8oXFcpL2csIlxcJDEiKSkpO30sZ2V0U2VsZWN0ZWQ6ZnVuY3Rpb24oKXt0aGlzLnNlbGVjdGVkSW5kZXg7cmV0dXJuIG5ldyBFbGVtZW50cyhBcnJheS5mcm9tKHRoaXMub3B0aW9ucykuZmlsdGVyKGZ1bmN0aW9uKG8pe3JldHVybiBvLnNlbGVjdGVkOwp9KSk7fSx0b1F1ZXJ5U3RyaW5nOmZ1bmN0aW9uKCl7dmFyIG89W107dGhpcy5nZXRFbGVtZW50cygiaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEiKS5lYWNoKGZ1bmN0aW9uKHEpe3ZhciBwPXEudHlwZTtpZighcS5uYW1lfHxxLmRpc2FibGVkfHxwPT0ic3VibWl0Inx8cD09InJlc2V0Inx8cD09ImZpbGUifHxwPT0iaW1hZ2UiKXtyZXR1cm47Cn12YXIgcj0ocS5nZXQoInRhZyIpPT0ic2VsZWN0Iik/cS5nZXRTZWxlY3RlZCgpLm1hcChmdW5jdGlvbihzKXtyZXR1cm4gZG9jdW1lbnQuaWQocykuZ2V0KCJ2YWx1ZSIpO30pOigocD09InJhZGlvInx8cD09ImNoZWNrYm94IikmJiFxLmNoZWNrZWQpP251bGw6cS5nZXQoInZhbHVlIik7CkFycmF5LmZyb20ocikuZWFjaChmdW5jdGlvbihzKXtpZih0eXBlb2YgcyE9InVuZGVmaW5lZCIpe28ucHVzaChlbmNvZGVVUklDb21wb25lbnQocS5uYW1lKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KHMpKTt9fSk7fSk7cmV0dXJuIG8uam9pbigiJiIpO30sY2xvbmU6ZnVuY3Rpb24ocixwKXtyPXIhPT1mYWxzZTsKdmFyIHc9dGhpcy5jbG9uZU5vZGUocik7dmFyIHY9ZnVuY3Rpb24oQyxCKXtpZighcCl7Qy5yZW1vdmVBdHRyaWJ1dGUoImlkIik7fWlmKEJyb3dzZXIuaWUpe0MuY2xlYXJBdHRyaWJ1dGVzKCk7Qy5tZXJnZUF0dHJpYnV0ZXMoQik7Qy5yZW1vdmVBdHRyaWJ1dGUoInVpZCIpOwppZihDLm9wdGlvbnMpe3ZhciBEPUMub3B0aW9ucyx6PUIub3B0aW9ucztmb3IodmFyIEE9RC5sZW5ndGg7QS0tOyl7RFtBXS5zZWxlY3RlZD16W0FdLnNlbGVjdGVkO319fXZhciBFPWxbQi50YWdOYW1lLnRvTG93ZXJDYXNlKCldO2lmKEUmJkJbRV0pe0NbRV09QltFXTsKfX07dmFyIHM7aWYocil7dmFyIG89dy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLHE9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpO2ZvcihzPW8ubGVuZ3RoO3MtLTspe3Yob1tzXSxxW3NdKTt9fXYodyx0aGlzKTtpZihCcm93c2VyLmllKXt2YXIgdT10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJvYmplY3QiKSx0PXcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm9iamVjdCIpLHk9dS5sZW5ndGgseD10Lmxlbmd0aDsKZm9yKHM9MDtzPHkmJnM8eDtzKyspe3Rbc10ub3V0ZXJIVE1MPXVbc10ub3V0ZXJIVE1MO319cmV0dXJuIGRvY3VtZW50LmlkKHcpO30sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBvPWkodGhpcykuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKTtBcnJheS5lYWNoKG8saSk7CkVsZW1lbnQuZGlzcG9zZSh0aGlzKTtyZXR1cm4gbnVsbDt9LGVtcHR5OmZ1bmN0aW9uKCl7QXJyYXkuZnJvbSh0aGlzLmNoaWxkTm9kZXMpLmVhY2goRWxlbWVudC5kaXNwb3NlKTtyZXR1cm4gdGhpczt9LGRpc3Bvc2U6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5wYXJlbnROb2RlKT90aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcyk6dGhpczsKfSxtYXRjaDpmdW5jdGlvbihvKXtyZXR1cm4gIW98fFNsaWNrLm1hdGNoKHRoaXMsbyk7fX0pO3ZhciBlPXtjb250YWluczpmdW5jdGlvbihvKXtyZXR1cm4gU2xpY2suY29udGFpbnModGhpcyxvKTt9fTtpZighZG9jdW1lbnQuY29udGFpbnMpe0RvY3VtZW50LmltcGxlbWVudChlKTsKfWlmKCFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKS5jb250YWlucyl7RWxlbWVudC5pbXBsZW1lbnQoZSk7fUVsZW1lbnQuaW1wbGVtZW50KCJoYXNDaGlsZCIsZnVuY3Rpb24obyl7cmV0dXJuIHRoaXMhPT1vJiZ0aGlzLmNvbnRhaW5zKG8pO30pO1tFbGVtZW50LFdpbmRvdyxEb2N1bWVudF0uaW52b2tlKCJpbXBsZW1lbnQiLHthZGRMaXN0ZW5lcjpmdW5jdGlvbihyLHEpe2lmKHI9PSJ1bmxvYWQiKXt2YXIgbz1xLHA9dGhpczsKcT1mdW5jdGlvbigpe3AucmVtb3ZlTGlzdGVuZXIoInVubG9hZCIscSk7bygpO307fWVsc2V7alt0aGlzLnVpZF09dGhpczt9aWYodGhpcy5hZGRFdmVudExpc3RlbmVyKXt0aGlzLmFkZEV2ZW50TGlzdGVuZXIocixxLGZhbHNlKTt9ZWxzZXt0aGlzLmF0dGFjaEV2ZW50KCJvbiIrcixxKTsKfXJldHVybiB0aGlzO30scmVtb3ZlTGlzdGVuZXI6ZnVuY3Rpb24ocCxvKXtpZih0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIpe3RoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihwLG8sZmFsc2UpO31lbHNle3RoaXMuZGV0YWNoRXZlbnQoIm9uIitwLG8pO31yZXR1cm4gdGhpczsKfSxyZXRyaWV2ZTpmdW5jdGlvbihwLG8pe3ZhciByPWQodGhpcy51aWQpLHE9cltwXTtpZihvIT1udWxsJiZxPT1udWxsKXtxPXJbcF09bzt9cmV0dXJuIHEhPW51bGw/cTpudWxsO30sc3RvcmU6ZnVuY3Rpb24ocCxvKXt2YXIgcT1kKHRoaXMudWlkKTtxW3BdPW87cmV0dXJuIHRoaXM7Cn0sZWxpbWluYXRlOmZ1bmN0aW9uKG8pe3ZhciBwPWQodGhpcy51aWQpO2RlbGV0ZSBwW29dO3JldHVybiB0aGlzO319KTtpZih3aW5kb3cuYXR0YWNoRXZlbnQmJiF3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcil7d2luZG93LmFkZExpc3RlbmVyKCJ1bmxvYWQiLGZ1bmN0aW9uKCl7T2JqZWN0LmVhY2goaixpKTsKaWYod2luZG93LkNvbGxlY3RHYXJiYWdlKXtDb2xsZWN0R2FyYmFnZSgpO319KTt9fSkoKTtFbGVtZW50LlByb3BlcnRpZXM9e307RWxlbWVudC5Qcm9wZXJ0aWVzPW5ldyBIYXNoO0VsZW1lbnQuUHJvcGVydGllcy5zdHlsZT17c2V0OmZ1bmN0aW9uKGEpe3RoaXMuc3R5bGUuY3NzVGV4dD1hOwp9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0eWxlLmNzc1RleHQ7fSxlcmFzZTpmdW5jdGlvbigpe3RoaXMuc3R5bGUuY3NzVGV4dD0iIjt9fTtFbGVtZW50LlByb3BlcnRpZXMudGFnPXtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50YWdOYW1lLnRvTG93ZXJDYXNlKCk7Cn19OyhmdW5jdGlvbihhKXtpZihhIT1udWxsKXtFbGVtZW50LlByb3BlcnRpZXMubWF4bGVuZ3RoPUVsZW1lbnQuUHJvcGVydGllcy5tYXhMZW5ndGg9e2dldDpmdW5jdGlvbigpe3ZhciBiPXRoaXMuZ2V0QXR0cmlidXRlKCJtYXhMZW5ndGgiKTtyZXR1cm4gYj09YT9udWxsOmI7Cn19O319KShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLmdldEF0dHJpYnV0ZSgibWF4TGVuZ3RoIikpO0VsZW1lbnQuUHJvcGVydGllcy5odG1sPShmdW5jdGlvbigpe3ZhciBjPUZ1bmN0aW9uLmF0dGVtcHQoZnVuY3Rpb24oKXt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0YWJsZSIpOwplLmlubmVySFRNTD0iPHRyPjx0ZD48L3RkPjwvdHI+Ijt9KTt2YXIgZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTt2YXIgYT17dGFibGU6WzEsIjx0YWJsZT4iLCI8L3RhYmxlPiJdLHNlbGVjdDpbMSwiPHNlbGVjdD4iLCI8L3NlbGVjdD4iXSx0Ym9keTpbMiwiPHRhYmxlPjx0Ym9keT4iLCI8L3Rib2R5PjwvdGFibGU+Il0sdHI6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdfTsKYS50aGVhZD1hLnRmb290PWEudGJvZHk7dmFyIGI9e3NldDpmdW5jdGlvbigpe3ZhciBmPUFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKS5qb2luKCIiKTt2YXIgZz0oIWMmJmFbdGhpcy5nZXQoInRhZyIpXSk7aWYoZyl7dmFyIGg9ZDtoLmlubmVySFRNTD1nWzFdK2YrZ1syXTsKZm9yKHZhciBlPWdbMF07ZS0tOyl7aD1oLmZpcnN0Q2hpbGQ7fXRoaXMuZW1wdHkoKS5hZG9wdChoLmNoaWxkTm9kZXMpO31lbHNle3RoaXMuaW5uZXJIVE1MPWY7fX19O2IuZXJhc2U9Yi5zZXQ7cmV0dXJuIGI7fSkoKTsoZnVuY3Rpb24oKXt2YXIgYz1kb2N1bWVudC5odG1sOwpFbGVtZW50LlByb3BlcnRpZXMuc3R5bGVzPXtzZXQ6ZnVuY3Rpb24oZil7dGhpcy5zZXRTdHlsZXMoZik7fX07dmFyIGU9KGMuc3R5bGUub3BhY2l0eSE9bnVsbCk7dmFyIGQ9L2FscGhhXChvcGFjaXR5PShbXGQuXSspXCkvaTt2YXIgYj1mdW5jdGlvbihnLGYpe2lmKCFnLmN1cnJlbnRTdHlsZXx8IWcuY3VycmVudFN0eWxlLmhhc0xheW91dCl7Zy5zdHlsZS56b29tPTE7Cn1pZihlKXtnLnN0eWxlLm9wYWNpdHk9Zjt9ZWxzZXtmPShmPT0xKT8iIjoiYWxwaGEob3BhY2l0eT0iK2YqMTAwKyIpIjt2YXIgaD1nLnN0eWxlLmZpbHRlcnx8Zy5nZXRDb21wdXRlZFN0eWxlKCJmaWx0ZXIiKXx8IiI7Zy5zdHlsZS5maWx0ZXI9aC50ZXN0KGQpP2gucmVwbGFjZShkLGYpOmgrZjsKfX07RWxlbWVudC5Qcm9wZXJ0aWVzLm9wYWNpdHk9e3NldDpmdW5jdGlvbihnKXt2YXIgZj10aGlzLnN0eWxlLnZpc2liaWxpdHk7aWYoZz09MCYmZiE9ImhpZGRlbiIpe3RoaXMuc3R5bGUudmlzaWJpbGl0eT0iaGlkZGVuIjt9ZWxzZXtpZihnIT0wJiZmIT0idmlzaWJsZSIpe3RoaXMuc3R5bGUudmlzaWJpbGl0eT0idmlzaWJsZSI7Cn19Yih0aGlzLGcpO30sZ2V0OihlKT9mdW5jdGlvbigpe3ZhciBmPXRoaXMuc3R5bGUub3BhY2l0eXx8dGhpcy5nZXRDb21wdXRlZFN0eWxlKCJvcGFjaXR5Iik7cmV0dXJuKGY9PSIiKT8xOmY7fTpmdW5jdGlvbigpe3ZhciBmLGc9KHRoaXMuc3R5bGUuZmlsdGVyfHx0aGlzLmdldENvbXB1dGVkU3R5bGUoImZpbHRlciIpKTsKaWYoZyl7Zj1nLm1hdGNoKGQpO31yZXR1cm4oZj09bnVsbHx8Zz09bnVsbCk/MTooZlsxXS8xMDApO319O3ZhciBhPShjLnN0eWxlLmNzc0Zsb2F0PT1udWxsKT8ic3R5bGVGbG9hdCI6ImNzc0Zsb2F0IjtFbGVtZW50LmltcGxlbWVudCh7Z2V0Q29tcHV0ZWRTdHlsZTpmdW5jdGlvbihoKXtpZih0aGlzLmN1cnJlbnRTdHlsZSl7cmV0dXJuIHRoaXMuY3VycmVudFN0eWxlW2guY2FtZWxDYXNlKCldOwp9dmFyIGc9RWxlbWVudC5nZXREb2N1bWVudCh0aGlzKS5kZWZhdWx0VmlldyxmPWc/Zy5nZXRDb21wdXRlZFN0eWxlKHRoaXMsbnVsbCk6bnVsbDtyZXR1cm4oZik/Zi5nZXRQcm9wZXJ0eVZhbHVlKChoPT1hKT8iZmxvYXQiOmguaHlwaGVuYXRlKCkpOm51bGw7fSxzZXRPcGFjaXR5OmZ1bmN0aW9uKGYpe2IodGhpcyxmKTsKcmV0dXJuIHRoaXM7fSxnZXRPcGFjaXR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0KCJvcGFjaXR5Iik7fSxzZXRTdHlsZTpmdW5jdGlvbihnLGYpe3N3aXRjaChnKXtjYXNlIm9wYWNpdHkiOnJldHVybiB0aGlzLnNldCgib3BhY2l0eSIscGFyc2VGbG9hdChmKSk7CmNhc2UiZmxvYXQiOmc9YTt9Zz1nLmNhbWVsQ2FzZSgpO2lmKHR5cGVPZihmKSE9InN0cmluZyIpe3ZhciBoPShFbGVtZW50LlN0eWxlc1tnXXx8IkAiKS5zcGxpdCgiICIpO2Y9QXJyYXkuZnJvbShmKS5tYXAoZnVuY3Rpb24oayxqKXtpZighaFtqXSl7cmV0dXJuIiI7Cn1yZXR1cm4odHlwZU9mKGspPT0ibnVtYmVyIik/aFtqXS5yZXBsYWNlKCJAIixNYXRoLnJvdW5kKGspKTprO30pLmpvaW4oIiAiKTt9ZWxzZXtpZihmPT1TdHJpbmcoTnVtYmVyKGYpKSl7Zj1NYXRoLnJvdW5kKGYpO319dGhpcy5zdHlsZVtnXT1mO3JldHVybiB0aGlzOwp9LGdldFN0eWxlOmZ1bmN0aW9uKGwpe3N3aXRjaChsKXtjYXNlIm9wYWNpdHkiOnJldHVybiB0aGlzLmdldCgib3BhY2l0eSIpO2Nhc2UiZmxvYXQiOmw9YTt9bD1sLmNhbWVsQ2FzZSgpO3ZhciBmPXRoaXMuc3R5bGVbbF07aWYoIWZ8fGw9PSJ6SW5kZXgiKXtmPVtdOwpmb3IodmFyIGsgaW4gRWxlbWVudC5TaG9ydFN0eWxlcyl7aWYobCE9ayl7Y29udGludWU7fWZvcih2YXIgaiBpbiBFbGVtZW50LlNob3J0U3R5bGVzW2tdKXtmLnB1c2godGhpcy5nZXRTdHlsZShqKSk7fXJldHVybiBmLmpvaW4oIiAiKTt9Zj10aGlzLmdldENvbXB1dGVkU3R5bGUobCk7Cn1pZihmKXtmPVN0cmluZyhmKTt2YXIgaD1mLm1hdGNoKC9yZ2JhP1woW1xkXHMsXStcKS8pO2lmKGgpe2Y9Zi5yZXBsYWNlKGhbMF0saFswXS5yZ2JUb0hleCgpKTt9fWlmKEJyb3dzZXIub3BlcmF8fChCcm93c2VyLmllJiZpc05hTihwYXJzZUZsb2F0KGYpKSkpe2lmKGwudGVzdCgvXihoZWlnaHR8d2lkdGgpJC8pKXt2YXIgZz0obD09IndpZHRoIik/WyJsZWZ0IiwicmlnaHQiXTpbInRvcCIsImJvdHRvbSJdLGk9MDsKZy5lYWNoKGZ1bmN0aW9uKG0pe2krPXRoaXMuZ2V0U3R5bGUoImJvcmRlci0iK20rIi13aWR0aCIpLnRvSW50KCkrdGhpcy5nZXRTdHlsZSgicGFkZGluZy0iK20pLnRvSW50KCk7fSx0aGlzKTtyZXR1cm4gdGhpc1sib2Zmc2V0IitsLmNhcGl0YWxpemUoKV0taSsicHgiOwp9aWYoQnJvd3Nlci5vcGVyYSYmU3RyaW5nKGYpLmluZGV4T2YoInB4IikhPS0xKXtyZXR1cm4gZjt9aWYobC50ZXN0KC8oYm9yZGVyKC4rKVdpZHRofG1hcmdpbnxwYWRkaW5nKS8pKXtyZXR1cm4iMHB4Ijt9fXJldHVybiBmO30sc2V0U3R5bGVzOmZ1bmN0aW9uKGcpe2Zvcih2YXIgZiBpbiBnKXt0aGlzLnNldFN0eWxlKGYsZ1tmXSk7Cn1yZXR1cm4gdGhpczt9LGdldFN0eWxlczpmdW5jdGlvbigpe3ZhciBmPXt9O0FycmF5LmZsYXR0ZW4oYXJndW1lbnRzKS5lYWNoKGZ1bmN0aW9uKGcpe2ZbZ109dGhpcy5nZXRTdHlsZShnKTt9LHRoaXMpO3JldHVybiBmO319KTtFbGVtZW50LlN0eWxlcz17bGVmdDoiQHB4Iix0b3A6IkBweCIsYm90dG9tOiJAcHgiLHJpZ2h0OiJAcHgiLHdpZHRoOiJAcHgiLGhlaWdodDoiQHB4IixtYXhXaWR0aDoiQHB4IixtYXhIZWlnaHQ6IkBweCIsbWluV2lkdGg6IkBweCIsbWluSGVpZ2h0OiJAcHgiLGJhY2tncm91bmRDb2xvcjoicmdiKEAsIEAsIEApIixiYWNrZ3JvdW5kUG9zaXRpb246IkBweCBAcHgiLGNvbG9yOiJyZ2IoQCwgQCwgQCkiLGZvbnRTaXplOiJAcHgiLGxldHRlclNwYWNpbmc6IkBweCIsbGluZUhlaWdodDoiQHB4IixjbGlwOiJyZWN0KEBweCBAcHggQHB4IEBweCkiLG1hcmdpbjoiQHB4IEBweCBAcHggQHB4IixwYWRkaW5nOiJAcHggQHB4IEBweCBAcHgiLGJvcmRlcjoiQHB4IEAgcmdiKEAsIEAsIEApIEBweCBAIHJnYihALCBALCBAKSBAcHggQCByZ2IoQCwgQCwgQCkiLGJvcmRlcldpZHRoOiJAcHggQHB4IEBweCBAcHgiLGJvcmRlclN0eWxlOiJAIEAgQCBAIixib3JkZXJDb2xvcjoicmdiKEAsIEAsIEApIHJnYihALCBALCBAKSByZ2IoQCwgQCwgQCkgcmdiKEAsIEAsIEApIix6SW5kZXg6IkAiLHpvb206IkAiLGZvbnRXZWlnaHQ6IkAiLHRleHRJbmRlbnQ6IkBweCIsb3BhY2l0eToiQCJ9OwpFbGVtZW50LlN0eWxlcz1uZXcgSGFzaChFbGVtZW50LlN0eWxlcyk7RWxlbWVudC5TaG9ydFN0eWxlcz17bWFyZ2luOnt9LHBhZGRpbmc6e30sYm9yZGVyOnt9LGJvcmRlcldpZHRoOnt9LGJvcmRlclN0eWxlOnt9LGJvcmRlckNvbG9yOnt9fTtbIlRvcCIsIlJpZ2h0IiwiQm90dG9tIiwiTGVmdCJdLmVhY2goZnVuY3Rpb24obCl7dmFyIGs9RWxlbWVudC5TaG9ydFN0eWxlczsKdmFyIGc9RWxlbWVudC5TdHlsZXM7WyJtYXJnaW4iLCJwYWRkaW5nIl0uZWFjaChmdW5jdGlvbihtKXt2YXIgbj1tK2w7a1ttXVtuXT1nW25dPSJAcHgiO30pO3ZhciBqPSJib3JkZXIiK2w7ay5ib3JkZXJbal09Z1tqXT0iQHB4IEAgcmdiKEAsIEAsIEApIjt2YXIgaT1qKyJXaWR0aCIsZj1qKyJTdHlsZSIsaD1qKyJDb2xvciI7Cmtbal09e307ay5ib3JkZXJXaWR0aFtpXT1rW2pdW2ldPWdbaV09IkBweCI7ay5ib3JkZXJTdHlsZVtmXT1rW2pdW2ZdPWdbZl09IkAiO2suYm9yZGVyQ29sb3JbaF09a1tqXVtoXT1nW2hdPSJyZ2IoQCwgQCwgQCkiO30pO30pKCk7KGZ1bmN0aW9uKCl7RWxlbWVudC5Qcm9wZXJ0aWVzLmV2ZW50cz17c2V0OmZ1bmN0aW9uKGMpe3RoaXMuYWRkRXZlbnRzKGMpOwp9fTtbRWxlbWVudCxXaW5kb3csRG9jdW1lbnRdLmludm9rZSgiaW1wbGVtZW50Iix7YWRkRXZlbnQ6ZnVuY3Rpb24oZyxpKXt2YXIgaj10aGlzLnJldHJpZXZlKCJldmVudHMiLHt9KTtpZighaltnXSl7altnXT17a2V5czpbXSx2YWx1ZXM6W119O31pZihqW2ddLmtleXMuY29udGFpbnMoaSkpe3JldHVybiB0aGlzOwp9altnXS5rZXlzLnB1c2goaSk7dmFyIGg9ZyxjPUVsZW1lbnQuRXZlbnRzW2ddLGU9aSxrPXRoaXM7aWYoYyl7aWYoYy5vbkFkZCl7Yy5vbkFkZC5jYWxsKHRoaXMsaSk7fWlmKGMuY29uZGl0aW9uKXtlPWZ1bmN0aW9uKGwpe2lmKGMuY29uZGl0aW9uLmNhbGwodGhpcyxsKSl7cmV0dXJuIGkuY2FsbCh0aGlzLGwpOwp9cmV0dXJuIHRydWU7fTt9aD1jLmJhc2V8fGg7fXZhciBmPWZ1bmN0aW9uKCl7cmV0dXJuIGkuY2FsbChrKTt9O3ZhciBkPUVsZW1lbnQuTmF0aXZlRXZlbnRzW2hdO2lmKGQpe2lmKGQ9PTIpe2Y9ZnVuY3Rpb24obCl7bD1uZXcgRXZlbnQobCxrLmdldFdpbmRvdygpKTsKaWYoZS5jYWxsKGssbCk9PT1mYWxzZSl7bC5zdG9wKCk7fX07fXRoaXMuYWRkTGlzdGVuZXIoaCxmKTt9altnXS52YWx1ZXMucHVzaChmKTtyZXR1cm4gdGhpczt9LHJlbW92ZUV2ZW50OmZ1bmN0aW9uKGYsZSl7dmFyIGQ9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIik7aWYoIWR8fCFkW2ZdKXtyZXR1cm4gdGhpczsKfXZhciBpPWRbZl07dmFyIGM9aS5rZXlzLmluZGV4T2YoZSk7aWYoYz09LTEpe3JldHVybiB0aGlzO312YXIgaD1pLnZhbHVlc1tjXTtkZWxldGUgaS5rZXlzW2NdO2RlbGV0ZSBpLnZhbHVlc1tjXTt2YXIgZz1FbGVtZW50LkV2ZW50c1tmXTtpZihnKXtpZihnLm9uUmVtb3ZlKXtnLm9uUmVtb3ZlLmNhbGwodGhpcyxlKTsKfWY9Zy5iYXNlfHxmO31yZXR1cm4oRWxlbWVudC5OYXRpdmVFdmVudHNbZl0pP3RoaXMucmVtb3ZlTGlzdGVuZXIoZixoKTp0aGlzO30sYWRkRXZlbnRzOmZ1bmN0aW9uKGMpe2Zvcih2YXIgZCBpbiBjKXt0aGlzLmFkZEV2ZW50KGQsY1tkXSk7fXJldHVybiB0aGlzOwp9LHJlbW92ZUV2ZW50czpmdW5jdGlvbihjKXt2YXIgZTtpZih0eXBlT2YoYyk9PSJvYmplY3QiKXtmb3IoZSBpbiBjKXt0aGlzLnJlbW92ZUV2ZW50KGUsY1tlXSk7fXJldHVybiB0aGlzO312YXIgZD10aGlzLnJldHJpZXZlKCJldmVudHMiKTtpZighZCl7cmV0dXJuIHRoaXM7Cn1pZighYyl7Zm9yKGUgaW4gZCl7dGhpcy5yZW1vdmVFdmVudHMoZSk7fXRoaXMuZWxpbWluYXRlKCJldmVudHMiKTt9ZWxzZXtpZihkW2NdKXtkW2NdLmtleXMuZWFjaChmdW5jdGlvbihmKXt0aGlzLnJlbW92ZUV2ZW50KGMsZik7fSx0aGlzKTtkZWxldGUgZFtjXTsKfX1yZXR1cm4gdGhpczt9LGZpcmVFdmVudDpmdW5jdGlvbihmLGQsYyl7dmFyIGU9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIik7aWYoIWV8fCFlW2ZdKXtyZXR1cm4gdGhpczt9ZD1BcnJheS5mcm9tKGQpO2VbZl0ua2V5cy5lYWNoKGZ1bmN0aW9uKGcpe2lmKGMpe2cuZGVsYXkoYyx0aGlzLGQpOwp9ZWxzZXtnLmFwcGx5KHRoaXMsZCk7fX0sdGhpcyk7cmV0dXJuIHRoaXM7fSxjbG9uZUV2ZW50czpmdW5jdGlvbihmLGUpe2Y9ZG9jdW1lbnQuaWQoZik7dmFyIGQ9Zi5yZXRyaWV2ZSgiZXZlbnRzIik7aWYoIWQpe3JldHVybiB0aGlzO31pZighZSl7Zm9yKHZhciBjIGluIGQpe3RoaXMuY2xvbmVFdmVudHMoZixjKTsKfX1lbHNle2lmKGRbZV0pe2RbZV0ua2V5cy5lYWNoKGZ1bmN0aW9uKGcpe3RoaXMuYWRkRXZlbnQoZSxnKTt9LHRoaXMpO319cmV0dXJuIHRoaXM7fX0pO3RyeXtpZih0eXBlb2YgSFRNTEVsZW1lbnQhPSJ1bmRlZmluZWQiKXtIVE1MRWxlbWVudC5wcm90b3R5cGUuZmlyZUV2ZW50PUVsZW1lbnQucHJvdG90eXBlLmZpcmVFdmVudDsKfX1jYXRjaChiKXt9RWxlbWVudC5OYXRpdmVFdmVudHM9e2NsaWNrOjIsZGJsY2xpY2s6Mixtb3VzZXVwOjIsbW91c2Vkb3duOjIsY29udGV4dG1lbnU6Mixtb3VzZXdoZWVsOjIsRE9NTW91c2VTY3JvbGw6Mixtb3VzZW92ZXI6Mixtb3VzZW91dDoyLG1vdXNlbW92ZToyLHNlbGVjdHN0YXJ0OjIsc2VsZWN0ZW5kOjIsa2V5ZG93bjoyLGtleXByZXNzOjIsa2V5dXA6MixvcmllbnRhdGlvbmNoYW5nZToyLHRvdWNoc3RhcnQ6Mix0b3VjaG1vdmU6Mix0b3VjaGVuZDoyLHRvdWNoY2FuY2VsOjIsZ2VzdHVyZXN0YXJ0OjIsZ2VzdHVyZWNoYW5nZToyLGdlc3R1cmVlbmQ6Mixmb2N1czoyLGJsdXI6MixjaGFuZ2U6MixyZXNldDoyLHNlbGVjdDoyLHN1Ym1pdDoyLGxvYWQ6Mix1bmxvYWQ6MSxiZWZvcmV1bmxvYWQ6MixyZXNpemU6MSxtb3ZlOjEsRE9NQ29udGVudExvYWRlZDoxLHJlYWR5c3RhdGVjaGFuZ2U6MSxlcnJvcjoxLGFib3J0OjEsc2Nyb2xsOjF9Owp2YXIgYT1mdW5jdGlvbihjKXt2YXIgZD1jLnJlbGF0ZWRUYXJnZXQ7aWYoZD09bnVsbCl7cmV0dXJuIHRydWU7fWlmKCFkKXtyZXR1cm4gZmFsc2U7fXJldHVybihkIT10aGlzJiZkLnByZWZpeCE9Inh1bCImJnR5cGVPZih0aGlzKSE9ImRvY3VtZW50IiYmIXRoaXMuY29udGFpbnMoZCkpOwp9O0VsZW1lbnQuRXZlbnRzPXttb3VzZWVudGVyOntiYXNlOiJtb3VzZW92ZXIiLGNvbmRpdGlvbjphfSxtb3VzZWxlYXZlOntiYXNlOiJtb3VzZW91dCIsY29uZGl0aW9uOmF9LG1vdXNld2hlZWw6e2Jhc2U6KEJyb3dzZXIuZmlyZWZveCk/IkRPTU1vdXNlU2Nyb2xsIjoibW91c2V3aGVlbCJ9fTsKRWxlbWVudC5FdmVudHM9bmV3IEhhc2goRWxlbWVudC5FdmVudHMpO30pKCk7KGZ1bmN0aW9uKCl7RWxlbWVudC5pbXBsZW1lbnQoe3Njcm9sbFRvOmZ1bmN0aW9uKGgsaSl7aWYoYih0aGlzKSl7dGhpcy5nZXRXaW5kb3coKS5zY3JvbGxUbyhoLGkpO31lbHNle3RoaXMuc2Nyb2xsTGVmdD1oOwp0aGlzLnNjcm9sbFRvcD1pO31yZXR1cm4gdGhpczt9LGdldFNpemU6ZnVuY3Rpb24oKXtpZihiKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRTaXplKCk7fXJldHVybnt4OnRoaXMub2Zmc2V0V2lkdGgseTp0aGlzLm9mZnNldEhlaWdodH07fSxnZXRTY3JvbGxTaXplOmZ1bmN0aW9uKCl7aWYoYih0aGlzKSl7cmV0dXJuIHRoaXMuZ2V0V2luZG93KCkuZ2V0U2Nyb2xsU2l6ZSgpOwp9cmV0dXJue3g6dGhpcy5zY3JvbGxXaWR0aCx5OnRoaXMuc2Nyb2xsSGVpZ2h0fTt9LGdldFNjcm9sbDpmdW5jdGlvbigpe2lmKGIodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldFNjcm9sbCgpO31yZXR1cm57eDp0aGlzLnNjcm9sbExlZnQseTp0aGlzLnNjcm9sbFRvcH07Cn0sZ2V0U2Nyb2xsczpmdW5jdGlvbigpe3ZhciBpPXRoaXMucGFyZW50Tm9kZSxoPXt4OjAseTowfTt3aGlsZShpJiYhYihpKSl7aC54Kz1pLnNjcm9sbExlZnQ7aC55Kz1pLnNjcm9sbFRvcDtpPWkucGFyZW50Tm9kZTt9cmV0dXJuIGg7fSxnZXRPZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXt2YXIgaD10aGlzOwppZihiKGgpKXtyZXR1cm4gbnVsbDt9aWYoIUJyb3dzZXIuaWUpe3JldHVybiBoLm9mZnNldFBhcmVudDt9d2hpbGUoKGg9aC5wYXJlbnROb2RlKSl7aWYoZChoLCJwb3NpdGlvbiIpIT0ic3RhdGljInx8YihoKSl7cmV0dXJuIGg7fX1yZXR1cm4gbnVsbDt9LGdldE9mZnNldHM6ZnVuY3Rpb24oKXtpZih0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCYmIUJyb3dzZXIuUGxhdGZvcm0uaW9zKXt2YXIgbT10aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGo9ZG9jdW1lbnQuaWQodGhpcy5nZXREb2N1bWVudCgpLmRvY3VtZW50RWxlbWVudCksbD1qLmdldFNjcm9sbCgpLG89dGhpcy5nZXRTY3JvbGxzKCksbj0oZCh0aGlzLCJwb3NpdGlvbiIpPT0iZml4ZWQiKTsKcmV0dXJue3g6bS5sZWZ0LnRvSW50KCkrby54Kygobik/MDpsLngpLWouY2xpZW50TGVmdCx5Om0udG9wLnRvSW50KCkrby55Kygobik/MDpsLnkpLWouY2xpZW50VG9wfTt9dmFyIGk9dGhpcyxoPXt4OjAseTowfTtpZihiKHRoaXMpKXtyZXR1cm4gaDt9d2hpbGUoaSYmIWIoaSkpe2gueCs9aS5vZmZzZXRMZWZ0OwpoLnkrPWkub2Zmc2V0VG9wO2lmKEJyb3dzZXIuZmlyZWZveCl7aWYoIWYoaSkpe2gueCs9YyhpKTtoLnkrPWcoaSk7fXZhciBrPWkucGFyZW50Tm9kZTtpZihrJiZkKGssIm92ZXJmbG93IikhPSJ2aXNpYmxlIil7aC54Kz1jKGspO2gueSs9ZyhrKTt9fWVsc2V7aWYoaSE9dGhpcyYmQnJvd3Nlci5zYWZhcmkpe2gueCs9YyhpKTsKaC55Kz1nKGkpO319aT1pLm9mZnNldFBhcmVudDt9aWYoQnJvd3Nlci5maXJlZm94JiYhZih0aGlzKSl7aC54LT1jKHRoaXMpO2gueS09Zyh0aGlzKTt9cmV0dXJuIGg7fSxnZXRQb3NpdGlvbjpmdW5jdGlvbihrKXtpZihiKHRoaXMpKXtyZXR1cm57eDowLHk6MH07fXZhciBsPXRoaXMuZ2V0T2Zmc2V0cygpLGk9dGhpcy5nZXRTY3JvbGxzKCk7CnZhciBoPXt4OmwueC1pLngseTpsLnktaS55fTtpZihrJiYoaz1kb2N1bWVudC5pZChrKSkpe3ZhciBqPWsuZ2V0UG9zaXRpb24oKTtyZXR1cm57eDpoLngtai54LWMoaykseTpoLnktai55LWcoayl9O31yZXR1cm4gaDt9LGdldENvb3JkaW5hdGVzOmZ1bmN0aW9uKGope2lmKGIodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldENvb3JkaW5hdGVzKCk7Cn12YXIgaD10aGlzLmdldFBvc2l0aW9uKGopLGk9dGhpcy5nZXRTaXplKCk7dmFyIGs9e2xlZnQ6aC54LHRvcDpoLnksd2lkdGg6aS54LGhlaWdodDppLnl9O2sucmlnaHQ9ay5sZWZ0K2sud2lkdGg7ay5ib3R0b209ay50b3Aray5oZWlnaHQ7cmV0dXJuIGs7fSxjb21wdXRlUG9zaXRpb246ZnVuY3Rpb24oaCl7cmV0dXJue2xlZnQ6aC54LWUodGhpcywibWFyZ2luLWxlZnQiKSx0b3A6aC55LWUodGhpcywibWFyZ2luLXRvcCIpfTsKfSxzZXRQb3NpdGlvbjpmdW5jdGlvbihoKXtyZXR1cm4gdGhpcy5zZXRTdHlsZXModGhpcy5jb21wdXRlUG9zaXRpb24oaCkpO319KTtbRG9jdW1lbnQsV2luZG93XS5pbnZva2UoImltcGxlbWVudCIse2dldFNpemU6ZnVuY3Rpb24oKXt2YXIgaD1hKHRoaXMpO3JldHVybnt4OmguY2xpZW50V2lkdGgseTpoLmNsaWVudEhlaWdodH07Cn0sZ2V0U2Nyb2xsOmZ1bmN0aW9uKCl7dmFyIGk9dGhpcy5nZXRXaW5kb3coKSxoPWEodGhpcyk7cmV0dXJue3g6aS5wYWdlWE9mZnNldHx8aC5zY3JvbGxMZWZ0LHk6aS5wYWdlWU9mZnNldHx8aC5zY3JvbGxUb3B9O30sZ2V0U2Nyb2xsU2l6ZTpmdW5jdGlvbigpe3ZhciBqPWEodGhpcyksaT10aGlzLmdldFNpemUoKSxoPXRoaXMuZ2V0RG9jdW1lbnQoKS5ib2R5OwpyZXR1cm57eDpNYXRoLm1heChqLnNjcm9sbFdpZHRoLGguc2Nyb2xsV2lkdGgsaS54KSx5Ok1hdGgubWF4KGouc2Nyb2xsSGVpZ2h0LGguc2Nyb2xsSGVpZ2h0LGkueSl9O30sZ2V0UG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm57eDowLHk6MH07fSxnZXRDb29yZGluYXRlczpmdW5jdGlvbigpe3ZhciBoPXRoaXMuZ2V0U2l6ZSgpOwpyZXR1cm57dG9wOjAsbGVmdDowLGJvdHRvbTpoLnkscmlnaHQ6aC54LGhlaWdodDpoLnksd2lkdGg6aC54fTt9fSk7dmFyIGQ9RWxlbWVudC5nZXRDb21wdXRlZFN0eWxlO2Z1bmN0aW9uIGUoaCxpKXtyZXR1cm4gZChoLGkpLnRvSW50KCl8fDA7fWZ1bmN0aW9uIGYoaCl7cmV0dXJuIGQoaCwiLW1vei1ib3gtc2l6aW5nIik9PSJib3JkZXItYm94IjsKfWZ1bmN0aW9uIGcoaCl7cmV0dXJuIGUoaCwiYm9yZGVyLXRvcC13aWR0aCIpO31mdW5jdGlvbiBjKGgpe3JldHVybiBlKGgsImJvcmRlci1sZWZ0LXdpZHRoIik7fWZ1bmN0aW9uIGIoaCl7cmV0dXJuKC9eKD86Ym9keXxodG1sKSQvaSkudGVzdChoLnRhZ05hbWUpOwp9ZnVuY3Rpb24gYShoKXt2YXIgaT1oLmdldERvY3VtZW50KCk7cmV0dXJuKCFpLmNvbXBhdE1vZGV8fGkuY29tcGF0TW9kZT09IkNTUzFDb21wYXQiKT9pLmh0bWw6aS5ib2R5O319KSgpO0VsZW1lbnQuYWxpYXMoe3Bvc2l0aW9uOiJzZXRQb3NpdGlvbiJ9KTtbV2luZG93LERvY3VtZW50LEVsZW1lbnRdLmludm9rZSgiaW1wbGVtZW50Iix7Z2V0SGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2l6ZSgpLnk7Cn0sZ2V0V2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTaXplKCkueDt9LGdldFNjcm9sbFRvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbCgpLnk7fSxnZXRTY3JvbGxMZWZ0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2Nyb2xsKCkueDsKfSxnZXRTY3JvbGxIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTY3JvbGxTaXplKCkueTt9LGdldFNjcm9sbFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2Nyb2xsU2l6ZSgpLng7fSxnZXRUb3A6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRQb3NpdGlvbigpLnk7Cn0sZ2V0TGVmdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFBvc2l0aW9uKCkueDt9fSk7KGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5GeD1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6W0NoYWluLEV2ZW50cyxPcHRpb25zXSxvcHRpb25zOntmcHM6NTAsdW5pdDpmYWxzZSxkdXJhdGlvbjo1MDAsbGluazoiaWdub3JlIn0saW5pdGlhbGl6ZTpmdW5jdGlvbihnKXt0aGlzLnN1YmplY3Q9dGhpcy5zdWJqZWN0fHx0aGlzOwp0aGlzLnNldE9wdGlvbnMoZyk7fSxnZXRUcmFuc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGcpe3JldHVybiAtKE1hdGguY29zKE1hdGguUEkqZyktMSkvMjt9O30sc3RlcDpmdW5jdGlvbigpe3ZhciBnPURhdGUubm93KCk7aWYoZzx0aGlzLnRpbWUrdGhpcy5vcHRpb25zLmR1cmF0aW9uKXt2YXIgaD10aGlzLnRyYW5zaXRpb24oKGctdGhpcy50aW1lKS90aGlzLm9wdGlvbnMuZHVyYXRpb24pOwp0aGlzLnNldCh0aGlzLmNvbXB1dGUodGhpcy5mcm9tLHRoaXMudG8saCkpO31lbHNle3RoaXMuc2V0KHRoaXMuY29tcHV0ZSh0aGlzLmZyb20sdGhpcy50bywxKSk7dGhpcy5jb21wbGV0ZSgpO319LHNldDpmdW5jdGlvbihnKXtyZXR1cm4gZzt9LGNvbXB1dGU6ZnVuY3Rpb24oaSxoLGcpe3JldHVybiBlLmNvbXB1dGUoaSxoLGcpOwp9LGNoZWNrOmZ1bmN0aW9uKCl7aWYoIXRoaXMudGltZXIpe3JldHVybiB0cnVlO31zd2l0Y2godGhpcy5vcHRpb25zLmxpbmspe2Nhc2UiY2FuY2VsIjp0aGlzLmNhbmNlbCgpO3JldHVybiB0cnVlO2Nhc2UiY2hhaW4iOnRoaXMuY2hhaW4odGhpcy5jYWxsZXIucGFzcyhhcmd1bWVudHMsdGhpcykpOwpyZXR1cm4gZmFsc2U7fXJldHVybiBmYWxzZTt9LHN0YXJ0OmZ1bmN0aW9uKGksaCl7aWYoIXRoaXMuY2hlY2soaSxoKSl7cmV0dXJuIHRoaXM7fXZhciBnPXRoaXMub3B0aW9ucy5kdXJhdGlvbjt0aGlzLm9wdGlvbnMuZHVyYXRpb249ZS5EdXJhdGlvbnNbZ118fGcudG9JbnQoKTsKdGhpcy5mcm9tPWk7dGhpcy50bz1oO3RoaXMudGltZT0wO3RoaXMudHJhbnNpdGlvbj10aGlzLmdldFRyYW5zaXRpb24oKTt0aGlzLnN0YXJ0VGltZXIoKTt0aGlzLm9uU3RhcnQoKTtyZXR1cm4gdGhpczt9LGNvbXBsZXRlOmZ1bmN0aW9uKCl7aWYodGhpcy5zdG9wVGltZXIoKSl7dGhpcy5vbkNvbXBsZXRlKCk7Cn1yZXR1cm4gdGhpczt9LGNhbmNlbDpmdW5jdGlvbigpe2lmKHRoaXMuc3RvcFRpbWVyKCkpe3RoaXMub25DYW5jZWwoKTt9cmV0dXJuIHRoaXM7fSxvblN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoInN0YXJ0Iix0aGlzLnN1YmplY3QpO30sb25Db21wbGV0ZTpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJjb21wbGV0ZSIsdGhpcy5zdWJqZWN0KTsKaWYoIXRoaXMuY2FsbENoYWluKCkpe3RoaXMuZmlyZUV2ZW50KCJjaGFpbkNvbXBsZXRlIix0aGlzLnN1YmplY3QpO319LG9uQ2FuY2VsOmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoImNhbmNlbCIsdGhpcy5zdWJqZWN0KS5jbGVhckNoYWluKCk7fSxwYXVzZTpmdW5jdGlvbigpe3RoaXMuc3RvcFRpbWVyKCk7CnJldHVybiB0aGlzO30scmVzdW1lOmZ1bmN0aW9uKCl7dGhpcy5zdGFydFRpbWVyKCk7cmV0dXJuIHRoaXM7fSxzdG9wVGltZXI6ZnVuY3Rpb24oKXtpZighdGhpcy50aW1lcil7cmV0dXJuIGZhbHNlO310aGlzLnRpbWU9RGF0ZS5ub3coKS10aGlzLnRpbWU7dGhpcy50aW1lcj1mKHRoaXMpOwpyZXR1cm4gdHJ1ZTt9LHN0YXJ0VGltZXI6ZnVuY3Rpb24oKXtpZih0aGlzLnRpbWVyKXtyZXR1cm4gZmFsc2U7fXRoaXMudGltZT1EYXRlLm5vdygpLXRoaXMudGltZTt0aGlzLnRpbWVyPWIodGhpcyk7cmV0dXJuIHRydWU7fX0pO2UuY29tcHV0ZT1mdW5jdGlvbihpLGgsZyl7cmV0dXJuKGgtaSkqZytpOwp9O2UuRHVyYXRpb25zPXsic2hvcnQiOjI1MCxub3JtYWw6NTAwLCJsb25nIjoxMDAwfTt2YXIgZD17fSxjPXt9O3ZhciBhPWZ1bmN0aW9uKCl7Zm9yKHZhciBnPXRoaXMubGVuZ3RoO2ctLTspe2lmKHRoaXNbZ10pe3RoaXNbZ10uc3RlcCgpO319fTt2YXIgYj1mdW5jdGlvbihnKXt2YXIgaT1nLm9wdGlvbnMuZnBzLGg9ZFtpXXx8KGRbaV09W10pOwpoLnB1c2goZyk7aWYoIWNbaV0pe2NbaV09YS5wZXJpb2RpY2FsKE1hdGgucm91bmQoMTAwMC9pKSxoKTt9cmV0dXJuIHRydWU7fTt2YXIgZj1mdW5jdGlvbihnKXt2YXIgaT1nLm9wdGlvbnMuZnBzLGg9ZFtpXXx8W107aC5lcmFzZShnKTtpZighaC5sZW5ndGgmJmNbaV0pe2NbaV09Y2xlYXJJbnRlcnZhbChjW2ldKTsKfXJldHVybiBmYWxzZTt9O30pKCk7RnguQ1NTPW5ldyBDbGFzcyh7RXh0ZW5kczpGeCxwcmVwYXJlOmZ1bmN0aW9uKGMsZCxiKXtiPUFycmF5LmZyb20oYik7aWYoYlsxXT09bnVsbCl7YlsxXT1iWzBdO2JbMF09Yy5nZXRTdHlsZShkKTt9dmFyIGE9Yi5tYXAodGhpcy5wYXJzZSk7CnJldHVybntmcm9tOmFbMF0sdG86YVsxXX07fSxwYXJzZTpmdW5jdGlvbihhKXthPUZ1bmN0aW9uLmZyb20oYSkoKTthPSh0eXBlb2YgYT09InN0cmluZyIpP2Euc3BsaXQoIiAiKTpBcnJheS5mcm9tKGEpO3JldHVybiBhLm1hcChmdW5jdGlvbihjKXtjPVN0cmluZyhjKTsKdmFyIGI9ZmFsc2U7T2JqZWN0LmVhY2goRnguQ1NTLlBhcnNlcnMsZnVuY3Rpb24oZixlKXtpZihiKXtyZXR1cm47fXZhciBkPWYucGFyc2UoYyk7aWYoZHx8ZD09PTApe2I9e3ZhbHVlOmQscGFyc2VyOmZ9O319KTtiPWJ8fHt2YWx1ZTpjLHBhcnNlcjpGeC5DU1MuUGFyc2Vycy5TdHJpbmd9OwpyZXR1cm4gYjt9KTt9LGNvbXB1dGU6ZnVuY3Rpb24oZCxjLGIpe3ZhciBhPVtdOyhNYXRoLm1pbihkLmxlbmd0aCxjLmxlbmd0aCkpLnRpbWVzKGZ1bmN0aW9uKGUpe2EucHVzaCh7dmFsdWU6ZFtlXS5wYXJzZXIuY29tcHV0ZShkW2VdLnZhbHVlLGNbZV0udmFsdWUsYikscGFyc2VyOmRbZV0ucGFyc2VyfSk7Cn0pO2EuJGZhbWlseT1GdW5jdGlvbi5mcm9tKCJmeDpjc3M6dmFsdWUiKTtyZXR1cm4gYTt9LHNlcnZlOmZ1bmN0aW9uKGMsYil7aWYodHlwZU9mKGMpIT0iZng6Y3NzOnZhbHVlIil7Yz10aGlzLnBhcnNlKGMpO312YXIgYT1bXTtjLmVhY2goZnVuY3Rpb24oZCl7YT1hLmNvbmNhdChkLnBhcnNlci5zZXJ2ZShkLnZhbHVlLGIpKTsKfSk7cmV0dXJuIGE7fSxyZW5kZXI6ZnVuY3Rpb24oYSxkLGMsYil7YS5zZXRTdHlsZShkLHRoaXMuc2VydmUoYyxiKSk7fSxzZWFyY2g6ZnVuY3Rpb24oYSl7aWYoRnguQ1NTLkNhY2hlW2FdKXtyZXR1cm4gRnguQ1NTLkNhY2hlW2FdO312YXIgYj17fTtBcnJheS5lYWNoKGRvY3VtZW50LnN0eWxlU2hlZXRzLGZ1bmN0aW9uKGUsZCl7dmFyIGM9ZS5ocmVmOwppZihjJiZjLmNvbnRhaW5zKCI6Ly8iKSYmIWMuY29udGFpbnMoZG9jdW1lbnQuZG9tYWluKSl7cmV0dXJuO312YXIgZj1lLnJ1bGVzfHxlLmNzc1J1bGVzO0FycmF5LmVhY2goZixmdW5jdGlvbihqLGcpe2lmKCFqLnN0eWxlKXtyZXR1cm47fXZhciBoPShqLnNlbGVjdG9yVGV4dCk/ai5zZWxlY3RvclRleHQucmVwbGFjZSgvXlx3Ky8sZnVuY3Rpb24oaSl7cmV0dXJuIGkudG9Mb3dlckNhc2UoKTsKfSk6bnVsbDtpZighaHx8IWgudGVzdCgiXiIrYSsiJCIpKXtyZXR1cm47fUVsZW1lbnQuU3R5bGVzLmVhY2goZnVuY3Rpb24oayxpKXtpZighai5zdHlsZVtpXXx8RWxlbWVudC5TaG9ydFN0eWxlc1tpXSl7cmV0dXJuO31rPVN0cmluZyhqLnN0eWxlW2ldKTtiW2ldPShrLnRlc3QoL15yZ2IvKSk/ay5yZ2JUb0hleCgpOms7Cn0pO30pO30pO3JldHVybiBGeC5DU1MuQ2FjaGVbYV09Yjt9fSk7RnguQ1NTLkNhY2hlPXt9O0Z4LkNTUy5QYXJzZXJzPXtDb2xvcjp7cGFyc2U6ZnVuY3Rpb24oYSl7aWYoYS5tYXRjaCgvXiNbMC05YS1mXXszLDZ9JC9pKSl7cmV0dXJuIGEuaGV4VG9SZ2IodHJ1ZSk7Cn1yZXR1cm4oKGE9YS5tYXRjaCgvKFxkKyksXHMqKFxkKyksXHMqKFxkKykvKSkpP1thWzFdLGFbMl0sYVszXV06ZmFsc2U7fSxjb21wdXRlOmZ1bmN0aW9uKGMsYixhKXtyZXR1cm4gYy5tYXAoZnVuY3Rpb24oZSxkKXtyZXR1cm4gTWF0aC5yb3VuZChGeC5jb21wdXRlKGNbZF0sYltkXSxhKSk7Cn0pO30sc2VydmU6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubWFwKE51bWJlcik7fX0sTnVtYmVyOntwYXJzZTpwYXJzZUZsb2F0LGNvbXB1dGU6RnguY29tcHV0ZSxzZXJ2ZTpmdW5jdGlvbihiLGEpe3JldHVybihhKT9iK2E6Yjt9fSxTdHJpbmc6e3BhcnNlOkZ1bmN0aW9uLmZyb20oZmFsc2UpLGNvbXB1dGU6ZnVuY3Rpb24oYixhKXtyZXR1cm4gYTsKfSxzZXJ2ZTpmdW5jdGlvbihhKXtyZXR1cm4gYTt9fX07RnguQ1NTLlBhcnNlcnM9bmV3IEhhc2goRnguQ1NTLlBhcnNlcnMpO0Z4LlR3ZWVuPW5ldyBDbGFzcyh7RXh0ZW5kczpGeC5DU1MsaW5pdGlhbGl6ZTpmdW5jdGlvbihiLGEpe3RoaXMuZWxlbWVudD10aGlzLnN1YmplY3Q9ZG9jdW1lbnQuaWQoYik7CnRoaXMucGFyZW50KGEpO30sc2V0OmZ1bmN0aW9uKGIsYSl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7YT1iO2I9dGhpcy5wcm9wZXJ0eXx8dGhpcy5vcHRpb25zLnByb3BlcnR5O310aGlzLnJlbmRlcih0aGlzLmVsZW1lbnQsYixhLHRoaXMub3B0aW9ucy51bml0KTsKcmV0dXJuIHRoaXM7fSxzdGFydDpmdW5jdGlvbihjLGUsZCl7aWYoIXRoaXMuY2hlY2soYyxlLGQpKXtyZXR1cm4gdGhpczt9dmFyIGI9QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpO3RoaXMucHJvcGVydHk9dGhpcy5vcHRpb25zLnByb3BlcnR5fHxiLnNoaWZ0KCk7dmFyIGE9dGhpcy5wcmVwYXJlKHRoaXMuZWxlbWVudCx0aGlzLnByb3BlcnR5LGIpOwpyZXR1cm4gdGhpcy5wYXJlbnQoYS5mcm9tLGEudG8pO319KTtFbGVtZW50LlByb3BlcnRpZXMudHdlZW49e3NldDpmdW5jdGlvbihhKXt0aGlzLmdldCgidHdlZW4iKS5jYW5jZWwoKS5zZXRPcHRpb25zKGEpO3JldHVybiB0aGlzO30sZ2V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yZXRyaWV2ZSgidHdlZW4iKTsKaWYoIWEpe2E9bmV3IEZ4LlR3ZWVuKHRoaXMse2xpbms6ImNhbmNlbCJ9KTt0aGlzLnN0b3JlKCJ0d2VlbiIsYSk7fXJldHVybiBhO319O0VsZW1lbnQuaW1wbGVtZW50KHt0d2VlbjpmdW5jdGlvbihhLGMsYil7dGhpcy5nZXQoInR3ZWVuIikuc3RhcnQoYXJndW1lbnRzKTsKcmV0dXJuIHRoaXM7fSxmYWRlOmZ1bmN0aW9uKGMpe3ZhciBlPXRoaXMuZ2V0KCJ0d2VlbiIpLGQ9Im9wYWNpdHkiLGE7Yz1bYywidG9nZ2xlIl0ucGljaygpO3N3aXRjaChjKXtjYXNlImluIjplLnN0YXJ0KGQsMSk7YnJlYWs7Y2FzZSJvdXQiOmUuc3RhcnQoZCwwKTsKYnJlYWs7Y2FzZSJzaG93IjplLnNldChkLDEpO2JyZWFrO2Nhc2UiaGlkZSI6ZS5zZXQoZCwwKTticmVhaztjYXNlInRvZ2dsZSI6dmFyIGI9dGhpcy5yZXRyaWV2ZSgiZmFkZTpmbGFnIix0aGlzLmdldCgib3BhY2l0eSIpPT0xKTtlLnN0YXJ0KGQsKGIpPzA6MSk7dGhpcy5zdG9yZSgiZmFkZTpmbGFnIiwhYik7CmE9dHJ1ZTticmVhaztkZWZhdWx0OmUuc3RhcnQoZCxhcmd1bWVudHMpO31pZighYSl7dGhpcy5lbGltaW5hdGUoImZhZGU6ZmxhZyIpO31yZXR1cm4gdGhpczt9LGhpZ2hsaWdodDpmdW5jdGlvbihjLGEpe2lmKCFhKXthPXRoaXMucmV0cmlldmUoImhpZ2hsaWdodDpvcmlnaW5hbCIsdGhpcy5nZXRTdHlsZSgiYmFja2dyb3VuZC1jb2xvciIpKTsKYT0oYT09InRyYW5zcGFyZW50Iik/IiNmZmYiOmE7fXZhciBiPXRoaXMuZ2V0KCJ0d2VlbiIpO2Iuc3RhcnQoImJhY2tncm91bmQtY29sb3IiLGN8fCIjZmZmZjg4IixhKS5jaGFpbihmdW5jdGlvbigpe3RoaXMuc2V0U3R5bGUoImJhY2tncm91bmQtY29sb3IiLHRoaXMucmV0cmlldmUoImhpZ2hsaWdodDpvcmlnaW5hbCIpKTsKYi5jYWxsQ2hhaW4oKTt9LmJpbmQodGhpcykpO3JldHVybiB0aGlzO319KTtGeC5Nb3JwaD1uZXcgQ2xhc3Moe0V4dGVuZHM6RnguQ1NTLGluaXRpYWxpemU6ZnVuY3Rpb24oYixhKXt0aGlzLmVsZW1lbnQ9dGhpcy5zdWJqZWN0PWRvY3VtZW50LmlkKGIpO3RoaXMucGFyZW50KGEpOwp9LHNldDpmdW5jdGlvbihhKXtpZih0eXBlb2YgYT09InN0cmluZyIpe2E9dGhpcy5zZWFyY2goYSk7fWZvcih2YXIgYiBpbiBhKXt0aGlzLnJlbmRlcih0aGlzLmVsZW1lbnQsYixhW2JdLHRoaXMub3B0aW9ucy51bml0KTt9cmV0dXJuIHRoaXM7fSxjb21wdXRlOmZ1bmN0aW9uKGUsZCxjKXt2YXIgYT17fTsKZm9yKHZhciBiIGluIGUpe2FbYl09dGhpcy5wYXJlbnQoZVtiXSxkW2JdLGMpO31yZXR1cm4gYTt9LHN0YXJ0OmZ1bmN0aW9uKGIpe2lmKCF0aGlzLmNoZWNrKGIpKXtyZXR1cm4gdGhpczt9aWYodHlwZW9mIGI9PSJzdHJpbmciKXtiPXRoaXMuc2VhcmNoKGIpO312YXIgZT17fSxkPXt9Owpmb3IodmFyIGMgaW4gYil7dmFyIGE9dGhpcy5wcmVwYXJlKHRoaXMuZWxlbWVudCxjLGJbY10pO2VbY109YS5mcm9tO2RbY109YS50bzt9cmV0dXJuIHRoaXMucGFyZW50KGUsZCk7fX0pO0VsZW1lbnQuUHJvcGVydGllcy5tb3JwaD17c2V0OmZ1bmN0aW9uKGEpe3RoaXMuZ2V0KCJtb3JwaCIpLmNhbmNlbCgpLnNldE9wdGlvbnMoYSk7CnJldHVybiB0aGlzO30sZ2V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yZXRyaWV2ZSgibW9ycGgiKTtpZighYSl7YT1uZXcgRnguTW9ycGgodGhpcyx7bGluazoiY2FuY2VsIn0pO3RoaXMuc3RvcmUoIm1vcnBoIixhKTt9cmV0dXJuIGE7fX07RWxlbWVudC5pbXBsZW1lbnQoe21vcnBoOmZ1bmN0aW9uKGEpe3RoaXMuZ2V0KCJtb3JwaCIpLnN0YXJ0KGEpOwpyZXR1cm4gdGhpczt9fSk7RnguaW1wbGVtZW50KHtnZXRUcmFuc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLnRyYW5zaXRpb258fEZ4LlRyYW5zaXRpb25zLlNpbmUuZWFzZUluT3V0O2lmKHR5cGVvZiBhPT0ic3RyaW5nIil7dmFyIGI9YS5zcGxpdCgiOiIpOwphPUZ4LlRyYW5zaXRpb25zO2E9YVtiWzBdXXx8YVtiWzBdLmNhcGl0YWxpemUoKV07aWYoYlsxXSl7YT1hWyJlYXNlIitiWzFdLmNhcGl0YWxpemUoKSsoYlsyXT9iWzJdLmNhcGl0YWxpemUoKToiIildO319cmV0dXJuIGE7fX0pO0Z4LlRyYW5zaXRpb249ZnVuY3Rpb24oYixhKXthPUFycmF5LmZyb20oYSk7CnJldHVybiBPYmplY3QuYXBwZW5kKGIse2Vhc2VJbjpmdW5jdGlvbihjKXtyZXR1cm4gYihjLGEpO30sZWFzZU91dDpmdW5jdGlvbihjKXtyZXR1cm4gMS1iKDEtYyxhKTt9LGVhc2VJbk91dDpmdW5jdGlvbihjKXtyZXR1cm4oYzw9MC41KT9iKDIqYyxhKS8yOigyLWIoMiooMS1jKSxhKSkvMjsKfX0pO307RnguVHJhbnNpdGlvbnM9e2xpbmVhcjpmdW5jdGlvbihhKXtyZXR1cm4gYTt9fTtGeC5UcmFuc2l0aW9ucz1uZXcgSGFzaChGeC5UcmFuc2l0aW9ucyk7RnguVHJhbnNpdGlvbnMuZXh0ZW5kPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKXtGeC5UcmFuc2l0aW9uc1tiXT1uZXcgRnguVHJhbnNpdGlvbihhW2JdKTsKfX07RnguVHJhbnNpdGlvbnMuZXh0ZW5kKHtQb3c6ZnVuY3Rpb24oYixhKXtyZXR1cm4gTWF0aC5wb3coYixhJiZhWzBdfHw2KTt9LEV4cG86ZnVuY3Rpb24oYSl7cmV0dXJuIE1hdGgucG93KDIsOCooYS0xKSk7fSxDaXJjOmZ1bmN0aW9uKGEpe3JldHVybiAxLU1hdGguc2luKE1hdGguYWNvcyhhKSk7Cn0sU2luZTpmdW5jdGlvbihhKXtyZXR1cm4gMS1NYXRoLnNpbigoMS1hKSpNYXRoLlBJLzIpO30sQmFjazpmdW5jdGlvbihiLGEpe2E9YSYmYVswXXx8MS42MTg7cmV0dXJuIE1hdGgucG93KGIsMikqKChhKzEpKmItYSk7fSxCb3VuY2U6ZnVuY3Rpb24oZil7dmFyIGU7CmZvcih2YXIgZD0wLGM9MTsxO2QrPWMsYy89Mil7aWYoZj49KDctNCpkKS8xMSl7ZT1jKmMtTWF0aC5wb3coKDExLTYqZC0xMSpmKS80LDIpO2JyZWFrO319cmV0dXJuIGU7fSxFbGFzdGljOmZ1bmN0aW9uKGIsYSl7cmV0dXJuIE1hdGgucG93KDIsMTAqLS1iKSpNYXRoLmNvcygyMCpiKk1hdGguUEkqKGEmJmFbMF18fDEpLzMpOwp9fSk7WyJRdWFkIiwiQ3ViaWMiLCJRdWFydCIsIlF1aW50Il0uZWFjaChmdW5jdGlvbihiLGEpe0Z4LlRyYW5zaXRpb25zW2JdPW5ldyBGeC5UcmFuc2l0aW9uKGZ1bmN0aW9uKGMpe3JldHVybiBNYXRoLnBvdyhjLFthKzJdKTt9KTt9KTsoZnVuY3Rpb24oKXt2YXIgYT0oIm9ucHJvZ3Jlc3MiIGluIG5ldyBCcm93c2VyLlJlcXVlc3QpOwp2YXIgYz10aGlzLlJlcXVlc3Q9bmV3IENsYXNzKHtJbXBsZW1lbnRzOltDaGFpbixFdmVudHMsT3B0aW9uc10sb3B0aW9uczp7dXJsOiIiLGRhdGE6IiIsaGVhZGVyczp7IlgtUmVxdWVzdGVkLVdpdGgiOiJYTUxIdHRwUmVxdWVzdCIsQWNjZXB0OiJ0ZXh0L2phdmFzY3JpcHQsIHRleHQvaHRtbCwgYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCwgKi8qIn0sYXN5bmM6dHJ1ZSxmb3JtYXQ6ZmFsc2UsbWV0aG9kOiJwb3N0IixsaW5rOiJpZ25vcmUiLGlzU3VjY2VzczpudWxsLGVtdWxhdGlvbjp0cnVlLHVybEVuY29kZWQ6dHJ1ZSxlbmNvZGluZzoidXRmLTgiLGV2YWxTY3JpcHRzOmZhbHNlLGV2YWxSZXNwb25zZTpmYWxzZSx0aW1lb3V0OjAsbm9DYWNoZTpmYWxzZX0saW5pdGlhbGl6ZTpmdW5jdGlvbihkKXt0aGlzLnhocj1uZXcgQnJvd3Nlci5SZXF1ZXN0KCk7CnRoaXMuc2V0T3B0aW9ucyhkKTt0aGlzLmhlYWRlcnM9dGhpcy5vcHRpb25zLmhlYWRlcnM7fSxvblN0YXRlQ2hhbmdlOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy54aHI7aWYoZC5yZWFkeVN0YXRlIT00fHwhdGhpcy5ydW5uaW5nKXtyZXR1cm47fXRoaXMucnVubmluZz1mYWxzZTsKdGhpcy5zdGF0dXM9MDtGdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7dmFyIGU9ZC5zdGF0dXM7dGhpcy5zdGF0dXM9KGU9PTEyMjMpPzIwNDplO30uYmluZCh0aGlzKSk7ZC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXt9O2NsZWFyVGltZW91dCh0aGlzLnRpbWVyKTsKdGhpcy5yZXNwb25zZT17dGV4dDp0aGlzLnhoci5yZXNwb25zZVRleHR8fCIiLHhtbDp0aGlzLnhoci5yZXNwb25zZVhNTH07aWYodGhpcy5vcHRpb25zLmlzU3VjY2Vzcy5jYWxsKHRoaXMsdGhpcy5zdGF0dXMpKXt0aGlzLnN1Y2Nlc3ModGhpcy5yZXNwb25zZS50ZXh0LHRoaXMucmVzcG9uc2UueG1sKTsKfWVsc2V7dGhpcy5mYWlsdXJlKCk7fX0saXNTdWNjZXNzOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5zdGF0dXM7cmV0dXJuKGQ+PTIwMCYmZDwzMDApO30saXNSdW5uaW5nOmZ1bmN0aW9uKCl7cmV0dXJuICEhdGhpcy5ydW5uaW5nO30scHJvY2Vzc1NjcmlwdHM6ZnVuY3Rpb24oZCl7aWYodGhpcy5vcHRpb25zLmV2YWxSZXNwb25zZXx8KC8oZWNtYXxqYXZhKXNjcmlwdC8pLnRlc3QodGhpcy5nZXRIZWFkZXIoIkNvbnRlbnQtdHlwZSIpKSl7cmV0dXJuIEJyb3dzZXIuZXhlYyhkKTsKfXJldHVybiBkLnN0cmlwU2NyaXB0cyh0aGlzLm9wdGlvbnMuZXZhbFNjcmlwdHMpO30sc3VjY2VzczpmdW5jdGlvbihlLGQpe3RoaXMub25TdWNjZXNzKHRoaXMucHJvY2Vzc1NjcmlwdHMoZSksZCk7fSxvblN1Y2Nlc3M6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiLGFyZ3VtZW50cykuZmlyZUV2ZW50KCJzdWNjZXNzIixhcmd1bWVudHMpLmNhbGxDaGFpbigpOwp9LGZhaWx1cmU6ZnVuY3Rpb24oKXt0aGlzLm9uRmFpbHVyZSgpO30sb25GYWlsdXJlOmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoImNvbXBsZXRlIikuZmlyZUV2ZW50KCJmYWlsdXJlIix0aGlzLnhocik7fSxsb2Fkc3RhcnQ6ZnVuY3Rpb24oZCl7dGhpcy5maXJlRXZlbnQoImxvYWRzdGFydCIsW2QsdGhpcy54aHJdKTsKfSxwcm9ncmVzczpmdW5jdGlvbihkKXt0aGlzLmZpcmVFdmVudCgicHJvZ3Jlc3MiLFtkLHRoaXMueGhyXSk7fSx0aW1lb3V0OmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoInRpbWVvdXQiLHRoaXMueGhyKTt9LHNldEhlYWRlcjpmdW5jdGlvbihkLGUpe3RoaXMuaGVhZGVyc1tkXT1lOwpyZXR1cm4gdGhpczt9LGdldEhlYWRlcjpmdW5jdGlvbihkKXtyZXR1cm4gRnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3JldHVybiB0aGlzLnhoci5nZXRSZXNwb25zZUhlYWRlcihkKTt9LmJpbmQodGhpcykpO30sY2hlY2s6ZnVuY3Rpb24oKXtpZighdGhpcy5ydW5uaW5nKXtyZXR1cm4gdHJ1ZTsKfXN3aXRjaCh0aGlzLm9wdGlvbnMubGluayl7Y2FzZSJjYW5jZWwiOnRoaXMuY2FuY2VsKCk7cmV0dXJuIHRydWU7Y2FzZSJjaGFpbiI6dGhpcy5jaGFpbih0aGlzLmNhbGxlci5wYXNzKGFyZ3VtZW50cyx0aGlzKSk7cmV0dXJuIGZhbHNlO31yZXR1cm4gZmFsc2U7fSxzZW5kOmZ1bmN0aW9uKG4pe2lmKCF0aGlzLmNoZWNrKG4pKXtyZXR1cm4gdGhpczsKfXRoaXMub3B0aW9ucy5pc1N1Y2Nlc3M9dGhpcy5vcHRpb25zLmlzU3VjY2Vzc3x8dGhpcy5pc1N1Y2Nlc3M7dGhpcy5ydW5uaW5nPXRydWU7dmFyIGs9dHlwZU9mKG4pO2lmKGs9PSJzdHJpbmcifHxrPT0iZWxlbWVudCIpe249e2RhdGE6bn07fXZhciBnPXRoaXMub3B0aW9uczsKbj1PYmplY3QuYXBwZW5kKHtkYXRhOmcuZGF0YSx1cmw6Zy51cmwsbWV0aG9kOmcubWV0aG9kfSxuKTt2YXIgaT1uLmRhdGEsZT1TdHJpbmcobi51cmwpLGQ9bi5tZXRob2QudG9Mb3dlckNhc2UoKTtzd2l0Y2godHlwZU9mKGkpKXtjYXNlImVsZW1lbnQiOmk9ZG9jdW1lbnQuaWQoaSkudG9RdWVyeVN0cmluZygpOwpicmVhaztjYXNlIm9iamVjdCI6Y2FzZSJoYXNoIjppPU9iamVjdC50b1F1ZXJ5U3RyaW5nKGkpO31pZih0aGlzLm9wdGlvbnMuZm9ybWF0KXt2YXIgbD0iZm9ybWF0PSIrdGhpcy5vcHRpb25zLmZvcm1hdDtpPShpKT9sKyImIitpOmw7fWlmKHRoaXMub3B0aW9ucy5lbXVsYXRpb24mJiFbImdldCIsInBvc3QiXS5jb250YWlucyhkKSl7dmFyIGo9Il9tZXRob2Q9IitkOwppPShpKT9qKyImIitpOmo7ZD0icG9zdCI7fWlmKHRoaXMub3B0aW9ucy51cmxFbmNvZGVkJiZbInBvc3QiLCJwdXQiXS5jb250YWlucyhkKSl7dmFyIGY9KHRoaXMub3B0aW9ucy5lbmNvZGluZyk/IjsgY2hhcnNldD0iK3RoaXMub3B0aW9ucy5lbmNvZGluZzoiIjt0aGlzLmhlYWRlcnNbIkNvbnRlbnQtdHlwZSJdPSJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiK2Y7Cn1pZighZSl7ZT1kb2N1bWVudC5sb2NhdGlvbi5wYXRobmFtZTt9dmFyIGg9ZS5sYXN0SW5kZXhPZigiLyIpO2lmKGg+LTEmJihoPWUuaW5kZXhPZigiIyIpKT4tMSl7ZT1lLnN1YnN0cigwLGgpO31pZih0aGlzLm9wdGlvbnMubm9DYWNoZSl7ZSs9KGUuY29udGFpbnMoIj8iKT8iJiI6Ij8iKStTdHJpbmcudW5pcXVlSUQoKTsKfWlmKGkmJmQ9PSJnZXQiKXtlKz0oZS5jb250YWlucygiPyIpPyImIjoiPyIpK2k7aT1udWxsO312YXIgbT10aGlzLnhocjtpZihhKXttLm9ubG9hZHN0YXJ0PXRoaXMubG9hZHN0YXJ0LmJpbmQodGhpcyk7bS5vbnByb2dyZXNzPXRoaXMucHJvZ3Jlc3MuYmluZCh0aGlzKTsKfW0ub3BlbihkLnRvVXBwZXJDYXNlKCksZSx0aGlzLm9wdGlvbnMuYXN5bmMsdGhpcy5vcHRpb25zLnVzZXIsdGhpcy5vcHRpb25zLnBhc3N3b3JkKTtpZih0aGlzLm9wdGlvbnMudXNlciYmIndpdGhDcmVkZW50aWFscyIgaW4gbSl7bS53aXRoQ3JlZGVudGlhbHM9dHJ1ZTsKfW0ub25yZWFkeXN0YXRlY2hhbmdlPXRoaXMub25TdGF0ZUNoYW5nZS5iaW5kKHRoaXMpO09iamVjdC5lYWNoKHRoaXMuaGVhZGVycyxmdW5jdGlvbihwLG8pe3RyeXttLnNldFJlcXVlc3RIZWFkZXIobyxwKTt9Y2F0Y2gocSl7dGhpcy5maXJlRXZlbnQoImV4Y2VwdGlvbiIsW28scF0pOwp9fSx0aGlzKTt0aGlzLmZpcmVFdmVudCgicmVxdWVzdCIpO20uc2VuZChpKTtpZighdGhpcy5vcHRpb25zLmFzeW5jKXt0aGlzLm9uU3RhdGVDaGFuZ2UoKTt9aWYodGhpcy5vcHRpb25zLnRpbWVvdXQpe3RoaXMudGltZXI9dGhpcy50aW1lb3V0LmRlbGF5KHRoaXMub3B0aW9ucy50aW1lb3V0LHRoaXMpOwp9cmV0dXJuIHRoaXM7fSxjYW5jZWw6ZnVuY3Rpb24oKXtpZighdGhpcy5ydW5uaW5nKXtyZXR1cm4gdGhpczt9dGhpcy5ydW5uaW5nPWZhbHNlO3ZhciBkPXRoaXMueGhyO2QuYWJvcnQoKTtjbGVhclRpbWVvdXQodGhpcy50aW1lcik7ZC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZC5vbnByb2dyZXNzPWQub25sb2Fkc3RhcnQ9ZnVuY3Rpb24oKXt9Owp0aGlzLnhocj1uZXcgQnJvd3Nlci5SZXF1ZXN0KCk7dGhpcy5maXJlRXZlbnQoImNhbmNlbCIpO3JldHVybiB0aGlzO319KTt2YXIgYj17fTtbImdldCIsInBvc3QiLCJwdXQiLCJkZWxldGUiLCJHRVQiLCJQT1NUIiwiUFVUIiwiREVMRVRFIl0uZWFjaChmdW5jdGlvbihkKXtiW2RdPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnNlbmQoe2RhdGE6ZSxtZXRob2Q6ZH0pOwp9O30pO2MuaW1wbGVtZW50KGIpO0VsZW1lbnQuUHJvcGVydGllcy5zZW5kPXtzZXQ6ZnVuY3Rpb24oZCl7dmFyIGU9dGhpcy5nZXQoInNlbmQiKS5jYW5jZWwoKTtlLnNldE9wdGlvbnMoZCk7cmV0dXJuIHRoaXM7fSxnZXQ6ZnVuY3Rpb24oKXt2YXIgZD10aGlzLnJldHJpZXZlKCJzZW5kIik7CmlmKCFkKXtkPW5ldyBjKHtkYXRhOnRoaXMsbGluazoiY2FuY2VsIixtZXRob2Q6dGhpcy5nZXQoIm1ldGhvZCIpfHwicG9zdCIsdXJsOnRoaXMuZ2V0KCJhY3Rpb24iKX0pO3RoaXMuc3RvcmUoInNlbmQiLGQpO31yZXR1cm4gZDt9fTtFbGVtZW50LmltcGxlbWVudCh7c2VuZDpmdW5jdGlvbihkKXt2YXIgZT10aGlzLmdldCgic2VuZCIpOwplLnNlbmQoe2RhdGE6dGhpcyx1cmw6ZHx8ZS5vcHRpb25zLnVybH0pO3JldHVybiB0aGlzO319KTt9KSgpO1JlcXVlc3QuSFRNTD1uZXcgQ2xhc3Moe0V4dGVuZHM6UmVxdWVzdCxvcHRpb25zOnt1cGRhdGU6ZmFsc2UsYXBwZW5kOmZhbHNlLGV2YWxTY3JpcHRzOnRydWUsZmlsdGVyOmZhbHNlLGhlYWRlcnM6e0FjY2VwdDoidGV4dC9odG1sLCBhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sLCAqLyoifX0sc3VjY2VzczpmdW5jdGlvbihlKXt2YXIgZD10aGlzLm9wdGlvbnMsYj10aGlzLnJlc3BvbnNlOwpiLmh0bWw9ZS5zdHJpcFNjcmlwdHMoZnVuY3Rpb24oZil7Yi5qYXZhc2NyaXB0PWY7fSk7dmFyIGM9Yi5odG1sLm1hdGNoKC88Ym9keVtePl0qPihbXHNcU10qPyk8XC9ib2R5Pi9pKTtpZihjKXtiLmh0bWw9Y1sxXTt9dmFyIGE9bmV3IEVsZW1lbnQoImRpdiIpLnNldCgiaHRtbCIsYi5odG1sKTsKYi50cmVlPWEuY2hpbGROb2RlcztiLmVsZW1lbnRzPWEuZ2V0RWxlbWVudHMoIioiKTtpZihkLmZpbHRlcil7Yi50cmVlPWIuZWxlbWVudHMuZmlsdGVyKGQuZmlsdGVyKTt9aWYoZC51cGRhdGUpe2RvY3VtZW50LmlkKGQudXBkYXRlKS5lbXB0eSgpLnNldCgiaHRtbCIsYi5odG1sKTsKfWVsc2V7aWYoZC5hcHBlbmQpe2RvY3VtZW50LmlkKGQuYXBwZW5kKS5hZG9wdChhLmdldENoaWxkcmVuKCkpO319aWYoZC5ldmFsU2NyaXB0cyl7QnJvd3Nlci5leGVjKGIuamF2YXNjcmlwdCk7fXRoaXMub25TdWNjZXNzKGIudHJlZSxiLmVsZW1lbnRzLGIuaHRtbCxiLmphdmFzY3JpcHQpOwp9fSk7RWxlbWVudC5Qcm9wZXJ0aWVzLmxvYWQ9e3NldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmdldCgibG9hZCIpLmNhbmNlbCgpO2Iuc2V0T3B0aW9ucyhhKTtyZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbigpe3ZhciBhPXRoaXMucmV0cmlldmUoImxvYWQiKTtpZighYSl7YT1uZXcgUmVxdWVzdC5IVE1MKHtkYXRhOnRoaXMsbGluazoiY2FuY2VsIix1cGRhdGU6dGhpcyxtZXRob2Q6ImdldCJ9KTsKdGhpcy5zdG9yZSgibG9hZCIsYSk7fXJldHVybiBhO319O0VsZW1lbnQuaW1wbGVtZW50KHtsb2FkOmZ1bmN0aW9uKCl7dGhpcy5nZXQoImxvYWQiKS5zZW5kKEFycmF5LmxpbmsoYXJndW1lbnRzLHtkYXRhOlR5cGUuaXNPYmplY3QsdXJsOlR5cGUuaXNTdHJpbmd9KSk7CnJldHVybiB0aGlzO319KTtpZighdGhpcy5KU09OKXt0aGlzLkpTT049e307fUpTT049bmV3IEhhc2goe3N0cmluZ2lmeTpKU09OLnN0cmluZ2lmeSxwYXJzZTpKU09OLnBhcnNlfSk7T2JqZWN0LmFwcGVuZChKU09OLHskc3BlY2lhbENoYXJzOnsiXGIiOiJcXGIiLCJcdCI6IlxcdCIsIlxuIjoiXFxuIiwiXGYiOiJcXGYiLCJcciI6IlxcciIsJyInOidcXCInLCJcXCI6IlxcXFwifSwkcmVwbGFjZUNoYXJzOmZ1bmN0aW9uKGEpe3JldHVybiBKU09OLiRzcGVjaWFsQ2hhcnNbYV18fCJcXHUwMCIrTWF0aC5mbG9vcihhLmNoYXJDb2RlQXQoKS8xNikudG9TdHJpbmcoMTYpKyhhLmNoYXJDb2RlQXQoKSUxNikudG9TdHJpbmcoMTYpOwp9LGVuY29kZTpmdW5jdGlvbihiKXtzd2l0Y2godHlwZU9mKGIpKXtjYXNlInN0cmluZyI6cmV0dXJuJyInK2IucmVwbGFjZSgvW1x4MDAtXHgxZlxcIl0vZyxKU09OLiRyZXBsYWNlQ2hhcnMpKyciJztjYXNlImFycmF5IjpyZXR1cm4iWyIrU3RyaW5nKGIubWFwKEpTT04uZW5jb2RlKS5jbGVhbigpKSsiXSI7CmNhc2Uib2JqZWN0IjpjYXNlImhhc2giOnZhciBhPVtdO09iamVjdC5lYWNoKGIsZnVuY3Rpb24oZSxkKXt2YXIgYz1KU09OLmVuY29kZShlKTtpZihjKXthLnB1c2goSlNPTi5lbmNvZGUoZCkrIjoiK2MpO319KTtyZXR1cm4ieyIrYSsifSI7Y2FzZSJudW1iZXIiOmNhc2UiYm9vbGVhbiI6cmV0dXJuIFN0cmluZyhiKTsKY2FzZSJudWxsIjpyZXR1cm4ibnVsbCI7fXJldHVybiBudWxsO30sZGVjb2RlOmZ1bmN0aW9uKHN0cmluZyxzZWN1cmUpe2lmKHR5cGVPZihzdHJpbmcpIT0ic3RyaW5nInx8IXN0cmluZy5sZW5ndGgpe3JldHVybiBudWxsO31pZihzZWN1cmUmJiEoL15bLDp7fVxbXF0wLTkuXC0rRWFlZmxuci11IFxuXHJcdF0qJC8pLnRlc3Qoc3RyaW5nLnJlcGxhY2UoL1xcLi9nLCJAIikucmVwbGFjZSgvIlteIlxcXG5ccl0qIi9nLCIiKSkpe3JldHVybiBudWxsOwp9cmV0dXJuIGV2YWwoIigiK3N0cmluZysiKSIpO319KTtSZXF1ZXN0LkpTT049bmV3IENsYXNzKHtFeHRlbmRzOlJlcXVlc3Qsb3B0aW9uczp7c2VjdXJlOnRydWV9LGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnQoYSk7T2JqZWN0LmFwcGVuZCh0aGlzLmhlYWRlcnMse0FjY2VwdDoiYXBwbGljYXRpb24vanNvbiIsIlgtUmVxdWVzdCI6IkpTT04ifSk7Cn0sc3VjY2VzczpmdW5jdGlvbihjKXt2YXIgYj10aGlzLm9wdGlvbnMuc2VjdXJlO3ZhciBhPXRoaXMucmVzcG9uc2UuanNvbj1GdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7cmV0dXJuIEpTT04uZGVjb2RlKGMsYik7fSk7aWYoYT09bnVsbCl7dGhpcy5vbkZhaWx1cmUoKTsKfWVsc2V7dGhpcy5vblN1Y2Nlc3MoYSxjKTt9fX0pO3ZhciBDb29raWU9bmV3IENsYXNzKHtJbXBsZW1lbnRzOk9wdGlvbnMsb3B0aW9uczp7cGF0aDoiLyIsZG9tYWluOmZhbHNlLGR1cmF0aW9uOmZhbHNlLHNlY3VyZTpmYWxzZSxkb2N1bWVudDpkb2N1bWVudCxlbmNvZGU6dHJ1ZX0saW5pdGlhbGl6ZTpmdW5jdGlvbihiLGEpe3RoaXMua2V5PWI7CnRoaXMuc2V0T3B0aW9ucyhhKTt9LHdyaXRlOmZ1bmN0aW9uKGIpe2lmKHRoaXMub3B0aW9ucy5lbmNvZGUpe2I9ZW5jb2RlVVJJQ29tcG9uZW50KGIpO31pZih0aGlzLm9wdGlvbnMuZG9tYWluKXtiKz0iOyBkb21haW49Iit0aGlzLm9wdGlvbnMuZG9tYWluO31pZih0aGlzLm9wdGlvbnMucGF0aCl7Yis9IjsgcGF0aD0iK3RoaXMub3B0aW9ucy5wYXRoOwp9aWYodGhpcy5vcHRpb25zLmR1cmF0aW9uKXt2YXIgYT1uZXcgRGF0ZSgpO2Euc2V0VGltZShhLmdldFRpbWUoKSt0aGlzLm9wdGlvbnMuZHVyYXRpb24qMjQqNjAqNjAqMTAwMCk7Yis9IjsgZXhwaXJlcz0iK2EudG9HTVRTdHJpbmcoKTt9aWYodGhpcy5vcHRpb25zLnNlY3VyZSl7Yis9Ijsgc2VjdXJlIjsKfXRoaXMub3B0aW9ucy5kb2N1bWVudC5jb29raWU9dGhpcy5rZXkrIj0iK2I7cmV0dXJuIHRoaXM7fSxyZWFkOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmRvY3VtZW50LmNvb2tpZS5tYXRjaCgiKD86Xnw7KVxccyoiK3RoaXMua2V5LmVzY2FwZVJlZ0V4cCgpKyI9KFteO10qKSIpOwpyZXR1cm4oYSk/ZGVjb2RlVVJJQ29tcG9uZW50KGFbMV0pOm51bGw7fSxkaXNwb3NlOmZ1bmN0aW9uKCl7bmV3IENvb2tpZSh0aGlzLmtleSxPYmplY3QubWVyZ2Uoe30sdGhpcy5vcHRpb25zLHtkdXJhdGlvbjotMX0pKS53cml0ZSgiIik7cmV0dXJuIHRoaXM7fX0pOwpDb29raWUud3JpdGU9ZnVuY3Rpb24oYixjLGEpe3JldHVybiBuZXcgQ29va2llKGIsYSkud3JpdGUoYyk7fTtDb29raWUucmVhZD1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IENvb2tpZShhKS5yZWFkKCk7fTtDb29raWUuZGlzcG9zZT1mdW5jdGlvbihiLGEpe3JldHVybiBuZXcgQ29va2llKGIsYSkuZGlzcG9zZSgpOwp9OyhmdW5jdGlvbihqLGwpe3ZhciBtLGcsZj1bXSxjLGIsbj10cnVlO3RyeXtuPWouZnJhbWVFbGVtZW50IT1udWxsO31jYXRjaChpKXt9dmFyIGg9ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoYik7aWYobSl7cmV0dXJuO31Ccm93c2VyLmxvYWRlZD1tPXRydWU7bC5yZW1vdmVMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsaCkucmVtb3ZlTGlzdGVuZXIoInJlYWR5c3RhdGVjaGFuZ2UiLGEpOwpsLmZpcmVFdmVudCgiZG9tcmVhZHkiKTtqLmZpcmVFdmVudCgiZG9tcmVhZHkiKTt9O3ZhciBhPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPWYubGVuZ3RoO2UtLTspe2lmKGZbZV0oKSl7aCgpO3JldHVybiB0cnVlO319cmV0dXJuIGZhbHNlO307dmFyIGs9ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoYik7CmlmKCFhKCkpe2I9c2V0VGltZW91dChrLDEwKTt9fTtsLmFkZExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixoKTt2YXIgZD1sLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2lmKGQuZG9TY3JvbGwmJiFuKXtmLnB1c2goZnVuY3Rpb24oKXt0cnl7ZC5kb1Njcm9sbCgpO3JldHVybiB0cnVlOwp9Y2F0Y2gobyl7fXJldHVybiBmYWxzZTt9KTtjPXRydWU7fWlmKGwucmVhZHlTdGF0ZSl7Zi5wdXNoKGZ1bmN0aW9uKCl7dmFyIGU9bC5yZWFkeVN0YXRlO3JldHVybihlPT0ibG9hZGVkInx8ZT09ImNvbXBsZXRlIik7fSk7fWlmKCJvbnJlYWR5c3RhdGVjaGFuZ2UiIGluIGwpe2wuYWRkTGlzdGVuZXIoInJlYWR5c3RhdGVjaGFuZ2UiLGEpOwp9ZWxzZXtjPXRydWU7fWlmKGMpe2soKTt9RWxlbWVudC5FdmVudHMuZG9tcmVhZHk9e29uQWRkOmZ1bmN0aW9uKGUpe2lmKG0pe2UuY2FsbCh0aGlzKTt9fX07RWxlbWVudC5FdmVudHMubG9hZD17YmFzZToibG9hZCIsb25BZGQ6ZnVuY3Rpb24oZSl7aWYoZyYmdGhpcz09ail7ZS5jYWxsKHRoaXMpOwp9fSxjb25kaXRpb246ZnVuY3Rpb24oKXtpZih0aGlzPT1qKXtoKCk7ZGVsZXRlIEVsZW1lbnQuRXZlbnRzLmxvYWQ7fXJldHVybiB0cnVlO319O2ouYWRkRXZlbnQoImxvYWQiLGZ1bmN0aW9uKCl7Zz10cnVlO30pO30pKHdpbmRvdyxkb2N1bWVudCk7KGZ1bmN0aW9uKCl7dmFyIGlkPTA7CnZhciBTd2lmZj10aGlzLlN3aWZmPW5ldyBDbGFzcyh7SW1wbGVtZW50czpPcHRpb25zLG9wdGlvbnM6e2lkOm51bGwsaGVpZ2h0OjEsd2lkdGg6MSxjb250YWluZXI6bnVsbCxwcm9wZXJ0aWVzOnt9LHBhcmFtczp7cXVhbGl0eToiaGlnaCIsYWxsb3dTY3JpcHRBY2Nlc3M6ImFsd2F5cyIsd01vZGU6IndpbmRvdyIsc3dMaXZlQ29ubmVjdDp0cnVlfSxjYWxsQmFja3M6e30sdmFyczp7fX0sdG9FbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub2JqZWN0Owp9LGluaXRpYWxpemU6ZnVuY3Rpb24ocGF0aCxvcHRpb25zKXt0aGlzLmluc3RhbmNlPSJTd2lmZl8iK2lkKys7dGhpcy5zZXRPcHRpb25zKG9wdGlvbnMpO29wdGlvbnM9dGhpcy5vcHRpb25zO3ZhciBpZD10aGlzLmlkPW9wdGlvbnMuaWR8fHRoaXMuaW5zdGFuY2U7CnZhciBjb250YWluZXI9ZG9jdW1lbnQuaWQob3B0aW9ucy5jb250YWluZXIpO1N3aWZmLkNhbGxCYWNrc1t0aGlzLmluc3RhbmNlXT17fTt2YXIgcGFyYW1zPW9wdGlvbnMucGFyYW1zLHZhcnM9b3B0aW9ucy52YXJzLGNhbGxCYWNrcz1vcHRpb25zLmNhbGxCYWNrczsKdmFyIHByb3BlcnRpZXM9T2JqZWN0LmFwcGVuZCh7aGVpZ2h0Om9wdGlvbnMuaGVpZ2h0LHdpZHRoOm9wdGlvbnMud2lkdGh9LG9wdGlvbnMucHJvcGVydGllcyk7dmFyIHNlbGY9dGhpcztmb3IodmFyIGNhbGxCYWNrIGluIGNhbGxCYWNrcyl7U3dpZmYuQ2FsbEJhY2tzW3RoaXMuaW5zdGFuY2VdW2NhbGxCYWNrXT0oZnVuY3Rpb24ob3B0aW9uKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gb3B0aW9uLmFwcGx5KHNlbGYub2JqZWN0LGFyZ3VtZW50cyk7Cn07fSkoY2FsbEJhY2tzW2NhbGxCYWNrXSk7dmFyc1tjYWxsQmFja109IlN3aWZmLkNhbGxCYWNrcy4iK3RoaXMuaW5zdGFuY2UrIi4iK2NhbGxCYWNrO31wYXJhbXMuZmxhc2hWYXJzPU9iamVjdC50b1F1ZXJ5U3RyaW5nKHZhcnMpO2lmKEJyb3dzZXIuaWUpe3Byb3BlcnRpZXMuY2xhc3NpZD0iY2xzaWQ6RDI3Q0RCNkUtQUU2RC0xMWNmLTk2QjgtNDQ0NTUzNTQwMDAwIjsKcGFyYW1zLm1vdmllPXBhdGg7fWVsc2V7cHJvcGVydGllcy50eXBlPSJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaCI7fXByb3BlcnRpZXMuZGF0YT1wYXRoO3ZhciBidWlsZD0nPG9iamVjdCBpZD0iJytpZCsnIic7Zm9yKHZhciBwcm9wZXJ0eSBpbiBwcm9wZXJ0aWVzKXtidWlsZCs9IiAiK3Byb3BlcnR5Kyc9IicrcHJvcGVydGllc1twcm9wZXJ0eV0rJyInOwp9YnVpbGQrPSI+Ijtmb3IodmFyIHBhcmFtIGluIHBhcmFtcyl7aWYocGFyYW1zW3BhcmFtXSl7YnVpbGQrPSc8cGFyYW0gbmFtZT0iJytwYXJhbSsnIiB2YWx1ZT0iJytwYXJhbXNbcGFyYW1dKyciIC8+Jzt9fWJ1aWxkKz0iPC9vYmplY3Q+Ijt0aGlzLm9iamVjdD0oKGNvbnRhaW5lcik/Y29udGFpbmVyLmVtcHR5KCk6bmV3IEVsZW1lbnQoImRpdiIpKS5zZXQoImh0bWwiLGJ1aWxkKS5maXJzdENoaWxkOwp9LHJlcGxhY2VzOmZ1bmN0aW9uKGVsZW1lbnQpe2VsZW1lbnQ9ZG9jdW1lbnQuaWQoZWxlbWVudCx0cnVlKTtlbGVtZW50LnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHRoaXMudG9FbGVtZW50KCksZWxlbWVudCk7cmV0dXJuIHRoaXM7fSxpbmplY3Q6ZnVuY3Rpb24oZWxlbWVudCl7ZG9jdW1lbnQuaWQoZWxlbWVudCx0cnVlKS5hcHBlbmRDaGlsZCh0aGlzLnRvRWxlbWVudCgpKTsKcmV0dXJuIHRoaXM7fSxyZW1vdGU6ZnVuY3Rpb24oKXtyZXR1cm4gU3dpZmYucmVtb3RlLmFwcGx5KFN3aWZmLFt0aGlzLnRvRWxlbWVudCgpXS5leHRlbmQoYXJndW1lbnRzKSk7fX0pO1N3aWZmLkNhbGxCYWNrcz17fTtTd2lmZi5yZW1vdGU9ZnVuY3Rpb24ob2JqLGZuKXt2YXIgcnM9b2JqLkNhbGxGdW5jdGlvbignPGludm9rZSBuYW1lPSInK2ZuKyciIHJldHVybnR5cGU9ImphdmFzY3JpcHQiPicrX19mbGFzaF9fYXJndW1lbnRzVG9YTUwoYXJndW1lbnRzLDIpKyI8L2ludm9rZT4iKTsKcmV0dXJuIGV2YWwocnMpO307fSkoKTs=",
                "body": "LyoKLS0tCk1vb1Rvb2xzOiB0aGUgamF2YXNjcmlwdCBmcmFtZXdvcmsKCndlYiBidWlsZDoKIC0gaHR0cDovL21vb3Rvb2xzLm5ldC9jb3JlLzdjNTZjZmVmOWRkZGNmMTcwYTVkNjhlM2ZiNjFjZmQ3CgpwYWNrYWdlciBidWlsZDoKIC0gcGFja2FnZXIgYnVpbGQgQ29yZS9Db3JlIENvcmUvQXJyYXkgQ29yZS9TdHJpbmcgQ29yZS9OdW1iZXIgQ29yZS9GdW5jdGlvbiBDb3JlL09iamVjdCBDb3JlL0V2ZW50IENvcmUvQnJvd3NlciBDb3JlL0NsYXNzIENvcmUvQ2xhc3MuRXh0cmFzIENvcmUvU2xpY2suUGFyc2VyIENvcmUvU2xpY2suRmluZGVyIENvcmUvRWxlbWVudCBDb3JlL0VsZW1lbnQuU3R5bGUgQ29yZS9FbGVtZW50LkV2ZW50IENvcmUvRWxlbWVudC5EaW1lbnNpb25zIENvcmUvRnggQ29yZS9GeC5DU1MgQ29yZS9GeC5Ud2VlbiBDb3JlL0Z4Lk1vcnBoIENvcmUvRnguVHJhbnNpdGlvbnMgQ29yZS9SZXF1ZXN0IENvcmUvUmVxdWVzdC5IVE1MIENvcmUvUmVxdWVzdC5KU09OIENvcmUvQ29va2llIENvcmUvSlNPTiBDb3JlL0RPTVJlYWR5IENvcmUvU3dpZmYKCmNvcHlyaWdodHM6CiAgLSBbTW9vVG9vbHNdKGh0dHA6Ly9tb290b29scy5uZXQpCgpsaWNlbnNlczoKICAtIFtNSVQgTGljZW5zZV0oaHR0cDovL21vb3Rvb2xzLm5ldC9saWNlbnNlLnR4dCkKLi4uCiovCihmdW5jdGlvbigpe3RoaXMuTW9vVG9vbHM9e3ZlcnNpb246IjEuMyIsYnVpbGQ6ImEzZWVkNjkyZGQ4NTA1MGQ4MDE2OGVjMmM3MDhlZmU5MDFiYjdkYjMifTt2YXIgZT10aGlzLnR5cGVPZj1mdW5jdGlvbihpKXtpZihpPT1udWxsKXtyZXR1cm4ibnVsbCI7fWlmKGkuJGZhbWlseSl7cmV0dXJuIGkuJGZhbWlseSgpOwp9aWYoaS5ub2RlTmFtZSl7aWYoaS5ub2RlVHlwZT09MSl7cmV0dXJuImVsZW1lbnQiO31pZihpLm5vZGVUeXBlPT0zKXtyZXR1cm4oL1xTLykudGVzdChpLm5vZGVWYWx1ZSk/InRleHRub2RlIjoid2hpdGVzcGFjZSI7fX1lbHNle2lmKHR5cGVvZiBpLmxlbmd0aD09Im51bWJlciIpe2lmKGkuY2FsbGVlKXtyZXR1cm4iYXJndW1lbnRzIjsKfWlmKCJpdGVtIiBpbiBpKXtyZXR1cm4iY29sbGVjdGlvbiI7fX19cmV0dXJuIHR5cGVvZiBpO307dmFyIHQ9dGhpcy5pbnN0YW5jZU9mPWZ1bmN0aW9uKHYsaSl7aWYodj09bnVsbCl7cmV0dXJuIGZhbHNlO312YXIgdT12LiRjb25zdHJ1Y3Rvcnx8di5jb25zdHJ1Y3RvcjsKd2hpbGUodSl7aWYodT09PWkpe3JldHVybiB0cnVlO311PXUucGFyZW50O31yZXR1cm4gdiBpbnN0YW5jZW9mIGk7fTt2YXIgZj10aGlzLkZ1bmN0aW9uO3ZhciBxPXRydWU7Zm9yKHZhciBwIGluIHt0b1N0cmluZzoxfSl7cT1udWxsO31pZihxKXtxPVsiaGFzT3duUHJvcGVydHkiLCJ2YWx1ZU9mIiwiaXNQcm90b3R5cGVPZiIsInByb3BlcnR5SXNFbnVtZXJhYmxlIiwidG9Mb2NhbGVTdHJpbmciLCJ0b1N0cmluZyIsImNvbnN0cnVjdG9yIl07Cn1mLnByb3RvdHlwZS5vdmVybG9hZFNldHRlcj1mdW5jdGlvbih1KXt2YXIgaT10aGlzO3JldHVybiBmdW5jdGlvbih3LHYpe2lmKHc9PW51bGwpe3JldHVybiB0aGlzO31pZih1fHx0eXBlb2YgdyE9InN0cmluZyIpe2Zvcih2YXIgeCBpbiB3KXtpLmNhbGwodGhpcyx4LHdbeF0pOwp9aWYocSl7Zm9yKHZhciB5PXEubGVuZ3RoO3ktLTspe3g9cVt5XTtpZih3Lmhhc093blByb3BlcnR5KHgpKXtpLmNhbGwodGhpcyx4LHdbeF0pO319fX1lbHNle2kuY2FsbCh0aGlzLHcsdik7fXJldHVybiB0aGlzO307fTtmLnByb3RvdHlwZS5vdmVybG9hZEdldHRlcj1mdW5jdGlvbih1KXt2YXIgaT10aGlzOwpyZXR1cm4gZnVuY3Rpb24odyl7dmFyIHgsdjtpZih1fHx0eXBlb2YgdyE9InN0cmluZyIpe3g9dzt9ZWxzZXtpZihhcmd1bWVudHMubGVuZ3RoPjEpe3g9YXJndW1lbnRzO319aWYoeCl7dj17fTtmb3IodmFyIHk9MDt5PHgubGVuZ3RoO3krKyl7dlt4W3ldXT1pLmNhbGwodGhpcyx4W3ldKTsKfX1lbHNle3Y9aS5jYWxsKHRoaXMsdyk7fXJldHVybiB2O307fTtmLnByb3RvdHlwZS5leHRlbmQ9ZnVuY3Rpb24oaSx1KXt0aGlzW2ldPXU7fS5vdmVybG9hZFNldHRlcigpO2YucHJvdG90eXBlLmltcGxlbWVudD1mdW5jdGlvbihpLHUpe3RoaXMucHJvdG90eXBlW2ldPXU7Cn0ub3ZlcmxvYWRTZXR0ZXIoKTt2YXIgbj1BcnJheS5wcm90b3R5cGUuc2xpY2U7Zi5mcm9tPWZ1bmN0aW9uKGkpe3JldHVybihlKGkpPT0iZnVuY3Rpb24iKT9pOmZ1bmN0aW9uKCl7cmV0dXJuIGk7fTt9O0FycmF5LmZyb209ZnVuY3Rpb24oaSl7aWYoaT09bnVsbCl7cmV0dXJuW107Cn1yZXR1cm4oay5pc0VudW1lcmFibGUoaSkmJnR5cGVvZiBpIT0ic3RyaW5nIik/KGUoaSk9PSJhcnJheSIpP2k6bi5jYWxsKGkpOltpXTt9O051bWJlci5mcm9tPWZ1bmN0aW9uKHUpe3ZhciBpPXBhcnNlRmxvYXQodSk7cmV0dXJuIGlzRmluaXRlKGkpP2k6bnVsbDsKfTtTdHJpbmcuZnJvbT1mdW5jdGlvbihpKXtyZXR1cm4gaSsiIjt9O2YuaW1wbGVtZW50KHtoaWRlOmZ1bmN0aW9uKCl7dGhpcy4kaGlkZGVuPXRydWU7cmV0dXJuIHRoaXM7fSxwcm90ZWN0OmZ1bmN0aW9uKCl7dGhpcy4kcHJvdGVjdGVkPXRydWU7cmV0dXJuIHRoaXM7Cn19KTt2YXIgaz10aGlzLlR5cGU9ZnVuY3Rpb24odyx2KXtpZih3KXt2YXIgdT13LnRvTG93ZXJDYXNlKCk7dmFyIGk9ZnVuY3Rpb24oeCl7cmV0dXJuKGUoeCk9PXUpO307a1siaXMiK3ddPWk7aWYodiE9bnVsbCl7di5wcm90b3R5cGUuJGZhbWlseT0oZnVuY3Rpb24oKXtyZXR1cm4gdTsKfSkuaGlkZSgpO3YudHlwZT1pO319aWYodj09bnVsbCl7cmV0dXJuIG51bGw7fXYuZXh0ZW5kKHRoaXMpO3YuJGNvbnN0cnVjdG9yPWs7di5wcm90b3R5cGUuJGNvbnN0cnVjdG9yPXY7cmV0dXJuIHY7fTt2YXIgbz1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO2suaXNFbnVtZXJhYmxlPWZ1bmN0aW9uKGkpe3JldHVybihpIT1udWxsJiZ0eXBlb2YgaS5sZW5ndGg9PSJudW1iZXIiJiZvLmNhbGwoaSkhPSJbb2JqZWN0IEZ1bmN0aW9uXSIpOwp9O3ZhciBiPXt9O3ZhciBkPWZ1bmN0aW9uKGkpe3ZhciB1PWUoaS5wcm90b3R5cGUpO3JldHVybiBiW3VdfHwoYlt1XT1bXSk7fTt2YXIgaD1mdW5jdGlvbih2LHope2lmKHomJnouJGhpZGRlbil7cmV0dXJuIHRoaXM7fXZhciB1PWQodGhpcyk7Zm9yKHZhciB3PTA7Cnc8dS5sZW5ndGg7dysrKXt2YXIgeT11W3ddO2lmKGUoeSk9PSJ0eXBlIil7aC5jYWxsKHksdix6KTt9ZWxzZXt5LmNhbGwodGhpcyx2LHopO319dmFyIHg9dGhpcy5wcm90b3R5cGVbdl07aWYoeD09bnVsbHx8IXguJHByb3RlY3RlZCl7dGhpcy5wcm90b3R5cGVbdl09ejsKfWlmKHRoaXNbdl09PW51bGwmJmUoeik9PSJmdW5jdGlvbiIpe3MuY2FsbCh0aGlzLHYsZnVuY3Rpb24oaSl7cmV0dXJuIHouYXBwbHkoaSxuLmNhbGwoYXJndW1lbnRzLDEpKTt9KTt9cmV0dXJuIHRoaXM7fTt2YXIgcz1mdW5jdGlvbihpLHYpe2lmKHYmJnYuJGhpZGRlbil7cmV0dXJuIHRoaXM7Cn12YXIgdT10aGlzW2ldO2lmKHU9PW51bGx8fCF1LiRwcm90ZWN0ZWQpe3RoaXNbaV09djt9cmV0dXJuIHRoaXM7fTtrLmltcGxlbWVudCh7aW1wbGVtZW50Omgub3ZlcmxvYWRTZXR0ZXIoKSxleHRlbmQ6cy5vdmVybG9hZFNldHRlcigpLGFsaWFzOmZ1bmN0aW9uKGksdSl7aC5jYWxsKHRoaXMsaSx0aGlzLnByb3RvdHlwZVt1XSk7Cn0ub3ZlcmxvYWRTZXR0ZXIoKSxtaXJyb3I6ZnVuY3Rpb24oaSl7ZCh0aGlzKS5wdXNoKGkpO3JldHVybiB0aGlzO319KTtuZXcgaygiVHlwZSIsayk7dmFyIGM9ZnVuY3Rpb24odSx5LHcpe3ZhciB2PSh5IT1PYmplY3QpLEM9eS5wcm90b3R5cGU7aWYodil7eT1uZXcgayh1LHkpOwp9Zm9yKHZhciB6PTAseD13Lmxlbmd0aDt6PHg7eisrKXt2YXIgRD13W3pdLEI9eVtEXSxBPUNbRF07aWYoQil7Qi5wcm90ZWN0KCk7fWlmKHYmJkEpe2RlbGV0ZSBDW0RdO0NbRF09QS5wcm90ZWN0KCk7fX1pZih2KXt5LmltcGxlbWVudChDKTt9cmV0dXJuIGM7fTtjKCJTdHJpbmciLFN0cmluZyxbImNoYXJBdCIsImNoYXJDb2RlQXQiLCJjb25jYXQiLCJpbmRleE9mIiwibGFzdEluZGV4T2YiLCJtYXRjaCIsInF1b3RlIiwicmVwbGFjZSIsInNlYXJjaCIsInNsaWNlIiwic3BsaXQiLCJzdWJzdHIiLCJzdWJzdHJpbmciLCJ0b0xvd2VyQ2FzZSIsInRvVXBwZXJDYXNlIl0pKCJBcnJheSIsQXJyYXksWyJwb3AiLCJwdXNoIiwicmV2ZXJzZSIsInNoaWZ0Iiwic29ydCIsInNwbGljZSIsInVuc2hpZnQiLCJjb25jYXQiLCJqb2luIiwic2xpY2UiLCJpbmRleE9mIiwibGFzdEluZGV4T2YiLCJmaWx0ZXIiLCJmb3JFYWNoIiwiZXZlcnkiLCJtYXAiLCJzb21lIiwicmVkdWNlIiwicmVkdWNlUmlnaHQiXSkoIk51bWJlciIsTnVtYmVyLFsidG9FeHBvbmVudGlhbCIsInRvRml4ZWQiLCJ0b0xvY2FsZVN0cmluZyIsInRvUHJlY2lzaW9uIl0pKCJGdW5jdGlvbiIsZixbImFwcGx5IiwiY2FsbCIsImJpbmQiXSkoIlJlZ0V4cCIsUmVnRXhwLFsiZXhlYyIsInRlc3QiXSkoIk9iamVjdCIsT2JqZWN0LFsiY3JlYXRlIiwiZGVmaW5lUHJvcGVydHkiLCJkZWZpbmVQcm9wZXJ0aWVzIiwia2V5cyIsImdldFByb3RvdHlwZU9mIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsInByZXZlbnRFeHRlbnNpb25zIiwiaXNFeHRlbnNpYmxlIiwic2VhbCIsImlzU2VhbGVkIiwiZnJlZXplIiwiaXNGcm96ZW4iXSkoIkRhdGUiLERhdGUsWyJub3ciXSk7Ck9iamVjdC5leHRlbmQ9cy5vdmVybG9hZFNldHRlcigpO0RhdGUuZXh0ZW5kKCJub3ciLGZ1bmN0aW9uKCl7cmV0dXJuICsobmV3IERhdGUpO30pO25ldyBrKCJCb29sZWFuIixCb29sZWFuKTtOdW1iZXIucHJvdG90eXBlLiRmYW1pbHk9ZnVuY3Rpb24oKXtyZXR1cm4gaXNGaW5pdGUodGhpcyk/Im51bWJlciI6Im51bGwiOwp9LmhpZGUoKTtOdW1iZXIuZXh0ZW5kKCJyYW5kb20iLGZ1bmN0aW9uKHUsaSl7cmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSooaS11KzEpK3UpO30pO09iamVjdC5leHRlbmQoImZvckVhY2giLGZ1bmN0aW9uKGksdix3KXtmb3IodmFyIHUgaW4gaSl7aWYoaS5oYXNPd25Qcm9wZXJ0eSh1KSl7di5jYWxsKHcsaVt1XSx1LGkpOwp9fX0pO09iamVjdC5lYWNoPU9iamVjdC5mb3JFYWNoO0FycmF5LmltcGxlbWVudCh7Zm9yRWFjaDpmdW5jdGlvbih3LHgpe2Zvcih2YXIgdj0wLHU9dGhpcy5sZW5ndGg7djx1O3YrKyl7aWYodiBpbiB0aGlzKXt3LmNhbGwoeCx0aGlzW3ZdLHYsdGhpcyk7fX19LGVhY2g6ZnVuY3Rpb24oaSx1KXtBcnJheS5mb3JFYWNoKHRoaXMsaSx1KTsKcmV0dXJuIHRoaXM7fX0pO3ZhciByPWZ1bmN0aW9uKGkpe3N3aXRjaChlKGkpKXtjYXNlImFycmF5IjpyZXR1cm4gaS5jbG9uZSgpO2Nhc2Uib2JqZWN0IjpyZXR1cm4gT2JqZWN0LmNsb25lKGkpO2RlZmF1bHQ6cmV0dXJuIGk7fX07QXJyYXkuaW1wbGVtZW50KCJjbG9uZSIsZnVuY3Rpb24oKXt2YXIgdT10aGlzLmxlbmd0aCx2PW5ldyBBcnJheSh1KTsKd2hpbGUodS0tKXt2W3VdPXIodGhpc1t1XSk7fXJldHVybiB2O30pO3ZhciBhPWZ1bmN0aW9uKHUsaSx2KXtzd2l0Y2goZSh2KSl7Y2FzZSJvYmplY3QiOmlmKGUodVtpXSk9PSJvYmplY3QiKXtPYmplY3QubWVyZ2UodVtpXSx2KTt9ZWxzZXt1W2ldPU9iamVjdC5jbG9uZSh2KTsKfWJyZWFrO2Nhc2UiYXJyYXkiOnVbaV09di5jbG9uZSgpO2JyZWFrO2RlZmF1bHQ6dVtpXT12O31yZXR1cm4gdTt9O09iamVjdC5leHRlbmQoe21lcmdlOmZ1bmN0aW9uKEIseCx3KXtpZihlKHgpPT0ic3RyaW5nIil7cmV0dXJuIGEoQix4LHcpO31mb3IodmFyIEE9MSx1PWFyZ3VtZW50cy5sZW5ndGg7CkE8dTtBKyspe3ZhciB5PWFyZ3VtZW50c1tBXTtmb3IodmFyIHogaW4geSl7YShCLHoseVt6XSk7fX1yZXR1cm4gQjt9LGNsb25lOmZ1bmN0aW9uKGkpe3ZhciB2PXt9O2Zvcih2YXIgdSBpbiBpKXt2W3VdPXIoaVt1XSk7fXJldHVybiB2O30sYXBwZW5kOmZ1bmN0aW9uKHkpe2Zvcih2YXIgeD0xLHY9YXJndW1lbnRzLmxlbmd0aDsKeDx2O3grKyl7dmFyIHU9YXJndW1lbnRzW3hdfHx7fTtmb3IodmFyIHcgaW4gdSl7eVt3XT11W3ddO319cmV0dXJuIHk7fX0pO1siT2JqZWN0IiwiV2hpdGVTcGFjZSIsIlRleHROb2RlIiwiQ29sbGVjdGlvbiIsIkFyZ3VtZW50cyJdLmVhY2goZnVuY3Rpb24oaSl7bmV3IGsoaSk7Cn0pO3ZhciBqPURhdGUubm93KCk7U3RyaW5nLmV4dGVuZCgidW5pcXVlSUQiLGZ1bmN0aW9uKCl7cmV0dXJuKGorKykudG9TdHJpbmcoMzYpO30pO3ZhciBnPXRoaXMuSGFzaD1uZXcgaygiSGFzaCIsZnVuY3Rpb24oaSl7aWYoZShpKT09Imhhc2giKXtpPU9iamVjdC5jbG9uZShpLmdldENsZWFuKCkpOwp9Zm9yKHZhciB1IGluIGkpe3RoaXNbdV09aVt1XTt9cmV0dXJuIHRoaXM7fSk7Zy5pbXBsZW1lbnQoe2ZvckVhY2g6ZnVuY3Rpb24oaSx1KXtPYmplY3QuZm9yRWFjaCh0aGlzLGksdSk7fSxnZXRDbGVhbjpmdW5jdGlvbigpe3ZhciB1PXt9O2Zvcih2YXIgaSBpbiB0aGlzKXtpZih0aGlzLmhhc093blByb3BlcnR5KGkpKXt1W2ldPXRoaXNbaV07Cn19cmV0dXJuIHU7fSxnZXRMZW5ndGg6ZnVuY3Rpb24oKXt2YXIgdT0wO2Zvcih2YXIgaSBpbiB0aGlzKXtpZih0aGlzLmhhc093blByb3BlcnR5KGkpKXt1Kys7fX1yZXR1cm4gdTt9fSk7Zy5hbGlhcygiZWFjaCIsImZvckVhY2giKTtPYmplY3QudHlwZT1rLmlzT2JqZWN0Owp2YXIgbT10aGlzLk5hdGl2ZT1mdW5jdGlvbihpKXtyZXR1cm4gbmV3IGsoaS5uYW1lLGkuaW5pdGlhbGl6ZSk7fTttLnR5cGU9ay50eXBlO20uaW1wbGVtZW50PWZ1bmN0aW9uKHcsdSl7Zm9yKHZhciB2PTA7djx3Lmxlbmd0aDt2Kyspe3dbdl0uaW1wbGVtZW50KHUpOwp9cmV0dXJuIG07fTt2YXIgbD1BcnJheS50eXBlO0FycmF5LnR5cGU9ZnVuY3Rpb24oaSl7cmV0dXJuIHQoaSxBcnJheSl8fGwoaSk7fTt0aGlzLiRBPWZ1bmN0aW9uKGkpe3JldHVybiBBcnJheS5mcm9tKGkpLnNsaWNlKCk7fTt0aGlzLiRhcmd1bWVudHM9ZnVuY3Rpb24odSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50c1t1XTsKfTt9O3RoaXMuJGNoaz1mdW5jdGlvbihpKXtyZXR1cm4gISEoaXx8aT09PTApO307dGhpcy4kY2xlYXI9ZnVuY3Rpb24oaSl7Y2xlYXJUaW1lb3V0KGkpO2NsZWFySW50ZXJ2YWwoaSk7cmV0dXJuIG51bGw7fTt0aGlzLiRkZWZpbmVkPWZ1bmN0aW9uKGkpe3JldHVybihpIT1udWxsKTsKfTt0aGlzLiRlYWNoPWZ1bmN0aW9uKHYsdSx3KXt2YXIgaT1lKHYpOygoaT09ImFyZ3VtZW50cyJ8fGk9PSJjb2xsZWN0aW9uInx8aT09ImFycmF5Inx8aT09ImVsZW1lbnRzIik/QXJyYXk6T2JqZWN0KS5lYWNoKHYsdSx3KTt9O3RoaXMuJGVtcHR5PWZ1bmN0aW9uKCl7fTsKdGhpcy4kZXh0ZW5kPWZ1bmN0aW9uKHUsaSl7cmV0dXJuIE9iamVjdC5hcHBlbmQodSxpKTt9O3RoaXMuJEg9ZnVuY3Rpb24oaSl7cmV0dXJuIG5ldyBnKGkpO307dGhpcy4kbWVyZ2U9ZnVuY3Rpb24oKXt2YXIgaT1BcnJheS5zbGljZShhcmd1bWVudHMpO2kudW5zaGlmdCh7fSk7CnJldHVybiBPYmplY3QubWVyZ2UuYXBwbHkobnVsbCxpKTt9O3RoaXMuJGxhbWJkYT1mLmZyb207dGhpcy4kbWl4aW49T2JqZWN0Lm1lcmdlO3RoaXMuJHJhbmRvbT1OdW1iZXIucmFuZG9tO3RoaXMuJHNwbGF0PUFycmF5LmZyb207dGhpcy4kdGltZT1EYXRlLm5vdzsKdGhpcy4kdHlwZT1mdW5jdGlvbihpKXt2YXIgdT1lKGkpO2lmKHU9PSJlbGVtZW50cyIpe3JldHVybiJhcnJheSI7fXJldHVybih1PT0ibnVsbCIpP2ZhbHNlOnU7fTt0aGlzLiR1bmxpbms9ZnVuY3Rpb24oaSl7c3dpdGNoKGUoaSkpe2Nhc2Uib2JqZWN0IjpyZXR1cm4gT2JqZWN0LmNsb25lKGkpOwpjYXNlImFycmF5IjpyZXR1cm4gQXJyYXkuY2xvbmUoaSk7Y2FzZSJoYXNoIjpyZXR1cm4gbmV3IGcoaSk7ZGVmYXVsdDpyZXR1cm4gaTt9fTt9KSgpO0FycmF5LmltcGxlbWVudCh7aW52b2tlOmZ1bmN0aW9uKGEpe3ZhciBiPUFycmF5LnNsaWNlKGFyZ3VtZW50cywxKTsKcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKGMpe3JldHVybiBjW2FdLmFwcGx5KGMsYik7fSk7fSxldmVyeTpmdW5jdGlvbihjLGQpe2Zvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7aWYoKGIgaW4gdGhpcykmJiFjLmNhbGwoZCx0aGlzW2JdLGIsdGhpcykpe3JldHVybiBmYWxzZTsKfX1yZXR1cm4gdHJ1ZTt9LGZpbHRlcjpmdW5jdGlvbihkLGUpe3ZhciBjPVtdO2Zvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7aWYoKGIgaW4gdGhpcykmJmQuY2FsbChlLHRoaXNbYl0sYix0aGlzKSl7Yy5wdXNoKHRoaXNbYl0pO319cmV0dXJuIGM7fSxjbGVhbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbihhKXtyZXR1cm4gYSE9bnVsbDsKfSk7fSxpbmRleE9mOmZ1bmN0aW9uKGMsZCl7dmFyIGE9dGhpcy5sZW5ndGg7Zm9yKHZhciBiPShkPDApP01hdGgubWF4KDAsYStkKTpkfHwwO2I8YTtiKyspe2lmKHRoaXNbYl09PT1jKXtyZXR1cm4gYjt9fXJldHVybiAtMTt9LG1hcDpmdW5jdGlvbihkLGUpe3ZhciBjPVtdOwpmb3IodmFyIGI9MCxhPXRoaXMubGVuZ3RoO2I8YTtiKyspe2lmKGIgaW4gdGhpcyl7Y1tiXT1kLmNhbGwoZSx0aGlzW2JdLGIsdGhpcyk7fX1yZXR1cm4gYzt9LHNvbWU6ZnVuY3Rpb24oYyxkKXtmb3IodmFyIGI9MCxhPXRoaXMubGVuZ3RoO2I8YTtiKyspe2lmKChiIGluIHRoaXMpJiZjLmNhbGwoZCx0aGlzW2JdLGIsdGhpcykpe3JldHVybiB0cnVlOwp9fXJldHVybiBmYWxzZTt9LGFzc29jaWF0ZTpmdW5jdGlvbihjKXt2YXIgZD17fSxiPU1hdGgubWluKHRoaXMubGVuZ3RoLGMubGVuZ3RoKTtmb3IodmFyIGE9MDthPGI7YSsrKXtkW2NbYV1dPXRoaXNbYV07fXJldHVybiBkO30sbGluazpmdW5jdGlvbihjKXt2YXIgYT17fTsKZm9yKHZhciBlPTAsYj10aGlzLmxlbmd0aDtlPGI7ZSsrKXtmb3IodmFyIGQgaW4gYyl7aWYoY1tkXSh0aGlzW2VdKSl7YVtkXT10aGlzW2VdO2RlbGV0ZSBjW2RdO2JyZWFrO319fXJldHVybiBhO30sY29udGFpbnM6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5pbmRleE9mKGEsYikhPS0xOwp9LGFwcGVuZDpmdW5jdGlvbihhKXt0aGlzLnB1c2guYXBwbHkodGhpcyxhKTtyZXR1cm4gdGhpczt9LGdldExhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5sZW5ndGgpP3RoaXNbdGhpcy5sZW5ndGgtMV06bnVsbDt9LGdldFJhbmRvbTpmdW5jdGlvbigpe3JldHVybih0aGlzLmxlbmd0aCk/dGhpc1tOdW1iZXIucmFuZG9tKDAsdGhpcy5sZW5ndGgtMSldOm51bGw7Cn0saW5jbHVkZTpmdW5jdGlvbihhKXtpZighdGhpcy5jb250YWlucyhhKSl7dGhpcy5wdXNoKGEpO31yZXR1cm4gdGhpczt9LGNvbWJpbmU6ZnVuY3Rpb24oYyl7Zm9yKHZhciBiPTAsYT1jLmxlbmd0aDtiPGE7YisrKXt0aGlzLmluY2x1ZGUoY1tiXSk7fXJldHVybiB0aGlzOwp9LGVyYXNlOmZ1bmN0aW9uKGIpe2Zvcih2YXIgYT10aGlzLmxlbmd0aDthLS07KXtpZih0aGlzW2FdPT09Yil7dGhpcy5zcGxpY2UoYSwxKTt9fXJldHVybiB0aGlzO30sZW1wdHk6ZnVuY3Rpb24oKXt0aGlzLmxlbmd0aD0wO3JldHVybiB0aGlzO30sZmxhdHRlbjpmdW5jdGlvbigpe3ZhciBkPVtdOwpmb3IodmFyIGI9MCxhPXRoaXMubGVuZ3RoO2I8YTtiKyspe3ZhciBjPXR5cGVPZih0aGlzW2JdKTtpZihjPT0ibnVsbCIpe2NvbnRpbnVlO31kPWQuY29uY2F0KChjPT0iYXJyYXkifHxjPT0iY29sbGVjdGlvbiJ8fGM9PSJhcmd1bWVudHMifHxpbnN0YW5jZU9mKHRoaXNbYl0sQXJyYXkpKT9BcnJheS5mbGF0dGVuKHRoaXNbYl0pOnRoaXNbYl0pOwp9cmV0dXJuIGQ7fSxwaWNrOmZ1bmN0aW9uKCl7Zm9yKHZhciBiPTAsYT10aGlzLmxlbmd0aDtiPGE7YisrKXtpZih0aGlzW2JdIT1udWxsKXtyZXR1cm4gdGhpc1tiXTt9fXJldHVybiBudWxsO30saGV4VG9SZ2I6ZnVuY3Rpb24oYil7aWYodGhpcy5sZW5ndGghPTMpe3JldHVybiBudWxsOwp9dmFyIGE9dGhpcy5tYXAoZnVuY3Rpb24oYyl7aWYoYy5sZW5ndGg9PTEpe2MrPWM7fXJldHVybiBjLnRvSW50KDE2KTt9KTtyZXR1cm4oYik/YToicmdiKCIrYSsiKSI7fSxyZ2JUb0hleDpmdW5jdGlvbihkKXtpZih0aGlzLmxlbmd0aDwzKXtyZXR1cm4gbnVsbDt9aWYodGhpcy5sZW5ndGg9PTQmJnRoaXNbM109PTAmJiFkKXtyZXR1cm4idHJhbnNwYXJlbnQiOwp9dmFyIGI9W107Zm9yKHZhciBhPTA7YTwzO2ErKyl7dmFyIGM9KHRoaXNbYV0tMCkudG9TdHJpbmcoMTYpO2IucHVzaCgoYy5sZW5ndGg9PTEpPyIwIitjOmMpO31yZXR1cm4oZCk/YjoiIyIrYi5qb2luKCIiKTt9fSk7QXJyYXkuYWxpYXMoImV4dGVuZCIsImFwcGVuZCIpOwp2YXIgJHBpY2s9ZnVuY3Rpb24oKXtyZXR1cm4gQXJyYXkuZnJvbShhcmd1bWVudHMpLnBpY2soKTt9O1N0cmluZy5pbXBsZW1lbnQoe3Rlc3Q6ZnVuY3Rpb24oYSxiKXtyZXR1cm4oKHR5cGVPZihhKT09InJlZ2V4cCIpP2E6bmV3IFJlZ0V4cCgiIithLGIpKS50ZXN0KHRoaXMpOwp9LGNvbnRhaW5zOmZ1bmN0aW9uKGEsYil7cmV0dXJuKGIpPyhiK3RoaXMrYikuaW5kZXhPZihiK2ErYik+LTE6dGhpcy5pbmRleE9mKGEpPi0xO30sdHJpbTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoL15ccyt8XHMrJC9nLCIiKTt9LGNsZWFuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXHMrL2csIiAiKS50cmltKCk7Cn0sY2FtZWxDYXNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvLVxEL2csZnVuY3Rpb24oYSl7cmV0dXJuIGEuY2hhckF0KDEpLnRvVXBwZXJDYXNlKCk7fSk7fSxoeXBoZW5hdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC9bQS1aXS9nLGZ1bmN0aW9uKGEpe3JldHVybigiLSIrYS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSk7Cn0pO30sY2FwaXRhbGl6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoL1xiW2Etel0vZyxmdW5jdGlvbihhKXtyZXR1cm4gYS50b1VwcGVyQ2FzZSgpO30pO30sZXNjYXBlUmVnRXhwOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvKFstLiorP14ke30oKXxbXF1cL1xcXSkvZywiXFwkMSIpOwp9LHRvSW50OmZ1bmN0aW9uKGEpe3JldHVybiBwYXJzZUludCh0aGlzLGF8fDEwKTt9LHRvRmxvYXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcGFyc2VGbG9hdCh0aGlzKTt9LGhleFRvUmdiOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMubWF0Y2goL14jPyhcd3sxLDJ9KShcd3sxLDJ9KShcd3sxLDJ9KSQvKTsKcmV0dXJuKGEpP2Euc2xpY2UoMSkuaGV4VG9SZ2IoYik6bnVsbDt9LHJnYlRvSGV4OmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMubWF0Y2goL1xkezEsM30vZyk7cmV0dXJuKGEpP2EucmdiVG9IZXgoYik6bnVsbDt9LHN1YnN0aXR1dGU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5yZXBsYWNlKGJ8fCgvXFw/XHsoW157fV0rKVx9L2cpLGZ1bmN0aW9uKGQsYyl7aWYoZC5jaGFyQXQoMCk9PSJcXCIpe3JldHVybiBkLnNsaWNlKDEpOwp9cmV0dXJuKGFbY10hPW51bGwpP2FbY106IiI7fSk7fX0pO051bWJlci5pbXBsZW1lbnQoe2xpbWl0OmZ1bmN0aW9uKGIsYSl7cmV0dXJuIE1hdGgubWluKGEsTWF0aC5tYXgoYix0aGlzKSk7fSxyb3VuZDpmdW5jdGlvbihhKXthPU1hdGgucG93KDEwLGF8fDApLnRvRml4ZWQoYTwwPy1hOjApOwpyZXR1cm4gTWF0aC5yb3VuZCh0aGlzKmEpL2E7fSx0aW1lczpmdW5jdGlvbihiLGMpe2Zvcih2YXIgYT0wO2E8dGhpczthKyspe2IuY2FsbChjLGEsdGhpcyk7fX0sdG9GbG9hdDpmdW5jdGlvbigpe3JldHVybiBwYXJzZUZsb2F0KHRoaXMpO30sdG9JbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHBhcnNlSW50KHRoaXMsYXx8MTApOwp9fSk7TnVtYmVyLmFsaWFzKCJlYWNoIiwidGltZXMiKTsoZnVuY3Rpb24oYil7dmFyIGE9e307Yi5lYWNoKGZ1bmN0aW9uKGMpe2lmKCFOdW1iZXJbY10pe2FbY109ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aFtjXS5hcHBseShudWxsLFt0aGlzXS5jb25jYXQoQXJyYXkuZnJvbShhcmd1bWVudHMpKSk7Cn07fX0pO051bWJlci5pbXBsZW1lbnQoYSk7fSkoWyJhYnMiLCJhY29zIiwiYXNpbiIsImF0YW4iLCJhdGFuMiIsImNlaWwiLCJjb3MiLCJleHAiLCJmbG9vciIsImxvZyIsIm1heCIsIm1pbiIsInBvdyIsInNpbiIsInNxcnQiLCJ0YW4iXSk7RnVuY3Rpb24uZXh0ZW5kKHthdHRlbXB0OmZ1bmN0aW9uKCl7Zm9yKHZhciBiPTAsYT1hcmd1bWVudHMubGVuZ3RoOwpiPGE7YisrKXt0cnl7cmV0dXJuIGFyZ3VtZW50c1tiXSgpO31jYXRjaChjKXt9fXJldHVybiBudWxsO319KTtGdW5jdGlvbi5pbXBsZW1lbnQoe2F0dGVtcHQ6ZnVuY3Rpb24oYSxjKXt0cnl7cmV0dXJuIHRoaXMuYXBwbHkoYyxBcnJheS5mcm9tKGEpKTt9Y2F0Y2goYil7fXJldHVybiBudWxsOwp9LGJpbmQ6ZnVuY3Rpb24oYyl7dmFyIGE9dGhpcyxiPShhcmd1bWVudHMubGVuZ3RoPjEpP0FycmF5LnNsaWNlKGFyZ3VtZW50cywxKTpudWxsO3JldHVybiBmdW5jdGlvbigpe2lmKCFiJiYhYXJndW1lbnRzLmxlbmd0aCl7cmV0dXJuIGEuY2FsbChjKTt9aWYoYiYmYXJndW1lbnRzLmxlbmd0aCl7cmV0dXJuIGEuYXBwbHkoYyxiLmNvbmNhdChBcnJheS5mcm9tKGFyZ3VtZW50cykpKTsKfXJldHVybiBhLmFwcGx5KGMsYnx8YXJndW1lbnRzKTt9O30scGFzczpmdW5jdGlvbihiLGMpe3ZhciBhPXRoaXM7aWYoYiE9bnVsbCl7Yj1BcnJheS5mcm9tKGIpO31yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShjLGJ8fGFyZ3VtZW50cyk7fTt9LGRlbGF5OmZ1bmN0aW9uKGIsYyxhKXtyZXR1cm4gc2V0VGltZW91dCh0aGlzLnBhc3MoYSxjKSxiKTsKfSxwZXJpb2RpY2FsOmZ1bmN0aW9uKGMsYixhKXtyZXR1cm4gc2V0SW50ZXJ2YWwodGhpcy5wYXNzKGEsYiksYyk7fX0pO2RlbGV0ZSBGdW5jdGlvbi5wcm90b3R5cGUuYmluZDtGdW5jdGlvbi5pbXBsZW1lbnQoe2NyZWF0ZTpmdW5jdGlvbihiKXt2YXIgYT10aGlzOwpiPWJ8fHt9O3JldHVybiBmdW5jdGlvbihkKXt2YXIgYz1iLmFyZ3VtZW50cztjPShjIT1udWxsKT9BcnJheS5mcm9tKGMpOkFycmF5LnNsaWNlKGFyZ3VtZW50cywoYi5ldmVudCk/MTowKTtpZihiLmV2ZW50KXtjPVtkfHx3aW5kb3cuZXZlbnRdLmV4dGVuZChjKTt9dmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShiLmJpbmR8fG51bGwsYyk7Cn07aWYoYi5kZWxheSl7cmV0dXJuIHNldFRpbWVvdXQoZSxiLmRlbGF5KTt9aWYoYi5wZXJpb2RpY2FsKXtyZXR1cm4gc2V0SW50ZXJ2YWwoZSxiLnBlcmlvZGljYWwpO31pZihiLmF0dGVtcHQpe3JldHVybiBGdW5jdGlvbi5hdHRlbXB0KGUpO31yZXR1cm4gZSgpO307Cn0sYmluZDpmdW5jdGlvbihjLGIpe3ZhciBhPXRoaXM7aWYoYiE9bnVsbCl7Yj1BcnJheS5mcm9tKGIpO31yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShjLGJ8fGFyZ3VtZW50cyk7fTt9LGJpbmRXaXRoRXZlbnQ6ZnVuY3Rpb24oYyxiKXt2YXIgYT10aGlzOwppZihiIT1udWxsKXtiPUFycmF5LmZyb20oYik7fXJldHVybiBmdW5jdGlvbihkKXtyZXR1cm4gYS5hcHBseShjLChiPT1udWxsKT9hcmd1bWVudHM6W2RdLmNvbmNhdChiKSk7fTt9LHJ1bjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmFwcGx5KGIsQXJyYXkuZnJvbShhKSk7Cn19KTt2YXIgJHRyeT1GdW5jdGlvbi5hdHRlbXB0O09iamVjdC5leHRlbmQoe3N1YnNldDpmdW5jdGlvbihjLGYpe3ZhciBlPXt9O2Zvcih2YXIgZD0wLGE9Zi5sZW5ndGg7ZDxhO2QrKyl7dmFyIGI9ZltkXTtlW2JdPWNbYl07fXJldHVybiBlO30sbWFwOmZ1bmN0aW9uKGEsZCxlKXt2YXIgYz17fTsKZm9yKHZhciBiIGluIGEpe2lmKGEuaGFzT3duUHJvcGVydHkoYikpe2NbYl09ZC5jYWxsKGUsYVtiXSxiLGEpO319cmV0dXJuIGM7fSxmaWx0ZXI6ZnVuY3Rpb24oYSxjLGQpe3ZhciBiPXt9O09iamVjdC5lYWNoKGEsZnVuY3Rpb24oZixlKXtpZihjLmNhbGwoZCxmLGUsYSkpe2JbZV09ZjsKfX0pO3JldHVybiBiO30sZXZlcnk6ZnVuY3Rpb24oYSxjLGQpe2Zvcih2YXIgYiBpbiBhKXtpZihhLmhhc093blByb3BlcnR5KGIpJiYhYy5jYWxsKGQsYVtiXSxiKSl7cmV0dXJuIGZhbHNlO319cmV0dXJuIHRydWU7fSxzb21lOmZ1bmN0aW9uKGEsYyxkKXtmb3IodmFyIGIgaW4gYSl7aWYoYS5oYXNPd25Qcm9wZXJ0eShiKSYmYy5jYWxsKGQsYVtiXSxiKSl7cmV0dXJuIHRydWU7Cn19cmV0dXJuIGZhbHNlO30sa2V5czpmdW5jdGlvbihhKXt2YXIgYz1bXTtmb3IodmFyIGIgaW4gYSl7aWYoYS5oYXNPd25Qcm9wZXJ0eShiKSl7Yy5wdXNoKGIpO319cmV0dXJuIGM7fSx2YWx1ZXM6ZnVuY3Rpb24oYil7dmFyIGE9W107Zm9yKHZhciBjIGluIGIpe2lmKGIuaGFzT3duUHJvcGVydHkoYykpe2EucHVzaChiW2NdKTsKfX1yZXR1cm4gYTt9LGdldExlbmd0aDpmdW5jdGlvbihhKXtyZXR1cm4gT2JqZWN0LmtleXMoYSkubGVuZ3RoO30sa2V5T2Y6ZnVuY3Rpb24oYSxjKXtmb3IodmFyIGIgaW4gYSl7aWYoYS5oYXNPd25Qcm9wZXJ0eShiKSYmYVtiXT09PWMpe3JldHVybiBiO319cmV0dXJuIG51bGw7Cn0sY29udGFpbnM6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gT2JqZWN0LmtleU9mKGEsYikhPW51bGw7fSx0b1F1ZXJ5U3RyaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGM9W107T2JqZWN0LmVhY2goYSxmdW5jdGlvbihnLGYpe2lmKGIpe2Y9YisiWyIrZisiXSI7fXZhciBlO3N3aXRjaCh0eXBlT2YoZykpe2Nhc2Uib2JqZWN0IjplPU9iamVjdC50b1F1ZXJ5U3RyaW5nKGcsZik7CmJyZWFrO2Nhc2UiYXJyYXkiOnZhciBkPXt9O2cuZWFjaChmdW5jdGlvbihqLGgpe2RbaF09ajt9KTtlPU9iamVjdC50b1F1ZXJ5U3RyaW5nKGQsZik7YnJlYWs7ZGVmYXVsdDplPWYrIj0iK2VuY29kZVVSSUNvbXBvbmVudChnKTt9aWYoZyE9bnVsbCl7Yy5wdXNoKGUpOwp9fSk7cmV0dXJuIGMuam9pbigiJiIpO319KTtIYXNoLmltcGxlbWVudCh7aGFzOk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksa2V5T2Y6ZnVuY3Rpb24oYSl7cmV0dXJuIE9iamVjdC5rZXlPZih0aGlzLGEpO30saGFzVmFsdWU6ZnVuY3Rpb24oYSl7cmV0dXJuIE9iamVjdC5jb250YWlucyh0aGlzLGEpOwp9LGV4dGVuZDpmdW5jdGlvbihhKXtIYXNoLmVhY2goYXx8e30sZnVuY3Rpb24oYyxiKXtIYXNoLnNldCh0aGlzLGIsYyk7fSx0aGlzKTtyZXR1cm4gdGhpczt9LGNvbWJpbmU6ZnVuY3Rpb24oYSl7SGFzaC5lYWNoKGF8fHt9LGZ1bmN0aW9uKGMsYil7SGFzaC5pbmNsdWRlKHRoaXMsYixjKTsKfSx0aGlzKTtyZXR1cm4gdGhpczt9LGVyYXNlOmZ1bmN0aW9uKGEpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoYSkpe2RlbGV0ZSB0aGlzW2FdO31yZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbihhKXtyZXR1cm4odGhpcy5oYXNPd25Qcm9wZXJ0eShhKSk/dGhpc1thXTpudWxsOwp9LHNldDpmdW5jdGlvbihhLGIpe2lmKCF0aGlzW2FdfHx0aGlzLmhhc093blByb3BlcnR5KGEpKXt0aGlzW2FdPWI7fXJldHVybiB0aGlzO30sZW1wdHk6ZnVuY3Rpb24oKXtIYXNoLmVhY2godGhpcyxmdW5jdGlvbihiLGEpe2RlbGV0ZSB0aGlzW2FdO30sdGhpcyk7CnJldHVybiB0aGlzO30saW5jbHVkZTpmdW5jdGlvbihhLGIpe2lmKHRoaXNbYV09PW51bGwpe3RoaXNbYV09Yjt9cmV0dXJuIHRoaXM7fSxtYXA6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEhhc2goT2JqZWN0Lm1hcCh0aGlzLGEsYikpO30sZmlsdGVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBIYXNoKE9iamVjdC5maWx0ZXIodGhpcyxhLGIpKTsKfSxldmVyeTpmdW5jdGlvbihhLGIpe3JldHVybiBPYmplY3QuZXZlcnkodGhpcyxhLGIpO30sc29tZTpmdW5jdGlvbihhLGIpe3JldHVybiBPYmplY3Quc29tZSh0aGlzLGEsYik7fSxnZXRLZXlzOmZ1bmN0aW9uKCl7cmV0dXJuIE9iamVjdC5rZXlzKHRoaXMpO30sZ2V0VmFsdWVzOmZ1bmN0aW9uKCl7cmV0dXJuIE9iamVjdC52YWx1ZXModGhpcyk7Cn0sdG9RdWVyeVN0cmluZzpmdW5jdGlvbihhKXtyZXR1cm4gT2JqZWN0LnRvUXVlcnlTdHJpbmcodGhpcyxhKTt9fSk7SGFzaC5leHRlbmQ9T2JqZWN0LmFwcGVuZDtIYXNoLmFsaWFzKHtpbmRleE9mOiJrZXlPZiIsY29udGFpbnM6Imhhc1ZhbHVlIn0pOyhmdW5jdGlvbigpe3ZhciBsPXRoaXMuZG9jdW1lbnQ7CnZhciBqPWwud2luZG93PXRoaXM7dmFyIGI9MTt0aGlzLiR1aWQ9KGouQWN0aXZlWE9iamVjdCk/ZnVuY3Rpb24oZSl7cmV0dXJuKGUudWlkfHwoZS51aWQ9W2IrK10pKVswXTt9OmZ1bmN0aW9uKGUpe3JldHVybiBlLnVpZHx8KGUudWlkPWIrKyk7fTskdWlkKGopOyR1aWQobCk7CnZhciBhPW5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSxjPW5hdmlnYXRvci5wbGF0Zm9ybS50b0xvd2VyQ2FzZSgpLGs9YS5tYXRjaCgvKG9wZXJhfGllfGZpcmVmb3h8Y2hyb21lfHZlcnNpb24pW1xzXC86XShbXHdcZFwuXSspPy4qPyhzYWZhcml8dmVyc2lvbltcc1wvOl0oW1x3XGRcLl0rKXwkKS8pfHxbbnVsbCwidW5rbm93biIsMF0sZz1rWzFdPT0iaWUiJiZsLmRvY3VtZW50TW9kZTsKdmFyIHA9dGhpcy5Ccm93c2VyPXtleHRlbmQ6RnVuY3Rpb24ucHJvdG90eXBlLmV4dGVuZCxuYW1lOihrWzFdPT0idmVyc2lvbiIpP2tbM106a1sxXSx2ZXJzaW9uOmd8fHBhcnNlRmxvYXQoKGtbMV09PSJvcGVyYSImJmtbNF0pP2tbNF06a1syXSksUGxhdGZvcm06e25hbWU6YS5tYXRjaCgvaXAoPzphZHxvZHxob25lKS8pPyJpb3MiOihhLm1hdGNoKC8oPzp3ZWJvc3xhbmRyb2lkKS8pfHxjLm1hdGNoKC9tYWN8d2lufGxpbnV4Lyl8fFsib3RoZXIiXSlbMF19LEZlYXR1cmVzOnt4cGF0aDohIShsLmV2YWx1YXRlKSxhaXI6ISEoai5ydW50aW1lKSxxdWVyeTohIShsLnF1ZXJ5U2VsZWN0b3IpLGpzb246ISEoai5KU09OKX0sUGx1Z2luczp7fX07CnBbcC5uYW1lXT10cnVlO3BbcC5uYW1lK3BhcnNlSW50KHAudmVyc2lvbiwxMCldPXRydWU7cC5QbGF0Zm9ybVtwLlBsYXRmb3JtLm5hbWVdPXRydWU7cC5SZXF1ZXN0PShmdW5jdGlvbigpe3ZhciByPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpOwp9O3ZhciBxPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KCJNU1hNTDIuWE1MSFRUUCIpO307dmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7fTtyZXR1cm4gRnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3IoKTsKcmV0dXJuIHI7fSxmdW5jdGlvbigpe3EoKTtyZXR1cm4gcTt9LGZ1bmN0aW9uKCl7ZSgpO3JldHVybiBlO30pO30pKCk7cC5GZWF0dXJlcy54aHI9ISEocC5SZXF1ZXN0KTt2YXIgaT0oRnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3JldHVybiBuYXZpZ2F0b3IucGx1Z2luc1siU2hvY2t3YXZlIEZsYXNoIl0uZGVzY3JpcHRpb247Cn0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoIikuR2V0VmFyaWFibGUoIiR2ZXJzaW9uIik7fSl8fCIwIHIwIikubWF0Y2goL1xkKy9nKTtwLlBsdWdpbnMuRmxhc2g9e3ZlcnNpb246TnVtYmVyKGlbMF18fCIwLiIraVsxXSl8fDAsYnVpbGQ6TnVtYmVyKGlbMl0pfHwwfTsKcC5leGVjPWZ1bmN0aW9uKHEpe2lmKCFxKXtyZXR1cm4gcTt9aWYoai5leGVjU2NyaXB0KXtqLmV4ZWNTY3JpcHQocSk7fWVsc2V7dmFyIGU9bC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtlLnNldEF0dHJpYnV0ZSgidHlwZSIsInRleHQvamF2YXNjcmlwdCIpO2UudGV4dD1xOwpsLmhlYWQuYXBwZW5kQ2hpbGQoZSk7bC5oZWFkLnJlbW92ZUNoaWxkKGUpO31yZXR1cm4gcTt9O1N0cmluZy5pbXBsZW1lbnQoInN0cmlwU2NyaXB0cyIsZnVuY3Rpb24ocSl7dmFyIGU9IiI7dmFyIHI9dGhpcy5yZXBsYWNlKC88c2NyaXB0W14+XSo+KFtcc1xTXSo/KTxcL3NjcmlwdD4vZ2ksZnVuY3Rpb24ocyx0KXtlKz10KyJcbiI7CnJldHVybiIiO30pO2lmKHE9PT10cnVlKXtwLmV4ZWMoZSk7fWVsc2V7aWYodHlwZU9mKHEpPT0iZnVuY3Rpb24iKXtxKGUscik7fX1yZXR1cm4gcjt9KTtwLmV4dGVuZCh7RG9jdW1lbnQ6dGhpcy5Eb2N1bWVudCxXaW5kb3c6dGhpcy5XaW5kb3csRWxlbWVudDp0aGlzLkVsZW1lbnQsRXZlbnQ6dGhpcy5FdmVudH0pOwp0aGlzLldpbmRvdz10aGlzLiRjb25zdHJ1Y3Rvcj1uZXcgVHlwZSgiV2luZG93IixmdW5jdGlvbigpe30pO3RoaXMuJGZhbWlseT1GdW5jdGlvbi5mcm9tKCJ3aW5kb3ciKS5oaWRlKCk7V2luZG93Lm1pcnJvcihmdW5jdGlvbihlLHEpe2pbZV09cTt9KTt0aGlzLkRvY3VtZW50PWwuJGNvbnN0cnVjdG9yPW5ldyBUeXBlKCJEb2N1bWVudCIsZnVuY3Rpb24oKXt9KTsKbC4kZmFtaWx5PUZ1bmN0aW9uLmZyb20oImRvY3VtZW50IikuaGlkZSgpO0RvY3VtZW50Lm1pcnJvcihmdW5jdGlvbihlLHEpe2xbZV09cTt9KTtsLmh0bWw9bC5kb2N1bWVudEVsZW1lbnQ7bC5oZWFkPWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXTtpZihsLmV4ZWNDb21tYW5kKXt0cnl7bC5leGVjQ29tbWFuZCgiQmFja2dyb3VuZEltYWdlQ2FjaGUiLGZhbHNlLHRydWUpOwp9Y2F0Y2goaCl7fX1pZih0aGlzLmF0dGFjaEV2ZW50JiYhdGhpcy5hZGRFdmVudExpc3RlbmVyKXt2YXIgZD1mdW5jdGlvbigpe3RoaXMuZGV0YWNoRXZlbnQoIm9udW5sb2FkIixkKTtsLmhlYWQ9bC5odG1sPWwud2luZG93PW51bGw7fTt0aGlzLmF0dGFjaEV2ZW50KCJvbnVubG9hZCIsZCk7Cn12YXIgbj1BcnJheS5mcm9tO3RyeXtuKGwuaHRtbC5jaGlsZE5vZGVzKTt9Y2F0Y2goaCl7QXJyYXkuZnJvbT1mdW5jdGlvbihxKXtpZih0eXBlb2YgcSE9InN0cmluZyImJlR5cGUuaXNFbnVtZXJhYmxlKHEpJiZ0eXBlT2YocSkhPSJhcnJheSIpe3ZhciBlPXEubGVuZ3RoLHI9bmV3IEFycmF5KGUpOwp3aGlsZShlLS0pe3JbZV09cVtlXTt9cmV0dXJuIHI7fXJldHVybiBuKHEpO307dmFyIG09QXJyYXkucHJvdG90eXBlLG89bS5zbGljZTtbInBvcCIsInB1c2giLCJyZXZlcnNlIiwic2hpZnQiLCJzb3J0Iiwic3BsaWNlIiwidW5zaGlmdCIsImNvbmNhdCIsImpvaW4iLCJzbGljZSJdLmVhY2goZnVuY3Rpb24oZSl7dmFyIHE9bVtlXTsKQXJyYXlbZV09ZnVuY3Rpb24ocil7cmV0dXJuIHEuYXBwbHkoQXJyYXkuZnJvbShyKSxvLmNhbGwoYXJndW1lbnRzLDEpKTt9O30pO31pZihwLlBsYXRmb3JtLmlvcyl7cC5QbGF0Zm9ybS5pcG9kPXRydWU7fXAuRW5naW5lPXt9O3ZhciBmPWZ1bmN0aW9uKHEsZSl7cC5FbmdpbmUubmFtZT1xOwpwLkVuZ2luZVtxK2VdPXRydWU7cC5FbmdpbmUudmVyc2lvbj1lO307aWYocC5pZSl7cC5FbmdpbmUudHJpZGVudD10cnVlO3N3aXRjaChwLnZlcnNpb24pe2Nhc2UgNjpmKCJ0cmlkZW50Iiw0KTticmVhaztjYXNlIDc6ZigidHJpZGVudCIsNSk7YnJlYWs7Y2FzZSA4OmYoInRyaWRlbnQiLDYpOwp9fWlmKHAuZmlyZWZveCl7cC5FbmdpbmUuZ2Vja289dHJ1ZTtpZihwLnZlcnNpb24+PTMpe2YoImdlY2tvIiwxOSk7fWVsc2V7ZigiZ2Vja28iLDE4KTt9fWlmKHAuc2FmYXJpfHxwLmNocm9tZSl7cC5FbmdpbmUud2Via2l0PXRydWU7c3dpdGNoKHAudmVyc2lvbil7Y2FzZSAyOmYoIndlYmtpdCIsNDE5KTsKYnJlYWs7Y2FzZSAzOmYoIndlYmtpdCIsNDIwKTticmVhaztjYXNlIDQ6Zigid2Via2l0Iiw1MjUpO319aWYocC5vcGVyYSl7cC5FbmdpbmUucHJlc3RvPXRydWU7aWYocC52ZXJzaW9uPj05LjYpe2YoInByZXN0byIsOTYwKTt9ZWxzZXtpZihwLnZlcnNpb24+PTkuNSl7ZigicHJlc3RvIiw5NTApOwp9ZWxzZXtmKCJwcmVzdG8iLDkyNSk7fX19aWYocC5uYW1lPT0idW5rbm93biIpe3N3aXRjaCgoYS5tYXRjaCgvKD86d2Via2l0fGtodG1sfGdlY2tvKS8pfHxbXSlbMF0pe2Nhc2Uid2Via2l0IjpjYXNlImtodG1sIjpwLkVuZ2luZS53ZWJraXQ9dHJ1ZTticmVhaztjYXNlImdlY2tvIjpwLkVuZ2luZS5nZWNrbz10cnVlOwp9fXRoaXMuJGV4ZWM9cC5leGVjO30pKCk7dmFyIEV2ZW50PW5ldyBUeXBlKCJFdmVudCIsZnVuY3Rpb24oYSxpKXtpZighaSl7aT13aW5kb3c7fXZhciBvPWkuZG9jdW1lbnQ7YT1hfHxpLmV2ZW50O2lmKGEuJGV4dGVuZGVkKXtyZXR1cm4gYTt9dGhpcy4kZXh0ZW5kZWQ9dHJ1ZTsKdmFyIG49YS50eXBlLGs9YS50YXJnZXR8fGEuc3JjRWxlbWVudCxtPXt9LGM9e307d2hpbGUoayYmay5ub2RlVHlwZT09Myl7az1rLnBhcmVudE5vZGU7fWlmKG4uaW5kZXhPZigia2V5IikhPS0xKXt2YXIgYj1hLndoaWNofHxhLmtleUNvZGU7dmFyIHE9T2JqZWN0LmtleU9mKEV2ZW50LktleXMsYik7CmlmKG49PSJrZXlkb3duIil7dmFyIGQ9Yi0xMTE7aWYoZD4wJiZkPDEzKXtxPSJmIitkO319aWYoIXEpe3E9U3RyaW5nLmZyb21DaGFyQ29kZShiKS50b0xvd2VyQ2FzZSgpO319ZWxzZXtpZihuLnRlc3QoL2NsaWNrfG1vdXNlfG1lbnUvaSkpe289KCFvLmNvbXBhdE1vZGV8fG8uY29tcGF0TW9kZT09IkNTUzFDb21wYXQiKT9vLmh0bWw6by5ib2R5OwptPXt4OihhLnBhZ2VYIT1udWxsKT9hLnBhZ2VYOmEuY2xpZW50WCtvLnNjcm9sbExlZnQseTooYS5wYWdlWSE9bnVsbCk/YS5wYWdlWTphLmNsaWVudFkrby5zY3JvbGxUb3B9O2M9e3g6KGEucGFnZVghPW51bGwpP2EucGFnZVgtaS5wYWdlWE9mZnNldDphLmNsaWVudFgseTooYS5wYWdlWSE9bnVsbCk/YS5wYWdlWS1pLnBhZ2VZT2Zmc2V0OmEuY2xpZW50WX07CmlmKG4udGVzdCgvRE9NTW91c2VTY3JvbGx8bW91c2V3aGVlbC8pKXt2YXIgbD0oYS53aGVlbERlbHRhKT9hLndoZWVsRGVsdGEvMTIwOi0oYS5kZXRhaWx8fDApLzM7fXZhciBoPShhLndoaWNoPT0zKXx8KGEuYnV0dG9uPT0yKSxwPW51bGw7aWYobi50ZXN0KC9vdmVyfG91dC8pKXtwPWEucmVsYXRlZFRhcmdldHx8YVsobj09Im1vdXNlb3ZlciI/ImZyb20iOiJ0byIpKyJFbGVtZW50Il07CnZhciBqPWZ1bmN0aW9uKCl7d2hpbGUocCYmcC5ub2RlVHlwZT09Myl7cD1wLnBhcmVudE5vZGU7fXJldHVybiB0cnVlO307dmFyIGc9KEJyb3dzZXIuZmlyZWZveDIpP2ouYXR0ZW1wdCgpOmooKTtwPShnKT9wOm51bGw7fX1lbHNle2lmKG4udGVzdCgvZ2VzdHVyZXx0b3VjaC9pKSl7dGhpcy5yb3RhdGlvbj1hLnJvdGF0aW9uOwp0aGlzLnNjYWxlPWEuc2NhbGU7dGhpcy50YXJnZXRUb3VjaGVzPWEudGFyZ2V0VG91Y2hlczt0aGlzLmNoYW5nZWRUb3VjaGVzPWEuY2hhbmdlZFRvdWNoZXM7dmFyIGY9dGhpcy50b3VjaGVzPWEudG91Y2hlcztpZihmJiZmWzBdKXt2YXIgZT1mWzBdO209e3g6ZS5wYWdlWCx5OmUucGFnZVl9OwpjPXt4OmUuY2xpZW50WCx5OmUuY2xpZW50WX07fX19fXJldHVybiBPYmplY3QuYXBwZW5kKHRoaXMse2V2ZW50OmEsdHlwZTpuLHBhZ2U6bSxjbGllbnQ6YyxyaWdodENsaWNrOmgsd2hlZWw6bCxyZWxhdGVkVGFyZ2V0OmRvY3VtZW50LmlkKHApLHRhcmdldDpkb2N1bWVudC5pZChrKSxjb2RlOmIsa2V5OnEsc2hpZnQ6YS5zaGlmdEtleSxjb250cm9sOmEuY3RybEtleSxhbHQ6YS5hbHRLZXksbWV0YTphLm1ldGFLZXl9KTsKfSk7RXZlbnQuS2V5cz17ZW50ZXI6MTMsdXA6MzgsZG93bjo0MCxsZWZ0OjM3LHJpZ2h0OjM5LGVzYzoyNyxzcGFjZTozMixiYWNrc3BhY2U6OCx0YWI6OSwiZGVsZXRlIjo0Nn07RXZlbnQuS2V5cz1uZXcgSGFzaChFdmVudC5LZXlzKTtFdmVudC5pbXBsZW1lbnQoe3N0b3A6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdG9wUHJvcGFnYXRpb24oKS5wcmV2ZW50RGVmYXVsdCgpOwp9LHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe2lmKHRoaXMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKXt0aGlzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO31lbHNle3RoaXMuZXZlbnQuY2FuY2VsQnViYmxlPXRydWU7fXJldHVybiB0aGlzO30scHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXtpZih0aGlzLmV2ZW50LnByZXZlbnREZWZhdWx0KXt0aGlzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7Cn1lbHNle3RoaXMuZXZlbnQucmV0dXJuVmFsdWU9ZmFsc2U7fXJldHVybiB0aGlzO319KTsoZnVuY3Rpb24oKXt2YXIgYT10aGlzLkNsYXNzPW5ldyBUeXBlKCJDbGFzcyIsZnVuY3Rpb24oaCl7aWYoaW5zdGFuY2VPZihoLEZ1bmN0aW9uKSl7aD17aW5pdGlhbGl6ZTpofTsKfXZhciBnPWZ1bmN0aW9uKCl7ZSh0aGlzKTtpZihnLiRwcm90b3R5cGluZyl7cmV0dXJuIHRoaXM7fXRoaXMuJGNhbGxlcj1udWxsO3ZhciBpPSh0aGlzLmluaXRpYWxpemUpP3RoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dGhpczt0aGlzLiRjYWxsZXI9dGhpcy5jYWxsZXI9bnVsbDsKcmV0dXJuIGk7fS5leHRlbmQodGhpcykuaW1wbGVtZW50KGgpO2cuJGNvbnN0cnVjdG9yPWE7Zy5wcm90b3R5cGUuJGNvbnN0cnVjdG9yPWc7Zy5wcm90b3R5cGUucGFyZW50PWM7cmV0dXJuIGc7fSk7dmFyIGM9ZnVuY3Rpb24oKXtpZighdGhpcy4kY2FsbGVyKXt0aHJvdyBuZXcgRXJyb3IoJ1RoZSBtZXRob2QgInBhcmVudCIgY2Fubm90IGJlIGNhbGxlZC4nKTsKfXZhciBnPXRoaXMuJGNhbGxlci4kbmFtZSxoPXRoaXMuJGNhbGxlci4kb3duZXIucGFyZW50LGk9KGgpP2gucHJvdG90eXBlW2ddOm51bGw7aWYoIWkpe3Rocm93IG5ldyBFcnJvcignVGhlIG1ldGhvZCAiJytnKyciIGhhcyBubyBwYXJlbnQuJyk7fXJldHVybiBpLmFwcGx5KHRoaXMsYXJndW1lbnRzKTsKfTt2YXIgZT1mdW5jdGlvbihnKXtmb3IodmFyIGggaW4gZyl7dmFyIGo9Z1toXTtzd2l0Y2godHlwZU9mKGopKXtjYXNlIm9iamVjdCI6dmFyIGk9ZnVuY3Rpb24oKXt9O2kucHJvdG90eXBlPWo7Z1toXT1lKG5ldyBpKTticmVhaztjYXNlImFycmF5IjpnW2hdPWouY2xvbmUoKTsKYnJlYWs7fX1yZXR1cm4gZzt9O3ZhciBiPWZ1bmN0aW9uKGcsaCxqKXtpZihqLiRvcmlnaW4pe2o9ai4kb3JpZ2luO312YXIgaT1mdW5jdGlvbigpe2lmKGouJHByb3RlY3RlZCYmdGhpcy4kY2FsbGVyPT1udWxsKXt0aHJvdyBuZXcgRXJyb3IoJ1RoZSBtZXRob2QgIicraCsnIiBjYW5ub3QgYmUgY2FsbGVkLicpOwp9dmFyIGw9dGhpcy5jYWxsZXIsbT10aGlzLiRjYWxsZXI7dGhpcy5jYWxsZXI9bTt0aGlzLiRjYWxsZXI9aTt2YXIgaz1qLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLiRjYWxsZXI9bTt0aGlzLmNhbGxlcj1sO3JldHVybiBrO30uZXh0ZW5kKHskb3duZXI6Zywkb3JpZ2luOmosJG5hbWU6aH0pOwpyZXR1cm4gaTt9O3ZhciBmPWZ1bmN0aW9uKGgsaSxnKXtpZihhLk11dGF0b3JzLmhhc093blByb3BlcnR5KGgpKXtpPWEuTXV0YXRvcnNbaF0uY2FsbCh0aGlzLGkpO2lmKGk9PW51bGwpe3JldHVybiB0aGlzO319aWYodHlwZU9mKGkpPT0iZnVuY3Rpb24iKXtpZihpLiRoaWRkZW4pe3JldHVybiB0aGlzOwp9dGhpcy5wcm90b3R5cGVbaF09KGcpP2k6Yih0aGlzLGgsaSk7fWVsc2V7T2JqZWN0Lm1lcmdlKHRoaXMucHJvdG90eXBlLGgsaSk7fXJldHVybiB0aGlzO307dmFyIGQ9ZnVuY3Rpb24oZyl7Zy4kcHJvdG90eXBpbmc9dHJ1ZTt2YXIgaD1uZXcgZztkZWxldGUgZy4kcHJvdG90eXBpbmc7CnJldHVybiBoO307YS5pbXBsZW1lbnQoImltcGxlbWVudCIsZi5vdmVybG9hZFNldHRlcigpKTthLk11dGF0b3JzPXtFeHRlbmRzOmZ1bmN0aW9uKGcpe3RoaXMucGFyZW50PWc7dGhpcy5wcm90b3R5cGU9ZChnKTt9LEltcGxlbWVudHM6ZnVuY3Rpb24oZyl7QXJyYXkuZnJvbShnKS5lYWNoKGZ1bmN0aW9uKGope3ZhciBoPW5ldyBqOwpmb3IodmFyIGkgaW4gaCl7Zi5jYWxsKHRoaXMsaSxoW2ldLHRydWUpO319LHRoaXMpO319O30pKCk7KGZ1bmN0aW9uKCl7dGhpcy5DaGFpbj1uZXcgQ2xhc3MoeyRjaGFpbjpbXSxjaGFpbjpmdW5jdGlvbigpe3RoaXMuJGNoYWluLmFwcGVuZChBcnJheS5mbGF0dGVuKGFyZ3VtZW50cykpOwpyZXR1cm4gdGhpczt9LGNhbGxDaGFpbjpmdW5jdGlvbigpe3JldHVybih0aGlzLiRjaGFpbi5sZW5ndGgpP3RoaXMuJGNoYWluLnNoaWZ0KCkuYXBwbHkodGhpcyxhcmd1bWVudHMpOmZhbHNlO30sY2xlYXJDaGFpbjpmdW5jdGlvbigpe3RoaXMuJGNoYWluLmVtcHR5KCk7CnJldHVybiB0aGlzO319KTt2YXIgYT1mdW5jdGlvbihiKXtyZXR1cm4gYi5yZXBsYWNlKC9eb24oW0EtWl0pLyxmdW5jdGlvbihjLGQpe3JldHVybiBkLnRvTG93ZXJDYXNlKCk7fSk7fTt0aGlzLkV2ZW50cz1uZXcgQ2xhc3MoeyRldmVudHM6e30sYWRkRXZlbnQ6ZnVuY3Rpb24oZCxjLGIpe2Q9YShkKTsKaWYoYz09JGVtcHR5KXtyZXR1cm4gdGhpczt9dGhpcy4kZXZlbnRzW2RdPSh0aGlzLiRldmVudHNbZF18fFtdKS5pbmNsdWRlKGMpO2lmKGIpe2MuaW50ZXJuYWw9dHJ1ZTt9cmV0dXJuIHRoaXM7fSxhZGRFdmVudHM6ZnVuY3Rpb24oYil7Zm9yKHZhciBjIGluIGIpe3RoaXMuYWRkRXZlbnQoYyxiW2NdKTsKfXJldHVybiB0aGlzO30sZmlyZUV2ZW50OmZ1bmN0aW9uKGUsYyxiKXtlPWEoZSk7dmFyIGQ9dGhpcy4kZXZlbnRzW2VdO2lmKCFkKXtyZXR1cm4gdGhpczt9Yz1BcnJheS5mcm9tKGMpO2QuZWFjaChmdW5jdGlvbihmKXtpZihiKXtmLmRlbGF5KGIsdGhpcyxjKTt9ZWxzZXtmLmFwcGx5KHRoaXMsYyk7Cn19LHRoaXMpO3JldHVybiB0aGlzO30scmVtb3ZlRXZlbnQ6ZnVuY3Rpb24oZSxkKXtlPWEoZSk7dmFyIGM9dGhpcy4kZXZlbnRzW2VdO2lmKGMmJiFkLmludGVybmFsKXt2YXIgYj1jLmluZGV4T2YoZCk7aWYoYiE9LTEpe2RlbGV0ZSBjW2JdO319cmV0dXJuIHRoaXM7Cn0scmVtb3ZlRXZlbnRzOmZ1bmN0aW9uKGQpe3ZhciBlO2lmKHR5cGVPZihkKT09Im9iamVjdCIpe2ZvcihlIGluIGQpe3RoaXMucmVtb3ZlRXZlbnQoZSxkW2VdKTt9cmV0dXJuIHRoaXM7fWlmKGQpe2Q9YShkKTt9Zm9yKGUgaW4gdGhpcy4kZXZlbnRzKXtpZihkJiZkIT1lKXtjb250aW51ZTsKfXZhciBjPXRoaXMuJGV2ZW50c1tlXTtmb3IodmFyIGI9Yy5sZW5ndGg7Yi0tOyl7dGhpcy5yZW1vdmVFdmVudChlLGNbYl0pO319cmV0dXJuIHRoaXM7fX0pO3RoaXMuT3B0aW9ucz1uZXcgQ2xhc3Moe3NldE9wdGlvbnM6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLm9wdGlvbnM9T2JqZWN0Lm1lcmdlLmFwcGx5KG51bGwsW3t9LHRoaXMub3B0aW9uc10uYXBwZW5kKGFyZ3VtZW50cykpOwppZighdGhpcy5hZGRFdmVudCl7cmV0dXJuIHRoaXM7fWZvcih2YXIgYyBpbiBiKXtpZih0eXBlT2YoYltjXSkhPSJmdW5jdGlvbiJ8fCEoL15vbltBLVpdLykudGVzdChjKSl7Y29udGludWU7fXRoaXMuYWRkRXZlbnQoYyxiW2NdKTtkZWxldGUgYltjXTt9cmV0dXJuIHRoaXM7Cn19KTt9KSgpOyhmdW5jdGlvbigpe3ZhciBrLG4sbCxnLGE9e30sYz17fSxtPS9cXC9nO3ZhciBlPWZ1bmN0aW9uKHEscCl7aWYocT09bnVsbCl7cmV0dXJuIG51bGw7fWlmKHEuU2xpY2s9PT10cnVlKXtyZXR1cm4gcTt9cT0oIiIrcSkucmVwbGFjZSgvXlxzK3xccyskL2csIiIpOwpnPSEhcDt2YXIgbz0oZyk/YzphO2lmKG9bcV0pe3JldHVybiBvW3FdO31rPXtTbGljazp0cnVlLGV4cHJlc3Npb25zOltdLHJhdzpxLHJldmVyc2U6ZnVuY3Rpb24oKXtyZXR1cm4gZSh0aGlzLnJhdyx0cnVlKTt9fTtuPS0xO3doaWxlKHEhPShxPXEucmVwbGFjZShqLGIpKSl7fWsubGVuZ3RoPWsuZXhwcmVzc2lvbnMubGVuZ3RoOwpyZXR1cm4gb1txXT0oZyk/aChrKTprO307dmFyIGk9ZnVuY3Rpb24obyl7aWYobz09PSIhIil7cmV0dXJuIiAiO31lbHNle2lmKG89PT0iICIpe3JldHVybiIhIjt9ZWxzZXtpZigoL14hLykudGVzdChvKSl7cmV0dXJuIG8ucmVwbGFjZSgvXiEvLCIiKTt9ZWxzZXtyZXR1cm4iISIrbzsKfX19fTt2YXIgaD1mdW5jdGlvbih1KXt2YXIgcj11LmV4cHJlc3Npb25zO2Zvcih2YXIgcD0wO3A8ci5sZW5ndGg7cCsrKXt2YXIgdD1yW3BdO3ZhciBxPXtwYXJ0czpbXSx0YWc6IioiLGNvbWJpbmF0b3I6aSh0WzBdLmNvbWJpbmF0b3IpfTtmb3IodmFyIG89MDtvPHQubGVuZ3RoOwpvKyspe3ZhciBzPXRbb107aWYoIXMucmV2ZXJzZUNvbWJpbmF0b3Ipe3MucmV2ZXJzZUNvbWJpbmF0b3I9IiAiO31zLmNvbWJpbmF0b3I9cy5yZXZlcnNlQ29tYmluYXRvcjtkZWxldGUgcy5yZXZlcnNlQ29tYmluYXRvcjt9dC5yZXZlcnNlKCkucHVzaChxKTt9cmV0dXJuIHU7Cn07dmFyIGY9ZnVuY3Rpb24obyl7cmV0dXJuIG8ucmVwbGFjZSgvWy1bXF17fSgpKis/LlxcXiR8LCNcc10vZywiXFwkJiIpO307dmFyIGo9bmV3IFJlZ0V4cCgiXig/OlxccyooLClcXHMqfFxccyooPGNvbWJpbmF0b3I+KylcXHMqfChcXHMrKXwoPHVuaWNvZGU+K3xcXCopfFxcIyg8dW5pY29kZT4rKXxcXC4oPHVuaWNvZGU+Kyl8XFxbXFxzKig8dW5pY29kZTE+KykoPzpcXHMqKFsqXiQhfnxdPz0pKD86XFxzKig/OihbXCInXT8pKC4qPylcXDkpKSk/XFxzKlxcXSg/IVxcXSl8OisoPHVuaWNvZGU+KykoPzpcXCgoPzooPzooW1wiJ10pKFteXFwxMl0qKVxcMTIpfCgoPzpcXChbXildK1xcKXxbXigpXSopKykpXFwpKT8pIi5yZXBsYWNlKC88Y29tYmluYXRvcj4vLCJbIitmKCI+K35gIUAkJV4mPXt9XFw7PC8iKSsiXSIpLnJlcGxhY2UoLzx1bmljb2RlPi9nLCIoPzpbXFx3XFx1MDBhMS1cXHVGRkZGLV18XFxcXFteXFxzMC05YS1mXSkiKS5yZXBsYWNlKC88dW5pY29kZTE+L2csIig/Ols6XFx3XFx1MDBhMS1cXHVGRkZGLV18XFxcXFteXFxzMC05YS1mXSkiKSk7CmZ1bmN0aW9uIGIoeCxzLEQseixyLEMscSxCLEEseSx1LEYsdixwLHcpe2lmKHN8fG49PT0tMSl7ay5leHByZXNzaW9uc1srK25dPVtdO2w9LTE7aWYocyl7cmV0dXJuIiI7fX1pZihEfHx6fHxsPT09LTEpe0Q9RHx8IiAiO3ZhciB0PWsuZXhwcmVzc2lvbnNbbl07aWYoZyYmdFtsXSl7dFtsXS5yZXZlcnNlQ29tYmluYXRvcj1pKEQpOwp9dFsrK2xdPXtjb21iaW5hdG9yOkQsdGFnOiIqIn07fXZhciBvPWsuZXhwcmVzc2lvbnNbbl1bbF07aWYocil7by50YWc9ci5yZXBsYWNlKG0sIiIpO31lbHNle2lmKEMpe28uaWQ9Qy5yZXBsYWNlKG0sIiIpO31lbHNle2lmKHEpe3E9cS5yZXBsYWNlKG0sIiIpO2lmKCFvLmNsYXNzTGlzdCl7by5jbGFzc0xpc3Q9W107Cn1pZighby5jbGFzc2VzKXtvLmNsYXNzZXM9W107fW8uY2xhc3NMaXN0LnB1c2gocSk7by5jbGFzc2VzLnB1c2goe3ZhbHVlOnEscmVnZXhwOm5ldyBSZWdFeHAoIihefFxccykiK2YocSkrIihcXHN8JCkiKX0pO31lbHNle2lmKEYpe3c9d3x8cDt3PXc/dy5yZXBsYWNlKG0sIiIpOm51bGw7CmlmKCFvLnBzZXVkb3Mpe28ucHNldWRvcz1bXTt9by5wc2V1ZG9zLnB1c2goe2tleTpGLnJlcGxhY2UobSwiIiksdmFsdWU6d30pO31lbHNle2lmKEIpe0I9Qi5yZXBsYWNlKG0sIiIpO3U9KHV8fCIiKS5yZXBsYWNlKG0sIiIpO3ZhciBFLEc7c3dpdGNoKEEpe2Nhc2UiXj0iOkc9bmV3IFJlZ0V4cCgiXiIrZih1KSk7CmJyZWFrO2Nhc2UiJD0iOkc9bmV3IFJlZ0V4cChmKHUpKyIkIik7YnJlYWs7Y2FzZSJ+PSI6Rz1uZXcgUmVnRXhwKCIoXnxcXHMpIitmKHUpKyIoXFxzfCQpIik7YnJlYWs7Y2FzZSJ8PSI6Rz1uZXcgUmVnRXhwKCJeIitmKHUpKyIoLXwkKSIpO2JyZWFrO2Nhc2UiPSI6RT1mdW5jdGlvbihIKXtyZXR1cm4gdT09SDsKfTticmVhaztjYXNlIio9IjpFPWZ1bmN0aW9uKEgpe3JldHVybiBIJiZILmluZGV4T2YodSk+LTE7fTticmVhaztjYXNlIiE9IjpFPWZ1bmN0aW9uKEgpe3JldHVybiB1IT1IO307YnJlYWs7ZGVmYXVsdDpFPWZ1bmN0aW9uKEgpe3JldHVybiAhIUg7fTt9aWYodT09IiImJigvXlsqJF5dPSQvKS50ZXN0KEEpKXtFPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlOwp9O31pZighRSl7RT1mdW5jdGlvbihIKXtyZXR1cm4gSCYmRy50ZXN0KEgpO307fWlmKCFvLmF0dHJpYnV0ZXMpe28uYXR0cmlidXRlcz1bXTt9by5hdHRyaWJ1dGVzLnB1c2goe2tleTpCLG9wZXJhdG9yOkEsdmFsdWU6dSx0ZXN0OkV9KTt9fX19fXJldHVybiIiO312YXIgZD0odGhpcy5TbGlja3x8e30pOwpkLnBhcnNlPWZ1bmN0aW9uKG8pe3JldHVybiBlKG8pO307ZC5lc2NhcGVSZWdFeHA9ZjtpZighdGhpcy5TbGljayl7dGhpcy5TbGljaz1kO319KS5hcHBseSgodHlwZW9mIGV4cG9ydHMhPSJ1bmRlZmluZWQiKT9leHBvcnRzOnRoaXMpOyhmdW5jdGlvbigpe3ZhciBiPXt9OwpiLmlzTmF0aXZlQ29kZT1mdW5jdGlvbihjKXtyZXR1cm4oL1x7XHMqXFtuYXRpdmUgY29kZVxdXHMqXH0vKS50ZXN0KCIiK2MpO307Yi5pc1hNTD1mdW5jdGlvbihjKXtyZXR1cm4oISFjLnhtbFZlcnNpb24pfHwoISFjLnhtbCl8fChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYyk9PT0iW29iamVjdCBYTUxEb2N1bWVudF0iKXx8KGMubm9kZVR5cGU9PT05JiZjLmRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSE9PSJIVE1MIik7Cn07Yi5zZXREb2N1bWVudD1mdW5jdGlvbihuKXtpZihuLm5vZGVUeXBlPT09OSl7fWVsc2V7aWYobi5vd25lckRvY3VtZW50KXtuPW4ub3duZXJEb2N1bWVudDt9ZWxzZXtpZihuLm5hdmlnYXRvcil7bj1uLmRvY3VtZW50O31lbHNle3JldHVybjt9fX1pZih0aGlzLmRvY3VtZW50PT09bil7cmV0dXJuOwp9dGhpcy5kb2N1bWVudD1uO3ZhciBvPXRoaXMucm9vdD1uLmRvY3VtZW50RWxlbWVudDt0aGlzLmlzWE1MRG9jdW1lbnQ9dGhpcy5pc1hNTChuKTt0aGlzLmJyb2tlblN0YXJHRUJUTj10aGlzLnN0YXJTZWxlY3RzQ2xvc2VkUVNBPXRoaXMuaWRHZXRzTmFtZT10aGlzLmJyb2tlbk1peGVkQ2FzZVFTQT10aGlzLmJyb2tlbkdFQkNOPXRoaXMuYnJva2VuQ2hlY2tlZFFTQT10aGlzLmJyb2tlbkVtcHR5QXR0cmlidXRlUVNBPXRoaXMuaXNIVE1MRG9jdW1lbnQ9ZmFsc2U7CnZhciBpLGoscCxrO3ZhciBsLGM7dmFyIHE9bi5jcmVhdGVFbGVtZW50KCJkaXYiKTtvLmFwcGVuZENoaWxkKHEpO3RyeXtjPSJzbGlja19nZXRieWlkX3Rlc3QiO3EuaW5uZXJIVE1MPSc8YSBpZD0iJytjKyciPjwvYT4nO3RoaXMuaXNIVE1MRG9jdW1lbnQ9ISFuLmdldEVsZW1lbnRCeUlkKGMpOwp9Y2F0Y2gobSl7fWlmKHRoaXMuaXNIVE1MRG9jdW1lbnQpe3Euc3R5bGUuZGlzcGxheT0ibm9uZSI7cS5hcHBlbmRDaGlsZChuLmNyZWF0ZUNvbW1lbnQoIiIpKTtqPShxLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RoPjApO3RyeXtxLmlubmVySFRNTD0iZm9vPC9mb28+IjsKbD1xLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIik7aT0obCYmbC5sZW5ndGgmJmxbMF0ubm9kZU5hbWUuY2hhckF0KDApPT0iLyIpO31jYXRjaChtKXt9dGhpcy5icm9rZW5TdGFyR0VCVE49anx8aTtpZihxLnF1ZXJ5U2VsZWN0b3JBbGwpe3RyeXtxLmlubmVySFRNTD0iZm9vPC9mb28+IjsKbD1xLnF1ZXJ5U2VsZWN0b3JBbGwoIioiKTt0aGlzLnN0YXJTZWxlY3RzQ2xvc2VkUVNBPShsJiZsLmxlbmd0aCYmbFswXS5ub2RlTmFtZS5jaGFyQXQoMCk9PSIvIik7fWNhdGNoKG0pe319dHJ5e2M9InNsaWNrX2lkX2dldHNfbmFtZSI7cS5pbm5lckhUTUw9JzxhIG5hbWU9IicrYysnIj48L2E+PGIgaWQ9IicrYysnIj48L2I+JzsKdGhpcy5pZEdldHNOYW1lPW4uZ2V0RWxlbWVudEJ5SWQoYyk9PT1xLmZpcnN0Q2hpbGQ7fWNhdGNoKG0pe310cnl7cS5pbm5lckhUTUw9JzxhIGNsYXNzPSJNaVhlZENhU2UiPjwvYT4nO3RoaXMuYnJva2VuTWl4ZWRDYXNlUVNBPSFxLnF1ZXJ5U2VsZWN0b3JBbGwoIi5NaVhlZENhU2UiKS5sZW5ndGg7Cn1jYXRjaChtKXt9dHJ5e3EuaW5uZXJIVE1MPSc8YSBjbGFzcz0iZiI+PC9hPjxhIGNsYXNzPSJiIj48L2E+JztxLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImIiKS5sZW5ndGg7cS5maXJzdENoaWxkLmNsYXNzTmFtZT0iYiI7az0ocS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJiIikubGVuZ3RoIT0yKTsKfWNhdGNoKG0pe310cnl7cS5pbm5lckhUTUw9JzxhIGNsYXNzPSJhIj48L2E+PGEgY2xhc3M9ImYgYiBhIj48L2E+JztwPShxLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImEiKS5sZW5ndGghPTIpO31jYXRjaChtKXt9dGhpcy5icm9rZW5HRUJDTj1rfHxwO3RyeXtxLmlubmVySFRNTD0nPHNlbGVjdD48b3B0aW9uIHNlbGVjdGVkPSJzZWxlY3RlZCI+YTwvb3B0aW9uPjwvc2VsZWN0Pic7CnRoaXMuYnJva2VuQ2hlY2tlZFFTQT0ocS5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aD09MCk7fWNhdGNoKG0pe310cnl7cS5pbm5lckhUTUw9JzxhIGNsYXNzPSIiPjwvYT4nO3RoaXMuYnJva2VuRW1wdHlBdHRyaWJ1dGVRU0E9KHEucXVlcnlTZWxlY3RvckFsbCgnW2NsYXNzKj0iIl0nKS5sZW5ndGghPTApOwp9Y2F0Y2gobSl7fX1vLnJlbW92ZUNoaWxkKHEpO3E9bnVsbDt0aGlzLmhhc0F0dHJpYnV0ZT0obyYmdGhpcy5pc05hdGl2ZUNvZGUoby5oYXNBdHRyaWJ1dGUpKT9mdW5jdGlvbihzLHIpe3JldHVybiBzLmhhc0F0dHJpYnV0ZShyKTt9OmZ1bmN0aW9uKHMscil7cz1zLmdldEF0dHJpYnV0ZU5vZGUocik7CnJldHVybiAhIShzJiYocy5zcGVjaWZpZWR8fHMubm9kZVZhbHVlKSk7fTt0aGlzLmNvbnRhaW5zPShvJiZ0aGlzLmlzTmF0aXZlQ29kZShvLmNvbnRhaW5zKSk/ZnVuY3Rpb24ocixzKXtyZXR1cm4gci5jb250YWlucyhzKTt9OihvJiZvLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKT9mdW5jdGlvbihyLHMpe3JldHVybiByPT09c3x8ISEoci5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihzKSYxNik7Cn06ZnVuY3Rpb24ocixzKXtpZihzKXtkb3tpZihzPT09cil7cmV0dXJuIHRydWU7fX13aGlsZSgocz1zLnBhcmVudE5vZGUpKTt9cmV0dXJuIGZhbHNlO307dGhpcy5kb2N1bWVudFNvcnRlcj0oby5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbik/ZnVuY3Rpb24ocyxyKXtpZighcy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbnx8IXIuY29tcGFyZURvY3VtZW50UG9zaXRpb24pe3JldHVybiAwOwp9cmV0dXJuIHMuY29tcGFyZURvY3VtZW50UG9zaXRpb24ocikmND8tMTpzPT09cj8wOjE7fTooInNvdXJjZUluZGV4IiBpbiBvKT9mdW5jdGlvbihzLHIpe2lmKCFzLnNvdXJjZUluZGV4fHwhci5zb3VyY2VJbmRleCl7cmV0dXJuIDA7fXJldHVybiBzLnNvdXJjZUluZGV4LXIuc291cmNlSW5kZXg7Cn06KG4uY3JlYXRlUmFuZ2UpP2Z1bmN0aW9uKHUscyl7aWYoIXUub3duZXJEb2N1bWVudHx8IXMub3duZXJEb2N1bWVudCl7cmV0dXJuIDA7fXZhciB0PXUub3duZXJEb2N1bWVudC5jcmVhdGVSYW5nZSgpLHI9cy5vd25lckRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7dC5zZXRTdGFydCh1LDApOwp0LnNldEVuZCh1LDApO3Iuc2V0U3RhcnQocywwKTtyLnNldEVuZChzLDApO3JldHVybiB0LmNvbXBhcmVCb3VuZGFyeVBvaW50cyhSYW5nZS5TVEFSVF9UT19FTkQscik7fTpudWxsO3RoaXMuZ2V0VUlEPSh0aGlzLmlzSFRNTERvY3VtZW50KT90aGlzLmdldFVJREhUTUw6dGhpcy5nZXRVSURYTUw7Cn07Yi5zZWFyY2g9ZnVuY3Rpb24oayx4LEYscSl7dmFyIHc9dGhpcy5mb3VuZD0ocSk/bnVsbDooRnx8W10pO2lmKCFrKXtyZXR1cm4gdzt9aWYoay5uYXZpZ2F0b3Ipe2s9ay5kb2N1bWVudDt9ZWxzZXtpZighay5ub2RlVHlwZSl7cmV0dXJuIHc7fX12YXIgdCxFO3ZhciBvPXRoaXMudW5pcXVlcz17fTsKaWYodGhpcy5kb2N1bWVudCE9PShrLm93bmVyRG9jdW1lbnR8fGspKXt0aGlzLnNldERvY3VtZW50KGspO312YXIgeT0hIShGJiZGLmxlbmd0aCk7aWYoeSl7Zm9yKEU9dy5sZW5ndGg7RS0tOyl7dGhpcy51bmlxdWVzW3RoaXMuZ2V0VUlEKHdbRV0pXT10cnVlO319aWYodHlwZW9mIHg9PSJzdHJpbmciKXtmb3IoRT10aGlzLm92ZXJyaWRlcy5sZW5ndGg7CkUtLTspe3ZhciB1PXRoaXMub3ZlcnJpZGVzW0VdO2lmKHUucmVnZXhwLnRlc3QoeCkpe3ZhciB2PXUubWV0aG9kLmNhbGwoayx4LHcscSk7aWYodj09PWZhbHNlKXtjb250aW51ZTt9aWYodj09PXRydWUpe3JldHVybiB3O31yZXR1cm4gdjt9fXQ9dGhpcy5TbGljay5wYXJzZSh4KTsKaWYoIXQubGVuZ3RoKXtyZXR1cm4gdzt9fWVsc2V7aWYoeD09bnVsbCl7cmV0dXJuIHc7fWVsc2V7aWYoeC5TbGljayl7dD14O31lbHNle2lmKHRoaXMuY29udGFpbnMoay5kb2N1bWVudEVsZW1lbnR8fGsseCkpeyh3KT93LnB1c2goeCk6dz14O3JldHVybiB3O31lbHNle3JldHVybiB3Owp9fX19dGhpcy5wb3NOVEg9e307dGhpcy5wb3NOVEhMYXN0PXt9O3RoaXMucG9zTlRIVHlwZT17fTt0aGlzLnBvc05USFR5cGVMYXN0PXt9O3RoaXMucHVzaD0oIXkmJihxfHwodC5sZW5ndGg9PTEmJnQuZXhwcmVzc2lvbnNbMF0ubGVuZ3RoPT0xKSkpP3RoaXMucHVzaEFycmF5OnRoaXMucHVzaFVJRDsKaWYodz09bnVsbCl7dz1bXTt9dmFyIEQsQixBO3ZhciBDLEsseixKLEcscyxwO3ZhciByLGwsYyxILEk9dC5leHByZXNzaW9ucztzZWFyY2g6Zm9yKEU9MDsobD1JW0VdKTtFKyspe2ZvcihEPTA7KGM9bFtEXSk7RCsrKXtDPSJjb21iaW5hdG9yOiIrYy5jb21iaW5hdG9yOwppZighdGhpc1tDXSl7Y29udGludWUgc2VhcmNoO31LPSh0aGlzLmlzWE1MRG9jdW1lbnQpP2MudGFnOmMudGFnLnRvVXBwZXJDYXNlKCk7ej1jLmlkO0o9Yy5jbGFzc0xpc3Q7Rz1jLmNsYXNzZXM7cz1jLmF0dHJpYnV0ZXM7cD1jLnBzZXVkb3M7SD0oRD09PShsLmxlbmd0aC0xKSk7CnRoaXMuYml0VW5pcXVlcz17fTtpZihIKXt0aGlzLnVuaXF1ZXM9bzt0aGlzLmZvdW5kPXc7fWVsc2V7dGhpcy51bmlxdWVzPXt9O3RoaXMuZm91bmQ9W107fWlmKEQ9PT0wKXt0aGlzW0NdKGssSyx6LEcscyxwLEopO2lmKHEmJkgmJncubGVuZ3RoKXticmVhayBzZWFyY2g7Cn19ZWxzZXtpZihxJiZIKXtmb3IoQj0wLEE9ci5sZW5ndGg7QjxBO0IrKyl7dGhpc1tDXShyW0JdLEsseixHLHMscCxKKTtpZih3Lmxlbmd0aCl7YnJlYWsgc2VhcmNoO319fWVsc2V7Zm9yKEI9MCxBPXIubGVuZ3RoO0I8QTtCKyspe3RoaXNbQ10ocltCXSxLLHosRyxzLHAsSik7Cn19fXI9dGhpcy5mb3VuZDt9fWlmKHl8fCh0LmV4cHJlc3Npb25zLmxlbmd0aD4xKSl7dGhpcy5zb3J0KHcpO31yZXR1cm4ocSk/KHdbMF18fG51bGwpOnc7fTtiLnVpZHg9MTtiLnVpZGs9InNsaWNrOnVuaXF1ZWlkIjtiLmdldFVJRFhNTD1mdW5jdGlvbihpKXt2YXIgYz1pLmdldEF0dHJpYnV0ZSh0aGlzLnVpZGspOwppZighYyl7Yz10aGlzLnVpZHgrKztpLnNldEF0dHJpYnV0ZSh0aGlzLnVpZGssYyk7fXJldHVybiBjO307Yi5nZXRVSURIVE1MPWZ1bmN0aW9uKGMpe3JldHVybiBjLnVuaXF1ZU51bWJlcnx8KGMudW5pcXVlTnVtYmVyPXRoaXMudWlkeCsrKTt9O2Iuc29ydD1mdW5jdGlvbihjKXtpZighdGhpcy5kb2N1bWVudFNvcnRlcil7cmV0dXJuIGM7Cn1jLnNvcnQodGhpcy5kb2N1bWVudFNvcnRlcik7cmV0dXJuIGM7fTtiLmNhY2hlTlRIPXt9O2IubWF0Y2hOVEg9L14oWystXT9cZCopPyhbYS16XSspPyhbKy1dXGQrKT8kLztiLnBhcnNlTlRIQXJndW1lbnQ9ZnVuY3Rpb24obCl7dmFyIGo9bC5tYXRjaCh0aGlzLm1hdGNoTlRIKTsKaWYoIWope3JldHVybiBmYWxzZTt9dmFyIGs9alsyXXx8ZmFsc2U7dmFyIGk9alsxXXx8MTtpZihpPT0iLSIpe2k9LTE7fXZhciBjPStqWzNdfHwwO2o9KGs9PSJuIik/e2E6aSxiOmN9OihrPT0ib2RkIik/e2E6MixiOjF9OihrPT0iZXZlbiIpP3thOjIsYjowfTp7YTowLGI6aX07CnJldHVybih0aGlzLmNhY2hlTlRIW2xdPWopO307Yi5jcmVhdGVOVEhQc2V1ZG89ZnVuY3Rpb24oayxpLGMsail7cmV0dXJuIGZ1bmN0aW9uKG4sbCl7dmFyIHA9dGhpcy5nZXRVSUQobik7aWYoIXRoaXNbY11bcF0pe3ZhciB2PW4ucGFyZW50Tm9kZTtpZighdil7cmV0dXJuIGZhbHNlOwp9dmFyIG09dltrXSxvPTE7aWYoail7dmFyIHU9bi5ub2RlTmFtZTtkb3tpZihtLm5vZGVOYW1lIT09dSl7Y29udGludWU7fXRoaXNbY11bdGhpcy5nZXRVSUQobSldPW8rKzt9d2hpbGUoKG09bVtpXSkpO31lbHNle2Rve2lmKG0ubm9kZVR5cGUhPT0xKXtjb250aW51ZTsKfXRoaXNbY11bdGhpcy5nZXRVSUQobSldPW8rKzt9d2hpbGUoKG09bVtpXSkpO319bD1sfHwibiI7dmFyIHE9dGhpcy5jYWNoZU5USFtsXXx8dGhpcy5wYXJzZU5USEFyZ3VtZW50KGwpO2lmKCFxKXtyZXR1cm4gZmFsc2U7fXZhciB0PXEuYSxzPXEuYixyPXRoaXNbY11bcF07CmlmKHQ9PTApe3JldHVybiBzPT1yO31pZih0PjApe2lmKHI8cyl7cmV0dXJuIGZhbHNlO319ZWxzZXtpZihzPHIpe3JldHVybiBmYWxzZTt9fXJldHVybigoci1zKSV0KT09MDt9O307Yi5wdXNoQXJyYXk9ZnVuY3Rpb24oayxjLG0saixpLGwpe2lmKHRoaXMubWF0Y2hTZWxlY3RvcihrLGMsbSxqLGksbCkpe3RoaXMuZm91bmQucHVzaChrKTsKfX07Yi5wdXNoVUlEPWZ1bmN0aW9uKGwsYyxuLGssaSxtKXt2YXIgaj10aGlzLmdldFVJRChsKTtpZighdGhpcy51bmlxdWVzW2pdJiZ0aGlzLm1hdGNoU2VsZWN0b3IobCxjLG4sayxpLG0pKXt0aGlzLnVuaXF1ZXNbal09dHJ1ZTt0aGlzLmZvdW5kLnB1c2gobCk7fX07CmIubWF0Y2hOb2RlPWZ1bmN0aW9uKG4sYyl7dmFyIGs9dGhpcy5TbGljay5wYXJzZShjKTtpZighayl7cmV0dXJuIHRydWU7fWlmKGsubGVuZ3RoPT0xJiZrLmV4cHJlc3Npb25zWzBdLmxlbmd0aD09MSl7dmFyIG89ay5leHByZXNzaW9uc1swXVswXTtyZXR1cm4gdGhpcy5tYXRjaFNlbGVjdG9yKG4sKHRoaXMuaXNYTUxEb2N1bWVudCk/by50YWc6by50YWcudG9VcHBlckNhc2UoKSxvLmlkLG8uY2xhc3NlcyxvLmF0dHJpYnV0ZXMsby5wc2V1ZG9zKTsKfXZhciBqPXRoaXMuc2VhcmNoKHRoaXMuZG9jdW1lbnQsayk7Zm9yKHZhciBsPTAsbTttPWpbbCsrXTspe2lmKG09PT1uKXtyZXR1cm4gdHJ1ZTt9fXJldHVybiBmYWxzZTt9O2IubWF0Y2hQc2V1ZG89ZnVuY3Rpb24obCxjLGspe3ZhciBpPSJwc2V1ZG86IitjO2lmKHRoaXNbaV0pe3JldHVybiB0aGlzW2ldKGwsayk7Cn12YXIgaj10aGlzLmdldEF0dHJpYnV0ZShsLGMpO3JldHVybihrKT9rPT1qOiEhajt9O2IubWF0Y2hTZWxlY3Rvcj1mdW5jdGlvbihrLHEsYyxsLG0sbyl7aWYocSl7aWYocT09IioiKXtpZihrLm5vZGVOYW1lPCJAIil7cmV0dXJuIGZhbHNlO319ZWxzZXtpZihrLm5vZGVOYW1lIT1xKXtyZXR1cm4gZmFsc2U7Cn19fWlmKGMmJmsuZ2V0QXR0cmlidXRlKCJpZCIpIT1jKXtyZXR1cm4gZmFsc2U7fXZhciBuLGoscDtpZihsKXtmb3Iobj1sLmxlbmd0aDtuLS07KXtwPSgiY2xhc3NOYW1lIiBpbiBrKT9rLmNsYXNzTmFtZTprLmdldEF0dHJpYnV0ZSgiY2xhc3MiKTtpZighKHAmJmxbbl0ucmVnZXhwLnRlc3QocCkpKXtyZXR1cm4gZmFsc2U7Cn19fWlmKG0pe2ZvcihuPW0ubGVuZ3RoO24tLTspe2o9bVtuXTtpZihqLm9wZXJhdG9yPyFqLnRlc3QodGhpcy5nZXRBdHRyaWJ1dGUoayxqLmtleSkpOiF0aGlzLmhhc0F0dHJpYnV0ZShrLGoua2V5KSl7cmV0dXJuIGZhbHNlO319fWlmKG8pe2ZvcihuPW8ubGVuZ3RoOwpuLS07KXtqPW9bbl07aWYoIXRoaXMubWF0Y2hQc2V1ZG8oayxqLmtleSxqLnZhbHVlKSl7cmV0dXJuIGZhbHNlO319fXJldHVybiB0cnVlO307dmFyIGE9eyIgIjpmdW5jdGlvbihsLHIsYyxtLG4scCxrKXt2YXIgbyxxLGo7aWYodGhpcy5pc0hUTUxEb2N1bWVudCl7Z2V0QnlJZDppZihjKXtxPXRoaXMuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYyk7CmlmKCghcSYmbC5hbGwpfHwodGhpcy5pZEdldHNOYW1lJiZxJiZxLmdldEF0dHJpYnV0ZU5vZGUoImlkIikubm9kZVZhbHVlIT1jKSl7aj1sLmFsbFtjXTtpZighail7cmV0dXJuO31pZighalswXSl7aj1bal07fWZvcihvPTA7cT1qW28rK107KXtpZihxLmdldEF0dHJpYnV0ZU5vZGUoImlkIikubm9kZVZhbHVlPT1jKXt0aGlzLnB1c2gocSxyLG51bGwsbSxuLHApOwpicmVhazt9fXJldHVybjt9aWYoIXEpe2lmKHRoaXMuY29udGFpbnModGhpcy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsbCkpe3JldHVybjt9ZWxzZXticmVhayBnZXRCeUlkO319ZWxzZXtpZih0aGlzLmRvY3VtZW50IT09bCYmIXRoaXMuY29udGFpbnMobCxxKSl7cmV0dXJuOwp9fXRoaXMucHVzaChxLHIsbnVsbCxtLG4scCk7cmV0dXJuO31nZXRCeUNsYXNzOmlmKG0mJmwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmIXRoaXMuYnJva2VuR0VCQ04pe2o9bC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGsuam9pbigiICIpKTtpZighKGomJmoubGVuZ3RoKSl7YnJlYWsgZ2V0QnlDbGFzczsKfWZvcihvPTA7cT1qW28rK107KXt0aGlzLnB1c2gocSxyLGMsbnVsbCxuLHApO31yZXR1cm47fX1nZXRCeVRhZzp7aj1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKHIpO2lmKCEoaiYmai5sZW5ndGgpKXticmVhayBnZXRCeVRhZzt9aWYoIXRoaXMuYnJva2VuU3RhckdFQlROKXtyPW51bGw7Cn1mb3Iobz0wO3E9altvKytdOyl7dGhpcy5wdXNoKHEscixjLG0sbixwKTt9fX0sIj4iOmZ1bmN0aW9uKGssYyxtLGosaSxsKXtpZigoaz1rLmZpcnN0Q2hpbGQpKXtkb3tpZihrLm5vZGVUeXBlPT09MSl7dGhpcy5wdXNoKGssYyxtLGosaSxsKTt9fXdoaWxlKChrPWsubmV4dFNpYmxpbmcpKTsKfX0sIisiOmZ1bmN0aW9uKGssYyxtLGosaSxsKXt3aGlsZSgoaz1rLm5leHRTaWJsaW5nKSl7aWYoay5ub2RlVHlwZT09PTEpe3RoaXMucHVzaChrLGMsbSxqLGksbCk7YnJlYWs7fX19LCJeIjpmdW5jdGlvbihrLGMsbSxqLGksbCl7az1rLmZpcnN0Q2hpbGQ7aWYoayl7aWYoay5ub2RlVHlwZT09PTEpe3RoaXMucHVzaChrLGMsbSxqLGksbCk7Cn1lbHNle3RoaXNbImNvbWJpbmF0b3I6KyJdKGssYyxtLGosaSxsKTt9fX0sIn4iOmZ1bmN0aW9uKGwsYyxuLGssaSxtKXt3aGlsZSgobD1sLm5leHRTaWJsaW5nKSl7aWYobC5ub2RlVHlwZSE9PTEpe2NvbnRpbnVlO312YXIgaj10aGlzLmdldFVJRChsKTtpZih0aGlzLmJpdFVuaXF1ZXNbal0pe2JyZWFrOwp9dGhpcy5iaXRVbmlxdWVzW2pdPXRydWU7dGhpcy5wdXNoKGwsYyxuLGssaSxtKTt9fSwiKysiOmZ1bmN0aW9uKGssYyxtLGosaSxsKXt0aGlzWyJjb21iaW5hdG9yOisiXShrLGMsbSxqLGksbCk7dGhpc1siY29tYmluYXRvcjohKyJdKGssYyxtLGosaSxsKTt9LCJ+fiI6ZnVuY3Rpb24oayxjLG0saixpLGwpe3RoaXNbImNvbWJpbmF0b3I6fiJdKGssYyxtLGosaSxsKTsKdGhpc1siY29tYmluYXRvcjohfiJdKGssYyxtLGosaSxsKTt9LCIhIjpmdW5jdGlvbihrLGMsbSxqLGksbCl7d2hpbGUoKGs9ay5wYXJlbnROb2RlKSl7aWYoayE9PXRoaXMuZG9jdW1lbnQpe3RoaXMucHVzaChrLGMsbSxqLGksbCk7fX19LCIhPiI6ZnVuY3Rpb24oayxjLG0saixpLGwpe2s9ay5wYXJlbnROb2RlOwppZihrIT09dGhpcy5kb2N1bWVudCl7dGhpcy5wdXNoKGssYyxtLGosaSxsKTt9fSwiISsiOmZ1bmN0aW9uKGssYyxtLGosaSxsKXt3aGlsZSgoaz1rLnByZXZpb3VzU2libGluZykpe2lmKGsubm9kZVR5cGU9PT0xKXt0aGlzLnB1c2goayxjLG0saixpLGwpO2JyZWFrOwp9fX0sIiFeIjpmdW5jdGlvbihrLGMsbSxqLGksbCl7az1rLmxhc3RDaGlsZDtpZihrKXtpZihrLm5vZGVUeXBlPT09MSl7dGhpcy5wdXNoKGssYyxtLGosaSxsKTt9ZWxzZXt0aGlzWyJjb21iaW5hdG9yOiErIl0oayxjLG0saixpLGwpO319fSwiIX4iOmZ1bmN0aW9uKGwsYyxuLGssaSxtKXt3aGlsZSgobD1sLnByZXZpb3VzU2libGluZykpe2lmKGwubm9kZVR5cGUhPT0xKXtjb250aW51ZTsKfXZhciBqPXRoaXMuZ2V0VUlEKGwpO2lmKHRoaXMuYml0VW5pcXVlc1tqXSl7YnJlYWs7fXRoaXMuYml0VW5pcXVlc1tqXT10cnVlO3RoaXMucHVzaChsLGMsbixrLGksbSk7fX19O2Zvcih2YXIgaCBpbiBhKXtiWyJjb21iaW5hdG9yOiIraF09YVtoXTt9dmFyIGc9e2VtcHR5OmZ1bmN0aW9uKGMpe3ZhciBpPWMuZmlyc3RDaGlsZDsKcmV0dXJuICEoaSYmaS5ub2RlVHlwZT09MSkmJiEoYy5pbm5lclRleHR8fGMudGV4dENvbnRlbnR8fCIiKS5sZW5ndGg7fSxub3Q6ZnVuY3Rpb24oYyxpKXtyZXR1cm4gIXRoaXMubWF0Y2hOb2RlKGMsaSk7fSxjb250YWluczpmdW5jdGlvbihjLGkpe3JldHVybihjLmlubmVyVGV4dHx8Yy50ZXh0Q29udGVudHx8IiIpLmluZGV4T2YoaSk+LTE7Cn0sImZpcnN0LWNoaWxkIjpmdW5jdGlvbihjKXt3aGlsZSgoYz1jLnByZXZpb3VzU2libGluZykpe2lmKGMubm9kZVR5cGU9PT0xKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTt9LCJsYXN0LWNoaWxkIjpmdW5jdGlvbihjKXt3aGlsZSgoYz1jLm5leHRTaWJsaW5nKSl7aWYoYy5ub2RlVHlwZT09PTEpe3JldHVybiBmYWxzZTsKfX1yZXR1cm4gdHJ1ZTt9LCJvbmx5LWNoaWxkIjpmdW5jdGlvbihqKXt2YXIgaT1qO3doaWxlKChpPWkucHJldmlvdXNTaWJsaW5nKSl7aWYoaS5ub2RlVHlwZT09PTEpe3JldHVybiBmYWxzZTt9fXZhciBjPWo7d2hpbGUoKGM9Yy5uZXh0U2libGluZykpe2lmKGMubm9kZVR5cGU9PT0xKXtyZXR1cm4gZmFsc2U7Cn19cmV0dXJuIHRydWU7fSwibnRoLWNoaWxkIjpiLmNyZWF0ZU5USFBzZXVkbygiZmlyc3RDaGlsZCIsIm5leHRTaWJsaW5nIiwicG9zTlRIIiksIm50aC1sYXN0LWNoaWxkIjpiLmNyZWF0ZU5USFBzZXVkbygibGFzdENoaWxkIiwicHJldmlvdXNTaWJsaW5nIiwicG9zTlRITGFzdCIpLCJudGgtb2YtdHlwZSI6Yi5jcmVhdGVOVEhQc2V1ZG8oImZpcnN0Q2hpbGQiLCJuZXh0U2libGluZyIsInBvc05USFR5cGUiLHRydWUpLCJudGgtbGFzdC1vZi10eXBlIjpiLmNyZWF0ZU5USFBzZXVkbygibGFzdENoaWxkIiwicHJldmlvdXNTaWJsaW5nIiwicG9zTlRIVHlwZUxhc3QiLHRydWUpLGluZGV4OmZ1bmN0aW9uKGksYyl7cmV0dXJuIHRoaXNbInBzZXVkbzpudGgtY2hpbGQiXShpLCIiK2MrMSk7Cn0sZXZlbjpmdW5jdGlvbihpLGMpe3JldHVybiB0aGlzWyJwc2V1ZG86bnRoLWNoaWxkIl0oaSwiMm4iKTt9LG9kZDpmdW5jdGlvbihpLGMpe3JldHVybiB0aGlzWyJwc2V1ZG86bnRoLWNoaWxkIl0oaSwiMm4rMSIpO30sImZpcnN0LW9mLXR5cGUiOmZ1bmN0aW9uKGMpe3ZhciBpPWMubm9kZU5hbWU7CndoaWxlKChjPWMucHJldmlvdXNTaWJsaW5nKSl7aWYoYy5ub2RlTmFtZT09PWkpe3JldHVybiBmYWxzZTt9fXJldHVybiB0cnVlO30sImxhc3Qtb2YtdHlwZSI6ZnVuY3Rpb24oYyl7dmFyIGk9Yy5ub2RlTmFtZTt3aGlsZSgoYz1jLm5leHRTaWJsaW5nKSl7aWYoYy5ub2RlTmFtZT09PWkpe3JldHVybiBmYWxzZTsKfX1yZXR1cm4gdHJ1ZTt9LCJvbmx5LW9mLXR5cGUiOmZ1bmN0aW9uKGope3ZhciBpPWosaz1qLm5vZGVOYW1lO3doaWxlKChpPWkucHJldmlvdXNTaWJsaW5nKSl7aWYoaS5ub2RlTmFtZT09PWspe3JldHVybiBmYWxzZTt9fXZhciBjPWo7d2hpbGUoKGM9Yy5uZXh0U2libGluZykpe2lmKGMubm9kZU5hbWU9PT1rKXtyZXR1cm4gZmFsc2U7Cn19cmV0dXJuIHRydWU7fSxlbmFibGVkOmZ1bmN0aW9uKGMpe3JldHVybihjLmRpc2FibGVkPT09ZmFsc2UpO30sZGlzYWJsZWQ6ZnVuY3Rpb24oYyl7cmV0dXJuKGMuZGlzYWJsZWQ9PT10cnVlKTt9LGNoZWNrZWQ6ZnVuY3Rpb24oYyl7cmV0dXJuIGMuY2hlY2tlZHx8Yy5zZWxlY3RlZDsKfSxmb2N1czpmdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5pc0hUTUxEb2N1bWVudCYmdGhpcy5kb2N1bWVudC5hY3RpdmVFbGVtZW50PT09YyYmKGMuaHJlZnx8Yy50eXBlfHx0aGlzLmhhc0F0dHJpYnV0ZShjLCJ0YWJpbmRleCIpKTt9LHJvb3Q6ZnVuY3Rpb24oYyl7cmV0dXJuKGM9PT10aGlzLnJvb3QpOwp9LHNlbGVjdGVkOmZ1bmN0aW9uKGMpe3JldHVybiBjLnNlbGVjdGVkO319O2Zvcih2YXIgZCBpbiBnKXtiWyJwc2V1ZG86IitkXT1nW2RdO31iLmF0dHJpYnV0ZUdldHRlcnM9eyJjbGFzcyI6ZnVuY3Rpb24oKXtyZXR1cm4oImNsYXNzTmFtZSIgaW4gdGhpcyk/dGhpcy5jbGFzc05hbWU6dGhpcy5nZXRBdHRyaWJ1dGUoImNsYXNzIik7Cn0sImZvciI6ZnVuY3Rpb24oKXtyZXR1cm4oImh0bWxGb3IiIGluIHRoaXMpP3RoaXMuaHRtbEZvcjp0aGlzLmdldEF0dHJpYnV0ZSgiZm9yIik7fSxocmVmOmZ1bmN0aW9uKCl7cmV0dXJuKCJocmVmIiBpbiB0aGlzKT90aGlzLmdldEF0dHJpYnV0ZSgiaHJlZiIsMik6dGhpcy5nZXRBdHRyaWJ1dGUoImhyZWYiKTsKfSxzdHlsZTpmdW5jdGlvbigpe3JldHVybih0aGlzLnN0eWxlKT90aGlzLnN0eWxlLmNzc1RleHQ6dGhpcy5nZXRBdHRyaWJ1dGUoInN0eWxlIik7fX07Yi5nZXRBdHRyaWJ1dGU9ZnVuY3Rpb24oaixjKXt2YXIgaz10aGlzLmF0dHJpYnV0ZUdldHRlcnNbY107aWYoayl7cmV0dXJuIGsuY2FsbChqKTsKfXZhciBpPWouZ2V0QXR0cmlidXRlTm9kZShjKTtyZXR1cm4gaT9pLm5vZGVWYWx1ZTpudWxsO307Yi5vdmVycmlkZXM9W107Yi5vdmVycmlkZT1mdW5jdGlvbihjLGkpe3RoaXMub3ZlcnJpZGVzLnB1c2goe3JlZ2V4cDpjLG1ldGhvZDppfSk7fTt2YXIgZj0vXFsuKlsqJF5dPSg/OlsiJ117Mn0pP1xdLzsKYi5vdmVycmlkZSgvLi8sZnVuY3Rpb24ocCxuLG8pe2lmKCF0aGlzLnF1ZXJ5U2VsZWN0b3JBbGx8fHRoaXMubm9kZVR5cGUhPTl8fCFiLmlzSFRNTERvY3VtZW50fHxiLmJyb2tlbk1peGVkQ2FzZVFTQXx8KGIuYnJva2VuQ2hlY2tlZFFTQSYmcC5pbmRleE9mKCI6Y2hlY2tlZCIpPi0xKXx8KGIuYnJva2VuRW1wdHlBdHRyaWJ1dGVRU0EmJmYudGVzdChwKSl8fGUuZGlzYWJsZVFTQSl7cmV0dXJuIGZhbHNlOwp9dmFyIGosbTt0cnl7aWYobyl7cmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvcihwKXx8bnVsbDt9ZWxzZXtqPXRoaXMucXVlcnlTZWxlY3RvckFsbChwKTt9fWNhdGNoKGspe3JldHVybiBmYWxzZTt9dmFyIGwsYz0hIShuLmxlbmd0aCk7aWYoYi5zdGFyU2VsZWN0c0Nsb3NlZFFTQSl7Zm9yKGw9MDsKbT1qW2wrK107KXtpZihtLm5vZGVOYW1lPiJAIiYmKCFjfHwhYi51bmlxdWVzW2IuZ2V0VUlESFRNTChtKV0pKXtuLnB1c2gobSk7fX19ZWxzZXtmb3IobD0wO209altsKytdOyl7aWYoIWN8fCFiLnVuaXF1ZXNbYi5nZXRVSURIVE1MKG0pXSl7bi5wdXNoKG0pO319fWlmKGMpe2Iuc29ydChuKTsKfXJldHVybiB0cnVlO30pO2Iub3ZlcnJpZGUoL15bXHctXSskfF5cKiQvLGZ1bmN0aW9uKHAsbixvKXt2YXIgaj1wO2lmKGo9PSIqIiYmYi5icm9rZW5TdGFyR0VCVE4pe3JldHVybiBmYWxzZTt9dmFyIGs9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZShqKTtpZihvKXtyZXR1cm4ga1swXXx8bnVsbDsKfXZhciBsLG0sYz0hIShuLmxlbmd0aCk7Zm9yKGw9MDttPWtbbCsrXTspe2lmKCFjfHwhYi51bmlxdWVzW2IuZ2V0VUlEKG0pXSl7bi5wdXNoKG0pO319aWYoYyl7Yi5zb3J0KG4pO31yZXR1cm4gdHJ1ZTt9KTtiLm92ZXJyaWRlKC9eXC5bXHctXSskLyxmdW5jdGlvbihvLHEsbSl7aWYoIWIuaXNIVE1MRG9jdW1lbnR8fCghdGhpcy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZ0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwpKXtyZXR1cm4gZmFsc2U7Cn12YXIgYyxrLGwsaj0hIShxJiZxLmxlbmd0aCkscD1vLnN1YnN0cmluZygxKTtpZih0aGlzLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJiFiLmJyb2tlbkdFQkNOKXtjPXRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShwKTtpZihtKXtyZXR1cm4gY1swXXx8bnVsbDsKfWZvcihsPTA7az1jW2wrK107KXtpZighanx8IWIudW5pcXVlc1tiLmdldFVJREhUTUwoayldKXtxLnB1c2goayk7fX19ZWxzZXt2YXIgbj1uZXcgUmVnRXhwKCIoXnxcXHMpIitlLmVzY2FwZVJlZ0V4cChwKSsiKFxcc3wkKSIpO2M9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpOwpmb3IobD0wO2s9Y1tsKytdOyl7cD1rLmNsYXNzTmFtZTtpZighcHx8IW4udGVzdChwKSl7Y29udGludWU7fWlmKG0pe3JldHVybiBrO31pZighanx8IWIudW5pcXVlc1tiLmdldFVJREhUTUwoayldKXtxLnB1c2goayk7fX19aWYoail7Yi5zb3J0KHEpO31yZXR1cm4obSk/bnVsbDp0cnVlOwp9KTtiLm92ZXJyaWRlKC9eI1tcdy1dKyQvLGZ1bmN0aW9uKGwsaixrKXtpZighYi5pc0hUTUxEb2N1bWVudHx8dGhpcy5ub2RlVHlwZSE9OSl7cmV0dXJuIGZhbHNlO312YXIgbT1sLnN1YnN0cmluZygxKSxpPXRoaXMuZ2V0RWxlbWVudEJ5SWQobSk7aWYoIWkpe3JldHVybiBqOwp9aWYoYi5pZEdldHNOYW1lJiZpLmdldEF0dHJpYnV0ZU5vZGUoImlkIikubm9kZVZhbHVlIT1tKXtyZXR1cm4gZmFsc2U7fWlmKGspe3JldHVybiBpfHxudWxsO312YXIgYz0hIShqLmxlbmd0aCk7aWYoIWN8fCFiLnVuaXF1ZXNbYi5nZXRVSURIVE1MKGkpXSl7ai5wdXNoKGkpOwp9aWYoYyl7Yi5zb3J0KGopO31yZXR1cm4gdHJ1ZTt9KTtpZih0eXBlb2YgZG9jdW1lbnQhPSJ1bmRlZmluZWQiKXtiLnNldERvY3VtZW50KGRvY3VtZW50KTt9dmFyIGU9Yi5TbGljaz0odGhpcy5TbGlja3x8e30pO2UudmVyc2lvbj0iMC45ZGV2IjtlLnNlYXJjaD1mdW5jdGlvbihpLGosYyl7cmV0dXJuIGIuc2VhcmNoKGksaixjKTsKfTtlLmZpbmQ9ZnVuY3Rpb24oYyxpKXtyZXR1cm4gYi5zZWFyY2goYyxpLG51bGwsdHJ1ZSk7fTtlLmNvbnRhaW5zPWZ1bmN0aW9uKGMsaSl7Yi5zZXREb2N1bWVudChjKTtyZXR1cm4gYi5jb250YWlucyhjLGkpO307ZS5nZXRBdHRyaWJ1dGU9ZnVuY3Rpb24oaSxjKXtyZXR1cm4gYi5nZXRBdHRyaWJ1dGUoaSxjKTsKfTtlLm1hdGNoPWZ1bmN0aW9uKGksYyl7aWYoIShpJiZjKSl7cmV0dXJuIGZhbHNlO31pZighY3x8Yz09PWkpe3JldHVybiB0cnVlO31pZih0eXBlb2YgYyE9InN0cmluZyIpe3JldHVybiBmYWxzZTt9Yi5zZXREb2N1bWVudChpKTtyZXR1cm4gYi5tYXRjaE5vZGUoaSxjKTsKfTtlLmRlZmluZUF0dHJpYnV0ZUdldHRlcj1mdW5jdGlvbihjLGkpe2IuYXR0cmlidXRlR2V0dGVyc1tjXT1pO3JldHVybiB0aGlzO307ZS5sb29rdXBBdHRyaWJ1dGVHZXR0ZXI9ZnVuY3Rpb24oYyl7cmV0dXJuIGIuYXR0cmlidXRlR2V0dGVyc1tjXTt9O2UuZGVmaW5lUHNldWRvPWZ1bmN0aW9uKGMsaSl7YlsicHNldWRvOiIrY109ZnVuY3Rpb24oayxqKXtyZXR1cm4gaS5jYWxsKGssaik7Cn07cmV0dXJuIHRoaXM7fTtlLmxvb2t1cFBzZXVkbz1mdW5jdGlvbihjKXt2YXIgaT1iWyJwc2V1ZG86IitjXTtpZihpKXtyZXR1cm4gZnVuY3Rpb24oail7cmV0dXJuIGkuY2FsbCh0aGlzLGopO307fXJldHVybiBudWxsO307ZS5vdmVycmlkZT1mdW5jdGlvbihpLGMpe2Iub3ZlcnJpZGUoaSxjKTsKcmV0dXJuIHRoaXM7fTtlLmlzWE1MPWIuaXNYTUw7ZS51aWRPZj1mdW5jdGlvbihjKXtyZXR1cm4gYi5nZXRVSURIVE1MKGMpO307aWYoIXRoaXMuU2xpY2spe3RoaXMuU2xpY2s9ZTt9fSkuYXBwbHkoKHR5cGVvZiBleHBvcnRzIT0idW5kZWZpbmVkIik/ZXhwb3J0czp0aGlzKTsKdmFyIEVsZW1lbnQ9ZnVuY3Rpb24oYixnKXt2YXIgaD1FbGVtZW50LkNvbnN0cnVjdG9yc1tiXTtpZihoKXtyZXR1cm4gaChnKTt9aWYodHlwZW9mIGIhPSJzdHJpbmciKXtyZXR1cm4gZG9jdW1lbnQuaWQoYikuc2V0KGcpO31pZighZyl7Zz17fTt9aWYoIWIudGVzdCgvXltcdy1dKyQvKSl7dmFyIGU9U2xpY2sucGFyc2UoYikuZXhwcmVzc2lvbnNbMF1bMF07CmI9KGUudGFnPT0iKiIpPyJkaXYiOmUudGFnO2lmKGUuaWQmJmcuaWQ9PW51bGwpe2cuaWQ9ZS5pZDt9dmFyIGQ9ZS5hdHRyaWJ1dGVzO2lmKGQpe2Zvcih2YXIgZj0wLGM9ZC5sZW5ndGg7ZjxjO2YrKyl7dmFyIGE9ZFtmXTtpZihhLnZhbHVlIT1udWxsJiZhLm9wZXJhdG9yPT0iPSImJmdbYS5rZXldPT1udWxsKXtnW2Eua2V5XT1hLnZhbHVlOwp9fX1pZihlLmNsYXNzTGlzdCYmZ1siY2xhc3MiXT09bnVsbCl7Z1siY2xhc3MiXT1lLmNsYXNzTGlzdC5qb2luKCIgIik7fX1yZXR1cm4gZG9jdW1lbnQubmV3RWxlbWVudChiLGcpO307aWYoQnJvd3Nlci5FbGVtZW50KXtFbGVtZW50LnByb3RvdHlwZT1Ccm93c2VyLkVsZW1lbnQucHJvdG90eXBlOwp9bmV3IFR5cGUoIkVsZW1lbnQiLEVsZW1lbnQpLm1pcnJvcihmdW5jdGlvbihhKXtpZihBcnJheS5wcm90b3R5cGVbYV0pe3JldHVybjt9dmFyIGI9e307YlthXT1mdW5jdGlvbigpe3ZhciBoPVtdLGU9YXJndW1lbnRzLGo9dHJ1ZTtmb3IodmFyIGc9MCxkPXRoaXMubGVuZ3RoOwpnPGQ7ZysrKXt2YXIgZj10aGlzW2ddLGM9aFtnXT1mW2FdLmFwcGx5KGYsZSk7aj0oaiYmdHlwZU9mKGMpPT0iZWxlbWVudCIpO31yZXR1cm4oaik/bmV3IEVsZW1lbnRzKGgpOmg7fTtFbGVtZW50cy5pbXBsZW1lbnQoYik7fSk7aWYoIUJyb3dzZXIuRWxlbWVudCl7RWxlbWVudC5wYXJlbnQ9T2JqZWN0OwpFbGVtZW50LlByb3RvdHlwZT17IiRmYW1pbHkiOkZ1bmN0aW9uLmZyb20oImVsZW1lbnQiKS5oaWRlKCl9O0VsZW1lbnQubWlycm9yKGZ1bmN0aW9uKGEsYil7RWxlbWVudC5Qcm90b3R5cGVbYV09Yjt9KTt9RWxlbWVudC5Db25zdHJ1Y3RvcnM9e307RWxlbWVudC5Db25zdHJ1Y3RvcnM9bmV3IEhhc2g7CnZhciBJRnJhbWU9bmV3IFR5cGUoIklGcmFtZSIsZnVuY3Rpb24oKXt2YXIgZT1BcnJheS5saW5rKGFyZ3VtZW50cyx7cHJvcGVydGllczpUeXBlLmlzT2JqZWN0LGlmcmFtZTpmdW5jdGlvbihmKXtyZXR1cm4oZiE9bnVsbCk7fX0pO3ZhciBjPWUucHJvcGVydGllc3x8e30sYjsKaWYoZS5pZnJhbWUpe2I9ZG9jdW1lbnQuaWQoZS5pZnJhbWUpO312YXIgZD1jLm9ubG9hZHx8ZnVuY3Rpb24oKXt9O2RlbGV0ZSBjLm9ubG9hZDtjLmlkPWMubmFtZT1bYy5pZCxjLm5hbWUsYj8oYi5pZHx8Yi5uYW1lKToiSUZyYW1lXyIrU3RyaW5nLnVuaXF1ZUlEKCldLnBpY2soKTsKYj1uZXcgRWxlbWVudChifHwiaWZyYW1lIixjKTt2YXIgYT1mdW5jdGlvbigpe2QuY2FsbChiLmNvbnRlbnRXaW5kb3cpO307aWYod2luZG93LmZyYW1lc1tjLmlkXSl7YSgpO31lbHNle2IuYWRkTGlzdGVuZXIoImxvYWQiLGEpO31yZXR1cm4gYjt9KTt2YXIgRWxlbWVudHM9dGhpcy5FbGVtZW50cz1mdW5jdGlvbihhKXtpZihhJiZhLmxlbmd0aCl7dmFyIGU9e30sZDsKZm9yKHZhciBjPTA7ZD1hW2MrK107KXt2YXIgYj1TbGljay51aWRPZihkKTtpZighZVtiXSl7ZVtiXT10cnVlO3RoaXMucHVzaChkKTt9fX19O0VsZW1lbnRzLnByb3RvdHlwZT17bGVuZ3RoOjB9O0VsZW1lbnRzLnBhcmVudD1BcnJheTtuZXcgVHlwZSgiRWxlbWVudHMiLEVsZW1lbnRzKS5pbXBsZW1lbnQoe2ZpbHRlcjpmdW5jdGlvbihhLGIpe2lmKCFhKXtyZXR1cm4gdGhpczsKfXJldHVybiBuZXcgRWxlbWVudHMoQXJyYXkuZmlsdGVyKHRoaXMsKHR5cGVPZihhKT09InN0cmluZyIpP2Z1bmN0aW9uKGMpe3JldHVybiBjLm1hdGNoKGEpO306YSxiKSk7fS5wcm90ZWN0KCkscHVzaDpmdW5jdGlvbigpe3ZhciBkPXRoaXMubGVuZ3RoO2Zvcih2YXIgYj0wLGE9YXJndW1lbnRzLmxlbmd0aDsKYjxhO2IrKyl7dmFyIGM9ZG9jdW1lbnQuaWQoYXJndW1lbnRzW2JdKTtpZihjKXt0aGlzW2QrK109Yzt9fXJldHVybih0aGlzLmxlbmd0aD1kKTt9LnByb3RlY3QoKSxjb25jYXQ6ZnVuY3Rpb24oKXt2YXIgYj1uZXcgRWxlbWVudHModGhpcyk7Zm9yKHZhciBjPTAsYT1hcmd1bWVudHMubGVuZ3RoOwpjPGE7YysrKXt2YXIgZD1hcmd1bWVudHNbY107aWYoVHlwZS5pc0VudW1lcmFibGUoZCkpe2IuYXBwZW5kKGQpO31lbHNle2IucHVzaChkKTt9fXJldHVybiBiO30ucHJvdGVjdCgpLGFwcGVuZDpmdW5jdGlvbihjKXtmb3IodmFyIGI9MCxhPWMubGVuZ3RoO2I8YTtiKyspe3RoaXMucHVzaChjW2JdKTsKfXJldHVybiB0aGlzO30ucHJvdGVjdCgpLGVtcHR5OmZ1bmN0aW9uKCl7d2hpbGUodGhpcy5sZW5ndGgpe2RlbGV0ZSB0aGlzWy0tdGhpcy5sZW5ndGhdO31yZXR1cm4gdGhpczt9LnByb3RlY3QoKX0pOyhmdW5jdGlvbigpe3ZhciBnPUFycmF5LnByb3RvdHlwZS5zcGxpY2UsYj17IjAiOjAsIjEiOjEsbGVuZ3RoOjJ9OwpnLmNhbGwoYiwxLDEpO2lmKGJbMV09PTEpe0VsZW1lbnRzLmltcGxlbWVudCgic3BsaWNlIixmdW5jdGlvbigpe3ZhciBlPXRoaXMubGVuZ3RoO2cuYXBwbHkodGhpcyxhcmd1bWVudHMpO3doaWxlKGU+PXRoaXMubGVuZ3RoKXtkZWxldGUgdGhpc1tlLS1dO31yZXR1cm4gdGhpczsKfS5wcm90ZWN0KCkpO31FbGVtZW50cy5pbXBsZW1lbnQoQXJyYXkucHJvdG90eXBlKTtBcnJheS5taXJyb3IoRWxlbWVudHMpO3ZhciBmO3RyeXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCI8aW5wdXQgbmFtZT14PiIpO2Y9KGEubmFtZT09IngiKTt9Y2F0Y2goYyl7fXZhciBkPWZ1bmN0aW9uKGUpe3JldHVybigiIitlKS5yZXBsYWNlKC8mL2csIiZhbXA7IikucmVwbGFjZSgvIi9nLCImcXVvdDsiKTsKfTtEb2N1bWVudC5pbXBsZW1lbnQoe25ld0VsZW1lbnQ6ZnVuY3Rpb24oZSxoKXtpZihoJiZoLmNoZWNrZWQhPW51bGwpe2guZGVmYXVsdENoZWNrZWQ9aC5jaGVja2VkO31pZihmJiZoKXtlPSI8IitlO2lmKGgubmFtZSl7ZSs9JyBuYW1lPSInK2QoaC5uYW1lKSsnIic7Cn1pZihoLnR5cGUpe2UrPScgdHlwZT0iJytkKGgudHlwZSkrJyInO31lKz0iPiI7ZGVsZXRlIGgubmFtZTtkZWxldGUgaC50eXBlO31yZXR1cm4gdGhpcy5pZCh0aGlzLmNyZWF0ZUVsZW1lbnQoZSkpLnNldChoKTt9fSk7fSkoKTtEb2N1bWVudC5pbXBsZW1lbnQoe25ld1RleHROb2RlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZVRleHROb2RlKGEpOwp9LGdldERvY3VtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7fSxnZXRXaW5kb3c6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53aW5kb3c7fSxpZDooZnVuY3Rpb24oKXt2YXIgYT17c3RyaW5nOmZ1bmN0aW9uKGQsYyxiKXtkPVNsaWNrLmZpbmQoYiwiIyIrZC5yZXBsYWNlKC8oXFcpL2csIlxcJDEiKSk7CnJldHVybihkKT9hLmVsZW1lbnQoZCxjKTpudWxsO30sZWxlbWVudDpmdW5jdGlvbihiLGMpeyR1aWQoYik7aWYoIWMmJiFiLiRmYW1pbHkmJiEoL15vYmplY3R8ZW1iZWQkL2kpLnRlc3QoYi50YWdOYW1lKSl7T2JqZWN0LmFwcGVuZChiLEVsZW1lbnQuUHJvdG90eXBlKTsKfXJldHVybiBiO30sb2JqZWN0OmZ1bmN0aW9uKGMsZCxiKXtpZihjLnRvRWxlbWVudCl7cmV0dXJuIGEuZWxlbWVudChjLnRvRWxlbWVudChiKSxkKTt9cmV0dXJuIG51bGw7fX07YS50ZXh0bm9kZT1hLndoaXRlc3BhY2U9YS53aW5kb3c9YS5kb2N1bWVudD1mdW5jdGlvbihiKXtyZXR1cm4gYjsKfTtyZXR1cm4gZnVuY3Rpb24oYyxlLGQpe2lmKGMmJmMuJGZhbWlseSYmYy51aWQpe3JldHVybiBjO312YXIgYj10eXBlT2YoYyk7cmV0dXJuKGFbYl0pP2FbYl0oYyxlLGR8fGRvY3VtZW50KTpudWxsO307fSkoKX0pO2lmKHdpbmRvdy4kPT1udWxsKXtXaW5kb3cuaW1wbGVtZW50KCIkIixmdW5jdGlvbihhLGIpe3JldHVybiBkb2N1bWVudC5pZChhLGIsdGhpcy5kb2N1bWVudCk7Cn0pO31XaW5kb3cuaW1wbGVtZW50KHtnZXREb2N1bWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvY3VtZW50O30sZ2V0V2luZG93OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7fX0pO1tEb2N1bWVudCxFbGVtZW50XS5pbnZva2UoImltcGxlbWVudCIse2dldEVsZW1lbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBTbGljay5zZWFyY2godGhpcyxhLG5ldyBFbGVtZW50cyk7Cn0sZ2V0RWxlbWVudDpmdW5jdGlvbihhKXtyZXR1cm4gZG9jdW1lbnQuaWQoU2xpY2suZmluZCh0aGlzLGEpKTt9fSk7KGZ1bmN0aW9uKGIsZCxhKXt0aGlzLlNlbGVjdG9ycz17fTt2YXIgZT10aGlzLlNlbGVjdG9ycy5Qc2V1ZG89bmV3IEhhc2goKTt2YXIgYz1mdW5jdGlvbigpe2Zvcih2YXIgZiBpbiBlKXtpZihlLmhhc093blByb3BlcnR5KGYpKXtTbGljay5kZWZpbmVQc2V1ZG8oZixlW2ZdKTsKZGVsZXRlIGVbZl07fX19O1NsaWNrLnNlYXJjaD1mdW5jdGlvbihnLGgsZil7YygpO3JldHVybiBiLmNhbGwodGhpcyxnLGgsZik7fTtTbGljay5maW5kPWZ1bmN0aW9uKGYsZyl7YygpO3JldHVybiBkLmNhbGwodGhpcyxmLGcpO307U2xpY2subWF0Y2g9ZnVuY3Rpb24oZyxmKXtjKCk7CnJldHVybiBhLmNhbGwodGhpcyxnLGYpO307fSkoU2xpY2suc2VhcmNoLFNsaWNrLmZpbmQsU2xpY2subWF0Y2gpO2lmKHdpbmRvdy4kJD09bnVsbCl7V2luZG93LmltcGxlbWVudCgiJCQiLGZ1bmN0aW9uKGEpe3ZhciBmPW5ldyBFbGVtZW50cztpZihhcmd1bWVudHMubGVuZ3RoPT0xJiZ0eXBlb2YgYT09InN0cmluZyIpe3JldHVybiBTbGljay5zZWFyY2godGhpcy5kb2N1bWVudCxhLGYpOwp9dmFyIGM9QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpO2Zvcih2YXIgZD0wLGI9Yy5sZW5ndGg7ZDxiO2QrKyl7dmFyIGU9Y1tkXTtzd2l0Y2godHlwZU9mKGUpKXtjYXNlImVsZW1lbnQiOmYucHVzaChlKTticmVhaztjYXNlInN0cmluZyI6U2xpY2suc2VhcmNoKHRoaXMuZG9jdW1lbnQsZSxmKTsKfX1yZXR1cm4gZjt9KTt9aWYod2luZG93LiQkPT1udWxsKXtXaW5kb3cuaW1wbGVtZW50KCIkJCIsZnVuY3Rpb24oYSl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7aWYodHlwZW9mIGE9PSJzdHJpbmciKXtyZXR1cm4gU2xpY2suc2VhcmNoKHRoaXMuZG9jdW1lbnQsYSxuZXcgRWxlbWVudHMpOwp9ZWxzZXtpZihUeXBlLmlzRW51bWVyYWJsZShhKSl7cmV0dXJuIG5ldyBFbGVtZW50cyhhKTt9fX1yZXR1cm4gbmV3IEVsZW1lbnRzKGFyZ3VtZW50cyk7fSk7fShmdW5jdGlvbigpe3ZhciBqPXt9LGg9e307dmFyIGw9e2lucHV0OiJjaGVja2VkIixvcHRpb246InNlbGVjdGVkIix0ZXh0YXJlYToidmFsdWUifTsKdmFyIGQ9ZnVuY3Rpb24obyl7cmV0dXJuKGhbb118fChoW29dPXt9KSk7fTt2YXIgaT1mdW5jdGlvbihwKXtpZihwLnJlbW92ZUV2ZW50cyl7cC5yZW1vdmVFdmVudHMoKTt9aWYocC5jbGVhckF0dHJpYnV0ZXMpe3AuY2xlYXJBdHRyaWJ1dGVzKCk7fXZhciBvPXAudWlkOwppZihvIT1udWxsKXtkZWxldGUgaltvXTtkZWxldGUgaFtvXTt9cmV0dXJuIHA7fTt2YXIgbj1bImRlZmF1bHRWYWx1ZSIsImFjY2Vzc0tleSIsImNlbGxQYWRkaW5nIiwiY2VsbFNwYWNpbmciLCJjb2xTcGFuIiwiZnJhbWVCb3JkZXIiLCJtYXhMZW5ndGgiLCJyZWFkT25seSIsInJvd1NwYW4iLCJ0YWJJbmRleCIsInVzZU1hcCJdOwp2YXIgYz1bImNvbXBhY3QiLCJub3dyYXAiLCJpc21hcCIsImRlY2xhcmUiLCJub3NoYWRlIiwiY2hlY2tlZCIsImRpc2FibGVkIiwicmVhZE9ubHkiLCJtdWx0aXBsZSIsInNlbGVjdGVkIiwibm9yZXNpemUiLCJkZWZlciJdO3ZhciBmPXtodG1sOiJpbm5lckhUTUwiLCJjbGFzcyI6ImNsYXNzTmFtZSIsImZvciI6Imh0bWxGb3IiLHRleHQ6KGZ1bmN0aW9uKCl7dmFyIG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CnJldHVybihvLmlubmVyVGV4dD09bnVsbCk/InRleHRDb250ZW50IjoiaW5uZXJUZXh0Ijt9KSgpfTt2YXIgbT1bInR5cGUiXTt2YXIgZz1bInZhbHVlIiwiZGVmYXVsdFZhbHVlIl07dmFyIGs9L14oPzpocmVmfHNyY3x1c2VtYXApJC9pO2M9Yy5hc3NvY2lhdGUoYyk7Cm49bi5hc3NvY2lhdGUobi5tYXAoU3RyaW5nLnRvTG93ZXJDYXNlKSk7bT1tLmFzc29jaWF0ZShtKTtPYmplY3QuYXBwZW5kKGYsZy5hc3NvY2lhdGUoZykpO3ZhciBiPXtiZWZvcmU6ZnVuY3Rpb24ocCxvKXt2YXIgcT1vLnBhcmVudE5vZGU7aWYocSl7cS5pbnNlcnRCZWZvcmUocCxvKTsKfX0sYWZ0ZXI6ZnVuY3Rpb24ocCxvKXt2YXIgcT1vLnBhcmVudE5vZGU7aWYocSl7cS5pbnNlcnRCZWZvcmUocCxvLm5leHRTaWJsaW5nKTt9fSxib3R0b206ZnVuY3Rpb24ocCxvKXtvLmFwcGVuZENoaWxkKHApO30sdG9wOmZ1bmN0aW9uKHAsbyl7by5pbnNlcnRCZWZvcmUocCxvLmZpcnN0Q2hpbGQpOwp9fTtiLmluc2lkZT1iLmJvdHRvbTtPYmplY3QuZWFjaChiLGZ1bmN0aW9uKHAscSl7cT1xLmNhcGl0YWxpemUoKTt2YXIgbz17fTtvWyJpbmplY3QiK3FdPWZ1bmN0aW9uKHIpe3AodGhpcyxkb2N1bWVudC5pZChyLHRydWUpKTtyZXR1cm4gdGhpczt9O29bImdyYWIiK3FdPWZ1bmN0aW9uKHIpe3AoZG9jdW1lbnQuaWQocix0cnVlKSx0aGlzKTsKcmV0dXJuIHRoaXM7fTtFbGVtZW50LmltcGxlbWVudChvKTt9KTt2YXIgYT1mdW5jdGlvbihyLHEpe2lmKCFyKXtyZXR1cm4gcTt9cj1TbGljay5wYXJzZShyKTt2YXIgcD1yLmV4cHJlc3Npb25zO2Zvcih2YXIgbz1wLmxlbmd0aDtvLS07KXtwW29dWzBdLmNvbWJpbmF0b3I9cTsKfXJldHVybiByO307RWxlbWVudC5pbXBsZW1lbnQoe3NldDpmdW5jdGlvbihxLHApe3ZhciBvPUVsZW1lbnQuUHJvcGVydGllc1txXTsobyYmby5zZXQpP28uc2V0LmNhbGwodGhpcyxwKTp0aGlzLnNldFByb3BlcnR5KHEscCk7fS5vdmVybG9hZFNldHRlcigpLGdldDpmdW5jdGlvbihwKXt2YXIgbz1FbGVtZW50LlByb3BlcnRpZXNbcF07CnJldHVybihvJiZvLmdldCk/by5nZXQuYXBwbHkodGhpcyk6dGhpcy5nZXRQcm9wZXJ0eShwKTt9Lm92ZXJsb2FkR2V0dGVyKCksZXJhc2U6ZnVuY3Rpb24ocCl7dmFyIG89RWxlbWVudC5Qcm9wZXJ0aWVzW3BdOyhvJiZvLmVyYXNlKT9vLmVyYXNlLmFwcGx5KHRoaXMpOnRoaXMucmVtb3ZlUHJvcGVydHkocCk7CnJldHVybiB0aGlzO30sc2V0UHJvcGVydHk6ZnVuY3Rpb24ocCxxKXtwPW5bcF18fHA7aWYocT09bnVsbCl7cmV0dXJuIHRoaXMucmVtb3ZlUHJvcGVydHkocCk7fXZhciBvPWZbcF07KG8pP3RoaXNbb109cTooY1twXSk/dGhpc1twXT0hIXE6dGhpcy5zZXRBdHRyaWJ1dGUocCwiIitxKTsKcmV0dXJuIHRoaXM7fSxzZXRQcm9wZXJ0aWVzOmZ1bmN0aW9uKG8pe2Zvcih2YXIgcCBpbiBvKXt0aGlzLnNldFByb3BlcnR5KHAsb1twXSk7fXJldHVybiB0aGlzO30sZ2V0UHJvcGVydHk6ZnVuY3Rpb24ocCl7cD1uW3BdfHxwO3ZhciBvPWZbcF18fG1bcF07cmV0dXJuKG8pP3RoaXNbb106KGNbcF0pPyEhdGhpc1twXTooay50ZXN0KHApP3RoaXMuZ2V0QXR0cmlidXRlKHAsMik6KG89dGhpcy5nZXRBdHRyaWJ1dGVOb2RlKHApKT9vLm5vZGVWYWx1ZTpudWxsKXx8bnVsbDsKfSxnZXRQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7dmFyIG89QXJyYXkuZnJvbShhcmd1bWVudHMpO3JldHVybiBvLm1hcCh0aGlzLmdldFByb3BlcnR5LHRoaXMpLmFzc29jaWF0ZShvKTt9LHJlbW92ZVByb3BlcnR5OmZ1bmN0aW9uKHApe3A9bltwXXx8cDt2YXIgbz1mW3BdOwoobyk/dGhpc1tvXT0iIjooY1twXSk/dGhpc1twXT1mYWxzZTp0aGlzLnJlbW92ZUF0dHJpYnV0ZShwKTtyZXR1cm4gdGhpczt9LHJlbW92ZVByb3BlcnRpZXM6ZnVuY3Rpb24oKXtBcnJheS5lYWNoKGFyZ3VtZW50cyx0aGlzLnJlbW92ZVByb3BlcnR5LHRoaXMpO3JldHVybiB0aGlzOwp9LGhhc0NsYXNzOmZ1bmN0aW9uKG8pe3JldHVybiB0aGlzLmNsYXNzTmFtZS5jbGVhbigpLmNvbnRhaW5zKG8sIiAiKTt9LGFkZENsYXNzOmZ1bmN0aW9uKG8pe2lmKCF0aGlzLmhhc0NsYXNzKG8pKXt0aGlzLmNsYXNzTmFtZT0odGhpcy5jbGFzc05hbWUrIiAiK28pLmNsZWFuKCk7Cn1yZXR1cm4gdGhpczt9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKG8pe3RoaXMuY2xhc3NOYW1lPXRoaXMuY2xhc3NOYW1lLnJlcGxhY2UobmV3IFJlZ0V4cCgiKF58XFxzKSIrbysiKD86XFxzfCQpIiksIiQxIik7cmV0dXJuIHRoaXM7fSx0b2dnbGVDbGFzczpmdW5jdGlvbihvLHApe2lmKHA9PW51bGwpe3A9IXRoaXMuaGFzQ2xhc3Mobyk7Cn1yZXR1cm4ocCk/dGhpcy5hZGRDbGFzcyhvKTp0aGlzLnJlbW92ZUNsYXNzKG8pO30sYWRvcHQ6ZnVuY3Rpb24oKXt2YXIgcj10aGlzLG8sdD1BcnJheS5mbGF0dGVuKGFyZ3VtZW50cykscz10Lmxlbmd0aDtpZihzPjEpe3I9bz1kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7Cn1mb3IodmFyIHE9MDtxPHM7cSsrKXt2YXIgcD1kb2N1bWVudC5pZCh0W3FdLHRydWUpO2lmKHApe3IuYXBwZW5kQ2hpbGQocCk7fX1pZihvKXt0aGlzLmFwcGVuZENoaWxkKG8pO31yZXR1cm4gdGhpczt9LGFwcGVuZFRleHQ6ZnVuY3Rpb24ocCxvKXtyZXR1cm4gdGhpcy5ncmFiKHRoaXMuZ2V0RG9jdW1lbnQoKS5uZXdUZXh0Tm9kZShwKSxvKTsKfSxncmFiOmZ1bmN0aW9uKHAsbyl7YltvfHwiYm90dG9tIl0oZG9jdW1lbnQuaWQocCx0cnVlKSx0aGlzKTtyZXR1cm4gdGhpczt9LGluamVjdDpmdW5jdGlvbihwLG8pe2Jbb3x8ImJvdHRvbSJdKHRoaXMsZG9jdW1lbnQuaWQocCx0cnVlKSk7cmV0dXJuIHRoaXM7fSxyZXBsYWNlczpmdW5jdGlvbihvKXtvPWRvY3VtZW50LmlkKG8sdHJ1ZSk7Cm8ucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodGhpcyxvKTtyZXR1cm4gdGhpczt9LHdyYXBzOmZ1bmN0aW9uKHAsbyl7cD1kb2N1bWVudC5pZChwLHRydWUpO3JldHVybiB0aGlzLnJlcGxhY2VzKHApLmdyYWIocCxvKTt9LGdldFByZXZpb3VzOmZ1bmN0aW9uKG8pe3JldHVybiBkb2N1bWVudC5pZChTbGljay5maW5kKHRoaXMsYShvLCIhfiIpKSk7Cn0sZ2V0QWxsUHJldmlvdXM6ZnVuY3Rpb24obyl7cmV0dXJuIFNsaWNrLnNlYXJjaCh0aGlzLGEobywiIX4iKSxuZXcgRWxlbWVudHMpO30sZ2V0TmV4dDpmdW5jdGlvbihvKXtyZXR1cm4gZG9jdW1lbnQuaWQoU2xpY2suZmluZCh0aGlzLGEobywifiIpKSk7fSxnZXRBbGxOZXh0OmZ1bmN0aW9uKG8pe3JldHVybiBTbGljay5zZWFyY2godGhpcyxhKG8sIn4iKSxuZXcgRWxlbWVudHMpOwp9LGdldEZpcnN0OmZ1bmN0aW9uKG8pe3JldHVybiBkb2N1bWVudC5pZChTbGljay5zZWFyY2godGhpcyxhKG8sIj4iKSlbMF0pO30sZ2V0TGFzdDpmdW5jdGlvbihvKXtyZXR1cm4gZG9jdW1lbnQuaWQoU2xpY2suc2VhcmNoKHRoaXMsYShvLCI+IikpLmdldExhc3QoKSk7Cn0sZ2V0UGFyZW50OmZ1bmN0aW9uKG8pe3JldHVybiBkb2N1bWVudC5pZChTbGljay5maW5kKHRoaXMsYShvLCIhIikpKTt9LGdldFBhcmVudHM6ZnVuY3Rpb24obyl7cmV0dXJuIFNsaWNrLnNlYXJjaCh0aGlzLGEobywiISIpLG5ldyBFbGVtZW50cyk7fSxnZXRTaWJsaW5nczpmdW5jdGlvbihvKXtyZXR1cm4gU2xpY2suc2VhcmNoKHRoaXMsYShvLCJ+fiIpLG5ldyBFbGVtZW50cyk7Cn0sZ2V0Q2hpbGRyZW46ZnVuY3Rpb24obyl7cmV0dXJuIFNsaWNrLnNlYXJjaCh0aGlzLGEobywiPiIpLG5ldyBFbGVtZW50cyk7fSxnZXRXaW5kb3c6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vd25lckRvY3VtZW50LndpbmRvdzt9LGdldERvY3VtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3duZXJEb2N1bWVudDsKfSxnZXRFbGVtZW50QnlJZDpmdW5jdGlvbihvKXtyZXR1cm4gZG9jdW1lbnQuaWQoU2xpY2suZmluZCh0aGlzLCIjIisoIiIrbykucmVwbGFjZSgvKFxXKS9nLCJcXCQxIikpKTt9LGdldFNlbGVjdGVkOmZ1bmN0aW9uKCl7dGhpcy5zZWxlY3RlZEluZGV4O3JldHVybiBuZXcgRWxlbWVudHMoQXJyYXkuZnJvbSh0aGlzLm9wdGlvbnMpLmZpbHRlcihmdW5jdGlvbihvKXtyZXR1cm4gby5zZWxlY3RlZDsKfSkpO30sdG9RdWVyeVN0cmluZzpmdW5jdGlvbigpe3ZhciBvPVtdO3RoaXMuZ2V0RWxlbWVudHMoImlucHV0LCBzZWxlY3QsIHRleHRhcmVhIikuZWFjaChmdW5jdGlvbihxKXt2YXIgcD1xLnR5cGU7aWYoIXEubmFtZXx8cS5kaXNhYmxlZHx8cD09InN1Ym1pdCJ8fHA9PSJyZXNldCJ8fHA9PSJmaWxlInx8cD09ImltYWdlIil7cmV0dXJuOwp9dmFyIHI9KHEuZ2V0KCJ0YWciKT09InNlbGVjdCIpP3EuZ2V0U2VsZWN0ZWQoKS5tYXAoZnVuY3Rpb24ocyl7cmV0dXJuIGRvY3VtZW50LmlkKHMpLmdldCgidmFsdWUiKTt9KTooKHA9PSJyYWRpbyJ8fHA9PSJjaGVja2JveCIpJiYhcS5jaGVja2VkKT9udWxsOnEuZ2V0KCJ2YWx1ZSIpOwpBcnJheS5mcm9tKHIpLmVhY2goZnVuY3Rpb24ocyl7aWYodHlwZW9mIHMhPSJ1bmRlZmluZWQiKXtvLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KHEubmFtZSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChzKSk7fX0pO30pO3JldHVybiBvLmpvaW4oIiYiKTt9LGNsb25lOmZ1bmN0aW9uKHIscCl7cj1yIT09ZmFsc2U7CnZhciB3PXRoaXMuY2xvbmVOb2RlKHIpO3ZhciB2PWZ1bmN0aW9uKEMsQil7aWYoIXApe0MucmVtb3ZlQXR0cmlidXRlKCJpZCIpO31pZihCcm93c2VyLmllKXtDLmNsZWFyQXR0cmlidXRlcygpO0MubWVyZ2VBdHRyaWJ1dGVzKEIpO0MucmVtb3ZlQXR0cmlidXRlKCJ1aWQiKTsKaWYoQy5vcHRpb25zKXt2YXIgRD1DLm9wdGlvbnMsej1CLm9wdGlvbnM7Zm9yKHZhciBBPUQubGVuZ3RoO0EtLTspe0RbQV0uc2VsZWN0ZWQ9eltBXS5zZWxlY3RlZDt9fX12YXIgRT1sW0IudGFnTmFtZS50b0xvd2VyQ2FzZSgpXTtpZihFJiZCW0VdKXtDW0VdPUJbRV07Cn19O3ZhciBzO2lmKHIpe3ZhciBvPXcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSxxPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKTtmb3Iocz1vLmxlbmd0aDtzLS07KXt2KG9bc10scVtzXSk7fX12KHcsdGhpcyk7aWYoQnJvd3Nlci5pZSl7dmFyIHU9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgib2JqZWN0IiksdD13LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJvYmplY3QiKSx5PXUubGVuZ3RoLHg9dC5sZW5ndGg7CmZvcihzPTA7czx5JiZzPHg7cysrKXt0W3NdLm91dGVySFRNTD11W3NdLm91dGVySFRNTDt9fXJldHVybiBkb2N1bWVudC5pZCh3KTt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgbz1pKHRoaXMpLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIik7QXJyYXkuZWFjaChvLGkpOwpFbGVtZW50LmRpc3Bvc2UodGhpcyk7cmV0dXJuIG51bGw7fSxlbXB0eTpmdW5jdGlvbigpe0FycmF5LmZyb20odGhpcy5jaGlsZE5vZGVzKS5lYWNoKEVsZW1lbnQuZGlzcG9zZSk7cmV0dXJuIHRoaXM7fSxkaXNwb3NlOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMucGFyZW50Tm9kZSk/dGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpOnRoaXM7Cn0sbWF0Y2g6ZnVuY3Rpb24obyl7cmV0dXJuICFvfHxTbGljay5tYXRjaCh0aGlzLG8pO319KTt2YXIgZT17Y29udGFpbnM6ZnVuY3Rpb24obyl7cmV0dXJuIFNsaWNrLmNvbnRhaW5zKHRoaXMsbyk7fX07aWYoIWRvY3VtZW50LmNvbnRhaW5zKXtEb2N1bWVudC5pbXBsZW1lbnQoZSk7Cn1pZighZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikuY29udGFpbnMpe0VsZW1lbnQuaW1wbGVtZW50KGUpO31FbGVtZW50LmltcGxlbWVudCgiaGFzQ2hpbGQiLGZ1bmN0aW9uKG8pe3JldHVybiB0aGlzIT09byYmdGhpcy5jb250YWlucyhvKTt9KTtbRWxlbWVudCxXaW5kb3csRG9jdW1lbnRdLmludm9rZSgiaW1wbGVtZW50Iix7YWRkTGlzdGVuZXI6ZnVuY3Rpb24ocixxKXtpZihyPT0idW5sb2FkIil7dmFyIG89cSxwPXRoaXM7CnE9ZnVuY3Rpb24oKXtwLnJlbW92ZUxpc3RlbmVyKCJ1bmxvYWQiLHEpO28oKTt9O31lbHNle2pbdGhpcy51aWRdPXRoaXM7fWlmKHRoaXMuYWRkRXZlbnRMaXN0ZW5lcil7dGhpcy5hZGRFdmVudExpc3RlbmVyKHIscSxmYWxzZSk7fWVsc2V7dGhpcy5hdHRhY2hFdmVudCgib24iK3IscSk7Cn1yZXR1cm4gdGhpczt9LHJlbW92ZUxpc3RlbmVyOmZ1bmN0aW9uKHAsbyl7aWYodGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKXt0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIocCxvLGZhbHNlKTt9ZWxzZXt0aGlzLmRldGFjaEV2ZW50KCJvbiIrcCxvKTt9cmV0dXJuIHRoaXM7Cn0scmV0cmlldmU6ZnVuY3Rpb24ocCxvKXt2YXIgcj1kKHRoaXMudWlkKSxxPXJbcF07aWYobyE9bnVsbCYmcT09bnVsbCl7cT1yW3BdPW87fXJldHVybiBxIT1udWxsP3E6bnVsbDt9LHN0b3JlOmZ1bmN0aW9uKHAsbyl7dmFyIHE9ZCh0aGlzLnVpZCk7cVtwXT1vO3JldHVybiB0aGlzOwp9LGVsaW1pbmF0ZTpmdW5jdGlvbihvKXt2YXIgcD1kKHRoaXMudWlkKTtkZWxldGUgcFtvXTtyZXR1cm4gdGhpczt9fSk7aWYod2luZG93LmF0dGFjaEV2ZW50JiYhd2luZG93LmFkZEV2ZW50TGlzdGVuZXIpe3dpbmRvdy5hZGRMaXN0ZW5lcigidW5sb2FkIixmdW5jdGlvbigpe09iamVjdC5lYWNoKGosaSk7CmlmKHdpbmRvdy5Db2xsZWN0R2FyYmFnZSl7Q29sbGVjdEdhcmJhZ2UoKTt9fSk7fX0pKCk7RWxlbWVudC5Qcm9wZXJ0aWVzPXt9O0VsZW1lbnQuUHJvcGVydGllcz1uZXcgSGFzaDtFbGVtZW50LlByb3BlcnRpZXMuc3R5bGU9e3NldDpmdW5jdGlvbihhKXt0aGlzLnN0eWxlLmNzc1RleHQ9YTsKfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdHlsZS5jc3NUZXh0O30sZXJhc2U6ZnVuY3Rpb24oKXt0aGlzLnN0eWxlLmNzc1RleHQ9IiI7fX07RWxlbWVudC5Qcm9wZXJ0aWVzLnRhZz17Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGFnTmFtZS50b0xvd2VyQ2FzZSgpOwp9fTsoZnVuY3Rpb24oYSl7aWYoYSE9bnVsbCl7RWxlbWVudC5Qcm9wZXJ0aWVzLm1heGxlbmd0aD1FbGVtZW50LlByb3BlcnRpZXMubWF4TGVuZ3RoPXtnZXQ6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLmdldEF0dHJpYnV0ZSgibWF4TGVuZ3RoIik7cmV0dXJuIGI9PWE/bnVsbDpiOwp9fTt9fSkoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKS5nZXRBdHRyaWJ1dGUoIm1heExlbmd0aCIpKTtFbGVtZW50LlByb3BlcnRpZXMuaHRtbD0oZnVuY3Rpb24oKXt2YXIgYz1GdW5jdGlvbi5hdHRlbXB0KGZ1bmN0aW9uKCl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGFibGUiKTsKZS5pbm5lckhUTUw9Ijx0cj48dGQ+PC90ZD48L3RyPiI7fSk7dmFyIGQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7dmFyIGE9e3RhYmxlOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSxzZWxlY3Q6WzEsIjxzZWxlY3Q+IiwiPC9zZWxlY3Q+Il0sdGJvZHk6WzIsIjx0YWJsZT48dGJvZHk+IiwiPC90Ym9keT48L3RhYmxlPiJdLHRyOlszLCI8dGFibGU+PHRib2R5Pjx0cj4iLCI8L3RyPjwvdGJvZHk+PC90YWJsZT4iXX07CmEudGhlYWQ9YS50Zm9vdD1hLnRib2R5O3ZhciBiPXtzZXQ6ZnVuY3Rpb24oKXt2YXIgZj1BcnJheS5mbGF0dGVuKGFyZ3VtZW50cykuam9pbigiIik7dmFyIGc9KCFjJiZhW3RoaXMuZ2V0KCJ0YWciKV0pO2lmKGcpe3ZhciBoPWQ7aC5pbm5lckhUTUw9Z1sxXStmK2dbMl07CmZvcih2YXIgZT1nWzBdO2UtLTspe2g9aC5maXJzdENoaWxkO310aGlzLmVtcHR5KCkuYWRvcHQoaC5jaGlsZE5vZGVzKTt9ZWxzZXt0aGlzLmlubmVySFRNTD1mO319fTtiLmVyYXNlPWIuc2V0O3JldHVybiBiO30pKCk7KGZ1bmN0aW9uKCl7dmFyIGM9ZG9jdW1lbnQuaHRtbDsKRWxlbWVudC5Qcm9wZXJ0aWVzLnN0eWxlcz17c2V0OmZ1bmN0aW9uKGYpe3RoaXMuc2V0U3R5bGVzKGYpO319O3ZhciBlPShjLnN0eWxlLm9wYWNpdHkhPW51bGwpO3ZhciBkPS9hbHBoYVwob3BhY2l0eT0oW1xkLl0rKVwpL2k7dmFyIGI9ZnVuY3Rpb24oZyxmKXtpZighZy5jdXJyZW50U3R5bGV8fCFnLmN1cnJlbnRTdHlsZS5oYXNMYXlvdXQpe2cuc3R5bGUuem9vbT0xOwp9aWYoZSl7Zy5zdHlsZS5vcGFjaXR5PWY7fWVsc2V7Zj0oZj09MSk/IiI6ImFscGhhKG9wYWNpdHk9IitmKjEwMCsiKSI7dmFyIGg9Zy5zdHlsZS5maWx0ZXJ8fGcuZ2V0Q29tcHV0ZWRTdHlsZSgiZmlsdGVyIil8fCIiO2cuc3R5bGUuZmlsdGVyPWgudGVzdChkKT9oLnJlcGxhY2UoZCxmKTpoK2Y7Cn19O0VsZW1lbnQuUHJvcGVydGllcy5vcGFjaXR5PXtzZXQ6ZnVuY3Rpb24oZyl7dmFyIGY9dGhpcy5zdHlsZS52aXNpYmlsaXR5O2lmKGc9PTAmJmYhPSJoaWRkZW4iKXt0aGlzLnN0eWxlLnZpc2liaWxpdHk9ImhpZGRlbiI7fWVsc2V7aWYoZyE9MCYmZiE9InZpc2libGUiKXt0aGlzLnN0eWxlLnZpc2liaWxpdHk9InZpc2libGUiOwp9fWIodGhpcyxnKTt9LGdldDooZSk/ZnVuY3Rpb24oKXt2YXIgZj10aGlzLnN0eWxlLm9wYWNpdHl8fHRoaXMuZ2V0Q29tcHV0ZWRTdHlsZSgib3BhY2l0eSIpO3JldHVybihmPT0iIik/MTpmO306ZnVuY3Rpb24oKXt2YXIgZixnPSh0aGlzLnN0eWxlLmZpbHRlcnx8dGhpcy5nZXRDb21wdXRlZFN0eWxlKCJmaWx0ZXIiKSk7CmlmKGcpe2Y9Zy5tYXRjaChkKTt9cmV0dXJuKGY9PW51bGx8fGc9PW51bGwpPzE6KGZbMV0vMTAwKTt9fTt2YXIgYT0oYy5zdHlsZS5jc3NGbG9hdD09bnVsbCk/InN0eWxlRmxvYXQiOiJjc3NGbG9hdCI7RWxlbWVudC5pbXBsZW1lbnQoe2dldENvbXB1dGVkU3R5bGU6ZnVuY3Rpb24oaCl7aWYodGhpcy5jdXJyZW50U3R5bGUpe3JldHVybiB0aGlzLmN1cnJlbnRTdHlsZVtoLmNhbWVsQ2FzZSgpXTsKfXZhciBnPUVsZW1lbnQuZ2V0RG9jdW1lbnQodGhpcykuZGVmYXVsdFZpZXcsZj1nP2cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLG51bGwpOm51bGw7cmV0dXJuKGYpP2YuZ2V0UHJvcGVydHlWYWx1ZSgoaD09YSk/ImZsb2F0IjpoLmh5cGhlbmF0ZSgpKTpudWxsO30sc2V0T3BhY2l0eTpmdW5jdGlvbihmKXtiKHRoaXMsZik7CnJldHVybiB0aGlzO30sZ2V0T3BhY2l0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldCgib3BhY2l0eSIpO30sc2V0U3R5bGU6ZnVuY3Rpb24oZyxmKXtzd2l0Y2goZyl7Y2FzZSJvcGFjaXR5IjpyZXR1cm4gdGhpcy5zZXQoIm9wYWNpdHkiLHBhcnNlRmxvYXQoZikpOwpjYXNlImZsb2F0IjpnPWE7fWc9Zy5jYW1lbENhc2UoKTtpZih0eXBlT2YoZikhPSJzdHJpbmciKXt2YXIgaD0oRWxlbWVudC5TdHlsZXNbZ118fCJAIikuc3BsaXQoIiAiKTtmPUFycmF5LmZyb20oZikubWFwKGZ1bmN0aW9uKGssail7aWYoIWhbal0pe3JldHVybiIiOwp9cmV0dXJuKHR5cGVPZihrKT09Im51bWJlciIpP2hbal0ucmVwbGFjZSgiQCIsTWF0aC5yb3VuZChrKSk6azt9KS5qb2luKCIgIik7fWVsc2V7aWYoZj09U3RyaW5nKE51bWJlcihmKSkpe2Y9TWF0aC5yb3VuZChmKTt9fXRoaXMuc3R5bGVbZ109ZjtyZXR1cm4gdGhpczsKfSxnZXRTdHlsZTpmdW5jdGlvbihsKXtzd2l0Y2gobCl7Y2FzZSJvcGFjaXR5IjpyZXR1cm4gdGhpcy5nZXQoIm9wYWNpdHkiKTtjYXNlImZsb2F0IjpsPWE7fWw9bC5jYW1lbENhc2UoKTt2YXIgZj10aGlzLnN0eWxlW2xdO2lmKCFmfHxsPT0iekluZGV4Iil7Zj1bXTsKZm9yKHZhciBrIGluIEVsZW1lbnQuU2hvcnRTdHlsZXMpe2lmKGwhPWspe2NvbnRpbnVlO31mb3IodmFyIGogaW4gRWxlbWVudC5TaG9ydFN0eWxlc1trXSl7Zi5wdXNoKHRoaXMuZ2V0U3R5bGUoaikpO31yZXR1cm4gZi5qb2luKCIgIik7fWY9dGhpcy5nZXRDb21wdXRlZFN0eWxlKGwpOwp9aWYoZil7Zj1TdHJpbmcoZik7dmFyIGg9Zi5tYXRjaCgvcmdiYT9cKFtcZFxzLF0rXCkvKTtpZihoKXtmPWYucmVwbGFjZShoWzBdLGhbMF0ucmdiVG9IZXgoKSk7fX1pZihCcm93c2VyLm9wZXJhfHwoQnJvd3Nlci5pZSYmaXNOYU4ocGFyc2VGbG9hdChmKSkpKXtpZihsLnRlc3QoL14oaGVpZ2h0fHdpZHRoKSQvKSl7dmFyIGc9KGw9PSJ3aWR0aCIpP1sibGVmdCIsInJpZ2h0Il06WyJ0b3AiLCJib3R0b20iXSxpPTA7CmcuZWFjaChmdW5jdGlvbihtKXtpKz10aGlzLmdldFN0eWxlKCJib3JkZXItIittKyItd2lkdGgiKS50b0ludCgpK3RoaXMuZ2V0U3R5bGUoInBhZGRpbmctIittKS50b0ludCgpO30sdGhpcyk7cmV0dXJuIHRoaXNbIm9mZnNldCIrbC5jYXBpdGFsaXplKCldLWkrInB4IjsKfWlmKEJyb3dzZXIub3BlcmEmJlN0cmluZyhmKS5pbmRleE9mKCJweCIpIT0tMSl7cmV0dXJuIGY7fWlmKGwudGVzdCgvKGJvcmRlciguKylXaWR0aHxtYXJnaW58cGFkZGluZykvKSl7cmV0dXJuIjBweCI7fX1yZXR1cm4gZjt9LHNldFN0eWxlczpmdW5jdGlvbihnKXtmb3IodmFyIGYgaW4gZyl7dGhpcy5zZXRTdHlsZShmLGdbZl0pOwp9cmV0dXJuIHRoaXM7fSxnZXRTdHlsZXM6ZnVuY3Rpb24oKXt2YXIgZj17fTtBcnJheS5mbGF0dGVuKGFyZ3VtZW50cykuZWFjaChmdW5jdGlvbihnKXtmW2ddPXRoaXMuZ2V0U3R5bGUoZyk7fSx0aGlzKTtyZXR1cm4gZjt9fSk7RWxlbWVudC5TdHlsZXM9e2xlZnQ6IkBweCIsdG9wOiJAcHgiLGJvdHRvbToiQHB4IixyaWdodDoiQHB4Iix3aWR0aDoiQHB4IixoZWlnaHQ6IkBweCIsbWF4V2lkdGg6IkBweCIsbWF4SGVpZ2h0OiJAcHgiLG1pbldpZHRoOiJAcHgiLG1pbkhlaWdodDoiQHB4IixiYWNrZ3JvdW5kQ29sb3I6InJnYihALCBALCBAKSIsYmFja2dyb3VuZFBvc2l0aW9uOiJAcHggQHB4Iixjb2xvcjoicmdiKEAsIEAsIEApIixmb250U2l6ZToiQHB4IixsZXR0ZXJTcGFjaW5nOiJAcHgiLGxpbmVIZWlnaHQ6IkBweCIsY2xpcDoicmVjdChAcHggQHB4IEBweCBAcHgpIixtYXJnaW46IkBweCBAcHggQHB4IEBweCIscGFkZGluZzoiQHB4IEBweCBAcHggQHB4Iixib3JkZXI6IkBweCBAIHJnYihALCBALCBAKSBAcHggQCByZ2IoQCwgQCwgQCkgQHB4IEAgcmdiKEAsIEAsIEApIixib3JkZXJXaWR0aDoiQHB4IEBweCBAcHggQHB4Iixib3JkZXJTdHlsZToiQCBAIEAgQCIsYm9yZGVyQ29sb3I6InJnYihALCBALCBAKSByZ2IoQCwgQCwgQCkgcmdiKEAsIEAsIEApIHJnYihALCBALCBAKSIsekluZGV4OiJAIix6b29tOiJAIixmb250V2VpZ2h0OiJAIix0ZXh0SW5kZW50OiJAcHgiLG9wYWNpdHk6IkAifTsKRWxlbWVudC5TdHlsZXM9bmV3IEhhc2goRWxlbWVudC5TdHlsZXMpO0VsZW1lbnQuU2hvcnRTdHlsZXM9e21hcmdpbjp7fSxwYWRkaW5nOnt9LGJvcmRlcjp7fSxib3JkZXJXaWR0aDp7fSxib3JkZXJTdHlsZTp7fSxib3JkZXJDb2xvcjp7fX07WyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXS5lYWNoKGZ1bmN0aW9uKGwpe3ZhciBrPUVsZW1lbnQuU2hvcnRTdHlsZXM7CnZhciBnPUVsZW1lbnQuU3R5bGVzO1sibWFyZ2luIiwicGFkZGluZyJdLmVhY2goZnVuY3Rpb24obSl7dmFyIG49bStsO2tbbV1bbl09Z1tuXT0iQHB4Ijt9KTt2YXIgaj0iYm9yZGVyIitsO2suYm9yZGVyW2pdPWdbal09IkBweCBAIHJnYihALCBALCBAKSI7dmFyIGk9aisiV2lkdGgiLGY9aisiU3R5bGUiLGg9aisiQ29sb3IiOwprW2pdPXt9O2suYm9yZGVyV2lkdGhbaV09a1tqXVtpXT1nW2ldPSJAcHgiO2suYm9yZGVyU3R5bGVbZl09a1tqXVtmXT1nW2ZdPSJAIjtrLmJvcmRlckNvbG9yW2hdPWtbal1baF09Z1toXT0icmdiKEAsIEAsIEApIjt9KTt9KSgpOyhmdW5jdGlvbigpe0VsZW1lbnQuUHJvcGVydGllcy5ldmVudHM9e3NldDpmdW5jdGlvbihjKXt0aGlzLmFkZEV2ZW50cyhjKTsKfX07W0VsZW1lbnQsV2luZG93LERvY3VtZW50XS5pbnZva2UoImltcGxlbWVudCIse2FkZEV2ZW50OmZ1bmN0aW9uKGcsaSl7dmFyIGo9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIix7fSk7aWYoIWpbZ10pe2pbZ109e2tleXM6W10sdmFsdWVzOltdfTt9aWYoaltnXS5rZXlzLmNvbnRhaW5zKGkpKXtyZXR1cm4gdGhpczsKfWpbZ10ua2V5cy5wdXNoKGkpO3ZhciBoPWcsYz1FbGVtZW50LkV2ZW50c1tnXSxlPWksaz10aGlzO2lmKGMpe2lmKGMub25BZGQpe2Mub25BZGQuY2FsbCh0aGlzLGkpO31pZihjLmNvbmRpdGlvbil7ZT1mdW5jdGlvbihsKXtpZihjLmNvbmRpdGlvbi5jYWxsKHRoaXMsbCkpe3JldHVybiBpLmNhbGwodGhpcyxsKTsKfXJldHVybiB0cnVlO307fWg9Yy5iYXNlfHxoO312YXIgZj1mdW5jdGlvbigpe3JldHVybiBpLmNhbGwoayk7fTt2YXIgZD1FbGVtZW50Lk5hdGl2ZUV2ZW50c1toXTtpZihkKXtpZihkPT0yKXtmPWZ1bmN0aW9uKGwpe2w9bmV3IEV2ZW50KGwsay5nZXRXaW5kb3coKSk7CmlmKGUuY2FsbChrLGwpPT09ZmFsc2Upe2wuc3RvcCgpO319O310aGlzLmFkZExpc3RlbmVyKGgsZik7fWpbZ10udmFsdWVzLnB1c2goZik7cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudDpmdW5jdGlvbihmLGUpe3ZhciBkPXRoaXMucmV0cmlldmUoImV2ZW50cyIpO2lmKCFkfHwhZFtmXSl7cmV0dXJuIHRoaXM7Cn12YXIgaT1kW2ZdO3ZhciBjPWkua2V5cy5pbmRleE9mKGUpO2lmKGM9PS0xKXtyZXR1cm4gdGhpczt9dmFyIGg9aS52YWx1ZXNbY107ZGVsZXRlIGkua2V5c1tjXTtkZWxldGUgaS52YWx1ZXNbY107dmFyIGc9RWxlbWVudC5FdmVudHNbZl07aWYoZyl7aWYoZy5vblJlbW92ZSl7Zy5vblJlbW92ZS5jYWxsKHRoaXMsZSk7Cn1mPWcuYmFzZXx8Zjt9cmV0dXJuKEVsZW1lbnQuTmF0aXZlRXZlbnRzW2ZdKT90aGlzLnJlbW92ZUxpc3RlbmVyKGYsaCk6dGhpczt9LGFkZEV2ZW50czpmdW5jdGlvbihjKXtmb3IodmFyIGQgaW4gYyl7dGhpcy5hZGRFdmVudChkLGNbZF0pO31yZXR1cm4gdGhpczsKfSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oYyl7dmFyIGU7aWYodHlwZU9mKGMpPT0ib2JqZWN0Iil7Zm9yKGUgaW4gYyl7dGhpcy5yZW1vdmVFdmVudChlLGNbZV0pO31yZXR1cm4gdGhpczt9dmFyIGQ9dGhpcy5yZXRyaWV2ZSgiZXZlbnRzIik7aWYoIWQpe3JldHVybiB0aGlzOwp9aWYoIWMpe2ZvcihlIGluIGQpe3RoaXMucmVtb3ZlRXZlbnRzKGUpO310aGlzLmVsaW1pbmF0ZSgiZXZlbnRzIik7fWVsc2V7aWYoZFtjXSl7ZFtjXS5rZXlzLmVhY2goZnVuY3Rpb24oZil7dGhpcy5yZW1vdmVFdmVudChjLGYpO30sdGhpcyk7ZGVsZXRlIGRbY107Cn19cmV0dXJuIHRoaXM7fSxmaXJlRXZlbnQ6ZnVuY3Rpb24oZixkLGMpe3ZhciBlPXRoaXMucmV0cmlldmUoImV2ZW50cyIpO2lmKCFlfHwhZVtmXSl7cmV0dXJuIHRoaXM7fWQ9QXJyYXkuZnJvbShkKTtlW2ZdLmtleXMuZWFjaChmdW5jdGlvbihnKXtpZihjKXtnLmRlbGF5KGMsdGhpcyxkKTsKfWVsc2V7Zy5hcHBseSh0aGlzLGQpO319LHRoaXMpO3JldHVybiB0aGlzO30sY2xvbmVFdmVudHM6ZnVuY3Rpb24oZixlKXtmPWRvY3VtZW50LmlkKGYpO3ZhciBkPWYucmV0cmlldmUoImV2ZW50cyIpO2lmKCFkKXtyZXR1cm4gdGhpczt9aWYoIWUpe2Zvcih2YXIgYyBpbiBkKXt0aGlzLmNsb25lRXZlbnRzKGYsYyk7Cn19ZWxzZXtpZihkW2VdKXtkW2VdLmtleXMuZWFjaChmdW5jdGlvbihnKXt0aGlzLmFkZEV2ZW50KGUsZyk7fSx0aGlzKTt9fXJldHVybiB0aGlzO319KTt0cnl7aWYodHlwZW9mIEhUTUxFbGVtZW50IT0idW5kZWZpbmVkIil7SFRNTEVsZW1lbnQucHJvdG90eXBlLmZpcmVFdmVudD1FbGVtZW50LnByb3RvdHlwZS5maXJlRXZlbnQ7Cn19Y2F0Y2goYil7fUVsZW1lbnQuTmF0aXZlRXZlbnRzPXtjbGljazoyLGRibGNsaWNrOjIsbW91c2V1cDoyLG1vdXNlZG93bjoyLGNvbnRleHRtZW51OjIsbW91c2V3aGVlbDoyLERPTU1vdXNlU2Nyb2xsOjIsbW91c2VvdmVyOjIsbW91c2VvdXQ6Mixtb3VzZW1vdmU6MixzZWxlY3RzdGFydDoyLHNlbGVjdGVuZDoyLGtleWRvd246MixrZXlwcmVzczoyLGtleXVwOjIsb3JpZW50YXRpb25jaGFuZ2U6Mix0b3VjaHN0YXJ0OjIsdG91Y2htb3ZlOjIsdG91Y2hlbmQ6Mix0b3VjaGNhbmNlbDoyLGdlc3R1cmVzdGFydDoyLGdlc3R1cmVjaGFuZ2U6MixnZXN0dXJlZW5kOjIsZm9jdXM6MixibHVyOjIsY2hhbmdlOjIscmVzZXQ6MixzZWxlY3Q6MixzdWJtaXQ6Mixsb2FkOjIsdW5sb2FkOjEsYmVmb3JldW5sb2FkOjIscmVzaXplOjEsbW92ZToxLERPTUNvbnRlbnRMb2FkZWQ6MSxyZWFkeXN0YXRlY2hhbmdlOjEsZXJyb3I6MSxhYm9ydDoxLHNjcm9sbDoxfTsKdmFyIGE9ZnVuY3Rpb24oYyl7dmFyIGQ9Yy5yZWxhdGVkVGFyZ2V0O2lmKGQ9PW51bGwpe3JldHVybiB0cnVlO31pZighZCl7cmV0dXJuIGZhbHNlO31yZXR1cm4oZCE9dGhpcyYmZC5wcmVmaXghPSJ4dWwiJiZ0eXBlT2YodGhpcykhPSJkb2N1bWVudCImJiF0aGlzLmNvbnRhaW5zKGQpKTsKfTtFbGVtZW50LkV2ZW50cz17bW91c2VlbnRlcjp7YmFzZToibW91c2VvdmVyIixjb25kaXRpb246YX0sbW91c2VsZWF2ZTp7YmFzZToibW91c2VvdXQiLGNvbmRpdGlvbjphfSxtb3VzZXdoZWVsOntiYXNlOihCcm93c2VyLmZpcmVmb3gpPyJET01Nb3VzZVNjcm9sbCI6Im1vdXNld2hlZWwifX07CkVsZW1lbnQuRXZlbnRzPW5ldyBIYXNoKEVsZW1lbnQuRXZlbnRzKTt9KSgpOyhmdW5jdGlvbigpe0VsZW1lbnQuaW1wbGVtZW50KHtzY3JvbGxUbzpmdW5jdGlvbihoLGkpe2lmKGIodGhpcykpe3RoaXMuZ2V0V2luZG93KCkuc2Nyb2xsVG8oaCxpKTt9ZWxzZXt0aGlzLnNjcm9sbExlZnQ9aDsKdGhpcy5zY3JvbGxUb3A9aTt9cmV0dXJuIHRoaXM7fSxnZXRTaXplOmZ1bmN0aW9uKCl7aWYoYih0aGlzKSl7cmV0dXJuIHRoaXMuZ2V0V2luZG93KCkuZ2V0U2l6ZSgpO31yZXR1cm57eDp0aGlzLm9mZnNldFdpZHRoLHk6dGhpcy5vZmZzZXRIZWlnaHR9O30sZ2V0U2Nyb2xsU2l6ZTpmdW5jdGlvbigpe2lmKGIodGhpcykpe3JldHVybiB0aGlzLmdldFdpbmRvdygpLmdldFNjcm9sbFNpemUoKTsKfXJldHVybnt4OnRoaXMuc2Nyb2xsV2lkdGgseTp0aGlzLnNjcm9sbEhlaWdodH07fSxnZXRTY3JvbGw6ZnVuY3Rpb24oKXtpZihiKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRTY3JvbGwoKTt9cmV0dXJue3g6dGhpcy5zY3JvbGxMZWZ0LHk6dGhpcy5zY3JvbGxUb3B9Owp9LGdldFNjcm9sbHM6ZnVuY3Rpb24oKXt2YXIgaT10aGlzLnBhcmVudE5vZGUsaD17eDowLHk6MH07d2hpbGUoaSYmIWIoaSkpe2gueCs9aS5zY3JvbGxMZWZ0O2gueSs9aS5zY3JvbGxUb3A7aT1pLnBhcmVudE5vZGU7fXJldHVybiBoO30sZ2V0T2Zmc2V0UGFyZW50OmZ1bmN0aW9uKCl7dmFyIGg9dGhpczsKaWYoYihoKSl7cmV0dXJuIG51bGw7fWlmKCFCcm93c2VyLmllKXtyZXR1cm4gaC5vZmZzZXRQYXJlbnQ7fXdoaWxlKChoPWgucGFyZW50Tm9kZSkpe2lmKGQoaCwicG9zaXRpb24iKSE9InN0YXRpYyJ8fGIoaCkpe3JldHVybiBoO319cmV0dXJuIG51bGw7fSxnZXRPZmZzZXRzOmZ1bmN0aW9uKCl7aWYodGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QmJiFCcm93c2VyLlBsYXRmb3JtLmlvcyl7dmFyIG09dGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxqPWRvY3VtZW50LmlkKHRoaXMuZ2V0RG9jdW1lbnQoKS5kb2N1bWVudEVsZW1lbnQpLGw9ai5nZXRTY3JvbGwoKSxvPXRoaXMuZ2V0U2Nyb2xscygpLG49KGQodGhpcywicG9zaXRpb24iKT09ImZpeGVkIik7CnJldHVybnt4Om0ubGVmdC50b0ludCgpK28ueCsoKG4pPzA6bC54KS1qLmNsaWVudExlZnQseTptLnRvcC50b0ludCgpK28ueSsoKG4pPzA6bC55KS1qLmNsaWVudFRvcH07fXZhciBpPXRoaXMsaD17eDowLHk6MH07aWYoYih0aGlzKSl7cmV0dXJuIGg7fXdoaWxlKGkmJiFiKGkpKXtoLngrPWkub2Zmc2V0TGVmdDsKaC55Kz1pLm9mZnNldFRvcDtpZihCcm93c2VyLmZpcmVmb3gpe2lmKCFmKGkpKXtoLngrPWMoaSk7aC55Kz1nKGkpO312YXIgaz1pLnBhcmVudE5vZGU7aWYoayYmZChrLCJvdmVyZmxvdyIpIT0idmlzaWJsZSIpe2gueCs9YyhrKTtoLnkrPWcoayk7fX1lbHNle2lmKGkhPXRoaXMmJkJyb3dzZXIuc2FmYXJpKXtoLngrPWMoaSk7CmgueSs9ZyhpKTt9fWk9aS5vZmZzZXRQYXJlbnQ7fWlmKEJyb3dzZXIuZmlyZWZveCYmIWYodGhpcykpe2gueC09Yyh0aGlzKTtoLnktPWcodGhpcyk7fXJldHVybiBoO30sZ2V0UG9zaXRpb246ZnVuY3Rpb24oayl7aWYoYih0aGlzKSl7cmV0dXJue3g6MCx5OjB9O312YXIgbD10aGlzLmdldE9mZnNldHMoKSxpPXRoaXMuZ2V0U2Nyb2xscygpOwp2YXIgaD17eDpsLngtaS54LHk6bC55LWkueX07aWYoayYmKGs9ZG9jdW1lbnQuaWQoaykpKXt2YXIgaj1rLmdldFBvc2l0aW9uKCk7cmV0dXJue3g6aC54LWoueC1jKGspLHk6aC55LWoueS1nKGspfTt9cmV0dXJuIGg7fSxnZXRDb29yZGluYXRlczpmdW5jdGlvbihqKXtpZihiKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRDb29yZGluYXRlcygpOwp9dmFyIGg9dGhpcy5nZXRQb3NpdGlvbihqKSxpPXRoaXMuZ2V0U2l6ZSgpO3ZhciBrPXtsZWZ0OmgueCx0b3A6aC55LHdpZHRoOmkueCxoZWlnaHQ6aS55fTtrLnJpZ2h0PWsubGVmdCtrLndpZHRoO2suYm90dG9tPWsudG9wK2suaGVpZ2h0O3JldHVybiBrO30sY29tcHV0ZVBvc2l0aW9uOmZ1bmN0aW9uKGgpe3JldHVybntsZWZ0OmgueC1lKHRoaXMsIm1hcmdpbi1sZWZ0IiksdG9wOmgueS1lKHRoaXMsIm1hcmdpbi10b3AiKX07Cn0sc2V0UG9zaXRpb246ZnVuY3Rpb24oaCl7cmV0dXJuIHRoaXMuc2V0U3R5bGVzKHRoaXMuY29tcHV0ZVBvc2l0aW9uKGgpKTt9fSk7W0RvY3VtZW50LFdpbmRvd10uaW52b2tlKCJpbXBsZW1lbnQiLHtnZXRTaXplOmZ1bmN0aW9uKCl7dmFyIGg9YSh0aGlzKTtyZXR1cm57eDpoLmNsaWVudFdpZHRoLHk6aC5jbGllbnRIZWlnaHR9Owp9LGdldFNjcm9sbDpmdW5jdGlvbigpe3ZhciBpPXRoaXMuZ2V0V2luZG93KCksaD1hKHRoaXMpO3JldHVybnt4OmkucGFnZVhPZmZzZXR8fGguc2Nyb2xsTGVmdCx5OmkucGFnZVlPZmZzZXR8fGguc2Nyb2xsVG9wfTt9LGdldFNjcm9sbFNpemU6ZnVuY3Rpb24oKXt2YXIgaj1hKHRoaXMpLGk9dGhpcy5nZXRTaXplKCksaD10aGlzLmdldERvY3VtZW50KCkuYm9keTsKcmV0dXJue3g6TWF0aC5tYXgoai5zY3JvbGxXaWR0aCxoLnNjcm9sbFdpZHRoLGkueCkseTpNYXRoLm1heChqLnNjcm9sbEhlaWdodCxoLnNjcm9sbEhlaWdodCxpLnkpfTt9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJue3g6MCx5OjB9O30sZ2V0Q29vcmRpbmF0ZXM6ZnVuY3Rpb24oKXt2YXIgaD10aGlzLmdldFNpemUoKTsKcmV0dXJue3RvcDowLGxlZnQ6MCxib3R0b206aC55LHJpZ2h0OmgueCxoZWlnaHQ6aC55LHdpZHRoOmgueH07fX0pO3ZhciBkPUVsZW1lbnQuZ2V0Q29tcHV0ZWRTdHlsZTtmdW5jdGlvbiBlKGgsaSl7cmV0dXJuIGQoaCxpKS50b0ludCgpfHwwO31mdW5jdGlvbiBmKGgpe3JldHVybiBkKGgsIi1tb3otYm94LXNpemluZyIpPT0iYm9yZGVyLWJveCI7Cn1mdW5jdGlvbiBnKGgpe3JldHVybiBlKGgsImJvcmRlci10b3Atd2lkdGgiKTt9ZnVuY3Rpb24gYyhoKXtyZXR1cm4gZShoLCJib3JkZXItbGVmdC13aWR0aCIpO31mdW5jdGlvbiBiKGgpe3JldHVybigvXig/OmJvZHl8aHRtbCkkL2kpLnRlc3QoaC50YWdOYW1lKTsKfWZ1bmN0aW9uIGEoaCl7dmFyIGk9aC5nZXREb2N1bWVudCgpO3JldHVybighaS5jb21wYXRNb2RlfHxpLmNvbXBhdE1vZGU9PSJDU1MxQ29tcGF0Iik/aS5odG1sOmkuYm9keTt9fSkoKTtFbGVtZW50LmFsaWFzKHtwb3NpdGlvbjoic2V0UG9zaXRpb24ifSk7W1dpbmRvdyxEb2N1bWVudCxFbGVtZW50XS5pbnZva2UoImltcGxlbWVudCIse2dldEhlaWdodDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNpemUoKS55Owp9LGdldFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2l6ZSgpLng7fSxnZXRTY3JvbGxUb3A6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTY3JvbGwoKS55O30sZ2V0U2Nyb2xsTGVmdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbCgpLng7Cn0sZ2V0U2Nyb2xsSGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2Nyb2xsU2l6ZSgpLnk7fSxnZXRTY3JvbGxXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbFNpemUoKS54O30sZ2V0VG9wOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0UG9zaXRpb24oKS55Owp9LGdldExlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRQb3NpdGlvbigpLng7fX0pOyhmdW5jdGlvbigpe3ZhciBlPXRoaXMuRng9bmV3IENsYXNzKHtJbXBsZW1lbnRzOltDaGFpbixFdmVudHMsT3B0aW9uc10sb3B0aW9uczp7ZnBzOjUwLHVuaXQ6ZmFsc2UsZHVyYXRpb246NTAwLGxpbms6Imlnbm9yZSJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oZyl7dGhpcy5zdWJqZWN0PXRoaXMuc3ViamVjdHx8dGhpczsKdGhpcy5zZXRPcHRpb25zKGcpO30sZ2V0VHJhbnNpdGlvbjpmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihnKXtyZXR1cm4gLShNYXRoLmNvcyhNYXRoLlBJKmcpLTEpLzI7fTt9LHN0ZXA6ZnVuY3Rpb24oKXt2YXIgZz1EYXRlLm5vdygpO2lmKGc8dGhpcy50aW1lK3RoaXMub3B0aW9ucy5kdXJhdGlvbil7dmFyIGg9dGhpcy50cmFuc2l0aW9uKChnLXRoaXMudGltZSkvdGhpcy5vcHRpb25zLmR1cmF0aW9uKTsKdGhpcy5zZXQodGhpcy5jb21wdXRlKHRoaXMuZnJvbSx0aGlzLnRvLGgpKTt9ZWxzZXt0aGlzLnNldCh0aGlzLmNvbXB1dGUodGhpcy5mcm9tLHRoaXMudG8sMSkpO3RoaXMuY29tcGxldGUoKTt9fSxzZXQ6ZnVuY3Rpb24oZyl7cmV0dXJuIGc7fSxjb21wdXRlOmZ1bmN0aW9uKGksaCxnKXtyZXR1cm4gZS5jb21wdXRlKGksaCxnKTsKfSxjaGVjazpmdW5jdGlvbigpe2lmKCF0aGlzLnRpbWVyKXtyZXR1cm4gdHJ1ZTt9c3dpdGNoKHRoaXMub3B0aW9ucy5saW5rKXtjYXNlImNhbmNlbCI6dGhpcy5jYW5jZWwoKTtyZXR1cm4gdHJ1ZTtjYXNlImNoYWluIjp0aGlzLmNoYWluKHRoaXMuY2FsbGVyLnBhc3MoYXJndW1lbnRzLHRoaXMpKTsKcmV0dXJuIGZhbHNlO31yZXR1cm4gZmFsc2U7fSxzdGFydDpmdW5jdGlvbihpLGgpe2lmKCF0aGlzLmNoZWNrKGksaCkpe3JldHVybiB0aGlzO312YXIgZz10aGlzLm9wdGlvbnMuZHVyYXRpb247dGhpcy5vcHRpb25zLmR1cmF0aW9uPWUuRHVyYXRpb25zW2ddfHxnLnRvSW50KCk7CnRoaXMuZnJvbT1pO3RoaXMudG89aDt0aGlzLnRpbWU9MDt0aGlzLnRyYW5zaXRpb249dGhpcy5nZXRUcmFuc2l0aW9uKCk7dGhpcy5zdGFydFRpbWVyKCk7dGhpcy5vblN0YXJ0KCk7cmV0dXJuIHRoaXM7fSxjb21wbGV0ZTpmdW5jdGlvbigpe2lmKHRoaXMuc3RvcFRpbWVyKCkpe3RoaXMub25Db21wbGV0ZSgpOwp9cmV0dXJuIHRoaXM7fSxjYW5jZWw6ZnVuY3Rpb24oKXtpZih0aGlzLnN0b3BUaW1lcigpKXt0aGlzLm9uQ2FuY2VsKCk7fXJldHVybiB0aGlzO30sb25TdGFydDpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJzdGFydCIsdGhpcy5zdWJqZWN0KTt9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiLHRoaXMuc3ViamVjdCk7CmlmKCF0aGlzLmNhbGxDaGFpbigpKXt0aGlzLmZpcmVFdmVudCgiY2hhaW5Db21wbGV0ZSIsdGhpcy5zdWJqZWN0KTt9fSxvbkNhbmNlbDpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJjYW5jZWwiLHRoaXMuc3ViamVjdCkuY2xlYXJDaGFpbigpO30scGF1c2U6ZnVuY3Rpb24oKXt0aGlzLnN0b3BUaW1lcigpOwpyZXR1cm4gdGhpczt9LHJlc3VtZTpmdW5jdGlvbigpe3RoaXMuc3RhcnRUaW1lcigpO3JldHVybiB0aGlzO30sc3RvcFRpbWVyOmZ1bmN0aW9uKCl7aWYoIXRoaXMudGltZXIpe3JldHVybiBmYWxzZTt9dGhpcy50aW1lPURhdGUubm93KCktdGhpcy50aW1lO3RoaXMudGltZXI9Zih0aGlzKTsKcmV0dXJuIHRydWU7fSxzdGFydFRpbWVyOmZ1bmN0aW9uKCl7aWYodGhpcy50aW1lcil7cmV0dXJuIGZhbHNlO310aGlzLnRpbWU9RGF0ZS5ub3coKS10aGlzLnRpbWU7dGhpcy50aW1lcj1iKHRoaXMpO3JldHVybiB0cnVlO319KTtlLmNvbXB1dGU9ZnVuY3Rpb24oaSxoLGcpe3JldHVybihoLWkpKmcraTsKfTtlLkR1cmF0aW9ucz17InNob3J0IjoyNTAsbm9ybWFsOjUwMCwibG9uZyI6MTAwMH07dmFyIGQ9e30sYz17fTt2YXIgYT1mdW5jdGlvbigpe2Zvcih2YXIgZz10aGlzLmxlbmd0aDtnLS07KXtpZih0aGlzW2ddKXt0aGlzW2ddLnN0ZXAoKTt9fX07dmFyIGI9ZnVuY3Rpb24oZyl7dmFyIGk9Zy5vcHRpb25zLmZwcyxoPWRbaV18fChkW2ldPVtdKTsKaC5wdXNoKGcpO2lmKCFjW2ldKXtjW2ldPWEucGVyaW9kaWNhbChNYXRoLnJvdW5kKDEwMDAvaSksaCk7fXJldHVybiB0cnVlO307dmFyIGY9ZnVuY3Rpb24oZyl7dmFyIGk9Zy5vcHRpb25zLmZwcyxoPWRbaV18fFtdO2guZXJhc2UoZyk7aWYoIWgubGVuZ3RoJiZjW2ldKXtjW2ldPWNsZWFySW50ZXJ2YWwoY1tpXSk7Cn1yZXR1cm4gZmFsc2U7fTt9KSgpO0Z4LkNTUz1uZXcgQ2xhc3Moe0V4dGVuZHM6RngscHJlcGFyZTpmdW5jdGlvbihjLGQsYil7Yj1BcnJheS5mcm9tKGIpO2lmKGJbMV09PW51bGwpe2JbMV09YlswXTtiWzBdPWMuZ2V0U3R5bGUoZCk7fXZhciBhPWIubWFwKHRoaXMucGFyc2UpOwpyZXR1cm57ZnJvbTphWzBdLHRvOmFbMV19O30scGFyc2U6ZnVuY3Rpb24oYSl7YT1GdW5jdGlvbi5mcm9tKGEpKCk7YT0odHlwZW9mIGE9PSJzdHJpbmciKT9hLnNwbGl0KCIgIik6QXJyYXkuZnJvbShhKTtyZXR1cm4gYS5tYXAoZnVuY3Rpb24oYyl7Yz1TdHJpbmcoYyk7CnZhciBiPWZhbHNlO09iamVjdC5lYWNoKEZ4LkNTUy5QYXJzZXJzLGZ1bmN0aW9uKGYsZSl7aWYoYil7cmV0dXJuO312YXIgZD1mLnBhcnNlKGMpO2lmKGR8fGQ9PT0wKXtiPXt2YWx1ZTpkLHBhcnNlcjpmfTt9fSk7Yj1ifHx7dmFsdWU6YyxwYXJzZXI6RnguQ1NTLlBhcnNlcnMuU3RyaW5nfTsKcmV0dXJuIGI7fSk7fSxjb21wdXRlOmZ1bmN0aW9uKGQsYyxiKXt2YXIgYT1bXTsoTWF0aC5taW4oZC5sZW5ndGgsYy5sZW5ndGgpKS50aW1lcyhmdW5jdGlvbihlKXthLnB1c2goe3ZhbHVlOmRbZV0ucGFyc2VyLmNvbXB1dGUoZFtlXS52YWx1ZSxjW2VdLnZhbHVlLGIpLHBhcnNlcjpkW2VdLnBhcnNlcn0pOwp9KTthLiRmYW1pbHk9RnVuY3Rpb24uZnJvbSgiZng6Y3NzOnZhbHVlIik7cmV0dXJuIGE7fSxzZXJ2ZTpmdW5jdGlvbihjLGIpe2lmKHR5cGVPZihjKSE9ImZ4OmNzczp2YWx1ZSIpe2M9dGhpcy5wYXJzZShjKTt9dmFyIGE9W107Yy5lYWNoKGZ1bmN0aW9uKGQpe2E9YS5jb25jYXQoZC5wYXJzZXIuc2VydmUoZC52YWx1ZSxiKSk7Cn0pO3JldHVybiBhO30scmVuZGVyOmZ1bmN0aW9uKGEsZCxjLGIpe2Euc2V0U3R5bGUoZCx0aGlzLnNlcnZlKGMsYikpO30sc2VhcmNoOmZ1bmN0aW9uKGEpe2lmKEZ4LkNTUy5DYWNoZVthXSl7cmV0dXJuIEZ4LkNTUy5DYWNoZVthXTt9dmFyIGI9e307QXJyYXkuZWFjaChkb2N1bWVudC5zdHlsZVNoZWV0cyxmdW5jdGlvbihlLGQpe3ZhciBjPWUuaHJlZjsKaWYoYyYmYy5jb250YWlucygiOi8vIikmJiFjLmNvbnRhaW5zKGRvY3VtZW50LmRvbWFpbikpe3JldHVybjt9dmFyIGY9ZS5ydWxlc3x8ZS5jc3NSdWxlcztBcnJheS5lYWNoKGYsZnVuY3Rpb24oaixnKXtpZighai5zdHlsZSl7cmV0dXJuO312YXIgaD0oai5zZWxlY3RvclRleHQpP2ouc2VsZWN0b3JUZXh0LnJlcGxhY2UoL15cdysvLGZ1bmN0aW9uKGkpe3JldHVybiBpLnRvTG93ZXJDYXNlKCk7Cn0pOm51bGw7aWYoIWh8fCFoLnRlc3QoIl4iK2ErIiQiKSl7cmV0dXJuO31FbGVtZW50LlN0eWxlcy5lYWNoKGZ1bmN0aW9uKGssaSl7aWYoIWouc3R5bGVbaV18fEVsZW1lbnQuU2hvcnRTdHlsZXNbaV0pe3JldHVybjt9az1TdHJpbmcoai5zdHlsZVtpXSk7YltpXT0oay50ZXN0KC9ecmdiLykpP2sucmdiVG9IZXgoKTprOwp9KTt9KTt9KTtyZXR1cm4gRnguQ1NTLkNhY2hlW2FdPWI7fX0pO0Z4LkNTUy5DYWNoZT17fTtGeC5DU1MuUGFyc2Vycz17Q29sb3I6e3BhcnNlOmZ1bmN0aW9uKGEpe2lmKGEubWF0Y2goL14jWzAtOWEtZl17Myw2fSQvaSkpe3JldHVybiBhLmhleFRvUmdiKHRydWUpOwp9cmV0dXJuKChhPWEubWF0Y2goLyhcZCspLFxzKihcZCspLFxzKihcZCspLykpKT9bYVsxXSxhWzJdLGFbM11dOmZhbHNlO30sY29tcHV0ZTpmdW5jdGlvbihjLGIsYSl7cmV0dXJuIGMubWFwKGZ1bmN0aW9uKGUsZCl7cmV0dXJuIE1hdGgucm91bmQoRnguY29tcHV0ZShjW2RdLGJbZF0sYSkpOwp9KTt9LHNlcnZlOmZ1bmN0aW9uKGEpe3JldHVybiBhLm1hcChOdW1iZXIpO319LE51bWJlcjp7cGFyc2U6cGFyc2VGbG9hdCxjb21wdXRlOkZ4LmNvbXB1dGUsc2VydmU6ZnVuY3Rpb24oYixhKXtyZXR1cm4oYSk/YithOmI7fX0sU3RyaW5nOntwYXJzZTpGdW5jdGlvbi5mcm9tKGZhbHNlKSxjb21wdXRlOmZ1bmN0aW9uKGIsYSl7cmV0dXJuIGE7Cn0sc2VydmU6ZnVuY3Rpb24oYSl7cmV0dXJuIGE7fX19O0Z4LkNTUy5QYXJzZXJzPW5ldyBIYXNoKEZ4LkNTUy5QYXJzZXJzKTtGeC5Ud2Vlbj1uZXcgQ2xhc3Moe0V4dGVuZHM6RnguQ1NTLGluaXRpYWxpemU6ZnVuY3Rpb24oYixhKXt0aGlzLmVsZW1lbnQ9dGhpcy5zdWJqZWN0PWRvY3VtZW50LmlkKGIpOwp0aGlzLnBhcmVudChhKTt9LHNldDpmdW5jdGlvbihiLGEpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe2E9YjtiPXRoaXMucHJvcGVydHl8fHRoaXMub3B0aW9ucy5wcm9wZXJ0eTt9dGhpcy5yZW5kZXIodGhpcy5lbGVtZW50LGIsYSx0aGlzLm9wdGlvbnMudW5pdCk7CnJldHVybiB0aGlzO30sc3RhcnQ6ZnVuY3Rpb24oYyxlLGQpe2lmKCF0aGlzLmNoZWNrKGMsZSxkKSl7cmV0dXJuIHRoaXM7fXZhciBiPUFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKTt0aGlzLnByb3BlcnR5PXRoaXMub3B0aW9ucy5wcm9wZXJ0eXx8Yi5zaGlmdCgpO3ZhciBhPXRoaXMucHJlcGFyZSh0aGlzLmVsZW1lbnQsdGhpcy5wcm9wZXJ0eSxiKTsKcmV0dXJuIHRoaXMucGFyZW50KGEuZnJvbSxhLnRvKTt9fSk7RWxlbWVudC5Qcm9wZXJ0aWVzLnR3ZWVuPXtzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5nZXQoInR3ZWVuIikuY2FuY2VsKCkuc2V0T3B0aW9ucyhhKTtyZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbigpe3ZhciBhPXRoaXMucmV0cmlldmUoInR3ZWVuIik7CmlmKCFhKXthPW5ldyBGeC5Ud2Vlbih0aGlzLHtsaW5rOiJjYW5jZWwifSk7dGhpcy5zdG9yZSgidHdlZW4iLGEpO31yZXR1cm4gYTt9fTtFbGVtZW50LmltcGxlbWVudCh7dHdlZW46ZnVuY3Rpb24oYSxjLGIpe3RoaXMuZ2V0KCJ0d2VlbiIpLnN0YXJ0KGFyZ3VtZW50cyk7CnJldHVybiB0aGlzO30sZmFkZTpmdW5jdGlvbihjKXt2YXIgZT10aGlzLmdldCgidHdlZW4iKSxkPSJvcGFjaXR5IixhO2M9W2MsInRvZ2dsZSJdLnBpY2soKTtzd2l0Y2goYyl7Y2FzZSJpbiI6ZS5zdGFydChkLDEpO2JyZWFrO2Nhc2Uib3V0IjplLnN0YXJ0KGQsMCk7CmJyZWFrO2Nhc2Uic2hvdyI6ZS5zZXQoZCwxKTticmVhaztjYXNlImhpZGUiOmUuc2V0KGQsMCk7YnJlYWs7Y2FzZSJ0b2dnbGUiOnZhciBiPXRoaXMucmV0cmlldmUoImZhZGU6ZmxhZyIsdGhpcy5nZXQoIm9wYWNpdHkiKT09MSk7ZS5zdGFydChkLChiKT8wOjEpO3RoaXMuc3RvcmUoImZhZGU6ZmxhZyIsIWIpOwphPXRydWU7YnJlYWs7ZGVmYXVsdDplLnN0YXJ0KGQsYXJndW1lbnRzKTt9aWYoIWEpe3RoaXMuZWxpbWluYXRlKCJmYWRlOmZsYWciKTt9cmV0dXJuIHRoaXM7fSxoaWdobGlnaHQ6ZnVuY3Rpb24oYyxhKXtpZighYSl7YT10aGlzLnJldHJpZXZlKCJoaWdobGlnaHQ6b3JpZ2luYWwiLHRoaXMuZ2V0U3R5bGUoImJhY2tncm91bmQtY29sb3IiKSk7CmE9KGE9PSJ0cmFuc3BhcmVudCIpPyIjZmZmIjphO312YXIgYj10aGlzLmdldCgidHdlZW4iKTtiLnN0YXJ0KCJiYWNrZ3JvdW5kLWNvbG9yIixjfHwiI2ZmZmY4OCIsYSkuY2hhaW4oZnVuY3Rpb24oKXt0aGlzLnNldFN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIix0aGlzLnJldHJpZXZlKCJoaWdobGlnaHQ6b3JpZ2luYWwiKSk7CmIuY2FsbENoYWluKCk7fS5iaW5kKHRoaXMpKTtyZXR1cm4gdGhpczt9fSk7RnguTW9ycGg9bmV3IENsYXNzKHtFeHRlbmRzOkZ4LkNTUyxpbml0aWFsaXplOmZ1bmN0aW9uKGIsYSl7dGhpcy5lbGVtZW50PXRoaXMuc3ViamVjdD1kb2N1bWVudC5pZChiKTt0aGlzLnBhcmVudChhKTsKfSxzZXQ6ZnVuY3Rpb24oYSl7aWYodHlwZW9mIGE9PSJzdHJpbmciKXthPXRoaXMuc2VhcmNoKGEpO31mb3IodmFyIGIgaW4gYSl7dGhpcy5yZW5kZXIodGhpcy5lbGVtZW50LGIsYVtiXSx0aGlzLm9wdGlvbnMudW5pdCk7fXJldHVybiB0aGlzO30sY29tcHV0ZTpmdW5jdGlvbihlLGQsYyl7dmFyIGE9e307CmZvcih2YXIgYiBpbiBlKXthW2JdPXRoaXMucGFyZW50KGVbYl0sZFtiXSxjKTt9cmV0dXJuIGE7fSxzdGFydDpmdW5jdGlvbihiKXtpZighdGhpcy5jaGVjayhiKSl7cmV0dXJuIHRoaXM7fWlmKHR5cGVvZiBiPT0ic3RyaW5nIil7Yj10aGlzLnNlYXJjaChiKTt9dmFyIGU9e30sZD17fTsKZm9yKHZhciBjIGluIGIpe3ZhciBhPXRoaXMucHJlcGFyZSh0aGlzLmVsZW1lbnQsYyxiW2NdKTtlW2NdPWEuZnJvbTtkW2NdPWEudG87fXJldHVybiB0aGlzLnBhcmVudChlLGQpO319KTtFbGVtZW50LlByb3BlcnRpZXMubW9ycGg9e3NldDpmdW5jdGlvbihhKXt0aGlzLmdldCgibW9ycGgiKS5jYW5jZWwoKS5zZXRPcHRpb25zKGEpOwpyZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbigpe3ZhciBhPXRoaXMucmV0cmlldmUoIm1vcnBoIik7aWYoIWEpe2E9bmV3IEZ4Lk1vcnBoKHRoaXMse2xpbms6ImNhbmNlbCJ9KTt0aGlzLnN0b3JlKCJtb3JwaCIsYSk7fXJldHVybiBhO319O0VsZW1lbnQuaW1wbGVtZW50KHttb3JwaDpmdW5jdGlvbihhKXt0aGlzLmdldCgibW9ycGgiKS5zdGFydChhKTsKcmV0dXJuIHRoaXM7fX0pO0Z4LmltcGxlbWVudCh7Z2V0VHJhbnNpdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy50cmFuc2l0aW9ufHxGeC5UcmFuc2l0aW9ucy5TaW5lLmVhc2VJbk91dDtpZih0eXBlb2YgYT09InN0cmluZyIpe3ZhciBiPWEuc3BsaXQoIjoiKTsKYT1GeC5UcmFuc2l0aW9uczthPWFbYlswXV18fGFbYlswXS5jYXBpdGFsaXplKCldO2lmKGJbMV0pe2E9YVsiZWFzZSIrYlsxXS5jYXBpdGFsaXplKCkrKGJbMl0/YlsyXS5jYXBpdGFsaXplKCk6IiIpXTt9fXJldHVybiBhO319KTtGeC5UcmFuc2l0aW9uPWZ1bmN0aW9uKGIsYSl7YT1BcnJheS5mcm9tKGEpOwpyZXR1cm4gT2JqZWN0LmFwcGVuZChiLHtlYXNlSW46ZnVuY3Rpb24oYyl7cmV0dXJuIGIoYyxhKTt9LGVhc2VPdXQ6ZnVuY3Rpb24oYyl7cmV0dXJuIDEtYigxLWMsYSk7fSxlYXNlSW5PdXQ6ZnVuY3Rpb24oYyl7cmV0dXJuKGM8PTAuNSk/YigyKmMsYSkvMjooMi1iKDIqKDEtYyksYSkpLzI7Cn19KTt9O0Z4LlRyYW5zaXRpb25zPXtsaW5lYXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGE7fX07RnguVHJhbnNpdGlvbnM9bmV3IEhhc2goRnguVHJhbnNpdGlvbnMpO0Z4LlRyYW5zaXRpb25zLmV4dGVuZD1mdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gYSl7RnguVHJhbnNpdGlvbnNbYl09bmV3IEZ4LlRyYW5zaXRpb24oYVtiXSk7Cn19O0Z4LlRyYW5zaXRpb25zLmV4dGVuZCh7UG93OmZ1bmN0aW9uKGIsYSl7cmV0dXJuIE1hdGgucG93KGIsYSYmYVswXXx8Nik7fSxFeHBvOmZ1bmN0aW9uKGEpe3JldHVybiBNYXRoLnBvdygyLDgqKGEtMSkpO30sQ2lyYzpmdW5jdGlvbihhKXtyZXR1cm4gMS1NYXRoLnNpbihNYXRoLmFjb3MoYSkpOwp9LFNpbmU6ZnVuY3Rpb24oYSl7cmV0dXJuIDEtTWF0aC5zaW4oKDEtYSkqTWF0aC5QSS8yKTt9LEJhY2s6ZnVuY3Rpb24oYixhKXthPWEmJmFbMF18fDEuNjE4O3JldHVybiBNYXRoLnBvdyhiLDIpKigoYSsxKSpiLWEpO30sQm91bmNlOmZ1bmN0aW9uKGYpe3ZhciBlOwpmb3IodmFyIGQ9MCxjPTE7MTtkKz1jLGMvPTIpe2lmKGY+PSg3LTQqZCkvMTEpe2U9YypjLU1hdGgucG93KCgxMS02KmQtMTEqZikvNCwyKTticmVhazt9fXJldHVybiBlO30sRWxhc3RpYzpmdW5jdGlvbihiLGEpe3JldHVybiBNYXRoLnBvdygyLDEwKi0tYikqTWF0aC5jb3MoMjAqYipNYXRoLlBJKihhJiZhWzBdfHwxKS8zKTsKfX0pO1siUXVhZCIsIkN1YmljIiwiUXVhcnQiLCJRdWludCJdLmVhY2goZnVuY3Rpb24oYixhKXtGeC5UcmFuc2l0aW9uc1tiXT1uZXcgRnguVHJhbnNpdGlvbihmdW5jdGlvbihjKXtyZXR1cm4gTWF0aC5wb3coYyxbYSsyXSk7fSk7fSk7KGZ1bmN0aW9uKCl7dmFyIGE9KCJvbnByb2dyZXNzIiBpbiBuZXcgQnJvd3Nlci5SZXF1ZXN0KTsKdmFyIGM9dGhpcy5SZXF1ZXN0PW5ldyBDbGFzcyh7SW1wbGVtZW50czpbQ2hhaW4sRXZlbnRzLE9wdGlvbnNdLG9wdGlvbnM6e3VybDoiIixkYXRhOiIiLGhlYWRlcnM6eyJYLVJlcXVlc3RlZC1XaXRoIjoiWE1MSHR0cFJlcXVlc3QiLEFjY2VwdDoidGV4dC9qYXZhc2NyaXB0LCB0ZXh0L2h0bWwsIGFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwsICovKiJ9LGFzeW5jOnRydWUsZm9ybWF0OmZhbHNlLG1ldGhvZDoicG9zdCIsbGluazoiaWdub3JlIixpc1N1Y2Nlc3M6bnVsbCxlbXVsYXRpb246dHJ1ZSx1cmxFbmNvZGVkOnRydWUsZW5jb2Rpbmc6InV0Zi04IixldmFsU2NyaXB0czpmYWxzZSxldmFsUmVzcG9uc2U6ZmFsc2UsdGltZW91dDowLG5vQ2FjaGU6ZmFsc2V9LGluaXRpYWxpemU6ZnVuY3Rpb24oZCl7dGhpcy54aHI9bmV3IEJyb3dzZXIuUmVxdWVzdCgpOwp0aGlzLnNldE9wdGlvbnMoZCk7dGhpcy5oZWFkZXJzPXRoaXMub3B0aW9ucy5oZWFkZXJzO30sb25TdGF0ZUNoYW5nZTpmdW5jdGlvbigpe3ZhciBkPXRoaXMueGhyO2lmKGQucmVhZHlTdGF0ZSE9NHx8IXRoaXMucnVubmluZyl7cmV0dXJuO310aGlzLnJ1bm5pbmc9ZmFsc2U7CnRoaXMuc3RhdHVzPTA7RnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3ZhciBlPWQuc3RhdHVzO3RoaXMuc3RhdHVzPShlPT0xMjIzKT8yMDQ6ZTt9LmJpbmQodGhpcykpO2Qub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7fTtjbGVhclRpbWVvdXQodGhpcy50aW1lcik7CnRoaXMucmVzcG9uc2U9e3RleHQ6dGhpcy54aHIucmVzcG9uc2VUZXh0fHwiIix4bWw6dGhpcy54aHIucmVzcG9uc2VYTUx9O2lmKHRoaXMub3B0aW9ucy5pc1N1Y2Nlc3MuY2FsbCh0aGlzLHRoaXMuc3RhdHVzKSl7dGhpcy5zdWNjZXNzKHRoaXMucmVzcG9uc2UudGV4dCx0aGlzLnJlc3BvbnNlLnhtbCk7Cn1lbHNle3RoaXMuZmFpbHVyZSgpO319LGlzU3VjY2VzczpmdW5jdGlvbigpe3ZhciBkPXRoaXMuc3RhdHVzO3JldHVybihkPj0yMDAmJmQ8MzAwKTt9LGlzUnVubmluZzpmdW5jdGlvbigpe3JldHVybiAhIXRoaXMucnVubmluZzt9LHByb2Nlc3NTY3JpcHRzOmZ1bmN0aW9uKGQpe2lmKHRoaXMub3B0aW9ucy5ldmFsUmVzcG9uc2V8fCgvKGVjbWF8amF2YSlzY3JpcHQvKS50ZXN0KHRoaXMuZ2V0SGVhZGVyKCJDb250ZW50LXR5cGUiKSkpe3JldHVybiBCcm93c2VyLmV4ZWMoZCk7Cn1yZXR1cm4gZC5zdHJpcFNjcmlwdHModGhpcy5vcHRpb25zLmV2YWxTY3JpcHRzKTt9LHN1Y2Nlc3M6ZnVuY3Rpb24oZSxkKXt0aGlzLm9uU3VjY2Vzcyh0aGlzLnByb2Nlc3NTY3JpcHRzKGUpLGQpO30sb25TdWNjZXNzOmZ1bmN0aW9uKCl7dGhpcy5maXJlRXZlbnQoImNvbXBsZXRlIixhcmd1bWVudHMpLmZpcmVFdmVudCgic3VjY2VzcyIsYXJndW1lbnRzKS5jYWxsQ2hhaW4oKTsKfSxmYWlsdXJlOmZ1bmN0aW9uKCl7dGhpcy5vbkZhaWx1cmUoKTt9LG9uRmFpbHVyZTpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJjb21wbGV0ZSIpLmZpcmVFdmVudCgiZmFpbHVyZSIsdGhpcy54aHIpO30sbG9hZHN0YXJ0OmZ1bmN0aW9uKGQpe3RoaXMuZmlyZUV2ZW50KCJsb2Fkc3RhcnQiLFtkLHRoaXMueGhyXSk7Cn0scHJvZ3Jlc3M6ZnVuY3Rpb24oZCl7dGhpcy5maXJlRXZlbnQoInByb2dyZXNzIixbZCx0aGlzLnhocl0pO30sdGltZW91dDpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJ0aW1lb3V0Iix0aGlzLnhocik7fSxzZXRIZWFkZXI6ZnVuY3Rpb24oZCxlKXt0aGlzLmhlYWRlcnNbZF09ZTsKcmV0dXJuIHRoaXM7fSxnZXRIZWFkZXI6ZnVuY3Rpb24oZCl7cmV0dXJuIEZ1bmN0aW9uLmF0dGVtcHQoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54aHIuZ2V0UmVzcG9uc2VIZWFkZXIoZCk7fS5iaW5kKHRoaXMpKTt9LGNoZWNrOmZ1bmN0aW9uKCl7aWYoIXRoaXMucnVubmluZyl7cmV0dXJuIHRydWU7Cn1zd2l0Y2godGhpcy5vcHRpb25zLmxpbmspe2Nhc2UiY2FuY2VsIjp0aGlzLmNhbmNlbCgpO3JldHVybiB0cnVlO2Nhc2UiY2hhaW4iOnRoaXMuY2hhaW4odGhpcy5jYWxsZXIucGFzcyhhcmd1bWVudHMsdGhpcykpO3JldHVybiBmYWxzZTt9cmV0dXJuIGZhbHNlO30sc2VuZDpmdW5jdGlvbihuKXtpZighdGhpcy5jaGVjayhuKSl7cmV0dXJuIHRoaXM7Cn10aGlzLm9wdGlvbnMuaXNTdWNjZXNzPXRoaXMub3B0aW9ucy5pc1N1Y2Nlc3N8fHRoaXMuaXNTdWNjZXNzO3RoaXMucnVubmluZz10cnVlO3ZhciBrPXR5cGVPZihuKTtpZihrPT0ic3RyaW5nInx8az09ImVsZW1lbnQiKXtuPXtkYXRhOm59O312YXIgZz10aGlzLm9wdGlvbnM7Cm49T2JqZWN0LmFwcGVuZCh7ZGF0YTpnLmRhdGEsdXJsOmcudXJsLG1ldGhvZDpnLm1ldGhvZH0sbik7dmFyIGk9bi5kYXRhLGU9U3RyaW5nKG4udXJsKSxkPW4ubWV0aG9kLnRvTG93ZXJDYXNlKCk7c3dpdGNoKHR5cGVPZihpKSl7Y2FzZSJlbGVtZW50IjppPWRvY3VtZW50LmlkKGkpLnRvUXVlcnlTdHJpbmcoKTsKYnJlYWs7Y2FzZSJvYmplY3QiOmNhc2UiaGFzaCI6aT1PYmplY3QudG9RdWVyeVN0cmluZyhpKTt9aWYodGhpcy5vcHRpb25zLmZvcm1hdCl7dmFyIGw9ImZvcm1hdD0iK3RoaXMub3B0aW9ucy5mb3JtYXQ7aT0oaSk/bCsiJiIraTpsO31pZih0aGlzLm9wdGlvbnMuZW11bGF0aW9uJiYhWyJnZXQiLCJwb3N0Il0uY29udGFpbnMoZCkpe3ZhciBqPSJfbWV0aG9kPSIrZDsKaT0oaSk/aisiJiIraTpqO2Q9InBvc3QiO31pZih0aGlzLm9wdGlvbnMudXJsRW5jb2RlZCYmWyJwb3N0IiwicHV0Il0uY29udGFpbnMoZCkpe3ZhciBmPSh0aGlzLm9wdGlvbnMuZW5jb2RpbmcpPyI7IGNoYXJzZXQ9Iit0aGlzLm9wdGlvbnMuZW5jb2Rpbmc6IiI7dGhpcy5oZWFkZXJzWyJDb250ZW50LXR5cGUiXT0iYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIitmOwp9aWYoIWUpe2U9ZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWU7fXZhciBoPWUubGFzdEluZGV4T2YoIi8iKTtpZihoPi0xJiYoaD1lLmluZGV4T2YoIiMiKSk+LTEpe2U9ZS5zdWJzdHIoMCxoKTt9aWYodGhpcy5vcHRpb25zLm5vQ2FjaGUpe2UrPShlLmNvbnRhaW5zKCI/Iik/IiYiOiI/IikrU3RyaW5nLnVuaXF1ZUlEKCk7Cn1pZihpJiZkPT0iZ2V0Iil7ZSs9KGUuY29udGFpbnMoIj8iKT8iJiI6Ij8iKStpO2k9bnVsbDt9dmFyIG09dGhpcy54aHI7aWYoYSl7bS5vbmxvYWRzdGFydD10aGlzLmxvYWRzdGFydC5iaW5kKHRoaXMpO20ub25wcm9ncmVzcz10aGlzLnByb2dyZXNzLmJpbmQodGhpcyk7Cn1tLm9wZW4oZC50b1VwcGVyQ2FzZSgpLGUsdGhpcy5vcHRpb25zLmFzeW5jLHRoaXMub3B0aW9ucy51c2VyLHRoaXMub3B0aW9ucy5wYXNzd29yZCk7aWYodGhpcy5vcHRpb25zLnVzZXImJiJ3aXRoQ3JlZGVudGlhbHMiIGluIG0pe20ud2l0aENyZWRlbnRpYWxzPXRydWU7Cn1tLm9ucmVhZHlzdGF0ZWNoYW5nZT10aGlzLm9uU3RhdGVDaGFuZ2UuYmluZCh0aGlzKTtPYmplY3QuZWFjaCh0aGlzLmhlYWRlcnMsZnVuY3Rpb24ocCxvKXt0cnl7bS5zZXRSZXF1ZXN0SGVhZGVyKG8scCk7fWNhdGNoKHEpe3RoaXMuZmlyZUV2ZW50KCJleGNlcHRpb24iLFtvLHBdKTsKfX0sdGhpcyk7dGhpcy5maXJlRXZlbnQoInJlcXVlc3QiKTttLnNlbmQoaSk7aWYoIXRoaXMub3B0aW9ucy5hc3luYyl7dGhpcy5vblN0YXRlQ2hhbmdlKCk7fWlmKHRoaXMub3B0aW9ucy50aW1lb3V0KXt0aGlzLnRpbWVyPXRoaXMudGltZW91dC5kZWxheSh0aGlzLm9wdGlvbnMudGltZW91dCx0aGlzKTsKfXJldHVybiB0aGlzO30sY2FuY2VsOmZ1bmN0aW9uKCl7aWYoIXRoaXMucnVubmluZyl7cmV0dXJuIHRoaXM7fXRoaXMucnVubmluZz1mYWxzZTt2YXIgZD10aGlzLnhocjtkLmFib3J0KCk7Y2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO2Qub25yZWFkeXN0YXRlY2hhbmdlPWQub25wcm9ncmVzcz1kLm9ubG9hZHN0YXJ0PWZ1bmN0aW9uKCl7fTsKdGhpcy54aHI9bmV3IEJyb3dzZXIuUmVxdWVzdCgpO3RoaXMuZmlyZUV2ZW50KCJjYW5jZWwiKTtyZXR1cm4gdGhpczt9fSk7dmFyIGI9e307WyJnZXQiLCJwb3N0IiwicHV0IiwiZGVsZXRlIiwiR0VUIiwiUE9TVCIsIlBVVCIsIkRFTEVURSJdLmVhY2goZnVuY3Rpb24oZCl7YltkXT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5zZW5kKHtkYXRhOmUsbWV0aG9kOmR9KTsKfTt9KTtjLmltcGxlbWVudChiKTtFbGVtZW50LlByb3BlcnRpZXMuc2VuZD17c2V0OmZ1bmN0aW9uKGQpe3ZhciBlPXRoaXMuZ2V0KCJzZW5kIikuY2FuY2VsKCk7ZS5zZXRPcHRpb25zKGQpO3JldHVybiB0aGlzO30sZ2V0OmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5yZXRyaWV2ZSgic2VuZCIpOwppZighZCl7ZD1uZXcgYyh7ZGF0YTp0aGlzLGxpbms6ImNhbmNlbCIsbWV0aG9kOnRoaXMuZ2V0KCJtZXRob2QiKXx8InBvc3QiLHVybDp0aGlzLmdldCgiYWN0aW9uIil9KTt0aGlzLnN0b3JlKCJzZW5kIixkKTt9cmV0dXJuIGQ7fX07RWxlbWVudC5pbXBsZW1lbnQoe3NlbmQ6ZnVuY3Rpb24oZCl7dmFyIGU9dGhpcy5nZXQoInNlbmQiKTsKZS5zZW5kKHtkYXRhOnRoaXMsdXJsOmR8fGUub3B0aW9ucy51cmx9KTtyZXR1cm4gdGhpczt9fSk7fSkoKTtSZXF1ZXN0LkhUTUw9bmV3IENsYXNzKHtFeHRlbmRzOlJlcXVlc3Qsb3B0aW9uczp7dXBkYXRlOmZhbHNlLGFwcGVuZDpmYWxzZSxldmFsU2NyaXB0czp0cnVlLGZpbHRlcjpmYWxzZSxoZWFkZXJzOntBY2NlcHQ6InRleHQvaHRtbCwgYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCwgKi8qIn19LHN1Y2Nlc3M6ZnVuY3Rpb24oZSl7dmFyIGQ9dGhpcy5vcHRpb25zLGI9dGhpcy5yZXNwb25zZTsKYi5odG1sPWUuc3RyaXBTY3JpcHRzKGZ1bmN0aW9uKGYpe2IuamF2YXNjcmlwdD1mO30pO3ZhciBjPWIuaHRtbC5tYXRjaCgvPGJvZHlbXj5dKj4oW1xzXFNdKj8pPFwvYm9keT4vaSk7aWYoYyl7Yi5odG1sPWNbMV07fXZhciBhPW5ldyBFbGVtZW50KCJkaXYiKS5zZXQoImh0bWwiLGIuaHRtbCk7CmIudHJlZT1hLmNoaWxkTm9kZXM7Yi5lbGVtZW50cz1hLmdldEVsZW1lbnRzKCIqIik7aWYoZC5maWx0ZXIpe2IudHJlZT1iLmVsZW1lbnRzLmZpbHRlcihkLmZpbHRlcik7fWlmKGQudXBkYXRlKXtkb2N1bWVudC5pZChkLnVwZGF0ZSkuZW1wdHkoKS5zZXQoImh0bWwiLGIuaHRtbCk7Cn1lbHNle2lmKGQuYXBwZW5kKXtkb2N1bWVudC5pZChkLmFwcGVuZCkuYWRvcHQoYS5nZXRDaGlsZHJlbigpKTt9fWlmKGQuZXZhbFNjcmlwdHMpe0Jyb3dzZXIuZXhlYyhiLmphdmFzY3JpcHQpO310aGlzLm9uU3VjY2VzcyhiLnRyZWUsYi5lbGVtZW50cyxiLmh0bWwsYi5qYXZhc2NyaXB0KTsKfX0pO0VsZW1lbnQuUHJvcGVydGllcy5sb2FkPXtzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXQoImxvYWQiKS5jYW5jZWwoKTtiLnNldE9wdGlvbnMoYSk7cmV0dXJuIHRoaXM7fSxnZXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnJldHJpZXZlKCJsb2FkIik7aWYoIWEpe2E9bmV3IFJlcXVlc3QuSFRNTCh7ZGF0YTp0aGlzLGxpbms6ImNhbmNlbCIsdXBkYXRlOnRoaXMsbWV0aG9kOiJnZXQifSk7CnRoaXMuc3RvcmUoImxvYWQiLGEpO31yZXR1cm4gYTt9fTtFbGVtZW50LmltcGxlbWVudCh7bG9hZDpmdW5jdGlvbigpe3RoaXMuZ2V0KCJsb2FkIikuc2VuZChBcnJheS5saW5rKGFyZ3VtZW50cyx7ZGF0YTpUeXBlLmlzT2JqZWN0LHVybDpUeXBlLmlzU3RyaW5nfSkpOwpyZXR1cm4gdGhpczt9fSk7aWYoIXRoaXMuSlNPTil7dGhpcy5KU09OPXt9O31KU09OPW5ldyBIYXNoKHtzdHJpbmdpZnk6SlNPTi5zdHJpbmdpZnkscGFyc2U6SlNPTi5wYXJzZX0pO09iamVjdC5hcHBlbmQoSlNPTix7JHNwZWNpYWxDaGFyczp7IlxiIjoiXFxiIiwiXHQiOiJcXHQiLCJcbiI6IlxcbiIsIlxmIjoiXFxmIiwiXHIiOiJcXHIiLCciJzonXFwiJywiXFwiOiJcXFxcIn0sJHJlcGxhY2VDaGFyczpmdW5jdGlvbihhKXtyZXR1cm4gSlNPTi4kc3BlY2lhbENoYXJzW2FdfHwiXFx1MDAiK01hdGguZmxvb3IoYS5jaGFyQ29kZUF0KCkvMTYpLnRvU3RyaW5nKDE2KSsoYS5jaGFyQ29kZUF0KCklMTYpLnRvU3RyaW5nKDE2KTsKfSxlbmNvZGU6ZnVuY3Rpb24oYil7c3dpdGNoKHR5cGVPZihiKSl7Y2FzZSJzdHJpbmciOnJldHVybiciJytiLnJlcGxhY2UoL1tceDAwLVx4MWZcXCJdL2csSlNPTi4kcmVwbGFjZUNoYXJzKSsnIic7Y2FzZSJhcnJheSI6cmV0dXJuIlsiK1N0cmluZyhiLm1hcChKU09OLmVuY29kZSkuY2xlYW4oKSkrIl0iOwpjYXNlIm9iamVjdCI6Y2FzZSJoYXNoIjp2YXIgYT1bXTtPYmplY3QuZWFjaChiLGZ1bmN0aW9uKGUsZCl7dmFyIGM9SlNPTi5lbmNvZGUoZSk7aWYoYyl7YS5wdXNoKEpTT04uZW5jb2RlKGQpKyI6IitjKTt9fSk7cmV0dXJuInsiK2ErIn0iO2Nhc2UibnVtYmVyIjpjYXNlImJvb2xlYW4iOnJldHVybiBTdHJpbmcoYik7CmNhc2UibnVsbCI6cmV0dXJuIm51bGwiO31yZXR1cm4gbnVsbDt9LGRlY29kZTpmdW5jdGlvbihzdHJpbmcsc2VjdXJlKXtpZih0eXBlT2Yoc3RyaW5nKSE9InN0cmluZyJ8fCFzdHJpbmcubGVuZ3RoKXtyZXR1cm4gbnVsbDt9aWYoc2VjdXJlJiYhKC9eWyw6e31cW1xdMC05LlwtK0VhZWZsbnItdSBcblxyXHRdKiQvKS50ZXN0KHN0cmluZy5yZXBsYWNlKC9cXC4vZywiQCIpLnJlcGxhY2UoLyJbXiJcXFxuXHJdKiIvZywiIikpKXtyZXR1cm4gbnVsbDsKfXJldHVybiBldmFsKCIoIitzdHJpbmcrIikiKTt9fSk7UmVxdWVzdC5KU09OPW5ldyBDbGFzcyh7RXh0ZW5kczpSZXF1ZXN0LG9wdGlvbnM6e3NlY3VyZTp0cnVlfSxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe3RoaXMucGFyZW50KGEpO09iamVjdC5hcHBlbmQodGhpcy5oZWFkZXJzLHtBY2NlcHQ6ImFwcGxpY2F0aW9uL2pzb24iLCJYLVJlcXVlc3QiOiJKU09OIn0pOwp9LHN1Y2Nlc3M6ZnVuY3Rpb24oYyl7dmFyIGI9dGhpcy5vcHRpb25zLnNlY3VyZTt2YXIgYT10aGlzLnJlc3BvbnNlLmpzb249RnVuY3Rpb24uYXR0ZW1wdChmdW5jdGlvbigpe3JldHVybiBKU09OLmRlY29kZShjLGIpO30pO2lmKGE9PW51bGwpe3RoaXMub25GYWlsdXJlKCk7Cn1lbHNle3RoaXMub25TdWNjZXNzKGEsYyk7fX19KTt2YXIgQ29va2llPW5ldyBDbGFzcyh7SW1wbGVtZW50czpPcHRpb25zLG9wdGlvbnM6e3BhdGg6Ii8iLGRvbWFpbjpmYWxzZSxkdXJhdGlvbjpmYWxzZSxzZWN1cmU6ZmFsc2UsZG9jdW1lbnQ6ZG9jdW1lbnQsZW5jb2RlOnRydWV9LGluaXRpYWxpemU6ZnVuY3Rpb24oYixhKXt0aGlzLmtleT1iOwp0aGlzLnNldE9wdGlvbnMoYSk7fSx3cml0ZTpmdW5jdGlvbihiKXtpZih0aGlzLm9wdGlvbnMuZW5jb2RlKXtiPWVuY29kZVVSSUNvbXBvbmVudChiKTt9aWYodGhpcy5vcHRpb25zLmRvbWFpbil7Yis9IjsgZG9tYWluPSIrdGhpcy5vcHRpb25zLmRvbWFpbjt9aWYodGhpcy5vcHRpb25zLnBhdGgpe2IrPSI7IHBhdGg9Iit0aGlzLm9wdGlvbnMucGF0aDsKfWlmKHRoaXMub3B0aW9ucy5kdXJhdGlvbil7dmFyIGE9bmV3IERhdGUoKTthLnNldFRpbWUoYS5nZXRUaW1lKCkrdGhpcy5vcHRpb25zLmR1cmF0aW9uKjI0KjYwKjYwKjEwMDApO2IrPSI7IGV4cGlyZXM9IithLnRvR01UU3RyaW5nKCk7fWlmKHRoaXMub3B0aW9ucy5zZWN1cmUpe2IrPSI7IHNlY3VyZSI7Cn10aGlzLm9wdGlvbnMuZG9jdW1lbnQuY29va2llPXRoaXMua2V5KyI9IitiO3JldHVybiB0aGlzO30scmVhZDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5kb2N1bWVudC5jb29raWUubWF0Y2goIig/Ol58OylcXHMqIit0aGlzLmtleS5lc2NhcGVSZWdFeHAoKSsiPShbXjtdKikiKTsKcmV0dXJuKGEpP2RlY29kZVVSSUNvbXBvbmVudChhWzFdKTpudWxsO30sZGlzcG9zZTpmdW5jdGlvbigpe25ldyBDb29raWUodGhpcy5rZXksT2JqZWN0Lm1lcmdlKHt9LHRoaXMub3B0aW9ucyx7ZHVyYXRpb246LTF9KSkud3JpdGUoIiIpO3JldHVybiB0aGlzO319KTsKQ29va2llLndyaXRlPWZ1bmN0aW9uKGIsYyxhKXtyZXR1cm4gbmV3IENvb2tpZShiLGEpLndyaXRlKGMpO307Q29va2llLnJlYWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBDb29raWUoYSkucmVhZCgpO307Q29va2llLmRpc3Bvc2U9ZnVuY3Rpb24oYixhKXtyZXR1cm4gbmV3IENvb2tpZShiLGEpLmRpc3Bvc2UoKTsKfTsoZnVuY3Rpb24oaixsKXt2YXIgbSxnLGY9W10sYyxiLG49dHJ1ZTt0cnl7bj1qLmZyYW1lRWxlbWVudCE9bnVsbDt9Y2F0Y2goaSl7fXZhciBoPWZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KGIpO2lmKG0pe3JldHVybjt9QnJvd3Nlci5sb2FkZWQ9bT10cnVlO2wucmVtb3ZlTGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLGgpLnJlbW92ZUxpc3RlbmVyKCJyZWFkeXN0YXRlY2hhbmdlIixhKTsKbC5maXJlRXZlbnQoImRvbXJlYWR5Iik7ai5maXJlRXZlbnQoImRvbXJlYWR5Iik7fTt2YXIgYT1mdW5jdGlvbigpe2Zvcih2YXIgZT1mLmxlbmd0aDtlLS07KXtpZihmW2VdKCkpe2goKTtyZXR1cm4gdHJ1ZTt9fXJldHVybiBmYWxzZTt9O3ZhciBrPWZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KGIpOwppZighYSgpKXtiPXNldFRpbWVvdXQoaywxMCk7fX07bC5hZGRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsaCk7dmFyIGQ9bC5jcmVhdGVFbGVtZW50KCJkaXYiKTtpZihkLmRvU2Nyb2xsJiYhbil7Zi5wdXNoKGZ1bmN0aW9uKCl7dHJ5e2QuZG9TY3JvbGwoKTtyZXR1cm4gdHJ1ZTsKfWNhdGNoKG8pe31yZXR1cm4gZmFsc2U7fSk7Yz10cnVlO31pZihsLnJlYWR5U3RhdGUpe2YucHVzaChmdW5jdGlvbigpe3ZhciBlPWwucmVhZHlTdGF0ZTtyZXR1cm4oZT09ImxvYWRlZCJ8fGU9PSJjb21wbGV0ZSIpO30pO31pZigib25yZWFkeXN0YXRlY2hhbmdlIiBpbiBsKXtsLmFkZExpc3RlbmVyKCJyZWFkeXN0YXRlY2hhbmdlIixhKTsKfWVsc2V7Yz10cnVlO31pZihjKXtrKCk7fUVsZW1lbnQuRXZlbnRzLmRvbXJlYWR5PXtvbkFkZDpmdW5jdGlvbihlKXtpZihtKXtlLmNhbGwodGhpcyk7fX19O0VsZW1lbnQuRXZlbnRzLmxvYWQ9e2Jhc2U6ImxvYWQiLG9uQWRkOmZ1bmN0aW9uKGUpe2lmKGcmJnRoaXM9PWope2UuY2FsbCh0aGlzKTsKfX0sY29uZGl0aW9uOmZ1bmN0aW9uKCl7aWYodGhpcz09ail7aCgpO2RlbGV0ZSBFbGVtZW50LkV2ZW50cy5sb2FkO31yZXR1cm4gdHJ1ZTt9fTtqLmFkZEV2ZW50KCJsb2FkIixmdW5jdGlvbigpe2c9dHJ1ZTt9KTt9KSh3aW5kb3csZG9jdW1lbnQpOyhmdW5jdGlvbigpe3ZhciBpZD0wOwp2YXIgU3dpZmY9dGhpcy5Td2lmZj1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6T3B0aW9ucyxvcHRpb25zOntpZDpudWxsLGhlaWdodDoxLHdpZHRoOjEsY29udGFpbmVyOm51bGwscHJvcGVydGllczp7fSxwYXJhbXM6e3F1YWxpdHk6ImhpZ2giLGFsbG93U2NyaXB0QWNjZXNzOiJhbHdheXMiLHdNb2RlOiJ3aW5kb3ciLHN3TGl2ZUNvbm5lY3Q6dHJ1ZX0sY2FsbEJhY2tzOnt9LHZhcnM6e319LHRvRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9iamVjdDsKfSxpbml0aWFsaXplOmZ1bmN0aW9uKHBhdGgsb3B0aW9ucyl7dGhpcy5pbnN0YW5jZT0iU3dpZmZfIitpZCsrO3RoaXMuc2V0T3B0aW9ucyhvcHRpb25zKTtvcHRpb25zPXRoaXMub3B0aW9uczt2YXIgaWQ9dGhpcy5pZD1vcHRpb25zLmlkfHx0aGlzLmluc3RhbmNlOwp2YXIgY29udGFpbmVyPWRvY3VtZW50LmlkKG9wdGlvbnMuY29udGFpbmVyKTtTd2lmZi5DYWxsQmFja3NbdGhpcy5pbnN0YW5jZV09e307dmFyIHBhcmFtcz1vcHRpb25zLnBhcmFtcyx2YXJzPW9wdGlvbnMudmFycyxjYWxsQmFja3M9b3B0aW9ucy5jYWxsQmFja3M7CnZhciBwcm9wZXJ0aWVzPU9iamVjdC5hcHBlbmQoe2hlaWdodDpvcHRpb25zLmhlaWdodCx3aWR0aDpvcHRpb25zLndpZHRofSxvcHRpb25zLnByb3BlcnRpZXMpO3ZhciBzZWxmPXRoaXM7Zm9yKHZhciBjYWxsQmFjayBpbiBjYWxsQmFja3Mpe1N3aWZmLkNhbGxCYWNrc1t0aGlzLmluc3RhbmNlXVtjYWxsQmFja109KGZ1bmN0aW9uKG9wdGlvbil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG9wdGlvbi5hcHBseShzZWxmLm9iamVjdCxhcmd1bWVudHMpOwp9O30pKGNhbGxCYWNrc1tjYWxsQmFja10pO3ZhcnNbY2FsbEJhY2tdPSJTd2lmZi5DYWxsQmFja3MuIit0aGlzLmluc3RhbmNlKyIuIitjYWxsQmFjazt9cGFyYW1zLmZsYXNoVmFycz1PYmplY3QudG9RdWVyeVN0cmluZyh2YXJzKTtpZihCcm93c2VyLmllKXtwcm9wZXJ0aWVzLmNsYXNzaWQ9ImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMCI7CnBhcmFtcy5tb3ZpZT1wYXRoO31lbHNle3Byb3BlcnRpZXMudHlwZT0iYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giO31wcm9wZXJ0aWVzLmRhdGE9cGF0aDt2YXIgYnVpbGQ9JzxvYmplY3QgaWQ9IicraWQrJyInO2Zvcih2YXIgcHJvcGVydHkgaW4gcHJvcGVydGllcyl7YnVpbGQrPSIgIitwcm9wZXJ0eSsnPSInK3Byb3BlcnRpZXNbcHJvcGVydHldKyciJzsKfWJ1aWxkKz0iPiI7Zm9yKHZhciBwYXJhbSBpbiBwYXJhbXMpe2lmKHBhcmFtc1twYXJhbV0pe2J1aWxkKz0nPHBhcmFtIG5hbWU9IicrcGFyYW0rJyIgdmFsdWU9IicrcGFyYW1zW3BhcmFtXSsnIiAvPic7fX1idWlsZCs9Ijwvb2JqZWN0PiI7dGhpcy5vYmplY3Q9KChjb250YWluZXIpP2NvbnRhaW5lci5lbXB0eSgpOm5ldyBFbGVtZW50KCJkaXYiKSkuc2V0KCJodG1sIixidWlsZCkuZmlyc3RDaGlsZDsKfSxyZXBsYWNlczpmdW5jdGlvbihlbGVtZW50KXtlbGVtZW50PWRvY3VtZW50LmlkKGVsZW1lbnQsdHJ1ZSk7ZWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCh0aGlzLnRvRWxlbWVudCgpLGVsZW1lbnQpO3JldHVybiB0aGlzO30saW5qZWN0OmZ1bmN0aW9uKGVsZW1lbnQpe2RvY3VtZW50LmlkKGVsZW1lbnQsdHJ1ZSkuYXBwZW5kQ2hpbGQodGhpcy50b0VsZW1lbnQoKSk7CnJldHVybiB0aGlzO30scmVtb3RlOmZ1bmN0aW9uKCl7cmV0dXJuIFN3aWZmLnJlbW90ZS5hcHBseShTd2lmZixbdGhpcy50b0VsZW1lbnQoKV0uZXh0ZW5kKGFyZ3VtZW50cykpO319KTtTd2lmZi5DYWxsQmFja3M9e307U3dpZmYucmVtb3RlPWZ1bmN0aW9uKG9iaixmbil7dmFyIHJzPW9iai5DYWxsRnVuY3Rpb24oJzxpbnZva2UgbmFtZT0iJytmbisnIiByZXR1cm50eXBlPSJqYXZhc2NyaXB0Ij4nK19fZmxhc2hfX2FyZ3VtZW50c1RvWE1MKGFyZ3VtZW50cywyKSsiPC9pbnZva2U+Iik7CnJldHVybiBldmFsKHJzKTt9O30pKCk7",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 03:55:00 GMT",
                    "Content-Length": "86238",
                    "Date": "Sat, 08 Nov 2014 03:55:41 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}