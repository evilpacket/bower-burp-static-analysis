{
    "url": "http://localhost:9999/brunogfranca/tiny-js-libs/swfobject/1.5/jwplayer.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>window.location</b> and written to <b>the 'setAttribute()' function of a DOM element</b> via the following statements:<ul><li>var _c=(_8)?_8:window.location;</li><li>this.setAttribute(\"xiRedirectUrl\",_c);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/brunogfranca/tiny-js-libs/swfobject/1.5/jwplayer.js",
                "path": "/brunogfranca/tiny-js-libs/swfobject/1.5/jwplayer.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9icnVub2dmcmFuY2EvdGlueS1qcy1saWJzL3N3Zm9iamVjdC8xLjUvandwbGF5ZXIuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjg4MA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAyMDoxNjowNCBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMjA6MTY6MDQgR01UDQoNCi8qKgogKiBTV0ZPYmplY3QgdjEuNTogRmxhc2ggUGxheWVyIGRldGVjdGlvbiBhbmQgZW1iZWQgLSBodHRwOi8vYmxvZy5kZWNvbmNlcHQuY29tL3N3Zm9iamVjdC8KICoKICogU1dGT2JqZWN0IGlzIChjKSAyMDA3IEdlb2ZmIFN0ZWFybnMgYW5kIGlzIHJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZToKICogaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHAKICoKICovCmlmKHR5cGVvZiBkZWNvbmNlcHQ9PSJ1bmRlZmluZWQiKXt2YXIgZGVjb25jZXB0PW5ldyBPYmplY3QoKTt9aWYodHlwZW9mIGRlY29uY2VwdC51dGlsPT0idW5kZWZpbmVkIil7ZGVjb25jZXB0LnV0aWw9bmV3IE9iamVjdCgpO31pZih0eXBlb2YgZGVjb25jZXB0LlNXRk9iamVjdFV0aWw9PSJ1bmRlZmluZWQiKXtkZWNvbmNlcHQuU1dGT2JqZWN0VXRpbD1uZXcgT2JqZWN0KCk7fWRlY29uY2VwdC5TV0ZPYmplY3Q9ZnVuY3Rpb24oXzEsaWQsdyxoLF81LGMsXzcsXzgsXzksX2Epe2lmKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCl7cmV0dXJuO310aGlzLkRFVEVDVF9LRVk9X2E/X2E6ImRldGVjdGZsYXNoIjt0aGlzLnNraXBEZXRlY3Q9ZGVjb25jZXB0LnV0aWwuZ2V0UmVxdWVzdFBhcmFtZXRlcih0aGlzLkRFVEVDVF9LRVkpO3RoaXMucGFyYW1zPW5ldyBPYmplY3QoKTt0aGlzLnZhcmlhYmxlcz1uZXcgT2JqZWN0KCk7dGhpcy5hdHRyaWJ1dGVzPW5ldyBBcnJheSgpO2lmKF8xKXt0aGlzLnNldEF0dHJpYnV0ZSgic3dmIixfMSk7fWlmKGlkKXt0aGlzLnNldEF0dHJpYnV0ZSgiaWQiLGlkKTt9aWYodyl7dGhpcy5zZXRBdHRyaWJ1dGUoIndpZHRoIix3KTt9aWYoaCl7dGhpcy5zZXRBdHRyaWJ1dGUoImhlaWdodCIsaCk7fWlmKF81KXt0aGlzLnNldEF0dHJpYnV0ZSgidmVyc2lvbiIsbmV3IGRlY29uY2VwdC5QbGF5ZXJWZXJzaW9uKF81LnRvU3RyaW5nKCkuc3BsaXQoIi4iKSkpO310aGlzLmluc3RhbGxlZFZlcj1kZWNvbmNlcHQuU1dGT2JqZWN0VXRpbC5nZXRQbGF5ZXJWZXJzaW9uKCk7aWYoIXdpbmRvdy5vcGVyYSYmZG9jdW1lbnQuYWxsJiZ0aGlzLmluc3RhbGxlZFZlci5tYWpvcj43KXtkZWNvbmNlcHQuU1dGT2JqZWN0LmRvUHJlcFVubG9hZD10cnVlO31pZihjKXt0aGlzLmFkZFBhcmFtKCJiZ2NvbG9yIixjKTt9dmFyIHE9Xzc/Xzc6ImhpZ2giO3RoaXMuYWRkUGFyYW0oInF1YWxpdHkiLHEpO3RoaXMuc2V0QXR0cmlidXRlKCJ1c2VFeHByZXNzSW5zdGFsbCIsZmFsc2UpO3RoaXMuc2V0QXR0cmlidXRlKCJkb0V4cHJlc3NJbnN0YWxsIixmYWxzZSk7dmFyIF9jPShfOCk/Xzg6d2luZG93LmxvY2F0aW9uO3RoaXMuc2V0QXR0cmlidXRlKCJ4aVJlZGlyZWN0VXJsIixfYyk7dGhpcy5zZXRBdHRyaWJ1dGUoInJlZGlyZWN0VXJsIiwiIik7aWYoXzkpe3RoaXMuc2V0QXR0cmlidXRlKCJyZWRpcmVjdFVybCIsXzkpO319O2RlY29uY2VwdC5TV0ZPYmplY3QucHJvdG90eXBlPXt1c2VFeHByZXNzSW5zdGFsbDpmdW5jdGlvbihfZCl7dGhpcy54aVNXRlBhdGg9IV9kPyJleHByZXNzaW5zdGFsbC5zd2YiOl9kO3RoaXMuc2V0QXR0cmlidXRlKCJ1c2VFeHByZXNzSW5zdGFsbCIsdHJ1ZSk7fSxzZXRBdHRyaWJ1dGU6ZnVuY3Rpb24oX2UsX2Ype3RoaXMuYXR0cmlidXRlc1tfZV09X2Y7fSxnZXRBdHRyaWJ1dGU6ZnVuY3Rpb24oXzEwKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW18xMF07fSxhZGRQYXJhbTpmdW5jdGlvbihfMTEsXzEyKXt0aGlzLnBhcmFtc1tfMTFdPV8xMjt9LGdldFBhcmFtczpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmFtczt9LGFkZFZhcmlhYmxlOmZ1bmN0aW9uKF8xMyxfMTQpe3RoaXMudmFyaWFibGVzW18xM109XzE0O30sZ2V0VmFyaWFibGU6ZnVuY3Rpb24oXzE1KXtyZXR1cm4gdGhpcy52YXJpYWJsZXNbXzE1XTt9LGdldFZhcmlhYmxlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhcmlhYmxlczt9LGdldFZhcmlhYmxlUGFpcnM6ZnVuY3Rpb24oKXt2YXIgXzE2PW5ldyBBcnJheSgpO3ZhciBrZXk7dmFyIF8xOD10aGlzLmdldFZhcmlhYmxlcygpO2ZvcihrZXkgaW4gXzE4KXtfMTZbXzE2Lmxlbmd0aF09a2V5KyI9IitfMThba2V5XTt9cmV0dXJuIF8xNjt9LGdldFNXRkhUTUw6ZnVuY3Rpb24oKXt2YXIgXzE5PSIiO2lmKG5hdmlnYXRvci5wbHVnaW5zJiZuYXZpZ2F0b3IubWltZVR5cGVzJiZuYXZpZ2F0b3IubWltZVR5cGVzLmxlbmd0aCl7aWYodGhpcy5nZXRBdHRyaWJ1dGUoImRvRXhwcmVzc0luc3RhbGwiKSl7dGhpcy5hZGRWYXJpYWJsZSgiTU1wbGF5ZXJUeXBlIiwiUGx1Z0luIik7dGhpcy5zZXRBdHRyaWJ1dGUoInN3ZiIsdGhpcy54aVNXRlBhdGgpO31fMTk9IjxlbWJlZCB0eXBlPVwiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2hcIiBzcmM9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJzd2YiKSsiXCIgd2lkdGg9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJ3aWR0aCIpKyJcIiBoZWlnaHQ9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJoZWlnaHQiKSsiXCIgc3R5bGU9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJzdHlsZSIpKyJcIiI7XzE5Kz0iIGlkPVwiIit0aGlzLmdldEF0dHJpYnV0ZSgiaWQiKSsiXCIgbmFtZT1cIiIrdGhpcy5nZXRBdHRyaWJ1dGUoImlkIikrIlwiICI7dmFyIF8xYT10aGlzLmdldFBhcmFtcygpO2Zvcih2YXIga2V5IGluIF8xYSl7XzE5Kz1ba2V5XSsiPVwiIitfMWFba2V5XSsiXCIgIjt9dmFyIF8xYz10aGlzLmdldFZhcmlhYmxlUGFpcnMoKS5qb2luKCImIik7aWYoXzFjLmxlbmd0aD4wKXtfMTkrPSJmbGFzaHZhcnM9XCIiK18xYysiXCIiO31fMTkrPSIvPiI7fWVsc2V7aWYodGhpcy5nZXRBdHRyaWJ1dGUoImRvRXhwcmVzc0luc3RhbGwiKSl7dGhpcy5hZGRWYXJpYWJsZSgiTU1wbGF5ZXJUeXBlIiwiQWN0aXZlWCIpO3RoaXMuc2V0QXR0cmlidXRlKCJzd2YiLHRoaXMueGlTV0ZQYXRoKTt9XzE5PSI8b2JqZWN0IGlkPVwiIit0aGlzLmdldEF0dHJpYnV0ZSgiaWQiKSsiXCIgY2xhc3NpZD1cImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMFwiIHdpZHRoPVwiIit0aGlzLmdldEF0dHJpYnV0ZSgid2lkdGgiKSsiXCIgaGVpZ2h0PVwiIit0aGlzLmdldEF0dHJpYnV0ZSgiaGVpZ2h0IikrIlwiIHN0eWxlPVwiIit0aGlzLmdldEF0dHJpYnV0ZSgic3R5bGUiKSsiXCI+IjtfMTkrPSI8cGFyYW0gbmFtZT1cIm1vdmllXCIgdmFsdWU9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJzd2YiKSsiXCIgLz4iO3ZhciBfMWQ9dGhpcy5nZXRQYXJhbXMoKTtmb3IodmFyIGtleSBpbiBfMWQpe18xOSs9IjxwYXJhbSBuYW1lPVwiIitrZXkrIlwiIHZhbHVlPVwiIitfMWRba2V5XSsiXCIgLz4iO312YXIgXzFmPXRoaXMuZ2V0VmFyaWFibGVQYWlycygpLmpvaW4oIiYiKTtpZihfMWYubGVuZ3RoPjApe18xOSs9IjxwYXJhbSBuYW1lPVwiZmxhc2h2YXJzXCIgdmFsdWU9XCIiK18xZisiXCIgLz4iO31fMTkrPSI8L29iamVjdD4iO31yZXR1cm4gXzE5O30sd3JpdGU6ZnVuY3Rpb24oXzIwKXtpZih0aGlzLmdldEF0dHJpYnV0ZSgidXNlRXhwcmVzc0luc3RhbGwiKSl7dmFyIF8yMT1uZXcgZGVjb25jZXB0LlBsYXllclZlcnNpb24oWzYsMCw2NV0pO2lmKHRoaXMuaW5zdGFsbGVkVmVyLnZlcnNpb25Jc1ZhbGlkKF8yMSkmJiF0aGlzLmluc3RhbGxlZFZlci52ZXJzaW9uSXNWYWxpZCh0aGlzLmdldEF0dHJpYnV0ZSgidmVyc2lvbiIpKSl7dGhpcy5zZXRBdHRyaWJ1dGUoImRvRXhwcmVzc0luc3RhbGwiLHRydWUpO3RoaXMuYWRkVmFyaWFibGUoIk1NcmVkaXJlY3RVUkwiLGVzY2FwZSh0aGlzLmdldEF0dHJpYnV0ZSgieGlSZWRpcmVjdFVybCIpKSk7ZG9jdW1lbnQudGl0bGU9ZG9jdW1lbnQudGl0bGUuc2xpY2UoMCw0NykrIiAtIEZsYXNoIFBsYXllciBJbnN0YWxsYXRpb24iO3RoaXMuYWRkVmFyaWFibGUoIk1NZG9jdGl0bGUiLGRvY3VtZW50LnRpdGxlKTt9fWlmKHRoaXMuc2tpcERldGVjdHx8dGhpcy5nZXRBdHRyaWJ1dGUoImRvRXhwcmVzc0luc3RhbGwiKXx8dGhpcy5pbnN0YWxsZWRWZXIudmVyc2lvbklzVmFsaWQodGhpcy5nZXRBdHRyaWJ1dGUoInZlcnNpb24iKSkpe3ZhciBuPSh0eXBlb2YgXzIwPT0ic3RyaW5nIik/ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXzIwKTpfMjA7bi5pbm5lckhUTUw9dGhpcy5nZXRTV0ZIVE1MKCk7cmV0dXJuIHRydWU7fWVsc2V7aWYodGhpcy5nZXRBdHRyaWJ1dGUoInJlZGlyZWN0VXJsIikhPSIiKXtkb2N1bWVudC5sb2NhdGlvbi5yZXBsYWNlKHRoaXMuZ2V0QXR0cmlidXRlKCJyZWRpcmVjdFVybCIpKTt9fXJldHVybiBmYWxzZTt9fTtkZWNvbmNlcHQuU1dGT2JqZWN0VXRpbC5nZXRQbGF5ZXJWZXJzaW9uPWZ1bmN0aW9uKCl7dmFyIF8yMz1uZXcgZGVjb25jZXB0LlBsYXllclZlcnNpb24oWzAsMCwwXSk7aWYobmF2aWdhdG9yLnBsdWdpbnMmJm5hdmlnYXRvci5taW1lVHlwZXMubGVuZ3RoKXt2YXIgeD1uYXZpZ2F0b3IucGx1Z2luc1siU2hvY2t3YXZlIEZsYXNoIl07aWYoeCYmeC5kZXNjcmlwdGlvbil7XzIzPW5ldyBkZWNvbmNlcHQuUGxheWVyVmVyc2lvbih4LmRlc2NyaXB0aW9uLnJlcGxhY2UoLyhbYS16QS1aXXxccykrLywiIikucmVwbGFjZSgvKFxzK3J8XHMrYlswLTldKykvLCIuIikuc3BsaXQoIi4iKSk7fX1lbHNle2lmKG5hdmlnYXRvci51c2VyQWdlbnQmJm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiV2luZG93cyBDRSIpPj0wKXt2YXIgYXhvPTE7dmFyIF8yNj0zO3doaWxlKGF4byl7dHJ5e18yNisrO2F4bz1uZXcgQWN0aXZlWE9iamVjdCgiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2guIitfMjYpO18yMz1uZXcgZGVjb25jZXB0LlBsYXllclZlcnNpb24oW18yNiwwLDBdKTt9Y2F0Y2goZSl7YXhvPW51bGw7fX19ZWxzZXt0cnl7dmFyIGF4bz1uZXcgQWN0aXZlWE9iamVjdCgiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2guNyIpO31jYXRjaChlKXt0cnl7dmFyIGF4bz1uZXcgQWN0aXZlWE9iamVjdCgiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2guNiIpO18yMz1uZXcgZGVjb25jZXB0LlBsYXllclZlcnNpb24oWzYsMCwyMV0pO2F4by5BbGxvd1NjcmlwdEFjY2Vzcz0iYWx3YXlzIjt9Y2F0Y2goZSl7aWYoXzIzLm1ham9yPT02KXtyZXR1cm4gXzIzO319dHJ5e2F4bz1uZXcgQWN0aXZlWE9iamVjdCgiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2giKTt9Y2F0Y2goZSl7fX1pZihheG8hPW51bGwpe18yMz1uZXcgZGVjb25jZXB0LlBsYXllclZlcnNpb24oYXhvLkdldFZhcmlhYmxlKCIkdmVyc2lvbiIpLnNwbGl0KCIgIilbMV0uc3BsaXQoIiwiKSk7fX19cmV0dXJuIF8yMzt9O2RlY29uY2VwdC5QbGF5ZXJWZXJzaW9uPWZ1bmN0aW9uKF8yOSl7dGhpcy5tYWpvcj1fMjlbMF0hPW51bGw/cGFyc2VJbnQoXzI5WzBdKTowO3RoaXMubWlub3I9XzI5WzFdIT1udWxsP3BhcnNlSW50KF8yOVsxXSk6MDt0aGlzLnJldj1fMjlbMl0hPW51bGw/cGFyc2VJbnQoXzI5WzJdKTowO307ZGVjb25jZXB0LlBsYXllclZlcnNpb24ucHJvdG90eXBlLnZlcnNpb25Jc1ZhbGlkPWZ1bmN0aW9uKGZ2KXtpZih0aGlzLm1ham9yPGZ2Lm1ham9yKXtyZXR1cm4gZmFsc2U7fWlmKHRoaXMubWFqb3I+ZnYubWFqb3Ipe3JldHVybiB0cnVlO31pZih0aGlzLm1pbm9yPGZ2Lm1pbm9yKXtyZXR1cm4gZmFsc2U7fWlmKHRoaXMubWlub3I+ZnYubWlub3Ipe3JldHVybiB0cnVlO31pZih0aGlzLnJldjxmdi5yZXYpe3JldHVybiBmYWxzZTt9cmV0dXJuIHRydWU7fTtkZWNvbmNlcHQudXRpbD17Z2V0UmVxdWVzdFBhcmFtZXRlcjpmdW5jdGlvbihfMmIpe3ZhciBxPWRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaHx8ZG9jdW1lbnQubG9jYXRpb24uaGFzaDtpZihfMmI9PW51bGwpe3JldHVybiBxO31pZihxKXt2YXIgXzJkPXEuc3Vic3RyaW5nKDEpLnNwbGl0KCImIik7Zm9yKHZhciBpPTA7aTxfMmQubGVuZ3RoO2krKyl7aWYoXzJkW2ldLnN1YnN0cmluZygwLF8yZFtpXS5pbmRleE9mKCI9IikpPT1fMmIpe3JldHVybiBfMmRbaV0uc3Vic3RyaW5nKChfMmRbaV0uaW5kZXhPZigiPSIpKzEpKTt9fX1yZXR1cm4gIiI7fX07ZGVjb25jZXB0LlNXRk9iamVjdFV0aWwuY2xlYW51cFNXRnM9ZnVuY3Rpb24oKXt2YXIgXzJmPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJPQkpFQ1QiKTtmb3IodmFyIGk9XzJmLmxlbmd0aC0xO2k+PTA7aS0tKXtfMmZbaV0uc3R5bGUuZGlzcGxheT0ibm9uZSI7Zm9yKHZhciB4IGluIF8yZltpXSl7aWYodHlwZW9mIF8yZltpXVt4XT09ImZ1bmN0aW9uIil7XzJmW2ldW3hdPWZ1bmN0aW9uKCl7fTt9fX19O2lmKGRlY29uY2VwdC5TV0ZPYmplY3QuZG9QcmVwVW5sb2FkKXtpZighZGVjb25jZXB0LnVubG9hZFNldCl7ZGVjb25jZXB0LlNXRk9iamVjdFV0aWwucHJlcFVubG9hZD1mdW5jdGlvbigpe19fZmxhc2hfdW5sb2FkSGFuZGxlcj1mdW5jdGlvbigpe307X19mbGFzaF9zYXZlZFVubG9hZEhhbmRsZXI9ZnVuY3Rpb24oKXt9O3dpbmRvdy5hdHRhY2hFdmVudCgib251bmxvYWQiLGRlY29uY2VwdC5TV0ZPYmplY3RVdGlsLmNsZWFudXBTV0ZzKTt9O3dpbmRvdy5hdHRhY2hFdmVudCgib25iZWZvcmV1bmxvYWQiLGRlY29uY2VwdC5TV0ZPYmplY3RVdGlsLnByZXBVbmxvYWQpO2RlY29uY2VwdC51bmxvYWRTZXQ9dHJ1ZTt9fWlmKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCYmZG9jdW1lbnQuYWxsKXtkb2N1bWVudC5nZXRFbGVtZW50QnlJZD1mdW5jdGlvbihpZCl7cmV0dXJuIGRvY3VtZW50LmFsbFtpZF07fTt9dmFyIGdldFF1ZXJ5UGFyYW1WYWx1ZT1kZWNvbmNlcHQudXRpbC5nZXRSZXF1ZXN0UGFyYW1ldGVyO3ZhciBGbGFzaE9iamVjdD1kZWNvbmNlcHQuU1dGT2JqZWN0O3ZhciBTV0ZPYmplY3Q9ZGVjb25jZXB0LlNXRk9iamVjdDs=",
                "body": "LyoqCiAqIFNXRk9iamVjdCB2MS41OiBGbGFzaCBQbGF5ZXIgZGV0ZWN0aW9uIGFuZCBlbWJlZCAtIGh0dHA6Ly9ibG9nLmRlY29uY2VwdC5jb20vc3dmb2JqZWN0LwogKgogKiBTV0ZPYmplY3QgaXMgKGMpIDIwMDcgR2VvZmYgU3RlYXJucyBhbmQgaXMgcmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlOgogKiBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAogKgogKi8KaWYodHlwZW9mIGRlY29uY2VwdD09InVuZGVmaW5lZCIpe3ZhciBkZWNvbmNlcHQ9bmV3IE9iamVjdCgpO31pZih0eXBlb2YgZGVjb25jZXB0LnV0aWw9PSJ1bmRlZmluZWQiKXtkZWNvbmNlcHQudXRpbD1uZXcgT2JqZWN0KCk7fWlmKHR5cGVvZiBkZWNvbmNlcHQuU1dGT2JqZWN0VXRpbD09InVuZGVmaW5lZCIpe2RlY29uY2VwdC5TV0ZPYmplY3RVdGlsPW5ldyBPYmplY3QoKTt9ZGVjb25jZXB0LlNXRk9iamVjdD1mdW5jdGlvbihfMSxpZCx3LGgsXzUsYyxfNyxfOCxfOSxfYSl7aWYoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKXtyZXR1cm47fXRoaXMuREVURUNUX0tFWT1fYT9fYToiZGV0ZWN0Zmxhc2giO3RoaXMuc2tpcERldGVjdD1kZWNvbmNlcHQudXRpbC5nZXRSZXF1ZXN0UGFyYW1ldGVyKHRoaXMuREVURUNUX0tFWSk7dGhpcy5wYXJhbXM9bmV3IE9iamVjdCgpO3RoaXMudmFyaWFibGVzPW5ldyBPYmplY3QoKTt0aGlzLmF0dHJpYnV0ZXM9bmV3IEFycmF5KCk7aWYoXzEpe3RoaXMuc2V0QXR0cmlidXRlKCJzd2YiLF8xKTt9aWYoaWQpe3RoaXMuc2V0QXR0cmlidXRlKCJpZCIsaWQpO31pZih3KXt0aGlzLnNldEF0dHJpYnV0ZSgid2lkdGgiLHcpO31pZihoKXt0aGlzLnNldEF0dHJpYnV0ZSgiaGVpZ2h0IixoKTt9aWYoXzUpe3RoaXMuc2V0QXR0cmlidXRlKCJ2ZXJzaW9uIixuZXcgZGVjb25jZXB0LlBsYXllclZlcnNpb24oXzUudG9TdHJpbmcoKS5zcGxpdCgiLiIpKSk7fXRoaXMuaW5zdGFsbGVkVmVyPWRlY29uY2VwdC5TV0ZPYmplY3RVdGlsLmdldFBsYXllclZlcnNpb24oKTtpZighd2luZG93Lm9wZXJhJiZkb2N1bWVudC5hbGwmJnRoaXMuaW5zdGFsbGVkVmVyLm1ham9yPjcpe2RlY29uY2VwdC5TV0ZPYmplY3QuZG9QcmVwVW5sb2FkPXRydWU7fWlmKGMpe3RoaXMuYWRkUGFyYW0oImJnY29sb3IiLGMpO312YXIgcT1fNz9fNzoiaGlnaCI7dGhpcy5hZGRQYXJhbSgicXVhbGl0eSIscSk7dGhpcy5zZXRBdHRyaWJ1dGUoInVzZUV4cHJlc3NJbnN0YWxsIixmYWxzZSk7dGhpcy5zZXRBdHRyaWJ1dGUoImRvRXhwcmVzc0luc3RhbGwiLGZhbHNlKTt2YXIgX2M9KF84KT9fODp3aW5kb3cubG9jYXRpb247dGhpcy5zZXRBdHRyaWJ1dGUoInhpUmVkaXJlY3RVcmwiLF9jKTt0aGlzLnNldEF0dHJpYnV0ZSgicmVkaXJlY3RVcmwiLCIiKTtpZihfOSl7dGhpcy5zZXRBdHRyaWJ1dGUoInJlZGlyZWN0VXJsIixfOSk7fX07ZGVjb25jZXB0LlNXRk9iamVjdC5wcm90b3R5cGU9e3VzZUV4cHJlc3NJbnN0YWxsOmZ1bmN0aW9uKF9kKXt0aGlzLnhpU1dGUGF0aD0hX2Q/ImV4cHJlc3NpbnN0YWxsLnN3ZiI6X2Q7dGhpcy5zZXRBdHRyaWJ1dGUoInVzZUV4cHJlc3NJbnN0YWxsIix0cnVlKTt9LHNldEF0dHJpYnV0ZTpmdW5jdGlvbihfZSxfZil7dGhpcy5hdHRyaWJ1dGVzW19lXT1fZjt9LGdldEF0dHJpYnV0ZTpmdW5jdGlvbihfMTApe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbXzEwXTt9LGFkZFBhcmFtOmZ1bmN0aW9uKF8xMSxfMTIpe3RoaXMucGFyYW1zW18xMV09XzEyO30sZ2V0UGFyYW1zOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGFyYW1zO30sYWRkVmFyaWFibGU6ZnVuY3Rpb24oXzEzLF8xNCl7dGhpcy52YXJpYWJsZXNbXzEzXT1fMTQ7fSxnZXRWYXJpYWJsZTpmdW5jdGlvbihfMTUpe3JldHVybiB0aGlzLnZhcmlhYmxlc1tfMTVdO30sZ2V0VmFyaWFibGVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFyaWFibGVzO30sZ2V0VmFyaWFibGVQYWlyczpmdW5jdGlvbigpe3ZhciBfMTY9bmV3IEFycmF5KCk7dmFyIGtleTt2YXIgXzE4PXRoaXMuZ2V0VmFyaWFibGVzKCk7Zm9yKGtleSBpbiBfMTgpe18xNltfMTYubGVuZ3RoXT1rZXkrIj0iK18xOFtrZXldO31yZXR1cm4gXzE2O30sZ2V0U1dGSFRNTDpmdW5jdGlvbigpe3ZhciBfMTk9IiI7aWYobmF2aWdhdG9yLnBsdWdpbnMmJm5hdmlnYXRvci5taW1lVHlwZXMmJm5hdmlnYXRvci5taW1lVHlwZXMubGVuZ3RoKXtpZih0aGlzLmdldEF0dHJpYnV0ZSgiZG9FeHByZXNzSW5zdGFsbCIpKXt0aGlzLmFkZFZhcmlhYmxlKCJNTXBsYXllclR5cGUiLCJQbHVnSW4iKTt0aGlzLnNldEF0dHJpYnV0ZSgic3dmIix0aGlzLnhpU1dGUGF0aCk7fV8xOT0iPGVtYmVkIHR5cGU9XCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaFwiIHNyYz1cIiIrdGhpcy5nZXRBdHRyaWJ1dGUoInN3ZiIpKyJcIiB3aWR0aD1cIiIrdGhpcy5nZXRBdHRyaWJ1dGUoIndpZHRoIikrIlwiIGhlaWdodD1cIiIrdGhpcy5nZXRBdHRyaWJ1dGUoImhlaWdodCIpKyJcIiBzdHlsZT1cIiIrdGhpcy5nZXRBdHRyaWJ1dGUoInN0eWxlIikrIlwiIjtfMTkrPSIgaWQ9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJpZCIpKyJcIiBuYW1lPVwiIit0aGlzLmdldEF0dHJpYnV0ZSgiaWQiKSsiXCIgIjt2YXIgXzFhPXRoaXMuZ2V0UGFyYW1zKCk7Zm9yKHZhciBrZXkgaW4gXzFhKXtfMTkrPVtrZXldKyI9XCIiK18xYVtrZXldKyJcIiAiO312YXIgXzFjPXRoaXMuZ2V0VmFyaWFibGVQYWlycygpLmpvaW4oIiYiKTtpZihfMWMubGVuZ3RoPjApe18xOSs9ImZsYXNodmFycz1cIiIrXzFjKyJcIiI7fV8xOSs9Ii8+Ijt9ZWxzZXtpZih0aGlzLmdldEF0dHJpYnV0ZSgiZG9FeHByZXNzSW5zdGFsbCIpKXt0aGlzLmFkZFZhcmlhYmxlKCJNTXBsYXllclR5cGUiLCJBY3RpdmVYIik7dGhpcy5zZXRBdHRyaWJ1dGUoInN3ZiIsdGhpcy54aVNXRlBhdGgpO31fMTk9IjxvYmplY3QgaWQ9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJpZCIpKyJcIiBjbGFzc2lkPVwiY2xzaWQ6RDI3Q0RCNkUtQUU2RC0xMWNmLTk2QjgtNDQ0NTUzNTQwMDAwXCIgd2lkdGg9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJ3aWR0aCIpKyJcIiBoZWlnaHQ9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJoZWlnaHQiKSsiXCIgc3R5bGU9XCIiK3RoaXMuZ2V0QXR0cmlidXRlKCJzdHlsZSIpKyJcIj4iO18xOSs9IjxwYXJhbSBuYW1lPVwibW92aWVcIiB2YWx1ZT1cIiIrdGhpcy5nZXRBdHRyaWJ1dGUoInN3ZiIpKyJcIiAvPiI7dmFyIF8xZD10aGlzLmdldFBhcmFtcygpO2Zvcih2YXIga2V5IGluIF8xZCl7XzE5Kz0iPHBhcmFtIG5hbWU9XCIiK2tleSsiXCIgdmFsdWU9XCIiK18xZFtrZXldKyJcIiAvPiI7fXZhciBfMWY9dGhpcy5nZXRWYXJpYWJsZVBhaXJzKCkuam9pbigiJiIpO2lmKF8xZi5sZW5ndGg+MCl7XzE5Kz0iPHBhcmFtIG5hbWU9XCJmbGFzaHZhcnNcIiB2YWx1ZT1cIiIrXzFmKyJcIiAvPiI7fV8xOSs9Ijwvb2JqZWN0PiI7fXJldHVybiBfMTk7fSx3cml0ZTpmdW5jdGlvbihfMjApe2lmKHRoaXMuZ2V0QXR0cmlidXRlKCJ1c2VFeHByZXNzSW5zdGFsbCIpKXt2YXIgXzIxPW5ldyBkZWNvbmNlcHQuUGxheWVyVmVyc2lvbihbNiwwLDY1XSk7aWYodGhpcy5pbnN0YWxsZWRWZXIudmVyc2lvbklzVmFsaWQoXzIxKSYmIXRoaXMuaW5zdGFsbGVkVmVyLnZlcnNpb25Jc1ZhbGlkKHRoaXMuZ2V0QXR0cmlidXRlKCJ2ZXJzaW9uIikpKXt0aGlzLnNldEF0dHJpYnV0ZSgiZG9FeHByZXNzSW5zdGFsbCIsdHJ1ZSk7dGhpcy5hZGRWYXJpYWJsZSgiTU1yZWRpcmVjdFVSTCIsZXNjYXBlKHRoaXMuZ2V0QXR0cmlidXRlKCJ4aVJlZGlyZWN0VXJsIikpKTtkb2N1bWVudC50aXRsZT1kb2N1bWVudC50aXRsZS5zbGljZSgwLDQ3KSsiIC0gRmxhc2ggUGxheWVyIEluc3RhbGxhdGlvbiI7dGhpcy5hZGRWYXJpYWJsZSgiTU1kb2N0aXRsZSIsZG9jdW1lbnQudGl0bGUpO319aWYodGhpcy5za2lwRGV0ZWN0fHx0aGlzLmdldEF0dHJpYnV0ZSgiZG9FeHByZXNzSW5zdGFsbCIpfHx0aGlzLmluc3RhbGxlZFZlci52ZXJzaW9uSXNWYWxpZCh0aGlzLmdldEF0dHJpYnV0ZSgidmVyc2lvbiIpKSl7dmFyIG49KHR5cGVvZiBfMjA9PSJzdHJpbmciKT9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChfMjApOl8yMDtuLmlubmVySFRNTD10aGlzLmdldFNXRkhUTUwoKTtyZXR1cm4gdHJ1ZTt9ZWxzZXtpZih0aGlzLmdldEF0dHJpYnV0ZSgicmVkaXJlY3RVcmwiKSE9IiIpe2RvY3VtZW50LmxvY2F0aW9uLnJlcGxhY2UodGhpcy5nZXRBdHRyaWJ1dGUoInJlZGlyZWN0VXJsIikpO319cmV0dXJuIGZhbHNlO319O2RlY29uY2VwdC5TV0ZPYmplY3RVdGlsLmdldFBsYXllclZlcnNpb249ZnVuY3Rpb24oKXt2YXIgXzIzPW5ldyBkZWNvbmNlcHQuUGxheWVyVmVyc2lvbihbMCwwLDBdKTtpZihuYXZpZ2F0b3IucGx1Z2lucyYmbmF2aWdhdG9yLm1pbWVUeXBlcy5sZW5ndGgpe3ZhciB4PW5hdmlnYXRvci5wbHVnaW5zWyJTaG9ja3dhdmUgRmxhc2giXTtpZih4JiZ4LmRlc2NyaXB0aW9uKXtfMjM9bmV3IGRlY29uY2VwdC5QbGF5ZXJWZXJzaW9uKHguZGVzY3JpcHRpb24ucmVwbGFjZSgvKFthLXpBLVpdfFxzKSsvLCIiKS5yZXBsYWNlKC8oXHMrcnxccytiWzAtOV0rKS8sIi4iKS5zcGxpdCgiLiIpKTt9fWVsc2V7aWYobmF2aWdhdG9yLnVzZXJBZ2VudCYmbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJXaW5kb3dzIENFIik+PTApe3ZhciBheG89MTt2YXIgXzI2PTM7d2hpbGUoYXhvKXt0cnl7XzI2Kys7YXhvPW5ldyBBY3RpdmVYT2JqZWN0KCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaC4iK18yNik7XzIzPW5ldyBkZWNvbmNlcHQuUGxheWVyVmVyc2lvbihbXzI2LDAsMF0pO31jYXRjaChlKXtheG89bnVsbDt9fX1lbHNle3RyeXt2YXIgYXhvPW5ldyBBY3RpdmVYT2JqZWN0KCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaC43Iik7fWNhdGNoKGUpe3RyeXt2YXIgYXhvPW5ldyBBY3RpdmVYT2JqZWN0KCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaC42Iik7XzIzPW5ldyBkZWNvbmNlcHQuUGxheWVyVmVyc2lvbihbNiwwLDIxXSk7YXhvLkFsbG93U2NyaXB0QWNjZXNzPSJhbHdheXMiO31jYXRjaChlKXtpZihfMjMubWFqb3I9PTYpe3JldHVybiBfMjM7fX10cnl7YXhvPW5ldyBBY3RpdmVYT2JqZWN0KCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaCIpO31jYXRjaChlKXt9fWlmKGF4byE9bnVsbCl7XzIzPW5ldyBkZWNvbmNlcHQuUGxheWVyVmVyc2lvbihheG8uR2V0VmFyaWFibGUoIiR2ZXJzaW9uIikuc3BsaXQoIiAiKVsxXS5zcGxpdCgiLCIpKTt9fX1yZXR1cm4gXzIzO307ZGVjb25jZXB0LlBsYXllclZlcnNpb249ZnVuY3Rpb24oXzI5KXt0aGlzLm1ham9yPV8yOVswXSE9bnVsbD9wYXJzZUludChfMjlbMF0pOjA7dGhpcy5taW5vcj1fMjlbMV0hPW51bGw/cGFyc2VJbnQoXzI5WzFdKTowO3RoaXMucmV2PV8yOVsyXSE9bnVsbD9wYXJzZUludChfMjlbMl0pOjA7fTtkZWNvbmNlcHQuUGxheWVyVmVyc2lvbi5wcm90b3R5cGUudmVyc2lvbklzVmFsaWQ9ZnVuY3Rpb24oZnYpe2lmKHRoaXMubWFqb3I8ZnYubWFqb3Ipe3JldHVybiBmYWxzZTt9aWYodGhpcy5tYWpvcj5mdi5tYWpvcil7cmV0dXJuIHRydWU7fWlmKHRoaXMubWlub3I8ZnYubWlub3Ipe3JldHVybiBmYWxzZTt9aWYodGhpcy5taW5vcj5mdi5taW5vcil7cmV0dXJuIHRydWU7fWlmKHRoaXMucmV2PGZ2LnJldil7cmV0dXJuIGZhbHNlO31yZXR1cm4gdHJ1ZTt9O2RlY29uY2VwdC51dGlsPXtnZXRSZXF1ZXN0UGFyYW1ldGVyOmZ1bmN0aW9uKF8yYil7dmFyIHE9ZG9jdW1lbnQubG9jYXRpb24uc2VhcmNofHxkb2N1bWVudC5sb2NhdGlvbi5oYXNoO2lmKF8yYj09bnVsbCl7cmV0dXJuIHE7fWlmKHEpe3ZhciBfMmQ9cS5zdWJzdHJpbmcoMSkuc3BsaXQoIiYiKTtmb3IodmFyIGk9MDtpPF8yZC5sZW5ndGg7aSsrKXtpZihfMmRbaV0uc3Vic3RyaW5nKDAsXzJkW2ldLmluZGV4T2YoIj0iKSk9PV8yYil7cmV0dXJuIF8yZFtpXS5zdWJzdHJpbmcoKF8yZFtpXS5pbmRleE9mKCI9IikrMSkpO319fXJldHVybiAiIjt9fTtkZWNvbmNlcHQuU1dGT2JqZWN0VXRpbC5jbGVhbnVwU1dGcz1mdW5jdGlvbigpe3ZhciBfMmY9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIk9CSkVDVCIpO2Zvcih2YXIgaT1fMmYubGVuZ3RoLTE7aT49MDtpLS0pe18yZltpXS5zdHlsZS5kaXNwbGF5PSJub25lIjtmb3IodmFyIHggaW4gXzJmW2ldKXtpZih0eXBlb2YgXzJmW2ldW3hdPT0iZnVuY3Rpb24iKXtfMmZbaV1beF09ZnVuY3Rpb24oKXt9O319fX07aWYoZGVjb25jZXB0LlNXRk9iamVjdC5kb1ByZXBVbmxvYWQpe2lmKCFkZWNvbmNlcHQudW5sb2FkU2V0KXtkZWNvbmNlcHQuU1dGT2JqZWN0VXRpbC5wcmVwVW5sb2FkPWZ1bmN0aW9uKCl7X19mbGFzaF91bmxvYWRIYW5kbGVyPWZ1bmN0aW9uKCl7fTtfX2ZsYXNoX3NhdmVkVW5sb2FkSGFuZGxlcj1mdW5jdGlvbigpe307d2luZG93LmF0dGFjaEV2ZW50KCJvbnVubG9hZCIsZGVjb25jZXB0LlNXRk9iamVjdFV0aWwuY2xlYW51cFNXRnMpO307d2luZG93LmF0dGFjaEV2ZW50KCJvbmJlZm9yZXVubG9hZCIsZGVjb25jZXB0LlNXRk9iamVjdFV0aWwucHJlcFVubG9hZCk7ZGVjb25jZXB0LnVubG9hZFNldD10cnVlO319aWYoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkJiZkb2N1bWVudC5hbGwpe2RvY3VtZW50LmdldEVsZW1lbnRCeUlkPWZ1bmN0aW9uKGlkKXtyZXR1cm4gZG9jdW1lbnQuYWxsW2lkXTt9O312YXIgZ2V0UXVlcnlQYXJhbVZhbHVlPWRlY29uY2VwdC51dGlsLmdldFJlcXVlc3RQYXJhbWV0ZXI7dmFyIEZsYXNoT2JqZWN0PWRlY29uY2VwdC5TV0ZPYmplY3Q7dmFyIFNXRk9iamVjdD1kZWNvbmNlcHQuU1dGT2JqZWN0Ow==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 20:16:04 GMT",
                    "Content-Length": "6880",
                    "Date": "Sat, 08 Nov 2014 20:16:04 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}