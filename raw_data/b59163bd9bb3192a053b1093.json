{
    "url": "http://localhost:9999/openlayers/openlayers/examples/example-list.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>window.location.search</b> and written to <b>the 'value' property of a DOM element</b> via the following statements:<ul><li>var list = window.location.search.substring(1).split(\"&amp;\");</li><li>var pair = list[i].split(\"=\");</li><li>params[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);</li><li>input.value = params[\"q\"];</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/openlayers/openlayers/examples/example-list.html",
                "path": "/openlayers/openlayers/examples/example-list.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9vcGVubGF5ZXJzL29wZW5sYXllcnMvZXhhbXBsZXMvZXhhbXBsZS1saXN0Lmh0bWwgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTEyNjYNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAyMToyMzoyOCBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMjE6MjM6MjggR01UDQoNCjwhRE9DVFlQRSBodG1sPgo8aHRtbD4KICAgIDxoZWFkPgogICAgICAgIDxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Ij4KICAgICAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9MCI+CiAgICAgICAgPG1ldGEgbmFtZT0iYXBwbGUtbW9iaWxlLXdlYi1hcHAtY2FwYWJsZSIgY29udGVudD0ieWVzIj4KICAgICAgICA8IS0tIFRoaXMgaXMgdGhlIGV4YW1wbGUgbGlzdCBzb3VyY2U6IGlmIHlvdSBhcmUgdHJ5aW5nIHRvIGxvb2sgYXQgdGhlIAogICAgICAgIHNvdXJjZSBvZiBhbiBleGFtcGxlLCBZT1UgQVJFIElOIFRIRSBXUk9ORyBQTEFDRS4gSWYgeW91IHdhbnQgdG8gdmlldwogICAgICAgIHRoZSBzb3VyY2Ugb2YganVzdCBvbmUgZXhhbXBsZSwgeW91IGNhbiB0eXBpY2FsbHkgY2hvb3NlIAogICAgICAgICJUaGlzIEZyYW1lIC0+IFZpZXcgc291cmNlIiB3aGVuIHJpZ2h0IGNsaWNraW5nIG9uIHRoZSBleGFtcGxlLiBJZiBub3QsCiAgICAgICAgY2hvb3NlIHRvIG9wZW4gdGhlIGV4YW1wbGUgaW4gYSBuZXcgd2luZG93ICh2aWEgdGhlIGNvbnRleHQgbWVudSAKICAgICAgICBjbGljayBvbiB0aGUgbGluayksIGFuZCB2aWV3IHNvdXJjZSBmcm9tIHRoZXJlLiAtLT4gIAogICAgICAgIDx0aXRsZT5PcGVuTGF5ZXJzIEV4YW1wbGVzPC90aXRsZT4KICAgICAgICA8bGluayByZWw9ImFsdGVybmF0ZSIgaHJlZj0iZXhhbXBsZS1saXN0LnhtbCIgdHlwZT0iYXBwbGljYXRpb24vYXRvbSt4bWwiIC8+CiAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJzdHlsZS5jc3MiIHR5cGU9InRleHQvY3NzIj4KICAgICAgICA8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgICAgICAgICBodG1sLCBib2R5IHsKICAgICAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMS4yNWVtOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNsb2dvIHsKICAgICAgICAgICAgICAgIHRleHQtc2hhZG93OiAycHggMnB4IDNweCBncmF5OwogICAgICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgICAgIHRvcDogNXB4OwogICAgICAgICAgICAgICAgbGVmdDogNXB4OwogICAgICAgICAgICAgICAgZm9udC1zaXplOiAzNHB4OwogICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6ICJUcmVidWNoZXQgTVMiLEhlbHZldGljYSxBcmlhbCxzYW5zLXNlcmlmOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNsb2dvIGltZyB7CiAgICAgICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5leF9jb250YWluZXJ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLmV4X2NvbnRhaW5lciBhIHsKICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDVweCAxZW07CiAgICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgICAgICAgfQogICAgICAgICAgICAuZXhfY29udGFpbmVyIGE6aG92ZXIgewogICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2VlZWVlZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAuZXhfdGl0bGV7CiAgICAgICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmU7CiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgICAgICAgICAgIGNvbG9yOiAjMzMzOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5leF90YWdzewogICAgICAgICAgICAgICAgZGlzcGxheTogaW5saW5lOwogICAgICAgICAgICAgICAgZm9udC1zaXplOiBzbWFsbGVyOwogICAgICAgICAgICAgICAgZm9udC1zdHlsZTogaXRhbGljOwogICAgICAgICAgICAgICAgY29sb3I6ICMzMzM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLmV4X2ZpbGVuYW1lIHsKICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuOGVtOwogICAgICAgICAgICAgICAgY29sb3I6ICNjY2MKICAgICAgICAgICAgfQogICAgICAgICAgICAuZXhfZGVzY3JpcHRpb257CiAgICAgICAgICAgICAgICBjb2xvcjogIzIyMjsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDNweDsKICAgICAgICAgICAgfQogICAgICAgICAgICAuZXhfY2xhc3Nlc3sKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogLjdlbTsKICAgICAgICAgICAgICAgIGNvbG9yOiBncmF5OwogICAgICAgICAgICAgICAgZGlzcGxheTogbm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAjdG9jIHsKICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNmaWx0ZXIgewogICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICAgICAgdG9wOiAwcHg7CiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjOUQ5RkExOwogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAxLjNlbSAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNleGFtcGxlcyB7CiAgICAgICAgICAgICAgICBvdmVyZmxvdzogYXV0bzsKICAgICAgICAgICAgICAgIGxpc3Qtc3R5bGU6IG5vbmU7CiAgICAgICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNleGFtcGxlcyB1bCB7CiAgICAgICAgICAgICAgICBsaXN0LXN0eWxlOiBub25lOwogICAgICAgICAgICAgICAgbWFyZ2luOiAwOwogICAgICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDRlbTsKICAgICAgICAgICAgfQogICAgICAgICAgICAjZXhhbXBsZXMgdWwgbGkgewogICAgICAgICAgICAgICAgZGlzcGxheTogaW5saW5lOwogICAgICAgICAgICAgICAgZmxvYXQ6IGxlZnQ7CiAgICAgICAgICAgICAgICB3aWR0aDogMzUwcHg7CiAgICAgICAgICAgICAgICBtYXJnaW46IDEwcHggMCAwIDEwcHg7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2RkZDsKICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDNweDsKICAgICAgICAgICAgfQogICAgICAgICAgICAjZXhhbXBsZXMgLm1haW5saW5rIHsKICAgICAgICAgICAgICAgIGhlaWdodDogOGVtOwogICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGF1dG87CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2V4d2luIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgICAgIHRvcDogMDsKICAgICAgICAgICAgICAgIGxlZnQ6IDMwJTsKICAgICAgICAgICAgICAgIHdpZHRoOiA3MCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgICAgICAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNjY2NjY2M7CiAgICAgICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA2MDBweCkgewogICAgICAgICAgICAgICAgI2V4YW1wbGVzIHVsIHsKICAgICAgICAgICAgICAgICAgICBtYXJnaW4tdG9wOiAxMDBweDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICNmaWx0ZXIgewogICAgICAgICAgICAgICAgICAgIHBhZGRpbmctdG9wOiA1MHB4OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgI2V4YW1wbGVzIHVsIGxpIHsKICAgICAgICAgICAgICAgICAgICBtYXJnaW4tbGVmdDogMDsKICAgICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICAgICAgICAgICAgICAgIGJvcmRlci13aWR0aDogMXB4IDA7CiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjZXhhbXBsZXMgLm1haW5saW5rIHsKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGF1dG87CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjZXhhbXBsZXMgLmV4X3RhZ3MsICNleGFtcGxlcyAuZXhfZmlsZW5hbWUgewogICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICA8L3N0eWxlPgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Ikp1Z2wuanMiPjwvc2NyaXB0PgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9ImV4YW1wbGUtbGlzdC5qcyI+PC9zY3JpcHQ+CiAgICAgICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgogICAgICAgICAgICB2YXIgdGVtcGxhdGUsIHRhcmdldDsKCiAgICAgICAgICAgIGZ1bmN0aW9uIGxpc3RFeGFtcGxlcyhleGFtcGxlcykgewogICAgICAgICAgICAgICAgdGFyZ2V0LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgdmFyIG5vZGUgPSB0ZW1wbGF0ZS5wcm9jZXNzKHsKICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiB7ZXhhbXBsZXM6IGV4YW1wbGVzfSwKICAgICAgICAgICAgICAgICAgICBjbG9uZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IHRhcmdldAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY291bnQiKS5pbm5lckhUTUwgPSAiKCIgKyBleGFtcGxlcy5sZW5ndGggKyAiKSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciB0aW1lcklkOwogICAgICAgICAgICBmdW5jdGlvbiBpbnB1dENoYW5nZSgpIHsKICAgICAgICAgICAgICAgIGlmKHRpbWVySWQpIHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRpbWVySWQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIHRleHQgPSB0aGlzLnZhbHVlOwogICAgICAgICAgICAgICAgdGltZXJJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGZpbHRlckxpc3QodGV4dCk7CiAgICAgICAgICAgICAgICB9LCA1MDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBmdW5jdGlvbiBmaWx0ZXJMaXN0KHRleHQpIHsKICAgICAgICAgICAgICAgIHZhciBleGFtcGxlczsKICAgICAgICAgICAgICAgIGlmKHRleHQubGVuZ3RoIDwgMikgewogICAgICAgICAgICAgICAgICAgIGV4YW1wbGVzID0gaW5mby5leGFtcGxlczsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmRzID0gdGV4dC5zcGxpdCgvXFcrLyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNjb3JlcyA9IHt9OwogICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wOyBpPHdvcmRzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3b3JkID0gd29yZHNbaV0udG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpY3QgPSBpbmZvLmluZGV4W3dvcmRdOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlU2NvcmVzID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoZXhJbmRleCBpbiBkaWN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gZGljdFtleEluZGV4XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzY29yZXNbZXhJbmRleF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2NvcmVzW2V4SW5kZXhdW3dvcmRdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29yZXNbZXhJbmRleF1bd29yZF0gKz0gY291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29yZXNbZXhJbmRleF1bd29yZF0gPSBjb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3Jlc1tleEluZGV4XSA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29yZXNbZXhJbmRleF1bd29yZF0gPSBjb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRpY3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVNjb3JlcygpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGlkeCBpbiBpbmZvLmluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gbmV3IFJlZ0V4cCh3b3JkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyLnRlc3QoaWR4KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWN0ID0gaW5mby5pbmRleFtpZHhdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTY29yZXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBleGFtcGxlcyA9IFtdOwogICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaiBpbiBzY29yZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4ID0gaW5mby5leGFtcGxlc1tqXTsKICAgICAgICAgICAgICAgICAgICAgICAgZXguc2NvcmUgPSBzY29yZXNbal07CiAgICAgICAgICAgICAgICAgICAgICAgIGV4YW1wbGVzLnB1c2goZXgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyBzb3J0IGV4YW1wbGVzIGJ5IGZpcnN0IGJ5IG51bWJlciBvZiB3b3JkcyBtYXRjaGVkLCB0aGVuCiAgICAgICAgICAgICAgICAgICAgLy8gYnkgd29yZCBmcmVxdWVuY3kKICAgICAgICAgICAgICAgICAgICBleGFtcGxlcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNtcDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFXb3JkcyA9IDAsIGJXb3JkcyA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU2NvcmUgPSAwLCBiU2NvcmUgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgaW4gYS5zY29yZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNjb3JlICs9IGEuc2NvcmVbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV29yZHMgKz0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGogaW4gYi5zY29yZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlNjb3JlICs9IGIuc2NvcmVbal07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiV29yZHMgKz0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZihhV29yZHMgPT0gYldvcmRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbXAgPSBiU2NvcmUgLSBhU2NvcmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbXAgPSBiV29yZHMgLSBhV29yZHM7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNtcDsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxpc3RFeGFtcGxlcyhleGFtcGxlcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dBbGwoKSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgia2V5d29yZHMiKS52YWx1ZSA9ICIiOwogICAgICAgICAgICAgICAgbGlzdEV4YW1wbGVzKGluZm8uZXhhbXBsZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBmdW5jdGlvbiBwYXJzZVF1ZXJ5KCkgewogICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHt9OwogICAgICAgICAgICAgICAgdmFyIGxpc3QgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKS5zcGxpdCgiJiIpOwogICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGk8bGlzdC5sZW5ndGg7ICsraSkgewogICAgICAgICAgICAgICAgICAgIHZhciBwYWlyID0gbGlzdFtpXS5zcGxpdCgiPSIpOwogICAgICAgICAgICAgICAgICAgIGlmKHBhaXIubGVuZ3RoID09IDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zW2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYocGFyYW1zWyJxIl0pIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgia2V5d29yZHMiKTsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHBhcmFtc1sicSJdOwogICAgICAgICAgICAgICAgICAgIGlucHV0Q2hhbmdlLmNhbGwoaW5wdXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIC8vZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tleXdvcmRzJykuZm9jdXMoKTsKICAgICAgICAgICAgICAgIHRlbXBsYXRlID0gbmV3IGp1Z2wuVGVtcGxhdGUoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZXhhbXBsZXMiKTsKICAgICAgICAgICAgICAgIGxpc3RFeGFtcGxlcyhpbmZvLmV4YW1wbGVzKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJrZXl3b3JkcyIpLm9ua2V5dXAgPSBpbnB1dENoYW5nZTsKICAgICAgICAgICAgICAgIHBhcnNlUXVlcnkoKTsKICAgICAgICAgICAgfTsKICAgICAgICA8L3NjcmlwdD4KICAgIDwvaGVhZD4KICAgIDxib2R5PgogICAgICAgIDxkaXYgaWQ9InRvYyI+CiAgICAgICAgICAgIDxkaXYgaWQ9ImZpbHRlciI+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJsb2dvIj4KICAgICAgICAgICAgICAgIDxpbWcgc3JjPSJodHRwOi8vd3d3Lm9wZW5sYXllcnMub3JnL2ltYWdlcy9PcGVuTGF5ZXJzLnRyYWMucG5nIgogICAgICAgICAgICAgICAgIC8+CiAgICAgICAgICAgICAgICAgT3BlbkxheWVycwogICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8cD4KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgYXV0b2ZvY3VzIHBsYWNlaG9sZGVyPSJmaWx0ZXIgYnkga2V5d29yZHMuLi4iIHR5cGU9InRleHQiIGlkPSJrZXl3b3JkcyIgLz4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBpZD0iY291bnQiPjwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQgc2hvd0FsbCgpOyI+c2hvdyBhbGw8L2E+CiAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJleGFtcGxlcyI+PC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICA8dWwgaWQ9InRlbXBsYXRlIj4KICAgICAgICAgICAgICAgIDxsaSBjbGFzcz0iZXhfY29udGFpbmVyIiBqdWdsOnJlcGVhdD0iZXhhbXBsZSBleGFtcGxlcyI+CiAgICAgICAgICAgICAgICA8YSBqdWdsOmF0dHJpYnV0ZXM9ImhyZWYgZXhhbXBsZS5saW5rIiBjbGFzcz0ibWFpbmxpbmsiCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiPgogICAgICAgICAgICAgICAgICAgICAgICA8aDUgY2xhc3M9ImV4X3RpdGxlIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGp1Z2w6cmVwbGFjZT0iZXhhbXBsZS50aXRsZSI+dGl0bGU8L3NwYW4+PGJyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImV4X2ZpbGVuYW1lIiBqdWdsOmNvbnRlbnQ9IicoJyArIGV4YW1wbGUuZXhhbXBsZSArICcpJyI+ZmlsZW5hbWU8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvaDU+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImV4X2Rlc2NyaXB0aW9uIiBqdWdsOmNvbnRlbnQ9ImV4YW1wbGUuc2hvcnRkZXNjIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3J0IERlc2NyaXB0aW9uIGdvZXMgaGVyZQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9ImV4X2NsYXNzZXMiIGp1Z2w6Y29udGVudD0iZXhhbXBsZS5jbGFzc2VzIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlbGF0ZWQgQ2xhc3NlcyBnbyBoZXJlCiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZXhfdGFncyIganVnbDpjb250ZW50PSInLi4udGFnZ2VkIHdpdGggJyArIGV4YW1wbGUudGFncyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9hPgogICAgICAgICAgICAgICAgPC9saT4KICAgICAgICAgICAgPC91bD4KICAgICAgICA8L2Rpdj4KICAgIDwvYm9keT4KPC9odG1sPgo=",
                "body": "PCFET0NUWVBFIGh0bWw+CjxodG1sPgogICAgPGhlYWQ+CiAgICAgICAgPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiPgogICAgICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wLCBtYXhpbXVtLXNjYWxlPTEuMCwgdXNlci1zY2FsYWJsZT0wIj4KICAgICAgICA8bWV0YSBuYW1lPSJhcHBsZS1tb2JpbGUtd2ViLWFwcC1jYXBhYmxlIiBjb250ZW50PSJ5ZXMiPgogICAgICAgIDwhLS0gVGhpcyBpcyB0aGUgZXhhbXBsZSBsaXN0IHNvdXJjZTogaWYgeW91IGFyZSB0cnlpbmcgdG8gbG9vayBhdCB0aGUgCiAgICAgICAgc291cmNlIG9mIGFuIGV4YW1wbGUsIFlPVSBBUkUgSU4gVEhFIFdST05HIFBMQUNFLiBJZiB5b3Ugd2FudCB0byB2aWV3CiAgICAgICAgdGhlIHNvdXJjZSBvZiBqdXN0IG9uZSBleGFtcGxlLCB5b3UgY2FuIHR5cGljYWxseSBjaG9vc2UgCiAgICAgICAgIlRoaXMgRnJhbWUgLT4gVmlldyBzb3VyY2UiIHdoZW4gcmlnaHQgY2xpY2tpbmcgb24gdGhlIGV4YW1wbGUuIElmIG5vdCwKICAgICAgICBjaG9vc2UgdG8gb3BlbiB0aGUgZXhhbXBsZSBpbiBhIG5ldyB3aW5kb3cgKHZpYSB0aGUgY29udGV4dCBtZW51IAogICAgICAgIGNsaWNrIG9uIHRoZSBsaW5rKSwgYW5kIHZpZXcgc291cmNlIGZyb20gdGhlcmUuIC0tPiAgCiAgICAgICAgPHRpdGxlPk9wZW5MYXllcnMgRXhhbXBsZXM8L3RpdGxlPgogICAgICAgIDxsaW5rIHJlbD0iYWx0ZXJuYXRlIiBocmVmPSJleGFtcGxlLWxpc3QueG1sIiB0eXBlPSJhcHBsaWNhdGlvbi9hdG9tK3htbCIgLz4KICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9InN0eWxlLmNzcyIgdHlwZT0idGV4dC9jc3MiPgogICAgICAgIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgICAgICAgIGh0bWwsIGJvZHkgewogICAgICAgICAgICAgICAgbWFyZ2luOiAwOwogICAgICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjI1ZW07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2xvZ28gewogICAgICAgICAgICAgICAgdGV4dC1zaGFkb3c6IDJweCAycHggM3B4IGdyYXk7CiAgICAgICAgICAgICAgICBjb2xvcjogd2hpdGU7CiAgICAgICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICAgICAgdG9wOiA1cHg7CiAgICAgICAgICAgICAgICBsZWZ0OiA1cHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDM0cHg7CiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogIlRyZWJ1Y2hldCBNUyIsSGVsdmV0aWNhLEFyaWFsLHNhbnMtc2VyaWY7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2xvZ28gaW1nIHsKICAgICAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLmV4X2NvbnRhaW5lcnsKICAgICAgICAgICAgfQogICAgICAgICAgICAuZXhfY29udGFpbmVyIGEgewogICAgICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgICAgICAgICAgICAgcGFkZGluZzogNXB4IDFlbTsKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5leF9jb250YWluZXIgYTpob3ZlciB7CiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWVlZWVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5leF90aXRsZXsKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZTsKICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgICAgICAgICAgY29sb3I6ICMzMzM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLmV4X3RhZ3N7CiAgICAgICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmU7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IHNtYWxsZXI7CiAgICAgICAgICAgICAgICBmb250LXN0eWxlOiBpdGFsaWM7CiAgICAgICAgICAgICAgICBjb2xvcjogIzMzMzsKICAgICAgICAgICAgfQogICAgICAgICAgICAuZXhfZmlsZW5hbWUgewogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IG5vcm1hbDsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07CiAgICAgICAgICAgICAgICBjb2xvcjogI2NjYwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5leF9kZXNjcmlwdGlvbnsKICAgICAgICAgICAgICAgIGNvbG9yOiAjMjIyOwogICAgICAgICAgICAgICAgcGFkZGluZzogM3B4OwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5leF9jbGFzc2VzewogICAgICAgICAgICAgICAgZm9udC1zaXplOiAuN2VtOwogICAgICAgICAgICAgICAgY29sb3I6IGdyYXk7CiAgICAgICAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgICN0b2MgewogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2ZpbHRlciB7CiAgICAgICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgICAgICB0b3A6IDBweDsKICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICM5RDlGQTE7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDEuM2VtIDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2V4YW1wbGVzIHsKICAgICAgICAgICAgICAgIG92ZXJmbG93OiBhdXRvOwogICAgICAgICAgICAgICAgbGlzdC1zdHlsZTogbm9uZTsKICAgICAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2V4YW1wbGVzIHVsIHsKICAgICAgICAgICAgICAgIGxpc3Qtc3R5bGU6IG5vbmU7CiAgICAgICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogNGVtOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNleGFtcGxlcyB1bCBsaSB7CiAgICAgICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmU7CiAgICAgICAgICAgICAgICBmbG9hdDogbGVmdDsKICAgICAgICAgICAgICAgIHdpZHRoOiAzNTBweDsKICAgICAgICAgICAgICAgIG1hcmdpbjogMTBweCAwIDAgMTBweDsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjZGRkOwogICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogM3B4OwogICAgICAgICAgICB9CiAgICAgICAgICAgICNleGFtcGxlcyAubWFpbmxpbmsgewogICAgICAgICAgICAgICAgaGVpZ2h0OiA4ZW07CiAgICAgICAgICAgICAgICBvdmVyZmxvdzogYXV0bzsKICAgICAgICAgICAgfQogICAgICAgICAgICAjZXh3aW4gewogICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICAgICAgdG9wOiAwOwogICAgICAgICAgICAgICAgbGVmdDogMzAlOwogICAgICAgICAgICAgICAgd2lkdGg6IDcwJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI2NjY2NjYzsKICAgICAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBAbWVkaWEgb25seSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDYwMHB4KSB7CiAgICAgICAgICAgICAgICAjZXhhbXBsZXMgdWwgewogICAgICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwMHB4OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgI2ZpbHRlciB7CiAgICAgICAgICAgICAgICAgICAgcGFkZGluZy10b3A6IDUwcHg7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjZXhhbXBsZXMgdWwgbGkgewogICAgICAgICAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiAwOwogICAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDA7CiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXdpZHRoOiAxcHggMDsKICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICNleGFtcGxlcyAubWFpbmxpbmsgewogICAgICAgICAgICAgICAgICAgIGhlaWdodDogYXV0bzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICNleGFtcGxlcyAuZXhfdGFncywgI2V4YW1wbGVzIC5leF9maWxlbmFtZSB7CiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogbm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIDwvc3R5bGU+CiAgICAgICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iSnVnbC5qcyI+PC9zY3JpcHQ+CiAgICAgICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iZXhhbXBsZS1saXN0LmpzIj48L3NjcmlwdD4KICAgICAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSwgdGFyZ2V0OwoKICAgICAgICAgICAgZnVuY3Rpb24gbGlzdEV4YW1wbGVzKGV4YW1wbGVzKSB7CiAgICAgICAgICAgICAgICB0YXJnZXQuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHRlbXBsYXRlLnByb2Nlc3MoewogICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IHtleGFtcGxlczogZXhhbXBsZXN9LAogICAgICAgICAgICAgICAgICAgIGNsb25lOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBhcmVudDogdGFyZ2V0CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb3VudCIpLmlubmVySFRNTCA9ICIoIiArIGV4YW1wbGVzLmxlbmd0aCArICIpIjsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHRpbWVySWQ7CiAgICAgICAgICAgIGZ1bmN0aW9uIGlucHV0Q2hhbmdlKCkgewogICAgICAgICAgICAgICAgaWYodGltZXJJZCkgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZXJJZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IHRoaXMudmFsdWU7CiAgICAgICAgICAgICAgICB0aW1lcklkID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgZmlsdGVyTGlzdCh0ZXh0KTsKICAgICAgICAgICAgICAgIH0sIDUwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbHRlckxpc3QodGV4dCkgewogICAgICAgICAgICAgICAgdmFyIGV4YW1wbGVzOwogICAgICAgICAgICAgICAgaWYodGV4dC5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICAgICAgZXhhbXBsZXMgPSBpbmZvLmV4YW1wbGVzOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSB0ZXh0LnNwbGl0KC9cVysvKTsKICAgICAgICAgICAgICAgICAgICB2YXIgc2NvcmVzID0ge307CiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGk8d29yZHMubGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmQgPSB3b3Jkc1tpXS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGljdCA9IGluZm8uaW5kZXhbd29yZF07CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVTY29yZXMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihleEluZGV4IGluIGRpY3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSBkaWN0W2V4SW5kZXhdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNjb3Jlc1tleEluZGV4XSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzY29yZXNbZXhJbmRleF1bd29yZF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3Jlc1tleEluZGV4XVt3b3JkXSArPSBjb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3Jlc1tleEluZGV4XVt3b3JkXSA9IGNvdW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmVzW2V4SW5kZXhdID0ge307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3Jlc1tleEluZGV4XVt3b3JkXSA9IGNvdW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGljdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlU2NvcmVzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaWR4IGluIGluZm8uaW5kZXgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBuZXcgUmVnRXhwKHdvcmQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIudGVzdChpZHgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpY3QgPSBpbmZvLmluZGV4W2lkeF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVNjb3JlcygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGV4YW1wbGVzID0gW107CiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBqIGluIHNjb3JlcykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXggPSBpbmZvLmV4YW1wbGVzW2pdOwogICAgICAgICAgICAgICAgICAgICAgICBleC5zY29yZSA9IHNjb3Jlc1tqXTsKICAgICAgICAgICAgICAgICAgICAgICAgZXhhbXBsZXMucHVzaChleCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIHNvcnQgZXhhbXBsZXMgYnkgZmlyc3QgYnkgbnVtYmVyIG9mIHdvcmRzIG1hdGNoZWQsIHRoZW4KICAgICAgICAgICAgICAgICAgICAvLyBieSB3b3JkIGZyZXF1ZW5jeQogICAgICAgICAgICAgICAgICAgIGV4YW1wbGVzLnNvcnQoZnVuY3Rpb24oYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY21wOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVdvcmRzID0gMCwgYldvcmRzID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFTY29yZSA9IDAsIGJTY29yZSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaSBpbiBhLnNjb3JlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU2NvcmUgKz0gYS5zY29yZVtpXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXb3JkcyArPSAxOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaiBpbiBiLnNjb3JlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiU2NvcmUgKz0gYi5zY29yZVtqXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJXb3JkcyArPSAxOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFXb3JkcyA9PSBiV29yZHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtcCA9IGJTY29yZSAtIGFTY29yZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtcCA9IGJXb3JkcyAtIGFXb3JkczsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY21wOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGlzdEV4YW1wbGVzKGV4YW1wbGVzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgZnVuY3Rpb24gc2hvd0FsbCgpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJrZXl3b3JkcyIpLnZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICBsaXN0RXhhbXBsZXMoaW5mby5leGFtcGxlcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGZ1bmN0aW9uIHBhcnNlUXVlcnkoKSB7CiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0ge307CiAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpLnNwbGl0KCImIik7CiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDsgaTxsaXN0Lmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBhaXIgPSBsaXN0W2ldLnNwbGl0KCI9Iik7CiAgICAgICAgICAgICAgICAgICAgaWYocGFpci5sZW5ndGggPT0gMikgewogICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXNbZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihwYXJhbXNbInEiXSkgewogICAgICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJrZXl3b3JkcyIpOwogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlID0gcGFyYW1zWyJxIl07CiAgICAgICAgICAgICAgICAgICAgaW5wdXRDaGFuZ2UuY2FsbChpbnB1dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2V5d29yZHMnKS5mb2N1cygpOwogICAgICAgICAgICAgICAgdGVtcGxhdGUgPSBuZXcganVnbC5UZW1wbGF0ZSgidGVtcGxhdGUiKTsKICAgICAgICAgICAgICAgIHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJleGFtcGxlcyIpOwogICAgICAgICAgICAgICAgbGlzdEV4YW1wbGVzKGluZm8uZXhhbXBsZXMpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImtleXdvcmRzIikub25rZXl1cCA9IGlucHV0Q2hhbmdlOwogICAgICAgICAgICAgICAgcGFyc2VRdWVyeSgpOwogICAgICAgICAgICB9OwogICAgICAgIDwvc2NyaXB0PgogICAgPC9oZWFkPgogICAgPGJvZHk+CiAgICAgICAgPGRpdiBpZD0idG9jIj4KICAgICAgICAgICAgPGRpdiBpZD0iZmlsdGVyIj4KICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImxvZ28iPgogICAgICAgICAgICAgICAgPGltZyBzcmM9Imh0dHA6Ly93d3cub3BlbmxheWVycy5vcmcvaW1hZ2VzL09wZW5MYXllcnMudHJhYy5wbmciCiAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICBPcGVuTGF5ZXJzCiAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxwPgogICAgICAgICAgICAgICAgICAgIDxpbnB1dCBhdXRvZm9jdXMgcGxhY2Vob2xkZXI9ImZpbHRlciBieSBrZXl3b3Jkcy4uLiIgdHlwZT0idGV4dCIgaWQ9ImtleXdvcmRzIiAvPgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGlkPSJjb3VudCI+PC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCBzaG93QWxsKCk7Ij5zaG93IGFsbDwvYT4KICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgaWQ9ImV4YW1wbGVzIj48L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OiBub25lOyI+CiAgICAgICAgICAgIDx1bCBpZD0idGVtcGxhdGUiPgogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJleF9jb250YWluZXIiIGp1Z2w6cmVwZWF0PSJleGFtcGxlIGV4YW1wbGVzIj4KICAgICAgICAgICAgICAgIDxhIGp1Z2w6YXR0cmlidXRlcz0iaHJlZiBleGFtcGxlLmxpbmsiIGNsYXNzPSJtYWlubGluayIKICAgICAgICAgICAgICAgICAgICB0YXJnZXQ9Il9ibGFuayI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzcz0iZXhfdGl0bGUiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4ganVnbDpyZXBsYWNlPSJleGFtcGxlLnRpdGxlIj50aXRsZTwvc3Bhbj48YnI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iZXhfZmlsZW5hbWUiIGp1Z2w6Y29udGVudD0iJygnICsgZXhhbXBsZS5leGFtcGxlICsgJyknIj5maWxlbmFtZTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9oNT4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZXhfZGVzY3JpcHRpb24iIGp1Z2w6Y29udGVudD0iZXhhbXBsZS5zaG9ydGRlc2MiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvcnQgRGVzY3JpcHRpb24gZ29lcyBoZXJlCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz0iZXhfY2xhc3NlcyIganVnbDpjb250ZW50PSJleGFtcGxlLmNsYXNzZXMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVsYXRlZCBDbGFzc2VzIGdvIGhlcmUKICAgICAgICAgICAgICAgICAgICAgICAgPC9wPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJleF90YWdzIiBqdWdsOmNvbnRlbnQ9IicuLi50YWdnZWQgd2l0aCAnICsgZXhhbXBsZS50YWdzIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2E+CiAgICAgICAgICAgICAgICA8L2xpPgogICAgICAgICAgICA8L3VsPgogICAgICAgIDwvZGl2PgogICAgPC9ib2R5Pgo8L2h0bWw+Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 21:23:28 GMT",
                    "Content-Length": "11266",
                    "Date": "Fri, 07 Nov 2014 21:23:28 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}