{
    "url": "http://localhost:9999/node-inspector/node-inspector/front-end-node/Overrides.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>window.location.search</b> and written to <b>the 'search' property of a DOM element</b> via the following statement:<ul><li>a.search = window.location.search;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/node-inspector/node-inspector/front-end-node/Overrides.js",
                "path": "/node-inspector/node-inspector/front-end-node/Overrides.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9ub2RlLWluc3BlY3Rvci9ub2RlLWluc3BlY3Rvci9mcm9udC1lbmQtbm9kZS9PdmVycmlkZXMuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNzMyNw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAxOTozNToyMSBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMTk6MzU6MTUgR01UDQoNCi8qanNoaW50IGJyb3dzZXI6dHJ1ZSAqLwovKmdsb2JhbCBXZWJJbnNwZWN0b3I6dHJ1ZSwgSW5zcGVjdG9yRnJvbnRlbmRIb3N0OnRydWUsIEluc3BlY3RvckJhY2tlbmQ6dHJ1ZSwgaW1wb3J0U2NyaXB0OnRydWUgKi8KLypnbG9iYWwgUHJlZmVyZW5jZXM6dHJ1ZSAqLwoKLy8gV2lyZSB1cCB3ZWJzb2NrZXQgdG8gdGFsayB0byBiYWNrZW5kCldlYkluc3BlY3Rvci5sb2FkZWQgPSBmdW5jdGlvbigpIHsKCiAgdmFyIHdlYlNvY2tldFVybCA9IGZ1bmN0aW9uKCkgewogICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAvLyBicm93c2VyIHdpbGwgcmVzb2x2ZSB0aGlzIHJlbGF0aXZlIHBhdGggdG8gYW4gYWJzb2x1dGUgb25lCiAgICBhLmhyZWYgPSAnd3MnOwogICAgYS5zZWFyY2ggPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoOwogICAgYS5wcm90b2NvbCA9IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicgPyAnd3NzOicgOiAnd3M6JzsKICAgIHJldHVybiBhLmhyZWY7CiAgfSgpOwoKICBXZWJJbnNwZWN0b3Iuc29ja2V0ID0gbmV3IFdlYlNvY2tldCh3ZWJTb2NrZXRVcmwpOwoKICBXZWJJbnNwZWN0b3Iuc29ja2V0Lm9ubWVzc2FnZSA9IG9uV2ViU29ja2V0TWVzc2FnZTsKICBXZWJJbnNwZWN0b3Iuc29ja2V0Lm9uZXJyb3IgPSBvbldlYlNvY2tldEVycm9yOwogIFdlYkluc3BlY3Rvci5zb2NrZXQub25vcGVuID0gb25XZWJTb2NrZXRDb25uZWN0ZWQ7Cn07Cgp2YXIgX2luc3BlY3RvckluaXRpYWxpemVkID0gZmFsc2U7CgpmdW5jdGlvbiBvbldlYlNvY2tldEVycm9yKGVycm9yKSB7CiAgY29uc29sZS5lcnJvcihlcnJvcik7Cn0KCmZ1bmN0aW9uIG9uV2ViU29ja2V0Q29ubmVjdGVkKCkgewogIGlmIChfaW5zcGVjdG9ySW5pdGlhbGl6ZWQpIHJldHVybjsKICBJbnNwZWN0b3JGcm9udGVuZEhvc3Quc2VuZE1lc3NhZ2VUb0JhY2tlbmQgPSBXZWJJbnNwZWN0b3Iuc29ja2V0LnNlbmQuYmluZChXZWJJbnNwZWN0b3Iuc29ja2V0KTsKCiAgV2ViSW5zcGVjdG9yLmRvY2tDb250cm9sbGVyID0gbmV3IFdlYkluc3BlY3Rvci5Eb2NrQ29udHJvbGxlcigpOwogIFdlYkluc3BlY3Rvci5kb0xvYWRlZERvbmUoKTsKCiAgX2luc3BlY3RvckluaXRpYWxpemVkID0gdHJ1ZTsKfQoKZnVuY3Rpb24gb25XZWJTb2NrZXRNZXNzYWdlKHJlc3BvbnNlKSB7CgogIHZhciBtZXNzYWdlID0gcmVzcG9uc2UuZGF0YTsKCiAgaWYgKCFtZXNzYWdlKSByZXR1cm47CgogIGlmIChtZXNzYWdlID09PSAnc2hvd0NvbnNvbGUnKSB7CiAgICBXZWJJbnNwZWN0b3Iuc2hvd0NvbnNvbGUoKTsKICB9IGVsc2UgewogICAgSW5zcGVjdG9yQmFja2VuZC5kaXNwYXRjaChtZXNzYWdlKTsKICB9Cn0KCi8vIERpc2FibGUgSFRNTCAmIENTUyBpbnNwZWN0aW9ucwpXZWJJbnNwZWN0b3IucXVlcnlQYXJhbXNPYmplY3RbJ2lzU2hhcmVkV29ya2VyJ10gPSB0cnVlOwoKLy8gZGlzYWJsZSBldmVyeXRoaW5nIGJlc2lkZXMgc2NyaXB0cyBhbmQgY29uc29sZQovLyB0aGF0IG1lYW5zICdwcm9maWxlcycgYW5kICd0aW1lbGluZScgYXQgdGhlIG1vbWVudApXZWJJbnNwZWN0b3IuX29yaWdfcGFuZWxEZXNjcmlwdG9ycyA9IFdlYkluc3BlY3Rvci5fcGFuZWxEZXNjcmlwdG9yczsKV2ViSW5zcGVjdG9yLl9wYW5lbERlc2NyaXB0b3JzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHBhbmVsRGVzY3JpcHRvcnMgPSB0aGlzLl9vcmlnX3BhbmVsRGVzY3JpcHRvcnMoKTsKICByZXR1cm4gcGFuZWxEZXNjcmlwdG9ycy5maWx0ZXIoZnVuY3Rpb24ocGQpIHsKICAgIHJldHVybiBbJ3NjcmlwdHMnLCAnY29uc29sZScsICdwcm9maWxlcyddLmluZGV4T2YocGQubmFtZSgpKSAhPSAtMTsKICB9KTsKfTsKCi8vIFBhdGNoIHRoZSBleHByZXNzaW9uIHVzZWQgYXMgYW4gaW5pdGlhbCB2YWx1ZSBmb3IgYSBuZXcgd2F0Y2guCi8vIERldlRvb2xzJyB2YWx1ZSAiXG4iIGJyZWFrcyB0aGUgZGVidWdnZXIgcHJvdG9jb2wuCmltcG9ydFNjcmlwdCgnV2F0Y2hFeHByZXNzaW9uc1NpZGViYXJQYW5lLmpzJyk7CldlYkluc3BlY3Rvci5XYXRjaEV4cHJlc3Npb25zU2VjdGlvbi5OZXdXYXRjaEV4cHJlc3Npb24gPSAnXCdcJyc7CgpQcmVmZXJlbmNlcy5sb2NhbGl6ZVVJID0gZmFsc2U7ClByZWZlcmVuY2VzLmFwcGxpY2F0aW9uVGl0bGUgPSAnTm9kZSBJbnNwZWN0b3InOwoKV2ViSW5zcGVjdG9yLl9wbGF0Zm9ybUZsYXZvciA9IFdlYkluc3BlY3Rvci5QbGF0Zm9ybUZsYXZvci5NYWNMZW9wYXJkOwoKLy8gRnJvbnQtZW5kIHVzZXMgYGV2YWwgbG9jYXRpb24uaHJlZmAgdG8gZ2V0IHVybCBvZiBpbnNwZWN0ZWQgcGFnZQovLyBUaGlzIGRvZXMgbm90IHdvcmsgaW4gbm9kZS5qcyBmcm9tIG9idmlvdXMgcmVhc29ucywgYW5kIGNhdXNlCi8vIGEgJ251bGwnIG1lc3NhZ2UgdG8gYmUgcHJpbnRlZCBpbiBmcm9udC1lbmQgY29uc29sZS4KLy8gU2luY2UgUHJlZmVyZW5jZXMuYXBwbGljYXRpb25UaXRsZSBkb2VzIG5vdCBpbmNsdWRlIGluc3BlY3RlZCB1cmwsCi8vIHdlIGNhbiByZXR1cm4gYXJiaXRyYXJ5IHN0cmluZyBhcyBpbnNwZWN0ZWQgVVJMLgpXZWJJbnNwZWN0b3IuV29ya2VyTWFuYWdlci5fY2FsY3VsYXRlV29ya2VySW5zcGVjdG9yVGl0bGUgPSBmdW5jdGlvbigpIHsKICBJbnNwZWN0b3JGcm9udGVuZEhvc3QuaW5zcGVjdGVkVVJMQ2hhbmdlZCgnJyk7Cn07CgovLyBEbyBub3Qgb2ZmZXIgZG93bmxvYWQgb2YgdGhlIGVkaXRlZCBmaWxlIHdoZW4gc2F2aW5nIGNoYW5nZXMgdG8gVjguCi8vIERldlRvb2xzJyBpbXBsZW1lbnRhdGlvbiBjaGFuZ2VzIHdpbmRvdy5sb2NhdGlvbiB3aGljaCBjbG9zZXMKLy8gd2ViLXNvY2tldCBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2ZXIgYW5kIHRodXMgYnJlYWtzIHRoZSBpbnNwZWN0b3IuCkluc3BlY3RvckZyb250ZW5kSG9zdC5jbG9zZSA9IGZ1bmN0aW9uKHVybCwgY29udGVudCwgZm9yY2VTYXZlQXMpIHsKICBkZWxldGUgdGhpcy5fZmlsZUJ1ZmZlcnNbdXJsXTsKfTsKCi8vIExldCBEZXZUb29scyBrbm93IHdlIGNhbiBzYXZlIHRoZSBjb250ZW50IG9mIG1vZGlmaWVkIGZpbGVzLAovLyBzbyB0aGF0IGEgd2FybmluZyBpY29uIGlzIG5vdCBkaXNwbGF5ZWQgaW4gdGhlIGZpbGUgdGFiIGhlYWRlci4KLy8gU2VlIFVJU291cmNlQ29kZS5oYXNVbnNhdmVkQ29tbWl0dGVkQ2hhbmdlcyB0byB1bmRlcnN0YW5kIHdoeS4KV2ViSW5zcGVjdG9yLmV4dGVuc2lvblNlcnZlci5fb25TdWJzY3JpYmUoCiAgewogICAgdHlwZTpXZWJJbnNwZWN0b3IuZXh0ZW5zaW9uQVBJLkV2ZW50cy5SZXNvdXJjZUNvbnRlbnRDb21taXR0ZWQKICB9LAogIHsKICAgIHBvc3RNZXNzYWdlOiBmdW5jdGlvbihtc2cpIHsKICAgICAgLy8gbm8tb3AKICAgIH0KICB9Cik7CgovLyBGcm9udC1lbmQgaW50ZXJjZXB0cyBDbWQrUiwgQ3RybCtSIGFuZCBGNSBrZXlzIGFuZCByZWxvYWRzIHRoZSBkZWJ1Z2dlZAovLyBwYWdlIGluc3RlYWQgb2YgdGhlIGZyb250LWVuZCBwYWdlLiAgV2Ugd2FudCB0byBkaXNhYmxlIHRoaXMgYmVoYXZpb3VyLgpXZWJJbnNwZWN0b3IuX29yaWdfZG9jdW1lbnRLZXlEb3duID0gV2ViSW5zcGVjdG9yLmRvY3VtZW50S2V5RG93bjsKV2ViSW5zcGVjdG9yLmRvY3VtZW50S2V5RG93biA9IGZ1bmN0aW9uKGV2ZW50KSB7CiAgc3dpdGNoIChldmVudC5rZXlJZGVudGlmaWVyKSB7CiAgICBjYXNlICdVKzAwNTInOiAvLyBSIGtleQogICAgY2FzZSAnRjUnOgogICAgICByZXR1cm47CiAgfQogIFdlYkluc3BlY3Rvci5fb3JpZ19kb2N1bWVudEtleURvd24oZXZlbnQpOwp9OwoKdmFyIG9yaWdfY3JlYXRlUmVzb3VyY2VGcm9tRnJhbWVQYXlsb2FkID0KICBXZWJJbnNwZWN0b3IuUmVzb3VyY2VUcmVlTW9kZWwucHJvdG90eXBlLl9jcmVhdGVSZXNvdXJjZUZyb21GcmFtZVBheWxvYWQ7CgpXZWJJbnNwZWN0b3IuUmVzb3VyY2VUcmVlTW9kZWwucHJvdG90eXBlLl9jcmVhdGVSZXNvdXJjZUZyb21GcmFtZVBheWxvYWQgPQogIGZ1bmN0aW9uKGZyYW1lLCB1cmwsIHR5cGUsIG1pbWVUeXBlKSB7CiAgICAvLyBGb3JjZSBTY3JpcHQgdHlwZSBmb3IgYWxsIG5vZGUgZnJhbWVzLgogICAgLy8gRnJvbnQtZW5kIGFzc2lnbnMgRG9jdW1lbnQgdHlwZSAoaS5lLiBIVE1MKSB0byBvdXIgbWFpbiBzY3JpcHQgZmlsZS4KICAgIGlmIChmcmFtZS5faXNOb2RlSW5zcGVjdG9yU2NyaXB0KSB7CiAgICAgIHR5cGUgPSBXZWJJbnNwZWN0b3IucmVzb3VyY2VUeXBlcy5TY3JpcHQ7CiAgICB9CgogICAgcmV0dXJuIG9yaWdfY3JlYXRlUmVzb3VyY2VGcm9tRnJhbWVQYXlsb2FkKGZyYW1lLCB1cmwsIHR5cGUsIG1pbWVUeXBlKTsKICB9OwoKLy8KLy8gT3BlbiB0aGUgbWFpbiBhcHBsaWNhdGlvbiBmaWxlIG9uIHN0YXJ0dXAKLy8KCldlYkluc3BlY3Rvci5ub3RpZmljYXRpb25zLmFkZEV2ZW50TGlzdGVuZXIoCiAgV2ViSW5zcGVjdG9yLkV2ZW50cy5JbnNwZWN0b3JMb2FkZWQsCiAgZnVuY3Rpb24oKSB7CiAgICBXZWJJbnNwZWN0b3IucmVzb3VyY2VUcmVlTW9kZWwuYWRkRXZlbnRMaXN0ZW5lcigKICAgICAgV2ViSW5zcGVjdG9yLlJlc291cmNlVHJlZU1vZGVsLkV2ZW50VHlwZXMuQ2FjaGVkUmVzb3VyY2VzTG9hZGVkLAogICAgICBzaG93TWFpbkFwcEZpbGUsCiAgICAgIG51bGwKICAgICk7CiAgfSwKICBudWxsCik7CgoKZnVuY3Rpb24gc2hvd01haW5BcHBGaWxlKCkgewogIHZhciBmaWxlVGFicyA9IFdlYkluc3BlY3Rvci5zaG93UGFuZWwoJ3NjcmlwdHMnKS5fZWRpdG9yQ29udGFpbmVyLl9maWxlczsKICBpZiAoT2JqZWN0LmtleXMoZmlsZVRhYnMpLmxlbmd0aCA+IDApewogICAgLy8gU29tZSBmaWxlcyBhcmUgYWxyZWFkeSBvcGVuZWQgLSBkbyBub3QgY2hhbmdlIHVzZXIncyB3b3Jrc3BhY2UKICAgIHJldHVybjsKICB9CgogIHZhciB1aVNvdXJjZUNvZGVzID0gZ2V0QWxsVWlTb3VyY2VDb2RlcygpOwogIHZhciB1cmlUb1Nob3cgPSBXZWJJbnNwZWN0b3IuaW5zcGVjdGVkUGFnZVVSTDsKCiAgZm9yICh2YXIgaSBpbiB1aVNvdXJjZUNvZGVzKSB7CiAgICBpZiAodWlTb3VyY2VDb2Rlc1tpXS51cmkoKSAhPT0gdXJpVG9TaG93KSBjb250aW51ZTsKICAgIFdlYkluc3BlY3Rvci5zaG93UGFuZWwoJ3NjcmlwdHMnKS5zaG93VUlTb3VyY2VDb2RlKHVpU291cmNlQ29kZXNbaV0pOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBjb25zb2xlLmVycm9yKCdDYW5ub3Qgc2hvdyB0aGUgbWFpbiBhcHBsaWNhdGlvbiBmaWxlICcsIHVyaVRvU2hvdyk7Cn0KCmZ1bmN0aW9uIGdldEFsbFVpU291cmNlQ29kZXMoKSB7CiAgLy8gQmFzZWQgb24gRmlsdGVyZWRJdGVtU2VjdGlvbkRpYWxvZy5qcyA+IFNlbGVjdFVJU291cmNlQ29kZURpYWxvZygpCiAgdmFyIHByb2plY3RzID0gV2ViSW5zcGVjdG9yLndvcmtzcGFjZS5wcm9qZWN0cygpOwogIHZhciB1aVNvdXJjZUNvZGVzID0gW107CiAgdmFyIHByb2plY3RGaWxlczsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9qZWN0cy5sZW5ndGg7ICsraSkgewogICAgcHJvamVjdEZpbGVzID0gcHJvamVjdHNbaV0KICAgICAgLnVpU291cmNlQ29kZXMoKQogICAgICAuZmlsdGVyKG5hbWVJc05vdEVtcHR5KTsKICAgIHVpU291cmNlQ29kZXMgPSB1aVNvdXJjZUNvZGVzLmNvbmNhdChwcm9qZWN0RmlsZXMpOwogIH0KCiAgcmV0dXJuIHVpU291cmNlQ29kZXM7CgogIGZ1bmN0aW9uIG5hbWVJc05vdEVtcHR5KHApIHsKICAgIHJldHVybiBwLm5hbWUoKTsKICB9Cn0KCnZhciBvbGREZXRhY2hlZCA9IFdlYkluc3BlY3Rvci5kZXRhY2hlZDsKV2ViSW5zcGVjdG9yLmRldGFjaGVkID0gZnVuY3Rpb24gKCkgewogIG9sZERldGFjaGVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICB9LCA0MDApOwp9OwoKLy9SZW1vdmUgdW51c2FibGUgdGFicyBpbiBoZWxwIHdpbmRvdwpXZWJJbnNwZWN0b3IuU2V0dGluZ3NDb250cm9sbGVyLnByb3RvdHlwZS5vcmlnX3Nob3dTZXR0aW5nc1NjcmVlbiA9IAogIFdlYkluc3BlY3Rvci5TZXR0aW5nc0NvbnRyb2xsZXIucHJvdG90eXBlLnNob3dTZXR0aW5nc1NjcmVlbjsKV2ViSW5zcGVjdG9yLlNldHRpbmdzQ29udHJvbGxlci5wcm90b3R5cGUuc2hvd1NldHRpbmdzU2NyZWVuID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5vcmlnX3Nob3dTZXR0aW5nc1NjcmVlbihXZWJJbnNwZWN0b3IuU2V0dGluZ3NTY3JlZW4uVGFicy5TaG9ydGN1dHMpOwp9OwoKLy9PdmVycmlkZSBzb21lIHNwZWNpZmljIHN0cmluZ3MgaW4gVUkKdmFyIG9sZFVJU3RyaW5nID0gV2ViSW5zcGVjdG9yLlVJU3RyaW5nOwp2YXIgc3RyaW5nT3ZlcnJpZGVzID0gewogICcobm8gZG9tYWluKSc6ICcoY29yZSBtb2R1bGVzKScKfTsKV2ViSW5zcGVjdG9yLlVJU3RyaW5nID0gZnVuY3Rpb24oc3RyaW5nLCB2YXJhcmcpIHsKICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAgYXJnc1swXSA9IHN0cmluZ092ZXJyaWRlc1tzdHJpbmddIHx8IHN0cmluZzsKICByZXR1cm4gb2xkVUlTdHJpbmcuYXBwbHkodGhpcywgYXJncyk7Cn07CgovLyBIaWRlIGNocm9tZS1zcGVjaWZpYyBlbGVtZW50cwp2YXIgY2hyb21lU3BlY2lmaWNzV2FzSGlkZGVuID0gZmFsc2U7CldlYkluc3BlY3Rvci5zZXR0aW5ncy5sYXN0QWN0aXZlUGFuZWwuYWRkQ2hhbmdlTGlzdGVuZXIoCiAgZnVuY3Rpb24oZXZlbnQpIHsKICAgIHZhciBwYW5lbE5hbWUgPSBldmVudC5kYXRhOwogICAgaWYgKHBhbmVsTmFtZSA9PSAnc2NyaXB0cycgJiYgIWNocm9tZVNwZWNpZmljc1dhc0hpZGRlbikgewogICAgICB2YXIgcGFuZXMgPSBXZWJJbnNwZWN0b3IucGFuZWxzLnNjcmlwdHMuc2lkZWJhclBhbmVzOwogICAgICBbCiAgICAgICAgcGFuZXMuZG9tQnJlYWtwb2ludHMuZWxlbWVudCwKICAgICAgICBwYW5lcy5kb21CcmVha3BvaW50cy50aXRsZUVsZW1lbnQucGFyZW50Tm9kZSwKICAgICAgICBwYW5lcy5ldmVudExpc3RlbmVyQnJlYWtwb2ludHMuZWxlbWVudCwKICAgICAgICBwYW5lcy5ldmVudExpc3RlbmVyQnJlYWtwb2ludHMudGl0bGVFbGVtZW50LnBhcmVudE5vZGUsCiAgICAgICAgcGFuZXMueGhyQnJlYWtwb2ludHMuZWxlbWVudCwKICAgICAgICBwYW5lcy54aHJCcmVha3BvaW50cy50aXRsZUVsZW1lbnQucGFyZW50Tm9kZQogICAgICBdLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkgewogICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgIH0pOwogICAgICBjaHJvbWVTcGVjaWZpY3NXYXNIaWRkZW4gPSB0cnVlOwogICAgfQogIH0sCiAgbnVsbAopOwo=",
                "body": "Lypqc2hpbnQgYnJvd3Nlcjp0cnVlICovCi8qZ2xvYmFsIFdlYkluc3BlY3Rvcjp0cnVlLCBJbnNwZWN0b3JGcm9udGVuZEhvc3Q6dHJ1ZSwgSW5zcGVjdG9yQmFja2VuZDp0cnVlLCBpbXBvcnRTY3JpcHQ6dHJ1ZSAqLwovKmdsb2JhbCBQcmVmZXJlbmNlczp0cnVlICovCgovLyBXaXJlIHVwIHdlYnNvY2tldCB0byB0YWxrIHRvIGJhY2tlbmQKV2ViSW5zcGVjdG9yLmxvYWRlZCA9IGZ1bmN0aW9uKCkgewoKICB2YXIgd2ViU29ja2V0VXJsID0gZnVuY3Rpb24oKSB7CiAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgIC8vIGJyb3dzZXIgd2lsbCByZXNvbHZlIHRoaXMgcmVsYXRpdmUgcGF0aCB0byBhbiBhYnNvbHV0ZSBvbmUKICAgIGEuaHJlZiA9ICd3cyc7CiAgICBhLnNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7CiAgICBhLnByb3RvY29sID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6JyA/ICd3c3M6JyA6ICd3czonOwogICAgcmV0dXJuIGEuaHJlZjsKICB9KCk7CgogIFdlYkluc3BlY3Rvci5zb2NrZXQgPSBuZXcgV2ViU29ja2V0KHdlYlNvY2tldFVybCk7CgogIFdlYkluc3BlY3Rvci5zb2NrZXQub25tZXNzYWdlID0gb25XZWJTb2NrZXRNZXNzYWdlOwogIFdlYkluc3BlY3Rvci5zb2NrZXQub25lcnJvciA9IG9uV2ViU29ja2V0RXJyb3I7CiAgV2ViSW5zcGVjdG9yLnNvY2tldC5vbm9wZW4gPSBvbldlYlNvY2tldENvbm5lY3RlZDsKfTsKCnZhciBfaW5zcGVjdG9ySW5pdGlhbGl6ZWQgPSBmYWxzZTsKCmZ1bmN0aW9uIG9uV2ViU29ja2V0RXJyb3IoZXJyb3IpIHsKICBjb25zb2xlLmVycm9yKGVycm9yKTsKfQoKZnVuY3Rpb24gb25XZWJTb2NrZXRDb25uZWN0ZWQoKSB7CiAgaWYgKF9pbnNwZWN0b3JJbml0aWFsaXplZCkgcmV0dXJuOwogIEluc3BlY3RvckZyb250ZW5kSG9zdC5zZW5kTWVzc2FnZVRvQmFja2VuZCA9IFdlYkluc3BlY3Rvci5zb2NrZXQuc2VuZC5iaW5kKFdlYkluc3BlY3Rvci5zb2NrZXQpOwoKICBXZWJJbnNwZWN0b3IuZG9ja0NvbnRyb2xsZXIgPSBuZXcgV2ViSW5zcGVjdG9yLkRvY2tDb250cm9sbGVyKCk7CiAgV2ViSW5zcGVjdG9yLmRvTG9hZGVkRG9uZSgpOwoKICBfaW5zcGVjdG9ySW5pdGlhbGl6ZWQgPSB0cnVlOwp9CgpmdW5jdGlvbiBvbldlYlNvY2tldE1lc3NhZ2UocmVzcG9uc2UpIHsKCiAgdmFyIG1lc3NhZ2UgPSByZXNwb25zZS5kYXRhOwoKICBpZiAoIW1lc3NhZ2UpIHJldHVybjsKCiAgaWYgKG1lc3NhZ2UgPT09ICdzaG93Q29uc29sZScpIHsKICAgIFdlYkluc3BlY3Rvci5zaG93Q29uc29sZSgpOwogIH0gZWxzZSB7CiAgICBJbnNwZWN0b3JCYWNrZW5kLmRpc3BhdGNoKG1lc3NhZ2UpOwogIH0KfQoKLy8gRGlzYWJsZSBIVE1MICYgQ1NTIGluc3BlY3Rpb25zCldlYkluc3BlY3Rvci5xdWVyeVBhcmFtc09iamVjdFsnaXNTaGFyZWRXb3JrZXInXSA9IHRydWU7CgovLyBkaXNhYmxlIGV2ZXJ5dGhpbmcgYmVzaWRlcyBzY3JpcHRzIGFuZCBjb25zb2xlCi8vIHRoYXQgbWVhbnMgJ3Byb2ZpbGVzJyBhbmQgJ3RpbWVsaW5lJyBhdCB0aGUgbW9tZW50CldlYkluc3BlY3Rvci5fb3JpZ19wYW5lbERlc2NyaXB0b3JzID0gV2ViSW5zcGVjdG9yLl9wYW5lbERlc2NyaXB0b3JzOwpXZWJJbnNwZWN0b3IuX3BhbmVsRGVzY3JpcHRvcnMgPSBmdW5jdGlvbigpIHsKICB2YXIgcGFuZWxEZXNjcmlwdG9ycyA9IHRoaXMuX29yaWdfcGFuZWxEZXNjcmlwdG9ycygpOwogIHJldHVybiBwYW5lbERlc2NyaXB0b3JzLmZpbHRlcihmdW5jdGlvbihwZCkgewogICAgcmV0dXJuIFsnc2NyaXB0cycsICdjb25zb2xlJywgJ3Byb2ZpbGVzJ10uaW5kZXhPZihwZC5uYW1lKCkpICE9IC0xOwogIH0pOwp9OwoKLy8gUGF0Y2ggdGhlIGV4cHJlc3Npb24gdXNlZCBhcyBhbiBpbml0aWFsIHZhbHVlIGZvciBhIG5ldyB3YXRjaC4KLy8gRGV2VG9vbHMnIHZhbHVlICJcbiIgYnJlYWtzIHRoZSBkZWJ1Z2dlciBwcm90b2NvbC4KaW1wb3J0U2NyaXB0KCdXYXRjaEV4cHJlc3Npb25zU2lkZWJhclBhbmUuanMnKTsKV2ViSW5zcGVjdG9yLldhdGNoRXhwcmVzc2lvbnNTZWN0aW9uLk5ld1dhdGNoRXhwcmVzc2lvbiA9ICdcJ1wnJzsKClByZWZlcmVuY2VzLmxvY2FsaXplVUkgPSBmYWxzZTsKUHJlZmVyZW5jZXMuYXBwbGljYXRpb25UaXRsZSA9ICdOb2RlIEluc3BlY3Rvcic7CgpXZWJJbnNwZWN0b3IuX3BsYXRmb3JtRmxhdm9yID0gV2ViSW5zcGVjdG9yLlBsYXRmb3JtRmxhdm9yLk1hY0xlb3BhcmQ7CgovLyBGcm9udC1lbmQgdXNlcyBgZXZhbCBsb2NhdGlvbi5ocmVmYCB0byBnZXQgdXJsIG9mIGluc3BlY3RlZCBwYWdlCi8vIFRoaXMgZG9lcyBub3Qgd29yayBpbiBub2RlLmpzIGZyb20gb2J2aW91cyByZWFzb25zLCBhbmQgY2F1c2UKLy8gYSAnbnVsbCcgbWVzc2FnZSB0byBiZSBwcmludGVkIGluIGZyb250LWVuZCBjb25zb2xlLgovLyBTaW5jZSBQcmVmZXJlbmNlcy5hcHBsaWNhdGlvblRpdGxlIGRvZXMgbm90IGluY2x1ZGUgaW5zcGVjdGVkIHVybCwKLy8gd2UgY2FuIHJldHVybiBhcmJpdHJhcnkgc3RyaW5nIGFzIGluc3BlY3RlZCBVUkwuCldlYkluc3BlY3Rvci5Xb3JrZXJNYW5hZ2VyLl9jYWxjdWxhdGVXb3JrZXJJbnNwZWN0b3JUaXRsZSA9IGZ1bmN0aW9uKCkgewogIEluc3BlY3RvckZyb250ZW5kSG9zdC5pbnNwZWN0ZWRVUkxDaGFuZ2VkKCcnKTsKfTsKCi8vIERvIG5vdCBvZmZlciBkb3dubG9hZCBvZiB0aGUgZWRpdGVkIGZpbGUgd2hlbiBzYXZpbmcgY2hhbmdlcyB0byBWOC4KLy8gRGV2VG9vbHMnIGltcGxlbWVudGF0aW9uIGNoYW5nZXMgd2luZG93LmxvY2F0aW9uIHdoaWNoIGNsb3NlcwovLyB3ZWItc29ja2V0IGNvbm5lY3Rpb24gdG8gdGhlIHNlcnZlciBhbmQgdGh1cyBicmVha3MgdGhlIGluc3BlY3Rvci4KSW5zcGVjdG9yRnJvbnRlbmRIb3N0LmNsb3NlID0gZnVuY3Rpb24odXJsLCBjb250ZW50LCBmb3JjZVNhdmVBcykgewogIGRlbGV0ZSB0aGlzLl9maWxlQnVmZmVyc1t1cmxdOwp9OwoKLy8gTGV0IERldlRvb2xzIGtub3cgd2UgY2FuIHNhdmUgdGhlIGNvbnRlbnQgb2YgbW9kaWZpZWQgZmlsZXMsCi8vIHNvIHRoYXQgYSB3YXJuaW5nIGljb24gaXMgbm90IGRpc3BsYXllZCBpbiB0aGUgZmlsZSB0YWIgaGVhZGVyLgovLyBTZWUgVUlTb3VyY2VDb2RlLmhhc1Vuc2F2ZWRDb21taXR0ZWRDaGFuZ2VzIHRvIHVuZGVyc3RhbmQgd2h5LgpXZWJJbnNwZWN0b3IuZXh0ZW5zaW9uU2VydmVyLl9vblN1YnNjcmliZSgKICB7CiAgICB0eXBlOldlYkluc3BlY3Rvci5leHRlbnNpb25BUEkuRXZlbnRzLlJlc291cmNlQ29udGVudENvbW1pdHRlZAogIH0sCiAgewogICAgcG9zdE1lc3NhZ2U6IGZ1bmN0aW9uKG1zZykgewogICAgICAvLyBuby1vcAogICAgfQogIH0KKTsKCi8vIEZyb250LWVuZCBpbnRlcmNlcHRzIENtZCtSLCBDdHJsK1IgYW5kIEY1IGtleXMgYW5kIHJlbG9hZHMgdGhlIGRlYnVnZ2VkCi8vIHBhZ2UgaW5zdGVhZCBvZiB0aGUgZnJvbnQtZW5kIHBhZ2UuICBXZSB3YW50IHRvIGRpc2FibGUgdGhpcyBiZWhhdmlvdXIuCldlYkluc3BlY3Rvci5fb3JpZ19kb2N1bWVudEtleURvd24gPSBXZWJJbnNwZWN0b3IuZG9jdW1lbnRLZXlEb3duOwpXZWJJbnNwZWN0b3IuZG9jdW1lbnRLZXlEb3duID0gZnVuY3Rpb24oZXZlbnQpIHsKICBzd2l0Y2ggKGV2ZW50LmtleUlkZW50aWZpZXIpIHsKICAgIGNhc2UgJ1UrMDA1Mic6IC8vIFIga2V5CiAgICBjYXNlICdGNSc6CiAgICAgIHJldHVybjsKICB9CiAgV2ViSW5zcGVjdG9yLl9vcmlnX2RvY3VtZW50S2V5RG93bihldmVudCk7Cn07Cgp2YXIgb3JpZ19jcmVhdGVSZXNvdXJjZUZyb21GcmFtZVBheWxvYWQgPQogIFdlYkluc3BlY3Rvci5SZXNvdXJjZVRyZWVNb2RlbC5wcm90b3R5cGUuX2NyZWF0ZVJlc291cmNlRnJvbUZyYW1lUGF5bG9hZDsKCldlYkluc3BlY3Rvci5SZXNvdXJjZVRyZWVNb2RlbC5wcm90b3R5cGUuX2NyZWF0ZVJlc291cmNlRnJvbUZyYW1lUGF5bG9hZCA9CiAgZnVuY3Rpb24oZnJhbWUsIHVybCwgdHlwZSwgbWltZVR5cGUpIHsKICAgIC8vIEZvcmNlIFNjcmlwdCB0eXBlIGZvciBhbGwgbm9kZSBmcmFtZXMuCiAgICAvLyBGcm9udC1lbmQgYXNzaWducyBEb2N1bWVudCB0eXBlIChpLmUuIEhUTUwpIHRvIG91ciBtYWluIHNjcmlwdCBmaWxlLgogICAgaWYgKGZyYW1lLl9pc05vZGVJbnNwZWN0b3JTY3JpcHQpIHsKICAgICAgdHlwZSA9IFdlYkluc3BlY3Rvci5yZXNvdXJjZVR5cGVzLlNjcmlwdDsKICAgIH0KCiAgICByZXR1cm4gb3JpZ19jcmVhdGVSZXNvdXJjZUZyb21GcmFtZVBheWxvYWQoZnJhbWUsIHVybCwgdHlwZSwgbWltZVR5cGUpOwogIH07CgovLwovLyBPcGVuIHRoZSBtYWluIGFwcGxpY2F0aW9uIGZpbGUgb24gc3RhcnR1cAovLwoKV2ViSW5zcGVjdG9yLm5vdGlmaWNhdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcigKICBXZWJJbnNwZWN0b3IuRXZlbnRzLkluc3BlY3RvckxvYWRlZCwKICBmdW5jdGlvbigpIHsKICAgIFdlYkluc3BlY3Rvci5yZXNvdXJjZVRyZWVNb2RlbC5hZGRFdmVudExpc3RlbmVyKAogICAgICBXZWJJbnNwZWN0b3IuUmVzb3VyY2VUcmVlTW9kZWwuRXZlbnRUeXBlcy5DYWNoZWRSZXNvdXJjZXNMb2FkZWQsCiAgICAgIHNob3dNYWluQXBwRmlsZSwKICAgICAgbnVsbAogICAgKTsKICB9LAogIG51bGwKKTsKCgpmdW5jdGlvbiBzaG93TWFpbkFwcEZpbGUoKSB7CiAgdmFyIGZpbGVUYWJzID0gV2ViSW5zcGVjdG9yLnNob3dQYW5lbCgnc2NyaXB0cycpLl9lZGl0b3JDb250YWluZXIuX2ZpbGVzOwogIGlmIChPYmplY3Qua2V5cyhmaWxlVGFicykubGVuZ3RoID4gMCl7CiAgICAvLyBTb21lIGZpbGVzIGFyZSBhbHJlYWR5IG9wZW5lZCAtIGRvIG5vdCBjaGFuZ2UgdXNlcidzIHdvcmtzcGFjZQogICAgcmV0dXJuOwogIH0KCiAgdmFyIHVpU291cmNlQ29kZXMgPSBnZXRBbGxVaVNvdXJjZUNvZGVzKCk7CiAgdmFyIHVyaVRvU2hvdyA9IFdlYkluc3BlY3Rvci5pbnNwZWN0ZWRQYWdlVVJMOwoKICBmb3IgKHZhciBpIGluIHVpU291cmNlQ29kZXMpIHsKICAgIGlmICh1aVNvdXJjZUNvZGVzW2ldLnVyaSgpICE9PSB1cmlUb1Nob3cpIGNvbnRpbnVlOwogICAgV2ViSW5zcGVjdG9yLnNob3dQYW5lbCgnc2NyaXB0cycpLnNob3dVSVNvdXJjZUNvZGUodWlTb3VyY2VDb2Rlc1tpXSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGNvbnNvbGUuZXJyb3IoJ0Nhbm5vdCBzaG93IHRoZSBtYWluIGFwcGxpY2F0aW9uIGZpbGUgJywgdXJpVG9TaG93KTsKfQoKZnVuY3Rpb24gZ2V0QWxsVWlTb3VyY2VDb2RlcygpIHsKICAvLyBCYXNlZCBvbiBGaWx0ZXJlZEl0ZW1TZWN0aW9uRGlhbG9nLmpzID4gU2VsZWN0VUlTb3VyY2VDb2RlRGlhbG9nKCkKICB2YXIgcHJvamVjdHMgPSBXZWJJbnNwZWN0b3Iud29ya3NwYWNlLnByb2plY3RzKCk7CiAgdmFyIHVpU291cmNlQ29kZXMgPSBbXTsKICB2YXIgcHJvamVjdEZpbGVzOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb2plY3RzLmxlbmd0aDsgKytpKSB7CiAgICBwcm9qZWN0RmlsZXMgPSBwcm9qZWN0c1tpXQogICAgICAudWlTb3VyY2VDb2RlcygpCiAgICAgIC5maWx0ZXIobmFtZUlzTm90RW1wdHkpOwogICAgdWlTb3VyY2VDb2RlcyA9IHVpU291cmNlQ29kZXMuY29uY2F0KHByb2plY3RGaWxlcyk7CiAgfQoKICByZXR1cm4gdWlTb3VyY2VDb2RlczsKCiAgZnVuY3Rpb24gbmFtZUlzTm90RW1wdHkocCkgewogICAgcmV0dXJuIHAubmFtZSgpOwogIH0KfQoKdmFyIG9sZERldGFjaGVkID0gV2ViSW5zcGVjdG9yLmRldGFjaGVkOwpXZWJJbnNwZWN0b3IuZGV0YWNoZWQgPSBmdW5jdGlvbiAoKSB7CiAgb2xkRGV0YWNoZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogIH0sIDQwMCk7Cn07CgovL1JlbW92ZSB1bnVzYWJsZSB0YWJzIGluIGhlbHAgd2luZG93CldlYkluc3BlY3Rvci5TZXR0aW5nc0NvbnRyb2xsZXIucHJvdG90eXBlLm9yaWdfc2hvd1NldHRpbmdzU2NyZWVuID0gCiAgV2ViSW5zcGVjdG9yLlNldHRpbmdzQ29udHJvbGxlci5wcm90b3R5cGUuc2hvd1NldHRpbmdzU2NyZWVuOwpXZWJJbnNwZWN0b3IuU2V0dGluZ3NDb250cm9sbGVyLnByb3RvdHlwZS5zaG93U2V0dGluZ3NTY3JlZW4gPSBmdW5jdGlvbigpIHsKICB0aGlzLm9yaWdfc2hvd1NldHRpbmdzU2NyZWVuKFdlYkluc3BlY3Rvci5TZXR0aW5nc1NjcmVlbi5UYWJzLlNob3J0Y3V0cyk7Cn07CgovL092ZXJyaWRlIHNvbWUgc3BlY2lmaWMgc3RyaW5ncyBpbiBVSQp2YXIgb2xkVUlTdHJpbmcgPSBXZWJJbnNwZWN0b3IuVUlTdHJpbmc7CnZhciBzdHJpbmdPdmVycmlkZXMgPSB7CiAgJyhubyBkb21haW4pJzogJyhjb3JlIG1vZHVsZXMpJwp9OwpXZWJJbnNwZWN0b3IuVUlTdHJpbmcgPSBmdW5jdGlvbihzdHJpbmcsIHZhcmFyZykgewogIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTsKICBhcmdzWzBdID0gc3RyaW5nT3ZlcnJpZGVzW3N0cmluZ10gfHwgc3RyaW5nOwogIHJldHVybiBvbGRVSVN0cmluZy5hcHBseSh0aGlzLCBhcmdzKTsKfTsKCi8vIEhpZGUgY2hyb21lLXNwZWNpZmljIGVsZW1lbnRzCnZhciBjaHJvbWVTcGVjaWZpY3NXYXNIaWRkZW4gPSBmYWxzZTsKV2ViSW5zcGVjdG9yLnNldHRpbmdzLmxhc3RBY3RpdmVQYW5lbC5hZGRDaGFuZ2VMaXN0ZW5lcigKICBmdW5jdGlvbihldmVudCkgewogICAgdmFyIHBhbmVsTmFtZSA9IGV2ZW50LmRhdGE7CiAgICBpZiAocGFuZWxOYW1lID09ICdzY3JpcHRzJyAmJiAhY2hyb21lU3BlY2lmaWNzV2FzSGlkZGVuKSB7CiAgICAgIHZhciBwYW5lcyA9IFdlYkluc3BlY3Rvci5wYW5lbHMuc2NyaXB0cy5zaWRlYmFyUGFuZXM7CiAgICAgIFsKICAgICAgICBwYW5lcy5kb21CcmVha3BvaW50cy5lbGVtZW50LAogICAgICAgIHBhbmVzLmRvbUJyZWFrcG9pbnRzLnRpdGxlRWxlbWVudC5wYXJlbnROb2RlLAogICAgICAgIHBhbmVzLmV2ZW50TGlzdGVuZXJCcmVha3BvaW50cy5lbGVtZW50LAogICAgICAgIHBhbmVzLmV2ZW50TGlzdGVuZXJCcmVha3BvaW50cy50aXRsZUVsZW1lbnQucGFyZW50Tm9kZSwKICAgICAgICBwYW5lcy54aHJCcmVha3BvaW50cy5lbGVtZW50LAogICAgICAgIHBhbmVzLnhockJyZWFrcG9pbnRzLnRpdGxlRWxlbWVudC5wYXJlbnROb2RlCiAgICAgIF0uZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7CiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKICAgICAgfSk7CiAgICAgIGNocm9tZVNwZWNpZmljc1dhc0hpZGRlbiA9IHRydWU7CiAgICB9CiAgfSwKICBudWxsCik7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 19:35:15 GMT",
                    "Content-Length": "7327",
                    "Date": "Fri, 07 Nov 2014 19:35:21 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}