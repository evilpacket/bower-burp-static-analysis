{
    "url": "http://localhost:9999/MinnPost/minnpost-styles/bower_components/datatables/media/unit_testing/unit_test.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cookie manipulation (DOM-based)",
    "issueType": 5245696,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based cookie manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the value of a cookie in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will set an arbitrary value in the user's cookie.<br><br>The potential impact of the vulnerability depends on the role that the cookie plays within the application. If the cookie is used to control the behavior that results from certain user actions (for example, a 'production' versus 'demo' mode setting), then the attacker may be able to cause the user to perform unintended actions by manipulating the cookie's value. If the cookie is used to track the user's session, then the attacker may be able to perform a session fixation attack, in which they set the cookie's value to a valid token that they have obtained from the application, and then hijack the session during the victim user's subsequent interaction with the application.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cookie manipulation vulnerabilities is not to dynamically write to cookies using data that originated from any untrusted source. This behavior should never be implemented for cookies that have any role in controlling privileged actions or user sessions within the application.",
    "issueDetail": "The application may be vulnerable to DOM-based cookie manipulation. Data is read from <b>window.location.pathname</b> and written to <b>document.cookie</b> via the following statements:<ul><li>var aParts = window.location.pathname.split('/');</li><li>document.cookie = sNameFile+\"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=\"+    aParts.join('/') + \"/\";</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/MinnPost/minnpost-styles/bower_components/datatables/media/unit_testing/unit_test.js",
                "path": "/MinnPost/minnpost-styles/bower_components/datatables/media/unit_testing/unit_test.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9NaW5uUG9zdC9taW5ucG9zdC1zdHlsZXMvYm93ZXJfY29tcG9uZW50cy9kYXRhdGFibGVzL21lZGlhL3VuaXRfdGVzdGluZy91bml0X3Rlc3QuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODg4Nw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAxNjowOTo0OSBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMTY6MDk6NDYgR01UDQoNCi8qCiAqIEZpbGU6ICAgICAgICB1bml0X3Rlc3QuanMKICogVmVyc2lvbjogICAgIDAuMC4xCiAqIENWUzogICAgICAgICAkSWQkCiAqIERlc2NyaXB0aW9uOiBVbml0IHRlc3QgZnJhbWV3b3JrCiAqIEF1dGhvcjogICAgICBBbGxhbiBKYXJkaW5lICh3d3cuc3ByeW1lZGlhLmNvLnVrKQogKiBDcmVhdGVkOiAgICAgU3VuIE1hciAgOCAyMjowMjo0OSBHTVQgMjAwOQogKiBNb2RpZmllZDogICAgJERhdGUkIGJ5ICRBdXRob3IkCiAqIExhbmd1YWdlOiAgICBKYXZhc2NyaXB0CiAqIExpY2Vuc2U6ICAgICBHUEwgdjIgb3IgQlNEIDMgcG9pbnQgc3R5bGUKICogUHJvamVjdDogICAgIERhdGFUYWJsZXMKICogQ29udGFjdDogICAgIGFsbGFuLmphcmRpbmVAc3ByeW1lZGlhLmNvLnVrCiAqIAogKiBDb3B5cmlnaHQgMjAwOSBBbGxhbiBKYXJkaW5lLCBhbGwgcmlnaHRzIHJlc2VydmVkLgogKgogKiBEZXNjcmlwdGlvbjoKICogVGhpcyBpcyBhIGphdmFzY3JpcHQgbGlicmFyeSBzdWl0YWJsZSBmb3IgdXNlIGFzIGEgdW5pdCB0ZXN0aW5nIGZyYW1ld29yay4gRW1wbG95aW5nIGEgcXVldWluZwogKiBtZWNoYW5pc2ltIHRvIHRha2UgYWNjb3VudCBvZiBhc3luYyBldmVudHMgaW4gamF2YXNjcmlwdCwgdGhpcyBsaWJyYXJ5IHdpbGwgY29tbXVuaWNhdGVzIHdpdGgKICogYSBjb250cm9sbGVyIGZyYW1lICh0byByZXBvcnQgaW5kaXZpZHVhbCB0ZXN0IHN0YXR1cykuCiAqIAogKi8KCgp2YXIgb1Rlc3QgPSB7CgkvKiBCbG9jayBmdXJ0aGVyIHRlc3RzIGZyb20gb2NjdXJpbmcgLSBtaWdodCBiZSBlbmQgb2YgdGVzdHMgb3IgZHVlIHRvIGFzeW5jIHdhaXQgKi8KCWJCbG9jazogZmFsc2UsCgkKCS8qIE51bWJlciBvZiB0aW1lcyB0byB0cnkgcmV0ZXN0aW5nIGZvciBhIGJsb2NraW5nIHRlc3QgKi8KCWlSZVRlc3RMaW1pdDogMjAsCgkKCS8qIEFtb3VudCBvZiB0aW1lIHRvIHdhaXQgYmV0d2VlbiB0cnlpbmcgZm9yIGFuIGFzeW5jIHRlc3QgKi8KCWlSZVRlc3REZWxheTogMTUwLAoJCgkvKiBFbmQgdGVzdHMgLSBleHRlcm5hbCBjb250cm9sICovCgliRW5kOiBmYWxzZSwKCQoJLyogSW50ZXJuYWwgdmFyaWFibGVzICovCglfYW9RdWV1ZTogW10sCglfaVJlVGVzdDogMCwKCV9iRmluaXNoZWQ6IGZhbHNlLAoJCgkKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgoJICogUmVjb21tZW5lZCBwdWJsaWMgZnVuY3Rpb25zCgkgKi8KCQoJLyoKCSAqIEZ1bmN0aW9uOiBmblRlc3QKCSAqIFB1cnBvc2U6ICBBZGQgYSB0ZXN0IHRvIHRoZSBxdWV1ZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICBzdHJpbmc6c01lc3NhZ2UgLSBuYW1lIG9mIHRoZSB0ZXN0CgkgKiAgICAgICAgICAgZnVuY3Rpb246Zm5UZXN0IC0gZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBldmFsdWRhdGVkIHRvIGdldCB0aGUgdGVzdCByZXN1bHQKCSAqLwoJImZuVGVzdCI6IGZ1bmN0aW9uICggc01lc3NhZ2UsIGZuU2V0dXAsIGZuVGVzdCApCgl7CgkJdGhpcy5fYW9RdWV1ZS5wdXNoKCB7CgkJCSJzTWVzc2FnZSI6IHNNZXNzYWdlLAoJCQkiZm5TZXR1cCI6IGZuU2V0dXAsCgkJCSJmblRlc3QiOiBmblRlc3QsCgkJCSJiUG9sbCI6IGZhbHNlCgkJfSApOwoJCXRoaXMuX2ZuTmV4dCgpOwoJfSwKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmbldhaXRUZXN0CgkgKiBQdXJwb3NlOiAgQWRkIGEgdGVzdCB0byB0aGUgcXVldWUgd2hpY2ggaGFzIGEgcmUtdGVzdCBjeWNsZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICBzdHJpbmc6c01lc3NhZ2UgLSBuYW1lIG9mIHRoZSB0ZXN0CgkgKiAgICAgICAgICAgZnVuY3Rpb246Zm5UZXN0IC0gZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBldmFsdWRhdGVkIHRvIGdldCB0aGUgdGVzdCByZXN1bHQKCSAqLwoJImZuV2FpdFRlc3QiOiBmdW5jdGlvbiAoIHNNZXNzYWdlLCBmblNldHVwLCBmblRlc3QgKQoJewoJCXRoaXMuX2FvUXVldWUucHVzaCggewoJCQkic01lc3NhZ2UiOiBzTWVzc2FnZSwKCQkJImZuU2V0dXAiOiBmblNldHVwLAoJCQkiZm5UZXN0IjogZm5UZXN0LAoJCQkiYlBvbGwiOiB0cnVlCgkJfSApOwoJCXRoaXMuX2ZuTmV4dCgpOwoJfSwKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmblN0YXJ0CgkgKiBQdXJwb3NlOiAgSW5kaWNhdGUgdGhhdCB0aGlzIGlzIGEgbmV3IHVuaXQgYW5kIHdoYXQgaXQgaXMgdGVzdGluZyAobWVzc2FnZSB0byBlbmQgdXNlcikKCSAqIFJldHVybnM6ICAtCgkgKiBJbnB1dHM6ICAgc3RyaW5nOnNNZXNzYWdlIC0gbWVzc2FnZSB0byBnaXZlIHRvIHRoZSB1c2VyIGFib3V0IHRoaXMgdW5pdAoJICovCgkiZm5TdGFydCI6IGZ1bmN0aW9uICggc01lc3NhZ2UgKQoJewoJCXdpbmRvdy5wYXJlbnQuY29udHJvbGxlci5mblN0YXJ0TWVzc2FnZSggc01lc3NhZ2UgKTsKCX0sCgkKCS8qCgkgKiBGdW5jdGlvbjogZm5Db21wbGV0ZQoJICogUHVycG9zZTogIFRlbGwgdGhlIGNvbnRyb2xsZXIgdGhhdCB3ZSBhcmUgYWxsIGRvbmUgaGVyZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICAtCgkgKi8KCSJmbkNvbXBsZXRlIjogZnVuY3Rpb24gKCkKCXsKCQl0aGlzLl9iRmluaXNoZWQgPSB0cnVlOwoJCXRoaXMuX2ZuTmV4dCgpOwoJfSwKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmbkNvb2tpZURlc3Ryb3kKCSAqIFB1cnBvc2U6ICBEZXN0cm95IGEgY29va2llIG9mIGEgZ2l2ZW4gbmFtZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICAtCgkgKi8KCSJmbkNvb2tpZURlc3Ryb3kiOiBmdW5jdGlvbiAoIG9UYWJsZSApCgl7CgkJdmFyIHNOYW1lID0gb1RhYmxlLmZuU2V0dGluZ3MoKS5zQ29va2llUHJlZml4K29UYWJsZS5mblNldHRpbmdzKCkuc0luc3RhbmNlOwoJCXZhciBhUGFydHMgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTsKCQl2YXIgc05hbWVGaWxlID0gc05hbWUgKyAnXycgKyBhUGFydHMucG9wKCkucmVwbGFjZSgvW1wvOl0vZywiIikudG9Mb3dlckNhc2UoKTsKCQlkb2N1bWVudC5jb29raWUgPSBzTmFtZUZpbGUrIj07IGV4cGlyZXM9VGh1LCAwMS1KYW4tMTk3MCAwMDowMDowMSBHTVQ7IHBhdGg9IisKCQkJYVBhcnRzLmpvaW4oJy8nKSArICIvIjsKCX0sCgkKCQoJCgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCSAqIEludGVybmFsIGZ1bmN0aW9ucwoJICovCgkKCQoJIl9mblJlVGVzdCI6IGZ1bmN0aW9uICggb1Rlc3RJbmZvICkKCXsKCQl2YXIgYlJlc3VsdCA9IG9UZXN0SW5mby5mblRlc3QoICk7CgkJaWYgKCBiUmVzdWx0ICkKCQl7CgkJCS8qIFRlc3QgcGFzc2VkIG9uIHJldHJ5ICovCgkJCXRoaXMuX2ZuUmVzdWx0KCB0cnVlICk7CgkJCXRoaXMuX2ZuTmV4dCgpOwoJCX0KCQllbHNlCgkJewoJCQlpZiAoIHRoaXMuX2lSZVRlc3QgPCB0aGlzLmlSZVRlc3RMaW1pdCApCgkJCXsKCQkJCXRoaXMuX2lSZVRlc3QrKzsKCQkJCXNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJCQkJCW9UZXN0Ll9mblJlVGVzdCggb1Rlc3RJbmZvICk7CgkJCQl9LCB0aGlzLmlSZVRlc3REZWxheSApOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJdGhpcy5fZm5SZXN1bHQoIGZhbHNlICk7CgkJCX0KCQl9Cgl9LAoJCgkiX2ZuTmV4dCI6IGZ1bmN0aW9uICgpCgl7CgkJaWYgKCB0aGlzLmJFbmQgKQoJCXsKCQkJcmV0dXJuOwoJCX0KCQkKCQlpZiAoICF0aGlzLmJCbG9jayAmJiB0aGlzLl9hb1F1ZXVlLmxlbmd0aCA+IDAgKQoJCXsKCQkJdmFyIG9OZXh0VGVzdCA9IHRoaXMuX2FvUXVldWUuc2hpZnQoKTsKCQkJd2luZG93LnBhcmVudC5jb250cm9sbGVyLmZuVGVzdFN0YXJ0KCBvTmV4dFRlc3Quc01lc3NhZ2UgKTsKCQkJdGhpcy5iQmxvY2sgPSB0cnVlOwoJCQkKCQkJaWYgKCB0eXBlb2Ygb05leHRUZXN0LmZuU2V0dXAgPT0gJ2Z1bmN0aW9uJyApCgkJCXsKCQkJCW9OZXh0VGVzdC5mblNldHVwKCApOwoJCQl9CgkJCXZhciBiUmVzdWx0ID0gb05leHRUZXN0LmZuVGVzdCggKTsKCQkJLy9iUmVzdWx0ID0gZmFsc2U7CgkJCQoJCQlpZiAoIG9OZXh0VGVzdC5iUG9sbCApCgkJCXsKCQkJCWlmICggYlJlc3VsdCApCgkJCQl7CgkJCQkJdGhpcy5fZm5SZXN1bHQoIHRydWUgKTsKCQkJCQl0aGlzLl9mbk5leHQoKTsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQlfaVJlVGVzdCA9IDA7CgkJCQkJc2V0VGltZW91dCggZnVuY3Rpb24oKSB7CgkJCQkJCW9UZXN0Ll9mblJlVGVzdCggb05leHRUZXN0ICk7CgkJCQkJfSwgdGhpcy5pUmVUZXN0RGVsYXkgKTsKCQkJCX0KCQkJfQoJCQllbHNlCgkJCXsKCQkJCXRoaXMuX2ZuUmVzdWx0KCBiUmVzdWx0ICk7CgkJCQl0aGlzLl9mbk5leHQoKTsKCQkJfQoJCX0KCQllbHNlIGlmICggIXRoaXMuYkJsb2NrICYmIHRoaXMuX2FvUXVldWUubGVuZ3RoID09IDAgJiYgdGhpcy5fYkZpbmlzaGVkICkKCQl7CgkJCXdpbmRvdy5wYXJlbnQuY29udHJvbGxlci5mblVuaXRDb21wbGV0ZSggKTsKCQl9Cgl9LAoJCgkiX2ZuUmVzdWx0IjogZnVuY3Rpb24gKCBiICkKCXsKCQl3aW5kb3cucGFyZW50LmNvbnRyb2xsZXIuZm5UZXN0UmVzdWx0KCBiICk7CgkJdGhpcy5iQmxvY2sgPSBmYWxzZTsKCQlpZiAoICFiICkKCQl7CgkJCXRoaXMuYkVuZCA9IHRydWU7CgkJfQoJfQp9OwoKCnZhciBvRGlzcGFjaGVyID0gewoJImNsaWNrIjogZnVuY3Rpb24gKCBuTm9kZSwgb1NwZWNpYWwgKQoJewoJCXZhciBldnQgPSB0aGlzLmZuQ3JlYXRlRXZlbnQoICdjbGljaycsIG5Ob2RlLCBvU3BlY2lhbCApOwoJCWlmICggbk5vZGUuZGlzcGF0Y2hFdmVudCApCgkJCW5Ob2RlLmRpc3BhdGNoRXZlbnQoZXZ0KTsKCQllbHNlCgkJCW5Ob2RlLmZpcmVFdmVudCgnb25jbGljaycsIGV2dCk7Cgl9LAoJCgkiY2hhbmdlIjogZnVuY3Rpb24gKCBuTm9kZSApCgl7CgkJdmFyIGV2dCA9IHRoaXMuZm5DcmVhdGVFdmVudCggJ2NoYW5nZScsIG5Ob2RlICk7CgkJaWYgKCBuTm9kZS5kaXNwYXRjaEV2ZW50ICkKCQluTm9kZS5kaXNwYXRjaEV2ZW50KGV2dCk7CgkJZWxzZQoJCQluTm9kZS5maXJlRXZlbnQoJ29uY2hhbmdlJywgZXZ0KTsKCX0sCgkKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmbkNyZWF0ZUV2ZW50CgkgKiBQdXJwb3NlOiAgQ3JlYXRlIGFuIGV2ZW50IG9qZWN0IGJhc2VkIG9uIHRoZSB0eXBlIHRvIHRyaWdnZXIgYW4gZXZlbnQgLSB4LXBsYXRmb3JtCgkgKiBSZXR1cm5zOiAgZXZlbnQ6ZXZ0CgkgKiBJbnB1dHM6ICAgc3RyaW5nOnNUeXBlIC0gdHlwZSBvZiBldmVudAoJICogICAgICAgICAgIG5vZGU6blRhcmdldCAtIHRhcmdldCBub2RlIG9mIHRoZSBldmVudAoJICovCglmbkNyZWF0ZUV2ZW50OiBmdW5jdGlvbiggc1R5cGUsIG5UYXJnZXQsIG9TcGVjaWFsICkKCXsKCQl2YXIgZXZ0ID0gbnVsbDsKCQl2YXIgb1RhcmdldFBvcyA9IHRoaXMuX2ZuR2V0UG9zKCBuVGFyZ2V0ICk7CgkJdmFyIHNUeXBlR3JvdXAgPSB0aGlzLl9mbkV2ZW50VHlwZUdyb3VwKCBzVHlwZSApOwoJCWlmICggdHlwZW9mIG9TcGVjaWFsID09ICd1bmRlZmluZWQnICkKCQl7CgkJCW9TcGVjaWFsID0ge307CgkJfQoJCQoJCXZhciBjdHJsS2V5ID0gZmFsc2U7CgkJdmFyIGFsdEtleSA9IGZhbHNlOwoJCXZhciBzaGlmdEtleSA9ICh0eXBlb2Ygb1NwZWNpYWwuc2hpZnQgIT0gJ3VuZGVmaW5lZCcpID8gb1NwZWNpYWwuc2hpZnQgOiBmYWxzZTsKCQl2YXIgbWV0YUtleSA9IGZhbHNlOwoJCXZhciBidXR0b24gPSBmYWxzZTsKCQkKCQlpZiAoIGRvY3VtZW50LmNyZWF0ZUV2ZW50ICkKCQl7CgkJCXN3aXRjaCAoIHNUeXBlR3JvdXAgKQoJCQl7CgkJCQljYXNlICdtb3VzZSc6CgkJCQkJZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoICJNb3VzZUV2ZW50cyIgKTsKCQkJCQlldnQuaW5pdE1vdXNlRXZlbnQoIHNUeXBlLCB0cnVlLCB0cnVlLCB3aW5kb3csIDAsIG9UYXJnZXRQb3NbMF0sIG9UYXJnZXRQb3NbMV0sIAoJCQkJCQlvVGFyZ2V0UG9zWzBdLCBvVGFyZ2V0UG9zWzFdLCBjdHJsS2V5LCBhbHRLZXksIHNoaWZ0S2V5LCAKCQkJCQkJbWV0YUtleSwgYnV0dG9uLCBudWxsICk7CgkJCQkJYnJlYWs7CgkJCQkKCQkJCWNhc2UgJ2h0bWwnOgoJCQkJCWV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCAiSFRNTEV2ZW50cyIgKTsKCQkJCQlldnQuaW5pdEV2ZW50KCBzVHlwZSwgdHJ1ZSwgdHJ1ZSApOwoJCQkJCWJyZWFrOwoJCQkJCQoJCQkJY2FzZSAndWknOgoJCQkJCWV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCAiVUlFdmVudHMiICk7CgkJCQkJZXZ0LmluaXRVSUV2ZW50KCBzVHlwZSwgdHJ1ZSwgdHJ1ZSwgd2luZG93LCAwICk7CgkJCQkJYnJlYWs7CgkJCQkKCQkJCWRlZmF1bHQ6CgkJCQkJYnJlYWs7CgkJCX0KCQl9CgkJZWxzZSBpZiAoIGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0ICkKCQl7CgkJCXN3aXRjaCAoIHNUeXBlR3JvdXAgKQoJCQl7CgkJCQljYXNlICdtb3VzZSc6CgkJCQkJZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTsKCQkJCQlldnQuc2NyZWVuWCA9IG9UYXJnZXRQb3NbMF07CgkJCQkJZXZ0LnNjcmVlblggPSBvVGFyZ2V0UG9zWzFdOwoJCQkJCWV2dC5jbGllbnRYID0gb1RhcmdldFBvc1swXTsKCQkJCQlldnQuY2xpZW50WSA9IG9UYXJnZXRQb3NbMV07CgkJCQkJZXZ0LmN0cmxLZXkgPSBjdHJsS2V5OwoJCQkJCWV2dC5hbHRLZXkgPSBhbHRLZXk7CgkJCQkJZXZ0LnNoaWZ0S2V5ID0gc2hpZnRLZXk7CgkJCQkJZXZ0Lm1ldGFLZXkgPSBtZXRhS2V5OwoJCQkJCWV2dC5idXR0b24gPSBidXR0b247CgkJCQkJZXZ0LnJlbGF0ZWRUYXJnZXQgPSBudWxsOwoJCQkJCWJyZWFrOwoJCQkJCgkJCQljYXNlICdodG1sJzoKCQkJCQkvKiBmYWxsIHRocm91Z2ggdG8gYmFzaWMgZXZlbnQgb2JqZWN0ICovCgkJCQkJCgkJCQljYXNlICd1aSc6CgkJCQkJZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTsKCQkJCQlicmVhazsKCQkJCQoJCQkJZGVmYXVsdDoKCQkJCQlicmVhazsKCQkJfQoJCX0KCQkKCQlyZXR1cm4gZXZ0OwoJfSwKCQoJLyogCgkgKiBGdW5jdGlvbjogRGVzaWduQ29yZS5mbkdldFBvcwoJICogUHVycG9zZTogIEdldCB0aGUgcG9zaXRpb24gb2YgYW4gZWxlbWVudCBvbiB0aGUgcGFnZQoJICogUmV0dXJuczogIGFycmF5WyAwLWludDpsZWZ0LCAxLWludDp0b3AgXQoJICogSW5wdXRzOiAgIG5vZGU6b2JqIC0gbm9kZSB0byBhbmFseXNlCgkgKi8KCV9mbkdldFBvczogZnVuY3Rpb24gKCBvYmogKSAKCXsKCQl2YXIgY3VybGVmdCA9IDA7CgkJdmFyIGN1cnRvcCA9IDA7CgkJCgkJaWYgKG9iai5vZmZzZXRQYXJlbnQpIAoJCXsKCQkJY3VybGVmdCA9IG9iai5vZmZzZXRMZWZ0OwoJCQljdXJ0b3AgPSBvYmoub2Zmc2V0VG9wOwoJCQl3aGlsZSAob2JqID0gb2JqLm9mZnNldFBhcmVudCApIAoJCQl7CgkJCQljdXJsZWZ0ICs9IG9iai5vZmZzZXRMZWZ0OwoJCQkJY3VydG9wICs9IG9iai5vZmZzZXRUb3A7CgkJCX0KCQl9CgkJcmV0dXJuIFtjdXJsZWZ0LGN1cnRvcF07Cgl9LAoJCgkKCS8qCgkgKiBGdW5jdGlvbjogX2ZuRXZlbnRUeXBlR3JvdXAKCSAqIFB1cnBvc2U6ICBHcm91cCB0aGUgZXZlbnQgdHlwZXMgYXMgcGVyIHczYyBncm91cGluZ3MKCSAqIFJldHVybnM6ICAtCgkgKiBJbnB1dHM6ICAgc3RyaW5nOnNUeXBlCgkgKi8KCV9mbkV2ZW50VHlwZUdyb3VwOiBmdW5jdGlvbiAoIHNUeXBlICkKCXsKCQlzd2l0Y2ggKCBzVHlwZSApCgkJewoJCQljYXNlICdjbGljayc6CgkJCWNhc2UgJ2RibGNsaWNrJzoKCQkJY2FzZSAnbW91c2Vkb3duJzoKCQkJY2FzZSAnbW91c2Vtb3ZlJzoKCQkJY2FzZSAnbW91c2VvdXQnOgoJCQljYXNlICdtb3VzZW92ZXInOgoJCQljYXNlICdtb3VzZXVwJzoKCQkJCXJldHVybiAnbW91c2UnOwoJCQkKCQkJY2FzZSAnY2hhbmdlJzoKCQkJY2FzZSAnZm9jdXMnOgoJCQljYXNlICdibHVyJzoKCQkJY2FzZSAnc2VsZWN0JzoKCQkJY2FzZSAnc3VibWl0JzoKCQkJCXJldHVybiAnaHRtbCc7CgkJCQkKCQkJY2FzZSAna2V5ZG93bic6CgkJCWNhc2UgJ2tleXByZXNzJzoKCQkJY2FzZSAna2V5dXAnOgoJCQljYXNlICdsb2FkJzoKCQkJY2FzZSAndW5sb2FkJzoKCQkJCXJldHVybiAndWknOwoJCQkKCQkJZGVmYXVsdDoKCQkJCXJldHVybiAnY3VzdG9tJzsKCQl9Cgl9Cn0KCgp2YXIgb1Nlc3Npb24gPSB7CgluVGFibGU6IG51bGwsCgkKCWZuQ2FjaGU6IGZ1bmN0aW9uICgpCgl7CgkJdGhpcy5uVGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVtbycpLmNsb25lTm9kZSh0cnVlKTsKCX0sCgkKCWZuUmVzdG9yZTogZnVuY3Rpb24gKCkKCXsKCQl3aGlsZSggJC5mbi5kYXRhVGFibGVTZXR0aW5ncy5sZW5ndGggPiAwICkKCQl7CgkJCXRyeSB7CgkJCQkkLmZuLmRhdGFUYWJsZVNldHRpbmdzWzBdLm9JbnN0YW5jZS5mbkRlc3Ryb3koKTsKCQkJfSBjYXRjaCAoZSkgewoJCQkJJC5mbi5kYXRhVGFibGVTZXR0aW5ncy5zcGxpY2UoIDAsIDEgKTsKCQkJfQoJCX0KCQkvLyQuZm4uZGF0YVRhYmxlU2V0dGluZ3Muc3BsaWNlKCAwLCAkLmZuLmRhdGFUYWJsZVNldHRpbmdzLmxlbmd0aCApOwoJCXZhciBuRGVtbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZW1vJyk7CgkJbkRlbW8uaW5uZXJIVE1MID0gIiI7CgkJZm9yICggdmFyIGk9MCwgaUxlbj10aGlzLm5UYWJsZS5jaGlsZE5vZGVzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJewoJCQluRGVtby5hcHBlbmRDaGlsZCggdGhpcy5uVGFibGUuY2hpbGROb2Rlc1swXSApOwoJCX0KCQl0aGlzLmZuQ2FjaGUoKTsKCX0KfQoKJChkb2N1bWVudCkucmVhZHkoIGZ1bmN0aW9uICgpIHsKCW9TZXNzaW9uLmZuQ2FjaGUoKTsKfSApOwo=",
                "body": "LyoKICogRmlsZTogICAgICAgIHVuaXRfdGVzdC5qcwogKiBWZXJzaW9uOiAgICAgMC4wLjEKICogQ1ZTOiAgICAgICAgICRJZCQKICogRGVzY3JpcHRpb246IFVuaXQgdGVzdCBmcmFtZXdvcmsKICogQXV0aG9yOiAgICAgIEFsbGFuIEphcmRpbmUgKHd3dy5zcHJ5bWVkaWEuY28udWspCiAqIENyZWF0ZWQ6ICAgICBTdW4gTWFyICA4IDIyOjAyOjQ5IEdNVCAyMDA5CiAqIE1vZGlmaWVkOiAgICAkRGF0ZSQgYnkgJEF1dGhvciQKICogTGFuZ3VhZ2U6ICAgIEphdmFzY3JpcHQKICogTGljZW5zZTogICAgIEdQTCB2MiBvciBCU0QgMyBwb2ludCBzdHlsZQogKiBQcm9qZWN0OiAgICAgRGF0YVRhYmxlcwogKiBDb250YWN0OiAgICAgYWxsYW4uamFyZGluZUBzcHJ5bWVkaWEuY28udWsKICogCiAqIENvcHlyaWdodCAyMDA5IEFsbGFuIEphcmRpbmUsIGFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIERlc2NyaXB0aW9uOgogKiBUaGlzIGlzIGEgamF2YXNjcmlwdCBsaWJyYXJ5IHN1aXRhYmxlIGZvciB1c2UgYXMgYSB1bml0IHRlc3RpbmcgZnJhbWV3b3JrLiBFbXBsb3lpbmcgYSBxdWV1aW5nCiAqIG1lY2hhbmlzaW0gdG8gdGFrZSBhY2NvdW50IG9mIGFzeW5jIGV2ZW50cyBpbiBqYXZhc2NyaXB0LCB0aGlzIGxpYnJhcnkgd2lsbCBjb21tdW5pY2F0ZXMgd2l0aAogKiBhIGNvbnRyb2xsZXIgZnJhbWUgKHRvIHJlcG9ydCBpbmRpdmlkdWFsIHRlc3Qgc3RhdHVzKS4KICogCiAqLwoKCnZhciBvVGVzdCA9IHsKCS8qIEJsb2NrIGZ1cnRoZXIgdGVzdHMgZnJvbSBvY2N1cmluZyAtIG1pZ2h0IGJlIGVuZCBvZiB0ZXN0cyBvciBkdWUgdG8gYXN5bmMgd2FpdCAqLwoJYkJsb2NrOiBmYWxzZSwKCQoJLyogTnVtYmVyIG9mIHRpbWVzIHRvIHRyeSByZXRlc3RpbmcgZm9yIGEgYmxvY2tpbmcgdGVzdCAqLwoJaVJlVGVzdExpbWl0OiAyMCwKCQoJLyogQW1vdW50IG9mIHRpbWUgdG8gd2FpdCBiZXR3ZWVuIHRyeWluZyBmb3IgYW4gYXN5bmMgdGVzdCAqLwoJaVJlVGVzdERlbGF5OiAxNTAsCgkKCS8qIEVuZCB0ZXN0cyAtIGV4dGVybmFsIGNvbnRyb2wgKi8KCWJFbmQ6IGZhbHNlLAoJCgkvKiBJbnRlcm5hbCB2YXJpYWJsZXMgKi8KCV9hb1F1ZXVlOiBbXSwKCV9pUmVUZXN0OiAwLAoJX2JGaW5pc2hlZDogZmFsc2UsCgkKCQoJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBSZWNvbW1lbmVkIHB1YmxpYyBmdW5jdGlvbnMKCSAqLwoJCgkvKgoJICogRnVuY3Rpb246IGZuVGVzdAoJICogUHVycG9zZTogIEFkZCBhIHRlc3QgdG8gdGhlIHF1ZXVlCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIHN0cmluZzpzTWVzc2FnZSAtIG5hbWUgb2YgdGhlIHRlc3QKCSAqICAgICAgICAgICBmdW5jdGlvbjpmblRlc3QgLSBmdW5jdGlvbiB3aGljaCB3aWxsIGJlIGV2YWx1ZGF0ZWQgdG8gZ2V0IHRoZSB0ZXN0IHJlc3VsdAoJICovCgkiZm5UZXN0IjogZnVuY3Rpb24gKCBzTWVzc2FnZSwgZm5TZXR1cCwgZm5UZXN0ICkKCXsKCQl0aGlzLl9hb1F1ZXVlLnB1c2goIHsKCQkJInNNZXNzYWdlIjogc01lc3NhZ2UsCgkJCSJmblNldHVwIjogZm5TZXR1cCwKCQkJImZuVGVzdCI6IGZuVGVzdCwKCQkJImJQb2xsIjogZmFsc2UKCQl9ICk7CgkJdGhpcy5fZm5OZXh0KCk7Cgl9LAoJCgkvKgoJICogRnVuY3Rpb246IGZuV2FpdFRlc3QKCSAqIFB1cnBvc2U6ICBBZGQgYSB0ZXN0IHRvIHRoZSBxdWV1ZSB3aGljaCBoYXMgYSByZS10ZXN0IGN5Y2xlCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIHN0cmluZzpzTWVzc2FnZSAtIG5hbWUgb2YgdGhlIHRlc3QKCSAqICAgICAgICAgICBmdW5jdGlvbjpmblRlc3QgLSBmdW5jdGlvbiB3aGljaCB3aWxsIGJlIGV2YWx1ZGF0ZWQgdG8gZ2V0IHRoZSB0ZXN0IHJlc3VsdAoJICovCgkiZm5XYWl0VGVzdCI6IGZ1bmN0aW9uICggc01lc3NhZ2UsIGZuU2V0dXAsIGZuVGVzdCApCgl7CgkJdGhpcy5fYW9RdWV1ZS5wdXNoKCB7CgkJCSJzTWVzc2FnZSI6IHNNZXNzYWdlLAoJCQkiZm5TZXR1cCI6IGZuU2V0dXAsCgkJCSJmblRlc3QiOiBmblRlc3QsCgkJCSJiUG9sbCI6IHRydWUKCQl9ICk7CgkJdGhpcy5fZm5OZXh0KCk7Cgl9LAoJCgkvKgoJICogRnVuY3Rpb246IGZuU3RhcnQKCSAqIFB1cnBvc2U6ICBJbmRpY2F0ZSB0aGF0IHRoaXMgaXMgYSBuZXcgdW5pdCBhbmQgd2hhdCBpdCBpcyB0ZXN0aW5nIChtZXNzYWdlIHRvIGVuZCB1c2VyKQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICBzdHJpbmc6c01lc3NhZ2UgLSBtZXNzYWdlIHRvIGdpdmUgdG8gdGhlIHVzZXIgYWJvdXQgdGhpcyB1bml0CgkgKi8KCSJmblN0YXJ0IjogZnVuY3Rpb24gKCBzTWVzc2FnZSApCgl7CgkJd2luZG93LnBhcmVudC5jb250cm9sbGVyLmZuU3RhcnRNZXNzYWdlKCBzTWVzc2FnZSApOwoJfSwKCQoJLyoKCSAqIEZ1bmN0aW9uOiBmbkNvbXBsZXRlCgkgKiBQdXJwb3NlOiAgVGVsbCB0aGUgY29udHJvbGxlciB0aGF0IHdlIGFyZSBhbGwgZG9uZSBoZXJlCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIC0KCSAqLwoJImZuQ29tcGxldGUiOiBmdW5jdGlvbiAoKQoJewoJCXRoaXMuX2JGaW5pc2hlZCA9IHRydWU7CgkJdGhpcy5fZm5OZXh0KCk7Cgl9LAoJCgkvKgoJICogRnVuY3Rpb246IGZuQ29va2llRGVzdHJveQoJICogUHVycG9zZTogIERlc3Ryb3kgYSBjb29raWUgb2YgYSBnaXZlbiBuYW1lCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIC0KCSAqLwoJImZuQ29va2llRGVzdHJveSI6IGZ1bmN0aW9uICggb1RhYmxlICkKCXsKCQl2YXIgc05hbWUgPSBvVGFibGUuZm5TZXR0aW5ncygpLnNDb29raWVQcmVmaXgrb1RhYmxlLmZuU2V0dGluZ3MoKS5zSW5zdGFuY2U7CgkJdmFyIGFQYXJ0cyA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpOwoJCXZhciBzTmFtZUZpbGUgPSBzTmFtZSArICdfJyArIGFQYXJ0cy5wb3AoKS5yZXBsYWNlKC9bXC86XS9nLCIiKS50b0xvd2VyQ2FzZSgpOwoJCWRvY3VtZW50LmNvb2tpZSA9IHNOYW1lRmlsZSsiPTsgZXhwaXJlcz1UaHUsIDAxLUphbi0xOTcwIDAwOjAwOjAxIEdNVDsgcGF0aD0iKwoJCQlhUGFydHMuam9pbignLycpICsgIi8iOwoJfSwKCQoJCgkKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgoJICogSW50ZXJuYWwgZnVuY3Rpb25zCgkgKi8KCQoJCgkiX2ZuUmVUZXN0IjogZnVuY3Rpb24gKCBvVGVzdEluZm8gKQoJewoJCXZhciBiUmVzdWx0ID0gb1Rlc3RJbmZvLmZuVGVzdCggKTsKCQlpZiAoIGJSZXN1bHQgKQoJCXsKCQkJLyogVGVzdCBwYXNzZWQgb24gcmV0cnkgKi8KCQkJdGhpcy5fZm5SZXN1bHQoIHRydWUgKTsKCQkJdGhpcy5fZm5OZXh0KCk7CgkJfQoJCWVsc2UKCQl7CgkJCWlmICggdGhpcy5faVJlVGVzdCA8IHRoaXMuaVJlVGVzdExpbWl0ICkKCQkJewoJCQkJdGhpcy5faVJlVGVzdCsrOwoJCQkJc2V0VGltZW91dCggZnVuY3Rpb24oKSB7CgkJCQkJb1Rlc3QuX2ZuUmVUZXN0KCBvVGVzdEluZm8gKTsKCQkJCX0sIHRoaXMuaVJlVGVzdERlbGF5ICk7CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQl0aGlzLl9mblJlc3VsdCggZmFsc2UgKTsKCQkJfQoJCX0KCX0sCgkKCSJfZm5OZXh0IjogZnVuY3Rpb24gKCkKCXsKCQlpZiAoIHRoaXMuYkVuZCApCgkJewoJCQlyZXR1cm47CgkJfQoJCQoJCWlmICggIXRoaXMuYkJsb2NrICYmIHRoaXMuX2FvUXVldWUubGVuZ3RoID4gMCApCgkJewoJCQl2YXIgb05leHRUZXN0ID0gdGhpcy5fYW9RdWV1ZS5zaGlmdCgpOwoJCQl3aW5kb3cucGFyZW50LmNvbnRyb2xsZXIuZm5UZXN0U3RhcnQoIG9OZXh0VGVzdC5zTWVzc2FnZSApOwoJCQl0aGlzLmJCbG9jayA9IHRydWU7CgkJCQoJCQlpZiAoIHR5cGVvZiBvTmV4dFRlc3QuZm5TZXR1cCA9PSAnZnVuY3Rpb24nICkKCQkJewoJCQkJb05leHRUZXN0LmZuU2V0dXAoICk7CgkJCX0KCQkJdmFyIGJSZXN1bHQgPSBvTmV4dFRlc3QuZm5UZXN0KCApOwoJCQkvL2JSZXN1bHQgPSBmYWxzZTsKCQkJCgkJCWlmICggb05leHRUZXN0LmJQb2xsICkKCQkJewoJCQkJaWYgKCBiUmVzdWx0ICkKCQkJCXsKCQkJCQl0aGlzLl9mblJlc3VsdCggdHJ1ZSApOwoJCQkJCXRoaXMuX2ZuTmV4dCgpOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCV9pUmVUZXN0ID0gMDsKCQkJCQlzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsKCQkJCQkJb1Rlc3QuX2ZuUmVUZXN0KCBvTmV4dFRlc3QgKTsKCQkJCQl9LCB0aGlzLmlSZVRlc3REZWxheSApOwoJCQkJfQoJCQl9CgkJCWVsc2UKCQkJewoJCQkJdGhpcy5fZm5SZXN1bHQoIGJSZXN1bHQgKTsKCQkJCXRoaXMuX2ZuTmV4dCgpOwoJCQl9CgkJfQoJCWVsc2UgaWYgKCAhdGhpcy5iQmxvY2sgJiYgdGhpcy5fYW9RdWV1ZS5sZW5ndGggPT0gMCAmJiB0aGlzLl9iRmluaXNoZWQgKQoJCXsKCQkJd2luZG93LnBhcmVudC5jb250cm9sbGVyLmZuVW5pdENvbXBsZXRlKCApOwoJCX0KCX0sCgkKCSJfZm5SZXN1bHQiOiBmdW5jdGlvbiAoIGIgKQoJewoJCXdpbmRvdy5wYXJlbnQuY29udHJvbGxlci5mblRlc3RSZXN1bHQoIGIgKTsKCQl0aGlzLmJCbG9jayA9IGZhbHNlOwoJCWlmICggIWIgKQoJCXsKCQkJdGhpcy5iRW5kID0gdHJ1ZTsKCQl9Cgl9Cn07CgoKdmFyIG9EaXNwYWNoZXIgPSB7CgkiY2xpY2siOiBmdW5jdGlvbiAoIG5Ob2RlLCBvU3BlY2lhbCApCgl7CgkJdmFyIGV2dCA9IHRoaXMuZm5DcmVhdGVFdmVudCggJ2NsaWNrJywgbk5vZGUsIG9TcGVjaWFsICk7CgkJaWYgKCBuTm9kZS5kaXNwYXRjaEV2ZW50ICkKCQkJbk5vZGUuZGlzcGF0Y2hFdmVudChldnQpOwoJCWVsc2UKCQkJbk5vZGUuZmlyZUV2ZW50KCdvbmNsaWNrJywgZXZ0KTsKCX0sCgkKCSJjaGFuZ2UiOiBmdW5jdGlvbiAoIG5Ob2RlICkKCXsKCQl2YXIgZXZ0ID0gdGhpcy5mbkNyZWF0ZUV2ZW50KCAnY2hhbmdlJywgbk5vZGUgKTsKCQlpZiAoIG5Ob2RlLmRpc3BhdGNoRXZlbnQgKQoJCW5Ob2RlLmRpc3BhdGNoRXZlbnQoZXZ0KTsKCQllbHNlCgkJCW5Ob2RlLmZpcmVFdmVudCgnb25jaGFuZ2UnLCBldnQpOwoJfSwKCQoJCgkvKgoJICogRnVuY3Rpb246IGZuQ3JlYXRlRXZlbnQKCSAqIFB1cnBvc2U6ICBDcmVhdGUgYW4gZXZlbnQgb2plY3QgYmFzZWQgb24gdGhlIHR5cGUgdG8gdHJpZ2dlciBhbiBldmVudCAtIHgtcGxhdGZvcm0KCSAqIFJldHVybnM6ICBldmVudDpldnQKCSAqIElucHV0czogICBzdHJpbmc6c1R5cGUgLSB0eXBlIG9mIGV2ZW50CgkgKiAgICAgICAgICAgbm9kZTpuVGFyZ2V0IC0gdGFyZ2V0IG5vZGUgb2YgdGhlIGV2ZW50CgkgKi8KCWZuQ3JlYXRlRXZlbnQ6IGZ1bmN0aW9uKCBzVHlwZSwgblRhcmdldCwgb1NwZWNpYWwgKQoJewoJCXZhciBldnQgPSBudWxsOwoJCXZhciBvVGFyZ2V0UG9zID0gdGhpcy5fZm5HZXRQb3MoIG5UYXJnZXQgKTsKCQl2YXIgc1R5cGVHcm91cCA9IHRoaXMuX2ZuRXZlbnRUeXBlR3JvdXAoIHNUeXBlICk7CgkJaWYgKCB0eXBlb2Ygb1NwZWNpYWwgPT0gJ3VuZGVmaW5lZCcgKQoJCXsKCQkJb1NwZWNpYWwgPSB7fTsKCQl9CgkJCgkJdmFyIGN0cmxLZXkgPSBmYWxzZTsKCQl2YXIgYWx0S2V5ID0gZmFsc2U7CgkJdmFyIHNoaWZ0S2V5ID0gKHR5cGVvZiBvU3BlY2lhbC5zaGlmdCAhPSAndW5kZWZpbmVkJykgPyBvU3BlY2lhbC5zaGlmdCA6IGZhbHNlOwoJCXZhciBtZXRhS2V5ID0gZmFsc2U7CgkJdmFyIGJ1dHRvbiA9IGZhbHNlOwoJCQoJCWlmICggZG9jdW1lbnQuY3JlYXRlRXZlbnQgKQoJCXsKCQkJc3dpdGNoICggc1R5cGVHcm91cCApCgkJCXsKCQkJCWNhc2UgJ21vdXNlJzoKCQkJCQlldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCggIk1vdXNlRXZlbnRzIiApOwoJCQkJCWV2dC5pbml0TW91c2VFdmVudCggc1R5cGUsIHRydWUsIHRydWUsIHdpbmRvdywgMCwgb1RhcmdldFBvc1swXSwgb1RhcmdldFBvc1sxXSwgCgkJCQkJCW9UYXJnZXRQb3NbMF0sIG9UYXJnZXRQb3NbMV0sIGN0cmxLZXksIGFsdEtleSwgc2hpZnRLZXksIAoJCQkJCQltZXRhS2V5LCBidXR0b24sIG51bGwgKTsKCQkJCQlicmVhazsKCQkJCQoJCQkJY2FzZSAnaHRtbCc6CgkJCQkJZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoICJIVE1MRXZlbnRzIiApOwoJCQkJCWV2dC5pbml0RXZlbnQoIHNUeXBlLCB0cnVlLCB0cnVlICk7CgkJCQkJYnJlYWs7CgkJCQkJCgkJCQljYXNlICd1aSc6CgkJCQkJZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoICJVSUV2ZW50cyIgKTsKCQkJCQlldnQuaW5pdFVJRXZlbnQoIHNUeXBlLCB0cnVlLCB0cnVlLCB3aW5kb3csIDAgKTsKCQkJCQlicmVhazsKCQkJCQoJCQkJZGVmYXVsdDoKCQkJCQlicmVhazsKCQkJfQoJCX0KCQllbHNlIGlmICggZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QgKQoJCXsKCQkJc3dpdGNoICggc1R5cGVHcm91cCApCgkJCXsKCQkJCWNhc2UgJ21vdXNlJzoKCQkJCQlldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpOwoJCQkJCWV2dC5zY3JlZW5YID0gb1RhcmdldFBvc1swXTsKCQkJCQlldnQuc2NyZWVuWCA9IG9UYXJnZXRQb3NbMV07CgkJCQkJZXZ0LmNsaWVudFggPSBvVGFyZ2V0UG9zWzBdOwoJCQkJCWV2dC5jbGllbnRZID0gb1RhcmdldFBvc1sxXTsKCQkJCQlldnQuY3RybEtleSA9IGN0cmxLZXk7CgkJCQkJZXZ0LmFsdEtleSA9IGFsdEtleTsKCQkJCQlldnQuc2hpZnRLZXkgPSBzaGlmdEtleTsKCQkJCQlldnQubWV0YUtleSA9IG1ldGFLZXk7CgkJCQkJZXZ0LmJ1dHRvbiA9IGJ1dHRvbjsKCQkJCQlldnQucmVsYXRlZFRhcmdldCA9IG51bGw7CgkJCQkJYnJlYWs7CgkJCQkKCQkJCWNhc2UgJ2h0bWwnOgoJCQkJCS8qIGZhbGwgdGhyb3VnaCB0byBiYXNpYyBldmVudCBvYmplY3QgKi8KCQkJCQkKCQkJCWNhc2UgJ3VpJzoKCQkJCQlldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpOwoJCQkJCWJyZWFrOwoJCQkJCgkJCQlkZWZhdWx0OgoJCQkJCWJyZWFrOwoJCQl9CgkJfQoJCQoJCXJldHVybiBldnQ7Cgl9LAoJCgkvKiAKCSAqIEZ1bmN0aW9uOiBEZXNpZ25Db3JlLmZuR2V0UG9zCgkgKiBQdXJwb3NlOiAgR2V0IHRoZSBwb3NpdGlvbiBvZiBhbiBlbGVtZW50IG9uIHRoZSBwYWdlCgkgKiBSZXR1cm5zOiAgYXJyYXlbIDAtaW50OmxlZnQsIDEtaW50OnRvcCBdCgkgKiBJbnB1dHM6ICAgbm9kZTpvYmogLSBub2RlIHRvIGFuYWx5c2UKCSAqLwoJX2ZuR2V0UG9zOiBmdW5jdGlvbiAoIG9iaiApIAoJewoJCXZhciBjdXJsZWZ0ID0gMDsKCQl2YXIgY3VydG9wID0gMDsKCQkKCQlpZiAob2JqLm9mZnNldFBhcmVudCkgCgkJewoJCQljdXJsZWZ0ID0gb2JqLm9mZnNldExlZnQ7CgkJCWN1cnRvcCA9IG9iai5vZmZzZXRUb3A7CgkJCXdoaWxlIChvYmogPSBvYmoub2Zmc2V0UGFyZW50ICkgCgkJCXsKCQkJCWN1cmxlZnQgKz0gb2JqLm9mZnNldExlZnQ7CgkJCQljdXJ0b3AgKz0gb2JqLm9mZnNldFRvcDsKCQkJfQoJCX0KCQlyZXR1cm4gW2N1cmxlZnQsY3VydG9wXTsKCX0sCgkKCQoJLyoKCSAqIEZ1bmN0aW9uOiBfZm5FdmVudFR5cGVHcm91cAoJICogUHVycG9zZTogIEdyb3VwIHRoZSBldmVudCB0eXBlcyBhcyBwZXIgdzNjIGdyb3VwaW5ncwoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICBzdHJpbmc6c1R5cGUKCSAqLwoJX2ZuRXZlbnRUeXBlR3JvdXA6IGZ1bmN0aW9uICggc1R5cGUgKQoJewoJCXN3aXRjaCAoIHNUeXBlICkKCQl7CgkJCWNhc2UgJ2NsaWNrJzoKCQkJY2FzZSAnZGJsY2xpY2snOgoJCQljYXNlICdtb3VzZWRvd24nOgoJCQljYXNlICdtb3VzZW1vdmUnOgoJCQljYXNlICdtb3VzZW91dCc6CgkJCWNhc2UgJ21vdXNlb3Zlcic6CgkJCWNhc2UgJ21vdXNldXAnOgoJCQkJcmV0dXJuICdtb3VzZSc7CgkJCQoJCQljYXNlICdjaGFuZ2UnOgoJCQljYXNlICdmb2N1cyc6CgkJCWNhc2UgJ2JsdXInOgoJCQljYXNlICdzZWxlY3QnOgoJCQljYXNlICdzdWJtaXQnOgoJCQkJcmV0dXJuICdodG1sJzsKCQkJCQoJCQljYXNlICdrZXlkb3duJzoKCQkJY2FzZSAna2V5cHJlc3MnOgoJCQljYXNlICdrZXl1cCc6CgkJCWNhc2UgJ2xvYWQnOgoJCQljYXNlICd1bmxvYWQnOgoJCQkJcmV0dXJuICd1aSc7CgkJCQoJCQlkZWZhdWx0OgoJCQkJcmV0dXJuICdjdXN0b20nOwoJCX0KCX0KfQoKCnZhciBvU2Vzc2lvbiA9IHsKCW5UYWJsZTogbnVsbCwKCQoJZm5DYWNoZTogZnVuY3Rpb24gKCkKCXsKCQl0aGlzLm5UYWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZW1vJykuY2xvbmVOb2RlKHRydWUpOwoJfSwKCQoJZm5SZXN0b3JlOiBmdW5jdGlvbiAoKQoJewoJCXdoaWxlKCAkLmZuLmRhdGFUYWJsZVNldHRpbmdzLmxlbmd0aCA+IDAgKQoJCXsKCQkJdHJ5IHsKCQkJCSQuZm4uZGF0YVRhYmxlU2V0dGluZ3NbMF0ub0luc3RhbmNlLmZuRGVzdHJveSgpOwoJCQl9IGNhdGNoIChlKSB7CgkJCQkkLmZuLmRhdGFUYWJsZVNldHRpbmdzLnNwbGljZSggMCwgMSApOwoJCQl9CgkJfQoJCS8vJC5mbi5kYXRhVGFibGVTZXR0aW5ncy5zcGxpY2UoIDAsICQuZm4uZGF0YVRhYmxlU2V0dGluZ3MubGVuZ3RoICk7CgkJdmFyIG5EZW1vID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlbW8nKTsKCQluRGVtby5pbm5lckhUTUwgPSAiIjsKCQlmb3IgKCB2YXIgaT0wLCBpTGVuPXRoaXMublRhYmxlLmNoaWxkTm9kZXMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQl7CgkJCW5EZW1vLmFwcGVuZENoaWxkKCB0aGlzLm5UYWJsZS5jaGlsZE5vZGVzWzBdICk7CgkJfQoJCXRoaXMuZm5DYWNoZSgpOwoJfQp9CgokKGRvY3VtZW50KS5yZWFkeSggZnVuY3Rpb24gKCkgewoJb1Nlc3Npb24uZm5DYWNoZSgpOwp9ICk7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 16:09:46 GMT",
                    "Content-Length": "8887",
                    "Date": "Fri, 07 Nov 2014 16:09:49 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}