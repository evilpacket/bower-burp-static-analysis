{
    "url": "http://localhost:9999/charbelrami/material-jekyll/bower_components/web-animations-js/test/test-generator.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>window.location.search</b> and written to <b>the 'value' property of a DOM element</b> via the following statement:<ul><li>document.getElementById(\"iframeSrc\").value = window.location.search.substring(1) || \"testcases/auto-test-calc.html\";</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/charbelrami/material-jekyll/bower_components/web-animations-js/test/test-generator.html",
                "path": "/charbelrami/material-jekyll/bower_components/web-animations-js/test/test-generator.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9jaGFyYmVscmFtaS9tYXRlcmlhbC1qZWt5bGwvYm93ZXJfY29tcG9uZW50cy93ZWItYW5pbWF0aW9ucy1qcy90ZXN0L3Rlc3QtZ2VuZXJhdG9yLmh0bWwgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNzA3Nw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBGcmksIDA3IE5vdiAyMDE0IDA5OjI2OjQyIEdNVA0KTGFzdC1Nb2RpZmllZDogRnJpLCAwNyBOb3YgMjAxNCAwOToyNjo0MCBHTVQNCg0KPCEtLQpDb3B5cmlnaHQgMjAxMiBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgoKTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgogICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgpVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgpTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgotLT4KPHN0eWxlPgppZnJhbWUgewogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogNjAwcHg7Cn0KLnRleHRCb3ggewogIHdpZHRoOjgwMHB4OwogIGhlaWdodDoyMDBweDsKfQppbnB1dCNpZnJhbWVTcmMgewogIHdpZHRoOiAyMDBweDsKfQo8L3N0eWxlPgoKPGlucHV0IHR5cGU9InRleHQiIGlkPSJpZnJhbWVTcmMiPgo8YnV0dG9uIGlkPSJsb2FkLWJ1dHRvbiIgb25jbGljaz0ibG9hZEZpbGUoKSI+TG9hZDwvYnV0dG9uPjxicj4KPGlmcmFtZSBpZD0iZnJhbWUiIHNyYz0iIj48L2lmcmFtZT4KPGRpdiBpZD0idXNlck9wdGlvbnMiPgogIDxpbnB1dCB0eXBlPSJudW1iZXIiIGlkPSJpbnRlcnZhbCIgdmFsdWU9MT4gSW50ZXJ2YWwgPGJyPgogIE9iamVjdHMgYW5kIHByb3BlcnRpZXMKICA8YnV0dG9uIGlkPSJnZW5lcmF0ZS1idXR0b24iIG9uY2xpY2s9InN0YXJ0R2VuZXJhdGluZ0V4cGVjdGF0aW9ucygpIj5HZW5lcmF0ZTwvYnV0dG9uPjxicj4KICA8dGV4dGFyZWEgaWQgPSAib2JQcm9wIiBjbGFzcyA9IHRleHRCb3g+PC90ZXh0YXJlYT4gPGJyPgo8L2Rpdj4KPGRpdj4gT3V0cHV0dGVkIENoZWNrcyA8L2Rpdj4KPHByZSBpZCA9ICJjaGVja3MiPjwvcHJlPgoKPHNjcmlwdCBzcmM9Ii4uL3dlYi1hbmltYXRpb25zLmpzIj48L3NjcmlwdD4KPHNjcmlwdD4KInVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gZGV0ZWN0RmVhdHVyZXMoKSB7CiAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICBzdHlsZS50ZXh0Q29udGVudCA9ICcnICsKICAgICAnZHVtbXlSdWxlRm9yVGVzdGluZyB7JyArCiAgICAgJ3dpZHRoOiBjYWxjKDBweCk7JyArCiAgICAgJ3dpZHRoOiAtd2Via2l0LWNhbGMoMHB4KTsgfSc7CiAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7CiAgdmFyIHRyYW5zZm9ybUNhbmRpZGF0ZXMgPSBbCiAgICAgICd0cmFuc2Zvcm0nLAogICAgICAnd2Via2l0VHJhbnNmb3JtJywKICAgICAgJ21zVHJhbnNmb3JtJwogIF07CiAgdmFyIHRyYW5zZm9ybVByb3BlcnR5ID0gdHJhbnNmb3JtQ2FuZGlkYXRlcy5maWx0ZXIoZnVuY3Rpb24ocHJvcGVydHkpIHsKICAgIHJldHVybiBwcm9wZXJ0eSBpbiBzdHlsZS5zaGVldC5jc3NSdWxlc1swXS5zdHlsZTsKICB9KVswXTsKICB2YXIgY2FsY0Z1bmN0aW9uID0gc3R5bGUuc2hlZXQuY3NzUnVsZXNbMF0uc3R5bGUud2lkdGguc3BsaXQoJygnKVswXTsKICBkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKHN0eWxlKTsKICByZXR1cm4gewogICAgdHJhbnNmb3JtUHJvcGVydHk6IHRyYW5zZm9ybVByb3BlcnR5LAogICAgY2FsY0Z1bmN0aW9uOiBjYWxjRnVuY3Rpb24KICB9Owp9Cgp2YXIgZmVhdHVyZXMgPSBkZXRlY3RGZWF0dXJlcygpOwoKdmFyIHRlc3RDdXJyZW50VGltZTsKdmFyIHRlc3RMZW5ndGggPSAwOwp2YXIgbGFzdFJ1biA9IGZhbHNlOwp2YXIgZnJhbWVUaW1lID0gMTAwOwp2YXIgY2hlY2tzID0gW107CnZhciBpbnRlcnZhbDsKCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpZnJhbWVTcmMiKS52YWx1ZSA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpIHx8ICJ0ZXN0Y2FzZXMvYXV0by10ZXN0LWNhbGMuaHRtbCI7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnRlcnZhbCIpLnZhbHVlID0gIjEiOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib2JQcm9wIikudmFsdWUgPSAiLmFuaW0sIHdpZHRoIjsKCgpmdW5jdGlvbiBUb0NoZWNrKG9iamVjdCwgaW5pdFNlbGN0b3IsIHByb3BlcnRpZXMpewogIHRoaXMub2JqZWN0ID0gb2JqZWN0OwogIHRoaXMuaW5pdFNlbGN0b3IgPSBpbml0U2VsY3RvcjsKICB0aGlzLnByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzOwp9CgpmdW5jdGlvbiBnZXRFbmRUaW1lKHRpbWVsaW5lKSB7CiAgdmFyIHBsYXllcnMgPSB0aW1lbGluZS5nZXRDdXJyZW50UGxheWVycygpOwoKICB2YXIgZW5kVGltZSA9IDA7CiAgcGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikgewogICAgZW5kVGltZSA9IE1hdGgubWF4KGVuZFRpbWUsIHBsYXllci5zb3VyY2UuZW5kVGltZSk7CiAgfSk7CiAgcmV0dXJuIGVuZFRpbWU7Cn0KCmZ1bmN0aW9uIGxvYWRGaWxlKG1vZGUsIGNhbGxiYWNrKSB7CiAgaWYgKHR5cGVvZiBtb2RlID09ICd1bmRlZmluZWQnKSB7CiAgICBtb2RlID0gJyc7CiAgfQoKICB2YXIgZmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpZnJhbWVTcmMiKS52YWx1ZTsKCiAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmcmFtZSIpOwogIC8vIFdlIHdhbnQgdGhlIGZyYW1lIHRvIGFsd2F5cyByZWxvYWQgZXZlbiBpZiB0aGUgc3JjIGlzIHRoZSBzYW1lLCBoZW5jZSB3ZQogIC8vIGZvcmNlIGl0IHRvIG51bGwgYW5kIHRoZW4gdG8gdGhlIHZhbHVlIHdlIHdhbnQuCiAgaWZyYW1lLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgaWZyYW1lLm9ubG9hZCA9IGNhbGxiYWNrOwogICAgaWZyYW1lLnNyYyA9IGZpbGUgKyAnIycgKyBtb2RlOwogIH07CiAgaWZyYW1lLnNyYyA9ICcnOyAKfQoKZnVuY3Rpb24gc3RhcnRHZW5lcmF0aW5nRXhwZWN0YXRpb25zKCkgewogIHZhciBvYlByb3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib2JQcm9wIikudmFsdWU7CgogIHZhciBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2hlY2tzIik7CiAgb3V0cHV0LmlubmVySFRNTCA9ICIiOwoKICBsb2FkRmlsZSgibWVzc2FnZSIsIGZ1bmN0aW9uICgpIHsKICAgIGZpbmRFbGVtZW50c1RvQ2hlY2sob2JQcm9wKTsKCiAgICBvdXRwdXQuaW5uZXJIVE1MICs9ICJ0aW1pbmdfdGVzdChmdW5jdGlvbigpIHtcbiI7CiAgICB2YXIgdGVzdFdpbmRvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmcmFtZSIpLmNvbnRlbnRXaW5kb3c7CiAgICB2YXIgaW50ZXJ2YWwgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnRlcnZhbCIpLnZhbHVlKTsKCiAgICB2YXIgZW5kVGltZSA9IEluZmluaXR5OwoKICAgIHZhciB0ID0gMDsKICAgIHdoaWxlKHQgPD0gZW5kVGltZSkgewogICAgICBpZiAodHlwZW9mIHRlc3RXaW5kb3cudGVzdGhhcm5lc3NfdGltZWxpbmUgPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIGFsZXJ0KCJZb3VyIHBhZ2UgZG9lc24ndCBjb250YWluIHRlc3RoYXJuZXNzX3RpbWxpbmUsIGNhbiBub3QgZ2VuZXJhdGUgYW55dGhpbmchIik7CiAgICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRlc3RXaW5kb3cudGVzdGhhcm5lc3NfdGltZWxpbmUuc2V0VGltZSh0KTsKCiAgICAgIC8vIFVwZGF0ZSB0aGUgZW5kVGltZSBhcyBpdCBjYW4gY2hhbmdlIGRlcGVuZGVudCBvbiB0aGUgcnVubmluZyBhbmltYXRpb25zCiAgICAgIC8vIGFuZCBtb2RpZmljYXRpb25zIHRvIHRoZW0uCiAgICAgIGVuZFRpbWUgPSBnZXRFbmRUaW1lKHRlc3RXaW5kb3cud2luZG93LmRvY3VtZW50LnRpbWVsaW5lKTsKCiAgICAgIGdlbmVyYXRlKHQpOwogICAgICB0ICs9IGludGVydmFsOwogICAgfQoKICAgIG91dHB1dC5pbm5lckhUTUwgKz0gJ30sICJBdXRvIGdlbmVyYXRlZCB0ZXN0cyIpO1xuJzsKICB9KTsKfQoKZnVuY3Rpb24gZmluZEVsZW1lbnRzVG9DaGVjayhyYXdTdHJpbmcpewogIC8vIFB1dCBhbGwgY2hlY2tzIGludG8gY2hlY2tTdGFjawogIGNoZWNrcyA9IFtdOwogIHJhd1N0cmluZyA9IHJhd1N0cmluZy5zcGxpdCgiXG4iKTsKCiAgZm9yICh2YXIgeCBpbiByYXdTdHJpbmcpewogICAgcmF3U3RyaW5nW3hdID0gcmF3U3RyaW5nW3hdLnJlcGxhY2UoL1xzL2csICIiKTsKICAgIHJhd1N0cmluZ1t4XSA9IHJhd1N0cmluZ1t4XS5zcGxpdCgiLCIpOwogICAgaWYgKHJhd1N0cmluZ1t4XVswXS5sZW5ndGggPT0gMCkKICAgICAgY29udGludWU7CiAgICB2YXIgb2JqZWN0ID0gd2luZG93LmZyYW1lc1swXS5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHJhd1N0cmluZ1t4XVswXSk7CiAgICB2YXIgcHJvcCA9IFtdOwogICAgZm9yICh2YXIgaSA9IDE7IGkgPCByYXdTdHJpbmdbeF0ubGVuZ3RoOyBpKyspewogICAgICBwcm9wLnB1c2gocmF3U3RyaW5nW3hdW2ldKTsKICAgIH0KICAgIGNoZWNrcy5wdXNoKG5ldyBUb0NoZWNrKG9iamVjdCwgcmF3U3RyaW5nW3hdWzBdLCBwcm9wKSk7CiAgfQp9CgpmdW5jdGlvbiBnZW5lcmF0ZSh0aW1lKXsKICBjb25zb2xlLmxvZygiR2VuZXJhdGluZyBjaGVja3MgZm9yIHQ9IiwgdGltZSk7CgogIC8vIFByb2R1Y2UgY2hlY2tzIGF0IHRoaXMgdGltZQogIHZhciBvdXRwdXRUZXh0ID0gIiAgYXQoIiArIHRpbWUgKyAiLCBmdW5jdGlvbigpIHtcbiI7CiAgZm9yICh2YXIgeCBpbiBjaGVja3MpewogICAgdmFyIHByb3BzbGlzdCA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGVja3NbeF0ub2JqZWN0Lmxlbmd0aDsgaSsrKXsKICAgICAgdmFyIHByb3BzUHJpbnQgPSAieyI7CiAgICAgIGZvciAodmFyIGogaW4gY2hlY2tzW3hdLnByb3BlcnRpZXMpewogICAgICAgIHZhciBwID0gY2hlY2tzW3hdLnByb3BlcnRpZXNbal07CiAgICAgICAgdmFyIGlzU1ZHID0gX1dlYkFuaW1hdGlvbnNUZXN0aW5nVXRpbGl0aWVzLl9wcm9wZXJ0eUlzU1ZHQXR0cmliKHAsIGNoZWNrc1t4XS5vYmplY3RbaV0pOwoKICAgICAgICBpZihpc1NWRykgdmFyIHByb3BzID0gY2hlY2tzW3hdLm9iamVjdFtpXS5hdHRyaWJ1dGVzOwogICAgICAgIGVsc2UgdmFyIHByb3BzID0gY2hlY2tzW3hdLm9iamVjdFtpXS5jdXJyZW50U3R5bGUgfHwKICAgICAgICAgICAgZ2V0Q29tcHV0ZWRTdHlsZShjaGVja3NbeF0ub2JqZWN0W2ldLCBudWxsKTsKCiAgICAgICAgaWYgKHAgPT0gJ2N0bScpIHsKICAgICAgICAgIHZhciBjdG0gPSBjaGVja3NbeF0ub2JqZWN0W2ldLmdldENUTSgpOwogICAgICAgICAgdmFyIHZhbHVlID0gJ3snICsgY3RtLmEgKyAnLCAnICsgY3RtLmIgKyAnLCAnICsgY3RtLmMgKyAnLCAnICsgY3RtLmQgKyAnLCAnICsgY3RtLmUgKyAnLCAnICsgY3RtLmYgKyAnfScKICAgICAgICB9IGVsc2UgaWYgKHAgPT0gJ3RyYW5zZm9ybScpIHsKICAgICAgICAgIHZhciB2YWx1ZSA9IHByb3BzW2ZlYXR1cmVzLnRyYW5zZm9ybVByb3BlcnR5XTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHZhbHVlID0gaXNTVkcgPyBwcm9wc1twXS52YWx1ZSA6IHByb3BzW3BdOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZygiTm9kZToiLCBjaGVja3NbeF0ub2JqZWN0W2ldLmNsb25lTm9kZSgpLCAiUHJvcGVydHk6IiwgY2hlY2tzW3hdLnByb3BlcnRpZXNbal0sICJWYWx1ZToiLCB2YWx1ZSk7CgogICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvWy0rXT9bMC05XStcLj9bMC05XSooPzpbZUVdWy0rXT9bMC05XSspPy9nLCBmdW5jdGlvbih2KSB7CiAgICAgICAgICB2ID0gTnVtYmVyKHYpOwogICAgICAgICAgaWYgKE1hdGguYWJzKHYpIDwgMWUtMTApIHsKICAgICAgICAgICAgdiA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gKCIiICsgdi50b1ByZWNpc2lvbig0KSkucmVwbGFjZSgvXC4/MCskLywgJycpOwogICAgICAgIH0pOwoKICAgICAgICBwcm9wc1ByaW50ICs9ICInIisgcCArICInOiciICsgdmFsdWUgKyAiJyI7CiAgICAgICAgaWYgKGogPCBjaGVja3NbeF0ucHJvcGVydGllcy5sZW5ndGggLTEpIHByb3BzUHJpbnQgKz0gIiwiOwogICAgICB9CiAgICAgIHByb3BzUHJpbnQgKz0gIn0iOwogICAgICBwcm9wc2xpc3QucHVzaChwcm9wc1ByaW50KTsKICAgIH0KICAgIG91dHB1dFRleHQgKz0gcHJpbnRDaGVjayhjaGVja3NbeF0uaW5pdFNlbGN0b3IsIGksIHByb3BzbGlzdCwgdGltZSk7CiAgfQogIG91dHB1dFRleHQgKz0gJyAgfSk7JzsKICB2YXIgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNoZWNrcyIpOwogIG91dHB1dC5pbm5lckhUTUwgKz0gb3V0cHV0VGV4dCArICI8YnI+IjsKfQoKZnVuY3Rpb24gcHJpbnRDaGVjayhvYmplY3QsIG51bWJlciwgcHJvcGVydGllcywgdGltZSl7CgogIHZhciBuZXdDaGVjayA9ICcgICAgYXNzZXJ0X3N0eWxlcygiJyArIG9iamVjdCArICciLCc7CgogIC8vIElmIGFsbCB0aGUgcHJvcGVydGllcyBhcmUgdGhlIHNhbWUgZm9yIGV2ZXJ5IG9iamVjdCwganVzdCBwYXNzIHRoZSBsaXN0LgogIHZhciBhbGxzYW1lID0gcHJvcGVydGllcy5ldmVyeShmdW5jdGlvbih4KSB7IHJldHVybiB4ID09PSBwcm9wZXJ0aWVzWzBdIH0pOwogIGlmIChhbGxzYW1lKSB7CiAgICBuZXdDaGVjayArPSBwcm9wZXJ0aWVzWzBdICsgIik7XG4iOwoKICB9IGVsc2UgewogICAgLy8gT3RoZXJ3aXNlIGdpdmUgYSBsaXN0IHdpdGggZWFjaAoKICAgIG5ld0NoZWNrICs9ICIgW1xuIjsKICAgIGZvciAodmFyIGogaW4gcHJvcGVydGllcykgewogICAgICAgbmV3Q2hlY2sgKz0gJyAgICAgICcgKyBwcm9wZXJ0aWVzW2pdICsgIixcbiI7CiAgICB9CiAgICBuZXdDaGVjayArPSAiICAgIF0pO1xuIjsKICB9CgogIHJldHVybiBuZXdDaGVjazsKfQo8L3NjcmlwdD4K",
                "body": "PCEtLQpDb3B5cmlnaHQgMjAxMiBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgoKTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgogICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgpVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgpTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgotLT4KPHN0eWxlPgppZnJhbWUgewogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogNjAwcHg7Cn0KLnRleHRCb3ggewogIHdpZHRoOjgwMHB4OwogIGhlaWdodDoyMDBweDsKfQppbnB1dCNpZnJhbWVTcmMgewogIHdpZHRoOiAyMDBweDsKfQo8L3N0eWxlPgoKPGlucHV0IHR5cGU9InRleHQiIGlkPSJpZnJhbWVTcmMiPgo8YnV0dG9uIGlkPSJsb2FkLWJ1dHRvbiIgb25jbGljaz0ibG9hZEZpbGUoKSI+TG9hZDwvYnV0dG9uPjxicj4KPGlmcmFtZSBpZD0iZnJhbWUiIHNyYz0iIj48L2lmcmFtZT4KPGRpdiBpZD0idXNlck9wdGlvbnMiPgogIDxpbnB1dCB0eXBlPSJudW1iZXIiIGlkPSJpbnRlcnZhbCIgdmFsdWU9MT4gSW50ZXJ2YWwgPGJyPgogIE9iamVjdHMgYW5kIHByb3BlcnRpZXMKICA8YnV0dG9uIGlkPSJnZW5lcmF0ZS1idXR0b24iIG9uY2xpY2s9InN0YXJ0R2VuZXJhdGluZ0V4cGVjdGF0aW9ucygpIj5HZW5lcmF0ZTwvYnV0dG9uPjxicj4KICA8dGV4dGFyZWEgaWQgPSAib2JQcm9wIiBjbGFzcyA9IHRleHRCb3g+PC90ZXh0YXJlYT4gPGJyPgo8L2Rpdj4KPGRpdj4gT3V0cHV0dGVkIENoZWNrcyA8L2Rpdj4KPHByZSBpZCA9ICJjaGVja3MiPjwvcHJlPgoKPHNjcmlwdCBzcmM9Ii4uL3dlYi1hbmltYXRpb25zLmpzIj48L3NjcmlwdD4KPHNjcmlwdD4KInVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gZGV0ZWN0RmVhdHVyZXMoKSB7CiAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICBzdHlsZS50ZXh0Q29udGVudCA9ICcnICsKICAgICAnZHVtbXlSdWxlRm9yVGVzdGluZyB7JyArCiAgICAgJ3dpZHRoOiBjYWxjKDBweCk7JyArCiAgICAgJ3dpZHRoOiAtd2Via2l0LWNhbGMoMHB4KTsgfSc7CiAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7CiAgdmFyIHRyYW5zZm9ybUNhbmRpZGF0ZXMgPSBbCiAgICAgICd0cmFuc2Zvcm0nLAogICAgICAnd2Via2l0VHJhbnNmb3JtJywKICAgICAgJ21zVHJhbnNmb3JtJwogIF07CiAgdmFyIHRyYW5zZm9ybVByb3BlcnR5ID0gdHJhbnNmb3JtQ2FuZGlkYXRlcy5maWx0ZXIoZnVuY3Rpb24ocHJvcGVydHkpIHsKICAgIHJldHVybiBwcm9wZXJ0eSBpbiBzdHlsZS5zaGVldC5jc3NSdWxlc1swXS5zdHlsZTsKICB9KVswXTsKICB2YXIgY2FsY0Z1bmN0aW9uID0gc3R5bGUuc2hlZXQuY3NzUnVsZXNbMF0uc3R5bGUud2lkdGguc3BsaXQoJygnKVswXTsKICBkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKHN0eWxlKTsKICByZXR1cm4gewogICAgdHJhbnNmb3JtUHJvcGVydHk6IHRyYW5zZm9ybVByb3BlcnR5LAogICAgY2FsY0Z1bmN0aW9uOiBjYWxjRnVuY3Rpb24KICB9Owp9Cgp2YXIgZmVhdHVyZXMgPSBkZXRlY3RGZWF0dXJlcygpOwoKdmFyIHRlc3RDdXJyZW50VGltZTsKdmFyIHRlc3RMZW5ndGggPSAwOwp2YXIgbGFzdFJ1biA9IGZhbHNlOwp2YXIgZnJhbWVUaW1lID0gMTAwOwp2YXIgY2hlY2tzID0gW107CnZhciBpbnRlcnZhbDsKCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpZnJhbWVTcmMiKS52YWx1ZSA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpIHx8ICJ0ZXN0Y2FzZXMvYXV0by10ZXN0LWNhbGMuaHRtbCI7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnRlcnZhbCIpLnZhbHVlID0gIjEiOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib2JQcm9wIikudmFsdWUgPSAiLmFuaW0sIHdpZHRoIjsKCgpmdW5jdGlvbiBUb0NoZWNrKG9iamVjdCwgaW5pdFNlbGN0b3IsIHByb3BlcnRpZXMpewogIHRoaXMub2JqZWN0ID0gb2JqZWN0OwogIHRoaXMuaW5pdFNlbGN0b3IgPSBpbml0U2VsY3RvcjsKICB0aGlzLnByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzOwp9CgpmdW5jdGlvbiBnZXRFbmRUaW1lKHRpbWVsaW5lKSB7CiAgdmFyIHBsYXllcnMgPSB0aW1lbGluZS5nZXRDdXJyZW50UGxheWVycygpOwoKICB2YXIgZW5kVGltZSA9IDA7CiAgcGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikgewogICAgZW5kVGltZSA9IE1hdGgubWF4KGVuZFRpbWUsIHBsYXllci5zb3VyY2UuZW5kVGltZSk7CiAgfSk7CiAgcmV0dXJuIGVuZFRpbWU7Cn0KCmZ1bmN0aW9uIGxvYWRGaWxlKG1vZGUsIGNhbGxiYWNrKSB7CiAgaWYgKHR5cGVvZiBtb2RlID09ICd1bmRlZmluZWQnKSB7CiAgICBtb2RlID0gJyc7CiAgfQoKICB2YXIgZmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpZnJhbWVTcmMiKS52YWx1ZTsKCiAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmcmFtZSIpOwogIC8vIFdlIHdhbnQgdGhlIGZyYW1lIHRvIGFsd2F5cyByZWxvYWQgZXZlbiBpZiB0aGUgc3JjIGlzIHRoZSBzYW1lLCBoZW5jZSB3ZQogIC8vIGZvcmNlIGl0IHRvIG51bGwgYW5kIHRoZW4gdG8gdGhlIHZhbHVlIHdlIHdhbnQuCiAgaWZyYW1lLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgaWZyYW1lLm9ubG9hZCA9IGNhbGxiYWNrOwogICAgaWZyYW1lLnNyYyA9IGZpbGUgKyAnIycgKyBtb2RlOwogIH07CiAgaWZyYW1lLnNyYyA9ICcnOyAKfQoKZnVuY3Rpb24gc3RhcnRHZW5lcmF0aW5nRXhwZWN0YXRpb25zKCkgewogIHZhciBvYlByb3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib2JQcm9wIikudmFsdWU7CgogIHZhciBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2hlY2tzIik7CiAgb3V0cHV0LmlubmVySFRNTCA9ICIiOwoKICBsb2FkRmlsZSgibWVzc2FnZSIsIGZ1bmN0aW9uICgpIHsKICAgIGZpbmRFbGVtZW50c1RvQ2hlY2sob2JQcm9wKTsKCiAgICBvdXRwdXQuaW5uZXJIVE1MICs9ICJ0aW1pbmdfdGVzdChmdW5jdGlvbigpIHtcbiI7CiAgICB2YXIgdGVzdFdpbmRvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmcmFtZSIpLmNvbnRlbnRXaW5kb3c7CiAgICB2YXIgaW50ZXJ2YWwgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnRlcnZhbCIpLnZhbHVlKTsKCiAgICB2YXIgZW5kVGltZSA9IEluZmluaXR5OwoKICAgIHZhciB0ID0gMDsKICAgIHdoaWxlKHQgPD0gZW5kVGltZSkgewogICAgICBpZiAodHlwZW9mIHRlc3RXaW5kb3cudGVzdGhhcm5lc3NfdGltZWxpbmUgPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIGFsZXJ0KCJZb3VyIHBhZ2UgZG9lc24ndCBjb250YWluIHRlc3RoYXJuZXNzX3RpbWxpbmUsIGNhbiBub3QgZ2VuZXJhdGUgYW55dGhpbmchIik7CiAgICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRlc3RXaW5kb3cudGVzdGhhcm5lc3NfdGltZWxpbmUuc2V0VGltZSh0KTsKCiAgICAgIC8vIFVwZGF0ZSB0aGUgZW5kVGltZSBhcyBpdCBjYW4gY2hhbmdlIGRlcGVuZGVudCBvbiB0aGUgcnVubmluZyBhbmltYXRpb25zCiAgICAgIC8vIGFuZCBtb2RpZmljYXRpb25zIHRvIHRoZW0uCiAgICAgIGVuZFRpbWUgPSBnZXRFbmRUaW1lKHRlc3RXaW5kb3cud2luZG93LmRvY3VtZW50LnRpbWVsaW5lKTsKCiAgICAgIGdlbmVyYXRlKHQpOwogICAgICB0ICs9IGludGVydmFsOwogICAgfQoKICAgIG91dHB1dC5pbm5lckhUTUwgKz0gJ30sICJBdXRvIGdlbmVyYXRlZCB0ZXN0cyIpO1xuJzsKICB9KTsKfQoKZnVuY3Rpb24gZmluZEVsZW1lbnRzVG9DaGVjayhyYXdTdHJpbmcpewogIC8vIFB1dCBhbGwgY2hlY2tzIGludG8gY2hlY2tTdGFjawogIGNoZWNrcyA9IFtdOwogIHJhd1N0cmluZyA9IHJhd1N0cmluZy5zcGxpdCgiXG4iKTsKCiAgZm9yICh2YXIgeCBpbiByYXdTdHJpbmcpewogICAgcmF3U3RyaW5nW3hdID0gcmF3U3RyaW5nW3hdLnJlcGxhY2UoL1xzL2csICIiKTsKICAgIHJhd1N0cmluZ1t4XSA9IHJhd1N0cmluZ1t4XS5zcGxpdCgiLCIpOwogICAgaWYgKHJhd1N0cmluZ1t4XVswXS5sZW5ndGggPT0gMCkKICAgICAgY29udGludWU7CiAgICB2YXIgb2JqZWN0ID0gd2luZG93LmZyYW1lc1swXS5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHJhd1N0cmluZ1t4XVswXSk7CiAgICB2YXIgcHJvcCA9IFtdOwogICAgZm9yICh2YXIgaSA9IDE7IGkgPCByYXdTdHJpbmdbeF0ubGVuZ3RoOyBpKyspewogICAgICBwcm9wLnB1c2gocmF3U3RyaW5nW3hdW2ldKTsKICAgIH0KICAgIGNoZWNrcy5wdXNoKG5ldyBUb0NoZWNrKG9iamVjdCwgcmF3U3RyaW5nW3hdWzBdLCBwcm9wKSk7CiAgfQp9CgpmdW5jdGlvbiBnZW5lcmF0ZSh0aW1lKXsKICBjb25zb2xlLmxvZygiR2VuZXJhdGluZyBjaGVja3MgZm9yIHQ9IiwgdGltZSk7CgogIC8vIFByb2R1Y2UgY2hlY2tzIGF0IHRoaXMgdGltZQogIHZhciBvdXRwdXRUZXh0ID0gIiAgYXQoIiArIHRpbWUgKyAiLCBmdW5jdGlvbigpIHtcbiI7CiAgZm9yICh2YXIgeCBpbiBjaGVja3MpewogICAgdmFyIHByb3BzbGlzdCA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGVja3NbeF0ub2JqZWN0Lmxlbmd0aDsgaSsrKXsKICAgICAgdmFyIHByb3BzUHJpbnQgPSAieyI7CiAgICAgIGZvciAodmFyIGogaW4gY2hlY2tzW3hdLnByb3BlcnRpZXMpewogICAgICAgIHZhciBwID0gY2hlY2tzW3hdLnByb3BlcnRpZXNbal07CiAgICAgICAgdmFyIGlzU1ZHID0gX1dlYkFuaW1hdGlvbnNUZXN0aW5nVXRpbGl0aWVzLl9wcm9wZXJ0eUlzU1ZHQXR0cmliKHAsIGNoZWNrc1t4XS5vYmplY3RbaV0pOwoKICAgICAgICBpZihpc1NWRykgdmFyIHByb3BzID0gY2hlY2tzW3hdLm9iamVjdFtpXS5hdHRyaWJ1dGVzOwogICAgICAgIGVsc2UgdmFyIHByb3BzID0gY2hlY2tzW3hdLm9iamVjdFtpXS5jdXJyZW50U3R5bGUgfHwKICAgICAgICAgICAgZ2V0Q29tcHV0ZWRTdHlsZShjaGVja3NbeF0ub2JqZWN0W2ldLCBudWxsKTsKCiAgICAgICAgaWYgKHAgPT0gJ2N0bScpIHsKICAgICAgICAgIHZhciBjdG0gPSBjaGVja3NbeF0ub2JqZWN0W2ldLmdldENUTSgpOwogICAgICAgICAgdmFyIHZhbHVlID0gJ3snICsgY3RtLmEgKyAnLCAnICsgY3RtLmIgKyAnLCAnICsgY3RtLmMgKyAnLCAnICsgY3RtLmQgKyAnLCAnICsgY3RtLmUgKyAnLCAnICsgY3RtLmYgKyAnfScKICAgICAgICB9IGVsc2UgaWYgKHAgPT0gJ3RyYW5zZm9ybScpIHsKICAgICAgICAgIHZhciB2YWx1ZSA9IHByb3BzW2ZlYXR1cmVzLnRyYW5zZm9ybVByb3BlcnR5XTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHZhbHVlID0gaXNTVkcgPyBwcm9wc1twXS52YWx1ZSA6IHByb3BzW3BdOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZygiTm9kZToiLCBjaGVja3NbeF0ub2JqZWN0W2ldLmNsb25lTm9kZSgpLCAiUHJvcGVydHk6IiwgY2hlY2tzW3hdLnByb3BlcnRpZXNbal0sICJWYWx1ZToiLCB2YWx1ZSk7CgogICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvWy0rXT9bMC05XStcLj9bMC05XSooPzpbZUVdWy0rXT9bMC05XSspPy9nLCBmdW5jdGlvbih2KSB7CiAgICAgICAgICB2ID0gTnVtYmVyKHYpOwogICAgICAgICAgaWYgKE1hdGguYWJzKHYpIDwgMWUtMTApIHsKICAgICAgICAgICAgdiA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gKCIiICsgdi50b1ByZWNpc2lvbig0KSkucmVwbGFjZSgvXC4/MCskLywgJycpOwogICAgICAgIH0pOwoKICAgICAgICBwcm9wc1ByaW50ICs9ICInIisgcCArICInOiciICsgdmFsdWUgKyAiJyI7CiAgICAgICAgaWYgKGogPCBjaGVja3NbeF0ucHJvcGVydGllcy5sZW5ndGggLTEpIHByb3BzUHJpbnQgKz0gIiwiOwogICAgICB9CiAgICAgIHByb3BzUHJpbnQgKz0gIn0iOwogICAgICBwcm9wc2xpc3QucHVzaChwcm9wc1ByaW50KTsKICAgIH0KICAgIG91dHB1dFRleHQgKz0gcHJpbnRDaGVjayhjaGVja3NbeF0uaW5pdFNlbGN0b3IsIGksIHByb3BzbGlzdCwgdGltZSk7CiAgfQogIG91dHB1dFRleHQgKz0gJyAgfSk7JzsKICB2YXIgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNoZWNrcyIpOwogIG91dHB1dC5pbm5lckhUTUwgKz0gb3V0cHV0VGV4dCArICI8YnI+IjsKfQoKZnVuY3Rpb24gcHJpbnRDaGVjayhvYmplY3QsIG51bWJlciwgcHJvcGVydGllcywgdGltZSl7CgogIHZhciBuZXdDaGVjayA9ICcgICAgYXNzZXJ0X3N0eWxlcygiJyArIG9iamVjdCArICciLCc7CgogIC8vIElmIGFsbCB0aGUgcHJvcGVydGllcyBhcmUgdGhlIHNhbWUgZm9yIGV2ZXJ5IG9iamVjdCwganVzdCBwYXNzIHRoZSBsaXN0LgogIHZhciBhbGxzYW1lID0gcHJvcGVydGllcy5ldmVyeShmdW5jdGlvbih4KSB7IHJldHVybiB4ID09PSBwcm9wZXJ0aWVzWzBdIH0pOwogIGlmIChhbGxzYW1lKSB7CiAgICBuZXdDaGVjayArPSBwcm9wZXJ0aWVzWzBdICsgIik7XG4iOwoKICB9IGVsc2UgewogICAgLy8gT3RoZXJ3aXNlIGdpdmUgYSBsaXN0IHdpdGggZWFjaAoKICAgIG5ld0NoZWNrICs9ICIgW1xuIjsKICAgIGZvciAodmFyIGogaW4gcHJvcGVydGllcykgewogICAgICAgbmV3Q2hlY2sgKz0gJyAgICAgICcgKyBwcm9wZXJ0aWVzW2pdICsgIixcbiI7CiAgICB9CiAgICBuZXdDaGVjayArPSAiICAgIF0pO1xuIjsKICB9CgogIHJldHVybiBuZXdDaGVjazsKfQo8L3NjcmlwdD4K",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 09:26:40 GMT",
                    "Content-Length": "7077",
                    "Date": "Fri, 07 Nov 2014 09:26:42 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}