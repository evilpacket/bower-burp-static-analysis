{
    "url": "http://localhost:9999/jralph/jQuery-Tabs/build/js/tabs.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>window.location.hash</b> and written to <b>$()</b> via the following statement:<ul><li>_this.addActiveClass($('[data-tab=\"'+window.location.hash+'\"]'));</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/jralph/jQuery-Tabs/build/js/tabs.js",
                "path": "/jralph/jQuery-Tabs/build/js/tabs.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9qcmFscGgvalF1ZXJ5LVRhYnMvYnVpbGQvanMvdGFicy5qcyBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNzcwMg0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAwNzoxMjoyOSBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMDc6MTI6MjkgR01UDQoNCi8qKgogKiBUYWJzIGpRdWVyeSBQbHVnaW4KICogCiAqIEBkZXNjIFRoaXMgalF1ZXJ5IHBsdWdpbiBwcm92aWRlcyBsaWdodHdlaWdodCB0YWJiaW5nIGZ1bmN0aW9uYWxpdHkgYW5kIHJlcXVpcmVzIGpxdWVyeS4KICogQGF1dGhvciBKb3NlcGggUmFscGggPGpvZUBqb3NlcGhyYWxwaC5jby51az4KICogQHVyaSBodHRwczovL2dpdGh1Yi5jb20vanJhbHBoL2pRdWVyeS1UYWJzLwogKiBAYXV0aG9yX3VyaSBodHRwOi8vam9zZXBocmFscGguY28udWsKICoKICogRXhhbXBsZToKICogPGNvZGU+CiAqICAgICA8ZGl2IGRhdGEtdGFicz4KICogICAgICAgICA8YSBkYXRhLXRhYj0iI3RhYjEiIGhyZWY9IiI+VGFiIDE8L2E+CiAqICAgICAgICAgPGEgZGF0YS10YWI9IiN0YWIyIiBocmVmPSIiPlRhYiAyPC9hPgogKiAgICAgPC9kaXY+CiAqICAgICA8ZGl2IGRhdGEtdGFiLWNvbnRlbnQgZGF0YS10YWJzLWRlZmF1bHQgaWQ9InRhYjEiPgogKiAgICAgICAgIDwhLS0gVGFiMSBDb250ZW50IC0tPgogKiAgICAgPC9kaXY+CiAqICAgICA8ZGl2IGRhdGEtdGFiLWNvbnRlbnQgaWQ9InRhYjIiPgogKiAgICAgICAgIDwhLS0gVGFiMiBDb250ZW50IC0tPgogKiAgICAgPC9kaXY+CiAqCiAqICAgICA8c2NyaXB0PgogKiAgICAgICAgICQoZnVuY3Rpb24oKSB7CiAqICAgICAgICAgICAgICQoJ1tkYXRhLXRhYnNdIGEnKS50YWJzKCk7CiAqICAgICAgICAgfSk7CiAqICAgICA8L3NjcmlwdD4KICogPC9jb2RlPgogKi8KKGZ1bmN0aW9uKCQsIGRvY3VtZW50LCB3aW5kb3csIHVuZGVmaW5lZCkgewogICAgCiAgICAvKioKICAgICAqIFNldCBwbHVnaW4gc2NvcGUgdmFyaWFibGVzLgogICAgICovCiAgICB2YXIgcGx1Z2luTmFtZSA9ICd0YWJzJywKICAgICAgICBkZWZhdWx0cyA9IHsKICAgICAgICAgICAgaW5BbmltYXRpb246ICdzaG93JywKICAgICAgICAgICAgb3V0QW5pbWF0aW9uOiAnaGlkZScsCiAgICAgICAgICAgIHNwZWVkOiAwLAogICAgICAgICAgICBhY3RpdmVDbGFzczogJ3RhYi1hY3RpdmUnLAogICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oZWxlbWVudCwgdGFiKSB7CgogICAgICAgICAgICB9LAogICAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZTogZnVuY3Rpb24odGFiKSB7CgogICAgICAgICAgICB9LAogICAgICAgICAgICB3YXRjaEhhc2g6IHRydWUsCiAgICAgICAgICAgIGRlZmF1bHRGcm9tSGFzaDogdHJ1ZQogICAgICAgIH07CgogICAgLyoqCiAgICAgKiBDcmVhdGUge29iamVjdH0gZWxlbWVudCBUaGUgalF1ZXJ5IGVsZW1lbnQgb2JqZWN0LgogICAgICoKICAgICAqIEBwYXJhbSAge29iamVjdH0gb3B0aW9ucyBBbnkgb3B0aW9ucyBwYXNzZWQgdG8gdGhlIHBsdWdpbi4KICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIGZ1bmN0aW9uIHRhYnMoZWxlbWVudCwgb3B0aW9ucykgewogICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7CiAgICAgICAgdGhpcy5zZWxlY3RvciA9IGVsZW1lbnQuc2VsZWN0b3I7CgogICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7CgogICAgICAgIHRoaXMuX2RlZmF1bHRzID0gZGVmYXVsdHM7CiAgICAgICAgdGhpcy5fbmFtZSA9IHBsdWdpbk5hbWU7CgogICAgICAgIHRoaXMuaW5pdCgpOwogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRvIGluaXRpYWxpemUgdGhlIHBsdWdpbi4KICAgICAqCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdGhpcy5oaWRlQWxsKCk7CiAgICAgICAgdGhpcy5zaG93RGVmYXVsdCgpOwogICAgICAgIHRoaXMuYWRkQ2xpY2tFdmVudCgpOwoKICAgICAgICBpZiAodGhpcy5vcHRpb25zLndhdGNoSGFzaCkgewogICAgICAgICAgICB0aGlzLndhdGNoVVJMSGFzaCgpOwogICAgICAgIH0KICAgIH07CgogICAgLyoqCiAgICAgKiBNZXRob2QgdG8gaGlkZSBhbGwgdGFicywgb3BlbiBvciBub3QuCiAgICAgKgogICAgICogQHJldHVybiB7dm9pZH0KICAgICAqLwogICAgdGFicy5wcm90b3R5cGUuaGlkZUFsbCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgJCh0aGlzLmVsZW1lbnQpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciB0YWJDb250ZW50ID0gJCh0aGlzKS5kYXRhKCd0YWInKTsKCiAgICAgICAgICAgICQodGFiQ29udGVudCkuaGlkZSgpOwogICAgICAgICAgICBfdGhpcy5yZW1vdmVBY3RpdmVDbGFzcyh0aGlzKTsKICAgICAgICB9KTsKICAgIH07CgogICAgLyoqCiAgICAgKiBNZXRob2QgdG8gc2hvdyBhbnkgZGVmYXVsdCAnb3BlbicgdGFicy4KICAgICAqCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS5zaG93RGVmYXVsdCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBkZWZhdWx0VGFiID0gJCgnW2RhdGEtdGFicy1kZWZhdWx0XScpLAogICAgICAgICAgICBfdGhpcyA9IHRoaXM7CgogICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGVmYXVsdEZyb21IYXNoICYmIHRoaXMuaXNUYWIod2luZG93LmxvY2F0aW9uLmhhc2gpKSB7CiAgICAgICAgICAgIHZhciBoYXNoTGluayA9ICQoJ1tkYXRhLXRhYj0iJyt3aW5kb3cubG9jYXRpb24uaGFzaCsnIl0nKTsKICAgICAgICAgICAgJCh3aW5kb3cubG9jYXRpb24uaGFzaCkuc2hvdygpOwogICAgICAgICAgICB0aGlzLmhpZGVPcGVuKHdpbmRvdy5sb2NhdGlvbi5oYXNoKTsKICAgICAgICAgICAgdGhpcy5hZGRBY3RpdmVDbGFzcyhoYXNoTGluayk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJChkZWZhdWx0VGFiKS5zaG93KDAsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIGlkID0gJCh0aGlzKS5hdHRyKCdpZCcpLAogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRMaW5rID0gJCgnW2RhdGEtdGFiPSIjJytpZCsnIl0nKTsKCiAgICAgICAgICAgICAgICBfdGhpcy5hZGRBY3RpdmVDbGFzcyhkZWZhdWx0TGluayk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CgogICAgLyoqCiAgICAgKiBNZXRob2QgdG8gYWRkIHRoZSBhY3RpdmUgY2xhc3MgdG8gdGhlIGN1cnJlbnRseSBhY3RpdmUgdGFiIGxpbmsuCiAgICAgKgogICAgICogQHBhcmFtIHtvYmplY3R9IGVsZW1lbnQgVGhlIGVsZW1lbnQgdG8gYWRkIHRoZSBjbGFzcyB0by4KICAgICAqLwogICAgdGFicy5wcm90b3R5cGUuYWRkQWN0aXZlQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50KSB7CiAgICAgICAgJChlbGVtZW50KS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MpOwogICAgfTsKCiAgICAvKioKICAgICAqIE1ldGhvZCB0byByZW1vdmUgdGhlIGFjdGl2ZSBjbGFzcyBmcm9tIGEgZ2l2ZW4gZWxlbWVudC9zZWxlY3Rvci4KICAgICAqCiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IGVsZW1lbnQgVGhlIGVsZW1lbnQvc2VsZWN0b3IuCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS5yZW1vdmVBY3RpdmVDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHsKICAgICAgICAkKGVsZW1lbnQpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5hY3RpdmVDbGFzcyk7CiAgICB9OwoKICAgIC8qKgogICAgICogTWV0aG9kIHRvIGFkZCB0aGUgY2xpY2sgZXZlbnQgdG8gdGhlIHNlbGVjdGVkIGVsZW1lbnRzLgogICAgICoKICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIHRhYnMucHJvdG90eXBlLmFkZENsaWNrRXZlbnQgPSBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgICQodGhpcy5lbGVtZW50KS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAkKHRoaXMpLmNsaWNrKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHRhYiA9IF90aGlzLnJ1bkNsaWNrKHRoaXMpOwogICAgICAgICAgICAgICAgX3RoaXMucnVuQ29tcGxldGUodGhpcywgdGFiKTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIC8qKgogICAgICogSWYgYSBoYXNoIHZhbHVlIGlzIGEgdGFiIG9uIHRoZSBwYWdlLCBsb2FkIGl0IGJ5IGRlZmF1bHQuCiAgICAgKgogICAgICogQHJldHVybiB7dm9pZH0KICAgICAqLwogICAgdGFicy5wcm90b3R5cGUud2F0Y2hVUkxIYXNoID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICAkKHdpbmRvdykub24oJ2hhc2hjaGFuZ2UnLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKF90aGlzLmlzVGFiKHdpbmRvdy5sb2NhdGlvbi5oYXNoKSkgewogICAgICAgICAgICAgICAgX3RoaXMuaGlkZU9wZW4od2luZG93LmxvY2F0aW9uLmhhc2gpOwogICAgICAgICAgICAgICAgX3RoaXMuc2hvd1RhYih3aW5kb3cubG9jYXRpb24uaGFzaCk7CiAgICAgICAgICAgICAgICBfdGhpcy5hZGRBY3RpdmVDbGFzcygkKCdbZGF0YS10YWI9Iicrd2luZG93LmxvY2F0aW9uLmhhc2grJyJdJykpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHRhYnMucHJvdG90eXBlLmlzVGFiID0gZnVuY3Rpb24oc2VsZWN0b3IpIHsKICAgICAgICB2YXIgaW5TY29wZSA9IGZhbHNlOwoKICAgICAgICAkKHRoaXMuc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciB0YWIgPSAkKHRoaXMpLmRhdGEoJ3RhYicpOwoKICAgICAgICAgICAgaWYgKHRhYiA9PSAnIycrJChzZWxlY3RvcikuYXR0cignaWQnKSkgewogICAgICAgICAgICAgICAgaW5TY29wZSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaWYgKCFpblNjb3BlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciBlbGVtZW50ID0gJChzZWxlY3RvciksCiAgICAgICAgICAgIHRhYl9jb250ZW50ID0gZWxlbWVudC5hdHRyKCdkYXRhLXRhYi1jb250ZW50Jyk7CgogICAgICAgIGlmICh0YWJfY29udGVudCA9PT0gdHlwZW9mIHVuZGVmaW5lZCB8fCB0YWJfY29udGVudCA9PT0gZmFsc2UgfHwgdGFiX2NvbnRlbnQgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIFJ1biB0aGUgY29tcGxldGUgY2FsbGJhY2sgd2hlbiBhIGNsaWNrIGhhcyBiZWVuIHJlZ2lzdGVyZWQgYW5kIHRoZQogICAgICogdGFiIGhhcyBiZWVuIHNob3duLgogICAgICoKICAgICAqIEBwYXJhbSAge29iamVjdH0gZWxlbWVudCBUaGUgZWxlbWVudCBjbGlja2VkIG9uLgogICAgICogQHBhcmFtICB7b2JqZWN0fSB0YWIgICAgIFRoZSB0YWIgYmVpbmcgbG9hZGVkLgogICAgICogQHJldHVybiB7dm9pZH0KICAgICAqLwogICAgdGFicy5wcm90b3R5cGUucnVuQ29tcGxldGUgPSBmdW5jdGlvbihlbGVtZW50LCB0YWIpIHsKICAgICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLmNvbXBsZXRlKSkgewogICAgICAgICAgICB0aGlzLm9wdGlvbnMuY29tcGxldGUoZWxlbWVudCwgdGFiKTsKICAgICAgICB9CiAgICB9OwoKICAgIC8qKgogICAgICogTWV0aG9kIHRvIHJ1biB3aGVuIHRoZSBjbGljayBldmVudCBpcyBmaXJlZC4KICAgICAqCiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IGVsZW1lbnQgVGhlIGVsZW1lbnQgY2xpY2tlZCBvbi4KICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIHRhYnMucHJvdG90eXBlLnJ1bkNsaWNrID0gZnVuY3Rpb24oZWxlbWVudCkgewogICAgICAgIHZhciB0YWIgPSAkKGVsZW1lbnQpLmRhdGEoJ3RhYicpOwoKICAgICAgICB0aGlzLnJlbW92ZUFjdGl2ZUNsYXNzKHRoaXMuZWxlbWVudCk7CiAgICAgICAgdGhpcy5hZGRBY3RpdmVDbGFzcyhlbGVtZW50KTsKCiAgICAgICAgdGhpcy5oaWRlT3Blbih0YWIpOwogICAgICAgIHRoaXMuc2hvd1RhYih0YWIpOwoKICAgICAgICByZXR1cm4gdGFiOwogICAgfTsKCiAgICAvKioKICAgICAqIE1ldGhvZCB0byBoaWRlIGFueSBvdGhlciBvcGVuIHRhYnMgYXBhcnQgZnJvbSB0aGUgY2xpY2tlZCBvbiB0YWIuCiAgICAgKgogICAgICogQHBhcmFtICB7b2JqZWN0fSB0YWIgVGhlIGNsaWNrZWQgb24gdGFiIHRvIG9wZW4uCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS5oaWRlT3BlbiA9IGZ1bmN0aW9uKHRhYikgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgJCh0aGlzLnNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIgY3VycmVudFRhYiA9ICQoJCh0aGlzKS5kYXRhKCd0YWInKSk7CgogICAgICAgICAgICBpZiAoY3VycmVudFRhYiA9PSB0YWIpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkKGN1cnJlbnRUYWIpW190aGlzLm9wdGlvbnMub3V0QW5pbWF0aW9uXShfdGhpcy5vcHRpb25zLnNwZWVkKTsKICAgICAgICAgICAgX3RoaXMucmVtb3ZlQWN0aXZlQ2xhc3MoJCgnW2RhdGEtdGFiPSInK2N1cnJlbnRUYWIrJyJdJykpOwogICAgICAgIH0pOwogICAgfTsKCiAgICAvKioKICAgICAqIE1ldGhvZCB0byBzaG93IHRoZSByZXF1ZXN0ZWQgdGFiLgogICAgICoKICAgICAqIEBwYXJhbSAge29iamVjdH0gdGFiIFRoZSByZXF1ZXRlZCB0YWIuCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS5zaG93VGFiID0gZnVuY3Rpb24odGFiKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICAkKHRhYikuZGVsYXkodGhpcy5vcHRpb25zLnNwZWVkKVt0aGlzLm9wdGlvbnMuaW5BbmltYXRpb25dKHRoaXMub3B0aW9ucy5zcGVlZCwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIF90aGlzLnJ1bkFuaW1hdGlvbkNvbXBsZXRlKHRoaXMpOwogICAgICAgIH0pOwogICAgfTsKCiAgICAvKioKICAgICAqIFJ1biBhIGNhbGxiYWNrIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZS4KICAgICAqIAogICAgICogQHBhcmFtICB7b2JqZWN0fSB0YWIKICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIHRhYnMucHJvdG90eXBlLnJ1bkFuaW1hdGlvbkNvbXBsZXRlID0gZnVuY3Rpb24odGFiKSB7CiAgICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy5hbmltYXRpb25Db21wbGV0ZSkpIHsKICAgICAgICAgICAgdGhpcy5vcHRpb25zLmFuaW1hdGlvbkNvbXBsZXRlKHRhYik7CiAgICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBwbHVnaW4uCiAgICAgKgogICAgICogQHBhcmFtICB7b2JqZWN0fSBvcHRpb25zIEFueSBjdXN0b20gb3B0aW9ucyB0byBhZGQgdG8gdGhlIHBsdWdpbi4KICAgICAqIEByZXR1cm4ge3RoaXN9CiAgICAgKi8KICAgICQuZm5bcGx1Z2luTmFtZV0gPSBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAgICAgaWYoISQuZGF0YSh0aGlzLCAncGx1Z2luXycgKyBwbHVnaW5OYW1lKSkgewogICAgICAgICAgICAkLmRhdGEodGhpcywgJ3BsdWdpbl8nICsgcGx1Z2luTmFtZSwgbmV3IHRhYnModGhpcywgb3B0aW9ucykpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpczsKICAgIH07Cgp9KShqUXVlcnksIGRvY3VtZW50LCB3aW5kb3cpOwo=",
                "body": "LyoqCiAqIFRhYnMgalF1ZXJ5IFBsdWdpbgogKiAKICogQGRlc2MgVGhpcyBqUXVlcnkgcGx1Z2luIHByb3ZpZGVzIGxpZ2h0d2VpZ2h0IHRhYmJpbmcgZnVuY3Rpb25hbGl0eSBhbmQgcmVxdWlyZXMganF1ZXJ5LgogKiBAYXV0aG9yIEpvc2VwaCBSYWxwaCA8am9lQGpvc2VwaHJhbHBoLmNvLnVrPgogKiBAdXJpIGh0dHBzOi8vZ2l0aHViLmNvbS9qcmFscGgvalF1ZXJ5LVRhYnMvCiAqIEBhdXRob3JfdXJpIGh0dHA6Ly9qb3NlcGhyYWxwaC5jby51awogKgogKiBFeGFtcGxlOgogKiA8Y29kZT4KICogICAgIDxkaXYgZGF0YS10YWJzPgogKiAgICAgICAgIDxhIGRhdGEtdGFiPSIjdGFiMSIgaHJlZj0iIj5UYWIgMTwvYT4KICogICAgICAgICA8YSBkYXRhLXRhYj0iI3RhYjIiIGhyZWY9IiI+VGFiIDI8L2E+CiAqICAgICA8L2Rpdj4KICogICAgIDxkaXYgZGF0YS10YWItY29udGVudCBkYXRhLXRhYnMtZGVmYXVsdCBpZD0idGFiMSI+CiAqICAgICAgICAgPCEtLSBUYWIxIENvbnRlbnQgLS0+CiAqICAgICA8L2Rpdj4KICogICAgIDxkaXYgZGF0YS10YWItY29udGVudCBpZD0idGFiMiI+CiAqICAgICAgICAgPCEtLSBUYWIyIENvbnRlbnQgLS0+CiAqICAgICA8L2Rpdj4KICoKICogICAgIDxzY3JpcHQ+CiAqICAgICAgICAgJChmdW5jdGlvbigpIHsKICogICAgICAgICAgICAgJCgnW2RhdGEtdGFic10gYScpLnRhYnMoKTsKICogICAgICAgICB9KTsKICogICAgIDwvc2NyaXB0PgogKiA8L2NvZGU+CiAqLwooZnVuY3Rpb24oJCwgZG9jdW1lbnQsIHdpbmRvdywgdW5kZWZpbmVkKSB7CiAgICAKICAgIC8qKgogICAgICogU2V0IHBsdWdpbiBzY29wZSB2YXJpYWJsZXMuCiAgICAgKi8KICAgIHZhciBwbHVnaW5OYW1lID0gJ3RhYnMnLAogICAgICAgIGRlZmF1bHRzID0gewogICAgICAgICAgICBpbkFuaW1hdGlvbjogJ3Nob3cnLAogICAgICAgICAgICBvdXRBbmltYXRpb246ICdoaWRlJywKICAgICAgICAgICAgc3BlZWQ6IDAsCiAgICAgICAgICAgIGFjdGl2ZUNsYXNzOiAndGFiLWFjdGl2ZScsCiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbihlbGVtZW50LCB0YWIpIHsKCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlOiBmdW5jdGlvbih0YWIpIHsKCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHdhdGNoSGFzaDogdHJ1ZSwKICAgICAgICAgICAgZGVmYXVsdEZyb21IYXNoOiB0cnVlCiAgICAgICAgfTsKCiAgICAvKioKICAgICAqIENyZWF0ZSB7b2JqZWN0fSBlbGVtZW50IFRoZSBqUXVlcnkgZWxlbWVudCBvYmplY3QuCiAgICAgKgogICAgICogQHBhcmFtICB7b2JqZWN0fSBvcHRpb25zIEFueSBvcHRpb25zIHBhc3NlZCB0byB0aGUgcGx1Z2luLgogICAgICogQHJldHVybiB7dm9pZH0KICAgICAqLwogICAgZnVuY3Rpb24gdGFicyhlbGVtZW50LCBvcHRpb25zKSB7CiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDsKICAgICAgICB0aGlzLnNlbGVjdG9yID0gZWxlbWVudC5zZWxlY3RvcjsKCiAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIGRlZmF1bHRzLCBvcHRpb25zKTsKCiAgICAgICAgdGhpcy5fZGVmYXVsdHMgPSBkZWZhdWx0czsKICAgICAgICB0aGlzLl9uYW1lID0gcGx1Z2luTmFtZTsKCiAgICAgICAgdGhpcy5pbml0KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNZXRob2QgdG8gaW5pdGlhbGl6ZSB0aGUgcGx1Z2luLgogICAgICoKICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIHRhYnMucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLmhpZGVBbGwoKTsKICAgICAgICB0aGlzLnNob3dEZWZhdWx0KCk7CiAgICAgICAgdGhpcy5hZGRDbGlja0V2ZW50KCk7CgogICAgICAgIGlmICh0aGlzLm9wdGlvbnMud2F0Y2hIYXNoKSB7CiAgICAgICAgICAgIHRoaXMud2F0Y2hVUkxIYXNoKCk7CiAgICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIE1ldGhvZCB0byBoaWRlIGFsbCB0YWJzLCBvcGVuIG9yIG5vdC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS5oaWRlQWxsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICAkKHRoaXMuZWxlbWVudCkuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgICAgdmFyIHRhYkNvbnRlbnQgPSAkKHRoaXMpLmRhdGEoJ3RhYicpOwoKICAgICAgICAgICAgJCh0YWJDb250ZW50KS5oaWRlKCk7CiAgICAgICAgICAgIF90aGlzLnJlbW92ZUFjdGl2ZUNsYXNzKHRoaXMpOwogICAgICAgIH0pOwogICAgfTsKCiAgICAvKioKICAgICAqIE1ldGhvZCB0byBzaG93IGFueSBkZWZhdWx0ICdvcGVuJyB0YWJzLgogICAgICoKICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIHRhYnMucHJvdG90eXBlLnNob3dEZWZhdWx0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGRlZmF1bHRUYWIgPSAkKCdbZGF0YS10YWJzLWRlZmF1bHRdJyksCiAgICAgICAgICAgIF90aGlzID0gdGhpczsKCiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kZWZhdWx0RnJvbUhhc2ggJiYgdGhpcy5pc1RhYih3aW5kb3cubG9jYXRpb24uaGFzaCkpIHsKICAgICAgICAgICAgdmFyIGhhc2hMaW5rID0gJCgnW2RhdGEtdGFiPSInK3dpbmRvdy5sb2NhdGlvbi5oYXNoKyciXScpOwogICAgICAgICAgICAkKHdpbmRvdy5sb2NhdGlvbi5oYXNoKS5zaG93KCk7CiAgICAgICAgICAgIHRoaXMuaGlkZU9wZW4od2luZG93LmxvY2F0aW9uLmhhc2gpOwogICAgICAgICAgICB0aGlzLmFkZEFjdGl2ZUNsYXNzKGhhc2hMaW5rKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkKGRlZmF1bHRUYWIpLnNob3coMCwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgaWQgPSAkKHRoaXMpLmF0dHIoJ2lkJyksCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdExpbmsgPSAkKCdbZGF0YS10YWI9IiMnK2lkKyciXScpOwoKICAgICAgICAgICAgICAgIF90aGlzLmFkZEFjdGl2ZUNsYXNzKGRlZmF1bHRMaW5rKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIE1ldGhvZCB0byBhZGQgdGhlIGFjdGl2ZSBjbGFzcyB0byB0aGUgY3VycmVudGx5IGFjdGl2ZSB0YWIgbGluay4KICAgICAqCiAgICAgKiBAcGFyYW0ge29iamVjdH0gZWxlbWVudCBUaGUgZWxlbWVudCB0byBhZGQgdGhlIGNsYXNzIHRvLgogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS5hZGRBY3RpdmVDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHsKICAgICAgICAkKGVsZW1lbnQpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5hY3RpdmVDbGFzcyk7CiAgICB9OwoKICAgIC8qKgogICAgICogTWV0aG9kIHRvIHJlbW92ZSB0aGUgYWN0aXZlIGNsYXNzIGZyb20gYSBnaXZlbiBlbGVtZW50L3NlbGVjdG9yLgogICAgICoKICAgICAqIEBwYXJhbSAge29iamVjdH0gZWxlbWVudCBUaGUgZWxlbWVudC9zZWxlY3Rvci4KICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIHRhYnMucHJvdG90eXBlLnJlbW92ZUFjdGl2ZUNsYXNzID0gZnVuY3Rpb24oZWxlbWVudCkgewogICAgICAgICQoZWxlbWVudCkucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBNZXRob2QgdG8gYWRkIHRoZSBjbGljayBldmVudCB0byB0aGUgc2VsZWN0ZWQgZWxlbWVudHMuCiAgICAgKgogICAgICogQHJldHVybiB7dm9pZH0KICAgICAqLwogICAgdGFicy5wcm90b3R5cGUuYWRkQ2xpY2tFdmVudCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgJCh0aGlzLmVsZW1lbnQpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICQodGhpcykuY2xpY2soZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgdGFiID0gX3RoaXMucnVuQ2xpY2sodGhpcyk7CiAgICAgICAgICAgICAgICBfdGhpcy5ydW5Db21wbGV0ZSh0aGlzLCB0YWIpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH07CgogICAgLyoqCiAgICAgKiBJZiBhIGhhc2ggdmFsdWUgaXMgYSB0YWIgb24gdGhlIHBhZ2UsIGxvYWQgaXQgYnkgZGVmYXVsdC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS53YXRjaFVSTEhhc2ggPSBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgICQod2luZG93KS5vbignaGFzaGNoYW5nZScsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAoX3RoaXMuaXNUYWIod2luZG93LmxvY2F0aW9uLmhhc2gpKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5oaWRlT3Blbih3aW5kb3cubG9jYXRpb24uaGFzaCk7CiAgICAgICAgICAgICAgICBfdGhpcy5zaG93VGFiKHdpbmRvdy5sb2NhdGlvbi5oYXNoKTsKICAgICAgICAgICAgICAgIF90aGlzLmFkZEFjdGl2ZUNsYXNzKCQoJ1tkYXRhLXRhYj0iJyt3aW5kb3cubG9jYXRpb24uaGFzaCsnIl0nKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH07CgogICAgdGFicy5wcm90b3R5cGUuaXNUYWIgPSBmdW5jdGlvbihzZWxlY3RvcikgewogICAgICAgIHZhciBpblNjb3BlID0gZmFsc2U7CgogICAgICAgICQodGhpcy5zZWxlY3RvcikuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgICAgdmFyIHRhYiA9ICQodGhpcykuZGF0YSgndGFiJyk7CgogICAgICAgICAgICBpZiAodGFiID09ICcjJyskKHNlbGVjdG9yKS5hdHRyKCdpZCcpKSB7CiAgICAgICAgICAgICAgICBpblNjb3BlID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAoIWluU2NvcGUpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdmFyIGVsZW1lbnQgPSAkKHNlbGVjdG9yKSwKICAgICAgICAgICAgdGFiX2NvbnRlbnQgPSBlbGVtZW50LmF0dHIoJ2RhdGEtdGFiLWNvbnRlbnQnKTsKCiAgICAgICAgaWYgKHRhYl9jb250ZW50ID09PSB0eXBlb2YgdW5kZWZpbmVkIHx8IHRhYl9jb250ZW50ID09PSBmYWxzZSB8fCB0YWJfY29udGVudCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9OwoKICAgIC8qKgogICAgICogUnVuIHRoZSBjb21wbGV0ZSBjYWxsYmFjayB3aGVuIGEgY2xpY2sgaGFzIGJlZW4gcmVnaXN0ZXJlZCBhbmQgdGhlCiAgICAgKiB0YWIgaGFzIGJlZW4gc2hvd24uCiAgICAgKgogICAgICogQHBhcmFtICB7b2JqZWN0fSBlbGVtZW50IFRoZSBlbGVtZW50IGNsaWNrZWQgb24uCiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHRhYiAgICAgVGhlIHRhYiBiZWluZyBsb2FkZWQuCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICB0YWJzLnByb3RvdHlwZS5ydW5Db21wbGV0ZSA9IGZ1bmN0aW9uKGVsZW1lbnQsIHRhYikgewogICAgICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbih0aGlzLm9wdGlvbnMuY29tcGxldGUpKSB7CiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5jb21wbGV0ZShlbGVtZW50LCB0YWIpOwogICAgICAgIH0KICAgIH07CgogICAgLyoqCiAgICAgKiBNZXRob2QgdG8gcnVuIHdoZW4gdGhlIGNsaWNrIGV2ZW50IGlzIGZpcmVkLgogICAgICoKICAgICAqIEBwYXJhbSAge29iamVjdH0gZWxlbWVudCBUaGUgZWxlbWVudCBjbGlja2VkIG9uLgogICAgICogQHJldHVybiB7dm9pZH0KICAgICAqLwogICAgdGFicy5wcm90b3R5cGUucnVuQ2xpY2sgPSBmdW5jdGlvbihlbGVtZW50KSB7CiAgICAgICAgdmFyIHRhYiA9ICQoZWxlbWVudCkuZGF0YSgndGFiJyk7CgogICAgICAgIHRoaXMucmVtb3ZlQWN0aXZlQ2xhc3ModGhpcy5lbGVtZW50KTsKICAgICAgICB0aGlzLmFkZEFjdGl2ZUNsYXNzKGVsZW1lbnQpOwoKICAgICAgICB0aGlzLmhpZGVPcGVuKHRhYik7CiAgICAgICAgdGhpcy5zaG93VGFiKHRhYik7CgogICAgICAgIHJldHVybiB0YWI7CiAgICB9OwoKICAgIC8qKgogICAgICogTWV0aG9kIHRvIGhpZGUgYW55IG90aGVyIG9wZW4gdGFicyBhcGFydCBmcm9tIHRoZSBjbGlja2VkIG9uIHRhYi4KICAgICAqCiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHRhYiBUaGUgY2xpY2tlZCBvbiB0YWIgdG8gb3Blbi4KICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIHRhYnMucHJvdG90eXBlLmhpZGVPcGVuID0gZnVuY3Rpb24odGFiKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICAkKHRoaXMuc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciBjdXJyZW50VGFiID0gJCgkKHRoaXMpLmRhdGEoJ3RhYicpKTsKCiAgICAgICAgICAgIGlmIChjdXJyZW50VGFiID09IHRhYikgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICQoY3VycmVudFRhYilbX3RoaXMub3B0aW9ucy5vdXRBbmltYXRpb25dKF90aGlzLm9wdGlvbnMuc3BlZWQpOwogICAgICAgICAgICBfdGhpcy5yZW1vdmVBY3RpdmVDbGFzcygkKCdbZGF0YS10YWI9IicrY3VycmVudFRhYisnIl0nKSk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIC8qKgogICAgICogTWV0aG9kIHRvIHNob3cgdGhlIHJlcXVlc3RlZCB0YWIuCiAgICAgKgogICAgICogQHBhcmFtICB7b2JqZWN0fSB0YWIgVGhlIHJlcXVldGVkIHRhYi4KICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIHRhYnMucHJvdG90eXBlLnNob3dUYWIgPSBmdW5jdGlvbih0YWIpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgICQodGFiKS5kZWxheSh0aGlzLm9wdGlvbnMuc3BlZWQpW3RoaXMub3B0aW9ucy5pbkFuaW1hdGlvbl0odGhpcy5vcHRpb25zLnNwZWVkLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgX3RoaXMucnVuQW5pbWF0aW9uQ29tcGxldGUodGhpcyk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIC8qKgogICAgICogUnVuIGEgY2FsbGJhY2sgd2hlbiB0aGUgYW5pbWF0aW9uIGlzIGNvbXBsZXRlLgogICAgICogCiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IHRhYgogICAgICogQHJldHVybiB7dm9pZH0KICAgICAqLwogICAgdGFicy5wcm90b3R5cGUucnVuQW5pbWF0aW9uQ29tcGxldGUgPSBmdW5jdGlvbih0YWIpIHsKICAgICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLmFuaW1hdGlvbkNvbXBsZXRlKSkgewogICAgICAgICAgICB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uQ29tcGxldGUodGFiKTsKICAgICAgICB9CiAgICB9OwoKICAgIC8qKgogICAgICogUmVnaXN0ZXIgdGhlIHBsdWdpbi4KICAgICAqCiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IG9wdGlvbnMgQW55IGN1c3RvbSBvcHRpb25zIHRvIGFkZCB0byB0aGUgcGx1Z2luLgogICAgICogQHJldHVybiB7dGhpc30KICAgICAqLwogICAgJC5mbltwbHVnaW5OYW1lXSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgICBpZighJC5kYXRhKHRoaXMsICdwbHVnaW5fJyArIHBsdWdpbk5hbWUpKSB7CiAgICAgICAgICAgICQuZGF0YSh0aGlzLCAncGx1Z2luXycgKyBwbHVnaW5OYW1lLCBuZXcgdGFicyh0aGlzLCBvcHRpb25zKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzOwogICAgfTsKCn0pKGpRdWVyeSwgZG9jdW1lbnQsIHdpbmRvdyk7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 07:12:29 GMT",
                    "Content-Length": "7702",
                    "Date": "Fri, 07 Nov 2014 07:12:29 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}