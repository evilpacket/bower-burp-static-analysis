{
    "url": "http://localhost:9999/jquery-orphans/jquery-metadata/test/testrunner.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>location.href</b> and written to <b>location.href</b> via the following statement:<ul><li>location.href = location.href.match(/^(.+?)(\\?.*)?$/)[1] + \"?\" + encodeURIComponent($.trim(target.text()));</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/jquery-orphans/jquery-metadata/test/testrunner.js",
                "path": "/jquery-orphans/jquery-metadata/test/testrunner.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9qcXVlcnktb3JwaGFucy9qcXVlcnktbWV0YWRhdGEvdGVzdC90ZXN0cnVubmVyLmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNzk1NQ0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAwNjo0MzozNSBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMDY6NDM6MzUgR01UDQoNCnZhciBfY29uZmlnID0gew0KCWZpeHR1cmU6IG51bGwsDQoJVGVzdDogW10sDQoJc3RhdHM6IHsNCgkJYWxsOiAwLA0KCQliYWQ6IDANCgl9LA0KCXF1ZXVlOiBbXSwNCglibG9ja2luZzogdHJ1ZSwNCgl0aW1lb3V0OiBudWxsLA0KCWV4cGVjdGVkOiBudWxsLA0KCWN1cnJlbnRNb2R1bGU6IG51bGwsDQoJYXN5bmNUaW1lb3V0OiAyIC8vIHNlY29uZHMgZm9yIGFzeW5jIHRpbWVvdXQNCn07DQoNCiQoZnVuY3Rpb24oKSB7DQoJJCgnI3VzZXJBZ2VudCcpLmh0bWwobmF2aWdhdG9yLnVzZXJBZ2VudCk7DQoJcnVuVGVzdCgpOwkNCn0pOw0KDQpmdW5jdGlvbiBzeW5jaHJvbml6ZShjYWxsYmFjaykgew0KCV9jb25maWcucXVldWVbX2NvbmZpZy5xdWV1ZS5sZW5ndGhdID0gY2FsbGJhY2s7DQoJaWYoIV9jb25maWcuYmxvY2tpbmcpIHsNCgkJcHJvY2VzcygpOw0KCX0NCn0NCg0KZnVuY3Rpb24gcHJvY2VzcygpIHsNCgl3aGlsZShfY29uZmlnLnF1ZXVlLmxlbmd0aCAmJiAhX2NvbmZpZy5ibG9ja2luZykgew0KCQl2YXIgY2FsbCA9IF9jb25maWcucXVldWVbMF07DQoJCV9jb25maWcucXVldWUgPSBfY29uZmlnLnF1ZXVlLnNsaWNlKDEpOw0KCQljYWxsKCk7DQoJfQ0KfQ0KDQpmdW5jdGlvbiBzdG9wKGFsbG93RmFpbHVyZSkgew0KCV9jb25maWcuYmxvY2tpbmcgPSB0cnVlOw0KCXZhciBoYW5kbGVyID0gYWxsb3dGYWlsdXJlID8gc3RhcnQgOiBmdW5jdGlvbigpIHsNCgkJb2soIGZhbHNlLCAiVGVzdCB0aW1lZCBvdXQiICk7DQoJCXN0YXJ0KCk7DQoJfTsNCglfY29uZmlnLnRpbWVvdXQgPSBzZXRUaW1lb3V0KGhhbmRsZXIsIF9jb25maWcuYXN5bmNUaW1lb3V0ICogMTAwMCk7DQp9DQpmdW5jdGlvbiBzdGFydCgpIHsNCglpZihfY29uZmlnLnRpbWVvdXQpDQoJCWNsZWFyVGltZW91dChfY29uZmlnLnRpbWVvdXQpOw0KCV9jb25maWcuYmxvY2tpbmcgPSBmYWxzZTsNCglwcm9jZXNzKCk7DQp9DQoNCmZ1bmN0aW9uIHJ1blRlc3QoKSB7DQoJX2NvbmZpZy5ibG9ja2luZyA9IGZhbHNlOw0KCXZhciB0aW1lID0gbmV3IERhdGUoKTsNCglfY29uZmlnLmZpeHR1cmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbicpLmlubmVySFRNTDsNCglyZXNldCgpOw0KCXN5bmNocm9uaXplKGZ1bmN0aW9uKCkgew0KCQl0aW1lID0gbmV3IERhdGUoKSAtIHRpbWU7DQoJCSQoIjxkaXY+IikuaHRtbChbJzxwIGNsYXNzPSJyZXN1bHQiPlRlc3RzIGNvbXBsZXRlZCBpbiAnLA0KCQkJdGltZSwgJyBtaWxsaXNlY29uZHMuPGJyLz4nLA0KCQkJX2NvbmZpZy5zdGF0cy5iYWQsICcgdGVzdHMgb2YgJywgX2NvbmZpZy5zdGF0cy5hbGwsICcgZmFpbGVkLjwvcD4nXQ0KCQkJLmpvaW4oJycpKQ0KCQkJLmFwcGVuZFRvKCJib2R5Iik7DQoJCSQoIiNiYW5uZXIiKS5hZGRDbGFzcyhfY29uZmlnLnN0YXRzLmJhZCA/ICJmYWlsIiA6ICJwYXNzIik7DQoJfSk7DQp9DQoNCmZ1bmN0aW9uIHRlc3QobmFtZSwgY2FsbGJhY2ssIG5vd2FpdCkgew0KCWlmKF9jb25maWcuY3VycmVudE1vZHVsZSkNCgkJbmFtZSA9IF9jb25maWcuY3VycmVudE1vZHVsZSArICIgbW9kdWxlOiAiICsgbmFtZTsNCgkJDQoJdmFyIGZpbHRlciA9IGxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKTsNCglpZiAoIGZpbHRlciAmJiBlbmNvZGVVUklDb21wb25lbnQobmFtZSkgIT0gZmlsdGVyICkNCgkJcmV0dXJuOw0KCQkNCglzeW5jaHJvbml6ZShmdW5jdGlvbigpIHsNCgkJX2NvbmZpZy5UZXN0ID0gW107DQoJCXRyeSB7DQoJCQljYWxsYmFjaygpOw0KCQl9IGNhdGNoKGUpIHsNCgkJCWlmKCB0eXBlb2YgY29uc29sZSAhPSAidW5kZWZpbmVkIiAmJiBjb25zb2xlLmVycm9yICYmIGNvbnNvbGUud2FybiApIHsNCgkJCQljb25zb2xlLmVycm9yKCJUZXN0ICIgKyBuYW1lICsgIiBkaWVkLCBleGNlcHRpb24gYW5kIHRlc3QgZm9sbG93cyIpOw0KCQkJCWNvbnNvbGUuZXJyb3IoZSk7DQoJCQkJY29uc29sZS53YXJuKGNhbGxiYWNrLnRvU3RyaW5nKCkpOw0KCQkJfQ0KCQkJX2NvbmZpZy5UZXN0LnB1c2goIFsgZmFsc2UsICJEaWVkIG9uIHRlc3QgIyIgKyAoX2NvbmZpZy5UZXN0Lmxlbmd0aCsxKSArICI6ICIgKyBlIF0gKTsNCgkJCS8vdGhyb3cgZTsNCgkJfQ0KCX0pOw0KCXN5bmNocm9uaXplKGZ1bmN0aW9uKCkgew0KCQlyZXNldCgpOw0KCQkNCgkJLy8gZG9uJ3Qgb3V0cHV0IHBhdXNlIHRlc3RzDQoJCWlmKG5vd2FpdCkgcmV0dXJuOw0KCQkNCgkJaWYoX2NvbmZpZy5leHBlY3RlZCAmJiBfY29uZmlnLmV4cGVjdGVkICE9IF9jb25maWcuVGVzdC5sZW5ndGgpIHsNCgkJCV9jb25maWcuVGVzdC5wdXNoKCBbIGZhbHNlLCAiRXhwZWN0ZWQgIiArIF9jb25maWcuZXhwZWN0ZWQgKyAiIGFzc2VydGlvbnMsIGJ1dCAiICsgX2NvbmZpZy5UZXN0Lmxlbmd0aCArICIgd2VyZSBydW4iIF0gKTsNCgkJfQ0KCQlfY29uZmlnLmV4cGVjdGVkID0gbnVsbDsNCgkJDQoJCXZhciBnb29kID0gMCwgYmFkID0gMDsNCgkJdmFyIG9sID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib2wiKTsNCgkJb2wuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCgkJdmFyIGxpID0gIiIsIHN0YXRlID0gInBhc3MiOw0KCQlmb3IgKCB2YXIgaSA9IDA7IGkgPCBfY29uZmlnLlRlc3QubGVuZ3RoOyBpKysgKSB7DQoJCQl2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaSIpOw0KCQkJbGkuY2xhc3NOYW1lID0gX2NvbmZpZy5UZXN0W2ldWzBdID8gInBhc3MiIDogImZhaWwiOw0KCQkJbGkuaW5uZXJIVE1MID0gX2NvbmZpZy5UZXN0W2ldWzFdOw0KCQkJb2wuYXBwZW5kQ2hpbGQoIGxpICk7DQoJCQkNCgkJCV9jb25maWcuc3RhdHMuYWxsKys7DQoJCQlpZiAoICFfY29uZmlnLlRlc3RbaV1bMF0gKSB7DQoJCQkJc3RhdGUgPSAiZmFpbCI7DQoJCQkJYmFkKys7DQoJCQkJX2NvbmZpZy5zdGF0cy5iYWQrKzsNCgkJCX0gZWxzZSBnb29kKys7DQoJCX0NCgkNCgkJdmFyIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGkiKTsNCgkJbGkuY2xhc3NOYW1lID0gc3RhdGU7DQoJDQoJCXZhciBiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3Ryb25nIik7DQoJCWIuaW5uZXJIVE1MID0gbmFtZSArICIgPGIgc3R5bGU9J2NvbG9yOmJsYWNrOyc+KDxiIGNsYXNzPSdmYWlsJz4iICsgYmFkICsgIjwvYj4sIDxiIGNsYXNzPSdwYXNzJz4iICsgZ29vZCArICI8L2I+LCAiICsgX2NvbmZpZy5UZXN0Lmxlbmd0aCArICIpPC9iPiI7DQoJCWIub25jbGljayA9IGZ1bmN0aW9uKCl7DQoJCQl2YXIgbiA9IHRoaXMubmV4dFNpYmxpbmc7DQoJCQlpZiAoIGpRdWVyeS5jc3MoIG4sICJkaXNwbGF5IiApID09ICJub25lIiApDQoJCQkJbi5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsNCgkJCWVsc2UNCgkJCQluLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQoJCX07DQoJCSQoYikuZGJsY2xpY2soZnVuY3Rpb24oZXZlbnQpIHsNCgkJCXZhciB0YXJnZXQgPSBqUXVlcnkoZXZlbnQudGFyZ2V0KS5maWx0ZXIoInN0cm9uZyIpLmNsb25lKCk7DQoJCQlpZiAoIHRhcmdldC5sZW5ndGggKSB7DQoJCQkJdGFyZ2V0LmNoaWxkcmVuKCkucmVtb3ZlKCk7DQoJCQkJbG9jYXRpb24uaHJlZiA9IGxvY2F0aW9uLmhyZWYubWF0Y2goL14oLis/KShcPy4qKT8kLylbMV0gKyAiPyIgKyBlbmNvZGVVUklDb21wb25lbnQoJC50cmltKHRhcmdldC50ZXh0KCkpKTsNCgkJCX0NCgkJfSk7DQoJCWxpLmFwcGVuZENoaWxkKCBiICk7DQoJCWxpLmFwcGVuZENoaWxkKCBvbCApOw0KCQ0KCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVzdHMiKS5hcHBlbmRDaGlsZCggbGkgKTsJCQ0KCX0pOw0KfQ0KDQovLyBjYWxsIG9uIHN0YXJ0IG9mIG1vZHVsZSB0ZXN0IHRvIHByZXBlbmQgbmFtZSB0byBhbGwgdGVzdHMNCmZ1bmN0aW9uIG1vZHVsZShtb2R1bGVOYW1lKSB7DQoJX2NvbmZpZy5jdXJyZW50TW9kdWxlID0gbW9kdWxlTmFtZTsNCn0NCg0KLyoqDQogKiBTcGVjaWZ5IHRoZSBudW1iZXIgb2YgZXhwZWN0ZWQgYXNzZXJ0aW9ucyB0byBndXJhbnRlZSB0aGF0IGZhaWxlZCB0ZXN0IChubyBhc3NlcnRpb25zIGFyZSBydW4gYXQgYWxsKSBkb24ndCBzbGlwIHRocm91Z2guDQogKi8NCmZ1bmN0aW9uIGV4cGVjdChhc3NlcnRzKSB7DQoJX2NvbmZpZy5leHBlY3RlZCA9IGFzc2VydHM7DQp9DQoNCi8qKg0KICogUmVzZXRzIHRoZSB0ZXN0IHNldHVwLiBVc2VmdWwgZm9yIHRlc3RzIHRoYXQgbW9kaWZ5IHRoZSBET00uDQogKi8NCmZ1bmN0aW9uIHJlc2V0KCkgew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJykuaW5uZXJIVE1MID0gX2NvbmZpZy5maXh0dXJlOw0KfQ0KDQovKioNCiAqIEFzc2VydHMgdHJ1ZS4NCiAqIEBleGFtcGxlIG9rKCAkKCJhIikuc2l6ZSgpID4gNSwgIlRoZXJlIG11c3QgYmUgYXQgbGVhc3QgNSBhbmNob3JzIiApOw0KICovDQpmdW5jdGlvbiBvayhhLCBtc2cpIHsNCglfY29uZmlnLlRlc3QucHVzaCggWyAhIWEsIG1zZyBdICk7DQp9DQoNCi8qKg0KICogQXNzZXJ0cyB0aGF0IHR3byBhcnJheXMgYXJlIHRoZSBzYW1lDQogKi8NCmZ1bmN0aW9uIGlzU2V0KGEsIGIsIG1zZykgew0KCXZhciByZXQgPSB0cnVlOw0KCWlmICggYSAmJiBiICYmIGEubGVuZ3RoICE9IHVuZGVmaW5lZCAmJiBhLmxlbmd0aCA9PSBiLmxlbmd0aCApIHsNCgkJZm9yICggdmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKyApDQoJCQlpZiAoIGFbaV0gIT0gYltpXSApDQoJCQkJcmV0ID0gZmFsc2U7DQoJfSBlbHNlDQoJCXJldCA9IGZhbHNlOw0KCWlmICggIXJldCApDQoJCV9jb25maWcuVGVzdC5wdXNoKCBbIHJldCwgbXNnICsgIiBleHBlY3RlZDogIiArIHNlcmlhbEFycmF5KGIpICsgIiByZXN1bHQ6ICIgKyBzZXJpYWxBcnJheShhKSBdICk7DQoJZWxzZSANCgkJX2NvbmZpZy5UZXN0LnB1c2goIFsgcmV0LCBtc2cgXSApOw0KfQ0KDQovKioNCiAqIEFzc2VydHMgdGhhdCB0d28gb2JqZWN0cyBhcmUgZXF1aXZhbGVudA0KICovDQpmdW5jdGlvbiBpc09iaihhLCBiLCBtc2cpIHsNCgl2YXIgcmV0ID0gdHJ1ZTsNCgkNCglpZiAoIGEgJiYgYiApIHsNCgkJZm9yICggdmFyIGkgaW4gYSApDQoJCQlpZiAoIGFbaV0gIT0gYltpXSApDQoJCQkJcmV0ID0gZmFsc2U7DQoNCgkJZm9yICggaSBpbiBiICkNCgkJCWlmICggYVtpXSAhPSBiW2ldICkNCgkJCQlyZXQgPSBmYWxzZTsNCgl9IGVsc2UNCgkJcmV0ID0gZmFsc2U7DQoNCiAgICBfY29uZmlnLlRlc3QucHVzaCggWyByZXQsIG1zZyBdICk7DQp9DQoNCmZ1bmN0aW9uIHNlcmlhbEFycmF5KCBhICkgew0KCXZhciByID0gW107DQoJDQoJaWYgKCBhICYmIGEubGVuZ3RoICkNCiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKyApIHsNCiAgICAgICAgICAgIHZhciBzdHIgPSBhW2ldLm5vZGVOYW1lOw0KICAgICAgICAgICAgaWYgKCBzdHIgKSB7DQogICAgICAgICAgICAgICAgc3RyID0gc3RyLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgaWYgKCBhW2ldLmlkICkNCiAgICAgICAgICAgICAgICAgICAgc3RyICs9ICIjIiArIGFbaV0uaWQ7DQogICAgICAgICAgICB9IGVsc2UNCiAgICAgICAgICAgICAgICBzdHIgPSBhW2ldOw0KICAgICAgICAgICAgci5wdXNoKCBzdHIgKTsNCiAgICAgICAgfQ0KDQoJcmV0dXJuICJbICIgKyByLmpvaW4oIiwgIikgKyAiIF0iDQp9DQoNCi8qKg0KICogUmV0dXJucyBhbiBhcnJheSBvZiBlbGVtZW50cyB3aXRoIHRoZSBnaXZlbiBJRHMsIGVnLg0KICogQGV4YW1wbGUgcSgibWFpbiIsICJmb28iLCAiYmFyIikNCiAqIEByZXN1bHQgWzxkaXYgaWQ9Im1haW4iPiwgPHNwYW4gaWQ9ImZvbyI+LCA8aW5wdXQgaWQ9ImJhciI+XQ0KICovDQpmdW5jdGlvbiBxKCkgew0KCXZhciByID0gW107DQoJZm9yICggdmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrICkNCgkJci5wdXNoKCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggYXJndW1lbnRzW2ldICkgKTsNCglyZXR1cm4gcjsNCn0NCg0KLyoqDQogKiBBc3NlcnRzIHRoYXQgYSBzZWxlY3QgbWF0Y2hlcyB0aGUgZ2l2ZW4gSURzDQogKiBAZXhhbXBsZSB0KCJDaGVjayBmb3Igc29tZXRoaW5nIiwgIi8vW2FdIiwgWyJmb28iLCAiYmFhciJdKTsNCiAqIEByZXN1bHQgcmV0dXJucyB0cnVlIGlmICIvL1thXSIgcmV0dXJuIHR3byBlbGVtZW50cyB3aXRoIHRoZSBJRHMgJ2ZvbycgYW5kICdiYWFyJw0KICovDQpmdW5jdGlvbiB0KGEsYixjKSB7DQoJdmFyIGYgPSBqUXVlcnkoYik7DQoJdmFyIHMgPSAiIjsNCglmb3IgKCB2YXIgaSA9IDA7IGkgPCBmLmxlbmd0aDsgaSsrICkNCgkJcyArPSAocyAmJiAiLCIpICsgJyInICsgZltpXS5pZCArICciJzsNCglpc1NldChmLCBxLmFwcGx5KHEsYyksIGEgKyAiICgiICsgYiArICIpIik7DQp9DQoNCi8qKg0KICogQWRkIHJhbmRvbSBudW1iZXIgdG8gdXJsIHRvIHN0b3AgSUUgZnJvbSBjYWNoaW5nDQogKg0KICogQGV4YW1wbGUgdXJsKCJkYXRhL3Rlc3QuaHRtbCIpDQogKiBAcmVzdWx0ICJkYXRhL3Rlc3QuaHRtbD8xMDUzODM1ODQyODk0MyINCiAqDQogKiBAZXhhbXBsZSB1cmwoImRhdGEvdGVzdC5waHA/Zm9vPWJhciIpDQogKiBAcmVzdWx0ICJkYXRhL3Rlc3QucGhwP2Zvbz1iYXImMTA1MzgzNTgzNDU1NTQiDQogKi8NCmZ1bmN0aW9uIHVybCh2YWx1ZSkgew0KCXJldHVybiB2YWx1ZSArICgvXD8vLnRlc3QodmFsdWUpID8gIiYiIDogIj8iKSArIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgIiIgKyBwYXJzZUludChNYXRoLnJhbmRvbSgpKjEwMDAwMCk7DQp9DQoNCi8qKg0KICogQ2hlY2tzIHRoYXQgdGhlIGZpcnN0IHR3byBhcmd1bWVudHMgYXJlIGVxdWFsLCB3aXRoIGFuIG9wdGlvbmFsIG1lc3NhZ2UuDQogKiBQcmludHMgb3V0IGJvdGggZXhwZWN0ZWQgYW5kIGFjdHVhbCB2YWx1ZXMgb24gZmFpbHVyZS4NCiAqDQogKiBQcmVmZXJlZCB0byBvayggZXhwZWN0ZWQgPT0gYWN0dWFsLCBtZXNzYWdlICkNCiAqDQogKiBAZXhhbXBsZSBlcXVhbHMoICJFeHBlY3RlZCAyIGNoYXJhY3RlcnMuIiwgdi5mb3JtYXRNZXNzYWdlKCJFeHBlY3RlZCB7MH0gY2hhcmFjdGVycy4iLCAyKSApOw0KICoNCiAqIEBwYXJhbSBPYmplY3QgZXhwZWN0ZWQNCiAqIEBwYXJhbSBPYmplY3QgYWN0dWFsDQogKiBAcGFyYW0gU3RyaW5nIG1lc3NhZ2UgKG9wdGlvbmFsKQ0KICovDQpmdW5jdGlvbiBlcXVhbHMoZXhwZWN0ZWQsIGFjdHVhbCwgbWVzc2FnZSkgew0KCXZhciByZXN1bHQgPSBleHBlY3RlZCA9PSBhY3R1YWw7DQoJbWVzc2FnZSA9IG1lc3NhZ2UgfHwgKHJlc3VsdCA/ICJva2F5IiA6ICJmYWlsZWQiKTsNCglfY29uZmlnLlRlc3QucHVzaCggWyByZXN1bHQsIHJlc3VsdCA/IG1lc3NhZ2UgKyAiOiAiICsgZXhwZWN0ZWQgOiBtZXNzYWdlICsgIiBleHBlY3RlZDogIiArIGV4cGVjdGVkICsgIiBhY3R1YWw6ICIgKyBhY3R1YWwgXSApOw0KfQ0KDQovKioNCiAqIFRyaWdnZXIgYW4gZXZlbnQgb24gYW4gZWxlbWVudC4NCiAqDQogKiBAZXhhbXBsZSB0cmlnZ2VyRXZlbnQoIGRvY3VtZW50LmJvZHksICJjbGljayIgKTsNCiAqDQogKiBAcGFyYW0gRE9NRWxlbWVudCBlbGVtDQogKiBAcGFyYW0gU3RyaW5nIHR5cGUNCiAqLw0KZnVuY3Rpb24gdHJpZ2dlckV2ZW50KCBlbGVtLCB0eXBlLCBldmVudCApIHsNCglpZiAoIGpRdWVyeS5icm93c2VyLm1vemlsbGEgfHwgalF1ZXJ5LmJyb3dzZXIub3BlcmEgKSB7DQoJCWV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoIk1vdXNlRXZlbnRzIik7DQoJCWV2ZW50LmluaXRNb3VzZUV2ZW50KHR5cGUsIHRydWUsIHRydWUsIGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldywNCgkJCTAsIDAsIDAsIDAsIDAsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAwLCBudWxsKTsNCgkJZWxlbS5kaXNwYXRjaEV2ZW50KCBldmVudCApOw0KCX0gZWxzZSBpZiAoIGpRdWVyeS5icm93c2VyLm1zaWUgKSB7DQoJCWVsZW0uZmlyZUV2ZW50KCJvbiIrdHlwZSk7DQoJfQ0KfQ0K",
                "body": "dmFyIF9jb25maWcgPSB7DQoJZml4dHVyZTogbnVsbCwNCglUZXN0OiBbXSwNCglzdGF0czogew0KCQlhbGw6IDAsDQoJCWJhZDogMA0KCX0sDQoJcXVldWU6IFtdLA0KCWJsb2NraW5nOiB0cnVlLA0KCXRpbWVvdXQ6IG51bGwsDQoJZXhwZWN0ZWQ6IG51bGwsDQoJY3VycmVudE1vZHVsZTogbnVsbCwNCglhc3luY1RpbWVvdXQ6IDIgLy8gc2Vjb25kcyBmb3IgYXN5bmMgdGltZW91dA0KfTsNCg0KJChmdW5jdGlvbigpIHsNCgkkKCcjdXNlckFnZW50JykuaHRtbChuYXZpZ2F0b3IudXNlckFnZW50KTsNCglydW5UZXN0KCk7CQ0KfSk7DQoNCmZ1bmN0aW9uIHN5bmNocm9uaXplKGNhbGxiYWNrKSB7DQoJX2NvbmZpZy5xdWV1ZVtfY29uZmlnLnF1ZXVlLmxlbmd0aF0gPSBjYWxsYmFjazsNCglpZighX2NvbmZpZy5ibG9ja2luZykgew0KCQlwcm9jZXNzKCk7DQoJfQ0KfQ0KDQpmdW5jdGlvbiBwcm9jZXNzKCkgew0KCXdoaWxlKF9jb25maWcucXVldWUubGVuZ3RoICYmICFfY29uZmlnLmJsb2NraW5nKSB7DQoJCXZhciBjYWxsID0gX2NvbmZpZy5xdWV1ZVswXTsNCgkJX2NvbmZpZy5xdWV1ZSA9IF9jb25maWcucXVldWUuc2xpY2UoMSk7DQoJCWNhbGwoKTsNCgl9DQp9DQoNCmZ1bmN0aW9uIHN0b3AoYWxsb3dGYWlsdXJlKSB7DQoJX2NvbmZpZy5ibG9ja2luZyA9IHRydWU7DQoJdmFyIGhhbmRsZXIgPSBhbGxvd0ZhaWx1cmUgPyBzdGFydCA6IGZ1bmN0aW9uKCkgew0KCQlvayggZmFsc2UsICJUZXN0IHRpbWVkIG91dCIgKTsNCgkJc3RhcnQoKTsNCgl9Ow0KCV9jb25maWcudGltZW91dCA9IHNldFRpbWVvdXQoaGFuZGxlciwgX2NvbmZpZy5hc3luY1RpbWVvdXQgKiAxMDAwKTsNCn0NCmZ1bmN0aW9uIHN0YXJ0KCkgew0KCWlmKF9jb25maWcudGltZW91dCkNCgkJY2xlYXJUaW1lb3V0KF9jb25maWcudGltZW91dCk7DQoJX2NvbmZpZy5ibG9ja2luZyA9IGZhbHNlOw0KCXByb2Nlc3MoKTsNCn0NCg0KZnVuY3Rpb24gcnVuVGVzdCgpIHsNCglfY29uZmlnLmJsb2NraW5nID0gZmFsc2U7DQoJdmFyIHRpbWUgPSBuZXcgRGF0ZSgpOw0KCV9jb25maWcuZml4dHVyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJykuaW5uZXJIVE1MOw0KCXJlc2V0KCk7DQoJc3luY2hyb25pemUoZnVuY3Rpb24oKSB7DQoJCXRpbWUgPSBuZXcgRGF0ZSgpIC0gdGltZTsNCgkJJCgiPGRpdj4iKS5odG1sKFsnPHAgY2xhc3M9InJlc3VsdCI+VGVzdHMgY29tcGxldGVkIGluICcsDQoJCQl0aW1lLCAnIG1pbGxpc2Vjb25kcy48YnIvPicsDQoJCQlfY29uZmlnLnN0YXRzLmJhZCwgJyB0ZXN0cyBvZiAnLCBfY29uZmlnLnN0YXRzLmFsbCwgJyBmYWlsZWQuPC9wPiddDQoJCQkuam9pbignJykpDQoJCQkuYXBwZW5kVG8oImJvZHkiKTsNCgkJJCgiI2Jhbm5lciIpLmFkZENsYXNzKF9jb25maWcuc3RhdHMuYmFkID8gImZhaWwiIDogInBhc3MiKTsNCgl9KTsNCn0NCg0KZnVuY3Rpb24gdGVzdChuYW1lLCBjYWxsYmFjaywgbm93YWl0KSB7DQoJaWYoX2NvbmZpZy5jdXJyZW50TW9kdWxlKQ0KCQluYW1lID0gX2NvbmZpZy5jdXJyZW50TW9kdWxlICsgIiBtb2R1bGU6ICIgKyBuYW1lOw0KCQkNCgl2YXIgZmlsdGVyID0gbG9jYXRpb24uc2VhcmNoLnNsaWNlKDEpOw0KCWlmICggZmlsdGVyICYmIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSAhPSBmaWx0ZXIgKQ0KCQlyZXR1cm47DQoJCQ0KCXN5bmNocm9uaXplKGZ1bmN0aW9uKCkgew0KCQlfY29uZmlnLlRlc3QgPSBbXTsNCgkJdHJ5IHsNCgkJCWNhbGxiYWNrKCk7DQoJCX0gY2F0Y2goZSkgew0KCQkJaWYoIHR5cGVvZiBjb25zb2xlICE9ICJ1bmRlZmluZWQiICYmIGNvbnNvbGUuZXJyb3IgJiYgY29uc29sZS53YXJuICkgew0KCQkJCWNvbnNvbGUuZXJyb3IoIlRlc3QgIiArIG5hbWUgKyAiIGRpZWQsIGV4Y2VwdGlvbiBhbmQgdGVzdCBmb2xsb3dzIik7DQoJCQkJY29uc29sZS5lcnJvcihlKTsNCgkJCQljb25zb2xlLndhcm4oY2FsbGJhY2sudG9TdHJpbmcoKSk7DQoJCQl9DQoJCQlfY29uZmlnLlRlc3QucHVzaCggWyBmYWxzZSwgIkRpZWQgb24gdGVzdCAjIiArIChfY29uZmlnLlRlc3QubGVuZ3RoKzEpICsgIjogIiArIGUgXSApOw0KCQkJLy90aHJvdyBlOw0KCQl9DQoJfSk7DQoJc3luY2hyb25pemUoZnVuY3Rpb24oKSB7DQoJCXJlc2V0KCk7DQoJCQ0KCQkvLyBkb24ndCBvdXRwdXQgcGF1c2UgdGVzdHMNCgkJaWYobm93YWl0KSByZXR1cm47DQoJCQ0KCQlpZihfY29uZmlnLmV4cGVjdGVkICYmIF9jb25maWcuZXhwZWN0ZWQgIT0gX2NvbmZpZy5UZXN0Lmxlbmd0aCkgew0KCQkJX2NvbmZpZy5UZXN0LnB1c2goIFsgZmFsc2UsICJFeHBlY3RlZCAiICsgX2NvbmZpZy5leHBlY3RlZCArICIgYXNzZXJ0aW9ucywgYnV0ICIgKyBfY29uZmlnLlRlc3QubGVuZ3RoICsgIiB3ZXJlIHJ1biIgXSApOw0KCQl9DQoJCV9jb25maWcuZXhwZWN0ZWQgPSBudWxsOw0KCQkNCgkJdmFyIGdvb2QgPSAwLCBiYWQgPSAwOw0KCQl2YXIgb2wgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvbCIpOw0KCQlvbC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KCQl2YXIgbGkgPSAiIiwgc3RhdGUgPSAicGFzcyI7DQoJCWZvciAoIHZhciBpID0gMDsgaSA8IF9jb25maWcuVGVzdC5sZW5ndGg7IGkrKyApIHsNCgkJCXZhciBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpIik7DQoJCQlsaS5jbGFzc05hbWUgPSBfY29uZmlnLlRlc3RbaV1bMF0gPyAicGFzcyIgOiAiZmFpbCI7DQoJCQlsaS5pbm5lckhUTUwgPSBfY29uZmlnLlRlc3RbaV1bMV07DQoJCQlvbC5hcHBlbmRDaGlsZCggbGkgKTsNCgkJCQ0KCQkJX2NvbmZpZy5zdGF0cy5hbGwrKzsNCgkJCWlmICggIV9jb25maWcuVGVzdFtpXVswXSApIHsNCgkJCQlzdGF0ZSA9ICJmYWlsIjsNCgkJCQliYWQrKzsNCgkJCQlfY29uZmlnLnN0YXRzLmJhZCsrOw0KCQkJfSBlbHNlIGdvb2QrKzsNCgkJfQ0KCQ0KCQl2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaSIpOw0KCQlsaS5jbGFzc05hbWUgPSBzdGF0ZTsNCgkNCgkJdmFyIGIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHJvbmciKTsNCgkJYi5pbm5lckhUTUwgPSBuYW1lICsgIiA8YiBzdHlsZT0nY29sb3I6YmxhY2s7Jz4oPGIgY2xhc3M9J2ZhaWwnPiIgKyBiYWQgKyAiPC9iPiwgPGIgY2xhc3M9J3Bhc3MnPiIgKyBnb29kICsgIjwvYj4sICIgKyBfY29uZmlnLlRlc3QubGVuZ3RoICsgIik8L2I+IjsNCgkJYi5vbmNsaWNrID0gZnVuY3Rpb24oKXsNCgkJCXZhciBuID0gdGhpcy5uZXh0U2libGluZzsNCgkJCWlmICggalF1ZXJ5LmNzcyggbiwgImRpc3BsYXkiICkgPT0gIm5vbmUiICkNCgkJCQluLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOw0KCQkJZWxzZQ0KCQkJCW4uc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCgkJfTsNCgkJJChiKS5kYmxjbGljayhmdW5jdGlvbihldmVudCkgew0KCQkJdmFyIHRhcmdldCA9IGpRdWVyeShldmVudC50YXJnZXQpLmZpbHRlcigic3Ryb25nIikuY2xvbmUoKTsNCgkJCWlmICggdGFyZ2V0Lmxlbmd0aCApIHsNCgkJCQl0YXJnZXQuY2hpbGRyZW4oKS5yZW1vdmUoKTsNCgkJCQlsb2NhdGlvbi5ocmVmID0gbG9jYXRpb24uaHJlZi5tYXRjaCgvXiguKz8pKFw/LiopPyQvKVsxXSArICI/IiArIGVuY29kZVVSSUNvbXBvbmVudCgkLnRyaW0odGFyZ2V0LnRleHQoKSkpOw0KCQkJfQ0KCQl9KTsNCgkJbGkuYXBwZW5kQ2hpbGQoIGIgKTsNCgkJbGkuYXBwZW5kQ2hpbGQoIG9sICk7DQoJDQoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0ZXN0cyIpLmFwcGVuZENoaWxkKCBsaSApOwkJDQoJfSk7DQp9DQoNCi8vIGNhbGwgb24gc3RhcnQgb2YgbW9kdWxlIHRlc3QgdG8gcHJlcGVuZCBuYW1lIHRvIGFsbCB0ZXN0cw0KZnVuY3Rpb24gbW9kdWxlKG1vZHVsZU5hbWUpIHsNCglfY29uZmlnLmN1cnJlbnRNb2R1bGUgPSBtb2R1bGVOYW1lOw0KfQ0KDQovKioNCiAqIFNwZWNpZnkgdGhlIG51bWJlciBvZiBleHBlY3RlZCBhc3NlcnRpb25zIHRvIGd1cmFudGVlIHRoYXQgZmFpbGVkIHRlc3QgKG5vIGFzc2VydGlvbnMgYXJlIHJ1biBhdCBhbGwpIGRvbid0IHNsaXAgdGhyb3VnaC4NCiAqLw0KZnVuY3Rpb24gZXhwZWN0KGFzc2VydHMpIHsNCglfY29uZmlnLmV4cGVjdGVkID0gYXNzZXJ0czsNCn0NCg0KLyoqDQogKiBSZXNldHMgdGhlIHRlc3Qgc2V0dXAuIFVzZWZ1bCBmb3IgdGVzdHMgdGhhdCBtb2RpZnkgdGhlIERPTS4NCiAqLw0KZnVuY3Rpb24gcmVzZXQoKSB7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKS5pbm5lckhUTUwgPSBfY29uZmlnLmZpeHR1cmU7DQp9DQoNCi8qKg0KICogQXNzZXJ0cyB0cnVlLg0KICogQGV4YW1wbGUgb2soICQoImEiKS5zaXplKCkgPiA1LCAiVGhlcmUgbXVzdCBiZSBhdCBsZWFzdCA1IGFuY2hvcnMiICk7DQogKi8NCmZ1bmN0aW9uIG9rKGEsIG1zZykgew0KCV9jb25maWcuVGVzdC5wdXNoKCBbICEhYSwgbXNnIF0gKTsNCn0NCg0KLyoqDQogKiBBc3NlcnRzIHRoYXQgdHdvIGFycmF5cyBhcmUgdGhlIHNhbWUNCiAqLw0KZnVuY3Rpb24gaXNTZXQoYSwgYiwgbXNnKSB7DQoJdmFyIHJldCA9IHRydWU7DQoJaWYgKCBhICYmIGIgJiYgYS5sZW5ndGggIT0gdW5kZWZpbmVkICYmIGEubGVuZ3RoID09IGIubGVuZ3RoICkgew0KCQlmb3IgKCB2YXIgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrICkNCgkJCWlmICggYVtpXSAhPSBiW2ldICkNCgkJCQlyZXQgPSBmYWxzZTsNCgl9IGVsc2UNCgkJcmV0ID0gZmFsc2U7DQoJaWYgKCAhcmV0ICkNCgkJX2NvbmZpZy5UZXN0LnB1c2goIFsgcmV0LCBtc2cgKyAiIGV4cGVjdGVkOiAiICsgc2VyaWFsQXJyYXkoYikgKyAiIHJlc3VsdDogIiArIHNlcmlhbEFycmF5KGEpIF0gKTsNCgllbHNlIA0KCQlfY29uZmlnLlRlc3QucHVzaCggWyByZXQsIG1zZyBdICk7DQp9DQoNCi8qKg0KICogQXNzZXJ0cyB0aGF0IHR3byBvYmplY3RzIGFyZSBlcXVpdmFsZW50DQogKi8NCmZ1bmN0aW9uIGlzT2JqKGEsIGIsIG1zZykgew0KCXZhciByZXQgPSB0cnVlOw0KCQ0KCWlmICggYSAmJiBiICkgew0KCQlmb3IgKCB2YXIgaSBpbiBhICkNCgkJCWlmICggYVtpXSAhPSBiW2ldICkNCgkJCQlyZXQgPSBmYWxzZTsNCg0KCQlmb3IgKCBpIGluIGIgKQ0KCQkJaWYgKCBhW2ldICE9IGJbaV0gKQ0KCQkJCXJldCA9IGZhbHNlOw0KCX0gZWxzZQ0KCQlyZXQgPSBmYWxzZTsNCg0KICAgIF9jb25maWcuVGVzdC5wdXNoKCBbIHJldCwgbXNnIF0gKTsNCn0NCg0KZnVuY3Rpb24gc2VyaWFsQXJyYXkoIGEgKSB7DQoJdmFyIHIgPSBbXTsNCgkNCglpZiAoIGEgJiYgYS5sZW5ndGggKQ0KICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrICkgew0KICAgICAgICAgICAgdmFyIHN0ciA9IGFbaV0ubm9kZU5hbWU7DQogICAgICAgICAgICBpZiAoIHN0ciApIHsNCiAgICAgICAgICAgICAgICBzdHIgPSBzdHIudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgICAgICBpZiAoIGFbaV0uaWQgKQ0KICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIiMiICsgYVtpXS5pZDsNCiAgICAgICAgICAgIH0gZWxzZQ0KICAgICAgICAgICAgICAgIHN0ciA9IGFbaV07DQogICAgICAgICAgICByLnB1c2goIHN0ciApOw0KICAgICAgICB9DQoNCglyZXR1cm4gIlsgIiArIHIuam9pbigiLCAiKSArICIgXSINCn0NCg0KLyoqDQogKiBSZXR1cm5zIGFuIGFycmF5IG9mIGVsZW1lbnRzIHdpdGggdGhlIGdpdmVuIElEcywgZWcuDQogKiBAZXhhbXBsZSBxKCJtYWluIiwgImZvbyIsICJiYXIiKQ0KICogQHJlc3VsdCBbPGRpdiBpZD0ibWFpbiI+LCA8c3BhbiBpZD0iZm9vIj4sIDxpbnB1dCBpZD0iYmFyIj5dDQogKi8NCmZ1bmN0aW9uIHEoKSB7DQoJdmFyIHIgPSBbXTsNCglmb3IgKCB2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKysgKQ0KCQlyLnB1c2goIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBhcmd1bWVudHNbaV0gKSApOw0KCXJldHVybiByOw0KfQ0KDQovKioNCiAqIEFzc2VydHMgdGhhdCBhIHNlbGVjdCBtYXRjaGVzIHRoZSBnaXZlbiBJRHMNCiAqIEBleGFtcGxlIHQoIkNoZWNrIGZvciBzb21ldGhpbmciLCAiLy9bYV0iLCBbImZvbyIsICJiYWFyIl0pOw0KICogQHJlc3VsdCByZXR1cm5zIHRydWUgaWYgIi8vW2FdIiByZXR1cm4gdHdvIGVsZW1lbnRzIHdpdGggdGhlIElEcyAnZm9vJyBhbmQgJ2JhYXInDQogKi8NCmZ1bmN0aW9uIHQoYSxiLGMpIHsNCgl2YXIgZiA9IGpRdWVyeShiKTsNCgl2YXIgcyA9ICIiOw0KCWZvciAoIHZhciBpID0gMDsgaSA8IGYubGVuZ3RoOyBpKysgKQ0KCQlzICs9IChzICYmICIsIikgKyAnIicgKyBmW2ldLmlkICsgJyInOw0KCWlzU2V0KGYsIHEuYXBwbHkocSxjKSwgYSArICIgKCIgKyBiICsgIikiKTsNCn0NCg0KLyoqDQogKiBBZGQgcmFuZG9tIG51bWJlciB0byB1cmwgdG8gc3RvcCBJRSBmcm9tIGNhY2hpbmcNCiAqDQogKiBAZXhhbXBsZSB1cmwoImRhdGEvdGVzdC5odG1sIikNCiAqIEByZXN1bHQgImRhdGEvdGVzdC5odG1sPzEwNTM4MzU4NDI4OTQzIg0KICoNCiAqIEBleGFtcGxlIHVybCgiZGF0YS90ZXN0LnBocD9mb289YmFyIikNCiAqIEByZXN1bHQgImRhdGEvdGVzdC5waHA/Zm9vPWJhciYxMDUzODM1ODM0NTU1NCINCiAqLw0KZnVuY3Rpb24gdXJsKHZhbHVlKSB7DQoJcmV0dXJuIHZhbHVlICsgKC9cPy8udGVzdCh2YWx1ZSkgPyAiJiIgOiAiPyIpICsgbmV3IERhdGUoKS5nZXRUaW1lKCkgKyAiIiArIHBhcnNlSW50KE1hdGgucmFuZG9tKCkqMTAwMDAwKTsNCn0NCg0KLyoqDQogKiBDaGVja3MgdGhhdCB0aGUgZmlyc3QgdHdvIGFyZ3VtZW50cyBhcmUgZXF1YWwsIHdpdGggYW4gb3B0aW9uYWwgbWVzc2FnZS4NCiAqIFByaW50cyBvdXQgYm90aCBleHBlY3RlZCBhbmQgYWN0dWFsIHZhbHVlcyBvbiBmYWlsdXJlLg0KICoNCiAqIFByZWZlcmVkIHRvIG9rKCBleHBlY3RlZCA9PSBhY3R1YWwsIG1lc3NhZ2UgKQ0KICoNCiAqIEBleGFtcGxlIGVxdWFscyggIkV4cGVjdGVkIDIgY2hhcmFjdGVycy4iLCB2LmZvcm1hdE1lc3NhZ2UoIkV4cGVjdGVkIHswfSBjaGFyYWN0ZXJzLiIsIDIpICk7DQogKg0KICogQHBhcmFtIE9iamVjdCBleHBlY3RlZA0KICogQHBhcmFtIE9iamVjdCBhY3R1YWwNCiAqIEBwYXJhbSBTdHJpbmcgbWVzc2FnZSAob3B0aW9uYWwpDQogKi8NCmZ1bmN0aW9uIGVxdWFscyhleHBlY3RlZCwgYWN0dWFsLCBtZXNzYWdlKSB7DQoJdmFyIHJlc3VsdCA9IGV4cGVjdGVkID09IGFjdHVhbDsNCgltZXNzYWdlID0gbWVzc2FnZSB8fCAocmVzdWx0ID8gIm9rYXkiIDogImZhaWxlZCIpOw0KCV9jb25maWcuVGVzdC5wdXNoKCBbIHJlc3VsdCwgcmVzdWx0ID8gbWVzc2FnZSArICI6ICIgKyBleHBlY3RlZCA6IG1lc3NhZ2UgKyAiIGV4cGVjdGVkOiAiICsgZXhwZWN0ZWQgKyAiIGFjdHVhbDogIiArIGFjdHVhbCBdICk7DQp9DQoNCi8qKg0KICogVHJpZ2dlciBhbiBldmVudCBvbiBhbiBlbGVtZW50Lg0KICoNCiAqIEBleGFtcGxlIHRyaWdnZXJFdmVudCggZG9jdW1lbnQuYm9keSwgImNsaWNrIiApOw0KICoNCiAqIEBwYXJhbSBET01FbGVtZW50IGVsZW0NCiAqIEBwYXJhbSBTdHJpbmcgdHlwZQ0KICovDQpmdW5jdGlvbiB0cmlnZ2VyRXZlbnQoIGVsZW0sIHR5cGUsIGV2ZW50ICkgew0KCWlmICggalF1ZXJ5LmJyb3dzZXIubW96aWxsYSB8fCBqUXVlcnkuYnJvd3Nlci5vcGVyYSApIHsNCgkJZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgiTW91c2VFdmVudHMiKTsNCgkJZXZlbnQuaW5pdE1vdXNlRXZlbnQodHlwZSwgdHJ1ZSwgdHJ1ZSwgZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LA0KCQkJMCwgMCwgMCwgMCwgMCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIG51bGwpOw0KCQllbGVtLmRpc3BhdGNoRXZlbnQoIGV2ZW50ICk7DQoJfSBlbHNlIGlmICggalF1ZXJ5LmJyb3dzZXIubXNpZSApIHsNCgkJZWxlbS5maXJlRXZlbnQoIm9uIit0eXBlKTsNCgl9DQp9DQo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 06:43:35 GMT",
                    "Content-Length": "7955",
                    "Date": "Fri, 07 Nov 2014 06:43:35 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}