{
    "url": "http://localhost:9999/oyvindkinsey/easyXDM/src/example/bridge.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>location.href</b> and written to <b>location.href</b> via the following statements:<ul><li>var remote = location.href;</li><li>location.href = remote.replace(\"provider\", \"consumer\");</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/oyvindkinsey/easyXDM/src/example/bridge.html",
                "path": "/oyvindkinsey/easyXDM/src/example/bridge.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9veXZpbmRraW5zZXkvZWFzeVhETS9zcmMvZXhhbXBsZS9icmlkZ2UuaHRtbCBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjIzNQ0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBUaHUsIDA2IE5vdiAyMDE0IDIyOjIzOjEyIEdNVA0KTGFzdC1Nb2RpZmllZDogVGh1LCAwNiBOb3YgMjAxNCAyMjoyMzoxMSBHTVQNCg0KPCFkb2N0eXBlIGh0bWw+CjxodG1sPgogICAgPGhlYWQ+CiAgICAgICAgPHRpdGxlPmVhc3lYRE08L3RpdGxlPgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Ii4uL2Vhc3lYRE0uZGVidWcuanMiPgogICAgICAgIDwvc2NyaXB0PgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIFJlcXVlc3QgdGhlIHVzZSBvZiB0aGUgSlNPTiBvYmplY3QKICAgICAgICAgICAgICovCiAgICAgICAgICAgIGVhc3lYRE0uRG9tSGVscGVyLnJlcXVpcmVzSlNPTigiLi4vanNvbjIuanMiKTsKICAgICAgICA8L3NjcmlwdD4KICAgICAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICAgICAgICAgIC8qIEhlcmUgd2UgZGVtbyBob3cgdG8gaGF2ZSB0d28gdmlzaWJsZSB3ZWIgYXBwbGljYXRpb25zIGNvbW11bmljYXRlIHRvZ2V0aGVyLgogICAgICAgICAgICAgKiBUaGlzIGlzIGRvbmUgYnkgaGF2aW5nIHRoZSByZW1vdGUgaW50ZXJmYWNlIG9wZW4gYSB2aXNpYmxlIHdpbmRvdyBhbmQgbG9hZGluZwogICAgICAgICAgICAgKiB0aGUgYXBwbGljYXRpb24gaW4gdGhpcy4KICAgICAgICAgICAgICogU2luY2UgdGhlIHJlbW90ZSBpbnRlcmZhY2UgaGFzIGFjY2VzcyB0byB0aGUgZW50aXJlIERPTSAoaW5jbHVkaW5nIGphdmFzY3JpcHQpCiAgICAgICAgICAgICAqIG9mIHRoZSBvcGVuZWQgd2luZG93LCB0aGUgcmVtb3RlIGludGVyZmFjZSBpcyBhYmxlIHRvIGludGVyZmFjZSBmcmVlbHkgd2l0aCB0aGUKICAgICAgICAgICAgICogcmVtb3RlIHdlYiBhcHBsaWNhdGlvbiBhbmQgY2FuIHNlcnZlIGFzIGEgYnJpZGdlIGJldHdlZW4gdGhlIHR3byBhcHBsaWNhdGlvbnMuCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB2YXIgUkVNT1RFID0gKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlID0gbG9jYXRpb24uaHJlZjsKICAgICAgICAgICAgICAgIHN3aXRjaCAobG9jYXRpb24uaG9zdCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgInByb3ZpZGVyLmVhc3l4ZG0ubmV0IjoKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IHJlbW90ZS5yZXBsYWNlKCJwcm92aWRlciIsICJjb25zdW1lciIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICJlYXN5eGRtLm5ldCI6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSA9IHJlbW90ZS5yZXBsYWNlKCJlYXN5eGRtLm5ldCIsICJjb25zdW1lci5lYXN5eGRtLm5ldCIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICJjb25zdW1lci5lYXN5eGRtLm5ldCI6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSA9IHJlbW90ZS5yZXBsYWNlKCJjb25zdW1lciIsICJwcm92aWRlciIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICJ4ZG0xIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlID0gcmVtb3RlLnJlcGxhY2UoInhkbTEiLCAieGRtMiIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGUuc3Vic3RyaW5nKDAsIHJlbW90ZS5sYXN0SW5kZXhPZigiLyIpKTsKICAgICAgICAgICAgfSgpKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwcm94eSwgd2luOwogICAgICAgICAgICBmdW5jdGlvbiBvcGVuUG9wdXAoKXsKICAgICAgICAgICAgICAgIGlmICh3aW4pIHsKICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGFsbG93cyB0byBvcGVuIG5ldyB3aW5kb3dzIGlmIHRoZSBwb3B1cCB3YXMgY2xvc2VkCiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbi5jbG9zZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luID0gd2luZG93Lm9wZW4oUkVNT1RFICsgJy9ibGFuay5odG1sJywgJ21haW5hcHAnLCAid2lkdGg9NDAwLCBoZWlnaHQ9NDAwIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHByb3h5Lm9wZW4oIm1haW5hcHAiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gb3BlbiB1cCB0aGUgcG9wdXAgCiAgICAgICAgICAgICAgICB3aW4gPSB3aW5kb3cub3BlbihSRU1PVEUgKyAnL2JsYW5rLmh0bWwnLCAnbWFpbmFwcCcsICJ3aWR0aD00MDAsIGhlaWdodD00MDAiKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ0biIpLmRpc2FibGVkID0gIiI7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHByb3h5ID0gbmV3IGVhc3lYRE0uUnBjKC8qKiBUaGUgY29uZmlndXJhdGlvbiAqL3sKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBSZWdpc3RlciB0aGUgdXJsIHRvIG5hbWUuaHRtbCwgdGhpcyBtdXN0IGJlIGFuIGFic29sdXRlIHBhdGgKICAgICAgICAgICAgICAgICAgICAgKiBvciBhIHBhdGggcmVsYXRpdmUgdG8gdGhlIHJvb3QuCiAgICAgICAgICAgICAgICAgICAgICogQGZpZWxkCiAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgbG9jYWw6ICIuLi9uYW1lLmh0bWwiLAogICAgICAgICAgICAgICAgICAgIHN3ZjogUkVNT1RFICsgIi8uLi9lYXN5eGRtLnN3ZiIsCiAgICAgICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgICAgICogUmVnaXN0ZXIgdGhlIHVybCB0byB0aGUgcmVtb3RlIGludGVyZmFjZQogICAgICAgICAgICAgICAgICAgICAqIEBmaWVsZAogICAgICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgIHJlbW90ZTogUkVNT1RFICsgIi9yZW1vdGUuaHRtbCIsCiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSGVscGVyOiBSRU1PVEUgKyAiLy4uL25hbWUuaHRtbCIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICByZW1vdGU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgb3Blbjoge30sCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RNZXNzYWdlOiB7fQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgbG9jYWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAqIFJlZ2lzdGVyIHRoZSBtZXRob2QgdGhhdCBzaG91bGQgaGFuZGxlIGluY29taW5nIGRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG9yaWdpbgogICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICAgICAgcG9zdE1lc3NhZ2U6IGZ1bmN0aW9uKGRhdGEpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9ICJkYXRhIGZyb20gJyIgKyBwcm94eS5vcmlnaW4gKyAiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBrZXkgKyAiPSIgKyBkYXRhW2tleV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gbGV0cyB0ZWxsIHRoZSBwcm94eSB0byBvcGVuIHVwIHRoZSB3aW5kb3cgYXMgc29vbiBhcyBwb3NzaWJsZQogICAgICAgICAgICAgICAgcHJveHkub3BlbigibWFpbmFwcCIpOwogICAgICAgICAgICB9CiAgICAgICAgPC9zY3JpcHQ+CiAgICA8L2hlYWQ+CiAgICA8Ym9keT4KICAgICAgICA8ZGl2IHN0eWxlPSJib3JkZXI6MXB4IHNvbGlkIGJsYWNrO3BhZGRpbmc6M3B4O21hcmdpbjoxMHB4OyI+CiAgICAgICAgICAgIDxhIGhyZWY9ImluZGV4Lmh0bWwiPkluZGV4IG9mIGV4YW1wbGVzPC9hPgogICAgICAgICAgICB8IDxhIGhyZWY9Imh0dHA6Ly9naXRodWIuY29tL295dmluZGtpbnNleS9lYXN5WERNLyNyZWFkbWUiPlJlYWRtZSBhdCBnaXRodWI8L2E+CiAgICAgICAgICAgIHwgCiAgICAgICAgICAgIHwgPGEgaHJlZj0iaHR0cDovL2Vhc3l4ZG0ubmV0LyI+ZWFzeVhETS5uZXQ8L2E+CiAgICAgICAgICAgIHwgPGEgaHJlZj0iaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL2Vhc3l4ZG0iPmVhc3lYRE0gYXQgR29vZ2xlIEdyb3VwczwvYT4KICAgICAgICAgICAgPGJyLz4KICAgICAgICAgICAgVGhlIGV4YW1wbGVzIGFyZSBleGVjdXRpbmcgc2xvd2VyIHRoYW4gdGhlIHByb2R1Y3Rpb24gYnVpbGQgZHVlIHRvIHRoZSBleHRlbnNpdmUgdHJhY2luZy4KICAgICAgICAgICAgPGJyLz4KICAgICAgICAgICAgSWYgeW91IGFyZSBhbGVydGVkIGFib3V0IGEgcG9wdXAsIHRoZW4gdGhpcyBpcyBvbmx5IHRoZSB0cmFjZSBsb2cgZmVhdHVyZS4gWW91IGNhbiBpZ25vcmUgdGhpcy4KICAgICAgICA8L2Rpdj4KICAgICAgICA8IS0tIGVhc3lYRE0uRGVidWcudHJhY2UobXNnKSB3aWxsIG91dHB1dCBpdHMgbWVzc2FnZXMgdG8gYW55IGVsZW1lbnQgd2l0aCB0aGUgaWQgImxvZyIgLS0+CiAgICAgICAgPGRpdiBpZD0ibG9nIiBzdHlsZT0iaGVpZ2h0OjEwMHB4O2JvcmRlcjoxcHggZG90dGVkIGJsYWNrO292ZXJmbG93OmF1dG8iPgogICAgICAgIDwvZGl2PgogICAgICAgIDxpbnB1dCBpZD0iYnRuT3BlbiIgdHlwZT0iYnV0dG9uIiBvbmNsaWNrPSJvcGVuUG9wdXAoKTsiIHZhbHVlPSJPcGVuIHBvcHVwIi8+PCEtLSBTZW5kIHNvbSBkYXRhIHRvIHRoZSBvdGhlciBzaWRlIC0tPjxpbnB1dCBpZD0iYnRuIiBkaXNhYmxlZD0iZGlzYWJsZWQiIHR5cGU9ImJ1dHRvbiIgb25jbGljaz0icHJveHkucG9zdE1lc3NhZ2Uoe2E6J2InLGM6J2QnLGU6J2YnfSk7IiB2YWx1ZT0ic2VuZCBkYXRhIHRvIHJlbW90ZSIvPgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICAgICAgdmFyIGdhSnNIb3N0ID0gKCgiaHR0cHM6IiA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCkgPyAiaHR0cHM6Ly9zc2wuIiA6ICJodHRwOi8vd3d3LiIpOwogICAgICAgICAgICBkb2N1bWVudC53cml0ZSh1bmVzY2FwZSgiJTNDc2NyaXB0IHNyYz0nIiArIGdhSnNIb3N0ICsgImdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJyB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnJTNFJTNDL3NjcmlwdCUzRSIpKTsKICAgICAgICA8L3NjcmlwdD4KICAgICAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICAgICAgICAgIGlmIChsb2NhdGlvbi5ob3N0LmluZGV4T2YoImVhc3l4ZG0ubmV0IikgIT09IC0xKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHZhciBwYWdlVHJhY2tlciA9IF9nYXQuX2dldFRyYWNrZXIoIlVBLTk1MzU1OTEtMyIpOwogICAgICAgICAgICAgICAgICAgIHBhZ2VUcmFja2VyLl9zZXREb21haW5OYW1lKCIuZWFzeXhkbS5uZXQiKTsKICAgICAgICAgICAgICAgICAgICBwYWdlVHJhY2tlci5fdHJhY2tQYWdldmlldygpOwogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIDwvc2NyaXB0PgogICAgPC9ib2R5Pgo8L2h0bWw+Cg==",
                "body": "PCFkb2N0eXBlIGh0bWw+CjxodG1sPgogICAgPGhlYWQ+CiAgICAgICAgPHRpdGxlPmVhc3lYRE08L3RpdGxlPgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Ii4uL2Vhc3lYRE0uZGVidWcuanMiPgogICAgICAgIDwvc2NyaXB0PgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIFJlcXVlc3QgdGhlIHVzZSBvZiB0aGUgSlNPTiBvYmplY3QKICAgICAgICAgICAgICovCiAgICAgICAgICAgIGVhc3lYRE0uRG9tSGVscGVyLnJlcXVpcmVzSlNPTigiLi4vanNvbjIuanMiKTsKICAgICAgICA8L3NjcmlwdD4KICAgICAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICAgICAgICAgIC8qIEhlcmUgd2UgZGVtbyBob3cgdG8gaGF2ZSB0d28gdmlzaWJsZSB3ZWIgYXBwbGljYXRpb25zIGNvbW11bmljYXRlIHRvZ2V0aGVyLgogICAgICAgICAgICAgKiBUaGlzIGlzIGRvbmUgYnkgaGF2aW5nIHRoZSByZW1vdGUgaW50ZXJmYWNlIG9wZW4gYSB2aXNpYmxlIHdpbmRvdyBhbmQgbG9hZGluZwogICAgICAgICAgICAgKiB0aGUgYXBwbGljYXRpb24gaW4gdGhpcy4KICAgICAgICAgICAgICogU2luY2UgdGhlIHJlbW90ZSBpbnRlcmZhY2UgaGFzIGFjY2VzcyB0byB0aGUgZW50aXJlIERPTSAoaW5jbHVkaW5nIGphdmFzY3JpcHQpCiAgICAgICAgICAgICAqIG9mIHRoZSBvcGVuZWQgd2luZG93LCB0aGUgcmVtb3RlIGludGVyZmFjZSBpcyBhYmxlIHRvIGludGVyZmFjZSBmcmVlbHkgd2l0aCB0aGUKICAgICAgICAgICAgICogcmVtb3RlIHdlYiBhcHBsaWNhdGlvbiBhbmQgY2FuIHNlcnZlIGFzIGEgYnJpZGdlIGJldHdlZW4gdGhlIHR3byBhcHBsaWNhdGlvbnMuCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB2YXIgUkVNT1RFID0gKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlID0gbG9jYXRpb24uaHJlZjsKICAgICAgICAgICAgICAgIHN3aXRjaCAobG9jYXRpb24uaG9zdCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgInByb3ZpZGVyLmVhc3l4ZG0ubmV0IjoKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IHJlbW90ZS5yZXBsYWNlKCJwcm92aWRlciIsICJjb25zdW1lciIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICJlYXN5eGRtLm5ldCI6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSA9IHJlbW90ZS5yZXBsYWNlKCJlYXN5eGRtLm5ldCIsICJjb25zdW1lci5lYXN5eGRtLm5ldCIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICJjb25zdW1lci5lYXN5eGRtLm5ldCI6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSA9IHJlbW90ZS5yZXBsYWNlKCJjb25zdW1lciIsICJwcm92aWRlciIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICJ4ZG0xIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlID0gcmVtb3RlLnJlcGxhY2UoInhkbTEiLCAieGRtMiIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGUuc3Vic3RyaW5nKDAsIHJlbW90ZS5sYXN0SW5kZXhPZigiLyIpKTsKICAgICAgICAgICAgfSgpKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwcm94eSwgd2luOwogICAgICAgICAgICBmdW5jdGlvbiBvcGVuUG9wdXAoKXsKICAgICAgICAgICAgICAgIGlmICh3aW4pIHsKICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGFsbG93cyB0byBvcGVuIG5ldyB3aW5kb3dzIGlmIHRoZSBwb3B1cCB3YXMgY2xvc2VkCiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbi5jbG9zZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luID0gd2luZG93Lm9wZW4oUkVNT1RFICsgJy9ibGFuay5odG1sJywgJ21haW5hcHAnLCAid2lkdGg9NDAwLCBoZWlnaHQ9NDAwIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHByb3h5Lm9wZW4oIm1haW5hcHAiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gb3BlbiB1cCB0aGUgcG9wdXAgCiAgICAgICAgICAgICAgICB3aW4gPSB3aW5kb3cub3BlbihSRU1PVEUgKyAnL2JsYW5rLmh0bWwnLCAnbWFpbmFwcCcsICJ3aWR0aD00MDAsIGhlaWdodD00MDAiKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ0biIpLmRpc2FibGVkID0gIiI7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHByb3h5ID0gbmV3IGVhc3lYRE0uUnBjKC8qKiBUaGUgY29uZmlndXJhdGlvbiAqL3sKICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgKiBSZWdpc3RlciB0aGUgdXJsIHRvIG5hbWUuaHRtbCwgdGhpcyBtdXN0IGJlIGFuIGFic29sdXRlIHBhdGgKICAgICAgICAgICAgICAgICAgICAgKiBvciBhIHBhdGggcmVsYXRpdmUgdG8gdGhlIHJvb3QuCiAgICAgICAgICAgICAgICAgICAgICogQGZpZWxkCiAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgbG9jYWw6ICIuLi9uYW1lLmh0bWwiLAogICAgICAgICAgICAgICAgICAgIHN3ZjogUkVNT1RFICsgIi8uLi9lYXN5eGRtLnN3ZiIsCiAgICAgICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgICAgICogUmVnaXN0ZXIgdGhlIHVybCB0byB0aGUgcmVtb3RlIGludGVyZmFjZQogICAgICAgICAgICAgICAgICAgICAqIEBmaWVsZAogICAgICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgIHJlbW90ZTogUkVNT1RFICsgIi9yZW1vdGUuaHRtbCIsCiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSGVscGVyOiBSRU1PVEUgKyAiLy4uL25hbWUuaHRtbCIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICByZW1vdGU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgb3Blbjoge30sCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RNZXNzYWdlOiB7fQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgbG9jYWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAqIFJlZ2lzdGVyIHRoZSBtZXRob2QgdGhhdCBzaG91bGQgaGFuZGxlIGluY29taW5nIGRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG9yaWdpbgogICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICAgICAgcG9zdE1lc3NhZ2U6IGZ1bmN0aW9uKGRhdGEpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9ICJkYXRhIGZyb20gJyIgKyBwcm94eS5vcmlnaW4gKyAiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBrZXkgKyAiPSIgKyBkYXRhW2tleV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gbGV0cyB0ZWxsIHRoZSBwcm94eSB0byBvcGVuIHVwIHRoZSB3aW5kb3cgYXMgc29vbiBhcyBwb3NzaWJsZQogICAgICAgICAgICAgICAgcHJveHkub3BlbigibWFpbmFwcCIpOwogICAgICAgICAgICB9CiAgICAgICAgPC9zY3JpcHQ+CiAgICA8L2hlYWQ+CiAgICA8Ym9keT4KICAgICAgICA8ZGl2IHN0eWxlPSJib3JkZXI6MXB4IHNvbGlkIGJsYWNrO3BhZGRpbmc6M3B4O21hcmdpbjoxMHB4OyI+CiAgICAgICAgICAgIDxhIGhyZWY9ImluZGV4Lmh0bWwiPkluZGV4IG9mIGV4YW1wbGVzPC9hPgogICAgICAgICAgICB8IDxhIGhyZWY9Imh0dHA6Ly9naXRodWIuY29tL295dmluZGtpbnNleS9lYXN5WERNLyNyZWFkbWUiPlJlYWRtZSBhdCBnaXRodWI8L2E+CiAgICAgICAgICAgIHwgCiAgICAgICAgICAgIHwgPGEgaHJlZj0iaHR0cDovL2Vhc3l4ZG0ubmV0LyI+ZWFzeVhETS5uZXQ8L2E+CiAgICAgICAgICAgIHwgPGEgaHJlZj0iaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL2Vhc3l4ZG0iPmVhc3lYRE0gYXQgR29vZ2xlIEdyb3VwczwvYT4KICAgICAgICAgICAgPGJyLz4KICAgICAgICAgICAgVGhlIGV4YW1wbGVzIGFyZSBleGVjdXRpbmcgc2xvd2VyIHRoYW4gdGhlIHByb2R1Y3Rpb24gYnVpbGQgZHVlIHRvIHRoZSBleHRlbnNpdmUgdHJhY2luZy4KICAgICAgICAgICAgPGJyLz4KICAgICAgICAgICAgSWYgeW91IGFyZSBhbGVydGVkIGFib3V0IGEgcG9wdXAsIHRoZW4gdGhpcyBpcyBvbmx5IHRoZSB0cmFjZSBsb2cgZmVhdHVyZS4gWW91IGNhbiBpZ25vcmUgdGhpcy4KICAgICAgICA8L2Rpdj4KICAgICAgICA8IS0tIGVhc3lYRE0uRGVidWcudHJhY2UobXNnKSB3aWxsIG91dHB1dCBpdHMgbWVzc2FnZXMgdG8gYW55IGVsZW1lbnQgd2l0aCB0aGUgaWQgImxvZyIgLS0+CiAgICAgICAgPGRpdiBpZD0ibG9nIiBzdHlsZT0iaGVpZ2h0OjEwMHB4O2JvcmRlcjoxcHggZG90dGVkIGJsYWNrO292ZXJmbG93OmF1dG8iPgogICAgICAgIDwvZGl2PgogICAgICAgIDxpbnB1dCBpZD0iYnRuT3BlbiIgdHlwZT0iYnV0dG9uIiBvbmNsaWNrPSJvcGVuUG9wdXAoKTsiIHZhbHVlPSJPcGVuIHBvcHVwIi8+PCEtLSBTZW5kIHNvbSBkYXRhIHRvIHRoZSBvdGhlciBzaWRlIC0tPjxpbnB1dCBpZD0iYnRuIiBkaXNhYmxlZD0iZGlzYWJsZWQiIHR5cGU9ImJ1dHRvbiIgb25jbGljaz0icHJveHkucG9zdE1lc3NhZ2Uoe2E6J2InLGM6J2QnLGU6J2YnfSk7IiB2YWx1ZT0ic2VuZCBkYXRhIHRvIHJlbW90ZSIvPgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICAgICAgdmFyIGdhSnNIb3N0ID0gKCgiaHR0cHM6IiA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCkgPyAiaHR0cHM6Ly9zc2wuIiA6ICJodHRwOi8vd3d3LiIpOwogICAgICAgICAgICBkb2N1bWVudC53cml0ZSh1bmVzY2FwZSgiJTNDc2NyaXB0IHNyYz0nIiArIGdhSnNIb3N0ICsgImdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJyB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnJTNFJTNDL3NjcmlwdCUzRSIpKTsKICAgICAgICA8L3NjcmlwdD4KICAgICAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICAgICAgICAgIGlmIChsb2NhdGlvbi5ob3N0LmluZGV4T2YoImVhc3l4ZG0ubmV0IikgIT09IC0xKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHZhciBwYWdlVHJhY2tlciA9IF9nYXQuX2dldFRyYWNrZXIoIlVBLTk1MzU1OTEtMyIpOwogICAgICAgICAgICAgICAgICAgIHBhZ2VUcmFja2VyLl9zZXREb21haW5OYW1lKCIuZWFzeXhkbS5uZXQiKTsKICAgICAgICAgICAgICAgICAgICBwYWdlVHJhY2tlci5fdHJhY2tQYWdldmlldygpOwogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIDwvc2NyaXB0PgogICAgPC9ib2R5Pgo8L2h0bWw+Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 22:23:11 GMT",
                    "Content-Length": "6235",
                    "Date": "Thu, 06 Nov 2014 22:23:12 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}