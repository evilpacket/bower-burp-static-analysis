{
    "url": "http://localhost:9999/fahad19/Aloha-Editor/src/plugins/common/ui/lib/tab.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>location.href</b> and written to <b>$()</b> via the following statement:<ul><li>this.handle = $('&lt;li&gt;&lt;a href=\"' + location.href.replace(/#.*$/, '') + '#' + this.id + '\"&gt;' +     settings.label + '&lt;/a&gt;&lt;/li&gt;');</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/fahad19/Aloha-Editor/src/plugins/common/ui/lib/tab.js",
                "path": "/fahad19/Aloha-Editor/src/plugins/common/ui/lib/tab.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9mYWhhZDE5L0Fsb2hhLUVkaXRvci9zcmMvcGx1Z2lucy9jb21tb24vdWkvbGliL3RhYi5qcyBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODQyNw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAwMDowMjowNCBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMDA6MDI6MDEgR01UDQoNCmRlZmluZShbCgknYWxvaGEvY29yZScsCgknanF1ZXJ5JywKCSd1aS9jb250YWluZXInLAoJJ3VpL2NvbXBvbmVudCcsCgknUHViU3ViJywKCSdqcXVlcnl1aScKXSwgZnVuY3Rpb24gKAoJQWxvaGEsCgkkLAoJQ29udGFpbmVyLAoJQ29tcG9uZW50LAoJUHViU3ViCikgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBpZENvdW50ZXIgPSAwOwoJdmFyIHNsb3R0ZWRDb21wb25lbnRzID0ge307CgoJZnVuY3Rpb24gaGFzVmlzaWJsZUNvbXBvbmVudHModGFiKXsKCQl2YXIgaSwgc2xvdCwgY29tcG9uZW50LCBoYXNWaXNpYmxlID0gZmFsc2U7CgoJCS8vIHRoZSBwcm9ibGVtIGlzLCBhIGNvbnRhaW5lciBjb21wb25lbnQgaGFkIGEgYnV0dG9uIHRvIGV4cGFuZCB0aGUgb3B0aW9ucwoJCWlmKCAkKAoJCQkJJ2J1dHRvbjpub3QoLmFsb2hhLW11bHRpc3BsaXQtdG9nZ2xlKScsCgkJCQl0YWIucGFuZWwKCQkJKS5sZW5ndGggIT09IDAKCQkpewoJCQloYXNWaXNpYmxlID0gdHJ1ZTsKCQl9CgoJCS8qCgkJLy8gQHRvZG8gdGhpcyBhbGdvcml0aG0gbXVzdCBiZSBlbmhhbmNlZCwgYXNraW5nIGVhY2ggY29tcG9uZW50IGlmIGlzIHZpc2libGUKCQkvLyB0aGlzIGlzIHRoZSBsb25nZXN0IGFwcm9hY2gsIEkgaXRlcmF0ZSB0aGUgY29tcG9uZW50cyByZWdpc3RlcmVkIGluCgkJLy8gdGhpcyB0YWIKCQlmb3IoaSA9IDA7IGkgPCB0YWIuX3Nsb3RzTGlzdC5sZW5ndGg7IGkrKyl7CgkJCWlmKHVuZGVmaW5lZCAhPT0gc2xvdHRlZENvbXBvbmVudHNbc2xvdE5hbWVdKXsKCQkJCWlmKCQoCgkJCQkJCSdidXR0b246bm90KC5hbG9oYS1tdWx0aXNwbGl0LXRvZ2dsZSknLAoJCQkJCQlzbG90dGVkQ29tcG9uZW50c1tzbG90TmFtZV0uZWxlbWVudAoJCQkJCSkubGVuZ3RoICE9PSAwCgkJCQkpewoJCQkJCWhhc1Zpc2libGUgPSB0cnVlOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfQoJCSovCgkJcmV0dXJuIGhhc1Zpc2libGU7Cgl9CgoJLyoqCgkgKiBEZWZpbmVzIGEgQ29udGFpbmVyIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgYSBjb2xsZWN0aW9uIG9mIHJlbGF0ZWQKCSAqIGNvbXBvbmVudCBncm91cHMgdG8gYmUgcmVuZGVyZWQgdG9nZXRoZXIgb24gdGhlIHRvb2xiYXIuICBUYWJzIGFyZQoJICogb3JnYW5pemVkIGJ5IGZlYXR1cmUgYW5kIGZ1bmN0aW9uYWxpdHkgc28gdGhhdCByZWxhdGVkIGNvbnRyb2xzIGNhbiBiZQoJICogYnJvdWdodCBpbiBhbmQgb3V0IG9mIHZpZXcgZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhleSBhcmUKCSAqIGFwcHJvcHJpYXRlIGZvciBhIGdpdmVuIHVzZXIgY29udGV4dC4KCSAqCgkgKiBUYWJzIGNhbiBiZSBkZWZpbmVkIGRlY2xhcml0aXZlbHkgaW4gdGhlIEFsb2hhIGNvbmZpZ3VyYXRpb24gaW4gdGhlCgkgKiBmb2xsb3dpbmcgbWFubmVyOgoJICoKCSAqICAgIEFsb2hhLnNldHRpbmdzLnRvb2xiYXI6IFsKCSAqICAgICAgewoJICogICAgICAgICBsYWJlbDogJ0xpc3RzJywKCSAqICAgICAgICAgc2hvd09uOiAndWwsb2wsKi5wYXJlbnQoLmFsb2hhLWVkaXRhYmxlIHVsLC5hbG9oYS1lZGl0YWJsZSBvbCknLAoJICogICAgICAgICBjb21wb25lbnRzOiBbIFsgJ29yZGVyZWRMaXN0JywgJ3Vub3JkZXJlZExpc3QnIF0gXQoJICogICAgICB9CgkgKiAgICBdCgkgKgoJICogQWx0ZXJuYXRpdmVseSwgdGFicyBjYW4gYWxzbyBiZSBjcmVhdGVkIGltcGVyYXRpdmVseSBpbiB0aGlzIHdheToKCSAqIG5ldyBUYWIoIG9wdGlvbnMsIGNvbXBvbmVudHMgKS4KCSAqCgkgKiBAY2xhc3MKCSAqIEBleHRlbmRzIHtDb250YWluZXJ9CgkgKi8KCXZhciBUYWIgPSBDb250YWluZXIuZXh0ZW5kKHsKCgkJX2VsZW1CeVNsb3Q6IG51bGwsCgkJX2dyb3VwQnlTbG90OiBudWxsLAoJCV9ncm91cEJ5Q29tcG9uZW50OiBudWxsLAoKCQkvKioKCQkgKiBBbGwgdGhhdCB0aGlzIGNvbnN0cnVjdG9yIGRvZXMgaXMgc2F2ZSB0aGUgY29tcG9uZW50cyBhcnJheSBpbnRvIGEKCQkgKiBsb2NhbCB2YXJpYWJsZSwgdG8gYmUgdXNlZCBkdXJpbmcgaW5zdGFudGlhbGl6YXRpb24uCgkJICoKCQkgKiBAcGFyYW0ge29iamVjdH0gc2V0dGluZ3MKCQkgKiBAcGFyYW0ge0FycmF5LjxBcnJheTxzdHJpbmc+Pn0gY29tcG9uZW50cwoJCSAqIEBjb25zdHJ1Y3RvcgoJCSAqLwoJCV9jb25zdHJ1Y3RvcjogZnVuY3Rpb24gKGNvbnRleHQsIHNldHRpbmdzLCBjb21wb25lbnRzKSB7CgkJCXZhciB0aGlzVGFiID0gdGhpcywKCQkJICAgIGksIGosCgkJCSAgICBlbGVtLAoJCQkgICAgZ3JvdXBlZENvbXBvbmVudHMsCgkJCSAgICBncm91cCwKCQkJICAgIGdyb3VwUHJvcHMsCgkJCSAgICBjb21wb25lbnROYW1lOwoKCQkJdGhpcy5fZWxlbUJ5U2xvdCA9IHt9OwoJCQl0aGlzLl9ncm91cEJ5U2xvdCA9IHt9OwoJCQl0aGlzLl9ncm91cEJ5Q29tcG9uZW50ID0ge307CgkJCXRoaXMuX3Nsb3RzTGlzdCA9IFtdOwoJCQl0aGlzLl9zdXBlcihjb250ZXh0LCBzZXR0aW5ncyk7CgoJCQl0aGlzLmNvbnRhaW5lciA9IHNldHRpbmdzLmNvbnRhaW5lcjsKCQkJdGhpcy5saXN0ID0gdGhpcy5jb250YWluZXIuZGF0YSgnbGlzdCcpOwoJCQl0aGlzLnBhbmVscyA9IHRoaXMuY29udGFpbmVyLmRhdGEoJ3BhbmVscycpOwoJCQl0aGlzLmlkID0gJ3RhYi11aS1jb250YWluZXItJyArICgrK2lkQ291bnRlcik7CgkJCXRoaXMucGFuZWwgPSAkKCc8ZGl2PicsIHtpZCA6IHRoaXMuaWQsICd1bnNlbGVjdGFibGUnOiAnb24nfSk7CgkJCXRoaXMuaGFuZGxlID0gJCgnPGxpPjxhIGhyZWY9IicgKyBsb2NhdGlvbi5ocmVmLnJlcGxhY2UoLyMuKiQvLCAnJykgKyAnIycgKyB0aGlzLmlkICsgJyI+JyArCgkJCQlzZXR0aW5ncy5sYWJlbCArICc8L2E+PC9saT4nKTsKCgkJCWZvciAoaSA9IDA7IGkgPCBjb21wb25lbnRzLmxlbmd0aDsgaSsrKSB7CgkJCQlpZiAodHlwZW9mIGNvbXBvbmVudHNbaV0gPT09ICdzdHJpbmcnKSB7CgkJCQkJaWYgKDEgPT09IGNvbXBvbmVudHNbaV0ubGVuZ3RoICYmIGNvbXBvbmVudHNbaV0uY2hhckNvZGVBdCgwKSA9PT0gMTApIHsKCQkJCQkJdGhpcy5wYW5lbC5hcHBlbmQoJzxkaXY+Jywgeyd1bnNlbGVjdGFibGUnOiAnb24nfSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJZWxlbSA9ICQoJzxzcGFuPicsIHsndW5zZWxlY3RhYmxlJzogJ29uJ30pOwoJCQkJCQl0aGlzLl9lbGVtQnlTbG90W2NvbXBvbmVudHNbaV1dID0gZWxlbTsKCQkJCQkJdGhpcy5wYW5lbC5hcHBlbmQoZWxlbSk7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQkvLyBIaWRlIHRoZSBncm91cCB1bnRpbCB0aGUgZmlyc3QgYnV0dG9uIGlzIGFkb3B0ZWQgaW50byBpdC4KCQkJCQlncm91cCA9ICQoJzxkaXY+JywgewoJCQkJCQknY2xhc3MnOiAnYWxvaGEtdWktY29tcG9uZW50LWdyb3VwIGFsb2hhLXVpLWhpZGRlbicsCgkJCQkJCSd1bnNlbGVjdGFibGUnOiAnb24nCgkJCQkJfSkuYXBwZW5kVG8odGhpcy5wYW5lbCk7CgkJCQkJZ3JvdXBQcm9wcyA9IHtlbGVtZW50OiBncm91cCwgdmlzaWJsZUNvdW50ZXI6IDB9OwoJCQkJCWdyb3VwZWRDb21wb25lbnRzID0gY29tcG9uZW50c1tpXTsKCQkJCQlmb3IgKGogPSAwOyBqIDwgZ3JvdXBlZENvbXBvbmVudHMubGVuZ3RoOyBqKyspIHsKCQkJCQkJdGhpcy5fZ3JvdXBCeVNsb3RbZ3JvdXBlZENvbXBvbmVudHNbal1dID0gZ3JvdXBQcm9wczsKCQkJCQkJaWYgKGdyb3VwZWRDb21wb25lbnRzW2pdICYmCgkJCQkJCQkxID09PSBncm91cGVkQ29tcG9uZW50c1tqXS5sZW5ndGggJiYKCQkJCQkJICAgIGdyb3VwZWRDb21wb25lbnRzW2pdLmNoYXJDb2RlQXQoMCkgPT09IDEwKSB7CgkJCQkJCQlncm91cC5hcHBlbmQoJCgnPGRpdj4nLCB7J3Vuc2VsZWN0YWJsZSc6ICdvbid9KSk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljb21wb25lbnROYW1lID0gZ3JvdXBlZENvbXBvbmVudHNbal07CgkJCQkJCQllbGVtID0gJCgnPHNwYW4+Jywgeyd1bnNlbGVjdGFibGUnOiAnb24nfSk7CgkJCQkJCQl0aGlzLl9lbGVtQnlTbG90W2dyb3VwZWRDb21wb25lbnRzW2pdXSA9IGVsZW07CgkJCQkJCQlncm91cC5hcHBlbmQoZWxlbSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXRoaXMucGFuZWwuYXBwZW5kKCQoJzxkaXY+JywgeydjbGFzcyc6ICdhbG9oYS11aS1jbGVhcicsICd1bnNlbGVjdGFibGUnOiAnb24nfSkpOwoJCQl0aGlzLmhhbmRsZS5hcHBlbmRUbyh0aGlzLmxpc3QpOwoJCQl0aGlzLnBhbmVsLmFwcGVuZFRvKHRoaXMucGFuZWxzKTsKCQkJdGhpcy5jb250YWluZXIudGFicygncmVmcmVzaCcpOwoKCQkJdmFyIGFsb2hhVGFicyA9IHNldHRpbmdzLmNvbnRhaW5lci5kYXRhKCdhbG9oYS10YWJzJyk7CgkJCXRoaXMuaW5kZXggPSBhbG9oYVRhYnMubGVuZ3RoOwoJCQlhbG9oYVRhYnMucHVzaCh0aGlzKTsKCQl9LAoKCQlhZG9wdEludG86IGZ1bmN0aW9uKHNsb3QsIGNvbXBvbmVudCkgewoJCQl2YXIgZWxlbSA9IHRoaXMuX2VsZW1CeVNsb3Rbc2xvdF0sCgkJCSAgICBncm91cDsKCQkJaWYgKCFlbGVtKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJc2xvdHRlZENvbXBvbmVudHNbc2xvdF0gPSBjb21wb25lbnQ7CgkJCWNvbXBvbmVudC5hZG9wdFBhcmVudCh0aGlzKTsKCQkJZWxlbS5hcHBlbmQoY29tcG9uZW50LmVsZW1lbnQpOwoJCQlncm91cCA9IHRoaXMuX2dyb3VwQnlTbG90W3Nsb3RdOwoJCQl0aGlzLl9zbG90c0xpc3QucHVzaChzbG90KTsKCQkJaWYgKGdyb3VwKSB7CgkJCQl0aGlzLl9ncm91cEJ5Q29tcG9uZW50W2NvbXBvbmVudC5pZF0gPSBncm91cDsKCQkJCWlmIChjb21wb25lbnQuaXNWaXNpYmxlKCkpIHsKCQkJCQlpZiAoIWdyb3VwLnZpc2libGVDb3VudGVyKSB7CgkJCQkJCWdyb3VwLmVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2Fsb2hhLXVpLWhpZGRlbicpOwoJCQkJCX0KCQkJCQlncm91cC52aXNpYmxlQ291bnRlciArPSAxOwoJCQkJfQoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX0sCgoJCWZvcmVncm91bmQ6IGZ1bmN0aW9uKCkgewoJCQl0aGlzLmNvbnRhaW5lci50YWJzKCdzZWxlY3QnLCB0aGlzLmluZGV4KTsKCQl9LAoKCQljaGlsZEZvcmVncm91bmQ6IGZ1bmN0aW9uKGNoaWxkQ29tcG9uZW50KSB7CgkJCXRoaXMuZm9yZWdyb3VuZCgpOwoJCX0sCgoJCWhhc1Zpc2libGVDb21wb25lbnRzOiBmdW5jdGlvbiAoKSB7CgkJCXZhciBzaWJsaW5ncyA9IHRoaXMuX2VsZW1CeVNsb3Q7CgkJCXZhciBzbG90OwoJCQlmb3IgKHNsb3QgaW4gc2libGluZ3MpIHsKCQkJCWlmIChzaWJsaW5ncy5oYXNPd25Qcm9wZXJ0eShzbG90KSAmJiBzbG90dGVkQ29tcG9uZW50c1tzbG90XSkgewoJCQkJCWlmIChzbG90dGVkQ29tcG9uZW50c1tzbG90XS52aXNpYmxlKSB7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlyZXR1cm4gZmFsc2U7CgkJfSwKCgkJY2hpbGRWaXNpYmxlOiBmdW5jdGlvbihjaGlsZENvbXBvbmVudCwgdmlzaWJsZSkgewoJCQlpZiAodmlzaWJsZSkgewoJCQkJY2hpbGRDb21wb25lbnQuY29udGFpbmVyLnNob3coKTsKCQkJfSBlbHNlIGlmICghY2hpbGRDb21wb25lbnQuY29udGFpbmVyLmhhc1Zpc2libGVDb21wb25lbnRzKCkpIHsKCQkJCWNoaWxkQ29tcG9uZW50LmNvbnRhaW5lci5oaWRlKCk7CgkJCX0KCQkJdmFyIGdyb3VwID0gdGhpcy5fZ3JvdXBCeUNvbXBvbmVudFtjaGlsZENvbXBvbmVudC5pZF07CgkJCWlmICghZ3JvdXApIHsKCQkJCXJldHVybjsKCQkJfQoJCQlpZiAodmlzaWJsZSkgewoJCQkJaWYgKDAgPT09IGdyb3VwLnZpc2libGVDb3VudGVyKSB7CgkJCQkJZ3JvdXAuZWxlbWVudC5yZW1vdmVDbGFzcygnYWxvaGEtdWktaGlkZGVuJyk7CgkJCQl9CgkJCQlncm91cC52aXNpYmxlQ291bnRlciArPSAxOwoJCQl9IGVsc2UgewoJCQkJZ3JvdXAudmlzaWJsZUNvdW50ZXIgLT0gMTsKCQkJCWlmICgwID09PSBncm91cC52aXNpYmxlQ291bnRlcikgewoJCQkJCWdyb3VwLmVsZW1lbnQuYWRkQ2xhc3MoJ2Fsb2hhLXVpLWhpZGRlbicpOwoJCQkJfQoJCQl9CgkJfSwKCgkJLyoqCgkJICogQG92ZXJyaWRlCgkJICovCgkJc2hvdzogZnVuY3Rpb24oKSB7CgkJCWlmICghdGhpcy5saXN0LmNoaWxkcmVuKCkubGVuZ3RoIHx8ICFoYXNWaXNpYmxlQ29tcG9uZW50cyh0aGlzKSkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQl0aGlzLmhhbmRsZS5zaG93KCk7CgkJCXRoaXMudmlzaWJsZSA9IHRydWU7CgoJCQkvLyBIaWRpbmcgYWxsIHRhYnMgbWF5IGhpZGUgdGhlIHRvb2xiYXIsIHNvIHNob3dpbmcgdGhlCgkJCS8vIGZpcnN0IHRhYiBhZ2FpbiBtdXN0IGFsc28gc2hvdyB0aGUgdG9vbGJhci4KCQkJdGhpcy5jb250YWluZXIuc2hvdygpOwoKCQkJLy8gSWYgbm8gdGFicyBhcmUgc2VsZWN0ZWQsIHRoZW4gc2VsZWN0IHRoZSB0YWIgd2hpY2ggd2FzIGp1c3Qgc2hvd24uCgkJCWlmICggICAhdGhpcy5jb250YWluZXIuZmluZCgnLnVpLXRhYnMtYWN0aXZlJykubGVuZ3RoCgkJCSAgICB8fCAgdGhpcy5jb250YWluZXIudGFicygnb3B0aW9uJywgJ3NlbGVjdGVkJykgPT09IHRoaXMuaW5kZXgpIHsKCQkJCXRoaXMuZm9yZWdyb3VuZCgpOwoJCQl9CgkJfSwKCgkJLyoqCgkJICogQG92ZXJyaWRlCgkJICovCgkJaGlkZTogZnVuY3Rpb24oKSB7CgkJCXZhciB0YWJzID0gdGhpcy5saXN0LmNoaWxkcmVuKCk7CgkJCWlmICggMCA9PT0gdGFicy5sZW5ndGggKSB7CgkJCQlyZXR1cm47CgkJCX0KCQkJdGhpcy5oYW5kbGUuaGlkZSgpOwoJCQl0aGlzLnZpc2libGUgPSBmYWxzZTsKCgkJCS8vIElmIHRoZSB0YWIgd2UganVzdCBoaWQgd2FzIHRoZSBzZWxlY3RlZCB0YWIsIHRoZW4gd2UgbmVlZCB0bwoJCQkvLyBzZWxlY3QgYW5vdGhlciB0YWIgaW4gaXRzIHN0ZWFkLiAgV2Ugd2lsbCBzZWxlY3QgdGhlIGZpcnN0CgkJCS8vIHZpc2libGUgdGFiIHdlIGZpbmQsIG9yIGVsc2Ugd2UgZGVzZWxlY3QgYWxsIHRhYnMuCgkJCWlmICggdGhpcy5pbmRleCA9PT0gdGhpcy5jb250YWluZXIudGFicyggJ29wdGlvbicsICdzZWxlY3RlZCcgKSApIHsKCQkJCXRhYnMgPSB0aGlzLmNvbnRhaW5lci5kYXRhKCAnYWxvaGEtdGFicycgKTsKCgkJCQl2YXIgaTsKCQkJCWZvciAoIGkgPSAwOyBpIDwgdGFicy5sZW5ndGg7ICsraSApIHsKCQkJCQlpZiAoIHRhYnNbIGkgXS52aXNpYmxlICkgewoJCQkJCQl0aGlzLmNvbnRhaW5lci50YWJzKCAnc2VsZWN0JywgaSApOwoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFRoaXMgZG9lcyBub3Qgd29yay4uLgoJCQkJLy8gdGhpcy5jb250YWluZXIudGFicyggJ3NlbGVjdCcsIC0xICk7CgoJCQkJLy8gV2h5IGRvIHdlIHJlbW92ZSB0aGlzIGNsYXNzPwoJCQkJdGhpcy5oYW5kbGUucmVtb3ZlQ2xhc3MoICd1aS10YWJzLWFjdGl2ZScgKTsKCgkJCQkvLyBJdCBkb2Vzbid0IG1ha2UgYW55IHNlbnNlIHRvIGxlYXZlIHRoZSB0b29sYmFyCgkJCQkvLyB2aXNpYmxlIGFmdGVyIGFsbCB0YWJzIGhhdmUgYmVlbiBoaWRkZW4uCgkJCQl0aGlzLmNvbnRhaW5lci5oaWRlKCk7CgkJCX0KCQl9CgoJfSk7CgoJJC5leHRlbmQoVGFiLCB7CgoJCS8qKgoJCSAqIENyZWF0ZXMgaG9sZGluZyBlbGVtZW50cyBmb3IgalF1ZXJ5IFVJIFRhYnMgZm9yIGEgc3VyZmFjZS4KCQkgKgoJCSAqIEBzdGF0aWMKCQkgKiBAcmV0dXJuIHtqUXVlcnkuPEhUTUxFbGVtZW50Pn0gVGhlIGhvbGRlciBjb250YWluZXIgb24gd2hpY2ggd2UKCQkgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52b2tlIGpRdWVyeSBVSSBUYWJzIG9uY2UgaXQgaXMKCQkgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdWxhdGVkIHdpdGggdGFiIGNvbnRhaW5lcnMuCgkJICovCgkJY3JlYXRlQ29udGFpbmVyOiBmdW5jdGlvbiAoKSB7CgkJCXZhciAkY29udGFpbmVyID0gJCgnPGRpdj4nLCB7J3Vuc2VsZWN0YWJsZSc6ICdvbid9KTsKCQkJdmFyICRsaXN0ID0gJCgnPHVsPicsIHsndW5zZWxlY3RhYmxlJzogJ29uJ30pLmFwcGVuZFRvKCRjb250YWluZXIpOwoJCQl2YXIgJHBhbmVscyA9ICQoJzxkaXY+Jywgeyd1bnNlbGVjdGFibGUnOiAnb24nfSkuYXBwZW5kVG8oJGNvbnRhaW5lcik7CgoJCQkkY29udGFpbmVyCgkJCQkuZGF0YSgnbGlzdCcsICRsaXN0KQoJCQkJLmRhdGEoJ3BhbmVscycsICRwYW5lbHMpCgkJCQkuZGF0YSgnYWxvaGEtdGFicycsIFtdKQoJCQkJLnRhYnMoewoJCQkJCXNlbGVjdDogZnVuY3Rpb24gKGV2ZW50LCB1aSkgewoJCQkJCQl2YXIgdGFicyA9ICRjb250YWluZXIuZGF0YSgnYWxvaGEtdGFicycpOwoJCQkJCQkkY29udGFpbmVyLmRhdGEoJ2Fsb2hhLWFjdGl2ZS1jb250YWluZXInLCB0YWJzW3VpLmluZGV4XSk7CgkJCQkJCVB1YlN1Yi5wdWIoJ2Fsb2hhLnVpLmNvbnRhaW5lci5zZWxlY3RlZCcsIHtkYXRhOiB0YWJzW3VpLmluZGV4XX0pOwoJCQkJCX0KCQkJCX0pOwoKCQkJcmV0dXJuICRjb250YWluZXI7CgkJfQoJfSk7CgoJcmV0dXJuIFRhYjsKfSk7Cg==",
                "body": "ZGVmaW5lKFsKCSdhbG9oYS9jb3JlJywKCSdqcXVlcnknLAoJJ3VpL2NvbnRhaW5lcicsCgkndWkvY29tcG9uZW50JywKCSdQdWJTdWInLAoJJ2pxdWVyeXVpJwpdLCBmdW5jdGlvbiAoCglBbG9oYSwKCSQsCglDb250YWluZXIsCglDb21wb25lbnQsCglQdWJTdWIKKSB7CgkndXNlIHN0cmljdCc7CgoJdmFyIGlkQ291bnRlciA9IDA7Cgl2YXIgc2xvdHRlZENvbXBvbmVudHMgPSB7fTsKCglmdW5jdGlvbiBoYXNWaXNpYmxlQ29tcG9uZW50cyh0YWIpewoJCXZhciBpLCBzbG90LCBjb21wb25lbnQsIGhhc1Zpc2libGUgPSBmYWxzZTsKCgkJLy8gdGhlIHByb2JsZW0gaXMsIGEgY29udGFpbmVyIGNvbXBvbmVudCBoYWQgYSBidXR0b24gdG8gZXhwYW5kIHRoZSBvcHRpb25zCgkJaWYoICQoCgkJCQknYnV0dG9uOm5vdCguYWxvaGEtbXVsdGlzcGxpdC10b2dnbGUpJywKCQkJCXRhYi5wYW5lbAoJCQkpLmxlbmd0aCAhPT0gMAoJCSl7CgkJCWhhc1Zpc2libGUgPSB0cnVlOwoJCX0KCgkJLyoKCQkvLyBAdG9kbyB0aGlzIGFsZ29yaXRobSBtdXN0IGJlIGVuaGFuY2VkLCBhc2tpbmcgZWFjaCBjb21wb25lbnQgaWYgaXMgdmlzaWJsZQoJCS8vIHRoaXMgaXMgdGhlIGxvbmdlc3QgYXByb2FjaCwgSSBpdGVyYXRlIHRoZSBjb21wb25lbnRzIHJlZ2lzdGVyZWQgaW4KCQkvLyB0aGlzIHRhYgoJCWZvcihpID0gMDsgaSA8IHRhYi5fc2xvdHNMaXN0Lmxlbmd0aDsgaSsrKXsKCQkJaWYodW5kZWZpbmVkICE9PSBzbG90dGVkQ29tcG9uZW50c1tzbG90TmFtZV0pewoJCQkJaWYoJCgKCQkJCQkJJ2J1dHRvbjpub3QoLmFsb2hhLW11bHRpc3BsaXQtdG9nZ2xlKScsCgkJCQkJCXNsb3R0ZWRDb21wb25lbnRzW3Nsb3ROYW1lXS5lbGVtZW50CgkJCQkJKS5sZW5ndGggIT09IDAKCQkJCSl7CgkJCQkJaGFzVmlzaWJsZSA9IHRydWU7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQl9CgkJKi8KCQlyZXR1cm4gaGFzVmlzaWJsZTsKCX0KCgkvKioKCSAqIERlZmluZXMgYSBDb250YWluZXIgb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhIGNvbGxlY3Rpb24gb2YgcmVsYXRlZAoJICogY29tcG9uZW50IGdyb3VwcyB0byBiZSByZW5kZXJlZCB0b2dldGhlciBvbiB0aGUgdG9vbGJhci4gIFRhYnMgYXJlCgkgKiBvcmdhbml6ZWQgYnkgZmVhdHVyZSBhbmQgZnVuY3Rpb25hbGl0eSBzbyB0aGF0IHJlbGF0ZWQgY29udHJvbHMgY2FuIGJlCgkgKiBicm91Z2h0IGluIGFuZCBvdXQgb2YgdmlldyBkZXBlbmRpbmcgb24gd2hldGhlciB0aGV5IGFyZQoJICogYXBwcm9wcmlhdGUgZm9yIGEgZ2l2ZW4gdXNlciBjb250ZXh0LgoJICoKCSAqIFRhYnMgY2FuIGJlIGRlZmluZWQgZGVjbGFyaXRpdmVseSBpbiB0aGUgQWxvaGEgY29uZmlndXJhdGlvbiBpbiB0aGUKCSAqIGZvbGxvd2luZyBtYW5uZXI6CgkgKgoJICogICAgQWxvaGEuc2V0dGluZ3MudG9vbGJhcjogWwoJICogICAgICB7CgkgKiAgICAgICAgIGxhYmVsOiAnTGlzdHMnLAoJICogICAgICAgICBzaG93T246ICd1bCxvbCwqLnBhcmVudCguYWxvaGEtZWRpdGFibGUgdWwsLmFsb2hhLWVkaXRhYmxlIG9sKScsCgkgKiAgICAgICAgIGNvbXBvbmVudHM6IFsgWyAnb3JkZXJlZExpc3QnLCAndW5vcmRlcmVkTGlzdCcgXSBdCgkgKiAgICAgIH0KCSAqICAgIF0KCSAqCgkgKiBBbHRlcm5hdGl2ZWx5LCB0YWJzIGNhbiBhbHNvIGJlIGNyZWF0ZWQgaW1wZXJhdGl2ZWx5IGluIHRoaXMgd2F5OgoJICogbmV3IFRhYiggb3B0aW9ucywgY29tcG9uZW50cyApLgoJICoKCSAqIEBjbGFzcwoJICogQGV4dGVuZHMge0NvbnRhaW5lcn0KCSAqLwoJdmFyIFRhYiA9IENvbnRhaW5lci5leHRlbmQoewoKCQlfZWxlbUJ5U2xvdDogbnVsbCwKCQlfZ3JvdXBCeVNsb3Q6IG51bGwsCgkJX2dyb3VwQnlDb21wb25lbnQ6IG51bGwsCgoJCS8qKgoJCSAqIEFsbCB0aGF0IHRoaXMgY29uc3RydWN0b3IgZG9lcyBpcyBzYXZlIHRoZSBjb21wb25lbnRzIGFycmF5IGludG8gYQoJCSAqIGxvY2FsIHZhcmlhYmxlLCB0byBiZSB1c2VkIGR1cmluZyBpbnN0YW50aWFsaXphdGlvbi4KCQkgKgoJCSAqIEBwYXJhbSB7b2JqZWN0fSBzZXR0aW5ncwoJCSAqIEBwYXJhbSB7QXJyYXkuPEFycmF5PHN0cmluZz4+fSBjb21wb25lbnRzCgkJICogQGNvbnN0cnVjdG9yCgkJICovCgkJX2NvbnN0cnVjdG9yOiBmdW5jdGlvbiAoY29udGV4dCwgc2V0dGluZ3MsIGNvbXBvbmVudHMpIHsKCQkJdmFyIHRoaXNUYWIgPSB0aGlzLAoJCQkgICAgaSwgaiwKCQkJICAgIGVsZW0sCgkJCSAgICBncm91cGVkQ29tcG9uZW50cywKCQkJICAgIGdyb3VwLAoJCQkgICAgZ3JvdXBQcm9wcywKCQkJICAgIGNvbXBvbmVudE5hbWU7CgoJCQl0aGlzLl9lbGVtQnlTbG90ID0ge307CgkJCXRoaXMuX2dyb3VwQnlTbG90ID0ge307CgkJCXRoaXMuX2dyb3VwQnlDb21wb25lbnQgPSB7fTsKCQkJdGhpcy5fc2xvdHNMaXN0ID0gW107CgkJCXRoaXMuX3N1cGVyKGNvbnRleHQsIHNldHRpbmdzKTsKCgkJCXRoaXMuY29udGFpbmVyID0gc2V0dGluZ3MuY29udGFpbmVyOwoJCQl0aGlzLmxpc3QgPSB0aGlzLmNvbnRhaW5lci5kYXRhKCdsaXN0Jyk7CgkJCXRoaXMucGFuZWxzID0gdGhpcy5jb250YWluZXIuZGF0YSgncGFuZWxzJyk7CgkJCXRoaXMuaWQgPSAndGFiLXVpLWNvbnRhaW5lci0nICsgKCsraWRDb3VudGVyKTsKCQkJdGhpcy5wYW5lbCA9ICQoJzxkaXY+Jywge2lkIDogdGhpcy5pZCwgJ3Vuc2VsZWN0YWJsZSc6ICdvbid9KTsKCQkJdGhpcy5oYW5kbGUgPSAkKCc8bGk+PGEgaHJlZj0iJyArIGxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy4qJC8sICcnKSArICcjJyArIHRoaXMuaWQgKyAnIj4nICsKCQkJCXNldHRpbmdzLmxhYmVsICsgJzwvYT48L2xpPicpOwoKCQkJZm9yIChpID0gMDsgaSA8IGNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHsKCQkJCWlmICh0eXBlb2YgY29tcG9uZW50c1tpXSA9PT0gJ3N0cmluZycpIHsKCQkJCQlpZiAoMSA9PT0gY29tcG9uZW50c1tpXS5sZW5ndGggJiYgY29tcG9uZW50c1tpXS5jaGFyQ29kZUF0KDApID09PSAxMCkgewoJCQkJCQl0aGlzLnBhbmVsLmFwcGVuZCgnPGRpdj4nLCB7J3Vuc2VsZWN0YWJsZSc6ICdvbid9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQllbGVtID0gJCgnPHNwYW4+Jywgeyd1bnNlbGVjdGFibGUnOiAnb24nfSk7CgkJCQkJCXRoaXMuX2VsZW1CeVNsb3RbY29tcG9uZW50c1tpXV0gPSBlbGVtOwoJCQkJCQl0aGlzLnBhbmVsLmFwcGVuZChlbGVtKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCS8vIEhpZGUgdGhlIGdyb3VwIHVudGlsIHRoZSBmaXJzdCBidXR0b24gaXMgYWRvcHRlZCBpbnRvIGl0LgoJCQkJCWdyb3VwID0gJCgnPGRpdj4nLCB7CgkJCQkJCSdjbGFzcyc6ICdhbG9oYS11aS1jb21wb25lbnQtZ3JvdXAgYWxvaGEtdWktaGlkZGVuJywKCQkJCQkJJ3Vuc2VsZWN0YWJsZSc6ICdvbicKCQkJCQl9KS5hcHBlbmRUbyh0aGlzLnBhbmVsKTsKCQkJCQlncm91cFByb3BzID0ge2VsZW1lbnQ6IGdyb3VwLCB2aXNpYmxlQ291bnRlcjogMH07CgkJCQkJZ3JvdXBlZENvbXBvbmVudHMgPSBjb21wb25lbnRzW2ldOwoJCQkJCWZvciAoaiA9IDA7IGogPCBncm91cGVkQ29tcG9uZW50cy5sZW5ndGg7IGorKykgewoJCQkJCQl0aGlzLl9ncm91cEJ5U2xvdFtncm91cGVkQ29tcG9uZW50c1tqXV0gPSBncm91cFByb3BzOwoJCQkJCQlpZiAoZ3JvdXBlZENvbXBvbmVudHNbal0gJiYKCQkJCQkJCTEgPT09IGdyb3VwZWRDb21wb25lbnRzW2pdLmxlbmd0aCAmJgoJCQkJCQkgICAgZ3JvdXBlZENvbXBvbmVudHNbal0uY2hhckNvZGVBdCgwKSA9PT0gMTApIHsKCQkJCQkJCWdyb3VwLmFwcGVuZCgkKCc8ZGl2PicsIHsndW5zZWxlY3RhYmxlJzogJ29uJ30pKTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCWNvbXBvbmVudE5hbWUgPSBncm91cGVkQ29tcG9uZW50c1tqXTsKCQkJCQkJCWVsZW0gPSAkKCc8c3Bhbj4nLCB7J3Vuc2VsZWN0YWJsZSc6ICdvbid9KTsKCQkJCQkJCXRoaXMuX2VsZW1CeVNsb3RbZ3JvdXBlZENvbXBvbmVudHNbal1dID0gZWxlbTsKCQkJCQkJCWdyb3VwLmFwcGVuZChlbGVtKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJdGhpcy5wYW5lbC5hcHBlbmQoJCgnPGRpdj4nLCB7J2NsYXNzJzogJ2Fsb2hhLXVpLWNsZWFyJywgJ3Vuc2VsZWN0YWJsZSc6ICdvbid9KSk7CgkJCXRoaXMuaGFuZGxlLmFwcGVuZFRvKHRoaXMubGlzdCk7CgkJCXRoaXMucGFuZWwuYXBwZW5kVG8odGhpcy5wYW5lbHMpOwoJCQl0aGlzLmNvbnRhaW5lci50YWJzKCdyZWZyZXNoJyk7CgoJCQl2YXIgYWxvaGFUYWJzID0gc2V0dGluZ3MuY29udGFpbmVyLmRhdGEoJ2Fsb2hhLXRhYnMnKTsKCQkJdGhpcy5pbmRleCA9IGFsb2hhVGFicy5sZW5ndGg7CgkJCWFsb2hhVGFicy5wdXNoKHRoaXMpOwoJCX0sCgoJCWFkb3B0SW50bzogZnVuY3Rpb24oc2xvdCwgY29tcG9uZW50KSB7CgkJCXZhciBlbGVtID0gdGhpcy5fZWxlbUJ5U2xvdFtzbG90XSwKCQkJICAgIGdyb3VwOwoJCQlpZiAoIWVsZW0pIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQlzbG90dGVkQ29tcG9uZW50c1tzbG90XSA9IGNvbXBvbmVudDsKCQkJY29tcG9uZW50LmFkb3B0UGFyZW50KHRoaXMpOwoJCQllbGVtLmFwcGVuZChjb21wb25lbnQuZWxlbWVudCk7CgkJCWdyb3VwID0gdGhpcy5fZ3JvdXBCeVNsb3Rbc2xvdF07CgkJCXRoaXMuX3Nsb3RzTGlzdC5wdXNoKHNsb3QpOwoJCQlpZiAoZ3JvdXApIHsKCQkJCXRoaXMuX2dyb3VwQnlDb21wb25lbnRbY29tcG9uZW50LmlkXSA9IGdyb3VwOwoJCQkJaWYgKGNvbXBvbmVudC5pc1Zpc2libGUoKSkgewoJCQkJCWlmICghZ3JvdXAudmlzaWJsZUNvdW50ZXIpIHsKCQkJCQkJZ3JvdXAuZWxlbWVudC5yZW1vdmVDbGFzcygnYWxvaGEtdWktaGlkZGVuJyk7CgkJCQkJfQoJCQkJCWdyb3VwLnZpc2libGVDb3VudGVyICs9IDE7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIHRydWU7CgkJfSwKCgkJZm9yZWdyb3VuZDogZnVuY3Rpb24oKSB7CgkJCXRoaXMuY29udGFpbmVyLnRhYnMoJ3NlbGVjdCcsIHRoaXMuaW5kZXgpOwoJCX0sCgoJCWNoaWxkRm9yZWdyb3VuZDogZnVuY3Rpb24oY2hpbGRDb21wb25lbnQpIHsKCQkJdGhpcy5mb3JlZ3JvdW5kKCk7CgkJfSwKCgkJaGFzVmlzaWJsZUNvbXBvbmVudHM6IGZ1bmN0aW9uICgpIHsKCQkJdmFyIHNpYmxpbmdzID0gdGhpcy5fZWxlbUJ5U2xvdDsKCQkJdmFyIHNsb3Q7CgkJCWZvciAoc2xvdCBpbiBzaWJsaW5ncykgewoJCQkJaWYgKHNpYmxpbmdzLmhhc093blByb3BlcnR5KHNsb3QpICYmIHNsb3R0ZWRDb21wb25lbnRzW3Nsb3RdKSB7CgkJCQkJaWYgKHNsb3R0ZWRDb21wb25lbnRzW3Nsb3RdLnZpc2libGUpIHsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCXJldHVybiBmYWxzZTsKCQl9LAoKCQljaGlsZFZpc2libGU6IGZ1bmN0aW9uKGNoaWxkQ29tcG9uZW50LCB2aXNpYmxlKSB7CgkJCWlmICh2aXNpYmxlKSB7CgkJCQljaGlsZENvbXBvbmVudC5jb250YWluZXIuc2hvdygpOwoJCQl9IGVsc2UgaWYgKCFjaGlsZENvbXBvbmVudC5jb250YWluZXIuaGFzVmlzaWJsZUNvbXBvbmVudHMoKSkgewoJCQkJY2hpbGRDb21wb25lbnQuY29udGFpbmVyLmhpZGUoKTsKCQkJfQoJCQl2YXIgZ3JvdXAgPSB0aGlzLl9ncm91cEJ5Q29tcG9uZW50W2NoaWxkQ29tcG9uZW50LmlkXTsKCQkJaWYgKCFncm91cCkgewoJCQkJcmV0dXJuOwoJCQl9CgkJCWlmICh2aXNpYmxlKSB7CgkJCQlpZiAoMCA9PT0gZ3JvdXAudmlzaWJsZUNvdW50ZXIpIHsKCQkJCQlncm91cC5lbGVtZW50LnJlbW92ZUNsYXNzKCdhbG9oYS11aS1oaWRkZW4nKTsKCQkJCX0KCQkJCWdyb3VwLnZpc2libGVDb3VudGVyICs9IDE7CgkJCX0gZWxzZSB7CgkJCQlncm91cC52aXNpYmxlQ291bnRlciAtPSAxOwoJCQkJaWYgKDAgPT09IGdyb3VwLnZpc2libGVDb3VudGVyKSB7CgkJCQkJZ3JvdXAuZWxlbWVudC5hZGRDbGFzcygnYWxvaGEtdWktaGlkZGVuJyk7CgkJCQl9CgkJCX0KCQl9LAoKCQkvKioKCQkgKiBAb3ZlcnJpZGUKCQkgKi8KCQlzaG93OiBmdW5jdGlvbigpIHsKCQkJaWYgKCF0aGlzLmxpc3QuY2hpbGRyZW4oKS5sZW5ndGggfHwgIWhhc1Zpc2libGVDb21wb25lbnRzKHRoaXMpKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCXRoaXMuaGFuZGxlLnNob3coKTsKCQkJdGhpcy52aXNpYmxlID0gdHJ1ZTsKCgkJCS8vIEhpZGluZyBhbGwgdGFicyBtYXkgaGlkZSB0aGUgdG9vbGJhciwgc28gc2hvd2luZyB0aGUKCQkJLy8gZmlyc3QgdGFiIGFnYWluIG11c3QgYWxzbyBzaG93IHRoZSB0b29sYmFyLgoJCQl0aGlzLmNvbnRhaW5lci5zaG93KCk7CgoJCQkvLyBJZiBubyB0YWJzIGFyZSBzZWxlY3RlZCwgdGhlbiBzZWxlY3QgdGhlIHRhYiB3aGljaCB3YXMganVzdCBzaG93bi4KCQkJaWYgKCAgICF0aGlzLmNvbnRhaW5lci5maW5kKCcudWktdGFicy1hY3RpdmUnKS5sZW5ndGgKCQkJICAgIHx8ICB0aGlzLmNvbnRhaW5lci50YWJzKCdvcHRpb24nLCAnc2VsZWN0ZWQnKSA9PT0gdGhpcy5pbmRleCkgewoJCQkJdGhpcy5mb3JlZ3JvdW5kKCk7CgkJCX0KCQl9LAoKCQkvKioKCQkgKiBAb3ZlcnJpZGUKCQkgKi8KCQloaWRlOiBmdW5jdGlvbigpIHsKCQkJdmFyIHRhYnMgPSB0aGlzLmxpc3QuY2hpbGRyZW4oKTsKCQkJaWYgKCAwID09PSB0YWJzLmxlbmd0aCApIHsKCQkJCXJldHVybjsKCQkJfQoJCQl0aGlzLmhhbmRsZS5oaWRlKCk7CgkJCXRoaXMudmlzaWJsZSA9IGZhbHNlOwoKCQkJLy8gSWYgdGhlIHRhYiB3ZSBqdXN0IGhpZCB3YXMgdGhlIHNlbGVjdGVkIHRhYiwgdGhlbiB3ZSBuZWVkIHRvCgkJCS8vIHNlbGVjdCBhbm90aGVyIHRhYiBpbiBpdHMgc3RlYWQuICBXZSB3aWxsIHNlbGVjdCB0aGUgZmlyc3QKCQkJLy8gdmlzaWJsZSB0YWIgd2UgZmluZCwgb3IgZWxzZSB3ZSBkZXNlbGVjdCBhbGwgdGFicy4KCQkJaWYgKCB0aGlzLmluZGV4ID09PSB0aGlzLmNvbnRhaW5lci50YWJzKCAnb3B0aW9uJywgJ3NlbGVjdGVkJyApICkgewoJCQkJdGFicyA9IHRoaXMuY29udGFpbmVyLmRhdGEoICdhbG9oYS10YWJzJyApOwoKCQkJCXZhciBpOwoJCQkJZm9yICggaSA9IDA7IGkgPCB0YWJzLmxlbmd0aDsgKytpICkgewoJCQkJCWlmICggdGFic1sgaSBdLnZpc2libGUgKSB7CgkJCQkJCXRoaXMuY29udGFpbmVyLnRhYnMoICdzZWxlY3QnLCBpICk7CgkJCQkJCXJldHVybjsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gVGhpcyBkb2VzIG5vdCB3b3JrLi4uCgkJCQkvLyB0aGlzLmNvbnRhaW5lci50YWJzKCAnc2VsZWN0JywgLTEgKTsKCgkJCQkvLyBXaHkgZG8gd2UgcmVtb3ZlIHRoaXMgY2xhc3M/CgkJCQl0aGlzLmhhbmRsZS5yZW1vdmVDbGFzcyggJ3VpLXRhYnMtYWN0aXZlJyApOwoKCQkJCS8vIEl0IGRvZXNuJ3QgbWFrZSBhbnkgc2Vuc2UgdG8gbGVhdmUgdGhlIHRvb2xiYXIKCQkJCS8vIHZpc2libGUgYWZ0ZXIgYWxsIHRhYnMgaGF2ZSBiZWVuIGhpZGRlbi4KCQkJCXRoaXMuY29udGFpbmVyLmhpZGUoKTsKCQkJfQoJCX0KCgl9KTsKCgkkLmV4dGVuZChUYWIsIHsKCgkJLyoqCgkJICogQ3JlYXRlcyBob2xkaW5nIGVsZW1lbnRzIGZvciBqUXVlcnkgVUkgVGFicyBmb3IgYSBzdXJmYWNlLgoJCSAqCgkJICogQHN0YXRpYwoJCSAqIEByZXR1cm4ge2pRdWVyeS48SFRNTEVsZW1lbnQ+fSBUaGUgaG9sZGVyIGNvbnRhaW5lciBvbiB3aGljaCB3ZQoJCSAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZva2UgalF1ZXJ5IFVJIFRhYnMgb25jZSBpdCBpcwoJCSAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1bGF0ZWQgd2l0aCB0YWIgY29udGFpbmVycy4KCQkgKi8KCQljcmVhdGVDb250YWluZXI6IGZ1bmN0aW9uICgpIHsKCQkJdmFyICRjb250YWluZXIgPSAkKCc8ZGl2PicsIHsndW5zZWxlY3RhYmxlJzogJ29uJ30pOwoJCQl2YXIgJGxpc3QgPSAkKCc8dWw+Jywgeyd1bnNlbGVjdGFibGUnOiAnb24nfSkuYXBwZW5kVG8oJGNvbnRhaW5lcik7CgkJCXZhciAkcGFuZWxzID0gJCgnPGRpdj4nLCB7J3Vuc2VsZWN0YWJsZSc6ICdvbid9KS5hcHBlbmRUbygkY29udGFpbmVyKTsKCgkJCSRjb250YWluZXIKCQkJCS5kYXRhKCdsaXN0JywgJGxpc3QpCgkJCQkuZGF0YSgncGFuZWxzJywgJHBhbmVscykKCQkJCS5kYXRhKCdhbG9oYS10YWJzJywgW10pCgkJCQkudGFicyh7CgkJCQkJc2VsZWN0OiBmdW5jdGlvbiAoZXZlbnQsIHVpKSB7CgkJCQkJCXZhciB0YWJzID0gJGNvbnRhaW5lci5kYXRhKCdhbG9oYS10YWJzJyk7CgkJCQkJCSRjb250YWluZXIuZGF0YSgnYWxvaGEtYWN0aXZlLWNvbnRhaW5lcicsIHRhYnNbdWkuaW5kZXhdKTsKCQkJCQkJUHViU3ViLnB1YignYWxvaGEudWkuY29udGFpbmVyLnNlbGVjdGVkJywge2RhdGE6IHRhYnNbdWkuaW5kZXhdfSk7CgkJCQkJfQoJCQkJfSk7CgoJCQlyZXR1cm4gJGNvbnRhaW5lcjsKCQl9Cgl9KTsKCglyZXR1cm4gVGFiOwp9KTsK",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 00:02:01 GMT",
                    "Content-Length": "8427",
                    "Date": "Fri, 07 Nov 2014 00:02:04 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}