{
    "url": "http://localhost:9999/bitovi/canjs.com/steal/canjs/route/pushstate/pushstate.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>window.location.hash</b> and written to <b>window.history.pushState()</b> via the following statements:<ul><li>path += window.location.hash;</li><li>window.history.pushState(null, null, can.route._call(\"root\") + path);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/bitovi/canjs.com/steal/canjs/route/pushstate/pushstate.js",
                "path": "/bitovi/canjs.com/steal/canjs/route/pushstate/pushstate.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9iaXRvdmkvY2FuanMuY29tL3N0ZWFsL2NhbmpzL3JvdXRlL3B1c2hzdGF0ZS9wdXNoc3RhdGUuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjEzMw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAxNDozNzoyNyBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMTQ6Mzc6MjEgR01UDQoNCi8qIQogKiBDYW5KUyAtIDIuMS4zCiAqIGh0dHA6Ly9jYW5qcy51cy8KICogQ29weXJpZ2h0IChjKSAyMDE0IEJpdG92aQogKiBNb24sIDI1IEF1ZyAyMDE0IDIxOjUxOjI5IEdNVAogKiBMaWNlbnNlZCBNSVQKICogSW5jbHVkZXM6IENhbkpTIGRlZmF1bHQgYnVpbGQKICogRG93bmxvYWQgZnJvbTogaHR0cDovL2NhbmpzLnVzLwogKi8KLy8gIyBjYW4vcm91dGUvcHVzaHN0YXRlL3B1c2hzdGF0ZS5qcwovLwovLyBQbHVnaW4gZm9yIGBjYW4ucm91dGVgIHdoaWNoIHVzZXMgYnJvd3NlciBgaGlzdG9yeS5wdXNoU3RhdGVgIHN1cHBvcnQKLy8gdG8gdXBkYXRlIHdpbmRvdydzIHBhdGhuYW1lIGluc3RlYWQgb2YgdGhlIGBoYXNoYC4KLy8KLy8gSXQgcmVnaXN0ZXJzIGl0c2VsZiBhcyBiaW5kaW5nIG9uIGBjYW4ucm91dGVgLCBpbnRlcmNlcHRzIGBjbGlja2AgZXZlbnRzCi8vIG9uIGA8YT5gIGVsZW1lbnRzIGFjcm9zcyBkb2N1bWVudCBhbmQgYWNjb3JkaW5nbHkgdXBkYXRlcyBgY2FuLnJvdXRlYCBzdGF0ZQovLyBhbmQgd2luZG93J3MgcGF0aG5hbWUuCgovKmpzaGludCBtYXhkZXB0aDo2Ki8KCnN0ZWFsKCdjYW4vdXRpbCcsICdjYW4vcm91dGUnLCBmdW5jdGlvbiAoY2FuKSB7CgkidXNlIHN0cmljdCI7CgoJLy8gSW5pdGlhbGl6ZSBwbHVnaW4gb25seSBpZiBicm93c2VyIHN1cHBvcnRzIHB1c2hzdGF0ZS4KCWlmICh3aW5kb3cuaGlzdG9yeSAmJiBoaXN0b3J5LnB1c2hTdGF0ZSkgewoKCQkvLyBSZWdpc3RlcnMgaXRzZWxmIHdpdGhpbiBgY2FuLnJvdXRlLmJpbmRpbmdzYC4KCQljYW4ucm91dGUuYmluZGluZ3MucHVzaHN0YXRlID0gewoJCQkvKioKCQkJICogQHByb3BlcnR5IHtTdHJpbmd9IGNhbi5yb3V0ZS5wdXNoc3RhdGUucm9vdAoJCQkgKiBAcGFyZW50IGNhbi5yb3V0ZS5wdXNoc3RhdGUKCQkJICoKCQkJICogQGRlc2NyaXB0aW9uIENvbmZpZ3VyZSB0aGUgYmFzZSB1cmwgdGhhdCB3aWxsIG5vdCBiZSBtb2RpZmllZC4KCQkJICoKCQkJICogQG9wdGlvbiB7U3RyaW5nfSBSZXByZXNlbnRzIHRoZSBiYXNlIHVybCB0aGF0IHB1c2hzdGF0ZSB3aWxsIHByZXBlbmQgdG8gYWxsCgkJCSAqIHJvdXRlcy4gIGByb290YCBkZWZhdWx0cyB0bzogYCIvImAuCgkJCSAqCgkJCSAqIEBib2R5CgkJCSAqCgkJCSAqICMjIFVzZQoJCQkgKgoJCQkgKiBCeSBkZWZhdWx0LCBhIHJvdXRlIGxpa2U6CgkJCSAqCgkJCSAqICAgICBjYW4ucm91dGUoIjp0eXBlLzppZCIpCgkJCSAqCgkJCSAqIE1hdGNoZXMgdXJscyBsaWtlOgoJCQkgKgoJCQkgKiAgICAgaHR0cDovL2RvbWFpbi5jb20vY29udGFjdC81CgkJCSAqCgkJCSAqIEJ1dCBzb21ldGltZXMsIHlvdSBvbmx5IHdhbnQgdG8gbWF0Y2ggcGFnZXMgd2l0aGluIGEgY2VydGFpbiBkaXJlY3RvcnkuICBGb3IKCQkJICogZXhhbXBsZSwgYW4gYXBwbGljYXRpb24gdGhhdCBpcyBhIGZpbGVtYW5hZ2VyLiAgWW91IG1pZ2h0IHdhbnQgdG8KCQkJICogc3BlY2lmeSByb290IGFuZCByb3V0ZXMgbGlrZToKCQkJICoKCQkJICogICAgIGNhbi5yb3V0ZS5wdXNoc3RhdGUucm9vdCA9ICIvZmlsZW1hbmFnZXIvIgoJCQkgKiAgICAgY2FuLnJvdXRlKCJmaWxlLTpmaWxlSWQiKTsKCQkJICogICAgIGNhbi5yb3V0ZSgiZm9sZGVyLTpmaWxlSWQiKQoJCQkgKgoJCQkgKiBXaGljaCBtYXRjaGVzIHVybHMgbGlrZToKCQkJICoKCQkJICogICAgIGh0dHA6Ly9kb21haW4uY29tL2ZpbGVtYW5hZ2VyL2ZpbGUtMzQyMzQKCQkJICoKCQkJICovCgoJCQkvLyBTdGFydCBvZiBgbG9jYXRpb24ucGF0aG5hbWVgIGlzIHRoZSByb290LgoJCQkvLyAoQ2FuIGJlIGNvbmZpZ3VyZWQgdmlhIGBjYW4ucm91dGUuYmluZGluZ3MucHVzaHN0YXRlLnJvb3RgKQoJCQlyb290OiAiLyIsCgkJCS8vIGRvbid0IGdyZWVkaWx5IG1hdGNoIHNsYXNoZXMgaW4gcm91dGluZyBydWxlcwoJCQltYXRjaFNsYXNoZXM6IGZhbHNlLAoJCQlwYXJhbXNNYXRjaGVyOiAvXlw/KD86W149XSs9W14mXSomKSpbXj1dKz1bXiZdKi8sCgkJCXF1ZXJ5U2VwYXJhdG9yOiAnPycsCgoJCQkvLyAjIyBiaW5kCgoJCQkvLyBJbnRlcmNlcHRzIGNsaWNrcyBvbiBgPGE+YCBlbGVtZW50cyBhbmQgcmV3cml0ZXMgb3JpZ2luYWwgYGhpc3RvcnlgIG1ldGhvZHMuCgkJCWJpbmQ6IGZ1bmN0aW9uICgpIHsKCQkJCS8vIEludGVyY2VwdCByb3V0YWJsZSBsaW5rcy4KCQkJCWNhbi5kZWxlZ2F0ZS5jYWxsKGNhbi4kKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCksICdhJywgJ2NsaWNrJywgYW5jaG9yQ2xpY2tIYW5kbGVyKTsKCgkJCQkvLyBSZXdyaXRlcyBvcmlnaW5hbCBgcHVzaFN0YXRlYC9gcmVwbGFjZVN0YXRlYCBtZXRob2RzIG9uIGBoaXN0b3J5YCBhbmQga2VlcHMgcG9pbnRlciB0byBvcmlnaW5hbCBtZXRob2RzCgkJCQljYW4uZWFjaChtZXRob2RzVG9PdmVyd3JpdGUsIGZ1bmN0aW9uIChtZXRob2QpIHsKCQkJCQlvcmlnaW5hbE1ldGhvZHNbbWV0aG9kXSA9IHdpbmRvdy5oaXN0b3J5W21ldGhvZF07CgkJCQkJd2luZG93Lmhpc3RvcnlbbWV0aG9kXSA9IGZ1bmN0aW9uIChzdGF0ZSwgdGl0bGUsIHVybCkgewoJCQkJCQkvLyBBdm9pZCBkb3VibGVkIGhpc3Rvcnkgc3RhdGVzICh3aXRoIHB1c2hTdGF0ZSkuCgkJCQkJCXZhciBhYnNvbHV0ZSA9IHVybC5pbmRleE9mKCJodHRwIikgPT09IDA7CgkJCQkJCXZhciBzZWFyY2hIYXNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaCArIHdpbmRvdy5sb2NhdGlvbi5oYXNoOwoJCQkJCQkvLyBJZiB1cmwgZGlmZmVycyBmcm9tIGN1cnJlbnQgY2FsbCBvcmlnaW5hbCBoaXN0b3kgbWV0aG9kIGFuZCB1cGRhdGUgYGNhbi5yb3V0ZWAgc3RhdGUuCgkJCQkJCWlmICgoIWFic29sdXRlICYmIHVybCAhPT0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lICsgc2VhcmNoSGFzaCkgfHwgKGFic29sdXRlICYmIHVybCAhPT0gd2luZG93LmxvY2F0aW9uLmhyZWYgKyBzZWFyY2hIYXNoKSkgewoJCQkJCQkJb3JpZ2luYWxNZXRob2RzW21ldGhvZF0uYXBwbHkod2luZG93Lmhpc3RvcnksIGFyZ3VtZW50cyk7CgkJCQkJCQljYW4ucm91dGUuc2V0U3RhdGUoKTsKCQkJCQkJfQoJCQkJCX07CgkJCQl9KTsKCgkJCQkvLyBCaW5kIHRvIGBwb3BzdGF0ZWAgZXZlbnQsIGZpcmVzIG9uIGJhY2svZm9yd2FyZC4KCQkJCWNhbi5iaW5kLmNhbGwod2luZG93LCAncG9wc3RhdGUnLCBjYW4ucm91dGUuc2V0U3RhdGUpOwoJCQl9LAoKCQkJLy8gIyMgdW5iaW5kCgoJCQkvLyBVbmJpbmRzIGFuZCByZXN0b3JlcyBvcmlnaW5hbCBgaGlzdG9yeWAgbWV0aG9kcwoJCQl1bmJpbmQ6IGZ1bmN0aW9uICgpIHsKCQkJCWNhbi51bmRlbGVnYXRlLmNhbGwoY2FuLiQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSwgJ2NsaWNrJywgJ2EnLCBhbmNob3JDbGlja0hhbmRsZXIpOwoKCQkJCWNhbi5lYWNoKG1ldGhvZHNUb092ZXJ3cml0ZSwgZnVuY3Rpb24gKG1ldGhvZCkgewoJCQkJCXdpbmRvdy5oaXN0b3J5W21ldGhvZF0gPSBvcmlnaW5hbE1ldGhvZHNbbWV0aG9kXTsKCQkJCX0pOwoJCQkJY2FuLnVuYmluZC5jYWxsKHdpbmRvdywgJ3BvcHN0YXRlJywgY2FuLnJvdXRlLnNldFN0YXRlKTsKCQkJfSwKCgkJCS8vICMjIG1hdGNoaW5nUGFydE9mVVJMCgoJCQkvLyBSZXR1cm5zIG1hdGNoaW5nIHBhcnQgb2YgdXJsIHdpdGhvdXQgcm9vdC4KCQkJbWF0Y2hpbmdQYXJ0T2ZVUkw6IGZ1bmN0aW9uICgpIHsKCQkJCXZhciByb290ID0gY2xlYW5Sb290KCksCgkJCQkJbG9jID0gKGxvY2F0aW9uLnBhdGhuYW1lICsgbG9jYXRpb24uc2VhcmNoKSwKCQkJCQlpbmRleCA9IGxvYy5pbmRleE9mKHJvb3QpOwoKCQkJCXJldHVybiBsb2Muc3Vic3RyKGluZGV4ICsgcm9vdC5sZW5ndGgpOwoJCQl9LAoKCQkJLy8gIyMgc2V0VVJMCgoJCQkvLyBVcGRhdGVzIFVSTCBieSBjYWxsaW5nIGBwdXNoU3RhdGVgLgoJCQlzZXRVUkw6IGZ1bmN0aW9uIChwYXRoKSB7CgkJCQkvLyBLZWVwcyBoYXNoIGlmIG5vdCBpbiBwYXRoLgoJCQkJaWYgKGluY2x1ZGVIYXNoICYmIHBhdGguaW5kZXhPZigiIyIpID09PSAtMSAmJiB3aW5kb3cubG9jYXRpb24uaGFzaCkgewoJCQkJCXBhdGggKz0gd2luZG93LmxvY2F0aW9uLmhhc2g7CgkJCQl9CgkJCQl3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgY2FuLnJvdXRlLl9jYWxsKCJyb290IikgKyBwYXRoKTsKCQkJfQoJCX07CgoJCS8vICMjIGFuY2hvckNsaWNrSGFuZGxlcgoKCQkvLyBIYW5kbGVyIGZ1bmN0aW9uIGZvciBgY2xpY2tgIGV2ZW50cy4KCQl2YXIgYW5jaG9yQ2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHsKCQkJaWYgKCEoZS5pc0RlZmF1bHRQcmV2ZW50ZWQgPyBlLmlzRGVmYXVsdFByZXZlbnRlZCgpIDogZS5kZWZhdWx0UHJldmVudGVkID09PSB0cnVlKSkgewoJCQkJLy8gWVVJIGNhbGxzIGJhY2sgZXZlbnRzIHRyaWdnZXJlZCB3aXRoIHRoaXMgYXMgYSB3cmFwcGVkIG9iamVjdC4KCQkJCXZhciBub2RlID0gdGhpcy5fbm9kZSB8fCB0aGlzOwoJCQkJLy8gRml4IGZvciBJRSBzaG93aW5nIGJsYW5rIGhvc3QsIGJ1dCBibGFuayBob3N0IG1lYW5zIGN1cnJlbnQgaG9zdC4KCQkJCXZhciBsaW5rc0hvc3QgPSBub2RlLmhvc3QgfHwgd2luZG93LmxvY2F0aW9uLmhvc3Q7CgoJCQkJLy8gSWYgbGluayBpcyB3aXRoaW4gdGhlIHNhbWUgZG9tYWluIGFuZCBkZXNjZW5kYW50IG9mIGByb290YAoJCQkJaWYgKHdpbmRvdy5sb2NhdGlvbi5ob3N0ID09PSBsaW5rc0hvc3QpIHsKCQkJCQl2YXIgcm9vdCA9IGNsZWFuUm9vdCgpOwoJCQkJCWlmIChub2RlLnBhdGhuYW1lLmluZGV4T2Yocm9vdCkgPT09IDApIHsKCgkJCQkJCS8vIFJlbW92ZXMgcm9vdCBmcm9tIHVybC4KCQkJCQkJdmFyIHVybCA9IChub2RlLnBhdGhuYW1lICsgbm9kZS5zZWFyY2gpLnN1YnN0cihyb290Lmxlbmd0aCk7CgkJCQkJCS8vIElmIGEgcm91dGUgbWF0Y2hlcyB1cGRhdGUgdGhlIGRhdGEuCgkJCQkJCXZhciBjdXJQYXJhbXMgPSBjYW4ucm91dGUuZGVwYXJhbSh1cmwpOwoJCQkJCQlpZiAoY3VyUGFyYW1zLmhhc093blByb3BlcnR5KCdyb3V0ZScpKSB7CgkJCQkJCQkvLyBNYWtlcyBpdCBwb3NzaWJsZSB0byBoYXZlIGEgbGluayB3aXRoIGEgaGFzaC4KCQkJCQkJCWluY2x1ZGVIYXNoID0gdHJ1ZTsKCQkJCQkJCXdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBub2RlLmhyZWYpOwoKCQkJCQkJCS8vIFRlc3QgaWYgeW91IGNhbiBwcmV2ZW50RGVmYXVsdAoJCQkJCQkJLy8gb3VyIHRlc3RzIGNhbid0IGNhbGwgLmNsaWNrKCkgYi9jIHRoaXMKCQkJCQkJCS8vIGZyZWV6ZXMgcGhhbnRvbS4KCQkJCQkJCWlmIChlLnByZXZlbnREZWZhdWx0KSB7CgkJCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfSwKCgkJCS8vICMjIGNsZWFuUm9vdAoKCQkJLy8gQWx3YXlzIHJldHVybnMgY2xlYW4gcm9vdCwgd2l0aG91dCBkb21haW4uCgkJCWNsZWFuUm9vdCA9IGZ1bmN0aW9uICgpIHsKCQkJCXZhciBkb21haW4gPSBsb2NhdGlvbi5wcm90b2NvbCArICIvLyIgKyBsb2NhdGlvbi5ob3N0LAoJCQkJCXJvb3QgPSBjYW4ucm91dGUuX2NhbGwoInJvb3QiKSwKCQkJCQlpbmRleCA9IHJvb3QuaW5kZXhPZihkb21haW4pOwoJCQkJaWYgKGluZGV4ID09PSAwKSB7CgkJCQkJcmV0dXJuIHJvb3Quc3Vic3RyKGRvbWFpbi5sZW5ndGgpOwoJCQkJfQoJCQkJcmV0dXJuIHJvb3Q7CgkJCX0sCgkJCS8vIE9yaWdpbmFsIG1ldGhvZHMgb24gYGhpc3RvcnlgIHRoYXQgd2lsbCBiZSBvdmVyd3JpdHRlbgoJCQltZXRob2RzVG9PdmVyd3JpdGUgPSBbJ3B1c2hTdGF0ZScsICdyZXBsYWNlU3RhdGUnXSwKCQkJLy8gQSBwbGFjZSB0byBzdG9yZSBwb2ludGVycyB0byBvcmlnaW5hbCBgaGlzdG9yeWAgbWV0aG9kcy4KCQkJb3JpZ2luYWxNZXRob2RzID0ge30sCgkJCS8vIFVzZWQgdG8gdGVsbCBzZXRVUkwgdG8gaW5jbHVkZSB0aGUgaGFzaCBiZWNhdXNlIHdlIGNsaWNrZWQgb24gYSBsaW5rLgoJCQlpbmNsdWRlSGFzaCA9IGZhbHNlOwoKCQkvLyBFbmFibGVzIHBsdWdpbiwgYnkgZGVmYXVsdCBgaGFzaGNoYW5nZWAgYmluZGluZyBpcyB1c2VkLgoJCWNhbi5yb3V0ZS5kZWZhdWx0QmluZGluZyA9ICJwdXNoc3RhdGUiOwoJfQoKCXJldHVybiBjYW47Cn0pOwo=",
                "body": "LyohCiAqIENhbkpTIC0gMi4xLjMKICogaHR0cDovL2NhbmpzLnVzLwogKiBDb3B5cmlnaHQgKGMpIDIwMTQgQml0b3ZpCiAqIE1vbiwgMjUgQXVnIDIwMTQgMjE6NTE6MjkgR01UCiAqIExpY2Vuc2VkIE1JVAogKiBJbmNsdWRlczogQ2FuSlMgZGVmYXVsdCBidWlsZAogKiBEb3dubG9hZCBmcm9tOiBodHRwOi8vY2FuanMudXMvCiAqLwovLyAjIGNhbi9yb3V0ZS9wdXNoc3RhdGUvcHVzaHN0YXRlLmpzCi8vCi8vIFBsdWdpbiBmb3IgYGNhbi5yb3V0ZWAgd2hpY2ggdXNlcyBicm93c2VyIGBoaXN0b3J5LnB1c2hTdGF0ZWAgc3VwcG9ydAovLyB0byB1cGRhdGUgd2luZG93J3MgcGF0aG5hbWUgaW5zdGVhZCBvZiB0aGUgYGhhc2hgLgovLwovLyBJdCByZWdpc3RlcnMgaXRzZWxmIGFzIGJpbmRpbmcgb24gYGNhbi5yb3V0ZWAsIGludGVyY2VwdHMgYGNsaWNrYCBldmVudHMKLy8gb24gYDxhPmAgZWxlbWVudHMgYWNyb3NzIGRvY3VtZW50IGFuZCBhY2NvcmRpbmdseSB1cGRhdGVzIGBjYW4ucm91dGVgIHN0YXRlCi8vIGFuZCB3aW5kb3cncyBwYXRobmFtZS4KCi8qanNoaW50IG1heGRlcHRoOjYqLwoKc3RlYWwoJ2Nhbi91dGlsJywgJ2Nhbi9yb3V0ZScsIGZ1bmN0aW9uIChjYW4pIHsKCSJ1c2Ugc3RyaWN0IjsKCgkvLyBJbml0aWFsaXplIHBsdWdpbiBvbmx5IGlmIGJyb3dzZXIgc3VwcG9ydHMgcHVzaHN0YXRlLgoJaWYgKHdpbmRvdy5oaXN0b3J5ICYmIGhpc3RvcnkucHVzaFN0YXRlKSB7CgoJCS8vIFJlZ2lzdGVycyBpdHNlbGYgd2l0aGluIGBjYW4ucm91dGUuYmluZGluZ3NgLgoJCWNhbi5yb3V0ZS5iaW5kaW5ncy5wdXNoc3RhdGUgPSB7CgkJCS8qKgoJCQkgKiBAcHJvcGVydHkge1N0cmluZ30gY2FuLnJvdXRlLnB1c2hzdGF0ZS5yb290CgkJCSAqIEBwYXJlbnQgY2FuLnJvdXRlLnB1c2hzdGF0ZQoJCQkgKgoJCQkgKiBAZGVzY3JpcHRpb24gQ29uZmlndXJlIHRoZSBiYXNlIHVybCB0aGF0IHdpbGwgbm90IGJlIG1vZGlmaWVkLgoJCQkgKgoJCQkgKiBAb3B0aW9uIHtTdHJpbmd9IFJlcHJlc2VudHMgdGhlIGJhc2UgdXJsIHRoYXQgcHVzaHN0YXRlIHdpbGwgcHJlcGVuZCB0byBhbGwKCQkJICogcm91dGVzLiAgYHJvb3RgIGRlZmF1bHRzIHRvOiBgIi8iYC4KCQkJICoKCQkJICogQGJvZHkKCQkJICoKCQkJICogIyMgVXNlCgkJCSAqCgkJCSAqIEJ5IGRlZmF1bHQsIGEgcm91dGUgbGlrZToKCQkJICoKCQkJICogICAgIGNhbi5yb3V0ZSgiOnR5cGUvOmlkIikKCQkJICoKCQkJICogTWF0Y2hlcyB1cmxzIGxpa2U6CgkJCSAqCgkJCSAqICAgICBodHRwOi8vZG9tYWluLmNvbS9jb250YWN0LzUKCQkJICoKCQkJICogQnV0IHNvbWV0aW1lcywgeW91IG9ubHkgd2FudCB0byBtYXRjaCBwYWdlcyB3aXRoaW4gYSBjZXJ0YWluIGRpcmVjdG9yeS4gIEZvcgoJCQkgKiBleGFtcGxlLCBhbiBhcHBsaWNhdGlvbiB0aGF0IGlzIGEgZmlsZW1hbmFnZXIuICBZb3UgbWlnaHQgd2FudCB0bwoJCQkgKiBzcGVjaWZ5IHJvb3QgYW5kIHJvdXRlcyBsaWtlOgoJCQkgKgoJCQkgKiAgICAgY2FuLnJvdXRlLnB1c2hzdGF0ZS5yb290ID0gIi9maWxlbWFuYWdlci8iCgkJCSAqICAgICBjYW4ucm91dGUoImZpbGUtOmZpbGVJZCIpOwoJCQkgKiAgICAgY2FuLnJvdXRlKCJmb2xkZXItOmZpbGVJZCIpCgkJCSAqCgkJCSAqIFdoaWNoIG1hdGNoZXMgdXJscyBsaWtlOgoJCQkgKgoJCQkgKiAgICAgaHR0cDovL2RvbWFpbi5jb20vZmlsZW1hbmFnZXIvZmlsZS0zNDIzNAoJCQkgKgoJCQkgKi8KCgkJCS8vIFN0YXJ0IG9mIGBsb2NhdGlvbi5wYXRobmFtZWAgaXMgdGhlIHJvb3QuCgkJCS8vIChDYW4gYmUgY29uZmlndXJlZCB2aWEgYGNhbi5yb3V0ZS5iaW5kaW5ncy5wdXNoc3RhdGUucm9vdGApCgkJCXJvb3Q6ICIvIiwKCQkJLy8gZG9uJ3QgZ3JlZWRpbHkgbWF0Y2ggc2xhc2hlcyBpbiByb3V0aW5nIHJ1bGVzCgkJCW1hdGNoU2xhc2hlczogZmFsc2UsCgkJCXBhcmFtc01hdGNoZXI6IC9eXD8oPzpbXj1dKz1bXiZdKiYpKltePV0rPVteJl0qLywKCQkJcXVlcnlTZXBhcmF0b3I6ICc/JywKCgkJCS8vICMjIGJpbmQKCgkJCS8vIEludGVyY2VwdHMgY2xpY2tzIG9uIGA8YT5gIGVsZW1lbnRzIGFuZCByZXdyaXRlcyBvcmlnaW5hbCBgaGlzdG9yeWAgbWV0aG9kcy4KCQkJYmluZDogZnVuY3Rpb24gKCkgewoJCQkJLy8gSW50ZXJjZXB0IHJvdXRhYmxlIGxpbmtzLgoJCQkJY2FuLmRlbGVnYXRlLmNhbGwoY2FuLiQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSwgJ2EnLCAnY2xpY2snLCBhbmNob3JDbGlja0hhbmRsZXIpOwoKCQkJCS8vIFJld3JpdGVzIG9yaWdpbmFsIGBwdXNoU3RhdGVgL2ByZXBsYWNlU3RhdGVgIG1ldGhvZHMgb24gYGhpc3RvcnlgIGFuZCBrZWVwcyBwb2ludGVyIHRvIG9yaWdpbmFsIG1ldGhvZHMKCQkJCWNhbi5lYWNoKG1ldGhvZHNUb092ZXJ3cml0ZSwgZnVuY3Rpb24gKG1ldGhvZCkgewoJCQkJCW9yaWdpbmFsTWV0aG9kc1ttZXRob2RdID0gd2luZG93Lmhpc3RvcnlbbWV0aG9kXTsKCQkJCQl3aW5kb3cuaGlzdG9yeVttZXRob2RdID0gZnVuY3Rpb24gKHN0YXRlLCB0aXRsZSwgdXJsKSB7CgkJCQkJCS8vIEF2b2lkIGRvdWJsZWQgaGlzdG9yeSBzdGF0ZXMgKHdpdGggcHVzaFN0YXRlKS4KCQkJCQkJdmFyIGFic29sdXRlID0gdXJsLmluZGV4T2YoImh0dHAiKSA9PT0gMDsKCQkJCQkJdmFyIHNlYXJjaEhhc2ggPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoICsgd2luZG93LmxvY2F0aW9uLmhhc2g7CgkJCQkJCS8vIElmIHVybCBkaWZmZXJzIGZyb20gY3VycmVudCBjYWxsIG9yaWdpbmFsIGhpc3RveSBtZXRob2QgYW5kIHVwZGF0ZSBgY2FuLnJvdXRlYCBzdGF0ZS4KCQkJCQkJaWYgKCghYWJzb2x1dGUgJiYgdXJsICE9PSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgKyBzZWFyY2hIYXNoKSB8fCAoYWJzb2x1dGUgJiYgdXJsICE9PSB3aW5kb3cubG9jYXRpb24uaHJlZiArIHNlYXJjaEhhc2gpKSB7CgkJCQkJCQlvcmlnaW5hbE1ldGhvZHNbbWV0aG9kXS5hcHBseSh3aW5kb3cuaGlzdG9yeSwgYXJndW1lbnRzKTsKCQkJCQkJCWNhbi5yb3V0ZS5zZXRTdGF0ZSgpOwoJCQkJCQl9CgkJCQkJfTsKCQkJCX0pOwoKCQkJCS8vIEJpbmQgdG8gYHBvcHN0YXRlYCBldmVudCwgZmlyZXMgb24gYmFjay9mb3J3YXJkLgoJCQkJY2FuLmJpbmQuY2FsbCh3aW5kb3csICdwb3BzdGF0ZScsIGNhbi5yb3V0ZS5zZXRTdGF0ZSk7CgkJCX0sCgoJCQkvLyAjIyB1bmJpbmQKCgkJCS8vIFVuYmluZHMgYW5kIHJlc3RvcmVzIG9yaWdpbmFsIGBoaXN0b3J5YCBtZXRob2RzCgkJCXVuYmluZDogZnVuY3Rpb24gKCkgewoJCQkJY2FuLnVuZGVsZWdhdGUuY2FsbChjYW4uJChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLCAnY2xpY2snLCAnYScsIGFuY2hvckNsaWNrSGFuZGxlcik7CgoJCQkJY2FuLmVhY2gobWV0aG9kc1RvT3ZlcndyaXRlLCBmdW5jdGlvbiAobWV0aG9kKSB7CgkJCQkJd2luZG93Lmhpc3RvcnlbbWV0aG9kXSA9IG9yaWdpbmFsTWV0aG9kc1ttZXRob2RdOwoJCQkJfSk7CgkJCQljYW4udW5iaW5kLmNhbGwod2luZG93LCAncG9wc3RhdGUnLCBjYW4ucm91dGUuc2V0U3RhdGUpOwoJCQl9LAoKCQkJLy8gIyMgbWF0Y2hpbmdQYXJ0T2ZVUkwKCgkJCS8vIFJldHVybnMgbWF0Y2hpbmcgcGFydCBvZiB1cmwgd2l0aG91dCByb290LgoJCQltYXRjaGluZ1BhcnRPZlVSTDogZnVuY3Rpb24gKCkgewoJCQkJdmFyIHJvb3QgPSBjbGVhblJvb3QoKSwKCQkJCQlsb2MgPSAobG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5zZWFyY2gpLAoJCQkJCWluZGV4ID0gbG9jLmluZGV4T2Yocm9vdCk7CgoJCQkJcmV0dXJuIGxvYy5zdWJzdHIoaW5kZXggKyByb290Lmxlbmd0aCk7CgkJCX0sCgoJCQkvLyAjIyBzZXRVUkwKCgkJCS8vIFVwZGF0ZXMgVVJMIGJ5IGNhbGxpbmcgYHB1c2hTdGF0ZWAuCgkJCXNldFVSTDogZnVuY3Rpb24gKHBhdGgpIHsKCQkJCS8vIEtlZXBzIGhhc2ggaWYgbm90IGluIHBhdGguCgkJCQlpZiAoaW5jbHVkZUhhc2ggJiYgcGF0aC5pbmRleE9mKCIjIikgPT09IC0xICYmIHdpbmRvdy5sb2NhdGlvbi5oYXNoKSB7CgkJCQkJcGF0aCArPSB3aW5kb3cubG9jYXRpb24uaGFzaDsKCQkJCX0KCQkJCXdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBjYW4ucm91dGUuX2NhbGwoInJvb3QiKSArIHBhdGgpOwoJCQl9CgkJfTsKCgkJLy8gIyMgYW5jaG9yQ2xpY2tIYW5kbGVyCgoJCS8vIEhhbmRsZXIgZnVuY3Rpb24gZm9yIGBjbGlja2AgZXZlbnRzLgoJCXZhciBhbmNob3JDbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkgewoJCQlpZiAoIShlLmlzRGVmYXVsdFByZXZlbnRlZCA/IGUuaXNEZWZhdWx0UHJldmVudGVkKCkgOiBlLmRlZmF1bHRQcmV2ZW50ZWQgPT09IHRydWUpKSB7CgkJCQkvLyBZVUkgY2FsbHMgYmFjayBldmVudHMgdHJpZ2dlcmVkIHdpdGggdGhpcyBhcyBhIHdyYXBwZWQgb2JqZWN0LgoJCQkJdmFyIG5vZGUgPSB0aGlzLl9ub2RlIHx8IHRoaXM7CgkJCQkvLyBGaXggZm9yIElFIHNob3dpbmcgYmxhbmsgaG9zdCwgYnV0IGJsYW5rIGhvc3QgbWVhbnMgY3VycmVudCBob3N0LgoJCQkJdmFyIGxpbmtzSG9zdCA9IG5vZGUuaG9zdCB8fCB3aW5kb3cubG9jYXRpb24uaG9zdDsKCgkJCQkvLyBJZiBsaW5rIGlzIHdpdGhpbiB0aGUgc2FtZSBkb21haW4gYW5kIGRlc2NlbmRhbnQgb2YgYHJvb3RgCgkJCQlpZiAod2luZG93LmxvY2F0aW9uLmhvc3QgPT09IGxpbmtzSG9zdCkgewoJCQkJCXZhciByb290ID0gY2xlYW5Sb290KCk7CgkJCQkJaWYgKG5vZGUucGF0aG5hbWUuaW5kZXhPZihyb290KSA9PT0gMCkgewoKCQkJCQkJLy8gUmVtb3ZlcyByb290IGZyb20gdXJsLgoJCQkJCQl2YXIgdXJsID0gKG5vZGUucGF0aG5hbWUgKyBub2RlLnNlYXJjaCkuc3Vic3RyKHJvb3QubGVuZ3RoKTsKCQkJCQkJLy8gSWYgYSByb3V0ZSBtYXRjaGVzIHVwZGF0ZSB0aGUgZGF0YS4KCQkJCQkJdmFyIGN1clBhcmFtcyA9IGNhbi5yb3V0ZS5kZXBhcmFtKHVybCk7CgkJCQkJCWlmIChjdXJQYXJhbXMuaGFzT3duUHJvcGVydHkoJ3JvdXRlJykpIHsKCQkJCQkJCS8vIE1ha2VzIGl0IHBvc3NpYmxlIHRvIGhhdmUgYSBsaW5rIHdpdGggYSBoYXNoLgoJCQkJCQkJaW5jbHVkZUhhc2ggPSB0cnVlOwoJCQkJCQkJd2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIG5vZGUuaHJlZik7CgoJCQkJCQkJLy8gVGVzdCBpZiB5b3UgY2FuIHByZXZlbnREZWZhdWx0CgkJCQkJCQkvLyBvdXIgdGVzdHMgY2FuJ3QgY2FsbCAuY2xpY2soKSBiL2MgdGhpcwoJCQkJCQkJLy8gZnJlZXplcyBwaGFudG9tLgoJCQkJCQkJaWYgKGUucHJldmVudERlZmF1bHQpIHsKCQkJCQkJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9LAoKCQkJLy8gIyMgY2xlYW5Sb290CgoJCQkvLyBBbHdheXMgcmV0dXJucyBjbGVhbiByb290LCB3aXRob3V0IGRvbWFpbi4KCQkJY2xlYW5Sb290ID0gZnVuY3Rpb24gKCkgewoJCQkJdmFyIGRvbWFpbiA9IGxvY2F0aW9uLnByb3RvY29sICsgIi8vIiArIGxvY2F0aW9uLmhvc3QsCgkJCQkJcm9vdCA9IGNhbi5yb3V0ZS5fY2FsbCgicm9vdCIpLAoJCQkJCWluZGV4ID0gcm9vdC5pbmRleE9mKGRvbWFpbik7CgkJCQlpZiAoaW5kZXggPT09IDApIHsKCQkJCQlyZXR1cm4gcm9vdC5zdWJzdHIoZG9tYWluLmxlbmd0aCk7CgkJCQl9CgkJCQlyZXR1cm4gcm9vdDsKCQkJfSwKCQkJLy8gT3JpZ2luYWwgbWV0aG9kcyBvbiBgaGlzdG9yeWAgdGhhdCB3aWxsIGJlIG92ZXJ3cml0dGVuCgkJCW1ldGhvZHNUb092ZXJ3cml0ZSA9IFsncHVzaFN0YXRlJywgJ3JlcGxhY2VTdGF0ZSddLAoJCQkvLyBBIHBsYWNlIHRvIHN0b3JlIHBvaW50ZXJzIHRvIG9yaWdpbmFsIGBoaXN0b3J5YCBtZXRob2RzLgoJCQlvcmlnaW5hbE1ldGhvZHMgPSB7fSwKCQkJLy8gVXNlZCB0byB0ZWxsIHNldFVSTCB0byBpbmNsdWRlIHRoZSBoYXNoIGJlY2F1c2Ugd2UgY2xpY2tlZCBvbiBhIGxpbmsuCgkJCWluY2x1ZGVIYXNoID0gZmFsc2U7CgoJCS8vIEVuYWJsZXMgcGx1Z2luLCBieSBkZWZhdWx0IGBoYXNoY2hhbmdlYCBiaW5kaW5nIGlzIHVzZWQuCgkJY2FuLnJvdXRlLmRlZmF1bHRCaW5kaW5nID0gInB1c2hzdGF0ZSI7Cgl9CgoJcmV0dXJuIGNhbjsKfSk7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 14:37:21 GMT",
                    "Content-Length": "6133",
                    "Date": "Thu, 06 Nov 2014 14:37:27 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}