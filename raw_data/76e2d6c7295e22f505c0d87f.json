{
    "url": "http://localhost:9999/leapmotion/leapjs-plugins/main/transform/",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>window.location.href</b> and written to <b>the 'href' property of a DOM element</b> via the following statement:<ul><li>document.getElementById('view-source').href = window.location.href.replace(/^(.*)\\/\\//, 'view-source:')</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/leapmotion/leapjs-plugins/main/transform/",
                "path": "/leapmotion/leapjs-plugins/main/transform/",
                "httpVersion": "HTTP/0.0",
                "method": "GET",
                "headers": {
                    "Referer": "http://localhost:9999/leapmotion/leapjs-plugins/main/transform",
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9sZWFwbW90aW9uL2xlYXBqcy1wbHVnaW5zL21haW4vdHJhbnNmb3JtLyBIVFRQLzAuMA0KSG9zdDogbG9jYWxob3N0Ojk5OTkNClJlZmVyZXI6IGh0dHA6Ly9sb2NhbGhvc3Q6OTk5OS9sZWFwbW90aW9uL2xlYXBqcy1wbHVnaW5zL21haW4vdHJhbnNmb3JtDQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjU4NQ0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBGcmksIDA3IE5vdiAyMDE0IDA4OjMzOjAzIEdNVA0KTGFzdC1Nb2RpZmllZDogRnJpLCAwNyBOb3YgMjAxNCAwODozMzowMiBHTVQNCg0KPCFET0NUWVBFIEhUTUw+CjxodG1sPgo8aGVhZD4KICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgPHRpdGxlPkxlYXAgVHJhbnNmb3JtIFBsdWdpbjwvdGl0bGU+CgogIDxzdHlsZT4KICAgIGJvZHl7CiAgICAgIG1hcmdpbjogMDsKICAgICAgZm9udC1mYW1pbHk6IEhlbHZldGljYTsKICAgIH0KICAgIGNhbnZhc3sKICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICB9CiAgICBpbnB1dHsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgfQogICAgI2Nvbm5lY3QtbGVhcHsKICAgICAgYm90dG9tOiAwOwogICAgICB0b3A6IGF1dG8gIWltcG9ydGFudDsKICAgIH0KCiAgICB0YWJsZSwgdGgsIHRkIHsKICAgICAgYm9yZGVyOiAxcHggc29saWQgI2FhYTsKICAgIH0KICAgIHRhYmxlIHsKICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKICAgIH0KICAgIHRkLCB0aCB7CiAgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7CiAgICAgIHBhZGRpbmc6IDNweDsKICAgIH0KICAgIHRoIHsKICAgICAgY29sb3I6ICM1NTU7CiAgICB9CiAgICAjdmlldy1zb3VyY2UgewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMDsKICAgICAgcmlnaHQ6IDA7CiAgICAgIG1hcmdpbjogMTBweDsKICAgIH0KICA8L3N0eWxlPgoKCiAgPHNjcmlwdCBzcmM9Ii8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3RocmVlLmpzL3I2OC90aHJlZS5taW4uanMiPjwvc2NyaXB0PgogIDxzY3JpcHQgc3JjPSIvL2pzLmxlYXBtb3Rpb24uY29tL2xlYXAtMC42LjMubWluLmpzIj48L3NjcmlwdD4KICA8c2NyaXB0IHNyYz0iLi4vbGVhcC1wbHVnaW5zLTAuMS45LmpzIj48L3NjcmlwdD4KICA8c2NyaXB0IHNyYz0iLy9qcy5sZWFwbW90aW9uLmNvbS9sZWFwLnJpZ2dlZC1oYW5kLTAuMS41Lm1pbi5qcyI+PC9zY3JpcHQ+Cgo8L2hlYWQ+Cjxib2R5PgoKPGEgaWQ9InZpZXctc291cmNlIiBocmVmPSIjIj5WaWV3IFNvdXJjZTwvYT4KCjxoMT5UcmFuc2Zvcm0gUGx1Z2luPC9oMT4KPHA+CiAgVHJhbnNmb3JtcyBMZWFwIGRhdGEgYmFzZWQgb2ZmIG9mIGEgcm90YXRpb24gbWF0cml4IG9yIGEgVEhSRUUuanMgcm90YXRpb24gYW5kIHZlY3RvcnMuCjwvcD4KPHA+CiAgSGVyZSB3ZSB1c2UgdGhlIHJpZ2dlZEhhbmQgdG8gdmlzdWFsaXplIHRoZSB0cmFuc2Zvcm1hdGlvbnMsIGJ1dCBpdCBpcyBub3QgcmVxdWlyZWQuICBBbGwgZGF0YSBpbiB0aGUgZnJhbWUgaXMgYWx0ZXJlZAogIGJ5IHRoZSB0cmFuc2Zvcm0gcGx1Z2luLgo8L3A+CjxwPgogIFBhcmFtZXRlcnMgY2FuIGJlIGVpdGhlciBzdGF0aWMgb2JqZWN0cyBvciBtZXRob2RzIHdoaWNoIHRyYW5zZm9ybSBvbiBldmVyeSBmcmFtZS4KPC9wPgo8cD4KICBJbiB0aGlzIHdheSwgeW91IGNhbiB0aGVuIHRyYW5zZm9ybSBpbmRpdmlkdWFsIGhhbmRzIGJhc2VkIHVwb24gdGhlaXIgaWQuCjwvcD4KCjxici8+Cgo8ZGl2IHN0eWxlPSJmbG9hdDogbGVmdDsiPgogIDxsYWJlbD5Sb3RhdGlvbjogPHNwYW4gaWQ9InJvdGF0aW9uT3V0cHV0Ij4wPC9zcGFuPs+APC9sYWJlbD48YnIvPgogIDxpbnB1dCBpZD0icm90YXRpb25JbnB1dCIgdHlwZT0icmFuZ2UiIG1pbj0iLTEiIG1heD0iMSIgdmFsdWU9IjAiIHN0ZXA9IjAuMDAxIj4KPC9kaXY+Cgo8ZGl2IHN0eWxlPSJmbG9hdDogbGVmdDsiPgogIDxsYWJlbD5aIFBvc2l0aW9uOiA8c3BhbiBpZD0icG9zaXRpb25PdXRwdXQiPjA8L3NwYW4+PC9sYWJlbD48YnIvPgogIDxpbnB1dCBpZD0icG9zaXRpb25JbnB1dCIgdHlwZT0icmFuZ2UiIG1pbj0iLTEwMDAiIG1heD0iMzAwIiB2YWx1ZT0iMCIgc3RlcD0iMSI+CjwvZGl2PgoKPGRpdiBzdHlsZT0iZmxvYXQ6IGxlZnQ7Ij4KICA8bGFiZWw+U2NhbGU6IDxzcGFuIGlkPSJzY2FsZU91dHB1dCI+MC4zPC9zcGFuPjwvbGFiZWw+PGJyLz4KICA8aW5wdXQgaWQ9InNjYWxlSW5wdXQiIHR5cGU9InJhbmdlIiBtaW49IjAuMSIgbWF4PSIxIiB2YWx1ZT0iMC4zIiBzdGVwPSIwLjAxIj4KICA8IS0tIG5vdGUgLSB0aGVyZSBzZWVtcyB0byBiZSBhIHN0cmFuZ2UgaXNzdWUgd2l0aCBUSFJFRWpzIHNlY3Rpb25zIG9mIHRoZSBoYW5kIGRpc2FwcGVhcmluZyBmb3Igc2NhbGVzIGxhcmdlciB0aGFuIDEuCiAgICAgICBTY2FsZSBzZXQgYXMgYW4gb3B0aW9uIGZvciB0aGUgcmlnZ2VkSGFuZCB3aWxsIGNhdXNlIHRoZSBpc3N1ZS4gIC0tPgo8L2Rpdj4KPGRpdiBzdHlsZT0iZmxvYXQ6IGxlZnQ7IHBhZGRpbmc6IDEwcHgiPgogIDxidXR0b24gaWQ9InNob3dIaWRlIj5TaG93L0hpZGU8L2J1dHRvbj4KPC9kaXY+Cgo8YnIvPgoKPHByZT48Y29kZT4KICAvLyBBdCB0aGUgc2ltcGxlc3Q6CiAgTGVhcC5sb29wKCkKICAgIC51c2UoJ3RyYW5zZm9ybScsIHsKICAgICAgLy8gbW92ZSAyMCBjbSBiYWNrLgogICAgICBwb3NpdGlvbjogbmV3IFRIUkVFLlZlY3RvcjMoMCwwLC0yMDApCiAgICB9KTsKPC9jb2RlPjwvcHJlPgoKPGJyLz4KCjxoMz5PcHRpb25zPC9oMz4KCjx0YWJsZT4KICA8dHI+CiAgICA8dGg+TmFtZTwvdGg+CiAgICA8dGg+RGVmYXVsdDwvdGg+CiAgICA8dGg+RGVzY3JpcHRpb248L3RoPgogIDwvdHI+CiAgPHRyPgogICAgPHRkPlZSPC90ZD4KICAgIDx0ZD5mYWxzZTwvdGQ+CiAgICA8dGQ+CiAgICAgIFNldHMgc2NhbGUsIHBvc2l0aW9uLCBhbmQgcm90YXRpb24gdHJhbnNmb3JtcyBmb3IgSE1EIG1vZGUuICBUaGVzZSBhcmU6IHVuaXRzIGluIG1ldGVycywgOGNtIGZvcndhcmQsIGFuZCBhbGwgeCwgeSwgYW5kIHogYXhpcyBmbGlwcGVkLiBBbHNvIHRlbGxzIHRyYWNraW5nIHRvIHVzZSBoZWFkLW1vdW50ZWQgZGV2aWNlIG1vZGUuCiAgICA8L3RkPgogIDwvdHI+CiAgPHRyPgogICAgPHRkPnBvc2l0aW9uPC90ZD4KICAgIDx0ZD51bmRlZmluZWQ8L3RkPgogICAgPHRkPkEgVEhSRUUuVmVjdG9yMyBwb3NpdGlvbiBvZmZzZXQgdmVjdG9yPC90ZD4KICA8L3RyPgogIDx0cj4KICAgIDx0ZD5xdWF0ZXJuaW9uPC90ZD4KICAgIDx0ZD51bmRlZmluZWQ8L3RkPgogICAgPHRkPkEgVEhSRUUuUXVhdGVybmlvbiByb3RhdGlvbjwvdGQ+CiAgPC90cj4KICA8dHI+CiAgICA8dGQ+c2NhbGU8L3RkPgogICAgPHRkPnVuZGVmaW5lZDwvdGQ+CiAgICA8dGQ+QSBUSFJFRS5WZWN0b3Igc2NhbGUgdmVjdG9yLCBvciBhIHNpbmdsZSBzY2FsYXIgdG8gYmUgYXBwbGllZCB0byBhbGwgdGhyZWUgYXhpcy48L3RkPgogIDwvdHI+CiAgPHRyPgogICAgPHRkPmVmZmVjdGl2ZVBhcmVudDwvdGQ+CiAgICA8dGQ+dW5kZWZpbmVkPC90ZD4KICAgIDx0ZD5BIFRIUkVFLk9iamVjdDNkLCBvciBhbnl0aGluZyB3aGljaCByZXNwb25kcyB0byBgbWF0cml4V29ybGRgIGFuZCBgc2NhbGVgLiBUaGlzIG1hdHJpeFdvcmxkIGlzIGFwcGxpZWQgdG8gdGhlCiAgICAgIGhhbmQgZGF0YSBhcyB3ZWxsIGFzIGFueSB0cmFuc2Zvcm1hdGlvbnMgc3BlY2lmaWVkIHRocm91Z2ggdGhlIG90aGVyIG9wdGlvbnMuICBUaGlzIGFsbG93cyBoYW5kcyB0byBiZSAiYXR0YWNoZWQiCiAgICAgIHRvIGEgY2FtZXJhLjwvdGQ+CiAgPC90cj4KPC90YWJsZT4KCgo8L2JvZHk+CgoKCjxzY3JpcHQ+CiAgLy8gYWxsIHVuaXRzIGluIG1tCiAgdmFyIGluaXRTY2VuZSA9IGZ1bmN0aW9uICgpIHsKICAgIHdpbmRvdy5zY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOwogICAgd2luZG93LnJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoewogICAgICBhbHBoYTogdHJ1ZQogICAgfSk7CgogICAgd2luZG93LnJlbmRlcmVyLnNldENsZWFyQ29sb3IoMHgwMDAwMDAsIDApOwogICAgd2luZG93LnJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7CgogICAgd2luZG93LnJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnOwogICAgd2luZG93LnJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUudG9wID0gMDsKICAgIHdpbmRvdy5yZW5kZXJlci5kb21FbGVtZW50LnN0eWxlLmxlZnQgPSAwOwogICAgd2luZG93LnJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUud2lkdGggPSAnMTAwJSc7CiAgICB3aW5kb3cucmVuZGVyZXIuZG9tRWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7CgogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh3aW5kb3cucmVuZGVyZXIuZG9tRWxlbWVudCk7CgogICAgd2luZG93LnNjZW5lLmFkZChuZXcgVEhSRUUuQW1iaWVudExpZ2h0KDB4ODg4ODg4KSk7CgogICAgdmFyIHBvaW50TGlnaHQgPSBuZXcgVEhSRUUuUG9pbnRMaWdodCgweEZGZmZmZik7CiAgICBwb2ludExpZ2h0LnBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoLTIwLCAxMCwgMTAwKTsKICAgIHBvaW50TGlnaHQubG9va0F0KG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAsIDApKTsKICAgIHdpbmRvdy5zY2VuZS5hZGQocG9pbnRMaWdodCk7CgogICAgd2luZG93LmNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg0NSwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMTAwMDApOwogICAgd2luZG93LmNhbWVyYS5wb3NpdGlvbi5mcm9tQXJyYXkoWzAsIDE2MCwgNDAwXSk7CiAgICB3aW5kb3cuY2FtZXJhLmxvb2tBdChuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAwKSk7CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHsKCiAgICAgIGNhbWVyYS5hc3BlY3QgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodDsKICAgICAgY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgICAgcmVuZGVyZXIuc2V0U2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTsKICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpOwoKICAgIH0sIGZhbHNlKTsKCiAgICBzY2VuZS5hZGQoY2FtZXJhKTsKCgogICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpOwogIH07CgogIGluaXRTY2VuZSgpOwoKCgoKICBMZWFwLmxvb3AoKQogIC8vIG5vdGUgdGhhdCB0cmFuc2Zvcm0gbXVzdCBiZSBfYmVmb3JlXyByaWdnZWQgaGFuZAogIC51c2UoJ3RyYW5zZm9ybScsIHsKICAgIHF1YXRlcm5pb246IG5ldyBUSFJFRS5RdWF0ZXJuaW9uLAogICAgcG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IzLAogICAgc2NhbGU6IDAuMwogIH0pCiAgLnVzZSgncGxheWJhY2snLCB7cmVjb3JkaW5nOiAnZmluZ2VyLXRhcC01NGZwcy5qc29uLmx6J30pCiAgLnVzZSgncmlnZ2VkSGFuZCcsIHsKICAgIGRvdHNNb2RlOiBmYWxzZSwKICAgIHBhcmVudDogc2NlbmUsCiAgICByZW5kZXJGbjogZnVuY3Rpb24oKXsKICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpOwogICAgfQoKICB9KQogIC5jb25uZWN0KCk7CgogIHdpbmRvdy50cmFuc2Zvcm1QbHVnaW4gPSBMZWFwLmxvb3BDb250cm9sbGVyLnBsdWdpbnMudHJhbnNmb3JtOwoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm90YXRpb25JbnB1dCcpLm9uaW5wdXQgPSBmdW5jdGlvbihlKXsKICAgIHZhciB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlOwogICAgdHJhbnNmb3JtUGx1Z2luLnF1YXRlcm5pb24uc2V0RnJvbUV1bGVyKAogICAgICAgIG5ldyBUSFJFRS5FdWxlcigwLCBNYXRoLlBJICogcGFyc2VGbG9hdCh2YWx1ZSwxMCkgLCAwKQogICAgKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb3RhdGlvbk91dHB1dCcpLmlubmVySFRNTCA9IHZhbHVlOwogIH07CgogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3NpdGlvbklucHV0Jykub25pbnB1dCA9IGZ1bmN0aW9uKGUpewogICAgdmFyIHZhbHVlID0gZS50YXJnZXQudmFsdWU7CiAgICB0cmFuc2Zvcm1QbHVnaW4ucG9zaXRpb24uc2V0KAogICAgICAgIDAsMCxwYXJzZUludCh2YWx1ZSwgMTApCiAgICApOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bvc2l0aW9uT3V0cHV0JykuaW5uZXJIVE1MID0gdmFsdWU7CiAgfTsKCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYWxlSW5wdXQnKS5vbmlucHV0ID0gZnVuY3Rpb24oZSl7CiAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlLDEwKTsKICAgIHRyYW5zZm9ybVBsdWdpbi5zY2FsZS5zZXQoCiAgICAgICAgdmFsdWUsIHZhbHVlLCB2YWx1ZQogICAgKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FsZU91dHB1dCcpLmlubmVySFRNTCA9IHZhbHVlOwogIH07CgogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93SGlkZScpLm9uY2xpY2sgPSBmdW5jdGlvbigpewogICAgdmFyIGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7CiAgICBpZiAoZWwuc3R5bGUuZGlzcGxheSA9PSAnbm9uZScpewogICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJwogICAgfWVsc2UgewogICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnCiAgICB9CiAgfQoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlldy1zb3VyY2UnKS5ocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvXiguKilcL1wvLywgJ3ZpZXctc291cmNlOicpCgo8L3NjcmlwdD4KCjwvaHRtbD4K",
                "body": "PCFET0NUWVBFIEhUTUw+CjxodG1sPgo8aGVhZD4KICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgPHRpdGxlPkxlYXAgVHJhbnNmb3JtIFBsdWdpbjwvdGl0bGU+CgogIDxzdHlsZT4KICAgIGJvZHl7CiAgICAgIG1hcmdpbjogMDsKICAgICAgZm9udC1mYW1pbHk6IEhlbHZldGljYTsKICAgIH0KICAgIGNhbnZhc3sKICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICB9CiAgICBpbnB1dHsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgfQogICAgI2Nvbm5lY3QtbGVhcHsKICAgICAgYm90dG9tOiAwOwogICAgICB0b3A6IGF1dG8gIWltcG9ydGFudDsKICAgIH0KCiAgICB0YWJsZSwgdGgsIHRkIHsKICAgICAgYm9yZGVyOiAxcHggc29saWQgI2FhYTsKICAgIH0KICAgIHRhYmxlIHsKICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKICAgIH0KICAgIHRkLCB0aCB7CiAgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7CiAgICAgIHBhZGRpbmc6IDNweDsKICAgIH0KICAgIHRoIHsKICAgICAgY29sb3I6ICM1NTU7CiAgICB9CiAgICAjdmlldy1zb3VyY2UgewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMDsKICAgICAgcmlnaHQ6IDA7CiAgICAgIG1hcmdpbjogMTBweDsKICAgIH0KICA8L3N0eWxlPgoKCiAgPHNjcmlwdCBzcmM9Ii8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3RocmVlLmpzL3I2OC90aHJlZS5taW4uanMiPjwvc2NyaXB0PgogIDxzY3JpcHQgc3JjPSIvL2pzLmxlYXBtb3Rpb24uY29tL2xlYXAtMC42LjMubWluLmpzIj48L3NjcmlwdD4KICA8c2NyaXB0IHNyYz0iLi4vbGVhcC1wbHVnaW5zLTAuMS45LmpzIj48L3NjcmlwdD4KICA8c2NyaXB0IHNyYz0iLy9qcy5sZWFwbW90aW9uLmNvbS9sZWFwLnJpZ2dlZC1oYW5kLTAuMS41Lm1pbi5qcyI+PC9zY3JpcHQ+Cgo8L2hlYWQ+Cjxib2R5PgoKPGEgaWQ9InZpZXctc291cmNlIiBocmVmPSIjIj5WaWV3IFNvdXJjZTwvYT4KCjxoMT5UcmFuc2Zvcm0gUGx1Z2luPC9oMT4KPHA+CiAgVHJhbnNmb3JtcyBMZWFwIGRhdGEgYmFzZWQgb2ZmIG9mIGEgcm90YXRpb24gbWF0cml4IG9yIGEgVEhSRUUuanMgcm90YXRpb24gYW5kIHZlY3RvcnMuCjwvcD4KPHA+CiAgSGVyZSB3ZSB1c2UgdGhlIHJpZ2dlZEhhbmQgdG8gdmlzdWFsaXplIHRoZSB0cmFuc2Zvcm1hdGlvbnMsIGJ1dCBpdCBpcyBub3QgcmVxdWlyZWQuICBBbGwgZGF0YSBpbiB0aGUgZnJhbWUgaXMgYWx0ZXJlZAogIGJ5IHRoZSB0cmFuc2Zvcm0gcGx1Z2luLgo8L3A+CjxwPgogIFBhcmFtZXRlcnMgY2FuIGJlIGVpdGhlciBzdGF0aWMgb2JqZWN0cyBvciBtZXRob2RzIHdoaWNoIHRyYW5zZm9ybSBvbiBldmVyeSBmcmFtZS4KPC9wPgo8cD4KICBJbiB0aGlzIHdheSwgeW91IGNhbiB0aGVuIHRyYW5zZm9ybSBpbmRpdmlkdWFsIGhhbmRzIGJhc2VkIHVwb24gdGhlaXIgaWQuCjwvcD4KCjxici8+Cgo8ZGl2IHN0eWxlPSJmbG9hdDogbGVmdDsiPgogIDxsYWJlbD5Sb3RhdGlvbjogPHNwYW4gaWQ9InJvdGF0aW9uT3V0cHV0Ij4wPC9zcGFuPs+APC9sYWJlbD48YnIvPgogIDxpbnB1dCBpZD0icm90YXRpb25JbnB1dCIgdHlwZT0icmFuZ2UiIG1pbj0iLTEiIG1heD0iMSIgdmFsdWU9IjAiIHN0ZXA9IjAuMDAxIj4KPC9kaXY+Cgo8ZGl2IHN0eWxlPSJmbG9hdDogbGVmdDsiPgogIDxsYWJlbD5aIFBvc2l0aW9uOiA8c3BhbiBpZD0icG9zaXRpb25PdXRwdXQiPjA8L3NwYW4+PC9sYWJlbD48YnIvPgogIDxpbnB1dCBpZD0icG9zaXRpb25JbnB1dCIgdHlwZT0icmFuZ2UiIG1pbj0iLTEwMDAiIG1heD0iMzAwIiB2YWx1ZT0iMCIgc3RlcD0iMSI+CjwvZGl2PgoKPGRpdiBzdHlsZT0iZmxvYXQ6IGxlZnQ7Ij4KICA8bGFiZWw+U2NhbGU6IDxzcGFuIGlkPSJzY2FsZU91dHB1dCI+MC4zPC9zcGFuPjwvbGFiZWw+PGJyLz4KICA8aW5wdXQgaWQ9InNjYWxlSW5wdXQiIHR5cGU9InJhbmdlIiBtaW49IjAuMSIgbWF4PSIxIiB2YWx1ZT0iMC4zIiBzdGVwPSIwLjAxIj4KICA8IS0tIG5vdGUgLSB0aGVyZSBzZWVtcyB0byBiZSBhIHN0cmFuZ2UgaXNzdWUgd2l0aCBUSFJFRWpzIHNlY3Rpb25zIG9mIHRoZSBoYW5kIGRpc2FwcGVhcmluZyBmb3Igc2NhbGVzIGxhcmdlciB0aGFuIDEuCiAgICAgICBTY2FsZSBzZXQgYXMgYW4gb3B0aW9uIGZvciB0aGUgcmlnZ2VkSGFuZCB3aWxsIGNhdXNlIHRoZSBpc3N1ZS4gIC0tPgo8L2Rpdj4KPGRpdiBzdHlsZT0iZmxvYXQ6IGxlZnQ7IHBhZGRpbmc6IDEwcHgiPgogIDxidXR0b24gaWQ9InNob3dIaWRlIj5TaG93L0hpZGU8L2J1dHRvbj4KPC9kaXY+Cgo8YnIvPgoKPHByZT48Y29kZT4KICAvLyBBdCB0aGUgc2ltcGxlc3Q6CiAgTGVhcC5sb29wKCkKICAgIC51c2UoJ3RyYW5zZm9ybScsIHsKICAgICAgLy8gbW92ZSAyMCBjbSBiYWNrLgogICAgICBwb3NpdGlvbjogbmV3IFRIUkVFLlZlY3RvcjMoMCwwLC0yMDApCiAgICB9KTsKPC9jb2RlPjwvcHJlPgoKPGJyLz4KCjxoMz5PcHRpb25zPC9oMz4KCjx0YWJsZT4KICA8dHI+CiAgICA8dGg+TmFtZTwvdGg+CiAgICA8dGg+RGVmYXVsdDwvdGg+CiAgICA8dGg+RGVzY3JpcHRpb248L3RoPgogIDwvdHI+CiAgPHRyPgogICAgPHRkPlZSPC90ZD4KICAgIDx0ZD5mYWxzZTwvdGQ+CiAgICA8dGQ+CiAgICAgIFNldHMgc2NhbGUsIHBvc2l0aW9uLCBhbmQgcm90YXRpb24gdHJhbnNmb3JtcyBmb3IgSE1EIG1vZGUuICBUaGVzZSBhcmU6IHVuaXRzIGluIG1ldGVycywgOGNtIGZvcndhcmQsIGFuZCBhbGwgeCwgeSwgYW5kIHogYXhpcyBmbGlwcGVkLiBBbHNvIHRlbGxzIHRyYWNraW5nIHRvIHVzZSBoZWFkLW1vdW50ZWQgZGV2aWNlIG1vZGUuCiAgICA8L3RkPgogIDwvdHI+CiAgPHRyPgogICAgPHRkPnBvc2l0aW9uPC90ZD4KICAgIDx0ZD51bmRlZmluZWQ8L3RkPgogICAgPHRkPkEgVEhSRUUuVmVjdG9yMyBwb3NpdGlvbiBvZmZzZXQgdmVjdG9yPC90ZD4KICA8L3RyPgogIDx0cj4KICAgIDx0ZD5xdWF0ZXJuaW9uPC90ZD4KICAgIDx0ZD51bmRlZmluZWQ8L3RkPgogICAgPHRkPkEgVEhSRUUuUXVhdGVybmlvbiByb3RhdGlvbjwvdGQ+CiAgPC90cj4KICA8dHI+CiAgICA8dGQ+c2NhbGU8L3RkPgogICAgPHRkPnVuZGVmaW5lZDwvdGQ+CiAgICA8dGQ+QSBUSFJFRS5WZWN0b3Igc2NhbGUgdmVjdG9yLCBvciBhIHNpbmdsZSBzY2FsYXIgdG8gYmUgYXBwbGllZCB0byBhbGwgdGhyZWUgYXhpcy48L3RkPgogIDwvdHI+CiAgPHRyPgogICAgPHRkPmVmZmVjdGl2ZVBhcmVudDwvdGQ+CiAgICA8dGQ+dW5kZWZpbmVkPC90ZD4KICAgIDx0ZD5BIFRIUkVFLk9iamVjdDNkLCBvciBhbnl0aGluZyB3aGljaCByZXNwb25kcyB0byBgbWF0cml4V29ybGRgIGFuZCBgc2NhbGVgLiBUaGlzIG1hdHJpeFdvcmxkIGlzIGFwcGxpZWQgdG8gdGhlCiAgICAgIGhhbmQgZGF0YSBhcyB3ZWxsIGFzIGFueSB0cmFuc2Zvcm1hdGlvbnMgc3BlY2lmaWVkIHRocm91Z2ggdGhlIG90aGVyIG9wdGlvbnMuICBUaGlzIGFsbG93cyBoYW5kcyB0byBiZSAiYXR0YWNoZWQiCiAgICAgIHRvIGEgY2FtZXJhLjwvdGQ+CiAgPC90cj4KPC90YWJsZT4KCgo8L2JvZHk+CgoKCjxzY3JpcHQ+CiAgLy8gYWxsIHVuaXRzIGluIG1tCiAgdmFyIGluaXRTY2VuZSA9IGZ1bmN0aW9uICgpIHsKICAgIHdpbmRvdy5zY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOwogICAgd2luZG93LnJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoewogICAgICBhbHBoYTogdHJ1ZQogICAgfSk7CgogICAgd2luZG93LnJlbmRlcmVyLnNldENsZWFyQ29sb3IoMHgwMDAwMDAsIDApOwogICAgd2luZG93LnJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7CgogICAgd2luZG93LnJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnOwogICAgd2luZG93LnJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUudG9wID0gMDsKICAgIHdpbmRvdy5yZW5kZXJlci5kb21FbGVtZW50LnN0eWxlLmxlZnQgPSAwOwogICAgd2luZG93LnJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUud2lkdGggPSAnMTAwJSc7CiAgICB3aW5kb3cucmVuZGVyZXIuZG9tRWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7CgogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh3aW5kb3cucmVuZGVyZXIuZG9tRWxlbWVudCk7CgogICAgd2luZG93LnNjZW5lLmFkZChuZXcgVEhSRUUuQW1iaWVudExpZ2h0KDB4ODg4ODg4KSk7CgogICAgdmFyIHBvaW50TGlnaHQgPSBuZXcgVEhSRUUuUG9pbnRMaWdodCgweEZGZmZmZik7CiAgICBwb2ludExpZ2h0LnBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoLTIwLCAxMCwgMTAwKTsKICAgIHBvaW50TGlnaHQubG9va0F0KG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAsIDApKTsKICAgIHdpbmRvdy5zY2VuZS5hZGQocG9pbnRMaWdodCk7CgogICAgd2luZG93LmNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg0NSwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMTAwMDApOwogICAgd2luZG93LmNhbWVyYS5wb3NpdGlvbi5mcm9tQXJyYXkoWzAsIDE2MCwgNDAwXSk7CiAgICB3aW5kb3cuY2FtZXJhLmxvb2tBdChuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAwKSk7CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHsKCiAgICAgIGNhbWVyYS5hc3BlY3QgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodDsKICAgICAgY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgICAgcmVuZGVyZXIuc2V0U2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTsKICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpOwoKICAgIH0sIGZhbHNlKTsKCiAgICBzY2VuZS5hZGQoY2FtZXJhKTsKCgogICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpOwogIH07CgogIGluaXRTY2VuZSgpOwoKCgoKICBMZWFwLmxvb3AoKQogIC8vIG5vdGUgdGhhdCB0cmFuc2Zvcm0gbXVzdCBiZSBfYmVmb3JlXyByaWdnZWQgaGFuZAogIC51c2UoJ3RyYW5zZm9ybScsIHsKICAgIHF1YXRlcm5pb246IG5ldyBUSFJFRS5RdWF0ZXJuaW9uLAogICAgcG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IzLAogICAgc2NhbGU6IDAuMwogIH0pCiAgLnVzZSgncGxheWJhY2snLCB7cmVjb3JkaW5nOiAnZmluZ2VyLXRhcC01NGZwcy5qc29uLmx6J30pCiAgLnVzZSgncmlnZ2VkSGFuZCcsIHsKICAgIGRvdHNNb2RlOiBmYWxzZSwKICAgIHBhcmVudDogc2NlbmUsCiAgICByZW5kZXJGbjogZnVuY3Rpb24oKXsKICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpOwogICAgfQoKICB9KQogIC5jb25uZWN0KCk7CgogIHdpbmRvdy50cmFuc2Zvcm1QbHVnaW4gPSBMZWFwLmxvb3BDb250cm9sbGVyLnBsdWdpbnMudHJhbnNmb3JtOwoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm90YXRpb25JbnB1dCcpLm9uaW5wdXQgPSBmdW5jdGlvbihlKXsKICAgIHZhciB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlOwogICAgdHJhbnNmb3JtUGx1Z2luLnF1YXRlcm5pb24uc2V0RnJvbUV1bGVyKAogICAgICAgIG5ldyBUSFJFRS5FdWxlcigwLCBNYXRoLlBJICogcGFyc2VGbG9hdCh2YWx1ZSwxMCkgLCAwKQogICAgKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb3RhdGlvbk91dHB1dCcpLmlubmVySFRNTCA9IHZhbHVlOwogIH07CgogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3NpdGlvbklucHV0Jykub25pbnB1dCA9IGZ1bmN0aW9uKGUpewogICAgdmFyIHZhbHVlID0gZS50YXJnZXQudmFsdWU7CiAgICB0cmFuc2Zvcm1QbHVnaW4ucG9zaXRpb24uc2V0KAogICAgICAgIDAsMCxwYXJzZUludCh2YWx1ZSwgMTApCiAgICApOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bvc2l0aW9uT3V0cHV0JykuaW5uZXJIVE1MID0gdmFsdWU7CiAgfTsKCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYWxlSW5wdXQnKS5vbmlucHV0ID0gZnVuY3Rpb24oZSl7CiAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KGUudGFyZ2V0LnZhbHVlLDEwKTsKICAgIHRyYW5zZm9ybVBsdWdpbi5zY2FsZS5zZXQoCiAgICAgICAgdmFsdWUsIHZhbHVlLCB2YWx1ZQogICAgKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FsZU91dHB1dCcpLmlubmVySFRNTCA9IHZhbHVlOwogIH07CgogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93SGlkZScpLm9uY2xpY2sgPSBmdW5jdGlvbigpewogICAgdmFyIGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7CiAgICBpZiAoZWwuc3R5bGUuZGlzcGxheSA9PSAnbm9uZScpewogICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJwogICAgfWVsc2UgewogICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnCiAgICB9CiAgfQoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlldy1zb3VyY2UnKS5ocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvXiguKilcL1wvLywgJ3ZpZXctc291cmNlOicpCgo8L3NjcmlwdD4KCjwvaHRtbD4K",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 08:33:02 GMT",
                    "Content-Length": "6585",
                    "Date": "Fri, 07 Nov 2014 08:33:03 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}