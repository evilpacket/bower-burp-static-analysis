{
    "url": "http://localhost:9999/kvz/phpjs/workbench/tokenizer/file_get_contents.min.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>window.location.href</b> and written to <b>the 'open()' function of an XMLHttpRequest object</b> via the following statements:<ul><li>href=this.window.location.href;</li><li>url=href.slice(0,pathPos+1)+url;</li><li>req.open(method,url,async);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/kvz/phpjs/workbench/tokenizer/file_get_contents.min.js",
                "path": "/kvz/phpjs/workbench/tokenizer/file_get_contents.min.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9rdnovcGhwanMvd29ya2JlbmNoL3Rva2VuaXplci9maWxlX2dldF9jb250ZW50cy5taW4uanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTExMDANCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkRhdGU6IEZyaSwgMDcgTm92IDIwMTQgMjI6MDA6MTUgR01UDQpMYXN0LU1vZGlmaWVkOiBGcmksIDA3IE5vdiAyMDE0IDIyOjAwOjExIEdNVA0KDQovKgogKiBNb3JlIGluZm8gYXQ6IGh0dHA6Ly9waHBqcy5vcmcKICoKICogVGhpcyBpcyB2ZXJzaW9uOiAzLjA2CiAqIHBocC5qcyBpcyBjb3B5cmlnaHQgMjAxMCBLZXZpbiB2YW4gWm9ubmV2ZWxkLgogKgogKiBQb3J0aW9ucyBjb3B5cmlnaHQgQnJldHQgWmFtaXIgKGh0dHA6Ly9icmV0dC16YW1pci5tZSksIEtldmluIHZhbiBab25uZXZlbGQKICogKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KSwgT25ubyBNYXJzbWFuLCBNaWNoYWVsIFdoaXRlCiAqIChodHRwOi8vZ2V0c3ByaW5rLmNvbSksIFRoZXJpYXVsdCwgV2FsZG8gTWFscXVpIFNpbHZhLCBQYXVsbyBSaWNhcmRvIEYuCiAqIFNhbnRvcywgSmFjaywgSm9uYXMgUmFvbmkgU29hcmVzIFNpbHZhIChodHRwOi8vd3d3LmpzZnJvbWhlbGwuY29tKSwgUGhpbGlwCiAqIFBldGVyc29uLCBMZWdhZXYgQW5kcmV5LCBBdGVzIEdvcmFsIChodHRwOi8vbWFnbmV0aXEuY29tKSwgQWxleCwgUmF0aGVvdXMsCiAqIE1hcnRpam4gV2llcmluZ2EsIE5hdGUsIFBoaWxpcHBlIEJhdW1hbm4sIGxtZXlyaWNrCiAqIChodHRwczovL3NvdXJjZWZvcmdlLm5ldC9wcm9qZWN0cy9iY21hdGgtanMvKSwgRW5yaXF1ZSBHb256YWxleiwKICogV2VidG9vbGtpdC5pbmZvIChodHRwOi8vd3d3LndlYnRvb2xraXQuaW5mby8pLCBKYW5pIEhhcnRpa2FpbmVuLCBPbGUKICogVnJpamVuaG9laywgQ2FybG9zIFIuIEwuIFJvZHJpZ3VlcyAoaHR0cDovL3d3dy5qc2Zyb21oZWxsLmNvbSksIEFzaCBTZWFybGUKICogKGh0dHA6Ly9oZXhtZW4uY29tL2Jsb2cvKSwgdHJhdmMsIHN0YWcwMTksIHBpbHVzLCBULldpbGQsCiAqIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTc4MDMvaG93LXRvLWNvbnZlcnQtZGVjaW1hbC10by1oZXgtaW4tamF2YXNjcmlwdCwKICogSm9obm55IE1hc3QgKGh0dHA6Ly93d3cucGhwdnJvdXdlbi5ubCksIEVya2VramV0dGVyLCBXZWJEZXZIb2JvCiAqIChodHRwOi8vd2ViZGV2aG9iby5ibG9nc3BvdC5jb20vKSwgR2Vla0ZHIChodHRwOi8vZ2Vla2ZnLmJsb2dzcG90LmNvbSksCiAqIEFuZHJlYSBHaWFtbWFyY2hpIChodHRwOi8vd2VicmVmbGVjdGlvbi5ibG9nc3BvdC5jb20pLCBkM3gsIG1hcnJ0aW5zLAogKiBNaWNoYWVsIEdyaWVyLCBNaXJlayBTbHVnZW4sIG1hamFrLCBtZHNqYWNrIChodHRwOi8vd3d3Lm1kc2phY2suYm8uaXQpLAogKiBnZXR0aW1lb2ZkYXksIE1haWxmYWtlciAoaHR0cDovL3d3dy53ZWVkZW0uZnIvKSwgRGF2aWQsIE1pY2hhZWwgV2hpdGUsCiAqIFB1YmxpYyBEb21haW4gKGh0dHA6Ly93d3cuanNvbi5vcmcvanNvbjIuanMpLCBUaW0gZGUgS29uaW5nCiAqIChodHRwOi8vd3d3LmtpbmdzcXVhcmUubmwpLCBPbGVnIEVyZW1lZXYsIE1hcmMgUGFsYXUsIFN0ZXZlbiBMZXZpdGhhbgogKiAoaHR0cDovL2Jsb2cuc3RldmVubGV2aXRoYW4uY29tKSwgSm9zaCBGcmFzZXIKICogKGh0dHA6Ly9vbmxpbmVhc3BlY3QuY29tLzIwMDcvMDYvMDgvYXV0by1kZXRlY3QtYS10aW1lLXpvbmUtd2l0aC1qYXZhc2NyaXB0LyksCiAqIEtFTEFOLCBBcnBhZCBSYXkgKG1haWx0bzphcnBhZEBwaHAubmV0KSwgSm9yaXMsIEJyZWFraW5nIFBhciBDb25zdWx0aW5nIEluYwogKiAoaHR0cDovL3d3dy5icmVha2luZ3Bhci5jb20vYmtwL2hvbWUubnNmLzAvODcyNTZCMjgwMDE1MTkzRjg3MjU2Q0ZCMDA2QzQ1RjcpLAogKiBNYXJ0aW4gKGh0dHA6Ly93d3cuZXJsZW53aWVzZS5kZS8pLCBBSiwgTGFycyBGaXNjaGVyLCBGZWxpeCBHZWlzZW5kb2VyZmVyCiAqIChodHRwOi8vd3d3LmRlYnVnZ2FibGUuY29tL2ZlbGl4KSwgUGVsbGVudGVzcXVlIE1hbGVzdWFkYSwgQ2FpbyBBcmllZGUKICogKGh0dHA6Ly9jYWlvYXJpZWRlLmNvbSksIEthbmtyZWx1bmUgKGh0dHA6Ly93d3cud2ViZmFrdG9yeS5pbmZvLyksIEFsZm9uc28KICogSmltZW5leiAoaHR0cDovL3d3dy5hbGZvbnNvamltZW5lei5jb20pLCBTYWtpbW9yaSwgU3RldmUgSGlsZGVyLCBnb3J0aGF1ciwKICogQW1hbiBHdXB0YSwgS2Fyb2wgS293YWxza2ksIFRodW5kZXIubSwgVHlsZXIgQWtpbnMgKGh0dHA6Ly9ydW1raW4uY29tKSwKICogam9obiAoaHR0cDovL3d3dy5qZC10ZWNoLm5ldCksIERvdWdsYXMgQ3JvY2tmb3JkCiAqIChodHRwOi8vamF2YXNjcmlwdC5jcm9ja2ZvcmQuY29tKSwgbWt0aW1lLCBHaWxiZXJ0LCBNYXJjbywgcGF1bG8ga3VvbmcsCiAqIEZyYW5rIEZvcnRlLCBkdW5jYW4sIG1hZGlwdGEsIGdlciwgU3ViaGFzaXMgRGViLCBmZWxpeCwgRGVubnkgV2FyZGhhbmEsCiAqIE1hdGV1c3ogImxvb25xdWF3bCIgWmFsZWdhLCBSZXZlcnNlU3ludGF4LCBGcmFuY29pcywgU2NvdHQgQ2FyaXNzLCBTbGF3b21pcgogKiBLYW5pZWNraSwgQXJubywgTmF0aGFuLCBOaWNrIEtvbG9zb3YgKGh0dHA6Ly9zYW1teS5ydSksIDBtM3IsIG5vbmFtZSwgbWFyYwogKiBhbmRyZXUsIEZveCwgc2Fua2FpLCBTYW5qb3kgUm95LCBub2JibGVyLCBTdGV2ZSBDbGF5LCBjbGFzc19leGlzdHMsIFRoaWFnbwogKiBNYXRhIChodHRwOi8vdGhpYWdvbWF0YS5ibG9nLmNvbSksIEpvbiBIb2hsZSwgbm9yZF91YSwgT3poLCBlY2hvIGlzIGJhZCwKICogTGludXh3b3JsZCwgWG9yYVggKGh0dHA6Ly93d3cueG9yYXguaW5mbyksIFB5ZXJyZSwgU29yZW4gSGFuc2VuLCBCcmFkCiAqIFRvdWVzbmFyZCwgTWVFdGMgKGh0dHA6Ly95YXNzLm1lZXRjd2ViLmNvbSksIFRpbSBXaWVsLCBCcnlhbiBFbGxpb3R0LAogKiBUMGJzbiwgUGV0ZXItUGF1bCBLb2NoIChodHRwOi8vd3d3LnF1aXJrc21vZGUub3JnL2pzL2JlYXQuaHRtbCksIERhdmlkCiAqIFJhbmRhbGwsIERlciBTaW1vbiAoaHR0cDovL2lubmVyZG9tLnNvdXJjZWZvcmdlLm5ldC8pLCBsbWV5cmljawogKiAoaHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvYmNtYXRoLWpzL3RoaXMuKSwgSHlhbSBTaW5nZXIKICogKGh0dHA6Ly93d3cuaW1wYWN0LWNvbXB1dGluZy5jb20vKSwgUGF1bCwga2VubmV0aCwgUmFwaGFlbCAoQW8gUlVETEVSKSwKICogRGF2aWQgSmFtZXMsIFQuIFdpbGQsIE9sZSBWcmlqZW5ob2VrIChodHRwOi8vd3d3Lm5lcnZvdXMubmwvKSwgSiBBIFIsCiAqIEJheXJvbiBHdWV2YXJhLCBMSCwgSkIsIEV1Z2VuZSBCdWxraW4gKGh0dHA6Ly9kb3VibGVhdy5jb20vKSwgU3RveWFuIEt5b3NldgogKiAoaHR0cDovL3d3dy5zdmVzdC5vcmcvKSwgZGptaXgsIE1hcmMgSmFuc2VuLCBGcmFuY2VzY28sIExpbmNvbG4gUmFtc2F5LAogKiBNYW5pc2gsIGRhdGUsIEtyaXN0b2YgQ29vbWFucyAoU0NLLUNFTiBCZWxnaWFuIE51Y2xlYWlyIFJlc2VhcmNoIENlbnRyZSksCiAqIFBpZXJyZS1MdWMgUGFvdXIsIE1hcnRpbiBQb29sLCBSaWNrIFdhbGRyb24sIEtpcmsgU3Ryb2JlY2ssIFNhdWxvIFZhbGxvcnksCiAqIENocmlzdG9waCwgQXJ0dXIgVGNoZXJueWNoZXYsIFdhZ25lciBCLiBTb2FyZXMsIFZhbGVudGluYSBEZSBSb3NhLCBEYW5pZWwKICogRXN0ZWJhbiwgSmFzb24gV29uZyAoaHR0cDovL2NhcnJvdC5vcmcvKSwgTWlja0BlbCwgcmV6bmEsIFNpbW9uIFdpbGxpc29uCiAqIChodHRwOi8vc2ltb253aWxsaXNvbi5uZXQpLCBHYWJyaWVsIFBhZGVybmksIE1hcmNvIHZhbiBPb3J0LAogKiBwZW51dGJ1dHRlcmplbGx5LCBQaGlsaXBwIExlbnNzZW4sIEFudG9uIE9uZ3NvbiwgQmx1ZXMKICogKGh0dHA6Ly90ZWNoLmJsdWVzbW9vbi5pbmZvLyksIFRvbWFzeiBXZXNvbG93c2tpLCBFcmljIE5hZ2VsLCBCb2JieSBEcmFrZSwKICogTHVrZSBHb2RmcmV5LCBQdWwsIHVlc3RsYSwgQWxhbiBDLCBZdmVzIFN1Y2FldCwgc293YmVycnksIGhpdHdvcmssIE9ybGFuZG8sCiAqIE5vcm1hbiAiekVoIiBGdWNocywgVWxyaWNoLCBqb2hucmVtYm8sIE5pY2sgQ2FsbGVuLCBlanNhbmRlcnMsIEFpZGFuIExpc3RlcgogKiAoaHR0cDovL2FpZGFubGlzdGVyLmNvbS8pLCBCcmlhbiBUYWZveWEgKGh0dHA6Ly93d3cucHJlbWFzb2x1dGlvbnMuY29tLyksCiAqIFBoaWxpcHBlIEphdXNpb25zIChodHRwOi8vcGVhci5waHAubmV0L3VzZXIvamF1c2lvbnMpLCBraWxvcHMsIGRwdHIxOTg4LAogKiBIS00sIG1ldGpheSwgc3RyY2FzZWNtcCwgc3RyY21wLCBUYXJhcyBCb2dhY2gsIGpwZmxlLCBDaGFvc05vMSwgQWxleGFuZGVyCiAqIEVybW9sYWV2IChodHRwOi8vc25pcHBldHMuZHpvbmUuY29tL3VzZXIvQWxleGFuZGVyRXJtb2xhZXYpLCBMZSBUb3JiaSwKICogSmFtZXMsIENocmlzLCBEeEd4LCBQZWRybyBUYWluaGEgKGh0dHA6Ly93d3cucGVkcm90YWluaGEuY29tKSwgQ2hyaXN0aWFuCiAqIERvZWJsZXIsIHNldGNvb2tpZSwgR3JlZyBGcmF6aWVyLCBUb2QgR2VudGlsbGUsIEFsZXhhbmRlciBNIEJlZWRpZSwKICogRnJlbXlDb21wYW55LCBULkouIExlYWh5LCBiYXJpcyBvemRpbCwgRkdGRW1wZXJvciwgZGFuaWVsIGFpcnRvbiB3ZXJtYW5uCiAqIChodHRwOi8vd2VybWFubi5jb20uYnIpLCAzRC1HUkFGLCBqYWtlcywgZ2FicmllbCBwYWRlcm5pLCBZYW5ub28sIEx1aXMKICogU2FsYXphciAoaHR0cDovL3d3dy5mcmVha3ktbWVkaWEuY29tLyksIFRpbSBkZSBLb25pbmcsIHN0ZW5zaSwgQmlsbHksIHZsYWRvCiAqIGhvdWJhLCBJdHNhY29uIChodHRwOi8vd3d3Lml0c2Fjb24ubmV0LyksIEphbGFsIEJlcnJhbWksIE1hdHRlbywgVmljdG9yLAogKiB0YWl0aCwgUm9iaW4sIE1hdHQgQnJhZGxleSwgZmVhcnBoYWdlCiAqIChodHRwOi8vaHR0cC9teS5vcGVyYS5jb20vZmVhcnBoYWdlLyksIENvcmQsIEF0bGkgw57Ds3IsIE1heGltdXN5YSwgQW5kcmVqCiAqIFBhdmxvdmljLCBEaW5vLCByZW0sIEdyZWVuc2VlZCwgbWVvLCBHYXJhZ290aCwgUnVzc2VsbCBXYWxrZXIKICogKGh0dHA6Ly93d3cubmJpbGwuY28udWsvKSwgWVVJIExpYnJhcnk6CiAqIGh0dHA6Ly9kZXZlbG9wZXIueWFob28uY29tL3l1aS9kb2NzL1lBSE9PLnV0aWwuRGF0ZUxvY2FsZS5odG1sLCBCbHVlcyBhdAogKiBodHRwOi8vaGFja3MuYmx1ZXNtb29uLmluZm8vc3RyZnRpbWUvc3RyZnRpbWUuanMsIEFuZHJlYXMsIEphbWllIEJlY2sKICogKGh0dHA6Ly93d3cudGVyYWJpdC5jYS8pLCBEdFR2QgogKiAoaHR0cDovL2R0LmluLnRoLzIwMDgtMDktMTYuc3RyaW5nLWxlbmd0aC1pbi1ieXRlcy5odG1sKSwgbWsua2VjaywgTGVzbGllCiAqIEhvYXJlLCBEaW9nbyBSZXNlbmRlLCBIb3dhcmQgWWVlbmQsIEFsbGFuIEplbnNlbiAoaHR0cDovL3d3dy53aW50ZXJuZXQubm8pLAogKiBkYXZvb2ssIEJlbmphbWluIEx1cHRvbiwgUml2YWwsIEx1a2UgU21pdGggKGh0dHA6Ly9sdWNhc3NtaXRoLm5hbWUpLAogKiBib29leU9ILCBCZW4gQnJ5YW4sIENhZ3JpIEVraW4sIEFtaXIgSGFiaWJpCiAqIChodHRwOi8vd3d3LnJlc2lkZW5jZS1taXh0ZS5jb20vKSwgS2hlYW5nIEhvayBDaGluCiAqIChodHRwOi8vd3d3LmRpc3RhbnRpYS5jYS8pLCBKYXkgS2xlaHIKICoKICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIChNSVQtTElDRU5TRS50eHQpCiAqIGFuZCBHUEwgKEdQTC1MSUNFTlNFLnR4dCkgbGljZW5zZXMuCiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCiAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKICogIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwogKiB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCiAqIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0bwogKiBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8KICogdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgogKgogKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAogKiBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KICoKICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKICogT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgogKiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuCiAqIElOIE5PIEVWRU5UIFNIQUxMIEtFVklOIFZBTiBaT05ORVZFTEQgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMKICogT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsCiAqIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgogKiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCiAqLwoKCi8vIENvbXByZXNzaW9uOiBtaW5pZmllZAoKCmZ1bmN0aW9uIGZpbGVfZ2V0X2NvbnRlbnRzKHVybCxmbGFncyxjb250ZXh0LG9mZnNldCxtYXhMZW4pe3ZhciB0bXAsaGVhZGVycz1bXSxuZXdUbXA9W10saz0wLGk9MCxocmVmPScnLHBhdGhQb3M9LTEsZmxhZ05hbWVzPTAsY29udGVudD1udWxsLGh0dHBfc3RyZWFtPWZhbHNlO3ZhciBmdW5jPWZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdmFsdWUuc3Vic3RyaW5nKDEpIT09Jyc7fTt0aGlzLnBocF9qcz10aGlzLnBocF9qc3x8e307dGhpcy5waHBfanMuaW5pPXRoaXMucGhwX2pzLmluaXx8e307dmFyIGluaT10aGlzLnBocF9qcy5pbmk7Y29udGV4dD1jb250ZXh0fHx0aGlzLnBocF9qcy5kZWZhdWx0X3N0cmVhbXNfY29udGV4dHx8bnVsbDtpZighZmxhZ3Mpe2ZsYWdzPTA7fQp2YXIgT1BUUz17RklMRV9VU0VfSU5DTFVERV9QQVRIOjEsRklMRV9URVhUOjMyLEZJTEVfQklOQVJZOjY0fTtpZih0eXBlb2YgZmxhZ3M9PT0nbnVtYmVyJyl7ZmxhZ05hbWVzPWZsYWdzO30KZWxzZXtmbGFncz1bXS5jb25jYXQoZmxhZ3MpO2ZvcihpPTA7aTxmbGFncy5sZW5ndGg7aSsrKXtpZihPUFRTW2ZsYWdzW2ldXSl7ZmxhZ05hbWVzPWZsYWdOYW1lc3xPUFRTW2ZsYWdzW2ldXTt9fX0KaWYoZmxhZ05hbWVzJk9QVFMuRklMRV9CSU5BUlkmJihmbGFnTmFtZXMmT1BUUy5GSUxFX1RFWFQpKXt0aHJvdydZb3UgY2Fubm90IHBhc3MgYm90aCBGSUxFX0JJTkFSWSBhbmQgRklMRV9URVhUIHRvIGZpbGVfZ2V0X2NvbnRlbnRzKCknO30KaWYoKGZsYWdOYW1lcyZPUFRTLkZJTEVfVVNFX0lOQ0xVREVfUEFUSCkmJmluaS5pbmNsdWRlX3BhdGgmJmluaS5pbmNsdWRlX3BhdGgubG9jYWxfdmFsdWUpe3ZhciBzbGFzaD1pbmkuaW5jbHVkZV9wYXRoLmxvY2FsX3ZhbHVlLmluZGV4T2YoJy8nKSE9PS0xPycvJzonXFwnO3VybD1pbmkuaW5jbHVkZV9wYXRoLmxvY2FsX3ZhbHVlK3NsYXNoK3VybDt9CmVsc2UgaWYoIS9eKGh0dHBzP3xmaWxlKTovLnRlc3QodXJsKSl7aHJlZj10aGlzLndpbmRvdy5sb2NhdGlvbi5ocmVmO3BhdGhQb3M9dXJsLmluZGV4T2YoJy8nKT09PTA/aHJlZi5pbmRleE9mKCcvJyw4KS0xOmhyZWYubGFzdEluZGV4T2YoJy8nKTt1cmw9aHJlZi5zbGljZSgwLHBhdGhQb3MrMSkrdXJsO30KaWYoY29udGV4dCl7dmFyIGh0dHBfb3B0aW9ucz1jb250ZXh0LnN0cmVhbV9vcHRpb25zJiZjb250ZXh0LnN0cmVhbV9vcHRpb25zLmh0dHA7aHR0cF9zdHJlYW09ISFodHRwX29wdGlvbnM7fQppZighY29udGV4dHx8aHR0cF9zdHJlYW0pe3ZhciByZXE9dGhpcy53aW5kb3cuQWN0aXZlWE9iamVjdD9uZXcgQWN0aXZlWE9iamVjdCgnTWljcm9zb2Z0LlhNTEhUVFAnKTpuZXcgWE1MSHR0cFJlcXVlc3QoKTtpZighcmVxKXt0aHJvdyBuZXcgRXJyb3IoJ1hNTEh0dHBSZXF1ZXN0IG5vdCBzdXBwb3J0ZWQnKTt9CnZhciBtZXRob2Q9aHR0cF9zdHJlYW0/aHR0cF9vcHRpb25zLm1ldGhvZDonR0VUJzt2YXIgYXN5bmM9ISEoY29udGV4dCYmY29udGV4dC5zdHJlYW1fcGFyYW1zJiZjb250ZXh0LnN0cmVhbV9wYXJhbXNbJ3BocGpzLmFzeW5jJ10pO2lmKGluaVsncGhwanMuYWpheEJ5cGFzc0NhY2hlJ10mJmluaVsncGhwanMuYWpheEJ5cGFzc0NhY2hlJ10ubG9jYWxfdmFsdWUpe3VybCs9KHVybC5tYXRjaCgvXD8vKT09bnVsbD8iPyI6IiYiKSsobmV3IERhdGUoKSkuZ2V0VGltZSgpO30KcmVxLm9wZW4obWV0aG9kLHVybCxhc3luYyk7aWYoYXN5bmMpe3ZhciBub3RpZmljYXRpb249Y29udGV4dC5zdHJlYW1fcGFyYW1zLm5vdGlmaWNhdGlvbjtpZih0eXBlb2Ygbm90aWZpY2F0aW9uPT09J2Z1bmN0aW9uJyl7aWYoMCYmcmVxLmFkZEV2ZW50TGlzdGVuZXIpe30KZWxzZXtyZXEub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKGFFdnQpe3ZhciBvYmpDb250ZXh0PXtyZXNwb25zZVRleHQ6cmVxLnJlc3BvbnNlVGV4dCxyZXNwb25zZVhNTDpyZXEucmVzcG9uc2VYTUwsc3RhdHVzOnJlcS5zdGF0dXMsc3RhdHVzVGV4dDpyZXEuc3RhdHVzVGV4dCxyZWFkeVN0YXRlOnJlcS5yZWFkeVN0YXRlLGV2dDphRXZ0fTt2YXIgYnl0ZXNfdHJhbnNmZXJyZWQ7c3dpdGNoKHJlcS5yZWFkeVN0YXRlKXtjYXNlIDA6bm90aWZpY2F0aW9uLmNhbGwob2JqQ29udGV4dCwwLDAsJycsMCwwLDApO2JyZWFrO2Nhc2UgMTpub3RpZmljYXRpb24uY2FsbChvYmpDb250ZXh0LDAsMCwnJywwLDAsMCk7YnJlYWs7Y2FzZSAyOm5vdGlmaWNhdGlvbi5jYWxsKG9iakNvbnRleHQsMCwwLCcnLDAsMCwwKTticmVhaztjYXNlIDM6Ynl0ZXNfdHJhbnNmZXJyZWQ9cmVxLnJlc3BvbnNlVGV4dC5sZW5ndGgqMjtub3RpZmljYXRpb24uY2FsbChvYmpDb250ZXh0LDcsMCwnJywwLGJ5dGVzX3RyYW5zZmVycmVkLDApO2JyZWFrO2Nhc2UgNDppZihyZXEuc3RhdHVzPj0yMDAmJnJlcS5zdGF0dXM8NDAwKXtieXRlc190cmFuc2ZlcnJlZD1yZXEucmVzcG9uc2VUZXh0Lmxlbmd0aCoyO25vdGlmaWNhdGlvbi5jYWxsKG9iakNvbnRleHQsOCwwLCcnLHJlcS5zdGF0dXMsYnl0ZXNfdHJhbnNmZXJyZWQsMCk7fQplbHNlIGlmKHJlcS5zdGF0dXM9PT00MDMpe25vdGlmaWNhdGlvbi5jYWxsKG9iakNvbnRleHQsMTAsMiwnJyxyZXEuc3RhdHVzLDAsMCk7fQplbHNle25vdGlmaWNhdGlvbi5jYWxsKG9iakNvbnRleHQsOSwyLCcnLHJlcS5zdGF0dXMsMCwwKTt9CmJyZWFrO2RlZmF1bHQ6dGhyb3cnVW5yZWNvZ25pemVkIHJlYWR5IHN0YXRlIGZvciBmaWxlX2dldF9jb250ZW50cygpJzt9fX19fQppZihodHRwX3N0cmVhbSl7dmFyIHNlbmRIZWFkZXJzPWh0dHBfb3B0aW9ucy5oZWFkZXImJmh0dHBfb3B0aW9ucy5oZWFkZXIuc3BsaXQoL1xyP1xuLyk7dmFyIHVzZXJBZ2VudFNlbnQ9ZmFsc2U7Zm9yKGk9MDtpPHNlbmRIZWFkZXJzLmxlbmd0aDtpKyspe3ZhciBzZW5kSGVhZGVyPXNlbmRIZWFkZXJzW2ldO3ZhciBicmVha1Bvcz1zZW5kSGVhZGVyLnNlYXJjaCgvOlxzKi8pO3ZhciBzZW5kSGVhZGVyTmFtZT1zZW5kSGVhZGVyLnN1YnN0cmluZygwLGJyZWFrUG9zKTtyZXEuc2V0UmVxdWVzdEhlYWRlcihzZW5kSGVhZGVyTmFtZSxzZW5kSGVhZGVyLnN1YnN0cmluZyhicmVha1BvcysxKSk7aWYoc2VuZEhlYWRlck5hbWU9PT0nVXNlci1BZ2VudCcpe3VzZXJBZ2VudFNlbnQ9dHJ1ZTt9fQppZighdXNlckFnZW50U2VudCl7dmFyIHVzZXJfYWdlbnQ9aHR0cF9vcHRpb25zLnVzZXJfYWdlbnR8fChpbmkudXNlcl9hZ2VudCYmaW5pLnVzZXJfYWdlbnQubG9jYWxfdmFsdWUpO2lmKHVzZXJfYWdlbnQpe3JlcS5zZXRSZXF1ZXN0SGVhZGVyKCdVc2VyLUFnZW50Jyx1c2VyX2FnZW50KTt9fQpjb250ZW50PWh0dHBfb3B0aW9ucy5jb250ZW50fHxudWxsO30KaWYoZmxhZ05hbWVzJk9QVFMuRklMRV9URVhUKXt2YXIgY29udGVudF90eXBlPSd0ZXh0L2h0bWwnO2lmKGh0dHBfb3B0aW9ucyYmaHR0cF9vcHRpb25zWydwaHBqcy5vdmVycmlkZSddKXtjb250ZW50X3R5cGU9aHR0cF9vcHRpb25zWydwaHBqcy5vdmVycmlkZSddO30KZWxzZXt2YXIgZW5jb2Rpbmc9KGluaVsndW5pY29kZS5zdHJlYW1fZW5jb2RpbmcnXSYmaW5pWyd1bmljb2RlLnN0cmVhbV9lbmNvZGluZyddLmxvY2FsX3ZhbHVlKXx8J1VURi04JztpZihodHRwX29wdGlvbnMmJmh0dHBfb3B0aW9ucy5oZWFkZXImJigvXmNvbnRlbnQtdHlwZTovaW0pLnRlc3QoaHR0cF9vcHRpb25zLmhlYWRlcikpe2NvbnRlbnRfdHlwZT1odHRwX29wdGlvbnMuaGVhZGVyLm1hdGNoKC9eY29udGVudC10eXBlOlxzKiguKikkL2ltKVsxXTt9CmlmKCEoLztccypjaGFyc2V0PS8pLnRlc3QoY29udGVudF90eXBlKSl7Y29udGVudF90eXBlKz0nOyBjaGFyc2V0PScrZW5jb2Rpbmc7fX0KcmVxLm92ZXJyaWRlTWltZVR5cGUoY29udGVudF90eXBlKTt9CmVsc2UgaWYoZmxhZ05hbWVzJk9QVFMuRklMRV9CSU5BUlkpe3JlcS5vdmVycmlkZU1pbWVUeXBlKCd0ZXh0L3BsYWluOyBjaGFyc2V0PXgtdXNlci1kZWZpbmVkJyk7fQppZihodHRwX29wdGlvbnMmJmh0dHBfb3B0aW9uc1sncGhwanMuc2VuZEFzQmluYXJ5J10pe3JlcS5zZW5kQXNCaW5hcnkoY29udGVudCk7fQplbHNle3JlcS5zZW5kKGNvbnRlbnQpO30KdG1wPXJlcS5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKTtpZih0bXApe3RtcD10bXAuc3BsaXQoJ1xuJyk7Zm9yKGs9MDtrPHRtcC5sZW5ndGg7aysrKXtpZihmdW5jKHRtcFtrXSkpe25ld1RtcC5wdXNoKHRtcFtrXSk7fX0KdG1wPW5ld1RtcDtmb3IoaT0wO2k8dG1wLmxlbmd0aDtpKyspe2hlYWRlcnNbaV09dG1wW2ldO30KdGhpcy4kaHR0cF9yZXNwb25zZV9oZWFkZXI9aGVhZGVyczt9CmlmKG9mZnNldHx8bWF4TGVuKXtpZihtYXhMZW4pe3JldHVybiByZXEucmVzcG9uc2VUZXh0LnN1YnN0cihvZmZzZXR8fDAsbWF4TGVuKTt9CnJldHVybiByZXEucmVzcG9uc2VUZXh0LnN1YnN0cihvZmZzZXQpO30KcmV0dXJuIHJlcS5yZXNwb25zZVRleHQ7fQpyZXR1cm4gZmFsc2U7fQo=",
                "body": "LyoKICogTW9yZSBpbmZvIGF0OiBodHRwOi8vcGhwanMub3JnCiAqCiAqIFRoaXMgaXMgdmVyc2lvbjogMy4wNgogKiBwaHAuanMgaXMgY29weXJpZ2h0IDIwMTAgS2V2aW4gdmFuIFpvbm5ldmVsZC4KICoKICogUG9ydGlvbnMgY29weXJpZ2h0IEJyZXR0IFphbWlyIChodHRwOi8vYnJldHQtemFtaXIubWUpLCBLZXZpbiB2YW4gWm9ubmV2ZWxkCiAqIChodHRwOi8va2V2aW4udmFuem9ubmV2ZWxkLm5ldCksIE9ubm8gTWFyc21hbiwgTWljaGFlbCBXaGl0ZQogKiAoaHR0cDovL2dldHNwcmluay5jb20pLCBUaGVyaWF1bHQsIFdhbGRvIE1hbHF1aSBTaWx2YSwgUGF1bG8gUmljYXJkbyBGLgogKiBTYW50b3MsIEphY2ssIEpvbmFzIFJhb25pIFNvYXJlcyBTaWx2YSAoaHR0cDovL3d3dy5qc2Zyb21oZWxsLmNvbSksIFBoaWxpcAogKiBQZXRlcnNvbiwgTGVnYWV2IEFuZHJleSwgQXRlcyBHb3JhbCAoaHR0cDovL21hZ25ldGlxLmNvbSksIEFsZXgsIFJhdGhlb3VzLAogKiBNYXJ0aWpuIFdpZXJpbmdhLCBOYXRlLCBQaGlsaXBwZSBCYXVtYW5uLCBsbWV5cmljawogKiAoaHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvYmNtYXRoLWpzLyksIEVucmlxdWUgR29uemFsZXosCiAqIFdlYnRvb2xraXQuaW5mbyAoaHR0cDovL3d3dy53ZWJ0b29sa2l0LmluZm8vKSwgSmFuaSBIYXJ0aWthaW5lbiwgT2xlCiAqIFZyaWplbmhvZWssIENhcmxvcyBSLiBMLiBSb2RyaWd1ZXMgKGh0dHA6Ly93d3cuanNmcm9taGVsbC5jb20pLCBBc2ggU2VhcmxlCiAqIChodHRwOi8vaGV4bWVuLmNvbS9ibG9nLyksIHRyYXZjLCBzdGFnMDE5LCBwaWx1cywgVC5XaWxkLAogKiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzU3ODAzL2hvdy10by1jb252ZXJ0LWRlY2ltYWwtdG8taGV4LWluLWphdmFzY3JpcHQsCiAqIEpvaG5ueSBNYXN0IChodHRwOi8vd3d3LnBocHZyb3V3ZW4ubmwpLCBFcmtla2pldHRlciwgV2ViRGV2SG9ibwogKiAoaHR0cDovL3dlYmRldmhvYm8uYmxvZ3Nwb3QuY29tLyksIEdlZWtGRyAoaHR0cDovL2dlZWtmZy5ibG9nc3BvdC5jb20pLAogKiBBbmRyZWEgR2lhbW1hcmNoaSAoaHR0cDovL3dlYnJlZmxlY3Rpb24uYmxvZ3Nwb3QuY29tKSwgZDN4LCBtYXJydGlucywKICogTWljaGFlbCBHcmllciwgTWlyZWsgU2x1Z2VuLCBtYWphaywgbWRzamFjayAoaHR0cDovL3d3dy5tZHNqYWNrLmJvLml0KSwKICogZ2V0dGltZW9mZGF5LCBNYWlsZmFrZXIgKGh0dHA6Ly93d3cud2VlZGVtLmZyLyksIERhdmlkLCBNaWNoYWVsIFdoaXRlLAogKiBQdWJsaWMgRG9tYWluIChodHRwOi8vd3d3Lmpzb24ub3JnL2pzb24yLmpzKSwgVGltIGRlIEtvbmluZwogKiAoaHR0cDovL3d3dy5raW5nc3F1YXJlLm5sKSwgT2xlZyBFcmVtZWV2LCBNYXJjIFBhbGF1LCBTdGV2ZW4gTGV2aXRoYW4KICogKGh0dHA6Ly9ibG9nLnN0ZXZlbmxldml0aGFuLmNvbSksIEpvc2ggRnJhc2VyCiAqIChodHRwOi8vb25saW5lYXNwZWN0LmNvbS8yMDA3LzA2LzA4L2F1dG8tZGV0ZWN0LWEtdGltZS16b25lLXdpdGgtamF2YXNjcmlwdC8pLAogKiBLRUxBTiwgQXJwYWQgUmF5IChtYWlsdG86YXJwYWRAcGhwLm5ldCksIEpvcmlzLCBCcmVha2luZyBQYXIgQ29uc3VsdGluZyBJbmMKICogKGh0dHA6Ly93d3cuYnJlYWtpbmdwYXIuY29tL2JrcC9ob21lLm5zZi8wLzg3MjU2QjI4MDAxNTE5M0Y4NzI1NkNGQjAwNkM0NUY3KSwKICogTWFydGluIChodHRwOi8vd3d3LmVybGVud2llc2UuZGUvKSwgQUosIExhcnMgRmlzY2hlciwgRmVsaXggR2Vpc2VuZG9lcmZlcgogKiAoaHR0cDovL3d3dy5kZWJ1Z2dhYmxlLmNvbS9mZWxpeCksIFBlbGxlbnRlc3F1ZSBNYWxlc3VhZGEsIENhaW8gQXJpZWRlCiAqIChodHRwOi8vY2Fpb2FyaWVkZS5jb20pLCBLYW5rcmVsdW5lIChodHRwOi8vd3d3LndlYmZha3RvcnkuaW5mby8pLCBBbGZvbnNvCiAqIEppbWVuZXogKGh0dHA6Ly93d3cuYWxmb25zb2ppbWVuZXouY29tKSwgU2FraW1vcmksIFN0ZXZlIEhpbGRlciwgZ29ydGhhdXIsCiAqIEFtYW4gR3VwdGEsIEthcm9sIEtvd2Fsc2tpLCBUaHVuZGVyLm0sIFR5bGVyIEFraW5zIChodHRwOi8vcnVta2luLmNvbSksCiAqIGpvaG4gKGh0dHA6Ly93d3cuamQtdGVjaC5uZXQpLCBEb3VnbGFzIENyb2NrZm9yZAogKiAoaHR0cDovL2phdmFzY3JpcHQuY3JvY2tmb3JkLmNvbSksIG1rdGltZSwgR2lsYmVydCwgTWFyY28sIHBhdWxvIGt1b25nLAogKiBGcmFuayBGb3J0ZSwgZHVuY2FuLCBtYWRpcHRhLCBnZXIsIFN1Ymhhc2lzIERlYiwgZmVsaXgsIERlbm55IFdhcmRoYW5hLAogKiBNYXRldXN6ICJsb29ucXVhd2wiIFphbGVnYSwgUmV2ZXJzZVN5bnRheCwgRnJhbmNvaXMsIFNjb3R0IENhcmlzcywgU2xhd29taXIKICogS2FuaWVja2ksIEFybm8sIE5hdGhhbiwgTmljayBLb2xvc292IChodHRwOi8vc2FtbXkucnUpLCAwbTNyLCBub25hbWUsIG1hcmMKICogYW5kcmV1LCBGb3gsIHNhbmthaSwgU2Fuam95IFJveSwgbm9iYmxlciwgU3RldmUgQ2xheSwgY2xhc3NfZXhpc3RzLCBUaGlhZ28KICogTWF0YSAoaHR0cDovL3RoaWFnb21hdGEuYmxvZy5jb20pLCBKb24gSG9obGUsIG5vcmRfdWEsIE96aCwgZWNobyBpcyBiYWQsCiAqIExpbnV4d29ybGQsIFhvcmFYIChodHRwOi8vd3d3LnhvcmF4LmluZm8pLCBQeWVycmUsIFNvcmVuIEhhbnNlbiwgQnJhZAogKiBUb3Vlc25hcmQsIE1lRXRjIChodHRwOi8veWFzcy5tZWV0Y3dlYi5jb20pLCBUaW0gV2llbCwgQnJ5YW4gRWxsaW90dCwKICogVDBic24sIFBldGVyLVBhdWwgS29jaCAoaHR0cDovL3d3dy5xdWlya3Ntb2RlLm9yZy9qcy9iZWF0Lmh0bWwpLCBEYXZpZAogKiBSYW5kYWxsLCBEZXIgU2ltb24gKGh0dHA6Ly9pbm5lcmRvbS5zb3VyY2Vmb3JnZS5uZXQvKSwgbG1leXJpY2sKICogKGh0dHBzOi8vc291cmNlZm9yZ2UubmV0L3Byb2plY3RzL2JjbWF0aC1qcy90aGlzLiksIEh5YW0gU2luZ2VyCiAqIChodHRwOi8vd3d3LmltcGFjdC1jb21wdXRpbmcuY29tLyksIFBhdWwsIGtlbm5ldGgsIFJhcGhhZWwgKEFvIFJVRExFUiksCiAqIERhdmlkIEphbWVzLCBULiBXaWxkLCBPbGUgVnJpamVuaG9layAoaHR0cDovL3d3dy5uZXJ2b3VzLm5sLyksIEogQSBSLAogKiBCYXlyb24gR3VldmFyYSwgTEgsIEpCLCBFdWdlbmUgQnVsa2luIChodHRwOi8vZG91YmxlYXcuY29tLyksIFN0b3lhbiBLeW9zZXYKICogKGh0dHA6Ly93d3cuc3Zlc3Qub3JnLyksIGRqbWl4LCBNYXJjIEphbnNlbiwgRnJhbmNlc2NvLCBMaW5jb2xuIFJhbXNheSwKICogTWFuaXNoLCBkYXRlLCBLcmlzdG9mIENvb21hbnMgKFNDSy1DRU4gQmVsZ2lhbiBOdWNsZWFpciBSZXNlYXJjaCBDZW50cmUpLAogKiBQaWVycmUtTHVjIFBhb3VyLCBNYXJ0aW4gUG9vbCwgUmljayBXYWxkcm9uLCBLaXJrIFN0cm9iZWNrLCBTYXVsbyBWYWxsb3J5LAogKiBDaHJpc3RvcGgsIEFydHVyIFRjaGVybnljaGV2LCBXYWduZXIgQi4gU29hcmVzLCBWYWxlbnRpbmEgRGUgUm9zYSwgRGFuaWVsCiAqIEVzdGViYW4sIEphc29uIFdvbmcgKGh0dHA6Ly9jYXJyb3Qub3JnLyksIE1pY2tAZWwsIHJlem5hLCBTaW1vbiBXaWxsaXNvbgogKiAoaHR0cDovL3NpbW9ud2lsbGlzb24ubmV0KSwgR2FicmllbCBQYWRlcm5pLCBNYXJjbyB2YW4gT29ydCwKICogcGVudXRidXR0ZXJqZWxseSwgUGhpbGlwcCBMZW5zc2VuLCBBbnRvbiBPbmdzb24sIEJsdWVzCiAqIChodHRwOi8vdGVjaC5ibHVlc21vb24uaW5mby8pLCBUb21hc3ogV2Vzb2xvd3NraSwgRXJpYyBOYWdlbCwgQm9iYnkgRHJha2UsCiAqIEx1a2UgR29kZnJleSwgUHVsLCB1ZXN0bGEsIEFsYW4gQywgWXZlcyBTdWNhZXQsIHNvd2JlcnJ5LCBoaXR3b3JrLCBPcmxhbmRvLAogKiBOb3JtYW4gInpFaCIgRnVjaHMsIFVscmljaCwgam9obnJlbWJvLCBOaWNrIENhbGxlbiwgZWpzYW5kZXJzLCBBaWRhbiBMaXN0ZXIKICogKGh0dHA6Ly9haWRhbmxpc3Rlci5jb20vKSwgQnJpYW4gVGFmb3lhIChodHRwOi8vd3d3LnByZW1hc29sdXRpb25zLmNvbS8pLAogKiBQaGlsaXBwZSBKYXVzaW9ucyAoaHR0cDovL3BlYXIucGhwLm5ldC91c2VyL2phdXNpb25zKSwga2lsb3BzLCBkcHRyMTk4OCwKICogSEtNLCBtZXRqYXksIHN0cmNhc2VjbXAsIHN0cmNtcCwgVGFyYXMgQm9nYWNoLCBqcGZsZSwgQ2hhb3NObzEsIEFsZXhhbmRlcgogKiBFcm1vbGFldiAoaHR0cDovL3NuaXBwZXRzLmR6b25lLmNvbS91c2VyL0FsZXhhbmRlckVybW9sYWV2KSwgTGUgVG9yYmksCiAqIEphbWVzLCBDaHJpcywgRHhHeCwgUGVkcm8gVGFpbmhhIChodHRwOi8vd3d3LnBlZHJvdGFpbmhhLmNvbSksIENocmlzdGlhbgogKiBEb2VibGVyLCBzZXRjb29raWUsIEdyZWcgRnJhemllciwgVG9kIEdlbnRpbGxlLCBBbGV4YW5kZXIgTSBCZWVkaWUsCiAqIEZyZW15Q29tcGFueSwgVC5KLiBMZWFoeSwgYmFyaXMgb3pkaWwsIEZHRkVtcGVyb3IsIGRhbmllbCBhaXJ0b24gd2VybWFubgogKiAoaHR0cDovL3dlcm1hbm4uY29tLmJyKSwgM0QtR1JBRiwgamFrZXMsIGdhYnJpZWwgcGFkZXJuaSwgWWFubm9vLCBMdWlzCiAqIFNhbGF6YXIgKGh0dHA6Ly93d3cuZnJlYWt5LW1lZGlhLmNvbS8pLCBUaW0gZGUgS29uaW5nLCBzdGVuc2ksIEJpbGx5LCB2bGFkbwogKiBob3ViYSwgSXRzYWNvbiAoaHR0cDovL3d3dy5pdHNhY29uLm5ldC8pLCBKYWxhbCBCZXJyYW1pLCBNYXR0ZW8sIFZpY3RvciwKICogdGFpdGgsIFJvYmluLCBNYXR0IEJyYWRsZXksIGZlYXJwaGFnZQogKiAoaHR0cDovL2h0dHAvbXkub3BlcmEuY29tL2ZlYXJwaGFnZS8pLCBDb3JkLCBBdGxpIMOew7NyLCBNYXhpbXVzeWEsIEFuZHJlagogKiBQYXZsb3ZpYywgRGlubywgcmVtLCBHcmVlbnNlZWQsIG1lbywgR2FyYWdvdGgsIFJ1c3NlbGwgV2Fsa2VyCiAqIChodHRwOi8vd3d3Lm5iaWxsLmNvLnVrLyksIFlVSSBMaWJyYXJ5OgogKiBodHRwOi8vZGV2ZWxvcGVyLnlhaG9vLmNvbS95dWkvZG9jcy9ZQUhPTy51dGlsLkRhdGVMb2NhbGUuaHRtbCwgQmx1ZXMgYXQKICogaHR0cDovL2hhY2tzLmJsdWVzbW9vbi5pbmZvL3N0cmZ0aW1lL3N0cmZ0aW1lLmpzLCBBbmRyZWFzLCBKYW1pZSBCZWNrCiAqIChodHRwOi8vd3d3LnRlcmFiaXQuY2EvKSwgRHRUdkIKICogKGh0dHA6Ly9kdC5pbi50aC8yMDA4LTA5LTE2LnN0cmluZy1sZW5ndGgtaW4tYnl0ZXMuaHRtbCksIG1rLmtlY2ssIExlc2xpZQogKiBIb2FyZSwgRGlvZ28gUmVzZW5kZSwgSG93YXJkIFllZW5kLCBBbGxhbiBKZW5zZW4gKGh0dHA6Ly93d3cud2ludGVybmV0Lm5vKSwKICogZGF2b29rLCBCZW5qYW1pbiBMdXB0b24sIFJpdmFsLCBMdWtlIFNtaXRoIChodHRwOi8vbHVjYXNzbWl0aC5uYW1lKSwKICogYm9vZXlPSCwgQmVuIEJyeWFuLCBDYWdyaSBFa2luLCBBbWlyIEhhYmliaQogKiAoaHR0cDovL3d3dy5yZXNpZGVuY2UtbWl4dGUuY29tLyksIEtoZWFuZyBIb2sgQ2hpbgogKiAoaHR0cDovL3d3dy5kaXN0YW50aWEuY2EvKSwgSmF5IEtsZWhyCiAqCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCAoTUlULUxJQ0VOU0UudHh0KQogKiBhbmQgR1BMIChHUEwtTElDRU5TRS50eHQpIGxpY2Vuc2VzLgogKgogKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQogKiBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCiAqICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKICogd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAogKiBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8KICogcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvCiAqIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKICoKICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQKICogaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCiAqCiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCiAqIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKICogTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULgogKiBJTiBOTyBFVkVOVCBTSEFMTCBLRVZJTiBWQU4gWk9OTkVWRUxEIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTCiAqIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLAogKiBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgogKi8KCgovLyBDb21wcmVzc2lvbjogbWluaWZpZWQKCgpmdW5jdGlvbiBmaWxlX2dldF9jb250ZW50cyh1cmwsZmxhZ3MsY29udGV4dCxvZmZzZXQsbWF4TGVuKXt2YXIgdG1wLGhlYWRlcnM9W10sbmV3VG1wPVtdLGs9MCxpPTAsaHJlZj0nJyxwYXRoUG9zPS0xLGZsYWdOYW1lcz0wLGNvbnRlbnQ9bnVsbCxodHRwX3N0cmVhbT1mYWxzZTt2YXIgZnVuYz1mdW5jdGlvbih2YWx1ZSl7cmV0dXJuIHZhbHVlLnN1YnN0cmluZygxKSE9PScnO307dGhpcy5waHBfanM9dGhpcy5waHBfanN8fHt9O3RoaXMucGhwX2pzLmluaT10aGlzLnBocF9qcy5pbml8fHt9O3ZhciBpbmk9dGhpcy5waHBfanMuaW5pO2NvbnRleHQ9Y29udGV4dHx8dGhpcy5waHBfanMuZGVmYXVsdF9zdHJlYW1zX2NvbnRleHR8fG51bGw7aWYoIWZsYWdzKXtmbGFncz0wO30KdmFyIE9QVFM9e0ZJTEVfVVNFX0lOQ0xVREVfUEFUSDoxLEZJTEVfVEVYVDozMixGSUxFX0JJTkFSWTo2NH07aWYodHlwZW9mIGZsYWdzPT09J251bWJlcicpe2ZsYWdOYW1lcz1mbGFnczt9CmVsc2V7ZmxhZ3M9W10uY29uY2F0KGZsYWdzKTtmb3IoaT0wO2k8ZmxhZ3MubGVuZ3RoO2krKyl7aWYoT1BUU1tmbGFnc1tpXV0pe2ZsYWdOYW1lcz1mbGFnTmFtZXN8T1BUU1tmbGFnc1tpXV07fX19CmlmKGZsYWdOYW1lcyZPUFRTLkZJTEVfQklOQVJZJiYoZmxhZ05hbWVzJk9QVFMuRklMRV9URVhUKSl7dGhyb3cnWW91IGNhbm5vdCBwYXNzIGJvdGggRklMRV9CSU5BUlkgYW5kIEZJTEVfVEVYVCB0byBmaWxlX2dldF9jb250ZW50cygpJzt9CmlmKChmbGFnTmFtZXMmT1BUUy5GSUxFX1VTRV9JTkNMVURFX1BBVEgpJiZpbmkuaW5jbHVkZV9wYXRoJiZpbmkuaW5jbHVkZV9wYXRoLmxvY2FsX3ZhbHVlKXt2YXIgc2xhc2g9aW5pLmluY2x1ZGVfcGF0aC5sb2NhbF92YWx1ZS5pbmRleE9mKCcvJykhPT0tMT8nLyc6J1xcJzt1cmw9aW5pLmluY2x1ZGVfcGF0aC5sb2NhbF92YWx1ZStzbGFzaCt1cmw7fQplbHNlIGlmKCEvXihodHRwcz98ZmlsZSk6Ly50ZXN0KHVybCkpe2hyZWY9dGhpcy53aW5kb3cubG9jYXRpb24uaHJlZjtwYXRoUG9zPXVybC5pbmRleE9mKCcvJyk9PT0wP2hyZWYuaW5kZXhPZignLycsOCktMTpocmVmLmxhc3RJbmRleE9mKCcvJyk7dXJsPWhyZWYuc2xpY2UoMCxwYXRoUG9zKzEpK3VybDt9CmlmKGNvbnRleHQpe3ZhciBodHRwX29wdGlvbnM9Y29udGV4dC5zdHJlYW1fb3B0aW9ucyYmY29udGV4dC5zdHJlYW1fb3B0aW9ucy5odHRwO2h0dHBfc3RyZWFtPSEhaHR0cF9vcHRpb25zO30KaWYoIWNvbnRleHR8fGh0dHBfc3RyZWFtKXt2YXIgcmVxPXRoaXMud2luZG93LkFjdGl2ZVhPYmplY3Q/bmV3IEFjdGl2ZVhPYmplY3QoJ01pY3Jvc29mdC5YTUxIVFRQJyk6bmV3IFhNTEh0dHBSZXF1ZXN0KCk7aWYoIXJlcSl7dGhyb3cgbmV3IEVycm9yKCdYTUxIdHRwUmVxdWVzdCBub3Qgc3VwcG9ydGVkJyk7fQp2YXIgbWV0aG9kPWh0dHBfc3RyZWFtP2h0dHBfb3B0aW9ucy5tZXRob2Q6J0dFVCc7dmFyIGFzeW5jPSEhKGNvbnRleHQmJmNvbnRleHQuc3RyZWFtX3BhcmFtcyYmY29udGV4dC5zdHJlYW1fcGFyYW1zWydwaHBqcy5hc3luYyddKTtpZihpbmlbJ3BocGpzLmFqYXhCeXBhc3NDYWNoZSddJiZpbmlbJ3BocGpzLmFqYXhCeXBhc3NDYWNoZSddLmxvY2FsX3ZhbHVlKXt1cmwrPSh1cmwubWF0Y2goL1w/Lyk9PW51bGw/Ij8iOiImIikrKG5ldyBEYXRlKCkpLmdldFRpbWUoKTt9CnJlcS5vcGVuKG1ldGhvZCx1cmwsYXN5bmMpO2lmKGFzeW5jKXt2YXIgbm90aWZpY2F0aW9uPWNvbnRleHQuc3RyZWFtX3BhcmFtcy5ub3RpZmljYXRpb247aWYodHlwZW9mIG5vdGlmaWNhdGlvbj09PSdmdW5jdGlvbicpe2lmKDAmJnJlcS5hZGRFdmVudExpc3RlbmVyKXt9CmVsc2V7cmVxLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbihhRXZ0KXt2YXIgb2JqQ29udGV4dD17cmVzcG9uc2VUZXh0OnJlcS5yZXNwb25zZVRleHQscmVzcG9uc2VYTUw6cmVxLnJlc3BvbnNlWE1MLHN0YXR1czpyZXEuc3RhdHVzLHN0YXR1c1RleHQ6cmVxLnN0YXR1c1RleHQscmVhZHlTdGF0ZTpyZXEucmVhZHlTdGF0ZSxldnQ6YUV2dH07dmFyIGJ5dGVzX3RyYW5zZmVycmVkO3N3aXRjaChyZXEucmVhZHlTdGF0ZSl7Y2FzZSAwOm5vdGlmaWNhdGlvbi5jYWxsKG9iakNvbnRleHQsMCwwLCcnLDAsMCwwKTticmVhaztjYXNlIDE6bm90aWZpY2F0aW9uLmNhbGwob2JqQ29udGV4dCwwLDAsJycsMCwwLDApO2JyZWFrO2Nhc2UgMjpub3RpZmljYXRpb24uY2FsbChvYmpDb250ZXh0LDAsMCwnJywwLDAsMCk7YnJlYWs7Y2FzZSAzOmJ5dGVzX3RyYW5zZmVycmVkPXJlcS5yZXNwb25zZVRleHQubGVuZ3RoKjI7bm90aWZpY2F0aW9uLmNhbGwob2JqQ29udGV4dCw3LDAsJycsMCxieXRlc190cmFuc2ZlcnJlZCwwKTticmVhaztjYXNlIDQ6aWYocmVxLnN0YXR1cz49MjAwJiZyZXEuc3RhdHVzPDQwMCl7Ynl0ZXNfdHJhbnNmZXJyZWQ9cmVxLnJlc3BvbnNlVGV4dC5sZW5ndGgqMjtub3RpZmljYXRpb24uY2FsbChvYmpDb250ZXh0LDgsMCwnJyxyZXEuc3RhdHVzLGJ5dGVzX3RyYW5zZmVycmVkLDApO30KZWxzZSBpZihyZXEuc3RhdHVzPT09NDAzKXtub3RpZmljYXRpb24uY2FsbChvYmpDb250ZXh0LDEwLDIsJycscmVxLnN0YXR1cywwLDApO30KZWxzZXtub3RpZmljYXRpb24uY2FsbChvYmpDb250ZXh0LDksMiwnJyxyZXEuc3RhdHVzLDAsMCk7fQpicmVhaztkZWZhdWx0OnRocm93J1VucmVjb2duaXplZCByZWFkeSBzdGF0ZSBmb3IgZmlsZV9nZXRfY29udGVudHMoKSc7fX19fX0KaWYoaHR0cF9zdHJlYW0pe3ZhciBzZW5kSGVhZGVycz1odHRwX29wdGlvbnMuaGVhZGVyJiZodHRwX29wdGlvbnMuaGVhZGVyLnNwbGl0KC9ccj9cbi8pO3ZhciB1c2VyQWdlbnRTZW50PWZhbHNlO2ZvcihpPTA7aTxzZW5kSGVhZGVycy5sZW5ndGg7aSsrKXt2YXIgc2VuZEhlYWRlcj1zZW5kSGVhZGVyc1tpXTt2YXIgYnJlYWtQb3M9c2VuZEhlYWRlci5zZWFyY2goLzpccyovKTt2YXIgc2VuZEhlYWRlck5hbWU9c2VuZEhlYWRlci5zdWJzdHJpbmcoMCxicmVha1Bvcyk7cmVxLnNldFJlcXVlc3RIZWFkZXIoc2VuZEhlYWRlck5hbWUsc2VuZEhlYWRlci5zdWJzdHJpbmcoYnJlYWtQb3MrMSkpO2lmKHNlbmRIZWFkZXJOYW1lPT09J1VzZXItQWdlbnQnKXt1c2VyQWdlbnRTZW50PXRydWU7fX0KaWYoIXVzZXJBZ2VudFNlbnQpe3ZhciB1c2VyX2FnZW50PWh0dHBfb3B0aW9ucy51c2VyX2FnZW50fHwoaW5pLnVzZXJfYWdlbnQmJmluaS51c2VyX2FnZW50LmxvY2FsX3ZhbHVlKTtpZih1c2VyX2FnZW50KXtyZXEuc2V0UmVxdWVzdEhlYWRlcignVXNlci1BZ2VudCcsdXNlcl9hZ2VudCk7fX0KY29udGVudD1odHRwX29wdGlvbnMuY29udGVudHx8bnVsbDt9CmlmKGZsYWdOYW1lcyZPUFRTLkZJTEVfVEVYVCl7dmFyIGNvbnRlbnRfdHlwZT0ndGV4dC9odG1sJztpZihodHRwX29wdGlvbnMmJmh0dHBfb3B0aW9uc1sncGhwanMub3ZlcnJpZGUnXSl7Y29udGVudF90eXBlPWh0dHBfb3B0aW9uc1sncGhwanMub3ZlcnJpZGUnXTt9CmVsc2V7dmFyIGVuY29kaW5nPShpbmlbJ3VuaWNvZGUuc3RyZWFtX2VuY29kaW5nJ10mJmluaVsndW5pY29kZS5zdHJlYW1fZW5jb2RpbmcnXS5sb2NhbF92YWx1ZSl8fCdVVEYtOCc7aWYoaHR0cF9vcHRpb25zJiZodHRwX29wdGlvbnMuaGVhZGVyJiYoL15jb250ZW50LXR5cGU6L2ltKS50ZXN0KGh0dHBfb3B0aW9ucy5oZWFkZXIpKXtjb250ZW50X3R5cGU9aHR0cF9vcHRpb25zLmhlYWRlci5tYXRjaCgvXmNvbnRlbnQtdHlwZTpccyooLiopJC9pbSlbMV07fQppZighKC87XHMqY2hhcnNldD0vKS50ZXN0KGNvbnRlbnRfdHlwZSkpe2NvbnRlbnRfdHlwZSs9JzsgY2hhcnNldD0nK2VuY29kaW5nO319CnJlcS5vdmVycmlkZU1pbWVUeXBlKGNvbnRlbnRfdHlwZSk7fQplbHNlIGlmKGZsYWdOYW1lcyZPUFRTLkZJTEVfQklOQVJZKXtyZXEub3ZlcnJpZGVNaW1lVHlwZSgndGV4dC9wbGFpbjsgY2hhcnNldD14LXVzZXItZGVmaW5lZCcpO30KaWYoaHR0cF9vcHRpb25zJiZodHRwX29wdGlvbnNbJ3BocGpzLnNlbmRBc0JpbmFyeSddKXtyZXEuc2VuZEFzQmluYXJ5KGNvbnRlbnQpO30KZWxzZXtyZXEuc2VuZChjb250ZW50KTt9CnRtcD1yZXEuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCk7aWYodG1wKXt0bXA9dG1wLnNwbGl0KCdcbicpO2ZvcihrPTA7azx0bXAubGVuZ3RoO2srKyl7aWYoZnVuYyh0bXBba10pKXtuZXdUbXAucHVzaCh0bXBba10pO319CnRtcD1uZXdUbXA7Zm9yKGk9MDtpPHRtcC5sZW5ndGg7aSsrKXtoZWFkZXJzW2ldPXRtcFtpXTt9CnRoaXMuJGh0dHBfcmVzcG9uc2VfaGVhZGVyPWhlYWRlcnM7fQppZihvZmZzZXR8fG1heExlbil7aWYobWF4TGVuKXtyZXR1cm4gcmVxLnJlc3BvbnNlVGV4dC5zdWJzdHIob2Zmc2V0fHwwLG1heExlbik7fQpyZXR1cm4gcmVxLnJlc3BvbnNlVGV4dC5zdWJzdHIob2Zmc2V0KTt9CnJldHVybiByZXEucmVzcG9uc2VUZXh0O30KcmV0dXJuIGZhbHNlO30K",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 22:00:11 GMT",
                    "Content-Length": "11100",
                    "Date": "Fri, 07 Nov 2014 22:00:15 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}