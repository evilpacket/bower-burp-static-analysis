{
    "url": "http://localhost:9999/HenrikJoreteg/SimpleWebRTC/",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>location.href</b> and written to <b>the 'text()' function of JQuery</b> via the following statement:<ul><li>$('#subTitle').text('Link to join: ' + location.href);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/HenrikJoreteg/SimpleWebRTC/",
                "path": "/HenrikJoreteg/SimpleWebRTC/",
                "httpVersion": "HTTP/0.0",
                "method": "GET",
                "headers": {
                    "Referer": "http://localhost:9999/HenrikJoreteg/SimpleWebRTC/index.html",
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9IZW5yaWtKb3JldGVnL1NpbXBsZVdlYlJUQy8gSFRUUC8wLjANCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQpSZWZlcmVyOiBodHRwOi8vbG9jYWxob3N0Ojk5OTkvSGVucmlrSm9yZXRlZy9TaW1wbGVXZWJSVEMvaW5kZXguaHRtbA0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjQzNA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBTYXQsIDA4IE5vdiAyMDE0IDA0OjQzOjUyIEdNVA0KTGFzdC1Nb2RpZmllZDogU2F0LCAwOCBOb3YgMjAxNCAwNDo0Mzo1MiBHTVQNCg0KPCFET0NUWVBFIGh0bWw+CjxodG1sPgogICAgPGhlYWQ+CiAgICAgICAgPHRpdGxlPlNpbXBsZVdlYlJUQyBEZW1vPC90aXRsZT4KICAgIDwvaGVhZD4KICAgIDxib2R5PgogICAgICAgIDxoMSBpZD0idGl0bGUiPlN0YXJ0IGEgcm9vbTwvaDE+CiAgICAgICAgPHN0eWxlPgogICAgICAgICAgICAudmlkZW9Db250YWluZXIgewogICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgICAgICAgICAgd2lkdGg6IDIwMHB4OwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxNTBweDsKICAgICAgICAgICAgfQogICAgICAgICAgICAudmlkZW9Db250YWluZXIgdmlkZW8gewogICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnZvbHVtZV9iYXIgewogICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICAgICAgd2lkdGg6IDVweDsKICAgICAgICAgICAgICAgIGhlaWdodDogMHB4OwogICAgICAgICAgICAgICAgcmlnaHQ6IDBweDsKICAgICAgICAgICAgICAgIGJvdHRvbTogMHB4OwogICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzEyYWNlZjsKICAgICAgICAgICAgfQogICAgICAgIDwvc3R5bGU+CiAgICAgICAgPGJ1dHRvbiBpZD0ic2NyZWVuU2hhcmVCdXR0b24iPjwvYnV0dG9uPgogICAgICAgIDxwIGlkPSJzdWJUaXRsZSI+PC9wPgogICAgICAgIDxmb3JtIGlkPSJjcmVhdGVSb29tIj4KICAgICAgICAgICAgPGlucHV0IGlkPSJzZXNzaW9uSW5wdXQiLz4KICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJzdWJtaXQiPkNyZWF0ZSBpdCE8L2J1dHRvbj4KICAgICAgICA8L2Zvcm0+CiAgICAgICAgPGRpdiBjbGFzcz0idmlkZW9Db250YWluZXIiPgogICAgICAgICAgICA8dmlkZW8gaWQ9ImxvY2FsVmlkZW8iIHN0eWxlPSJoZWlnaHQ6IDE1MHB4OyIgb25jb250ZXh0bWVudT0icmV0dXJuIGZhbHNlOyI+PC92aWRlbz4KICAgICAgICAgICAgPGRpdiBpZD0ibG9jYWxWb2x1bWUiIGNsYXNzPSJ2b2x1bWVfYmFyIj48L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJyZW1vdGVzIj48L2Rpdj4KICAgICAgICA8c2NyaXB0IHNyYz0iLy9hamF4Lmdvb2dsZWFwaXMuY29tL2FqYXgvbGlicy9qcXVlcnkvMS45LjAvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICAgICAgPHNjcmlwdCBzcmM9InNvY2tldC5pby5qcyI+PC9zY3JpcHQ+CiAgICAgICAgPHNjcmlwdCBzcmM9InNpbXBsZXdlYnJ0Yy5idW5kbGUuanMiPjwvc2NyaXB0PgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgIC8vIGdyYWIgdGhlIHJvb20gZnJvbSB0aGUgVVJMCiAgICAgICAgICAgIHZhciByb29tID0gbG9jYXRpb24uc2VhcmNoICYmIGxvY2F0aW9uLnNlYXJjaC5zcGxpdCgnPycpWzFdOwoKICAgICAgICAgICAgLy8gY3JlYXRlIG91ciB3ZWJydGMgY29ubmVjdGlvbgogICAgICAgICAgICB2YXIgd2VicnRjID0gbmV3IFNpbXBsZVdlYlJUQyh7CiAgICAgICAgICAgICAgICAvLyB0aGUgaWQvZWxlbWVudCBkb20gZWxlbWVudCB0aGF0IHdpbGwgaG9sZCAib3VyIiB2aWRlbwogICAgICAgICAgICAgICAgbG9jYWxWaWRlb0VsOiAnbG9jYWxWaWRlbycsCiAgICAgICAgICAgICAgICAvLyB0aGUgaWQvZWxlbWVudCBkb20gZWxlbWVudCB0aGF0IHdpbGwgaG9sZCByZW1vdGUgdmlkZW9zCiAgICAgICAgICAgICAgICByZW1vdGVWaWRlb3NFbDogJycsCiAgICAgICAgICAgICAgICAvLyBpbW1lZGlhdGVseSBhc2sgZm9yIGNhbWVyYSBhY2Nlc3MKICAgICAgICAgICAgICAgIGF1dG9SZXF1ZXN0TWVkaWE6IHRydWUsCiAgICAgICAgICAgICAgICBkZWJ1ZzogZmFsc2UsCiAgICAgICAgICAgICAgICBkZXRlY3RTcGVha2luZ0V2ZW50czogdHJ1ZSwKICAgICAgICAgICAgICAgIGF1dG9BZGp1c3RNaWM6IGZhbHNlCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gd2hlbiBpdCdzIHJlYWR5LCBqb2luIGlmIHdlIGdvdCBhIHJvb20gZnJvbSB0aGUgVVJMCiAgICAgICAgICAgIHdlYnJ0Yy5vbigncmVhZHlUb0NhbGwnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvLyB5b3UgY2FuIG5hbWUgaXQgYW55dGhpbmcKICAgICAgICAgICAgICAgIGlmIChyb29tKSB3ZWJydGMuam9pblJvb20ocm9vbSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgZnVuY3Rpb24gc2hvd1ZvbHVtZShlbCwgdm9sdW1lKSB7CiAgICAgICAgICAgICAgICBpZiAoIWVsKSByZXR1cm47CiAgICAgICAgICAgICAgICBpZiAodm9sdW1lIDwgLTQ1KSB7IC8vIHZhcnkgYmV0d2VlbiAtNDUgYW5kIC0yMAogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9ICcwcHgnOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2b2x1bWUgPiAtMjApIHsKICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9ICcnICsgTWF0aC5mbG9vcigodm9sdW1lICsgMTAwKSAqIDEwMCAvIDI1IC0gMjIwKSArICclJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB3ZWJydGMub24oJ2NoYW5uZWxNZXNzYWdlJywgZnVuY3Rpb24gKHBlZXIsIGxhYmVsLCBkYXRhKSB7CiAgICAgICAgICAgICAgICBpZiAoZGF0YS50eXBlID09ICd2b2x1bWUnKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd1ZvbHVtZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndm9sdW1lXycgKyBwZWVyLmlkKSwgZGF0YS52b2x1bWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgd2VicnRjLm9uKCd2aWRlb0FkZGVkJywgZnVuY3Rpb24gKHZpZGVvLCBwZWVyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndmlkZW8gYWRkZWQnLCBwZWVyKTsKICAgICAgICAgICAgICAgIHZhciByZW1vdGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbW90ZXMnKTsKICAgICAgICAgICAgICAgIGlmIChyZW1vdGVzKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBkLmNsYXNzTmFtZSA9ICd2aWRlb0NvbnRhaW5lcic7CiAgICAgICAgICAgICAgICAgICAgZC5pZCA9ICdjb250YWluZXJfJyArIHdlYnJ0Yy5nZXREb21JZChwZWVyKTsKICAgICAgICAgICAgICAgICAgICBkLmFwcGVuZENoaWxkKHZpZGVvKTsKICAgICAgICAgICAgICAgICAgICB2YXIgdm9sID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgdm9sLmlkID0gJ3ZvbHVtZV8nICsgcGVlci5pZDsKICAgICAgICAgICAgICAgICAgICB2b2wuY2xhc3NOYW1lID0gJ3ZvbHVtZV9iYXInOwogICAgICAgICAgICAgICAgICAgIHZpZGVvLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZpZGVvLnN0eWxlLndpZHRoID0gdmlkZW8udmlkZW9XaWR0aCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIHZpZGVvLnN0eWxlLmhlaWdodCA9IHZpZGVvLnZpZGVvSGVpZ2h0ICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGQuYXBwZW5kQ2hpbGQodm9sKTsKICAgICAgICAgICAgICAgICAgICByZW1vdGVzLmFwcGVuZENoaWxkKGQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgd2VicnRjLm9uKCd2aWRlb1JlbW92ZWQnLCBmdW5jdGlvbiAodmlkZW8sIHBlZXIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd2aWRlbyByZW1vdmVkICcsIHBlZXIpOwogICAgICAgICAgICAgICAgdmFyIHJlbW90ZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtb3RlcycpOwogICAgICAgICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcl8nICsgd2VicnRjLmdldERvbUlkKHBlZXIpKTsKICAgICAgICAgICAgICAgIGlmIChyZW1vdGVzICYmIGVsKSB7CiAgICAgICAgICAgICAgICAgICAgcmVtb3Rlcy5yZW1vdmVDaGlsZChlbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB3ZWJydGMub24oJ3ZvbHVtZUNoYW5nZScsIGZ1bmN0aW9uICh2b2x1bWUsIHRyZXNob2xkKSB7CiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdvd24gdm9sdW1lJywgdm9sdW1lKTsKICAgICAgICAgICAgICAgIHNob3dWb2x1bWUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvY2FsVm9sdW1lJyksIHZvbHVtZSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gU2luY2Ugd2UgdXNlIHRoaXMgdHdpY2Ugd2UgcHV0IGl0IGhlcmUKICAgICAgICAgICAgZnVuY3Rpb24gc2V0Um9vbShuYW1lKSB7CiAgICAgICAgICAgICAgICAkKCdmb3JtJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAkKCdoMScpLnRleHQobmFtZSk7CiAgICAgICAgICAgICAgICAkKCcjc3ViVGl0bGUnKS50ZXh0KCdMaW5rIHRvIGpvaW46ICcgKyBsb2NhdGlvbi5ocmVmKTsKICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnYWN0aXZlJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyb29tKSB7CiAgICAgICAgICAgICAgICBzZXRSb29tKHJvb20pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgJCgnZm9ybScpLnN1Ym1pdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9ICQoJyNzZXNzaW9uSW5wdXQnKS52YWwoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICctJykucmVwbGFjZSgvW15BLVphLXowLTlfXC1dL2csICcnKTsKICAgICAgICAgICAgICAgICAgICB3ZWJydGMuY3JlYXRlUm9vbSh2YWwsIGZ1bmN0aW9uIChlcnIsIG5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyBjcmVhdGUgcm9vbSBjYicsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdVcmwgPSBsb2NhdGlvbi5wYXRobmFtZSArICc/JyArIG5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7Zm9vOiAnYmFyJ30sIG51bGwsIG5ld1VybCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRSb29tKG5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgICAgICAgICAgCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGJ1dHRvbiA9ICQoJyNzY3JlZW5TaGFyZUJ1dHRvbicpLAogICAgICAgICAgICAgICAgc2V0QnV0dG9uID0gZnVuY3Rpb24gKGJvb2wpIHsKICAgICAgICAgICAgICAgICAgICBidXR0b24udGV4dChib29sID8gJ3NoYXJlIHNjcmVlbicgOiAnc3RvcCBzaGFyaW5nJyk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB3ZWJydGMub24oJ2xvY2FsU2NyZWVuU3RvcHBlZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHNldEJ1dHRvbih0cnVlKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBzZXRCdXR0b24odHJ1ZSk7CgogICAgICAgICAgICBidXR0b24uY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKHdlYnJ0Yy5nZXRMb2NhbFNjcmVlbigpKSB7CiAgICAgICAgICAgICAgICAgICAgd2VicnRjLnN0b3BTY3JlZW5TaGFyZSgpOwogICAgICAgICAgICAgICAgICAgIHNldEJ1dHRvbih0cnVlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgd2VicnRjLnNoYXJlU2NyZWVuKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QnV0dG9uKHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QnV0dG9uKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICA8L3NjcmlwdD4KICAgIDwvYm9keT4KPC9odG1sPgo=",
                "body": "PCFET0NUWVBFIGh0bWw+CjxodG1sPgogICAgPGhlYWQ+CiAgICAgICAgPHRpdGxlPlNpbXBsZVdlYlJUQyBEZW1vPC90aXRsZT4KICAgIDwvaGVhZD4KICAgIDxib2R5PgogICAgICAgIDxoMSBpZD0idGl0bGUiPlN0YXJ0IGEgcm9vbTwvaDE+CiAgICAgICAgPHN0eWxlPgogICAgICAgICAgICAudmlkZW9Db250YWluZXIgewogICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgICAgICAgICAgd2lkdGg6IDIwMHB4OwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxNTBweDsKICAgICAgICAgICAgfQogICAgICAgICAgICAudmlkZW9Db250YWluZXIgdmlkZW8gewogICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnZvbHVtZV9iYXIgewogICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICAgICAgd2lkdGg6IDVweDsKICAgICAgICAgICAgICAgIGhlaWdodDogMHB4OwogICAgICAgICAgICAgICAgcmlnaHQ6IDBweDsKICAgICAgICAgICAgICAgIGJvdHRvbTogMHB4OwogICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzEyYWNlZjsKICAgICAgICAgICAgfQogICAgICAgIDwvc3R5bGU+CiAgICAgICAgPGJ1dHRvbiBpZD0ic2NyZWVuU2hhcmVCdXR0b24iPjwvYnV0dG9uPgogICAgICAgIDxwIGlkPSJzdWJUaXRsZSI+PC9wPgogICAgICAgIDxmb3JtIGlkPSJjcmVhdGVSb29tIj4KICAgICAgICAgICAgPGlucHV0IGlkPSJzZXNzaW9uSW5wdXQiLz4KICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJzdWJtaXQiPkNyZWF0ZSBpdCE8L2J1dHRvbj4KICAgICAgICA8L2Zvcm0+CiAgICAgICAgPGRpdiBjbGFzcz0idmlkZW9Db250YWluZXIiPgogICAgICAgICAgICA8dmlkZW8gaWQ9ImxvY2FsVmlkZW8iIHN0eWxlPSJoZWlnaHQ6IDE1MHB4OyIgb25jb250ZXh0bWVudT0icmV0dXJuIGZhbHNlOyI+PC92aWRlbz4KICAgICAgICAgICAgPGRpdiBpZD0ibG9jYWxWb2x1bWUiIGNsYXNzPSJ2b2x1bWVfYmFyIj48L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJyZW1vdGVzIj48L2Rpdj4KICAgICAgICA8c2NyaXB0IHNyYz0iLy9hamF4Lmdvb2dsZWFwaXMuY29tL2FqYXgvbGlicy9qcXVlcnkvMS45LjAvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICAgICAgPHNjcmlwdCBzcmM9InNvY2tldC5pby5qcyI+PC9zY3JpcHQ+CiAgICAgICAgPHNjcmlwdCBzcmM9InNpbXBsZXdlYnJ0Yy5idW5kbGUuanMiPjwvc2NyaXB0PgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgIC8vIGdyYWIgdGhlIHJvb20gZnJvbSB0aGUgVVJMCiAgICAgICAgICAgIHZhciByb29tID0gbG9jYXRpb24uc2VhcmNoICYmIGxvY2F0aW9uLnNlYXJjaC5zcGxpdCgnPycpWzFdOwoKICAgICAgICAgICAgLy8gY3JlYXRlIG91ciB3ZWJydGMgY29ubmVjdGlvbgogICAgICAgICAgICB2YXIgd2VicnRjID0gbmV3IFNpbXBsZVdlYlJUQyh7CiAgICAgICAgICAgICAgICAvLyB0aGUgaWQvZWxlbWVudCBkb20gZWxlbWVudCB0aGF0IHdpbGwgaG9sZCAib3VyIiB2aWRlbwogICAgICAgICAgICAgICAgbG9jYWxWaWRlb0VsOiAnbG9jYWxWaWRlbycsCiAgICAgICAgICAgICAgICAvLyB0aGUgaWQvZWxlbWVudCBkb20gZWxlbWVudCB0aGF0IHdpbGwgaG9sZCByZW1vdGUgdmlkZW9zCiAgICAgICAgICAgICAgICByZW1vdGVWaWRlb3NFbDogJycsCiAgICAgICAgICAgICAgICAvLyBpbW1lZGlhdGVseSBhc2sgZm9yIGNhbWVyYSBhY2Nlc3MKICAgICAgICAgICAgICAgIGF1dG9SZXF1ZXN0TWVkaWE6IHRydWUsCiAgICAgICAgICAgICAgICBkZWJ1ZzogZmFsc2UsCiAgICAgICAgICAgICAgICBkZXRlY3RTcGVha2luZ0V2ZW50czogdHJ1ZSwKICAgICAgICAgICAgICAgIGF1dG9BZGp1c3RNaWM6IGZhbHNlCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gd2hlbiBpdCdzIHJlYWR5LCBqb2luIGlmIHdlIGdvdCBhIHJvb20gZnJvbSB0aGUgVVJMCiAgICAgICAgICAgIHdlYnJ0Yy5vbigncmVhZHlUb0NhbGwnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvLyB5b3UgY2FuIG5hbWUgaXQgYW55dGhpbmcKICAgICAgICAgICAgICAgIGlmIChyb29tKSB3ZWJydGMuam9pblJvb20ocm9vbSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgZnVuY3Rpb24gc2hvd1ZvbHVtZShlbCwgdm9sdW1lKSB7CiAgICAgICAgICAgICAgICBpZiAoIWVsKSByZXR1cm47CiAgICAgICAgICAgICAgICBpZiAodm9sdW1lIDwgLTQ1KSB7IC8vIHZhcnkgYmV0d2VlbiAtNDUgYW5kIC0yMAogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9ICcwcHgnOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2b2x1bWUgPiAtMjApIHsKICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9ICcnICsgTWF0aC5mbG9vcigodm9sdW1lICsgMTAwKSAqIDEwMCAvIDI1IC0gMjIwKSArICclJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB3ZWJydGMub24oJ2NoYW5uZWxNZXNzYWdlJywgZnVuY3Rpb24gKHBlZXIsIGxhYmVsLCBkYXRhKSB7CiAgICAgICAgICAgICAgICBpZiAoZGF0YS50eXBlID09ICd2b2x1bWUnKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd1ZvbHVtZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndm9sdW1lXycgKyBwZWVyLmlkKSwgZGF0YS52b2x1bWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgd2VicnRjLm9uKCd2aWRlb0FkZGVkJywgZnVuY3Rpb24gKHZpZGVvLCBwZWVyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndmlkZW8gYWRkZWQnLCBwZWVyKTsKICAgICAgICAgICAgICAgIHZhciByZW1vdGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbW90ZXMnKTsKICAgICAgICAgICAgICAgIGlmIChyZW1vdGVzKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBkLmNsYXNzTmFtZSA9ICd2aWRlb0NvbnRhaW5lcic7CiAgICAgICAgICAgICAgICAgICAgZC5pZCA9ICdjb250YWluZXJfJyArIHdlYnJ0Yy5nZXREb21JZChwZWVyKTsKICAgICAgICAgICAgICAgICAgICBkLmFwcGVuZENoaWxkKHZpZGVvKTsKICAgICAgICAgICAgICAgICAgICB2YXIgdm9sID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgdm9sLmlkID0gJ3ZvbHVtZV8nICsgcGVlci5pZDsKICAgICAgICAgICAgICAgICAgICB2b2wuY2xhc3NOYW1lID0gJ3ZvbHVtZV9iYXInOwogICAgICAgICAgICAgICAgICAgIHZpZGVvLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZpZGVvLnN0eWxlLndpZHRoID0gdmlkZW8udmlkZW9XaWR0aCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIHZpZGVvLnN0eWxlLmhlaWdodCA9IHZpZGVvLnZpZGVvSGVpZ2h0ICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGQuYXBwZW5kQ2hpbGQodm9sKTsKICAgICAgICAgICAgICAgICAgICByZW1vdGVzLmFwcGVuZENoaWxkKGQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgd2VicnRjLm9uKCd2aWRlb1JlbW92ZWQnLCBmdW5jdGlvbiAodmlkZW8sIHBlZXIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd2aWRlbyByZW1vdmVkICcsIHBlZXIpOwogICAgICAgICAgICAgICAgdmFyIHJlbW90ZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtb3RlcycpOwogICAgICAgICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcl8nICsgd2VicnRjLmdldERvbUlkKHBlZXIpKTsKICAgICAgICAgICAgICAgIGlmIChyZW1vdGVzICYmIGVsKSB7CiAgICAgICAgICAgICAgICAgICAgcmVtb3Rlcy5yZW1vdmVDaGlsZChlbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB3ZWJydGMub24oJ3ZvbHVtZUNoYW5nZScsIGZ1bmN0aW9uICh2b2x1bWUsIHRyZXNob2xkKSB7CiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdvd24gdm9sdW1lJywgdm9sdW1lKTsKICAgICAgICAgICAgICAgIHNob3dWb2x1bWUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvY2FsVm9sdW1lJyksIHZvbHVtZSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gU2luY2Ugd2UgdXNlIHRoaXMgdHdpY2Ugd2UgcHV0IGl0IGhlcmUKICAgICAgICAgICAgZnVuY3Rpb24gc2V0Um9vbShuYW1lKSB7CiAgICAgICAgICAgICAgICAkKCdmb3JtJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAkKCdoMScpLnRleHQobmFtZSk7CiAgICAgICAgICAgICAgICAkKCcjc3ViVGl0bGUnKS50ZXh0KCdMaW5rIHRvIGpvaW46ICcgKyBsb2NhdGlvbi5ocmVmKTsKICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnYWN0aXZlJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyb29tKSB7CiAgICAgICAgICAgICAgICBzZXRSb29tKHJvb20pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgJCgnZm9ybScpLnN1Ym1pdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9ICQoJyNzZXNzaW9uSW5wdXQnKS52YWwoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICctJykucmVwbGFjZSgvW15BLVphLXowLTlfXC1dL2csICcnKTsKICAgICAgICAgICAgICAgICAgICB3ZWJydGMuY3JlYXRlUm9vbSh2YWwsIGZ1bmN0aW9uIChlcnIsIG5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyBjcmVhdGUgcm9vbSBjYicsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdVcmwgPSBsb2NhdGlvbi5wYXRobmFtZSArICc/JyArIG5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7Zm9vOiAnYmFyJ30sIG51bGwsIG5ld1VybCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRSb29tKG5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgICAgICAgICAgCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGJ1dHRvbiA9ICQoJyNzY3JlZW5TaGFyZUJ1dHRvbicpLAogICAgICAgICAgICAgICAgc2V0QnV0dG9uID0gZnVuY3Rpb24gKGJvb2wpIHsKICAgICAgICAgICAgICAgICAgICBidXR0b24udGV4dChib29sID8gJ3NoYXJlIHNjcmVlbicgOiAnc3RvcCBzaGFyaW5nJyk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB3ZWJydGMub24oJ2xvY2FsU2NyZWVuU3RvcHBlZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHNldEJ1dHRvbih0cnVlKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBzZXRCdXR0b24odHJ1ZSk7CgogICAgICAgICAgICBidXR0b24uY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKHdlYnJ0Yy5nZXRMb2NhbFNjcmVlbigpKSB7CiAgICAgICAgICAgICAgICAgICAgd2VicnRjLnN0b3BTY3JlZW5TaGFyZSgpOwogICAgICAgICAgICAgICAgICAgIHNldEJ1dHRvbih0cnVlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgd2VicnRjLnNoYXJlU2NyZWVuKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QnV0dG9uKHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QnV0dG9uKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICA8L3NjcmlwdD4KICAgIDwvYm9keT4KPC9odG1sPgo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 04:43:52 GMT",
                    "Content-Length": "6434",
                    "Date": "Sat, 08 Nov 2014 04:43:52 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}