{
    "url": "http://localhost:9999/HummingTop/doresol_storymap/source/embed/",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>window.location.search</b> and written to <b>the 'open()' function of an XMLHttpRequest object</b> via the following statements:<ul><li>var qs = window.location.search.replace('?', '');</li><li>var pairs = qs.split('&amp;');</li><li>var p = pairs[i].split('=');</li><li>nvpair[p[0]] = p[1];</li><li>return nvpair;</li><li>var params = parseQuerystring();</li><li>var storymap_url = decodeURIComponent(params['url']);</li><li>storymap_url = location.protocol+'//proxy.knightlab.com/'+storymap_url.split('://')[1];</li><li>xdr.open(\"get\", storymap_url);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/HummingTop/doresol_storymap/source/embed/",
                "path": "/HummingTop/doresol_storymap/source/embed/",
                "httpVersion": "HTTP/0.0",
                "method": "GET",
                "headers": {
                    "Referer": "http://localhost:9999/HummingTop/doresol_storymap/source/embed",
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9IdW1taW5nVG9wL2RvcmVzb2xfc3RvcnltYXAvc291cmNlL2VtYmVkLyBIVFRQLzAuMA0KSG9zdDogbG9jYWxob3N0Ojk5OTkNClJlZmVyZXI6IGh0dHA6Ly9sb2NhbGhvc3Q6OTk5OS9IdW1taW5nVG9wL2RvcmVzb2xfc3RvcnltYXAvc291cmNlL2VtYmVkDQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNzM5Mg0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBUaHUsIDA2IE5vdiAyMDE0IDIxOjU2OjIyIEdNVA0KTGFzdC1Nb2RpZmllZDogVGh1LCAwNiBOb3YgMjAxNCAyMTo1NjoxMSBHTVQNCg0KPCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KCTxoZWFkPgoJCTx0aXRsZT5TdG9yeU1hcEpTIEVtYmVkPC90aXRsZT4KCQk8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CgkJPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IlN0b3J5TWFwSlMgRW1iZWQiPgoJCTxtZXRhIG5hbWU9ImFwcGxlLW1vYmlsZS13ZWItYXBwLWNhcGFibGUiIGNvbnRlbnQ9InllcyI+CgkJPG1ldGEgbmFtZT0iYXBwbGUtdG91Y2gtZnVsbHNjcmVlbiIgY29udGVudD0ieWVzIj4KCQk8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAiPgoJCTwhLS0gYnVpbGQ6Y3NzIC4uL2Nzcy9zdG9yeW1hcC5jc3MgLS0+CgkJPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIvYnVpbGQvY3NzL3N0b3J5bWFwLmNzcyI+CgkJPCEtLSBlbmRidWlsZCAtLT4KCQk8IS0tIGJ1aWxkOmpzIC4uL2pzL3N0b3J5bWFwLW1pbi5qcyAtLT4KCQk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSIvYnVpbGQvanMvc3RvcnltYXAuanMiPjwvc2NyaXB0PgoJCTwhLS0gZW5kYnVpbGQgLS0+CgkJPCEtLSBidWlsZDpqcyAuLi9qcy9qc29uMi5taW4uanMgLS0+CgkJPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iL2J1aWxkL2pzL2pzb24yLm1pbi5qcyI+PC9zY3JpcHQ+CgkJPCEtLSBlbmRidWlsZCAtLT4KCQk8c3R5bGU+CgkJCWh0bWwsIGJvZHkgewoJCQkgICAgd2lkdGg6IDEwMCU7CgkJCSAgICBoZWlnaHQ6IDEwMCU7CgkJCSAgICBwYWRkaW5nOiAwOwoJCQkgICAgbWFyZ2luOiAwOwoJCQl9CgkJCSNzdG9yeW1hcC1lbWJlZCB7CgkJCQkvKmJvcmRlcjogMXB4IHNvbGlkICM5OTk7Ki8KCQkJfQoJCTwvc3R5bGU+CgkJPCEtLSBIVE1MNSBzaGltLCBmb3IgSUU2LTggc3VwcG9ydCBvZiBIVE1MIGVsZW1lbnRzLS0+PCEtLVtpZiBsdCBJRSA5XT4KCQk8c2NyaXB0IHNyYz0iLy9odG1sNXNoaW0uZ29vZ2xlY29kZS5jb20vc3ZuL3RydW5rL2h0bWw1LmpzIj48L3NjcmlwdD48IVtlbmRpZl0tLT4KCTwvaGVhZD4KCTxib2R5PgoJCTxkaXYgaWQ9InN0b3J5bWFwLWVtYmVkIj48L2Rpdj4KCgkJPCEtLSBHb29nbGUgQW5hbHl0aWNzOiBkb24ndCBtZXNzIHdpdGggdGhpcyBzdHVmZiAtLT4KCQk8IS0tIG5hbWVkIHRyYWNrZXIgbm90ZXMgZnJvbSBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9hbmFseXRpY3MvZGV2Z3VpZGVzL2NvbGxlY3Rpb24vZ2Fqcy8gLS0+CgkJPCEtLSBtdWx0aS1kb21haW4gdHJhY2tpbmcgbm90ZXMgZnJvbSBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9hbmFseXRpY3MvZGV2Z3VpZGVzL2NvbGxlY3Rpb24vZ2Fqcy9nYVRyYWNraW5nU2l0ZSAtLT4KCQk8c2NyaXB0PgoJCSAgKGZ1bmN0aW9uKGkscyxvLGcscixhLG0pe2lbJ0dvb2dsZUFuYWx5dGljc09iamVjdCddPXI7aVtyXT1pW3JdfHxmdW5jdGlvbigpewoJCSAgKGlbcl0ucT1pW3JdLnF8fFtdKS5wdXNoKGFyZ3VtZW50cyl9LGlbcl0ubD0xKm5ldyBEYXRlKCk7YT1zLmNyZWF0ZUVsZW1lbnQobyksCgkJICBtPXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobylbMF07YS5hc3luYz0xO2Euc3JjPWc7bS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShhLG0pCgkJICB9KSh3aW5kb3csZG9jdW1lbnQsJ3NjcmlwdCcsJy8vd3d3Lmdvb2dsZS1hbmFseXRpY3MuY29tL2FuYWx5dGljcy5qcycsJ2dhJyk7CgoJCSAgZ2EoJ2NyZWF0ZScsICdVQS0yNzgyOTgwMi0yJywgJ2tuaWdodGxhYi5jb20nKTsgLyogU3RvcnlNYXAgRW1iZWQgYW5hbHl0aWNzIG9ubHkuIE5vdCBLbmlnaHRMYWIgYnJvYWRseSAqLwoJCSAgZ2EoJ3NlbmQnLCAncGFnZXZpZXcnKTsKCQkgIGdhKCdzZW5kJywgJ2V2ZW50JywgJ1N0b3J5TWFwSlMnLCAnRW1iZWRkZWRJbicsIGRvY3VtZW50LnJlZmVycmVyKQoKCQk8L3NjcmlwdD4KCQk8IS0tIEVuZCBHb29nbGUgQW5hbHl0aWNzIC0tPgoKCQk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CgoJCWZ1bmN0aW9uIHBhcnNlUXVlcnlzdHJpbmcoKSB7CgkJICAgIHZhciBudnBhaXIgPSB7fTsKCQkgICAgdmFyIHFzID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5yZXBsYWNlKCc/JywgJycpOwoJCSAgICB2YXIgcGFpcnMgPSBxcy5zcGxpdCgnJicpOwogICAgCgkJICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwYWlycy5sZW5ndGg7IGkrKykgewoJCSAgICAgICAgdmFyIHAgPSBwYWlyc1tpXS5zcGxpdCgnPScpOwoJCSAgICAgICAgbnZwYWlyW3BbMF1dID0gcFsxXTsKCQkgICAgfQoJCSAgICByZXR1cm4gbnZwYWlyOwoJCX0KCgkJZnVuY3Rpb24gZ2V0U2NyaXB0UGF0aChzY3JpcHRuYW1lKSB7CgkJICAgIHZhciBzY3JpcHRUYWdzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpOwogICAgCgkJCWZvcih2YXIgaSA9IDA7IGkgPCBzY3JpcHRUYWdzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICBpZihzY3JpcHRUYWdzW2ldLnNyYy5tYXRjaChzY3JpcHRuYW1lKSkgewoJCSAgICAgICAgICAgIHNjcmlwdF9wYXRoID0gc2NyaXB0VGFnc1tpXS5zcmM7ICAgICAgICAgICAgCgkJICAgICAgICAgICAgcmV0dXJuIHNjcmlwdF9wYXRoLnNwbGl0KCc/JylbMF0uc3BsaXQoJy8nKS5zbGljZSgwLCAtMSkuam9pbignLycpOwoJCSAgICAgICAgfQoJCQl9CgkJCXJldHVybiAnJzsKCQl9CgoJCWZ1bmN0aW9uIHVybF9qb2luKHVybCwgY29uY2F0KSB7IC8vIHNlZSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI2NzYxNzgvam9pbmluZy1yZWxhdGl2ZS11cmxzCgkJICAgIGZ1bmN0aW9uIGJ1aWxkKHBhcnRzLGNvbnRhaW5lcikgewoJCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpICsrKSB7CgkJICAgICAgICAgICAgaWYgKHBhcnRzW2ldID09ICcuLicpIHsKCQkgICAgICAgICAgICAgICAgY29udGFpbmVyLnBvcCgpOwoJCSAgICAgICAgICAgIH0gZWxzZSBpZiAocGFydHNbaV0gPT0gJy4nKSB7CgkJICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoJCSAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgIGNvbnRhaW5lci5wdXNoKHBhcnRzW2ldKTsKCQkgICAgICAgICAgICB9CgkJICAgICAgICB9CgkJICAgIH0KCQkgICAgdmFyIHVybF9wYXJ0cyA9IFsgXTsKCQkgICAgYnVpbGQodXJsLnNwbGl0KCcvJyksdXJsX3BhcnRzKTsKCQkgICAgYnVpbGQoY29uY2F0LnNwbGl0KCcvJyksdXJsX3BhcnRzKTsKCQkgICAgcmV0dXJuIHVybF9wYXJ0cy5qb2luKCcvJyk7CgkJfQoKCgkJdmFyIHN0b3J5bWFwID0gbnVsbDsKCgkJdmFyIHBhcmFtcyA9IHBhcnNlUXVlcnlzdHJpbmcoKTsKCQl2YXIgc3RvcnltYXBfdXJsID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhcmFtc1sndXJsJ10pOwoKCQkvLyBwcm94eQoJCXRyYWNlKG5hdmlnYXRvci51c2VyQWdlbnQpOwoKCQlpZighIW5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FwcGxlV2ViS2l0XC8uKiBNb2JpbGVcLy8pCgkJfHwgISFuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9WZXJzaW9uXC9bXGRcLl0rLipTYWZhcmkvKQoJCXx8ICEhbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9tc2llIFs3ODldLykpIHsgICAgCgkJICAgIGlmKHN0b3J5bWFwX3VybC5tYXRjaCgvXmh0dHBzPzpcL1wvd3d3XC5nb29nbGVkcml2ZVwuY29tXC9ob3N0XC8vKSkgewoJCSAgICAgICAgc3RvcnltYXBfdXJsID0gbG9jYXRpb24ucHJvdG9jb2wrJy8vcHJveHkua25pZ2h0bGFiLmNvbS8nK3N0b3J5bWFwX3VybC5zcGxpdCgnOi8vJylbMV07CgkJICAgICAgICB0cmFjZSgncHJveHksICcrc3RvcnltYXBfdXJsKTsKCQkgICAgfQoJCX0KCgkJdmFyIG9wdGlvbnMgPSB7CgkJICAgIHNjcmlwdF9wYXRoOiBnZXRTY3JpcHRQYXRoKC9zdG9yeW1hcCgtbWluKT9cLmpzLyksCgkJICAgIHN0YXJ0X2F0X3NsaWRlOiAwLAoJCSAgICBzaG93X2xpbmVzOiB0cnVlCgkJfTsKCgkJaWYocGFyYW1zLmhhc093blByb3BlcnR5KCdzdGFydF9hdF9zbGlkZScpKSB7CgkJICAgIG9wdGlvbnMuc3RhcnRfYXRfc2xpZGUgPSBwYXJzZUludChwYXJhbXMuc3RhcnRfYXRfc2xpZGUpOwoJCX0KCgkJZnVuY3Rpb24gc3RvcnltYXBfb25sb2FkKGQpIHsKCQkgICAgdHJhY2UoJ2VtYmVkOiBzdG9yeW1hcCBkYXRhIGxvYWRlZCcpOwoKCQkgICAgaWYgKGQgJiYgZC5zdG9yeW1hcCkgewogICAgICAgICAgICAgICAgUFJPUEVSVElFU19UT19DT1BZID0gWydtYXBfdHlwZScsICdtYXBfc3ViZG9tYWlucycsICdtYXBfYXNfaW1hZ2UnLCAndXNlX2N1c3RvbV9tYXJrZXJzJywgJ21hcF9iYWNrZ3JvdW5kX2NvbG9yJywgJ2xhbmd1YWdlJywgJ3pvb21pZnknLCAncmVsYXRpdmVfZGF0ZSddCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IFBST1BFUlRJRVNfVE9fQ09QWS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChkLnN0b3J5bWFwW1BST1BFUlRJRVNfVE9fQ09QWVtpXV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1tQUk9QRVJUSUVTX1RPX0NPUFlbaV1dID0gZC5zdG9yeW1hcFtQUk9QRVJUSUVTX1RPX0NPUFlbaV1dOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCQkgICAgICAgIGlmKGQuc3RvcnltYXAuaGFzT3duUHJvcGVydHkoJ3Nob3dfbGluZXMnKSkgewoJCSAgICAgICAgICAgIG9wdGlvbnMuc2hvd19saW5lcyA9IGQuc3RvcnltYXAuc2hvd19saW5lczsKCQkgICAgICAgIH0KCgkJICAgICAgICB2YXIgZm9udCA9ICJzdG9jazpkZWZhdWx0IjsKCQkgICAgICAgIGlmKGQuZm9udF9jc3MpIHsKCQkgICAgICAgICAgICBmb250ID0gZC5mb250X2NzczsKCQkgICAgICAgIH0KCQkgICAgICAgIGlmKGZvbnQuaW5kZXhPZigic3RvY2s6IikgPT0gMCkgewoJCSAgICAgICAgICAgIHZhciBmb250X25hbWUgPSBmb250LnNwbGl0KCc6JylbMV07CgkJICAgICAgICAgICAgdmFyIGJhc2VfdXJsID0gdXJsX2pvaW4ob3B0aW9ucy5zY3JpcHRfcGF0aCwiLi4vY3NzL2ZvbnRzIik7CgkJICAgICAgICAgICAgZm9udCA9IHVybF9qb2luKGJhc2VfdXJsLCAiZm9udC4iICsgZm9udF9uYW1lICsgIi5jc3MiKTsKCQkgICAgICAgIH0gZWxzZSBpZighZm9udC5tYXRjaCgnXihodHRwfGh0dHBzfC8vKScpKSB7CgkJICAgICAgICAgICAgZm9udCA9IHVybF9qb2luKG9wdGlvbnMuc2NyaXB0X3BhdGgsIGZvbnQpOwoJCSAgICAgICAgfQoJCSAgICAgICAgVkNPLkxvYWQuY3NzKGZvbnQsZnVuY3Rpb24oKXsgdHJhY2UoJ2ZvbnQgbG9hZGVkOiAnICsgZm9udCk7fSk7CgkJICAgICAgICBzdG9yeW1hcCA9IG5ldyBWQ08uU3RvcnlNYXAoJ3N0b3J5bWFwLWVtYmVkJywgZCwgb3B0aW9ucywge3RpdGxlOiBvbl9zdG9yeW1hcF90aXRsZX0pOwoJCSAgICB9CgkJfQoJCQoJCWZ1bmN0aW9uIG9uX3N0b3J5bWFwX3RpdGxlKGUpIHsKCQkJZG9jdW1lbnQudGl0bGUgPSAiU3RvcnlNYXBKUzogIiArIGUudGl0bGU7CgkJfTsKCQkKCQlmdW5jdGlvbiBzdG9yeW1hcF9nZXRqc29uKCkgewoJCSAgICBpZignd2l0aENyZWRlbnRpYWxzJyBpbiBuZXcgWE1MSHR0cFJlcXVlc3QoKSkgewoJCSAgICAgICAgLy8gU3VwcG9ydHMgY3Jvc3MtZG9tYWluIHJlcXVlc3RzCgkJICAgICAgICB0cmFjZSgnZW1iZWQ6IGxvYWRpbmcgZGF0YSB2aWEgWE1MSHR0cFJlcXVlc3QnKTsKCQkgICAgICAgIFZDTy5nZXRKU09OKHN0b3J5bWFwX3VybCwgc3RvcnltYXBfb25sb2FkKTsKCQkgICAgfSBlbHNlIGlmKHR5cGVvZiBYRG9tYWluUmVxdWVzdCAhPT0gInVuZGVmaW5lZCIpIHsKCQkgICAgICAgIC8vIFVzZSBJRS1zcGVjaWZpYyAiQ09SUyIgY29kZSB3aXRoIFhEUgoJCSAgICAgICAgdHJhY2UoJ2VtYmVkOiBsb2FkaW5nIGRhdGEgdmlhIFhEb21haW5SZXF1ZXN0Jyk7CgkJICAgICAgICB2YXIgeGRyID0gbmV3IFhEb21haW5SZXF1ZXN0KCk7CgkJICAgICAgICB4ZHIub25sb2FkID0gZnVuY3Rpb24oKSB7CgkJICAgICAgICAgICAgc3RvcnltYXBfb25sb2FkKEpTT04ucGFyc2UoeGRyLnJlc3BvbnNlVGV4dCkpOwoJCSAgICAgICAgfTsKCQkgICAgICAgIHhkci5vbmVycm9yID0gZnVuY3Rpb24oKSB7IAoJCSAgICAgICAgICAgIHRyYWNlKCdlbWJlZDogZXJyb3IgbG9hZGluZyBkYXRhIHZpYSBYRG9tYWluUmVxdWVzdCcpOyAKCQkgICAgICAgIH07CgkJICAgICAgICB4ZHIub25wcm9ncmVzcyA9IGZ1bmN0aW9uKCkge307CgkJICAgICAgICB4ZHIub3BlbigiZ2V0Iiwgc3RvcnltYXBfdXJsKTsKCQkgICAgICAgIHhkci5zZW5kKCk7CgkJICAgIH0KCQl9CgoJCXdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKCQkgICAgaWYoc3RvcnltYXBfdXJsLm1hdGNoKCdcXC5qcyQnKSkgeyAgICAgICAgCgkJICAgICAgICB0cmFjZSgnZW1iZWQ6IGxvYWRpbmcgZGF0YSB2aWEgc2NyaXB0IGluamVjdGlvbicpOwoJCSAgICAgICAgdmFyIGxvYWRlZCA9IGZhbHNlOyAgCgkJICAgICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CgkJICAgICAgICBzY3JpcHQudHlwZSA9ICJ0ZXh0L2phdmFzY3JpcHQiOwoJCSAgICAgICAgc2NyaXB0LnNyYyAgPSBzdG9yeW1hcF91cmw7ICAgIAoJCSAgICAgICAgc2NyaXB0Lm9ubG9hZCA9IHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKCQkgICAgICAgICAgICBpZighbG9hZGVkICYmICghKGQgPSB0aGlzLnJlYWR5U3RhdGUpIHx8IGQgPT0gImxvYWRlZCIgfHwgZCA9PSAiY29tcGxldGUiKSkgewoJCSAgICAgICAgICAgICAgICBsb2FkZWQgPSB0cnVlOwoJCSAgICAgICAgICAgICAgICBzdG9yeW1hcF9vbmxvYWQoc3RvcnltYXBfanNvbik7CgkJICAgICAgICAgICAgfQoJCSAgICAgICAgfQogICAgCgkJICAgICAgICAvLyBkb2N1bWVudC5oZWFkIG5vdCBzdGFuZGFyZCBiZWZvcmUgSFRNTDUKCQkgICAgICAgIHZhciBpbnNlcnRpb25Qb2ludCA9IGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKS5pdGVtKDApIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdOwoJCSAgICAgICAgaW5zZXJ0aW9uUG9pbnQuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKCQkgICAgfSBlbHNlIHsgICAgCgkJICAgICAgICBzdG9yeW1hcF9nZXRqc29uKCk7IAoJCSAgICB9CgkJfQoKCQl3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbihldmVudCkgewoJCSAgICBpZihzdG9yeW1hcCkgewoJCSAgICAgICAgc3RvcnltYXAudXBkYXRlRGlzcGxheSgpOwoJCSAgICB9CgkJfQoJCTwvc2NyaXB0PgoJPC9ib2R5Pgo8L2h0bWw+",
                "body": "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KCTxoZWFkPgoJCTx0aXRsZT5TdG9yeU1hcEpTIEVtYmVkPC90aXRsZT4KCQk8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CgkJPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IlN0b3J5TWFwSlMgRW1iZWQiPgoJCTxtZXRhIG5hbWU9ImFwcGxlLW1vYmlsZS13ZWItYXBwLWNhcGFibGUiIGNvbnRlbnQ9InllcyI+CgkJPG1ldGEgbmFtZT0iYXBwbGUtdG91Y2gtZnVsbHNjcmVlbiIgY29udGVudD0ieWVzIj4KCQk8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAiPgoJCTwhLS0gYnVpbGQ6Y3NzIC4uL2Nzcy9zdG9yeW1hcC5jc3MgLS0+CgkJPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIvYnVpbGQvY3NzL3N0b3J5bWFwLmNzcyI+CgkJPCEtLSBlbmRidWlsZCAtLT4KCQk8IS0tIGJ1aWxkOmpzIC4uL2pzL3N0b3J5bWFwLW1pbi5qcyAtLT4KCQk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSIvYnVpbGQvanMvc3RvcnltYXAuanMiPjwvc2NyaXB0PgoJCTwhLS0gZW5kYnVpbGQgLS0+CgkJPCEtLSBidWlsZDpqcyAuLi9qcy9qc29uMi5taW4uanMgLS0+CgkJPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iL2J1aWxkL2pzL2pzb24yLm1pbi5qcyI+PC9zY3JpcHQ+CgkJPCEtLSBlbmRidWlsZCAtLT4KCQk8c3R5bGU+CgkJCWh0bWwsIGJvZHkgewoJCQkgICAgd2lkdGg6IDEwMCU7CgkJCSAgICBoZWlnaHQ6IDEwMCU7CgkJCSAgICBwYWRkaW5nOiAwOwoJCQkgICAgbWFyZ2luOiAwOwoJCQl9CgkJCSNzdG9yeW1hcC1lbWJlZCB7CgkJCQkvKmJvcmRlcjogMXB4IHNvbGlkICM5OTk7Ki8KCQkJfQoJCTwvc3R5bGU+CgkJPCEtLSBIVE1MNSBzaGltLCBmb3IgSUU2LTggc3VwcG9ydCBvZiBIVE1MIGVsZW1lbnRzLS0+PCEtLVtpZiBsdCBJRSA5XT4KCQk8c2NyaXB0IHNyYz0iLy9odG1sNXNoaW0uZ29vZ2xlY29kZS5jb20vc3ZuL3RydW5rL2h0bWw1LmpzIj48L3NjcmlwdD48IVtlbmRpZl0tLT4KCTwvaGVhZD4KCTxib2R5PgoJCTxkaXYgaWQ9InN0b3J5bWFwLWVtYmVkIj48L2Rpdj4KCgkJPCEtLSBHb29nbGUgQW5hbHl0aWNzOiBkb24ndCBtZXNzIHdpdGggdGhpcyBzdHVmZiAtLT4KCQk8IS0tIG5hbWVkIHRyYWNrZXIgbm90ZXMgZnJvbSBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9hbmFseXRpY3MvZGV2Z3VpZGVzL2NvbGxlY3Rpb24vZ2Fqcy8gLS0+CgkJPCEtLSBtdWx0aS1kb21haW4gdHJhY2tpbmcgbm90ZXMgZnJvbSBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9hbmFseXRpY3MvZGV2Z3VpZGVzL2NvbGxlY3Rpb24vZ2Fqcy9nYVRyYWNraW5nU2l0ZSAtLT4KCQk8c2NyaXB0PgoJCSAgKGZ1bmN0aW9uKGkscyxvLGcscixhLG0pe2lbJ0dvb2dsZUFuYWx5dGljc09iamVjdCddPXI7aVtyXT1pW3JdfHxmdW5jdGlvbigpewoJCSAgKGlbcl0ucT1pW3JdLnF8fFtdKS5wdXNoKGFyZ3VtZW50cyl9LGlbcl0ubD0xKm5ldyBEYXRlKCk7YT1zLmNyZWF0ZUVsZW1lbnQobyksCgkJICBtPXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobylbMF07YS5hc3luYz0xO2Euc3JjPWc7bS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShhLG0pCgkJICB9KSh3aW5kb3csZG9jdW1lbnQsJ3NjcmlwdCcsJy8vd3d3Lmdvb2dsZS1hbmFseXRpY3MuY29tL2FuYWx5dGljcy5qcycsJ2dhJyk7CgoJCSAgZ2EoJ2NyZWF0ZScsICdVQS0yNzgyOTgwMi0yJywgJ2tuaWdodGxhYi5jb20nKTsgLyogU3RvcnlNYXAgRW1iZWQgYW5hbHl0aWNzIG9ubHkuIE5vdCBLbmlnaHRMYWIgYnJvYWRseSAqLwoJCSAgZ2EoJ3NlbmQnLCAncGFnZXZpZXcnKTsKCQkgIGdhKCdzZW5kJywgJ2V2ZW50JywgJ1N0b3J5TWFwSlMnLCAnRW1iZWRkZWRJbicsIGRvY3VtZW50LnJlZmVycmVyKQoKCQk8L3NjcmlwdD4KCQk8IS0tIEVuZCBHb29nbGUgQW5hbHl0aWNzIC0tPgoKCQk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CgoJCWZ1bmN0aW9uIHBhcnNlUXVlcnlzdHJpbmcoKSB7CgkJICAgIHZhciBudnBhaXIgPSB7fTsKCQkgICAgdmFyIHFzID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5yZXBsYWNlKCc/JywgJycpOwoJCSAgICB2YXIgcGFpcnMgPSBxcy5zcGxpdCgnJicpOwogICAgCgkJICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwYWlycy5sZW5ndGg7IGkrKykgewoJCSAgICAgICAgdmFyIHAgPSBwYWlyc1tpXS5zcGxpdCgnPScpOwoJCSAgICAgICAgbnZwYWlyW3BbMF1dID0gcFsxXTsKCQkgICAgfQoJCSAgICByZXR1cm4gbnZwYWlyOwoJCX0KCgkJZnVuY3Rpb24gZ2V0U2NyaXB0UGF0aChzY3JpcHRuYW1lKSB7CgkJICAgIHZhciBzY3JpcHRUYWdzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpOwogICAgCgkJCWZvcih2YXIgaSA9IDA7IGkgPCBzY3JpcHRUYWdzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICBpZihzY3JpcHRUYWdzW2ldLnNyYy5tYXRjaChzY3JpcHRuYW1lKSkgewoJCSAgICAgICAgICAgIHNjcmlwdF9wYXRoID0gc2NyaXB0VGFnc1tpXS5zcmM7ICAgICAgICAgICAgCgkJICAgICAgICAgICAgcmV0dXJuIHNjcmlwdF9wYXRoLnNwbGl0KCc/JylbMF0uc3BsaXQoJy8nKS5zbGljZSgwLCAtMSkuam9pbignLycpOwoJCSAgICAgICAgfQoJCQl9CgkJCXJldHVybiAnJzsKCQl9CgoJCWZ1bmN0aW9uIHVybF9qb2luKHVybCwgY29uY2F0KSB7IC8vIHNlZSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI2NzYxNzgvam9pbmluZy1yZWxhdGl2ZS11cmxzCgkJICAgIGZ1bmN0aW9uIGJ1aWxkKHBhcnRzLGNvbnRhaW5lcikgewoJCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpICsrKSB7CgkJICAgICAgICAgICAgaWYgKHBhcnRzW2ldID09ICcuLicpIHsKCQkgICAgICAgICAgICAgICAgY29udGFpbmVyLnBvcCgpOwoJCSAgICAgICAgICAgIH0gZWxzZSBpZiAocGFydHNbaV0gPT0gJy4nKSB7CgkJICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoJCSAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgIGNvbnRhaW5lci5wdXNoKHBhcnRzW2ldKTsKCQkgICAgICAgICAgICB9CgkJICAgICAgICB9CgkJICAgIH0KCQkgICAgdmFyIHVybF9wYXJ0cyA9IFsgXTsKCQkgICAgYnVpbGQodXJsLnNwbGl0KCcvJyksdXJsX3BhcnRzKTsKCQkgICAgYnVpbGQoY29uY2F0LnNwbGl0KCcvJyksdXJsX3BhcnRzKTsKCQkgICAgcmV0dXJuIHVybF9wYXJ0cy5qb2luKCcvJyk7CgkJfQoKCgkJdmFyIHN0b3J5bWFwID0gbnVsbDsKCgkJdmFyIHBhcmFtcyA9IHBhcnNlUXVlcnlzdHJpbmcoKTsKCQl2YXIgc3RvcnltYXBfdXJsID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhcmFtc1sndXJsJ10pOwoKCQkvLyBwcm94eQoJCXRyYWNlKG5hdmlnYXRvci51c2VyQWdlbnQpOwoKCQlpZighIW5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FwcGxlV2ViS2l0XC8uKiBNb2JpbGVcLy8pCgkJfHwgISFuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9WZXJzaW9uXC9bXGRcLl0rLipTYWZhcmkvKQoJCXx8ICEhbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9tc2llIFs3ODldLykpIHsgICAgCgkJICAgIGlmKHN0b3J5bWFwX3VybC5tYXRjaCgvXmh0dHBzPzpcL1wvd3d3XC5nb29nbGVkcml2ZVwuY29tXC9ob3N0XC8vKSkgewoJCSAgICAgICAgc3RvcnltYXBfdXJsID0gbG9jYXRpb24ucHJvdG9jb2wrJy8vcHJveHkua25pZ2h0bGFiLmNvbS8nK3N0b3J5bWFwX3VybC5zcGxpdCgnOi8vJylbMV07CgkJICAgICAgICB0cmFjZSgncHJveHksICcrc3RvcnltYXBfdXJsKTsKCQkgICAgfQoJCX0KCgkJdmFyIG9wdGlvbnMgPSB7CgkJICAgIHNjcmlwdF9wYXRoOiBnZXRTY3JpcHRQYXRoKC9zdG9yeW1hcCgtbWluKT9cLmpzLyksCgkJICAgIHN0YXJ0X2F0X3NsaWRlOiAwLAoJCSAgICBzaG93X2xpbmVzOiB0cnVlCgkJfTsKCgkJaWYocGFyYW1zLmhhc093blByb3BlcnR5KCdzdGFydF9hdF9zbGlkZScpKSB7CgkJICAgIG9wdGlvbnMuc3RhcnRfYXRfc2xpZGUgPSBwYXJzZUludChwYXJhbXMuc3RhcnRfYXRfc2xpZGUpOwoJCX0KCgkJZnVuY3Rpb24gc3RvcnltYXBfb25sb2FkKGQpIHsKCQkgICAgdHJhY2UoJ2VtYmVkOiBzdG9yeW1hcCBkYXRhIGxvYWRlZCcpOwoKCQkgICAgaWYgKGQgJiYgZC5zdG9yeW1hcCkgewogICAgICAgICAgICAgICAgUFJPUEVSVElFU19UT19DT1BZID0gWydtYXBfdHlwZScsICdtYXBfc3ViZG9tYWlucycsICdtYXBfYXNfaW1hZ2UnLCAndXNlX2N1c3RvbV9tYXJrZXJzJywgJ21hcF9iYWNrZ3JvdW5kX2NvbG9yJywgJ2xhbmd1YWdlJywgJ3pvb21pZnknLCAncmVsYXRpdmVfZGF0ZSddCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IFBST1BFUlRJRVNfVE9fQ09QWS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChkLnN0b3J5bWFwW1BST1BFUlRJRVNfVE9fQ09QWVtpXV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1tQUk9QRVJUSUVTX1RPX0NPUFlbaV1dID0gZC5zdG9yeW1hcFtQUk9QRVJUSUVTX1RPX0NPUFlbaV1dOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCQkgICAgICAgIGlmKGQuc3RvcnltYXAuaGFzT3duUHJvcGVydHkoJ3Nob3dfbGluZXMnKSkgewoJCSAgICAgICAgICAgIG9wdGlvbnMuc2hvd19saW5lcyA9IGQuc3RvcnltYXAuc2hvd19saW5lczsKCQkgICAgICAgIH0KCgkJICAgICAgICB2YXIgZm9udCA9ICJzdG9jazpkZWZhdWx0IjsKCQkgICAgICAgIGlmKGQuZm9udF9jc3MpIHsKCQkgICAgICAgICAgICBmb250ID0gZC5mb250X2NzczsKCQkgICAgICAgIH0KCQkgICAgICAgIGlmKGZvbnQuaW5kZXhPZigic3RvY2s6IikgPT0gMCkgewoJCSAgICAgICAgICAgIHZhciBmb250X25hbWUgPSBmb250LnNwbGl0KCc6JylbMV07CgkJICAgICAgICAgICAgdmFyIGJhc2VfdXJsID0gdXJsX2pvaW4ob3B0aW9ucy5zY3JpcHRfcGF0aCwiLi4vY3NzL2ZvbnRzIik7CgkJICAgICAgICAgICAgZm9udCA9IHVybF9qb2luKGJhc2VfdXJsLCAiZm9udC4iICsgZm9udF9uYW1lICsgIi5jc3MiKTsKCQkgICAgICAgIH0gZWxzZSBpZighZm9udC5tYXRjaCgnXihodHRwfGh0dHBzfC8vKScpKSB7CgkJICAgICAgICAgICAgZm9udCA9IHVybF9qb2luKG9wdGlvbnMuc2NyaXB0X3BhdGgsIGZvbnQpOwoJCSAgICAgICAgfQoJCSAgICAgICAgVkNPLkxvYWQuY3NzKGZvbnQsZnVuY3Rpb24oKXsgdHJhY2UoJ2ZvbnQgbG9hZGVkOiAnICsgZm9udCk7fSk7CgkJICAgICAgICBzdG9yeW1hcCA9IG5ldyBWQ08uU3RvcnlNYXAoJ3N0b3J5bWFwLWVtYmVkJywgZCwgb3B0aW9ucywge3RpdGxlOiBvbl9zdG9yeW1hcF90aXRsZX0pOwoJCSAgICB9CgkJfQoJCQoJCWZ1bmN0aW9uIG9uX3N0b3J5bWFwX3RpdGxlKGUpIHsKCQkJZG9jdW1lbnQudGl0bGUgPSAiU3RvcnlNYXBKUzogIiArIGUudGl0bGU7CgkJfTsKCQkKCQlmdW5jdGlvbiBzdG9yeW1hcF9nZXRqc29uKCkgewoJCSAgICBpZignd2l0aENyZWRlbnRpYWxzJyBpbiBuZXcgWE1MSHR0cFJlcXVlc3QoKSkgewoJCSAgICAgICAgLy8gU3VwcG9ydHMgY3Jvc3MtZG9tYWluIHJlcXVlc3RzCgkJICAgICAgICB0cmFjZSgnZW1iZWQ6IGxvYWRpbmcgZGF0YSB2aWEgWE1MSHR0cFJlcXVlc3QnKTsKCQkgICAgICAgIFZDTy5nZXRKU09OKHN0b3J5bWFwX3VybCwgc3RvcnltYXBfb25sb2FkKTsKCQkgICAgfSBlbHNlIGlmKHR5cGVvZiBYRG9tYWluUmVxdWVzdCAhPT0gInVuZGVmaW5lZCIpIHsKCQkgICAgICAgIC8vIFVzZSBJRS1zcGVjaWZpYyAiQ09SUyIgY29kZSB3aXRoIFhEUgoJCSAgICAgICAgdHJhY2UoJ2VtYmVkOiBsb2FkaW5nIGRhdGEgdmlhIFhEb21haW5SZXF1ZXN0Jyk7CgkJICAgICAgICB2YXIgeGRyID0gbmV3IFhEb21haW5SZXF1ZXN0KCk7CgkJICAgICAgICB4ZHIub25sb2FkID0gZnVuY3Rpb24oKSB7CgkJICAgICAgICAgICAgc3RvcnltYXBfb25sb2FkKEpTT04ucGFyc2UoeGRyLnJlc3BvbnNlVGV4dCkpOwoJCSAgICAgICAgfTsKCQkgICAgICAgIHhkci5vbmVycm9yID0gZnVuY3Rpb24oKSB7IAoJCSAgICAgICAgICAgIHRyYWNlKCdlbWJlZDogZXJyb3IgbG9hZGluZyBkYXRhIHZpYSBYRG9tYWluUmVxdWVzdCcpOyAKCQkgICAgICAgIH07CgkJICAgICAgICB4ZHIub25wcm9ncmVzcyA9IGZ1bmN0aW9uKCkge307CgkJICAgICAgICB4ZHIub3BlbigiZ2V0Iiwgc3RvcnltYXBfdXJsKTsKCQkgICAgICAgIHhkci5zZW5kKCk7CgkJICAgIH0KCQl9CgoJCXdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKCQkgICAgaWYoc3RvcnltYXBfdXJsLm1hdGNoKCdcXC5qcyQnKSkgeyAgICAgICAgCgkJICAgICAgICB0cmFjZSgnZW1iZWQ6IGxvYWRpbmcgZGF0YSB2aWEgc2NyaXB0IGluamVjdGlvbicpOwoJCSAgICAgICAgdmFyIGxvYWRlZCA9IGZhbHNlOyAgCgkJICAgICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CgkJICAgICAgICBzY3JpcHQudHlwZSA9ICJ0ZXh0L2phdmFzY3JpcHQiOwoJCSAgICAgICAgc2NyaXB0LnNyYyAgPSBzdG9yeW1hcF91cmw7ICAgIAoJCSAgICAgICAgc2NyaXB0Lm9ubG9hZCA9IHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKCQkgICAgICAgICAgICBpZighbG9hZGVkICYmICghKGQgPSB0aGlzLnJlYWR5U3RhdGUpIHx8IGQgPT0gImxvYWRlZCIgfHwgZCA9PSAiY29tcGxldGUiKSkgewoJCSAgICAgICAgICAgICAgICBsb2FkZWQgPSB0cnVlOwoJCSAgICAgICAgICAgICAgICBzdG9yeW1hcF9vbmxvYWQoc3RvcnltYXBfanNvbik7CgkJICAgICAgICAgICAgfQoJCSAgICAgICAgfQogICAgCgkJICAgICAgICAvLyBkb2N1bWVudC5oZWFkIG5vdCBzdGFuZGFyZCBiZWZvcmUgSFRNTDUKCQkgICAgICAgIHZhciBpbnNlcnRpb25Qb2ludCA9IGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKS5pdGVtKDApIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdOwoJCSAgICAgICAgaW5zZXJ0aW9uUG9pbnQuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKCQkgICAgfSBlbHNlIHsgICAgCgkJICAgICAgICBzdG9yeW1hcF9nZXRqc29uKCk7IAoJCSAgICB9CgkJfQoKCQl3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbihldmVudCkgewoJCSAgICBpZihzdG9yeW1hcCkgewoJCSAgICAgICAgc3RvcnltYXAudXBkYXRlRGlzcGxheSgpOwoJCSAgICB9CgkJfQoJCTwvc2NyaXB0PgoJPC9ib2R5Pgo8L2h0bWw+",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 21:56:11 GMT",
                    "Content-Length": "7392",
                    "Date": "Thu, 06 Nov 2014 21:56:22 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}