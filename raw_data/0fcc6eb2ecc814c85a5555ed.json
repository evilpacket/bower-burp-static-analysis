{
    "url": "http://localhost:9999/Operational-Transformation/ot.js/test/phantomjs/codemirror/demo/theme.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>document.location.search</b> and written to <b>the 'value' property of a DOM element</b> via the following statements:<ul><li>var choice = document.location.search &amp;&amp;                decodeURIComponent(document.location.search.slice(1));</li><li>input.value = choice;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/Operational-Transformation/ot.js/test/phantomjs/codemirror/demo/theme.html",
                "path": "/Operational-Transformation/ot.js/test/phantomjs/codemirror/demo/theme.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9PcGVyYXRpb25hbC1UcmFuc2Zvcm1hdGlvbi9vdC5qcy90ZXN0L3BoYW50b21qcy9jb2RlbWlycm9yL2RlbW8vdGhlbWUuaHRtbCBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNDM2Ng0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBGcmksIDA3IE5vdiAyMDE0IDIxOjMxOjA4IEdNVA0KTGFzdC1Nb2RpZmllZDogRnJpLCAwNyBOb3YgMjAxNCAyMTozMTowOCBHTVQNCg0KPCFkb2N0eXBlIGh0bWw+Cgo8dGl0bGU+Q29kZU1pcnJvcjogVGhlbWUgRGVtbzwvdGl0bGU+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+CjxsaW5rIHJlbD1zdHlsZXNoZWV0IGhyZWY9Ii4uL2RvYy9kb2NzLmNzcyI+Cgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2xpYi9jb2RlbWlycm9yLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvMzAyNC1kYXkuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS8zMDI0LW5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvYW1iaWFuY2UuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9iYXNlMTYtZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2Jhc2UxNi1saWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2JsYWNrYm9hcmQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9jb2JhbHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9lY2xpcHNlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvZWxlZ2FudC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2VybGFuZy1kYXJrLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbGVzc2VyLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tYm8uY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tZG4tbGlrZS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL21pZG5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbW9ub2thaS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL25lYXQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9uaWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9wYXN0ZWwtb24tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3J1YnlibHVlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvc29sYXJpemVkLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdGhlLW1hdHJpeC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3RvbW9ycm93LW5pZ2h0LWVpZ2h0aWVzLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdHdpbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS92aWJyYW50LWluay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3hxLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS94cS1saWdodC5jc3MiPgo8c2NyaXB0IHNyYz0iLi4vbGliL2NvZGVtaXJyb3IuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vbW9kZS9qYXZhc2NyaXB0L2phdmFzY3JpcHQuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4va2V5bWFwL2V4dHJhLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Ii4uL2FkZG9uL3NlbGVjdGlvbi9hY3RpdmUtbGluZS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSIuLi9hZGRvbi9lZGl0L21hdGNoYnJhY2tldHMuanMiPjwvc2NyaXB0Pgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgICAuQ29kZU1pcnJvciB7Ym9yZGVyOiAxcHggc29saWQgYmxhY2s7IGZvbnQtc2l6ZToxM3B4fQogICAgPC9zdHlsZT4KPGRpdiBpZD1uYXY+CiAgPGEgaHJlZj0iaHR0cDovL2NvZGVtaXJyb3IubmV0Ij48aW1nIGlkPWxvZ28gc3JjPSIuLi9kb2MvbG9nby5wbmciPjwvYT4KCiAgPHVsPgogICAgPGxpPjxhIGhyZWY9Ii4uL2luZGV4Lmh0bWwiPkhvbWU8L2E+CiAgICA8bGk+PGEgaHJlZj0iLi4vZG9jL21hbnVhbC5odG1sIj5NYW51YWw8L2E+CiAgICA8bGk+PGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL21hcmlqbmgvY29kZW1pcnJvciI+Q29kZTwvYT4KICA8L3VsPgogIDx1bD4KICAgIDxsaT48YSBjbGFzcz1hY3RpdmUgaHJlZj0iIyI+VGhlbWU8L2E+CiAgPC91bD4KPC9kaXY+Cgo8YXJ0aWNsZT4KPGgyPlRoZW1lIERlbW88L2gyPgo8Zm9ybT48dGV4dGFyZWEgaWQ9ImNvZGUiIG5hbWU9ImNvZGUiPgpmdW5jdGlvbiBmaW5kU2VxdWVuY2UoZ29hbCkgewogIGZ1bmN0aW9uIGZpbmQoc3RhcnQsIGhpc3RvcnkpIHsKICAgIGlmIChzdGFydCA9PSBnb2FsKQogICAgICByZXR1cm4gaGlzdG9yeTsKICAgIGVsc2UgaWYgKHN0YXJ0ID4gZ29hbCkKICAgICAgcmV0dXJuIG51bGw7CiAgICBlbHNlCiAgICAgIHJldHVybiBmaW5kKHN0YXJ0ICsgNSwgIigiICsgaGlzdG9yeSArICIgKyA1KSIpIHx8CiAgICAgICAgICAgICBmaW5kKHN0YXJ0ICogMywgIigiICsgaGlzdG9yeSArICIgKiAzKSIpOwogIH0KICByZXR1cm4gZmluZCgxLCAiMSIpOwp9PC90ZXh0YXJlYT48L2Zvcm0+Cgo8cD5TZWxlY3QgYSB0aGVtZTogPHNlbGVjdCBvbmNoYW5nZT0ic2VsZWN0VGhlbWUoKSIgaWQ9c2VsZWN0PgogICAgPG9wdGlvbiBzZWxlY3RlZD5kZWZhdWx0PC9vcHRpb24+CiAgICA8b3B0aW9uPjMwMjQtZGF5PC9vcHRpb24+CiAgICA8b3B0aW9uPjMwMjQtbmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+YW1iaWFuY2U8L29wdGlvbj4KICAgIDxvcHRpb24+YmFzZTE2LWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+YmFzZTE2LWxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPmJsYWNrYm9hcmQ8L29wdGlvbj4KICAgIDxvcHRpb24+Y29iYWx0PC9vcHRpb24+CiAgICA8b3B0aW9uPmVjbGlwc2U8L29wdGlvbj4KICAgIDxvcHRpb24+ZWxlZ2FudDwvb3B0aW9uPgogICAgPG9wdGlvbj5lcmxhbmctZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5sZXNzZXItZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5tYm88L29wdGlvbj4KICAgIDxvcHRpb24+bWRuLWxpa2U8L29wdGlvbj4KICAgIDxvcHRpb24+bWlkbmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+bW9ub2thaTwvb3B0aW9uPgogICAgPG9wdGlvbj5uZWF0PC9vcHRpb24+CiAgICA8b3B0aW9uPm5pZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPnBhcmFpc28tZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5wYXJhaXNvLWxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPnBhc3RlbC1vbi1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPnJ1YnlibHVlPC9vcHRpb24+CiAgICA8b3B0aW9uPnNvbGFyaXplZCBkYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPnNvbGFyaXplZCBsaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj50aGUtbWF0cml4PC9vcHRpb24+CiAgICA8b3B0aW9uPnRvbW9ycm93LW5pZ2h0LWVpZ2h0aWVzPC9vcHRpb24+CiAgICA8b3B0aW9uPnR3aWxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPnZpYnJhbnQtaW5rPC9vcHRpb24+CiAgICA8b3B0aW9uPnhxLWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+eHEtbGlnaHQ8L29wdGlvbj4KPC9zZWxlY3Q+CjwvcD4KCjxzY3JpcHQ+CiAgdmFyIGVkaXRvciA9IENvZGVNaXJyb3IuZnJvbVRleHRBcmVhKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb2RlIiksIHsKICAgIGxpbmVOdW1iZXJzOiB0cnVlLAogICAgc3R5bGVBY3RpdmVMaW5lOiB0cnVlLAogICAgbWF0Y2hCcmFja2V0czogdHJ1ZQogIH0pOwogIHZhciBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZWxlY3QiKTsKICBmdW5jdGlvbiBzZWxlY3RUaGVtZSgpIHsKICAgIHZhciB0aGVtZSA9IGlucHV0Lm9wdGlvbnNbaW5wdXQuc2VsZWN0ZWRJbmRleF0uaW5uZXJIVE1MOwogICAgZWRpdG9yLnNldE9wdGlvbigidGhlbWUiLCB0aGVtZSk7CiAgfQogIHZhciBjaG9pY2UgPSBkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2ggJiYKICAgICAgICAgICAgICAgZGVjb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKSk7CiAgaWYgKGNob2ljZSkgewogICAgaW5wdXQudmFsdWUgPSBjaG9pY2U7CiAgICBlZGl0b3Iuc2V0T3B0aW9uKCJ0aGVtZSIsIGNob2ljZSk7CiAgfQo8L3NjcmlwdD4KICA8L2FydGljbGU+Cg==",
                "body": "PCFkb2N0eXBlIGh0bWw+Cgo8dGl0bGU+Q29kZU1pcnJvcjogVGhlbWUgRGVtbzwvdGl0bGU+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+CjxsaW5rIHJlbD1zdHlsZXNoZWV0IGhyZWY9Ii4uL2RvYy9kb2NzLmNzcyI+Cgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2xpYi9jb2RlbWlycm9yLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvMzAyNC1kYXkuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS8zMDI0LW5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvYW1iaWFuY2UuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9iYXNlMTYtZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2Jhc2UxNi1saWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2JsYWNrYm9hcmQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9jb2JhbHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9lY2xpcHNlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvZWxlZ2FudC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2VybGFuZy1kYXJrLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbGVzc2VyLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tYm8uY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tZG4tbGlrZS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL21pZG5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbW9ub2thaS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL25lYXQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9uaWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9wYXN0ZWwtb24tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3J1YnlibHVlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvc29sYXJpemVkLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdGhlLW1hdHJpeC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3RvbW9ycm93LW5pZ2h0LWVpZ2h0aWVzLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdHdpbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS92aWJyYW50LWluay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3hxLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS94cS1saWdodC5jc3MiPgo8c2NyaXB0IHNyYz0iLi4vbGliL2NvZGVtaXJyb3IuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vbW9kZS9qYXZhc2NyaXB0L2phdmFzY3JpcHQuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4va2V5bWFwL2V4dHJhLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Ii4uL2FkZG9uL3NlbGVjdGlvbi9hY3RpdmUtbGluZS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSIuLi9hZGRvbi9lZGl0L21hdGNoYnJhY2tldHMuanMiPjwvc2NyaXB0Pgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgICAuQ29kZU1pcnJvciB7Ym9yZGVyOiAxcHggc29saWQgYmxhY2s7IGZvbnQtc2l6ZToxM3B4fQogICAgPC9zdHlsZT4KPGRpdiBpZD1uYXY+CiAgPGEgaHJlZj0iaHR0cDovL2NvZGVtaXJyb3IubmV0Ij48aW1nIGlkPWxvZ28gc3JjPSIuLi9kb2MvbG9nby5wbmciPjwvYT4KCiAgPHVsPgogICAgPGxpPjxhIGhyZWY9Ii4uL2luZGV4Lmh0bWwiPkhvbWU8L2E+CiAgICA8bGk+PGEgaHJlZj0iLi4vZG9jL21hbnVhbC5odG1sIj5NYW51YWw8L2E+CiAgICA8bGk+PGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL21hcmlqbmgvY29kZW1pcnJvciI+Q29kZTwvYT4KICA8L3VsPgogIDx1bD4KICAgIDxsaT48YSBjbGFzcz1hY3RpdmUgaHJlZj0iIyI+VGhlbWU8L2E+CiAgPC91bD4KPC9kaXY+Cgo8YXJ0aWNsZT4KPGgyPlRoZW1lIERlbW88L2gyPgo8Zm9ybT48dGV4dGFyZWEgaWQ9ImNvZGUiIG5hbWU9ImNvZGUiPgpmdW5jdGlvbiBmaW5kU2VxdWVuY2UoZ29hbCkgewogIGZ1bmN0aW9uIGZpbmQoc3RhcnQsIGhpc3RvcnkpIHsKICAgIGlmIChzdGFydCA9PSBnb2FsKQogICAgICByZXR1cm4gaGlzdG9yeTsKICAgIGVsc2UgaWYgKHN0YXJ0ID4gZ29hbCkKICAgICAgcmV0dXJuIG51bGw7CiAgICBlbHNlCiAgICAgIHJldHVybiBmaW5kKHN0YXJ0ICsgNSwgIigiICsgaGlzdG9yeSArICIgKyA1KSIpIHx8CiAgICAgICAgICAgICBmaW5kKHN0YXJ0ICogMywgIigiICsgaGlzdG9yeSArICIgKiAzKSIpOwogIH0KICByZXR1cm4gZmluZCgxLCAiMSIpOwp9PC90ZXh0YXJlYT48L2Zvcm0+Cgo8cD5TZWxlY3QgYSB0aGVtZTogPHNlbGVjdCBvbmNoYW5nZT0ic2VsZWN0VGhlbWUoKSIgaWQ9c2VsZWN0PgogICAgPG9wdGlvbiBzZWxlY3RlZD5kZWZhdWx0PC9vcHRpb24+CiAgICA8b3B0aW9uPjMwMjQtZGF5PC9vcHRpb24+CiAgICA8b3B0aW9uPjMwMjQtbmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+YW1iaWFuY2U8L29wdGlvbj4KICAgIDxvcHRpb24+YmFzZTE2LWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+YmFzZTE2LWxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPmJsYWNrYm9hcmQ8L29wdGlvbj4KICAgIDxvcHRpb24+Y29iYWx0PC9vcHRpb24+CiAgICA8b3B0aW9uPmVjbGlwc2U8L29wdGlvbj4KICAgIDxvcHRpb24+ZWxlZ2FudDwvb3B0aW9uPgogICAgPG9wdGlvbj5lcmxhbmctZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5sZXNzZXItZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5tYm88L29wdGlvbj4KICAgIDxvcHRpb24+bWRuLWxpa2U8L29wdGlvbj4KICAgIDxvcHRpb24+bWlkbmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+bW9ub2thaTwvb3B0aW9uPgogICAgPG9wdGlvbj5uZWF0PC9vcHRpb24+CiAgICA8b3B0aW9uPm5pZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPnBhcmFpc28tZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5wYXJhaXNvLWxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPnBhc3RlbC1vbi1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPnJ1YnlibHVlPC9vcHRpb24+CiAgICA8b3B0aW9uPnNvbGFyaXplZCBkYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPnNvbGFyaXplZCBsaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj50aGUtbWF0cml4PC9vcHRpb24+CiAgICA8b3B0aW9uPnRvbW9ycm93LW5pZ2h0LWVpZ2h0aWVzPC9vcHRpb24+CiAgICA8b3B0aW9uPnR3aWxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPnZpYnJhbnQtaW5rPC9vcHRpb24+CiAgICA8b3B0aW9uPnhxLWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+eHEtbGlnaHQ8L29wdGlvbj4KPC9zZWxlY3Q+CjwvcD4KCjxzY3JpcHQ+CiAgdmFyIGVkaXRvciA9IENvZGVNaXJyb3IuZnJvbVRleHRBcmVhKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb2RlIiksIHsKICAgIGxpbmVOdW1iZXJzOiB0cnVlLAogICAgc3R5bGVBY3RpdmVMaW5lOiB0cnVlLAogICAgbWF0Y2hCcmFja2V0czogdHJ1ZQogIH0pOwogIHZhciBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZWxlY3QiKTsKICBmdW5jdGlvbiBzZWxlY3RUaGVtZSgpIHsKICAgIHZhciB0aGVtZSA9IGlucHV0Lm9wdGlvbnNbaW5wdXQuc2VsZWN0ZWRJbmRleF0uaW5uZXJIVE1MOwogICAgZWRpdG9yLnNldE9wdGlvbigidGhlbWUiLCB0aGVtZSk7CiAgfQogIHZhciBjaG9pY2UgPSBkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2ggJiYKICAgICAgICAgICAgICAgZGVjb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKSk7CiAgaWYgKGNob2ljZSkgewogICAgaW5wdXQudmFsdWUgPSBjaG9pY2U7CiAgICBlZGl0b3Iuc2V0T3B0aW9uKCJ0aGVtZSIsIGNob2ljZSk7CiAgfQo8L3NjcmlwdD4KICA8L2FydGljbGU+Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 21:31:08 GMT",
                    "Content-Length": "4366",
                    "Date": "Fri, 07 Nov 2014 21:31:08 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}