{
    "url": "http://localhost:9999/avoidwork/keigai/lib/keigai.min.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>location.href</b> and written to <b>the 'href' property of a DOM element</b> via the following statements:<ul><li>uri=!server?location.href:\"\";</li><li>obj.href=uri</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/avoidwork/keigai/lib/keigai.min.js",
                "path": "/avoidwork/keigai/lib/keigai.min.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9hdm9pZHdvcmsva2VpZ2FpL2xpYi9rZWlnYWkubWluLmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogOTg2MjUNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkRhdGU6IEZyaSwgMDcgTm92IDIwMTQgMDc6NTk6MTkgR01UDQpMYXN0LU1vZGlmaWVkOiBGcmksIDA3IE5vdiAyMDE0IDA3OjU5OjE4IEdNVA0KDQovKgogMjAxNCBKYXNvbiBNdWxsaWdhbgogQGxpY2Vuc2UgQlNELTMgPGh0dHBzOi8vcmF3LmdpdGh1Yi5jb20vYXZvaWR3b3JrL2tlaWdhaS9tYXN0ZXIvTElDRU5TRT4KIEBsaW5rIGh0dHA6Ly9rZWlnYWkuaW8KIEBtb2R1bGUga2VpZ2FpCiBAdmVyc2lvbiAwLjkuMAoqLwooZnVuY3Rpb24oZ2xvYmFsKXt2YXIgZG9jdW1lbnQ9Z2xvYmFsLmRvY3VtZW50LGxvY2F0aW9uPWdsb2JhbC5sb2NhdGlvbixuYXZpZ2F0b3I9Z2xvYmFsLm5hdmlnYXRvcixzZXJ2ZXI9dHlwZW9mIHByb2Nlc3MhPSJ1bmRlZmluZWQiLHdlYldvcmtlcj10eXBlb2YgQmxvYiE9InVuZGVmaW5lZCImJnR5cGVvZiBXb3JrZXIhPSJ1bmRlZmluZWQiLE1BWD0xMCxWRVJTSU9OUz0xMDAsQ0FDSEU9NTAwLEVWRU5UUz1bInJlYWR5c3RhdGVjaGFuZ2UiLCJhYm9ydCIsImxvYWQiLCJsb2Fkc3RhcnQiLCJsb2FkZW5kIiwiZXJyb3IiLCJwcm9ncmVzcyIsInRpbWVvdXQiXSxmb3JtYXQsaHR0cCxodHRwcyxsaWIsbW9uZ29kYix1cmwsUkVOREVSLFRJTUUsV09SS0VSO2lmKHNlcnZlcil7dXJsPXJlcXVpcmUoInVybCIpO2h0dHA9cmVxdWlyZSgiaHR0cCIpO2h0dHBzPXJlcXVpcmUoImh0dHBzIik7bW9uZ29kYj1yZXF1aXJlKCJtb25nb2RiIikuTW9uZ29DbGllbnQ7Zm9ybWF0PXJlcXVpcmUoInV0aWwiKS5mb3JtYXQ7CmlmKHR5cGVvZiBQcm9taXNlPT0idW5kZWZpbmVkIilQcm9taXNlPXJlcXVpcmUoImVzNi1wcm9taXNlIikuUHJvbWlzZTtpZih0eXBlb2YgU3RvcmFnZT09InVuZGVmaW5lZCIpbG9jYWxTdG9yYWdlPXJlcXVpcmUoImxvY2FsU3RvcmFnZSIpO2lmKHR5cGVvZiBYTUxIdHRwUmVxdWVzdD09InVuZGVmaW5lZCIpWE1MSHR0cFJlcXVlc3Q9bnVsbDtpZih0eXBlb2YgYnRvYT09InVuZGVmaW5lZCIpYnRvYT1yZXF1aXJlKCJidG9hIil9ZWxzZSBpZih0eXBlb2YgQnVmZmVyPT0idW5kZWZpbmVkIilCdWZmZXI9ZnVuY3Rpb24oKXt9O2xpYj1mdW5jdGlvbigpe3ZhciBleHRlcm5hbCxoYXMsc2xpY2U7dmFyIHJlZ2V4PXthZnRlcl9zcGFjZTovXHMrLiovLGFsbG93Oi9eYWxsb3ckL2ksYWxsb3dfY29yczovXmFjY2Vzcy1jb250cm9sLWFsbG93LW1ldGhvZHMkL2ksYW5kOi9eJi8sYXJnczovXCgoLiopXCkvLGF1dGg6L1wvXC8oLiopXEAvLGJvb2w6L14odHJ1ZXxmYWxzZSk/JC8sY2FwczovW0EtWl0vLApjZGF0YTovXCZ8PHw+fFwifFwnfFx0fFxyfFxufFxAfFwkLyxjaGVja2VkX2Rpc2FibGVkOi9jaGVja2VkfGRpc2FibGVkL2ksY29tcGxldGVfbG9hZGVkOi9eKGNvbXBsZXRlfGxvYWRlZCkkL2ksY3N2X3F1b3RlOi9eXHN8XCJ8XG58LHxccyQvLGRlbDovXmRlbC8sZG9tYWluOi9eW1x3Li1fXStcLltBLVphLXpdezIsfSQvLGRvd246L2Rvd24vLGVuZHNsYXNoOi9cLyQvLGVvbF9ubDovXG4kLyxlbGVtZW50X3VwZGF0ZTovaWR8aW5uZXJIVE1MfGlubmVyVGV4dHx0ZXh0Q29udGVudHx0eXBlfHNyYy8sZ2V0X2hlYWRlcnM6L14oaGVhZHxnZXR8b3B0aW9ucykkLyxnZXRfcmVtb3ZlX3NldDovZ2V0fHJlbW92ZXxzZXQvLGhhc2g6L15cIy8saGVhZGVyX3JlcGxhY2U6LzouKi8saGVhZGVyX3ZhbHVlX3JlcGxhY2U6Ly4qOlxzKy8saHRtbDovXjwuKj4kLyxodHRwX2JvZHk6LzIwMHwyMDF8MjAyfDIwM3wyMDYvLGh0dHBfcG9ydHM6LzgwfDQ0My8saWU6L21zaWV8aWUvaSxpcDovXig/Oig/OjI1WzAtNV18MlswLTRdWzAtOV18WzAxXT9bMC05XVswLTldPylcLil7M30oPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pJC8sCmlzX3htbDovXjxcP3htbC4qXD8+Lyxqc29uX21heWJlOi9qc29ufHBsYWlufGphdmFzY3JpcHQvLGpzb25fd3JhcDovXltcW1x7XS8sa2xhc3M6L15cLi8sbm86L25vLXN0b3JlfG5vLWNhY2hlL2ksbm90X2RvdG5vdGF0aW9uOi8tfFxzLyxub3RfZW5kcG9pbnQ6Ly4qXC8vLG51bGxfdW5kZWZpbmVkOi9udWxsfHVuZGVmaW5lZC8sbnVtYmVyOi8oXi0/XGRcZCpcLlxkKiQpfCheLT9cZFxkKiQpfCheLT9cLlxkXGQqJCl8bnVtYmVyLyxudW1iZXJfZm9ybWF0XzE6Ly4qXC4vLG51bWJlcl9mb3JtYXRfMjovXC4uKi8sbnVtYmVyX3ByZXNlbnQ6L1xkezEsfS8sbnVtYmVyX3N0cmluZzovbnVtYmVyfHN0cmluZy9pLG51bWJlcl9zdHJpbmdfb2JqZWN0Oi9udW1iZXJ8b2JqZWN0fHN0cmluZy9pLG9iamVjdF90eXBlOi9cW29iamVjdCBPYmplY3RcXS8scGF0Y2g6L15wYXRjaCQvLHByaW1pdGl2ZTovXihib29sZWFufGZ1bmN0aW9ufG51bWJlcnxzdHJpbmcpJC8scHJpdjovcHJpdmF0ZS8sCnB1dF9wb3N0Oi9eKHBvc3R8cHV0KSQvaSxyYWRpb19jaGVja2JveDovXihyYWRpb3xjaGVja2JveCkkL2kscm9vdDovXlwvW15cL10vLHNlbGVjdDovc2VsZWN0L2ksc2VsZWN0b3JfaXM6L146LyxzZWxlY3Rvcl9jb21wbGV4Oi9ccyt8XD58XCt8XH58XDp8XFsvLHNldF9kZWw6L14oc2V0fGRlbHxkZWxldGUpJC8sc3BhY2VfaHlwaGVuOi9cc3wtLyxzdHJpbmdfb2JqZWN0Oi9zdHJpbmd8b2JqZWN0L2ksc3ZnOi9zdmcvLHRvcF9ib3R0b206L3RvcHxib3R0b20vaSx1cmw6L14oPzooPzpodHRwcz98ZnRwKTpcL1wvKSg/OlxTKyg/OjpcUyopP0ApPyg/Oig/ITEwKD86XC5cZHsxLDN9KXszfSkoPyExMjcoPzpcLlxkezEsM30pezN9KSg/ITE2OVwuMjU0KD86XC5cZHsxLDN9KXsyfSkoPyExOTJcLjE2OCg/OlwuXGR7MSwzfSl7Mn0pKD8hMTcyXC4oPzoxWzYtOV18MlxkfDNbMC0xXSkoPzpcLlxkezEsM30pezJ9KSg/OlsxLTldXGQ/fDFcZFxkfDJbMDFdXGR8MjJbMC0zXSkoPzpcLig/OjE/XGR7MSwyfXwyWzAtNF1cZHwyNVswLTVdKSl7Mn0oPzpcLig/OlsxLTldXGQ/fDFcZFxkfDJbMC00XVxkfDI1WzAtNF0pKXwoPzooPzpbYS16XHUwMGExLVx1ZmZmZjAtOV0rLT8pKlthLXpcdTAwYTEtXHVmZmZmMC05XSspKD86XC4oPzpbYS16XHUwMGExLVx1ZmZmZjAtOV0rLT8pKlthLXpcdTAwYTEtXHVmZmZmMC05XSspKig/OlwuKD86W2Etelx1MDBhMS1cdWZmZmZdezIsfSkpKSg/OjpcZHsyLDV9KT8oPzpcL1teXHNdKik/JC9pLAp3b3JkOi9eXHcrJC8seGRvbWFpbnJlcXVlc3Q6L14oZ2V0fHBvc3QpJC9pLHhtbDoveG1sL2l9O3ZhciBscnU9e2ZhY3Rvcnk6ZnVuY3Rpb24obWF4KXtyZXR1cm4gbmV3IExSVShtYXgpfX07ZnVuY3Rpb24gTFJVKG1heCl7dGhpcy5jYWNoZT17fTt0aGlzLm1heD1tYXh8fDFFMzt0aGlzLmZpcnN0PW51bGw7dGhpcy5sYXN0PW51bGw7dGhpcy5sZW5ndGg9MH1MUlUucHJvdG90eXBlLmNvbnN0cnVjdG9yPUxSVTtMUlUucHJvdG90eXBlLmV2aWN0PWZ1bmN0aW9uKCl7aWYodGhpcy5sYXN0IT09bnVsbCl0aGlzLnJlbW92ZSh0aGlzLmxhc3QpO3JldHVybiB0aGlzfTtMUlUucHJvdG90eXBlLmdldD1mdW5jdGlvbihrZXkpe3ZhciBpdGVtPXRoaXMuY2FjaGVba2V5XTtpZihpdGVtPT09dW5kZWZpbmVkKXJldHVybjt0aGlzLnNldChrZXksaXRlbS52YWx1ZSk7cmV0dXJuIGl0ZW0udmFsdWV9O0xSVS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGtleSl7dmFyIGl0ZW09dGhpcy5jYWNoZVtrZXldOwppZihpdGVtKXtkZWxldGUgdGhpcy5jYWNoZVtrZXldO3RoaXMubGVuZ3RoLS07aWYoaXRlbS5wcmV2aW91cyE9PW51bGwpdGhpcy5jYWNoZVtpdGVtLnByZXZpb3VzXS5uZXh0PWl0ZW0ubmV4dDtpZihpdGVtLm5leHQhPT1udWxsKXRoaXMuY2FjaGVbaXRlbS5uZXh0XS5wcmV2aW91cz1pdGVtLnByZXZpb3VzO2lmKHRoaXMuZmlyc3Q9PT1rZXkpdGhpcy5maXJzdD1pdGVtLnByZXZpb3VzO2lmKHRoaXMubGFzdD09PWtleSl0aGlzLmxhc3Q9aXRlbS5uZXh0fXJldHVybiBpdGVtfTtMUlUucHJvdG90eXBlLnNldD1mdW5jdGlvbihrZXksdmFsdWUpe3ZhciBpdGVtPXRoaXMucmVtb3ZlKGtleSk7aWYoaXRlbT09PXVuZGVmaW5lZClpdGVtPW5ldyBMUlVJdGVtKHZhbHVlKTtlbHNlIGl0ZW0udmFsdWU9dmFsdWU7aXRlbS5uZXh0PW51bGw7aXRlbS5wcmV2aW91cz10aGlzLmZpcnN0O3RoaXMuY2FjaGVba2V5XT1pdGVtO2lmKHRoaXMuZmlyc3QhPT1udWxsKXRoaXMuY2FjaGVbdGhpcy5maXJzdF0ubmV4dD0Ka2V5O3RoaXMuZmlyc3Q9a2V5O2lmKHRoaXMubGFzdD09PW51bGwpdGhpcy5sYXN0PWtleTtpZigrK3RoaXMubGVuZ3RoPnRoaXMubWF4KXRoaXMuZXZpY3QoKTtyZXR1cm4gdGhpc307ZnVuY3Rpb24gTFJVSXRlbSh2YWx1ZSl7dGhpcy5uZXh0PW51bGw7dGhpcy5wcmV2aW91cz1udWxsO3RoaXMudmFsdWU9dmFsdWV9TFJVSXRlbS5wcm90b3R5cGUuY29uc3RydWN0b3I9TFJVSXRlbTt2YXIgb2JzZXJ2YWJsZT17ZmFjdG9yeTpmdW5jdGlvbihhcmcpe3JldHVybiBuZXcgT2JzZXJ2YWJsZShhcmcpfX07ZnVuY3Rpb24gT2JzZXJ2YWJsZShhcmcpe3RoaXMubGltaXQ9YXJnfHxNQVg7dGhpcy5saXN0ZW5lcnM9e307dGhpcy5ob29rcz17fX1PYnNlcnZhYmxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1PYnNlcnZhYmxlO09ic2VydmFibGUucHJvdG90eXBlLmRpc3BhdGNoPWZ1bmN0aW9uKCl7dmFyIGFyZ3M9YXJyYXkuY2FzdChhcmd1bWVudHMpLGV2PWFyZ3Muc2hpZnQoKTtpZihldiYmCnRoaXMubGlzdGVuZXJzW2V2XSl1dGlsaXR5Lml0ZXJhdGUodGhpcy5saXN0ZW5lcnNbZXZdLGZ1bmN0aW9uKGkpe2kuaGFuZGxlci5hcHBseShpLnNjb3BlLGFyZ3MpfSk7cmV0dXJuIHRoaXN9O09ic2VydmFibGUucHJvdG90eXBlLmhvb2s9ZnVuY3Rpb24odGFyZ2V0LGV2KXt2YXIgc2VsZj10aGlzO2lmKHR5cGVvZiB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lciE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7dXRpbGl0eS5nZW5JZCh0YXJnZXQpO3RoaXMuaG9va3NbdGFyZ2V0LmlkXT1mdW5jdGlvbihhcmcpe3NlbGYuZGlzcGF0Y2goZXYsYXJnKX07dGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXYsdGhpcy5ob29rc1t0YXJnZXQuaWRdLGZhbHNlKTtyZXR1cm4gdGFyZ2V0fTtPYnNlcnZhYmxlLnByb3RvdHlwZS5vZmY9ZnVuY3Rpb24oZXYsaWQpe2lmKHRoaXMubGlzdGVuZXJzW2V2XSlpZihpZClkZWxldGUgdGhpcy5saXN0ZW5lcnNbZXZdW2lkXTsKZWxzZSBkZWxldGUgdGhpcy5saXN0ZW5lcnNbZXZdO3JldHVybiB0aGlzfTtPYnNlcnZhYmxlLnByb3RvdHlwZS5vbj1mdW5jdGlvbihldixoYW5kbGVyLGlkLHNjb3BlKXtpZD1pZHx8dXRpbGl0eS51dWlkKCk7c2NvcGU9c2NvcGV8fHRoaXM7aWYoIXRoaXMubGlzdGVuZXJzW2V2XSl0aGlzLmxpc3RlbmVyc1tldl09e307aWYoYXJyYXkua2V5cyh0aGlzLmxpc3RlbmVyc1tldl0pLmxlbmd0aD49dGhpcy5saW1pdCl0aHJvdyBuZXcgRXJyb3IoIlBvc3NpYmxlIG1lbW9yeSBsZWFrLCBtb3JlIHRoYW4gIit0aGlzLmxpbWl0KyIgbGlzdGVuZXJzIGZvciBldmVudDogIitldik7dGhpcy5saXN0ZW5lcnNbZXZdW2lkXT17c2NvcGU6c2NvcGUsaGFuZGxlcjpoYW5kbGVyfTtyZXR1cm4gdGhpc307T2JzZXJ2YWJsZS5wcm90b3R5cGUub25jZT1mdW5jdGlvbihldixoYW5kbGVyLGlkLHNjb3BlKXt2YXIgc2VsZj10aGlzO2lkPWlkfHx1dGlsaXR5LnV1aWQoKTtzY29wZT1zY29wZXx8dGhpczsKcmV0dXJuIHRoaXMub24oZXYsZnVuY3Rpb24oKXtoYW5kbGVyLmFwcGx5KHNjb3BlLFtdLmNvbmNhdChhcnJheS5jYXN0KGFyZ3VtZW50cykpKTtzZWxmLm9mZihldixpZCl9LGlkLHNjb3BlKX07T2JzZXJ2YWJsZS5wcm90b3R5cGUudW5ob29rPWZ1bmN0aW9uKHRhcmdldCxldil7dGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXYsdGhpcy5ob29rc1t0YXJnZXQuaWRdLGZhbHNlKTtkZWxldGUgdGhpcy5ob29rc1t0YXJnZXQuaWRdO3JldHVybiB0YXJnZXR9O3ZhciBiYXNlPXtmYWN0b3J5OmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBCYXNlfX07ZnVuY3Rpb24gQmFzZSgpe3RoaXMub2JzZXJ2ZXI9bnVsbH1CYXNlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1CYXNlO0Jhc2UucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZXYsbGlzdGVuZXIsaWQsc2NvcGUpe3RoaXMub2JzZXJ2ZXIub24oZXYsbGlzdGVuZXIsaWQsc2NvcGV8fHRoaXMpO3JldHVybiB0aGlzfTtCYXNlLnByb3RvdHlwZS5hZGRMaXN0ZW5lcj0KZnVuY3Rpb24oZXYsbGlzdGVuZXIsaWQsc2NvcGUpe3RoaXMub2JzZXJ2ZXIub24oZXYsbGlzdGVuZXIsaWQsc2NvcGV8fHRoaXMpO3JldHVybiB0aGlzfTtCYXNlLnByb3RvdHlwZS5kaXNwYXRjaD1mdW5jdGlvbigpe3RoaXMub2JzZXJ2ZXIuZGlzcGF0Y2guYXBwbHkodGhpcy5vYnNlcnZlcixbXS5jb25jYXQoYXJyYXkuY2FzdChhcmd1bWVudHMpKSk7cmV0dXJuIHRoaXN9O0Jhc2UucHJvdG90eXBlLmRpc3BhdGNoRXZlbnQ9ZnVuY3Rpb24oKXt0aGlzLm9ic2VydmVyLmRpc3BhdGNoLmFwcGx5KHRoaXMub2JzZXJ2ZXIsW10uY29uY2F0KGFycmF5LmNhc3QoYXJndW1lbnRzKSkpO3JldHVybiB0aGlzfTtCYXNlLnByb3RvdHlwZS5lbWl0PWZ1bmN0aW9uKCl7dGhpcy5vYnNlcnZlci5kaXNwYXRjaC5hcHBseSh0aGlzLm9ic2VydmVyLFtdLmNvbmNhdChhcnJheS5jYXN0KGFyZ3VtZW50cykpKTtyZXR1cm4gdGhpc307QmFzZS5wcm90b3R5cGUuaG9vaz1mdW5jdGlvbigpe3RoaXMub2JzZXJ2ZXIuaG9vay5hcHBseSh0aGlzLm9ic2VydmVyLApbXS5jb25jYXQoYXJyYXkuY2FzdChhcmd1bWVudHMpKSk7cmV0dXJuIHRoaXN9O0Jhc2UucHJvdG90eXBlLmxpc3RlbmVycz1mdW5jdGlvbihldil7cmV0dXJuIGV2P3RoaXMub2JzZXJ2ZXIubGlzdGVuZXJzW2V2XTp0aGlzLmxpc3RlbmVyc307QmFzZS5wcm90b3R5cGUub2ZmPWZ1bmN0aW9uKGV2LGlkKXt0aGlzLm9ic2VydmVyLm9mZihldixpZCk7cmV0dXJuIHRoaXN9O0Jhc2UucHJvdG90eXBlLm9uPWZ1bmN0aW9uKGV2LGxpc3RlbmVyLGlkLHNjb3BlKXt0aGlzLm9ic2VydmVyLm9uKGV2LGxpc3RlbmVyLGlkLHNjb3BlfHx0aGlzKTtyZXR1cm4gdGhpc307QmFzZS5wcm90b3R5cGUub25jZT1mdW5jdGlvbihldixsaXN0ZW5lcixpZCxzY29wZSl7dGhpcy5vYnNlcnZlci5vbmNlKGV2LGxpc3RlbmVyLGlkLHNjb3BlfHx0aGlzKTtyZXR1cm4gdGhpc307QmFzZS5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihldixpZCl7dGhpcy5vYnNlcnZlci5vZmYoZXYsCmlkKTtyZXR1cm4gdGhpc307QmFzZS5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXI9ZnVuY3Rpb24oZXYsaWQpe3RoaXMub2JzZXJ2ZXIub2ZmKGV2LGlkKTtyZXR1cm4gdGhpc307dmFyIGFycmF5PXthZGQ6ZnVuY3Rpb24ob2JqLGFyZyl7aWYoIWFycmF5LmNvbnRhaW5zKG9iaixhcmcpKW9iai5wdXNoKGFyZyk7cmV0dXJuIG9ian0sYmluSW5kZXg6ZnVuY3Rpb24ob2JqLGFyZyl7dmFyIG1pbj0wLG1heD1vYmoubGVuZ3RoLTEsaWR4LHZhbDt3aGlsZShtaW48PW1heCl7aWR4PU1hdGguZmxvb3IoKG1pbittYXgpLzIpO3ZhbD1vYmpbaWR4XTtpZih2YWw8YXJnKW1pbj1pZHgrMTtlbHNlIGlmKHZhbD5hcmcpbWF4PWlkeC0xO2Vsc2UgcmV0dXJuIGlkeH1yZXR1cm4tMX0sY2FzdDpmdW5jdGlvbihvYmosa2V5KXtrZXk9a2V5PT09dHJ1ZTt2YXIgbz1bXTtpZighaXNOYU4ob2JqLmxlbmd0aCkpbz1zbGljZS5jYWxsKG9iaik7ZWxzZSBpZihrZXkpbz1hcnJheS5rZXlzKG9iaik7ZWxzZSB1dGlsaXR5Lml0ZXJhdGUob2JqLApmdW5jdGlvbihpKXtvLnB1c2goaSl9KTtyZXR1cm4gb30sY2h1bms6ZnVuY3Rpb24ob2JqLHNpemUpe3ZhciByZXN1bHQ9W10sbnRoPW51bWJlci5yb3VuZChvYmoubGVuZ3RoL3NpemUsInVwIiksc3RhcnQ9MCxpPS0xO3doaWxlKCsraTxudGgpe3N0YXJ0PWkqc2l6ZTtyZXN1bHQucHVzaChhcnJheS5saW1pdChvYmosc3RhcnQsc2l6ZSkpfXJldHVybiByZXN1bHR9LGNsZWFyOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai5sZW5ndGg+MD9hcnJheS5yZW1vdmUob2JqLDAsb2JqLmxlbmd0aCk6b2JqfSxjbG9uZTpmdW5jdGlvbihvYmope3JldHVybiBvYmouc2xpY2UoKX0sY29udGFpbnM6ZnVuY3Rpb24ob2JqLGFyZyl7cmV0dXJuIG9iai5pbmRleE9mKGFyZyk+LTF9LGNvbGxlY3Q6ZnVuY3Rpb24ob2JqLGZuKXt2YXIgcmVzdWx0PVtdO2FycmF5LmVhY2gob2JqLGZ1bmN0aW9uKGkpe3Jlc3VsdC5wdXNoKGZuKGkpKX0pO3JldHVybiByZXN1bHR9LGNvbXBhY3Q6ZnVuY3Rpb24ob2JqLApkaWZmKXtkaWZmPWRpZmY9PT10cnVlO3ZhciByZXN1bHQ7cmVzdWx0PW9iai5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIXJlZ2V4Lm51bGxfdW5kZWZpbmVkLnRlc3QoaSl9KTtyZXR1cm4hZGlmZj9yZXN1bHQ6cmVzdWx0Lmxlbmd0aDxvYmoubGVuZ3RoP3Jlc3VsdDpudWxsfSxjb3VudDpmdW5jdGlvbihvYmosdmFsdWUpe3JldHVybiBvYmouZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpPT09dmFsdWV9KS5sZW5ndGh9LGRpZmY6ZnVuY3Rpb24ob2JqMSxvYmoyKXt2YXIgcmVzdWx0PVtdO2FycmF5LmVhY2gob2JqMSxmdW5jdGlvbihpKXtpZighYXJyYXkuY29udGFpbnMob2JqMixpKSlhcnJheS5hZGQocmVzdWx0LGkpfSk7YXJyYXkuZWFjaChvYmoyLGZ1bmN0aW9uKGkpe2lmKCFhcnJheS5jb250YWlucyhvYmoxLGkpKWFycmF5LmFkZChyZXN1bHQsaSl9KTtyZXR1cm4gcmVzdWx0fSxlYWNoOmZ1bmN0aW9uKG9iaixmbixhc3luYyxzaXplKXt2YXIgbnRoPW9iai5sZW5ndGgsCmksb2Zmc2V0O2lmKGFzeW5jIT09dHJ1ZSl7aT0tMTt3aGlsZSgrK2k8bnRoKWlmKGZuLmNhbGwob2JqLG9ialtpXSxpKT09PWZhbHNlKWJyZWFrfWVsc2V7c2l6ZT1zaXplfHwxMDtvZmZzZXQ9MDtpZihzaXplPm50aClzaXplPW50aDt1dGlsaXR5LnJlcGVhdChmdW5jdGlvbigpe3ZhciBpPS0xLGlkeDt3aGlsZSgrK2k8c2l6ZSl7aWR4PWkrb2Zmc2V0O2lmKGlkeD09PW50aHx8Zm4uY2FsbChvYmosb2JqW2lkeF0saWR4KT09PWZhbHNlKXJldHVybiBmYWxzZX1vZmZzZXQrPXNpemU7aWYob2Zmc2V0Pj1udGgpcmV0dXJuIGZhbHNlfSx1bmRlZmluZWQsdW5kZWZpbmVkLGZhbHNlKX1yZXR1cm4gb2JqfSxlYWNoUmV2ZXJzZTpmdW5jdGlvbihvYmosZm4sYXN5bmMsc2l6ZSl7dmFyIG50aD1vYmoubGVuZ3RoLGksb2Zmc2V0O2lmKGFzeW5jIT09dHJ1ZSl7aT1udGg7d2hpbGUoLS1pPi0xKWlmKGZuLmNhbGwob2JqLG9ialtpXSxpKT09PWZhbHNlKWJyZWFrfWVsc2V7c2l6ZT1zaXplfHwKMTA7b2Zmc2V0PW50aC0xO2lmKHNpemU+bnRoKXNpemU9bnRoO3V0aWxpdHkucmVwZWF0KGZ1bmN0aW9uKCl7dmFyIGk9LTEsaWR4O3doaWxlKCsraTxzaXplKXtpZHg9b2Zmc2V0LWk7aWYoaWR4PDB8fGZuLmNhbGwob2JqLG9ialtpZHhdLGlkeCk9PT1mYWxzZSlyZXR1cm4gZmFsc2V9b2Zmc2V0LT1zaXplO2lmKG9mZnNldDwwKXJldHVybiBmYWxzZX0sdW5kZWZpbmVkLHVuZGVmaW5lZCxmYWxzZSl9cmV0dXJuIG9ian0sZW1wdHk6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gb2JqLmxlbmd0aD09PTB9LGVxdWFsOmZ1bmN0aW9uKG9iajEsb2JqMil7cmV0dXJuIGpzb24uZW5jb2RlKG9iajEpPT09anNvbi5lbmNvZGUob2JqMil9LGZpYjpmdW5jdGlvbihhcmcpe3ZhciByZXN1bHQ9WzEsMV0sZmlyc3Q9cmVzdWx0WzBdLHNlY29uZD1yZXN1bHRbMV0sc3VtO2FyZz0oYXJnfHwxMDApLTE7aWYoaXNOYU4oYXJnKXx8YXJnPDIpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpOwp3aGlsZSgtLWFyZyl7c3VtPWZpcnN0K3NlY29uZDtmaXJzdD1zZWNvbmQ7c2Vjb25kPXN1bTtyZXN1bHQucHVzaChzdW0pfXJldHVybiByZXN1bHR9LGZpbGw6ZnVuY3Rpb24ob2JqLGFyZyxzdGFydCxvZmZzZXQpe3ZhciBmbj10eXBlb2YgYXJnPT0iZnVuY3Rpb24iLGw9b2JqLmxlbmd0aCxpPSFpc05hTihzdGFydCk/c3RhcnQ6MCxudGg9IWlzTmFOKG9mZnNldCk/aStvZmZzZXQ6bC0xO2lmKG50aD5sLTEpbnRoPWwtMTt3aGlsZShpPD1udGgpe29ialtpXT1mbj9hcmcob2JqW2ldKTphcmc7aSsrfXJldHVybiBvYmp9LGZpcnN0OmZ1bmN0aW9uKG9iail7cmV0dXJuIG9ialswXX0sZmxhdDpmdW5jdGlvbihvYmope3ZhciByZXN1bHQ9W107cmVzdWx0PW9iai5yZWR1Y2UoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5jb25jYXQoYil9LHJlc3VsdCk7cmV0dXJuIHJlc3VsdH0sZm9yRWFjaDpmdW5jdGlvbihvYmosZm4sYXN5bmMsc2l6ZSl7cmV0dXJuIGFycmF5LmVhY2gob2JqLGZuLGFzeW5jLApzaXplKX0sZnJvbU9iamVjdDpmdW5jdGlvbihvYmope3JldHVybiBhcnJheS5taW5nbGUoYXJyYXkua2V5cyhvYmopLGFycmF5LmNhc3Qob2JqKSl9LGluZGV4OmZ1bmN0aW9uKG9iaixhcmcpe3JldHVybiBvYmouaW5kZXhPZihhcmcpfSxpbmRleGVkOmZ1bmN0aW9uKG9iail7dmFyIGluZGV4ZWQ9W107dXRpbGl0eS5pdGVyYXRlKG9iaixmdW5jdGlvbih2KXtpbmRleGVkLnB1c2godil9KTtyZXR1cm4gaW5kZXhlZH0saW50ZXJzZWN0OmZ1bmN0aW9uKG9iajEsb2JqMil7dmFyIGE9b2JqMS5sZW5ndGg+b2JqMi5sZW5ndGg/b2JqMTpvYmoyLGI9YT09PW9iajE/b2JqMjpvYmoxO3JldHVybiBhLmZpbHRlcihmdW5jdGlvbihrZXkpe3JldHVybiBhcnJheS5jb250YWlucyhiLGtleSl9KX0sa2VlcElmOmZ1bmN0aW9uKG9iaixmbil7aWYodHlwZW9mIGZuIT0iZnVuY3Rpb24iKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTt2YXIgcmVzdWx0PVtdLHJlbW92ZT0KW107cmVzdWx0PW9iai5maWx0ZXIoZm4pO3JlbW92ZT1hcnJheS5kaWZmKG9iaixyZXN1bHQpO2FycmF5LmVhY2gocmVtb3ZlLGZ1bmN0aW9uKGkpe2FycmF5LnJlbW92ZShvYmosYXJyYXkuaW5kZXgob2JqLGkpKX0pO3JldHVybiBvYmp9LGtleXM6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gT2JqZWN0LmtleXMob2JqKX0sa2V5U29ydDpmdW5jdGlvbihvYmoscXVlcnksc3ViKXtxdWVyeT1xdWVyeS5yZXBsYWNlKC9ccyphc2MvaWcsIiIpLnJlcGxhY2UoL1xzKmRlc2MvaWcsIiBkZXNjIik7dmFyIHF1ZXJpZXM9c3RyaW5nLmV4cGxvZGUocXVlcnkpLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5zcGxpdCgiICIpfSksc29ydHM9W10sYnJhY2VTPSdbIicsYnJhY2VFPSciXSc7aWYoc3ViJiZzdWIhPT0iIilzdWI9Ii4iK3N1YjtlbHNlIHN1Yj0iIjthcnJheS5lYWNoKHF1ZXJpZXMsZnVuY3Rpb24oaSl7dmFyIHM9Ii4iLGU9IiI7aWYocmVnZXgubm90X2RvdG5vdGF0aW9uLnRlc3QoaVswXSkpe3M9CmJyYWNlUztlPWJyYWNlRX1zb3J0cy5wdXNoKCJ0cnkgeyIpO2lmKGlbMV09PT0iZGVzYyIpe3NvcnRzLnB1c2goImlmICggYSIrc3ViK3MraVswXStlKyIgPCBiIitzdWIrcytpWzBdK2UrIiApIHJldHVybiAxOyIpO3NvcnRzLnB1c2goImlmICggYSIrc3ViK3MraVswXStlKyIgPiBiIitzdWIrcytpWzBdK2UrIiApIHJldHVybiAtMTsiKX1lbHNle3NvcnRzLnB1c2goImlmICggYSIrc3ViK3MraVswXStlKyIgPCBiIitzdWIrcytpWzBdK2UrIiApIHJldHVybiAtMTsiKTtzb3J0cy5wdXNoKCJpZiAoIGEiK3N1YitzK2lbMF0rZSsiID4gYiIrc3ViK3MraVswXStlKyIgKSByZXR1cm4gMTsiKX1zb3J0cy5wdXNoKCJ9IGNhdGNoIChlKSB7Iik7c29ydHMucHVzaCgidHJ5IHsiKTtzb3J0cy5wdXNoKCJpZiAoIGEiK3N1YitzK2lbMF0rZSsiICE9PSB1bmRlZmluZWQgKSByZXR1cm4gIisoaVsxXT09PSJkZXNjIj8iLTEiOiIxIikrIjsiKTtzb3J0cy5wdXNoKCJ9IGNhdGNoIChlKSB7fSIpOwpzb3J0cy5wdXNoKCJ0cnkgeyIpO3NvcnRzLnB1c2goImlmICggYiIrc3ViK3MraVswXStlKyIgIT09IHVuZGVmaW5lZCApIHJldHVybiAiKyhpWzFdPT09ImRlc2MiPyIxIjoiLTEiKSsiOyIpO3NvcnRzLnB1c2goIn0gY2F0Y2ggKGUpIHt9Iik7c29ydHMucHVzaCgifSIpfSk7c29ydHMucHVzaCgicmV0dXJuIDA7Iik7cmV0dXJuIG9iai5zb3J0KG5ldyBGdW5jdGlvbigiYSIsImIiLHNvcnRzLmpvaW4oIlxuIikpKX0sbGFzdDpmdW5jdGlvbihvYmosYXJnKXt2YXIgbj1vYmoubGVuZ3RoLTE7aWYoYXJnPj1uKzEpcmV0dXJuIG9iajtlbHNlIGlmKGlzTmFOKGFyZyl8fGFyZz09PTEpcmV0dXJuIG9ialtuXTtlbHNlIHJldHVybiBhcnJheS5saW1pdChvYmosbi0gLS1hcmcsbil9LGxpbWl0OmZ1bmN0aW9uKG9iaixzdGFydCxvZmZzZXQpe3ZhciByZXN1bHQ9W10saT1zdGFydC0xLG50aD1zdGFydCtvZmZzZXQsbWF4PW9iai5sZW5ndGg7aWYobWF4PjApd2hpbGUoKytpPG50aCYmaTwKbWF4KXJlc3VsdC5wdXNoKG9ialtpXSk7cmV0dXJuIHJlc3VsdH0sbWF4OmZ1bmN0aW9uKG9iail7cmV0dXJuIGFycmF5Lmxhc3Qob2JqLnNvcnQoYXJyYXkuc29ydCkpfSxtZWFuOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai5sZW5ndGg+MD9hcnJheS5zdW0ob2JqKS9vYmoubGVuZ3RoOnVuZGVmaW5lZH0sbWVkaWFuOmZ1bmN0aW9uKG9iail7dmFyIG50aD1vYmoubGVuZ3RoLG1pZD1udW1iZXIucm91bmQobnRoLzIsImRvd24iKSxzb3J0ZWQ9b2JqLnNvcnQoYXJyYXkuc29ydCk7cmV0dXJuIG51bWJlci5vZGQobnRoKT9zb3J0ZWRbbWlkXTooc29ydGVkW21pZC0xXStzb3J0ZWRbbWlkXSkvMn0sbWVyZ2U6ZnVuY3Rpb24ob2JqMSxvYmoyKXthcnJheS5lYWNoKG9iajIsZnVuY3Rpb24oaSl7YXJyYXkuYWRkKG9iajEsaSl9KTtyZXR1cm4gb2JqMX0sbWluOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai5zb3J0KGFycmF5LnNvcnQpWzBdfSxtaW5nbGU6ZnVuY3Rpb24ob2JqMSxvYmoyKXt2YXIgcmVzdWx0OwpyZXN1bHQ9b2JqMS5tYXAoZnVuY3Rpb24oaSxpZHgpe3JldHVybltpLG9iajJbaWR4XV19KTtyZXR1cm4gcmVzdWx0fSxtb2RlOmZ1bmN0aW9uKG9iail7dmFyIHZhbHVlcz17fSxjb3VudD0wLG1vZGU9W10sbnRoLHJlc3VsdDthcnJheS5lYWNoKG9iaixmdW5jdGlvbihpKXtpZighaXNOYU4odmFsdWVzW2ldKSl2YWx1ZXNbaV0rKztlbHNlIHZhbHVlc1tpXT0xfSk7Y291bnQ9YXJyYXkubWF4KGFycmF5LmNhc3QodmFsdWVzKSk7dXRpbGl0eS5pdGVyYXRlKHZhbHVlcyxmdW5jdGlvbih2LGspe2lmKHY9PT1jb3VudCltb2RlLnB1c2gobnVtYmVyLnBhcnNlKGspKX0pO250aD1tb2RlLmxlbmd0aDtpZihudGg+MClyZXN1bHQ9bnRoPT09MT9tb2RlWzBdOm1vZGU7cmV0dXJuIHJlc3VsdH0scGVyY2VudHM6ZnVuY3Rpb24ob2JqLHByZWNpc2lvbix0b3RhbCl7dmFyIHJlc3VsdD1bXSxjdXN0b209ZmFsc2UsbGFzdCxwYWRkaW5nLHN1bTtwcmVjaXNpb249cHJlY2lzaW9ufHwwO2lmKHRvdGFsPT09CnVuZGVmaW5lZCl0b3RhbD1hcnJheS5zdW0ob2JqKTtlbHNlIGN1c3RvbT10cnVlO2FycmF5LmVhY2gob2JqLGZ1bmN0aW9uKGkpe3Jlc3VsdC5wdXNoKG51bWJlci5wYXJzZSgoaS90b3RhbCoxMDApLnRvRml4ZWQocHJlY2lzaW9uKSkpfSk7aWYoIWN1c3RvbSl7c3VtPWFycmF5LnN1bShyZXN1bHQpO2lmKHN1bTwxMDApe3BhZGRpbmc9bnVtYmVyLnBhcnNlKG51bWJlci5kaWZmKHN1bSwxMDApLnRvRml4ZWQocHJlY2lzaW9uKSk7bGFzdD1hcnJheS5sYXN0KHJlc3VsdCkrcGFkZGluZztyZXN1bHRbcmVzdWx0Lmxlbmd0aC0xXT1sYXN0fWVsc2UgaWYoc3VtPjEwMCl7cGFkZGluZz1udW1iZXIucGFyc2UobnVtYmVyLmRpZmYoc3VtLDEwMCkudG9GaXhlZChwcmVjaXNpb24pKTtsYXN0PW51bWJlci5wYXJzZSgoYXJyYXkubGFzdChyZXN1bHQpLXBhZGRpbmcpLnRvRml4ZWQocHJlY2lzaW9uKSk7cmVzdWx0W3Jlc3VsdC5sZW5ndGgtMV09bGFzdH19cmV0dXJuIHJlc3VsdH0scmFuZ2U6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gYXJyYXkubWF4KG9iaiktCmFycmF5Lm1pbihvYmopfSxyYXNzb2M6ZnVuY3Rpb24ob2JqLGFyZyl7dmFyIHJlc3VsdDthcnJheS5lYWNoKG9iaixmdW5jdGlvbihpLGlkeCl7aWYoaVsxXT09PWFyZyl7cmVzdWx0PW9ialtpZHhdO3JldHVybiBmYWxzZX19KTtyZXR1cm4gcmVzdWx0fSxyZWplY3Q6ZnVuY3Rpb24ob2JqLGZuKXtyZXR1cm4gYXJyYXkuZGlmZihvYmosb2JqLmZpbHRlcihmbikpfSxyZW1vdmU6ZnVuY3Rpb24ob2JqLHN0YXJ0LGVuZCl7aWYoaXNOYU4oc3RhcnQpKXtzdGFydD1vYmouaW5kZXhPZihzdGFydCk7aWYoc3RhcnQ9PT0tMSlyZXR1cm4gb2JqfWVsc2Ugc3RhcnQ9c3RhcnR8fDA7dmFyIGxlbmd0aD1vYmoubGVuZ3RoLHJlbWFpbmluZz1vYmouc2xpY2UoKGVuZHx8c3RhcnQpKzF8fGxlbmd0aCk7b2JqLmxlbmd0aD1zdGFydDwwP2xlbmd0aCtzdGFydDpzdGFydDtvYmoucHVzaC5hcHBseShvYmoscmVtYWluaW5nKTtyZXR1cm4gb2JqfSxyZW1vdmVJZjpmdW5jdGlvbihvYmosZm4pe3ZhciByZW1vdmU7CmlmKHR5cGVvZiBmbiE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7cmVtb3ZlPW9iai5maWx0ZXIoZm4pO2FycmF5LmVhY2gocmVtb3ZlLGZ1bmN0aW9uKGkpe2FycmF5LnJlbW92ZShvYmosYXJyYXkuaW5kZXgob2JqLGkpKX0pO3JldHVybiBvYmp9LHJlbW92ZVdoaWxlOmZ1bmN0aW9uKG9iaixmbil7aWYodHlwZW9mIGZuIT0iZnVuY3Rpb24iKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTt2YXIgcmVtb3ZlPVtdO2FycmF5LmVhY2gob2JqLGZ1bmN0aW9uKGkpe2lmKGZuKGkpIT09ZmFsc2UpcmVtb3ZlLnB1c2goaSk7ZWxzZSByZXR1cm4gZmFsc2V9KTthcnJheS5lYWNoKHJlbW92ZSxmdW5jdGlvbihpKXthcnJheS5yZW1vdmUob2JqLGFycmF5LmluZGV4KG9iaixpKSl9KTtyZXR1cm4gb2JqfSxyZXBsYWNlOmZ1bmN0aW9uKG9iajEsb2JqMil7YXJyYXkucmVtb3ZlKG9iajEsMCxvYmoxLmxlbmd0aCk7YXJyYXkuZWFjaChvYmoyLApmdW5jdGlvbihpKXtvYmoxLnB1c2goaSl9KTtyZXR1cm4gb2JqMX0scmVzdDpmdW5jdGlvbihvYmosYXJnKXthcmc9YXJnfHwxO2lmKGFyZzwxKWFyZz0xO3JldHVybiBhcnJheS5saW1pdChvYmosYXJnLG9iai5sZW5ndGgpfSxyaW5kZXg6ZnVuY3Rpb24ob2JqLGFyZyl7dmFyIHJlc3VsdD0tMTthcnJheS5lYWNoKG9iaixmdW5jdGlvbihpLGlkeCl7aWYoaT09PWFyZylyZXN1bHQ9aWR4fSk7cmV0dXJuIHJlc3VsdH0scm90YXRlOmZ1bmN0aW9uKG9iaixhcmcpe3ZhciBudGg9b2JqLmxlbmd0aCxyZXN1bHQ7aWYoYXJnPT09MClyZXN1bHQ9b2JqO2Vsc2V7aWYoYXJnPDApYXJnKz1udGg7ZWxzZSBhcmctLTtyZXN1bHQ9YXJyYXkubGltaXQob2JqLGFyZyxudGgpO3Jlc3VsdD1yZXN1bHQuY29uY2F0KGFycmF5LmxpbWl0KG9iaiwwLGFyZykpfXJldHVybiByZXN1bHR9LHNlcmllczpmdW5jdGlvbihzdGFydCxlbmQsb2Zmc2V0KXtzdGFydD1zdGFydHx8MDtlbmQ9ZW5kfHxzdGFydDsKb2Zmc2V0PW9mZnNldHx8MTt2YXIgcmVzdWx0PVtdLG49LTEsbnRoPU1hdGgubWF4KDAsTWF0aC5jZWlsKChlbmQtc3RhcnQpL29mZnNldCkpO3doaWxlKCsrbjxudGgpe3Jlc3VsdFtuXT1zdGFydDtzdGFydCs9b2Zmc2V0fXJldHVybiByZXN1bHR9LHNvcnQ6ZnVuY3Rpb24oYSxiKXt2YXIgdHlwZXM9e2E6dHlwZW9mIGEsYjp0eXBlb2YgYn0sYyxkLHJlc3VsdDtpZih0eXBlcy5hPT09Im51bWJlciImJnR5cGVzLmI9PT0ibnVtYmVyIilyZXN1bHQ9YS1iO2Vsc2V7Yz1hLnRvU3RyaW5nKCk7ZD1iLnRvU3RyaW5nKCk7aWYoYzxkKXJlc3VsdD0tMTtlbHNlIGlmKGM+ZClyZXN1bHQ9MTtlbHNlIGlmKHR5cGVzLmE9PT10eXBlcy5iKXJlc3VsdD0wO2Vsc2UgaWYodHlwZXMuYT09PSJib29sZWFuIilyZXN1bHQ9LTE7ZWxzZSByZXN1bHQ9MX1yZXR1cm4gcmVzdWx0fSxzb3J0ZWQ6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gb2JqLnNvcnQoYXJyYXkuc29ydCl9LHNwbGl0OmZ1bmN0aW9uKG9iaiwKZGl2aXNvcil7dmFyIHJlc3VsdD1bXSx0b3RhbD1vYmoubGVuZ3RoLG50aD1NYXRoLmNlaWwodG90YWwvZGl2aXNvciksbG93PU1hdGguZmxvb3IodG90YWwvZGl2aXNvciksbG93ZXI9TWF0aC5jZWlsKHRvdGFsL250aCksbG93ZXJlZD1mYWxzZSxzdGFydD0wLGk9LTE7aWYobnVtYmVyLmRpZmYodG90YWwsZGl2aXNvcipudGgpPm50aClsb3dlcj10b3RhbC1sb3cqZGl2aXNvcitsb3ctMTtlbHNlIGlmKHRvdGFsJWRpdmlzb3I+MCYmbG93ZXIqbnRoPj10b3RhbClsb3dlci0tO3doaWxlKCsraTxkaXZpc29yKXtpZihpPjApc3RhcnQ9c3RhcnQrbnRoO2lmKCFsb3dlcmVkJiZsb3dlcjxkaXZpc29yJiZpPT09bG93ZXIpey0tbnRoO2xvd2VyZWQ9dHJ1ZX1yZXN1bHQucHVzaChhcnJheS5saW1pdChvYmosc3RhcnQsbnRoKSl9cmV0dXJuIHJlc3VsdH0sc3RkZGV2OmZ1bmN0aW9uKG9iail7cmV0dXJuIE1hdGguc3FydChhcnJheS52YXJpYW5jZShvYmopKX0sc3VtOmZ1bmN0aW9uKG9iail7dmFyIHJlc3VsdD0KMDtpZihvYmoubGVuZ3RoPjApcmVzdWx0PW9iai5yZWR1Y2UoZnVuY3Rpb24ocHJldixjdXIpe3JldHVybiBwcmV2K2N1cn0pO3JldHVybiByZXN1bHR9LHRha2U6ZnVuY3Rpb24ob2JqLG4pe3JldHVybiBhcnJheS5saW1pdChvYmosMCxuKX0sdG9PYmplY3Q6ZnVuY3Rpb24oYXIpe3ZhciBvYmo9e30saT1hci5sZW5ndGg7d2hpbGUoaS0tKW9ialtpLnRvU3RyaW5nKCldPWFyW2ldO3JldHVybiBvYmp9LHRvdGFsOmZ1bmN0aW9uKG9iail7cmV0dXJuIGFycmF5LmluZGV4ZWQob2JqKS5sZW5ndGh9LHVuaXF1ZTpmdW5jdGlvbihvYmope3ZhciByZXN1bHQ9W107YXJyYXkuZWFjaChvYmosZnVuY3Rpb24oaSl7YXJyYXkuYWRkKHJlc3VsdCxpKX0pO3JldHVybiByZXN1bHR9LHZhcmlhbmNlOmZ1bmN0aW9uKG9iail7dmFyIG50aD1vYmoubGVuZ3RoLG49MCxtZWFuO2lmKG50aD4wKXttZWFuPWFycmF5Lm1lYW4ob2JqKTthcnJheS5lYWNoKG9iaixmdW5jdGlvbihpKXtuKz1tYXRoLnNxcihpLQptZWFuKX0pO3JldHVybiBuL250aH1lbHNlIHJldHVybiBufSx6aXA6ZnVuY3Rpb24ob2JqLGFyZ3Mpe3ZhciByZXN1bHQ9W107aWYoIShhcmdzIGluc3RhbmNlb2YgQXJyYXkpKWFyZ3M9dHlwZW9mIGFyZ3M9PSJvYmplY3QiP2FycmF5LmNhc3QoYXJncyk6W2FyZ3NdO2FycmF5LmVhY2goYXJncyxmdW5jdGlvbihpLGlkeCl7aWYoIShpIGluc3RhbmNlb2YgQXJyYXkpKXRoaXNbaWR4XT1baV19KTthcnJheS5lYWNoKG9iaixmdW5jdGlvbihpLGlkeCl7cmVzdWx0W2lkeF09W2ldO2FycmF5LmVhY2goYXJncyxmdW5jdGlvbih4KXtyZXN1bHRbaWR4XS5wdXNoKHhbaWR4XXx8bnVsbCl9KX0pO3JldHVybiByZXN1bHR9fTt2YXIgY2FjaGU9e2xydTpscnUuZmFjdG9yeShDQUNIRSksY2xlYW46ZnVuY3Rpb24oKXthcnJheS5lYWNoKGFycmF5LmtleXMoY2FjaGUubHJ1LmNhY2hlKSxmdW5jdGlvbihpKXtpZihjYWNoZS5leHBpcmVkKGkpKWNhY2hlLmV4cGlyZShpKX0pfSxleHBpcmU6ZnVuY3Rpb24odXJpKXtpZihjYWNoZS5scnUuY2FjaGVbdXJpXSl7Y2FjaGUubHJ1LnJlbW92ZSh1cmkpOwpyZXR1cm4gdHJ1ZX1lbHNlIHJldHVybiBmYWxzZX0sZXhwaXJlZDpmdW5jdGlvbih1cmkpe3ZhciBpdGVtPWNhY2hlLmxydS5jYWNoZVt1cmldO3JldHVybiBpdGVtJiZpdGVtLnZhbHVlLmV4cGlyZXM8KG5ldyBEYXRlKS5nZXRUaW1lKCl9LGdldDpmdW5jdGlvbih1cmksZXhwaXJlKXt1cmk9dXRpbGl0eS5wYXJzZSh1cmkpLmhyZWY7dmFyIGl0ZW09Y2FjaGUubHJ1LmdldCh1cmkpO2lmKCFpdGVtKXJldHVybiBmYWxzZTtpZihleHBpcmUhPT1mYWxzZSYmY2FjaGUuZXhwaXJlZCh1cmkpKXtjYWNoZS5leHBpcmUodXJpKTtyZXR1cm4gZmFsc2V9cmV0dXJuIHV0aWxpdHkuY2xvbmUoaXRlbSx0cnVlKX0sc2V0OmZ1bmN0aW9uKHVyaSxwcm9wZXJ0eSx2YWx1ZSl7dXJpPXV0aWxpdHkucGFyc2UodXJpKS5ocmVmO3ZhciBpdGVtPWNhY2hlLmxydS5nZXQodXJpKTtpZighaXRlbSlpdGVtPXtwZXJtaXNzaW9uOjB9O2lmKHByb3BlcnR5PT09InBlcm1pc3Npb24iKWl0ZW0ucGVybWlzc2lvbnw9CnZhbHVlO2Vsc2UgaWYocHJvcGVydHk9PT0iIXBlcm1pc3Npb24iKWl0ZW0ucGVybWlzc2lvbiY9fnZhbHVlO2Vsc2UgaXRlbVtwcm9wZXJ0eV09dmFsdWU7Y2FjaGUubHJ1LnNldCh1cmksaXRlbSk7cmV0dXJuIGl0ZW19fTtmdW5jdGlvbiBLWE1MSHR0cFJlcXVlc3QoeGhyKXt0aGlzLm9ic2VydmVyPW9ic2VydmFibGUuZmFjdG9yeSgpO3RoaXMuZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpO3RoaXMueGhyPXhocn1LWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlPWJhc2UuZmFjdG9yeSgpO0tYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuY29uc3RydWN0b3I9S1hNTEh0dHBSZXF1ZXN0O3ZhciBjbGllbnQ9e2llOmZ1bmN0aW9uKCl7cmV0dXJuIXNlcnZlciYmcmVnZXguaWUudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KX0oKSx2ZXJzaW9uOmZ1bmN0aW9uKCl7dmFyIHZlcnNpb249MDtpZih0aGlzLmllKXt2ZXJzaW9uPW5hdmlnYXRvci51c2VyQWdlbnQucmVwbGFjZSgvKC4qbXNpZXw7LiopL2dpLAoiIik7dmVyc2lvbj1udW1iZXIucGFyc2Uoc3RyaW5nLnRyaW0odmVyc2lvbikpfXJldHVybiB2ZXJzaW9ufSxhbGxvd3M6ZnVuY3Rpb24odXJpLHZlcmIpe2lmKHN0cmluZy5pc0VtcHR5KHVyaSl8fHN0cmluZy5pc0VtcHR5KHZlcmIpKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTt1cmk9dXRpbGl0eS5wYXJzZSh1cmkpLmhyZWY7dmVyYj12ZXJiLnRvTG93ZXJDYXNlKCk7dmFyIHJlc3VsdD1mYWxzZSxiaXQ9MDtpZighY2FjaGUuZ2V0KHVyaSxmYWxzZSkpcmVzdWx0PXVuZGVmaW5lZDtlbHNle2lmKHJlZ2V4LmRlbC50ZXN0KHZlcmIpKWJpdD0xO2Vsc2UgaWYocmVnZXguZ2V0X2hlYWRlcnMudGVzdCh2ZXJiKSliaXQ9NDtlbHNlIGlmKHJlZ2V4LnB1dF9wb3N0LnRlc3QodmVyYikpYml0PTI7ZWxzZSBpZihyZWdleC5wYXRjaC50ZXN0KHZlcmIpKWJpdD04O3Jlc3VsdD1Cb29sZWFuKGNsaWVudC5wZXJtaXNzaW9ucyh1cmksdmVyYikuYml0JmJpdCl9cmV0dXJuIHJlc3VsdH0sCmJpdDpmdW5jdGlvbihhcmdzKXt2YXIgcmVzdWx0PTA7YXJyYXkuZWFjaChhcmdzLGZ1bmN0aW9uKHZlcmIpe3ZlcmI9dmVyYi50b0xvd2VyQ2FzZSgpO2lmKHJlZ2V4LmdldF9oZWFkZXJzLnRlc3QodmVyYikpcmVzdWx0fD00O2Vsc2UgaWYocmVnZXgucHV0X3Bvc3QudGVzdCh2ZXJiKSlyZXN1bHR8PTI7ZWxzZSBpZihyZWdleC5wYXRjaC50ZXN0KHZlcmIpKXJlc3VsdHw9ODtlbHNlIGlmKHJlZ2V4LmRlbC50ZXN0KHZlcmIpKXJlc3VsdHw9MX0pO3JldHVybiByZXN1bHR9LGNvcnM6ZnVuY3Rpb24odXJpKXtyZXR1cm4hc2VydmVyJiZ1cmkuaW5kZXhPZigiLy8iKT4tMSYmdXJpLmluZGV4T2YoIi8vIitsb2NhdGlvbi5ob3N0KT09PS0xfSxoZWFkZXJzOmZ1bmN0aW9uKHhocix1cmksdHlwZSl7dmFyIGhlYWRlcnM9c3RyaW5nLnRyaW0oeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKS5zcGxpdCgiXG4iKSxpdGVtcz17fSxvPXt9LGFsbG93PW51bGwsZXhwaXJlcz1uZXcgRGF0ZSwKY29ycz1jbGllbnQuY29ycyh1cmkpO2FycmF5LmVhY2goaGVhZGVycyxmdW5jdGlvbihpKXt2YXIgaGVhZGVyPWkuc3BsaXQoIjogIik7aXRlbXNbaGVhZGVyWzBdLnRvTG93ZXJDYXNlKCldPXN0cmluZy50cmltKGhlYWRlclsxXSk7aWYoYWxsb3c9PT1udWxsKWlmKCFjb3JzJiZyZWdleC5hbGxvdy50ZXN0KGhlYWRlcil8fGNvcnMmJnJlZ2V4LmFsbG93X2NvcnMudGVzdChoZWFkZXIpKWFsbG93PWhlYWRlclsxXX0pO2lmKHJlZ2V4Lm5vLnRlc3QoaXRlbXNbImNhY2hlLWNvbnRyb2wiXSkpZXhwaXJlcz1leHBpcmVzLmdldFRpbWUoKTtlbHNlIGlmKGl0ZW1zWyJjYWNoZS1jb250cm9sIl0mJnJlZ2V4Lm51bWJlcl9wcmVzZW50LnRlc3QoaXRlbXNbImNhY2hlLWNvbnRyb2wiXSkpZXhwaXJlcz1leHBpcmVzLnNldFNlY29uZHMoZXhwaXJlcy5nZXRTZWNvbmRzKCkrbnVtYmVyLnBhcnNlKHJlZ2V4Lm51bWJlcl9wcmVzZW50LmV4ZWMoaXRlbXNbImNhY2hlLWNvbnRyb2wiXSlbMF0sCjEwKSk7ZWxzZSBpZihpdGVtcy5leHBpcmVzKWV4cGlyZXM9KG5ldyBEYXRlKGl0ZW1zLmV4cGlyZXMpKS5nZXRUaW1lKCk7ZWxzZSBleHBpcmVzPWV4cGlyZXMuZ2V0VGltZSgpO28uZXhwaXJlcz1leHBpcmVzO28uaGVhZGVycz1pdGVtcztvLnRpbWVzdGFtcD1uZXcgRGF0ZTtvLnBlcm1pc3Npb249Y2xpZW50LmJpdChhbGxvdyE9PW51bGw/c3RyaW5nLmV4cGxvZGUoYWxsb3cpOlt0eXBlXSk7aWYodHlwZT09PSJnZXQiKXtjYWNoZS5zZXQodXJpLCJleHBpcmVzIixvLmV4cGlyZXMpO2NhY2hlLnNldCh1cmksImhlYWRlcnMiLG8uaGVhZGVycyk7Y2FjaGUuc2V0KHVyaSwidGltZXN0YW1wIixvLnRpbWVzdGFtcCk7Y2FjaGUuc2V0KHVyaSwicGVybWlzc2lvbiIsby5wZXJtaXNzaW9uKX1yZXR1cm4gb30scGFyc2U6ZnVuY3Rpb24oeGhyLHR5cGUpe3R5cGU9dHlwZXx8IiI7dmFyIHJlc3VsdCxvYmo7aWYoKHJlZ2V4Lmpzb25fbWF5YmUudGVzdCh0eXBlKXx8c3RyaW5nLmlzRW1wdHkodHlwZSkpJiYKKHJlZ2V4Lmpzb25fd3JhcC50ZXN0KHhoci5yZXNwb25zZVRleHQpJiZCb29sZWFuKG9iaj1qc29uLmRlY29kZSh4aHIucmVzcG9uc2VUZXh0LHRydWUpKSkpcmVzdWx0PW9iajtlbHNlIGlmKHR5cGU9PT0idGV4dC9jc3YiKXJlc3VsdD1jc3YuZGVjb2RlKHhoci5yZXNwb25zZVRleHQpO2Vsc2UgaWYodHlwZT09PSJ0ZXh0L3RzdiIpcmVzdWx0PWNzdi5kZWNvZGUoeGhyLnJlc3BvbnNlVGV4dCwiXHQiKTtlbHNlIGlmKHJlZ2V4LnhtbC50ZXN0KHR5cGUpKXtpZih0eXBlIT09InRleHQveG1sIil4aHIub3ZlcnJpZGVNaW1lVHlwZSgidGV4dC94bWwiKTtyZXN1bHQ9eGhyLnJlc3BvbnNlWE1MfWVsc2UgaWYodHlwZT09PSJ0ZXh0L3BsYWluIiYmcmVnZXguaXNfeG1sLnRlc3QoeGhyLnJlc3BvbnNlVGV4dCkmJnhtbC52YWxpZCh4aHIucmVzcG9uc2VUZXh0KSlyZXN1bHQ9eG1sLmRlY29kZSh4aHIucmVzcG9uc2VUZXh0KTtlbHNlIHJlc3VsdD14aHIucmVzcG9uc2VUZXh0O3JldHVybiByZXN1bHR9LApwZXJtaXNzaW9uczpmdW5jdGlvbih1cmkpe3ZhciBjYWNoZWQ9Y2FjaGUuZ2V0KHVyaSxmYWxzZSksYml0PSFjYWNoZWQ/MDpjYWNoZWQucGVybWlzc2lvbixyZXN1bHQ9e2FsbG93czpbXSxiaXQ6Yml0LG1hcDp7cGFydGlhbDo4LHJlYWQ6NCx3cml0ZToyLCJkZWxldGUiOjEsdW5rbm93bjowfX07aWYoYml0JjEpcmVzdWx0LmFsbG93cy5wdXNoKCJERUxFVEUiKTtpZihiaXQmMil7cmVzdWx0LmFsbG93cy5wdXNoKCJQT1NUIik7cmVzdWx0LmFsbG93cy5wdXNoKCJQVVQiKX1pZihiaXQmNClyZXN1bHQuYWxsb3dzLnB1c2goIkdFVCIpO2lmKGJpdCY4KXJlc3VsdC5hbGxvd3MucHVzaCgiUEFUQ0giKTtyZXR1cm4gcmVzdWx0fSxqc29ucDpmdW5jdGlvbih1cmksYXJncyl7dmFyIGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSxjYWxsYmFjaz0iY2FsbGJhY2siLGNiaWQscztpZihleHRlcm5hbD09PXVuZGVmaW5lZCl7aWYoIWdsb2JhbC5rZWlnYWkpZ2xvYmFsLmtlaWdhaT17Y2FsbGJhY2s6e319OwpleHRlcm5hbD0ia2VpZ2FpIn1pZihhcmdzIGluc3RhbmNlb2YgT2JqZWN0JiYhYXJncy5jYWxsYmFjayljYWxsYmFjaz1hcmdzLmNhbGxiYWNrO2RvIGNiaWQ9dXRpbGl0eS5nZW5JZCgpLnNsaWNlKDAsMTApO3doaWxlKGdsb2JhbC5jYWxsYmFja1tjYmlkXSk7dXJpPXVyaS5yZXBsYWNlKGNhbGxiYWNrKyI9PyIsY2FsbGJhY2srIj0iK2V4dGVybmFsKyIuY2FsbGJhY2suIitjYmlkKTtnbG9iYWwuY2FsbGJhY2tbY2JpZF09ZnVuY3Rpb24oYXJnKXt1dGlsaXR5LmNsZWFyVGltZXJzKGNiaWQpO2RlbGV0ZSBnbG9iYWwuY2FsbGJhY2tbY2JpZF07ZGVmZXIucmVzb2x2ZShhcmcpO2VsZW1lbnQuZGVzdHJveShzKX07cz1lbGVtZW50LmNyZWF0ZSgic2NyaXB0Iix7c3JjOnVyaSx0eXBlOiJ0ZXh0L2phdmFzY3JpcHQifSx1dGlsaXR5LmRvbSgiaGVhZCIpWzBdKTt1dGlsaXR5LmRlZmVyKGZ1bmN0aW9uKCl7ZGVmZXIucmVqZWN0KHVuZGVmaW5lZCl9LDNFNCxjYmlkKTtyZXR1cm4gZGVmZXJ9LApreGhyOmZ1bmN0aW9uKHhocil7dmFyIG9iaj1uZXcgS1hNTEh0dHBSZXF1ZXN0KHhocik7YXJyYXkuZWFjaChhcnJheS5rZXlzKERlZmVycmVkLnByb3RvdHlwZSksZnVuY3Rpb24oaSl7b2JqW2ldPWZ1bmN0aW9uKCl7cmV0dXJuIG9iai5kZWZlcltpXS5hcHBseShvYmouZGVmZXIsYXJyYXkuY2FzdChhcmd1bWVudHMpKX19KTthcnJheS5lYWNoKEVWRU5UUyxmdW5jdGlvbihpKXtvYmouaG9vayhvYmoueGhyLGkpfSk7cmV0dXJuIG9ian0scmVxdWVzdDpmdW5jdGlvbih1cmksdHlwZSxhcmdzLGhlYWRlcnMpe3ZhciBjb3JzLGt4aHIscGF5bG9hZCxjYWNoZWQsY29udGVudFR5cGUsZG9jLGFiLGJsb2I7dHlwZT10eXBlfHwiR0VUIjtpZigocmVnZXgucHV0X3Bvc3QudGVzdCh0eXBlKXx8cmVnZXgucGF0Y2gudGVzdCh0eXBlKSkmJmFyZ3M9PT11bmRlZmluZWQpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO3VyaT11dGlsaXR5LnBhcnNlKHVyaSkuaHJlZjsKdHlwZT10eXBlLnRvTG93ZXJDYXNlKCk7aGVhZGVycz1oZWFkZXJzIGluc3RhbmNlb2YgT2JqZWN0P2hlYWRlcnM6bnVsbDtjb3JzPWNsaWVudC5jb3JzKHVyaSk7a3hocj1jbGllbnQua3hocighY2xpZW50LmllfHwoIWNvcnN8fGNsaWVudC52ZXJzaW9uPjkpP25ldyBYTUxIdHRwUmVxdWVzdDpuZXcgWERvbWFpblJlcXVlc3QpO3BheWxvYWQ9KHJlZ2V4LnB1dF9wb3N0LnRlc3QodHlwZSl8fHJlZ2V4LnBhdGNoLnRlc3QodHlwZSkpJiZhcmdzP2FyZ3M6bnVsbDtjYWNoZWQ9dHlwZT09PSJnZXQiP2NhY2hlLmdldCh1cmkpOmZhbHNlO2NvbnRlbnRUeXBlPW51bGw7ZG9jPXR5cGVvZiBEb2N1bWVudCE9InVuZGVmaW5lZCI7YWI9dHlwZW9mIEFycmF5QnVmZmVyIT0idW5kZWZpbmVkIjtibG9iPXR5cGVvZiBCbG9iIT0idW5kZWZpbmVkIjtpZihjb3JzJiZjbGllbnQuaWUmJmNsaWVudC52ZXJzaW9uPT09OSYmIXJlZ2V4Lnhkb21haW5yZXF1ZXN0LnRlc3QodHlwZSkpdGhyb3cgbmV3IEVycm9yKGxhYmVsLm5vdEF2YWlsYWJsZSk7Cmt4aHIub24oInJlYWR5c3RhdGVjaGFuZ2UiLGZ1bmN0aW9uKGV2KXtzd2l0Y2godGhpcy54aHIucmVhZHlTdGF0ZSl7Y2FzZSAxOnRoaXMuZGlzcGF0Y2goImJlZm9yZVhIUiIsdGhpcy54aHIsZXYpO2JyZWFrO2Nhc2UgNDp0aGlzLmRpc3BhdGNoKCJhZnRlclhIUiIsdGhpcy54aHIsZXYpO2JyZWFrfX0pO2lmKCFjb3JzJiYhcmVnZXguZ2V0X2hlYWRlcnMudGVzdCh0eXBlKSYmY2xpZW50LmFsbG93cyh1cmksdHlwZSk9PT1mYWxzZSl7dXRpbGl0eS5kZWxheShmdW5jdGlvbigpe2t4aHIuZGlzcGF0Y2goImJlZm9yZVhIUiIsa3hoci54aHIsbnVsbCk7a3hoci5kaXNwYXRjaCgiYWZ0ZXJYSFIiLGt4aHIueGhyLG51bGwpfSk7a3hoci54aHIuc3RhdHVzPTQwNTtreGhyLnJlamVjdChudWxsKX1pZih0eXBlPT09ImdldCImJkJvb2xlYW4oY2FjaGVkKSl7aWYoc2VydmVyKXtreGhyLnhoci5yZWFkeVN0YXRlPTQ7a3hoci54aHIuc3RhdHVzPTIwMDtreGhyLnhoci5fcmVzaGVhZGVycz0KY2FjaGVkLmhlYWRlcnN9dXRpbGl0eS5kZWxheShmdW5jdGlvbigpe2t4aHIuZGlzcGF0Y2goImJlZm9yZVhIUiIsa3hoci54aHIsbnVsbCk7a3hoci5kaXNwYXRjaCgiYWZ0ZXJYSFIiLGt4aHIueGhyLG51bGwpfSk7a3hoci5yZXNvbHZlKGNhY2hlZC5yZXNwb25zZSl9ZWxzZSB1dGlsaXR5LmRlbGF5KGZ1bmN0aW9uKCl7a3hoci54aHIub3Blbih0eXBlLnRvVXBwZXJDYXNlKCksdXJpLHRydWUpO2lmKGhlYWRlcnMhPT1udWxsJiZoZWFkZXJzLmhhc093blByb3BlcnR5KCJjb250ZW50LXR5cGUiKSljb250ZW50VHlwZT1oZWFkZXJzWyJjb250ZW50LXR5cGUiXTtpZihjb3JzJiZjb250ZW50VHlwZT09PW51bGwpY29udGVudFR5cGU9InRleHQvcGxhaW4iO2lmKHBheWxvYWQhPT1udWxsKXtpZihwYXlsb2FkLmhhc093blByb3BlcnR5KCJ4bWwiKSlwYXlsb2FkPXBheWxvYWQueG1sO2lmKGRvYyYmcGF5bG9hZCBpbnN0YW5jZW9mIERvY3VtZW50KXBheWxvYWQ9eG1sLmRlY29kZShwYXlsb2FkKTsKaWYodHlwZW9mIHBheWxvYWQ9PSJzdHJpbmciJiZyZWdleC5pc194bWwudGVzdChwYXlsb2FkKSljb250ZW50VHlwZT0iYXBwbGljYXRpb24veG1sIjtpZighKGFiJiZwYXlsb2FkIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpJiYhKGJsb2ImJnBheWxvYWQgaW5zdGFuY2VvZiBCbG9iKSYmIShwYXlsb2FkIGluc3RhbmNlb2YgQnVmZmVyKSYmcGF5bG9hZCBpbnN0YW5jZW9mIE9iamVjdCl7Y29udGVudFR5cGU9ImFwcGxpY2F0aW9uL2pzb24iO3BheWxvYWQ9anNvbi5lbmNvZGUocGF5bG9hZCl9aWYoY29udGVudFR5cGU9PT1udWxsJiYoYWImJnBheWxvYWQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcnx8YmxvYiYmcGF5bG9hZCBpbnN0YW5jZW9mIEJsb2IpKWNvbnRlbnRUeXBlPSJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iO2lmKGNvbnRlbnRUeXBlPT09bnVsbCljb250ZW50VHlwZT0iYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04In1pZighY2xpZW50LmllfHwKKCFjb3JzfHxjbGllbnQudmVyc2lvbj45KSl7aWYoaGVhZGVycz09PW51bGwpaGVhZGVycz17fTtpZih0eXBlb2YgY2FjaGVkPT0ib2JqZWN0IiYmY2FjaGVkLmhlYWRlcnMuaGFzT3duUHJvcGVydHkoImV0YWciKSloZWFkZXJzLmV0YWc9Y2FjaGVkLmhlYWRlcnMuZXRhZztpZihjb250ZW50VHlwZSE9PW51bGwpaGVhZGVyc1siY29udGVudC10eXBlIl09Y29udGVudFR5cGU7aWYoaGVhZGVycy5oYXNPd25Qcm9wZXJ0eSgiY2FsbGJhY2siKSlkZWxldGUgaGVhZGVycy5jYWxsYmFjaztoZWFkZXJzWyJ4LXJlcXVlc3RlZC13aXRoIl09IlhNTEh0dHBSZXF1ZXN0Ijt1dGlsaXR5Lml0ZXJhdGUoaGVhZGVycyxmdW5jdGlvbih2LGspe2lmKHYhPT1udWxsJiZrIT09IndpdGhDcmVkZW50aWFscyIpa3hoci54aHIuc2V0UmVxdWVzdEhlYWRlcihrLHYpfSk7aWYodHlwZW9mIGt4aHIueGhyLndpdGhDcmVkZW50aWFscz09ImJvb2xlYW4iJiZoZWFkZXJzIT09bnVsbCYmdHlwZW9mIGhlYWRlcnMud2l0aENyZWRlbnRpYWxzPT0KImJvb2xlYW4iKWt4aHIueGhyLndpdGhDcmVkZW50aWFscz1oZWFkZXJzLndpdGhDcmVkZW50aWFsc31reGhyLm9uKCJsb2FkIixmdW5jdGlvbigpe3ZhciBzZWxmPXRoaXMseGRyPWNsaWVudC5pZSYmdGhpcy54aHIucmVhZHlTdGF0ZT09PXVuZGVmaW5lZCxzaGFyZWQ9dHJ1ZSxvLHIsdCxyZWRpcmVjdDtpZigheGRyJiZ0aGlzLnhoci5yZWFkeVN0YXRlPT09NClzd2l0Y2godGhpcy54aHIuc3RhdHVzKXtjYXNlIDIwMDpjYXNlIDIwMTpjYXNlIDIwMjpjYXNlIDIwMzpjYXNlIDIwNDpjYXNlIDIwNTpjYXNlIDIwNjpvPWNsaWVudC5oZWFkZXJzKHRoaXMueGhyLHVyaSx0eXBlKTtpZih0eXBlPT09ImhlYWQiKXJldHVybiB0aGlzLnJlc29sdmUoby5oZWFkZXJzKTtlbHNlIGlmKHR5cGU9PT0ib3B0aW9ucyIpcmV0dXJuIHRoaXMucmVzb2x2ZShvLmhlYWRlcnMpO2Vsc2UgaWYodHlwZSE9PSJkZWxldGUiKXtpZihzZXJ2ZXImJnJlZ2V4LnByaXYudGVzdChvLmhlYWRlcnNbImNhY2hlLWNvbnRyb2wiXSkpc2hhcmVkPQpmYWxzZTtpZihyZWdleC5odHRwX2JvZHkudGVzdCh0aGlzLnhoci5zdGF0dXMpKXt0PW8uaGVhZGVyc1siY29udGVudC10eXBlIl18fCIiO3I9Y2xpZW50LnBhcnNlKHRoaXMueGhyLHQpO2lmKHI9PT11bmRlZmluZWQpdGhpcy5yZWplY3QobmV3IEVycm9yKGxhYmVsLnNlcnZlckVycm9yKSl9aWYodHlwZT09PSJnZXQiJiZzaGFyZWQpY2FjaGUuc2V0KHVyaSwicmVzcG9uc2UiLG8ucmVzcG9uc2U9dXRpbGl0eS5jbG9uZShyLHRydWUpKTtlbHNlIGNhY2hlLmV4cGlyZSh1cmksdHJ1ZSl9ZWxzZSBpZih0eXBlPT09ImRlbGV0ZSIpY2FjaGUuZXhwaXJlKHVyaSx0cnVlKTtzd2l0Y2godGhpcy54aHIuc3RhdHVzKXtjYXNlIDIwMDpjYXNlIDIwMjpjYXNlIDIwMzpjYXNlIDIwNjp0aGlzLnJlc29sdmUocik7YnJlYWs7Y2FzZSAyMDE6aWYoKG8uaGVhZGVycy5sb2NhdGlvbj09PXVuZGVmaW5lZHx8c3RyaW5nLmlzRW1wdHkoby5oZWFkZXJzLmxvY2F0aW9uKSkmJiFzdHJpbmcuaXNVcmwocikpdGhpcy5yZXNvbHZlKHIpOwplbHNle3JlZGlyZWN0PXN0cmluZy50cmltKG8uaGVhZGVycy5Mb2NhdGlvbnx8cik7Y2xpZW50LnJlcXVlc3QocmVkaXJlY3QpLnRoZW4oZnVuY3Rpb24oYXJnKXtzZWxmLnJlc29sdmUoYXJnKX0sZnVuY3Rpb24oZSl7c2VsZi5yZWplY3QoZSl9KX1icmVhaztjYXNlIDIwNDpjYXNlIDIwNTp0aGlzLnJlc29sdmUobnVsbCk7YnJlYWt9YnJlYWs7Y2FzZSAzMDQ6dGhpcy5yZXNvbHZlKHIpO2JyZWFrO2Nhc2UgNDAxOnRoaXMucmVqZWN0KG5ldyBFcnJvcih0aGlzLnhoci5yZXNwb25zZVRleHR8fGxhYmVsLnNlcnZlclVuYXV0aG9yaXplZCkpO2JyZWFrO2Nhc2UgNDAzOmNhY2hlLnNldCh1cmksIiFwZXJtaXNzaW9uIixjbGllbnQuYml0KFt0eXBlXSkpO3RoaXMucmVqZWN0KG5ldyBFcnJvcih0aGlzLnhoci5yZXNwb25zZVRleHR8fGxhYmVsLnNlcnZlckZvcmJpZGRlbikpO2JyZWFrO2Nhc2UgNDA1OmNhY2hlLnNldCh1cmksIiFwZXJtaXNzaW9uIixjbGllbnQuYml0KFt0eXBlXSkpOwp0aGlzLnJlamVjdChuZXcgRXJyb3IodGhpcy54aHIucmVzcG9uc2VUZXh0fHxsYWJlbC5zZXJ2ZXJJbnZhbGlkTWV0aG9kKSk7YnJlYWs7ZGVmYXVsdDp0aGlzLnJlamVjdChuZXcgRXJyb3IodGhpcy54aHIucmVzcG9uc2VUZXh0fHxsYWJlbC5zZXJ2ZXJFcnJvcikpfWVsc2UgaWYoeGRyKXtyPWNsaWVudC5wYXJzZSh0aGlzLnhociwidGV4dC9wbGFpbiIpO2NhY2hlLnNldCh1cmksInBlcm1pc3Npb24iLGNsaWVudC5iaXQoWyJnZXQiXSkpO2NhY2hlLnNldCh1cmksInJlc3BvbnNlIixyKTt0aGlzLnJlc29sdmUocil9fSk7a3hoci5vbigiZXJyb3IiLGZ1bmN0aW9uKGUpe3RoaXMucmVqZWN0KGUpfSk7a3hoci54aHIuc2VuZChwYXlsb2FkIT09bnVsbD9wYXlsb2FkOnVuZGVmaW5lZCl9KTtyZXR1cm4ga3hocn0sc2Nyb2xsOmZ1bmN0aW9uKGRlc3QsbXMpe3ZhciBkZWZlcj1kZWZlcnJlZCgpLHN0YXJ0PWNsaWVudC5zY3JvbGxQb3MoKSx0PTA7bXM9KCFpc05hTihtcyk/bXM6MjUwKS8KMTAwO3V0aWxpdHkucmVwZWF0KGZ1bmN0aW9uKCl7dmFyIHBvcz1tYXRoLmJlemllcihzdGFydFswXSxzdGFydFsxXSxkZXN0WzBdLGRlc3RbMV0sKyt0LzEwMCk7d2luZG93LnNjcm9sbFRvKHBvc1swXSxwb3NbMV0pO2lmKHQ9PT0xMDApe2RlZmVyLnJlc29sdmUodHJ1ZSk7cmV0dXJuIGZhbHNlfX0sbXMsInNjcm9sbGluZyIpO3JldHVybiBkZWZlcn0sc2Nyb2xsUG9zOmZ1bmN0aW9uKCl7cmV0dXJuW3dpbmRvdy5zY3JvbGxYfHwwLHdpbmRvdy5zY3JvbGxZfHwwXX19O3ZhciBjc3Y9e2RlY29kZTpmdW5jdGlvbihhcmcsZGVsaW1pdGVyKXtkZWxpbWl0ZXI9ZGVsaW1pdGVyfHwiLCI7dmFyIHJlZ2V4PW5ldyBSZWdFeHAoZGVsaW1pdGVyKycoPz0oPzpbXiJdfCIoPzpbXiJdKVteIl0qIikqJCknKSxyb3dzPXN0cmluZy50cmltKGFyZykuc3BsaXQoIlxuIiksa2V5cz1yb3dzLnNoaWZ0KCkuc3BsaXQoZGVsaW1pdGVyKSxyZXN1bHQ9W10sbnRoPXJvd3MubGVuZ3RoLHg9a2V5cy5sZW5ndGgsCmk9LTEsbixvYmoscm93O3doaWxlKCsraTxudGgpe29iaj17fTtyb3c9cm93c1tpXS5zcGxpdChyZWdleCk7bj0tMTt3aGlsZSgrK248eClvYmpba2V5c1tuXV09dXRpbGl0eS5jb2VyY2UoKHJvd1tuXXx8IiIpLnJlcGxhY2UoL14ifCIkL2csIiIpKTtyZXN1bHQucHVzaChvYmopfXJldHVybiByZXN1bHR9LGVuY29kZTpmdW5jdGlvbihhcmcsZGVsaW1pdGVyLGhlYWRlcil7dmFyIG9iaj1qc29uLmRlY29kZShhcmcsdHJ1ZSl8fGFyZyxyZXN1bHQ9IiI7ZGVsaW1pdGVyPWRlbGltaXRlcnx8IiwiO2hlYWRlcj1oZWFkZXIhPT1mYWxzZTtmdW5jdGlvbiBwcmVwYXJlKGlucHV0KXt2YXIgb3V0cHV0O2lmKGlucHV0IGluc3RhbmNlb2YgQXJyYXkpe291dHB1dD0nIicraW5wdXQudG9TdHJpbmcoKSsnIic7aWYocmVnZXgub2JqZWN0X3R5cGUudGVzdChvdXRwdXQpKW91dHB1dD0nIicrY3N2LmVuY29kZShpbnB1dCxkZWxpbWl0ZXIpKyciJ31lbHNlIGlmKGlucHV0IGluc3RhbmNlb2YgT2JqZWN0KW91dHB1dD0KJyInK2Nzdi5lbmNvZGUoaW5wdXQsZGVsaW1pdGVyKSsnIic7ZWxzZSBpZihyZWdleC5jc3ZfcXVvdGUudGVzdChpbnB1dCkpb3V0cHV0PSciJytpbnB1dC5yZXBsYWNlKC8iL2csJyIiJykrJyInO2Vsc2Ugb3V0cHV0PWlucHV0O3JldHVybiBvdXRwdXR9aWYob2JqIGluc3RhbmNlb2YgQXJyYXkpaWYob2JqWzBdaW5zdGFuY2VvZiBPYmplY3Qpe2lmKGhlYWRlcilyZXN1bHQ9YXJyYXkua2V5cyhvYmpbMF0pLmpvaW4oZGVsaW1pdGVyKSsiXG4iO3Jlc3VsdCs9b2JqLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gY3N2LmVuY29kZShpLGRlbGltaXRlcixmYWxzZSl9KS5qb2luKCJcbiIpfWVsc2UgcmVzdWx0Kz1wcmVwYXJlKG9iaixkZWxpbWl0ZXIpKyJcbiI7ZWxzZXtpZihoZWFkZXIpcmVzdWx0PWFycmF5LmtleXMob2JqKS5qb2luKGRlbGltaXRlcikrIlxuIjtyZXN1bHQrPWFycmF5LmNhc3Qob2JqKS5tYXAocHJlcGFyZSkuam9pbihkZWxpbWl0ZXIpKyJcbiJ9cmV0dXJuIHJlc3VsdC5yZXBsYWNlKHJlZ2V4LmVvbF9ubCwKIiIpfX07dmFyIGZpbHRlcj17ZmFjdG9yeTpmdW5jdGlvbih0YXJnZXQsbGlzdCxmaWx0ZXJzLGRlYm91bmNlKXt2YXIgcmVmPVtsaXN0XSxvYmo7ZGVib3VuY2U9ZGVib3VuY2V8fDI1MDtpZighKHRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQpfHxsaXN0JiYhbGlzdC5zdG9yZXx8KHR5cGVvZiBmaWx0ZXJzIT0ic3RyaW5nInx8c3RyaW5nLmlzRW1wdHkoZmlsdGVycykpKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTtvYmo9KG5ldyBEYXRhTGlzdEZpbHRlcih0YXJnZXQscmVmWzBdLGRlYm91bmNlKSkuc2V0KGZpbHRlcnMpO2VsZW1lbnQuYXR0cih0YXJnZXQsInR5cGUiLCJ0ZXh0Iik7b2JqLm9ic2VydmVyLmhvb2sob2JqLmVsZW1lbnQsImtleXVwIik7b2JqLm9ic2VydmVyLmhvb2sob2JqLmVsZW1lbnQsImlucHV0Iik7b2JqLm9uKCJrZXl1cCIsb2JqLnVwZGF0ZSwia2V5dXAiKTtvYmoub24oImlucHV0IixvYmoudXBkYXRlLCJpbnB1dCIpO3JldHVybiBvYmp9fTsKZnVuY3Rpb24gRGF0YUxpc3RGaWx0ZXIoZWxlbWVudCxsaXN0LGRlYm91bmNlKXt0aGlzLmRlYm91bmNlPWRlYm91bmNlO3RoaXMuZWxlbWVudD1lbGVtZW50O3RoaXMuZmlsdGVycz17fTt0aGlzLmxpc3Q9bGlzdDt0aGlzLm9ic2VydmVyPW9ic2VydmFibGUuZmFjdG9yeSgpfURhdGFMaXN0RmlsdGVyLnByb3RvdHlwZT1iYXNlLmZhY3RvcnkoKTtEYXRhTGlzdEZpbHRlci5wcm90b3R5cGUuY29uc3RydWN0b3I9RGF0YUxpc3RGaWx0ZXI7RGF0YUxpc3RGaWx0ZXIucHJvdG90eXBlLnNldD1mdW5jdGlvbihmaWVsZHMpe3ZhciBvYmo9e307YXJyYXkuZWFjaChzdHJpbmcuZXhwbG9kZShmaWVsZHMpLGZ1bmN0aW9uKHYpe29ialt2XT0iIn0pO3RoaXMuZmlsdGVycz1vYmo7cmV0dXJuIHRoaXN9O0RhdGFMaXN0RmlsdGVyLnByb3RvdHlwZS50ZWFyZG93bj1mdW5jdGlvbigpe3RoaXMub2JzZXJ2ZXIudW5ob29rKHRoaXMuZWxlbWVudCwia2V5dXAiKTt0aGlzLm9ic2VydmVyLnVuaG9vayh0aGlzLmVsZW1lbnQsCiJpbnB1dCIpO3JldHVybiB0aGlzfTtEYXRhTGlzdEZpbHRlci5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczt1dGlsaXR5LmRlZmVyKGZ1bmN0aW9uKCl7dmFyIHZhbD1lbGVtZW50LnZhbChzZWxmLmVsZW1lbnQpLnRvU3RyaW5nKCk7c2VsZi5saXN0LmRpc3BhdGNoKCJiZWZvcmVGaWx0ZXIiLHNlbGYuZWxlbWVudCx2YWwpO2lmKCFzdHJpbmcuaXNFbXB0eSh2YWwpKXt1dGlsaXR5Lml0ZXJhdGUoc2VsZi5maWx0ZXJzLGZ1bmN0aW9uKHYsayl7dmFyIHF1ZXJpZXM9c3RyaW5nLmV4cGxvZGUodmFsKTtxdWVyaWVzPXF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiFzdHJpbmcuaXNFbXB0eShpKX0pO2FycmF5LmVhY2gocXVlcmllcyxmdW5jdGlvbihpLGlkeCl7dGhpc1tpZHhdPSJeLioiK3N0cmluZy5lc2NhcGUoaSkucmVwbGFjZSgvKF5cKnxcKiQpL2csIiIpLnJlcGxhY2UoL1wqL2csIi4qIikrIi4qIn0pO3RoaXNba109cXVlcmllcy5qb2luKCIsIil9KTsKc2VsZi5saXN0LmZpbHRlcj1zZWxmLmZpbHRlcnN9ZWxzZSBzZWxmLmxpc3QuZmlsdGVyPW51bGw7c2VsZi5saXN0LnBhZ2VJbmRleD0xO3NlbGYubGlzdC5yZWZyZXNoKCk7c2VsZi5saXN0LmRpc3BhdGNoKCJhZnRlckZpbHRlciIsc2VsZi5lbGVtZW50KX0sdGhpcy5kZWJvdW5jZSx0aGlzLmVsZW1lbnQuaWQrIkRlYm91bmNlIik7cmV0dXJuIHRoaXN9O3ZhciBncmlkPXtmYWN0b3J5OmZ1bmN0aW9uKHRhcmdldCxzdG9yZSxmaWVsZHMsc29ydGFibGUsb3B0aW9ucyxmaWx0ZXJlZCxkZWJvdW5jZSl7dmFyIHJlZj1bc3RvcmVdLG9iaix0ZW1wbGF0ZSxoZWFkZXIsd2lkdGgsY3NzLHNvcnQ7b2JqPW5ldyBEYXRhR3JpZCh0YXJnZXQscmVmWzBdLGZpZWxkcyxzb3J0YWJsZSxvcHRpb25zLGZpbHRlcmVkKTt0ZW1wbGF0ZT0iIjtoZWFkZXI9ZWxlbWVudC5jcmVhdGUoImxpIix7fSxlbGVtZW50LmNyZWF0ZSgidWwiLHsiY2xhc3MiOiJoZWFkZXIifSxvYmouZWxlbWVudCkpO3dpZHRoPQoxMDAvb2JqLmZpZWxkcy5sZW5ndGgrIiUiO2Nzcz0iZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6Iit3aWR0aDtzb3J0PW9iai5vcHRpb25zLm9yZGVyP3N0cmluZy5leHBsb2RlKG9iai5vcHRpb25zLm9yZGVyKTpbXTthcnJheS5lYWNoKG9iai5maWVsZHMsZnVuY3Rpb24oaSl7dmFyIHRyaW1tZWQ9aS5yZXBsYWNlKC8uKlwuL2csIiIpLGVsPWVsZW1lbnQuY3JlYXRlKCJzcGFuIix7aW5uZXJIVE1MOnN0cmluZy5jYXBpdGFsaXplKHN0cmluZy51bkNhbWVsQ2FzZShzdHJpbmcudW5oeXBoZW5hdGUodHJpbW1lZCx0cnVlKSkucmVwbGFjZSgvX3wtL2csIiAiKSx0cnVlKSxzdHlsZTpjc3MsImRhdGEtZmllbGQiOml9LGhlYWRlcik7aWYoYXJyYXkuY29udGFpbnMob2JqLnNvcnRhYmxlLGkpKXtlbGVtZW50LmtsYXNzKGVsLCJzb3J0YWJsZSIsdHJ1ZSk7aWYoc29ydC5maWx0ZXIoZnVuY3Rpb24oeCl7cmV0dXJuIHguaW5kZXhPZihpKT09PTB9KS5sZW5ndGg+MCllbGVtZW50LmRhdGEoZWwsCiJzb3J0IixhcnJheS5jb250YWlucyhzb3J0LGkrIiBkZXNjIik/ImRlc2MiOiJhc2MiKX10ZW1wbGF0ZSs9JzxzcGFuIGNsYXNzPSInK2krJyIgZGF0YS1maWVsZD0iJytpKyciIHN0eWxlPSInK2NzcysnIj57eycraSsifX08L3NwYW4+In0pO2lmKG9iai5zb3J0YWJsZS5sZW5ndGg+MClvYmoub2JzZXJ2ZXIuaG9vayhoZWFkZXIucGFyZW50Tm9kZSwiY2xpY2siLG9iai5zb3J0LCJzb3J0IixvYmopO3JlZi5wdXNoKGxpc3QuZmFjdG9yeShvYmouZWxlbWVudCxyZWZbMF0sdGVtcGxhdGUsb2JqLm9wdGlvbnMpKTtvYmoubGlzdD1yZWZbMV07aWYob2JqLmZpbHRlcmVkPT09dHJ1ZSl7cmVmLnB1c2goZmlsdGVyLmZhY3RvcnkoZWxlbWVudC5jcmVhdGUoImlucHV0Iix7ImNsYXNzIjoiZmlsdGVyIixwbGFjZWhvbGRlcjoiRmlsdGVyIn0sb2JqLmVsZW1lbnQsImZpcnN0IikscmVmWzFdLG9iai5maWVsZHMuam9pbigiLCIpLGRlYm91bmNlfHwyNTApKTtvYmouZmlsdGVyPXJlZlsyXX1vYmoub24oImJlZm9yZVJlZnJlc2giLApmdW5jdGlvbihhcmcpe2VsZW1lbnQuZGlzcGF0Y2goYXJnLCJiZWZvcmVSZWZyZXNoIil9LCJidWJibGUiKTtvYmoub24oImFmdGVyUmVmcmVzaCIsZnVuY3Rpb24oYXJnKXtlbGVtZW50LmRpc3BhdGNoKGFyZywiYWZ0ZXJSZWZyZXNoIil9LCJidWJibGUiKTtvYmoub24oImNsaWNrIixmdW5jdGlvbihlKXtpZihlbGVtZW50Lmhhc0NsYXNzKGUuY3VycmVudFRhcmdldCwiaGVhZGVyIikpb2JqLnNvcnQoZSl9LCJoZWFkZXIiKTtvYmoubGlzdC5vbigiY2hhbmdlIixmdW5jdGlvbigpe29iai5kaXNwYXRjaC5hcHBseShvYmosWyJjaGFuZ2UiXS5jb25jYXQoYXJyYXkuY2FzdChhcmd1bWVudHMpKSl9LCJjaGFuZ2UiKTtvYmoubGlzdC5vbigiYmVmb3JlRmlsdGVyIixmdW5jdGlvbigpe29iai5kaXNwYXRjaC5hcHBseShvYmosWyJiZWZvcmVGaWx0ZXIiXS5jb25jYXQoYXJyYXkuY2FzdChhcmd1bWVudHMpKSl9LCJiZWZvcmVGaWx0ZXIiKTtvYmoubGlzdC5vbigiYWZ0ZXJGaWx0ZXIiLApmdW5jdGlvbigpe29iai5kaXNwYXRjaC5hcHBseShvYmosWyJhZnRlckZpbHRlciJdLmNvbmNhdChhcnJheS5jYXN0KGFyZ3VtZW50cykpKX0sImFmdGVyRmlsdGVyIik7cmV0dXJuIG9ian19O2Z1bmN0aW9uIERhdGFHcmlkKHRhcmdldCxzdG9yZSxmaWVsZHMsc29ydGFibGUsb3B0aW9ucyxmaWx0ZXJlZCl7dmFyIHNvcnRPcmRlcjtpZihvcHRpb25zLm9yZGVyJiYhc3RyaW5nLmlzRW1wdHkob3B0aW9ucy5vcmRlcikpc29ydE9yZGVyPXN0cmluZy5leHBsb2RlKG9wdGlvbnMub3JkZXIpLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5yZXBsYWNlKHJlZ2V4LmFmdGVyX3NwYWNlLCIiKX0pO3RoaXMuZWxlbWVudD1lbGVtZW50LmNyZWF0ZSgic2VjdGlvbiIseyJjbGFzcyI6ImdyaWQifSx0YXJnZXQpO3RoaXMuZmllbGRzPWZpZWxkczt0aGlzLmZpbHRlcj1udWxsO3RoaXMuZmlsdGVyZWQ9ZmlsdGVyZWQ9PT10cnVlO3RoaXMubGlzdD1udWxsO3RoaXMub2JzZXJ2ZXI9b2JzZXJ2YWJsZS5mYWN0b3J5KCk7CnRoaXMub3B0aW9ucz1vcHRpb25zfHx7fTt0aGlzLnN0b3JlPXN0b3JlO3RoaXMuc29ydGFibGU9c29ydGFibGV8fFtdO3RoaXMuc29ydE9yZGVyPXNvcnRPcmRlcnx8c29ydGFibGV8fFtdfURhdGFHcmlkLnByb3RvdHlwZT1iYXNlLmZhY3RvcnkoKTtEYXRhR3JpZC5wcm90b3R5cGUuY29uc3RydWN0b3I9RGF0YUdyaWQ7RGF0YUdyaWQucHJvdG90eXBlLmFkZD1mdW5jdGlvbihyZWNvcmQpe3ZhciBzZWxmPXRoaXM7dGhpcy5zdG9yZS5zZXQobnVsbCxyZWNvcmQpLnRoZW4obnVsbCxmdW5jdGlvbihlKXt1dGlsaXR5LmVycm9yKGUpO3NlbGYuZGlzcGF0Y2goImVycm9yIixlKX0pO3JldHVybiB0aGlzfTtEYXRhR3JpZC5wcm90b3R5cGUuZHVtcD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN0b3JlLmR1bXAodGhpcy5saXN0LnJlY29yZHMsdGhpcy5maWVsZHMpfTtEYXRhR3JpZC5wcm90b3R5cGUucmVmcmVzaD1mdW5jdGlvbigpe3ZhciBzb3J0PVtdLHNlbGY9dGhpczt0aGlzLmRpc3BhdGNoKCJiZWZvcmVSZWZyZXNoIiwKdGhpcy5lbGVtZW50KTtpZih0aGlzLnNvcnRPcmRlci5sZW5ndGg+MCl7YXJyYXkuZWFjaCh0aGlzLnNvcnRPcmRlcixmdW5jdGlvbihpKXt2YXIgb2JqPWVsZW1lbnQuZmluZChzZWxmLmVsZW1lbnQsIi5oZWFkZXIgc3BhbltkYXRhLWZpZWxkPSciK2krIiddIilbMF07c29ydC5wdXNoKHN0cmluZy50cmltKGkrIiAiKyhlbGVtZW50LmRhdGEob2JqLCJzb3J0Iil8fCIiKSkpfSk7dGhpcy5vcHRpb25zLm9yZGVyPXRoaXMubGlzdC5vcmRlcj1zb3J0LmpvaW4oIiwgIil9dGhpcy5saXN0LndoZXJlPW51bGw7dXRpbGl0eS5tZXJnZSh0aGlzLmxpc3QsdGhpcy5vcHRpb25zKTt0aGlzLmxpc3QucmVmcmVzaCgpO3RoaXMuZGlzcGF0Y2goImFmdGVyUmVmcmVzaCIsdGhpcy5lbGVtZW50KTtyZXR1cm4gdGhpc307RGF0YUdyaWQucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihyZWNvcmQpe3ZhciBzZWxmPXRoaXM7dGhpcy5zdG9yZS5kZWwocmVjb3JkKS50aGVuKG51bGwsZnVuY3Rpb24oZSl7dXRpbGl0eS5lcnJvcihlKTsKc2VsZi5kaXNwYXRjaCgiZXJyb3IiLGUpfSk7cmV0dXJuIHRoaXN9O0RhdGFHcmlkLnByb3RvdHlwZS5zb3J0PWZ1bmN0aW9uKGV2KXt2YXIgdGFyZ2V0PXV0aWxpdHkudGFyZ2V0KGV2KSxmaWVsZDt1dGlsaXR5LnN0b3AoZXYpO2lmKGVsZW1lbnQuaGFzQ2xhc3ModGFyZ2V0LCJzb3J0YWJsZSIpKXtmaWVsZD1lbGVtZW50LmRhdGEodGFyZ2V0LCJmaWVsZCIpO2VsZW1lbnQuZGF0YSh0YXJnZXQsInNvcnQiLGVsZW1lbnQuZGF0YSh0YXJnZXQsInNvcnQiKT09PSJhc2MiPyJkZXNjIjoiYXNjIik7YXJyYXkucmVtb3ZlKHRoaXMuc29ydE9yZGVyLGZpZWxkKTt0aGlzLnNvcnRPcmRlci5zcGxpY2UoMCwwLGZpZWxkKTt0aGlzLnJlZnJlc2goKX1yZXR1cm4gdGhpc307RGF0YUdyaWQucHJvdG90eXBlLnRlYXJkb3duPWZ1bmN0aW9uKCl7aWYodGhpcy5maWx0ZXIhPT1udWxsKXt0aGlzLmZpbHRlci50ZWFyZG93bigpO3RoaXMuZmlsdGVyPW51bGx9dGhpcy5saXN0LnRlYXJkb3duKCk7CnRoaXMub2JzZXJ2ZXIudW5ob29rKGVsZW1lbnQuZmluZCh0aGlzLmVsZW1lbnQsIi5oZWFkZXIiKVswXSwiY2xpY2siKTtlbGVtZW50LmRlc3Ryb3kodGhpcy5lbGVtZW50KTt0aGlzLmVsZW1lbnQ9bnVsbDtyZXR1cm4gdGhpc307RGF0YUdyaWQucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbihrZXksZGF0YSl7dmFyIHNlbGY9dGhpczt0aGlzLnN0b3JlLnVwZGF0ZShrZXksZGF0YSkudGhlbihudWxsLGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSk7c2VsZi5kaXNwYXRjaCgiZXJyb3IiLGUpfSk7cmV0dXJuIHRoaXN9O3ZhciBsaXN0PXtmYWN0b3J5OmZ1bmN0aW9uKHRhcmdldCxzdG9yZSx0ZW1wbGF0ZSxvcHRpb25zKXt2YXIgcmVmPVtzdG9yZV0sb2JqO2lmKCEodGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudCl8fHR5cGVvZiBzdG9yZSE9Im9iamVjdCJ8fCFyZWdleC5zdHJpbmdfb2JqZWN0LnRlc3QodHlwZW9mIHRlbXBsYXRlKSl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7Cm9iaj1uZXcgRGF0YUxpc3QoZWxlbWVudC5jcmVhdGUoInVsIix7ImNsYXNzIjoibGlzdCJ9LHRhcmdldCkscmVmWzBdLHRlbXBsYXRlKTtpZihvcHRpb25zIGluc3RhbmNlb2YgT2JqZWN0KXtpZihvcHRpb25zLmxpc3RGaWx0ZXJlZCYmb3B0aW9ucy5saXN0RmlsdGVyKXtvYmoubGlzdEZpbHRlcj1maWx0ZXIuZmFjdG9yeShlbGVtZW50LmNyZWF0ZSgiaW5wdXQiLHsiaWQiOm9iai5lbGVtZW50LmlkKyItZmlsdGVyIiwiY2xhc3MiOiJmaWx0ZXIiLHBsYWNlaG9sZGVyOiJGaWx0ZXIifSx0YXJnZXQsImZpcnN0Iiksb2JqLG9wdGlvbnMubGlzdEZpbHRlcixvcHRpb25zLmRlYm91bmNlfHwyNTApO2RlbGV0ZSBvcHRpb25zLmxpc3RGaWx0ZXI7ZGVsZXRlIG9wdGlvbnMubGlzdEZpbHRlcmVkfXV0aWxpdHkubWVyZ2Uob2JqLG9wdGlvbnMpfW9iai5zdG9yZS5saXN0cy5wdXNoKG9iaik7b2JqLm9uKCJiZWZvcmVSZWZyZXNoIixmdW5jdGlvbihhcmcpe2VsZW1lbnQuZGlzcGF0Y2goYXJnLAoiYmVmb3JlUmVmcmVzaCIpfSwiYnViYmxlIik7b2JqLm9uKCJhZnRlclJlZnJlc2giLGZ1bmN0aW9uKGFyZyl7ZWxlbWVudC5kaXNwYXRjaChhcmcsImFmdGVyUmVmcmVzaCIpfSwiYnViYmxlIik7b2JqLm9uKCJjaGFuZ2UiLGZ1bmN0aW9uKGFyZyl7ZWxlbWVudC5kaXNwYXRjaChvYmouZWxlbWVudCwiY2hhbmdlIixhcmcpfSwiY2hhbmdlIik7b2JqLm9uKCJjbGljayIsZnVuY3Rpb24oZSl7dmFyIHRhcmdldD11dGlsaXR5LnRhcmdldChlKSxwYWdlO3V0aWxpdHkuc3RvcChlKTtpZih0YXJnZXQubm9kZU5hbWU9PT0iQSIpe3BhZ2U9ZWxlbWVudC5kYXRhKHRhcmdldCwicGFnZSIpO2lmKCFpc05hTihwYWdlKSlvYmoucGFnZShwYWdlKX19LCJwYWdpbmF0aW9uIik7aWYodHlwZW9mIE11dGF0aW9uT2JzZXJ2ZXI9PSJmdW5jdGlvbiIpe29iai5tdXRhdGlvbj1uZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihhcmcpe29iai5kaXNwYXRjaCgiY2hhbmdlIixhcmcpfSk7b2JqLm11dGF0aW9uLm9ic2VydmUob2JqLmVsZW1lbnQsCntjaGlsZExpc3Q6dHJ1ZSxzdWJ0cmVlOnRydWV9KX1pZihvYmouc3RvcmUudXJpPT09bnVsbHx8b2JqLnN0b3JlLmxvYWRlZClvYmoucmVmcmVzaCgpO3JldHVybiBvYmp9LHBhZ2VzOmZ1bmN0aW9uKCl7aWYoaXNOYU4odGhpcy5wYWdlU2l6ZSkpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO3JldHVybiBNYXRoLmNlaWwoKCF0aGlzLmZpbHRlcj90aGlzLnRvdGFsOnRoaXMuZmlsdGVyZWQubGVuZ3RoKS90aGlzLnBhZ2VTaXplKX0scmFuZ2U6ZnVuY3Rpb24oKXt2YXIgc3RhcnQ9dGhpcy5wYWdlSW5kZXgqdGhpcy5wYWdlU2l6ZS10aGlzLnBhZ2VTaXplLGVuZD10aGlzLnBhZ2VTaXplO3JldHVybltzdGFydCxlbmRdfX07ZnVuY3Rpb24gRGF0YUxpc3QoZWxlbWVudCxzdG9yZSx0ZW1wbGF0ZSl7dGhpcy5jYWxsYmFjaz1udWxsO3RoaXMuY3VycmVudD1bXTt0aGlzLmVsZW1lbnQ9ZWxlbWVudDt0aGlzLmVtcHR5TXNnPWxhYmVsLm5vRGF0YTt0aGlzLmZpbHRlcj0KbnVsbDt0aGlzLmZpbHRlcmVkPVtdO3RoaXMuaWQ9dXRpbGl0eS5nZW5JZCgpO3RoaXMuaXRlbXM9W107dGhpcy5saXN0RmlsdGVyPW51bGw7dGhpcy5tdXRhdGlvbj1udWxsO3RoaXMub2JzZXJ2ZXI9b2JzZXJ2YWJsZS5mYWN0b3J5KCk7dGhpcy5wYWdlSW5kZXg9MTt0aGlzLnBhZ2VTaXplPW51bGw7dGhpcy5wYWdlUmFuZ2U9NTt0aGlzLnBhZ2luYXRpb249ImJvdHRvbSI7dGhpcy5wbGFjZWhvbGRlcj0iIjt0aGlzLm9yZGVyPSIiO3RoaXMucmVjb3Jkcz1bXTt0aGlzLnRlbXBsYXRlPXRlbXBsYXRlO3RoaXMudG90YWw9MDt0aGlzLnN0b3JlPXN0b3JlO3RoaXMud2hlcmU9bnVsbH1EYXRhTGlzdC5wcm90b3R5cGU9YmFzZS5mYWN0b3J5KCk7RGF0YUxpc3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPURhdGFMaXN0O0RhdGFMaXN0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24ocmVjb3JkKXt2YXIgc2VsZj10aGlzO3RoaXMuc3RvcmUuc2V0KG51bGwscmVjb3JkKS50aGVuKG51bGwsZnVuY3Rpb24oZSl7dXRpbGl0eS5lcnJvcihlKTsKc2VsZi5kaXNwYXRjaCgiZXJyb3IiLGUpfSk7cmV0dXJuIHRoaXN9O0RhdGFMaXN0LnByb3RvdHlwZS5kdW1wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RvcmUuZHVtcCh0aGlzLnJlY29yZHMpfTtEYXRhTGlzdC5wcm90b3R5cGUucGFnZT1mdW5jdGlvbihuKXt0aGlzLnBhZ2VJbmRleD1uO3JldHVybiB0aGlzLnJlZnJlc2goKX07RGF0YUxpc3QucHJvdG90eXBlLnBhZ2VzPWZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcyxvYmo9dGhpcy5lbGVtZW50LHBhZ2U9dGhpcy5wYWdlSW5kZXgscG9zPXRoaXMucGFnaW5hdGlvbixyYW5nZT10aGlzLnBhZ2VSYW5nZSxtaWQ9TWF0aC5mbG9vcihyYW5nZS8yKSxzdGFydD1wYWdlLW1pZCxlbmQ9cGFnZSttaWQsdG90YWw9bGlzdC5wYWdlcy5jYWxsKHRoaXMpLGRpZmY7aWYoIXJlZ2V4LnRvcF9ib3R0b20udGVzdChwb3MpKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTthcnJheS5lYWNoKHV0aWxpdHkuZG9tKCIjIitvYmouaWQrCiItcGFnZXMtdG9wLCAjIitvYmouaWQrIi1wYWdlcy1ib3R0b20iKSxmdW5jdGlvbihpKXtpZihpKXtzZWxmLm9ic2VydmVyLnVuaG9vayhpLCJjbGljayIpO2VsZW1lbnQuZGVzdHJveShpKX19KTtpZih0aGlzLmZpbHRlciYmdGhpcy5maWx0ZXJlZC5sZW5ndGg9PT0wfHx0aGlzLnRvdGFsPT09MHx8dG90YWw9PT0xKXJldHVybiB0aGlzO2lmKHN0YXJ0PDEpe2RpZmY9bnVtYmVyLmRpZmYoc3RhcnQsMSk7c3RhcnQ9c3RhcnQrZGlmZjtlbmQ9ZW5kK2RpZmZ9aWYoZW5kPnRvdGFsKXtlbmQ9dG90YWw7c3RhcnQ9ZW5kLXJhbmdlKzE7aWYoc3RhcnQ8MSlzdGFydD0xfWlmKG51bWJlci5kaWZmKHN0YXJ0LGVuZCk+PXJhbmdlKS0tZW5kO2FycmF5LmVhY2goc3RyaW5nLmV4cGxvZGUocG9zKSxmdW5jdGlvbihpKXt2YXIgY3VycmVudD1mYWxzZSxtb3JlPXBhZ2U+MSxuZXh0PXBhZ2UrMTw9dG90YWwsbGFzdD1wYWdlPj10b3RhbCxlbCxuO2VsPWVsZW1lbnQuY3JlYXRlKCJ1bCIseyJjbGFzcyI6Imxpc3QgcGFnZXMgaGlkZGVuICIrCmksaWQ6b2JqLmlkKyItcGFnZXMtIitpfSxvYmosaT09PSJib3R0b20iPyJhZnRlciI6ImJlZm9yZSIpO2VsZW1lbnQuY3JlYXRlKG1vcmU/ImEiOiJzcGFuIix7ImNsYXNzIjoiZmlyc3QgcGFnZSIsImRhdGEtcGFnZSI6MSxpbm5lckhUTUw6IiZsdDsmbHQ7In0sZWxlbWVudC5jcmVhdGUoImxpIix7fSxlbCkpO2VsZW1lbnQuY3JlYXRlKG1vcmU/ImEiOiJzcGFuIix7ImNsYXNzIjoicHJldiBwYWdlIiwiZGF0YS1wYWdlIjpwYWdlLTEsaW5uZXJIVE1MOiImbHQ7In0sZWxlbWVudC5jcmVhdGUoImxpIix7fSxlbCkpO2ZvcihuPXN0YXJ0O248PWVuZDtuKyspe2N1cnJlbnQ9bj09PXBhZ2U7ZWxlbWVudC5jcmVhdGUoY3VycmVudD8ic3BhbiI6ImEiLHsiY2xhc3MiOmN1cnJlbnQ/ImN1cnJlbnQgcGFnZSI6InBhZ2UiLCJkYXRhLXBhZ2UiOm4saW5uZXJIVE1MOm59LGVsZW1lbnQuY3JlYXRlKCJsaSIse30sZWwpKX1lbGVtZW50LmNyZWF0ZShuZXh0PyJhIjoic3BhbiIseyJjbGFzcyI6Im5leHQgcGFnZSIsCiJkYXRhLXBhZ2UiOm5leHQ/cGFnZSsxOm51bGwsaW5uZXJIVE1MOiImZ3Q7In0sZWxlbWVudC5jcmVhdGUoImxpIix7fSxlbCkpO2VsZW1lbnQuY3JlYXRlKGxhc3Q/InNwYW4iOiJhIix7ImNsYXNzIjoibGFzdCBwYWdlIiwiZGF0YS1wYWdlIjpsYXN0P251bGw6dG90YWwsaW5uZXJIVE1MOiImZ3Q7Jmd0OyJ9LGVsZW1lbnQuY3JlYXRlKCJsaSIse30sZWwpKTtlbGVtZW50LmtsYXNzKGVsLCJoaWRkZW4iLGZhbHNlKTtzZWxmLm9ic2VydmVyLmhvb2soZWwsImNsaWNrIil9KTtyZXR1cm4gdGhpc307RGF0YUxpc3QucHJvdG90eXBlLnJlZnJlc2g9ZnVuY3Rpb24oY3JlYXRlKXt2YXIgc2VsZj10aGlzLGVsPXRoaXMuZWxlbWVudCx0ZW1wbGF0ZT10eXBlb2YgdGhpcy50ZW1wbGF0ZT09Im9iamVjdCIsZmlsdGVyPXRoaXMuZmlsdGVyIT09bnVsbCxpdGVtcz1bXSxjYWxsYmFjaz10eXBlb2YgdGhpcy5jYWxsYmFjaz09ImZ1bmN0aW9uIixyZWc9bmV3IFJlZ0V4cCxyZWdpc3RyeT1bXSwKcmFuZ2U9W10sZm4sY2VpbGluZyxuZXh0O2NyZWF0ZT1jcmVhdGU9PT10cnVlO3RoaXMuZGlzcGF0Y2goImJlZm9yZVJlZnJlc2giLGVsKTtpZighdGVtcGxhdGUpZm49ZnVuY3Rpb24oaSl7dmFyIGh0bWw9c2VsZi50ZW1wbGF0ZSxpdGVtcz1hcnJheS51bmlxdWUoaHRtbC5tYXRjaCgvXHtce1tcd1wuXC1cW1xdXStcfVx9L2cpKTtodG1sPWh0bWwucmVwbGFjZSgie3siK3NlbGYuc3RvcmUua2V5KyJ9fSIsaS5rZXkpO2FycmF5LmVhY2goaXRlbXMsZnVuY3Rpb24oYXR0cil7dmFyIGtleT1hdHRyLnJlcGxhY2UoL1x7XHt8XH1cfS9nLCIiKSx2YWx1ZT11dGlsaXR5LndhbGsoaS5kYXRhLGtleSk7aWYodmFsdWU9PT11bmRlZmluZWQpdmFsdWU9IiI7cmVnLmNvbXBpbGUoc3RyaW5nLmVzY2FwZShhdHRyKSwiZyIpO2h0bWw9aHRtbC5yZXBsYWNlKHJlZyx2YWx1ZSl9KTtodG1sPWh0bWwucmVwbGFjZSgvXHtcey4qXH1cfS9nLHNlbGYucGxhY2Vob2xkZXIpO3JldHVybic8bGkgZGF0YS1rZXk9IicrCmkua2V5KyciPicraHRtbCsiPC9saT4ifTtlbHNlIGZuPWZ1bmN0aW9uKGkpe3ZhciBvYmo9anNvbi5lbmNvZGUoc2VsZi50ZW1wbGF0ZSksaXRlbXM9YXJyYXkudW5pcXVlKG9iai5tYXRjaCgvXHtce1tcd1wuXC1cW1xdXStcfVx9L2cpKTtvYmo9b2JqLnJlcGxhY2UoInt7IitzZWxmLnN0b3JlLmtleSsifX0iLGkua2V5KTthcnJheS5lYWNoKGl0ZW1zLGZ1bmN0aW9uKGF0dHIpe3ZhciBrZXk9YXR0ci5yZXBsYWNlKC9ce1x7fFx9XH0vZywiIiksdmFsdWU9dXRpbGl0eS53YWxrKGkuZGF0YSxrZXkpfHwiIjtyZWcuY29tcGlsZShzdHJpbmcuZXNjYXBlKGF0dHIpLCJnIik7b2JqPW9iai5yZXBsYWNlKHJlZyxqc29uLmVuY29kZSh2YWx1ZSkucmVwbGFjZSgvKF4iKXwoIiQpL2csIiIpKX0pO29iaj1qc29uLmRlY29kZShvYmoucmVwbGFjZSgvXHtcey4qXH1cfS9nLHNlbGYucGxhY2Vob2xkZXIpKTtyZXR1cm57bGk6b2JqfX07bmV4dD1mdW5jdGlvbihhcmdzKXtzZWxmLnJlY29yZHM9CmFyZ3M7c2VsZi50b3RhbD1zZWxmLnJlY29yZHMubGVuZ3RoO3NlbGYuZmlsdGVyZWQ9W107c2VsZi5jdXJyZW50PVtdO2lmKGZpbHRlcilhcnJheS5lYWNoKHNlbGYucmVjb3JkcyxmdW5jdGlvbihpKXt1dGlsaXR5Lml0ZXJhdGUoc2VsZi5maWx0ZXIsZnVuY3Rpb24odixrKXt2YXIgcmVnLGtleTtpZihhcnJheS5jb250YWlucyhyZWdpc3RyeSxpLmtleSkpcmV0dXJuIGZhbHNlO3Y9c3RyaW5nLmV4cGxvZGUodik7cmVnPW5ldyBSZWdFeHAsa2V5PWs9PT1zZWxmLnN0b3JlLmtleTthcnJheS5lYWNoKHYsZnVuY3Rpb24ocXVlcnkpe3ZhciB2YWx1ZT0ha2V5P3V0aWxpdHkud2FsayhpLmRhdGEsayk6IiI7dXRpbGl0eS5jb21waWxlKHJlZyxxdWVyeSwiaSIpO2lmKGtleSYmcmVnLnRlc3QoaS5rZXkpfHxyZWcudGVzdCh2YWx1ZSkpe3JlZ2lzdHJ5LnB1c2goaS5rZXkpO3NlbGYuZmlsdGVyZWQucHVzaChpKTtyZXR1cm4gZmFsc2V9fSl9KX0pO2lmKHNlbGYucGFnZVNpemUhPT1udWxsJiYKIWlzTmFOKHNlbGYucGFnZUluZGV4KSYmIWlzTmFOKHNlbGYucGFnZVNpemUpKXtjZWlsaW5nPWxpc3QucGFnZXMuY2FsbChzZWxmKTtpZihjZWlsaW5nPjAmJnNlbGYucGFnZUluZGV4PmNlaWxpbmcpcmV0dXJuIHNlbGYucGFnZShjZWlsaW5nKTtlbHNlIGlmKHNlbGYudG90YWw+MCl7cmFuZ2U9bGlzdC5yYW5nZS5jYWxsKHNlbGYpO3NlbGYuY3VycmVudD1hcnJheS5saW1pdCghZmlsdGVyP3NlbGYucmVjb3JkczpzZWxmLmZpbHRlcmVkLHJhbmdlWzBdLHJhbmdlWzFdKX19ZWxzZSBzZWxmLmN1cnJlbnQ9IWZpbHRlcj9zZWxmLnJlY29yZHM6c2VsZi5maWx0ZXJlZDthcnJheS5lYWNoKHNlbGYuY3VycmVudCxmdW5jdGlvbihpKXt2YXIgaHRtbD1mbihpKSxoYXNoPWJ0b2EoaHRtbCk7aXRlbXMucHVzaCh7a2V5Omkua2V5LHRlbXBsYXRlOmh0bWwsaGFzaDpoYXNofSl9KTt1dGlsaXR5LnJlbmRlcihmdW5jdGlvbigpe3ZhciBkZXN0cm95PVtdLGNhbGxiYWNrcz1bXSxpLG50aDtpZihpdGVtcy5sZW5ndGg9PT0KMCllbGVtZW50Lmh0bWwoZWwsJzxsaSBjbGFzcz0iZW1wdHkiPicrc2VsZi5lbXB0eU1zZysiPC9saT4iKTtlbHNlIGlmKHNlbGYuaXRlbXMubGVuZ3RoPT09MCl7ZWxlbWVudC5odG1sKGVsLGl0ZW1zLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS50ZW1wbGF0ZX0pLmpvaW4oIiIpKTtpZihjYWxsYmFjaylhcnJheS5lYWNoKGFycmF5LmNhc3QoZWwuY2hpbGROb2RlcyksZnVuY3Rpb24oaSl7c2VsZi5jYWxsYmFjayhpKX0pfWVsc2V7YXJyYXkuZWFjaChpdGVtcyxmdW5jdGlvbihpLGlkeCl7aWYoc2VsZi5pdGVtc1tpZHhdIT09dW5kZWZpbmVkJiZzZWxmLml0ZW1zW2lkeF0uaGFzaCE9PWkuaGFzaCl7ZWxlbWVudC5kYXRhKGVsZW1lbnQuaHRtbChlbC5jaGlsZE5vZGVzW2lkeF0saS50ZW1wbGF0ZS5yZXBsYWNlKC88bGkgZGF0YS1rZXk9XCJcZCtcIj58PFwvbGk+L2csIiIpKSwia2V5IixpLmtleSk7Y2FsbGJhY2tzLnB1c2goaWR4KX1lbHNlIGlmKHNlbGYuaXRlbXNbaWR4XT09PQp1bmRlZmluZWQpe2VsZW1lbnQuY3JlYXRlKGkudGVtcGxhdGUsbnVsbCxlbCk7Y2FsbGJhY2tzLnB1c2goaWR4KX19KTtpZihpdGVtcy5sZW5ndGg8c2VsZi5pdGVtcy5sZW5ndGgpe2k9aXRlbXMubGVuZ3RoLTE7bnRoPXNlbGYuaXRlbXMubGVuZ3RoO3doaWxlKCsraTxudGgpZGVzdHJveS5wdXNoKGkpO2FycmF5LmVhY2goZGVzdHJveS5yZXZlcnNlKCksZnVuY3Rpb24oaSl7ZWxlbWVudC5kZXN0cm95KGVsLmNoaWxkTm9kZXNbaV0pfSl9aWYoY2FsbGJhY2spYXJyYXkuZWFjaChjYWxsYmFja3MsZnVuY3Rpb24oaSl7c2VsZi5jYWxsYmFjayhlbC5jaGlsZE5vZGVzW2ldKX0pfXNlbGYuaXRlbXM9aXRlbXM7aWYoc2VsZi5wYWdlU2l6ZSE9PW51bGwmJnJlZ2V4LnRvcF9ib3R0b20udGVzdChzZWxmLnBhZ2luYXRpb24pJiYhaXNOYU4oc2VsZi5wYWdlSW5kZXgpJiYhaXNOYU4oc2VsZi5wYWdlU2l6ZSkpc2VsZi5wYWdlcygpO2Vsc2UgYXJyYXkuZWFjaCh1dGlsaXR5LiQoIiMiK2VsLmlkKwoiLXBhZ2VzLXRvcCwgIyIrZWwuaWQrIi1wYWdlcy1ib3R0b20iKSxmdW5jdGlvbihpKXtlbGVtZW50LmRlc3Ryb3koaSl9KTtzZWxmLmRpc3BhdGNoKCJhZnRlclJlZnJlc2giLGVsKX0pfTtpZih0aGlzLndoZXJlPT09bnVsbClzdHJpbmcuaXNFbXB0eSh0aGlzLm9yZGVyKT9uZXh0KHRoaXMuc3RvcmUuZ2V0KCkpOnRoaXMuc3RvcmUuc29ydCh0aGlzLm9yZGVyLGNyZWF0ZSkudGhlbihuZXh0LGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSk7c2VsZi5kaXNwYXRjaCgiZXJyb3IiLGUpfSk7ZWxzZSBpZihzdHJpbmcuaXNFbXB0eSh0aGlzLm9yZGVyKSl0aGlzLnN0b3JlLnNlbGVjdCh0aGlzLndoZXJlKS50aGVuKG5leHQsZnVuY3Rpb24oZSl7dXRpbGl0eS5lcnJvcihlKTtzZWxmLmRpc3BhdGNoKCJlcnJvciIsZSl9KTtlbHNlIHRoaXMuc3RvcmUuc29ydCh0aGlzLm9yZGVyLGNyZWF0ZSx0aGlzLndoZXJlKS50aGVuKG5leHQsZnVuY3Rpb24oZSl7dXRpbGl0eS5lcnJvcihlKTsKc2VsZi5kaXNwYXRjaCgiZXJyb3IiLGUpfSk7cmV0dXJuIHRoaXN9O0RhdGFMaXN0LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24ocmVjb3JkKXt2YXIgc2VsZj10aGlzO3RoaXMuc3RvcmUuZGVsKHJlY29yZCkudGhlbihudWxsLGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSk7c2VsZi5kaXNwYXRjaCgiZXJyb3IiLGUpfSk7cmV0dXJuIHRoaXN9O0RhdGFMaXN0LnByb3RvdHlwZS5zb3J0PWZ1bmN0aW9uKG9yZGVyKXt0aGlzLm9yZGVyPW9yZGVyO3JldHVybiB0aGlzLnJlZnJlc2goKX07RGF0YUxpc3QucHJvdG90eXBlLnRlYXJkb3duPWZ1bmN0aW9uKGRlc3Ryb3kpe2Rlc3Ryb3k9ZGVzdHJveT09PXRydWU7dmFyIHNlbGY9dGhpcyxpZD10aGlzLmVsZW1lbnQuaWQ7YXJyYXkuZWFjaCh0aGlzLnN0b3JlLmxpc3RzLGZ1bmN0aW9uKGksaWR4KXtpZihpLmlkPT09c2VsZi5pZCl7YXJyYXkucmVtb3ZlKHRoaXMsaWR4KTtyZXR1cm4gZmFsc2V9fSk7ZGVsZXRlIHRoaXMub2JzZXJ2ZXIuaG9va3NbaWRdOwppZih0aGlzLmxpc3RGaWx0ZXIpdGhpcy5saXN0RmlsdGVyLnRlYXJkb3duKCk7aWYoZGVzdHJveSl7ZWxlbWVudC5kZXN0cm95KHRoaXMuZWxlbWVudCk7YXJyYXkuZWFjaCh1dGlsaXR5LiQoIiMiK2lkKyItZmlsdGVyLCAjIitpZCsiLXBhZ2VzLXRvcCwgIyIraWQrIi1wYWdlcy1ib3R0b20iKSxmdW5jdGlvbihpKXtlbGVtZW50LmRlc3Ryb3koaSl9KTt0aGlzLmVsZW1lbnQ9bnVsbH1yZXR1cm4gdGhpc307RGF0YUxpc3QucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbihrZXksZGF0YSl7dmFyIHNlbGY9dGhpczt0aGlzLnN0b3JlLnVwZGF0ZShrZXksZGF0YSkudGhlbihudWxsLGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSk7c2VsZi5kaXNwYXRjaCgiZXJyb3IiLGUpfSk7cmV0dXJuIHRoaXN9O3ZhciBkZWZlcnJlZD17ZmFjdG9yeTpmdW5jdGlvbigpe3JldHVybiBuZXcgRGVmZXJyZWR9fTtmdW5jdGlvbiBEZWZlcnJlZCgpe3ZhciBzZWxmPXRoaXM7dGhpcy5wcm9taXNlPXByb21pc2UuZmFjdG9yeSgpOwp0aGlzLm9uRG9uZT1bXTt0aGlzLm9uQWx3YXlzPVtdO3RoaXMub25GYWlsPVtdO3RoaXMucHJvbWlzZS50aGVuKGZ1bmN0aW9uKGFyZyl7YXJyYXkuZWFjaChzZWxmLm9uRG9uZSxmdW5jdGlvbihpKXtpKGFyZyl9KTthcnJheS5lYWNoKHNlbGYub25BbHdheXMsZnVuY3Rpb24oaSl7aShhcmcpfSk7c2VsZi5vbkFsd2F5cz1bXTtzZWxmLm9uRG9uZT1bXTtzZWxmLm9uRmFpbD1bXX0sZnVuY3Rpb24oYXJnKXthcnJheS5lYWNoKHNlbGYub25GYWlsLGZ1bmN0aW9uKGkpe2koYXJnKX0pO2FycmF5LmVhY2goc2VsZi5vbkFsd2F5cyxmdW5jdGlvbihpKXtpKGFyZyl9KTtzZWxmLm9uQWx3YXlzPVtdO3NlbGYub25Eb25lPVtdO3NlbGYub25GYWlsPVtdfSl9RGVmZXJyZWQucHJvdG90eXBlLmNvbnN0cnVjdG9yPURlZmVycmVkO0RlZmVycmVkLnByb3RvdHlwZS5hbHdheXM9ZnVuY3Rpb24oYXJnKXt0aGlzLm9uQWx3YXlzLnB1c2goYXJnKTtyZXR1cm4gdGhpc307RGVmZXJyZWQucHJvdG90eXBlLmRvbmU9CmZ1bmN0aW9uKGFyZyl7dGhpcy5vbkRvbmUucHVzaChhcmcpO3JldHVybiB0aGlzfTtEZWZlcnJlZC5wcm90b3R5cGUuZmFpbD1mdW5jdGlvbihhcmcpe3RoaXMub25GYWlsLnB1c2goYXJnKTtyZXR1cm4gdGhpc307RGVmZXJyZWQucHJvdG90eXBlLnJlamVjdD1mdW5jdGlvbihhcmcpe3RoaXMucHJvbWlzZS5yZWplY3QuY2FsbCh0aGlzLnByb21pc2UsYXJnKTtyZXR1cm4gdGhpc307RGVmZXJyZWQucHJvdG90eXBlLnJlc29sdmU9ZnVuY3Rpb24oYXJnKXt0aGlzLnByb21pc2UucmVzb2x2ZS5jYWxsKHRoaXMucHJvbWlzZSxhcmcpO3JldHVybiB0aGlzfTtEZWZlcnJlZC5wcm90b3R5cGUudGhlbj1mdW5jdGlvbihzdWNjZXNzLGZhaWx1cmUpe3JldHVybiB0aGlzLnByb21pc2UudGhlbihzdWNjZXNzLGZhaWx1cmUpfTt2YXIgZWxlbWVudD17YXBwZW5kVG86ZnVuY3Rpb24ob2JqLGNoaWxkKXtvYmouYXBwZW5kQ2hpbGQoY2hpbGQpO3JldHVybiBvYmp9LGF0dHI6ZnVuY3Rpb24ob2JqLAprZXksdmFsdWUpe3ZhciB0YXJnZXQscmVzdWx0O2lmKHJlZ2V4LnN2Zy50ZXN0KG9iai5uYW1lc3BhY2VVUkkpKWlmKHZhbHVlPT09dW5kZWZpbmVkKXtyZXN1bHQ9b2JqLmdldEF0dHJpYnV0ZU5TKG9iai5uYW1lc3BhY2VVUkksa2V5KTtpZihyZXN1bHQ9PT1udWxsfHxzdHJpbmcuaXNFbXB0eShyZXN1bHQpKXJlc3VsdD11bmRlZmluZWQ7ZWxzZSByZXN1bHQ9dXRpbGl0eS5jb2VyY2UocmVzdWx0KX1lbHNlIG9iai5zZXRBdHRyaWJ1dGVOUyhvYmoubmFtZXNwYWNlVVJJLGtleSx2YWx1ZSk7ZWxzZXtpZih0eXBlb2YgdmFsdWU9PSJzdHJpbmciKXZhbHVlPXN0cmluZy50cmltKHZhbHVlKTtpZihyZWdleC5jaGVja2VkX2Rpc2FibGVkLnRlc3Qoa2V5KSYmdmFsdWU9PT11bmRlZmluZWQpcmV0dXJuIHV0aWxpdHkuY29lcmNlKG9ialtrZXldKTtlbHNlIGlmKHJlZ2V4LmNoZWNrZWRfZGlzYWJsZWQudGVzdChrZXkpJiZ2YWx1ZSE9PXVuZGVmaW5lZClvYmpba2V5XT12YWx1ZTtlbHNlIGlmKG9iai5ub2RlTmFtZT09PQoiU0VMRUNUIiYma2V5PT09InNlbGVjdGVkIiYmdmFsdWU9PT11bmRlZmluZWQpcmV0dXJuIHV0aWxpdHkuZG9tKCIjIitvYmouaWQrJyBvcHRpb25bc2VsZWN0ZWQ9InNlbGVjdGVkIl0nKVswXXx8dXRpbGl0eS5kb20oIiMiK29iai5pZCsiIG9wdGlvbiIpWzBdO2Vsc2UgaWYob2JqLm5vZGVOYW1lPT09IlNFTEVDVCImJmtleT09PSJzZWxlY3RlZCImJnZhbHVlIT09dW5kZWZpbmVkKXt0YXJnZXQ9dXRpbGl0eS5kb20oIiMiK29iai5pZCsnIG9wdGlvbltzZWxlY3RlZD0ic2VsZWN0ZWQiXScpWzBdO2lmKHRhcmdldCE9PXVuZGVmaW5lZCl7dGFyZ2V0LnNlbGVjdGVkPWZhbHNlO3RhcmdldC5yZW1vdmVBdHRyaWJ1dGUoInNlbGVjdGVkIil9dGFyZ2V0PXV0aWxpdHkuZG9tKCIjIitvYmouaWQrJyBvcHRpb25bdmFsdWU9IicrdmFsdWUrJyJdJylbMF07dGFyZ2V0LnNlbGVjdGVkPXRydWU7dGFyZ2V0LnNldEF0dHJpYnV0ZSgic2VsZWN0ZWQiLCJzZWxlY3RlZCIpfWVsc2UgaWYodmFsdWU9PT0KdW5kZWZpbmVkKXtyZXN1bHQ9b2JqLmdldEF0dHJpYnV0ZShrZXkpO2lmKHJlc3VsdD09PW51bGx8fHN0cmluZy5pc0VtcHR5KHJlc3VsdCkpcmVzdWx0PXVuZGVmaW5lZDtlbHNlIHJlc3VsdD11dGlsaXR5LmNvZXJjZShyZXN1bHQpO3JldHVybiByZXN1bHR9ZWxzZSBvYmouc2V0QXR0cmlidXRlKGtleSx2YWx1ZSl9cmV0dXJuIG9ian0sY2xlYXI6ZnVuY3Rpb24ob2JqKXtpZih0eXBlb2Ygb2JqLnJlc2V0PT0iZnVuY3Rpb24iKW9iai5yZXNldCgpO2Vsc2UgaWYob2JqLnZhbHVlIT09dW5kZWZpbmVkKWVsZW1lbnQudXBkYXRlKG9iaix7aW5uZXJIVE1MOiIiLHZhbHVlOiIifSk7ZWxzZSBlbGVtZW50LnVwZGF0ZShvYmose2lubmVySFRNTDoiIn0pO3JldHVybiBvYmp9LGNyZWF0ZTpmdW5jdGlvbih0eXBlLGFyZ3Msb2JqLHBvcyl7dmFyIHN2Zz1mYWxzZSxmcmFnPWZhbHNlLGZyYWdtZW50LHVpZCxyZXN1bHQ7dHlwZT10eXBlLnJlcGxhY2UoL1x0fFxufFxyL2csIiIpO2lmKG9iailzdmc9Cm9iai5uYW1lc3BhY2VVUkkmJnJlZ2V4LnN2Zy50ZXN0KG9iai5uYW1lc3BhY2VVUkkpO2Vsc2Ugb2JqPWRvY3VtZW50LmJvZHk7aWYoYXJncyBpbnN0YW5jZW9mIE9iamVjdCYmYXJncy5pZCYmIXV0aWxpdHkuZG9tKCIjIithcmdzLmlkKSl7dWlkPWFyZ3MuaWQ7ZGVsZXRlIGFyZ3MuaWR9ZWxzZSBpZighc3ZnKXVpZD11dGlsaXR5LmdlbklkKHVuZGVmaW5lZCx0cnVlKTtpZihyZWdleC5odG1sLnRlc3QodHlwZSkpe2ZyYWc9dHJ1ZTtmcmFnbWVudD1lbGVtZW50LmZyYWcodHlwZSk7cmVzdWx0PWZyYWdtZW50LmNoaWxkTm9kZXMubGVuZ3RoPT09MT9mcmFnbWVudC5jaGlsZE5vZGVzWzBdOmFycmF5LmNhc3QoZnJhZ21lbnQuY2hpbGROb2Rlcyl9ZWxzZXtpZighc3ZnJiYhcmVnZXguc3ZnLnRlc3QodHlwZSkpZnJhZ21lbnQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0eXBlKTtlbHNlIGZyYWdtZW50PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLAp0eXBlKTtpZih1aWQpZnJhZ21lbnQuaWQ9dWlkO2lmKGFyZ3MgaW5zdGFuY2VvZiBPYmplY3QpZWxlbWVudC51cGRhdGUoZnJhZ21lbnQsYXJncyl9aWYoIXBvc3x8cG9zPT09Imxhc3QiKW9iai5hcHBlbmRDaGlsZChmcmFnbWVudCk7ZWxzZSBpZihwb3M9PT0iZmlyc3QiKWVsZW1lbnQucHJlcGVuZENoaWxkKG9iaixmcmFnbWVudCk7ZWxzZSBpZihwb3M9PT0iYWZ0ZXIiKXtwb3M9e2FmdGVyOm9ian07b2JqPW9iai5wYXJlbnROb2RlO29iai5pbnNlcnRCZWZvcmUoZnJhZ21lbnQscG9zLmFmdGVyLm5leHRTaWJsaW5nKX1lbHNlIGlmKHBvcy5hZnRlcilvYmouaW5zZXJ0QmVmb3JlKGZyYWdtZW50LHBvcy5hZnRlci5uZXh0U2libGluZyk7ZWxzZSBpZihwb3M9PT0iYmVmb3JlIil7cG9zPXtiZWZvcmU6b2JqfTtvYmo9b2JqLnBhcmVudE5vZGU7b2JqLmluc2VydEJlZm9yZShmcmFnbWVudCxwb3MuYmVmb3JlKX1lbHNlIGlmKHBvcy5iZWZvcmUpb2JqLmluc2VydEJlZm9yZShmcmFnbWVudCwKcG9zLmJlZm9yZSk7ZWxzZSBvYmouYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO3JldHVybiFmcmFnP2ZyYWdtZW50OnJlc3VsdH0sY3NzOmZ1bmN0aW9uKG9iaixrZXksdmFsdWUpe2lmKCFyZWdleC5jYXBzLnRlc3Qoa2V5KSlrZXk9c3RyaW5nLnRvQ2FtZWxDYXNlKGtleSk7aWYodmFsdWUhPT11bmRlZmluZWQpe29iai5zdHlsZVtrZXldPXZhbHVlO3JldHVybiBvYmp9ZWxzZSByZXR1cm4gb2JqLnN0eWxlW2tleV19LGRhdGE6ZnVuY3Rpb24ob2JqLGtleSx2YWx1ZSl7aWYodmFsdWUhPT11bmRlZmluZWQpe29iai5zZXRBdHRyaWJ1dGUoImRhdGEtIitrZXkscmVnZXguanNvbl93cmFwLnRlc3QodmFsdWUpP2pzb24uZW5jb2RlKHZhbHVlKTp2YWx1ZSk7cmV0dXJuIG9ian1lbHNlIHJldHVybiB1dGlsaXR5LmNvZXJjZShvYmouZ2V0QXR0cmlidXRlKCJkYXRhLSIra2V5KSl9LGRlc3Ryb3k6ZnVuY3Rpb24ob2JqKXtpZihvYmoucGFyZW50Tm9kZSE9PW51bGwpb2JqLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQob2JqKTsKcmV0dXJuIHVuZGVmaW5lZH0sZGlzYWJsZTpmdW5jdGlvbihvYmope2lmKHR5cGVvZiBvYmouZGlzYWJsZWQ9PSJib29sZWFuIiYmIW9iai5kaXNhYmxlZClvYmouZGlzYWJsZWQ9dHJ1ZTtyZXR1cm4gb2JqfSxkaXNwYXRjaDpmdW5jdGlvbihvYmosdHlwZSxkYXRhLGJ1YmJsZXMsY2FuY2VsYWJsZSl7dmFyIGV2O2lmKCFvYmopcmV0dXJuO3RyeXtldj1uZXcgQ3VzdG9tRXZlbnQodHlwZSl9Y2F0Y2goZSl7ZXY9ZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkN1c3RvbUV2ZW50Iil9YnViYmxlcz1idWJibGVzIT09ZmFsc2U7Y2FuY2VsYWJsZT1jYW5jZWxhYmxlIT09ZmFsc2U7ZXYuaW5pdEN1c3RvbUV2ZW50KHR5cGUsYnViYmxlcyxjYW5jZWxhYmxlLGRhdGF8fHt9KTtvYmouZGlzcGF0Y2hFdmVudChldik7cmV0dXJuIG9ian0sZW5hYmxlOmZ1bmN0aW9uKG9iail7aWYodHlwZW9mIG9iai5kaXNhYmxlZD09ImJvb2xlYW4iJiZvYmouZGlzYWJsZWQpb2JqLmRpc2FibGVkPWZhbHNlO3JldHVybiBvYmp9LApmaW5kOmZ1bmN0aW9uKG9iaixhcmcpe3ZhciByZXN1bHQ9W107dXRpbGl0eS5nZW5JZChvYmosdHJ1ZSk7YXJyYXkuZWFjaChzdHJpbmcuZXhwbG9kZShhcmcpLGZ1bmN0aW9uKGkpe3Jlc3VsdD1yZXN1bHQuY29uY2F0KHV0aWxpdHkuZG9tKCIjIitvYmouaWQrIiAiK2kpKX0pO3JldHVybiByZXN1bHR9LGZyYWc6ZnVuY3Rpb24oYXJnKXt2YXIgb2JqPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtpZihhcmcpe2FycmF5LmVhY2goYXJyYXkuY2FzdChlbGVtZW50LmNyZWF0ZSgiZGl2Iix7aW5uZXJIVE1MOmFyZ30sb2JqKS5jaGlsZE5vZGVzKSxmdW5jdGlvbihpKXtvYmouYXBwZW5kQ2hpbGQoaSl9KTtvYmoucmVtb3ZlQ2hpbGQob2JqLmNoaWxkTm9kZXNbMF0pfXJldHVybiBvYmp9LGhhczpmdW5jdGlvbihvYmosYXJnKXt2YXIgcmVzdWx0PWVsZW1lbnQuZmluZChvYmosYXJnKTtyZXR1cm4haXNOYU4ocmVzdWx0Lmxlbmd0aCkmJnJlc3VsdC5sZW5ndGg+MH0saGFzQ2xhc3M6ZnVuY3Rpb24ob2JqLAphcmcpe3JldHVybiBvYmouY2xhc3NMaXN0LmNvbnRhaW5zKGFyZyl9LGhpZGRlbjpmdW5jdGlvbihvYmope3JldHVybiBvYmouc3R5bGUuZGlzcGxheT09PSJub25lInx8dHlwZW9mIG9iai5oaWRkZW49PSJib29sZWFuIiYmb2JqLmhpZGRlbn0saHRtbDpmdW5jdGlvbihvYmosYXJnKXtpZihhcmc9PT11bmRlZmluZWQpcmV0dXJuIG9iai5pbm5lckhUTUw7ZWxzZXtvYmouaW5uZXJIVE1MPWFyZztyZXR1cm4gb2JqfX0saXM6ZnVuY3Rpb24ob2JqLGFyZyl7aWYocmVnZXguc2VsZWN0b3JfaXMudGVzdChhcmcpKXJldHVybiBlbGVtZW50LmZpbmQob2JqLnBhcmVudE5vZGUsb2JqLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkrYXJnKS5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGkuaWQ9PT1vYmouaWR9KS5sZW5ndGg9PT0xO2Vsc2UgcmV0dXJuKG5ldyBSZWdFeHAoYXJnLCJpIikpLnRlc3Qob2JqLm5vZGVOYW1lKX0sa2xhc3M6ZnVuY3Rpb24ob2JqLGFyZyxhZGQpe2FkZD1hZGQhPT0KZmFsc2U7YXJnPXN0cmluZy5leHBsb2RlKGFyZywiICIpO2lmKGFkZClhcnJheS5lYWNoKGFyZyxmdW5jdGlvbihpKXtvYmouY2xhc3NMaXN0LmFkZChpKX0pO2Vsc2UgYXJyYXkuZWFjaChhcmcsZnVuY3Rpb24oaSl7aWYoaSE9PSIqIilvYmouY2xhc3NMaXN0LnJlbW92ZShpKTtlbHNle2FycmF5LmVhY2gob2JqLmNsYXNzTGlzdCxmdW5jdGlvbih4KXt0aGlzLnJlbW92ZSh4KX0pO3JldHVybiBmYWxzZX19KTtyZXR1cm4gb2JqfSxwb3NpdGlvbjpmdW5jdGlvbihvYmope29iaj1vYmp8fGRvY3VtZW50LmJvZHk7dmFyIGxlZnQsdG9wLHJpZ2h0LGJvdHRvbSxoZWlnaHQsd2lkdGg7bGVmdD10b3A9MDt3aWR0aD1vYmoub2Zmc2V0V2lkdGg7aGVpZ2h0PW9iai5vZmZzZXRIZWlnaHQ7aWYob2JqLm9mZnNldFBhcmVudCl7dG9wPW9iai5vZmZzZXRUb3A7bGVmdD1vYmoub2Zmc2V0TGVmdDt3aGlsZShvYmo9b2JqLm9mZnNldFBhcmVudCl7bGVmdCs9b2JqLm9mZnNldExlZnQ7dG9wKz1vYmoub2Zmc2V0VG9wfXJpZ2h0PQpkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoLShsZWZ0K3dpZHRoKTtib3R0b209ZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQtKHRvcCtoZWlnaHQpfWVsc2V7cmlnaHQ9d2lkdGg7Ym90dG9tPWhlaWdodH1yZXR1cm5bbGVmdCx0b3AscmlnaHQsYm90dG9tXX0scHJlcGVuZENoaWxkOmZ1bmN0aW9uKG9iaixjaGlsZCl7cmV0dXJuIG9iai5jaGlsZE5vZGVzLmxlbmd0aD09PTA/b2JqLmFwcGVuZENoaWxkKGNoaWxkKTpvYmouaW5zZXJ0QmVmb3JlKGNoaWxkLG9iai5jaGlsZE5vZGVzWzBdKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihvYmosa2V5KXt2YXIgdGFyZ2V0O2lmKHJlZ2V4LnN2Zy50ZXN0KG9iai5uYW1lc3BhY2VVUkkpKW9iai5yZW1vdmVBdHRyaWJ1dGVOUyhvYmoubmFtZXNwYWNlVVJJLGtleSk7ZWxzZSBpZihvYmoubm9kZU5hbWU9PT0iU0VMRUNUIiYma2V5PT09InNlbGVjdGVkIil7dGFyZ2V0PXV0aWxpdHkuZG9tKCIjIitvYmouaWQrJyBvcHRpb25bc2VsZWN0ZWQ9InNlbGVjdGVkIl0nKVswXTsKaWYodGFyZ2V0KXt0YXJnZXQuc2VsZWN0ZWQ9ZmFsc2U7dGFyZ2V0LnJlbW92ZUF0dHJpYnV0ZSgic2VsZWN0ZWQiKX19ZWxzZSBvYmoucmVtb3ZlQXR0cmlidXRlKGtleSk7cmV0dXJuIG9ian0sc2Nyb2xsVG86ZnVuY3Rpb24ob2JqLG1zLG9mZnNldFRvcCxvZmZzZXRMZWZ0KXt2YXIgcG9zPWFycmF5LnJlbW92ZShlbGVtZW50LnBvc2l0aW9uKG9iaiksMiwzKTtpZighaXNOYU4ob2Zmc2V0VG9wKSlwb3NbMF0rPW9mZnNldFRvcDtpZighaXNOYU4ob2Zmc2V0TGVmdCkpcG9zWzFdKz1vZmZzZXRMZWZ0O3JldHVybiBjbGllbnQuc2Nyb2xsKHBvcyxtcyl9LHNlcmlhbGl6ZTpmdW5jdGlvbihvYmosc3RyaW5nLGVuY29kZSl7c3RyaW5nPXN0cmluZz09PXRydWU7ZW5jb2RlPWVuY29kZSE9PWZhbHNlO3ZhciByZWdpc3RyeT17fSxjaGlsZHJlbixyZXN1bHQ7Y2hpbGRyZW49b2JqLm5vZGVOYW1lPT09IkZPUk0iP29iai5lbGVtZW50cz9hcnJheS5jYXN0KG9iai5lbGVtZW50cyk6b2JqLmZpbmQoImJ1dHRvbiwgaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEiKToKW29ial07YXJyYXkuZWFjaChjaGlsZHJlbixmdW5jdGlvbihpKXt2YXIgaWQ9aS5pZHx8aS5uYW1lfHxpLnR5cGU7aWYoaS5ub2RlTmFtZT09PSJGT1JNIil1dGlsaXR5Lm1lcmdlKHJlZ2lzdHJ5LGpzb24uZGVjb2RlKGVsZW1lbnQuc2VyaWFsaXplKGkpKSk7ZWxzZSBpZighcmVnaXN0cnlbaWRdKXJlZ2lzdHJ5W2lkXT1lbGVtZW50LnZhbChpKX0pO2lmKCFzdHJpbmcpcmVzdWx0PXJlZ2lzdHJ5O2Vsc2V7cmVzdWx0PSIiO3V0aWxpdHkuaXRlcmF0ZShyZWdpc3RyeSxmdW5jdGlvbih2LGspe2VuY29kZT9yZXN1bHQrPSImIitlbmNvZGVVUklDb21wb25lbnQoaykrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh2KTpyZXN1bHQrPSImIitrKyI9Iit2fSk7cmVzdWx0PXJlc3VsdC5yZXBsYWNlKHJlZ2V4LmFuZCwiPyIpfXJldHVybiByZXN1bHR9LHNpemU6ZnVuY3Rpb24ob2JqKXtyZXR1cm5bb2JqLm9mZnNldFdpZHRoK251bWJlci5wYXJzZShvYmouc3R5bGUucGFkZGluZ0xlZnR8fDApKwpudW1iZXIucGFyc2Uob2JqLnN0eWxlLnBhZGRpbmdSaWdodHx8MCkrbnVtYmVyLnBhcnNlKG9iai5zdHlsZS5ib3JkZXJMZWZ0fHwwKStudW1iZXIucGFyc2Uob2JqLnN0eWxlLmJvcmRlclJpZ2h0fHwwKSxvYmoub2Zmc2V0SGVpZ2h0K251bWJlci5wYXJzZShvYmouc3R5bGUucGFkZGluZ1RvcHx8MCkrbnVtYmVyLnBhcnNlKG9iai5zdHlsZS5wYWRkaW5nQm90dG9tfHwwKStudW1iZXIucGFyc2Uob2JqLnN0eWxlLmJvcmRlclRvcHx8MCkrbnVtYmVyLnBhcnNlKG9iai5zdHlsZS5ib3JkZXJCb3R0b218fDApXX0sdGV4dDpmdW5jdGlvbihvYmosYXJnKXt2YXIga2V5PW9iai50ZXh0Q29udGVudD8idGV4dENvbnRlbnQiOiJpbm5lclRleHQiLHBheWxvYWQ9e30sc2V0PWZhbHNlO2lmKHR5cGVvZiBhcmchPSJ1bmRlZmluZWQiKXtzZXQ9dHJ1ZTtwYXlsb2FkW2tleV09YXJnfXJldHVybiBzZXQ/ZWxlbWVudC51cGRhdGUob2JqLHBheWxvYWQpOm9ialtrZXldfSx0b2dnbGVDbGFzczpmdW5jdGlvbihvYmosCmFyZyl7b2JqLmNsYXNzTGlzdC50b2dnbGUoYXJnKTtyZXR1cm4gb2JqfSx1cGRhdGU6ZnVuY3Rpb24ob2JqLGFyZ3Mpe3V0aWxpdHkuaXRlcmF0ZShhcmdzLGZ1bmN0aW9uKHYsayl7aWYocmVnZXguZWxlbWVudF91cGRhdGUudGVzdChrKSlvYmpba109djtlbHNlIGlmKGs9PT0iY2xhc3MiKSFzdHJpbmcuaXNFbXB0eSh2KT9lbGVtZW50LmtsYXNzKG9iaix2KTplbGVtZW50LmtsYXNzKG9iaiwiKiIsZmFsc2UpO2Vsc2UgaWYoay5pbmRleE9mKCJkYXRhLSIpPT09MCllbGVtZW50LmRhdGEob2JqLGsucmVwbGFjZSgiZGF0YS0iLCIiKSx2KTtlbHNlIGVsZW1lbnQuYXR0cihvYmosayx2KX0pO3JldHVybiBvYmp9LHZhbDpmdW5jdGlvbihvYmosdmFsdWUpe3ZhciBldj0iaW5wdXQiLG91dHB1dDtpZih2YWx1ZT09PXVuZGVmaW5lZCl7aWYocmVnZXgucmFkaW9fY2hlY2tib3gudGVzdChvYmoudHlwZSkpe2lmKHN0cmluZy5pc0VtcHR5KG9iai5uYW1lKSl0aHJvdyBuZXcgRXJyb3IobGFiZWwuZXhwZWN0ZWRQcm9wZXJ0eSk7CmFycmF5LmVhY2godXRpbGl0eS5kb20oImlucHV0W25hbWU9JyIrb2JqLm5hbWUrIiddIiksZnVuY3Rpb24oaSl7aWYoaS5jaGVja2VkKXtvdXRwdXQ9aS52YWx1ZTtyZXR1cm4gZmFsc2V9fSl9ZWxzZSBpZihyZWdleC5zZWxlY3QudGVzdChvYmoudHlwZSkpb3V0cHV0PW9iai5vcHRpb25zW29iai5zZWxlY3RlZEluZGV4XS52YWx1ZTtlbHNlIGlmKG9iai52YWx1ZSlvdXRwdXQ9b2JqLnZhbHVlO2Vsc2Ugb3V0cHV0PWVsZW1lbnQudGV4dChvYmopO2lmKG91dHB1dCE9PXVuZGVmaW5lZCl7b3V0cHV0PXV0aWxpdHkuY29lcmNlKG91dHB1dCk7aWYodHlwZW9mIG91dHB1dD09InN0cmluZyIpb3V0cHV0PXN0cmluZy50cmltKG91dHB1dCl9ZWxzZSBvdXRwdXQ9IiJ9ZWxzZXt2YWx1ZT12YWx1ZS50b1N0cmluZygpO2lmKHJlZ2V4LnJhZGlvX2NoZWNrYm94LnRlc3Qob2JqLnR5cGUpKXtldj0iY2xpY2siO2FycmF5LmVhY2godXRpbGl0eS5kb20oImlucHV0W25hbWU9JyIrb2JqLm5hbWUrCiInXSIpLGZ1bmN0aW9uKGkpe2lmKGkudmFsdWU9PT12YWx1ZSl7aS5jaGVja2VkPXRydWU7b3V0cHV0PWk7cmV0dXJuIGZhbHNlfX0pfWVsc2UgaWYocmVnZXguc2VsZWN0LnRlc3Qob2JqLnR5cGUpKXtldj0iY2hhbmdlIjthcnJheS5lYWNoKGVsZW1lbnQuZmluZChvYmosIj4gKiIpLGZ1bmN0aW9uKGkpe2lmKGkudmFsdWU9PT12YWx1ZSl7aS5zZWxlY3RlZD10cnVlO291dHB1dD1pO3JldHVybiBmYWxzZX19KX1lbHNlIG9iai52YWx1ZSE9PXVuZGVmaW5lZD9vYmoudmFsdWU9dmFsdWU6ZWxlbWVudC50ZXh0KG9iaix2YWx1ZSk7ZWxlbWVudC5kaXNwYXRjaChvYmosZXYpO291dHB1dD1vYmp9cmV0dXJuIG91dHB1dH19O3ZhciBqc29uPXtkZWNvZGU6ZnVuY3Rpb24oYXJnLHNpbGVudCl7dHJ5e3JldHVybiBKU09OLnBhcnNlKGFyZyl9Y2F0Y2goZSl7aWYoc2lsZW50IT09dHJ1ZSl1dGlsaXR5LmVycm9yKGUsYXJndW1lbnRzLHRoaXMpO3JldHVybiB1bmRlZmluZWR9fSxlbmNvZGU6ZnVuY3Rpb24oYXJnLApzaWxlbnQpe3RyeXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnKX1jYXRjaChlKXtpZihzaWxlbnQhPT10cnVlKXV0aWxpdHkuZXJyb3IoZSxhcmd1bWVudHMsdGhpcyk7cmV0dXJuIHVuZGVmaW5lZH19fTt2YXIgbGFiZWw9e2V4cGVjdGVkTnVtYmVyOiJFeHBlY3RlZCBhIE51bWJlciIsZXhwZWN0ZWRQcm9wZXJ0eToiRXhwZWN0ZWQgYSBwcm9wZXJ0eSwgYW5kIGl0IHdhcyBub3Qgc2V0IixleHBlY3RlZE9iamVjdDoiRXhwZWN0ZWQgYW4gT2JqZWN0IixpbnZhbGlkQXJndW1lbnRzOiJPbmUgb3IgbW9yZSBhcmd1bWVudHMgaXMgaW52YWxpZCIsaW52YWxpZFN0YXRlTm9IZWFkZXJzOiJJTlZBTElEX1NUQVRFX0VSUjogSGVhZGVycyBoYXZlIG5vdCBiZWVuIHJlY2VpdmVkIixpbnZhbGlkU3RhdGVOb1N5bmM6IlN5bmNocm9ub3VzIFhNTEh0dHBSZXF1ZXN0IHJlcXVlc3RzIGFyZSBub3Qgc3VwcG9ydGVkIixpbnZhbGlkU3RhdGVOb3RPcGVuOiJJTlZBTElEX1NUQVRFX0VSUjogT2JqZWN0IGlzIG5vdCBvcGVuIiwKaW52YWxpZFN0YXRlTm90U2VuZGluZzoiSU5WQUxJRF9TVEFURV9FUlI6IE9iamVjdCBpcyBzZW5kaW5nIixpbnZhbGlkU3RhdGVOb3RVc2FibGU6IklOVkFMSURfU1RBVEVfRVJSOiBPYmplY3QgaXMgbm90IHVzYWJsZSIsbm9EYXRhOiJOb3RoaW5nIHRvIGRpc3BsYXkiLG5vdEF2YWlsYWJsZToiUmVxdWVzdGVkIG1ldGhvZCBpcyBub3QgYXZhaWxhYmxlIixkYXRhc3RvcmVOb1ByZXZWZXJzaW9uOiJObyBwcmV2aW91cyB2ZXJzaW9uIGZvdW5kIixzZXJ2ZXJFcnJvcjoiU2VydmVyIGVycm9yIGhhcyBvY2N1cnJlZCIsc2VydmVyRm9yYmlkZGVuOiJGb3JiaWRkZW4gdG8gYWNjZXNzIFVSSSIsc2VydmVySW52YWxpZE1ldGhvZDoiTWV0aG9kIG5vdCBhbGxvd2VkIixzZXJ2ZXJVbmF1dGhvcml6ZWQ6IkF1dGhvcml6YXRpb24gcmVxdWlyZWQgdG8gYWNjZXNzIFVSSSIsdXBncmFkZToiWW91ciBicm93c2VyIGlzIHRvbyBvbGQgdG8gdXNlIGtlaWdhaSwgcGxlYXNlIHVwZ3JhZGUifTt2YXIgbWF0aD0Ke2JlemllcjpmdW5jdGlvbigpe3ZhciBhPWFycmF5LmNhc3QoYXJndW1lbnRzKSx0PWEucG9wKCksUD1hcnJheS5jaHVuayhhLDIpLG49UC5sZW5ndGgsYyxTMCxRMCxRMSxRMixDMCxDMSxDMixDMztpZihuPDJ8fG4+NCl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7Yz1bXTtTMD0xLXQ7UTA9bWF0aC5zcXIoUzApO1ExPTIqUzAqdDtRMj1tYXRoLnNxcih0KTtDMD1NYXRoLnBvdyhTMCwzKTtDMT0zKlEwKnQ7QzI9MypTMCpRMjtDMz1NYXRoLnBvdyh0LDMpO2lmKG49PT0yKXtjLnB1c2goUzAqUFswXVswXSt0KlBbMV1bMF0pO2MucHVzaChTMCpQWzBdWzFdK3QqUFsxXVsxXSl9ZWxzZSBpZihuPT09Myl7Yy5wdXNoKFEwKlBbMF1bMF0rUTEqUFsxXVswXSsoUTIrUFsyXVswXSkpO2MucHVzaChRMCpQWzBdWzFdK1ExKlBbMV1bMV0rKFEyK1BbMl1bMV0pKX1lbHNlIGlmKG49PT00KXtjLnB1c2goQzAqUFswXVswXStDMSpQWzFdWzBdK0MyKlBbMl1bMF0rQzMqClBbM11bMF0pO2MucHVzaChDMCpQWzBdWzFdK0MxKlBbMV1bMV0rQzIqUFsyXVsxXStDMypQWzNdWzFdKX1yZXR1cm4gY30sZGlzdDpmdW5jdGlvbihhLGIpe3JldHVybiBNYXRoLnNxcnQobWF0aC5zcXIoYlswXS1hWzBdKSttYXRoLnNxcihiWzFdLWFbMV0pKX0sc3FyOmZ1bmN0aW9uKG4pe3JldHVybiBNYXRoLnBvdyhuLDIpfX07dmFyIG51bWJlcj17ZGlmZjpmdW5jdGlvbihudW0xLG51bTIpe2lmKGlzTmFOKG51bTEpfHxpc05hTihudW0yKSl0aHJvdyBuZXcgRXJyb3IobGFiZWwuZXhwZWN0ZWROdW1iZXIpO3JldHVybiBNYXRoLmFicyhudW0xLW51bTIpfSxldmVuOmZ1bmN0aW9uKGFyZyl7cmV0dXJuIGFyZyUyPT09MH0sZm9ybWF0OmZ1bmN0aW9uKGFyZyxkZWxpbWl0ZXIsZXZlcnkpe2lmKGlzTmFOKGFyZykpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmV4cGVjdGVkTnVtYmVyKTthcmc9YXJnLnRvU3RyaW5nKCk7ZGVsaW1pdGVyPWRlbGltaXRlcnx8IiwiO2V2ZXJ5PWV2ZXJ5fHwKMzt2YXIgZD1hcmcuaW5kZXhPZigiLiIpPi0xPyIuIithcmcucmVwbGFjZShyZWdleC5udW1iZXJfZm9ybWF0XzEsIiIpOiIiLGE9YXJnLnJlcGxhY2UocmVnZXgubnVtYmVyX2Zvcm1hdF8yLCIiKS5zcGxpdCgiIikucmV2ZXJzZSgpLHA9TWF0aC5mbG9vcihhLmxlbmd0aC9ldmVyeSksaT0xLG4sYjtmb3IoYj0wO2I8cDtiKyspe249aT09PTE/ZXZlcnk6ZXZlcnkqaSsoaT09PTI/MTppLTEpO2Euc3BsaWNlKG4sMCxkZWxpbWl0ZXIpO2krK31hPWEucmV2ZXJzZSgpLmpvaW4oIiIpO2lmKGEuY2hhckF0KDApPT09ZGVsaW1pdGVyKWE9YS5zdWJzdHJpbmcoMSk7cmV0dXJuIGErZH0saGFsZjpmdW5jdGlvbihhLGIpe3JldHVybiBiP2EvYj09PS41OmEvMn0sb2RkOmZ1bmN0aW9uKGFyZyl7cmV0dXJuIW51bWJlci5ldmVuKGFyZyl9LHBhcnNlOmZ1bmN0aW9uKGFyZyxiYXNlKXtyZXR1cm4gYmFzZT09PXVuZGVmaW5lZD9wYXJzZUZsb2F0KGFyZyk6cGFyc2VJbnQoYXJnLGJhc2UpfSxyYW5kb206ZnVuY3Rpb24oYXJnKXthcmc9CmFyZ3x8MTAwO3JldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGFyZysxKSl9LHJvdW5kOmZ1bmN0aW9uKGFyZyxkaXJlY3Rpb24pe2FyZz1udW1iZXIucGFyc2UoYXJnKTtpZihkaXJlY3Rpb249PT11bmRlZmluZWR8fHN0cmluZy5pc0VtcHR5KGRpcmVjdGlvbikpcmV0dXJuIG51bWJlci5wYXJzZShhcmcudG9GaXhlZCgwKSk7ZWxzZSBpZihyZWdleC5kb3duLnRlc3QoZGlyZWN0aW9uKSlyZXR1cm5+fmFyZztlbHNlIHJldHVybiBNYXRoLmNlaWwoYXJnKX19O3ZhciBwcm9taXNlPXtmYWN0b3J5OmZ1bmN0aW9uKCl7dmFyIHByb21pc2UscENhdGNoLHBSZXNvbHZlLHBSZWplY3QscFRoZW47cHJvbWlzZT1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLHJlamVjdCl7cFJlc29sdmU9cmVzb2x2ZTtwUmVqZWN0PXJlamVjdH0pO3BDYXRjaD1mdW5jdGlvbigpe3JldHVybiBwcm9taXNlWyJjYXRjaCJdLmFwcGx5KHByb21pc2UsYXJndW1lbnRzKX07cFRoZW49ZnVuY3Rpb24oKXtyZXR1cm4gcHJvbWlzZS50aGVuLmFwcGx5KHByb21pc2UsCmFyZ3VtZW50cyl9O3JldHVybnsiY2F0Y2giOnBDYXRjaCxyZXNvbHZlOnBSZXNvbHZlLHJlamVjdDpwUmVqZWN0LHRoZW46cFRoZW59fX07dmFyIHN0b3JlPXtmYWN0b3J5OmZ1bmN0aW9uKHJlY3MsYXJncyl7dmFyIG9iaj1uZXcgRGF0YVN0b3JlO2lmKGFyZ3MgaW5zdGFuY2VvZiBPYmplY3QpdXRpbGl0eS5tZXJnZShvYmosYXJncyk7aWYocmVjcyE9PW51bGwmJnR5cGVvZiByZWNzPT0ib2JqZWN0IilvYmouYmF0Y2goInNldCIscmVjcyk7cmV0dXJuIG9ian0sd29ya2VyOmZ1bmN0aW9uKGV2KXt2YXIgY21kPWV2LmRhdGEuY21kLHJlY29yZHM9ZXYuZGF0YS5yZWNvcmRzLGNsYXVzZXMsY29uZCxmdW5jdGlvbnMsaW5kZXhlcyxpbmRleCxyZXN1bHQsc29ydGVkLHdoZXJlLHZhbHVlcztpZihjbWQ9PT0ic2VsZWN0Iil7d2hlcmU9SlNPTi5wYXJzZShldi5kYXRhLndoZXJlKTtmdW5jdGlvbnM9ZXYuZGF0YS5mdW5jdGlvbnM7Y2xhdXNlcz1hcnJheS5mcm9tT2JqZWN0KHdoZXJlKTsKc29ydGVkPWFycmF5LmZsYXQoY2xhdXNlcykuZmlsdGVyKGZ1bmN0aW9uKGksaWR4KXtyZXR1cm4gaWR4JTI9PT0wfSkuc29ydChhcnJheS5zb3J0KTtpbmRleD1zb3J0ZWQuam9pbigifCIpO3ZhbHVlcz1zb3J0ZWQubWFwKGZ1bmN0aW9uKGkpe3JldHVybiB3aGVyZVtpXX0pLmpvaW4oInwiKTtpbmRleGVzPWV2LmRhdGEuaW5kZXhlcztjb25kPSJyZXR1cm4gKCAiO2lmKGZ1bmN0aW9ucy5sZW5ndGg9PT0wJiZpbmRleGVzW2luZGV4XSlyZXN1bHQ9KGluZGV4ZXNbaW5kZXhdW3ZhbHVlc118fFtdKS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIHJlY29yZHNbaV19KTtlbHNle2lmKGNsYXVzZXMubGVuZ3RoPjEpYXJyYXkuZWFjaChjbGF1c2VzLGZ1bmN0aW9uKGksaWR4KXt2YXIgYjE9IiggIjtpZihpZHg+MCliMT0iICYmICggIjtpZihhcnJheS5jb250YWlucyhmdW5jdGlvbnMsaVswXSkpY29uZCs9YjEraVsxXSsnKCByZWMuZGF0YVsiJytpWzBdKyciXSApICknO2Vsc2UgaWYoIWlzTmFOKGlbMV0pKWNvbmQrPQpiMSsncmVjLmRhdGFbIicraVswXSsnIl0gPT09ICcraVsxXSsiICkiO2Vsc2UgY29uZCs9YjErJ3JlYy5kYXRhWyInK2lbMF0rJyJdID09PSAiJytpWzFdKyciICknfSk7ZWxzZSBpZihhcnJheS5jb250YWlucyhmdW5jdGlvbnMsY2xhdXNlc1swXVswXSkpY29uZCs9Y2xhdXNlc1swXVsxXSsnKCByZWMuZGF0YVsiJytjbGF1c2VzWzBdWzBdKyciXSApJztlbHNlIGlmKCFpc05hTihjbGF1c2VzWzBdWzFdKSljb25kKz0ncmVjLmRhdGFbIicrY2xhdXNlc1swXVswXSsnIl0gPT09ICcrY2xhdXNlc1swXVsxXTtlbHNlIGNvbmQrPSdyZWMuZGF0YVsiJytjbGF1c2VzWzBdWzBdKyciXSA9PT0gIicrY2xhdXNlc1swXVsxXSsnIic7Y29uZCs9IiApOyI7cmVzdWx0PXJlY29yZHMuZmlsdGVyKG5ldyBGdW5jdGlvbigicmVjIixjb25kKSl9fWVsc2UgaWYoY21kPT09InNvcnQiKXJlc3VsdD1hcnJheS5rZXlTb3J0KHJlY29yZHMsZXYuZGF0YS5xdWVyeSwiZGF0YSIpO3Bvc3RNZXNzYWdlKHJlc3VsdCl9fTsKZnVuY3Rpb24gRGF0YVN0b3JlKCl7dGhpcy5hdXRvc2F2ZT1mYWxzZTt0aGlzLmNhbGxiYWNrPW51bGw7dGhpcy5jcmVkZW50aWFscz1udWxsO3RoaXMubGlzdHM9W107dGhpcy5ldmVudHM9dHJ1ZTt0aGlzLmV4cGlyZXM9bnVsbDt0aGlzLmhlYWRlcnM9e0FjY2VwdDoiYXBwbGljYXRpb24vanNvbiJ9O3RoaXMuaWdub3JlPVtdO3RoaXMuaW5kZXg9W107dGhpcy5pbmRleGVzPXtrZXk6e319O3RoaXMua2V5PW51bGw7dGhpcy5sb2FkZWQ9ZmFsc2U7dGhpcy5tb25nb2RiPSIiO3RoaXMub2JzZXJ2ZXI9b2JzZXJ2YWJsZS5mYWN0b3J5KCk7dGhpcy5yZWNvcmRzPVtdO3RoaXMuc291cmNlPW51bGw7dGhpcy50b3RhbD0wO3RoaXMudmVyc2lvbnM9e307dGhpcy52ZXJzaW9uaW5nPXRydWU7dGhpcy52aWV3cz17fTt0aGlzLnVyaT1udWxsfURhdGFTdG9yZS5wcm90b3R5cGU9YmFzZS5mYWN0b3J5KCk7RGF0YVN0b3JlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1EYXRhU3RvcmU7RGF0YVN0b3JlLnByb3RvdHlwZS5iYXRjaD0KZnVuY3Rpb24odHlwZSxkYXRhLHN5bmMpe3N5bmM9c3luYz09PXRydWU7dmFyIHNlbGY9dGhpcyxldmVudHM9dGhpcy5ldmVudHMsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpLGRlZmVycmVkcz1bXTtpZighcmVnZXguc2V0X2RlbC50ZXN0KHR5cGUpfHxzeW5jJiZyZWdleC5kZWwudGVzdCh0eXBlKXx8dHlwZW9mIGRhdGEhPSJvYmplY3QiKWRlZmVyLnJlamVjdChuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cykpO2Vsc2V7aWYoZXZlbnRzKXRoaXMuZGlzcGF0Y2goImJlZm9yZUJhdGNoIixkYXRhKTtpZihzeW5jKXRoaXMuY2xlYXIoc3luYyk7aWYoZGF0YS5sZW5ndGg9PT0wKXt0aGlzLmxvYWRlZD10cnVlO2lmKGV2ZW50cyl0aGlzLmRpc3BhdGNoKCJhZnRlckJhdGNoIix0aGlzLnJlY29yZHMpO2RlZmVyLnJlc29sdmUodGhpcy5yZWNvcmRzKX1lbHNle2lmKHR5cGU9PT0iZGVsIilhcnJheS5lYWNoKGRhdGEsZnVuY3Rpb24oaSl7ZGVmZXJyZWRzLnB1c2goc2VsZi5kZWwoaSwKZmFsc2UsdHJ1ZSkpfSk7ZWxzZSBhcnJheS5lYWNoKGRhdGEsZnVuY3Rpb24oaSl7ZGVmZXJyZWRzLnB1c2goc2VsZi5zZXQobnVsbCxpLHRydWUpKX0pO3RoaXMubG9hZGVkPWZhbHNlO3V0aWxpdHkud2hlbihkZWZlcnJlZHMpLnRoZW4oZnVuY3Rpb24oYXJncyl7c2VsZi5sb2FkZWQ9dHJ1ZTtpZihldmVudHMpc2VsZi5kaXNwYXRjaCgiYWZ0ZXJCYXRjaCIsYXJncyk7YXJyYXkuZWFjaChzZWxmLmxpc3RzLGZ1bmN0aW9uKGkpe2kucmVmcmVzaCh0cnVlKX0pO2lmKHR5cGU9PT0iZGVsIil7c2VsZi5yZWNvcmRzPWFycmF5LmNvbXBhY3Qoc2VsZi5yZWNvcmRzKTtzZWxmLnJlaW5kZXgoKX1pZihzZWxmLmF1dG9zYXZlKXNlbGYuc2F2ZSgpO2RlZmVyLnJlc29sdmUoYXJncyl9LGZ1bmN0aW9uKGUpe2lmKGV2ZW50cylzZWxmLmRpc3BhdGNoKCJmYWlsZWRCYXRjaCIsZSk7ZGVmZXIucmVqZWN0KGUpfSl9fXJldHVybiBkZWZlcn07RGF0YVN0b3JlLnByb3RvdHlwZS5idWlsZFVyaT1mdW5jdGlvbihrZXkpe3ZhciBwYXJzZWQ9CnV0aWxpdHkucGFyc2UodGhpcy51cmkpO3JldHVybiBwYXJzZWQucHJvdG9jb2wrIi8vIitwYXJzZWQuaG9zdCtwYXJzZWQucGF0aG5hbWUrKHJlZ2V4LmVuZHNsYXNoLnRlc3QocGFyc2VkLnBhdGhuYW1lKT8iIjoiLyIpK2tleX07RGF0YVN0b3JlLnByb3RvdHlwZS5jbGVhcj1mdW5jdGlvbihzeW5jKXtzeW5jPXN5bmM9PT10cnVlO3ZhciBldmVudHM9dGhpcy5ldmVudHM9PT10cnVlLHJlc2F2ZT10aGlzLmF1dG9zYXZlPT09dHJ1ZTtpZighc3luYyl7aWYoZXZlbnRzKXRoaXMuZGlzcGF0Y2goImJlZm9yZUNsZWFyIik7YXJyYXkuZWFjaCh0aGlzLmxpc3RzLGZ1bmN0aW9uKGkpe2lmKGkpaS50ZWFyZG93bih0cnVlKX0pO3RoaXMuYXV0b3NhdmU9ZmFsc2U7dGhpcy5jYWxsYmFjaz1udWxsO3RoaXMuY3JlZGVudGlhbHM9bnVsbDt0aGlzLmxpc3RzPVtdO3RoaXMuZXZlbnRzPXRydWU7dGhpcy5leHBpcmVzPW51bGw7dGhpcy5oZWFkZXJzPXtBY2NlcHQ6ImFwcGxpY2F0aW9uL2pzb24ifTsKdGhpcy5pZ25vcmU9W107dGhpcy5pbmRleD1bXTt0aGlzLmluZGV4ZXM9e2tleTp7fX07dGhpcy5rZXk9bnVsbDt0aGlzLmxvYWRlZD1mYWxzZTt0aGlzLnJlY29yZHM9W107dGhpcy5zb3VyY2U9bnVsbDt0aGlzLnRvdGFsPTA7dGhpcy52ZXJzaW9ucz17fTt0aGlzLnZlcnNpb25pbmc9dHJ1ZTt0aGlzLnZpZXdzPXt9O3RoaXMudXJpPW51bGw7aWYoZXZlbnRzKXRoaXMuZGlzcGF0Y2goImFmdGVyQ2xlYXIiKX1lbHNle3RoaXMuaW5kZXhlcz17a2V5Ont9fTt0aGlzLmxvYWRlZD1mYWxzZTt0aGlzLnJlY29yZHM9W107dGhpcy50b3RhbD0wO3RoaXMudmlld3M9e307YXJyYXkuZWFjaCh0aGlzLmxpc3RzLGZ1bmN0aW9uKGkpe2lmKGkpaS5yZWZyZXNoKCl9KX1pZihyZXNhdmUpdGhpcy5zYXZlKCk7cmV0dXJuIHRoaXN9O0RhdGFTdG9yZS5wcm90b3R5cGUuZGVsPWZ1bmN0aW9uKHJlY29yZCxyZWluZGV4LGJhdGNoKXtyZWNvcmQ9cmVjb3JkLmtleT9yZWNvcmQ6dGhpcy5nZXQocmVjb3JkKTsKcmVpbmRleD1yZWluZGV4IT09ZmFsc2U7YmF0Y2g9YmF0Y2g9PT10cnVlO3ZhciBzZWxmPXRoaXMsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpO2lmKHJlY29yZD09PXVuZGVmaW5lZClkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpKTtlbHNle2lmKHRoaXMuZXZlbnRzKXNlbGYuZGlzcGF0Y2goImJlZm9yZURlbGV0ZSIscmVjb3JkKTtpZih0aGlzLnVyaT09PW51bGx8fHRoaXMuY2FsbGJhY2shPT1udWxsKXRoaXMuZGVsQ29tcGxldGUocmVjb3JkLHJlaW5kZXgsYmF0Y2gsZGVmZXIpO2Vsc2UgY2xpZW50LnJlcXVlc3QodGhpcy5idWlsZFVyaShyZWNvcmQua2V5KSwiREVMRVRFIixudWxsLHV0aWxpdHkubWVyZ2Uoe3dpdGhDcmVkZW50aWFsczp0aGlzLmNyZWRlbnRpYWxzfSx0aGlzLmhlYWRlcnMpKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5kZWxDb21wbGV0ZShyZWNvcmQscmVpbmRleCxiYXRjaCxkZWZlcil9LGZ1bmN0aW9uKGUpe3NlbGYuZGlzcGF0Y2goImZhaWxlZERlbGV0ZSIsCmUpO2RlZmVyLnJlamVjdChlKX0pfXJldHVybiBkZWZlcn07RGF0YVN0b3JlLnByb3RvdHlwZS5kZWxDb21wbGV0ZT1mdW5jdGlvbihyZWNvcmQscmVpbmRleCxiYXRjaCxkZWZlcil7dmFyIHNlbGY9dGhpcztkZWxldGUgdGhpcy5pbmRleGVzLmtleVtyZWNvcmQua2V5XTtkZWxldGUgdGhpcy52ZXJzaW9uc1tyZWNvcmQua2V5XTt0aGlzLnRvdGFsLS07dGhpcy52aWV3cz17fTtpZighYmF0Y2gpe2FycmF5LnJlbW92ZSh0aGlzLnJlY29yZHMscmVjb3JkLmluZGV4KTtpZihyZWluZGV4KXRoaXMucmVpbmRleCgpO2Vsc2UgYXJyYXkuZWFjaChyZWNvcmQuaW5kZXhlcyxmdW5jdGlvbihpKXthcnJheS5yZW1vdmUoc2VsZi5pbmRleGVzW2lbMF1dW2lbMV1dLHJlY29yZC5pbmRleCk7aWYoc2VsZi5pbmRleGVzW2lbMF1dW2lbMV1dLmxlbmd0aD09PTApZGVsZXRlIHNlbGYuaW5kZXhlc1tpWzBdXVtpWzFdXX0pO2lmKHRoaXMuYXV0b3NhdmUpdGhpcy5wdXJnZShyZWNvcmQua2V5KTtpZih0aGlzLmV2ZW50cyl0aGlzLmRpc3BhdGNoKCJhZnRlckRlbGV0ZSIsCnJlY29yZCk7YXJyYXkuZWFjaCh0aGlzLmxpc3RzLGZ1bmN0aW9uKGkpe2kucmVmcmVzaCgpfSl9ZWxzZSB0aGlzLnJlY29yZHNbcmVjb3JkLmluZGV4XT1udWxsO3JldHVybiBkZWZlci5yZXNvbHZlKHJlY29yZC5rZXkpfTtEYXRhU3RvcmUucHJvdG90eXBlLmR1bXA9ZnVuY3Rpb24oYXJncyxmaWVsZHMpe2FyZ3M9YXJnc3x8dGhpcy5yZWNvcmRzO3ZhciBzZWxmPXRoaXMsY3VzdG9tPWZpZWxkcyBpbnN0YW5jZW9mIEFycmF5JiZmaWVsZHMubGVuZ3RoPjAsa2V5PXRoaXMua2V5IT09bnVsbCxmbjtpZihjdXN0b20pZm49ZnVuY3Rpb24oaSl7dmFyIHJlY29yZD17fTthcnJheS5lYWNoKGZpZWxkcyxmdW5jdGlvbihmKXtyZWNvcmRbZl09Zj09PXNlbGYua2V5P2lzTmFOKGkua2V5KT9pLmtleTpOdW1iZXIoaS5rZXkpOnV0aWxpdHkuY2xvbmUoaS5kYXRhW2ZdLHRydWUpfSk7cmV0dXJuIHJlY29yZH07ZWxzZSBmbj1mdW5jdGlvbihpKXt2YXIgcmVjb3JkPXt9O2lmKGtleSlyZWNvcmRbc2VsZi5rZXldPQppc05hTihpLmtleSk/aS5rZXk6TnVtYmVyKGkua2V5KTt1dGlsaXR5Lml0ZXJhdGUoaS5kYXRhLGZ1bmN0aW9uKHYsayl7cmVjb3JkW2tdPXV0aWxpdHkuY2xvbmUodix0cnVlKX0pO3JldHVybiByZWNvcmR9O3JldHVybiBhcmdzLm1hcChmbil9O0RhdGFTdG9yZS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHJlY29yZCxvZmZzZXQpe3ZhciB0eXBlPXR5cGVvZiByZWNvcmQsc2VsZj10aGlzLHJlc3VsdDtpZih0eXBlPT09InVuZGVmaW5lZCIpcmVzdWx0PXRoaXMucmVjb3JkcztlbHNlIGlmKHR5cGU9PT0ic3RyaW5nIilpZihyZWNvcmQuaW5kZXhPZigiLCIpPT09LTEpcmVzdWx0PXRoaXMucmVjb3Jkc1t0aGlzLmluZGV4ZXMua2V5W3JlY29yZF1dO2Vsc2UgcmVzdWx0PXN0cmluZy5leHBsb2RlKHJlY29yZCkubWFwKGZ1bmN0aW9uKGkpe2lmKCFpc05hTihpKSlyZXR1cm4gc2VsZi5yZWNvcmRzW3BhcnNlSW50KGksMTApXTtlbHNlIHJldHVybiBzZWxmLnJlY29yZHNbc2VsZi5pbmRleGVzLmtleVtpXV19KTsKZWxzZSBpZih0eXBlPT09Im51bWJlciIpaWYoaXNOYU4ob2Zmc2V0KSlyZXN1bHQ9dGhpcy5yZWNvcmRzW3BhcnNlSW50KHJlY29yZCwxMCldO2Vsc2UgcmVzdWx0PWFycmF5LmxpbWl0KHRoaXMucmVjb3JkcyxwYXJzZUludChyZWNvcmQsMTApLHBhcnNlSW50KG9mZnNldCwxMCkpO3JldHVybiB1dGlsaXR5LmNsb25lKHJlc3VsdCx0cnVlKX0sRGF0YVN0b3JlLnByb3RvdHlwZS5qb2luPWZ1bmN0aW9uKGFyZyxmaWVsZCxqb2luKXtqb2luPWpvaW58fCJpbm5lciI7dmFyIHNlbGY9dGhpcyxkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCkscmVzdWx0cz1bXSxkZWZlcnJlZHM9W10sa2V5PWZpZWxkPT09dGhpcy5rZXksa2V5cz1hcnJheS5tZXJnZShhcnJheS5rZXlzKHRoaXMucmVjb3Jkc1swXS5kYXRhKSxhcnJheS5rZXlzKGFyZy5yZWNvcmRzWzBdLmRhdGEpKSxmbjtpZihqb2luPT09ImlubmVyIilmbj1mdW5jdGlvbihpKXt2YXIgd2hlcmU9e30scmVjb3JkPWkuZGF0YSxkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCk7CndoZXJlW2ZpZWxkXT1rZXk/aS5rZXk6cmVjb3JkW2ZpZWxkXTthcmcuc2VsZWN0KHdoZXJlKS50aGVuKGZ1bmN0aW9uKG1hdGNoKXtpZihtYXRjaC5sZW5ndGg+MilkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmRhdGFiYXNlTW9yZVRoYW5PbmUpKTtlbHNlIGlmKG1hdGNoLmxlbmd0aD09PTEpe3Jlc3VsdHMucHVzaCh1dGlsaXR5Lm1lcmdlKHJlY29yZCxtYXRjaFswXS5kYXRhKSk7ZGVmZXIucmVzb2x2ZSh0cnVlKX1lbHNlIGRlZmVyLnJlc29sdmUoZmFsc2UpfSk7ZGVmZXJyZWRzLnB1c2goZGVmZXIpfTtlbHNlIGlmKGpvaW49PT0ibGVmdCIpZm49ZnVuY3Rpb24oaSl7dmFyIHdoZXJlPXt9LHJlY29yZD1pLmRhdGEsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpO3doZXJlW2ZpZWxkXT1rZXk/aS5rZXk6cmVjb3JkW2ZpZWxkXTthcmcuc2VsZWN0KHdoZXJlKS50aGVuKGZ1bmN0aW9uKG1hdGNoKXtpZihtYXRjaC5sZW5ndGg+MilkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmRhdGFiYXNlTW9yZVRoYW5PbmUpKTsKZWxzZSBpZihtYXRjaC5sZW5ndGg9PT0xKXtyZXN1bHRzLnB1c2godXRpbGl0eS5tZXJnZShyZWNvcmQsbWF0Y2hbMF0uZGF0YSkpO2RlZmVyLnJlc29sdmUodHJ1ZSl9ZWxzZXthcnJheS5lYWNoKGtleXMsZnVuY3Rpb24oaSl7aWYocmVjb3JkW2ldPT09dW5kZWZpbmVkKXJlY29yZFtpXT1udWxsfSk7cmVzdWx0cy5wdXNoKHJlY29yZCk7ZGVmZXIucmVzb2x2ZSh0cnVlKX19KTtkZWZlcnJlZHMucHVzaChkZWZlcil9O2Vsc2UgaWYoam9pbj09PSJyaWdodCIpZm49ZnVuY3Rpb24oaSl7dmFyIHdoZXJlPXt9LHJlY29yZD1pLmRhdGEsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpO3doZXJlW2ZpZWxkXT1rZXk/aS5rZXk6cmVjb3JkW2ZpZWxkXTtzZWxmLnNlbGVjdCh3aGVyZSkudGhlbihmdW5jdGlvbihtYXRjaCl7aWYobWF0Y2gubGVuZ3RoPjIpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5kYXRhYmFzZU1vcmVUaGFuT25lKSk7ZWxzZSBpZihtYXRjaC5sZW5ndGg9PT0xKXtyZXN1bHRzLnB1c2godXRpbGl0eS5tZXJnZShyZWNvcmQsCm1hdGNoWzBdLmRhdGEpKTtkZWZlci5yZXNvbHZlKHRydWUpfWVsc2V7YXJyYXkuZWFjaChrZXlzLGZ1bmN0aW9uKGkpe2lmKHJlY29yZFtpXT09PXVuZGVmaW5lZClyZWNvcmRbaV09bnVsbH0pO3Jlc3VsdHMucHVzaChyZWNvcmQpO2RlZmVyLnJlc29sdmUodHJ1ZSl9fSk7ZGVmZXJyZWRzLnB1c2goZGVmZXIpfTthcnJheS5lYWNoKHV0aWxpdHkuY2xvbmUoam9pbj09PSJyaWdodCI/YXJnLnJlY29yZHM6dGhpcy5yZWNvcmRzLHRydWUpLGZuKTt1dGlsaXR5LndoZW4oZGVmZXJyZWRzKS50aGVuKGZ1bmN0aW9uKCl7ZGVmZXIucmVzb2x2ZShyZXN1bHRzKX0sZnVuY3Rpb24oZSl7ZGVmZXIucmVqZWN0KGUpfSk7cmV0dXJuIGRlZmVyfTtEYXRhU3RvcmUucHJvdG90eXBlLm9ubHk9ZnVuY3Rpb24oYXJnKXtpZihhcmc9PT10aGlzLmtleSlyZXR1cm4gdGhpcy5yZWNvcmRzLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5rZXl9KTtlbHNlIHJldHVybiB0aGlzLnJlY29yZHMubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpLmRhdGFbYXJnXX0pfTsKRGF0YVN0b3JlLnByb3RvdHlwZS5wdXJnZT1mdW5jdGlvbihhcmcpe3JldHVybiB0aGlzLnN0b3JhZ2UoYXJnfHx0aGlzLCJyZW1vdmUiKX07RGF0YVN0b3JlLnByb3RvdHlwZS5yZWluZGV4PWZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcyxpPS0xLHRtcD1bXTt0aGlzLnZpZXdzPXt9O3RoaXMuaW5kZXhlcz17a2V5Ont9fTtpZih0aGlzLnRvdGFsPjApYXJyYXkuZWFjaCh0aGlzLnJlY29yZHMsZnVuY3Rpb24ocmVjb3JkKXtpZihyZWNvcmQhPT11bmRlZmluZWQpe3RtcFsrK2ldPXJlY29yZDtyZWNvcmQuaW5kZXg9aTtzZWxmLmluZGV4ZXMua2V5W3JlY29yZC5rZXldPWk7c2VsZi5zZXRJbmRleGVzKHJlY29yZCl9fSk7dGhpcy5yZWNvcmRzPXRtcDtyZXR1cm4gdGhpc307RGF0YVN0b3JlLnByb3RvdHlwZS5yZXN0b3JlPWZ1bmN0aW9uKGFyZyl7cmV0dXJuIHRoaXMuc3RvcmFnZShhcmd8fHRoaXMsImdldCIpfTtEYXRhU3RvcmUucHJvdG90eXBlLnNhdmU9ZnVuY3Rpb24oYXJnKXtyZXR1cm4gdGhpcy5zdG9yYWdlKGFyZ3x8CnRoaXMsInNldCIpfTtEYXRhU3RvcmUucHJvdG90eXBlLnNlbGVjdD1mdW5jdGlvbih3aGVyZSl7dmFyIHNlbGY9dGhpcyxkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCksZnVuY3Rpb25zPVtdLGNsYXVzZXMsY29uZCxpbmRleCxyZXN1bHQsc29ydGVkLHZhbHVlcyx3b3JrZXI7aWYoISh3aGVyZSBpbnN0YW5jZW9mIE9iamVjdCkpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKSk7ZWxzZXt1dGlsaXR5Lml0ZXJhdGUod2hlcmUsZnVuY3Rpb24odixrKXtpZih0eXBlb2Ygdj09ImZ1bmN0aW9uIil7dGhpc1trXT12LnRvU3RyaW5nKCk7ZnVuY3Rpb25zLnB1c2goayl9fSk7aWYod2ViV29ya2VyKXRyeXt3b3JrZXI9dXRpbGl0eS53b3JrZXIoZGVmZXIpO3dvcmtlci5wb3N0TWVzc2FnZSh7Y21kOiJzZWxlY3QiLGluZGV4ZXM6dGhpcy5pbmRleGVzLHJlY29yZHM6dGhpcy5yZWNvcmRzLHdoZXJlOmpzb24uZW5jb2RlKHdoZXJlKSxmdW5jdGlvbnM6ZnVuY3Rpb25zfSl9Y2F0Y2goZSl7d2ViV29ya2VyPQpmYWxzZTt0aGlzLnNlbGVjdCh3aGVyZSkudGhlbihmdW5jdGlvbihhcmcpe2RlZmVyLnJlc29sdmUoYXJnKX0sZnVuY3Rpb24oZSl7ZGVmZXIucmVqZWN0KGUpfSl9ZWxzZXtjbGF1c2VzPWFycmF5LmZyb21PYmplY3Qod2hlcmUpO3NvcnRlZD1hcnJheS5mbGF0KGNsYXVzZXMpLmZpbHRlcihmdW5jdGlvbihpLGlkeCl7cmV0dXJuIGlkeCUyPT09MH0pLnNvcnQoYXJyYXkuc29ydCk7aW5kZXg9c29ydGVkLmpvaW4oInwiKTt2YWx1ZXM9c29ydGVkLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gd2hlcmVbaV19KS5qb2luKCJ8Iik7Y29uZD0icmV0dXJuICggIjtpZihmdW5jdGlvbnMubGVuZ3RoPT09MCYmdGhpcy5pbmRleGVzW2luZGV4XSlyZXN1bHQ9KHRoaXMuaW5kZXhlc1tpbmRleF1bdmFsdWVzXXx8W10pLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gc2VsZi5yZWNvcmRzW2ldfSk7ZWxzZXtpZihjbGF1c2VzLmxlbmd0aD4xKWFycmF5LmVhY2goY2xhdXNlcyxmdW5jdGlvbihpLGlkeCl7dmFyIGIxPQoiKCAiO2lmKGlkeD4wKWIxPSIgJiYgKCAiO2lmKGlbMV1pbnN0YW5jZW9mIEZ1bmN0aW9uKWNvbmQrPWIxK2lbMV0udG9TdHJpbmcoKSsnKCByZWMuZGF0YVsiJytpWzBdKyciXSApICknO2Vsc2UgaWYoIWlzTmFOKGlbMV0pKWNvbmQrPWIxKydyZWMuZGF0YVsiJytpWzBdKyciXSA9PT0gJytpWzFdKyIgKSI7ZWxzZSBjb25kKz1iMSsncmVjLmRhdGFbIicraVswXSsnIl0gPT09ICInK2lbMV0rJyIgKSd9KTtlbHNlIGlmKGNsYXVzZXNbMF1bMV1pbnN0YW5jZW9mIEZ1bmN0aW9uKWNvbmQrPWNsYXVzZXNbMF1bMV0udG9TdHJpbmcoKSsnKCByZWMuZGF0YVsiJytjbGF1c2VzWzBdWzBdKyciXSApJztlbHNlIGlmKCFpc05hTihjbGF1c2VzWzBdWzFdKSljb25kKz0ncmVjLmRhdGFbIicrY2xhdXNlc1swXVswXSsnIl0gPT09ICcrY2xhdXNlc1swXVsxXTtlbHNlIGNvbmQrPSdyZWMuZGF0YVsiJytjbGF1c2VzWzBdWzBdKyciXSA9PT0gIicrY2xhdXNlc1swXVsxXSsnIic7Y29uZCs9IiApOyI7CnJlc3VsdD11dGlsaXR5LmNsb25lKHRoaXMucmVjb3Jkcyx0cnVlKS5maWx0ZXIobmV3IEZ1bmN0aW9uKCJyZWMiLGNvbmQpKX1kZWZlci5yZXNvbHZlKHJlc3VsdCl9fXJldHVybiBkZWZlcn07RGF0YVN0b3JlLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oa2V5LGRhdGEsYmF0Y2gsb3ZlcndyaXRlKXtkYXRhPXV0aWxpdHkuY2xvbmUoZGF0YSx0cnVlKTtiYXRjaD1iYXRjaD09PXRydWU7b3ZlcndyaXRlPW92ZXJ3cml0ZT09PXRydWU7dmFyIHNlbGY9dGhpcyxldmVudHM9dGhpcy5ldmVudHMsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpLHJlY29yZD1rZXkhPT1udWxsP3RoaXMuZ2V0KGtleSl8fG51bGw6ZGF0YVt0aGlzLmtleV0/dGhpcy5nZXQoZGF0YVt0aGlzLmtleV0pfHxudWxsOm51bGwsbWV0aG9kPSJQT1NUIixwYXJzZWQ9dXRpbGl0eS5wYXJzZShzZWxmLnVyaXx8IiIpLHVyaSxvZGF0YSxyZGVmZXI7ZnVuY3Rpb24gcGF0Y2gob3ZlcndyaXRlLGRhdGEsb2dkYXRhKXt2YXIgbmRhdGE9CltdO2lmKG92ZXJ3cml0ZSlhcnJheS5lYWNoKGFycmF5LmtleXMob2dkYXRhKSxmdW5jdGlvbihrKXtpZihrIT09c2VsZi5rZXkmJmRhdGFba109PT11bmRlZmluZWQpbmRhdGEucHVzaCh7b3A6InJlbW92ZSIscGF0aDoiLyIra30pfSk7dXRpbGl0eS5pdGVyYXRlKGRhdGEsZnVuY3Rpb24odixrKXtpZihrIT09c2VsZi5rZXkmJm9nZGF0YVtrXT09PXVuZGVmaW5lZCluZGF0YS5wdXNoKHtvcDoiYWRkIixwYXRoOiIvIitrLHZhbHVlOnZ9KTtlbHNlIGlmKGpzb24uZW5jb2RlKG9nZGF0YVtrXSkhPT1qc29uLmVuY29kZSh2KSluZGF0YS5wdXNoKHtvcDoicmVwbGFjZSIscGF0aDoiLyIrayx2YWx1ZTp2fSl9KTtyZXR1cm4gbmRhdGF9aWYodHlwZW9mIGRhdGE9PSJzdHJpbmciKXtpZihkYXRhLmluZGV4T2YoIi8vIik9PT0tMSlpZihkYXRhLmNoYXJBdCgwKSE9PSIvIil1cmk9dGhpcy5idWlsZFVyaShkYXRhKTtlbHNlIGlmKHNlbGYudXJpIT09bnVsbCYmcmVnZXgucm9vdC50ZXN0KGRhdGEpKXVyaT0KcGFyc2VkLnByb3RvY29sKyIvLyIrcGFyc2VkLmhvc3QrZGF0YTtlbHNlIHVyaT1kYXRhO2Vsc2UgdXJpPWRhdGE7a2V5PXVyaS5yZXBsYWNlKHJlZ2V4Lm5vdF9lbmRwb2ludCwiIik7aWYoc3RyaW5nLmlzRW1wdHkoa2V5KSlkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpKTtlbHNle2lmKCFiYXRjaCYmZXZlbnRzKXNlbGYuZGlzcGF0Y2goImJlZm9yZVNldCIse2tleTprZXksZGF0YTpkYXRhfSk7Y2xpZW50LnJlcXVlc3QodXJpLCJHRVQiLG51bGwsdXRpbGl0eS5tZXJnZSh7d2l0aENyZWRlbnRpYWxzOnNlbGYuY3JlZGVudGlhbHN9LHNlbGYuaGVhZGVycykpLnRoZW4oZnVuY3Rpb24oYXJnKXtzZWxmLnNldENvbXBsZXRlKHJlY29yZCxrZXksc2VsZi5zb3VyY2U/dXRpbGl0eS53YWxrKGFyZyxzZWxmLnNvdXJjZSk6YXJnLGJhdGNoLG92ZXJ3cml0ZSxkZWZlcil9LGZ1bmN0aW9uKGUpe3NlbGYuZGlzcGF0Y2goImZhaWxlZFNldCIsZSk7ZGVmZXIucmVqZWN0KGUpfSl9fWVsc2V7aWYoIWJhdGNoJiYKZXZlbnRzKXNlbGYuZGlzcGF0Y2goImJlZm9yZVNldCIse2tleTprZXksZGF0YTpkYXRhfSk7aWYoYmF0Y2h8fHRoaXMudXJpPT09bnVsbCl0aGlzLnNldENvbXBsZXRlKHJlY29yZCxrZXksZGF0YSxiYXRjaCxvdmVyd3JpdGUsZGVmZXIpO2Vsc2V7aWYoa2V5IT09bnVsbCl7dXJpPXRoaXMuYnVpbGRVcmkoa2V5KTttZXRob2Q9IlBBVENIIjtvZGF0YT11dGlsaXR5LmNsb25lKGRhdGEsdHJ1ZSk7ZGF0YT1wYXRjaChvdmVyd3JpdGUsZGF0YSx0aGlzLmR1bXAoW3JlY29yZF0pWzBdKX1lbHNlIHVyaT1wYXJzZWQucHJvdG9jb2wrIi8vIitwYXJzZWQuaG9zdCtwYXJzZWQucGF0aG5hbWU7cmRlZmVyPWNsaWVudC5yZXF1ZXN0KHVyaSxtZXRob2QsZGF0YSx1dGlsaXR5Lm1lcmdlKHt3aXRoQ3JlZGVudGlhbHM6dGhpcy5jcmVkZW50aWFsc30sdGhpcy5oZWFkZXJzKSk7cmRlZmVyLnRoZW4oZnVuY3Rpb24oYXJnKXt2YXIgY2hhbmdlO2lmKHJkZWZlci54aHIuc3RhdHVzIT09MjA0JiZyZGVmZXIueGhyLnN0YXR1czwKMzAwKWNoYW5nZT1rZXk9PT1udWxsP3NlbGYuc291cmNlP3V0aWxpdHkud2Fsayhhcmcsc2VsZi5zb3VyY2UpOmFyZzpvZGF0YTtlbHNlIGNoYW5nZT1vZGF0YTtzZWxmLnNldENvbXBsZXRlKHJlY29yZCxrZXksY2hhbmdlLGJhdGNoLG92ZXJ3cml0ZSxkZWZlcil9LGZ1bmN0aW9uKGUpe2lmKG1ldGhvZD09IlBBVENIIil7bWV0aG9kPSJQVVQiO2RhdGE9dXRpbGl0eS5jbG9uZShvZGF0YSx0cnVlKTt1dGlsaXR5Lml0ZXJhdGUocmVjb3JkLmRhdGEsZnVuY3Rpb24odixrKXtkYXRhW2tdPXZ9KTtjbGllbnQucmVxdWVzdCh1cmksbWV0aG9kLGRhdGEsdXRpbGl0eS5tZXJnZSh7d2l0aENyZWRlbnRpYWxzOnNlbGYuY3JlZGVudGlhbHN9LHNlbGYuaGVhZGVycykpLnRoZW4oZnVuY3Rpb24oKXtzZWxmLnNldENvbXBsZXRlKHJlY29yZCxrZXksb2RhdGEsYmF0Y2gsb3ZlcndyaXRlLGRlZmVyKX0sZnVuY3Rpb24oZSl7c2VsZi5kaXNwYXRjaCgiZmFpbGVkU2V0IixlKTtkZWZlci5yZWplY3QoZSl9KX1lbHNle3NlbGYuZGlzcGF0Y2goImZhaWxlZFNldCIsCmUpO2RlZmVyLnJlamVjdChlKX19KX19cmV0dXJuIGRlZmVyfTtEYXRhU3RvcmUucHJvdG90eXBlLnNldENvbXBsZXRlPWZ1bmN0aW9uKHJlY29yZCxrZXksZGF0YSxiYXRjaCxvdmVyd3JpdGUsZGVmZXIpe3RoaXMudmlld3M9e307aWYoa2V5PT09bnVsbClpZih0aGlzLmtleSE9PW51bGwmJmRhdGFbdGhpcy5rZXldIT09dW5kZWZpbmVkJiZkYXRhW3RoaXMua2V5XSE9PW51bGwpa2V5PWRhdGFbdGhpcy5rZXldLnRvU3RyaW5nKCk7ZWxzZSBrZXk9dXRpbGl0eS51dWlkKCk7aWYodGhpcy5rZXkpZGVsZXRlIGRhdGFbdGhpcy5rZXldO2lmKHJlY29yZD09PW51bGwpe3JlY29yZD17aW5kZXg6dGhpcy50b3RhbCsrLGtleTprZXksZGF0YTpkYXRhLGluZGV4ZXM6W119O3RoaXMuaW5kZXhlcy5rZXlba2V5XT1yZWNvcmQuaW5kZXg7dGhpcy5yZWNvcmRzW3JlY29yZC5pbmRleF09cmVjb3JkO2lmKHRoaXMudmVyc2lvbmluZyl7dGhpcy52ZXJzaW9uc1tyZWNvcmQua2V5XT1scnUuZmFjdG9yeShWRVJTSU9OUyk7CnRoaXMudmVyc2lvbnNbcmVjb3JkLmtleV0ubnRoPTB9fWVsc2V7aWYodGhpcy52ZXJzaW9uaW5nKXtpZih0aGlzLnZlcnNpb25zW3JlY29yZC5rZXldPT09dW5kZWZpbmVkKXt0aGlzLnZlcnNpb25zW3JlY29yZC5rZXldPWxydS5mYWN0b3J5KFZFUlNJT05TKTt0aGlzLnZlcnNpb25zW3JlY29yZC5rZXldLm50aD0wfXRoaXMudmVyc2lvbnNbcmVjb3JkLmtleV0uc2V0KCJ2IisgKyt0aGlzLnZlcnNpb25zW3JlY29yZC5rZXldLm50aCx0aGlzLmR1bXAoW3JlY29yZF0pWzBdKX1yZWNvcmQ9dGhpcy5yZWNvcmRzW3JlY29yZC5pbmRleF07aWYob3ZlcndyaXRlKXJlY29yZC5kYXRhPXt9O3V0aWxpdHkuaXRlcmF0ZShkYXRhLGZ1bmN0aW9uKHYsayl7cmVjb3JkLmRhdGFba109dn0pO3JlY29yZD11dGlsaXR5LmNsb25lKHJlY29yZCx0cnVlKX10aGlzLnNldEluZGV4ZXMocmVjb3JkKTtpZighYmF0Y2gpe2lmKHRoaXMuYXV0b3NhdmUpdGhpcy5zYXZlKCk7aWYodGhpcy5ldmVudHMpdGhpcy5kaXNwYXRjaCgiYWZ0ZXJTZXQiLApyZWNvcmQpO2FycmF5LmVhY2godGhpcy5saXN0cyxmdW5jdGlvbihpKXtpLnJlZnJlc2goKX0pfWRlZmVyLnJlc29sdmUocmVjb3JkKTtyZXR1cm4gdGhpc307RGF0YVN0b3JlLnByb3RvdHlwZS5zZXRFeHBpcmVzPWZ1bmN0aW9uKGFyZyl7dmFyIGlkPXRoaXMuaWQrIkV4cGlyZSIsZXhwaXJlcz1hcmcsc2VsZj10aGlzO2lmKGFyZyE9PW51bGwmJnRoaXMudXJpPT09bnVsbHx8YXJnIT09bnVsbCYmKGlzTmFOKGFyZyl8fGFyZzwxRTMpKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTtpZih0aGlzLmV4cGlyZXM9PT1hcmcpcmV0dXJuO3RoaXMuZXhwaXJlcz1hcmc7dXRpbGl0eS5jbGVhclRpbWVycyhpZCk7aWYoYXJnPT09bnVsbClyZXR1cm47dXRpbGl0eS5yZXBlYXQoZnVuY3Rpb24oKXtpZihzZWxmLnVyaT09PW51bGwpe3NlbGYuc2V0RXhwaXJlcyhudWxsKTtyZXR1cm4gZmFsc2V9c2VsZi5kaXNwYXRjaCgiYmVmb3JlRXhwaXJlIik7Y2FjaGUuZXhwaXJlKHNlbGYudXJpKTsKc2VsZi5kaXNwYXRjaCgiZXhwaXJlIik7c2VsZi5kaXNwYXRjaCgiYWZ0ZXJFeHBpcmUiKX0sZXhwaXJlcyxpZCxmYWxzZSl9O0RhdGFTdG9yZS5wcm90b3R5cGUuc2V0SW5kZXhlcz1mdW5jdGlvbihhcmcpe3ZhciBzZWxmPXRoaXMsZGVsaW10ZXI9InwiO2FyZy5pbmRleGVzPVtdO2FycmF5LmVhY2godGhpcy5pbmRleCxmdW5jdGlvbihpKXt2YXIga2V5cz1pLnNwbGl0KGRlbGltdGVyKSx2YWx1ZXM9IiI7aWYoc2VsZi5pbmRleGVzW2ldPT09dW5kZWZpbmVkKXNlbGYuaW5kZXhlc1tpXT17fTthcnJheS5lYWNoKGtleXMsZnVuY3Rpb24oayxrZHgpe3ZhbHVlcys9KGtkeD4wP2RlbGltdGVyOiIiKSthcmcuZGF0YVtrXX0pO2lmKHNlbGYuaW5kZXhlc1tpXVt2YWx1ZXNdPT09dW5kZWZpbmVkKXNlbGYuaW5kZXhlc1tpXVt2YWx1ZXNdPVtdO2lmKCFhcnJheS5jb250YWlucyhzZWxmLmluZGV4ZXNbaV1bdmFsdWVzXSxhcmcuaW5kZXgpKXtzZWxmLmluZGV4ZXNbaV1bdmFsdWVzXS5wdXNoKGFyZy5pbmRleCk7CmFyZy5pbmRleGVzLnB1c2goW2ksdmFsdWVzXSl9fSk7cmV0dXJuIHRoaXN9O0RhdGFTdG9yZS5wcm90b3R5cGUuc2V0VXJpPWZ1bmN0aW9uKGFyZyl7dmFyIGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSxwYXJzZWQ7aWYoYXJnIT09bnVsbCYmc3RyaW5nLmlzRW1wdHkoYXJnKSlkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpKTtpZihhcmc9PT1udWxsKXRoaXMudXJpPWFyZztlbHNle3BhcnNlZD11dGlsaXR5LnBhcnNlKGFyZyk7dGhpcy51cmk9cGFyc2VkLnByb3RvY29sKyIvLyIrcGFyc2VkLmhvc3QrcGFyc2VkLnBhdGg7aWYoIXN0cmluZy5pc0VtcHR5KHBhcnNlZC5hdXRoKSYmIXRoaXMuaGVhZGVycy5hdXRob3JpemF0aW9uJiYhdGhpcy5oZWFkZXJzLkF1dGhvcml6YXRpb24pdGhpcy5oZWFkZXJzLkF1dGhvcml6YXRpb249IkJhc2ljICIrYnRvYShkZWNvZGVVUklDb21wb25lbnQocGFyc2VkLmF1dGgpKTt0aGlzLm9uKCJleHBpcmUiLGZ1bmN0aW9uKCl7dGhpcy5zeW5jKCl9LAoicmVzeW5jIix0aGlzKTtjYWNoZS5leHBpcmUodGhpcy51cmkpO3RoaXMuc3luYygpLnRoZW4oZnVuY3Rpb24oYXJnKXtkZWZlci5yZXNvbHZlKGFyZyl9LGZ1bmN0aW9uKGUpe2RlZmVyLnJlamVjdChlKX0pfXJldHVybiBkZWZlcn07RGF0YVN0b3JlLnByb3RvdHlwZS5zb3J0PWZ1bmN0aW9uKHF1ZXJ5LGNyZWF0ZSx3aGVyZSl7Y3JlYXRlPWNyZWF0ZT09PXRydWV8fHdoZXJlIGluc3RhbmNlb2YgT2JqZWN0O3ZhciBzZWxmPXRoaXMsdmlldz1zdHJpbmcudG9DYW1lbENhc2Uoc3RyaW5nLmV4cGxvZGUocXVlcnkpLmpvaW4oIiAiKSksZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpLG5leHQsd29ya2VyO25leHQ9ZnVuY3Rpb24ocmVjb3Jkcyl7aWYoc2VsZi50b3RhbD09PTApZGVmZXIucmVzb2x2ZShbXSk7ZWxzZSBpZighY3JlYXRlJiZzZWxmLnZpZXdzW3ZpZXddKWRlZmVyLnJlc29sdmUoc2VsZi52aWV3c1t2aWV3XSk7ZWxzZSBpZih3ZWJXb3JrZXIpe2RlZmVyLnRoZW4oZnVuY3Rpb24oYXJnKXtzZWxmLnZpZXdzW3ZpZXddPQphcmc7cmV0dXJuIHNlbGYudmlld3Nbdmlld119LGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSl9KTt0cnl7d29ya2VyPXV0aWxpdHkud29ya2VyKGRlZmVyKTt3b3JrZXIucG9zdE1lc3NhZ2Uoe2NtZDoic29ydCIsaW5kZXhlczpzZWxmLmluZGV4ZXMscmVjb3JkczpyZWNvcmRzLHF1ZXJ5OnF1ZXJ5fSl9Y2F0Y2goZSl7d2ViV29ya2VyPWZhbHNlO3NlbGYudmlld3Nbdmlld109YXJyYXkua2V5U29ydChyZWNvcmRzLHF1ZXJ5LCJkYXRhIik7ZGVmZXIucmVzb2x2ZShzZWxmLnZpZXdzW3ZpZXddKX19ZWxzZXtzZWxmLnZpZXdzW3ZpZXddPWFycmF5LmtleVNvcnQocmVjb3JkcyxxdWVyeSwiZGF0YSIpO2RlZmVyLnJlc29sdmUoc2VsZi52aWV3c1t2aWV3XSl9fTtpZighd2hlcmUpbmV4dCh1dGlsaXR5LmNsb25lKHRoaXMucmVjb3Jkcyx0cnVlKSk7ZWxzZSB0aGlzLnNlbGVjdCh3aGVyZSkudGhlbihuZXh0LGZ1bmN0aW9uKGUpe2RlZmVyLnJlamVjdChlKX0pO3JldHVybiBkZWZlcn07CkRhdGFTdG9yZS5wcm90b3R5cGUuc3RvcmFnZT1mdW5jdGlvbihvYmosb3AsdHlwZSl7dmFyIHNlbGY9dGhpcyxyZWNvcmQ9ZmFsc2UsbW9uZ289IXN0cmluZy5pc0VtcHR5KHRoaXMubW9uZ29kYiksc2Vzc2lvbj10eXBlPT09InNlc3Npb24iJiZ0eXBlb2Ygc2Vzc2lvblN0b3JhZ2UhPSJ1bmRlZmluZWQiLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSxkYXRhLGtleSxyZXN1bHQ7aWYoIXJlZ2V4Lm51bWJlcl9zdHJpbmdfb2JqZWN0LnRlc3QodHlwZW9mIG9iail8fCFyZWdleC5nZXRfcmVtb3ZlX3NldC50ZXN0KG9wKSlkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpKTtlbHNle3JlY29yZD1yZWdleC5udW1iZXJfc3RyaW5nLnRlc3QodHlwZW9mIG9iail8fG9iai5oYXNPd25Qcm9wZXJ0eSgiZGF0YSIpO2lmKG9wIT09InJlbW92ZSIpe2lmKHJlY29yZCYmIShvYmogaW5zdGFuY2VvZiBPYmplY3QpKW9iaj10aGlzLmdldChvYmopO2tleT1yZWNvcmQ/Cm9iai5rZXk6b2JqLmlkfWVsc2UgaWYob3A9PT0icmVtb3ZlIiYmcmVjb3JkKWtleT1vYmoua2V5fHxvYmo7aWYobW9uZ28pbW9uZ29kYi5jb25uZWN0KHRoaXMubW9uZ29kYixmdW5jdGlvbihlLGRiKXtpZihlKXtpZihkYilkYi5jbG9zZSgpO3JldHVybiBkZWZlci5yZWplY3QoZSl9ZGIuY29sbGVjdGlvbihzZWxmLmlkLGZ1bmN0aW9uKGUsY29sbGVjdGlvbil7aWYoZSl7ZGIuY2xvc2UoKTtyZXR1cm4gZGVmZXIucmVqZWN0KGUpfWlmKG9wPT09ImdldCIpaWYocmVjb3JkKWNvbGxlY3Rpb24uZmluZCh7X2lkOm9iai5rZXl9KS5saW1pdCgxKS50b0FycmF5KGZ1bmN0aW9uKGUscmVjcyl7ZGIuY2xvc2UoKTtpZihlKWRlZmVyLnJlamVjdChlKTtlbHNlIGlmKHJlY3MubGVuZ3RoPT09MClkZWZlci5yZXNvbHZlKG51bGwpO2Vsc2V7ZGVsZXRlIHJlY3NbMF0uX2lkO3NlbGYuc2V0KGtleSxyZWNzWzBdLHRydWUpLnRoZW4oZnVuY3Rpb24ocmVjKXtkZWZlci5yZXNvbHZlKHJlYyl9LApmdW5jdGlvbihlKXtkZWZlci5yZWplY3QoZSl9KX19KTtlbHNlIGNvbGxlY3Rpb24uZmluZCh7fSkudG9BcnJheShmdW5jdGlvbihlLHJlY3Mpe3ZhciBpLG50aDtpZihlKXtkYi5jbG9zZSgpO3JldHVybiBkZWZlci5yZWplY3QoZSl9aT0tMTtudGg9cmVjcy5sZW5ndGg7aWYobnRoPjApe3NlbGYucmVjb3Jkcz1yZWNzLm1hcChmdW5jdGlvbihyKXt2YXIgcmVjPXtrZXk6ci5faWQsaW5kZXg6KytpLGRhdGE6e319O3NlbGYuaW5kZXhlcy5rZXlbcmVjLmtleV09cmVjLmluZGV4O3JlYy5kYXRhPXI7ZGVsZXRlIHJlYy5kYXRhLl9pZDtzZWxmLnNldEluZGV4ZXMocmVjKTtyZXR1cm4gcmVjfSk7c2VsZi50b3RhbD1udGh9ZGIuY2xvc2UoKTtkZWZlci5yZXNvbHZlKHNlbGYucmVjb3Jkcyl9KTtlbHNlIGlmKG9wPT09InJlbW92ZSIpY29sbGVjdGlvbi5yZW1vdmUocmVjb3JkP3tfaWQ6a2V5fTp7fSx7c2FmZTp0cnVlfSxmdW5jdGlvbihlLGFyZyl7ZGIuY2xvc2UoKTtpZihlKWRlZmVyLnJlamVjdChlKTsKZWxzZSBkZWZlci5yZXNvbHZlKGFyZyl9KTtlbHNlIGlmKG9wPT09InNldCIpaWYocmVjb3JkKWNvbGxlY3Rpb24udXBkYXRlKHtfaWQ6b2JqLmtleX0sb2JqLmRhdGEse3c6MSxzYWZlOnRydWUsdXBzZXJ0OnRydWV9LGZ1bmN0aW9uKGUsYXJnKXtkYi5jbG9zZSgpO2lmKGUpZGVmZXIucmVqZWN0KGUpO2Vsc2UgZGVmZXIucmVzb2x2ZShhcmcpfSk7ZWxzZSBjb2xsZWN0aW9uLnJlbW92ZSh7fSx7dzoxLHNhZmU6dHJ1ZX0sZnVuY3Rpb24oZSl7dmFyIGRlZmVycmVkcztpZihlKXtkYi5jbG9zZSgpO3JldHVybiBkZWZlci5yZWplY3QoZSl9ZWxzZXtkZWZlcnJlZHM9W107YXJyYXkuZWFjaChzZWxmLnJlY29yZHMsZnVuY3Rpb24oaSl7dmFyIGRhdGE9e30sZGVmZXIyPWRlZmVycmVkLmZhY3RvcnkoKTtkZWZlcnJlZHMucHVzaChkZWZlcjIpO3V0aWxpdHkuaXRlcmF0ZShpLmRhdGEsZnVuY3Rpb24odixrKXtkYXRhW2tdPXZ9KTtjb2xsZWN0aW9uLnVwZGF0ZSh7X2lkOmkua2V5fSxkYXRhLAp7dzoxLHNhZmU6dHJ1ZSx1cHNlcnQ6dHJ1ZX0sZnVuY3Rpb24oZSxhcmcpe2lmKGUpZGVmZXIyLnJlamVjdChlKTtlbHNlIGRlZmVyMi5yZXNvbHZlKGFyZyl9KX0pO3V0aWxpdHkud2hlbihkZWZlcnJlZHMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtkYi5jbG9zZSgpO2RlZmVyLnJlc29sdmUocmVzdWx0KX0sZnVuY3Rpb24oZSl7ZGIuY2xvc2UoKTtkZWZlci5yZWplY3QoZSl9KX19KTtlbHNle2RiLmNsb3NlKCk7ZGVmZXIucmVqZWN0KG51bGwpfX0pfSk7ZWxzZSBpZihvcD09PSJnZXQiKXtyZXN1bHQ9c2Vzc2lvbj9zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKGtleSk6bG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtpZihyZXN1bHQhPT1udWxsKXtyZXN1bHQ9anNvbi5kZWNvZGUocmVzdWx0KTtpZihyZWNvcmQpc2VsZi5zZXQoa2V5LHJlc3VsdCx0cnVlKS50aGVuKGZ1bmN0aW9uKHJlYyl7ZGVmZXIucmVzb2x2ZShyZWMpfSxmdW5jdGlvbihlKXtkZWZlci5yZWplY3QoZSl9KTtlbHNle3V0aWxpdHkubWVyZ2Uoc2VsZiwKcmVzdWx0KTtkZWZlci5yZXNvbHZlKHNlbGYpfX1lbHNlIGRlZmVyLnJlc29sdmUoc2VsZik7ZGVmZXIudGhlbihmdW5jdGlvbigpe3NlbGYubG9hZGVkPXRydWV9LGZ1bmN0aW9uKGUpe3Rocm93IGU7fSl9ZWxzZSBpZihvcD09PSJyZW1vdmUiKXtzZXNzaW9uP3Nlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTpsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO2RlZmVyLnJlc29sdmUodGhpcyl9ZWxzZSBpZihvcD09PSJzZXQiKXtkYXRhPWpzb24uZW5jb2RlKHJlY29yZD9vYmouZGF0YTp7dG90YWw6dGhpcy50b3RhbCxpbmRleDp0aGlzLmluZGV4LGluZGV4ZXM6dGhpcy5pbmRleGVzLHJlY29yZHM6dGhpcy5yZWNvcmRzfSk7c2Vzc2lvbj9zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKGtleSxkYXRhKTpsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksZGF0YSk7ZGVmZXIucmVzb2x2ZSh0aGlzKX1lbHNlIGRlZmVyLnJlamVjdChudWxsKX1yZXR1cm4gZGVmZXJ9O0RhdGFTdG9yZS5wcm90b3R5cGUuc3luYz0KZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzLGV2ZW50cz10aGlzLmV2ZW50cz09PXRydWUsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpLHN1Y2Nlc3MsZmFpbHVyZTtzdWNjZXNzPWZ1bmN0aW9uKGFyZyl7dmFyIGRhdGE7aWYodHlwZW9mIGFyZyE9Im9iamVjdCIpcmV0dXJuIGZhaWx1cmUobmV3IEVycm9yKGxhYmVsLmV4cGVjdGVkT2JqZWN0KSk7aWYoc2VsZi5zb3VyY2UhPT1udWxsKWFyZz11dGlsaXR5LndhbGsoYXJnLHNlbGYuc291cmNlKTtpZihhcmcgaW5zdGFuY2VvZiBBcnJheSlkYXRhPWFyZztlbHNlIGRhdGE9W2FyZ107c2VsZi5iYXRjaCgic2V0IixkYXRhLHRydWUpLnRoZW4oZnVuY3Rpb24oYXJnKXtpZihldmVudHMpc2VsZi5kaXNwYXRjaCgiYWZ0ZXJTeW5jIixhcmcpO2RlZmVyLnJlc29sdmUoYXJnKX0sZmFpbHVyZSl9O2ZhaWx1cmU9ZnVuY3Rpb24oZSl7aWYoZXZlbnRzKXNlbGYuZGlzcGF0Y2goImZhaWxlZFN5bmMiLGUpO2RlZmVyLnJlamVjdChlKX07aWYodGhpcy51cmk9PT0KbnVsbHx8c3RyaW5nLmlzRW1wdHkodGhpcy51cmkpKWRlZmVyLnJlamVjdChuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cykpO2Vsc2V7aWYoZXZlbnRzKXRoaXMuZGlzcGF0Y2goImJlZm9yZVN5bmMiLHRoaXMudXJpKTtpZih0aGlzLmNhbGxiYWNrIT09bnVsbCljbGllbnQuanNvbnAodGhpcy51cmkse2NhbGxiYWNrOnRoaXMuY2FsbGJhY2t9KS50aGVuKHN1Y2Nlc3MsZmFpbHVyZSk7ZWxzZSBjbGllbnQucmVxdWVzdCh0aGlzLnVyaSwiR0VUIixudWxsLHV0aWxpdHkubWVyZ2Uoe3dpdGhDcmVkZW50aWFsczp0aGlzLmNyZWRlbnRpYWxzfSx0aGlzLmhlYWRlcnMpKS50aGVuKHN1Y2Nlc3MsZmFpbHVyZSl9cmV0dXJuIGRlZmVyfTtEYXRhU3RvcmUucHJvdG90eXBlLnRlYXJkb3duPWZ1bmN0aW9uKCl7dmFyIHVyaT10aGlzLnVyaSxpZDtpZih1cmkhPT1udWxsKXtjYWNoZS5leHBpcmUodXJpLHRydWUpO2lkPXRoaXMuaWQrIkRhdGFFeHBpcmUiO3V0aWxpdHkuY2xlYXJUaW1lcnMoaWQpOwphcnJheS5lYWNoKHRoaXMucmVjb3JkcyxmdW5jdGlvbihpKXt2YXIgcmVjb3JkVXJpPXVyaSsiLyIraS5rZXk7Y2FjaGUuZXhwaXJlKHJlY29yZFVyaSx0cnVlKX0pfWFycmF5LmVhY2godGhpcy5saXN0cyxmdW5jdGlvbihpKXtpLnRlYXJkb3duKHRydWUpfSk7dGhpcy5jbGVhcih0cnVlKTt0aGlzLmRpc3BhdGNoKCJhZnRlclRlYXJkb3duIik7cmV0dXJuIHRoaXN9O0RhdGFTdG9yZS5wcm90b3R5cGUudW5kbz1mdW5jdGlvbihrZXksdmVyc2lvbil7dmFyIHJlY29yZD10aGlzLmdldChrZXkpLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSx2ZXJzaW9ucz10aGlzLnZlcnNpb25zW3JlY29yZC5rZXldLHByZXZpb3VzO2lmKHJlY29yZD09PXVuZGVmaW5lZClkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpKTtlbHNlIGlmKHZlcnNpb25zKXtwcmV2aW91cz12ZXJzaW9ucy5nZXQodmVyc2lvbnx8dmVyc2lvbnMuZmlyc3QpO2lmKHByZXZpb3VzPT09dW5kZWZpbmVkKWRlZmVyLnJlamVjdChsYWJlbC5kYXRhc3RvcmVOb1ByZXZWZXJzaW9uKTsKZWxzZSB0aGlzLnNldChrZXkscHJldmlvdXMpLnRoZW4oZnVuY3Rpb24oYXJnKXtkZWZlci5yZXNvbHZlKGFyZyl9LGZ1bmN0aW9uKGUpe2RlZmVyLnJlamVjdChlKX0pfWVsc2UgZGVmZXIucmVqZWN0KGxhYmVsLmRhdGFzdG9yZU5vUHJldlZlcnNpb24pO3JldHVybiBkZWZlcn07RGF0YVN0b3JlLnByb3RvdHlwZS51bmlxdWU9ZnVuY3Rpb24oa2V5KXtyZXR1cm4gYXJyYXkudW5pcXVlKHRoaXMucmVjb3Jkcy5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuZGF0YVtrZXldfSkpfTtEYXRhU3RvcmUucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbihrZXksZGF0YSl7dmFyIHJlY29yZD10aGlzLmdldChrZXkpLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKTtpZihyZWNvcmQ9PT11bmRlZmluZWQpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKSk7ZWxzZSB0aGlzLnNldChrZXksdXRpbGl0eS5tZXJnZShyZWNvcmQuZGF0YSxkYXRhKSkudGhlbihmdW5jdGlvbihhcmcpe2RlZmVyLnJlc29sdmUoYXJnKX0sCmZ1bmN0aW9uKGUpe2RlZmVyLnJlamVjdChlKX0pO3JldHVybiBkZWZlcn07dmFyIHN0cmluZz17Y2FwaXRhbGl6ZTpmdW5jdGlvbihvYmosYWxsKXthbGw9YWxsPT09dHJ1ZTt2YXIgcmVzdWx0O2lmKGFsbClyZXN1bHQ9c3RyaW5nLmV4cGxvZGUob2JqLCIgIikubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK2kuc2xpY2UoMSl9KS5qb2luKCIgIik7ZWxzZSByZXN1bHQ9b2JqLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK29iai5zbGljZSgxKTtyZXR1cm4gcmVzdWx0fSxlc2NhcGU6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gb2JqLnJlcGxhY2UoL1tcLVxbXF17fSgpKis/LixcXFwvXF5cJHwjXHNdL2csIlxcJCYiKX0sZXhwbG9kZTpmdW5jdGlvbihvYmosYXJnKXthcmc9YXJnfHwiLCI7cmV0dXJuIHN0cmluZy50cmltKG9iaikuc3BsaXQobmV3IFJlZ0V4cCgiXFxzKiIrYXJnKyJcXHMqIikpfSxmcm9tT2JqZWN0OmZ1bmN0aW9uKG9iaixuYW1lKXt2YXIgcmVzdWx0PQoobmFtZT9uYW1lKyIgPSB7IjoieyIpKyJcbiI7dXRpbGl0eS5pdGVyYXRlKG9iaixmdW5jdGlvbih2LGspe3Jlc3VsdCs9JyInK2srJyI6Jyt2LnRvU3RyaW5nKCkrIixcbiJ9KTtyZXN1bHQ9cmVzdWx0LnJlcGxhY2UoL1xbb2JqZWN0IE9iamVjdFxdL2csInt9IikucmVwbGFjZSgvLFxuJC8sIlxuIikrIn0iO3JldHVybiByZXN1bHR9LGh5cGhlbmF0ZTpmdW5jdGlvbihvYmosY2FtZWwpe3ZhciByZXN1bHQ9c3RyaW5nLnRyaW0ob2JqKS5yZXBsYWNlKC9ccysvZywiLSIpO2lmKGNhbWVsPT09dHJ1ZSlyZXN1bHQ9cmVzdWx0LnJlcGxhY2UoLyhbQS1aXSkvZywiLSQxIikudG9Mb3dlckNhc2UoKTtyZXR1cm4gcmVzdWx0fSxpc0Jvb2xlYW46ZnVuY3Rpb24ob2JqKXtyZXR1cm4gcmVnZXguYm9vbC50ZXN0KG9iail9LGlzRW1wdHk6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gc3RyaW5nLnRyaW0ob2JqKT09PSIifSxpc051bWJlcjpmdW5jdGlvbihvYmope3JldHVybiByZWdleC5udW1iZXIudGVzdChvYmopfSwKaXNVcmw6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gcmVnZXgudXJsLnRlc3Qob2JqKX0sdG9DYW1lbENhc2U6ZnVuY3Rpb24ob2JqKXt2YXIgcz1zdHJpbmcudHJpbShvYmopLnJlcGxhY2UoL1wufF98LXxcQHxcW3xcXXxcKHxcKXxcI3xcJHxcJXxcXnxcJnxcKnxccysvZywiICIpLnRvTG93ZXJDYXNlKCkuc3BsaXQocmVnZXguc3BhY2VfaHlwaGVuKSxyPVtdO2FycmF5LmVhY2gocyxmdW5jdGlvbihpLGlkeCl7ci5wdXNoKGlkeD09PTA/aTpzdHJpbmcuY2FwaXRhbGl6ZShpKSl9KTtyZXR1cm4gci5qb2luKCIiKX0sc2luZ3VsYXI6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gb2JqLnJlcGxhY2UoL29lP3MkLywibyIpLnJlcGxhY2UoL2llcyQvLCJ5IikucmVwbGFjZSgvc2VzJC8sInNlIikucmVwbGFjZSgvcyQvLCIiKX0sdG9GdW5jdGlvbjpmdW5jdGlvbihvYmope3ZhciBhcmdzPXN0cmluZy50cmltKG9iai5yZXBsYWNlKC9eLipcKC8sIiIpLnJlcGxhY2UoL1tcdHxccnxcbnxcInxcJ10rL2csCiIiKS5yZXBsYWNlKC9cKS4qLywiIikpLGJvZHk9c3RyaW5nLnRyaW0ob2JqLnJlcGxhY2UoL14uKlx7LywiIikucmVwbGFjZSgvXH0kLywiIikpO3JldHVybiBGdW5jdGlvbi5hcHBseShGdW5jdGlvbixzdHJpbmcuZXhwbG9kZShhcmdzKS5jb25jYXQoW2JvZHldKSl9LHRyaW06ZnVuY3Rpb24ob2JqKXtyZXR1cm4gb2JqLnJlcGxhY2UoL14oXHMrfFx0K3xcbispfChccyt8XHQrfFxuKykkL2csIiIpfSx1bkNhbWVsQ2FzZTpmdW5jdGlvbihvYmope3JldHVybiBzdHJpbmcudHJpbShvYmoucmVwbGFjZSgvKFtBLVpdKS9nLCIgJDEiKS50b0xvd2VyQ2FzZSgpKX0sdW5jYXBpdGFsaXplOmZ1bmN0aW9uKG9iail7b2JqPXN0cmluZy50cmltKG9iaik7cmV0dXJuIG9iai5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKStvYmouc2xpY2UoMSl9LHVuaHlwaGVuYXRlOmZ1bmN0aW9uKG9iaixjYXBzKXtpZihjYXBzIT09dHJ1ZSlyZXR1cm4gc3RyaW5nLmV4cGxvZGUob2JqLCItIikuam9pbigiICIpOwplbHNlIHJldHVybiBzdHJpbmcuZXhwbG9kZShvYmosIi0iKS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIHN0cmluZy5jYXBpdGFsaXplKGkpfSkuam9pbigiICIpfX07dmFyIHV0aWxpdHk9e3RpbWVyOnt9LHJlcGVhdGluZzp7fSwkOmZ1bmN0aW9uKGFyZyl7dmFyIHJlc3VsdDtpZighYXJnKTtlbHNlIGlmKHJlZ2V4Lmh0bWwudGVzdChhcmcpKXJlc3VsdD1bZWxlbWVudC5jcmVhdGUoYXJnKV07ZWxzZXthcmc9c3RyaW5nLnRyaW0oYXJnKTtpZihhcmcuaW5kZXhPZigiLCIpPT09LTEpe3Jlc3VsdD11dGlsaXR5LmRvbShhcmcpO2lmKHJlc3VsdCl7aWYoaXNOYU4ocmVzdWx0Lmxlbmd0aCkpcmVzdWx0PVtyZXN1bHRdfWVsc2UgcmVzdWx0PVtdfWVsc2V7cmVzdWx0PVtdO2FycmF5LmVhY2goc3RyaW5nLmV4cGxvZGUoYXJnKSxmdW5jdGlvbihxdWVyeSl7dmFyIG9iaj11dGlsaXR5LmRvbShxdWVyeSk7aWYob2JqIGluc3RhbmNlb2YgQXJyYXkpcmVzdWx0PXJlc3VsdC5jb25jYXQob2JqKTsKZWxzZSBpZihvYmopcmVzdWx0LnB1c2gob2JqKX0pfX1yZXR1cm4gcmVzdWx0fSxiYXNlOmZ1bmN0aW9uKGFyZyl7dmFyIG9iaj1uZXcgQmFzZTtpZihhcmcgaW5zdGFuY2VvZiBPYmplY3QpdXRpbGl0eS5tZXJnZShvYmosYXJnKTtvYmoub2JzZXJ2ZXI9b2JzZXJ2YWJsZS5mYWN0b3J5KCk7cmV0dXJuIG9ian0sYmxvYjpmdW5jdGlvbihhcmcpe3ZhciBvYmo7dHJ5e29iaj1uZXcgQmxvYihbYXJnXSx7dHlwZToiYXBwbGljYXRpb24vamF2YXNjcmlwdCJ9KX1jYXRjaChlKXtpZighZ2xvYmFsLkJsb2JCdWlsZGVyKWdsb2JhbC5CbG9iQnVpbGRlcj1nbG9iYWwuTVNCbG9iQnVpbGRlcnx8Z2xvYmFsLldlYktpdEJsb2JCdWlsZGVyfHxnbG9iYWwuTW96QmxvYkJ1aWxkZXI7b2JqPShuZXcgZ2xvYmFsLkJsb2JCdWlsZGVyKS5hcHBlbmQoYXJnKS5nZXRCbG9iKCl9cmV0dXJuIG9ian0sY2xlYXJUaW1lcnM6ZnVuY3Rpb24oaWQpe2lmKGlkPT09dW5kZWZpbmVkfHxzdHJpbmcuaXNFbXB0eShpZCkpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpOwppZih1dGlsaXR5LnRpbWVyW2lkXSl7Y2xlYXJUaW1lb3V0KHV0aWxpdHkudGltZXJbaWRdKTtkZWxldGUgdXRpbGl0eS50aW1lcltpZF19aWYodXRpbGl0eS5yZXBlYXRpbmdbaWRdKXtjbGVhclRpbWVvdXQodXRpbGl0eS5yZXBlYXRpbmdbaWRdKTtkZWxldGUgdXRpbGl0eS5yZXBlYXRpbmdbaWRdfX0sY2xvbmU6ZnVuY3Rpb24ob2JqLHNoYWxsb3cpe3ZhciBjbG9uZTtpZihzaGFsbG93PT09dHJ1ZSlyZXR1cm4gb2JqIT09dW5kZWZpbmVkJiZvYmohPT1udWxsP2pzb24uZGVjb2RlKGpzb24uZW5jb2RlKG9iaikpOm9iajtlbHNlIGlmKCFvYmp8fHJlZ2V4LnByaW1pdGl2ZS50ZXN0KHR5cGVvZiBvYmopfHxvYmogaW5zdGFuY2VvZiBSZWdFeHApcmV0dXJuIG9iajtlbHNlIGlmKG9iaiBpbnN0YW5jZW9mIEFycmF5KXJldHVybiBvYmouc2xpY2UoKTtlbHNlIGlmKCFzZXJ2ZXImJiFjbGllbnQuaWUmJm9iaiBpbnN0YW5jZW9mIERvY3VtZW50KXJldHVybiB4bWwuZGVjb2RlKHhtbC5lbmNvZGUob2JqKSk7CmVsc2UgaWYodHlwZW9mIG9iai5fX3Byb3RvX18hPSJ1bmRlZmluZWQiKXJldHVybiB1dGlsaXR5LmV4dGVuZChvYmouX19wcm90b19fLG9iaik7ZWxzZSBpZihvYmogaW5zdGFuY2VvZiBPYmplY3Qpe2Nsb25lPWpzb24uZW5jb2RlKG9iaix0cnVlKTtpZihjbG9uZSE9PXVuZGVmaW5lZCl7Y2xvbmU9anNvbi5kZWNvZGUoY2xvbmUpO3V0aWxpdHkuaXRlcmF0ZShvYmosZnVuY3Rpb24odixrKXtpZih0eXBlb2Ygdj09ImZ1bmN0aW9uIiljbG9uZVtrXT12fSl9ZWxzZSBjbG9uZT1vYmo7cmV0dXJuIGNsb25lfWVsc2UgcmV0dXJuIG9ian0sY29lcmNlOmZ1bmN0aW9uKHZhbHVlKXt2YXIgdG1wO2lmKHZhbHVlPT09bnVsbHx8dmFsdWU9PT11bmRlZmluZWQpcmV0dXJuIHVuZGVmaW5lZDtlbHNlIGlmKHZhbHVlPT09InRydWUiKXJldHVybiB0cnVlO2Vsc2UgaWYodmFsdWU9PT0iZmFsc2UiKXJldHVybiBmYWxzZTtlbHNlIGlmKHZhbHVlPT09Im51bGwiKXJldHVybiBudWxsO2Vsc2UgaWYodmFsdWU9PT0KInVuZGVmaW5lZCIpcmV0dXJuIHVuZGVmaW5lZDtlbHNlIGlmKHZhbHVlPT09IiIpcmV0dXJuIHZhbHVlO2Vsc2UgaWYoIWlzTmFOKHRtcD1OdW1iZXIodmFsdWUpKSlyZXR1cm4gdG1wO2Vsc2UgaWYocmVnZXguanNvbl93cmFwLnRlc3QodmFsdWUpKXJldHVybiBqc29uLmRlY29kZSh2YWx1ZSx0cnVlKXx8dmFsdWU7ZWxzZSByZXR1cm4gdmFsdWV9LGNvbXBpbGU6ZnVuY3Rpb24ocmVnLHBhdHRlcm4sbW9kaWZpZXJzKXtyZWcuY29tcGlsZShwYXR0ZXJuLG1vZGlmaWVycyk7cmV0dXJuIHRydWV9LGN1cnJ5OmZ1bmN0aW9uKCl7dmFyIGFyZ3M9YXJyYXkuY2FzdChhcmd1bWVudHMpLGZuPWFyZ3Muc2hpZnQoKSxjZm49Zm4uYXBwbHkoZm4sYXJncyk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGNmbi5hcHBseShjZm4sYXJndW1lbnRzKX19LGRlZmVyOmZ1bmN0aW9uKGZuLG1zLGlkLHJlcGVhdCl7dmFyIG9wO21zPW1zfHwwO3JlcGVhdD1yZXBlYXQ9PT10cnVlO2lmKGlkIT09dW5kZWZpbmVkKXV0aWxpdHkuY2xlYXJUaW1lcnMoaWQpOwplbHNlIGlkPXV0aWxpdHkudXVpZCh0cnVlKTtvcD1mdW5jdGlvbigpe3V0aWxpdHkuY2xlYXJUaW1lcnMoaWQpO2ZuKCl9O3V0aWxpdHlbcmVwZWF0PyJyZXBlYXRpbmciOiJ0aW1lciJdW2lkXT1zZXRUaW1lb3V0KG9wLG1zKTtyZXR1cm4gaWR9LGRlbGF5OmZ1bmN0aW9uKCl7aWYodHlwZW9mIHNldEltbWVkaWF0ZSE9InVuZGVmaW5lZCIpcmV0dXJuIGZ1bmN0aW9uKGFyZyl7c2V0SW1tZWRpYXRlKGFyZyl9O2Vsc2UgaWYodHlwZW9mIHByb2Nlc3MhPSJ1bmRlZmluZWQiKXJldHVybiBwcm9jZXNzLm5leHRUaWNrO2Vsc2UgcmV0dXJuIGZ1bmN0aW9uKGFyZyl7c2V0VGltZW91dChhcmcsMCl9fSgpLGRvbTpmdW5jdGlvbihhcmcpe3ZhciByZXN1bHQ7aWYoIXJlZ2V4LnNlbGVjdG9yX2NvbXBsZXgudGVzdChhcmcpKWlmKHJlZ2V4Lmhhc2gudGVzdChhcmcpKXJlc3VsdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChhcmcucmVwbGFjZShyZWdleC5oYXNoLCIiKSl8fHVuZGVmaW5lZDsKZWxzZSBpZihyZWdleC5rbGFzcy50ZXN0KGFyZykpcmVzdWx0PWFycmF5LmNhc3QoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShhcmcucmVwbGFjZShyZWdleC5rbGFzcywiIikpKTtlbHNlIGlmKHJlZ2V4LndvcmQudGVzdChhcmcpKXJlc3VsdD1hcnJheS5jYXN0KGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKGFyZykpO2Vsc2UgcmVzdWx0PWFycmF5LmNhc3QoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChhcmcpKTtlbHNlIHJlc3VsdD1hcnJheS5jYXN0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYXJnKSk7cmV0dXJuIHJlc3VsdH0sZG9tSWQ6ZnVuY3Rpb24oYXJnKXtyZXR1cm4iYSIrYXJnLnJlcGxhY2UoLy0vZywiIikuc2xpY2UoMSl9LGVycm9yOmZ1bmN0aW9uKGUsYXJncyxzY29wZSx3YXJuaW5nKXt2YXIgbz17ImFyZ3VtZW50cyI6YXJncz9hcnJheS5jYXN0KGFyZ3MpOltdLG1lc3NhZ2U6ZS5tZXNzYWdlfHxlLG51bWJlcjplLm51bWJlcj9lLm51bWJlciYKNjU1MzU6dW5kZWZpbmVkLHNjb3BlOnNjb3BlLHN0YWNrOmUuc3RhY2t8fHVuZGVmaW5lZCx0aW1lc3RhbXA6KG5ldyBEYXRlKS50b1VUQ1N0cmluZygpLHR5cGU6ZS50eXBlfHwiVHlwZUVycm9yIn07dXRpbGl0eS5sb2coby5zdGFja3x8by5tZXNzYWdlLHdhcm5pbmchPT10cnVlPyJlcnJvciI6Indhcm4iKTtyZXR1cm4gdW5kZWZpbmVkfSxleHRlbmQ6ZnVuY3Rpb24ob2JqLGFyZyl7dmFyIG87aWYob2JqPT09dW5kZWZpbmVkKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTtvPU9iamVjdC5jcmVhdGUob2JqKTtpZihhcmcgaW5zdGFuY2VvZiBPYmplY3QpdXRpbGl0eS5tZXJnZShvLGFyZyk7cmV0dXJuIG99LGdlbklkOmZ1bmN0aW9uKG9iaixkb20pe2RvbT1kb209PT10cnVlO3ZhciBpZDtpZihvYmomJihvYmouaWR8fG9iaiBpbnN0YW5jZW9mIEFycmF5fHwodHlwZW9mIG9iaj09InN0cmluZyJ8fG9iaiBpbnN0YW5jZW9mIFN0cmluZykpKXJldHVybiBvYmo7CmlmKGRvbSl7ZG8gaWQ9dXRpbGl0eS5kb21JZCh1dGlsaXR5LnV1aWQodHJ1ZSkpO3doaWxlKHV0aWxpdHkuZG9tKCIjIitpZCkpfWVsc2UgaWQ9dXRpbGl0eS5kb21JZCh1dGlsaXR5LnV1aWQodHJ1ZSkpO2lmKHR5cGVvZiBvYmo9PSJvYmplY3QiKXtvYmouaWQ9aWQ7cmV0dXJuIG9ian1lbHNlIHJldHVybiBpZH0saXRlcmF0ZTpmdW5jdGlvbihvYmosZm4pe2lmKHR5cGVvZiBmbiE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7YXJyYXkuZWFjaChPYmplY3Qua2V5cyhvYmopLGZ1bmN0aW9uKGkpe3JldHVybiBmbi5jYWxsKG9iaixvYmpbaV0saSl9KTtyZXR1cm4gb2JqfSxsb2c6ZnVuY3Rpb24oYXJnLHRhcmdldCl7dmFyIHRzLG1zZztpZih0eXBlb2YgY29uc29sZSE9InVuZGVmaW5lZCIpe3RzPXR5cGVvZiBhcmchPSJvYmplY3QiO21zZz10cz8iWyIrKG5ldyBEYXRlKS50b0xvY2FsZVRpbWVTdHJpbmcoKSsiXSAiK2FyZzphcmc7Y29uc29sZVt0YXJnZXR8fAoibG9nIl0obXNnKX19LG1lcmdlOmZ1bmN0aW9uKG9iaixhcmcpe3V0aWxpdHkuaXRlcmF0ZShhcmcsZnVuY3Rpb24odixrKXtpZihvYmpba11pbnN0YW5jZW9mIEFycmF5JiZ2IGluc3RhbmNlb2YgQXJyYXkpYXJyYXkubWVyZ2Uob2JqW2tdLHYpO2Vsc2UgaWYob2JqW2tdaW5zdGFuY2VvZiBPYmplY3QmJnYgaW5zdGFuY2VvZiBPYmplY3QpdXRpbGl0eS5pdGVyYXRlKHYsZnVuY3Rpb24oeCx5KXtvYmpba11beV09dXRpbGl0eS5jbG9uZSh4KX0pO2Vsc2Ugb2JqW2tdPXV0aWxpdHkuY2xvbmUodil9KTtyZXR1cm4gb2JqfSxwYXJzZTpmdW5jdGlvbih1cmkpe3ZhciBvYmo9e30scGFyc2VkPXt9O2lmKHVyaT09PXVuZGVmaW5lZCl1cmk9IXNlcnZlcj9sb2NhdGlvbi5ocmVmOiIiO2lmKCFzZXJ2ZXIpe29iaj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7b2JqLmhyZWY9dXJpfWVsc2Ugb2JqPXVybC5wYXJzZSh1cmkpO2lmKHNlcnZlcil1dGlsaXR5Lml0ZXJhdGUob2JqLGZ1bmN0aW9uKHYsCmspe2lmKHY9PT1udWxsKW9ialtrXT11bmRlZmluZWR9KTtwYXJzZWQ9e2F1dGg6c2VydmVyP251bGw6cmVnZXguYXV0aC5leGVjKHVyaSkscHJvdG9jb2w6b2JqLnByb3RvY29sfHwiaHR0cDoiLGhvc3RuYW1lOm9iai5ob3N0bmFtZXx8ImxvY2FsaG9zdCIscG9ydDpvYmoucG9ydD9udW1iZXIucGFyc2Uob2JqLnBvcnQsMTApOiIiLHBhdGhuYW1lOm9iai5wYXRobmFtZSxzZWFyY2g6b2JqLnNlYXJjaHx8IiIsaGFzaDpvYmouaGFzaHx8IiIsaG9zdDpvYmouaG9zdHx8ImxvY2FsaG9zdCJ9O2lmKGNsaWVudC5pZSl7aWYocGFyc2VkLnByb3RvY29sPT09IjoiKXBhcnNlZC5wcm90b2NvbD1sb2NhdGlvbi5wcm90b2NvbDtpZihzdHJpbmcuaXNFbXB0eShwYXJzZWQuaG9zdG5hbWUpKXBhcnNlZC5ob3N0bmFtZT1sb2NhdGlvbi5ob3N0bmFtZTtpZihzdHJpbmcuaXNFbXB0eShwYXJzZWQuaG9zdCkpcGFyc2VkLmhvc3Q9bG9jYXRpb24uaG9zdDtpZihwYXJzZWQucGF0aG5hbWUuY2hhckF0KDApIT09CiIvIilwYXJzZWQucGF0aG5hbWU9Ii8iK3BhcnNlZC5wYXRobmFtZX1wYXJzZWQuYXV0aD1vYmouYXV0aHx8KHBhcnNlZC5hdXRoPT09bnVsbD8iIjpwYXJzZWQuYXV0aFsxXSk7cGFyc2VkLmhyZWY9b2JqLmhyZWZ8fHBhcnNlZC5wcm90b2NvbCsiLy8iKyhzdHJpbmcuaXNFbXB0eShwYXJzZWQuYXV0aCk/IiI6cGFyc2VkLmF1dGgrIkAiKStwYXJzZWQuaG9zdCtwYXJzZWQucGF0aG5hbWUrcGFyc2VkLnNlYXJjaCtwYXJzZWQuaGFzaDtwYXJzZWQucGF0aD1vYmoucGF0aHx8cGFyc2VkLnBhdGhuYW1lK3BhcnNlZC5zZWFyY2g7cGFyc2VkLnF1ZXJ5PXV0aWxpdHkucXVlcnlTdHJpbmcobnVsbCxwYXJzZWQuc2VhcmNoKTtyZXR1cm4gcGFyc2VkfSxwYXJ0aWFsOmZ1bmN0aW9uKCl7dmFyIGFyZ3M9YXJyYXkuY2FzdChhcmd1bWVudHMpLGZuPWFyZ3Muc2hpZnQoKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZm4uYXBwbHkoZm4sYXJncy5jb25jYXQoYXJyYXkuY2FzdChhcmd1bWVudHMpKSl9fSwKcHJldmVudDpmdW5jdGlvbihldil7aWYodHlwZW9mIGV2LnByZXZlbnREZWZhdWx0PT0iZnVuY3Rpb24iKWV2LnByZXZlbnREZWZhdWx0KCk7cmV0dXJuIGV2fSxxdWVyeVN0cmluZzpmdW5jdGlvbihhcmcscXN0cmluZyl7dmFyIG9iaj17fSxyZXN1bHQ9cXN0cmluZyE9PXVuZGVmaW5lZD9xc3RyaW5nLmluZGV4T2YoIj8iKT4tMT9xc3RyaW5nLnJlcGxhY2UoLy4qXD8vLCIiKTpudWxsOnNlcnZlcnx8c3RyaW5nLmlzRW1wdHkobG9jYXRpb24uc2VhcmNoKT9udWxsOmxvY2F0aW9uLnNlYXJjaC5yZXBsYWNlKCI/IiwiIik7aWYocmVzdWx0IT09bnVsbCYmIXN0cmluZy5pc0VtcHR5KHJlc3VsdCkpe3Jlc3VsdD1yZXN1bHQuc3BsaXQoIiYiKTthcnJheS5lYWNoKHJlc3VsdCxmdW5jdGlvbihwcm9wKXt2YXIgaXRlbT1wcm9wLnNwbGl0KCI9Iik7aWYoc3RyaW5nLmlzRW1wdHkoaXRlbVswXSkpcmV0dXJuO2lmKGl0ZW1bMV09PT11bmRlZmluZWQpaXRlbVsxXT0iIjtlbHNlIGl0ZW1bMV09CnV0aWxpdHkuY29lcmNlKGRlY29kZVVSSUNvbXBvbmVudChpdGVtWzFdKSk7aWYob2JqW2l0ZW1bMF1dPT09dW5kZWZpbmVkKW9ialtpdGVtWzBdXT1pdGVtWzFdO2Vsc2UgaWYoIShvYmpbaXRlbVswXV1pbnN0YW5jZW9mIEFycmF5KSl7b2JqW2l0ZW1bMF1dPVtvYmpbaXRlbVswXV1dO29ialtpdGVtWzBdXS5wdXNoKGl0ZW1bMV0pfWVsc2Ugb2JqW2l0ZW1bMF1dLnB1c2goaXRlbVsxXSl9KX1pZihhcmchPT1udWxsJiZhcmchPT11bmRlZmluZWQpb2JqPW9ialthcmddO3JldHVybiBvYmp9LHJhY2U6ZnVuY3Rpb24oKXt2YXIgZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpLGFyZ3M9YXJyYXkuY2FzdChhcmd1bWVudHMpO2lmKGFyZ3NbMF1pbnN0YW5jZW9mIEFycmF5KWFyZ3M9YXJnc1swXTtpZihhcmdzLmxlbmd0aD09PTApZGVmZXIucmVzb2x2ZShudWxsKTtlbHNlIFByb21pc2UucmFjZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdHMpe2RlZmVyLnJlc29sdmUocmVzdWx0cyl9LApmdW5jdGlvbihlKXtkZWZlci5yZWplY3QoZSl9KTtyZXR1cm4gZGVmZXJ9LHJlbmRlcjpmdW5jdGlvbihmbil7dmFyIGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKTtSRU5ERVIoZnVuY3Rpb24oYXJnKXt0cnl7ZGVmZXIucmVzb2x2ZShmbihhcmcpKX1jYXRjaChlKXtkZWZlci5yZWplY3QoZSl9fSk7cmV0dXJuIGRlZmVyfSxyZXBlYXQ6ZnVuY3Rpb24oZm4sbXMsaWQsbm93KXttcz1tc3x8MTA7aWQ9aWR8fHV0aWxpdHkudXVpZCh0cnVlKTtub3c9bm93IT09ZmFsc2U7aWYobm93JiZmbigpPT09ZmFsc2UpcmV0dXJuO3V0aWxpdHkuZGVmZXIoZnVuY3Rpb24oKXt2YXIgcmVjdXJzaXZlPWZ1bmN0aW9uKGZuLG1zLGlkKXt2YXIgcmVjdXJzaXZlPXRoaXM7aWYoZm4oKSE9PWZhbHNlKXV0aWxpdHkucmVwZWF0aW5nW2lkXT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmVjdXJzaXZlLmNhbGwocmVjdXJzaXZlLGZuLG1zLGlkKX0sbXMpO2Vsc2UgZGVsZXRlIHV0aWxpdHkucmVwZWF0aW5nW2lkXX07CnJlY3Vyc2l2ZS5jYWxsKHJlY3Vyc2l2ZSxmbixtcyxpZCl9LG1zLGlkLHRydWUpO3JldHVybiBpZH0sc3RvcDpmdW5jdGlvbihldil7aWYodHlwZW9mIGV2LnN0b3BQcm9wYWdhdGlvbj09ImZ1bmN0aW9uIilldi5zdG9wUHJvcGFnYXRpb24oKTt1dGlsaXR5LnByZXZlbnQoZXYpO3JldHVybiBldn0sdGFyZ2V0OmZ1bmN0aW9uKGV2KXtyZXR1cm4gZXYudGFyZ2V0fHxldi5zcmNFbGVtZW50fSx1dWlkOmZ1bmN0aW9uKHN0cmlwKXt2YXIgcz1mdW5jdGlvbigpe3JldHVybigoMStNYXRoLnJhbmRvbSgpKSo2NTUzNnwwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpfSxyPVs4LDksImEiLCJiIl0sbztvPXMoKStzKCkrIi0iK3MoKSsiLTQiK3MoKS5zdWJzdHIoMCwzKSsiLSIrcltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqNCldK3MoKS5zdWJzdHIoMCwzKSsiLSIrcygpK3MoKStzKCk7aWYoc3RyaXA9PT10cnVlKW89by5yZXBsYWNlKC8tL2csIiIpO3JldHVybiBvfSx3YWxrOmZ1bmN0aW9uKG9iaiwKYXJnKXt2YXIgb3V0cHV0PW9iajthcnJheS5lYWNoKGFyZy5yZXBsYWNlKC9cXSQvLCIiKS5yZXBsYWNlKC9cXS9nLCIuIikucmVwbGFjZSgvXC5cLi9nLCIuIikuc3BsaXQoL1wufFxbLyksZnVuY3Rpb24oaSl7aWYob3V0cHV0W2ldPT09dW5kZWZpbmVkfHxvdXRwdXRbaV09PT1udWxsKXtvdXRwdXQ9dW5kZWZpbmVkO3JldHVybiBmYWxzZX1vdXRwdXQ9b3V0cHV0W2ldfSk7cmV0dXJuIG91dHB1dH0sd2hlbjpmdW5jdGlvbigpe3ZhciBkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCksYXJncz1hcnJheS5jYXN0KGFyZ3VtZW50cyk7aWYoYXJnc1swXWluc3RhbmNlb2YgQXJyYXkpYXJncz1hcmdzWzBdO2lmKGFyZ3MubGVuZ3RoPT09MClkZWZlci5yZXNvbHZlKG51bGwpO2Vsc2UgUHJvbWlzZS5hbGwoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHRzKXtkZWZlci5yZXNvbHZlKHJlc3VsdHMpfSxmdW5jdGlvbihlKXtkZWZlci5yZWplY3QoZSl9KTtyZXR1cm4gZGVmZXJ9LHdvcmtlcjpmdW5jdGlvbihkZWZlcil7dmFyIG9iaj0KbmV3IFdvcmtlcihXT1JLRVIpO29iai5vbmVycm9yPWZ1bmN0aW9uKGVycil7ZGVmZXIucmVqZWN0KGVycik7b2JqLnRlcm1pbmF0ZSgpfTtvYmoub25tZXNzYWdlPWZ1bmN0aW9uKGV2KXtkZWZlci5yZXNvbHZlKGV2LmRhdGEpO29iai50ZXJtaW5hdGUoKX07cmV0dXJuIG9ian19O2Z1bmN0aW9uIHhocigpe3ZhciBVTlNFTlQ9MCxPUEVORUQ9MSxIRUFERVJTX1JFQ0VJVkVEPTIsTE9BRElORz0zLERPTkU9NCxFUlJfUkVGVVNFRD0vRUNPTk5SRUZVU0VELyxyZWFkeT1uZXcgUmVnRXhwKEhFQURFUlNfUkVDRUlWRUQrInwiK0xPQURJTkcpLFhNTEh0dHBSZXF1ZXN0LGhlYWRlcnMsZGlzcGF0Y2gsc3VjY2VzcyxmYWlsdXJlLHN0YXRlO2hlYWRlcnM9eyJ1c2VyLWFnZW50Ijoia2VpZ2FpLzAuOS4wIG5vZGUuanMvIitwcm9jZXNzLnZlcnNpb25zLm5vZGUucmVwbGFjZSgvXnYvLCIiKSsiICgiK3N0cmluZy5jYXBpdGFsaXplKHByb2Nlc3MucGxhdGZvcm0pKyIgVjgvIitwcm9jZXNzLnZlcnNpb25zLnY4KwoiICkiLCJjb250ZW50LXR5cGUiOiJ0ZXh0L3BsYWluIiwiYWNjZXB0IjoiKi8qIn07ZGlzcGF0Y2g9ZnVuY3Rpb24oYXJnKXt2YXIgZm49Im9uIithcmc7aWYodHlwZW9mIHRoaXNbZm5dPT0iZnVuY3Rpb24iKXRoaXNbZm5dKCk7dGhpcy5kaXNwYXRjaEV2ZW50KGFyZyk7cmV0dXJuIHRoaXN9O3N0YXRlPWZ1bmN0aW9uKGFyZyl7aWYodGhpcy5yZWFkeVN0YXRlIT09YXJnKXt0aGlzLnJlYWR5U3RhdGU9YXJnO2Rpc3BhdGNoLmNhbGwodGhpcywicmVhZHlzdGF0ZWNoYW5nZSIpO2lmKHRoaXMucmVhZHlTdGF0ZT09PURPTkUmJiF0aGlzLl9lcnJvcil7ZGlzcGF0Y2guY2FsbCh0aGlzLCJsb2FkIik7ZGlzcGF0Y2guY2FsbCh0aGlzLCJsb2FkZW5kIil9fXJldHVybiB0aGlzfTtzdWNjZXNzPWZ1bmN0aW9uKHJlcyl7dmFyIHNlbGY9dGhpcztzdGF0ZS5jYWxsKHRoaXMsSEVBREVSU19SRUNFSVZFRCk7dGhpcy5zdGF0dXM9cmVzLnN0YXR1c0NvZGU7dGhpcy5fcmVzaGVhZGVycz1yZXMuaGVhZGVyczsKaWYodGhpcy5fcmVzaGVhZGVyc1sic2V0LWNvb2tpZSJdJiZ0aGlzLl9yZXNoZWFkZXJzWyJzZXQtY29va2llIl1pbnN0YW5jZW9mIEFycmF5KXRoaXMuX3Jlc2hlYWRlcnNbInNldC1jb29raWUiXT10aGlzLl9yZXNoZWFkZXJzWyJzZXQtY29va2llIl0uam9pbigiOyIpO3Jlcy5vbigiZGF0YSIsZnVuY3Rpb24oYXJnKXtyZXMuc2V0RW5jb2RpbmcoInV0ZjgiKTtpZihzZWxmLl9zZW5kKXtpZihhcmcpc2VsZi5yZXNwb25zZVRleHQrPWFyZztzdGF0ZS5jYWxsKHNlbGYsTE9BRElORyl9fSk7cmVzLm9uKCJlbmQiLGZ1bmN0aW9uKCl7aWYoc2VsZi5fc2VuZCl7c3RhdGUuY2FsbChzZWxmLERPTkUpO3NlbGYuX3NlbmQ9ZmFsc2V9fSl9O2ZhaWx1cmU9ZnVuY3Rpb24oZSl7dGhpcy5zdGF0dXM9RVJSX1JFRlVTRUQudGVzdChlLm1lc3NhZ2UpPzUwMzo1MDA7dGhpcy5zdGF0dXNUZXh0PSIiO3RoaXMucmVzcG9uc2VUZXh0PWUubWVzc2FnZTt0aGlzLl9lcnJvcj10cnVlO3RoaXMuX3NlbmQ9CmZhbHNlO2Rpc3BhdGNoLmNhbGwodGhpcywiZXJyb3IiKTtzdGF0ZS5jYWxsKHRoaXMsRE9ORSl9O1hNTEh0dHBSZXF1ZXN0PWZ1bmN0aW9uKCl7dGhpcy5vbmFib3J0PW51bGw7dGhpcy5vbmVycm9yPW51bGw7dGhpcy5vbmxvYWQ9bnVsbDt0aGlzLm9ubG9hZGVuZD1udWxsO3RoaXMub25sb2Fkc3RhcnQ9bnVsbDt0aGlzLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsO3RoaXMucmVhZHlTdGF0ZT1VTlNFTlQ7dGhpcy5yZXNwb25zZT1udWxsO3RoaXMucmVzcG9uc2VUZXh0PSIiO3RoaXMucmVzcG9uc2VUeXBlPSIiO3RoaXMucmVzcG9uc2VYTUw9bnVsbDt0aGlzLnN0YXR1cz1VTlNFTlQ7dGhpcy5zdGF0dXNUZXh0PSIiO3RoaXMub2JzZXJ2ZXI9b2JzZXJ2YWJsZS5mYWN0b3J5KCk7dGhpcy5fZXJyb3I9ZmFsc2U7dGhpcy5faGVhZGVycz17fTt0aGlzLl9wYXJhbXM9e307dGhpcy5fcmVxdWVzdD1udWxsO3RoaXMuX3Jlc2hlYWRlcnM9e307dGhpcy5fc2VuZD1mYWxzZX07WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlPQpiYXNlLmZhY3RvcnkoKTtYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuY29uc3RydWN0b3I9WE1MSHR0cFJlcXVlc3Q7WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmFib3J0PWZ1bmN0aW9uKCl7aWYodGhpcy5fcmVxdWVzdCE9PW51bGwpe3RoaXMuX3JlcXVlc3QuYWJvcnQoKTt0aGlzLl9yZXF1ZXN0PW51bGw7dGhpcy5yZXNwb25zZVRleHQ9IiI7dGhpcy5yZXNwb25zZVhNTD0iIjt0aGlzLl9lcnJvcj10cnVlO3RoaXMuX2hlYWRlcnM9e307aWYodGhpcy5fc2VuZD09PXRydWV8fHJlYWR5LnRlc3QodGhpcy5yZWFkeVN0YXRlKSl7dGhpcy5fc2VuZD1mYWxzZTtzdGF0ZS5jYWxsKHRoaXMsRE9ORSl9ZGlzcGF0Y2guY2FsbCh0aGlzLCJhYm9ydCIpO3RoaXMucmVhZHlTdGF0ZT1VTlNFTlR9cmV0dXJuIHRoaXN9O1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5nZXRBbGxSZXNwb25zZUhlYWRlcnM9ZnVuY3Rpb24oKXt2YXIgcmVzdWx0PSIiO2lmKHRoaXMucmVhZHlTdGF0ZTxIRUFERVJTX1JFQ0VJVkVEKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkU3RhdGVOb0hlYWRlcnMpOwp1dGlsaXR5Lml0ZXJhdGUodGhpcy5fcmVzaGVhZGVycyxmdW5jdGlvbih2LGspe3Jlc3VsdCs9aysiOiAiK3YrIlxuIn0pO3JldHVybiByZXN1bHR9O1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5nZXRSZXNwb25zZUhlYWRlcj1mdW5jdGlvbihoZWFkZXIpe3ZhciByZXN1bHQ7aWYodGhpcy5yZWFkeVN0YXRlPEhFQURFUlNfUkVDRUlWRUR8fHRoaXMuX2Vycm9yKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkU3RhdGVOb0hlYWRlcnMpO3Jlc3VsdD10aGlzLl9yZXNoZWFkZXJzW2hlYWRlcl18fHRoaXMuX3Jlc2hlYWRlcnNbaGVhZGVyLnRvTG93ZXJDYXNlKCldO3JldHVybiByZXN1bHR9O1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuPWZ1bmN0aW9uKG1ldGhvZCx1cmwsYXN5bmMsdXNlcixwYXNzd29yZCl7dmFyIHNlbGY9dGhpcztpZihhc3luYyE9PXRydWUpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRTdGF0ZU5vU3luYyk7dGhpcy5hYm9ydCgpO3RoaXMuX2Vycm9yPQpmYWxzZTt0aGlzLl9wYXJhbXM9e21ldGhvZDptZXRob2QsdXJsOnVybCxhc3luYzphc3luY3x8dHJ1ZSx1c2VyOnVzZXJ8fG51bGwscGFzc3dvcmQ6cGFzc3dvcmR8fG51bGx9O3V0aWxpdHkuaXRlcmF0ZShoZWFkZXJzLGZ1bmN0aW9uKHYsayl7c2VsZi5faGVhZGVyc1trXT12fSk7dGhpcy5yZWFkeVN0YXRlPU9QRU5FRDtyZXR1cm4gdGhpc307WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLm92ZXJyaWRlTWltZVR5cGU9ZnVuY3Rpb24obWltZSl7dGhpcy5faGVhZGVyc1siY29udGVudC10eXBlIl09bWltZTtyZXR1cm4gdGhpc307WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oZGF0YSl7ZGF0YT1kYXRhfHxudWxsO3ZhciBzZWxmPXRoaXMsb3B0aW9ucyxwYXJzZWQscmVxdWVzdCxvYmo7aWYodGhpcy5yZWFkeVN0YXRlPE9QRU5FRCl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZFN0YXRlTm90T3Blbik7ZWxzZSBpZih0aGlzLl9zZW5kKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkU3RhdGVOb3RTZW5kaW5nKTsKcGFyc2VkPXV0aWxpdHkucGFyc2UodGhpcy5fcGFyYW1zLnVybCk7cGFyc2VkLnBvcnQ9cGFyc2VkLnBvcnR8fChwYXJzZWQucHJvdG9jb2w9PT0iaHR0cHM6Ij80NDM6ODApO2lmKHRoaXMuX3BhcmFtcy51c2VyIT09bnVsbCYmdGhpcy5fcGFyYW1zLnBhc3N3b3JkIT09bnVsbClwYXJzZWQuYXV0aD10aGlzLl9wYXJhbXMudXNlcisiOiIrdGhpcy5fcGFyYW1zLnBhc3N3b3JkO2lmKHJlZ2V4LnB1dF9wb3N0LnRlc3QodGhpcy5fcGFyYW1zLm1ldGhvZCkpaWYoZGF0YT09PW51bGwpdGhpcy5faGVhZGVyc1siY29udGVudC1sZW5ndGgiXT0wO2Vsc2UgaWYodHlwZW9mIGRhdGE9PSJzdHJpbmciKXRoaXMuX2hlYWRlcnNbImNvbnRlbnQtbGVuZ3RoIl09QnVmZmVyLmJ5dGVMZW5ndGgoZGF0YSk7ZWxzZSBpZihkYXRhIGluc3RhbmNlb2YgQnVmZmVyfHx0eXBlb2YgZGF0YS50b1N0cmluZz09ImZ1bmN0aW9uIil7ZGF0YT1kYXRhLnRvU3RyaW5nKCk7dGhpcy5faGVhZGVyc1siY29udGVudC1sZW5ndGgiXT0KQnVmZmVyLmJ5dGVMZW5ndGgoZGF0YSl9ZWxzZSB0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7dGhpcy5faGVhZGVycy5ob3N0PXBhcnNlZC5ob3N0O2lmKHRoaXMuX2hlYWRlcnNbIngtcmVxdWVzdGVkLXdpdGgiXT09PSJYTUxIdHRwUmVxdWVzdCIpZGVsZXRlIHRoaXMuX2hlYWRlcnNbIngtcmVxdWVzdGVkLXdpdGgiXTtvcHRpb25zPXtob3N0bmFtZTpwYXJzZWQuaG9zdG5hbWUscGF0aDpwYXJzZWQucGF0aCxwb3J0OnBhcnNlZC5wb3J0LG1ldGhvZDp0aGlzLl9wYXJhbXMubWV0aG9kLGhlYWRlcnM6dGhpcy5faGVhZGVyc307aWYocGFyc2VkLnByb3RvY29sPT09Imh0dHBzOiIpe29wdGlvbnMucmVqZWN0VW5hdXRob3JpemVkPWZhbHNlO29wdGlvbnMuYWdlbnQ9ZmFsc2V9aWYocGFyc2VkLmF1dGgpb3B0aW9ucy5hdXRoPXBhcnNlZC5hdXRoO3RoaXMuX3NlbmQ9dHJ1ZTtkaXNwYXRjaC5jYWxsKHRoaXMsInJlYWR5c3RhdGVjaGFuZ2UiKTtvYmo9cGFyc2VkLnByb3RvY29sPT09CiJodHRwOiI/aHR0cDpodHRwcztyZXF1ZXN0PW9iai5yZXF1ZXN0KG9wdGlvbnMsZnVuY3Rpb24oYXJnKXtzdWNjZXNzLmNhbGwoc2VsZixhcmcpfSkub24oImVycm9yIixmdW5jdGlvbihlKXtmYWlsdXJlLmNhbGwoc2VsZixlKX0pO2RhdGE9PT1udWxsP3JlcXVlc3Quc2V0U29ja2V0S2VlcEFsaXZlKHRydWUpOnJlcXVlc3Qud3JpdGUoZGF0YSwidXRmOCIpO3RoaXMuX3JlcXVlc3Q9cmVxdWVzdDtyZXF1ZXN0LmVuZCgpO2Rpc3BhdGNoLmNhbGwodGhpcywibG9hZHN0YXJ0Iik7cmV0dXJuIHRoaXN9O1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zZXRSZXF1ZXN0SGVhZGVyPWZ1bmN0aW9uKGhlYWRlcix2YWx1ZSl7aWYodGhpcy5yZWFkeVN0YXRlIT09T1BFTkVEKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkU3RhdGVOb3RVc2FibGUpO2Vsc2UgaWYodGhpcy5fc2VuZCl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZFN0YXRlTm90U2VuZGluZyk7dGhpcy5faGVhZGVyc1toZWFkZXIudG9Mb3dlckNhc2UoKV09CnZhbHVlO3JldHVybiB0aGlzfTtyZXR1cm4gWE1MSHR0cFJlcXVlc3R9dmFyIHhtbD17ZGVjb2RlOmZ1bmN0aW9uKGFyZyl7aWYodHlwZW9mIGFyZyE9InN0cmluZyJ8fHN0cmluZy5pc0VtcHR5KGFyZykpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO3JldHVybihuZXcgRE9NUGFyc2VyKS5wYXJzZUZyb21TdHJpbmcoYXJnLCJ0ZXh0L3htbCIpfSxlbmNvZGU6ZnVuY3Rpb24oYXJnLHdyYXApe3RyeXtpZihhcmc9PT11bmRlZmluZWQpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO3dyYXA9d3JhcCE9PWZhbHNlO3ZhciB4PXdyYXA/Ijx4bWw+IjoiIix0b3A9YXJndW1lbnRzWzJdIT09ZmFsc2Usbm9kZTtub2RlPWZ1bmN0aW9uKG5hbWUsdmFsdWUpe3ZhciBvdXRwdXQ9IjxuPnY8L24+IjtvdXRwdXQ9b3V0cHV0LnJlcGxhY2UoInYiLHJlZ2V4LmNkYXRhLnRlc3QodmFsdWUpPyI8IVtDREFUQVsiK3ZhbHVlKyJdXVx4M2UiOnZhbHVlKTsKcmV0dXJuIG91dHB1dC5yZXBsYWNlKC88KFwvKT9uPi9nLCI8JDEiK25hbWUrIj4iKX07aWYoYXJnIT09bnVsbCYmYXJnLnhtbClhcmc9YXJnLnhtbDtpZihhcmcgaW5zdGFuY2VvZiBEb2N1bWVudClhcmc9KG5ldyBYTUxTZXJpYWxpemVyKS5zZXJpYWxpemVUb1N0cmluZyhhcmcpO2lmKHJlZ2V4LmJvb2xlYW5fbnVtYmVyX3N0cmluZy50ZXN0KHR5cGVvZiBhcmcpKXgrPW5vZGUoIml0ZW0iLGFyZyk7ZWxzZSBpZih0eXBlb2YgYXJnPT0ib2JqZWN0Iil1dGlsaXR5Lml0ZXJhdGUoYXJnLGZ1bmN0aW9uKHYsayl7eCs9eG1sLmVuY29kZSh2LHR5cGVvZiB2PT0ib2JqZWN0IixmYWxzZSkucmVwbGFjZSgvaXRlbXx4bWwvZyxpc05hTihrKT9rOiJpdGVtIil9KTt4Kz13cmFwPyI8L3htbD4iOiIiO2lmKHRvcCl4PSc8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEY4Ij8+Jyt4O3JldHVybiB4fWNhdGNoKGUpe3V0aWxpdHkuZXJyb3IoZSxhcmd1bWVudHMsdGhpcyk7cmV0dXJuIHVuZGVmaW5lZH19LAp2YWxpZDpmdW5jdGlvbihhcmcpe3JldHVybiB4bWwuZGVjb2RlKGFyZykuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIikubGVuZ3RoPT09MH19O2Z1bmN0aW9uIGJvb3RzdHJhcCgpe2Z1bmN0aW9uIGluaXQoKXtUSU1FPShuZXcgRGF0ZSkuZ2V0VGltZSgpO3V0aWxpdHkucmVwZWF0KGZ1bmN0aW9uKCl7Y2FjaGUuY2xlYW4oKX0sNkU0LCJjYWNoZUdhcmJhZ2VDb2xsZWN0b3IiKX1mdW5jdGlvbiBmbigpe2lmKHJlZ2V4LmNvbXBsZXRlX2xvYWRlZC50ZXN0KGRvY3VtZW50LnJlYWR5U3RhdGUpKXtpbml0KCk7cmV0dXJuIGZhbHNlfX1pZighc2VydmVyKXtjbGllbnQudmVyc2lvbj1jbGllbnQudmVyc2lvbigpO2lmKGNsaWVudC5pZSYmY2xpZW50LnZlcnNpb248OSl0aHJvdyBuZXcgRXJyb3IobGFiZWwudXBncmFkZSk7aWYoRWxlbWVudC5wcm90b3R5cGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT09PXVuZGVmaW5lZClFbGVtZW50LnByb3RvdHlwZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPQpmdW5jdGlvbihhcmcpe3JldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIuIithcmcpfTtpZighZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdCkoZnVuY3Rpb24odmlldyl7dmFyIENsYXNzTGlzdCxnZXR0ZXIscHJvdG8sdGFyZ2V0LGRlc2NyaXB0b3I7aWYoISgiSFRNTEVsZW1lbnQiaW4gdmlldykmJiEoIkVsZW1lbnQiaW4gdmlldykpcmV0dXJuO0NsYXNzTGlzdD1mdW5jdGlvbihvYmope3ZhciBjbGFzc2VzPXN0cmluZy5leHBsb2RlKG9iai5jbGFzc05hbWUsIiAiKSxzZWxmPXRoaXM7YXJyYXkuZWFjaChjbGFzc2VzLGZ1bmN0aW9uKGkpe3NlbGYucHVzaChpKX0pO3RoaXMudXBkYXRlQ2xhc3NOYW1lPWZ1bmN0aW9uKCl7b2JqLmNsYXNzTmFtZT10aGlzLmpvaW4oIiAiKX19O2dldHRlcj1mdW5jdGlvbigpe3JldHVybiBuZXcgQ2xhc3NMaXN0KHRoaXMpfTtwcm90bz1DbGFzc0xpc3QucHJvdG90eXBlPVtdO3RhcmdldD0odmlldy5IVE1MRWxlbWVudHx8CnZpZXcuRWxlbWVudCkucHJvdG90eXBlO3Byb3RvLmFkZD1mdW5jdGlvbihhcmcpe2lmKCFhcnJheS5jb250YWlucyh0aGlzLGFyZykpe3RoaXMucHVzaChhcmcpO3RoaXMudXBkYXRlQ2xhc3NOYW1lKCl9fTtwcm90by5jb250YWlucz1mdW5jdGlvbihhcmcpe3JldHVybiBhcnJheS5jb250YWlucyh0aGlzLGFyZyl9O3Byb3RvLnJlbW92ZT1mdW5jdGlvbihhcmcpe2lmKGFycmF5LmNvbnRhaW5zKHRoaXMsYXJnKSl7YXJyYXkucmVtb3ZlKHRoaXMsYXJnKTt0aGlzLnVwZGF0ZUNsYXNzTmFtZSgpfX07cHJvdG8udG9nZ2xlPWZ1bmN0aW9uKGFyZyl7YXJyYXlbYXJyYXkuY29udGFpbnModGhpcyxhcmcpPyJyZW1vdmUiOiJhZGQiXSh0aGlzLGFyZyk7dGhpcy51cGRhdGVDbGFzc05hbWUoKX07aWYoT2JqZWN0LmRlZmluZVByb3BlcnR5KXtkZXNjcmlwdG9yPXtnZXQ6Z2V0dGVyLGVudW1lcmFibGU6dHJ1ZSxjb25maWd1cmFibGU6dHJ1ZX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwKImNsYXNzTGlzdCIsZGVzY3JpcHRvcil9ZWxzZSBpZihPYmplY3QucHJvdG90eXBlLl9fZGVmaW5lR2V0dGVyX18pdGFyZ2V0Ll9fZGVmaW5lR2V0dGVyX18oImNsYXNzTGlzdCIsZ2V0dGVyKTtlbHNlIHRocm93IG5ldyBFcnJvcigiQ291bGQgbm90IGNyZWF0ZSBjbGFzc0xpc3Qgc2hpbSIpO30pKGdsb2JhbCl9ZWxzZSBYTUxIdHRwUmVxdWVzdD14aHIoKTtoYXM9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtzbGljZT1BcnJheS5wcm90b3R5cGUuc2xpY2U7aWYod2ViV29ya2VyKVdPUktFUj1nbG9iYWwuVVJMLmNyZWF0ZU9iamVjdFVSTCh1dGlsaXR5LmJsb2IoInZhciAiK3N0cmluZy5mcm9tT2JqZWN0KGFycmF5LCJhcnJheSIpKyIsICIrc3RyaW5nLmZyb21PYmplY3QocmVnZXgsInJlZ2V4IikrIiwgIitzdHJpbmcuZnJvbU9iamVjdChzdHJpbmcsInN0cmluZyIpKyIsICIrc3RyaW5nLmZyb21PYmplY3QodXRpbGl0eSwidXRpbGl0eSIpKyI7IG9ubWVzc2FnZSA9ICIrCnN0b3JlLndvcmtlci50b1N0cmluZygpKyI7IikpO1JFTkRFUj1nbG9iYWwucmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxmdW5jdGlvbihmbil7dmFyIG9mZnNldD0obmV3IERhdGUpLmdldFRpbWUoKS1USU1FO3V0aWxpdHkuZGVmZXIoZnVuY3Rpb24oKXtmbihvZmZzZXQpfSwxNixvZmZzZXQpfTtpZih0eXBlb2YgZXhwb3J0cyE9InVuZGVmaW5lZCJ8fHR5cGVvZiBkZWZpbmU9PSJmdW5jdGlvbiJ8fHJlZ2V4LmNvbXBsZXRlX2xvYWRlZC50ZXN0KGRvY3VtZW50LnJlYWR5U3RhdGUpKWluaXQoKTtlbHNlIGlmKHR5cGVvZiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyPT0iZnVuY3Rpb24iKWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLGZ1bmN0aW9uKCl7aW5pdCgpfSxmYWxzZSk7ZWxzZSBpZih0eXBlb2YgZG9jdW1lbnQuYXR0YWNoRXZlbnQ9PSJmdW5jdGlvbiIpZG9jdW1lbnQuYXR0YWNoRXZlbnQoIm9ucmVhZHlzdGF0ZWNoYW5nZSIsZm4pO2Vsc2UgdXRpbGl0eS5yZXBlYXQoZm4pfQpib290c3RyYXAoKTtyZXR1cm57ZmlsdGVyOmZpbHRlci5mYWN0b3J5LGxpc3Q6bGlzdC5mYWN0b3J5LGdyaWQ6Z3JpZC5mYWN0b3J5LHN0b3JlOnN0b3JlLmZhY3RvcnksdXRpbDp7JDp1dGlsaXR5LiQsYXJyYXk6YXJyYXksYmFzZTp1dGlsaXR5LmJhc2UsY2xvbmU6dXRpbGl0eS5jbG9uZSxjb2VyY2U6dXRpbGl0eS5jb2VyY2UsY3Vycnk6dXRpbGl0eS5jdXJyeSxjc3Y6Y3N2LGRlZmVyOmRlZmVycmVkLmZhY3RvcnksZWxlbWVudDplbGVtZW50LGV4dGVuZDp1dGlsaXR5LmV4dGVuZCxnZW5JZDp1dGlsaXR5LmdlbklkLGl0ZXJhdGU6dXRpbGl0eS5pdGVyYXRlLGpzb246anNvbixqc29ucDpjbGllbnQuanNvbnAsbG9nOnV0aWxpdHkubG9nLGxydTpscnUuZmFjdG9yeSxtYXRoOm1hdGgsbWVyZ2U6dXRpbGl0eS5tZXJnZSxudW1iZXI6bnVtYmVyLG9ic2VydmVyOm9ic2VydmFibGUuZmFjdG9yeSxwYXJzZTp1dGlsaXR5LnBhcnNlLHBhcnRpYWw6dXRpbGl0eS5wYXJ0aWFsLHByZXZlbnQ6dXRpbGl0eS5wcmV2ZW50LApyYWNlOnV0aWxpdHkucmFjZSxyZW5kZXI6dXRpbGl0eS5yZW5kZXIscmVwZWF0OnV0aWxpdHkucmVwZWF0LHJlcXVlc3Q6Y2xpZW50LnJlcXVlc3Qsc3RvcDp1dGlsaXR5LnN0b3Asc3RyaW5nOnN0cmluZyx0YXJnZXQ6dXRpbGl0eS50YXJnZXQsdXVpZDp1dGlsaXR5LnV1aWQsd2Fsazp1dGlsaXR5LndhbGssd2hlbjp1dGlsaXR5LndoZW59LHZlcnNpb246IjAuOS4wIn19KCk7aWYodHlwZW9mIGV4cG9ydHMhPSJ1bmRlZmluZWQiKW1vZHVsZS5leHBvcnRzPWxpYjtlbHNlIGlmKHR5cGVvZiBkZWZpbmU9PSJmdW5jdGlvbiIpZGVmaW5lKGZ1bmN0aW9uKCl7cmV0dXJuIGxpYn0pO2Vsc2UgZ2xvYmFsLmtlaWdhaT1saWJ9KSh0aGlzKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VpZ2FpLm1hcAo=",
                "body": "LyoKIDIwMTQgSmFzb24gTXVsbGlnYW4KIEBsaWNlbnNlIEJTRC0zIDxodHRwczovL3Jhdy5naXRodWIuY29tL2F2b2lkd29yay9rZWlnYWkvbWFzdGVyL0xJQ0VOU0U+CiBAbGluayBodHRwOi8va2VpZ2FpLmlvCiBAbW9kdWxlIGtlaWdhaQogQHZlcnNpb24gMC45LjAKKi8KKGZ1bmN0aW9uKGdsb2JhbCl7dmFyIGRvY3VtZW50PWdsb2JhbC5kb2N1bWVudCxsb2NhdGlvbj1nbG9iYWwubG9jYXRpb24sbmF2aWdhdG9yPWdsb2JhbC5uYXZpZ2F0b3Isc2VydmVyPXR5cGVvZiBwcm9jZXNzIT0idW5kZWZpbmVkIix3ZWJXb3JrZXI9dHlwZW9mIEJsb2IhPSJ1bmRlZmluZWQiJiZ0eXBlb2YgV29ya2VyIT0idW5kZWZpbmVkIixNQVg9MTAsVkVSU0lPTlM9MTAwLENBQ0hFPTUwMCxFVkVOVFM9WyJyZWFkeXN0YXRlY2hhbmdlIiwiYWJvcnQiLCJsb2FkIiwibG9hZHN0YXJ0IiwibG9hZGVuZCIsImVycm9yIiwicHJvZ3Jlc3MiLCJ0aW1lb3V0Il0sZm9ybWF0LGh0dHAsaHR0cHMsbGliLG1vbmdvZGIsdXJsLFJFTkRFUixUSU1FLFdPUktFUjtpZihzZXJ2ZXIpe3VybD1yZXF1aXJlKCJ1cmwiKTtodHRwPXJlcXVpcmUoImh0dHAiKTtodHRwcz1yZXF1aXJlKCJodHRwcyIpO21vbmdvZGI9cmVxdWlyZSgibW9uZ29kYiIpLk1vbmdvQ2xpZW50O2Zvcm1hdD1yZXF1aXJlKCJ1dGlsIikuZm9ybWF0OwppZih0eXBlb2YgUHJvbWlzZT09InVuZGVmaW5lZCIpUHJvbWlzZT1yZXF1aXJlKCJlczYtcHJvbWlzZSIpLlByb21pc2U7aWYodHlwZW9mIFN0b3JhZ2U9PSJ1bmRlZmluZWQiKWxvY2FsU3RvcmFnZT1yZXF1aXJlKCJsb2NhbFN0b3JhZ2UiKTtpZih0eXBlb2YgWE1MSHR0cFJlcXVlc3Q9PSJ1bmRlZmluZWQiKVhNTEh0dHBSZXF1ZXN0PW51bGw7aWYodHlwZW9mIGJ0b2E9PSJ1bmRlZmluZWQiKWJ0b2E9cmVxdWlyZSgiYnRvYSIpfWVsc2UgaWYodHlwZW9mIEJ1ZmZlcj09InVuZGVmaW5lZCIpQnVmZmVyPWZ1bmN0aW9uKCl7fTtsaWI9ZnVuY3Rpb24oKXt2YXIgZXh0ZXJuYWwsaGFzLHNsaWNlO3ZhciByZWdleD17YWZ0ZXJfc3BhY2U6L1xzKy4qLyxhbGxvdzovXmFsbG93JC9pLGFsbG93X2NvcnM6L15hY2Nlc3MtY29udHJvbC1hbGxvdy1tZXRob2RzJC9pLGFuZDovXiYvLGFyZ3M6L1woKC4qKVwpLyxhdXRoOi9cL1wvKC4qKVxALyxib29sOi9eKHRydWV8ZmFsc2UpPyQvLGNhcHM6L1tBLVpdLywKY2RhdGE6L1wmfDx8PnxcInxcJ3xcdHxccnxcbnxcQHxcJC8sY2hlY2tlZF9kaXNhYmxlZDovY2hlY2tlZHxkaXNhYmxlZC9pLGNvbXBsZXRlX2xvYWRlZDovXihjb21wbGV0ZXxsb2FkZWQpJC9pLGNzdl9xdW90ZTovXlxzfFwifFxufCx8XHMkLyxkZWw6L15kZWwvLGRvbWFpbjovXltcdy4tX10rXC5bQS1aYS16XXsyLH0kLyxkb3duOi9kb3duLyxlbmRzbGFzaDovXC8kLyxlb2xfbmw6L1xuJC8sZWxlbWVudF91cGRhdGU6L2lkfGlubmVySFRNTHxpbm5lclRleHR8dGV4dENvbnRlbnR8dHlwZXxzcmMvLGdldF9oZWFkZXJzOi9eKGhlYWR8Z2V0fG9wdGlvbnMpJC8sZ2V0X3JlbW92ZV9zZXQ6L2dldHxyZW1vdmV8c2V0LyxoYXNoOi9eXCMvLGhlYWRlcl9yZXBsYWNlOi86LiovLGhlYWRlcl92YWx1ZV9yZXBsYWNlOi8uKjpccysvLGh0bWw6L148Lio+JC8saHR0cF9ib2R5Oi8yMDB8MjAxfDIwMnwyMDN8MjA2LyxodHRwX3BvcnRzOi84MHw0NDMvLGllOi9tc2llfGllL2ksaXA6L14oPzooPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pXC4pezN9KD86MjVbMC01XXwyWzAtNF1bMC05XXxbMDFdP1swLTldWzAtOV0/KSQvLAppc194bWw6L148XD94bWwuKlw/Pi8sanNvbl9tYXliZTovanNvbnxwbGFpbnxqYXZhc2NyaXB0Lyxqc29uX3dyYXA6L15bXFtce10vLGtsYXNzOi9eXC4vLG5vOi9uby1zdG9yZXxuby1jYWNoZS9pLG5vdF9kb3Rub3RhdGlvbjovLXxccy8sbm90X2VuZHBvaW50Oi8uKlwvLyxudWxsX3VuZGVmaW5lZDovbnVsbHx1bmRlZmluZWQvLG51bWJlcjovKF4tP1xkXGQqXC5cZCokKXwoXi0/XGRcZCokKXwoXi0/XC5cZFxkKiQpfG51bWJlci8sbnVtYmVyX2Zvcm1hdF8xOi8uKlwuLyxudW1iZXJfZm9ybWF0XzI6L1wuLiovLG51bWJlcl9wcmVzZW50Oi9cZHsxLH0vLG51bWJlcl9zdHJpbmc6L251bWJlcnxzdHJpbmcvaSxudW1iZXJfc3RyaW5nX29iamVjdDovbnVtYmVyfG9iamVjdHxzdHJpbmcvaSxvYmplY3RfdHlwZTovXFtvYmplY3QgT2JqZWN0XF0vLHBhdGNoOi9ecGF0Y2gkLyxwcmltaXRpdmU6L14oYm9vbGVhbnxmdW5jdGlvbnxudW1iZXJ8c3RyaW5nKSQvLHByaXY6L3ByaXZhdGUvLApwdXRfcG9zdDovXihwb3N0fHB1dCkkL2kscmFkaW9fY2hlY2tib3g6L14ocmFkaW98Y2hlY2tib3gpJC9pLHJvb3Q6L15cL1teXC9dLyxzZWxlY3Q6L3NlbGVjdC9pLHNlbGVjdG9yX2lzOi9eOi8sc2VsZWN0b3JfY29tcGxleDovXHMrfFw+fFwrfFx+fFw6fFxbLyxzZXRfZGVsOi9eKHNldHxkZWx8ZGVsZXRlKSQvLHNwYWNlX2h5cGhlbjovXHN8LS8sc3RyaW5nX29iamVjdDovc3RyaW5nfG9iamVjdC9pLHN2Zzovc3ZnLyx0b3BfYm90dG9tOi90b3B8Ym90dG9tL2ksdXJsOi9eKD86KD86aHR0cHM/fGZ0cCk6XC9cLykoPzpcUysoPzo6XFMqKT9AKT8oPzooPyExMCg/OlwuXGR7MSwzfSl7M30pKD8hMTI3KD86XC5cZHsxLDN9KXszfSkoPyExNjlcLjI1NCg/OlwuXGR7MSwzfSl7Mn0pKD8hMTkyXC4xNjgoPzpcLlxkezEsM30pezJ9KSg/ITE3MlwuKD86MVs2LTldfDJcZHwzWzAtMV0pKD86XC5cZHsxLDN9KXsyfSkoPzpbMS05XVxkP3wxXGRcZHwyWzAxXVxkfDIyWzAtM10pKD86XC4oPzoxP1xkezEsMn18MlswLTRdXGR8MjVbMC01XSkpezJ9KD86XC4oPzpbMS05XVxkP3wxXGRcZHwyWzAtNF1cZHwyNVswLTRdKSl8KD86KD86W2Etelx1MDBhMS1cdWZmZmYwLTldKy0/KSpbYS16XHUwMGExLVx1ZmZmZjAtOV0rKSg/OlwuKD86W2Etelx1MDBhMS1cdWZmZmYwLTldKy0/KSpbYS16XHUwMGExLVx1ZmZmZjAtOV0rKSooPzpcLig/OlthLXpcdTAwYTEtXHVmZmZmXXsyLH0pKSkoPzo6XGR7Miw1fSk/KD86XC9bXlxzXSopPyQvaSwKd29yZDovXlx3KyQvLHhkb21haW5yZXF1ZXN0Oi9eKGdldHxwb3N0KSQvaSx4bWw6L3htbC9pfTt2YXIgbHJ1PXtmYWN0b3J5OmZ1bmN0aW9uKG1heCl7cmV0dXJuIG5ldyBMUlUobWF4KX19O2Z1bmN0aW9uIExSVShtYXgpe3RoaXMuY2FjaGU9e307dGhpcy5tYXg9bWF4fHwxRTM7dGhpcy5maXJzdD1udWxsO3RoaXMubGFzdD1udWxsO3RoaXMubGVuZ3RoPTB9TFJVLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1MUlU7TFJVLnByb3RvdHlwZS5ldmljdD1mdW5jdGlvbigpe2lmKHRoaXMubGFzdCE9PW51bGwpdGhpcy5yZW1vdmUodGhpcy5sYXN0KTtyZXR1cm4gdGhpc307TFJVLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oa2V5KXt2YXIgaXRlbT10aGlzLmNhY2hlW2tleV07aWYoaXRlbT09PXVuZGVmaW5lZClyZXR1cm47dGhpcy5zZXQoa2V5LGl0ZW0udmFsdWUpO3JldHVybiBpdGVtLnZhbHVlfTtMUlUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihrZXkpe3ZhciBpdGVtPXRoaXMuY2FjaGVba2V5XTsKaWYoaXRlbSl7ZGVsZXRlIHRoaXMuY2FjaGVba2V5XTt0aGlzLmxlbmd0aC0tO2lmKGl0ZW0ucHJldmlvdXMhPT1udWxsKXRoaXMuY2FjaGVbaXRlbS5wcmV2aW91c10ubmV4dD1pdGVtLm5leHQ7aWYoaXRlbS5uZXh0IT09bnVsbCl0aGlzLmNhY2hlW2l0ZW0ubmV4dF0ucHJldmlvdXM9aXRlbS5wcmV2aW91cztpZih0aGlzLmZpcnN0PT09a2V5KXRoaXMuZmlyc3Q9aXRlbS5wcmV2aW91cztpZih0aGlzLmxhc3Q9PT1rZXkpdGhpcy5sYXN0PWl0ZW0ubmV4dH1yZXR1cm4gaXRlbX07TFJVLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oa2V5LHZhbHVlKXt2YXIgaXRlbT10aGlzLnJlbW92ZShrZXkpO2lmKGl0ZW09PT11bmRlZmluZWQpaXRlbT1uZXcgTFJVSXRlbSh2YWx1ZSk7ZWxzZSBpdGVtLnZhbHVlPXZhbHVlO2l0ZW0ubmV4dD1udWxsO2l0ZW0ucHJldmlvdXM9dGhpcy5maXJzdDt0aGlzLmNhY2hlW2tleV09aXRlbTtpZih0aGlzLmZpcnN0IT09bnVsbCl0aGlzLmNhY2hlW3RoaXMuZmlyc3RdLm5leHQ9CmtleTt0aGlzLmZpcnN0PWtleTtpZih0aGlzLmxhc3Q9PT1udWxsKXRoaXMubGFzdD1rZXk7aWYoKyt0aGlzLmxlbmd0aD50aGlzLm1heCl0aGlzLmV2aWN0KCk7cmV0dXJuIHRoaXN9O2Z1bmN0aW9uIExSVUl0ZW0odmFsdWUpe3RoaXMubmV4dD1udWxsO3RoaXMucHJldmlvdXM9bnVsbDt0aGlzLnZhbHVlPXZhbHVlfUxSVUl0ZW0ucHJvdG90eXBlLmNvbnN0cnVjdG9yPUxSVUl0ZW07dmFyIG9ic2VydmFibGU9e2ZhY3Rvcnk6ZnVuY3Rpb24oYXJnKXtyZXR1cm4gbmV3IE9ic2VydmFibGUoYXJnKX19O2Z1bmN0aW9uIE9ic2VydmFibGUoYXJnKXt0aGlzLmxpbWl0PWFyZ3x8TUFYO3RoaXMubGlzdGVuZXJzPXt9O3RoaXMuaG9va3M9e319T2JzZXJ2YWJsZS5wcm90b3R5cGUuY29uc3RydWN0b3I9T2JzZXJ2YWJsZTtPYnNlcnZhYmxlLnByb3RvdHlwZS5kaXNwYXRjaD1mdW5jdGlvbigpe3ZhciBhcmdzPWFycmF5LmNhc3QoYXJndW1lbnRzKSxldj1hcmdzLnNoaWZ0KCk7aWYoZXYmJgp0aGlzLmxpc3RlbmVyc1tldl0pdXRpbGl0eS5pdGVyYXRlKHRoaXMubGlzdGVuZXJzW2V2XSxmdW5jdGlvbihpKXtpLmhhbmRsZXIuYXBwbHkoaS5zY29wZSxhcmdzKX0pO3JldHVybiB0aGlzfTtPYnNlcnZhYmxlLnByb3RvdHlwZS5ob29rPWZ1bmN0aW9uKHRhcmdldCxldil7dmFyIHNlbGY9dGhpcztpZih0eXBlb2YgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIhPSJmdW5jdGlvbiIpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO3V0aWxpdHkuZ2VuSWQodGFyZ2V0KTt0aGlzLmhvb2tzW3RhcmdldC5pZF09ZnVuY3Rpb24oYXJnKXtzZWxmLmRpc3BhdGNoKGV2LGFyZyl9O3RhcmdldC5hZGRFdmVudExpc3RlbmVyKGV2LHRoaXMuaG9va3NbdGFyZ2V0LmlkXSxmYWxzZSk7cmV0dXJuIHRhcmdldH07T2JzZXJ2YWJsZS5wcm90b3R5cGUub2ZmPWZ1bmN0aW9uKGV2LGlkKXtpZih0aGlzLmxpc3RlbmVyc1tldl0paWYoaWQpZGVsZXRlIHRoaXMubGlzdGVuZXJzW2V2XVtpZF07CmVsc2UgZGVsZXRlIHRoaXMubGlzdGVuZXJzW2V2XTtyZXR1cm4gdGhpc307T2JzZXJ2YWJsZS5wcm90b3R5cGUub249ZnVuY3Rpb24oZXYsaGFuZGxlcixpZCxzY29wZSl7aWQ9aWR8fHV0aWxpdHkudXVpZCgpO3Njb3BlPXNjb3BlfHx0aGlzO2lmKCF0aGlzLmxpc3RlbmVyc1tldl0pdGhpcy5saXN0ZW5lcnNbZXZdPXt9O2lmKGFycmF5LmtleXModGhpcy5saXN0ZW5lcnNbZXZdKS5sZW5ndGg+PXRoaXMubGltaXQpdGhyb3cgbmV3IEVycm9yKCJQb3NzaWJsZSBtZW1vcnkgbGVhaywgbW9yZSB0aGFuICIrdGhpcy5saW1pdCsiIGxpc3RlbmVycyBmb3IgZXZlbnQ6ICIrZXYpO3RoaXMubGlzdGVuZXJzW2V2XVtpZF09e3Njb3BlOnNjb3BlLGhhbmRsZXI6aGFuZGxlcn07cmV0dXJuIHRoaXN9O09ic2VydmFibGUucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24oZXYsaGFuZGxlcixpZCxzY29wZSl7dmFyIHNlbGY9dGhpcztpZD1pZHx8dXRpbGl0eS51dWlkKCk7c2NvcGU9c2NvcGV8fHRoaXM7CnJldHVybiB0aGlzLm9uKGV2LGZ1bmN0aW9uKCl7aGFuZGxlci5hcHBseShzY29wZSxbXS5jb25jYXQoYXJyYXkuY2FzdChhcmd1bWVudHMpKSk7c2VsZi5vZmYoZXYsaWQpfSxpZCxzY29wZSl9O09ic2VydmFibGUucHJvdG90eXBlLnVuaG9vaz1mdW5jdGlvbih0YXJnZXQsZXYpe3RhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKGV2LHRoaXMuaG9va3NbdGFyZ2V0LmlkXSxmYWxzZSk7ZGVsZXRlIHRoaXMuaG9va3NbdGFyZ2V0LmlkXTtyZXR1cm4gdGFyZ2V0fTt2YXIgYmFzZT17ZmFjdG9yeTpmdW5jdGlvbigpe3JldHVybiBuZXcgQmFzZX19O2Z1bmN0aW9uIEJhc2UoKXt0aGlzLm9ic2VydmVyPW51bGx9QmFzZS5wcm90b3R5cGUuY29uc3RydWN0b3I9QmFzZTtCYXNlLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGV2LGxpc3RlbmVyLGlkLHNjb3BlKXt0aGlzLm9ic2VydmVyLm9uKGV2LGxpc3RlbmVyLGlkLHNjb3BlfHx0aGlzKTtyZXR1cm4gdGhpc307QmFzZS5wcm90b3R5cGUuYWRkTGlzdGVuZXI9CmZ1bmN0aW9uKGV2LGxpc3RlbmVyLGlkLHNjb3BlKXt0aGlzLm9ic2VydmVyLm9uKGV2LGxpc3RlbmVyLGlkLHNjb3BlfHx0aGlzKTtyZXR1cm4gdGhpc307QmFzZS5wcm90b3R5cGUuZGlzcGF0Y2g9ZnVuY3Rpb24oKXt0aGlzLm9ic2VydmVyLmRpc3BhdGNoLmFwcGx5KHRoaXMub2JzZXJ2ZXIsW10uY29uY2F0KGFycmF5LmNhc3QoYXJndW1lbnRzKSkpO3JldHVybiB0aGlzfTtCYXNlLnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50PWZ1bmN0aW9uKCl7dGhpcy5vYnNlcnZlci5kaXNwYXRjaC5hcHBseSh0aGlzLm9ic2VydmVyLFtdLmNvbmNhdChhcnJheS5jYXN0KGFyZ3VtZW50cykpKTtyZXR1cm4gdGhpc307QmFzZS5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbigpe3RoaXMub2JzZXJ2ZXIuZGlzcGF0Y2guYXBwbHkodGhpcy5vYnNlcnZlcixbXS5jb25jYXQoYXJyYXkuY2FzdChhcmd1bWVudHMpKSk7cmV0dXJuIHRoaXN9O0Jhc2UucHJvdG90eXBlLmhvb2s9ZnVuY3Rpb24oKXt0aGlzLm9ic2VydmVyLmhvb2suYXBwbHkodGhpcy5vYnNlcnZlciwKW10uY29uY2F0KGFycmF5LmNhc3QoYXJndW1lbnRzKSkpO3JldHVybiB0aGlzfTtCYXNlLnByb3RvdHlwZS5saXN0ZW5lcnM9ZnVuY3Rpb24oZXYpe3JldHVybiBldj90aGlzLm9ic2VydmVyLmxpc3RlbmVyc1tldl06dGhpcy5saXN0ZW5lcnN9O0Jhc2UucHJvdG90eXBlLm9mZj1mdW5jdGlvbihldixpZCl7dGhpcy5vYnNlcnZlci5vZmYoZXYsaWQpO3JldHVybiB0aGlzfTtCYXNlLnByb3RvdHlwZS5vbj1mdW5jdGlvbihldixsaXN0ZW5lcixpZCxzY29wZSl7dGhpcy5vYnNlcnZlci5vbihldixsaXN0ZW5lcixpZCxzY29wZXx8dGhpcyk7cmV0dXJuIHRoaXN9O0Jhc2UucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24oZXYsbGlzdGVuZXIsaWQsc2NvcGUpe3RoaXMub2JzZXJ2ZXIub25jZShldixsaXN0ZW5lcixpZCxzY29wZXx8dGhpcyk7cmV0dXJuIHRoaXN9O0Jhc2UucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZXYsaWQpe3RoaXMub2JzZXJ2ZXIub2ZmKGV2LAppZCk7cmV0dXJuIHRoaXN9O0Jhc2UucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyPWZ1bmN0aW9uKGV2LGlkKXt0aGlzLm9ic2VydmVyLm9mZihldixpZCk7cmV0dXJuIHRoaXN9O3ZhciBhcnJheT17YWRkOmZ1bmN0aW9uKG9iaixhcmcpe2lmKCFhcnJheS5jb250YWlucyhvYmosYXJnKSlvYmoucHVzaChhcmcpO3JldHVybiBvYmp9LGJpbkluZGV4OmZ1bmN0aW9uKG9iaixhcmcpe3ZhciBtaW49MCxtYXg9b2JqLmxlbmd0aC0xLGlkeCx2YWw7d2hpbGUobWluPD1tYXgpe2lkeD1NYXRoLmZsb29yKChtaW4rbWF4KS8yKTt2YWw9b2JqW2lkeF07aWYodmFsPGFyZyltaW49aWR4KzE7ZWxzZSBpZih2YWw+YXJnKW1heD1pZHgtMTtlbHNlIHJldHVybiBpZHh9cmV0dXJuLTF9LGNhc3Q6ZnVuY3Rpb24ob2JqLGtleSl7a2V5PWtleT09PXRydWU7dmFyIG89W107aWYoIWlzTmFOKG9iai5sZW5ndGgpKW89c2xpY2UuY2FsbChvYmopO2Vsc2UgaWYoa2V5KW89YXJyYXkua2V5cyhvYmopO2Vsc2UgdXRpbGl0eS5pdGVyYXRlKG9iaiwKZnVuY3Rpb24oaSl7by5wdXNoKGkpfSk7cmV0dXJuIG99LGNodW5rOmZ1bmN0aW9uKG9iaixzaXplKXt2YXIgcmVzdWx0PVtdLG50aD1udW1iZXIucm91bmQob2JqLmxlbmd0aC9zaXplLCJ1cCIpLHN0YXJ0PTAsaT0tMTt3aGlsZSgrK2k8bnRoKXtzdGFydD1pKnNpemU7cmVzdWx0LnB1c2goYXJyYXkubGltaXQob2JqLHN0YXJ0LHNpemUpKX1yZXR1cm4gcmVzdWx0fSxjbGVhcjpmdW5jdGlvbihvYmope3JldHVybiBvYmoubGVuZ3RoPjA/YXJyYXkucmVtb3ZlKG9iaiwwLG9iai5sZW5ndGgpOm9ian0sY2xvbmU6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gb2JqLnNsaWNlKCl9LGNvbnRhaW5zOmZ1bmN0aW9uKG9iaixhcmcpe3JldHVybiBvYmouaW5kZXhPZihhcmcpPi0xfSxjb2xsZWN0OmZ1bmN0aW9uKG9iaixmbil7dmFyIHJlc3VsdD1bXTthcnJheS5lYWNoKG9iaixmdW5jdGlvbihpKXtyZXN1bHQucHVzaChmbihpKSl9KTtyZXR1cm4gcmVzdWx0fSxjb21wYWN0OmZ1bmN0aW9uKG9iaiwKZGlmZil7ZGlmZj1kaWZmPT09dHJ1ZTt2YXIgcmVzdWx0O3Jlc3VsdD1vYmouZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiFyZWdleC5udWxsX3VuZGVmaW5lZC50ZXN0KGkpfSk7cmV0dXJuIWRpZmY/cmVzdWx0OnJlc3VsdC5sZW5ndGg8b2JqLmxlbmd0aD9yZXN1bHQ6bnVsbH0sY291bnQ6ZnVuY3Rpb24ob2JqLHZhbHVlKXtyZXR1cm4gb2JqLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaT09PXZhbHVlfSkubGVuZ3RofSxkaWZmOmZ1bmN0aW9uKG9iajEsb2JqMil7dmFyIHJlc3VsdD1bXTthcnJheS5lYWNoKG9iajEsZnVuY3Rpb24oaSl7aWYoIWFycmF5LmNvbnRhaW5zKG9iajIsaSkpYXJyYXkuYWRkKHJlc3VsdCxpKX0pO2FycmF5LmVhY2gob2JqMixmdW5jdGlvbihpKXtpZighYXJyYXkuY29udGFpbnMob2JqMSxpKSlhcnJheS5hZGQocmVzdWx0LGkpfSk7cmV0dXJuIHJlc3VsdH0sZWFjaDpmdW5jdGlvbihvYmosZm4sYXN5bmMsc2l6ZSl7dmFyIG50aD1vYmoubGVuZ3RoLAppLG9mZnNldDtpZihhc3luYyE9PXRydWUpe2k9LTE7d2hpbGUoKytpPG50aClpZihmbi5jYWxsKG9iaixvYmpbaV0saSk9PT1mYWxzZSlicmVha31lbHNle3NpemU9c2l6ZXx8MTA7b2Zmc2V0PTA7aWYoc2l6ZT5udGgpc2l6ZT1udGg7dXRpbGl0eS5yZXBlYXQoZnVuY3Rpb24oKXt2YXIgaT0tMSxpZHg7d2hpbGUoKytpPHNpemUpe2lkeD1pK29mZnNldDtpZihpZHg9PT1udGh8fGZuLmNhbGwob2JqLG9ialtpZHhdLGlkeCk9PT1mYWxzZSlyZXR1cm4gZmFsc2V9b2Zmc2V0Kz1zaXplO2lmKG9mZnNldD49bnRoKXJldHVybiBmYWxzZX0sdW5kZWZpbmVkLHVuZGVmaW5lZCxmYWxzZSl9cmV0dXJuIG9ian0sZWFjaFJldmVyc2U6ZnVuY3Rpb24ob2JqLGZuLGFzeW5jLHNpemUpe3ZhciBudGg9b2JqLmxlbmd0aCxpLG9mZnNldDtpZihhc3luYyE9PXRydWUpe2k9bnRoO3doaWxlKC0taT4tMSlpZihmbi5jYWxsKG9iaixvYmpbaV0saSk9PT1mYWxzZSlicmVha31lbHNle3NpemU9c2l6ZXx8CjEwO29mZnNldD1udGgtMTtpZihzaXplPm50aClzaXplPW50aDt1dGlsaXR5LnJlcGVhdChmdW5jdGlvbigpe3ZhciBpPS0xLGlkeDt3aGlsZSgrK2k8c2l6ZSl7aWR4PW9mZnNldC1pO2lmKGlkeDwwfHxmbi5jYWxsKG9iaixvYmpbaWR4XSxpZHgpPT09ZmFsc2UpcmV0dXJuIGZhbHNlfW9mZnNldC09c2l6ZTtpZihvZmZzZXQ8MClyZXR1cm4gZmFsc2V9LHVuZGVmaW5lZCx1bmRlZmluZWQsZmFsc2UpfXJldHVybiBvYmp9LGVtcHR5OmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai5sZW5ndGg9PT0wfSxlcXVhbDpmdW5jdGlvbihvYmoxLG9iajIpe3JldHVybiBqc29uLmVuY29kZShvYmoxKT09PWpzb24uZW5jb2RlKG9iajIpfSxmaWI6ZnVuY3Rpb24oYXJnKXt2YXIgcmVzdWx0PVsxLDFdLGZpcnN0PXJlc3VsdFswXSxzZWNvbmQ9cmVzdWx0WzFdLHN1bTthcmc9KGFyZ3x8MTAwKS0xO2lmKGlzTmFOKGFyZyl8fGFyZzwyKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTsKd2hpbGUoLS1hcmcpe3N1bT1maXJzdCtzZWNvbmQ7Zmlyc3Q9c2Vjb25kO3NlY29uZD1zdW07cmVzdWx0LnB1c2goc3VtKX1yZXR1cm4gcmVzdWx0fSxmaWxsOmZ1bmN0aW9uKG9iaixhcmcsc3RhcnQsb2Zmc2V0KXt2YXIgZm49dHlwZW9mIGFyZz09ImZ1bmN0aW9uIixsPW9iai5sZW5ndGgsaT0haXNOYU4oc3RhcnQpP3N0YXJ0OjAsbnRoPSFpc05hTihvZmZzZXQpP2krb2Zmc2V0OmwtMTtpZihudGg+bC0xKW50aD1sLTE7d2hpbGUoaTw9bnRoKXtvYmpbaV09Zm4/YXJnKG9ialtpXSk6YXJnO2krK31yZXR1cm4gb2JqfSxmaXJzdDpmdW5jdGlvbihvYmope3JldHVybiBvYmpbMF19LGZsYXQ6ZnVuY3Rpb24ob2JqKXt2YXIgcmVzdWx0PVtdO3Jlc3VsdD1vYmoucmVkdWNlKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29uY2F0KGIpfSxyZXN1bHQpO3JldHVybiByZXN1bHR9LGZvckVhY2g6ZnVuY3Rpb24ob2JqLGZuLGFzeW5jLHNpemUpe3JldHVybiBhcnJheS5lYWNoKG9iaixmbixhc3luYywKc2l6ZSl9LGZyb21PYmplY3Q6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gYXJyYXkubWluZ2xlKGFycmF5LmtleXMob2JqKSxhcnJheS5jYXN0KG9iaikpfSxpbmRleDpmdW5jdGlvbihvYmosYXJnKXtyZXR1cm4gb2JqLmluZGV4T2YoYXJnKX0saW5kZXhlZDpmdW5jdGlvbihvYmope3ZhciBpbmRleGVkPVtdO3V0aWxpdHkuaXRlcmF0ZShvYmosZnVuY3Rpb24odil7aW5kZXhlZC5wdXNoKHYpfSk7cmV0dXJuIGluZGV4ZWR9LGludGVyc2VjdDpmdW5jdGlvbihvYmoxLG9iajIpe3ZhciBhPW9iajEubGVuZ3RoPm9iajIubGVuZ3RoP29iajE6b2JqMixiPWE9PT1vYmoxP29iajI6b2JqMTtyZXR1cm4gYS5maWx0ZXIoZnVuY3Rpb24oa2V5KXtyZXR1cm4gYXJyYXkuY29udGFpbnMoYixrZXkpfSl9LGtlZXBJZjpmdW5jdGlvbihvYmosZm4pe2lmKHR5cGVvZiBmbiE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7dmFyIHJlc3VsdD1bXSxyZW1vdmU9CltdO3Jlc3VsdD1vYmouZmlsdGVyKGZuKTtyZW1vdmU9YXJyYXkuZGlmZihvYmoscmVzdWx0KTthcnJheS5lYWNoKHJlbW92ZSxmdW5jdGlvbihpKXthcnJheS5yZW1vdmUob2JqLGFycmF5LmluZGV4KG9iaixpKSl9KTtyZXR1cm4gb2JqfSxrZXlzOmZ1bmN0aW9uKG9iail7cmV0dXJuIE9iamVjdC5rZXlzKG9iail9LGtleVNvcnQ6ZnVuY3Rpb24ob2JqLHF1ZXJ5LHN1Yil7cXVlcnk9cXVlcnkucmVwbGFjZSgvXHMqYXNjL2lnLCIiKS5yZXBsYWNlKC9ccypkZXNjL2lnLCIgZGVzYyIpO3ZhciBxdWVyaWVzPXN0cmluZy5leHBsb2RlKHF1ZXJ5KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuc3BsaXQoIiAiKX0pLHNvcnRzPVtdLGJyYWNlUz0nWyInLGJyYWNlRT0nIl0nO2lmKHN1YiYmc3ViIT09IiIpc3ViPSIuIitzdWI7ZWxzZSBzdWI9IiI7YXJyYXkuZWFjaChxdWVyaWVzLGZ1bmN0aW9uKGkpe3ZhciBzPSIuIixlPSIiO2lmKHJlZ2V4Lm5vdF9kb3Rub3RhdGlvbi50ZXN0KGlbMF0pKXtzPQpicmFjZVM7ZT1icmFjZUV9c29ydHMucHVzaCgidHJ5IHsiKTtpZihpWzFdPT09ImRlc2MiKXtzb3J0cy5wdXNoKCJpZiAoIGEiK3N1YitzK2lbMF0rZSsiIDwgYiIrc3ViK3MraVswXStlKyIgKSByZXR1cm4gMTsiKTtzb3J0cy5wdXNoKCJpZiAoIGEiK3N1YitzK2lbMF0rZSsiID4gYiIrc3ViK3MraVswXStlKyIgKSByZXR1cm4gLTE7Iil9ZWxzZXtzb3J0cy5wdXNoKCJpZiAoIGEiK3N1YitzK2lbMF0rZSsiIDwgYiIrc3ViK3MraVswXStlKyIgKSByZXR1cm4gLTE7Iik7c29ydHMucHVzaCgiaWYgKCBhIitzdWIrcytpWzBdK2UrIiA+IGIiK3N1YitzK2lbMF0rZSsiICkgcmV0dXJuIDE7Iil9c29ydHMucHVzaCgifSBjYXRjaCAoZSkgeyIpO3NvcnRzLnB1c2goInRyeSB7Iik7c29ydHMucHVzaCgiaWYgKCBhIitzdWIrcytpWzBdK2UrIiAhPT0gdW5kZWZpbmVkICkgcmV0dXJuICIrKGlbMV09PT0iZGVzYyI/Ii0xIjoiMSIpKyI7Iik7c29ydHMucHVzaCgifSBjYXRjaCAoZSkge30iKTsKc29ydHMucHVzaCgidHJ5IHsiKTtzb3J0cy5wdXNoKCJpZiAoIGIiK3N1YitzK2lbMF0rZSsiICE9PSB1bmRlZmluZWQgKSByZXR1cm4gIisoaVsxXT09PSJkZXNjIj8iMSI6Ii0xIikrIjsiKTtzb3J0cy5wdXNoKCJ9IGNhdGNoIChlKSB7fSIpO3NvcnRzLnB1c2goIn0iKX0pO3NvcnRzLnB1c2goInJldHVybiAwOyIpO3JldHVybiBvYmouc29ydChuZXcgRnVuY3Rpb24oImEiLCJiIixzb3J0cy5qb2luKCJcbiIpKSl9LGxhc3Q6ZnVuY3Rpb24ob2JqLGFyZyl7dmFyIG49b2JqLmxlbmd0aC0xO2lmKGFyZz49bisxKXJldHVybiBvYmo7ZWxzZSBpZihpc05hTihhcmcpfHxhcmc9PT0xKXJldHVybiBvYmpbbl07ZWxzZSByZXR1cm4gYXJyYXkubGltaXQob2JqLG4tIC0tYXJnLG4pfSxsaW1pdDpmdW5jdGlvbihvYmosc3RhcnQsb2Zmc2V0KXt2YXIgcmVzdWx0PVtdLGk9c3RhcnQtMSxudGg9c3RhcnQrb2Zmc2V0LG1heD1vYmoubGVuZ3RoO2lmKG1heD4wKXdoaWxlKCsraTxudGgmJmk8Cm1heClyZXN1bHQucHVzaChvYmpbaV0pO3JldHVybiByZXN1bHR9LG1heDpmdW5jdGlvbihvYmope3JldHVybiBhcnJheS5sYXN0KG9iai5zb3J0KGFycmF5LnNvcnQpKX0sbWVhbjpmdW5jdGlvbihvYmope3JldHVybiBvYmoubGVuZ3RoPjA/YXJyYXkuc3VtKG9iaikvb2JqLmxlbmd0aDp1bmRlZmluZWR9LG1lZGlhbjpmdW5jdGlvbihvYmope3ZhciBudGg9b2JqLmxlbmd0aCxtaWQ9bnVtYmVyLnJvdW5kKG50aC8yLCJkb3duIiksc29ydGVkPW9iai5zb3J0KGFycmF5LnNvcnQpO3JldHVybiBudW1iZXIub2RkKG50aCk/c29ydGVkW21pZF06KHNvcnRlZFttaWQtMV0rc29ydGVkW21pZF0pLzJ9LG1lcmdlOmZ1bmN0aW9uKG9iajEsb2JqMil7YXJyYXkuZWFjaChvYmoyLGZ1bmN0aW9uKGkpe2FycmF5LmFkZChvYmoxLGkpfSk7cmV0dXJuIG9iajF9LG1pbjpmdW5jdGlvbihvYmope3JldHVybiBvYmouc29ydChhcnJheS5zb3J0KVswXX0sbWluZ2xlOmZ1bmN0aW9uKG9iajEsb2JqMil7dmFyIHJlc3VsdDsKcmVzdWx0PW9iajEubWFwKGZ1bmN0aW9uKGksaWR4KXtyZXR1cm5baSxvYmoyW2lkeF1dfSk7cmV0dXJuIHJlc3VsdH0sbW9kZTpmdW5jdGlvbihvYmope3ZhciB2YWx1ZXM9e30sY291bnQ9MCxtb2RlPVtdLG50aCxyZXN1bHQ7YXJyYXkuZWFjaChvYmosZnVuY3Rpb24oaSl7aWYoIWlzTmFOKHZhbHVlc1tpXSkpdmFsdWVzW2ldKys7ZWxzZSB2YWx1ZXNbaV09MX0pO2NvdW50PWFycmF5Lm1heChhcnJheS5jYXN0KHZhbHVlcykpO3V0aWxpdHkuaXRlcmF0ZSh2YWx1ZXMsZnVuY3Rpb24odixrKXtpZih2PT09Y291bnQpbW9kZS5wdXNoKG51bWJlci5wYXJzZShrKSl9KTtudGg9bW9kZS5sZW5ndGg7aWYobnRoPjApcmVzdWx0PW50aD09PTE/bW9kZVswXTptb2RlO3JldHVybiByZXN1bHR9LHBlcmNlbnRzOmZ1bmN0aW9uKG9iaixwcmVjaXNpb24sdG90YWwpe3ZhciByZXN1bHQ9W10sY3VzdG9tPWZhbHNlLGxhc3QscGFkZGluZyxzdW07cHJlY2lzaW9uPXByZWNpc2lvbnx8MDtpZih0b3RhbD09PQp1bmRlZmluZWQpdG90YWw9YXJyYXkuc3VtKG9iaik7ZWxzZSBjdXN0b209dHJ1ZTthcnJheS5lYWNoKG9iaixmdW5jdGlvbihpKXtyZXN1bHQucHVzaChudW1iZXIucGFyc2UoKGkvdG90YWwqMTAwKS50b0ZpeGVkKHByZWNpc2lvbikpKX0pO2lmKCFjdXN0b20pe3N1bT1hcnJheS5zdW0ocmVzdWx0KTtpZihzdW08MTAwKXtwYWRkaW5nPW51bWJlci5wYXJzZShudW1iZXIuZGlmZihzdW0sMTAwKS50b0ZpeGVkKHByZWNpc2lvbikpO2xhc3Q9YXJyYXkubGFzdChyZXN1bHQpK3BhZGRpbmc7cmVzdWx0W3Jlc3VsdC5sZW5ndGgtMV09bGFzdH1lbHNlIGlmKHN1bT4xMDApe3BhZGRpbmc9bnVtYmVyLnBhcnNlKG51bWJlci5kaWZmKHN1bSwxMDApLnRvRml4ZWQocHJlY2lzaW9uKSk7bGFzdD1udW1iZXIucGFyc2UoKGFycmF5Lmxhc3QocmVzdWx0KS1wYWRkaW5nKS50b0ZpeGVkKHByZWNpc2lvbikpO3Jlc3VsdFtyZXN1bHQubGVuZ3RoLTFdPWxhc3R9fXJldHVybiByZXN1bHR9LHJhbmdlOmZ1bmN0aW9uKG9iail7cmV0dXJuIGFycmF5Lm1heChvYmopLQphcnJheS5taW4ob2JqKX0scmFzc29jOmZ1bmN0aW9uKG9iaixhcmcpe3ZhciByZXN1bHQ7YXJyYXkuZWFjaChvYmosZnVuY3Rpb24oaSxpZHgpe2lmKGlbMV09PT1hcmcpe3Jlc3VsdD1vYmpbaWR4XTtyZXR1cm4gZmFsc2V9fSk7cmV0dXJuIHJlc3VsdH0scmVqZWN0OmZ1bmN0aW9uKG9iaixmbil7cmV0dXJuIGFycmF5LmRpZmYob2JqLG9iai5maWx0ZXIoZm4pKX0scmVtb3ZlOmZ1bmN0aW9uKG9iaixzdGFydCxlbmQpe2lmKGlzTmFOKHN0YXJ0KSl7c3RhcnQ9b2JqLmluZGV4T2Yoc3RhcnQpO2lmKHN0YXJ0PT09LTEpcmV0dXJuIG9ian1lbHNlIHN0YXJ0PXN0YXJ0fHwwO3ZhciBsZW5ndGg9b2JqLmxlbmd0aCxyZW1haW5pbmc9b2JqLnNsaWNlKChlbmR8fHN0YXJ0KSsxfHxsZW5ndGgpO29iai5sZW5ndGg9c3RhcnQ8MD9sZW5ndGgrc3RhcnQ6c3RhcnQ7b2JqLnB1c2guYXBwbHkob2JqLHJlbWFpbmluZyk7cmV0dXJuIG9ian0scmVtb3ZlSWY6ZnVuY3Rpb24ob2JqLGZuKXt2YXIgcmVtb3ZlOwppZih0eXBlb2YgZm4hPSJmdW5jdGlvbiIpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO3JlbW92ZT1vYmouZmlsdGVyKGZuKTthcnJheS5lYWNoKHJlbW92ZSxmdW5jdGlvbihpKXthcnJheS5yZW1vdmUob2JqLGFycmF5LmluZGV4KG9iaixpKSl9KTtyZXR1cm4gb2JqfSxyZW1vdmVXaGlsZTpmdW5jdGlvbihvYmosZm4pe2lmKHR5cGVvZiBmbiE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7dmFyIHJlbW92ZT1bXTthcnJheS5lYWNoKG9iaixmdW5jdGlvbihpKXtpZihmbihpKSE9PWZhbHNlKXJlbW92ZS5wdXNoKGkpO2Vsc2UgcmV0dXJuIGZhbHNlfSk7YXJyYXkuZWFjaChyZW1vdmUsZnVuY3Rpb24oaSl7YXJyYXkucmVtb3ZlKG9iaixhcnJheS5pbmRleChvYmosaSkpfSk7cmV0dXJuIG9ian0scmVwbGFjZTpmdW5jdGlvbihvYmoxLG9iajIpe2FycmF5LnJlbW92ZShvYmoxLDAsb2JqMS5sZW5ndGgpO2FycmF5LmVhY2gob2JqMiwKZnVuY3Rpb24oaSl7b2JqMS5wdXNoKGkpfSk7cmV0dXJuIG9iajF9LHJlc3Q6ZnVuY3Rpb24ob2JqLGFyZyl7YXJnPWFyZ3x8MTtpZihhcmc8MSlhcmc9MTtyZXR1cm4gYXJyYXkubGltaXQob2JqLGFyZyxvYmoubGVuZ3RoKX0scmluZGV4OmZ1bmN0aW9uKG9iaixhcmcpe3ZhciByZXN1bHQ9LTE7YXJyYXkuZWFjaChvYmosZnVuY3Rpb24oaSxpZHgpe2lmKGk9PT1hcmcpcmVzdWx0PWlkeH0pO3JldHVybiByZXN1bHR9LHJvdGF0ZTpmdW5jdGlvbihvYmosYXJnKXt2YXIgbnRoPW9iai5sZW5ndGgscmVzdWx0O2lmKGFyZz09PTApcmVzdWx0PW9iajtlbHNle2lmKGFyZzwwKWFyZys9bnRoO2Vsc2UgYXJnLS07cmVzdWx0PWFycmF5LmxpbWl0KG9iaixhcmcsbnRoKTtyZXN1bHQ9cmVzdWx0LmNvbmNhdChhcnJheS5saW1pdChvYmosMCxhcmcpKX1yZXR1cm4gcmVzdWx0fSxzZXJpZXM6ZnVuY3Rpb24oc3RhcnQsZW5kLG9mZnNldCl7c3RhcnQ9c3RhcnR8fDA7ZW5kPWVuZHx8c3RhcnQ7Cm9mZnNldD1vZmZzZXR8fDE7dmFyIHJlc3VsdD1bXSxuPS0xLG50aD1NYXRoLm1heCgwLE1hdGguY2VpbCgoZW5kLXN0YXJ0KS9vZmZzZXQpKTt3aGlsZSgrK248bnRoKXtyZXN1bHRbbl09c3RhcnQ7c3RhcnQrPW9mZnNldH1yZXR1cm4gcmVzdWx0fSxzb3J0OmZ1bmN0aW9uKGEsYil7dmFyIHR5cGVzPXthOnR5cGVvZiBhLGI6dHlwZW9mIGJ9LGMsZCxyZXN1bHQ7aWYodHlwZXMuYT09PSJudW1iZXIiJiZ0eXBlcy5iPT09Im51bWJlciIpcmVzdWx0PWEtYjtlbHNle2M9YS50b1N0cmluZygpO2Q9Yi50b1N0cmluZygpO2lmKGM8ZClyZXN1bHQ9LTE7ZWxzZSBpZihjPmQpcmVzdWx0PTE7ZWxzZSBpZih0eXBlcy5hPT09dHlwZXMuYilyZXN1bHQ9MDtlbHNlIGlmKHR5cGVzLmE9PT0iYm9vbGVhbiIpcmVzdWx0PS0xO2Vsc2UgcmVzdWx0PTF9cmV0dXJuIHJlc3VsdH0sc29ydGVkOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai5zb3J0KGFycmF5LnNvcnQpfSxzcGxpdDpmdW5jdGlvbihvYmosCmRpdmlzb3Ipe3ZhciByZXN1bHQ9W10sdG90YWw9b2JqLmxlbmd0aCxudGg9TWF0aC5jZWlsKHRvdGFsL2Rpdmlzb3IpLGxvdz1NYXRoLmZsb29yKHRvdGFsL2Rpdmlzb3IpLGxvd2VyPU1hdGguY2VpbCh0b3RhbC9udGgpLGxvd2VyZWQ9ZmFsc2Usc3RhcnQ9MCxpPS0xO2lmKG51bWJlci5kaWZmKHRvdGFsLGRpdmlzb3IqbnRoKT5udGgpbG93ZXI9dG90YWwtbG93KmRpdmlzb3IrbG93LTE7ZWxzZSBpZih0b3RhbCVkaXZpc29yPjAmJmxvd2VyKm50aD49dG90YWwpbG93ZXItLTt3aGlsZSgrK2k8ZGl2aXNvcil7aWYoaT4wKXN0YXJ0PXN0YXJ0K250aDtpZighbG93ZXJlZCYmbG93ZXI8ZGl2aXNvciYmaT09PWxvd2VyKXstLW50aDtsb3dlcmVkPXRydWV9cmVzdWx0LnB1c2goYXJyYXkubGltaXQob2JqLHN0YXJ0LG50aCkpfXJldHVybiByZXN1bHR9LHN0ZGRldjpmdW5jdGlvbihvYmope3JldHVybiBNYXRoLnNxcnQoYXJyYXkudmFyaWFuY2Uob2JqKSl9LHN1bTpmdW5jdGlvbihvYmope3ZhciByZXN1bHQ9CjA7aWYob2JqLmxlbmd0aD4wKXJlc3VsdD1vYmoucmVkdWNlKGZ1bmN0aW9uKHByZXYsY3VyKXtyZXR1cm4gcHJlditjdXJ9KTtyZXR1cm4gcmVzdWx0fSx0YWtlOmZ1bmN0aW9uKG9iaixuKXtyZXR1cm4gYXJyYXkubGltaXQob2JqLDAsbil9LHRvT2JqZWN0OmZ1bmN0aW9uKGFyKXt2YXIgb2JqPXt9LGk9YXIubGVuZ3RoO3doaWxlKGktLSlvYmpbaS50b1N0cmluZygpXT1hcltpXTtyZXR1cm4gb2JqfSx0b3RhbDpmdW5jdGlvbihvYmope3JldHVybiBhcnJheS5pbmRleGVkKG9iaikubGVuZ3RofSx1bmlxdWU6ZnVuY3Rpb24ob2JqKXt2YXIgcmVzdWx0PVtdO2FycmF5LmVhY2gob2JqLGZ1bmN0aW9uKGkpe2FycmF5LmFkZChyZXN1bHQsaSl9KTtyZXR1cm4gcmVzdWx0fSx2YXJpYW5jZTpmdW5jdGlvbihvYmope3ZhciBudGg9b2JqLmxlbmd0aCxuPTAsbWVhbjtpZihudGg+MCl7bWVhbj1hcnJheS5tZWFuKG9iaik7YXJyYXkuZWFjaChvYmosZnVuY3Rpb24oaSl7bis9bWF0aC5zcXIoaS0KbWVhbil9KTtyZXR1cm4gbi9udGh9ZWxzZSByZXR1cm4gbn0semlwOmZ1bmN0aW9uKG9iaixhcmdzKXt2YXIgcmVzdWx0PVtdO2lmKCEoYXJncyBpbnN0YW5jZW9mIEFycmF5KSlhcmdzPXR5cGVvZiBhcmdzPT0ib2JqZWN0Ij9hcnJheS5jYXN0KGFyZ3MpOlthcmdzXTthcnJheS5lYWNoKGFyZ3MsZnVuY3Rpb24oaSxpZHgpe2lmKCEoaSBpbnN0YW5jZW9mIEFycmF5KSl0aGlzW2lkeF09W2ldfSk7YXJyYXkuZWFjaChvYmosZnVuY3Rpb24oaSxpZHgpe3Jlc3VsdFtpZHhdPVtpXTthcnJheS5lYWNoKGFyZ3MsZnVuY3Rpb24oeCl7cmVzdWx0W2lkeF0ucHVzaCh4W2lkeF18fG51bGwpfSl9KTtyZXR1cm4gcmVzdWx0fX07dmFyIGNhY2hlPXtscnU6bHJ1LmZhY3RvcnkoQ0FDSEUpLGNsZWFuOmZ1bmN0aW9uKCl7YXJyYXkuZWFjaChhcnJheS5rZXlzKGNhY2hlLmxydS5jYWNoZSksZnVuY3Rpb24oaSl7aWYoY2FjaGUuZXhwaXJlZChpKSljYWNoZS5leHBpcmUoaSl9KX0sZXhwaXJlOmZ1bmN0aW9uKHVyaSl7aWYoY2FjaGUubHJ1LmNhY2hlW3VyaV0pe2NhY2hlLmxydS5yZW1vdmUodXJpKTsKcmV0dXJuIHRydWV9ZWxzZSByZXR1cm4gZmFsc2V9LGV4cGlyZWQ6ZnVuY3Rpb24odXJpKXt2YXIgaXRlbT1jYWNoZS5scnUuY2FjaGVbdXJpXTtyZXR1cm4gaXRlbSYmaXRlbS52YWx1ZS5leHBpcmVzPChuZXcgRGF0ZSkuZ2V0VGltZSgpfSxnZXQ6ZnVuY3Rpb24odXJpLGV4cGlyZSl7dXJpPXV0aWxpdHkucGFyc2UodXJpKS5ocmVmO3ZhciBpdGVtPWNhY2hlLmxydS5nZXQodXJpKTtpZighaXRlbSlyZXR1cm4gZmFsc2U7aWYoZXhwaXJlIT09ZmFsc2UmJmNhY2hlLmV4cGlyZWQodXJpKSl7Y2FjaGUuZXhwaXJlKHVyaSk7cmV0dXJuIGZhbHNlfXJldHVybiB1dGlsaXR5LmNsb25lKGl0ZW0sdHJ1ZSl9LHNldDpmdW5jdGlvbih1cmkscHJvcGVydHksdmFsdWUpe3VyaT11dGlsaXR5LnBhcnNlKHVyaSkuaHJlZjt2YXIgaXRlbT1jYWNoZS5scnUuZ2V0KHVyaSk7aWYoIWl0ZW0paXRlbT17cGVybWlzc2lvbjowfTtpZihwcm9wZXJ0eT09PSJwZXJtaXNzaW9uIilpdGVtLnBlcm1pc3Npb258PQp2YWx1ZTtlbHNlIGlmKHByb3BlcnR5PT09IiFwZXJtaXNzaW9uIilpdGVtLnBlcm1pc3Npb24mPX52YWx1ZTtlbHNlIGl0ZW1bcHJvcGVydHldPXZhbHVlO2NhY2hlLmxydS5zZXQodXJpLGl0ZW0pO3JldHVybiBpdGVtfX07ZnVuY3Rpb24gS1hNTEh0dHBSZXF1ZXN0KHhocil7dGhpcy5vYnNlcnZlcj1vYnNlcnZhYmxlLmZhY3RvcnkoKTt0aGlzLmRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKTt0aGlzLnhocj14aHJ9S1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZT1iYXNlLmZhY3RvcnkoKTtLWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPUtYTUxIdHRwUmVxdWVzdDt2YXIgY2xpZW50PXtpZTpmdW5jdGlvbigpe3JldHVybiFzZXJ2ZXImJnJlZ2V4LmllLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCl9KCksdmVyc2lvbjpmdW5jdGlvbigpe3ZhciB2ZXJzaW9uPTA7aWYodGhpcy5pZSl7dmVyc2lvbj1uYXZpZ2F0b3IudXNlckFnZW50LnJlcGxhY2UoLyguKm1zaWV8Oy4qKS9naSwKIiIpO3ZlcnNpb249bnVtYmVyLnBhcnNlKHN0cmluZy50cmltKHZlcnNpb24pKX1yZXR1cm4gdmVyc2lvbn0sYWxsb3dzOmZ1bmN0aW9uKHVyaSx2ZXJiKXtpZihzdHJpbmcuaXNFbXB0eSh1cmkpfHxzdHJpbmcuaXNFbXB0eSh2ZXJiKSl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7dXJpPXV0aWxpdHkucGFyc2UodXJpKS5ocmVmO3ZlcmI9dmVyYi50b0xvd2VyQ2FzZSgpO3ZhciByZXN1bHQ9ZmFsc2UsYml0PTA7aWYoIWNhY2hlLmdldCh1cmksZmFsc2UpKXJlc3VsdD11bmRlZmluZWQ7ZWxzZXtpZihyZWdleC5kZWwudGVzdCh2ZXJiKSliaXQ9MTtlbHNlIGlmKHJlZ2V4LmdldF9oZWFkZXJzLnRlc3QodmVyYikpYml0PTQ7ZWxzZSBpZihyZWdleC5wdXRfcG9zdC50ZXN0KHZlcmIpKWJpdD0yO2Vsc2UgaWYocmVnZXgucGF0Y2gudGVzdCh2ZXJiKSliaXQ9ODtyZXN1bHQ9Qm9vbGVhbihjbGllbnQucGVybWlzc2lvbnModXJpLHZlcmIpLmJpdCZiaXQpfXJldHVybiByZXN1bHR9LApiaXQ6ZnVuY3Rpb24oYXJncyl7dmFyIHJlc3VsdD0wO2FycmF5LmVhY2goYXJncyxmdW5jdGlvbih2ZXJiKXt2ZXJiPXZlcmIudG9Mb3dlckNhc2UoKTtpZihyZWdleC5nZXRfaGVhZGVycy50ZXN0KHZlcmIpKXJlc3VsdHw9NDtlbHNlIGlmKHJlZ2V4LnB1dF9wb3N0LnRlc3QodmVyYikpcmVzdWx0fD0yO2Vsc2UgaWYocmVnZXgucGF0Y2gudGVzdCh2ZXJiKSlyZXN1bHR8PTg7ZWxzZSBpZihyZWdleC5kZWwudGVzdCh2ZXJiKSlyZXN1bHR8PTF9KTtyZXR1cm4gcmVzdWx0fSxjb3JzOmZ1bmN0aW9uKHVyaSl7cmV0dXJuIXNlcnZlciYmdXJpLmluZGV4T2YoIi8vIik+LTEmJnVyaS5pbmRleE9mKCIvLyIrbG9jYXRpb24uaG9zdCk9PT0tMX0saGVhZGVyczpmdW5jdGlvbih4aHIsdXJpLHR5cGUpe3ZhciBoZWFkZXJzPXN0cmluZy50cmltKHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkuc3BsaXQoIlxuIiksaXRlbXM9e30sbz17fSxhbGxvdz1udWxsLGV4cGlyZXM9bmV3IERhdGUsCmNvcnM9Y2xpZW50LmNvcnModXJpKTthcnJheS5lYWNoKGhlYWRlcnMsZnVuY3Rpb24oaSl7dmFyIGhlYWRlcj1pLnNwbGl0KCI6ICIpO2l0ZW1zW2hlYWRlclswXS50b0xvd2VyQ2FzZSgpXT1zdHJpbmcudHJpbShoZWFkZXJbMV0pO2lmKGFsbG93PT09bnVsbClpZighY29ycyYmcmVnZXguYWxsb3cudGVzdChoZWFkZXIpfHxjb3JzJiZyZWdleC5hbGxvd19jb3JzLnRlc3QoaGVhZGVyKSlhbGxvdz1oZWFkZXJbMV19KTtpZihyZWdleC5uby50ZXN0KGl0ZW1zWyJjYWNoZS1jb250cm9sIl0pKWV4cGlyZXM9ZXhwaXJlcy5nZXRUaW1lKCk7ZWxzZSBpZihpdGVtc1siY2FjaGUtY29udHJvbCJdJiZyZWdleC5udW1iZXJfcHJlc2VudC50ZXN0KGl0ZW1zWyJjYWNoZS1jb250cm9sIl0pKWV4cGlyZXM9ZXhwaXJlcy5zZXRTZWNvbmRzKGV4cGlyZXMuZ2V0U2Vjb25kcygpK251bWJlci5wYXJzZShyZWdleC5udW1iZXJfcHJlc2VudC5leGVjKGl0ZW1zWyJjYWNoZS1jb250cm9sIl0pWzBdLAoxMCkpO2Vsc2UgaWYoaXRlbXMuZXhwaXJlcylleHBpcmVzPShuZXcgRGF0ZShpdGVtcy5leHBpcmVzKSkuZ2V0VGltZSgpO2Vsc2UgZXhwaXJlcz1leHBpcmVzLmdldFRpbWUoKTtvLmV4cGlyZXM9ZXhwaXJlcztvLmhlYWRlcnM9aXRlbXM7by50aW1lc3RhbXA9bmV3IERhdGU7by5wZXJtaXNzaW9uPWNsaWVudC5iaXQoYWxsb3chPT1udWxsP3N0cmluZy5leHBsb2RlKGFsbG93KTpbdHlwZV0pO2lmKHR5cGU9PT0iZ2V0Iil7Y2FjaGUuc2V0KHVyaSwiZXhwaXJlcyIsby5leHBpcmVzKTtjYWNoZS5zZXQodXJpLCJoZWFkZXJzIixvLmhlYWRlcnMpO2NhY2hlLnNldCh1cmksInRpbWVzdGFtcCIsby50aW1lc3RhbXApO2NhY2hlLnNldCh1cmksInBlcm1pc3Npb24iLG8ucGVybWlzc2lvbil9cmV0dXJuIG99LHBhcnNlOmZ1bmN0aW9uKHhocix0eXBlKXt0eXBlPXR5cGV8fCIiO3ZhciByZXN1bHQsb2JqO2lmKChyZWdleC5qc29uX21heWJlLnRlc3QodHlwZSl8fHN0cmluZy5pc0VtcHR5KHR5cGUpKSYmCihyZWdleC5qc29uX3dyYXAudGVzdCh4aHIucmVzcG9uc2VUZXh0KSYmQm9vbGVhbihvYmo9anNvbi5kZWNvZGUoeGhyLnJlc3BvbnNlVGV4dCx0cnVlKSkpKXJlc3VsdD1vYmo7ZWxzZSBpZih0eXBlPT09InRleHQvY3N2IilyZXN1bHQ9Y3N2LmRlY29kZSh4aHIucmVzcG9uc2VUZXh0KTtlbHNlIGlmKHR5cGU9PT0idGV4dC90c3YiKXJlc3VsdD1jc3YuZGVjb2RlKHhoci5yZXNwb25zZVRleHQsIlx0Iik7ZWxzZSBpZihyZWdleC54bWwudGVzdCh0eXBlKSl7aWYodHlwZSE9PSJ0ZXh0L3htbCIpeGhyLm92ZXJyaWRlTWltZVR5cGUoInRleHQveG1sIik7cmVzdWx0PXhoci5yZXNwb25zZVhNTH1lbHNlIGlmKHR5cGU9PT0idGV4dC9wbGFpbiImJnJlZ2V4LmlzX3htbC50ZXN0KHhoci5yZXNwb25zZVRleHQpJiZ4bWwudmFsaWQoeGhyLnJlc3BvbnNlVGV4dCkpcmVzdWx0PXhtbC5kZWNvZGUoeGhyLnJlc3BvbnNlVGV4dCk7ZWxzZSByZXN1bHQ9eGhyLnJlc3BvbnNlVGV4dDtyZXR1cm4gcmVzdWx0fSwKcGVybWlzc2lvbnM6ZnVuY3Rpb24odXJpKXt2YXIgY2FjaGVkPWNhY2hlLmdldCh1cmksZmFsc2UpLGJpdD0hY2FjaGVkPzA6Y2FjaGVkLnBlcm1pc3Npb24scmVzdWx0PXthbGxvd3M6W10sYml0OmJpdCxtYXA6e3BhcnRpYWw6OCxyZWFkOjQsd3JpdGU6MiwiZGVsZXRlIjoxLHVua25vd246MH19O2lmKGJpdCYxKXJlc3VsdC5hbGxvd3MucHVzaCgiREVMRVRFIik7aWYoYml0JjIpe3Jlc3VsdC5hbGxvd3MucHVzaCgiUE9TVCIpO3Jlc3VsdC5hbGxvd3MucHVzaCgiUFVUIil9aWYoYml0JjQpcmVzdWx0LmFsbG93cy5wdXNoKCJHRVQiKTtpZihiaXQmOClyZXN1bHQuYWxsb3dzLnB1c2goIlBBVENIIik7cmV0dXJuIHJlc3VsdH0sanNvbnA6ZnVuY3Rpb24odXJpLGFyZ3Mpe3ZhciBkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCksY2FsbGJhY2s9ImNhbGxiYWNrIixjYmlkLHM7aWYoZXh0ZXJuYWw9PT11bmRlZmluZWQpe2lmKCFnbG9iYWwua2VpZ2FpKWdsb2JhbC5rZWlnYWk9e2NhbGxiYWNrOnt9fTsKZXh0ZXJuYWw9ImtlaWdhaSJ9aWYoYXJncyBpbnN0YW5jZW9mIE9iamVjdCYmIWFyZ3MuY2FsbGJhY2spY2FsbGJhY2s9YXJncy5jYWxsYmFjaztkbyBjYmlkPXV0aWxpdHkuZ2VuSWQoKS5zbGljZSgwLDEwKTt3aGlsZShnbG9iYWwuY2FsbGJhY2tbY2JpZF0pO3VyaT11cmkucmVwbGFjZShjYWxsYmFjaysiPT8iLGNhbGxiYWNrKyI9IitleHRlcm5hbCsiLmNhbGxiYWNrLiIrY2JpZCk7Z2xvYmFsLmNhbGxiYWNrW2NiaWRdPWZ1bmN0aW9uKGFyZyl7dXRpbGl0eS5jbGVhclRpbWVycyhjYmlkKTtkZWxldGUgZ2xvYmFsLmNhbGxiYWNrW2NiaWRdO2RlZmVyLnJlc29sdmUoYXJnKTtlbGVtZW50LmRlc3Ryb3kocyl9O3M9ZWxlbWVudC5jcmVhdGUoInNjcmlwdCIse3NyYzp1cmksdHlwZToidGV4dC9qYXZhc2NyaXB0In0sdXRpbGl0eS5kb20oImhlYWQiKVswXSk7dXRpbGl0eS5kZWZlcihmdW5jdGlvbigpe2RlZmVyLnJlamVjdCh1bmRlZmluZWQpfSwzRTQsY2JpZCk7cmV0dXJuIGRlZmVyfSwKa3hocjpmdW5jdGlvbih4aHIpe3ZhciBvYmo9bmV3IEtYTUxIdHRwUmVxdWVzdCh4aHIpO2FycmF5LmVhY2goYXJyYXkua2V5cyhEZWZlcnJlZC5wcm90b3R5cGUpLGZ1bmN0aW9uKGkpe29ialtpXT1mdW5jdGlvbigpe3JldHVybiBvYmouZGVmZXJbaV0uYXBwbHkob2JqLmRlZmVyLGFycmF5LmNhc3QoYXJndW1lbnRzKSl9fSk7YXJyYXkuZWFjaChFVkVOVFMsZnVuY3Rpb24oaSl7b2JqLmhvb2sob2JqLnhocixpKX0pO3JldHVybiBvYmp9LHJlcXVlc3Q6ZnVuY3Rpb24odXJpLHR5cGUsYXJncyxoZWFkZXJzKXt2YXIgY29ycyxreGhyLHBheWxvYWQsY2FjaGVkLGNvbnRlbnRUeXBlLGRvYyxhYixibG9iO3R5cGU9dHlwZXx8IkdFVCI7aWYoKHJlZ2V4LnB1dF9wb3N0LnRlc3QodHlwZSl8fHJlZ2V4LnBhdGNoLnRlc3QodHlwZSkpJiZhcmdzPT09dW5kZWZpbmVkKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTt1cmk9dXRpbGl0eS5wYXJzZSh1cmkpLmhyZWY7CnR5cGU9dHlwZS50b0xvd2VyQ2FzZSgpO2hlYWRlcnM9aGVhZGVycyBpbnN0YW5jZW9mIE9iamVjdD9oZWFkZXJzOm51bGw7Y29ycz1jbGllbnQuY29ycyh1cmkpO2t4aHI9Y2xpZW50Lmt4aHIoIWNsaWVudC5pZXx8KCFjb3JzfHxjbGllbnQudmVyc2lvbj45KT9uZXcgWE1MSHR0cFJlcXVlc3Q6bmV3IFhEb21haW5SZXF1ZXN0KTtwYXlsb2FkPShyZWdleC5wdXRfcG9zdC50ZXN0KHR5cGUpfHxyZWdleC5wYXRjaC50ZXN0KHR5cGUpKSYmYXJncz9hcmdzOm51bGw7Y2FjaGVkPXR5cGU9PT0iZ2V0Ij9jYWNoZS5nZXQodXJpKTpmYWxzZTtjb250ZW50VHlwZT1udWxsO2RvYz10eXBlb2YgRG9jdW1lbnQhPSJ1bmRlZmluZWQiO2FiPXR5cGVvZiBBcnJheUJ1ZmZlciE9InVuZGVmaW5lZCI7YmxvYj10eXBlb2YgQmxvYiE9InVuZGVmaW5lZCI7aWYoY29ycyYmY2xpZW50LmllJiZjbGllbnQudmVyc2lvbj09PTkmJiFyZWdleC54ZG9tYWlucmVxdWVzdC50ZXN0KHR5cGUpKXRocm93IG5ldyBFcnJvcihsYWJlbC5ub3RBdmFpbGFibGUpOwpreGhyLm9uKCJyZWFkeXN0YXRlY2hhbmdlIixmdW5jdGlvbihldil7c3dpdGNoKHRoaXMueGhyLnJlYWR5U3RhdGUpe2Nhc2UgMTp0aGlzLmRpc3BhdGNoKCJiZWZvcmVYSFIiLHRoaXMueGhyLGV2KTticmVhaztjYXNlIDQ6dGhpcy5kaXNwYXRjaCgiYWZ0ZXJYSFIiLHRoaXMueGhyLGV2KTticmVha319KTtpZighY29ycyYmIXJlZ2V4LmdldF9oZWFkZXJzLnRlc3QodHlwZSkmJmNsaWVudC5hbGxvd3ModXJpLHR5cGUpPT09ZmFsc2Upe3V0aWxpdHkuZGVsYXkoZnVuY3Rpb24oKXtreGhyLmRpc3BhdGNoKCJiZWZvcmVYSFIiLGt4aHIueGhyLG51bGwpO2t4aHIuZGlzcGF0Y2goImFmdGVyWEhSIixreGhyLnhocixudWxsKX0pO2t4aHIueGhyLnN0YXR1cz00MDU7a3hoci5yZWplY3QobnVsbCl9aWYodHlwZT09PSJnZXQiJiZCb29sZWFuKGNhY2hlZCkpe2lmKHNlcnZlcil7a3hoci54aHIucmVhZHlTdGF0ZT00O2t4aHIueGhyLnN0YXR1cz0yMDA7a3hoci54aHIuX3Jlc2hlYWRlcnM9CmNhY2hlZC5oZWFkZXJzfXV0aWxpdHkuZGVsYXkoZnVuY3Rpb24oKXtreGhyLmRpc3BhdGNoKCJiZWZvcmVYSFIiLGt4aHIueGhyLG51bGwpO2t4aHIuZGlzcGF0Y2goImFmdGVyWEhSIixreGhyLnhocixudWxsKX0pO2t4aHIucmVzb2x2ZShjYWNoZWQucmVzcG9uc2UpfWVsc2UgdXRpbGl0eS5kZWxheShmdW5jdGlvbigpe2t4aHIueGhyLm9wZW4odHlwZS50b1VwcGVyQ2FzZSgpLHVyaSx0cnVlKTtpZihoZWFkZXJzIT09bnVsbCYmaGVhZGVycy5oYXNPd25Qcm9wZXJ0eSgiY29udGVudC10eXBlIikpY29udGVudFR5cGU9aGVhZGVyc1siY29udGVudC10eXBlIl07aWYoY29ycyYmY29udGVudFR5cGU9PT1udWxsKWNvbnRlbnRUeXBlPSJ0ZXh0L3BsYWluIjtpZihwYXlsb2FkIT09bnVsbCl7aWYocGF5bG9hZC5oYXNPd25Qcm9wZXJ0eSgieG1sIikpcGF5bG9hZD1wYXlsb2FkLnhtbDtpZihkb2MmJnBheWxvYWQgaW5zdGFuY2VvZiBEb2N1bWVudClwYXlsb2FkPXhtbC5kZWNvZGUocGF5bG9hZCk7CmlmKHR5cGVvZiBwYXlsb2FkPT0ic3RyaW5nIiYmcmVnZXguaXNfeG1sLnRlc3QocGF5bG9hZCkpY29udGVudFR5cGU9ImFwcGxpY2F0aW9uL3htbCI7aWYoIShhYiYmcGF5bG9hZCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSYmIShibG9iJiZwYXlsb2FkIGluc3RhbmNlb2YgQmxvYikmJiEocGF5bG9hZCBpbnN0YW5jZW9mIEJ1ZmZlcikmJnBheWxvYWQgaW5zdGFuY2VvZiBPYmplY3Qpe2NvbnRlbnRUeXBlPSJhcHBsaWNhdGlvbi9qc29uIjtwYXlsb2FkPWpzb24uZW5jb2RlKHBheWxvYWQpfWlmKGNvbnRlbnRUeXBlPT09bnVsbCYmKGFiJiZwYXlsb2FkIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fGJsb2ImJnBheWxvYWQgaW5zdGFuY2VvZiBCbG9iKSljb250ZW50VHlwZT0iYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtIjtpZihjb250ZW50VHlwZT09PW51bGwpY29udGVudFR5cGU9ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCJ9aWYoIWNsaWVudC5pZXx8CighY29yc3x8Y2xpZW50LnZlcnNpb24+OSkpe2lmKGhlYWRlcnM9PT1udWxsKWhlYWRlcnM9e307aWYodHlwZW9mIGNhY2hlZD09Im9iamVjdCImJmNhY2hlZC5oZWFkZXJzLmhhc093blByb3BlcnR5KCJldGFnIikpaGVhZGVycy5ldGFnPWNhY2hlZC5oZWFkZXJzLmV0YWc7aWYoY29udGVudFR5cGUhPT1udWxsKWhlYWRlcnNbImNvbnRlbnQtdHlwZSJdPWNvbnRlbnRUeXBlO2lmKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoImNhbGxiYWNrIikpZGVsZXRlIGhlYWRlcnMuY2FsbGJhY2s7aGVhZGVyc1sieC1yZXF1ZXN0ZWQtd2l0aCJdPSJYTUxIdHRwUmVxdWVzdCI7dXRpbGl0eS5pdGVyYXRlKGhlYWRlcnMsZnVuY3Rpb24odixrKXtpZih2IT09bnVsbCYmayE9PSJ3aXRoQ3JlZGVudGlhbHMiKWt4aHIueGhyLnNldFJlcXVlc3RIZWFkZXIoayx2KX0pO2lmKHR5cGVvZiBreGhyLnhoci53aXRoQ3JlZGVudGlhbHM9PSJib29sZWFuIiYmaGVhZGVycyE9PW51bGwmJnR5cGVvZiBoZWFkZXJzLndpdGhDcmVkZW50aWFscz09CiJib29sZWFuIilreGhyLnhoci53aXRoQ3JlZGVudGlhbHM9aGVhZGVycy53aXRoQ3JlZGVudGlhbHN9a3hoci5vbigibG9hZCIsZnVuY3Rpb24oKXt2YXIgc2VsZj10aGlzLHhkcj1jbGllbnQuaWUmJnRoaXMueGhyLnJlYWR5U3RhdGU9PT11bmRlZmluZWQsc2hhcmVkPXRydWUsbyxyLHQscmVkaXJlY3Q7aWYoIXhkciYmdGhpcy54aHIucmVhZHlTdGF0ZT09PTQpc3dpdGNoKHRoaXMueGhyLnN0YXR1cyl7Y2FzZSAyMDA6Y2FzZSAyMDE6Y2FzZSAyMDI6Y2FzZSAyMDM6Y2FzZSAyMDQ6Y2FzZSAyMDU6Y2FzZSAyMDY6bz1jbGllbnQuaGVhZGVycyh0aGlzLnhocix1cmksdHlwZSk7aWYodHlwZT09PSJoZWFkIilyZXR1cm4gdGhpcy5yZXNvbHZlKG8uaGVhZGVycyk7ZWxzZSBpZih0eXBlPT09Im9wdGlvbnMiKXJldHVybiB0aGlzLnJlc29sdmUoby5oZWFkZXJzKTtlbHNlIGlmKHR5cGUhPT0iZGVsZXRlIil7aWYoc2VydmVyJiZyZWdleC5wcml2LnRlc3Qoby5oZWFkZXJzWyJjYWNoZS1jb250cm9sIl0pKXNoYXJlZD0KZmFsc2U7aWYocmVnZXguaHR0cF9ib2R5LnRlc3QodGhpcy54aHIuc3RhdHVzKSl7dD1vLmhlYWRlcnNbImNvbnRlbnQtdHlwZSJdfHwiIjtyPWNsaWVudC5wYXJzZSh0aGlzLnhocix0KTtpZihyPT09dW5kZWZpbmVkKXRoaXMucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5zZXJ2ZXJFcnJvcikpfWlmKHR5cGU9PT0iZ2V0IiYmc2hhcmVkKWNhY2hlLnNldCh1cmksInJlc3BvbnNlIixvLnJlc3BvbnNlPXV0aWxpdHkuY2xvbmUocix0cnVlKSk7ZWxzZSBjYWNoZS5leHBpcmUodXJpLHRydWUpfWVsc2UgaWYodHlwZT09PSJkZWxldGUiKWNhY2hlLmV4cGlyZSh1cmksdHJ1ZSk7c3dpdGNoKHRoaXMueGhyLnN0YXR1cyl7Y2FzZSAyMDA6Y2FzZSAyMDI6Y2FzZSAyMDM6Y2FzZSAyMDY6dGhpcy5yZXNvbHZlKHIpO2JyZWFrO2Nhc2UgMjAxOmlmKChvLmhlYWRlcnMubG9jYXRpb249PT11bmRlZmluZWR8fHN0cmluZy5pc0VtcHR5KG8uaGVhZGVycy5sb2NhdGlvbikpJiYhc3RyaW5nLmlzVXJsKHIpKXRoaXMucmVzb2x2ZShyKTsKZWxzZXtyZWRpcmVjdD1zdHJpbmcudHJpbShvLmhlYWRlcnMuTG9jYXRpb258fHIpO2NsaWVudC5yZXF1ZXN0KHJlZGlyZWN0KS50aGVuKGZ1bmN0aW9uKGFyZyl7c2VsZi5yZXNvbHZlKGFyZyl9LGZ1bmN0aW9uKGUpe3NlbGYucmVqZWN0KGUpfSl9YnJlYWs7Y2FzZSAyMDQ6Y2FzZSAyMDU6dGhpcy5yZXNvbHZlKG51bGwpO2JyZWFrfWJyZWFrO2Nhc2UgMzA0OnRoaXMucmVzb2x2ZShyKTticmVhaztjYXNlIDQwMTp0aGlzLnJlamVjdChuZXcgRXJyb3IodGhpcy54aHIucmVzcG9uc2VUZXh0fHxsYWJlbC5zZXJ2ZXJVbmF1dGhvcml6ZWQpKTticmVhaztjYXNlIDQwMzpjYWNoZS5zZXQodXJpLCIhcGVybWlzc2lvbiIsY2xpZW50LmJpdChbdHlwZV0pKTt0aGlzLnJlamVjdChuZXcgRXJyb3IodGhpcy54aHIucmVzcG9uc2VUZXh0fHxsYWJlbC5zZXJ2ZXJGb3JiaWRkZW4pKTticmVhaztjYXNlIDQwNTpjYWNoZS5zZXQodXJpLCIhcGVybWlzc2lvbiIsY2xpZW50LmJpdChbdHlwZV0pKTsKdGhpcy5yZWplY3QobmV3IEVycm9yKHRoaXMueGhyLnJlc3BvbnNlVGV4dHx8bGFiZWwuc2VydmVySW52YWxpZE1ldGhvZCkpO2JyZWFrO2RlZmF1bHQ6dGhpcy5yZWplY3QobmV3IEVycm9yKHRoaXMueGhyLnJlc3BvbnNlVGV4dHx8bGFiZWwuc2VydmVyRXJyb3IpKX1lbHNlIGlmKHhkcil7cj1jbGllbnQucGFyc2UodGhpcy54aHIsInRleHQvcGxhaW4iKTtjYWNoZS5zZXQodXJpLCJwZXJtaXNzaW9uIixjbGllbnQuYml0KFsiZ2V0Il0pKTtjYWNoZS5zZXQodXJpLCJyZXNwb25zZSIscik7dGhpcy5yZXNvbHZlKHIpfX0pO2t4aHIub24oImVycm9yIixmdW5jdGlvbihlKXt0aGlzLnJlamVjdChlKX0pO2t4aHIueGhyLnNlbmQocGF5bG9hZCE9PW51bGw/cGF5bG9hZDp1bmRlZmluZWQpfSk7cmV0dXJuIGt4aHJ9LHNjcm9sbDpmdW5jdGlvbihkZXN0LG1zKXt2YXIgZGVmZXI9ZGVmZXJyZWQoKSxzdGFydD1jbGllbnQuc2Nyb2xsUG9zKCksdD0wO21zPSghaXNOYU4obXMpP21zOjI1MCkvCjEwMDt1dGlsaXR5LnJlcGVhdChmdW5jdGlvbigpe3ZhciBwb3M9bWF0aC5iZXppZXIoc3RhcnRbMF0sc3RhcnRbMV0sZGVzdFswXSxkZXN0WzFdLCsrdC8xMDApO3dpbmRvdy5zY3JvbGxUbyhwb3NbMF0scG9zWzFdKTtpZih0PT09MTAwKXtkZWZlci5yZXNvbHZlKHRydWUpO3JldHVybiBmYWxzZX19LG1zLCJzY3JvbGxpbmciKTtyZXR1cm4gZGVmZXJ9LHNjcm9sbFBvczpmdW5jdGlvbigpe3JldHVyblt3aW5kb3cuc2Nyb2xsWHx8MCx3aW5kb3cuc2Nyb2xsWXx8MF19fTt2YXIgY3N2PXtkZWNvZGU6ZnVuY3Rpb24oYXJnLGRlbGltaXRlcil7ZGVsaW1pdGVyPWRlbGltaXRlcnx8IiwiO3ZhciByZWdleD1uZXcgUmVnRXhwKGRlbGltaXRlcisnKD89KD86W14iXXwiKD86W14iXSlbXiJdKiIpKiQpJykscm93cz1zdHJpbmcudHJpbShhcmcpLnNwbGl0KCJcbiIpLGtleXM9cm93cy5zaGlmdCgpLnNwbGl0KGRlbGltaXRlcikscmVzdWx0PVtdLG50aD1yb3dzLmxlbmd0aCx4PWtleXMubGVuZ3RoLAppPS0xLG4sb2JqLHJvdzt3aGlsZSgrK2k8bnRoKXtvYmo9e307cm93PXJvd3NbaV0uc3BsaXQocmVnZXgpO249LTE7d2hpbGUoKytuPHgpb2JqW2tleXNbbl1dPXV0aWxpdHkuY29lcmNlKChyb3dbbl18fCIiKS5yZXBsYWNlKC9eInwiJC9nLCIiKSk7cmVzdWx0LnB1c2gob2JqKX1yZXR1cm4gcmVzdWx0fSxlbmNvZGU6ZnVuY3Rpb24oYXJnLGRlbGltaXRlcixoZWFkZXIpe3ZhciBvYmo9anNvbi5kZWNvZGUoYXJnLHRydWUpfHxhcmcscmVzdWx0PSIiO2RlbGltaXRlcj1kZWxpbWl0ZXJ8fCIsIjtoZWFkZXI9aGVhZGVyIT09ZmFsc2U7ZnVuY3Rpb24gcHJlcGFyZShpbnB1dCl7dmFyIG91dHB1dDtpZihpbnB1dCBpbnN0YW5jZW9mIEFycmF5KXtvdXRwdXQ9JyInK2lucHV0LnRvU3RyaW5nKCkrJyInO2lmKHJlZ2V4Lm9iamVjdF90eXBlLnRlc3Qob3V0cHV0KSlvdXRwdXQ9JyInK2Nzdi5lbmNvZGUoaW5wdXQsZGVsaW1pdGVyKSsnIid9ZWxzZSBpZihpbnB1dCBpbnN0YW5jZW9mIE9iamVjdClvdXRwdXQ9CiciJytjc3YuZW5jb2RlKGlucHV0LGRlbGltaXRlcikrJyInO2Vsc2UgaWYocmVnZXguY3N2X3F1b3RlLnRlc3QoaW5wdXQpKW91dHB1dD0nIicraW5wdXQucmVwbGFjZSgvIi9nLCciIicpKyciJztlbHNlIG91dHB1dD1pbnB1dDtyZXR1cm4gb3V0cHV0fWlmKG9iaiBpbnN0YW5jZW9mIEFycmF5KWlmKG9ialswXWluc3RhbmNlb2YgT2JqZWN0KXtpZihoZWFkZXIpcmVzdWx0PWFycmF5LmtleXMob2JqWzBdKS5qb2luKGRlbGltaXRlcikrIlxuIjtyZXN1bHQrPW9iai5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGNzdi5lbmNvZGUoaSxkZWxpbWl0ZXIsZmFsc2UpfSkuam9pbigiXG4iKX1lbHNlIHJlc3VsdCs9cHJlcGFyZShvYmosZGVsaW1pdGVyKSsiXG4iO2Vsc2V7aWYoaGVhZGVyKXJlc3VsdD1hcnJheS5rZXlzKG9iaikuam9pbihkZWxpbWl0ZXIpKyJcbiI7cmVzdWx0Kz1hcnJheS5jYXN0KG9iaikubWFwKHByZXBhcmUpLmpvaW4oZGVsaW1pdGVyKSsiXG4ifXJldHVybiByZXN1bHQucmVwbGFjZShyZWdleC5lb2xfbmwsCiIiKX19O3ZhciBmaWx0ZXI9e2ZhY3Rvcnk6ZnVuY3Rpb24odGFyZ2V0LGxpc3QsZmlsdGVycyxkZWJvdW5jZSl7dmFyIHJlZj1bbGlzdF0sb2JqO2RlYm91bmNlPWRlYm91bmNlfHwyNTA7aWYoISh0YXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50KXx8bGlzdCYmIWxpc3Quc3RvcmV8fCh0eXBlb2YgZmlsdGVycyE9InN0cmluZyJ8fHN0cmluZy5pc0VtcHR5KGZpbHRlcnMpKSl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7b2JqPShuZXcgRGF0YUxpc3RGaWx0ZXIodGFyZ2V0LHJlZlswXSxkZWJvdW5jZSkpLnNldChmaWx0ZXJzKTtlbGVtZW50LmF0dHIodGFyZ2V0LCJ0eXBlIiwidGV4dCIpO29iai5vYnNlcnZlci5ob29rKG9iai5lbGVtZW50LCJrZXl1cCIpO29iai5vYnNlcnZlci5ob29rKG9iai5lbGVtZW50LCJpbnB1dCIpO29iai5vbigia2V5dXAiLG9iai51cGRhdGUsImtleXVwIik7b2JqLm9uKCJpbnB1dCIsb2JqLnVwZGF0ZSwiaW5wdXQiKTtyZXR1cm4gb2JqfX07CmZ1bmN0aW9uIERhdGFMaXN0RmlsdGVyKGVsZW1lbnQsbGlzdCxkZWJvdW5jZSl7dGhpcy5kZWJvdW5jZT1kZWJvdW5jZTt0aGlzLmVsZW1lbnQ9ZWxlbWVudDt0aGlzLmZpbHRlcnM9e307dGhpcy5saXN0PWxpc3Q7dGhpcy5vYnNlcnZlcj1vYnNlcnZhYmxlLmZhY3RvcnkoKX1EYXRhTGlzdEZpbHRlci5wcm90b3R5cGU9YmFzZS5mYWN0b3J5KCk7RGF0YUxpc3RGaWx0ZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yPURhdGFMaXN0RmlsdGVyO0RhdGFMaXN0RmlsdGVyLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oZmllbGRzKXt2YXIgb2JqPXt9O2FycmF5LmVhY2goc3RyaW5nLmV4cGxvZGUoZmllbGRzKSxmdW5jdGlvbih2KXtvYmpbdl09IiJ9KTt0aGlzLmZpbHRlcnM9b2JqO3JldHVybiB0aGlzfTtEYXRhTGlzdEZpbHRlci5wcm90b3R5cGUudGVhcmRvd249ZnVuY3Rpb24oKXt0aGlzLm9ic2VydmVyLnVuaG9vayh0aGlzLmVsZW1lbnQsImtleXVwIik7dGhpcy5vYnNlcnZlci51bmhvb2sodGhpcy5lbGVtZW50LAoiaW5wdXQiKTtyZXR1cm4gdGhpc307RGF0YUxpc3RGaWx0ZXIucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbigpe3ZhciBzZWxmPXRoaXM7dXRpbGl0eS5kZWZlcihmdW5jdGlvbigpe3ZhciB2YWw9ZWxlbWVudC52YWwoc2VsZi5lbGVtZW50KS50b1N0cmluZygpO3NlbGYubGlzdC5kaXNwYXRjaCgiYmVmb3JlRmlsdGVyIixzZWxmLmVsZW1lbnQsdmFsKTtpZighc3RyaW5nLmlzRW1wdHkodmFsKSl7dXRpbGl0eS5pdGVyYXRlKHNlbGYuZmlsdGVycyxmdW5jdGlvbih2LGspe3ZhciBxdWVyaWVzPXN0cmluZy5leHBsb2RlKHZhbCk7cXVlcmllcz1xdWVyaWVzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4hc3RyaW5nLmlzRW1wdHkoaSl9KTthcnJheS5lYWNoKHF1ZXJpZXMsZnVuY3Rpb24oaSxpZHgpe3RoaXNbaWR4XT0iXi4qIitzdHJpbmcuZXNjYXBlKGkpLnJlcGxhY2UoLyheXCp8XCokKS9nLCIiKS5yZXBsYWNlKC9cKi9nLCIuKiIpKyIuKiJ9KTt0aGlzW2tdPXF1ZXJpZXMuam9pbigiLCIpfSk7CnNlbGYubGlzdC5maWx0ZXI9c2VsZi5maWx0ZXJzfWVsc2Ugc2VsZi5saXN0LmZpbHRlcj1udWxsO3NlbGYubGlzdC5wYWdlSW5kZXg9MTtzZWxmLmxpc3QucmVmcmVzaCgpO3NlbGYubGlzdC5kaXNwYXRjaCgiYWZ0ZXJGaWx0ZXIiLHNlbGYuZWxlbWVudCl9LHRoaXMuZGVib3VuY2UsdGhpcy5lbGVtZW50LmlkKyJEZWJvdW5jZSIpO3JldHVybiB0aGlzfTt2YXIgZ3JpZD17ZmFjdG9yeTpmdW5jdGlvbih0YXJnZXQsc3RvcmUsZmllbGRzLHNvcnRhYmxlLG9wdGlvbnMsZmlsdGVyZWQsZGVib3VuY2Upe3ZhciByZWY9W3N0b3JlXSxvYmosdGVtcGxhdGUsaGVhZGVyLHdpZHRoLGNzcyxzb3J0O29iaj1uZXcgRGF0YUdyaWQodGFyZ2V0LHJlZlswXSxmaWVsZHMsc29ydGFibGUsb3B0aW9ucyxmaWx0ZXJlZCk7dGVtcGxhdGU9IiI7aGVhZGVyPWVsZW1lbnQuY3JlYXRlKCJsaSIse30sZWxlbWVudC5jcmVhdGUoInVsIix7ImNsYXNzIjoiaGVhZGVyIn0sb2JqLmVsZW1lbnQpKTt3aWR0aD0KMTAwL29iai5maWVsZHMubGVuZ3RoKyIlIjtjc3M9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3dpZHRoOiIrd2lkdGg7c29ydD1vYmoub3B0aW9ucy5vcmRlcj9zdHJpbmcuZXhwbG9kZShvYmoub3B0aW9ucy5vcmRlcik6W107YXJyYXkuZWFjaChvYmouZmllbGRzLGZ1bmN0aW9uKGkpe3ZhciB0cmltbWVkPWkucmVwbGFjZSgvLipcLi9nLCIiKSxlbD1lbGVtZW50LmNyZWF0ZSgic3BhbiIse2lubmVySFRNTDpzdHJpbmcuY2FwaXRhbGl6ZShzdHJpbmcudW5DYW1lbENhc2Uoc3RyaW5nLnVuaHlwaGVuYXRlKHRyaW1tZWQsdHJ1ZSkpLnJlcGxhY2UoL198LS9nLCIgIiksdHJ1ZSksc3R5bGU6Y3NzLCJkYXRhLWZpZWxkIjppfSxoZWFkZXIpO2lmKGFycmF5LmNvbnRhaW5zKG9iai5zb3J0YWJsZSxpKSl7ZWxlbWVudC5rbGFzcyhlbCwic29ydGFibGUiLHRydWUpO2lmKHNvcnQuZmlsdGVyKGZ1bmN0aW9uKHgpe3JldHVybiB4LmluZGV4T2YoaSk9PT0wfSkubGVuZ3RoPjApZWxlbWVudC5kYXRhKGVsLAoic29ydCIsYXJyYXkuY29udGFpbnMoc29ydCxpKyIgZGVzYyIpPyJkZXNjIjoiYXNjIil9dGVtcGxhdGUrPSc8c3BhbiBjbGFzcz0iJytpKyciIGRhdGEtZmllbGQ9IicraSsnIiBzdHlsZT0iJytjc3MrJyI+e3snK2krIn19PC9zcGFuPiJ9KTtpZihvYmouc29ydGFibGUubGVuZ3RoPjApb2JqLm9ic2VydmVyLmhvb2soaGVhZGVyLnBhcmVudE5vZGUsImNsaWNrIixvYmouc29ydCwic29ydCIsb2JqKTtyZWYucHVzaChsaXN0LmZhY3Rvcnkob2JqLmVsZW1lbnQscmVmWzBdLHRlbXBsYXRlLG9iai5vcHRpb25zKSk7b2JqLmxpc3Q9cmVmWzFdO2lmKG9iai5maWx0ZXJlZD09PXRydWUpe3JlZi5wdXNoKGZpbHRlci5mYWN0b3J5KGVsZW1lbnQuY3JlYXRlKCJpbnB1dCIseyJjbGFzcyI6ImZpbHRlciIscGxhY2Vob2xkZXI6IkZpbHRlciJ9LG9iai5lbGVtZW50LCJmaXJzdCIpLHJlZlsxXSxvYmouZmllbGRzLmpvaW4oIiwiKSxkZWJvdW5jZXx8MjUwKSk7b2JqLmZpbHRlcj1yZWZbMl19b2JqLm9uKCJiZWZvcmVSZWZyZXNoIiwKZnVuY3Rpb24oYXJnKXtlbGVtZW50LmRpc3BhdGNoKGFyZywiYmVmb3JlUmVmcmVzaCIpfSwiYnViYmxlIik7b2JqLm9uKCJhZnRlclJlZnJlc2giLGZ1bmN0aW9uKGFyZyl7ZWxlbWVudC5kaXNwYXRjaChhcmcsImFmdGVyUmVmcmVzaCIpfSwiYnViYmxlIik7b2JqLm9uKCJjbGljayIsZnVuY3Rpb24oZSl7aWYoZWxlbWVudC5oYXNDbGFzcyhlLmN1cnJlbnRUYXJnZXQsImhlYWRlciIpKW9iai5zb3J0KGUpfSwiaGVhZGVyIik7b2JqLmxpc3Qub24oImNoYW5nZSIsZnVuY3Rpb24oKXtvYmouZGlzcGF0Y2guYXBwbHkob2JqLFsiY2hhbmdlIl0uY29uY2F0KGFycmF5LmNhc3QoYXJndW1lbnRzKSkpfSwiY2hhbmdlIik7b2JqLmxpc3Qub24oImJlZm9yZUZpbHRlciIsZnVuY3Rpb24oKXtvYmouZGlzcGF0Y2guYXBwbHkob2JqLFsiYmVmb3JlRmlsdGVyIl0uY29uY2F0KGFycmF5LmNhc3QoYXJndW1lbnRzKSkpfSwiYmVmb3JlRmlsdGVyIik7b2JqLmxpc3Qub24oImFmdGVyRmlsdGVyIiwKZnVuY3Rpb24oKXtvYmouZGlzcGF0Y2guYXBwbHkob2JqLFsiYWZ0ZXJGaWx0ZXIiXS5jb25jYXQoYXJyYXkuY2FzdChhcmd1bWVudHMpKSl9LCJhZnRlckZpbHRlciIpO3JldHVybiBvYmp9fTtmdW5jdGlvbiBEYXRhR3JpZCh0YXJnZXQsc3RvcmUsZmllbGRzLHNvcnRhYmxlLG9wdGlvbnMsZmlsdGVyZWQpe3ZhciBzb3J0T3JkZXI7aWYob3B0aW9ucy5vcmRlciYmIXN0cmluZy5pc0VtcHR5KG9wdGlvbnMub3JkZXIpKXNvcnRPcmRlcj1zdHJpbmcuZXhwbG9kZShvcHRpb25zLm9yZGVyKS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkucmVwbGFjZShyZWdleC5hZnRlcl9zcGFjZSwiIil9KTt0aGlzLmVsZW1lbnQ9ZWxlbWVudC5jcmVhdGUoInNlY3Rpb24iLHsiY2xhc3MiOiJncmlkIn0sdGFyZ2V0KTt0aGlzLmZpZWxkcz1maWVsZHM7dGhpcy5maWx0ZXI9bnVsbDt0aGlzLmZpbHRlcmVkPWZpbHRlcmVkPT09dHJ1ZTt0aGlzLmxpc3Q9bnVsbDt0aGlzLm9ic2VydmVyPW9ic2VydmFibGUuZmFjdG9yeSgpOwp0aGlzLm9wdGlvbnM9b3B0aW9uc3x8e307dGhpcy5zdG9yZT1zdG9yZTt0aGlzLnNvcnRhYmxlPXNvcnRhYmxlfHxbXTt0aGlzLnNvcnRPcmRlcj1zb3J0T3JkZXJ8fHNvcnRhYmxlfHxbXX1EYXRhR3JpZC5wcm90b3R5cGU9YmFzZS5mYWN0b3J5KCk7RGF0YUdyaWQucHJvdG90eXBlLmNvbnN0cnVjdG9yPURhdGFHcmlkO0RhdGFHcmlkLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24ocmVjb3JkKXt2YXIgc2VsZj10aGlzO3RoaXMuc3RvcmUuc2V0KG51bGwscmVjb3JkKS50aGVuKG51bGwsZnVuY3Rpb24oZSl7dXRpbGl0eS5lcnJvcihlKTtzZWxmLmRpc3BhdGNoKCJlcnJvciIsZSl9KTtyZXR1cm4gdGhpc307RGF0YUdyaWQucHJvdG90eXBlLmR1bXA9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdG9yZS5kdW1wKHRoaXMubGlzdC5yZWNvcmRzLHRoaXMuZmllbGRzKX07RGF0YUdyaWQucHJvdG90eXBlLnJlZnJlc2g9ZnVuY3Rpb24oKXt2YXIgc29ydD1bXSxzZWxmPXRoaXM7dGhpcy5kaXNwYXRjaCgiYmVmb3JlUmVmcmVzaCIsCnRoaXMuZWxlbWVudCk7aWYodGhpcy5zb3J0T3JkZXIubGVuZ3RoPjApe2FycmF5LmVhY2godGhpcy5zb3J0T3JkZXIsZnVuY3Rpb24oaSl7dmFyIG9iaj1lbGVtZW50LmZpbmQoc2VsZi5lbGVtZW50LCIuaGVhZGVyIHNwYW5bZGF0YS1maWVsZD0nIitpKyInXSIpWzBdO3NvcnQucHVzaChzdHJpbmcudHJpbShpKyIgIisoZWxlbWVudC5kYXRhKG9iaiwic29ydCIpfHwiIikpKX0pO3RoaXMub3B0aW9ucy5vcmRlcj10aGlzLmxpc3Qub3JkZXI9c29ydC5qb2luKCIsICIpfXRoaXMubGlzdC53aGVyZT1udWxsO3V0aWxpdHkubWVyZ2UodGhpcy5saXN0LHRoaXMub3B0aW9ucyk7dGhpcy5saXN0LnJlZnJlc2goKTt0aGlzLmRpc3BhdGNoKCJhZnRlclJlZnJlc2giLHRoaXMuZWxlbWVudCk7cmV0dXJuIHRoaXN9O0RhdGFHcmlkLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24ocmVjb3JkKXt2YXIgc2VsZj10aGlzO3RoaXMuc3RvcmUuZGVsKHJlY29yZCkudGhlbihudWxsLGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSk7CnNlbGYuZGlzcGF0Y2goImVycm9yIixlKX0pO3JldHVybiB0aGlzfTtEYXRhR3JpZC5wcm90b3R5cGUuc29ydD1mdW5jdGlvbihldil7dmFyIHRhcmdldD11dGlsaXR5LnRhcmdldChldiksZmllbGQ7dXRpbGl0eS5zdG9wKGV2KTtpZihlbGVtZW50Lmhhc0NsYXNzKHRhcmdldCwic29ydGFibGUiKSl7ZmllbGQ9ZWxlbWVudC5kYXRhKHRhcmdldCwiZmllbGQiKTtlbGVtZW50LmRhdGEodGFyZ2V0LCJzb3J0IixlbGVtZW50LmRhdGEodGFyZ2V0LCJzb3J0Iik9PT0iYXNjIj8iZGVzYyI6ImFzYyIpO2FycmF5LnJlbW92ZSh0aGlzLnNvcnRPcmRlcixmaWVsZCk7dGhpcy5zb3J0T3JkZXIuc3BsaWNlKDAsMCxmaWVsZCk7dGhpcy5yZWZyZXNoKCl9cmV0dXJuIHRoaXN9O0RhdGFHcmlkLnByb3RvdHlwZS50ZWFyZG93bj1mdW5jdGlvbigpe2lmKHRoaXMuZmlsdGVyIT09bnVsbCl7dGhpcy5maWx0ZXIudGVhcmRvd24oKTt0aGlzLmZpbHRlcj1udWxsfXRoaXMubGlzdC50ZWFyZG93bigpOwp0aGlzLm9ic2VydmVyLnVuaG9vayhlbGVtZW50LmZpbmQodGhpcy5lbGVtZW50LCIuaGVhZGVyIilbMF0sImNsaWNrIik7ZWxlbWVudC5kZXN0cm95KHRoaXMuZWxlbWVudCk7dGhpcy5lbGVtZW50PW51bGw7cmV0dXJuIHRoaXN9O0RhdGFHcmlkLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oa2V5LGRhdGEpe3ZhciBzZWxmPXRoaXM7dGhpcy5zdG9yZS51cGRhdGUoa2V5LGRhdGEpLnRoZW4obnVsbCxmdW5jdGlvbihlKXt1dGlsaXR5LmVycm9yKGUpO3NlbGYuZGlzcGF0Y2goImVycm9yIixlKX0pO3JldHVybiB0aGlzfTt2YXIgbGlzdD17ZmFjdG9yeTpmdW5jdGlvbih0YXJnZXQsc3RvcmUsdGVtcGxhdGUsb3B0aW9ucyl7dmFyIHJlZj1bc3RvcmVdLG9iajtpZighKHRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQpfHx0eXBlb2Ygc3RvcmUhPSJvYmplY3QifHwhcmVnZXguc3RyaW5nX29iamVjdC50ZXN0KHR5cGVvZiB0ZW1wbGF0ZSkpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpOwpvYmo9bmV3IERhdGFMaXN0KGVsZW1lbnQuY3JlYXRlKCJ1bCIseyJjbGFzcyI6Imxpc3QifSx0YXJnZXQpLHJlZlswXSx0ZW1wbGF0ZSk7aWYob3B0aW9ucyBpbnN0YW5jZW9mIE9iamVjdCl7aWYob3B0aW9ucy5saXN0RmlsdGVyZWQmJm9wdGlvbnMubGlzdEZpbHRlcil7b2JqLmxpc3RGaWx0ZXI9ZmlsdGVyLmZhY3RvcnkoZWxlbWVudC5jcmVhdGUoImlucHV0Iix7ImlkIjpvYmouZWxlbWVudC5pZCsiLWZpbHRlciIsImNsYXNzIjoiZmlsdGVyIixwbGFjZWhvbGRlcjoiRmlsdGVyIn0sdGFyZ2V0LCJmaXJzdCIpLG9iaixvcHRpb25zLmxpc3RGaWx0ZXIsb3B0aW9ucy5kZWJvdW5jZXx8MjUwKTtkZWxldGUgb3B0aW9ucy5saXN0RmlsdGVyO2RlbGV0ZSBvcHRpb25zLmxpc3RGaWx0ZXJlZH11dGlsaXR5Lm1lcmdlKG9iaixvcHRpb25zKX1vYmouc3RvcmUubGlzdHMucHVzaChvYmopO29iai5vbigiYmVmb3JlUmVmcmVzaCIsZnVuY3Rpb24oYXJnKXtlbGVtZW50LmRpc3BhdGNoKGFyZywKImJlZm9yZVJlZnJlc2giKX0sImJ1YmJsZSIpO29iai5vbigiYWZ0ZXJSZWZyZXNoIixmdW5jdGlvbihhcmcpe2VsZW1lbnQuZGlzcGF0Y2goYXJnLCJhZnRlclJlZnJlc2giKX0sImJ1YmJsZSIpO29iai5vbigiY2hhbmdlIixmdW5jdGlvbihhcmcpe2VsZW1lbnQuZGlzcGF0Y2gob2JqLmVsZW1lbnQsImNoYW5nZSIsYXJnKX0sImNoYW5nZSIpO29iai5vbigiY2xpY2siLGZ1bmN0aW9uKGUpe3ZhciB0YXJnZXQ9dXRpbGl0eS50YXJnZXQoZSkscGFnZTt1dGlsaXR5LnN0b3AoZSk7aWYodGFyZ2V0Lm5vZGVOYW1lPT09IkEiKXtwYWdlPWVsZW1lbnQuZGF0YSh0YXJnZXQsInBhZ2UiKTtpZighaXNOYU4ocGFnZSkpb2JqLnBhZ2UocGFnZSl9fSwicGFnaW5hdGlvbiIpO2lmKHR5cGVvZiBNdXRhdGlvbk9ic2VydmVyPT0iZnVuY3Rpb24iKXtvYmoubXV0YXRpb249bmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oYXJnKXtvYmouZGlzcGF0Y2goImNoYW5nZSIsYXJnKX0pO29iai5tdXRhdGlvbi5vYnNlcnZlKG9iai5lbGVtZW50LAp7Y2hpbGRMaXN0OnRydWUsc3VidHJlZTp0cnVlfSl9aWYob2JqLnN0b3JlLnVyaT09PW51bGx8fG9iai5zdG9yZS5sb2FkZWQpb2JqLnJlZnJlc2goKTtyZXR1cm4gb2JqfSxwYWdlczpmdW5jdGlvbigpe2lmKGlzTmFOKHRoaXMucGFnZVNpemUpKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTtyZXR1cm4gTWF0aC5jZWlsKCghdGhpcy5maWx0ZXI/dGhpcy50b3RhbDp0aGlzLmZpbHRlcmVkLmxlbmd0aCkvdGhpcy5wYWdlU2l6ZSl9LHJhbmdlOmZ1bmN0aW9uKCl7dmFyIHN0YXJ0PXRoaXMucGFnZUluZGV4KnRoaXMucGFnZVNpemUtdGhpcy5wYWdlU2l6ZSxlbmQ9dGhpcy5wYWdlU2l6ZTtyZXR1cm5bc3RhcnQsZW5kXX19O2Z1bmN0aW9uIERhdGFMaXN0KGVsZW1lbnQsc3RvcmUsdGVtcGxhdGUpe3RoaXMuY2FsbGJhY2s9bnVsbDt0aGlzLmN1cnJlbnQ9W107dGhpcy5lbGVtZW50PWVsZW1lbnQ7dGhpcy5lbXB0eU1zZz1sYWJlbC5ub0RhdGE7dGhpcy5maWx0ZXI9Cm51bGw7dGhpcy5maWx0ZXJlZD1bXTt0aGlzLmlkPXV0aWxpdHkuZ2VuSWQoKTt0aGlzLml0ZW1zPVtdO3RoaXMubGlzdEZpbHRlcj1udWxsO3RoaXMubXV0YXRpb249bnVsbDt0aGlzLm9ic2VydmVyPW9ic2VydmFibGUuZmFjdG9yeSgpO3RoaXMucGFnZUluZGV4PTE7dGhpcy5wYWdlU2l6ZT1udWxsO3RoaXMucGFnZVJhbmdlPTU7dGhpcy5wYWdpbmF0aW9uPSJib3R0b20iO3RoaXMucGxhY2Vob2xkZXI9IiI7dGhpcy5vcmRlcj0iIjt0aGlzLnJlY29yZHM9W107dGhpcy50ZW1wbGF0ZT10ZW1wbGF0ZTt0aGlzLnRvdGFsPTA7dGhpcy5zdG9yZT1zdG9yZTt0aGlzLndoZXJlPW51bGx9RGF0YUxpc3QucHJvdG90eXBlPWJhc2UuZmFjdG9yeSgpO0RhdGFMaXN0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1EYXRhTGlzdDtEYXRhTGlzdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHJlY29yZCl7dmFyIHNlbGY9dGhpczt0aGlzLnN0b3JlLnNldChudWxsLHJlY29yZCkudGhlbihudWxsLGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSk7CnNlbGYuZGlzcGF0Y2goImVycm9yIixlKX0pO3JldHVybiB0aGlzfTtEYXRhTGlzdC5wcm90b3R5cGUuZHVtcD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN0b3JlLmR1bXAodGhpcy5yZWNvcmRzKX07RGF0YUxpc3QucHJvdG90eXBlLnBhZ2U9ZnVuY3Rpb24obil7dGhpcy5wYWdlSW5kZXg9bjtyZXR1cm4gdGhpcy5yZWZyZXNoKCl9O0RhdGFMaXN0LnByb3RvdHlwZS5wYWdlcz1mdW5jdGlvbigpe3ZhciBzZWxmPXRoaXMsb2JqPXRoaXMuZWxlbWVudCxwYWdlPXRoaXMucGFnZUluZGV4LHBvcz10aGlzLnBhZ2luYXRpb24scmFuZ2U9dGhpcy5wYWdlUmFuZ2UsbWlkPU1hdGguZmxvb3IocmFuZ2UvMiksc3RhcnQ9cGFnZS1taWQsZW5kPXBhZ2UrbWlkLHRvdGFsPWxpc3QucGFnZXMuY2FsbCh0aGlzKSxkaWZmO2lmKCFyZWdleC50b3BfYm90dG9tLnRlc3QocG9zKSl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7YXJyYXkuZWFjaCh1dGlsaXR5LmRvbSgiIyIrb2JqLmlkKwoiLXBhZ2VzLXRvcCwgIyIrb2JqLmlkKyItcGFnZXMtYm90dG9tIiksZnVuY3Rpb24oaSl7aWYoaSl7c2VsZi5vYnNlcnZlci51bmhvb2soaSwiY2xpY2siKTtlbGVtZW50LmRlc3Ryb3koaSl9fSk7aWYodGhpcy5maWx0ZXImJnRoaXMuZmlsdGVyZWQubGVuZ3RoPT09MHx8dGhpcy50b3RhbD09PTB8fHRvdGFsPT09MSlyZXR1cm4gdGhpcztpZihzdGFydDwxKXtkaWZmPW51bWJlci5kaWZmKHN0YXJ0LDEpO3N0YXJ0PXN0YXJ0K2RpZmY7ZW5kPWVuZCtkaWZmfWlmKGVuZD50b3RhbCl7ZW5kPXRvdGFsO3N0YXJ0PWVuZC1yYW5nZSsxO2lmKHN0YXJ0PDEpc3RhcnQ9MX1pZihudW1iZXIuZGlmZihzdGFydCxlbmQpPj1yYW5nZSktLWVuZDthcnJheS5lYWNoKHN0cmluZy5leHBsb2RlKHBvcyksZnVuY3Rpb24oaSl7dmFyIGN1cnJlbnQ9ZmFsc2UsbW9yZT1wYWdlPjEsbmV4dD1wYWdlKzE8PXRvdGFsLGxhc3Q9cGFnZT49dG90YWwsZWwsbjtlbD1lbGVtZW50LmNyZWF0ZSgidWwiLHsiY2xhc3MiOiJsaXN0IHBhZ2VzIGhpZGRlbiAiKwppLGlkOm9iai5pZCsiLXBhZ2VzLSIraX0sb2JqLGk9PT0iYm90dG9tIj8iYWZ0ZXIiOiJiZWZvcmUiKTtlbGVtZW50LmNyZWF0ZShtb3JlPyJhIjoic3BhbiIseyJjbGFzcyI6ImZpcnN0IHBhZ2UiLCJkYXRhLXBhZ2UiOjEsaW5uZXJIVE1MOiImbHQ7Jmx0OyJ9LGVsZW1lbnQuY3JlYXRlKCJsaSIse30sZWwpKTtlbGVtZW50LmNyZWF0ZShtb3JlPyJhIjoic3BhbiIseyJjbGFzcyI6InByZXYgcGFnZSIsImRhdGEtcGFnZSI6cGFnZS0xLGlubmVySFRNTDoiJmx0OyJ9LGVsZW1lbnQuY3JlYXRlKCJsaSIse30sZWwpKTtmb3Iobj1zdGFydDtuPD1lbmQ7bisrKXtjdXJyZW50PW49PT1wYWdlO2VsZW1lbnQuY3JlYXRlKGN1cnJlbnQ/InNwYW4iOiJhIix7ImNsYXNzIjpjdXJyZW50PyJjdXJyZW50IHBhZ2UiOiJwYWdlIiwiZGF0YS1wYWdlIjpuLGlubmVySFRNTDpufSxlbGVtZW50LmNyZWF0ZSgibGkiLHt9LGVsKSl9ZWxlbWVudC5jcmVhdGUobmV4dD8iYSI6InNwYW4iLHsiY2xhc3MiOiJuZXh0IHBhZ2UiLAoiZGF0YS1wYWdlIjpuZXh0P3BhZ2UrMTpudWxsLGlubmVySFRNTDoiJmd0OyJ9LGVsZW1lbnQuY3JlYXRlKCJsaSIse30sZWwpKTtlbGVtZW50LmNyZWF0ZShsYXN0PyJzcGFuIjoiYSIseyJjbGFzcyI6Imxhc3QgcGFnZSIsImRhdGEtcGFnZSI6bGFzdD9udWxsOnRvdGFsLGlubmVySFRNTDoiJmd0OyZndDsifSxlbGVtZW50LmNyZWF0ZSgibGkiLHt9LGVsKSk7ZWxlbWVudC5rbGFzcyhlbCwiaGlkZGVuIixmYWxzZSk7c2VsZi5vYnNlcnZlci5ob29rKGVsLCJjbGljayIpfSk7cmV0dXJuIHRoaXN9O0RhdGFMaXN0LnByb3RvdHlwZS5yZWZyZXNoPWZ1bmN0aW9uKGNyZWF0ZSl7dmFyIHNlbGY9dGhpcyxlbD10aGlzLmVsZW1lbnQsdGVtcGxhdGU9dHlwZW9mIHRoaXMudGVtcGxhdGU9PSJvYmplY3QiLGZpbHRlcj10aGlzLmZpbHRlciE9PW51bGwsaXRlbXM9W10sY2FsbGJhY2s9dHlwZW9mIHRoaXMuY2FsbGJhY2s9PSJmdW5jdGlvbiIscmVnPW5ldyBSZWdFeHAscmVnaXN0cnk9W10sCnJhbmdlPVtdLGZuLGNlaWxpbmcsbmV4dDtjcmVhdGU9Y3JlYXRlPT09dHJ1ZTt0aGlzLmRpc3BhdGNoKCJiZWZvcmVSZWZyZXNoIixlbCk7aWYoIXRlbXBsYXRlKWZuPWZ1bmN0aW9uKGkpe3ZhciBodG1sPXNlbGYudGVtcGxhdGUsaXRlbXM9YXJyYXkudW5pcXVlKGh0bWwubWF0Y2goL1x7XHtbXHdcLlwtXFtcXV0rXH1cfS9nKSk7aHRtbD1odG1sLnJlcGxhY2UoInt7IitzZWxmLnN0b3JlLmtleSsifX0iLGkua2V5KTthcnJheS5lYWNoKGl0ZW1zLGZ1bmN0aW9uKGF0dHIpe3ZhciBrZXk9YXR0ci5yZXBsYWNlKC9ce1x7fFx9XH0vZywiIiksdmFsdWU9dXRpbGl0eS53YWxrKGkuZGF0YSxrZXkpO2lmKHZhbHVlPT09dW5kZWZpbmVkKXZhbHVlPSIiO3JlZy5jb21waWxlKHN0cmluZy5lc2NhcGUoYXR0ciksImciKTtodG1sPWh0bWwucmVwbGFjZShyZWcsdmFsdWUpfSk7aHRtbD1odG1sLnJlcGxhY2UoL1x7XHsuKlx9XH0vZyxzZWxmLnBsYWNlaG9sZGVyKTtyZXR1cm4nPGxpIGRhdGEta2V5PSInKwppLmtleSsnIj4nK2h0bWwrIjwvbGk+In07ZWxzZSBmbj1mdW5jdGlvbihpKXt2YXIgb2JqPWpzb24uZW5jb2RlKHNlbGYudGVtcGxhdGUpLGl0ZW1zPWFycmF5LnVuaXF1ZShvYmoubWF0Y2goL1x7XHtbXHdcLlwtXFtcXV0rXH1cfS9nKSk7b2JqPW9iai5yZXBsYWNlKCJ7eyIrc2VsZi5zdG9yZS5rZXkrIn19IixpLmtleSk7YXJyYXkuZWFjaChpdGVtcyxmdW5jdGlvbihhdHRyKXt2YXIga2V5PWF0dHIucmVwbGFjZSgvXHtce3xcfVx9L2csIiIpLHZhbHVlPXV0aWxpdHkud2FsayhpLmRhdGEsa2V5KXx8IiI7cmVnLmNvbXBpbGUoc3RyaW5nLmVzY2FwZShhdHRyKSwiZyIpO29iaj1vYmoucmVwbGFjZShyZWcsanNvbi5lbmNvZGUodmFsdWUpLnJlcGxhY2UoLyheIil8KCIkKS9nLCIiKSl9KTtvYmo9anNvbi5kZWNvZGUob2JqLnJlcGxhY2UoL1x7XHsuKlx9XH0vZyxzZWxmLnBsYWNlaG9sZGVyKSk7cmV0dXJue2xpOm9ian19O25leHQ9ZnVuY3Rpb24oYXJncyl7c2VsZi5yZWNvcmRzPQphcmdzO3NlbGYudG90YWw9c2VsZi5yZWNvcmRzLmxlbmd0aDtzZWxmLmZpbHRlcmVkPVtdO3NlbGYuY3VycmVudD1bXTtpZihmaWx0ZXIpYXJyYXkuZWFjaChzZWxmLnJlY29yZHMsZnVuY3Rpb24oaSl7dXRpbGl0eS5pdGVyYXRlKHNlbGYuZmlsdGVyLGZ1bmN0aW9uKHYsayl7dmFyIHJlZyxrZXk7aWYoYXJyYXkuY29udGFpbnMocmVnaXN0cnksaS5rZXkpKXJldHVybiBmYWxzZTt2PXN0cmluZy5leHBsb2RlKHYpO3JlZz1uZXcgUmVnRXhwLGtleT1rPT09c2VsZi5zdG9yZS5rZXk7YXJyYXkuZWFjaCh2LGZ1bmN0aW9uKHF1ZXJ5KXt2YXIgdmFsdWU9IWtleT91dGlsaXR5LndhbGsoaS5kYXRhLGspOiIiO3V0aWxpdHkuY29tcGlsZShyZWcscXVlcnksImkiKTtpZihrZXkmJnJlZy50ZXN0KGkua2V5KXx8cmVnLnRlc3QodmFsdWUpKXtyZWdpc3RyeS5wdXNoKGkua2V5KTtzZWxmLmZpbHRlcmVkLnB1c2goaSk7cmV0dXJuIGZhbHNlfX0pfSl9KTtpZihzZWxmLnBhZ2VTaXplIT09bnVsbCYmCiFpc05hTihzZWxmLnBhZ2VJbmRleCkmJiFpc05hTihzZWxmLnBhZ2VTaXplKSl7Y2VpbGluZz1saXN0LnBhZ2VzLmNhbGwoc2VsZik7aWYoY2VpbGluZz4wJiZzZWxmLnBhZ2VJbmRleD5jZWlsaW5nKXJldHVybiBzZWxmLnBhZ2UoY2VpbGluZyk7ZWxzZSBpZihzZWxmLnRvdGFsPjApe3JhbmdlPWxpc3QucmFuZ2UuY2FsbChzZWxmKTtzZWxmLmN1cnJlbnQ9YXJyYXkubGltaXQoIWZpbHRlcj9zZWxmLnJlY29yZHM6c2VsZi5maWx0ZXJlZCxyYW5nZVswXSxyYW5nZVsxXSl9fWVsc2Ugc2VsZi5jdXJyZW50PSFmaWx0ZXI/c2VsZi5yZWNvcmRzOnNlbGYuZmlsdGVyZWQ7YXJyYXkuZWFjaChzZWxmLmN1cnJlbnQsZnVuY3Rpb24oaSl7dmFyIGh0bWw9Zm4oaSksaGFzaD1idG9hKGh0bWwpO2l0ZW1zLnB1c2goe2tleTppLmtleSx0ZW1wbGF0ZTpodG1sLGhhc2g6aGFzaH0pfSk7dXRpbGl0eS5yZW5kZXIoZnVuY3Rpb24oKXt2YXIgZGVzdHJveT1bXSxjYWxsYmFja3M9W10saSxudGg7aWYoaXRlbXMubGVuZ3RoPT09CjApZWxlbWVudC5odG1sKGVsLCc8bGkgY2xhc3M9ImVtcHR5Ij4nK3NlbGYuZW1wdHlNc2crIjwvbGk+Iik7ZWxzZSBpZihzZWxmLml0ZW1zLmxlbmd0aD09PTApe2VsZW1lbnQuaHRtbChlbCxpdGVtcy5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkudGVtcGxhdGV9KS5qb2luKCIiKSk7aWYoY2FsbGJhY2spYXJyYXkuZWFjaChhcnJheS5jYXN0KGVsLmNoaWxkTm9kZXMpLGZ1bmN0aW9uKGkpe3NlbGYuY2FsbGJhY2soaSl9KX1lbHNle2FycmF5LmVhY2goaXRlbXMsZnVuY3Rpb24oaSxpZHgpe2lmKHNlbGYuaXRlbXNbaWR4XSE9PXVuZGVmaW5lZCYmc2VsZi5pdGVtc1tpZHhdLmhhc2ghPT1pLmhhc2gpe2VsZW1lbnQuZGF0YShlbGVtZW50Lmh0bWwoZWwuY2hpbGROb2Rlc1tpZHhdLGkudGVtcGxhdGUucmVwbGFjZSgvPGxpIGRhdGEta2V5PVwiXGQrXCI+fDxcL2xpPi9nLCIiKSksImtleSIsaS5rZXkpO2NhbGxiYWNrcy5wdXNoKGlkeCl9ZWxzZSBpZihzZWxmLml0ZW1zW2lkeF09PT0KdW5kZWZpbmVkKXtlbGVtZW50LmNyZWF0ZShpLnRlbXBsYXRlLG51bGwsZWwpO2NhbGxiYWNrcy5wdXNoKGlkeCl9fSk7aWYoaXRlbXMubGVuZ3RoPHNlbGYuaXRlbXMubGVuZ3RoKXtpPWl0ZW1zLmxlbmd0aC0xO250aD1zZWxmLml0ZW1zLmxlbmd0aDt3aGlsZSgrK2k8bnRoKWRlc3Ryb3kucHVzaChpKTthcnJheS5lYWNoKGRlc3Ryb3kucmV2ZXJzZSgpLGZ1bmN0aW9uKGkpe2VsZW1lbnQuZGVzdHJveShlbC5jaGlsZE5vZGVzW2ldKX0pfWlmKGNhbGxiYWNrKWFycmF5LmVhY2goY2FsbGJhY2tzLGZ1bmN0aW9uKGkpe3NlbGYuY2FsbGJhY2soZWwuY2hpbGROb2Rlc1tpXSl9KX1zZWxmLml0ZW1zPWl0ZW1zO2lmKHNlbGYucGFnZVNpemUhPT1udWxsJiZyZWdleC50b3BfYm90dG9tLnRlc3Qoc2VsZi5wYWdpbmF0aW9uKSYmIWlzTmFOKHNlbGYucGFnZUluZGV4KSYmIWlzTmFOKHNlbGYucGFnZVNpemUpKXNlbGYucGFnZXMoKTtlbHNlIGFycmF5LmVhY2godXRpbGl0eS4kKCIjIitlbC5pZCsKIi1wYWdlcy10b3AsICMiK2VsLmlkKyItcGFnZXMtYm90dG9tIiksZnVuY3Rpb24oaSl7ZWxlbWVudC5kZXN0cm95KGkpfSk7c2VsZi5kaXNwYXRjaCgiYWZ0ZXJSZWZyZXNoIixlbCl9KX07aWYodGhpcy53aGVyZT09PW51bGwpc3RyaW5nLmlzRW1wdHkodGhpcy5vcmRlcik/bmV4dCh0aGlzLnN0b3JlLmdldCgpKTp0aGlzLnN0b3JlLnNvcnQodGhpcy5vcmRlcixjcmVhdGUpLnRoZW4obmV4dCxmdW5jdGlvbihlKXt1dGlsaXR5LmVycm9yKGUpO3NlbGYuZGlzcGF0Y2goImVycm9yIixlKX0pO2Vsc2UgaWYoc3RyaW5nLmlzRW1wdHkodGhpcy5vcmRlcikpdGhpcy5zdG9yZS5zZWxlY3QodGhpcy53aGVyZSkudGhlbihuZXh0LGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSk7c2VsZi5kaXNwYXRjaCgiZXJyb3IiLGUpfSk7ZWxzZSB0aGlzLnN0b3JlLnNvcnQodGhpcy5vcmRlcixjcmVhdGUsdGhpcy53aGVyZSkudGhlbihuZXh0LGZ1bmN0aW9uKGUpe3V0aWxpdHkuZXJyb3IoZSk7CnNlbGYuZGlzcGF0Y2goImVycm9yIixlKX0pO3JldHVybiB0aGlzfTtEYXRhTGlzdC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKHJlY29yZCl7dmFyIHNlbGY9dGhpczt0aGlzLnN0b3JlLmRlbChyZWNvcmQpLnRoZW4obnVsbCxmdW5jdGlvbihlKXt1dGlsaXR5LmVycm9yKGUpO3NlbGYuZGlzcGF0Y2goImVycm9yIixlKX0pO3JldHVybiB0aGlzfTtEYXRhTGlzdC5wcm90b3R5cGUuc29ydD1mdW5jdGlvbihvcmRlcil7dGhpcy5vcmRlcj1vcmRlcjtyZXR1cm4gdGhpcy5yZWZyZXNoKCl9O0RhdGFMaXN0LnByb3RvdHlwZS50ZWFyZG93bj1mdW5jdGlvbihkZXN0cm95KXtkZXN0cm95PWRlc3Ryb3k9PT10cnVlO3ZhciBzZWxmPXRoaXMsaWQ9dGhpcy5lbGVtZW50LmlkO2FycmF5LmVhY2godGhpcy5zdG9yZS5saXN0cyxmdW5jdGlvbihpLGlkeCl7aWYoaS5pZD09PXNlbGYuaWQpe2FycmF5LnJlbW92ZSh0aGlzLGlkeCk7cmV0dXJuIGZhbHNlfX0pO2RlbGV0ZSB0aGlzLm9ic2VydmVyLmhvb2tzW2lkXTsKaWYodGhpcy5saXN0RmlsdGVyKXRoaXMubGlzdEZpbHRlci50ZWFyZG93bigpO2lmKGRlc3Ryb3kpe2VsZW1lbnQuZGVzdHJveSh0aGlzLmVsZW1lbnQpO2FycmF5LmVhY2godXRpbGl0eS4kKCIjIitpZCsiLWZpbHRlciwgIyIraWQrIi1wYWdlcy10b3AsICMiK2lkKyItcGFnZXMtYm90dG9tIiksZnVuY3Rpb24oaSl7ZWxlbWVudC5kZXN0cm95KGkpfSk7dGhpcy5lbGVtZW50PW51bGx9cmV0dXJuIHRoaXN9O0RhdGFMaXN0LnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oa2V5LGRhdGEpe3ZhciBzZWxmPXRoaXM7dGhpcy5zdG9yZS51cGRhdGUoa2V5LGRhdGEpLnRoZW4obnVsbCxmdW5jdGlvbihlKXt1dGlsaXR5LmVycm9yKGUpO3NlbGYuZGlzcGF0Y2goImVycm9yIixlKX0pO3JldHVybiB0aGlzfTt2YXIgZGVmZXJyZWQ9e2ZhY3Rvcnk6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IERlZmVycmVkfX07ZnVuY3Rpb24gRGVmZXJyZWQoKXt2YXIgc2VsZj10aGlzO3RoaXMucHJvbWlzZT1wcm9taXNlLmZhY3RvcnkoKTsKdGhpcy5vbkRvbmU9W107dGhpcy5vbkFsd2F5cz1bXTt0aGlzLm9uRmFpbD1bXTt0aGlzLnByb21pc2UudGhlbihmdW5jdGlvbihhcmcpe2FycmF5LmVhY2goc2VsZi5vbkRvbmUsZnVuY3Rpb24oaSl7aShhcmcpfSk7YXJyYXkuZWFjaChzZWxmLm9uQWx3YXlzLGZ1bmN0aW9uKGkpe2koYXJnKX0pO3NlbGYub25BbHdheXM9W107c2VsZi5vbkRvbmU9W107c2VsZi5vbkZhaWw9W119LGZ1bmN0aW9uKGFyZyl7YXJyYXkuZWFjaChzZWxmLm9uRmFpbCxmdW5jdGlvbihpKXtpKGFyZyl9KTthcnJheS5lYWNoKHNlbGYub25BbHdheXMsZnVuY3Rpb24oaSl7aShhcmcpfSk7c2VsZi5vbkFsd2F5cz1bXTtzZWxmLm9uRG9uZT1bXTtzZWxmLm9uRmFpbD1bXX0pfURlZmVycmVkLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1EZWZlcnJlZDtEZWZlcnJlZC5wcm90b3R5cGUuYWx3YXlzPWZ1bmN0aW9uKGFyZyl7dGhpcy5vbkFsd2F5cy5wdXNoKGFyZyk7cmV0dXJuIHRoaXN9O0RlZmVycmVkLnByb3RvdHlwZS5kb25lPQpmdW5jdGlvbihhcmcpe3RoaXMub25Eb25lLnB1c2goYXJnKTtyZXR1cm4gdGhpc307RGVmZXJyZWQucHJvdG90eXBlLmZhaWw9ZnVuY3Rpb24oYXJnKXt0aGlzLm9uRmFpbC5wdXNoKGFyZyk7cmV0dXJuIHRoaXN9O0RlZmVycmVkLnByb3RvdHlwZS5yZWplY3Q9ZnVuY3Rpb24oYXJnKXt0aGlzLnByb21pc2UucmVqZWN0LmNhbGwodGhpcy5wcm9taXNlLGFyZyk7cmV0dXJuIHRoaXN9O0RlZmVycmVkLnByb3RvdHlwZS5yZXNvbHZlPWZ1bmN0aW9uKGFyZyl7dGhpcy5wcm9taXNlLnJlc29sdmUuY2FsbCh0aGlzLnByb21pc2UsYXJnKTtyZXR1cm4gdGhpc307RGVmZXJyZWQucHJvdG90eXBlLnRoZW49ZnVuY3Rpb24oc3VjY2VzcyxmYWlsdXJlKXtyZXR1cm4gdGhpcy5wcm9taXNlLnRoZW4oc3VjY2VzcyxmYWlsdXJlKX07dmFyIGVsZW1lbnQ9e2FwcGVuZFRvOmZ1bmN0aW9uKG9iaixjaGlsZCl7b2JqLmFwcGVuZENoaWxkKGNoaWxkKTtyZXR1cm4gb2JqfSxhdHRyOmZ1bmN0aW9uKG9iaiwKa2V5LHZhbHVlKXt2YXIgdGFyZ2V0LHJlc3VsdDtpZihyZWdleC5zdmcudGVzdChvYmoubmFtZXNwYWNlVVJJKSlpZih2YWx1ZT09PXVuZGVmaW5lZCl7cmVzdWx0PW9iai5nZXRBdHRyaWJ1dGVOUyhvYmoubmFtZXNwYWNlVVJJLGtleSk7aWYocmVzdWx0PT09bnVsbHx8c3RyaW5nLmlzRW1wdHkocmVzdWx0KSlyZXN1bHQ9dW5kZWZpbmVkO2Vsc2UgcmVzdWx0PXV0aWxpdHkuY29lcmNlKHJlc3VsdCl9ZWxzZSBvYmouc2V0QXR0cmlidXRlTlMob2JqLm5hbWVzcGFjZVVSSSxrZXksdmFsdWUpO2Vsc2V7aWYodHlwZW9mIHZhbHVlPT0ic3RyaW5nIil2YWx1ZT1zdHJpbmcudHJpbSh2YWx1ZSk7aWYocmVnZXguY2hlY2tlZF9kaXNhYmxlZC50ZXN0KGtleSkmJnZhbHVlPT09dW5kZWZpbmVkKXJldHVybiB1dGlsaXR5LmNvZXJjZShvYmpba2V5XSk7ZWxzZSBpZihyZWdleC5jaGVja2VkX2Rpc2FibGVkLnRlc3Qoa2V5KSYmdmFsdWUhPT11bmRlZmluZWQpb2JqW2tleV09dmFsdWU7ZWxzZSBpZihvYmoubm9kZU5hbWU9PT0KIlNFTEVDVCImJmtleT09PSJzZWxlY3RlZCImJnZhbHVlPT09dW5kZWZpbmVkKXJldHVybiB1dGlsaXR5LmRvbSgiIyIrb2JqLmlkKycgb3B0aW9uW3NlbGVjdGVkPSJzZWxlY3RlZCJdJylbMF18fHV0aWxpdHkuZG9tKCIjIitvYmouaWQrIiBvcHRpb24iKVswXTtlbHNlIGlmKG9iai5ub2RlTmFtZT09PSJTRUxFQ1QiJiZrZXk9PT0ic2VsZWN0ZWQiJiZ2YWx1ZSE9PXVuZGVmaW5lZCl7dGFyZ2V0PXV0aWxpdHkuZG9tKCIjIitvYmouaWQrJyBvcHRpb25bc2VsZWN0ZWQ9InNlbGVjdGVkIl0nKVswXTtpZih0YXJnZXQhPT11bmRlZmluZWQpe3RhcmdldC5zZWxlY3RlZD1mYWxzZTt0YXJnZXQucmVtb3ZlQXR0cmlidXRlKCJzZWxlY3RlZCIpfXRhcmdldD11dGlsaXR5LmRvbSgiIyIrb2JqLmlkKycgb3B0aW9uW3ZhbHVlPSInK3ZhbHVlKyciXScpWzBdO3RhcmdldC5zZWxlY3RlZD10cnVlO3RhcmdldC5zZXRBdHRyaWJ1dGUoInNlbGVjdGVkIiwic2VsZWN0ZWQiKX1lbHNlIGlmKHZhbHVlPT09CnVuZGVmaW5lZCl7cmVzdWx0PW9iai5nZXRBdHRyaWJ1dGUoa2V5KTtpZihyZXN1bHQ9PT1udWxsfHxzdHJpbmcuaXNFbXB0eShyZXN1bHQpKXJlc3VsdD11bmRlZmluZWQ7ZWxzZSByZXN1bHQ9dXRpbGl0eS5jb2VyY2UocmVzdWx0KTtyZXR1cm4gcmVzdWx0fWVsc2Ugb2JqLnNldEF0dHJpYnV0ZShrZXksdmFsdWUpfXJldHVybiBvYmp9LGNsZWFyOmZ1bmN0aW9uKG9iail7aWYodHlwZW9mIG9iai5yZXNldD09ImZ1bmN0aW9uIilvYmoucmVzZXQoKTtlbHNlIGlmKG9iai52YWx1ZSE9PXVuZGVmaW5lZCllbGVtZW50LnVwZGF0ZShvYmose2lubmVySFRNTDoiIix2YWx1ZToiIn0pO2Vsc2UgZWxlbWVudC51cGRhdGUob2JqLHtpbm5lckhUTUw6IiJ9KTtyZXR1cm4gb2JqfSxjcmVhdGU6ZnVuY3Rpb24odHlwZSxhcmdzLG9iaixwb3Mpe3ZhciBzdmc9ZmFsc2UsZnJhZz1mYWxzZSxmcmFnbWVudCx1aWQscmVzdWx0O3R5cGU9dHlwZS5yZXBsYWNlKC9cdHxcbnxcci9nLCIiKTtpZihvYmopc3ZnPQpvYmoubmFtZXNwYWNlVVJJJiZyZWdleC5zdmcudGVzdChvYmoubmFtZXNwYWNlVVJJKTtlbHNlIG9iaj1kb2N1bWVudC5ib2R5O2lmKGFyZ3MgaW5zdGFuY2VvZiBPYmplY3QmJmFyZ3MuaWQmJiF1dGlsaXR5LmRvbSgiIyIrYXJncy5pZCkpe3VpZD1hcmdzLmlkO2RlbGV0ZSBhcmdzLmlkfWVsc2UgaWYoIXN2Zyl1aWQ9dXRpbGl0eS5nZW5JZCh1bmRlZmluZWQsdHJ1ZSk7aWYocmVnZXguaHRtbC50ZXN0KHR5cGUpKXtmcmFnPXRydWU7ZnJhZ21lbnQ9ZWxlbWVudC5mcmFnKHR5cGUpO3Jlc3VsdD1mcmFnbWVudC5jaGlsZE5vZGVzLmxlbmd0aD09PTE/ZnJhZ21lbnQuY2hpbGROb2Rlc1swXTphcnJheS5jYXN0KGZyYWdtZW50LmNoaWxkTm9kZXMpfWVsc2V7aWYoIXN2ZyYmIXJlZ2V4LnN2Zy50ZXN0KHR5cGUpKWZyYWdtZW50PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSk7ZWxzZSBmcmFnbWVudD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwKdHlwZSk7aWYodWlkKWZyYWdtZW50LmlkPXVpZDtpZihhcmdzIGluc3RhbmNlb2YgT2JqZWN0KWVsZW1lbnQudXBkYXRlKGZyYWdtZW50LGFyZ3MpfWlmKCFwb3N8fHBvcz09PSJsYXN0IilvYmouYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO2Vsc2UgaWYocG9zPT09ImZpcnN0IillbGVtZW50LnByZXBlbmRDaGlsZChvYmosZnJhZ21lbnQpO2Vsc2UgaWYocG9zPT09ImFmdGVyIil7cG9zPXthZnRlcjpvYmp9O29iaj1vYmoucGFyZW50Tm9kZTtvYmouaW5zZXJ0QmVmb3JlKGZyYWdtZW50LHBvcy5hZnRlci5uZXh0U2libGluZyl9ZWxzZSBpZihwb3MuYWZ0ZXIpb2JqLmluc2VydEJlZm9yZShmcmFnbWVudCxwb3MuYWZ0ZXIubmV4dFNpYmxpbmcpO2Vsc2UgaWYocG9zPT09ImJlZm9yZSIpe3Bvcz17YmVmb3JlOm9ian07b2JqPW9iai5wYXJlbnROb2RlO29iai5pbnNlcnRCZWZvcmUoZnJhZ21lbnQscG9zLmJlZm9yZSl9ZWxzZSBpZihwb3MuYmVmb3JlKW9iai5pbnNlcnRCZWZvcmUoZnJhZ21lbnQsCnBvcy5iZWZvcmUpO2Vsc2Ugb2JqLmFwcGVuZENoaWxkKGZyYWdtZW50KTtyZXR1cm4hZnJhZz9mcmFnbWVudDpyZXN1bHR9LGNzczpmdW5jdGlvbihvYmosa2V5LHZhbHVlKXtpZighcmVnZXguY2Fwcy50ZXN0KGtleSkpa2V5PXN0cmluZy50b0NhbWVsQ2FzZShrZXkpO2lmKHZhbHVlIT09dW5kZWZpbmVkKXtvYmouc3R5bGVba2V5XT12YWx1ZTtyZXR1cm4gb2JqfWVsc2UgcmV0dXJuIG9iai5zdHlsZVtrZXldfSxkYXRhOmZ1bmN0aW9uKG9iaixrZXksdmFsdWUpe2lmKHZhbHVlIT09dW5kZWZpbmVkKXtvYmouc2V0QXR0cmlidXRlKCJkYXRhLSIra2V5LHJlZ2V4Lmpzb25fd3JhcC50ZXN0KHZhbHVlKT9qc29uLmVuY29kZSh2YWx1ZSk6dmFsdWUpO3JldHVybiBvYmp9ZWxzZSByZXR1cm4gdXRpbGl0eS5jb2VyY2Uob2JqLmdldEF0dHJpYnV0ZSgiZGF0YS0iK2tleSkpfSxkZXN0cm95OmZ1bmN0aW9uKG9iail7aWYob2JqLnBhcmVudE5vZGUhPT1udWxsKW9iai5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG9iaik7CnJldHVybiB1bmRlZmluZWR9LGRpc2FibGU6ZnVuY3Rpb24ob2JqKXtpZih0eXBlb2Ygb2JqLmRpc2FibGVkPT0iYm9vbGVhbiImJiFvYmouZGlzYWJsZWQpb2JqLmRpc2FibGVkPXRydWU7cmV0dXJuIG9ian0sZGlzcGF0Y2g6ZnVuY3Rpb24ob2JqLHR5cGUsZGF0YSxidWJibGVzLGNhbmNlbGFibGUpe3ZhciBldjtpZighb2JqKXJldHVybjt0cnl7ZXY9bmV3IEN1c3RvbUV2ZW50KHR5cGUpfWNhdGNoKGUpe2V2PWRvY3VtZW50LmNyZWF0ZUV2ZW50KCJDdXN0b21FdmVudCIpfWJ1YmJsZXM9YnViYmxlcyE9PWZhbHNlO2NhbmNlbGFibGU9Y2FuY2VsYWJsZSE9PWZhbHNlO2V2LmluaXRDdXN0b21FdmVudCh0eXBlLGJ1YmJsZXMsY2FuY2VsYWJsZSxkYXRhfHx7fSk7b2JqLmRpc3BhdGNoRXZlbnQoZXYpO3JldHVybiBvYmp9LGVuYWJsZTpmdW5jdGlvbihvYmope2lmKHR5cGVvZiBvYmouZGlzYWJsZWQ9PSJib29sZWFuIiYmb2JqLmRpc2FibGVkKW9iai5kaXNhYmxlZD1mYWxzZTtyZXR1cm4gb2JqfSwKZmluZDpmdW5jdGlvbihvYmosYXJnKXt2YXIgcmVzdWx0PVtdO3V0aWxpdHkuZ2VuSWQob2JqLHRydWUpO2FycmF5LmVhY2goc3RyaW5nLmV4cGxvZGUoYXJnKSxmdW5jdGlvbihpKXtyZXN1bHQ9cmVzdWx0LmNvbmNhdCh1dGlsaXR5LmRvbSgiIyIrb2JqLmlkKyIgIitpKSl9KTtyZXR1cm4gcmVzdWx0fSxmcmFnOmZ1bmN0aW9uKGFyZyl7dmFyIG9iaj1kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7aWYoYXJnKXthcnJheS5lYWNoKGFycmF5LmNhc3QoZWxlbWVudC5jcmVhdGUoImRpdiIse2lubmVySFRNTDphcmd9LG9iaikuY2hpbGROb2RlcyksZnVuY3Rpb24oaSl7b2JqLmFwcGVuZENoaWxkKGkpfSk7b2JqLnJlbW92ZUNoaWxkKG9iai5jaGlsZE5vZGVzWzBdKX1yZXR1cm4gb2JqfSxoYXM6ZnVuY3Rpb24ob2JqLGFyZyl7dmFyIHJlc3VsdD1lbGVtZW50LmZpbmQob2JqLGFyZyk7cmV0dXJuIWlzTmFOKHJlc3VsdC5sZW5ndGgpJiZyZXN1bHQubGVuZ3RoPjB9LGhhc0NsYXNzOmZ1bmN0aW9uKG9iaiwKYXJnKXtyZXR1cm4gb2JqLmNsYXNzTGlzdC5jb250YWlucyhhcmcpfSxoaWRkZW46ZnVuY3Rpb24ob2JqKXtyZXR1cm4gb2JqLnN0eWxlLmRpc3BsYXk9PT0ibm9uZSJ8fHR5cGVvZiBvYmouaGlkZGVuPT0iYm9vbGVhbiImJm9iai5oaWRkZW59LGh0bWw6ZnVuY3Rpb24ob2JqLGFyZyl7aWYoYXJnPT09dW5kZWZpbmVkKXJldHVybiBvYmouaW5uZXJIVE1MO2Vsc2V7b2JqLmlubmVySFRNTD1hcmc7cmV0dXJuIG9ian19LGlzOmZ1bmN0aW9uKG9iaixhcmcpe2lmKHJlZ2V4LnNlbGVjdG9yX2lzLnRlc3QoYXJnKSlyZXR1cm4gZWxlbWVudC5maW5kKG9iai5wYXJlbnROb2RlLG9iai5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpK2FyZykuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpLmlkPT09b2JqLmlkfSkubGVuZ3RoPT09MTtlbHNlIHJldHVybihuZXcgUmVnRXhwKGFyZywiaSIpKS50ZXN0KG9iai5ub2RlTmFtZSl9LGtsYXNzOmZ1bmN0aW9uKG9iaixhcmcsYWRkKXthZGQ9YWRkIT09CmZhbHNlO2FyZz1zdHJpbmcuZXhwbG9kZShhcmcsIiAiKTtpZihhZGQpYXJyYXkuZWFjaChhcmcsZnVuY3Rpb24oaSl7b2JqLmNsYXNzTGlzdC5hZGQoaSl9KTtlbHNlIGFycmF5LmVhY2goYXJnLGZ1bmN0aW9uKGkpe2lmKGkhPT0iKiIpb2JqLmNsYXNzTGlzdC5yZW1vdmUoaSk7ZWxzZXthcnJheS5lYWNoKG9iai5jbGFzc0xpc3QsZnVuY3Rpb24oeCl7dGhpcy5yZW1vdmUoeCl9KTtyZXR1cm4gZmFsc2V9fSk7cmV0dXJuIG9ian0scG9zaXRpb246ZnVuY3Rpb24ob2JqKXtvYmo9b2JqfHxkb2N1bWVudC5ib2R5O3ZhciBsZWZ0LHRvcCxyaWdodCxib3R0b20saGVpZ2h0LHdpZHRoO2xlZnQ9dG9wPTA7d2lkdGg9b2JqLm9mZnNldFdpZHRoO2hlaWdodD1vYmoub2Zmc2V0SGVpZ2h0O2lmKG9iai5vZmZzZXRQYXJlbnQpe3RvcD1vYmoub2Zmc2V0VG9wO2xlZnQ9b2JqLm9mZnNldExlZnQ7d2hpbGUob2JqPW9iai5vZmZzZXRQYXJlbnQpe2xlZnQrPW9iai5vZmZzZXRMZWZ0O3RvcCs9b2JqLm9mZnNldFRvcH1yaWdodD0KZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aC0obGVmdCt3aWR0aCk7Ym90dG9tPWRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0LSh0b3AraGVpZ2h0KX1lbHNle3JpZ2h0PXdpZHRoO2JvdHRvbT1oZWlnaHR9cmV0dXJuW2xlZnQsdG9wLHJpZ2h0LGJvdHRvbV19LHByZXBlbmRDaGlsZDpmdW5jdGlvbihvYmosY2hpbGQpe3JldHVybiBvYmouY2hpbGROb2Rlcy5sZW5ndGg9PT0wP29iai5hcHBlbmRDaGlsZChjaGlsZCk6b2JqLmluc2VydEJlZm9yZShjaGlsZCxvYmouY2hpbGROb2Rlc1swXSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24ob2JqLGtleSl7dmFyIHRhcmdldDtpZihyZWdleC5zdmcudGVzdChvYmoubmFtZXNwYWNlVVJJKSlvYmoucmVtb3ZlQXR0cmlidXRlTlMob2JqLm5hbWVzcGFjZVVSSSxrZXkpO2Vsc2UgaWYob2JqLm5vZGVOYW1lPT09IlNFTEVDVCImJmtleT09PSJzZWxlY3RlZCIpe3RhcmdldD11dGlsaXR5LmRvbSgiIyIrb2JqLmlkKycgb3B0aW9uW3NlbGVjdGVkPSJzZWxlY3RlZCJdJylbMF07CmlmKHRhcmdldCl7dGFyZ2V0LnNlbGVjdGVkPWZhbHNlO3RhcmdldC5yZW1vdmVBdHRyaWJ1dGUoInNlbGVjdGVkIil9fWVsc2Ugb2JqLnJlbW92ZUF0dHJpYnV0ZShrZXkpO3JldHVybiBvYmp9LHNjcm9sbFRvOmZ1bmN0aW9uKG9iaixtcyxvZmZzZXRUb3Asb2Zmc2V0TGVmdCl7dmFyIHBvcz1hcnJheS5yZW1vdmUoZWxlbWVudC5wb3NpdGlvbihvYmopLDIsMyk7aWYoIWlzTmFOKG9mZnNldFRvcCkpcG9zWzBdKz1vZmZzZXRUb3A7aWYoIWlzTmFOKG9mZnNldExlZnQpKXBvc1sxXSs9b2Zmc2V0TGVmdDtyZXR1cm4gY2xpZW50LnNjcm9sbChwb3MsbXMpfSxzZXJpYWxpemU6ZnVuY3Rpb24ob2JqLHN0cmluZyxlbmNvZGUpe3N0cmluZz1zdHJpbmc9PT10cnVlO2VuY29kZT1lbmNvZGUhPT1mYWxzZTt2YXIgcmVnaXN0cnk9e30sY2hpbGRyZW4scmVzdWx0O2NoaWxkcmVuPW9iai5ub2RlTmFtZT09PSJGT1JNIj9vYmouZWxlbWVudHM/YXJyYXkuY2FzdChvYmouZWxlbWVudHMpOm9iai5maW5kKCJidXR0b24sIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhIik6CltvYmpdO2FycmF5LmVhY2goY2hpbGRyZW4sZnVuY3Rpb24oaSl7dmFyIGlkPWkuaWR8fGkubmFtZXx8aS50eXBlO2lmKGkubm9kZU5hbWU9PT0iRk9STSIpdXRpbGl0eS5tZXJnZShyZWdpc3RyeSxqc29uLmRlY29kZShlbGVtZW50LnNlcmlhbGl6ZShpKSkpO2Vsc2UgaWYoIXJlZ2lzdHJ5W2lkXSlyZWdpc3RyeVtpZF09ZWxlbWVudC52YWwoaSl9KTtpZighc3RyaW5nKXJlc3VsdD1yZWdpc3RyeTtlbHNle3Jlc3VsdD0iIjt1dGlsaXR5Lml0ZXJhdGUocmVnaXN0cnksZnVuY3Rpb24odixrKXtlbmNvZGU/cmVzdWx0Kz0iJiIrZW5jb2RlVVJJQ29tcG9uZW50KGspKyI9IitlbmNvZGVVUklDb21wb25lbnQodik6cmVzdWx0Kz0iJiIraysiPSIrdn0pO3Jlc3VsdD1yZXN1bHQucmVwbGFjZShyZWdleC5hbmQsIj8iKX1yZXR1cm4gcmVzdWx0fSxzaXplOmZ1bmN0aW9uKG9iail7cmV0dXJuW29iai5vZmZzZXRXaWR0aCtudW1iZXIucGFyc2Uob2JqLnN0eWxlLnBhZGRpbmdMZWZ0fHwwKSsKbnVtYmVyLnBhcnNlKG9iai5zdHlsZS5wYWRkaW5nUmlnaHR8fDApK251bWJlci5wYXJzZShvYmouc3R5bGUuYm9yZGVyTGVmdHx8MCkrbnVtYmVyLnBhcnNlKG9iai5zdHlsZS5ib3JkZXJSaWdodHx8MCksb2JqLm9mZnNldEhlaWdodCtudW1iZXIucGFyc2Uob2JqLnN0eWxlLnBhZGRpbmdUb3B8fDApK251bWJlci5wYXJzZShvYmouc3R5bGUucGFkZGluZ0JvdHRvbXx8MCkrbnVtYmVyLnBhcnNlKG9iai5zdHlsZS5ib3JkZXJUb3B8fDApK251bWJlci5wYXJzZShvYmouc3R5bGUuYm9yZGVyQm90dG9tfHwwKV19LHRleHQ6ZnVuY3Rpb24ob2JqLGFyZyl7dmFyIGtleT1vYmoudGV4dENvbnRlbnQ/InRleHRDb250ZW50IjoiaW5uZXJUZXh0IixwYXlsb2FkPXt9LHNldD1mYWxzZTtpZih0eXBlb2YgYXJnIT0idW5kZWZpbmVkIil7c2V0PXRydWU7cGF5bG9hZFtrZXldPWFyZ31yZXR1cm4gc2V0P2VsZW1lbnQudXBkYXRlKG9iaixwYXlsb2FkKTpvYmpba2V5XX0sdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24ob2JqLAphcmcpe29iai5jbGFzc0xpc3QudG9nZ2xlKGFyZyk7cmV0dXJuIG9ian0sdXBkYXRlOmZ1bmN0aW9uKG9iaixhcmdzKXt1dGlsaXR5Lml0ZXJhdGUoYXJncyxmdW5jdGlvbih2LGspe2lmKHJlZ2V4LmVsZW1lbnRfdXBkYXRlLnRlc3Qoaykpb2JqW2tdPXY7ZWxzZSBpZihrPT09ImNsYXNzIikhc3RyaW5nLmlzRW1wdHkodik/ZWxlbWVudC5rbGFzcyhvYmosdik6ZWxlbWVudC5rbGFzcyhvYmosIioiLGZhbHNlKTtlbHNlIGlmKGsuaW5kZXhPZigiZGF0YS0iKT09PTApZWxlbWVudC5kYXRhKG9iaixrLnJlcGxhY2UoImRhdGEtIiwiIiksdik7ZWxzZSBlbGVtZW50LmF0dHIob2JqLGssdil9KTtyZXR1cm4gb2JqfSx2YWw6ZnVuY3Rpb24ob2JqLHZhbHVlKXt2YXIgZXY9ImlucHV0IixvdXRwdXQ7aWYodmFsdWU9PT11bmRlZmluZWQpe2lmKHJlZ2V4LnJhZGlvX2NoZWNrYm94LnRlc3Qob2JqLnR5cGUpKXtpZihzdHJpbmcuaXNFbXB0eShvYmoubmFtZSkpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmV4cGVjdGVkUHJvcGVydHkpOwphcnJheS5lYWNoKHV0aWxpdHkuZG9tKCJpbnB1dFtuYW1lPSciK29iai5uYW1lKyInXSIpLGZ1bmN0aW9uKGkpe2lmKGkuY2hlY2tlZCl7b3V0cHV0PWkudmFsdWU7cmV0dXJuIGZhbHNlfX0pfWVsc2UgaWYocmVnZXguc2VsZWN0LnRlc3Qob2JqLnR5cGUpKW91dHB1dD1vYmoub3B0aW9uc1tvYmouc2VsZWN0ZWRJbmRleF0udmFsdWU7ZWxzZSBpZihvYmoudmFsdWUpb3V0cHV0PW9iai52YWx1ZTtlbHNlIG91dHB1dD1lbGVtZW50LnRleHQob2JqKTtpZihvdXRwdXQhPT11bmRlZmluZWQpe291dHB1dD11dGlsaXR5LmNvZXJjZShvdXRwdXQpO2lmKHR5cGVvZiBvdXRwdXQ9PSJzdHJpbmciKW91dHB1dD1zdHJpbmcudHJpbShvdXRwdXQpfWVsc2Ugb3V0cHV0PSIifWVsc2V7dmFsdWU9dmFsdWUudG9TdHJpbmcoKTtpZihyZWdleC5yYWRpb19jaGVja2JveC50ZXN0KG9iai50eXBlKSl7ZXY9ImNsaWNrIjthcnJheS5lYWNoKHV0aWxpdHkuZG9tKCJpbnB1dFtuYW1lPSciK29iai5uYW1lKwoiJ10iKSxmdW5jdGlvbihpKXtpZihpLnZhbHVlPT09dmFsdWUpe2kuY2hlY2tlZD10cnVlO291dHB1dD1pO3JldHVybiBmYWxzZX19KX1lbHNlIGlmKHJlZ2V4LnNlbGVjdC50ZXN0KG9iai50eXBlKSl7ZXY9ImNoYW5nZSI7YXJyYXkuZWFjaChlbGVtZW50LmZpbmQob2JqLCI+ICoiKSxmdW5jdGlvbihpKXtpZihpLnZhbHVlPT09dmFsdWUpe2kuc2VsZWN0ZWQ9dHJ1ZTtvdXRwdXQ9aTtyZXR1cm4gZmFsc2V9fSl9ZWxzZSBvYmoudmFsdWUhPT11bmRlZmluZWQ/b2JqLnZhbHVlPXZhbHVlOmVsZW1lbnQudGV4dChvYmosdmFsdWUpO2VsZW1lbnQuZGlzcGF0Y2gob2JqLGV2KTtvdXRwdXQ9b2JqfXJldHVybiBvdXRwdXR9fTt2YXIganNvbj17ZGVjb2RlOmZ1bmN0aW9uKGFyZyxzaWxlbnQpe3RyeXtyZXR1cm4gSlNPTi5wYXJzZShhcmcpfWNhdGNoKGUpe2lmKHNpbGVudCE9PXRydWUpdXRpbGl0eS5lcnJvcihlLGFyZ3VtZW50cyx0aGlzKTtyZXR1cm4gdW5kZWZpbmVkfX0sZW5jb2RlOmZ1bmN0aW9uKGFyZywKc2lsZW50KXt0cnl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KGFyZyl9Y2F0Y2goZSl7aWYoc2lsZW50IT09dHJ1ZSl1dGlsaXR5LmVycm9yKGUsYXJndW1lbnRzLHRoaXMpO3JldHVybiB1bmRlZmluZWR9fX07dmFyIGxhYmVsPXtleHBlY3RlZE51bWJlcjoiRXhwZWN0ZWQgYSBOdW1iZXIiLGV4cGVjdGVkUHJvcGVydHk6IkV4cGVjdGVkIGEgcHJvcGVydHksIGFuZCBpdCB3YXMgbm90IHNldCIsZXhwZWN0ZWRPYmplY3Q6IkV4cGVjdGVkIGFuIE9iamVjdCIsaW52YWxpZEFyZ3VtZW50czoiT25lIG9yIG1vcmUgYXJndW1lbnRzIGlzIGludmFsaWQiLGludmFsaWRTdGF0ZU5vSGVhZGVyczoiSU5WQUxJRF9TVEFURV9FUlI6IEhlYWRlcnMgaGF2ZSBub3QgYmVlbiByZWNlaXZlZCIsaW52YWxpZFN0YXRlTm9TeW5jOiJTeW5jaHJvbm91cyBYTUxIdHRwUmVxdWVzdCByZXF1ZXN0cyBhcmUgbm90IHN1cHBvcnRlZCIsaW52YWxpZFN0YXRlTm90T3BlbjoiSU5WQUxJRF9TVEFURV9FUlI6IE9iamVjdCBpcyBub3Qgb3BlbiIsCmludmFsaWRTdGF0ZU5vdFNlbmRpbmc6IklOVkFMSURfU1RBVEVfRVJSOiBPYmplY3QgaXMgc2VuZGluZyIsaW52YWxpZFN0YXRlTm90VXNhYmxlOiJJTlZBTElEX1NUQVRFX0VSUjogT2JqZWN0IGlzIG5vdCB1c2FibGUiLG5vRGF0YToiTm90aGluZyB0byBkaXNwbGF5Iixub3RBdmFpbGFibGU6IlJlcXVlc3RlZCBtZXRob2QgaXMgbm90IGF2YWlsYWJsZSIsZGF0YXN0b3JlTm9QcmV2VmVyc2lvbjoiTm8gcHJldmlvdXMgdmVyc2lvbiBmb3VuZCIsc2VydmVyRXJyb3I6IlNlcnZlciBlcnJvciBoYXMgb2NjdXJyZWQiLHNlcnZlckZvcmJpZGRlbjoiRm9yYmlkZGVuIHRvIGFjY2VzcyBVUkkiLHNlcnZlckludmFsaWRNZXRob2Q6Ik1ldGhvZCBub3QgYWxsb3dlZCIsc2VydmVyVW5hdXRob3JpemVkOiJBdXRob3JpemF0aW9uIHJlcXVpcmVkIHRvIGFjY2VzcyBVUkkiLHVwZ3JhZGU6IllvdXIgYnJvd3NlciBpcyB0b28gb2xkIHRvIHVzZSBrZWlnYWksIHBsZWFzZSB1cGdyYWRlIn07dmFyIG1hdGg9CntiZXppZXI6ZnVuY3Rpb24oKXt2YXIgYT1hcnJheS5jYXN0KGFyZ3VtZW50cyksdD1hLnBvcCgpLFA9YXJyYXkuY2h1bmsoYSwyKSxuPVAubGVuZ3RoLGMsUzAsUTAsUTEsUTIsQzAsQzEsQzIsQzM7aWYobjwyfHxuPjQpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO2M9W107UzA9MS10O1EwPW1hdGguc3FyKFMwKTtRMT0yKlMwKnQ7UTI9bWF0aC5zcXIodCk7QzA9TWF0aC5wb3coUzAsMyk7QzE9MypRMCp0O0MyPTMqUzAqUTI7QzM9TWF0aC5wb3codCwzKTtpZihuPT09Mil7Yy5wdXNoKFMwKlBbMF1bMF0rdCpQWzFdWzBdKTtjLnB1c2goUzAqUFswXVsxXSt0KlBbMV1bMV0pfWVsc2UgaWYobj09PTMpe2MucHVzaChRMCpQWzBdWzBdK1ExKlBbMV1bMF0rKFEyK1BbMl1bMF0pKTtjLnB1c2goUTAqUFswXVsxXStRMSpQWzFdWzFdKyhRMitQWzJdWzFdKSl9ZWxzZSBpZihuPT09NCl7Yy5wdXNoKEMwKlBbMF1bMF0rQzEqUFsxXVswXStDMipQWzJdWzBdK0MzKgpQWzNdWzBdKTtjLnB1c2goQzAqUFswXVsxXStDMSpQWzFdWzFdK0MyKlBbMl1bMV0rQzMqUFszXVsxXSl9cmV0dXJuIGN9LGRpc3Q6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTWF0aC5zcXJ0KG1hdGguc3FyKGJbMF0tYVswXSkrbWF0aC5zcXIoYlsxXS1hWzFdKSl9LHNxcjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC5wb3cobiwyKX19O3ZhciBudW1iZXI9e2RpZmY6ZnVuY3Rpb24obnVtMSxudW0yKXtpZihpc05hTihudW0xKXx8aXNOYU4obnVtMikpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmV4cGVjdGVkTnVtYmVyKTtyZXR1cm4gTWF0aC5hYnMobnVtMS1udW0yKX0sZXZlbjpmdW5jdGlvbihhcmcpe3JldHVybiBhcmclMj09PTB9LGZvcm1hdDpmdW5jdGlvbihhcmcsZGVsaW1pdGVyLGV2ZXJ5KXtpZihpc05hTihhcmcpKXRocm93IG5ldyBFcnJvcihsYWJlbC5leHBlY3RlZE51bWJlcik7YXJnPWFyZy50b1N0cmluZygpO2RlbGltaXRlcj1kZWxpbWl0ZXJ8fCIsIjtldmVyeT1ldmVyeXx8CjM7dmFyIGQ9YXJnLmluZGV4T2YoIi4iKT4tMT8iLiIrYXJnLnJlcGxhY2UocmVnZXgubnVtYmVyX2Zvcm1hdF8xLCIiKToiIixhPWFyZy5yZXBsYWNlKHJlZ2V4Lm51bWJlcl9mb3JtYXRfMiwiIikuc3BsaXQoIiIpLnJldmVyc2UoKSxwPU1hdGguZmxvb3IoYS5sZW5ndGgvZXZlcnkpLGk9MSxuLGI7Zm9yKGI9MDtiPHA7YisrKXtuPWk9PT0xP2V2ZXJ5OmV2ZXJ5KmkrKGk9PT0yPzE6aS0xKTthLnNwbGljZShuLDAsZGVsaW1pdGVyKTtpKyt9YT1hLnJldmVyc2UoKS5qb2luKCIiKTtpZihhLmNoYXJBdCgwKT09PWRlbGltaXRlcilhPWEuc3Vic3RyaW5nKDEpO3JldHVybiBhK2R9LGhhbGY6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9hL2I9PT0uNTphLzJ9LG9kZDpmdW5jdGlvbihhcmcpe3JldHVybiFudW1iZXIuZXZlbihhcmcpfSxwYXJzZTpmdW5jdGlvbihhcmcsYmFzZSl7cmV0dXJuIGJhc2U9PT11bmRlZmluZWQ/cGFyc2VGbG9hdChhcmcpOnBhcnNlSW50KGFyZyxiYXNlKX0scmFuZG9tOmZ1bmN0aW9uKGFyZyl7YXJnPQphcmd8fDEwMDtyZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihhcmcrMSkpfSxyb3VuZDpmdW5jdGlvbihhcmcsZGlyZWN0aW9uKXthcmc9bnVtYmVyLnBhcnNlKGFyZyk7aWYoZGlyZWN0aW9uPT09dW5kZWZpbmVkfHxzdHJpbmcuaXNFbXB0eShkaXJlY3Rpb24pKXJldHVybiBudW1iZXIucGFyc2UoYXJnLnRvRml4ZWQoMCkpO2Vsc2UgaWYocmVnZXguZG93bi50ZXN0KGRpcmVjdGlvbikpcmV0dXJufn5hcmc7ZWxzZSByZXR1cm4gTWF0aC5jZWlsKGFyZyl9fTt2YXIgcHJvbWlzZT17ZmFjdG9yeTpmdW5jdGlvbigpe3ZhciBwcm9taXNlLHBDYXRjaCxwUmVzb2x2ZSxwUmVqZWN0LHBUaGVuO3Byb21pc2U9bmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSxyZWplY3Qpe3BSZXNvbHZlPXJlc29sdmU7cFJlamVjdD1yZWplY3R9KTtwQ2F0Y2g9ZnVuY3Rpb24oKXtyZXR1cm4gcHJvbWlzZVsiY2F0Y2giXS5hcHBseShwcm9taXNlLGFyZ3VtZW50cyl9O3BUaGVuPWZ1bmN0aW9uKCl7cmV0dXJuIHByb21pc2UudGhlbi5hcHBseShwcm9taXNlLAphcmd1bWVudHMpfTtyZXR1cm57ImNhdGNoIjpwQ2F0Y2gscmVzb2x2ZTpwUmVzb2x2ZSxyZWplY3Q6cFJlamVjdCx0aGVuOnBUaGVufX19O3ZhciBzdG9yZT17ZmFjdG9yeTpmdW5jdGlvbihyZWNzLGFyZ3Mpe3ZhciBvYmo9bmV3IERhdGFTdG9yZTtpZihhcmdzIGluc3RhbmNlb2YgT2JqZWN0KXV0aWxpdHkubWVyZ2Uob2JqLGFyZ3MpO2lmKHJlY3MhPT1udWxsJiZ0eXBlb2YgcmVjcz09Im9iamVjdCIpb2JqLmJhdGNoKCJzZXQiLHJlY3MpO3JldHVybiBvYmp9LHdvcmtlcjpmdW5jdGlvbihldil7dmFyIGNtZD1ldi5kYXRhLmNtZCxyZWNvcmRzPWV2LmRhdGEucmVjb3JkcyxjbGF1c2VzLGNvbmQsZnVuY3Rpb25zLGluZGV4ZXMsaW5kZXgscmVzdWx0LHNvcnRlZCx3aGVyZSx2YWx1ZXM7aWYoY21kPT09InNlbGVjdCIpe3doZXJlPUpTT04ucGFyc2UoZXYuZGF0YS53aGVyZSk7ZnVuY3Rpb25zPWV2LmRhdGEuZnVuY3Rpb25zO2NsYXVzZXM9YXJyYXkuZnJvbU9iamVjdCh3aGVyZSk7CnNvcnRlZD1hcnJheS5mbGF0KGNsYXVzZXMpLmZpbHRlcihmdW5jdGlvbihpLGlkeCl7cmV0dXJuIGlkeCUyPT09MH0pLnNvcnQoYXJyYXkuc29ydCk7aW5kZXg9c29ydGVkLmpvaW4oInwiKTt2YWx1ZXM9c29ydGVkLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gd2hlcmVbaV19KS5qb2luKCJ8Iik7aW5kZXhlcz1ldi5kYXRhLmluZGV4ZXM7Y29uZD0icmV0dXJuICggIjtpZihmdW5jdGlvbnMubGVuZ3RoPT09MCYmaW5kZXhlc1tpbmRleF0pcmVzdWx0PShpbmRleGVzW2luZGV4XVt2YWx1ZXNdfHxbXSkubWFwKGZ1bmN0aW9uKGkpe3JldHVybiByZWNvcmRzW2ldfSk7ZWxzZXtpZihjbGF1c2VzLmxlbmd0aD4xKWFycmF5LmVhY2goY2xhdXNlcyxmdW5jdGlvbihpLGlkeCl7dmFyIGIxPSIoICI7aWYoaWR4PjApYjE9IiAmJiAoICI7aWYoYXJyYXkuY29udGFpbnMoZnVuY3Rpb25zLGlbMF0pKWNvbmQrPWIxK2lbMV0rJyggcmVjLmRhdGFbIicraVswXSsnIl0gKSApJztlbHNlIGlmKCFpc05hTihpWzFdKSljb25kKz0KYjErJ3JlYy5kYXRhWyInK2lbMF0rJyJdID09PSAnK2lbMV0rIiApIjtlbHNlIGNvbmQrPWIxKydyZWMuZGF0YVsiJytpWzBdKyciXSA9PT0gIicraVsxXSsnIiApJ30pO2Vsc2UgaWYoYXJyYXkuY29udGFpbnMoZnVuY3Rpb25zLGNsYXVzZXNbMF1bMF0pKWNvbmQrPWNsYXVzZXNbMF1bMV0rJyggcmVjLmRhdGFbIicrY2xhdXNlc1swXVswXSsnIl0gKSc7ZWxzZSBpZighaXNOYU4oY2xhdXNlc1swXVsxXSkpY29uZCs9J3JlYy5kYXRhWyInK2NsYXVzZXNbMF1bMF0rJyJdID09PSAnK2NsYXVzZXNbMF1bMV07ZWxzZSBjb25kKz0ncmVjLmRhdGFbIicrY2xhdXNlc1swXVswXSsnIl0gPT09ICInK2NsYXVzZXNbMF1bMV0rJyInO2NvbmQrPSIgKTsiO3Jlc3VsdD1yZWNvcmRzLmZpbHRlcihuZXcgRnVuY3Rpb24oInJlYyIsY29uZCkpfX1lbHNlIGlmKGNtZD09PSJzb3J0IilyZXN1bHQ9YXJyYXkua2V5U29ydChyZWNvcmRzLGV2LmRhdGEucXVlcnksImRhdGEiKTtwb3N0TWVzc2FnZShyZXN1bHQpfX07CmZ1bmN0aW9uIERhdGFTdG9yZSgpe3RoaXMuYXV0b3NhdmU9ZmFsc2U7dGhpcy5jYWxsYmFjaz1udWxsO3RoaXMuY3JlZGVudGlhbHM9bnVsbDt0aGlzLmxpc3RzPVtdO3RoaXMuZXZlbnRzPXRydWU7dGhpcy5leHBpcmVzPW51bGw7dGhpcy5oZWFkZXJzPXtBY2NlcHQ6ImFwcGxpY2F0aW9uL2pzb24ifTt0aGlzLmlnbm9yZT1bXTt0aGlzLmluZGV4PVtdO3RoaXMuaW5kZXhlcz17a2V5Ont9fTt0aGlzLmtleT1udWxsO3RoaXMubG9hZGVkPWZhbHNlO3RoaXMubW9uZ29kYj0iIjt0aGlzLm9ic2VydmVyPW9ic2VydmFibGUuZmFjdG9yeSgpO3RoaXMucmVjb3Jkcz1bXTt0aGlzLnNvdXJjZT1udWxsO3RoaXMudG90YWw9MDt0aGlzLnZlcnNpb25zPXt9O3RoaXMudmVyc2lvbmluZz10cnVlO3RoaXMudmlld3M9e307dGhpcy51cmk9bnVsbH1EYXRhU3RvcmUucHJvdG90eXBlPWJhc2UuZmFjdG9yeSgpO0RhdGFTdG9yZS5wcm90b3R5cGUuY29uc3RydWN0b3I9RGF0YVN0b3JlO0RhdGFTdG9yZS5wcm90b3R5cGUuYmF0Y2g9CmZ1bmN0aW9uKHR5cGUsZGF0YSxzeW5jKXtzeW5jPXN5bmM9PT10cnVlO3ZhciBzZWxmPXRoaXMsZXZlbnRzPXRoaXMuZXZlbnRzLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSxkZWZlcnJlZHM9W107aWYoIXJlZ2V4LnNldF9kZWwudGVzdCh0eXBlKXx8c3luYyYmcmVnZXguZGVsLnRlc3QodHlwZSl8fHR5cGVvZiBkYXRhIT0ib2JqZWN0IilkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpKTtlbHNle2lmKGV2ZW50cyl0aGlzLmRpc3BhdGNoKCJiZWZvcmVCYXRjaCIsZGF0YSk7aWYoc3luYyl0aGlzLmNsZWFyKHN5bmMpO2lmKGRhdGEubGVuZ3RoPT09MCl7dGhpcy5sb2FkZWQ9dHJ1ZTtpZihldmVudHMpdGhpcy5kaXNwYXRjaCgiYWZ0ZXJCYXRjaCIsdGhpcy5yZWNvcmRzKTtkZWZlci5yZXNvbHZlKHRoaXMucmVjb3Jkcyl9ZWxzZXtpZih0eXBlPT09ImRlbCIpYXJyYXkuZWFjaChkYXRhLGZ1bmN0aW9uKGkpe2RlZmVycmVkcy5wdXNoKHNlbGYuZGVsKGksCmZhbHNlLHRydWUpKX0pO2Vsc2UgYXJyYXkuZWFjaChkYXRhLGZ1bmN0aW9uKGkpe2RlZmVycmVkcy5wdXNoKHNlbGYuc2V0KG51bGwsaSx0cnVlKSl9KTt0aGlzLmxvYWRlZD1mYWxzZTt1dGlsaXR5LndoZW4oZGVmZXJyZWRzKS50aGVuKGZ1bmN0aW9uKGFyZ3Mpe3NlbGYubG9hZGVkPXRydWU7aWYoZXZlbnRzKXNlbGYuZGlzcGF0Y2goImFmdGVyQmF0Y2giLGFyZ3MpO2FycmF5LmVhY2goc2VsZi5saXN0cyxmdW5jdGlvbihpKXtpLnJlZnJlc2godHJ1ZSl9KTtpZih0eXBlPT09ImRlbCIpe3NlbGYucmVjb3Jkcz1hcnJheS5jb21wYWN0KHNlbGYucmVjb3Jkcyk7c2VsZi5yZWluZGV4KCl9aWYoc2VsZi5hdXRvc2F2ZSlzZWxmLnNhdmUoKTtkZWZlci5yZXNvbHZlKGFyZ3MpfSxmdW5jdGlvbihlKXtpZihldmVudHMpc2VsZi5kaXNwYXRjaCgiZmFpbGVkQmF0Y2giLGUpO2RlZmVyLnJlamVjdChlKX0pfX1yZXR1cm4gZGVmZXJ9O0RhdGFTdG9yZS5wcm90b3R5cGUuYnVpbGRVcmk9ZnVuY3Rpb24oa2V5KXt2YXIgcGFyc2VkPQp1dGlsaXR5LnBhcnNlKHRoaXMudXJpKTtyZXR1cm4gcGFyc2VkLnByb3RvY29sKyIvLyIrcGFyc2VkLmhvc3QrcGFyc2VkLnBhdGhuYW1lKyhyZWdleC5lbmRzbGFzaC50ZXN0KHBhcnNlZC5wYXRobmFtZSk/IiI6Ii8iKStrZXl9O0RhdGFTdG9yZS5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oc3luYyl7c3luYz1zeW5jPT09dHJ1ZTt2YXIgZXZlbnRzPXRoaXMuZXZlbnRzPT09dHJ1ZSxyZXNhdmU9dGhpcy5hdXRvc2F2ZT09PXRydWU7aWYoIXN5bmMpe2lmKGV2ZW50cyl0aGlzLmRpc3BhdGNoKCJiZWZvcmVDbGVhciIpO2FycmF5LmVhY2godGhpcy5saXN0cyxmdW5jdGlvbihpKXtpZihpKWkudGVhcmRvd24odHJ1ZSl9KTt0aGlzLmF1dG9zYXZlPWZhbHNlO3RoaXMuY2FsbGJhY2s9bnVsbDt0aGlzLmNyZWRlbnRpYWxzPW51bGw7dGhpcy5saXN0cz1bXTt0aGlzLmV2ZW50cz10cnVlO3RoaXMuZXhwaXJlcz1udWxsO3RoaXMuaGVhZGVycz17QWNjZXB0OiJhcHBsaWNhdGlvbi9qc29uIn07CnRoaXMuaWdub3JlPVtdO3RoaXMuaW5kZXg9W107dGhpcy5pbmRleGVzPXtrZXk6e319O3RoaXMua2V5PW51bGw7dGhpcy5sb2FkZWQ9ZmFsc2U7dGhpcy5yZWNvcmRzPVtdO3RoaXMuc291cmNlPW51bGw7dGhpcy50b3RhbD0wO3RoaXMudmVyc2lvbnM9e307dGhpcy52ZXJzaW9uaW5nPXRydWU7dGhpcy52aWV3cz17fTt0aGlzLnVyaT1udWxsO2lmKGV2ZW50cyl0aGlzLmRpc3BhdGNoKCJhZnRlckNsZWFyIil9ZWxzZXt0aGlzLmluZGV4ZXM9e2tleTp7fX07dGhpcy5sb2FkZWQ9ZmFsc2U7dGhpcy5yZWNvcmRzPVtdO3RoaXMudG90YWw9MDt0aGlzLnZpZXdzPXt9O2FycmF5LmVhY2godGhpcy5saXN0cyxmdW5jdGlvbihpKXtpZihpKWkucmVmcmVzaCgpfSl9aWYocmVzYXZlKXRoaXMuc2F2ZSgpO3JldHVybiB0aGlzfTtEYXRhU3RvcmUucHJvdG90eXBlLmRlbD1mdW5jdGlvbihyZWNvcmQscmVpbmRleCxiYXRjaCl7cmVjb3JkPXJlY29yZC5rZXk/cmVjb3JkOnRoaXMuZ2V0KHJlY29yZCk7CnJlaW5kZXg9cmVpbmRleCE9PWZhbHNlO2JhdGNoPWJhdGNoPT09dHJ1ZTt2YXIgc2VsZj10aGlzLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKTtpZihyZWNvcmQ9PT11bmRlZmluZWQpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKSk7ZWxzZXtpZih0aGlzLmV2ZW50cylzZWxmLmRpc3BhdGNoKCJiZWZvcmVEZWxldGUiLHJlY29yZCk7aWYodGhpcy51cmk9PT1udWxsfHx0aGlzLmNhbGxiYWNrIT09bnVsbCl0aGlzLmRlbENvbXBsZXRlKHJlY29yZCxyZWluZGV4LGJhdGNoLGRlZmVyKTtlbHNlIGNsaWVudC5yZXF1ZXN0KHRoaXMuYnVpbGRVcmkocmVjb3JkLmtleSksIkRFTEVURSIsbnVsbCx1dGlsaXR5Lm1lcmdlKHt3aXRoQ3JlZGVudGlhbHM6dGhpcy5jcmVkZW50aWFsc30sdGhpcy5oZWFkZXJzKSkudGhlbihmdW5jdGlvbigpe3NlbGYuZGVsQ29tcGxldGUocmVjb3JkLHJlaW5kZXgsYmF0Y2gsZGVmZXIpfSxmdW5jdGlvbihlKXtzZWxmLmRpc3BhdGNoKCJmYWlsZWREZWxldGUiLAplKTtkZWZlci5yZWplY3QoZSl9KX1yZXR1cm4gZGVmZXJ9O0RhdGFTdG9yZS5wcm90b3R5cGUuZGVsQ29tcGxldGU9ZnVuY3Rpb24ocmVjb3JkLHJlaW5kZXgsYmF0Y2gsZGVmZXIpe3ZhciBzZWxmPXRoaXM7ZGVsZXRlIHRoaXMuaW5kZXhlcy5rZXlbcmVjb3JkLmtleV07ZGVsZXRlIHRoaXMudmVyc2lvbnNbcmVjb3JkLmtleV07dGhpcy50b3RhbC0tO3RoaXMudmlld3M9e307aWYoIWJhdGNoKXthcnJheS5yZW1vdmUodGhpcy5yZWNvcmRzLHJlY29yZC5pbmRleCk7aWYocmVpbmRleCl0aGlzLnJlaW5kZXgoKTtlbHNlIGFycmF5LmVhY2gocmVjb3JkLmluZGV4ZXMsZnVuY3Rpb24oaSl7YXJyYXkucmVtb3ZlKHNlbGYuaW5kZXhlc1tpWzBdXVtpWzFdXSxyZWNvcmQuaW5kZXgpO2lmKHNlbGYuaW5kZXhlc1tpWzBdXVtpWzFdXS5sZW5ndGg9PT0wKWRlbGV0ZSBzZWxmLmluZGV4ZXNbaVswXV1baVsxXV19KTtpZih0aGlzLmF1dG9zYXZlKXRoaXMucHVyZ2UocmVjb3JkLmtleSk7aWYodGhpcy5ldmVudHMpdGhpcy5kaXNwYXRjaCgiYWZ0ZXJEZWxldGUiLApyZWNvcmQpO2FycmF5LmVhY2godGhpcy5saXN0cyxmdW5jdGlvbihpKXtpLnJlZnJlc2goKX0pfWVsc2UgdGhpcy5yZWNvcmRzW3JlY29yZC5pbmRleF09bnVsbDtyZXR1cm4gZGVmZXIucmVzb2x2ZShyZWNvcmQua2V5KX07RGF0YVN0b3JlLnByb3RvdHlwZS5kdW1wPWZ1bmN0aW9uKGFyZ3MsZmllbGRzKXthcmdzPWFyZ3N8fHRoaXMucmVjb3Jkczt2YXIgc2VsZj10aGlzLGN1c3RvbT1maWVsZHMgaW5zdGFuY2VvZiBBcnJheSYmZmllbGRzLmxlbmd0aD4wLGtleT10aGlzLmtleSE9PW51bGwsZm47aWYoY3VzdG9tKWZuPWZ1bmN0aW9uKGkpe3ZhciByZWNvcmQ9e307YXJyYXkuZWFjaChmaWVsZHMsZnVuY3Rpb24oZil7cmVjb3JkW2ZdPWY9PT1zZWxmLmtleT9pc05hTihpLmtleSk/aS5rZXk6TnVtYmVyKGkua2V5KTp1dGlsaXR5LmNsb25lKGkuZGF0YVtmXSx0cnVlKX0pO3JldHVybiByZWNvcmR9O2Vsc2UgZm49ZnVuY3Rpb24oaSl7dmFyIHJlY29yZD17fTtpZihrZXkpcmVjb3JkW3NlbGYua2V5XT0KaXNOYU4oaS5rZXkpP2kua2V5Ok51bWJlcihpLmtleSk7dXRpbGl0eS5pdGVyYXRlKGkuZGF0YSxmdW5jdGlvbih2LGspe3JlY29yZFtrXT11dGlsaXR5LmNsb25lKHYsdHJ1ZSl9KTtyZXR1cm4gcmVjb3JkfTtyZXR1cm4gYXJncy5tYXAoZm4pfTtEYXRhU3RvcmUucHJvdG90eXBlLmdldD1mdW5jdGlvbihyZWNvcmQsb2Zmc2V0KXt2YXIgdHlwZT10eXBlb2YgcmVjb3JkLHNlbGY9dGhpcyxyZXN1bHQ7aWYodHlwZT09PSJ1bmRlZmluZWQiKXJlc3VsdD10aGlzLnJlY29yZHM7ZWxzZSBpZih0eXBlPT09InN0cmluZyIpaWYocmVjb3JkLmluZGV4T2YoIiwiKT09PS0xKXJlc3VsdD10aGlzLnJlY29yZHNbdGhpcy5pbmRleGVzLmtleVtyZWNvcmRdXTtlbHNlIHJlc3VsdD1zdHJpbmcuZXhwbG9kZShyZWNvcmQpLm1hcChmdW5jdGlvbihpKXtpZighaXNOYU4oaSkpcmV0dXJuIHNlbGYucmVjb3Jkc1twYXJzZUludChpLDEwKV07ZWxzZSByZXR1cm4gc2VsZi5yZWNvcmRzW3NlbGYuaW5kZXhlcy5rZXlbaV1dfSk7CmVsc2UgaWYodHlwZT09PSJudW1iZXIiKWlmKGlzTmFOKG9mZnNldCkpcmVzdWx0PXRoaXMucmVjb3Jkc1twYXJzZUludChyZWNvcmQsMTApXTtlbHNlIHJlc3VsdD1hcnJheS5saW1pdCh0aGlzLnJlY29yZHMscGFyc2VJbnQocmVjb3JkLDEwKSxwYXJzZUludChvZmZzZXQsMTApKTtyZXR1cm4gdXRpbGl0eS5jbG9uZShyZXN1bHQsdHJ1ZSl9LERhdGFTdG9yZS5wcm90b3R5cGUuam9pbj1mdW5jdGlvbihhcmcsZmllbGQsam9pbil7am9pbj1qb2lufHwiaW5uZXIiO3ZhciBzZWxmPXRoaXMsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpLHJlc3VsdHM9W10sZGVmZXJyZWRzPVtdLGtleT1maWVsZD09PXRoaXMua2V5LGtleXM9YXJyYXkubWVyZ2UoYXJyYXkua2V5cyh0aGlzLnJlY29yZHNbMF0uZGF0YSksYXJyYXkua2V5cyhhcmcucmVjb3Jkc1swXS5kYXRhKSksZm47aWYoam9pbj09PSJpbm5lciIpZm49ZnVuY3Rpb24oaSl7dmFyIHdoZXJlPXt9LHJlY29yZD1pLmRhdGEsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpOwp3aGVyZVtmaWVsZF09a2V5P2kua2V5OnJlY29yZFtmaWVsZF07YXJnLnNlbGVjdCh3aGVyZSkudGhlbihmdW5jdGlvbihtYXRjaCl7aWYobWF0Y2gubGVuZ3RoPjIpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5kYXRhYmFzZU1vcmVUaGFuT25lKSk7ZWxzZSBpZihtYXRjaC5sZW5ndGg9PT0xKXtyZXN1bHRzLnB1c2godXRpbGl0eS5tZXJnZShyZWNvcmQsbWF0Y2hbMF0uZGF0YSkpO2RlZmVyLnJlc29sdmUodHJ1ZSl9ZWxzZSBkZWZlci5yZXNvbHZlKGZhbHNlKX0pO2RlZmVycmVkcy5wdXNoKGRlZmVyKX07ZWxzZSBpZihqb2luPT09ImxlZnQiKWZuPWZ1bmN0aW9uKGkpe3ZhciB3aGVyZT17fSxyZWNvcmQ9aS5kYXRhLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKTt3aGVyZVtmaWVsZF09a2V5P2kua2V5OnJlY29yZFtmaWVsZF07YXJnLnNlbGVjdCh3aGVyZSkudGhlbihmdW5jdGlvbihtYXRjaCl7aWYobWF0Y2gubGVuZ3RoPjIpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5kYXRhYmFzZU1vcmVUaGFuT25lKSk7CmVsc2UgaWYobWF0Y2gubGVuZ3RoPT09MSl7cmVzdWx0cy5wdXNoKHV0aWxpdHkubWVyZ2UocmVjb3JkLG1hdGNoWzBdLmRhdGEpKTtkZWZlci5yZXNvbHZlKHRydWUpfWVsc2V7YXJyYXkuZWFjaChrZXlzLGZ1bmN0aW9uKGkpe2lmKHJlY29yZFtpXT09PXVuZGVmaW5lZClyZWNvcmRbaV09bnVsbH0pO3Jlc3VsdHMucHVzaChyZWNvcmQpO2RlZmVyLnJlc29sdmUodHJ1ZSl9fSk7ZGVmZXJyZWRzLnB1c2goZGVmZXIpfTtlbHNlIGlmKGpvaW49PT0icmlnaHQiKWZuPWZ1bmN0aW9uKGkpe3ZhciB3aGVyZT17fSxyZWNvcmQ9aS5kYXRhLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKTt3aGVyZVtmaWVsZF09a2V5P2kua2V5OnJlY29yZFtmaWVsZF07c2VsZi5zZWxlY3Qod2hlcmUpLnRoZW4oZnVuY3Rpb24obWF0Y2gpe2lmKG1hdGNoLmxlbmd0aD4yKWRlZmVyLnJlamVjdChuZXcgRXJyb3IobGFiZWwuZGF0YWJhc2VNb3JlVGhhbk9uZSkpO2Vsc2UgaWYobWF0Y2gubGVuZ3RoPT09MSl7cmVzdWx0cy5wdXNoKHV0aWxpdHkubWVyZ2UocmVjb3JkLAptYXRjaFswXS5kYXRhKSk7ZGVmZXIucmVzb2x2ZSh0cnVlKX1lbHNle2FycmF5LmVhY2goa2V5cyxmdW5jdGlvbihpKXtpZihyZWNvcmRbaV09PT11bmRlZmluZWQpcmVjb3JkW2ldPW51bGx9KTtyZXN1bHRzLnB1c2gocmVjb3JkKTtkZWZlci5yZXNvbHZlKHRydWUpfX0pO2RlZmVycmVkcy5wdXNoKGRlZmVyKX07YXJyYXkuZWFjaCh1dGlsaXR5LmNsb25lKGpvaW49PT0icmlnaHQiP2FyZy5yZWNvcmRzOnRoaXMucmVjb3Jkcyx0cnVlKSxmbik7dXRpbGl0eS53aGVuKGRlZmVycmVkcykudGhlbihmdW5jdGlvbigpe2RlZmVyLnJlc29sdmUocmVzdWx0cyl9LGZ1bmN0aW9uKGUpe2RlZmVyLnJlamVjdChlKX0pO3JldHVybiBkZWZlcn07RGF0YVN0b3JlLnByb3RvdHlwZS5vbmx5PWZ1bmN0aW9uKGFyZyl7aWYoYXJnPT09dGhpcy5rZXkpcmV0dXJuIHRoaXMucmVjb3Jkcy5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkua2V5fSk7ZWxzZSByZXR1cm4gdGhpcy5yZWNvcmRzLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5kYXRhW2FyZ119KX07CkRhdGFTdG9yZS5wcm90b3R5cGUucHVyZ2U9ZnVuY3Rpb24oYXJnKXtyZXR1cm4gdGhpcy5zdG9yYWdlKGFyZ3x8dGhpcywicmVtb3ZlIil9O0RhdGFTdG9yZS5wcm90b3R5cGUucmVpbmRleD1mdW5jdGlvbigpe3ZhciBzZWxmPXRoaXMsaT0tMSx0bXA9W107dGhpcy52aWV3cz17fTt0aGlzLmluZGV4ZXM9e2tleTp7fX07aWYodGhpcy50b3RhbD4wKWFycmF5LmVhY2godGhpcy5yZWNvcmRzLGZ1bmN0aW9uKHJlY29yZCl7aWYocmVjb3JkIT09dW5kZWZpbmVkKXt0bXBbKytpXT1yZWNvcmQ7cmVjb3JkLmluZGV4PWk7c2VsZi5pbmRleGVzLmtleVtyZWNvcmQua2V5XT1pO3NlbGYuc2V0SW5kZXhlcyhyZWNvcmQpfX0pO3RoaXMucmVjb3Jkcz10bXA7cmV0dXJuIHRoaXN9O0RhdGFTdG9yZS5wcm90b3R5cGUucmVzdG9yZT1mdW5jdGlvbihhcmcpe3JldHVybiB0aGlzLnN0b3JhZ2UoYXJnfHx0aGlzLCJnZXQiKX07RGF0YVN0b3JlLnByb3RvdHlwZS5zYXZlPWZ1bmN0aW9uKGFyZyl7cmV0dXJuIHRoaXMuc3RvcmFnZShhcmd8fAp0aGlzLCJzZXQiKX07RGF0YVN0b3JlLnByb3RvdHlwZS5zZWxlY3Q9ZnVuY3Rpb24od2hlcmUpe3ZhciBzZWxmPXRoaXMsZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpLGZ1bmN0aW9ucz1bXSxjbGF1c2VzLGNvbmQsaW5kZXgscmVzdWx0LHNvcnRlZCx2YWx1ZXMsd29ya2VyO2lmKCEod2hlcmUgaW5zdGFuY2VvZiBPYmplY3QpKWRlZmVyLnJlamVjdChuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cykpO2Vsc2V7dXRpbGl0eS5pdGVyYXRlKHdoZXJlLGZ1bmN0aW9uKHYsayl7aWYodHlwZW9mIHY9PSJmdW5jdGlvbiIpe3RoaXNba109di50b1N0cmluZygpO2Z1bmN0aW9ucy5wdXNoKGspfX0pO2lmKHdlYldvcmtlcil0cnl7d29ya2VyPXV0aWxpdHkud29ya2VyKGRlZmVyKTt3b3JrZXIucG9zdE1lc3NhZ2Uoe2NtZDoic2VsZWN0IixpbmRleGVzOnRoaXMuaW5kZXhlcyxyZWNvcmRzOnRoaXMucmVjb3Jkcyx3aGVyZTpqc29uLmVuY29kZSh3aGVyZSksZnVuY3Rpb25zOmZ1bmN0aW9uc30pfWNhdGNoKGUpe3dlYldvcmtlcj0KZmFsc2U7dGhpcy5zZWxlY3Qod2hlcmUpLnRoZW4oZnVuY3Rpb24oYXJnKXtkZWZlci5yZXNvbHZlKGFyZyl9LGZ1bmN0aW9uKGUpe2RlZmVyLnJlamVjdChlKX0pfWVsc2V7Y2xhdXNlcz1hcnJheS5mcm9tT2JqZWN0KHdoZXJlKTtzb3J0ZWQ9YXJyYXkuZmxhdChjbGF1c2VzKS5maWx0ZXIoZnVuY3Rpb24oaSxpZHgpe3JldHVybiBpZHglMj09PTB9KS5zb3J0KGFycmF5LnNvcnQpO2luZGV4PXNvcnRlZC5qb2luKCJ8Iik7dmFsdWVzPXNvcnRlZC5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIHdoZXJlW2ldfSkuam9pbigifCIpO2NvbmQ9InJldHVybiAoICI7aWYoZnVuY3Rpb25zLmxlbmd0aD09PTAmJnRoaXMuaW5kZXhlc1tpbmRleF0pcmVzdWx0PSh0aGlzLmluZGV4ZXNbaW5kZXhdW3ZhbHVlc118fFtdKS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIHNlbGYucmVjb3Jkc1tpXX0pO2Vsc2V7aWYoY2xhdXNlcy5sZW5ndGg+MSlhcnJheS5lYWNoKGNsYXVzZXMsZnVuY3Rpb24oaSxpZHgpe3ZhciBiMT0KIiggIjtpZihpZHg+MCliMT0iICYmICggIjtpZihpWzFdaW5zdGFuY2VvZiBGdW5jdGlvbiljb25kKz1iMStpWzFdLnRvU3RyaW5nKCkrJyggcmVjLmRhdGFbIicraVswXSsnIl0gKSApJztlbHNlIGlmKCFpc05hTihpWzFdKSljb25kKz1iMSsncmVjLmRhdGFbIicraVswXSsnIl0gPT09ICcraVsxXSsiICkiO2Vsc2UgY29uZCs9YjErJ3JlYy5kYXRhWyInK2lbMF0rJyJdID09PSAiJytpWzFdKyciICknfSk7ZWxzZSBpZihjbGF1c2VzWzBdWzFdaW5zdGFuY2VvZiBGdW5jdGlvbiljb25kKz1jbGF1c2VzWzBdWzFdLnRvU3RyaW5nKCkrJyggcmVjLmRhdGFbIicrY2xhdXNlc1swXVswXSsnIl0gKSc7ZWxzZSBpZighaXNOYU4oY2xhdXNlc1swXVsxXSkpY29uZCs9J3JlYy5kYXRhWyInK2NsYXVzZXNbMF1bMF0rJyJdID09PSAnK2NsYXVzZXNbMF1bMV07ZWxzZSBjb25kKz0ncmVjLmRhdGFbIicrY2xhdXNlc1swXVswXSsnIl0gPT09ICInK2NsYXVzZXNbMF1bMV0rJyInO2NvbmQrPSIgKTsiOwpyZXN1bHQ9dXRpbGl0eS5jbG9uZSh0aGlzLnJlY29yZHMsdHJ1ZSkuZmlsdGVyKG5ldyBGdW5jdGlvbigicmVjIixjb25kKSl9ZGVmZXIucmVzb2x2ZShyZXN1bHQpfX1yZXR1cm4gZGVmZXJ9O0RhdGFTdG9yZS5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKGtleSxkYXRhLGJhdGNoLG92ZXJ3cml0ZSl7ZGF0YT11dGlsaXR5LmNsb25lKGRhdGEsdHJ1ZSk7YmF0Y2g9YmF0Y2g9PT10cnVlO292ZXJ3cml0ZT1vdmVyd3JpdGU9PT10cnVlO3ZhciBzZWxmPXRoaXMsZXZlbnRzPXRoaXMuZXZlbnRzLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSxyZWNvcmQ9a2V5IT09bnVsbD90aGlzLmdldChrZXkpfHxudWxsOmRhdGFbdGhpcy5rZXldP3RoaXMuZ2V0KGRhdGFbdGhpcy5rZXldKXx8bnVsbDpudWxsLG1ldGhvZD0iUE9TVCIscGFyc2VkPXV0aWxpdHkucGFyc2Uoc2VsZi51cml8fCIiKSx1cmksb2RhdGEscmRlZmVyO2Z1bmN0aW9uIHBhdGNoKG92ZXJ3cml0ZSxkYXRhLG9nZGF0YSl7dmFyIG5kYXRhPQpbXTtpZihvdmVyd3JpdGUpYXJyYXkuZWFjaChhcnJheS5rZXlzKG9nZGF0YSksZnVuY3Rpb24oayl7aWYoayE9PXNlbGYua2V5JiZkYXRhW2tdPT09dW5kZWZpbmVkKW5kYXRhLnB1c2goe29wOiJyZW1vdmUiLHBhdGg6Ii8iK2t9KX0pO3V0aWxpdHkuaXRlcmF0ZShkYXRhLGZ1bmN0aW9uKHYsayl7aWYoayE9PXNlbGYua2V5JiZvZ2RhdGFba109PT11bmRlZmluZWQpbmRhdGEucHVzaCh7b3A6ImFkZCIscGF0aDoiLyIrayx2YWx1ZTp2fSk7ZWxzZSBpZihqc29uLmVuY29kZShvZ2RhdGFba10pIT09anNvbi5lbmNvZGUodikpbmRhdGEucHVzaCh7b3A6InJlcGxhY2UiLHBhdGg6Ii8iK2ssdmFsdWU6dn0pfSk7cmV0dXJuIG5kYXRhfWlmKHR5cGVvZiBkYXRhPT0ic3RyaW5nIil7aWYoZGF0YS5pbmRleE9mKCIvLyIpPT09LTEpaWYoZGF0YS5jaGFyQXQoMCkhPT0iLyIpdXJpPXRoaXMuYnVpbGRVcmkoZGF0YSk7ZWxzZSBpZihzZWxmLnVyaSE9PW51bGwmJnJlZ2V4LnJvb3QudGVzdChkYXRhKSl1cmk9CnBhcnNlZC5wcm90b2NvbCsiLy8iK3BhcnNlZC5ob3N0K2RhdGE7ZWxzZSB1cmk9ZGF0YTtlbHNlIHVyaT1kYXRhO2tleT11cmkucmVwbGFjZShyZWdleC5ub3RfZW5kcG9pbnQsIiIpO2lmKHN0cmluZy5pc0VtcHR5KGtleSkpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKSk7ZWxzZXtpZighYmF0Y2gmJmV2ZW50cylzZWxmLmRpc3BhdGNoKCJiZWZvcmVTZXQiLHtrZXk6a2V5LGRhdGE6ZGF0YX0pO2NsaWVudC5yZXF1ZXN0KHVyaSwiR0VUIixudWxsLHV0aWxpdHkubWVyZ2Uoe3dpdGhDcmVkZW50aWFsczpzZWxmLmNyZWRlbnRpYWxzfSxzZWxmLmhlYWRlcnMpKS50aGVuKGZ1bmN0aW9uKGFyZyl7c2VsZi5zZXRDb21wbGV0ZShyZWNvcmQsa2V5LHNlbGYuc291cmNlP3V0aWxpdHkud2Fsayhhcmcsc2VsZi5zb3VyY2UpOmFyZyxiYXRjaCxvdmVyd3JpdGUsZGVmZXIpfSxmdW5jdGlvbihlKXtzZWxmLmRpc3BhdGNoKCJmYWlsZWRTZXQiLGUpO2RlZmVyLnJlamVjdChlKX0pfX1lbHNle2lmKCFiYXRjaCYmCmV2ZW50cylzZWxmLmRpc3BhdGNoKCJiZWZvcmVTZXQiLHtrZXk6a2V5LGRhdGE6ZGF0YX0pO2lmKGJhdGNofHx0aGlzLnVyaT09PW51bGwpdGhpcy5zZXRDb21wbGV0ZShyZWNvcmQsa2V5LGRhdGEsYmF0Y2gsb3ZlcndyaXRlLGRlZmVyKTtlbHNle2lmKGtleSE9PW51bGwpe3VyaT10aGlzLmJ1aWxkVXJpKGtleSk7bWV0aG9kPSJQQVRDSCI7b2RhdGE9dXRpbGl0eS5jbG9uZShkYXRhLHRydWUpO2RhdGE9cGF0Y2gob3ZlcndyaXRlLGRhdGEsdGhpcy5kdW1wKFtyZWNvcmRdKVswXSl9ZWxzZSB1cmk9cGFyc2VkLnByb3RvY29sKyIvLyIrcGFyc2VkLmhvc3QrcGFyc2VkLnBhdGhuYW1lO3JkZWZlcj1jbGllbnQucmVxdWVzdCh1cmksbWV0aG9kLGRhdGEsdXRpbGl0eS5tZXJnZSh7d2l0aENyZWRlbnRpYWxzOnRoaXMuY3JlZGVudGlhbHN9LHRoaXMuaGVhZGVycykpO3JkZWZlci50aGVuKGZ1bmN0aW9uKGFyZyl7dmFyIGNoYW5nZTtpZihyZGVmZXIueGhyLnN0YXR1cyE9PTIwNCYmcmRlZmVyLnhoci5zdGF0dXM8CjMwMCljaGFuZ2U9a2V5PT09bnVsbD9zZWxmLnNvdXJjZT91dGlsaXR5LndhbGsoYXJnLHNlbGYuc291cmNlKTphcmc6b2RhdGE7ZWxzZSBjaGFuZ2U9b2RhdGE7c2VsZi5zZXRDb21wbGV0ZShyZWNvcmQsa2V5LGNoYW5nZSxiYXRjaCxvdmVyd3JpdGUsZGVmZXIpfSxmdW5jdGlvbihlKXtpZihtZXRob2Q9PSJQQVRDSCIpe21ldGhvZD0iUFVUIjtkYXRhPXV0aWxpdHkuY2xvbmUob2RhdGEsdHJ1ZSk7dXRpbGl0eS5pdGVyYXRlKHJlY29yZC5kYXRhLGZ1bmN0aW9uKHYsayl7ZGF0YVtrXT12fSk7Y2xpZW50LnJlcXVlc3QodXJpLG1ldGhvZCxkYXRhLHV0aWxpdHkubWVyZ2Uoe3dpdGhDcmVkZW50aWFsczpzZWxmLmNyZWRlbnRpYWxzfSxzZWxmLmhlYWRlcnMpKS50aGVuKGZ1bmN0aW9uKCl7c2VsZi5zZXRDb21wbGV0ZShyZWNvcmQsa2V5LG9kYXRhLGJhdGNoLG92ZXJ3cml0ZSxkZWZlcil9LGZ1bmN0aW9uKGUpe3NlbGYuZGlzcGF0Y2goImZhaWxlZFNldCIsZSk7ZGVmZXIucmVqZWN0KGUpfSl9ZWxzZXtzZWxmLmRpc3BhdGNoKCJmYWlsZWRTZXQiLAplKTtkZWZlci5yZWplY3QoZSl9fSl9fXJldHVybiBkZWZlcn07RGF0YVN0b3JlLnByb3RvdHlwZS5zZXRDb21wbGV0ZT1mdW5jdGlvbihyZWNvcmQsa2V5LGRhdGEsYmF0Y2gsb3ZlcndyaXRlLGRlZmVyKXt0aGlzLnZpZXdzPXt9O2lmKGtleT09PW51bGwpaWYodGhpcy5rZXkhPT1udWxsJiZkYXRhW3RoaXMua2V5XSE9PXVuZGVmaW5lZCYmZGF0YVt0aGlzLmtleV0hPT1udWxsKWtleT1kYXRhW3RoaXMua2V5XS50b1N0cmluZygpO2Vsc2Uga2V5PXV0aWxpdHkudXVpZCgpO2lmKHRoaXMua2V5KWRlbGV0ZSBkYXRhW3RoaXMua2V5XTtpZihyZWNvcmQ9PT1udWxsKXtyZWNvcmQ9e2luZGV4OnRoaXMudG90YWwrKyxrZXk6a2V5LGRhdGE6ZGF0YSxpbmRleGVzOltdfTt0aGlzLmluZGV4ZXMua2V5W2tleV09cmVjb3JkLmluZGV4O3RoaXMucmVjb3Jkc1tyZWNvcmQuaW5kZXhdPXJlY29yZDtpZih0aGlzLnZlcnNpb25pbmcpe3RoaXMudmVyc2lvbnNbcmVjb3JkLmtleV09bHJ1LmZhY3RvcnkoVkVSU0lPTlMpOwp0aGlzLnZlcnNpb25zW3JlY29yZC5rZXldLm50aD0wfX1lbHNle2lmKHRoaXMudmVyc2lvbmluZyl7aWYodGhpcy52ZXJzaW9uc1tyZWNvcmQua2V5XT09PXVuZGVmaW5lZCl7dGhpcy52ZXJzaW9uc1tyZWNvcmQua2V5XT1scnUuZmFjdG9yeShWRVJTSU9OUyk7dGhpcy52ZXJzaW9uc1tyZWNvcmQua2V5XS5udGg9MH10aGlzLnZlcnNpb25zW3JlY29yZC5rZXldLnNldCgidiIrICsrdGhpcy52ZXJzaW9uc1tyZWNvcmQua2V5XS5udGgsdGhpcy5kdW1wKFtyZWNvcmRdKVswXSl9cmVjb3JkPXRoaXMucmVjb3Jkc1tyZWNvcmQuaW5kZXhdO2lmKG92ZXJ3cml0ZSlyZWNvcmQuZGF0YT17fTt1dGlsaXR5Lml0ZXJhdGUoZGF0YSxmdW5jdGlvbih2LGspe3JlY29yZC5kYXRhW2tdPXZ9KTtyZWNvcmQ9dXRpbGl0eS5jbG9uZShyZWNvcmQsdHJ1ZSl9dGhpcy5zZXRJbmRleGVzKHJlY29yZCk7aWYoIWJhdGNoKXtpZih0aGlzLmF1dG9zYXZlKXRoaXMuc2F2ZSgpO2lmKHRoaXMuZXZlbnRzKXRoaXMuZGlzcGF0Y2goImFmdGVyU2V0IiwKcmVjb3JkKTthcnJheS5lYWNoKHRoaXMubGlzdHMsZnVuY3Rpb24oaSl7aS5yZWZyZXNoKCl9KX1kZWZlci5yZXNvbHZlKHJlY29yZCk7cmV0dXJuIHRoaXN9O0RhdGFTdG9yZS5wcm90b3R5cGUuc2V0RXhwaXJlcz1mdW5jdGlvbihhcmcpe3ZhciBpZD10aGlzLmlkKyJFeHBpcmUiLGV4cGlyZXM9YXJnLHNlbGY9dGhpcztpZihhcmchPT1udWxsJiZ0aGlzLnVyaT09PW51bGx8fGFyZyE9PW51bGwmJihpc05hTihhcmcpfHxhcmc8MUUzKSl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7aWYodGhpcy5leHBpcmVzPT09YXJnKXJldHVybjt0aGlzLmV4cGlyZXM9YXJnO3V0aWxpdHkuY2xlYXJUaW1lcnMoaWQpO2lmKGFyZz09PW51bGwpcmV0dXJuO3V0aWxpdHkucmVwZWF0KGZ1bmN0aW9uKCl7aWYoc2VsZi51cmk9PT1udWxsKXtzZWxmLnNldEV4cGlyZXMobnVsbCk7cmV0dXJuIGZhbHNlfXNlbGYuZGlzcGF0Y2goImJlZm9yZUV4cGlyZSIpO2NhY2hlLmV4cGlyZShzZWxmLnVyaSk7CnNlbGYuZGlzcGF0Y2goImV4cGlyZSIpO3NlbGYuZGlzcGF0Y2goImFmdGVyRXhwaXJlIil9LGV4cGlyZXMsaWQsZmFsc2UpfTtEYXRhU3RvcmUucHJvdG90eXBlLnNldEluZGV4ZXM9ZnVuY3Rpb24oYXJnKXt2YXIgc2VsZj10aGlzLGRlbGltdGVyPSJ8IjthcmcuaW5kZXhlcz1bXTthcnJheS5lYWNoKHRoaXMuaW5kZXgsZnVuY3Rpb24oaSl7dmFyIGtleXM9aS5zcGxpdChkZWxpbXRlciksdmFsdWVzPSIiO2lmKHNlbGYuaW5kZXhlc1tpXT09PXVuZGVmaW5lZClzZWxmLmluZGV4ZXNbaV09e307YXJyYXkuZWFjaChrZXlzLGZ1bmN0aW9uKGssa2R4KXt2YWx1ZXMrPShrZHg+MD9kZWxpbXRlcjoiIikrYXJnLmRhdGFba119KTtpZihzZWxmLmluZGV4ZXNbaV1bdmFsdWVzXT09PXVuZGVmaW5lZClzZWxmLmluZGV4ZXNbaV1bdmFsdWVzXT1bXTtpZighYXJyYXkuY29udGFpbnMoc2VsZi5pbmRleGVzW2ldW3ZhbHVlc10sYXJnLmluZGV4KSl7c2VsZi5pbmRleGVzW2ldW3ZhbHVlc10ucHVzaChhcmcuaW5kZXgpOwphcmcuaW5kZXhlcy5wdXNoKFtpLHZhbHVlc10pfX0pO3JldHVybiB0aGlzfTtEYXRhU3RvcmUucHJvdG90eXBlLnNldFVyaT1mdW5jdGlvbihhcmcpe3ZhciBkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCkscGFyc2VkO2lmKGFyZyE9PW51bGwmJnN0cmluZy5pc0VtcHR5KGFyZykpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKSk7aWYoYXJnPT09bnVsbCl0aGlzLnVyaT1hcmc7ZWxzZXtwYXJzZWQ9dXRpbGl0eS5wYXJzZShhcmcpO3RoaXMudXJpPXBhcnNlZC5wcm90b2NvbCsiLy8iK3BhcnNlZC5ob3N0K3BhcnNlZC5wYXRoO2lmKCFzdHJpbmcuaXNFbXB0eShwYXJzZWQuYXV0aCkmJiF0aGlzLmhlYWRlcnMuYXV0aG9yaXphdGlvbiYmIXRoaXMuaGVhZGVycy5BdXRob3JpemF0aW9uKXRoaXMuaGVhZGVycy5BdXRob3JpemF0aW9uPSJCYXNpYyAiK2J0b2EoZGVjb2RlVVJJQ29tcG9uZW50KHBhcnNlZC5hdXRoKSk7dGhpcy5vbigiZXhwaXJlIixmdW5jdGlvbigpe3RoaXMuc3luYygpfSwKInJlc3luYyIsdGhpcyk7Y2FjaGUuZXhwaXJlKHRoaXMudXJpKTt0aGlzLnN5bmMoKS50aGVuKGZ1bmN0aW9uKGFyZyl7ZGVmZXIucmVzb2x2ZShhcmcpfSxmdW5jdGlvbihlKXtkZWZlci5yZWplY3QoZSl9KX1yZXR1cm4gZGVmZXJ9O0RhdGFTdG9yZS5wcm90b3R5cGUuc29ydD1mdW5jdGlvbihxdWVyeSxjcmVhdGUsd2hlcmUpe2NyZWF0ZT1jcmVhdGU9PT10cnVlfHx3aGVyZSBpbnN0YW5jZW9mIE9iamVjdDt2YXIgc2VsZj10aGlzLHZpZXc9c3RyaW5nLnRvQ2FtZWxDYXNlKHN0cmluZy5leHBsb2RlKHF1ZXJ5KS5qb2luKCIgIikpLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSxuZXh0LHdvcmtlcjtuZXh0PWZ1bmN0aW9uKHJlY29yZHMpe2lmKHNlbGYudG90YWw9PT0wKWRlZmVyLnJlc29sdmUoW10pO2Vsc2UgaWYoIWNyZWF0ZSYmc2VsZi52aWV3c1t2aWV3XSlkZWZlci5yZXNvbHZlKHNlbGYudmlld3Nbdmlld10pO2Vsc2UgaWYod2ViV29ya2VyKXtkZWZlci50aGVuKGZ1bmN0aW9uKGFyZyl7c2VsZi52aWV3c1t2aWV3XT0KYXJnO3JldHVybiBzZWxmLnZpZXdzW3ZpZXddfSxmdW5jdGlvbihlKXt1dGlsaXR5LmVycm9yKGUpfSk7dHJ5e3dvcmtlcj11dGlsaXR5LndvcmtlcihkZWZlcik7d29ya2VyLnBvc3RNZXNzYWdlKHtjbWQ6InNvcnQiLGluZGV4ZXM6c2VsZi5pbmRleGVzLHJlY29yZHM6cmVjb3JkcyxxdWVyeTpxdWVyeX0pfWNhdGNoKGUpe3dlYldvcmtlcj1mYWxzZTtzZWxmLnZpZXdzW3ZpZXddPWFycmF5LmtleVNvcnQocmVjb3JkcyxxdWVyeSwiZGF0YSIpO2RlZmVyLnJlc29sdmUoc2VsZi52aWV3c1t2aWV3XSl9fWVsc2V7c2VsZi52aWV3c1t2aWV3XT1hcnJheS5rZXlTb3J0KHJlY29yZHMscXVlcnksImRhdGEiKTtkZWZlci5yZXNvbHZlKHNlbGYudmlld3Nbdmlld10pfX07aWYoIXdoZXJlKW5leHQodXRpbGl0eS5jbG9uZSh0aGlzLnJlY29yZHMsdHJ1ZSkpO2Vsc2UgdGhpcy5zZWxlY3Qod2hlcmUpLnRoZW4obmV4dCxmdW5jdGlvbihlKXtkZWZlci5yZWplY3QoZSl9KTtyZXR1cm4gZGVmZXJ9OwpEYXRhU3RvcmUucHJvdG90eXBlLnN0b3JhZ2U9ZnVuY3Rpb24ob2JqLG9wLHR5cGUpe3ZhciBzZWxmPXRoaXMscmVjb3JkPWZhbHNlLG1vbmdvPSFzdHJpbmcuaXNFbXB0eSh0aGlzLm1vbmdvZGIpLHNlc3Npb249dHlwZT09PSJzZXNzaW9uIiYmdHlwZW9mIHNlc3Npb25TdG9yYWdlIT0idW5kZWZpbmVkIixkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCksZGF0YSxrZXkscmVzdWx0O2lmKCFyZWdleC5udW1iZXJfc3RyaW5nX29iamVjdC50ZXN0KHR5cGVvZiBvYmopfHwhcmVnZXguZ2V0X3JlbW92ZV9zZXQudGVzdChvcCkpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKSk7ZWxzZXtyZWNvcmQ9cmVnZXgubnVtYmVyX3N0cmluZy50ZXN0KHR5cGVvZiBvYmopfHxvYmouaGFzT3duUHJvcGVydHkoImRhdGEiKTtpZihvcCE9PSJyZW1vdmUiKXtpZihyZWNvcmQmJiEob2JqIGluc3RhbmNlb2YgT2JqZWN0KSlvYmo9dGhpcy5nZXQob2JqKTtrZXk9cmVjb3JkPwpvYmoua2V5Om9iai5pZH1lbHNlIGlmKG9wPT09InJlbW92ZSImJnJlY29yZClrZXk9b2JqLmtleXx8b2JqO2lmKG1vbmdvKW1vbmdvZGIuY29ubmVjdCh0aGlzLm1vbmdvZGIsZnVuY3Rpb24oZSxkYil7aWYoZSl7aWYoZGIpZGIuY2xvc2UoKTtyZXR1cm4gZGVmZXIucmVqZWN0KGUpfWRiLmNvbGxlY3Rpb24oc2VsZi5pZCxmdW5jdGlvbihlLGNvbGxlY3Rpb24pe2lmKGUpe2RiLmNsb3NlKCk7cmV0dXJuIGRlZmVyLnJlamVjdChlKX1pZihvcD09PSJnZXQiKWlmKHJlY29yZCljb2xsZWN0aW9uLmZpbmQoe19pZDpvYmoua2V5fSkubGltaXQoMSkudG9BcnJheShmdW5jdGlvbihlLHJlY3Mpe2RiLmNsb3NlKCk7aWYoZSlkZWZlci5yZWplY3QoZSk7ZWxzZSBpZihyZWNzLmxlbmd0aD09PTApZGVmZXIucmVzb2x2ZShudWxsKTtlbHNle2RlbGV0ZSByZWNzWzBdLl9pZDtzZWxmLnNldChrZXkscmVjc1swXSx0cnVlKS50aGVuKGZ1bmN0aW9uKHJlYyl7ZGVmZXIucmVzb2x2ZShyZWMpfSwKZnVuY3Rpb24oZSl7ZGVmZXIucmVqZWN0KGUpfSl9fSk7ZWxzZSBjb2xsZWN0aW9uLmZpbmQoe30pLnRvQXJyYXkoZnVuY3Rpb24oZSxyZWNzKXt2YXIgaSxudGg7aWYoZSl7ZGIuY2xvc2UoKTtyZXR1cm4gZGVmZXIucmVqZWN0KGUpfWk9LTE7bnRoPXJlY3MubGVuZ3RoO2lmKG50aD4wKXtzZWxmLnJlY29yZHM9cmVjcy5tYXAoZnVuY3Rpb24ocil7dmFyIHJlYz17a2V5OnIuX2lkLGluZGV4OisraSxkYXRhOnt9fTtzZWxmLmluZGV4ZXMua2V5W3JlYy5rZXldPXJlYy5pbmRleDtyZWMuZGF0YT1yO2RlbGV0ZSByZWMuZGF0YS5faWQ7c2VsZi5zZXRJbmRleGVzKHJlYyk7cmV0dXJuIHJlY30pO3NlbGYudG90YWw9bnRofWRiLmNsb3NlKCk7ZGVmZXIucmVzb2x2ZShzZWxmLnJlY29yZHMpfSk7ZWxzZSBpZihvcD09PSJyZW1vdmUiKWNvbGxlY3Rpb24ucmVtb3ZlKHJlY29yZD97X2lkOmtleX06e30se3NhZmU6dHJ1ZX0sZnVuY3Rpb24oZSxhcmcpe2RiLmNsb3NlKCk7aWYoZSlkZWZlci5yZWplY3QoZSk7CmVsc2UgZGVmZXIucmVzb2x2ZShhcmcpfSk7ZWxzZSBpZihvcD09PSJzZXQiKWlmKHJlY29yZCljb2xsZWN0aW9uLnVwZGF0ZSh7X2lkOm9iai5rZXl9LG9iai5kYXRhLHt3OjEsc2FmZTp0cnVlLHVwc2VydDp0cnVlfSxmdW5jdGlvbihlLGFyZyl7ZGIuY2xvc2UoKTtpZihlKWRlZmVyLnJlamVjdChlKTtlbHNlIGRlZmVyLnJlc29sdmUoYXJnKX0pO2Vsc2UgY29sbGVjdGlvbi5yZW1vdmUoe30se3c6MSxzYWZlOnRydWV9LGZ1bmN0aW9uKGUpe3ZhciBkZWZlcnJlZHM7aWYoZSl7ZGIuY2xvc2UoKTtyZXR1cm4gZGVmZXIucmVqZWN0KGUpfWVsc2V7ZGVmZXJyZWRzPVtdO2FycmF5LmVhY2goc2VsZi5yZWNvcmRzLGZ1bmN0aW9uKGkpe3ZhciBkYXRhPXt9LGRlZmVyMj1kZWZlcnJlZC5mYWN0b3J5KCk7ZGVmZXJyZWRzLnB1c2goZGVmZXIyKTt1dGlsaXR5Lml0ZXJhdGUoaS5kYXRhLGZ1bmN0aW9uKHYsayl7ZGF0YVtrXT12fSk7Y29sbGVjdGlvbi51cGRhdGUoe19pZDppLmtleX0sZGF0YSwKe3c6MSxzYWZlOnRydWUsdXBzZXJ0OnRydWV9LGZ1bmN0aW9uKGUsYXJnKXtpZihlKWRlZmVyMi5yZWplY3QoZSk7ZWxzZSBkZWZlcjIucmVzb2x2ZShhcmcpfSl9KTt1dGlsaXR5LndoZW4oZGVmZXJyZWRzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7ZGIuY2xvc2UoKTtkZWZlci5yZXNvbHZlKHJlc3VsdCl9LGZ1bmN0aW9uKGUpe2RiLmNsb3NlKCk7ZGVmZXIucmVqZWN0KGUpfSl9fSk7ZWxzZXtkYi5jbG9zZSgpO2RlZmVyLnJlamVjdChudWxsKX19KX0pO2Vsc2UgaWYob3A9PT0iZ2V0Iil7cmVzdWx0PXNlc3Npb24/c2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShrZXkpOmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7aWYocmVzdWx0IT09bnVsbCl7cmVzdWx0PWpzb24uZGVjb2RlKHJlc3VsdCk7aWYocmVjb3JkKXNlbGYuc2V0KGtleSxyZXN1bHQsdHJ1ZSkudGhlbihmdW5jdGlvbihyZWMpe2RlZmVyLnJlc29sdmUocmVjKX0sZnVuY3Rpb24oZSl7ZGVmZXIucmVqZWN0KGUpfSk7ZWxzZXt1dGlsaXR5Lm1lcmdlKHNlbGYsCnJlc3VsdCk7ZGVmZXIucmVzb2x2ZShzZWxmKX19ZWxzZSBkZWZlci5yZXNvbHZlKHNlbGYpO2RlZmVyLnRoZW4oZnVuY3Rpb24oKXtzZWxmLmxvYWRlZD10cnVlfSxmdW5jdGlvbihlKXt0aHJvdyBlO30pfWVsc2UgaWYob3A9PT0icmVtb3ZlIil7c2Vzc2lvbj9zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk6bG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtkZWZlci5yZXNvbHZlKHRoaXMpfWVsc2UgaWYob3A9PT0ic2V0Iil7ZGF0YT1qc29uLmVuY29kZShyZWNvcmQ/b2JqLmRhdGE6e3RvdGFsOnRoaXMudG90YWwsaW5kZXg6dGhpcy5pbmRleCxpbmRleGVzOnRoaXMuaW5kZXhlcyxyZWNvcmRzOnRoaXMucmVjb3Jkc30pO3Nlc3Npb24/c2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShrZXksZGF0YSk6bG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LGRhdGEpO2RlZmVyLnJlc29sdmUodGhpcyl9ZWxzZSBkZWZlci5yZWplY3QobnVsbCl9cmV0dXJuIGRlZmVyfTtEYXRhU3RvcmUucHJvdG90eXBlLnN5bmM9CmZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpcyxldmVudHM9dGhpcy5ldmVudHM9PT10cnVlLGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSxzdWNjZXNzLGZhaWx1cmU7c3VjY2Vzcz1mdW5jdGlvbihhcmcpe3ZhciBkYXRhO2lmKHR5cGVvZiBhcmchPSJvYmplY3QiKXJldHVybiBmYWlsdXJlKG5ldyBFcnJvcihsYWJlbC5leHBlY3RlZE9iamVjdCkpO2lmKHNlbGYuc291cmNlIT09bnVsbClhcmc9dXRpbGl0eS53YWxrKGFyZyxzZWxmLnNvdXJjZSk7aWYoYXJnIGluc3RhbmNlb2YgQXJyYXkpZGF0YT1hcmc7ZWxzZSBkYXRhPVthcmddO3NlbGYuYmF0Y2goInNldCIsZGF0YSx0cnVlKS50aGVuKGZ1bmN0aW9uKGFyZyl7aWYoZXZlbnRzKXNlbGYuZGlzcGF0Y2goImFmdGVyU3luYyIsYXJnKTtkZWZlci5yZXNvbHZlKGFyZyl9LGZhaWx1cmUpfTtmYWlsdXJlPWZ1bmN0aW9uKGUpe2lmKGV2ZW50cylzZWxmLmRpc3BhdGNoKCJmYWlsZWRTeW5jIixlKTtkZWZlci5yZWplY3QoZSl9O2lmKHRoaXMudXJpPT09Cm51bGx8fHN0cmluZy5pc0VtcHR5KHRoaXMudXJpKSlkZWZlci5yZWplY3QobmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpKTtlbHNle2lmKGV2ZW50cyl0aGlzLmRpc3BhdGNoKCJiZWZvcmVTeW5jIix0aGlzLnVyaSk7aWYodGhpcy5jYWxsYmFjayE9PW51bGwpY2xpZW50Lmpzb25wKHRoaXMudXJpLHtjYWxsYmFjazp0aGlzLmNhbGxiYWNrfSkudGhlbihzdWNjZXNzLGZhaWx1cmUpO2Vsc2UgY2xpZW50LnJlcXVlc3QodGhpcy51cmksIkdFVCIsbnVsbCx1dGlsaXR5Lm1lcmdlKHt3aXRoQ3JlZGVudGlhbHM6dGhpcy5jcmVkZW50aWFsc30sdGhpcy5oZWFkZXJzKSkudGhlbihzdWNjZXNzLGZhaWx1cmUpfXJldHVybiBkZWZlcn07RGF0YVN0b3JlLnByb3RvdHlwZS50ZWFyZG93bj1mdW5jdGlvbigpe3ZhciB1cmk9dGhpcy51cmksaWQ7aWYodXJpIT09bnVsbCl7Y2FjaGUuZXhwaXJlKHVyaSx0cnVlKTtpZD10aGlzLmlkKyJEYXRhRXhwaXJlIjt1dGlsaXR5LmNsZWFyVGltZXJzKGlkKTsKYXJyYXkuZWFjaCh0aGlzLnJlY29yZHMsZnVuY3Rpb24oaSl7dmFyIHJlY29yZFVyaT11cmkrIi8iK2kua2V5O2NhY2hlLmV4cGlyZShyZWNvcmRVcmksdHJ1ZSl9KX1hcnJheS5lYWNoKHRoaXMubGlzdHMsZnVuY3Rpb24oaSl7aS50ZWFyZG93bih0cnVlKX0pO3RoaXMuY2xlYXIodHJ1ZSk7dGhpcy5kaXNwYXRjaCgiYWZ0ZXJUZWFyZG93biIpO3JldHVybiB0aGlzfTtEYXRhU3RvcmUucHJvdG90eXBlLnVuZG89ZnVuY3Rpb24oa2V5LHZlcnNpb24pe3ZhciByZWNvcmQ9dGhpcy5nZXQoa2V5KSxkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCksdmVyc2lvbnM9dGhpcy52ZXJzaW9uc1tyZWNvcmQua2V5XSxwcmV2aW91cztpZihyZWNvcmQ9PT11bmRlZmluZWQpZGVmZXIucmVqZWN0KG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKSk7ZWxzZSBpZih2ZXJzaW9ucyl7cHJldmlvdXM9dmVyc2lvbnMuZ2V0KHZlcnNpb258fHZlcnNpb25zLmZpcnN0KTtpZihwcmV2aW91cz09PXVuZGVmaW5lZClkZWZlci5yZWplY3QobGFiZWwuZGF0YXN0b3JlTm9QcmV2VmVyc2lvbik7CmVsc2UgdGhpcy5zZXQoa2V5LHByZXZpb3VzKS50aGVuKGZ1bmN0aW9uKGFyZyl7ZGVmZXIucmVzb2x2ZShhcmcpfSxmdW5jdGlvbihlKXtkZWZlci5yZWplY3QoZSl9KX1lbHNlIGRlZmVyLnJlamVjdChsYWJlbC5kYXRhc3RvcmVOb1ByZXZWZXJzaW9uKTtyZXR1cm4gZGVmZXJ9O0RhdGFTdG9yZS5wcm90b3R5cGUudW5pcXVlPWZ1bmN0aW9uKGtleSl7cmV0dXJuIGFycmF5LnVuaXF1ZSh0aGlzLnJlY29yZHMubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpLmRhdGFba2V5XX0pKX07RGF0YVN0b3JlLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oa2V5LGRhdGEpe3ZhciByZWNvcmQ9dGhpcy5nZXQoa2V5KSxkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCk7aWYocmVjb3JkPT09dW5kZWZpbmVkKWRlZmVyLnJlamVjdChuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cykpO2Vsc2UgdGhpcy5zZXQoa2V5LHV0aWxpdHkubWVyZ2UocmVjb3JkLmRhdGEsZGF0YSkpLnRoZW4oZnVuY3Rpb24oYXJnKXtkZWZlci5yZXNvbHZlKGFyZyl9LApmdW5jdGlvbihlKXtkZWZlci5yZWplY3QoZSl9KTtyZXR1cm4gZGVmZXJ9O3ZhciBzdHJpbmc9e2NhcGl0YWxpemU6ZnVuY3Rpb24ob2JqLGFsbCl7YWxsPWFsbD09PXRydWU7dmFyIHJlc3VsdDtpZihhbGwpcmVzdWx0PXN0cmluZy5leHBsb2RlKG9iaiwiICIpLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStpLnNsaWNlKDEpfSkuam9pbigiICIpO2Vsc2UgcmVzdWx0PW9iai5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStvYmouc2xpY2UoMSk7cmV0dXJuIHJlc3VsdH0sZXNjYXBlOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai5yZXBsYWNlKC9bXC1cW1xde30oKSorPy4sXFxcL1xeXCR8I1xzXS9nLCJcXCQmIil9LGV4cGxvZGU6ZnVuY3Rpb24ob2JqLGFyZyl7YXJnPWFyZ3x8IiwiO3JldHVybiBzdHJpbmcudHJpbShvYmopLnNwbGl0KG5ldyBSZWdFeHAoIlxccyoiK2FyZysiXFxzKiIpKX0sZnJvbU9iamVjdDpmdW5jdGlvbihvYmosbmFtZSl7dmFyIHJlc3VsdD0KKG5hbWU/bmFtZSsiID0geyI6InsiKSsiXG4iO3V0aWxpdHkuaXRlcmF0ZShvYmosZnVuY3Rpb24odixrKXtyZXN1bHQrPSciJytrKyciOicrdi50b1N0cmluZygpKyIsXG4ifSk7cmVzdWx0PXJlc3VsdC5yZXBsYWNlKC9cW29iamVjdCBPYmplY3RcXS9nLCJ7fSIpLnJlcGxhY2UoLyxcbiQvLCJcbiIpKyJ9IjtyZXR1cm4gcmVzdWx0fSxoeXBoZW5hdGU6ZnVuY3Rpb24ob2JqLGNhbWVsKXt2YXIgcmVzdWx0PXN0cmluZy50cmltKG9iaikucmVwbGFjZSgvXHMrL2csIi0iKTtpZihjYW1lbD09PXRydWUpcmVzdWx0PXJlc3VsdC5yZXBsYWNlKC8oW0EtWl0pL2csIi0kMSIpLnRvTG93ZXJDYXNlKCk7cmV0dXJuIHJlc3VsdH0saXNCb29sZWFuOmZ1bmN0aW9uKG9iail7cmV0dXJuIHJlZ2V4LmJvb2wudGVzdChvYmopfSxpc0VtcHR5OmZ1bmN0aW9uKG9iail7cmV0dXJuIHN0cmluZy50cmltKG9iaik9PT0iIn0saXNOdW1iZXI6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gcmVnZXgubnVtYmVyLnRlc3Qob2JqKX0sCmlzVXJsOmZ1bmN0aW9uKG9iail7cmV0dXJuIHJlZ2V4LnVybC50ZXN0KG9iail9LHRvQ2FtZWxDYXNlOmZ1bmN0aW9uKG9iail7dmFyIHM9c3RyaW5nLnRyaW0ob2JqKS5yZXBsYWNlKC9cLnxffC18XEB8XFt8XF18XCh8XCl8XCN8XCR8XCV8XF58XCZ8XCp8XHMrL2csIiAiKS50b0xvd2VyQ2FzZSgpLnNwbGl0KHJlZ2V4LnNwYWNlX2h5cGhlbikscj1bXTthcnJheS5lYWNoKHMsZnVuY3Rpb24oaSxpZHgpe3IucHVzaChpZHg9PT0wP2k6c3RyaW5nLmNhcGl0YWxpemUoaSkpfSk7cmV0dXJuIHIuam9pbigiIil9LHNpbmd1bGFyOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai5yZXBsYWNlKC9vZT9zJC8sIm8iKS5yZXBsYWNlKC9pZXMkLywieSIpLnJlcGxhY2UoL3NlcyQvLCJzZSIpLnJlcGxhY2UoL3MkLywiIil9LHRvRnVuY3Rpb246ZnVuY3Rpb24ob2JqKXt2YXIgYXJncz1zdHJpbmcudHJpbShvYmoucmVwbGFjZSgvXi4qXCgvLCIiKS5yZXBsYWNlKC9bXHR8XHJ8XG58XCJ8XCddKy9nLAoiIikucmVwbGFjZSgvXCkuKi8sIiIpKSxib2R5PXN0cmluZy50cmltKG9iai5yZXBsYWNlKC9eLipcey8sIiIpLnJlcGxhY2UoL1x9JC8sIiIpKTtyZXR1cm4gRnVuY3Rpb24uYXBwbHkoRnVuY3Rpb24sc3RyaW5nLmV4cGxvZGUoYXJncykuY29uY2F0KFtib2R5XSkpfSx0cmltOmZ1bmN0aW9uKG9iail7cmV0dXJuIG9iai5yZXBsYWNlKC9eKFxzK3xcdCt8XG4rKXwoXHMrfFx0K3xcbispJC9nLCIiKX0sdW5DYW1lbENhc2U6ZnVuY3Rpb24ob2JqKXtyZXR1cm4gc3RyaW5nLnRyaW0ob2JqLnJlcGxhY2UoLyhbQS1aXSkvZywiICQxIikudG9Mb3dlckNhc2UoKSl9LHVuY2FwaXRhbGl6ZTpmdW5jdGlvbihvYmope29iaj1zdHJpbmcudHJpbShvYmopO3JldHVybiBvYmouY2hhckF0KDApLnRvTG93ZXJDYXNlKCkrb2JqLnNsaWNlKDEpfSx1bmh5cGhlbmF0ZTpmdW5jdGlvbihvYmosY2Fwcyl7aWYoY2FwcyE9PXRydWUpcmV0dXJuIHN0cmluZy5leHBsb2RlKG9iaiwiLSIpLmpvaW4oIiAiKTsKZWxzZSByZXR1cm4gc3RyaW5nLmV4cGxvZGUob2JqLCItIikubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBzdHJpbmcuY2FwaXRhbGl6ZShpKX0pLmpvaW4oIiAiKX19O3ZhciB1dGlsaXR5PXt0aW1lcjp7fSxyZXBlYXRpbmc6e30sJDpmdW5jdGlvbihhcmcpe3ZhciByZXN1bHQ7aWYoIWFyZyk7ZWxzZSBpZihyZWdleC5odG1sLnRlc3QoYXJnKSlyZXN1bHQ9W2VsZW1lbnQuY3JlYXRlKGFyZyldO2Vsc2V7YXJnPXN0cmluZy50cmltKGFyZyk7aWYoYXJnLmluZGV4T2YoIiwiKT09PS0xKXtyZXN1bHQ9dXRpbGl0eS5kb20oYXJnKTtpZihyZXN1bHQpe2lmKGlzTmFOKHJlc3VsdC5sZW5ndGgpKXJlc3VsdD1bcmVzdWx0XX1lbHNlIHJlc3VsdD1bXX1lbHNle3Jlc3VsdD1bXTthcnJheS5lYWNoKHN0cmluZy5leHBsb2RlKGFyZyksZnVuY3Rpb24ocXVlcnkpe3ZhciBvYmo9dXRpbGl0eS5kb20ocXVlcnkpO2lmKG9iaiBpbnN0YW5jZW9mIEFycmF5KXJlc3VsdD1yZXN1bHQuY29uY2F0KG9iaik7CmVsc2UgaWYob2JqKXJlc3VsdC5wdXNoKG9iail9KX19cmV0dXJuIHJlc3VsdH0sYmFzZTpmdW5jdGlvbihhcmcpe3ZhciBvYmo9bmV3IEJhc2U7aWYoYXJnIGluc3RhbmNlb2YgT2JqZWN0KXV0aWxpdHkubWVyZ2Uob2JqLGFyZyk7b2JqLm9ic2VydmVyPW9ic2VydmFibGUuZmFjdG9yeSgpO3JldHVybiBvYmp9LGJsb2I6ZnVuY3Rpb24oYXJnKXt2YXIgb2JqO3RyeXtvYmo9bmV3IEJsb2IoW2FyZ10se3R5cGU6ImFwcGxpY2F0aW9uL2phdmFzY3JpcHQifSl9Y2F0Y2goZSl7aWYoIWdsb2JhbC5CbG9iQnVpbGRlcilnbG9iYWwuQmxvYkJ1aWxkZXI9Z2xvYmFsLk1TQmxvYkJ1aWxkZXJ8fGdsb2JhbC5XZWJLaXRCbG9iQnVpbGRlcnx8Z2xvYmFsLk1vekJsb2JCdWlsZGVyO29iaj0obmV3IGdsb2JhbC5CbG9iQnVpbGRlcikuYXBwZW5kKGFyZykuZ2V0QmxvYigpfXJldHVybiBvYmp9LGNsZWFyVGltZXJzOmZ1bmN0aW9uKGlkKXtpZihpZD09PXVuZGVmaW5lZHx8c3RyaW5nLmlzRW1wdHkoaWQpKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTsKaWYodXRpbGl0eS50aW1lcltpZF0pe2NsZWFyVGltZW91dCh1dGlsaXR5LnRpbWVyW2lkXSk7ZGVsZXRlIHV0aWxpdHkudGltZXJbaWRdfWlmKHV0aWxpdHkucmVwZWF0aW5nW2lkXSl7Y2xlYXJUaW1lb3V0KHV0aWxpdHkucmVwZWF0aW5nW2lkXSk7ZGVsZXRlIHV0aWxpdHkucmVwZWF0aW5nW2lkXX19LGNsb25lOmZ1bmN0aW9uKG9iaixzaGFsbG93KXt2YXIgY2xvbmU7aWYoc2hhbGxvdz09PXRydWUpcmV0dXJuIG9iaiE9PXVuZGVmaW5lZCYmb2JqIT09bnVsbD9qc29uLmRlY29kZShqc29uLmVuY29kZShvYmopKTpvYmo7ZWxzZSBpZighb2JqfHxyZWdleC5wcmltaXRpdmUudGVzdCh0eXBlb2Ygb2JqKXx8b2JqIGluc3RhbmNlb2YgUmVnRXhwKXJldHVybiBvYmo7ZWxzZSBpZihvYmogaW5zdGFuY2VvZiBBcnJheSlyZXR1cm4gb2JqLnNsaWNlKCk7ZWxzZSBpZighc2VydmVyJiYhY2xpZW50LmllJiZvYmogaW5zdGFuY2VvZiBEb2N1bWVudClyZXR1cm4geG1sLmRlY29kZSh4bWwuZW5jb2RlKG9iaikpOwplbHNlIGlmKHR5cGVvZiBvYmouX19wcm90b19fIT0idW5kZWZpbmVkIilyZXR1cm4gdXRpbGl0eS5leHRlbmQob2JqLl9fcHJvdG9fXyxvYmopO2Vsc2UgaWYob2JqIGluc3RhbmNlb2YgT2JqZWN0KXtjbG9uZT1qc29uLmVuY29kZShvYmosdHJ1ZSk7aWYoY2xvbmUhPT11bmRlZmluZWQpe2Nsb25lPWpzb24uZGVjb2RlKGNsb25lKTt1dGlsaXR5Lml0ZXJhdGUob2JqLGZ1bmN0aW9uKHYsayl7aWYodHlwZW9mIHY9PSJmdW5jdGlvbiIpY2xvbmVba109dn0pfWVsc2UgY2xvbmU9b2JqO3JldHVybiBjbG9uZX1lbHNlIHJldHVybiBvYmp9LGNvZXJjZTpmdW5jdGlvbih2YWx1ZSl7dmFyIHRtcDtpZih2YWx1ZT09PW51bGx8fHZhbHVlPT09dW5kZWZpbmVkKXJldHVybiB1bmRlZmluZWQ7ZWxzZSBpZih2YWx1ZT09PSJ0cnVlIilyZXR1cm4gdHJ1ZTtlbHNlIGlmKHZhbHVlPT09ImZhbHNlIilyZXR1cm4gZmFsc2U7ZWxzZSBpZih2YWx1ZT09PSJudWxsIilyZXR1cm4gbnVsbDtlbHNlIGlmKHZhbHVlPT09CiJ1bmRlZmluZWQiKXJldHVybiB1bmRlZmluZWQ7ZWxzZSBpZih2YWx1ZT09PSIiKXJldHVybiB2YWx1ZTtlbHNlIGlmKCFpc05hTih0bXA9TnVtYmVyKHZhbHVlKSkpcmV0dXJuIHRtcDtlbHNlIGlmKHJlZ2V4Lmpzb25fd3JhcC50ZXN0KHZhbHVlKSlyZXR1cm4ganNvbi5kZWNvZGUodmFsdWUsdHJ1ZSl8fHZhbHVlO2Vsc2UgcmV0dXJuIHZhbHVlfSxjb21waWxlOmZ1bmN0aW9uKHJlZyxwYXR0ZXJuLG1vZGlmaWVycyl7cmVnLmNvbXBpbGUocGF0dGVybixtb2RpZmllcnMpO3JldHVybiB0cnVlfSxjdXJyeTpmdW5jdGlvbigpe3ZhciBhcmdzPWFycmF5LmNhc3QoYXJndW1lbnRzKSxmbj1hcmdzLnNoaWZ0KCksY2ZuPWZuLmFwcGx5KGZuLGFyZ3MpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBjZm4uYXBwbHkoY2ZuLGFyZ3VtZW50cyl9fSxkZWZlcjpmdW5jdGlvbihmbixtcyxpZCxyZXBlYXQpe3ZhciBvcDttcz1tc3x8MDtyZXBlYXQ9cmVwZWF0PT09dHJ1ZTtpZihpZCE9PXVuZGVmaW5lZCl1dGlsaXR5LmNsZWFyVGltZXJzKGlkKTsKZWxzZSBpZD11dGlsaXR5LnV1aWQodHJ1ZSk7b3A9ZnVuY3Rpb24oKXt1dGlsaXR5LmNsZWFyVGltZXJzKGlkKTtmbigpfTt1dGlsaXR5W3JlcGVhdD8icmVwZWF0aW5nIjoidGltZXIiXVtpZF09c2V0VGltZW91dChvcCxtcyk7cmV0dXJuIGlkfSxkZWxheTpmdW5jdGlvbigpe2lmKHR5cGVvZiBzZXRJbW1lZGlhdGUhPSJ1bmRlZmluZWQiKXJldHVybiBmdW5jdGlvbihhcmcpe3NldEltbWVkaWF0ZShhcmcpfTtlbHNlIGlmKHR5cGVvZiBwcm9jZXNzIT0idW5kZWZpbmVkIilyZXR1cm4gcHJvY2Vzcy5uZXh0VGljaztlbHNlIHJldHVybiBmdW5jdGlvbihhcmcpe3NldFRpbWVvdXQoYXJnLDApfX0oKSxkb206ZnVuY3Rpb24oYXJnKXt2YXIgcmVzdWx0O2lmKCFyZWdleC5zZWxlY3Rvcl9jb21wbGV4LnRlc3QoYXJnKSlpZihyZWdleC5oYXNoLnRlc3QoYXJnKSlyZXN1bHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYXJnLnJlcGxhY2UocmVnZXguaGFzaCwiIikpfHx1bmRlZmluZWQ7CmVsc2UgaWYocmVnZXgua2xhc3MudGVzdChhcmcpKXJlc3VsdD1hcnJheS5jYXN0KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYXJnLnJlcGxhY2UocmVnZXgua2xhc3MsIiIpKSk7ZWxzZSBpZihyZWdleC53b3JkLnRlc3QoYXJnKSlyZXN1bHQ9YXJyYXkuY2FzdChkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShhcmcpKTtlbHNlIHJlc3VsdD1hcnJheS5jYXN0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYXJnKSk7ZWxzZSByZXN1bHQ9YXJyYXkuY2FzdChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGFyZykpO3JldHVybiByZXN1bHR9LGRvbUlkOmZ1bmN0aW9uKGFyZyl7cmV0dXJuImEiK2FyZy5yZXBsYWNlKC8tL2csIiIpLnNsaWNlKDEpfSxlcnJvcjpmdW5jdGlvbihlLGFyZ3Msc2NvcGUsd2FybmluZyl7dmFyIG89eyJhcmd1bWVudHMiOmFyZ3M/YXJyYXkuY2FzdChhcmdzKTpbXSxtZXNzYWdlOmUubWVzc2FnZXx8ZSxudW1iZXI6ZS5udW1iZXI/ZS5udW1iZXImCjY1NTM1OnVuZGVmaW5lZCxzY29wZTpzY29wZSxzdGFjazplLnN0YWNrfHx1bmRlZmluZWQsdGltZXN0YW1wOihuZXcgRGF0ZSkudG9VVENTdHJpbmcoKSx0eXBlOmUudHlwZXx8IlR5cGVFcnJvciJ9O3V0aWxpdHkubG9nKG8uc3RhY2t8fG8ubWVzc2FnZSx3YXJuaW5nIT09dHJ1ZT8iZXJyb3IiOiJ3YXJuIik7cmV0dXJuIHVuZGVmaW5lZH0sZXh0ZW5kOmZ1bmN0aW9uKG9iaixhcmcpe3ZhciBvO2lmKG9iaj09PXVuZGVmaW5lZCl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZEFyZ3VtZW50cyk7bz1PYmplY3QuY3JlYXRlKG9iaik7aWYoYXJnIGluc3RhbmNlb2YgT2JqZWN0KXV0aWxpdHkubWVyZ2UobyxhcmcpO3JldHVybiBvfSxnZW5JZDpmdW5jdGlvbihvYmosZG9tKXtkb209ZG9tPT09dHJ1ZTt2YXIgaWQ7aWYob2JqJiYob2JqLmlkfHxvYmogaW5zdGFuY2VvZiBBcnJheXx8KHR5cGVvZiBvYmo9PSJzdHJpbmcifHxvYmogaW5zdGFuY2VvZiBTdHJpbmcpKSlyZXR1cm4gb2JqOwppZihkb20pe2RvIGlkPXV0aWxpdHkuZG9tSWQodXRpbGl0eS51dWlkKHRydWUpKTt3aGlsZSh1dGlsaXR5LmRvbSgiIyIraWQpKX1lbHNlIGlkPXV0aWxpdHkuZG9tSWQodXRpbGl0eS51dWlkKHRydWUpKTtpZih0eXBlb2Ygb2JqPT0ib2JqZWN0Iil7b2JqLmlkPWlkO3JldHVybiBvYmp9ZWxzZSByZXR1cm4gaWR9LGl0ZXJhdGU6ZnVuY3Rpb24ob2JqLGZuKXtpZih0eXBlb2YgZm4hPSJmdW5jdGlvbiIpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO2FycmF5LmVhY2goT2JqZWN0LmtleXMob2JqKSxmdW5jdGlvbihpKXtyZXR1cm4gZm4uY2FsbChvYmosb2JqW2ldLGkpfSk7cmV0dXJuIG9ian0sbG9nOmZ1bmN0aW9uKGFyZyx0YXJnZXQpe3ZhciB0cyxtc2c7aWYodHlwZW9mIGNvbnNvbGUhPSJ1bmRlZmluZWQiKXt0cz10eXBlb2YgYXJnIT0ib2JqZWN0Ijttc2c9dHM/IlsiKyhuZXcgRGF0ZSkudG9Mb2NhbGVUaW1lU3RyaW5nKCkrIl0gIithcmc6YXJnO2NvbnNvbGVbdGFyZ2V0fHwKImxvZyJdKG1zZyl9fSxtZXJnZTpmdW5jdGlvbihvYmosYXJnKXt1dGlsaXR5Lml0ZXJhdGUoYXJnLGZ1bmN0aW9uKHYsayl7aWYob2JqW2tdaW5zdGFuY2VvZiBBcnJheSYmdiBpbnN0YW5jZW9mIEFycmF5KWFycmF5Lm1lcmdlKG9ialtrXSx2KTtlbHNlIGlmKG9ialtrXWluc3RhbmNlb2YgT2JqZWN0JiZ2IGluc3RhbmNlb2YgT2JqZWN0KXV0aWxpdHkuaXRlcmF0ZSh2LGZ1bmN0aW9uKHgseSl7b2JqW2tdW3ldPXV0aWxpdHkuY2xvbmUoeCl9KTtlbHNlIG9ialtrXT11dGlsaXR5LmNsb25lKHYpfSk7cmV0dXJuIG9ian0scGFyc2U6ZnVuY3Rpb24odXJpKXt2YXIgb2JqPXt9LHBhcnNlZD17fTtpZih1cmk9PT11bmRlZmluZWQpdXJpPSFzZXJ2ZXI/bG9jYXRpb24uaHJlZjoiIjtpZighc2VydmVyKXtvYmo9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpO29iai5ocmVmPXVyaX1lbHNlIG9iaj11cmwucGFyc2UodXJpKTtpZihzZXJ2ZXIpdXRpbGl0eS5pdGVyYXRlKG9iaixmdW5jdGlvbih2LAprKXtpZih2PT09bnVsbClvYmpba109dW5kZWZpbmVkfSk7cGFyc2VkPXthdXRoOnNlcnZlcj9udWxsOnJlZ2V4LmF1dGguZXhlYyh1cmkpLHByb3RvY29sOm9iai5wcm90b2NvbHx8Imh0dHA6Iixob3N0bmFtZTpvYmouaG9zdG5hbWV8fCJsb2NhbGhvc3QiLHBvcnQ6b2JqLnBvcnQ/bnVtYmVyLnBhcnNlKG9iai5wb3J0LDEwKToiIixwYXRobmFtZTpvYmoucGF0aG5hbWUsc2VhcmNoOm9iai5zZWFyY2h8fCIiLGhhc2g6b2JqLmhhc2h8fCIiLGhvc3Q6b2JqLmhvc3R8fCJsb2NhbGhvc3QifTtpZihjbGllbnQuaWUpe2lmKHBhcnNlZC5wcm90b2NvbD09PSI6IilwYXJzZWQucHJvdG9jb2w9bG9jYXRpb24ucHJvdG9jb2w7aWYoc3RyaW5nLmlzRW1wdHkocGFyc2VkLmhvc3RuYW1lKSlwYXJzZWQuaG9zdG5hbWU9bG9jYXRpb24uaG9zdG5hbWU7aWYoc3RyaW5nLmlzRW1wdHkocGFyc2VkLmhvc3QpKXBhcnNlZC5ob3N0PWxvY2F0aW9uLmhvc3Q7aWYocGFyc2VkLnBhdGhuYW1lLmNoYXJBdCgwKSE9PQoiLyIpcGFyc2VkLnBhdGhuYW1lPSIvIitwYXJzZWQucGF0aG5hbWV9cGFyc2VkLmF1dGg9b2JqLmF1dGh8fChwYXJzZWQuYXV0aD09PW51bGw/IiI6cGFyc2VkLmF1dGhbMV0pO3BhcnNlZC5ocmVmPW9iai5ocmVmfHxwYXJzZWQucHJvdG9jb2wrIi8vIisoc3RyaW5nLmlzRW1wdHkocGFyc2VkLmF1dGgpPyIiOnBhcnNlZC5hdXRoKyJAIikrcGFyc2VkLmhvc3QrcGFyc2VkLnBhdGhuYW1lK3BhcnNlZC5zZWFyY2grcGFyc2VkLmhhc2g7cGFyc2VkLnBhdGg9b2JqLnBhdGh8fHBhcnNlZC5wYXRobmFtZStwYXJzZWQuc2VhcmNoO3BhcnNlZC5xdWVyeT11dGlsaXR5LnF1ZXJ5U3RyaW5nKG51bGwscGFyc2VkLnNlYXJjaCk7cmV0dXJuIHBhcnNlZH0scGFydGlhbDpmdW5jdGlvbigpe3ZhciBhcmdzPWFycmF5LmNhc3QoYXJndW1lbnRzKSxmbj1hcmdzLnNoaWZ0KCk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGZuLmFwcGx5KGZuLGFyZ3MuY29uY2F0KGFycmF5LmNhc3QoYXJndW1lbnRzKSkpfX0sCnByZXZlbnQ6ZnVuY3Rpb24oZXYpe2lmKHR5cGVvZiBldi5wcmV2ZW50RGVmYXVsdD09ImZ1bmN0aW9uIilldi5wcmV2ZW50RGVmYXVsdCgpO3JldHVybiBldn0scXVlcnlTdHJpbmc6ZnVuY3Rpb24oYXJnLHFzdHJpbmcpe3ZhciBvYmo9e30scmVzdWx0PXFzdHJpbmchPT11bmRlZmluZWQ/cXN0cmluZy5pbmRleE9mKCI/Iik+LTE/cXN0cmluZy5yZXBsYWNlKC8uKlw/LywiIik6bnVsbDpzZXJ2ZXJ8fHN0cmluZy5pc0VtcHR5KGxvY2F0aW9uLnNlYXJjaCk/bnVsbDpsb2NhdGlvbi5zZWFyY2gucmVwbGFjZSgiPyIsIiIpO2lmKHJlc3VsdCE9PW51bGwmJiFzdHJpbmcuaXNFbXB0eShyZXN1bHQpKXtyZXN1bHQ9cmVzdWx0LnNwbGl0KCImIik7YXJyYXkuZWFjaChyZXN1bHQsZnVuY3Rpb24ocHJvcCl7dmFyIGl0ZW09cHJvcC5zcGxpdCgiPSIpO2lmKHN0cmluZy5pc0VtcHR5KGl0ZW1bMF0pKXJldHVybjtpZihpdGVtWzFdPT09dW5kZWZpbmVkKWl0ZW1bMV09IiI7ZWxzZSBpdGVtWzFdPQp1dGlsaXR5LmNvZXJjZShkZWNvZGVVUklDb21wb25lbnQoaXRlbVsxXSkpO2lmKG9ialtpdGVtWzBdXT09PXVuZGVmaW5lZClvYmpbaXRlbVswXV09aXRlbVsxXTtlbHNlIGlmKCEob2JqW2l0ZW1bMF1daW5zdGFuY2VvZiBBcnJheSkpe29ialtpdGVtWzBdXT1bb2JqW2l0ZW1bMF1dXTtvYmpbaXRlbVswXV0ucHVzaChpdGVtWzFdKX1lbHNlIG9ialtpdGVtWzBdXS5wdXNoKGl0ZW1bMV0pfSl9aWYoYXJnIT09bnVsbCYmYXJnIT09dW5kZWZpbmVkKW9iaj1vYmpbYXJnXTtyZXR1cm4gb2JqfSxyYWNlOmZ1bmN0aW9uKCl7dmFyIGRlZmVyPWRlZmVycmVkLmZhY3RvcnkoKSxhcmdzPWFycmF5LmNhc3QoYXJndW1lbnRzKTtpZihhcmdzWzBdaW5zdGFuY2VvZiBBcnJheSlhcmdzPWFyZ3NbMF07aWYoYXJncy5sZW5ndGg9PT0wKWRlZmVyLnJlc29sdmUobnVsbCk7ZWxzZSBQcm9taXNlLnJhY2UoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHRzKXtkZWZlci5yZXNvbHZlKHJlc3VsdHMpfSwKZnVuY3Rpb24oZSl7ZGVmZXIucmVqZWN0KGUpfSk7cmV0dXJuIGRlZmVyfSxyZW5kZXI6ZnVuY3Rpb24oZm4pe3ZhciBkZWZlcj1kZWZlcnJlZC5mYWN0b3J5KCk7UkVOREVSKGZ1bmN0aW9uKGFyZyl7dHJ5e2RlZmVyLnJlc29sdmUoZm4oYXJnKSl9Y2F0Y2goZSl7ZGVmZXIucmVqZWN0KGUpfX0pO3JldHVybiBkZWZlcn0scmVwZWF0OmZ1bmN0aW9uKGZuLG1zLGlkLG5vdyl7bXM9bXN8fDEwO2lkPWlkfHx1dGlsaXR5LnV1aWQodHJ1ZSk7bm93PW5vdyE9PWZhbHNlO2lmKG5vdyYmZm4oKT09PWZhbHNlKXJldHVybjt1dGlsaXR5LmRlZmVyKGZ1bmN0aW9uKCl7dmFyIHJlY3Vyc2l2ZT1mdW5jdGlvbihmbixtcyxpZCl7dmFyIHJlY3Vyc2l2ZT10aGlzO2lmKGZuKCkhPT1mYWxzZSl1dGlsaXR5LnJlcGVhdGluZ1tpZF09c2V0VGltZW91dChmdW5jdGlvbigpe3JlY3Vyc2l2ZS5jYWxsKHJlY3Vyc2l2ZSxmbixtcyxpZCl9LG1zKTtlbHNlIGRlbGV0ZSB1dGlsaXR5LnJlcGVhdGluZ1tpZF19OwpyZWN1cnNpdmUuY2FsbChyZWN1cnNpdmUsZm4sbXMsaWQpfSxtcyxpZCx0cnVlKTtyZXR1cm4gaWR9LHN0b3A6ZnVuY3Rpb24oZXYpe2lmKHR5cGVvZiBldi5zdG9wUHJvcGFnYXRpb249PSJmdW5jdGlvbiIpZXYuc3RvcFByb3BhZ2F0aW9uKCk7dXRpbGl0eS5wcmV2ZW50KGV2KTtyZXR1cm4gZXZ9LHRhcmdldDpmdW5jdGlvbihldil7cmV0dXJuIGV2LnRhcmdldHx8ZXYuc3JjRWxlbWVudH0sdXVpZDpmdW5jdGlvbihzdHJpcCl7dmFyIHM9ZnVuY3Rpb24oKXtyZXR1cm4oKDErTWF0aC5yYW5kb20oKSkqNjU1MzZ8MCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKX0scj1bOCw5LCJhIiwiYiJdLG87bz1zKCkrcygpKyItIitzKCkrIi00IitzKCkuc3Vic3RyKDAsMykrIi0iK3JbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjQpXStzKCkuc3Vic3RyKDAsMykrIi0iK3MoKStzKCkrcygpO2lmKHN0cmlwPT09dHJ1ZSlvPW8ucmVwbGFjZSgvLS9nLCIiKTtyZXR1cm4gb30sd2FsazpmdW5jdGlvbihvYmosCmFyZyl7dmFyIG91dHB1dD1vYmo7YXJyYXkuZWFjaChhcmcucmVwbGFjZSgvXF0kLywiIikucmVwbGFjZSgvXF0vZywiLiIpLnJlcGxhY2UoL1wuXC4vZywiLiIpLnNwbGl0KC9cLnxcWy8pLGZ1bmN0aW9uKGkpe2lmKG91dHB1dFtpXT09PXVuZGVmaW5lZHx8b3V0cHV0W2ldPT09bnVsbCl7b3V0cHV0PXVuZGVmaW5lZDtyZXR1cm4gZmFsc2V9b3V0cHV0PW91dHB1dFtpXX0pO3JldHVybiBvdXRwdXR9LHdoZW46ZnVuY3Rpb24oKXt2YXIgZGVmZXI9ZGVmZXJyZWQuZmFjdG9yeSgpLGFyZ3M9YXJyYXkuY2FzdChhcmd1bWVudHMpO2lmKGFyZ3NbMF1pbnN0YW5jZW9mIEFycmF5KWFyZ3M9YXJnc1swXTtpZihhcmdzLmxlbmd0aD09PTApZGVmZXIucmVzb2x2ZShudWxsKTtlbHNlIFByb21pc2UuYWxsKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0cyl7ZGVmZXIucmVzb2x2ZShyZXN1bHRzKX0sZnVuY3Rpb24oZSl7ZGVmZXIucmVqZWN0KGUpfSk7cmV0dXJuIGRlZmVyfSx3b3JrZXI6ZnVuY3Rpb24oZGVmZXIpe3ZhciBvYmo9Cm5ldyBXb3JrZXIoV09SS0VSKTtvYmoub25lcnJvcj1mdW5jdGlvbihlcnIpe2RlZmVyLnJlamVjdChlcnIpO29iai50ZXJtaW5hdGUoKX07b2JqLm9ubWVzc2FnZT1mdW5jdGlvbihldil7ZGVmZXIucmVzb2x2ZShldi5kYXRhKTtvYmoudGVybWluYXRlKCl9O3JldHVybiBvYmp9fTtmdW5jdGlvbiB4aHIoKXt2YXIgVU5TRU5UPTAsT1BFTkVEPTEsSEVBREVSU19SRUNFSVZFRD0yLExPQURJTkc9MyxET05FPTQsRVJSX1JFRlVTRUQ9L0VDT05OUkVGVVNFRC8scmVhZHk9bmV3IFJlZ0V4cChIRUFERVJTX1JFQ0VJVkVEKyJ8IitMT0FESU5HKSxYTUxIdHRwUmVxdWVzdCxoZWFkZXJzLGRpc3BhdGNoLHN1Y2Nlc3MsZmFpbHVyZSxzdGF0ZTtoZWFkZXJzPXsidXNlci1hZ2VudCI6ImtlaWdhaS8wLjkuMCBub2RlLmpzLyIrcHJvY2Vzcy52ZXJzaW9ucy5ub2RlLnJlcGxhY2UoL152LywiIikrIiAoIitzdHJpbmcuY2FwaXRhbGl6ZShwcm9jZXNzLnBsYXRmb3JtKSsiIFY4LyIrcHJvY2Vzcy52ZXJzaW9ucy52OCsKIiApIiwiY29udGVudC10eXBlIjoidGV4dC9wbGFpbiIsImFjY2VwdCI6IiovKiJ9O2Rpc3BhdGNoPWZ1bmN0aW9uKGFyZyl7dmFyIGZuPSJvbiIrYXJnO2lmKHR5cGVvZiB0aGlzW2ZuXT09ImZ1bmN0aW9uIil0aGlzW2ZuXSgpO3RoaXMuZGlzcGF0Y2hFdmVudChhcmcpO3JldHVybiB0aGlzfTtzdGF0ZT1mdW5jdGlvbihhcmcpe2lmKHRoaXMucmVhZHlTdGF0ZSE9PWFyZyl7dGhpcy5yZWFkeVN0YXRlPWFyZztkaXNwYXRjaC5jYWxsKHRoaXMsInJlYWR5c3RhdGVjaGFuZ2UiKTtpZih0aGlzLnJlYWR5U3RhdGU9PT1ET05FJiYhdGhpcy5fZXJyb3Ipe2Rpc3BhdGNoLmNhbGwodGhpcywibG9hZCIpO2Rpc3BhdGNoLmNhbGwodGhpcywibG9hZGVuZCIpfX1yZXR1cm4gdGhpc307c3VjY2Vzcz1mdW5jdGlvbihyZXMpe3ZhciBzZWxmPXRoaXM7c3RhdGUuY2FsbCh0aGlzLEhFQURFUlNfUkVDRUlWRUQpO3RoaXMuc3RhdHVzPXJlcy5zdGF0dXNDb2RlO3RoaXMuX3Jlc2hlYWRlcnM9cmVzLmhlYWRlcnM7CmlmKHRoaXMuX3Jlc2hlYWRlcnNbInNldC1jb29raWUiXSYmdGhpcy5fcmVzaGVhZGVyc1sic2V0LWNvb2tpZSJdaW5zdGFuY2VvZiBBcnJheSl0aGlzLl9yZXNoZWFkZXJzWyJzZXQtY29va2llIl09dGhpcy5fcmVzaGVhZGVyc1sic2V0LWNvb2tpZSJdLmpvaW4oIjsiKTtyZXMub24oImRhdGEiLGZ1bmN0aW9uKGFyZyl7cmVzLnNldEVuY29kaW5nKCJ1dGY4Iik7aWYoc2VsZi5fc2VuZCl7aWYoYXJnKXNlbGYucmVzcG9uc2VUZXh0Kz1hcmc7c3RhdGUuY2FsbChzZWxmLExPQURJTkcpfX0pO3Jlcy5vbigiZW5kIixmdW5jdGlvbigpe2lmKHNlbGYuX3NlbmQpe3N0YXRlLmNhbGwoc2VsZixET05FKTtzZWxmLl9zZW5kPWZhbHNlfX0pfTtmYWlsdXJlPWZ1bmN0aW9uKGUpe3RoaXMuc3RhdHVzPUVSUl9SRUZVU0VELnRlc3QoZS5tZXNzYWdlKT81MDM6NTAwO3RoaXMuc3RhdHVzVGV4dD0iIjt0aGlzLnJlc3BvbnNlVGV4dD1lLm1lc3NhZ2U7dGhpcy5fZXJyb3I9dHJ1ZTt0aGlzLl9zZW5kPQpmYWxzZTtkaXNwYXRjaC5jYWxsKHRoaXMsImVycm9yIik7c3RhdGUuY2FsbCh0aGlzLERPTkUpfTtYTUxIdHRwUmVxdWVzdD1mdW5jdGlvbigpe3RoaXMub25hYm9ydD1udWxsO3RoaXMub25lcnJvcj1udWxsO3RoaXMub25sb2FkPW51bGw7dGhpcy5vbmxvYWRlbmQ9bnVsbDt0aGlzLm9ubG9hZHN0YXJ0PW51bGw7dGhpcy5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDt0aGlzLnJlYWR5U3RhdGU9VU5TRU5UO3RoaXMucmVzcG9uc2U9bnVsbDt0aGlzLnJlc3BvbnNlVGV4dD0iIjt0aGlzLnJlc3BvbnNlVHlwZT0iIjt0aGlzLnJlc3BvbnNlWE1MPW51bGw7dGhpcy5zdGF0dXM9VU5TRU5UO3RoaXMuc3RhdHVzVGV4dD0iIjt0aGlzLm9ic2VydmVyPW9ic2VydmFibGUuZmFjdG9yeSgpO3RoaXMuX2Vycm9yPWZhbHNlO3RoaXMuX2hlYWRlcnM9e307dGhpcy5fcGFyYW1zPXt9O3RoaXMuX3JlcXVlc3Q9bnVsbDt0aGlzLl9yZXNoZWFkZXJzPXt9O3RoaXMuX3NlbmQ9ZmFsc2V9O1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZT0KYmFzZS5mYWN0b3J5KCk7WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPVhNTEh0dHBSZXF1ZXN0O1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5hYm9ydD1mdW5jdGlvbigpe2lmKHRoaXMuX3JlcXVlc3QhPT1udWxsKXt0aGlzLl9yZXF1ZXN0LmFib3J0KCk7dGhpcy5fcmVxdWVzdD1udWxsO3RoaXMucmVzcG9uc2VUZXh0PSIiO3RoaXMucmVzcG9uc2VYTUw9IiI7dGhpcy5fZXJyb3I9dHJ1ZTt0aGlzLl9oZWFkZXJzPXt9O2lmKHRoaXMuX3NlbmQ9PT10cnVlfHxyZWFkeS50ZXN0KHRoaXMucmVhZHlTdGF0ZSkpe3RoaXMuX3NlbmQ9ZmFsc2U7c3RhdGUuY2FsbCh0aGlzLERPTkUpfWRpc3BhdGNoLmNhbGwodGhpcywiYWJvcnQiKTt0aGlzLnJlYWR5U3RhdGU9VU5TRU5UfXJldHVybiB0aGlzfTtYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzPWZ1bmN0aW9uKCl7dmFyIHJlc3VsdD0iIjtpZih0aGlzLnJlYWR5U3RhdGU8SEVBREVSU19SRUNFSVZFRCl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZFN0YXRlTm9IZWFkZXJzKTsKdXRpbGl0eS5pdGVyYXRlKHRoaXMuX3Jlc2hlYWRlcnMsZnVuY3Rpb24odixrKXtyZXN1bHQrPWsrIjogIit2KyJcbiJ9KTtyZXR1cm4gcmVzdWx0fTtYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuZ2V0UmVzcG9uc2VIZWFkZXI9ZnVuY3Rpb24oaGVhZGVyKXt2YXIgcmVzdWx0O2lmKHRoaXMucmVhZHlTdGF0ZTxIRUFERVJTX1JFQ0VJVkVEfHx0aGlzLl9lcnJvcil0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZFN0YXRlTm9IZWFkZXJzKTtyZXN1bHQ9dGhpcy5fcmVzaGVhZGVyc1toZWFkZXJdfHx0aGlzLl9yZXNoZWFkZXJzW2hlYWRlci50b0xvd2VyQ2FzZSgpXTtyZXR1cm4gcmVzdWx0fTtYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3Blbj1mdW5jdGlvbihtZXRob2QsdXJsLGFzeW5jLHVzZXIscGFzc3dvcmQpe3ZhciBzZWxmPXRoaXM7aWYoYXN5bmMhPT10cnVlKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkU3RhdGVOb1N5bmMpO3RoaXMuYWJvcnQoKTt0aGlzLl9lcnJvcj0KZmFsc2U7dGhpcy5fcGFyYW1zPXttZXRob2Q6bWV0aG9kLHVybDp1cmwsYXN5bmM6YXN5bmN8fHRydWUsdXNlcjp1c2VyfHxudWxsLHBhc3N3b3JkOnBhc3N3b3JkfHxudWxsfTt1dGlsaXR5Lml0ZXJhdGUoaGVhZGVycyxmdW5jdGlvbih2LGspe3NlbGYuX2hlYWRlcnNba109dn0pO3RoaXMucmVhZHlTdGF0ZT1PUEVORUQ7cmV0dXJuIHRoaXN9O1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vdmVycmlkZU1pbWVUeXBlPWZ1bmN0aW9uKG1pbWUpe3RoaXMuX2hlYWRlcnNbImNvbnRlbnQtdHlwZSJdPW1pbWU7cmV0dXJuIHRoaXN9O1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zZW5kPWZ1bmN0aW9uKGRhdGEpe2RhdGE9ZGF0YXx8bnVsbDt2YXIgc2VsZj10aGlzLG9wdGlvbnMscGFyc2VkLHJlcXVlc3Qsb2JqO2lmKHRoaXMucmVhZHlTdGF0ZTxPUEVORUQpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRTdGF0ZU5vdE9wZW4pO2Vsc2UgaWYodGhpcy5fc2VuZCl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZFN0YXRlTm90U2VuZGluZyk7CnBhcnNlZD11dGlsaXR5LnBhcnNlKHRoaXMuX3BhcmFtcy51cmwpO3BhcnNlZC5wb3J0PXBhcnNlZC5wb3J0fHwocGFyc2VkLnByb3RvY29sPT09Imh0dHBzOiI/NDQzOjgwKTtpZih0aGlzLl9wYXJhbXMudXNlciE9PW51bGwmJnRoaXMuX3BhcmFtcy5wYXNzd29yZCE9PW51bGwpcGFyc2VkLmF1dGg9dGhpcy5fcGFyYW1zLnVzZXIrIjoiK3RoaXMuX3BhcmFtcy5wYXNzd29yZDtpZihyZWdleC5wdXRfcG9zdC50ZXN0KHRoaXMuX3BhcmFtcy5tZXRob2QpKWlmKGRhdGE9PT1udWxsKXRoaXMuX2hlYWRlcnNbImNvbnRlbnQtbGVuZ3RoIl09MDtlbHNlIGlmKHR5cGVvZiBkYXRhPT0ic3RyaW5nIil0aGlzLl9oZWFkZXJzWyJjb250ZW50LWxlbmd0aCJdPUJ1ZmZlci5ieXRlTGVuZ3RoKGRhdGEpO2Vsc2UgaWYoZGF0YSBpbnN0YW5jZW9mIEJ1ZmZlcnx8dHlwZW9mIGRhdGEudG9TdHJpbmc9PSJmdW5jdGlvbiIpe2RhdGE9ZGF0YS50b1N0cmluZygpO3RoaXMuX2hlYWRlcnNbImNvbnRlbnQtbGVuZ3RoIl09CkJ1ZmZlci5ieXRlTGVuZ3RoKGRhdGEpfWVsc2UgdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRBcmd1bWVudHMpO3RoaXMuX2hlYWRlcnMuaG9zdD1wYXJzZWQuaG9zdDtpZih0aGlzLl9oZWFkZXJzWyJ4LXJlcXVlc3RlZC13aXRoIl09PT0iWE1MSHR0cFJlcXVlc3QiKWRlbGV0ZSB0aGlzLl9oZWFkZXJzWyJ4LXJlcXVlc3RlZC13aXRoIl07b3B0aW9ucz17aG9zdG5hbWU6cGFyc2VkLmhvc3RuYW1lLHBhdGg6cGFyc2VkLnBhdGgscG9ydDpwYXJzZWQucG9ydCxtZXRob2Q6dGhpcy5fcGFyYW1zLm1ldGhvZCxoZWFkZXJzOnRoaXMuX2hlYWRlcnN9O2lmKHBhcnNlZC5wcm90b2NvbD09PSJodHRwczoiKXtvcHRpb25zLnJlamVjdFVuYXV0aG9yaXplZD1mYWxzZTtvcHRpb25zLmFnZW50PWZhbHNlfWlmKHBhcnNlZC5hdXRoKW9wdGlvbnMuYXV0aD1wYXJzZWQuYXV0aDt0aGlzLl9zZW5kPXRydWU7ZGlzcGF0Y2guY2FsbCh0aGlzLCJyZWFkeXN0YXRlY2hhbmdlIik7b2JqPXBhcnNlZC5wcm90b2NvbD09PQoiaHR0cDoiP2h0dHA6aHR0cHM7cmVxdWVzdD1vYmoucmVxdWVzdChvcHRpb25zLGZ1bmN0aW9uKGFyZyl7c3VjY2Vzcy5jYWxsKHNlbGYsYXJnKX0pLm9uKCJlcnJvciIsZnVuY3Rpb24oZSl7ZmFpbHVyZS5jYWxsKHNlbGYsZSl9KTtkYXRhPT09bnVsbD9yZXF1ZXN0LnNldFNvY2tldEtlZXBBbGl2ZSh0cnVlKTpyZXF1ZXN0LndyaXRlKGRhdGEsInV0ZjgiKTt0aGlzLl9yZXF1ZXN0PXJlcXVlc3Q7cmVxdWVzdC5lbmQoKTtkaXNwYXRjaC5jYWxsKHRoaXMsImxvYWRzdGFydCIpO3JldHVybiB0aGlzfTtYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuc2V0UmVxdWVzdEhlYWRlcj1mdW5jdGlvbihoZWFkZXIsdmFsdWUpe2lmKHRoaXMucmVhZHlTdGF0ZSE9PU9QRU5FRCl0aHJvdyBuZXcgRXJyb3IobGFiZWwuaW52YWxpZFN0YXRlTm90VXNhYmxlKTtlbHNlIGlmKHRoaXMuX3NlbmQpdGhyb3cgbmV3IEVycm9yKGxhYmVsLmludmFsaWRTdGF0ZU5vdFNlbmRpbmcpO3RoaXMuX2hlYWRlcnNbaGVhZGVyLnRvTG93ZXJDYXNlKCldPQp2YWx1ZTtyZXR1cm4gdGhpc307cmV0dXJuIFhNTEh0dHBSZXF1ZXN0fXZhciB4bWw9e2RlY29kZTpmdW5jdGlvbihhcmcpe2lmKHR5cGVvZiBhcmchPSJzdHJpbmcifHxzdHJpbmcuaXNFbXB0eShhcmcpKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTtyZXR1cm4obmV3IERPTVBhcnNlcikucGFyc2VGcm9tU3RyaW5nKGFyZywidGV4dC94bWwiKX0sZW5jb2RlOmZ1bmN0aW9uKGFyZyx3cmFwKXt0cnl7aWYoYXJnPT09dW5kZWZpbmVkKXRocm93IG5ldyBFcnJvcihsYWJlbC5pbnZhbGlkQXJndW1lbnRzKTt3cmFwPXdyYXAhPT1mYWxzZTt2YXIgeD13cmFwPyI8eG1sPiI6IiIsdG9wPWFyZ3VtZW50c1syXSE9PWZhbHNlLG5vZGU7bm9kZT1mdW5jdGlvbihuYW1lLHZhbHVlKXt2YXIgb3V0cHV0PSI8bj52PC9uPiI7b3V0cHV0PW91dHB1dC5yZXBsYWNlKCJ2IixyZWdleC5jZGF0YS50ZXN0KHZhbHVlKT8iPCFbQ0RBVEFbIit2YWx1ZSsiXV1ceDNlIjp2YWx1ZSk7CnJldHVybiBvdXRwdXQucmVwbGFjZSgvPChcLyk/bj4vZywiPCQxIituYW1lKyI+Iil9O2lmKGFyZyE9PW51bGwmJmFyZy54bWwpYXJnPWFyZy54bWw7aWYoYXJnIGluc3RhbmNlb2YgRG9jdW1lbnQpYXJnPShuZXcgWE1MU2VyaWFsaXplcikuc2VyaWFsaXplVG9TdHJpbmcoYXJnKTtpZihyZWdleC5ib29sZWFuX251bWJlcl9zdHJpbmcudGVzdCh0eXBlb2YgYXJnKSl4Kz1ub2RlKCJpdGVtIixhcmcpO2Vsc2UgaWYodHlwZW9mIGFyZz09Im9iamVjdCIpdXRpbGl0eS5pdGVyYXRlKGFyZyxmdW5jdGlvbih2LGspe3grPXhtbC5lbmNvZGUodix0eXBlb2Ygdj09Im9iamVjdCIsZmFsc2UpLnJlcGxhY2UoL2l0ZW18eG1sL2csaXNOYU4oayk/azoiaXRlbSIpfSk7eCs9d3JhcD8iPC94bWw+IjoiIjtpZih0b3ApeD0nPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGOCI/PicreDtyZXR1cm4geH1jYXRjaChlKXt1dGlsaXR5LmVycm9yKGUsYXJndW1lbnRzLHRoaXMpO3JldHVybiB1bmRlZmluZWR9fSwKdmFsaWQ6ZnVuY3Rpb24oYXJnKXtyZXR1cm4geG1sLmRlY29kZShhcmcpLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwYXJzZXJlcnJvciIpLmxlbmd0aD09PTB9fTtmdW5jdGlvbiBib290c3RyYXAoKXtmdW5jdGlvbiBpbml0KCl7VElNRT0obmV3IERhdGUpLmdldFRpbWUoKTt1dGlsaXR5LnJlcGVhdChmdW5jdGlvbigpe2NhY2hlLmNsZWFuKCl9LDZFNCwiY2FjaGVHYXJiYWdlQ29sbGVjdG9yIil9ZnVuY3Rpb24gZm4oKXtpZihyZWdleC5jb21wbGV0ZV9sb2FkZWQudGVzdChkb2N1bWVudC5yZWFkeVN0YXRlKSl7aW5pdCgpO3JldHVybiBmYWxzZX19aWYoIXNlcnZlcil7Y2xpZW50LnZlcnNpb249Y2xpZW50LnZlcnNpb24oKTtpZihjbGllbnQuaWUmJmNsaWVudC52ZXJzaW9uPDkpdGhyb3cgbmV3IEVycm9yKGxhYmVsLnVwZ3JhZGUpO2lmKEVsZW1lbnQucHJvdG90eXBlLmdldEVsZW1lbnRzQnlDbGFzc05hbWU9PT11bmRlZmluZWQpRWxlbWVudC5wcm90b3R5cGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT0KZnVuY3Rpb24oYXJnKXtyZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLiIrYXJnKX07aWYoIWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QpKGZ1bmN0aW9uKHZpZXcpe3ZhciBDbGFzc0xpc3QsZ2V0dGVyLHByb3RvLHRhcmdldCxkZXNjcmlwdG9yO2lmKCEoIkhUTUxFbGVtZW50ImluIHZpZXcpJiYhKCJFbGVtZW50ImluIHZpZXcpKXJldHVybjtDbGFzc0xpc3Q9ZnVuY3Rpb24ob2JqKXt2YXIgY2xhc3Nlcz1zdHJpbmcuZXhwbG9kZShvYmouY2xhc3NOYW1lLCIgIiksc2VsZj10aGlzO2FycmF5LmVhY2goY2xhc3NlcyxmdW5jdGlvbihpKXtzZWxmLnB1c2goaSl9KTt0aGlzLnVwZGF0ZUNsYXNzTmFtZT1mdW5jdGlvbigpe29iai5jbGFzc05hbWU9dGhpcy5qb2luKCIgIil9fTtnZXR0ZXI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IENsYXNzTGlzdCh0aGlzKX07cHJvdG89Q2xhc3NMaXN0LnByb3RvdHlwZT1bXTt0YXJnZXQ9KHZpZXcuSFRNTEVsZW1lbnR8fAp2aWV3LkVsZW1lbnQpLnByb3RvdHlwZTtwcm90by5hZGQ9ZnVuY3Rpb24oYXJnKXtpZighYXJyYXkuY29udGFpbnModGhpcyxhcmcpKXt0aGlzLnB1c2goYXJnKTt0aGlzLnVwZGF0ZUNsYXNzTmFtZSgpfX07cHJvdG8uY29udGFpbnM9ZnVuY3Rpb24oYXJnKXtyZXR1cm4gYXJyYXkuY29udGFpbnModGhpcyxhcmcpfTtwcm90by5yZW1vdmU9ZnVuY3Rpb24oYXJnKXtpZihhcnJheS5jb250YWlucyh0aGlzLGFyZykpe2FycmF5LnJlbW92ZSh0aGlzLGFyZyk7dGhpcy51cGRhdGVDbGFzc05hbWUoKX19O3Byb3RvLnRvZ2dsZT1mdW5jdGlvbihhcmcpe2FycmF5W2FycmF5LmNvbnRhaW5zKHRoaXMsYXJnKT8icmVtb3ZlIjoiYWRkIl0odGhpcyxhcmcpO3RoaXMudXBkYXRlQ2xhc3NOYW1lKCl9O2lmKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSl7ZGVzY3JpcHRvcj17Z2V0OmdldHRlcixlbnVtZXJhYmxlOnRydWUsY29uZmlndXJhYmxlOnRydWV9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsCiJjbGFzc0xpc3QiLGRlc2NyaXB0b3IpfWVsc2UgaWYoT2JqZWN0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fKXRhcmdldC5fX2RlZmluZUdldHRlcl9fKCJjbGFzc0xpc3QiLGdldHRlcik7ZWxzZSB0aHJvdyBuZXcgRXJyb3IoIkNvdWxkIG5vdCBjcmVhdGUgY2xhc3NMaXN0IHNoaW0iKTt9KShnbG9iYWwpfWVsc2UgWE1MSHR0cFJlcXVlc3Q9eGhyKCk7aGFzPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7c2xpY2U9QXJyYXkucHJvdG90eXBlLnNsaWNlO2lmKHdlYldvcmtlcilXT1JLRVI9Z2xvYmFsLlVSTC5jcmVhdGVPYmplY3RVUkwodXRpbGl0eS5ibG9iKCJ2YXIgIitzdHJpbmcuZnJvbU9iamVjdChhcnJheSwiYXJyYXkiKSsiLCAiK3N0cmluZy5mcm9tT2JqZWN0KHJlZ2V4LCJyZWdleCIpKyIsICIrc3RyaW5nLmZyb21PYmplY3Qoc3RyaW5nLCJzdHJpbmciKSsiLCAiK3N0cmluZy5mcm9tT2JqZWN0KHV0aWxpdHksInV0aWxpdHkiKSsiOyBvbm1lc3NhZ2UgPSAiKwpzdG9yZS53b3JrZXIudG9TdHJpbmcoKSsiOyIpKTtSRU5ERVI9Z2xvYmFsLnJlcXVlc3RBbmltYXRpb25GcmFtZXx8ZnVuY3Rpb24oZm4pe3ZhciBvZmZzZXQ9KG5ldyBEYXRlKS5nZXRUaW1lKCktVElNRTt1dGlsaXR5LmRlZmVyKGZ1bmN0aW9uKCl7Zm4ob2Zmc2V0KX0sMTYsb2Zmc2V0KX07aWYodHlwZW9mIGV4cG9ydHMhPSJ1bmRlZmluZWQifHx0eXBlb2YgZGVmaW5lPT0iZnVuY3Rpb24ifHxyZWdleC5jb21wbGV0ZV9sb2FkZWQudGVzdChkb2N1bWVudC5yZWFkeVN0YXRlKSlpbml0KCk7ZWxzZSBpZih0eXBlb2YgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcj09ImZ1bmN0aW9uIilkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixmdW5jdGlvbigpe2luaXQoKX0sZmFsc2UpO2Vsc2UgaWYodHlwZW9mIGRvY3VtZW50LmF0dGFjaEV2ZW50PT0iZnVuY3Rpb24iKWRvY3VtZW50LmF0dGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLGZuKTtlbHNlIHV0aWxpdHkucmVwZWF0KGZuKX0KYm9vdHN0cmFwKCk7cmV0dXJue2ZpbHRlcjpmaWx0ZXIuZmFjdG9yeSxsaXN0Omxpc3QuZmFjdG9yeSxncmlkOmdyaWQuZmFjdG9yeSxzdG9yZTpzdG9yZS5mYWN0b3J5LHV0aWw6eyQ6dXRpbGl0eS4kLGFycmF5OmFycmF5LGJhc2U6dXRpbGl0eS5iYXNlLGNsb25lOnV0aWxpdHkuY2xvbmUsY29lcmNlOnV0aWxpdHkuY29lcmNlLGN1cnJ5OnV0aWxpdHkuY3VycnksY3N2OmNzdixkZWZlcjpkZWZlcnJlZC5mYWN0b3J5LGVsZW1lbnQ6ZWxlbWVudCxleHRlbmQ6dXRpbGl0eS5leHRlbmQsZ2VuSWQ6dXRpbGl0eS5nZW5JZCxpdGVyYXRlOnV0aWxpdHkuaXRlcmF0ZSxqc29uOmpzb24sanNvbnA6Y2xpZW50Lmpzb25wLGxvZzp1dGlsaXR5LmxvZyxscnU6bHJ1LmZhY3RvcnksbWF0aDptYXRoLG1lcmdlOnV0aWxpdHkubWVyZ2UsbnVtYmVyOm51bWJlcixvYnNlcnZlcjpvYnNlcnZhYmxlLmZhY3RvcnkscGFyc2U6dXRpbGl0eS5wYXJzZSxwYXJ0aWFsOnV0aWxpdHkucGFydGlhbCxwcmV2ZW50OnV0aWxpdHkucHJldmVudCwKcmFjZTp1dGlsaXR5LnJhY2UscmVuZGVyOnV0aWxpdHkucmVuZGVyLHJlcGVhdDp1dGlsaXR5LnJlcGVhdCxyZXF1ZXN0OmNsaWVudC5yZXF1ZXN0LHN0b3A6dXRpbGl0eS5zdG9wLHN0cmluZzpzdHJpbmcsdGFyZ2V0OnV0aWxpdHkudGFyZ2V0LHV1aWQ6dXRpbGl0eS51dWlkLHdhbGs6dXRpbGl0eS53YWxrLHdoZW46dXRpbGl0eS53aGVufSx2ZXJzaW9uOiIwLjkuMCJ9fSgpO2lmKHR5cGVvZiBleHBvcnRzIT0idW5kZWZpbmVkIiltb2R1bGUuZXhwb3J0cz1saWI7ZWxzZSBpZih0eXBlb2YgZGVmaW5lPT0iZnVuY3Rpb24iKWRlZmluZShmdW5jdGlvbigpe3JldHVybiBsaWJ9KTtlbHNlIGdsb2JhbC5rZWlnYWk9bGlifSkodGhpcyk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlaWdhaS5tYXAK",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 07:59:18 GMT",
                    "Content-Length": "98625",
                    "Date": "Fri, 07 Nov 2014 07:59:19 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}