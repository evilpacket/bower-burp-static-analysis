{
    "url": "http://localhost:9999/MinnPost/minnpost-styles/bower_components/datatables/media/src/core/core.state.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cookie manipulation (DOM-based)",
    "issueType": 5245696,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based cookie manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the value of a cookie in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will set an arbitrary value in the user's cookie.<br><br>The potential impact of the vulnerability depends on the role that the cookie plays within the application. If the cookie is used to control the behavior that results from certain user actions (for example, a 'production' versus 'demo' mode setting), then the attacker may be able to cause the user to perform unintended actions by manipulating the cookie's value. If the cookie is used to track the user's session, then the attacker may be able to perform a session fixation attack, in which they set the cookie's value to a valid token that they have obtained from the application, and then hijack the session during the victim user's subsequent interaction with the application.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cookie manipulation vulnerabilities is not to dynamically write to cookies using data that originated from any untrusted source. This behavior should never be implemented for cookies that have any role in controlling privileged actions or user sessions within the application.",
    "issueDetail": "The application may be vulnerable to DOM-based cookie manipulation. Data is read from <b>window.location.pathname</b> and written to <b>document.cookie</b> via the following statements:<ul><li>var aParts = window.location.pathname.split('/');</li><li>document.cookie = old.name+\"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=\"+     aParts.join('/') + \"/\";</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/MinnPost/minnpost-styles/bower_components/datatables/media/src/core/core.state.js",
                "path": "/MinnPost/minnpost-styles/bower_components/datatables/media/src/core/core.state.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9NaW5uUG9zdC9taW5ucG9zdC1zdHlsZXMvYm93ZXJfY29tcG9uZW50cy9kYXRhdGFibGVzL21lZGlhL3NyYy9jb3JlL2NvcmUuc3RhdGUuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjQ5MA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAxNjowOTo0OCBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMTY6MDk6NDYgR01UDQoNCgoKLyoqCiAqIFNhdmUgdGhlIHN0YXRlIG9mIGEgdGFibGUgaW4gYSBjb29raWUgc3VjaCB0aGF0IHRoZSBwYWdlIGNhbiBiZSByZWxvYWRlZAogKiAgQHBhcmFtIHtvYmplY3R9IG9TZXR0aW5ncyBkYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdAogKiAgQG1lbWJlcm9mIERhdGFUYWJsZSNvQXBpCiAqLwpmdW5jdGlvbiBfZm5TYXZlU3RhdGUgKCBvU2V0dGluZ3MgKQp7CglpZiAoICFvU2V0dGluZ3Mub0ZlYXR1cmVzLmJTdGF0ZVNhdmUgfHwgb1NldHRpbmdzLmJEZXN0cm95aW5nICkKCXsKCQlyZXR1cm47Cgl9CgoJLyogU3RvcmUgdGhlIGludGVyZXN0aW5nIHZhcmlhYmxlcyAqLwoJdmFyIGksIGlMZW4sIGJJbmZpbml0ZT1vU2V0dGluZ3Mub1Njcm9sbC5iSW5maW5pdGU7Cgl2YXIgb1N0YXRlID0gewoJCSJpQ3JlYXRlIjogICAgICBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKCQkiaVN0YXJ0IjogICAgICAgKGJJbmZpbml0ZSA/IDAgOiBvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQpLAoJCSJpRW5kIjogICAgICAgICAoYkluZmluaXRlID8gb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCA6IG9TZXR0aW5ncy5faURpc3BsYXlFbmQpLAoJCSJpTGVuZ3RoIjogICAgICBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoLAoJCSJhYVNvcnRpbmciOiAgICAkLmV4dGVuZCggdHJ1ZSwgW10sIG9TZXR0aW5ncy5hYVNvcnRpbmcgKSwKCQkib1NlYXJjaCI6ICAgICAgJC5leHRlbmQoIHRydWUsIHt9LCBvU2V0dGluZ3Mub1ByZXZpb3VzU2VhcmNoICksCgkJImFvU2VhcmNoQ29scyI6ICQuZXh0ZW5kKCB0cnVlLCBbXSwgb1NldHRpbmdzLmFvUHJlU2VhcmNoQ29scyApLAoJCSJhYlZpc0NvbHMiOiAgICBbXQoJfTsKCglmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJewoJCW9TdGF0ZS5hYlZpc0NvbHMucHVzaCggb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5iVmlzaWJsZSApOwoJfQoKCV9mbkNhbGxiYWNrRmlyZSggb1NldHRpbmdzLCAiYW9TdGF0ZVNhdmVQYXJhbXMiLCAnc3RhdGVTYXZlUGFyYW1zJywgW29TZXR0aW5ncywgb1N0YXRlXSApOwoJCglvU2V0dGluZ3MuZm5TdGF0ZVNhdmUuY2FsbCggb1NldHRpbmdzLm9JbnN0YW5jZSwgb1NldHRpbmdzLCBvU3RhdGUgKTsKfQoKCi8qKgogKiBBdHRlbXB0IHRvIGxvYWQgYSBzYXZlZCB0YWJsZSBzdGF0ZSBmcm9tIGEgY29va2llCiAqICBAcGFyYW0ge29iamVjdH0gb1NldHRpbmdzIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CiAqICBAcGFyYW0ge29iamVjdH0gb0luaXQgRGF0YVRhYmxlcyBpbml0IG9iamVjdCBzbyB3ZSBjYW4gb3ZlcnJpZGUgc2V0dGluZ3MKICogIEBtZW1iZXJvZiBEYXRhVGFibGUjb0FwaQogKi8KZnVuY3Rpb24gX2ZuTG9hZFN0YXRlICggb1NldHRpbmdzLCBvSW5pdCApCnsKCWlmICggIW9TZXR0aW5ncy5vRmVhdHVyZXMuYlN0YXRlU2F2ZSApCgl7CgkJcmV0dXJuOwoJfQoKCXZhciBvRGF0YSA9IG9TZXR0aW5ncy5mblN0YXRlTG9hZC5jYWxsKCBvU2V0dGluZ3Mub0luc3RhbmNlLCBvU2V0dGluZ3MgKTsKCWlmICggIW9EYXRhICkKCXsKCQlyZXR1cm47Cgl9CgkKCS8qIEFsbG93IGN1c3RvbSBhbmQgcGx1Zy1pbiBtYW5pcHVsYXRpb24gZnVuY3Rpb25zIHRvIGFsdGVyIHRoZSBzYXZlZCBkYXRhIHNldCBhbmQKCSAqIGNhbmNlbGxpbmcgb2YgbG9hZGluZyBieSByZXR1cm5pbmcgZmFsc2UKCSAqLwoJdmFyIGFiU3RhdGVMb2FkID0gX2ZuQ2FsbGJhY2tGaXJlKCBvU2V0dGluZ3MsICdhb1N0YXRlTG9hZFBhcmFtcycsICdzdGF0ZUxvYWRQYXJhbXMnLCBbb1NldHRpbmdzLCBvRGF0YV0gKTsKCWlmICggJC5pbkFycmF5KCBmYWxzZSwgYWJTdGF0ZUxvYWQgKSAhPT0gLTEgKQoJewoJCXJldHVybjsKCX0KCQoJLyogU3RvcmUgdGhlIHNhdmVkIHN0YXRlIHNvIGl0IG1pZ2h0IGJlIGFjY2Vzc2VkIGF0IGFueSB0aW1lICovCglvU2V0dGluZ3Mub0xvYWRlZFN0YXRlID0gJC5leHRlbmQoIHRydWUsIHt9LCBvRGF0YSApOwoJCgkvKiBSZXN0b3JlIGtleSBmZWF0dXJlcyAqLwoJb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0ICAgID0gb0RhdGEuaVN0YXJ0OwoJb1NldHRpbmdzLmlJbml0RGlzcGxheVN0YXJ0ID0gb0RhdGEuaVN0YXJ0OwoJb1NldHRpbmdzLl9pRGlzcGxheUVuZCAgICAgID0gb0RhdGEuaUVuZDsKCW9TZXR0aW5ncy5faURpc3BsYXlMZW5ndGggICA9IG9EYXRhLmlMZW5ndGg7CglvU2V0dGluZ3MuYWFTb3J0aW5nICAgICAgICAgPSBvRGF0YS5hYVNvcnRpbmcuc2xpY2UoKTsKCW9TZXR0aW5ncy5zYXZlZF9hYVNvcnRpbmcgICA9IG9EYXRhLmFhU29ydGluZy5zbGljZSgpOwoJCgkvKiBTZWFyY2ggZmlsdGVyaW5nICAqLwoJJC5leHRlbmQoIG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2gsIG9EYXRhLm9TZWFyY2ggKTsKCSQuZXh0ZW5kKCB0cnVlLCBvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzLCBvRGF0YS5hb1NlYXJjaENvbHMgKTsKCQoJLyogQ29sdW1uIHZpc2liaWxpdHkgc3RhdGUKCSAqIFBhc3MgYmFjayB2aXNpYmlsaXR5IHNldHRpbmdzIHRvIHRoZSBpbml0IGhhbmRsZXIsIGJ1dCB0byBkbyBub3QgaGVyZSBvdmVycmlkZQoJICogdGhlIGluaXQgb2JqZWN0IHRoYXQgdGhlIHVzZXIgbWlnaHQgaGF2ZSBwYXNzZWQgaW4KCSAqLwoJb0luaXQuc2F2ZWRfYW9Db2x1bW5zID0gW107Cglmb3IgKCB2YXIgaT0wIDsgaTxvRGF0YS5hYlZpc0NvbHMubGVuZ3RoIDsgaSsrICkKCXsKCQlvSW5pdC5zYXZlZF9hb0NvbHVtbnNbaV0gPSB7fTsKCQlvSW5pdC5zYXZlZF9hb0NvbHVtbnNbaV0uYlZpc2libGUgPSBvRGF0YS5hYlZpc0NvbHNbaV07Cgl9CgoJX2ZuQ2FsbGJhY2tGaXJlKCBvU2V0dGluZ3MsICdhb1N0YXRlTG9hZGVkJywgJ3N0YXRlTG9hZGVkJywgW29TZXR0aW5ncywgb0RhdGFdICk7Cn0KCgovKioKICogQ3JlYXRlIGEgbmV3IGNvb2tpZSB3aXRoIGEgdmFsdWUgdG8gc3RvcmUgdGhlIHN0YXRlIG9mIGEgdGFibGUKICogIEBwYXJhbSB7c3RyaW5nfSBzTmFtZSBuYW1lIG9mIHRoZSBjb29raWUgdG8gY3JlYXRlCiAqICBAcGFyYW0ge3N0cmluZ30gc1ZhbHVlIHRoZSB2YWx1ZSB0aGUgY29va2llIHNob3VsZCB0YWtlCiAqICBAcGFyYW0ge2ludH0gaVNlY3MgZHVyYXRpb24gb2YgdGhlIGNvb2tpZQogKiAgQHBhcmFtIHtzdHJpbmd9IHNCYXNlTmFtZSBzTmFtZSBpcyBtYWRlIHVwIG9mIHRoZSBiYXNlICsgZmlsZSBuYW1lIC0gdGhpcyBpcyB0aGUgYmFzZQogKiAgQHBhcmFtIHtmdW5jdGlvbn0gZm5DYWxsYmFjayBVc2VyIGRlZmluYWJsZSBmdW5jdGlvbiB0byBtb2RpZnkgdGhlIGNvb2tpZQogKiAgQG1lbWJlcm9mIERhdGFUYWJsZSNvQXBpCiAqLwpmdW5jdGlvbiBfZm5DcmVhdGVDb29raWUgKCBzTmFtZSwgc1ZhbHVlLCBpU2Vjcywgc0Jhc2VOYW1lLCBmbkNhbGxiYWNrICkKewoJdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwoJZGF0ZS5zZXRUaW1lKCBkYXRlLmdldFRpbWUoKSsoaVNlY3MqMTAwMCkgKTsKCQoJLyogCgkgKiBTaG9ja2luZyBidXQgdHJ1ZSAtIGl0IHdvdWxkIGFwcGVhciBJRSBoYXMgbWFqb3IgaXNzdWVzIHdpdGggaGF2aW5nIHRoZSBwYXRoIG5vdCBoYXZpbmcKCSAqIGEgdHJhaWxpbmcgc2xhc2ggb24gaXQuIFdlIG5lZWQgdGhlIGNvb2tpZSB0byBiZSBhdmFpbGFibGUgYmFzZWQgb24gdGhlIHBhdGgsIHNvIHdlCgkgKiBoYXZlIHRvIGFwcGVuZCB0aGUgZmlsZSBuYW1lIHRvIHRoZSBjb29raWUgbmFtZS4gQXBwYWxsaW5nLiBUaGFua3MgdG8gdmV4IGZvciBhZGRpbmcgdGhlCgkgKiBwYXRjaCB0byB1c2UgYXQgbGVhc3Qgc29tZSBvZiB0aGUgcGF0aAoJICovCgl2YXIgYVBhcnRzID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJyk7Cgl2YXIgc05hbWVGaWxlID0gc05hbWUgKyAnXycgKyBhUGFydHMucG9wKCkucmVwbGFjZSgvW1wvOl0vZywiIikudG9Mb3dlckNhc2UoKTsKCXZhciBzRnVsbENvb2tpZSwgb0RhdGE7CgkKCWlmICggZm5DYWxsYmFjayAhPT0gbnVsbCApCgl7CgkJb0RhdGEgPSAodHlwZW9mICQucGFyc2VKU09OID09PSAnZnVuY3Rpb24nKSA/IAoJCQkkLnBhcnNlSlNPTiggc1ZhbHVlICkgOiBldmFsKCAnKCcrc1ZhbHVlKycpJyApOwoJCXNGdWxsQ29va2llID0gZm5DYWxsYmFjayggc05hbWVGaWxlLCBvRGF0YSwgZGF0ZS50b0dNVFN0cmluZygpLAoJCQlhUGFydHMuam9pbignLycpKyIvIiApOwoJfQoJZWxzZQoJewoJCXNGdWxsQ29va2llID0gc05hbWVGaWxlICsgIj0iICsgZW5jb2RlVVJJQ29tcG9uZW50KHNWYWx1ZSkgKwoJCQkiOyBleHBpcmVzPSIgKyBkYXRlLnRvR01UU3RyaW5nKCkgKyI7IHBhdGg9IiArIGFQYXJ0cy5qb2luKCcvJykrIi8iOwoJfQoJCgkvKiBBcmUgd2UgZ29pbmcgdG8gZ28gb3ZlciB0aGUgY29va2llIGxpbWl0IG9mIDRLaUI/IElmIHNvLCB0cnkgdG8gZGVsZXRlIGEgY29va2llcwoJICogYmVsb25naW5nIHRvIERhdGFUYWJsZXMuCgkgKi8KCXZhcgoJCWFDb29raWVzID1kb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKSwKCQlpTmV3Q29va2llTGVuID0gc0Z1bGxDb29raWUuc3BsaXQoJzsnKVswXS5sZW5ndGgsCgkJYU9sZENvb2tpZXMgPSBbXTsKCQoJaWYgKCBpTmV3Q29va2llTGVuK2RvY3VtZW50LmNvb2tpZS5sZW5ndGgrMTAgPiA0MDk2ICkgLyogTWFnaWMgMTAgZm9yIHBhZGRpbmcgKi8KCXsKCQlmb3IgKCB2YXIgaT0wLCBpTGVuPWFDb29raWVzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJewoJCQlpZiAoIGFDb29raWVzW2ldLmluZGV4T2YoIHNCYXNlTmFtZSApICE9IC0xICkKCQkJewoJCQkJLyogSXQncyBhIERhdGFUYWJsZXMgY29va2llLCBzbyBldmFsIGl0IGFuZCBjaGVjayB0aGUgdGltZSBzdGFtcCAqLwoJCQkJdmFyIGFTcGxpdENvb2tpZSA9IGFDb29raWVzW2ldLnNwbGl0KCc9Jyk7CgkJCQl0cnkgewoJCQkJCW9EYXRhID0gZXZhbCggJygnK2RlY29kZVVSSUNvbXBvbmVudChhU3BsaXRDb29raWVbMV0pKycpJyApOwoKCQkJCQlpZiAoIG9EYXRhICYmIG9EYXRhLmlDcmVhdGUgKQoJCQkJCXsKCQkJCQkJYU9sZENvb2tpZXMucHVzaCggewoJCQkJCQkJIm5hbWUiOiBhU3BsaXRDb29raWVbMF0sCgkJCQkJCQkidGltZSI6IG9EYXRhLmlDcmVhdGUKCQkJCQkJfSApOwoJCQkJCX0KCQkJCX0KCQkJCWNhdGNoKCBlICkge30KCQkJfQoJCX0KCgkJLy8gTWFrZSBzdXJlIHdlIGRlbGV0ZSB0aGUgb2xkZXN0IG9uZXMgZmlyc3QKCQlhT2xkQ29va2llcy5zb3J0KCBmdW5jdGlvbiAoYSwgYikgewoJCQlyZXR1cm4gYi50aW1lIC0gYS50aW1lOwoJCX0gKTsKCgkJLy8gRWxpbWluYXRlIGFzIG1hbnkgb2xkIERhdGFUYWJsZXMgY29va2llcyBhcyB3ZSBuZWVkIHRvCgkJd2hpbGUgKCBpTmV3Q29va2llTGVuICsgZG9jdW1lbnQuY29va2llLmxlbmd0aCArIDEwID4gNDA5NiApIHsKCQkJaWYgKCBhT2xkQ29va2llcy5sZW5ndGggPT09IDAgKSB7CgkJCQkvLyBEZWxldGVkIGFsbCBEVCBjb29raWVzIGFuZCBzdGlsbCBub3QgZW5vdWdoIHNwYWNlLiBDYW4ndCBzdGF0ZSBzYXZlCgkJCQlyZXR1cm47CgkJCX0KCQkJCgkJCXZhciBvbGQgPSBhT2xkQ29va2llcy5wb3AoKTsKCQkJZG9jdW1lbnQuY29va2llID0gb2xkLm5hbWUrIj07IGV4cGlyZXM9VGh1LCAwMS1KYW4tMTk3MCAwMDowMDowMSBHTVQ7IHBhdGg9IisKCQkJCWFQYXJ0cy5qb2luKCcvJykgKyAiLyI7CgkJfQoJfQoJCglkb2N1bWVudC5jb29raWUgPSBzRnVsbENvb2tpZTsKfQoKCi8qKgogKiBSZWFkIGFuIG9sZCBjb29raWUgdG8gZ2V0IGEgY29va2llIHdpdGggYW4gb2xkIHRhYmxlIHN0YXRlCiAqICBAcGFyYW0ge3N0cmluZ30gc05hbWUgbmFtZSBvZiB0aGUgY29va2llIHRvIHJlYWQKICogIEByZXR1cm5zIHtzdHJpbmd9IGNvbnRlbnRzIG9mIHRoZSBjb29raWUgLSBvciBudWxsIGlmIG5vIGNvb2tpZSB3aXRoIHRoYXQgbmFtZSBmb3VuZAogKiAgQG1lbWJlcm9mIERhdGFUYWJsZSNvQXBpCiAqLwpmdW5jdGlvbiBfZm5SZWFkQ29va2llICggc05hbWUgKQp7Cgl2YXIKCQlhUGFydHMgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKSwKCQlzTmFtZUVRID0gc05hbWUgKyAnXycgKyBhUGFydHNbYVBhcnRzLmxlbmd0aC0xXS5yZXBsYWNlKC9bXC86XS9nLCIiKS50b0xvd2VyQ2FzZSgpICsgJz0nLAoJIAlzQ29va2llQ29udGVudHMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTsKCQoJZm9yKCB2YXIgaT0wIDsgaTxzQ29va2llQ29udGVudHMubGVuZ3RoIDsgaSsrICkKCXsKCQl2YXIgYyA9IHNDb29raWVDb250ZW50c1tpXTsKCQkKCQl3aGlsZSAoYy5jaGFyQXQoMCk9PScgJykKCQl7CgkJCWMgPSBjLnN1YnN0cmluZygxLGMubGVuZ3RoKTsKCQl9CgkJCgkJaWYgKGMuaW5kZXhPZihzTmFtZUVRKSA9PT0gMCkKCQl7CgkJCXJldHVybiBkZWNvZGVVUklDb21wb25lbnQoIGMuc3Vic3RyaW5nKHNOYW1lRVEubGVuZ3RoLGMubGVuZ3RoKSApOwoJCX0KCX0KCXJldHVybiBudWxsOwp9Cgo=",
                "body": "CgovKioKICogU2F2ZSB0aGUgc3RhdGUgb2YgYSB0YWJsZSBpbiBhIGNvb2tpZSBzdWNoIHRoYXQgdGhlIHBhZ2UgY2FuIGJlIHJlbG9hZGVkCiAqICBAcGFyYW0ge29iamVjdH0gb1NldHRpbmdzIGRhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CiAqICBAbWVtYmVyb2YgRGF0YVRhYmxlI29BcGkKICovCmZ1bmN0aW9uIF9mblNhdmVTdGF0ZSAoIG9TZXR0aW5ncyApCnsKCWlmICggIW9TZXR0aW5ncy5vRmVhdHVyZXMuYlN0YXRlU2F2ZSB8fCBvU2V0dGluZ3MuYkRlc3Ryb3lpbmcgKQoJewoJCXJldHVybjsKCX0KCgkvKiBTdG9yZSB0aGUgaW50ZXJlc3RpbmcgdmFyaWFibGVzICovCgl2YXIgaSwgaUxlbiwgYkluZmluaXRlPW9TZXR0aW5ncy5vU2Nyb2xsLmJJbmZpbml0ZTsKCXZhciBvU3RhdGUgPSB7CgkJImlDcmVhdGUiOiAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpLAoJCSJpU3RhcnQiOiAgICAgICAoYkluZmluaXRlID8gMCA6IG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCksCgkJImlFbmQiOiAgICAgICAgIChiSW5maW5pdGUgPyBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoIDogb1NldHRpbmdzLl9pRGlzcGxheUVuZCksCgkJImlMZW5ndGgiOiAgICAgIG9TZXR0aW5ncy5faURpc3BsYXlMZW5ndGgsCgkJImFhU29ydGluZyI6ICAgICQuZXh0ZW5kKCB0cnVlLCBbXSwgb1NldHRpbmdzLmFhU29ydGluZyApLAoJCSJvU2VhcmNoIjogICAgICAkLmV4dGVuZCggdHJ1ZSwge30sIG9TZXR0aW5ncy5vUHJldmlvdXNTZWFyY2ggKSwKCQkiYW9TZWFyY2hDb2xzIjogJC5leHRlbmQoIHRydWUsIFtdLCBvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzICksCgkJImFiVmlzQ29scyI6ICAgIFtdCgl9OwoKCWZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9Db2x1bW5zLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgl7CgkJb1N0YXRlLmFiVmlzQ29scy5wdXNoKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLmJWaXNpYmxlICk7Cgl9CgoJX2ZuQ2FsbGJhY2tGaXJlKCBvU2V0dGluZ3MsICJhb1N0YXRlU2F2ZVBhcmFtcyIsICdzdGF0ZVNhdmVQYXJhbXMnLCBbb1NldHRpbmdzLCBvU3RhdGVdICk7CgkKCW9TZXR0aW5ncy5mblN0YXRlU2F2ZS5jYWxsKCBvU2V0dGluZ3Mub0luc3RhbmNlLCBvU2V0dGluZ3MsIG9TdGF0ZSApOwp9CgoKLyoqCiAqIEF0dGVtcHQgdG8gbG9hZCBhIHNhdmVkIHRhYmxlIHN0YXRlIGZyb20gYSBjb29raWUKICogIEBwYXJhbSB7b2JqZWN0fSBvU2V0dGluZ3MgZGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKICogIEBwYXJhbSB7b2JqZWN0fSBvSW5pdCBEYXRhVGFibGVzIGluaXQgb2JqZWN0IHNvIHdlIGNhbiBvdmVycmlkZSBzZXR0aW5ncwogKiAgQG1lbWJlcm9mIERhdGFUYWJsZSNvQXBpCiAqLwpmdW5jdGlvbiBfZm5Mb2FkU3RhdGUgKCBvU2V0dGluZ3MsIG9Jbml0ICkKewoJaWYgKCAhb1NldHRpbmdzLm9GZWF0dXJlcy5iU3RhdGVTYXZlICkKCXsKCQlyZXR1cm47Cgl9CgoJdmFyIG9EYXRhID0gb1NldHRpbmdzLmZuU3RhdGVMb2FkLmNhbGwoIG9TZXR0aW5ncy5vSW5zdGFuY2UsIG9TZXR0aW5ncyApOwoJaWYgKCAhb0RhdGEgKQoJewoJCXJldHVybjsKCX0KCQoJLyogQWxsb3cgY3VzdG9tIGFuZCBwbHVnLWluIG1hbmlwdWxhdGlvbiBmdW5jdGlvbnMgdG8gYWx0ZXIgdGhlIHNhdmVkIGRhdGEgc2V0IGFuZAoJICogY2FuY2VsbGluZyBvZiBsb2FkaW5nIGJ5IHJldHVybmluZyBmYWxzZQoJICovCgl2YXIgYWJTdGF0ZUxvYWQgPSBfZm5DYWxsYmFja0ZpcmUoIG9TZXR0aW5ncywgJ2FvU3RhdGVMb2FkUGFyYW1zJywgJ3N0YXRlTG9hZFBhcmFtcycsIFtvU2V0dGluZ3MsIG9EYXRhXSApOwoJaWYgKCAkLmluQXJyYXkoIGZhbHNlLCBhYlN0YXRlTG9hZCApICE9PSAtMSApCgl7CgkJcmV0dXJuOwoJfQoJCgkvKiBTdG9yZSB0aGUgc2F2ZWQgc3RhdGUgc28gaXQgbWlnaHQgYmUgYWNjZXNzZWQgYXQgYW55IHRpbWUgKi8KCW9TZXR0aW5ncy5vTG9hZGVkU3RhdGUgPSAkLmV4dGVuZCggdHJ1ZSwge30sIG9EYXRhICk7CgkKCS8qIFJlc3RvcmUga2V5IGZlYXR1cmVzICovCglvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgICAgPSBvRGF0YS5pU3RhcnQ7CglvU2V0dGluZ3MuaUluaXREaXNwbGF5U3RhcnQgPSBvRGF0YS5pU3RhcnQ7CglvU2V0dGluZ3MuX2lEaXNwbGF5RW5kICAgICAgPSBvRGF0YS5pRW5kOwoJb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCAgID0gb0RhdGEuaUxlbmd0aDsKCW9TZXR0aW5ncy5hYVNvcnRpbmcgICAgICAgICA9IG9EYXRhLmFhU29ydGluZy5zbGljZSgpOwoJb1NldHRpbmdzLnNhdmVkX2FhU29ydGluZyAgID0gb0RhdGEuYWFTb3J0aW5nLnNsaWNlKCk7CgkKCS8qIFNlYXJjaCBmaWx0ZXJpbmcgICovCgkkLmV4dGVuZCggb1NldHRpbmdzLm9QcmV2aW91c1NlYXJjaCwgb0RhdGEub1NlYXJjaCApOwoJJC5leHRlbmQoIHRydWUsIG9TZXR0aW5ncy5hb1ByZVNlYXJjaENvbHMsIG9EYXRhLmFvU2VhcmNoQ29scyApOwoJCgkvKiBDb2x1bW4gdmlzaWJpbGl0eSBzdGF0ZQoJICogUGFzcyBiYWNrIHZpc2liaWxpdHkgc2V0dGluZ3MgdG8gdGhlIGluaXQgaGFuZGxlciwgYnV0IHRvIGRvIG5vdCBoZXJlIG92ZXJyaWRlCgkgKiB0aGUgaW5pdCBvYmplY3QgdGhhdCB0aGUgdXNlciBtaWdodCBoYXZlIHBhc3NlZCBpbgoJICovCglvSW5pdC5zYXZlZF9hb0NvbHVtbnMgPSBbXTsKCWZvciAoIHZhciBpPTAgOyBpPG9EYXRhLmFiVmlzQ29scy5sZW5ndGggOyBpKysgKQoJewoJCW9Jbml0LnNhdmVkX2FvQ29sdW1uc1tpXSA9IHt9OwoJCW9Jbml0LnNhdmVkX2FvQ29sdW1uc1tpXS5iVmlzaWJsZSA9IG9EYXRhLmFiVmlzQ29sc1tpXTsKCX0KCglfZm5DYWxsYmFja0ZpcmUoIG9TZXR0aW5ncywgJ2FvU3RhdGVMb2FkZWQnLCAnc3RhdGVMb2FkZWQnLCBbb1NldHRpbmdzLCBvRGF0YV0gKTsKfQoKCi8qKgogKiBDcmVhdGUgYSBuZXcgY29va2llIHdpdGggYSB2YWx1ZSB0byBzdG9yZSB0aGUgc3RhdGUgb2YgYSB0YWJsZQogKiAgQHBhcmFtIHtzdHJpbmd9IHNOYW1lIG5hbWUgb2YgdGhlIGNvb2tpZSB0byBjcmVhdGUKICogIEBwYXJhbSB7c3RyaW5nfSBzVmFsdWUgdGhlIHZhbHVlIHRoZSBjb29raWUgc2hvdWxkIHRha2UKICogIEBwYXJhbSB7aW50fSBpU2VjcyBkdXJhdGlvbiBvZiB0aGUgY29va2llCiAqICBAcGFyYW0ge3N0cmluZ30gc0Jhc2VOYW1lIHNOYW1lIGlzIG1hZGUgdXAgb2YgdGhlIGJhc2UgKyBmaWxlIG5hbWUgLSB0aGlzIGlzIHRoZSBiYXNlCiAqICBAcGFyYW0ge2Z1bmN0aW9ufSBmbkNhbGxiYWNrIFVzZXIgZGVmaW5hYmxlIGZ1bmN0aW9uIHRvIG1vZGlmeSB0aGUgY29va2llCiAqICBAbWVtYmVyb2YgRGF0YVRhYmxlI29BcGkKICovCmZ1bmN0aW9uIF9mbkNyZWF0ZUNvb2tpZSAoIHNOYW1lLCBzVmFsdWUsIGlTZWNzLCBzQmFzZU5hbWUsIGZuQ2FsbGJhY2sgKQp7Cgl2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7CglkYXRlLnNldFRpbWUoIGRhdGUuZ2V0VGltZSgpKyhpU2VjcyoxMDAwKSApOwoJCgkvKiAKCSAqIFNob2NraW5nIGJ1dCB0cnVlIC0gaXQgd291bGQgYXBwZWFyIElFIGhhcyBtYWpvciBpc3N1ZXMgd2l0aCBoYXZpbmcgdGhlIHBhdGggbm90IGhhdmluZwoJICogYSB0cmFpbGluZyBzbGFzaCBvbiBpdC4gV2UgbmVlZCB0aGUgY29va2llIHRvIGJlIGF2YWlsYWJsZSBiYXNlZCBvbiB0aGUgcGF0aCwgc28gd2UKCSAqIGhhdmUgdG8gYXBwZW5kIHRoZSBmaWxlIG5hbWUgdG8gdGhlIGNvb2tpZSBuYW1lLiBBcHBhbGxpbmcuIFRoYW5rcyB0byB2ZXggZm9yIGFkZGluZyB0aGUKCSAqIHBhdGNoIHRvIHVzZSBhdCBsZWFzdCBzb21lIG9mIHRoZSBwYXRoCgkgKi8KCXZhciBhUGFydHMgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTsKCXZhciBzTmFtZUZpbGUgPSBzTmFtZSArICdfJyArIGFQYXJ0cy5wb3AoKS5yZXBsYWNlKC9bXC86XS9nLCIiKS50b0xvd2VyQ2FzZSgpOwoJdmFyIHNGdWxsQ29va2llLCBvRGF0YTsKCQoJaWYgKCBmbkNhbGxiYWNrICE9PSBudWxsICkKCXsKCQlvRGF0YSA9ICh0eXBlb2YgJC5wYXJzZUpTT04gPT09ICdmdW5jdGlvbicpID8gCgkJCSQucGFyc2VKU09OKCBzVmFsdWUgKSA6IGV2YWwoICcoJytzVmFsdWUrJyknICk7CgkJc0Z1bGxDb29raWUgPSBmbkNhbGxiYWNrKCBzTmFtZUZpbGUsIG9EYXRhLCBkYXRlLnRvR01UU3RyaW5nKCksCgkJCWFQYXJ0cy5qb2luKCcvJykrIi8iICk7Cgl9CgllbHNlCgl7CgkJc0Z1bGxDb29raWUgPSBzTmFtZUZpbGUgKyAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQoc1ZhbHVlKSArCgkJCSI7IGV4cGlyZXM9IiArIGRhdGUudG9HTVRTdHJpbmcoKSArIjsgcGF0aD0iICsgYVBhcnRzLmpvaW4oJy8nKSsiLyI7Cgl9CgkKCS8qIEFyZSB3ZSBnb2luZyB0byBnbyBvdmVyIHRoZSBjb29raWUgbGltaXQgb2YgNEtpQj8gSWYgc28sIHRyeSB0byBkZWxldGUgYSBjb29raWVzCgkgKiBiZWxvbmdpbmcgdG8gRGF0YVRhYmxlcy4KCSAqLwoJdmFyCgkJYUNvb2tpZXMgPWRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpLAoJCWlOZXdDb29raWVMZW4gPSBzRnVsbENvb2tpZS5zcGxpdCgnOycpWzBdLmxlbmd0aCwKCQlhT2xkQ29va2llcyA9IFtdOwoJCglpZiAoIGlOZXdDb29raWVMZW4rZG9jdW1lbnQuY29va2llLmxlbmd0aCsxMCA+IDQwOTYgKSAvKiBNYWdpYyAxMCBmb3IgcGFkZGluZyAqLwoJewoJCWZvciAoIHZhciBpPTAsIGlMZW49YUNvb2tpZXMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQl7CgkJCWlmICggYUNvb2tpZXNbaV0uaW5kZXhPZiggc0Jhc2VOYW1lICkgIT0gLTEgKQoJCQl7CgkJCQkvKiBJdCdzIGEgRGF0YVRhYmxlcyBjb29raWUsIHNvIGV2YWwgaXQgYW5kIGNoZWNrIHRoZSB0aW1lIHN0YW1wICovCgkJCQl2YXIgYVNwbGl0Q29va2llID0gYUNvb2tpZXNbaV0uc3BsaXQoJz0nKTsKCQkJCXRyeSB7CgkJCQkJb0RhdGEgPSBldmFsKCAnKCcrZGVjb2RlVVJJQ29tcG9uZW50KGFTcGxpdENvb2tpZVsxXSkrJyknICk7CgoJCQkJCWlmICggb0RhdGEgJiYgb0RhdGEuaUNyZWF0ZSApCgkJCQkJewoJCQkJCQlhT2xkQ29va2llcy5wdXNoKCB7CgkJCQkJCQkibmFtZSI6IGFTcGxpdENvb2tpZVswXSwKCQkJCQkJCSJ0aW1lIjogb0RhdGEuaUNyZWF0ZQoJCQkJCQl9ICk7CgkJCQkJfQoJCQkJfQoJCQkJY2F0Y2goIGUgKSB7fQoJCQl9CgkJfQoKCQkvLyBNYWtlIHN1cmUgd2UgZGVsZXRlIHRoZSBvbGRlc3Qgb25lcyBmaXJzdAoJCWFPbGRDb29raWVzLnNvcnQoIGZ1bmN0aW9uIChhLCBiKSB7CgkJCXJldHVybiBiLnRpbWUgLSBhLnRpbWU7CgkJfSApOwoKCQkvLyBFbGltaW5hdGUgYXMgbWFueSBvbGQgRGF0YVRhYmxlcyBjb29raWVzIGFzIHdlIG5lZWQgdG8KCQl3aGlsZSAoIGlOZXdDb29raWVMZW4gKyBkb2N1bWVudC5jb29raWUubGVuZ3RoICsgMTAgPiA0MDk2ICkgewoJCQlpZiAoIGFPbGRDb29raWVzLmxlbmd0aCA9PT0gMCApIHsKCQkJCS8vIERlbGV0ZWQgYWxsIERUIGNvb2tpZXMgYW5kIHN0aWxsIG5vdCBlbm91Z2ggc3BhY2UuIENhbid0IHN0YXRlIHNhdmUKCQkJCXJldHVybjsKCQkJfQoJCQkKCQkJdmFyIG9sZCA9IGFPbGRDb29raWVzLnBvcCgpOwoJCQlkb2N1bWVudC5jb29raWUgPSBvbGQubmFtZSsiPTsgZXhwaXJlcz1UaHUsIDAxLUphbi0xOTcwIDAwOjAwOjAxIEdNVDsgcGF0aD0iKwoJCQkJYVBhcnRzLmpvaW4oJy8nKSArICIvIjsKCQl9Cgl9CgkKCWRvY3VtZW50LmNvb2tpZSA9IHNGdWxsQ29va2llOwp9CgoKLyoqCiAqIFJlYWQgYW4gb2xkIGNvb2tpZSB0byBnZXQgYSBjb29raWUgd2l0aCBhbiBvbGQgdGFibGUgc3RhdGUKICogIEBwYXJhbSB7c3RyaW5nfSBzTmFtZSBuYW1lIG9mIHRoZSBjb29raWUgdG8gcmVhZAogKiAgQHJldHVybnMge3N0cmluZ30gY29udGVudHMgb2YgdGhlIGNvb2tpZSAtIG9yIG51bGwgaWYgbm8gY29va2llIHdpdGggdGhhdCBuYW1lIGZvdW5kCiAqICBAbWVtYmVyb2YgRGF0YVRhYmxlI29BcGkKICovCmZ1bmN0aW9uIF9mblJlYWRDb29raWUgKCBzTmFtZSApCnsKCXZhcgoJCWFQYXJ0cyA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpLAoJCXNOYW1lRVEgPSBzTmFtZSArICdfJyArIGFQYXJ0c1thUGFydHMubGVuZ3RoLTFdLnJlcGxhY2UoL1tcLzpdL2csIiIpLnRvTG93ZXJDYXNlKCkgKyAnPScsCgkgCXNDb29raWVDb250ZW50cyA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpOwoJCglmb3IoIHZhciBpPTAgOyBpPHNDb29raWVDb250ZW50cy5sZW5ndGggOyBpKysgKQoJewoJCXZhciBjID0gc0Nvb2tpZUNvbnRlbnRzW2ldOwoJCQoJCXdoaWxlIChjLmNoYXJBdCgwKT09JyAnKQoJCXsKCQkJYyA9IGMuc3Vic3RyaW5nKDEsYy5sZW5ndGgpOwoJCX0KCQkKCQlpZiAoYy5pbmRleE9mKHNOYW1lRVEpID09PSAwKQoJCXsKCQkJcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudCggYy5zdWJzdHJpbmcoc05hbWVFUS5sZW5ndGgsYy5sZW5ndGgpICk7CgkJfQoJfQoJcmV0dXJuIG51bGw7Cn0KCg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 16:09:46 GMT",
                    "Content-Length": "6490",
                    "Date": "Fri, 07 Nov 2014 16:09:48 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}