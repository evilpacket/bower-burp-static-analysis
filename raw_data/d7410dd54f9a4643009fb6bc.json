{
    "url": "http://localhost:9999/marijnh/CodeMirror/demo/theme.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>document.location.search</b> and written to <b>the 'value' property of a DOM element</b> via the following statements:<ul><li>var choice = document.location.search &amp;&amp;                decodeURIComponent(document.location.search.slice(1));</li><li>input.value = choice;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/marijnh/CodeMirror/demo/theme.html",
                "path": "/marijnh/CodeMirror/demo/theme.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9tYXJpam5oL0NvZGVNaXJyb3IvZGVtby90aGVtZS5odG1sIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNDQxOA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBUaHUsIDA2IE5vdiAyMDE0IDE1OjQ1OjE5IEdNVA0KTGFzdC1Nb2RpZmllZDogVGh1LCAwNiBOb3YgMjAxNCAxNTo0NToxNCBHTVQNCg0KPCFkb2N0eXBlIGh0bWw+Cgo8dGl0bGU+Q29kZU1pcnJvcjogVGhlbWUgRGVtbzwvdGl0bGU+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+CjxsaW5rIHJlbD1zdHlsZXNoZWV0IGhyZWY9Ii4uL2RvYy9kb2NzLmNzcyI+Cgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2xpYi9jb2RlbWlycm9yLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvMzAyNC1kYXkuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS8zMDI0LW5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvYW1iaWFuY2UuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9iYXNlMTYtZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2Jhc2UxNi1saWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2JsYWNrYm9hcmQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9jb2JhbHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9lY2xpcHNlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvZWxlZ2FudC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2VybGFuZy1kYXJrLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbGVzc2VyLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tYm8uY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tZG4tbGlrZS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL21pZG5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbW9ub2thaS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL25lYXQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9uZW8uY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9uaWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9wYXN0ZWwtb24tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3J1YnlibHVlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvc29sYXJpemVkLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdGhlLW1hdHJpeC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3RvbW9ycm93LW5pZ2h0LWVpZ2h0aWVzLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdHdpbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS92aWJyYW50LWluay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3hxLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS94cS1saWdodC5jc3MiPgo8c2NyaXB0IHNyYz0iLi4vbGliL2NvZGVtaXJyb3IuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vbW9kZS9qYXZhc2NyaXB0L2phdmFzY3JpcHQuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vYWRkb24vc2VsZWN0aW9uL2FjdGl2ZS1saW5lLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Ii4uL2FkZG9uL2VkaXQvbWF0Y2hicmFja2V0cy5qcyI+PC9zY3JpcHQ+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgIC5Db2RlTWlycm9yIHtib3JkZXI6IDFweCBzb2xpZCBibGFjazsgZm9udC1zaXplOjEzcHh9CiAgICA8L3N0eWxlPgo8ZGl2IGlkPW5hdj4KICA8YSBocmVmPSJodHRwOi8vY29kZW1pcnJvci5uZXQiPjxoMT5Db2RlTWlycm9yPC9oMT48aW1nIGlkPWxvZ28gc3JjPSIuLi9kb2MvbG9nby5wbmciPjwvYT4KCiAgPHVsPgogICAgPGxpPjxhIGhyZWY9Ii4uL2luZGV4Lmh0bWwiPkhvbWU8L2E+CiAgICA8bGk+PGEgaHJlZj0iLi4vZG9jL21hbnVhbC5odG1sIj5NYW51YWw8L2E+CiAgICA8bGk+PGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL2NvZGVtaXJyb3IvY29kZW1pcnJvciI+Q29kZTwvYT4KICA8L3VsPgogIDx1bD4KICAgIDxsaT48YSBjbGFzcz1hY3RpdmUgaHJlZj0iIyI+VGhlbWU8L2E+CiAgPC91bD4KPC9kaXY+Cgo8YXJ0aWNsZT4KPGgyPlRoZW1lIERlbW88L2gyPgo8Zm9ybT48dGV4dGFyZWEgaWQ9ImNvZGUiIG5hbWU9ImNvZGUiPgpmdW5jdGlvbiBmaW5kU2VxdWVuY2UoZ29hbCkgewogIGZ1bmN0aW9uIGZpbmQoc3RhcnQsIGhpc3RvcnkpIHsKICAgIGlmIChzdGFydCA9PSBnb2FsKQogICAgICByZXR1cm4gaGlzdG9yeTsKICAgIGVsc2UgaWYgKHN0YXJ0ID4gZ29hbCkKICAgICAgcmV0dXJuIG51bGw7CiAgICBlbHNlCiAgICAgIHJldHVybiBmaW5kKHN0YXJ0ICsgNSwgIigiICsgaGlzdG9yeSArICIgKyA1KSIpIHx8CiAgICAgICAgICAgICBmaW5kKHN0YXJ0ICogMywgIigiICsgaGlzdG9yeSArICIgKiAzKSIpOwogIH0KICByZXR1cm4gZmluZCgxLCAiMSIpOwp9PC90ZXh0YXJlYT48L2Zvcm0+Cgo8cD5TZWxlY3QgYSB0aGVtZTogPHNlbGVjdCBvbmNoYW5nZT0ic2VsZWN0VGhlbWUoKSIgaWQ9c2VsZWN0PgogICAgPG9wdGlvbiBzZWxlY3RlZD5kZWZhdWx0PC9vcHRpb24+CiAgICA8b3B0aW9uPjMwMjQtZGF5PC9vcHRpb24+CiAgICA8b3B0aW9uPjMwMjQtbmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+YW1iaWFuY2U8L29wdGlvbj4KICAgIDxvcHRpb24+YmFzZTE2LWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+YmFzZTE2LWxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPmJsYWNrYm9hcmQ8L29wdGlvbj4KICAgIDxvcHRpb24+Y29iYWx0PC9vcHRpb24+CiAgICA8b3B0aW9uPmVjbGlwc2U8L29wdGlvbj4KICAgIDxvcHRpb24+ZWxlZ2FudDwvb3B0aW9uPgogICAgPG9wdGlvbj5lcmxhbmctZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5sZXNzZXItZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5tYm88L29wdGlvbj4KICAgIDxvcHRpb24+bWRuLWxpa2U8L29wdGlvbj4KICAgIDxvcHRpb24+bWlkbmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+bW9ub2thaTwvb3B0aW9uPgogICAgPG9wdGlvbj5uZWF0PC9vcHRpb24+CiAgICA8b3B0aW9uPm5lbzwvb3B0aW9uPgogICAgPG9wdGlvbj5uaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj5wYXJhaXNvLWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+cGFyYWlzby1saWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj5wYXN0ZWwtb24tZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5ydWJ5Ymx1ZTwvb3B0aW9uPgogICAgPG9wdGlvbj5zb2xhcml6ZWQgZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5zb2xhcml6ZWQgbGlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+dGhlLW1hdHJpeDwvb3B0aW9uPgogICAgPG9wdGlvbj50b21vcnJvdy1uaWdodC1laWdodGllczwvb3B0aW9uPgogICAgPG9wdGlvbj50d2lsaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj52aWJyYW50LWluazwvb3B0aW9uPgogICAgPG9wdGlvbj54cS1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPnhxLWxpZ2h0PC9vcHRpb24+Cjwvc2VsZWN0Pgo8L3A+Cgo8c2NyaXB0PgogIHZhciBlZGl0b3IgPSBDb2RlTWlycm9yLmZyb21UZXh0QXJlYShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29kZSIpLCB7CiAgICBsaW5lTnVtYmVyczogdHJ1ZSwKICAgIHN0eWxlQWN0aXZlTGluZTogdHJ1ZSwKICAgIG1hdGNoQnJhY2tldHM6IHRydWUKICB9KTsKICB2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2VsZWN0Iik7CiAgZnVuY3Rpb24gc2VsZWN0VGhlbWUoKSB7CiAgICB2YXIgdGhlbWUgPSBpbnB1dC5vcHRpb25zW2lucHV0LnNlbGVjdGVkSW5kZXhdLmlubmVySFRNTDsKICAgIGVkaXRvci5zZXRPcHRpb24oInRoZW1lIiwgdGhlbWUpOwogIH0KICB2YXIgY2hvaWNlID0gZG9jdW1lbnQubG9jYXRpb24uc2VhcmNoICYmCiAgICAgICAgICAgICAgIGRlY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2guc2xpY2UoMSkpOwogIGlmIChjaG9pY2UpIHsKICAgIGlucHV0LnZhbHVlID0gY2hvaWNlOwogICAgZWRpdG9yLnNldE9wdGlvbigidGhlbWUiLCBjaG9pY2UpOwogIH0KPC9zY3JpcHQ+CiAgPC9hcnRpY2xlPgo=",
                "body": "PCFkb2N0eXBlIGh0bWw+Cgo8dGl0bGU+Q29kZU1pcnJvcjogVGhlbWUgRGVtbzwvdGl0bGU+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+CjxsaW5rIHJlbD1zdHlsZXNoZWV0IGhyZWY9Ii4uL2RvYy9kb2NzLmNzcyI+Cgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2xpYi9jb2RlbWlycm9yLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvMzAyNC1kYXkuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS8zMDI0LW5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvYW1iaWFuY2UuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9iYXNlMTYtZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2Jhc2UxNi1saWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2JsYWNrYm9hcmQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9jb2JhbHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9lY2xpcHNlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvZWxlZ2FudC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2VybGFuZy1kYXJrLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbGVzc2VyLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tYm8uY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tZG4tbGlrZS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL21pZG5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbW9ub2thaS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL25lYXQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9uZW8uY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9uaWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9wYXN0ZWwtb24tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3J1YnlibHVlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvc29sYXJpemVkLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdGhlLW1hdHJpeC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3RvbW9ycm93LW5pZ2h0LWVpZ2h0aWVzLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdHdpbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS92aWJyYW50LWluay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3hxLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS94cS1saWdodC5jc3MiPgo8c2NyaXB0IHNyYz0iLi4vbGliL2NvZGVtaXJyb3IuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vbW9kZS9qYXZhc2NyaXB0L2phdmFzY3JpcHQuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vYWRkb24vc2VsZWN0aW9uL2FjdGl2ZS1saW5lLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Ii4uL2FkZG9uL2VkaXQvbWF0Y2hicmFja2V0cy5qcyI+PC9zY3JpcHQ+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgIC5Db2RlTWlycm9yIHtib3JkZXI6IDFweCBzb2xpZCBibGFjazsgZm9udC1zaXplOjEzcHh9CiAgICA8L3N0eWxlPgo8ZGl2IGlkPW5hdj4KICA8YSBocmVmPSJodHRwOi8vY29kZW1pcnJvci5uZXQiPjxoMT5Db2RlTWlycm9yPC9oMT48aW1nIGlkPWxvZ28gc3JjPSIuLi9kb2MvbG9nby5wbmciPjwvYT4KCiAgPHVsPgogICAgPGxpPjxhIGhyZWY9Ii4uL2luZGV4Lmh0bWwiPkhvbWU8L2E+CiAgICA8bGk+PGEgaHJlZj0iLi4vZG9jL21hbnVhbC5odG1sIj5NYW51YWw8L2E+CiAgICA8bGk+PGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL2NvZGVtaXJyb3IvY29kZW1pcnJvciI+Q29kZTwvYT4KICA8L3VsPgogIDx1bD4KICAgIDxsaT48YSBjbGFzcz1hY3RpdmUgaHJlZj0iIyI+VGhlbWU8L2E+CiAgPC91bD4KPC9kaXY+Cgo8YXJ0aWNsZT4KPGgyPlRoZW1lIERlbW88L2gyPgo8Zm9ybT48dGV4dGFyZWEgaWQ9ImNvZGUiIG5hbWU9ImNvZGUiPgpmdW5jdGlvbiBmaW5kU2VxdWVuY2UoZ29hbCkgewogIGZ1bmN0aW9uIGZpbmQoc3RhcnQsIGhpc3RvcnkpIHsKICAgIGlmIChzdGFydCA9PSBnb2FsKQogICAgICByZXR1cm4gaGlzdG9yeTsKICAgIGVsc2UgaWYgKHN0YXJ0ID4gZ29hbCkKICAgICAgcmV0dXJuIG51bGw7CiAgICBlbHNlCiAgICAgIHJldHVybiBmaW5kKHN0YXJ0ICsgNSwgIigiICsgaGlzdG9yeSArICIgKyA1KSIpIHx8CiAgICAgICAgICAgICBmaW5kKHN0YXJ0ICogMywgIigiICsgaGlzdG9yeSArICIgKiAzKSIpOwogIH0KICByZXR1cm4gZmluZCgxLCAiMSIpOwp9PC90ZXh0YXJlYT48L2Zvcm0+Cgo8cD5TZWxlY3QgYSB0aGVtZTogPHNlbGVjdCBvbmNoYW5nZT0ic2VsZWN0VGhlbWUoKSIgaWQ9c2VsZWN0PgogICAgPG9wdGlvbiBzZWxlY3RlZD5kZWZhdWx0PC9vcHRpb24+CiAgICA8b3B0aW9uPjMwMjQtZGF5PC9vcHRpb24+CiAgICA8b3B0aW9uPjMwMjQtbmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+YW1iaWFuY2U8L29wdGlvbj4KICAgIDxvcHRpb24+YmFzZTE2LWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+YmFzZTE2LWxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPmJsYWNrYm9hcmQ8L29wdGlvbj4KICAgIDxvcHRpb24+Y29iYWx0PC9vcHRpb24+CiAgICA8b3B0aW9uPmVjbGlwc2U8L29wdGlvbj4KICAgIDxvcHRpb24+ZWxlZ2FudDwvb3B0aW9uPgogICAgPG9wdGlvbj5lcmxhbmctZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5sZXNzZXItZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5tYm88L29wdGlvbj4KICAgIDxvcHRpb24+bWRuLWxpa2U8L29wdGlvbj4KICAgIDxvcHRpb24+bWlkbmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+bW9ub2thaTwvb3B0aW9uPgogICAgPG9wdGlvbj5uZWF0PC9vcHRpb24+CiAgICA8b3B0aW9uPm5lbzwvb3B0aW9uPgogICAgPG9wdGlvbj5uaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj5wYXJhaXNvLWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+cGFyYWlzby1saWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj5wYXN0ZWwtb24tZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5ydWJ5Ymx1ZTwvb3B0aW9uPgogICAgPG9wdGlvbj5zb2xhcml6ZWQgZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5zb2xhcml6ZWQgbGlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+dGhlLW1hdHJpeDwvb3B0aW9uPgogICAgPG9wdGlvbj50b21vcnJvdy1uaWdodC1laWdodGllczwvb3B0aW9uPgogICAgPG9wdGlvbj50d2lsaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj52aWJyYW50LWluazwvb3B0aW9uPgogICAgPG9wdGlvbj54cS1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPnhxLWxpZ2h0PC9vcHRpb24+Cjwvc2VsZWN0Pgo8L3A+Cgo8c2NyaXB0PgogIHZhciBlZGl0b3IgPSBDb2RlTWlycm9yLmZyb21UZXh0QXJlYShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29kZSIpLCB7CiAgICBsaW5lTnVtYmVyczogdHJ1ZSwKICAgIHN0eWxlQWN0aXZlTGluZTogdHJ1ZSwKICAgIG1hdGNoQnJhY2tldHM6IHRydWUKICB9KTsKICB2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2VsZWN0Iik7CiAgZnVuY3Rpb24gc2VsZWN0VGhlbWUoKSB7CiAgICB2YXIgdGhlbWUgPSBpbnB1dC5vcHRpb25zW2lucHV0LnNlbGVjdGVkSW5kZXhdLmlubmVySFRNTDsKICAgIGVkaXRvci5zZXRPcHRpb24oInRoZW1lIiwgdGhlbWUpOwogIH0KICB2YXIgY2hvaWNlID0gZG9jdW1lbnQubG9jYXRpb24uc2VhcmNoICYmCiAgICAgICAgICAgICAgIGRlY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2guc2xpY2UoMSkpOwogIGlmIChjaG9pY2UpIHsKICAgIGlucHV0LnZhbHVlID0gY2hvaWNlOwogICAgZWRpdG9yLnNldE9wdGlvbigidGhlbWUiLCBjaG9pY2UpOwogIH0KPC9zY3JpcHQ+CiAgPC9hcnRpY2xlPgo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 15:45:14 GMT",
                    "Content-Length": "4418",
                    "Date": "Thu, 06 Nov 2014 15:45:19 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}