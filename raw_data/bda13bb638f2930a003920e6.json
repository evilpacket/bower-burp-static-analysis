{
    "url": "http://localhost:9999/kripken/box2d.js/webgl_demo/box2d.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>window.location</b> and written to <b>window.location</b> via the following statement:<ul><li>window.location = window.location.toString().split('?')[0] + '?' + boxes.value;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/kripken/box2d.js/webgl_demo/box2d.html",
                "path": "/kripken/box2d.js/webgl_demo/box2d.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9rcmlwa2VuL2JveDJkLmpzL3dlYmdsX2RlbW8vYm94MmQuaHRtbCBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODY4MQ0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBUaHUsIDA2IE5vdiAyMDE0IDE0OjAwOjM1IEdNVA0KTGFzdC1Nb2RpZmllZDogVGh1LCAwNiBOb3YgMjAxNCAxNDowMDoyNyBHTVQNCg0KPGh0bWw+CiAgICA8aGVhZD4KICAgICAgPHRpdGxlPkJveDJEL1dlYkdMIERlbW88L3RpdGxlPgogICAgICA8c2NyaXB0IHNyYz0iQ3ViaWNWUi5taW4uanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+CiAgICAgIDxzY3JpcHQ+CiAgICAgICAgdmFyIE1vZHVsZSA9IHsgVE9UQUxfTUVNT1JZOiAyNTYqMTAyNCoxMDI0IH07CiAgICAgIDwvc2NyaXB0PgogICAgICA8c2NyaXB0IHNyYz0iLi4vYm94MmQuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+CiAgICAgIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgICAgYm9keSB7IGJhY2tncm91bmQtY29sb3I6ICNjY2M7IH0KICAgICAgPC9zdHlsZT4KCiAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICB2YXIgc3RhcnRVcCwgcmVzdGFydDsKICAgICAgICAoZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgcyA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEpOwogICAgICAgICAgdmFyIE5VTSA9IHMubGVuZ3RoID4gMSA/ICtzIDogNTAwOwoKICAgICAgICAgIHZhciBOVU1SQU5HRSA9IFtdOwogICAgICAgICAgd2hpbGUgKE5VTVJBTkdFLmxlbmd0aCA8IE5VTSkgTlVNUkFOR0UucHVzaChOVU1SQU5HRS5sZW5ndGgrMSk7CiAgICAgICAgICB2YXIgYm9kaWVzID0gW251bGxdOyAvLyBJbmRleGVzIHN0YXJ0IGZyb20gMQoKICAgICAgICAgIC8vIEJveDJELWludGVyZmFjaW5nIGNvZGUKCiAgICAgICAgICB2YXIgZ3Jhdml0eSA9IG5ldyBCb3gyRC5iMlZlYzIoMC4wLCAtMTAuMCk7CgogICAgICAgICAgdmFyIHdvcmxkID0gbmV3IEJveDJELmIyV29ybGQoZ3Jhdml0eSk7CgogICAgICAgICAgdmFyIGJkX2dyb3VuZCA9IG5ldyBCb3gyRC5iMkJvZHlEZWYoKTsKICAgICAgICAgIHZhciBncm91bmQgPSB3b3JsZC5DcmVhdGVCb2R5KGJkX2dyb3VuZCk7CgogICAgICAgICAgdmFyIHNoYXBlMCA9IG5ldyBCb3gyRC5iMkVkZ2VTaGFwZSgpOwogICAgICAgICAgc2hhcGUwLlNldChuZXcgQm94MkQuYjJWZWMyKC00MC4wLCAtNi4wKSwgbmV3IEJveDJELmIyVmVjMig0MC4wLCAtNi4wKSk7CiAgICAgICAgICBncm91bmQuQ3JlYXRlRml4dHVyZShzaGFwZTAsIDAuMCk7CgogICAgICAgICAgdmFyIHNpemUgPSAxLjA7CiAgICAgICAgICB2YXIgc2hhcGUgPSBuZXcgQm94MkQuYjJQb2x5Z29uU2hhcGUoKTsKICAgICAgICAgIHNoYXBlLlNldEFzQm94KHNpemUsIHNpemUpOwoKICAgICAgICAgIHZhciBaRVJPID0gbmV3IEJveDJELmIyVmVjMigwLjAsIDAuMCk7CiAgICAgICAgICB2YXIgdGVtcCA9IG5ldyBCb3gyRC5iMlZlYzIoMC4wLCAwLjApOwoKICAgICAgICAgIE5VTVJBTkdFLmZvckVhY2goZnVuY3Rpb24oaSkgewogICAgICAgICAgICB2YXIgYmQgPSBuZXcgQm94MkQuYjJCb2R5RGVmKCk7CiAgICAgICAgICAgIGJkLnNldF90eXBlKEJveDJELmIyX2R5bmFtaWNCb2R5KTsKICAgICAgICAgICAgYmQuc2V0X3Bvc2l0aW9uKFpFUk8pOwogICAgICAgICAgICB2YXIgYm9keSA9IHdvcmxkLkNyZWF0ZUJvZHkoYmQpOwogICAgICAgICAgICBib2R5LkNyZWF0ZUZpeHR1cmUoc2hhcGUsIDUuMCk7CgogICAgICAgICAgICBib2RpZXMucHVzaChib2R5KTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0UG9zaXRpb25zKCkgewogICAgICAgICAgICBOVU1SQU5HRS5mb3JFYWNoKGZ1bmN0aW9uKGkpIHsKICAgICAgICAgICAgICB2YXIgYm9keSA9IGJvZGllc1tpXTsKICAgICAgICAgICAgICB0ZW1wLlNldCgyNSooTWF0aC5yYW5kb20oKS0wLjUpLCAyLjAgKyAxLjUqaSk7CiAgICAgICAgICAgICAgYm9keS5TZXRUcmFuc2Zvcm0odGVtcCwgMC4wKTsKICAgICAgICAgICAgICBib2R5LlNldExpbmVhclZlbG9jaXR5KFpFUk8pOwogICAgICAgICAgICAgIGJvZHkuU2V0QXdha2UoMSk7CiAgICAgICAgICAgICAgYm9keS5TZXRBY3RpdmUoMSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJlc2V0UG9zaXRpb25zKCk7CgogICAgICAgICAgZnVuY3Rpb24gcmVhZE9iamVjdChpLCBkYXRhKSB7CiAgICAgICAgICAgIHZhciBib2R5ID0gYm9kaWVzW2ldOwogICAgICAgICAgICB2YXIgYnBvcyA9IGJvZHkuR2V0UG9zaXRpb24oKTsKICAgICAgICAgICAgZGF0YS54ID0gYnBvcy5nZXRfeCgpOwogICAgICAgICAgICBkYXRhLnkgPSBicG9zLmdldF95KCk7CiAgICAgICAgICAgIGRhdGEuYW5nbGUgPSBib2R5LkdldEFuZ2xlKCk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGxhc3RJbmFjdGl2aXR5ID0gRGF0ZS5ub3coKTsKICAgICAgICAgIGZ1bmN0aW9uIHNvbWVJbmFjdGl2ZSgpIHsKICAgICAgICAgICAgdmFyIGFzbGVlcCA9IDA7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTlVNOyBpKyspIHsKICAgICAgICAgICAgICBpZiAoIWJvZGllc1tpKzFdLklzQXdha2UoKSkgewogICAgICAgICAgICAgICAgYXNsZWVwKys7CiAgICAgICAgICAgICAgICBpZiAoYXNsZWVwID09IDMpIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gTWFpbiBkZW1vIGNvZGUKCiAgICAgICAgICB2YXIgdG90YWxUaW1lID0gMDsKCiAgICAgICAgICB2YXIgYm94ZXMgPSBbXTsKCiAgICAgICAgICB2YXIgcG9zaXRpb24gPSBbMCwwLDBdOwoKICAgICAgICAgIGZ1bmN0aW9uIHNpbXVsYXRlKGR0KSB7CiAgICAgICAgICAgIHdvcmxkLlN0ZXAoZHQsIDIsIDIpOwoKICAgICAgICAgICAgdmFyIGRhdGEgPSB7IHg6IDAsIHk6IDAsIGFuZ2xlOiAwIH07CgogICAgICAgICAgICAvLyBSZWFkIGJveDJkIGRhdGEgaW50byBKUyBvYmplY3RzCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTlVNOyBpKyspIHsKICAgICAgICAgICAgICByZWFkT2JqZWN0KGkrMSwgZGF0YSk7CiAgICAgICAgICAgICAgdmFyIHJlbmRlck9iamVjdCA9IGJveGVzW2ldOwogICAgICAgICAgICAgIHJlbmRlck9iamVjdC5wb3NpdGlvblswXSA9IGRhdGEueDsKICAgICAgICAgICAgICByZW5kZXJPYmplY3QucG9zaXRpb25bMV0gPSBkYXRhLnk7CiAgICAgICAgICAgICAgcmVuZGVyT2JqZWN0LnBvc2l0aW9uWzJdID0gMDsKICAgICAgICAgICAgICByZW5kZXJPYmplY3Qucm90YXRpb24gPSBbMCwgMCwgZGF0YS5hbmdsZSoxODAvTWF0aC5QSV07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRvdGFsVGltZSArPSBkdDsKCiAgICAgICAgICAgIGlmIChzb21lSW5hY3RpdmUoKSB8fCB0b3RhbFRpbWUgPj0gMzApIHJlc3RhcnQoKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZnBzSW5mbyA9IHsKICAgICAgICAgICAgZHRzOiAwLAogICAgICAgICAgICBudW06IDAsCiAgICAgICAgICAgIGxhc3RIVUQ6IERhdGUubm93KCksCiAgICAgICAgICAgIGFsbE51bTogMCwKICAgICAgICAgICAgYWxsOiAwLAogICAgICAgICAgfTsKCiAgICAgICAgICB2YXIgb3V0RWxlbWVudCA9IG51bGw7CiAgICAgICAgICBmdW5jdGlvbiBzaG93RlBTKGR0KSB7CiAgICAgICAgICAgIGlmICghb3V0RWxlbWVudCkgb3V0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXQnKTsKICAgICAgICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7CiAgICAgICAgICAgIGZwc0luZm8uZHRzICs9IGR0OwogICAgICAgICAgICBmcHNJbmZvLm51bSsrOwogICAgICAgICAgICBpZiAobm93IC0gZnBzSW5mby5sYXN0SFVEID4gNTAwKSB7CiAgICAgICAgICAgICAgdmFyIGN1cnIgPSAxLyhmcHNJbmZvLmR0cy9mcHNJbmZvLm51bSk7CiAgICAgICAgICAgICAgZnBzSW5mby5hbGxOdW0rKzsKICAgICAgICAgICAgICB2YXIgYWxwaGEgPSBNYXRoLm1pbigxLCAyL2Zwc0luZm8uYWxsTnVtKTsKICAgICAgICAgICAgICBmcHNJbmZvLmFsbCA9IGFscGhhKmN1cnIgKyAoMS1hbHBoYSkqZnBzSW5mby5hbGw7CiAgICAgICAgICAgICAgb3V0RWxlbWVudC52YWx1ZSA9IE1hdGgucm91bmQoY3VycikgKyAnIC8gJyArIE1hdGgucm91bmQoZnBzSW5mby5hbGwpOwogICAgICAgICAgICAgIGZwc0luZm8ubGFzdEhVRCA9IG5vdzsKICAgICAgICAgICAgICBmcHNJbmZvLmR0cyA9IDA7CiAgICAgICAgICAgICAgZnBzSW5mby5udW0gPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmVzdGFydCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB0b3RhbFRpbWUgPSAwOwogICAgICAgICAgICByZXNldFBvc2l0aW9ucygpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBGTE9PUl9TSVpFID0gMTAwOwogICAgICAgICAgdmFyIEZMT09SX0hFSUdIVCA9IC01NgoKICAgICAgICAgIC8vIEN1YmljVlIgY29kZQoKICAgICAgICAgIHN0YXJ0VXAgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8nKS5pbm5lckhUTUwgPSAnPGI+Qm94ZXM6ICcgKyBOVU0gKyAnPC9iPic7CgogICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhbnZhcyIpOwogICAgICAgICAgICBjYW52YXMud2lkdGggPSBzY3JlZW4ud2lkdGgqMC43MDsKICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IHNjcmVlbi5oZWlnaHQqMC41NTsKCiAgICAgICAgICAgIHZhciBnbCA9IEN1YmljVlIuR0xDb3JlLmluaXQoY2FudmFzKTsKCiAgICAgICAgICAgIGlmICghZ2wpIHsKICAgICAgICAgICAgICBhbGVydCgiU29ycnksIG5vIFdlYkdMIHN1cHBvcnQgOigiKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgc2NlbmUgPSBuZXcgQ3ViaWNWUi5TY2VuZShjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQsIDcwKTsKCiAgICAgICAgICAgIHZhciBsaWdodCA9IG5ldyBDdWJpY1ZSLkxpZ2h0KHsKICAgICAgICAgICAgICB0eXBlOkN1YmljVlIuZW51bXMubGlnaHQudHlwZS5QT0lOVCwKICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDAsIDVdLAogICAgICAgICAgICAgIGludGVuc2l0eTogMC45LAogICAgICAgICAgICAgIGFyZWFDZWlsaW5nOiA4MCwKICAgICAgICAgICAgICBhcmVhRmxvb3I6IEZMT09SX0hFSUdIVCwKICAgICAgICAgICAgICBhcmVhQXhpczogWzE1LCAxMF0sCiAgICAgICAgICAgICAgZGlzdGFuY2U6IDYwLAogICAgICAgICAgICAgIG1hcFJlczogMTAyNAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc2NlbmUuYmluZExpZ2h0KGxpZ2h0KTsKCiAgICAgICAgICAgIHNjZW5lLmNhbWVyYS5wb3NpdGlvbiA9IFswLCAyLjQsIDE3XTsKICAgICAgICAgICAgc2NlbmUuY2FtZXJhLnRhcmdldCA9IFswLCAyLjQsIDBdOwoKICAgICAgICAgICAgdmFyIGJveE1lc2hlcyA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykgewogICAgICAgICAgICAgIGJveE1lc2hlc1tpXSA9IG5ldyBDdWJpY1ZSLnByaW1pdGl2ZXMuYm94KHsKICAgICAgICAgICAgICAgIHNpemU6IDIuMCwKICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBuZXcgQ3ViaWNWUi5NYXRlcmlhbCh7CiAgICAgICAgICAgICAgICAgIHRleHR1cmVzOiB7CiAgICAgICAgICAgICAgICAgICAgY29sb3I6IG5ldyBDdWJpY1ZSLlRleHR1cmUoImN1YmUiICsgKChpICUgNSkrMSkgKyAiLmpwZyIpCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgdXZtYXBwZXI6IHsKICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbk1vZGU6IEN1YmljVlIuZW51bXMudXYucHJvamVjdGlvbi5DVUJJQywKICAgICAgICAgICAgICAgICAgc2NhbGU6IFsyLCAyLCAyXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLmNhbGNOb3JtYWxzKCkudHJpYW5ndWxhdGVRdWFkcygpLmNvbXBpbGUoKS5jbGVhbigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE5VTTsgaSsrKSB7CiAgICAgICAgICAgICAgYm94ZXNbaV0gPSBuZXcgQ3ViaWNWUi5TY2VuZU9iamVjdCh7IG1lc2g6IGJveE1lc2hlc1tpJTVdLCBwb3NpdGlvbjogWzAsIC0xMDAwMCwgMF0gfSk7CiAgICAgICAgICAgICAgc2NlbmUuYmluZFNjZW5lT2JqZWN0KGJveGVzW2ldLCB0cnVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGZsb29yTWF0ZXJpYWwgPSBuZXcgQ3ViaWNWUi5NYXRlcmlhbCh7CiAgICAgICAgICAgICAgdGV4dHVyZXM6IHsKICAgICAgICAgICAgICAgIGNvbG9yOiBuZXcgQ3ViaWNWUi5UZXh0dXJlKCJjdWJlMy5qcGciKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHZhciBmbG9vck1lc2ggPSBuZXcgIEN1YmljVlIucHJpbWl0aXZlcy5ib3goewogICAgICAgICAgICAgIHNpemU6IEZMT09SX1NJWkUsCiAgICAgICAgICAgICAgbWF0ZXJpYWw6IGZsb29yTWF0ZXJpYWwsCiAgICAgICAgICAgICAgdXZtYXBwZXI6IHsKICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbk1vZGU6IEN1YmljVlIuZW51bXMudXYucHJvamVjdGlvbi5DVUJJQywKICAgICAgICAgICAgICAgICAgc2NhbGU6IFs0LCA0LCA0XQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2FsY05vcm1hbHMoKS50cmlhbmd1bGF0ZVF1YWRzKCkuY29tcGlsZSgpLmNsZWFuKCk7CgogICAgICAgICAgICB2YXIgZmxvb3JfID0gbmV3IEN1YmljVlIuU2NlbmVPYmplY3QoeyBtZXNoOiBmbG9vck1lc2gsIHBvc2l0aW9uOiBbMCwgRkxPT1JfSEVJR0hULCAwXSB9KTsKICAgICAgICAgICAgc2NlbmUuYmluZFNjZW5lT2JqZWN0KGZsb29yXywgdHJ1ZSk7CgogICAgICAgICAgICAvL3ZhciBtdmMgPSBuZXcgQ3ViaWNWUi5Nb3VzZVZpZXdDb250cm9sbGVyKGNhbnZhcywgc2NlbmUuY2FtZXJhKTsKCiAgICAgICAgICAgIEN1YmljVlIuTWFpbkxvb3AoZnVuY3Rpb24odGltZXIsIGdsKSB7CiAgICAgICAgICAgICAgdmFyIGR0ID0gdGltZXIuZ2V0TGFzdFVwZGF0ZVNlY29uZHMoKTsKICAgICAgICAgICAgICBzaW11bGF0ZShkdCk7CiAgICAgICAgICAgICAgc2NlbmUudXBkYXRlU2hhZG93cygpOwogICAgICAgICAgICAgIHNjZW5lLnJlbmRlcigpOwogICAgICAgICAgICAgIHNob3dGUFMoZHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KSgpOwogICAgICA8L3NjcmlwdD4KICAgIDwvaGVhZD4KICAgIDxib2R5IG9ubG9hZD0ic3RhcnRVcCgpIj4KICAgICAgPGNlbnRlcj4KICAgICAgICA8aDI+Ym94MmQuanMgV2ViR0wgRGVtbzwvaDI+CiAgICAgICAgPGZvcm0+CiAgICAgICAgICBCb3hlcyA6CiAgICAgICAgICA8c2VsZWN0IG5hbWU9ImJveGVzIj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNTAwIiBzZWxlY3RlZD4ocGljayk8L29wdGlvbj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMTAiPjEwPC9vcHRpb24+CiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjUwIj41MDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxMDAiPjEwMDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIyMDAiPjIwMDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIzMDAiPjMwMDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI1MDAiPjUwMDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI3NTAiPjc1MDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxMDAwIj4xMDAwPC9vcHRpb24+CiAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgIDxpbnB1dCB0eXBlPSJidXR0b24iIHZhbHVlPSJnbyEiIG9uY2xpY2s9IndpbmRvdy5sb2NhdGlvbiA9IHdpbmRvdy5sb2NhdGlvbi50b1N0cmluZygpLnNwbGl0KCc/JylbMF0gKyAnPycgKyBib3hlcy52YWx1ZTsiPgogICAgICAgIDwvZm9ybT4KICAgICAgICA8Y2FudmFzIGlkPSJjYW52YXMiIHdpZHRoPSI2MDAiIGhlaWdodD0iNTAwIj48L2NhbnZhcz4KICAgICAgICA8YnI+PGJyPgogICAgICAgIDxkaXY+RlBTIChjdXJyZW50IC8gc3RhYmxlKTogPGlucHV0IHR5cGU9InRleHQiIGlkPSJvdXQiIHJlYWRvbmx5PSIxIiBzaXplPSI3Ij48L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJpbmZvIj48L2Rpdj4KICAgICAgICA8cD4KICAgICAgICBUaGlzIGlzIDxiPjxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9rcmlwa2VuL2JveDJkLmpzIj5ib3gyZC5qczwvYT48L2I+LCBhIHBvcnQgb2YKICAgICAgICB0aGUgPGI+PGEgaHJlZj0iaHR0cDovL2JveDJkLm9yZy8iPkJveDJEIHBoeXNpY3MgZW5naW5lPC9hPjwvYj4gZnJvbSBDKysgdG8gSmF2YVNjcmlwdAogICAgICAgIHVzaW5nIDxiPjxhIGhyZWY9Imh0dHA6Ly9lbXNjcmlwdGVuLm9yZyI+RW1zY3JpcHRlbjwvYT48L2I+LiBXZWJHTCByZW5kZXJpbmcgaW4gdGhpcyBkZW1vIGlzIGRvbmUgdXNpbmcKICAgICAgICA8Yj48YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vY2pjbGlmZmUvQ3ViaWNWUi5qcy8iPkN1YmljVlIuanM8L2E+PC9iPi4KICAgICAgICA8L3A+CiAgICAgICAgPGlucHV0IHR5cGU9ImJ1dHRvbiIgb25jbGljaz0icmVzdGFydCgpIiB2YWx1ZT0icmVzdGFydCI+CiAgICAgIDwvY2VudGVyPgogICAgPC9ib2R5Pgo8L2h0bWw+Cgo=",
                "body": "PGh0bWw+CiAgICA8aGVhZD4KICAgICAgPHRpdGxlPkJveDJEL1dlYkdMIERlbW88L3RpdGxlPgogICAgICA8c2NyaXB0IHNyYz0iQ3ViaWNWUi5taW4uanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+CiAgICAgIDxzY3JpcHQ+CiAgICAgICAgdmFyIE1vZHVsZSA9IHsgVE9UQUxfTUVNT1JZOiAyNTYqMTAyNCoxMDI0IH07CiAgICAgIDwvc2NyaXB0PgogICAgICA8c2NyaXB0IHNyYz0iLi4vYm94MmQuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+CiAgICAgIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgICAgYm9keSB7IGJhY2tncm91bmQtY29sb3I6ICNjY2M7IH0KICAgICAgPC9zdHlsZT4KCiAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICB2YXIgc3RhcnRVcCwgcmVzdGFydDsKICAgICAgICAoZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgcyA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEpOwogICAgICAgICAgdmFyIE5VTSA9IHMubGVuZ3RoID4gMSA/ICtzIDogNTAwOwoKICAgICAgICAgIHZhciBOVU1SQU5HRSA9IFtdOwogICAgICAgICAgd2hpbGUgKE5VTVJBTkdFLmxlbmd0aCA8IE5VTSkgTlVNUkFOR0UucHVzaChOVU1SQU5HRS5sZW5ndGgrMSk7CiAgICAgICAgICB2YXIgYm9kaWVzID0gW251bGxdOyAvLyBJbmRleGVzIHN0YXJ0IGZyb20gMQoKICAgICAgICAgIC8vIEJveDJELWludGVyZmFjaW5nIGNvZGUKCiAgICAgICAgICB2YXIgZ3Jhdml0eSA9IG5ldyBCb3gyRC5iMlZlYzIoMC4wLCAtMTAuMCk7CgogICAgICAgICAgdmFyIHdvcmxkID0gbmV3IEJveDJELmIyV29ybGQoZ3Jhdml0eSk7CgogICAgICAgICAgdmFyIGJkX2dyb3VuZCA9IG5ldyBCb3gyRC5iMkJvZHlEZWYoKTsKICAgICAgICAgIHZhciBncm91bmQgPSB3b3JsZC5DcmVhdGVCb2R5KGJkX2dyb3VuZCk7CgogICAgICAgICAgdmFyIHNoYXBlMCA9IG5ldyBCb3gyRC5iMkVkZ2VTaGFwZSgpOwogICAgICAgICAgc2hhcGUwLlNldChuZXcgQm94MkQuYjJWZWMyKC00MC4wLCAtNi4wKSwgbmV3IEJveDJELmIyVmVjMig0MC4wLCAtNi4wKSk7CiAgICAgICAgICBncm91bmQuQ3JlYXRlRml4dHVyZShzaGFwZTAsIDAuMCk7CgogICAgICAgICAgdmFyIHNpemUgPSAxLjA7CiAgICAgICAgICB2YXIgc2hhcGUgPSBuZXcgQm94MkQuYjJQb2x5Z29uU2hhcGUoKTsKICAgICAgICAgIHNoYXBlLlNldEFzQm94KHNpemUsIHNpemUpOwoKICAgICAgICAgIHZhciBaRVJPID0gbmV3IEJveDJELmIyVmVjMigwLjAsIDAuMCk7CiAgICAgICAgICB2YXIgdGVtcCA9IG5ldyBCb3gyRC5iMlZlYzIoMC4wLCAwLjApOwoKICAgICAgICAgIE5VTVJBTkdFLmZvckVhY2goZnVuY3Rpb24oaSkgewogICAgICAgICAgICB2YXIgYmQgPSBuZXcgQm94MkQuYjJCb2R5RGVmKCk7CiAgICAgICAgICAgIGJkLnNldF90eXBlKEJveDJELmIyX2R5bmFtaWNCb2R5KTsKICAgICAgICAgICAgYmQuc2V0X3Bvc2l0aW9uKFpFUk8pOwogICAgICAgICAgICB2YXIgYm9keSA9IHdvcmxkLkNyZWF0ZUJvZHkoYmQpOwogICAgICAgICAgICBib2R5LkNyZWF0ZUZpeHR1cmUoc2hhcGUsIDUuMCk7CgogICAgICAgICAgICBib2RpZXMucHVzaChib2R5KTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0UG9zaXRpb25zKCkgewogICAgICAgICAgICBOVU1SQU5HRS5mb3JFYWNoKGZ1bmN0aW9uKGkpIHsKICAgICAgICAgICAgICB2YXIgYm9keSA9IGJvZGllc1tpXTsKICAgICAgICAgICAgICB0ZW1wLlNldCgyNSooTWF0aC5yYW5kb20oKS0wLjUpLCAyLjAgKyAxLjUqaSk7CiAgICAgICAgICAgICAgYm9keS5TZXRUcmFuc2Zvcm0odGVtcCwgMC4wKTsKICAgICAgICAgICAgICBib2R5LlNldExpbmVhclZlbG9jaXR5KFpFUk8pOwogICAgICAgICAgICAgIGJvZHkuU2V0QXdha2UoMSk7CiAgICAgICAgICAgICAgYm9keS5TZXRBY3RpdmUoMSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJlc2V0UG9zaXRpb25zKCk7CgogICAgICAgICAgZnVuY3Rpb24gcmVhZE9iamVjdChpLCBkYXRhKSB7CiAgICAgICAgICAgIHZhciBib2R5ID0gYm9kaWVzW2ldOwogICAgICAgICAgICB2YXIgYnBvcyA9IGJvZHkuR2V0UG9zaXRpb24oKTsKICAgICAgICAgICAgZGF0YS54ID0gYnBvcy5nZXRfeCgpOwogICAgICAgICAgICBkYXRhLnkgPSBicG9zLmdldF95KCk7CiAgICAgICAgICAgIGRhdGEuYW5nbGUgPSBib2R5LkdldEFuZ2xlKCk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGxhc3RJbmFjdGl2aXR5ID0gRGF0ZS5ub3coKTsKICAgICAgICAgIGZ1bmN0aW9uIHNvbWVJbmFjdGl2ZSgpIHsKICAgICAgICAgICAgdmFyIGFzbGVlcCA9IDA7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTlVNOyBpKyspIHsKICAgICAgICAgICAgICBpZiAoIWJvZGllc1tpKzFdLklzQXdha2UoKSkgewogICAgICAgICAgICAgICAgYXNsZWVwKys7CiAgICAgICAgICAgICAgICBpZiAoYXNsZWVwID09IDMpIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gTWFpbiBkZW1vIGNvZGUKCiAgICAgICAgICB2YXIgdG90YWxUaW1lID0gMDsKCiAgICAgICAgICB2YXIgYm94ZXMgPSBbXTsKCiAgICAgICAgICB2YXIgcG9zaXRpb24gPSBbMCwwLDBdOwoKICAgICAgICAgIGZ1bmN0aW9uIHNpbXVsYXRlKGR0KSB7CiAgICAgICAgICAgIHdvcmxkLlN0ZXAoZHQsIDIsIDIpOwoKICAgICAgICAgICAgdmFyIGRhdGEgPSB7IHg6IDAsIHk6IDAsIGFuZ2xlOiAwIH07CgogICAgICAgICAgICAvLyBSZWFkIGJveDJkIGRhdGEgaW50byBKUyBvYmplY3RzCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTlVNOyBpKyspIHsKICAgICAgICAgICAgICByZWFkT2JqZWN0KGkrMSwgZGF0YSk7CiAgICAgICAgICAgICAgdmFyIHJlbmRlck9iamVjdCA9IGJveGVzW2ldOwogICAgICAgICAgICAgIHJlbmRlck9iamVjdC5wb3NpdGlvblswXSA9IGRhdGEueDsKICAgICAgICAgICAgICByZW5kZXJPYmplY3QucG9zaXRpb25bMV0gPSBkYXRhLnk7CiAgICAgICAgICAgICAgcmVuZGVyT2JqZWN0LnBvc2l0aW9uWzJdID0gMDsKICAgICAgICAgICAgICByZW5kZXJPYmplY3Qucm90YXRpb24gPSBbMCwgMCwgZGF0YS5hbmdsZSoxODAvTWF0aC5QSV07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRvdGFsVGltZSArPSBkdDsKCiAgICAgICAgICAgIGlmIChzb21lSW5hY3RpdmUoKSB8fCB0b3RhbFRpbWUgPj0gMzApIHJlc3RhcnQoKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZnBzSW5mbyA9IHsKICAgICAgICAgICAgZHRzOiAwLAogICAgICAgICAgICBudW06IDAsCiAgICAgICAgICAgIGxhc3RIVUQ6IERhdGUubm93KCksCiAgICAgICAgICAgIGFsbE51bTogMCwKICAgICAgICAgICAgYWxsOiAwLAogICAgICAgICAgfTsKCiAgICAgICAgICB2YXIgb3V0RWxlbWVudCA9IG51bGw7CiAgICAgICAgICBmdW5jdGlvbiBzaG93RlBTKGR0KSB7CiAgICAgICAgICAgIGlmICghb3V0RWxlbWVudCkgb3V0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXQnKTsKICAgICAgICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7CiAgICAgICAgICAgIGZwc0luZm8uZHRzICs9IGR0OwogICAgICAgICAgICBmcHNJbmZvLm51bSsrOwogICAgICAgICAgICBpZiAobm93IC0gZnBzSW5mby5sYXN0SFVEID4gNTAwKSB7CiAgICAgICAgICAgICAgdmFyIGN1cnIgPSAxLyhmcHNJbmZvLmR0cy9mcHNJbmZvLm51bSk7CiAgICAgICAgICAgICAgZnBzSW5mby5hbGxOdW0rKzsKICAgICAgICAgICAgICB2YXIgYWxwaGEgPSBNYXRoLm1pbigxLCAyL2Zwc0luZm8uYWxsTnVtKTsKICAgICAgICAgICAgICBmcHNJbmZvLmFsbCA9IGFscGhhKmN1cnIgKyAoMS1hbHBoYSkqZnBzSW5mby5hbGw7CiAgICAgICAgICAgICAgb3V0RWxlbWVudC52YWx1ZSA9IE1hdGgucm91bmQoY3VycikgKyAnIC8gJyArIE1hdGgucm91bmQoZnBzSW5mby5hbGwpOwogICAgICAgICAgICAgIGZwc0luZm8ubGFzdEhVRCA9IG5vdzsKICAgICAgICAgICAgICBmcHNJbmZvLmR0cyA9IDA7CiAgICAgICAgICAgICAgZnBzSW5mby5udW0gPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmVzdGFydCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB0b3RhbFRpbWUgPSAwOwogICAgICAgICAgICByZXNldFBvc2l0aW9ucygpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBGTE9PUl9TSVpFID0gMTAwOwogICAgICAgICAgdmFyIEZMT09SX0hFSUdIVCA9IC01NgoKICAgICAgICAgIC8vIEN1YmljVlIgY29kZQoKICAgICAgICAgIHN0YXJ0VXAgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8nKS5pbm5lckhUTUwgPSAnPGI+Qm94ZXM6ICcgKyBOVU0gKyAnPC9iPic7CgogICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhbnZhcyIpOwogICAgICAgICAgICBjYW52YXMud2lkdGggPSBzY3JlZW4ud2lkdGgqMC43MDsKICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IHNjcmVlbi5oZWlnaHQqMC41NTsKCiAgICAgICAgICAgIHZhciBnbCA9IEN1YmljVlIuR0xDb3JlLmluaXQoY2FudmFzKTsKCiAgICAgICAgICAgIGlmICghZ2wpIHsKICAgICAgICAgICAgICBhbGVydCgiU29ycnksIG5vIFdlYkdMIHN1cHBvcnQgOigiKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgc2NlbmUgPSBuZXcgQ3ViaWNWUi5TY2VuZShjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQsIDcwKTsKCiAgICAgICAgICAgIHZhciBsaWdodCA9IG5ldyBDdWJpY1ZSLkxpZ2h0KHsKICAgICAgICAgICAgICB0eXBlOkN1YmljVlIuZW51bXMubGlnaHQudHlwZS5QT0lOVCwKICAgICAgICAgICAgICBwb3NpdGlvbjogWzAsIDAsIDVdLAogICAgICAgICAgICAgIGludGVuc2l0eTogMC45LAogICAgICAgICAgICAgIGFyZWFDZWlsaW5nOiA4MCwKICAgICAgICAgICAgICBhcmVhRmxvb3I6IEZMT09SX0hFSUdIVCwKICAgICAgICAgICAgICBhcmVhQXhpczogWzE1LCAxMF0sCiAgICAgICAgICAgICAgZGlzdGFuY2U6IDYwLAogICAgICAgICAgICAgIG1hcFJlczogMTAyNAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc2NlbmUuYmluZExpZ2h0KGxpZ2h0KTsKCiAgICAgICAgICAgIHNjZW5lLmNhbWVyYS5wb3NpdGlvbiA9IFswLCAyLjQsIDE3XTsKICAgICAgICAgICAgc2NlbmUuY2FtZXJhLnRhcmdldCA9IFswLCAyLjQsIDBdOwoKICAgICAgICAgICAgdmFyIGJveE1lc2hlcyA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykgewogICAgICAgICAgICAgIGJveE1lc2hlc1tpXSA9IG5ldyBDdWJpY1ZSLnByaW1pdGl2ZXMuYm94KHsKICAgICAgICAgICAgICAgIHNpemU6IDIuMCwKICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBuZXcgQ3ViaWNWUi5NYXRlcmlhbCh7CiAgICAgICAgICAgICAgICAgIHRleHR1cmVzOiB7CiAgICAgICAgICAgICAgICAgICAgY29sb3I6IG5ldyBDdWJpY1ZSLlRleHR1cmUoImN1YmUiICsgKChpICUgNSkrMSkgKyAiLmpwZyIpCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgdXZtYXBwZXI6IHsKICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbk1vZGU6IEN1YmljVlIuZW51bXMudXYucHJvamVjdGlvbi5DVUJJQywKICAgICAgICAgICAgICAgICAgc2NhbGU6IFsyLCAyLCAyXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLmNhbGNOb3JtYWxzKCkudHJpYW5ndWxhdGVRdWFkcygpLmNvbXBpbGUoKS5jbGVhbigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE5VTTsgaSsrKSB7CiAgICAgICAgICAgICAgYm94ZXNbaV0gPSBuZXcgQ3ViaWNWUi5TY2VuZU9iamVjdCh7IG1lc2g6IGJveE1lc2hlc1tpJTVdLCBwb3NpdGlvbjogWzAsIC0xMDAwMCwgMF0gfSk7CiAgICAgICAgICAgICAgc2NlbmUuYmluZFNjZW5lT2JqZWN0KGJveGVzW2ldLCB0cnVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGZsb29yTWF0ZXJpYWwgPSBuZXcgQ3ViaWNWUi5NYXRlcmlhbCh7CiAgICAgICAgICAgICAgdGV4dHVyZXM6IHsKICAgICAgICAgICAgICAgIGNvbG9yOiBuZXcgQ3ViaWNWUi5UZXh0dXJlKCJjdWJlMy5qcGciKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHZhciBmbG9vck1lc2ggPSBuZXcgIEN1YmljVlIucHJpbWl0aXZlcy5ib3goewogICAgICAgICAgICAgIHNpemU6IEZMT09SX1NJWkUsCiAgICAgICAgICAgICAgbWF0ZXJpYWw6IGZsb29yTWF0ZXJpYWwsCiAgICAgICAgICAgICAgdXZtYXBwZXI6IHsKICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbk1vZGU6IEN1YmljVlIuZW51bXMudXYucHJvamVjdGlvbi5DVUJJQywKICAgICAgICAgICAgICAgICAgc2NhbGU6IFs0LCA0LCA0XQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2FsY05vcm1hbHMoKS50cmlhbmd1bGF0ZVF1YWRzKCkuY29tcGlsZSgpLmNsZWFuKCk7CgogICAgICAgICAgICB2YXIgZmxvb3JfID0gbmV3IEN1YmljVlIuU2NlbmVPYmplY3QoeyBtZXNoOiBmbG9vck1lc2gsIHBvc2l0aW9uOiBbMCwgRkxPT1JfSEVJR0hULCAwXSB9KTsKICAgICAgICAgICAgc2NlbmUuYmluZFNjZW5lT2JqZWN0KGZsb29yXywgdHJ1ZSk7CgogICAgICAgICAgICAvL3ZhciBtdmMgPSBuZXcgQ3ViaWNWUi5Nb3VzZVZpZXdDb250cm9sbGVyKGNhbnZhcywgc2NlbmUuY2FtZXJhKTsKCiAgICAgICAgICAgIEN1YmljVlIuTWFpbkxvb3AoZnVuY3Rpb24odGltZXIsIGdsKSB7CiAgICAgICAgICAgICAgdmFyIGR0ID0gdGltZXIuZ2V0TGFzdFVwZGF0ZVNlY29uZHMoKTsKICAgICAgICAgICAgICBzaW11bGF0ZShkdCk7CiAgICAgICAgICAgICAgc2NlbmUudXBkYXRlU2hhZG93cygpOwogICAgICAgICAgICAgIHNjZW5lLnJlbmRlcigpOwogICAgICAgICAgICAgIHNob3dGUFMoZHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KSgpOwogICAgICA8L3NjcmlwdD4KICAgIDwvaGVhZD4KICAgIDxib2R5IG9ubG9hZD0ic3RhcnRVcCgpIj4KICAgICAgPGNlbnRlcj4KICAgICAgICA8aDI+Ym94MmQuanMgV2ViR0wgRGVtbzwvaDI+CiAgICAgICAgPGZvcm0+CiAgICAgICAgICBCb3hlcyA6CiAgICAgICAgICA8c2VsZWN0IG5hbWU9ImJveGVzIj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNTAwIiBzZWxlY3RlZD4ocGljayk8L29wdGlvbj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMTAiPjEwPC9vcHRpb24+CiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjUwIj41MDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxMDAiPjEwMDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIyMDAiPjIwMDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIzMDAiPjMwMDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI1MDAiPjUwMDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI3NTAiPjc1MDwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxMDAwIj4xMDAwPC9vcHRpb24+CiAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgIDxpbnB1dCB0eXBlPSJidXR0b24iIHZhbHVlPSJnbyEiIG9uY2xpY2s9IndpbmRvdy5sb2NhdGlvbiA9IHdpbmRvdy5sb2NhdGlvbi50b1N0cmluZygpLnNwbGl0KCc/JylbMF0gKyAnPycgKyBib3hlcy52YWx1ZTsiPgogICAgICAgIDwvZm9ybT4KICAgICAgICA8Y2FudmFzIGlkPSJjYW52YXMiIHdpZHRoPSI2MDAiIGhlaWdodD0iNTAwIj48L2NhbnZhcz4KICAgICAgICA8YnI+PGJyPgogICAgICAgIDxkaXY+RlBTIChjdXJyZW50IC8gc3RhYmxlKTogPGlucHV0IHR5cGU9InRleHQiIGlkPSJvdXQiIHJlYWRvbmx5PSIxIiBzaXplPSI3Ij48L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJpbmZvIj48L2Rpdj4KICAgICAgICA8cD4KICAgICAgICBUaGlzIGlzIDxiPjxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9rcmlwa2VuL2JveDJkLmpzIj5ib3gyZC5qczwvYT48L2I+LCBhIHBvcnQgb2YKICAgICAgICB0aGUgPGI+PGEgaHJlZj0iaHR0cDovL2JveDJkLm9yZy8iPkJveDJEIHBoeXNpY3MgZW5naW5lPC9hPjwvYj4gZnJvbSBDKysgdG8gSmF2YVNjcmlwdAogICAgICAgIHVzaW5nIDxiPjxhIGhyZWY9Imh0dHA6Ly9lbXNjcmlwdGVuLm9yZyI+RW1zY3JpcHRlbjwvYT48L2I+LiBXZWJHTCByZW5kZXJpbmcgaW4gdGhpcyBkZW1vIGlzIGRvbmUgdXNpbmcKICAgICAgICA8Yj48YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vY2pjbGlmZmUvQ3ViaWNWUi5qcy8iPkN1YmljVlIuanM8L2E+PC9iPi4KICAgICAgICA8L3A+CiAgICAgICAgPGlucHV0IHR5cGU9ImJ1dHRvbiIgb25jbGljaz0icmVzdGFydCgpIiB2YWx1ZT0icmVzdGFydCI+CiAgICAgIDwvY2VudGVyPgogICAgPC9ib2R5Pgo8L2h0bWw+Cgo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 14:00:27 GMT",
                    "Content-Length": "8681",
                    "Date": "Thu, 06 Nov 2014 14:00:35 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}