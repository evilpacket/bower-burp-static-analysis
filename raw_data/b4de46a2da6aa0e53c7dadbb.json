{
    "url": "http://localhost:9999/ibm-js/dapp/tests/unit/jqm/hideViewJqm/Test.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>location.href</b> and written to <b>history.pushState()</b> via the following statement:<ul><li>history.pushState(null, null, location.href.replace(/#/, ''));</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/ibm-js/dapp/tests/unit/jqm/hideViewJqm/Test.js",
                "path": "/ibm-js/dapp/tests/unit/jqm/hideViewJqm/Test.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9pYm0tanMvZGFwcC90ZXN0cy91bml0L2pxbS9oaWRlVmlld0pxbS9UZXN0LmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjM1OA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAyMDowMDozNCBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMjA6MDA6MzMgR01UDQoNCnJlcXVpcmUoWyJqcXVlcnkiXSwKCWZ1bmN0aW9uICgkKSB7CgkJLy8gdGhpcyBtdXN0IGJlIHNldHVwIGFmdGVyIGpxdWVyeSBpcyBsb2FkZWQsIGJ1dCBiZWZvcmUganF1ZXJ5Lm1vYmlsZSBpcyBsb2FkZWQKCQkkKGRvY3VtZW50KS5iaW5kKCJtb2JpbGVpbml0IiwgZnVuY3Rpb24gKCkgewoJCQkvLyBpZiB0aGlzIGlzIHNldCB0cnVlIHRvIHNlZSBpZiBpdCBoZWxwcyB0aGluZ3MKCQkJLy8JJC5tb2JpbGUucmVsb2FkID0gdHJ1ZTsKCgkJCS8vIGlmIHRoaXMgaXMgc2V0IGZhbHNlIHRoZSBhcHAgbXVzdCBjYWxsICQubW9iaWxlLmluaXRpYWxpemVQYWdlKCk7CgkJCSQubW9iaWxlLmF1dG9Jbml0aWFsaXplUGFnZSA9IGZhbHNlOwoKCQkJLy8gUHJldmVudHMgYWxsIGFuY2hvciBjbGljayBoYW5kbGluZwoJCQkkLm1vYmlsZS5saW5rQmluZGluZ0VuYWJsZWQgPSBmYWxzZTsKCgkJCS8vIERpc2FibGluZyB0aGlzIHdpbGwgcHJldmVudCBqUXVlcnkgTW9iaWxlIGZyb20gaGFuZGxpbmcgaGFzaCBjaGFuZ2VzCgkJCS8vIGlmIGVuYWJsZWQgSGlzdG9yeSBjb250cm9sbGVyIHNob3VsZCBub3QgYmUgdXNlZC4KCQkJJC5tb2JpbGUuaGFzaExpc3RlbmluZ0VuYWJsZWQgPSBmYWxzZTsKCgkJCS8vIGtlZXAgYWxsIHByZXZpb3VzbHktdmlzaXRlZCBwYWdlcyBpbiB0aGUgRE9NCgkJCSQubW9iaWxlLnBhZ2UucHJvdG90eXBlLm9wdGlvbnMuZG9tQ2FjaGUgPSB0cnVlOwoKCQkJLy8gdGhlIGhhc2ggaW4gdGhlIGxvY2F0aW9uIGJhciBzaG91bGQgbm90IGJlIHVwZGF0ZWQgYnkganF1ZXJ5Lm1vYmlsZQoJCQkkLm1vYmlsZS5jaGFuZ2VQYWdlLmRlZmF1bHRzLmNoYW5nZUhhc2ggPSBmYWxzZTsKCQl9KTsKCX0pOwoKLy8ganNoaW50IHF1b3RtYXJrOmZhbHNlCmRlZmluZShbCgkiaW50ZXJuIW9iamVjdCIsCgkiaW50ZXJuL2NoYWkhYXNzZXJ0IiwKCSJkYXBwL0FwcGxpY2F0aW9uIiwKCSJkYXBwL3V0aWxzL3ZpZXciLAoJImRvam8vRGVmZXJyZWQiLAoJInJlcXVpcmVqcy10ZXh0L3RleHQhZGFwcC90ZXN0cy91bml0L2pxbS9oaWRlVmlld0pxbS9hcHAuanNvbiIsCgkianF1ZXJ5IiwKCSJqcXVlcnkubW9iaWxlIiwKCSJkZWxpdGVmdWwvTGluZWFyTGF5b3V0IiwKCSJkZWxpdGVmdWwvVmlld1N0YWNrIgpdLCBmdW5jdGlvbiAocmVnaXN0ZXJTdWl0ZSwgYXNzZXJ0LCBBcHBsaWNhdGlvbiwgdmlld1V0aWxzLCBEZWZlcnJlZCwganFtaGlkZVZpZXdKcW1jb25maWcsICQpIHsKCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vCgkvLyBmb3IganFtaGlkZVZpZXdKcW1TdWl0ZQoJdmFyIGpxbWhpZGVWaWV3SnFtQ29udGFpbmVyMywKCQl0ZXN0QXBwLAoJCWhpZGVWaWV3SnFtQXBwSG9tZTFWaWV3LAoJCWhpZGVWaWV3SnFtQXBwSG9tZTJWaWV3LAoJCWpxbWhpZGVWaWV3SnFtTm9kZTM7CgoJdmFyIGpxbWhpZGVWaWV3SnFtSHRtbENvbnRlbnQzID0KCQknPGRpdiBpZD0ibWFpblBub2RlSlFNIj4gPGRpdiBpZD0iZHVtbXlQYWdlIiBkYXRhLXJvbGU9InBhZ2UiPjwvZGl2PjwvZGl2Pic7CgkvLwknPGRpdiBpZD0ibWFpblBub2RlSlFNIj4gPGRpdiBpZD0iZHVtbXlQYWdlIiBkYXRhLXJvbGU9InBhZ2UiPjwvZGl2PicgKwoJLy8gJzxkaXYgaWQ9ImhvbWVDb250YWluZXIiIGRhdGEtcm9sZT0icGFnZSI+PC9kaXY+PGRpdiBpZD0iZGV0YWlsQ29udGFpbmVyIiBkYXRhLXJvbGU9InBhZ2UiPjwvZGl2PjwvZGl2PjwvZGl2Pic7CgoJdmFyIGpxbWhpZGVWaWV3SnFtU3VpdGUgPSB7CgkJbmFtZTogImpxbWhpZGVWaWV3SnFtU3VpdGUgZGFwcCBqcW1oaWRlVmlld0pxbTogdGVzdCBhcHAgdHJhbnNpdGlvbnMiLAoJCXNldHVwOiBmdW5jdGlvbiAoKSB7CgkJCWRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0ganFtaGlkZVZpZXdKcW1IdG1sQ29udGVudDM7CgkJCWpxbWhpZGVWaWV3SnFtTm9kZTMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGlkZVZpZXdKcW1BcHBkdmlld1N0YWNrIik7CgkJCS8vIGRvbid0IGZvcmdldCB0byB0cmlnZ2VyIGpxdWVyeS5tb2JpbGUgbWFudWFsbHkKCQkJaWYgKCQubW9iaWxlLmF1dG9Jbml0aWFsaXplUGFnZSA9PT0gZmFsc2UpIHsKCQkJCSQubW9iaWxlLmluaXRpYWxpemVQYWdlKCk7CgkJCX0KCQl9LAoJCSJqcW1oaWRlVmlld0pxbVN1aXRlIGRhcHAganFtaGlkZVZpZXdKcW0gdGVzdCBpbml0aWFsIGxheW91dCI6IGZ1bmN0aW9uICgpIHsKCQkJdGhpcy50aW1lb3V0ID0gMjAwMDA7CgoJCQl2YXIgYXBwU3RhcnRlZERlZiA9IG5ldyBBcHBsaWNhdGlvbihKU09OLnBhcnNlKHN0cmlwQ29tbWVudHMoanFtaGlkZVZpZXdKcW1jb25maWcpKSwKCQkJCWpxbWhpZGVWaWV3SnFtQ29udGFpbmVyMyk7CgkJCXJldHVybiBhcHBTdGFydGVkRGVmLnRoZW4oZnVuY3Rpb24gKGFwcCkgewoJCQkJLy8gd2UgYXJlIHJlYWR5IHRvIHRlc3QKCQkJCXRlc3RBcHAgPSBhcHA7CgoJCQkJLy92YXIgaGlkZVZpZXdKcW1BcHBIb21lMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoaWRlVmlld0pxbUFwcEhvbWUxIik7CgkJCQloaWRlVmlld0pxbUFwcEhvbWUxVmlldyA9IHZpZXdVdGlscy5nZXRWaWV3RnJvbVZpZXdJZCh0ZXN0QXBwLCAiaGlkZVZpZXdKcW1BcHBIb21lMSIpOwoJCQkJYXNzZXJ0LnN0cmljdEVxdWFsKGhpZGVWaWV3SnFtQXBwSG9tZTFWaWV3Ll9iZWZvcmVBY3RpdmF0ZUNhbGxDb3VudCwgMSwKCQkJCQkiaGlkZVZpZXdKcW1BcHBIb21lMVZpZXcuX2JlZm9yZUFjdGl2YXRlQ2FsbENvdW50IHNob3VsZCBiZSAxIik7CgkJCX0pOwoJCX0sCgkJIlRlc3Qgc2hvd09ySGlkZVZpZXdzKCdoaWRlVmlld0pxbUFwcEhvbWUyJyAiOiBmdW5jdGlvbiAoKSB7CgkJCXRoaXMudGltZW91dCA9IDIwMDAwOwoJCQl2YXIgZGlzcGxheURlZmVycmVkID0gbmV3IERlZmVycmVkKCk7CgoJCQl0ZXN0QXBwLnNob3dPckhpZGVWaWV3cygnaGlkZVZpZXdKcW1BcHBIb21lMicsIHsKCQkJCWRpc3BsYXlEZWZlcnJlZDogZGlzcGxheURlZmVycmVkCgkJCX0pOwoJCQlyZXR1cm4gZGlzcGxheURlZmVycmVkLnRoZW4oZnVuY3Rpb24gKCkgewoJCQkJaGlkZVZpZXdKcW1BcHBIb21lMlZpZXcgPSB2aWV3VXRpbHMuZ2V0Vmlld0Zyb21WaWV3SWQodGVzdEFwcCwgImhpZGVWaWV3SnFtQXBwSG9tZTIiKTsKCQkJCWNoZWNrQWN0aXZhdGVDYWxsQ291bnQoaGlkZVZpZXdKcW1BcHBIb21lMlZpZXcsIDEpOwoJCQkJY2hlY2tEZWFjdGl2YXRlQ2FsbENvdW50KGhpZGVWaWV3SnFtQXBwSG9tZTFWaWV3LCAxKTsKCQkJfSk7CgkJfSwKCQkiVGVzdCBzaG93T3JIaWRlVmlld3MoJ2hpZGVWaWV3SnFtQXBwSG9tZTEnICI6IGZ1bmN0aW9uICgpIHsKCQkJdGhpcy50aW1lb3V0ID0gMjAwMDA7CgkJCXZhciBkaXNwbGF5RGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTsKCgkJCXRlc3RBcHAuc2hvd09ySGlkZVZpZXdzKCdoaWRlVmlld0pxbUFwcEhvbWUxJywgewoJCQkJZGlzcGxheURlZmVycmVkOiBkaXNwbGF5RGVmZXJyZWQKCQkJfSk7CgkJCXJldHVybiBkaXNwbGF5RGVmZXJyZWQudGhlbihmdW5jdGlvbiAoKSB7CgkJCQljaGVja0FjdGl2YXRlQ2FsbENvdW50KGhpZGVWaWV3SnFtQXBwSG9tZTFWaWV3LCAyKTsKCQkJCWNoZWNrRGVhY3RpdmF0ZUNhbGxDb3VudChoaWRlVmlld0pxbUFwcEhvbWUyVmlldywgMSk7CgkJCX0pOwoJCX0sCgkJIlRlc3Qgc2hvd09ySGlkZVZpZXdzKCctaGlkZVZpZXdKcW1BcHBIb21lMScgIjogZnVuY3Rpb24gKCkgewoJCQl0aGlzLnRpbWVvdXQgPSAyMDAwMDsKCQkJdmFyIGRpc3BsYXlEZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpOwoKCQkJdGVzdEFwcC5zaG93T3JIaWRlVmlld3MoJy1oaWRlVmlld0pxbUFwcEhvbWUxJywgewoJCQkJZGlzcGxheURlZmVycmVkOiBkaXNwbGF5RGVmZXJyZWQKCQkJfSk7CgkJCXJldHVybiBkaXNwbGF5RGVmZXJyZWQudGhlbihmdW5jdGlvbiAoKSB7CgkJCQkvL2NoZWNrQWN0aXZhdGVDYWxsQ291bnQoaGlkZVZpZXdKcW1BcHBIb21lMVZpZXcsIDIpOwoJCQkJY2hlY2tEZWFjdGl2YXRlQ2FsbENvdW50KGhpZGVWaWV3SnFtQXBwSG9tZTFWaWV3LCAyKTsKCQkJfSk7CgkJfSwKCQkiVGVzdCBzaG93T3JIaWRlVmlld3MoJ2hpZGVWaWV3SnFtQXBwSG9tZTInKSBhZ2FpbiAiOiBmdW5jdGlvbiAoKSB7CgkJCXRoaXMudGltZW91dCA9IDIwMDAwOwoJCQl2YXIgZGlzcGxheURlZmVycmVkID0gbmV3IERlZmVycmVkKCk7CgoJCQl0ZXN0QXBwLnNob3dPckhpZGVWaWV3cygnaGlkZVZpZXdKcW1BcHBIb21lMicsIHsKCQkJCWRpc3BsYXlEZWZlcnJlZDogZGlzcGxheURlZmVycmVkCgkJCX0pOwoJCQlyZXR1cm4gZGlzcGxheURlZmVycmVkLnRoZW4oZnVuY3Rpb24gKCkgewoJCQkJY2hlY2tBY3RpdmF0ZUNhbGxDb3VudChoaWRlVmlld0pxbUFwcEhvbWUyVmlldywgMik7CgkJCQljaGVja0RlYWN0aXZhdGVDYWxsQ291bnQoaGlkZVZpZXdKcW1BcHBIb21lMVZpZXcsIDIpOwoJCQl9KTsKCQl9LAoJCXRlYXJkb3duOiBmdW5jdGlvbiAoKSB7CgkJCS8vIGNhbGwgdW5sb2FkQXBwIHRvIGNsZWFudXAgYW5kIGVuZCB0aGUgdGVzdAoJCQl2YXIgbWFpbk5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWFpblBub2RlSlFNIik7CgkJCW1haW5Ob2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobWFpbk5vZGUpOwoJCQl0ZXN0QXBwLnVubG9hZEFwcCgpOwoJCQkvLyB0aGlzIGlzIHRvIHJlc2V0IHRoZSB1cmwgc28gdGhhdCBhIGJyb3dzZXIgcmVmcmVzaCBjYW4gcmVydW4gdGhlIHRlc3RzCgkJCWxvY2F0aW9uLmhhc2ggPSAiP2NvbmZpZz10ZXN0cy9pbnRlcm4uYnJvd3NlciI7CgkJCWhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIGxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy8sICcnKSk7CgkJfQoJfTsKCglyZWdpc3RlclN1aXRlKGpxbWhpZGVWaWV3SnFtU3VpdGUpOwoKCWZ1bmN0aW9uIGNoZWNrQWN0aXZhdGVDYWxsQ291bnQodmlldywgY291bnQpIHsKCQlpZiAodmlldykgewoJCQlhc3NlcnQuc3RyaWN0RXF1YWwodmlldy5fYmVmb3JlQWN0aXZhdGVDYWxsQ291bnQsIGNvdW50LAoJCQkJdmlldy5pZCArICIgX2JlZm9yZUFjdGl2YXRlQ2FsbENvdW50IHNob3VsZCBiZSAiICsgY291bnQpOwoJCQlhc3NlcnQuc3RyaWN0RXF1YWwodmlldy5fYWZ0ZXJBY3RpdmF0ZUNhbGxDb3VudCwgY291bnQsCgkJCQl2aWV3LmlkICsgIiBfYWZ0ZXJBY3RpdmF0ZUNhbGxDb3VudCBzaG91bGQgYmUgIiArIGNvdW50KTsKCgkJCS8vYWxzbyB0ZXN0IGZvciBzZWxlY3RlZENoaWxkcmVuIGJlaW5nIHNldCBjb3JyZWN0bHkgd2l0aCBjb25zdHJhaW50IG1haW4KCQkJdmFyIHNlbGVjdGVkQ2hpbGRJZCA9IHRlc3RBcHAuc2VsZWN0ZWRDaGlsZHJlbi5jZW50ZXIuaWQ7CgkJCWFzc2VydC5zdHJpY3RFcXVhbCh2aWV3LmlkLCBzZWxlY3RlZENoaWxkSWQsIHZpZXcuaWQgKyAiIHNob3VsZCBiZSBpbiB0ZXN0QXBwLnNlbGVjdGVkQ2hpbGRyZW4uY2VudGVyLiAiKTsKCgkJCS8vYWxzbyB0ZXN0IGZvciB2aWV3Ll9hY3RpdmUgYmVpbmcgc2V0IGNvcnJlY3RseSB0byB0cnVlCgkJCWFzc2VydC5pc1RydWUodmlldy5fYWN0aXZlLCAidmlld19hY3RpdmUgc2hvdWxkIGJlIHRydWUgZm9yICIgKyB2aWV3LmlkKTsKCQl9Cgl9CgoJZnVuY3Rpb24gY2hlY2tEZWFjdGl2YXRlQ2FsbENvdW50KHZpZXcsIGNvdW50KSB7CgkJCWlmICh2aWV3KSB7CgkJCQlhc3NlcnQuc3RyaWN0RXF1YWwodmlldy5fYmVmb3JlRGVhY3RpdmF0ZUNhbGxDb3VudCwgY291bnQsCgkJCQkJdmlldy5pZCArICIgX2JlZm9yZURlYWN0aXZhdGVDYWxsQ291bnQgc2hvdWxkIGJlICIgKyBjb3VudCk7CgkJCQlhc3NlcnQuc3RyaWN0RXF1YWwodmlldy5fYWZ0ZXJEZWFjdGl2YXRlQ2FsbENvdW50LCBjb3VudCwKCQkJCQl2aWV3LmlkICsgIiBfYWZ0ZXJEZWFjdGl2YXRlQ2FsbENvdW50IHNob3VsZCBiZSAiICsgY291bnQpOwoKCQkJCS8vYWxzbyB0ZXN0IGZvciB2aWV3Ll9hY3RpdmUgYmVpbmcgc2V0IGNvcnJlY3RseSB0byBmYWxzZQoJCQkJYXNzZXJ0LmlzRmFsc2Uodmlldy5fYWN0aXZlLCAidmlld19hY3RpdmUgc2hvdWxkIGJlIGZhbHNlIGZvciAiICsgdmlldy5pZCk7CgkJCX0KCQl9CgkJLy8gc3RyaXAgb3V0IHNpbmdsZSBsaW5lIGNvbW1lbnRzIGZyb20gdGhlIGpzb24gY29uZmlnCglmdW5jdGlvbiBzdHJpcENvbW1lbnRzKGpzb25EYXRhKSB7CgkJanNvbkRhdGEgPSBqc29uRGF0YS5yZXBsYWNlKC9cL1wqLio/XCpcLy9nLCAiIik7CgkJanNvbkRhdGEgPSBqc29uRGF0YS5yZXBsYWNlKC9cL1wvLiovZywgIiIpOwoJCXJldHVybiBqc29uRGF0YTsKCX0KCn0pOwo=",
                "body": "cmVxdWlyZShbImpxdWVyeSJdLAoJZnVuY3Rpb24gKCQpIHsKCQkvLyB0aGlzIG11c3QgYmUgc2V0dXAgYWZ0ZXIganF1ZXJ5IGlzIGxvYWRlZCwgYnV0IGJlZm9yZSBqcXVlcnkubW9iaWxlIGlzIGxvYWRlZAoJCSQoZG9jdW1lbnQpLmJpbmQoIm1vYmlsZWluaXQiLCBmdW5jdGlvbiAoKSB7CgkJCS8vIGlmIHRoaXMgaXMgc2V0IHRydWUgdG8gc2VlIGlmIGl0IGhlbHBzIHRoaW5ncwoJCQkvLwkkLm1vYmlsZS5yZWxvYWQgPSB0cnVlOwoKCQkJLy8gaWYgdGhpcyBpcyBzZXQgZmFsc2UgdGhlIGFwcCBtdXN0IGNhbGwgJC5tb2JpbGUuaW5pdGlhbGl6ZVBhZ2UoKTsKCQkJJC5tb2JpbGUuYXV0b0luaXRpYWxpemVQYWdlID0gZmFsc2U7CgoJCQkvLyBQcmV2ZW50cyBhbGwgYW5jaG9yIGNsaWNrIGhhbmRsaW5nCgkJCSQubW9iaWxlLmxpbmtCaW5kaW5nRW5hYmxlZCA9IGZhbHNlOwoKCQkJLy8gRGlzYWJsaW5nIHRoaXMgd2lsbCBwcmV2ZW50IGpRdWVyeSBNb2JpbGUgZnJvbSBoYW5kbGluZyBoYXNoIGNoYW5nZXMKCQkJLy8gaWYgZW5hYmxlZCBIaXN0b3J5IGNvbnRyb2xsZXIgc2hvdWxkIG5vdCBiZSB1c2VkLgoJCQkkLm1vYmlsZS5oYXNoTGlzdGVuaW5nRW5hYmxlZCA9IGZhbHNlOwoKCQkJLy8ga2VlcCBhbGwgcHJldmlvdXNseS12aXNpdGVkIHBhZ2VzIGluIHRoZSBET00KCQkJJC5tb2JpbGUucGFnZS5wcm90b3R5cGUub3B0aW9ucy5kb21DYWNoZSA9IHRydWU7CgoJCQkvLyB0aGUgaGFzaCBpbiB0aGUgbG9jYXRpb24gYmFyIHNob3VsZCBub3QgYmUgdXBkYXRlZCBieSBqcXVlcnkubW9iaWxlCgkJCSQubW9iaWxlLmNoYW5nZVBhZ2UuZGVmYXVsdHMuY2hhbmdlSGFzaCA9IGZhbHNlOwoJCX0pOwoJfSk7CgovLyBqc2hpbnQgcXVvdG1hcms6ZmFsc2UKZGVmaW5lKFsKCSJpbnRlcm4hb2JqZWN0IiwKCSJpbnRlcm4vY2hhaSFhc3NlcnQiLAoJImRhcHAvQXBwbGljYXRpb24iLAoJImRhcHAvdXRpbHMvdmlldyIsCgkiZG9qby9EZWZlcnJlZCIsCgkicmVxdWlyZWpzLXRleHQvdGV4dCFkYXBwL3Rlc3RzL3VuaXQvanFtL2hpZGVWaWV3SnFtL2FwcC5qc29uIiwKCSJqcXVlcnkiLAoJImpxdWVyeS5tb2JpbGUiLAoJImRlbGl0ZWZ1bC9MaW5lYXJMYXlvdXQiLAoJImRlbGl0ZWZ1bC9WaWV3U3RhY2siCl0sIGZ1bmN0aW9uIChyZWdpc3RlclN1aXRlLCBhc3NlcnQsIEFwcGxpY2F0aW9uLCB2aWV3VXRpbHMsIERlZmVycmVkLCBqcW1oaWRlVmlld0pxbWNvbmZpZywgJCkgewoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy8KCS8vIGZvciBqcW1oaWRlVmlld0pxbVN1aXRlCgl2YXIganFtaGlkZVZpZXdKcW1Db250YWluZXIzLAoJCXRlc3RBcHAsCgkJaGlkZVZpZXdKcW1BcHBIb21lMVZpZXcsCgkJaGlkZVZpZXdKcW1BcHBIb21lMlZpZXcsCgkJanFtaGlkZVZpZXdKcW1Ob2RlMzsKCgl2YXIganFtaGlkZVZpZXdKcW1IdG1sQ29udGVudDMgPQoJCSc8ZGl2IGlkPSJtYWluUG5vZGVKUU0iPiA8ZGl2IGlkPSJkdW1teVBhZ2UiIGRhdGEtcm9sZT0icGFnZSI+PC9kaXY+PC9kaXY+JzsKCS8vCSc8ZGl2IGlkPSJtYWluUG5vZGVKUU0iPiA8ZGl2IGlkPSJkdW1teVBhZ2UiIGRhdGEtcm9sZT0icGFnZSI+PC9kaXY+JyArCgkvLyAnPGRpdiBpZD0iaG9tZUNvbnRhaW5lciIgZGF0YS1yb2xlPSJwYWdlIj48L2Rpdj48ZGl2IGlkPSJkZXRhaWxDb250YWluZXIiIGRhdGEtcm9sZT0icGFnZSI+PC9kaXY+PC9kaXY+PC9kaXY+JzsKCgl2YXIganFtaGlkZVZpZXdKcW1TdWl0ZSA9IHsKCQluYW1lOiAianFtaGlkZVZpZXdKcW1TdWl0ZSBkYXBwIGpxbWhpZGVWaWV3SnFtOiB0ZXN0IGFwcCB0cmFuc2l0aW9ucyIsCgkJc2V0dXA6IGZ1bmN0aW9uICgpIHsKCQkJZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSBqcW1oaWRlVmlld0pxbUh0bWxDb250ZW50MzsKCQkJanFtaGlkZVZpZXdKcW1Ob2RlMyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoaWRlVmlld0pxbUFwcGR2aWV3U3RhY2siKTsKCQkJLy8gZG9uJ3QgZm9yZ2V0IHRvIHRyaWdnZXIganF1ZXJ5Lm1vYmlsZSBtYW51YWxseQoJCQlpZiAoJC5tb2JpbGUuYXV0b0luaXRpYWxpemVQYWdlID09PSBmYWxzZSkgewoJCQkJJC5tb2JpbGUuaW5pdGlhbGl6ZVBhZ2UoKTsKCQkJfQoJCX0sCgkJImpxbWhpZGVWaWV3SnFtU3VpdGUgZGFwcCBqcW1oaWRlVmlld0pxbSB0ZXN0IGluaXRpYWwgbGF5b3V0IjogZnVuY3Rpb24gKCkgewoJCQl0aGlzLnRpbWVvdXQgPSAyMDAwMDsKCgkJCXZhciBhcHBTdGFydGVkRGVmID0gbmV3IEFwcGxpY2F0aW9uKEpTT04ucGFyc2Uoc3RyaXBDb21tZW50cyhqcW1oaWRlVmlld0pxbWNvbmZpZykpLAoJCQkJanFtaGlkZVZpZXdKcW1Db250YWluZXIzKTsKCQkJcmV0dXJuIGFwcFN0YXJ0ZWREZWYudGhlbihmdW5jdGlvbiAoYXBwKSB7CgkJCQkvLyB3ZSBhcmUgcmVhZHkgdG8gdGVzdAoJCQkJdGVzdEFwcCA9IGFwcDsKCgkJCQkvL3ZhciBoaWRlVmlld0pxbUFwcEhvbWUxID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhpZGVWaWV3SnFtQXBwSG9tZTEiKTsKCQkJCWhpZGVWaWV3SnFtQXBwSG9tZTFWaWV3ID0gdmlld1V0aWxzLmdldFZpZXdGcm9tVmlld0lkKHRlc3RBcHAsICJoaWRlVmlld0pxbUFwcEhvbWUxIik7CgkJCQlhc3NlcnQuc3RyaWN0RXF1YWwoaGlkZVZpZXdKcW1BcHBIb21lMVZpZXcuX2JlZm9yZUFjdGl2YXRlQ2FsbENvdW50LCAxLAoJCQkJCSJoaWRlVmlld0pxbUFwcEhvbWUxVmlldy5fYmVmb3JlQWN0aXZhdGVDYWxsQ291bnQgc2hvdWxkIGJlIDEiKTsKCQkJfSk7CgkJfSwKCQkiVGVzdCBzaG93T3JIaWRlVmlld3MoJ2hpZGVWaWV3SnFtQXBwSG9tZTInICI6IGZ1bmN0aW9uICgpIHsKCQkJdGhpcy50aW1lb3V0ID0gMjAwMDA7CgkJCXZhciBkaXNwbGF5RGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTsKCgkJCXRlc3RBcHAuc2hvd09ySGlkZVZpZXdzKCdoaWRlVmlld0pxbUFwcEhvbWUyJywgewoJCQkJZGlzcGxheURlZmVycmVkOiBkaXNwbGF5RGVmZXJyZWQKCQkJfSk7CgkJCXJldHVybiBkaXNwbGF5RGVmZXJyZWQudGhlbihmdW5jdGlvbiAoKSB7CgkJCQloaWRlVmlld0pxbUFwcEhvbWUyVmlldyA9IHZpZXdVdGlscy5nZXRWaWV3RnJvbVZpZXdJZCh0ZXN0QXBwLCAiaGlkZVZpZXdKcW1BcHBIb21lMiIpOwoJCQkJY2hlY2tBY3RpdmF0ZUNhbGxDb3VudChoaWRlVmlld0pxbUFwcEhvbWUyVmlldywgMSk7CgkJCQljaGVja0RlYWN0aXZhdGVDYWxsQ291bnQoaGlkZVZpZXdKcW1BcHBIb21lMVZpZXcsIDEpOwoJCQl9KTsKCQl9LAoJCSJUZXN0IHNob3dPckhpZGVWaWV3cygnaGlkZVZpZXdKcW1BcHBIb21lMScgIjogZnVuY3Rpb24gKCkgewoJCQl0aGlzLnRpbWVvdXQgPSAyMDAwMDsKCQkJdmFyIGRpc3BsYXlEZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpOwoKCQkJdGVzdEFwcC5zaG93T3JIaWRlVmlld3MoJ2hpZGVWaWV3SnFtQXBwSG9tZTEnLCB7CgkJCQlkaXNwbGF5RGVmZXJyZWQ6IGRpc3BsYXlEZWZlcnJlZAoJCQl9KTsKCQkJcmV0dXJuIGRpc3BsYXlEZWZlcnJlZC50aGVuKGZ1bmN0aW9uICgpIHsKCQkJCWNoZWNrQWN0aXZhdGVDYWxsQ291bnQoaGlkZVZpZXdKcW1BcHBIb21lMVZpZXcsIDIpOwoJCQkJY2hlY2tEZWFjdGl2YXRlQ2FsbENvdW50KGhpZGVWaWV3SnFtQXBwSG9tZTJWaWV3LCAxKTsKCQkJfSk7CgkJfSwKCQkiVGVzdCBzaG93T3JIaWRlVmlld3MoJy1oaWRlVmlld0pxbUFwcEhvbWUxJyAiOiBmdW5jdGlvbiAoKSB7CgkJCXRoaXMudGltZW91dCA9IDIwMDAwOwoJCQl2YXIgZGlzcGxheURlZmVycmVkID0gbmV3IERlZmVycmVkKCk7CgoJCQl0ZXN0QXBwLnNob3dPckhpZGVWaWV3cygnLWhpZGVWaWV3SnFtQXBwSG9tZTEnLCB7CgkJCQlkaXNwbGF5RGVmZXJyZWQ6IGRpc3BsYXlEZWZlcnJlZAoJCQl9KTsKCQkJcmV0dXJuIGRpc3BsYXlEZWZlcnJlZC50aGVuKGZ1bmN0aW9uICgpIHsKCQkJCS8vY2hlY2tBY3RpdmF0ZUNhbGxDb3VudChoaWRlVmlld0pxbUFwcEhvbWUxVmlldywgMik7CgkJCQljaGVja0RlYWN0aXZhdGVDYWxsQ291bnQoaGlkZVZpZXdKcW1BcHBIb21lMVZpZXcsIDIpOwoJCQl9KTsKCQl9LAoJCSJUZXN0IHNob3dPckhpZGVWaWV3cygnaGlkZVZpZXdKcW1BcHBIb21lMicpIGFnYWluICI6IGZ1bmN0aW9uICgpIHsKCQkJdGhpcy50aW1lb3V0ID0gMjAwMDA7CgkJCXZhciBkaXNwbGF5RGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTsKCgkJCXRlc3RBcHAuc2hvd09ySGlkZVZpZXdzKCdoaWRlVmlld0pxbUFwcEhvbWUyJywgewoJCQkJZGlzcGxheURlZmVycmVkOiBkaXNwbGF5RGVmZXJyZWQKCQkJfSk7CgkJCXJldHVybiBkaXNwbGF5RGVmZXJyZWQudGhlbihmdW5jdGlvbiAoKSB7CgkJCQljaGVja0FjdGl2YXRlQ2FsbENvdW50KGhpZGVWaWV3SnFtQXBwSG9tZTJWaWV3LCAyKTsKCQkJCWNoZWNrRGVhY3RpdmF0ZUNhbGxDb3VudChoaWRlVmlld0pxbUFwcEhvbWUxVmlldywgMik7CgkJCX0pOwoJCX0sCgkJdGVhcmRvd246IGZ1bmN0aW9uICgpIHsKCQkJLy8gY2FsbCB1bmxvYWRBcHAgdG8gY2xlYW51cCBhbmQgZW5kIHRoZSB0ZXN0CgkJCXZhciBtYWluTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYWluUG5vZGVKUU0iKTsKCQkJbWFpbk5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChtYWluTm9kZSk7CgkJCXRlc3RBcHAudW5sb2FkQXBwKCk7CgkJCS8vIHRoaXMgaXMgdG8gcmVzZXQgdGhlIHVybCBzbyB0aGF0IGEgYnJvd3NlciByZWZyZXNoIGNhbiByZXJ1biB0aGUgdGVzdHMKCQkJbG9jYXRpb24uaGFzaCA9ICI/Y29uZmlnPXRlc3RzL2ludGVybi5icm93c2VyIjsKCQkJaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgbG9jYXRpb24uaHJlZi5yZXBsYWNlKC8jLywgJycpKTsKCQl9Cgl9OwoKCXJlZ2lzdGVyU3VpdGUoanFtaGlkZVZpZXdKcW1TdWl0ZSk7CgoJZnVuY3Rpb24gY2hlY2tBY3RpdmF0ZUNhbGxDb3VudCh2aWV3LCBjb3VudCkgewoJCWlmICh2aWV3KSB7CgkJCWFzc2VydC5zdHJpY3RFcXVhbCh2aWV3Ll9iZWZvcmVBY3RpdmF0ZUNhbGxDb3VudCwgY291bnQsCgkJCQl2aWV3LmlkICsgIiBfYmVmb3JlQWN0aXZhdGVDYWxsQ291bnQgc2hvdWxkIGJlICIgKyBjb3VudCk7CgkJCWFzc2VydC5zdHJpY3RFcXVhbCh2aWV3Ll9hZnRlckFjdGl2YXRlQ2FsbENvdW50LCBjb3VudCwKCQkJCXZpZXcuaWQgKyAiIF9hZnRlckFjdGl2YXRlQ2FsbENvdW50IHNob3VsZCBiZSAiICsgY291bnQpOwoKCQkJLy9hbHNvIHRlc3QgZm9yIHNlbGVjdGVkQ2hpbGRyZW4gYmVpbmcgc2V0IGNvcnJlY3RseSB3aXRoIGNvbnN0cmFpbnQgbWFpbgoJCQl2YXIgc2VsZWN0ZWRDaGlsZElkID0gdGVzdEFwcC5zZWxlY3RlZENoaWxkcmVuLmNlbnRlci5pZDsKCQkJYXNzZXJ0LnN0cmljdEVxdWFsKHZpZXcuaWQsIHNlbGVjdGVkQ2hpbGRJZCwgdmlldy5pZCArICIgc2hvdWxkIGJlIGluIHRlc3RBcHAuc2VsZWN0ZWRDaGlsZHJlbi5jZW50ZXIuICIpOwoKCQkJLy9hbHNvIHRlc3QgZm9yIHZpZXcuX2FjdGl2ZSBiZWluZyBzZXQgY29ycmVjdGx5IHRvIHRydWUKCQkJYXNzZXJ0LmlzVHJ1ZSh2aWV3Ll9hY3RpdmUsICJ2aWV3X2FjdGl2ZSBzaG91bGQgYmUgdHJ1ZSBmb3IgIiArIHZpZXcuaWQpOwoJCX0KCX0KCglmdW5jdGlvbiBjaGVja0RlYWN0aXZhdGVDYWxsQ291bnQodmlldywgY291bnQpIHsKCQkJaWYgKHZpZXcpIHsKCQkJCWFzc2VydC5zdHJpY3RFcXVhbCh2aWV3Ll9iZWZvcmVEZWFjdGl2YXRlQ2FsbENvdW50LCBjb3VudCwKCQkJCQl2aWV3LmlkICsgIiBfYmVmb3JlRGVhY3RpdmF0ZUNhbGxDb3VudCBzaG91bGQgYmUgIiArIGNvdW50KTsKCQkJCWFzc2VydC5zdHJpY3RFcXVhbCh2aWV3Ll9hZnRlckRlYWN0aXZhdGVDYWxsQ291bnQsIGNvdW50LAoJCQkJCXZpZXcuaWQgKyAiIF9hZnRlckRlYWN0aXZhdGVDYWxsQ291bnQgc2hvdWxkIGJlICIgKyBjb3VudCk7CgoJCQkJLy9hbHNvIHRlc3QgZm9yIHZpZXcuX2FjdGl2ZSBiZWluZyBzZXQgY29ycmVjdGx5IHRvIGZhbHNlCgkJCQlhc3NlcnQuaXNGYWxzZSh2aWV3Ll9hY3RpdmUsICJ2aWV3X2FjdGl2ZSBzaG91bGQgYmUgZmFsc2UgZm9yICIgKyB2aWV3LmlkKTsKCQkJfQoJCX0KCQkvLyBzdHJpcCBvdXQgc2luZ2xlIGxpbmUgY29tbWVudHMgZnJvbSB0aGUganNvbiBjb25maWcKCWZ1bmN0aW9uIHN0cmlwQ29tbWVudHMoanNvbkRhdGEpIHsKCQlqc29uRGF0YSA9IGpzb25EYXRhLnJlcGxhY2UoL1wvXCouKj9cKlwvL2csICIiKTsKCQlqc29uRGF0YSA9IGpzb25EYXRhLnJlcGxhY2UoL1wvXC8uKi9nLCAiIik7CgkJcmV0dXJuIGpzb25EYXRhOwoJfQoKfSk7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 20:00:33 GMT",
                    "Content-Length": "6358",
                    "Date": "Thu, 06 Nov 2014 20:00:34 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}