{
    "url": "http://localhost:9999/mrdoob/three.js/examples/webgl_geometry_text.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>document.location.hash</b> and written to <b>the 'href' property of a DOM element</b> via the following statements:<ul><li>var hash = document.location.hash.substr( 1 );</li><li>var colorhash  = hash.substring( 0, 6 );</li><li>hex = colorhash;</li><li>var link = hex + fontMap[ font ] + weightMap[ weight ] + boolToNum( postprocessing.enabled ) + boolToNum( bevelEnabled ) + \"#\" + encodeURI( text );</li><li>permalink.href = \"#\" + link;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/mrdoob/three.js/examples/webgl_geometry_text.html",
                "path": "/mrdoob/three.js/examples/webgl_geometry_text.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9tcmRvb2IvdGhyZWUuanMvZXhhbXBsZXMvd2ViZ2xfZ2VvbWV0cnlfdGV4dC5odG1sIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTUzMDgNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAxNTozODowMyBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMTU6Mzc6NTUgR01UDQoNCjwhRE9DVFlQRSBodG1sPgo8aHRtbCBsYW5nPSJlbiI+Cgk8aGVhZD4KCQk8dGl0bGU+dGhyZWUuanMgd2ViZ2wgLSBnZW9tZXRyeSAtIHRleHQ8L3RpdGxlPgoJCTxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KCQk8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCB1c2VyLXNjYWxhYmxlPW5vLCBtaW5pbXVtLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAiPgoJCTxzdHlsZT4KCQkJYm9keSB7CgkJCQlmb250LWZhbWlseTogTW9ub3NwYWNlOwoJCQkJYmFja2dyb3VuZC1jb2xvcjogIzAwMDsKCQkJCWNvbG9yOiAjZmZmOwoJCQkJbWFyZ2luOiAwcHg7CgkJCQlvdmVyZmxvdzogaGlkZGVuOwoJCQl9CgkJCSNpbmZvIHsKCQkJCXBvc2l0aW9uOiBhYnNvbHV0ZTsKCQkJCXRvcDogMTBweDsKCQkJCXdpZHRoOiAxMDAlOwoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQkJei1pbmRleDogMTAwOwoJCQkJZGlzcGxheTpibG9jazsKCQkJfQoJCQkjaW5mbyBhLCAuYnV0dG9uIHsgY29sb3I6ICNmMDA7IGZvbnQtd2VpZ2h0OiBib2xkOyB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTsgY3Vyc29yOiBwb2ludGVyIH0KCQk8L3N0eWxlPgoJPC9oZWFkPgoJPGJvZHk+CgoJCTxkaXYgaWQ9ImluZm8iPgoJCTxhIGhyZWY9Imh0dHA6Ly90aHJlZWpzLm9yZyIgdGFyZ2V0PSJfYmxhbmsiPnRocmVlLmpzPC9hPiAtIHByb2NlZHVyYWwgM0QgdGV4dCBieSA8YSBocmVmPSJodHRwOi8vd3d3LmxhYjRnYW1lcy5uZXQveno4NS9ibG9nIiB0YXJnZXQ9Il9ibGFuayI+eno4NTwvYT4gJmFtcDsgYWx0ZXJlZHEKCQkoZm9udHMgZnJvbSA8YSBocmVmPSJodHRwOi8vdHlwZWZhY2UubmVvY3JhY3kub3JnLyI+dHlwZWZhY2UuanM8L2E+IGFuZCA8YSBocmVmPSJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Ryb2lkXyUyOGZvbnQlMjkiPkRyb2lkPC9hPikKCQk8YnIvPnR5cGUgdG8gZW50ZXIgbmV3IHRleHQsIGRyYWcgdG8gc3BpbiB0aGUgdGV4dAoJCTxici8+PHNwYW4gY2xhc3M9ImJ1dHRvbiIgaWQ9ImNvbG9yIj5jaGFuZ2UgY29sb3I8L3NwYW4+LAoJCQk8c3BhbiBjbGFzcz0iYnV0dG9uIiBpZD0iZm9udCI+Y2hhbmdlIGZvbnQ8L3NwYW4+LAoJCQk8c3BhbiBjbGFzcz0iYnV0dG9uIiBpZD0id2VpZ2h0Ij5jaGFuZ2Ugd2VpZ2h0PC9zcGFuPiwKCQkJPHNwYW4gY2xhc3M9ImJ1dHRvbiIgaWQ9ImJldmVsIj5jaGFuZ2UgYmV2ZWw8L3NwYW4+LAoJCQk8c3BhbiBjbGFzcz0iYnV0dG9uIiBpZD0icG9zdHByb2Nlc3NpbmciPmNoYW5nZSBwb3N0cHJvY2Vzc2luZzwvc3Bhbj4sCgkJCTxhIGlkPSJwZXJtYWxpbmsiIGhyZWY9IiMiPnBlcm1hbGluazwvYT4KCQk8L2Rpdj4KCgoJCTxzY3JpcHQgc3JjPSIuLi9idWlsZC90aHJlZS5taW4uanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy91dGlscy9HZW9tZXRyeVV0aWxzLmpzIj48L3NjcmlwdD4KCgkJPHNjcmlwdCBzcmM9ImpzL3NoYWRlcnMvQ29udm9sdXRpb25TaGFkZXIuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy9zaGFkZXJzL0NvcHlTaGFkZXIuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy9zaGFkZXJzL0ZpbG1TaGFkZXIuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy9zaGFkZXJzL0ZYQUFTaGFkZXIuanMiPjwvc2NyaXB0PgoKCQk8c2NyaXB0IHNyYz0ianMvcG9zdHByb2Nlc3NpbmcvRWZmZWN0Q29tcG9zZXIuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy9wb3N0cHJvY2Vzc2luZy9SZW5kZXJQYXNzLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0ianMvcG9zdHByb2Nlc3NpbmcvU2hhZGVyUGFzcy5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL3Bvc3Rwcm9jZXNzaW5nL01hc2tQYXNzLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0ianMvcG9zdHByb2Nlc3NpbmcvQmxvb21QYXNzLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0ianMvcG9zdHByb2Nlc3NpbmcvRmlsbVBhc3MuanMiPjwvc2NyaXB0PgoKCQk8c2NyaXB0IHNyYz0ianMvRGV0ZWN0b3IuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy9saWJzL3N0YXRzLm1pbi5qcyI+PC9zY3JpcHQ+CgoJCTwhLS0gbG9hZCB0aGUgZm9udCBmaWxlcyAtLT4KCgkJPHNjcmlwdCBzcmM9ImZvbnRzL2dlbnRpbGlzX2JvbGQudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJmb250cy9nZW50aWxpc19yZWd1bGFyLnR5cGVmYWNlLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0iZm9udHMvb3B0aW1lcl9ib2xkLnR5cGVmYWNlLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0iZm9udHMvb3B0aW1lcl9yZWd1bGFyLnR5cGVmYWNlLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0iZm9udHMvaGVsdmV0aWtlcl9ib2xkLnR5cGVmYWNlLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0iZm9udHMvaGVsdmV0aWtlcl9yZWd1bGFyLnR5cGVmYWNlLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0iZm9udHMvZHJvaWQvZHJvaWRfc2Fuc19yZWd1bGFyLnR5cGVmYWNlLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0iZm9udHMvZHJvaWQvZHJvaWRfc2Fuc19ib2xkLnR5cGVmYWNlLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0iZm9udHMvZHJvaWQvZHJvaWRfc2VyaWZfcmVndWxhci50eXBlZmFjZS5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImZvbnRzL2Ryb2lkL2Ryb2lkX3NlcmlmX2JvbGQudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoKCQk8IS0tIHRvZG8gYXN5bmMgbG9hZGVyIGZvciBmb250cyAtLT4KCgkJPHNjcmlwdD4KCgkJCWlmICggISBEZXRlY3Rvci53ZWJnbCApIERldGVjdG9yLmFkZEdldFdlYkdMTWVzc2FnZSgpOwoKCQkJdmFyIGNvbnRhaW5lciwgc3RhdHMsIHBlcm1hbGluaywgaGV4LCBjb2xvcjsKCgkJCXZhciBjYW1lcmEsIGNhbWVyYVRhcmdldCwgc2NlbmUsIHJlbmRlcmVyOwoKCQkJdmFyIGNvbXBvc2VyOwoJCQl2YXIgZWZmZWN0RlhBQTsKCgkJCXZhciBncm91cCwgdGV4dE1lc2gxLCB0ZXh0TWVzaDIsIHRleHRHZW8sIG1hdGVyaWFsOwoKCQkJdmFyIGZpcnN0TGV0dGVyID0gdHJ1ZTsKCgkJCXZhciB0ZXh0ID0gInRocmVlLmpzIiwKCgkJCQloZWlnaHQgPSAyMCwKCQkJCXNpemUgPSA3MCwKCQkJCWhvdmVyID0gMzAsCgoJCQkJY3VydmVTZWdtZW50cyA9IDQsCgoJCQkJYmV2ZWxUaGlja25lc3MgPSAyLAoJCQkJYmV2ZWxTaXplID0gMS41LAoJCQkJYmV2ZWxTZWdtZW50cyA9IDMsCgkJCQliZXZlbEVuYWJsZWQgPSB0cnVlLAoKCQkJCWZvbnQgPSAib3B0aW1lciIsIC8vIGhlbHZldGlrZXIsIG9wdGltZXIsIGdlbnRpbGlzLCBkcm9pZCBzYW5zLCBkcm9pZCBzZXJpZgoJCQkJd2VpZ2h0ID0gImJvbGQiLCAvLyBub3JtYWwgYm9sZAoJCQkJc3R5bGUgPSAibm9ybWFsIjsgLy8gbm9ybWFsIGl0YWxpYwoKCQkJdmFyIG1pcnJvciA9IHRydWU7CgoJCQl2YXIgZm9udE1hcCA9IHsKCgkJCQkiaGVsdmV0aWtlciI6IDAsCgkJCQkib3B0aW1lciI6IDEsCgkJCQkiZ2VudGlsaXMiOiAyLAoJCQkJImRyb2lkIHNhbnMiOiAzLAoJCQkJImRyb2lkIHNlcmlmIjogNAoKCQkJfTsKCgkJCXZhciB3ZWlnaHRNYXAgPSB7CgoJCQkJIm5vcm1hbCI6IDAsCgkJCQkiYm9sZCI6IDEKCgkJCX07CgoJCQl2YXIgcmV2ZXJzZUZvbnRNYXAgPSB7fTsKCQkJdmFyIHJldmVyc2VXZWlnaHRNYXAgPSB7fTsKCgkJCWZvciAoIHZhciBpIGluIGZvbnRNYXAgKSByZXZlcnNlRm9udE1hcFsgZm9udE1hcFtpXSBdID0gaTsKCQkJZm9yICggdmFyIGkgaW4gd2VpZ2h0TWFwICkgcmV2ZXJzZVdlaWdodE1hcFsgd2VpZ2h0TWFwW2ldIF0gPSBpOwoKCQkJdmFyIHRhcmdldFJvdGF0aW9uID0gMDsKCQkJdmFyIHRhcmdldFJvdGF0aW9uT25Nb3VzZURvd24gPSAwOwoKCQkJdmFyIG1vdXNlWCA9IDA7CgkJCXZhciBtb3VzZVhPbk1vdXNlRG93biA9IDA7CgoJCQl2YXIgd2luZG93SGFsZlggPSB3aW5kb3cuaW5uZXJXaWR0aCAvIDI7CgkJCXZhciB3aW5kb3dIYWxmWSA9IHdpbmRvdy5pbm5lckhlaWdodCAvIDI7CgoJCQl2YXIgcG9zdHByb2Nlc3NpbmcgPSB7IGVuYWJsZWQgOiBmYWxzZSB9OwoJCQl2YXIgZ2xvdyA9IDAuOTsKCgkJCWluaXQoKTsKCQkJYW5pbWF0ZSgpOwoKCQkJZnVuY3Rpb24gY2FwaXRhbGl6ZSggdHh0ICkgewoKCQkJCXJldHVybiB0eHQuc3Vic3RyaW5nKCAwLCAxICkudG9VcHBlckNhc2UoKSArIHR4dC5zdWJzdHJpbmcoIDEgKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIGRlY2ltYWxUb0hleCggZCApIHsKCgkJCQl2YXIgaGV4ID0gTnVtYmVyKCBkICkudG9TdHJpbmcoIDE2ICk7CgkJCQloZXggPSAiMDAwMDAwIi5zdWJzdHIoIDAsIDYgLSBoZXgubGVuZ3RoICkgKyBoZXg7CgkJCQlyZXR1cm4gaGV4LnRvVXBwZXJDYXNlKCk7CgoJCQl9CgoJCQlmdW5jdGlvbiBpbml0KCkgewoKCQkJCWNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7CgkJCQlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCBjb250YWluZXIgKTsKCgkJCQlwZXJtYWxpbmsgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggInBlcm1hbGluayIgKTsKCgkJCQkvLyBDQU1FUkEKCgkJCQljYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoIDMwLCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMSwgMTUwMCApOwoJCQkJY2FtZXJhLnBvc2l0aW9uLnNldCggMCwgNDAwLCA3MDAgKTsKCgkJCQljYW1lcmFUYXJnZXQgPSBuZXcgVEhSRUUuVmVjdG9yMyggMCwgMTUwLCAwICk7CgoJCQkJLy8gU0NFTkUKCgkJCQlzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOwoJCQkJc2NlbmUuZm9nID0gbmV3IFRIUkVFLkZvZyggMHgwMDAwMDAsIDI1MCwgMTQwMCApOwoKCQkJCS8vIExJR0hUUwoKCQkJCXZhciBkaXJMaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KCAweGZmZmZmZiwgMC4xMjUgKTsKCQkJCWRpckxpZ2h0LnBvc2l0aW9uLnNldCggMCwgMCwgMSApLm5vcm1hbGl6ZSgpOwoJCQkJc2NlbmUuYWRkKCBkaXJMaWdodCApOwoKCQkJCXZhciBwb2ludExpZ2h0ID0gbmV3IFRIUkVFLlBvaW50TGlnaHQoIDB4ZmZmZmZmLCAxLjUgKTsKCQkJCXBvaW50TGlnaHQucG9zaXRpb24uc2V0KCAwLCAxMDAsIDkwICk7CgkJCQlzY2VuZS5hZGQoIHBvaW50TGlnaHQgKTsKCgkJCQkvL3RleHQgPSBjYXBpdGFsaXplKCBmb250ICkgKyAiICIgKyBjYXBpdGFsaXplKCB3ZWlnaHQgKTsKCQkJCS8vdGV4dCA9ICJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkiOwoJCQkJLy90ZXh0ID0gIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaMDEyMzQ1Njc4OSI7CgoJCQkJLy8gR2V0IHRleHQgZnJvbSBoYXNoCgoJCQkJdmFyIGhhc2ggPSBkb2N1bWVudC5sb2NhdGlvbi5oYXNoLnN1YnN0ciggMSApOwoKCQkJCWlmICggaGFzaC5sZW5ndGggIT09IDAgKSB7CgoJCQkJCXZhciBjb2xvcmhhc2ggID0gaGFzaC5zdWJzdHJpbmcoIDAsIDYgKTsKCQkJCQl2YXIgZm9udGhhc2ggICA9IGhhc2guc3Vic3RyaW5nKCA2LCA3ICk7CgkJCQkJdmFyIHdlaWdodGhhc2ggPSBoYXNoLnN1YnN0cmluZyggNywgOCApOwoJCQkJCXZhciBwcGhhc2ggCSAgID0gaGFzaC5zdWJzdHJpbmcoIDgsIDkgKTsKCQkJCQl2YXIgYmV2ZWxoYXNoICA9IGhhc2guc3Vic3RyaW5nKCA5LCAxMCApOwoJCQkJCXZhciB0ZXh0aGFzaCAgID0gaGFzaC5zdWJzdHJpbmcoIDEwICk7CgoJCQkJCWhleCA9IGNvbG9yaGFzaDsKCQkJCQlwb2ludExpZ2h0LmNvbG9yLnNldEhleCggcGFyc2VJbnQoIGNvbG9yaGFzaCwgMTYgKSApOwoKCQkJCQlmb250ID0gcmV2ZXJzZUZvbnRNYXBbIHBhcnNlSW50KCBmb250aGFzaCApIF07CgkJCQkJd2VpZ2h0ID0gcmV2ZXJzZVdlaWdodE1hcFsgcGFyc2VJbnQoIHdlaWdodGhhc2ggKSBdOwoKCQkJCQlwb3N0cHJvY2Vzc2luZy5lbmFibGVkID0gcGFyc2VJbnQoIHBwaGFzaCApOwoJCQkJCWJldmVsRW5hYmxlZCA9IHBhcnNlSW50KCBiZXZlbGhhc2ggKTsKCgkJCQkJdGV4dCA9IGRlY29kZVVSSSggdGV4dGhhc2ggKTsKCgkJCQkJdXBkYXRlUGVybWFsaW5rKCk7CgoJCQkJfSBlbHNlIHsKCgkJCQkJcG9pbnRMaWdodC5jb2xvci5zZXRIU0woIE1hdGgucmFuZG9tKCksIDEsIDAuNSApOwoJCQkJCWhleCA9IGRlY2ltYWxUb0hleCggcG9pbnRMaWdodC5jb2xvci5nZXRIZXgoKSApOwoKCQkJCX0KCgkJCQltYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoRmFjZU1hdGVyaWFsKCBbIAoJCQkJCW5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCggeyBjb2xvcjogMHhmZmZmZmYsIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nIH0gKSwgLy8gZnJvbnQKCQkJCQluZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoIHsgY29sb3I6IDB4ZmZmZmZmLCBzaGFkaW5nOiBUSFJFRS5TbW9vdGhTaGFkaW5nIH0gKSAvLyBzaWRlCgkJCQldICk7CgoJCQkJZ3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsKCQkJCWdyb3VwLnBvc2l0aW9uLnkgPSAxMDA7CgoJCQkJc2NlbmUuYWRkKCBncm91cCApOwoKCQkJCWNyZWF0ZVRleHQoKTsKCgkJCQl2YXIgcGxhbmUgPSBuZXcgVEhSRUUuTWVzaCgKCQkJCQluZXcgVEhSRUUuUGxhbmVCdWZmZXJHZW9tZXRyeSggMTAwMDAsIDEwMDAwICksCgkJCQkJbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7IGNvbG9yOiAweGZmZmZmZiwgb3BhY2l0eTogMC41LCB0cmFuc3BhcmVudDogdHJ1ZSB9ICkKCQkJCSk7CgkJCQlwbGFuZS5wb3NpdGlvbi55ID0gMTAwOwoJCQkJcGxhbmUucm90YXRpb24ueCA9IC0gTWF0aC5QSSAvIDI7CgkJCQlzY2VuZS5hZGQoIHBsYW5lICk7CgoJCQkJLy8gUkVOREVSRVIKCgkJCQlyZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKCB7IGFudGlhbGlhczogdHJ1ZSB9ICk7CgkJCQlyZW5kZXJlci5zZXRTaXplKCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0ICk7CgoJCQkJcmVuZGVyZXIuc2V0Q2xlYXJDb2xvciggc2NlbmUuZm9nLmNvbG9yLCAxICk7CgoJCQkJY29udGFpbmVyLmFwcGVuZENoaWxkKCByZW5kZXJlci5kb21FbGVtZW50ICk7CgoJCQkJLy8gU1RBVFMKCgkJCQlzdGF0cyA9IG5ldyBTdGF0cygpOwoJCQkJc3RhdHMuZG9tRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7CgkJCQlzdGF0cy5kb21FbGVtZW50LnN0eWxlLnRvcCA9ICcwcHgnOwoJCQkJLy9jb250YWluZXIuYXBwZW5kQ2hpbGQoIHN0YXRzLmRvbUVsZW1lbnQgKTsKCgkJCQkvLyBFVkVOVFMKCgkJCQlkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vkb3duJywgb25Eb2N1bWVudE1vdXNlRG93biwgZmFsc2UgKTsKCQkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaHN0YXJ0Jywgb25Eb2N1bWVudFRvdWNoU3RhcnQsIGZhbHNlICk7CgkJCQlkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAndG91Y2htb3ZlJywgb25Eb2N1bWVudFRvdWNoTW92ZSwgZmFsc2UgKTsKCQkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdrZXlwcmVzcycsIG9uRG9jdW1lbnRLZXlQcmVzcywgZmFsc2UgKTsKCQkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdrZXlkb3duJywgb25Eb2N1bWVudEtleURvd24sIGZhbHNlICk7CgoJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICJjb2xvciIgKS5hZGRFdmVudExpc3RlbmVyKCAnY2xpY2snLCBmdW5jdGlvbigpIHsKCgkJCQkJcG9pbnRMaWdodC5jb2xvci5zZXRIU0woIE1hdGgucmFuZG9tKCksIDEsIDAuNSApOwoJCQkJCWhleCA9IGRlY2ltYWxUb0hleCggcG9pbnRMaWdodC5jb2xvci5nZXRIZXgoKSApOwoKCQkJCQl1cGRhdGVQZXJtYWxpbmsoKTsKCgkJCQl9LCBmYWxzZSApOwoKCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAiZm9udCIgKS5hZGRFdmVudExpc3RlbmVyKCAnY2xpY2snLCBmdW5jdGlvbigpIHsKCgkJCQkJaWYgKCBmb250ID09ICJoZWx2ZXRpa2VyIiApIHsKCgkJCQkJCWZvbnQgPSAib3B0aW1lciI7CgoJCQkJCX0gZWxzZSBpZiAoIGZvbnQgPT0gIm9wdGltZXIiICkgewoKCQkJCQkJZm9udCA9ICJnZW50aWxpcyI7CgoJCQkJCX0gZWxzZSBpZiAoIGZvbnQgPT0gImdlbnRpbGlzIiApIHsKCgkJCQkJCWZvbnQgPSAiZHJvaWQgc2FucyI7CgoJCQkJCX0gZWxzZSBpZiAoIGZvbnQgPT0gImRyb2lkIHNhbnMiICkgewoKCQkJCQkJZm9udCA9ICJkcm9pZCBzZXJpZiI7CgoJCQkJCX0gZWxzZSB7CgoJCQkJCQlmb250ID0gImhlbHZldGlrZXIiOwoKCQkJCQl9CgoJCQkJCXJlZnJlc2hUZXh0KCk7CgoJCQkJfSwgZmFsc2UgKTsKCgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggIndlaWdodCIgKS5hZGRFdmVudExpc3RlbmVyKCAnY2xpY2snLCBmdW5jdGlvbigpIHsKCgkJCQkJaWYgKCB3ZWlnaHQgPT0gImJvbGQiICkgewoKCQkJCQkJd2VpZ2h0ID0gIm5vcm1hbCI7CgoJCQkJCX0gZWxzZSB7CgoJCQkJCQl3ZWlnaHQgPSAiYm9sZCI7CgoJCQkJCX0KCgkJCQkJcmVmcmVzaFRleHQoKTsKCgkJCQl9LCBmYWxzZSApOwoKCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAiYmV2ZWwiICkuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgZnVuY3Rpb24oKSB7CgoJCQkJCWJldmVsRW5hYmxlZCA9ICFiZXZlbEVuYWJsZWQ7CgoJCQkJCXJlZnJlc2hUZXh0KCk7CgoJCQkJfSwgZmFsc2UgKTsKCgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggInBvc3Rwcm9jZXNzaW5nIiApLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uKCkgewoKCQkJCQlwb3N0cHJvY2Vzc2luZy5lbmFibGVkID0gIXBvc3Rwcm9jZXNzaW5nLmVuYWJsZWQ7CgkJCQkJdXBkYXRlUGVybWFsaW5rKCk7CgoJCQkJfSwgZmFsc2UgKTsKCgoJCQkJLy8gUE9TVFBST0NFU1NJTkcKCgkJCQlyZW5kZXJlci5hdXRvQ2xlYXIgPSBmYWxzZTsKCgkJCQl2YXIgcmVuZGVyTW9kZWwgPSBuZXcgVEhSRUUuUmVuZGVyUGFzcyggc2NlbmUsIGNhbWVyYSApOwoJCQkJdmFyIGVmZmVjdEJsb29tID0gbmV3IFRIUkVFLkJsb29tUGFzcyggMC4yNSApOwoJCQkJdmFyIGVmZmVjdEZpbG0gPSBuZXcgVEhSRUUuRmlsbVBhc3MoIDAuNSwgMC4xMjUsIDIwNDgsIGZhbHNlICk7CgoJCQkJZWZmZWN0RlhBQSA9IG5ldyBUSFJFRS5TaGFkZXJQYXNzKCBUSFJFRS5GWEFBU2hhZGVyICk7CgoJCQkJdmFyIHdpZHRoID0gd2luZG93LmlubmVyV2lkdGggfHwgMjsKCQkJCXZhciBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgMjsKCgkJCQllZmZlY3RGWEFBLnVuaWZvcm1zWyAncmVzb2x1dGlvbicgXS52YWx1ZS5zZXQoIDEgLyB3aWR0aCwgMSAvIGhlaWdodCApOwoKCQkJCWVmZmVjdEZpbG0ucmVuZGVyVG9TY3JlZW4gPSB0cnVlOwoKCQkJCWNvbXBvc2VyID0gbmV3IFRIUkVFLkVmZmVjdENvbXBvc2VyKCByZW5kZXJlciApOwoKCQkJCWNvbXBvc2VyLmFkZFBhc3MoIHJlbmRlck1vZGVsICk7CgkJCQljb21wb3Nlci5hZGRQYXNzKCBlZmZlY3RGWEFBICk7CgkJCQljb21wb3Nlci5hZGRQYXNzKCBlZmZlY3RCbG9vbSApOwoJCQkJY29tcG9zZXIuYWRkUGFzcyggZWZmZWN0RmlsbSApOwoKCQkJCS8vCgoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdyZXNpemUnLCBvbldpbmRvd1Jlc2l6ZSwgZmFsc2UgKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIG9uV2luZG93UmVzaXplKCkgewoKCQkJCXdpbmRvd0hhbGZYID0gd2luZG93LmlubmVyV2lkdGggLyAyOwoJCQkJd2luZG93SGFsZlkgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyOwoKCQkJCWNhbWVyYS5hc3BlY3QgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodDsKCQkJCWNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7CgoJCQkJcmVuZGVyZXIuc2V0U2l6ZSggd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCApOwoKCQkJCWNvbXBvc2VyLnJlc2V0KCk7CgoJCQkJZWZmZWN0RlhBQS51bmlmb3Jtc1sgJ3Jlc29sdXRpb24nIF0udmFsdWUuc2V0KCAxIC8gd2luZG93LmlubmVyV2lkdGgsIDEgLyB3aW5kb3cuaW5uZXJIZWlnaHQgKTsKCgkJCX0KCgkJCS8vCgoJCQlmdW5jdGlvbiBib29sVG9OdW0oIGIgKSB7CgoJCQkJcmV0dXJuIGIgPyAxIDogMDsKCgkJCX0KCgkJCWZ1bmN0aW9uIHVwZGF0ZVBlcm1hbGluaygpIHsKCgkJCQl2YXIgbGluayA9IGhleCArIGZvbnRNYXBbIGZvbnQgXSArIHdlaWdodE1hcFsgd2VpZ2h0IF0gKyBib29sVG9OdW0oIHBvc3Rwcm9jZXNzaW5nLmVuYWJsZWQgKSArIGJvb2xUb051bSggYmV2ZWxFbmFibGVkICkgKyAiIyIgKyBlbmNvZGVVUkkoIHRleHQgKTsKCgkJCQlwZXJtYWxpbmsuaHJlZiA9ICIjIiArIGxpbms7CgkJCQl3aW5kb3cubG9jYXRpb24uaGFzaCA9IGxpbms7CgoJCQl9CgoJCQlmdW5jdGlvbiBvbkRvY3VtZW50S2V5RG93biggZXZlbnQgKSB7CgoJCQkJaWYgKCBmaXJzdExldHRlciApIHsKCgkJCQkJZmlyc3RMZXR0ZXIgPSBmYWxzZTsKCQkJCQl0ZXh0ID0gIiI7CgoJCQkJfQoKCQkJCXZhciBrZXlDb2RlID0gZXZlbnQua2V5Q29kZTsKCgkJCQkvLyBiYWNrc3BhY2UKCgkJCQlpZiAoIGtleUNvZGUgPT0gOCApIHsKCgkJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCgkJCQkJdGV4dCA9IHRleHQuc3Vic3RyaW5nKCAwLCB0ZXh0Lmxlbmd0aCAtIDEgKTsKCQkJCQlyZWZyZXNoVGV4dCgpOwoKCQkJCQlyZXR1cm4gZmFsc2U7CgoJCQkJfQoKCQkJfQoKCQkJZnVuY3Rpb24gb25Eb2N1bWVudEtleVByZXNzKCBldmVudCApIHsKCgkJCQl2YXIga2V5Q29kZSA9IGV2ZW50LndoaWNoOwoKCQkJCS8vIGJhY2tzcGFjZQoKCQkJCWlmICgga2V5Q29kZSA9PSA4ICkgewoKCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCX0gZWxzZSB7CgoJCQkJCXZhciBjaCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoIGtleUNvZGUgKTsKCQkJCQl0ZXh0ICs9IGNoOwoKCQkJCQlyZWZyZXNoVGV4dCgpOwoKCQkJCX0KCgkJCX0KCgkJCWZ1bmN0aW9uIGNyZWF0ZVRleHQoKSB7CgoJCQkJdGV4dEdlbyA9IG5ldyBUSFJFRS5UZXh0R2VvbWV0cnkoIHRleHQsIHsKCgkJCQkJc2l6ZTogc2l6ZSwKCQkJCQloZWlnaHQ6IGhlaWdodCwKCQkJCQljdXJ2ZVNlZ21lbnRzOiBjdXJ2ZVNlZ21lbnRzLAoKCQkJCQlmb250OiBmb250LAoJCQkJCXdlaWdodDogd2VpZ2h0LAoJCQkJCXN0eWxlOiBzdHlsZSwKCgkJCQkJYmV2ZWxUaGlja25lc3M6IGJldmVsVGhpY2tuZXNzLAoJCQkJCWJldmVsU2l6ZTogYmV2ZWxTaXplLAoJCQkJCWJldmVsRW5hYmxlZDogYmV2ZWxFbmFibGVkLAoKCQkJCQltYXRlcmlhbDogMCwKCQkJCQlleHRydWRlTWF0ZXJpYWw6IDEKCgkJCQl9KTsKCgkJCQl0ZXh0R2VvLmNvbXB1dGVCb3VuZGluZ0JveCgpOwoJCQkJdGV4dEdlby5jb21wdXRlVmVydGV4Tm9ybWFscygpOwoKCQkJCS8vICJmaXgiIHNpZGUgbm9ybWFscyBieSByZW1vdmluZyB6LWNvbXBvbmVudCBvZiBub3JtYWxzIGZvciBzaWRlIGZhY2VzCgkJCQkvLyAodGhpcyBkb2Vzbid0IHdvcmsgd2VsbCBmb3IgYmV2ZWxlZCBnZW9tZXRyeSBhcyB0aGVuIHdlIGxvc2UgbmljZSBjdXJ2YXR1cmUgYXJvdW5kIHotYXhpcykKCgkJCQlpZiAoICEgYmV2ZWxFbmFibGVkICkgewoKCQkJCQl2YXIgdHJpYW5nbGVBcmVhSGV1cmlzdGljcyA9IDAuMSAqICggaGVpZ2h0ICogc2l6ZSApOwoKCQkJCQlmb3IgKCB2YXIgaSA9IDA7IGkgPCB0ZXh0R2VvLmZhY2VzLmxlbmd0aDsgaSArKyApIHsKCgkJCQkJCXZhciBmYWNlID0gdGV4dEdlby5mYWNlc1sgaSBdOwoKCQkJCQkJaWYgKCBmYWNlLm1hdGVyaWFsSW5kZXggPT0gMSApIHsKCgkJCQkJCQlmb3IgKCB2YXIgaiA9IDA7IGogPCBmYWNlLnZlcnRleE5vcm1hbHMubGVuZ3RoOyBqICsrICkgewoKCQkJCQkJCQlmYWNlLnZlcnRleE5vcm1hbHNbIGogXS56ID0gMDsKCQkJCQkJCQlmYWNlLnZlcnRleE5vcm1hbHNbIGogXS5ub3JtYWxpemUoKTsKCgkJCQkJCQl9CgoJCQkJCQkJdmFyIHZhID0gdGV4dEdlby52ZXJ0aWNlc1sgZmFjZS5hIF07CgkJCQkJCQl2YXIgdmIgPSB0ZXh0R2VvLnZlcnRpY2VzWyBmYWNlLmIgXTsKCQkJCQkJCXZhciB2YyA9IHRleHRHZW8udmVydGljZXNbIGZhY2UuYyBdOwoKCQkJCQkJCXZhciBzID0gVEhSRUUuR2VvbWV0cnlVdGlscy50cmlhbmdsZUFyZWEoIHZhLCB2YiwgdmMgKTsKCgkJCQkJCQlpZiAoIHMgPiB0cmlhbmdsZUFyZWFIZXVyaXN0aWNzICkgewoKCQkJCQkJCQlmb3IgKCB2YXIgaiA9IDA7IGogPCBmYWNlLnZlcnRleE5vcm1hbHMubGVuZ3RoOyBqICsrICkgewoKCQkJCQkJCQkJZmFjZS52ZXJ0ZXhOb3JtYWxzWyBqIF0uY29weSggZmFjZS5ub3JtYWwgKTsKCgkJCQkJCQkJfQoKCQkJCQkJCX0KCgkJCQkJCX0KCgkJCQkJfQoKCQkJCX0KCgkJCQl2YXIgY2VudGVyT2Zmc2V0ID0gLTAuNSAqICggdGV4dEdlby5ib3VuZGluZ0JveC5tYXgueCAtIHRleHRHZW8uYm91bmRpbmdCb3gubWluLnggKTsKCgkJCQl0ZXh0TWVzaDEgPSBuZXcgVEhSRUUuTWVzaCggdGV4dEdlbywgbWF0ZXJpYWwgKTsKCgkJCQl0ZXh0TWVzaDEucG9zaXRpb24ueCA9IGNlbnRlck9mZnNldDsKCQkJCXRleHRNZXNoMS5wb3NpdGlvbi55ID0gaG92ZXI7CgkJCQl0ZXh0TWVzaDEucG9zaXRpb24ueiA9IDA7CgoJCQkJdGV4dE1lc2gxLnJvdGF0aW9uLnggPSAwOwoJCQkJdGV4dE1lc2gxLnJvdGF0aW9uLnkgPSBNYXRoLlBJICogMjsKCgkJCQlncm91cC5hZGQoIHRleHRNZXNoMSApOwoKCQkJCWlmICggbWlycm9yICkgewoKCQkJCQl0ZXh0TWVzaDIgPSBuZXcgVEhSRUUuTWVzaCggdGV4dEdlbywgbWF0ZXJpYWwgKTsKCgkJCQkJdGV4dE1lc2gyLnBvc2l0aW9uLnggPSBjZW50ZXJPZmZzZXQ7CgkJCQkJdGV4dE1lc2gyLnBvc2l0aW9uLnkgPSAtaG92ZXI7CgkJCQkJdGV4dE1lc2gyLnBvc2l0aW9uLnogPSBoZWlnaHQ7CgoJCQkJCXRleHRNZXNoMi5yb3RhdGlvbi54ID0gTWF0aC5QSTsKCQkJCQl0ZXh0TWVzaDIucm90YXRpb24ueSA9IE1hdGguUEkgKiAyOwoKCQkJCQlncm91cC5hZGQoIHRleHRNZXNoMiApOwoKCQkJCX0KCgkJCX0KCgkJCWZ1bmN0aW9uIHJlZnJlc2hUZXh0KCkgewoKCQkJCXVwZGF0ZVBlcm1hbGluaygpOwoKCQkJCWdyb3VwLnJlbW92ZSggdGV4dE1lc2gxICk7CgkJCQlpZiAoIG1pcnJvciApIGdyb3VwLnJlbW92ZSggdGV4dE1lc2gyICk7CgoJCQkJaWYgKCAhdGV4dCApIHJldHVybjsKCgkJCQljcmVhdGVUZXh0KCk7CgoJCQl9CgoJCQlmdW5jdGlvbiBvbkRvY3VtZW50TW91c2VEb3duKCBldmVudCApIHsKCgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBvbkRvY3VtZW50TW91c2VNb3ZlLCBmYWxzZSApOwoJCQkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBvbkRvY3VtZW50TW91c2VVcCwgZmFsc2UgKTsKCQkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZW91dCcsIG9uRG9jdW1lbnRNb3VzZU91dCwgZmFsc2UgKTsKCgkJCQltb3VzZVhPbk1vdXNlRG93biA9IGV2ZW50LmNsaWVudFggLSB3aW5kb3dIYWxmWDsKCQkJCXRhcmdldFJvdGF0aW9uT25Nb3VzZURvd24gPSB0YXJnZXRSb3RhdGlvbjsKCgkJCX0KCgkJCWZ1bmN0aW9uIG9uRG9jdW1lbnRNb3VzZU1vdmUoIGV2ZW50ICkgewoKCQkJCW1vdXNlWCA9IGV2ZW50LmNsaWVudFggLSB3aW5kb3dIYWxmWDsKCgkJCQl0YXJnZXRSb3RhdGlvbiA9IHRhcmdldFJvdGF0aW9uT25Nb3VzZURvd24gKyAoIG1vdXNlWCAtIG1vdXNlWE9uTW91c2VEb3duICkgKiAwLjAyOwoKCQkJfQoKCQkJZnVuY3Rpb24gb25Eb2N1bWVudE1vdXNlVXAoIGV2ZW50ICkgewoKCQkJCWRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBvbkRvY3VtZW50TW91c2VNb3ZlLCBmYWxzZSApOwoJCQkJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBvbkRvY3VtZW50TW91c2VVcCwgZmFsc2UgKTsKCQkJCWRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZW91dCcsIG9uRG9jdW1lbnRNb3VzZU91dCwgZmFsc2UgKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIG9uRG9jdW1lbnRNb3VzZU91dCggZXZlbnQgKSB7CgoJCQkJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIG9uRG9jdW1lbnRNb3VzZU1vdmUsIGZhbHNlICk7CgkJCQlkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uRG9jdW1lbnRNb3VzZVVwLCBmYWxzZSApOwoJCQkJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlb3V0Jywgb25Eb2N1bWVudE1vdXNlT3V0LCBmYWxzZSApOwoKCQkJfQoKCQkJZnVuY3Rpb24gb25Eb2N1bWVudFRvdWNoU3RhcnQoIGV2ZW50ICkgewoKCQkJCWlmICggZXZlbnQudG91Y2hlcy5sZW5ndGggPT0gMSApIHsKCgkJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCgkJCQkJbW91c2VYT25Nb3VzZURvd24gPSBldmVudC50b3VjaGVzWyAwIF0ucGFnZVggLSB3aW5kb3dIYWxmWDsKCQkJCQl0YXJnZXRSb3RhdGlvbk9uTW91c2VEb3duID0gdGFyZ2V0Um90YXRpb247CgoJCQkJfQoKCQkJfQoKCQkJZnVuY3Rpb24gb25Eb2N1bWVudFRvdWNoTW92ZSggZXZlbnQgKSB7CgoJCQkJaWYgKCBldmVudC50b3VjaGVzLmxlbmd0aCA9PSAxICkgewoKCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCQltb3VzZVggPSBldmVudC50b3VjaGVzWyAwIF0ucGFnZVggLSB3aW5kb3dIYWxmWDsKCQkJCQl0YXJnZXRSb3RhdGlvbiA9IHRhcmdldFJvdGF0aW9uT25Nb3VzZURvd24gKyAoIG1vdXNlWCAtIG1vdXNlWE9uTW91c2VEb3duICkgKiAwLjA1OwoKCQkJCX0KCgkJCX0KCgkJCS8vCgoJCQlmdW5jdGlvbiBhbmltYXRlKCkgewoKCQkJCXJlcXVlc3RBbmltYXRpb25GcmFtZSggYW5pbWF0ZSApOwoKCQkJCXJlbmRlcigpOwoJCQkJc3RhdHMudXBkYXRlKCk7CgoJCQl9CgoJCQlmdW5jdGlvbiByZW5kZXIoKSB7CgoJCQkJZ3JvdXAucm90YXRpb24ueSArPSAoIHRhcmdldFJvdGF0aW9uIC0gZ3JvdXAucm90YXRpb24ueSApICogMC4wNTsKCgkJCQljYW1lcmEubG9va0F0KCBjYW1lcmFUYXJnZXQgKTsKCgkJCQlyZW5kZXJlci5jbGVhcigpOwoKCQkJCWlmICggcG9zdHByb2Nlc3NpbmcuZW5hYmxlZCApIHsKCgkJCQkJY29tcG9zZXIucmVuZGVyKCAwLjA1ICk7CgoJCQkJfSBlbHNlIHsKCgkJCQkJcmVuZGVyZXIucmVuZGVyKCBzY2VuZSwgY2FtZXJhICk7CgoJCQkJfQoKCQkJfQoKCQk8L3NjcmlwdD4KCgk8L2JvZHk+CjwvaHRtbD4K",
                "body": "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KCTxoZWFkPgoJCTx0aXRsZT50aHJlZS5qcyB3ZWJnbCAtIGdlb21ldHJ5IC0gdGV4dDwvdGl0bGU+CgkJPG1ldGEgY2hhcnNldD0idXRmLTgiPgoJCTxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIHVzZXItc2NhbGFibGU9bm8sIG1pbmltdW0tc2NhbGU9MS4wLCBtYXhpbXVtLXNjYWxlPTEuMCI+CgkJPHN0eWxlPgoJCQlib2R5IHsKCQkJCWZvbnQtZmFtaWx5OiBNb25vc3BhY2U7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiAjMDAwOwoJCQkJY29sb3I6ICNmZmY7CgkJCQltYXJnaW46IDBweDsKCQkJCW92ZXJmbG93OiBoaWRkZW47CgkJCX0KCQkJI2luZm8gewoJCQkJcG9zaXRpb246IGFic29sdXRlOwoJCQkJdG9wOiAxMHB4OwoJCQkJd2lkdGg6IDEwMCU7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCQl6LWluZGV4OiAxMDA7CgkJCQlkaXNwbGF5OmJsb2NrOwoJCQl9CgkJCSNpbmZvIGEsIC5idXR0b24geyBjb2xvcjogI2YwMDsgZm9udC13ZWlnaHQ6IGJvbGQ7IHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lOyBjdXJzb3I6IHBvaW50ZXIgfQoJCTwvc3R5bGU+Cgk8L2hlYWQ+Cgk8Ym9keT4KCgkJPGRpdiBpZD0iaW5mbyI+CgkJPGEgaHJlZj0iaHR0cDovL3RocmVlanMub3JnIiB0YXJnZXQ9Il9ibGFuayI+dGhyZWUuanM8L2E+IC0gcHJvY2VkdXJhbCAzRCB0ZXh0IGJ5IDxhIGhyZWY9Imh0dHA6Ly93d3cubGFiNGdhbWVzLm5ldC96ejg1L2Jsb2ciIHRhcmdldD0iX2JsYW5rIj56ejg1PC9hPiAmYW1wOyBhbHRlcmVkcQoJCShmb250cyBmcm9tIDxhIGhyZWY9Imh0dHA6Ly90eXBlZmFjZS5uZW9jcmFjeS5vcmcvIj50eXBlZmFjZS5qczwvYT4gYW5kIDxhIGhyZWY9Imh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRHJvaWRfJTI4Zm9udCUyOSI+RHJvaWQ8L2E+KQoJCTxici8+dHlwZSB0byBlbnRlciBuZXcgdGV4dCwgZHJhZyB0byBzcGluIHRoZSB0ZXh0CgkJPGJyLz48c3BhbiBjbGFzcz0iYnV0dG9uIiBpZD0iY29sb3IiPmNoYW5nZSBjb2xvcjwvc3Bhbj4sCgkJCTxzcGFuIGNsYXNzPSJidXR0b24iIGlkPSJmb250Ij5jaGFuZ2UgZm9udDwvc3Bhbj4sCgkJCTxzcGFuIGNsYXNzPSJidXR0b24iIGlkPSJ3ZWlnaHQiPmNoYW5nZSB3ZWlnaHQ8L3NwYW4+LAoJCQk8c3BhbiBjbGFzcz0iYnV0dG9uIiBpZD0iYmV2ZWwiPmNoYW5nZSBiZXZlbDwvc3Bhbj4sCgkJCTxzcGFuIGNsYXNzPSJidXR0b24iIGlkPSJwb3N0cHJvY2Vzc2luZyI+Y2hhbmdlIHBvc3Rwcm9jZXNzaW5nPC9zcGFuPiwKCQkJPGEgaWQ9InBlcm1hbGluayIgaHJlZj0iIyI+cGVybWFsaW5rPC9hPgoJCTwvZGl2PgoKCgkJPHNjcmlwdCBzcmM9Ii4uL2J1aWxkL3RocmVlLm1pbi5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL3V0aWxzL0dlb21ldHJ5VXRpbHMuanMiPjwvc2NyaXB0PgoKCQk8c2NyaXB0IHNyYz0ianMvc2hhZGVycy9Db252b2x1dGlvblNoYWRlci5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL3NoYWRlcnMvQ29weVNoYWRlci5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL3NoYWRlcnMvRmlsbVNoYWRlci5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL3NoYWRlcnMvRlhBQVNoYWRlci5qcyI+PC9zY3JpcHQ+CgoJCTxzY3JpcHQgc3JjPSJqcy9wb3N0cHJvY2Vzc2luZy9FZmZlY3RDb21wb3Nlci5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL3Bvc3Rwcm9jZXNzaW5nL1JlbmRlclBhc3MuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy9wb3N0cHJvY2Vzc2luZy9TaGFkZXJQYXNzLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0ianMvcG9zdHByb2Nlc3NpbmcvTWFza1Bhc3MuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy9wb3N0cHJvY2Vzc2luZy9CbG9vbVBhc3MuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJqcy9wb3N0cHJvY2Vzc2luZy9GaWxtUGFzcy5qcyI+PC9zY3JpcHQ+CgoJCTxzY3JpcHQgc3JjPSJqcy9EZXRlY3Rvci5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL2xpYnMvc3RhdHMubWluLmpzIj48L3NjcmlwdD4KCgkJPCEtLSBsb2FkIHRoZSBmb250IGZpbGVzIC0tPgoKCQk8c2NyaXB0IHNyYz0iZm9udHMvZ2VudGlsaXNfYm9sZC50eXBlZmFjZS5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImZvbnRzL2dlbnRpbGlzX3JlZ3VsYXIudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJmb250cy9vcHRpbWVyX2JvbGQudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJmb250cy9vcHRpbWVyX3JlZ3VsYXIudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJmb250cy9oZWx2ZXRpa2VyX2JvbGQudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJmb250cy9oZWx2ZXRpa2VyX3JlZ3VsYXIudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJmb250cy9kcm9pZC9kcm9pZF9zYW5zX3JlZ3VsYXIudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJmb250cy9kcm9pZC9kcm9pZF9zYW5zX2JvbGQudHlwZWZhY2UuanMiPjwvc2NyaXB0PgoJCTxzY3JpcHQgc3JjPSJmb250cy9kcm9pZC9kcm9pZF9zZXJpZl9yZWd1bGFyLnR5cGVmYWNlLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0iZm9udHMvZHJvaWQvZHJvaWRfc2VyaWZfYm9sZC50eXBlZmFjZS5qcyI+PC9zY3JpcHQ+CgoJCTwhLS0gdG9kbyBhc3luYyBsb2FkZXIgZm9yIGZvbnRzIC0tPgoKCQk8c2NyaXB0PgoKCQkJaWYgKCAhIERldGVjdG9yLndlYmdsICkgRGV0ZWN0b3IuYWRkR2V0V2ViR0xNZXNzYWdlKCk7CgoJCQl2YXIgY29udGFpbmVyLCBzdGF0cywgcGVybWFsaW5rLCBoZXgsIGNvbG9yOwoKCQkJdmFyIGNhbWVyYSwgY2FtZXJhVGFyZ2V0LCBzY2VuZSwgcmVuZGVyZXI7CgoJCQl2YXIgY29tcG9zZXI7CgkJCXZhciBlZmZlY3RGWEFBOwoKCQkJdmFyIGdyb3VwLCB0ZXh0TWVzaDEsIHRleHRNZXNoMiwgdGV4dEdlbywgbWF0ZXJpYWw7CgoJCQl2YXIgZmlyc3RMZXR0ZXIgPSB0cnVlOwoKCQkJdmFyIHRleHQgPSAidGhyZWUuanMiLAoKCQkJCWhlaWdodCA9IDIwLAoJCQkJc2l6ZSA9IDcwLAoJCQkJaG92ZXIgPSAzMCwKCgkJCQljdXJ2ZVNlZ21lbnRzID0gNCwKCgkJCQliZXZlbFRoaWNrbmVzcyA9IDIsCgkJCQliZXZlbFNpemUgPSAxLjUsCgkJCQliZXZlbFNlZ21lbnRzID0gMywKCQkJCWJldmVsRW5hYmxlZCA9IHRydWUsCgoJCQkJZm9udCA9ICJvcHRpbWVyIiwgLy8gaGVsdmV0aWtlciwgb3B0aW1lciwgZ2VudGlsaXMsIGRyb2lkIHNhbnMsIGRyb2lkIHNlcmlmCgkJCQl3ZWlnaHQgPSAiYm9sZCIsIC8vIG5vcm1hbCBib2xkCgkJCQlzdHlsZSA9ICJub3JtYWwiOyAvLyBub3JtYWwgaXRhbGljCgoJCQl2YXIgbWlycm9yID0gdHJ1ZTsKCgkJCXZhciBmb250TWFwID0gewoKCQkJCSJoZWx2ZXRpa2VyIjogMCwKCQkJCSJvcHRpbWVyIjogMSwKCQkJCSJnZW50aWxpcyI6IDIsCgkJCQkiZHJvaWQgc2FucyI6IDMsCgkJCQkiZHJvaWQgc2VyaWYiOiA0CgoJCQl9OwoKCQkJdmFyIHdlaWdodE1hcCA9IHsKCgkJCQkibm9ybWFsIjogMCwKCQkJCSJib2xkIjogMQoKCQkJfTsKCgkJCXZhciByZXZlcnNlRm9udE1hcCA9IHt9OwoJCQl2YXIgcmV2ZXJzZVdlaWdodE1hcCA9IHt9OwoKCQkJZm9yICggdmFyIGkgaW4gZm9udE1hcCApIHJldmVyc2VGb250TWFwWyBmb250TWFwW2ldIF0gPSBpOwoJCQlmb3IgKCB2YXIgaSBpbiB3ZWlnaHRNYXAgKSByZXZlcnNlV2VpZ2h0TWFwWyB3ZWlnaHRNYXBbaV0gXSA9IGk7CgoJCQl2YXIgdGFyZ2V0Um90YXRpb24gPSAwOwoJCQl2YXIgdGFyZ2V0Um90YXRpb25Pbk1vdXNlRG93biA9IDA7CgoJCQl2YXIgbW91c2VYID0gMDsKCQkJdmFyIG1vdXNlWE9uTW91c2VEb3duID0gMDsKCgkJCXZhciB3aW5kb3dIYWxmWCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gMjsKCQkJdmFyIHdpbmRvd0hhbGZZID0gd2luZG93LmlubmVySGVpZ2h0IC8gMjsKCgkJCXZhciBwb3N0cHJvY2Vzc2luZyA9IHsgZW5hYmxlZCA6IGZhbHNlIH07CgkJCXZhciBnbG93ID0gMC45OwoKCQkJaW5pdCgpOwoJCQlhbmltYXRlKCk7CgoJCQlmdW5jdGlvbiBjYXBpdGFsaXplKCB0eHQgKSB7CgoJCQkJcmV0dXJuIHR4dC5zdWJzdHJpbmcoIDAsIDEgKS50b1VwcGVyQ2FzZSgpICsgdHh0LnN1YnN0cmluZyggMSApOwoKCQkJfQoKCQkJZnVuY3Rpb24gZGVjaW1hbFRvSGV4KCBkICkgewoKCQkJCXZhciBoZXggPSBOdW1iZXIoIGQgKS50b1N0cmluZyggMTYgKTsKCQkJCWhleCA9ICIwMDAwMDAiLnN1YnN0ciggMCwgNiAtIGhleC5sZW5ndGggKSArIGhleDsKCQkJCXJldHVybiBoZXgudG9VcHBlckNhc2UoKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIGluaXQoKSB7CgoJCQkJY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTsKCQkJCWRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApOwoKCQkJCXBlcm1hbGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAicGVybWFsaW5rIiApOwoKCQkJCS8vIENBTUVSQQoKCQkJCWNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSggMzAsIHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0LCAxLCAxNTAwICk7CgkJCQljYW1lcmEucG9zaXRpb24uc2V0KCAwLCA0MDAsIDcwMCApOwoKCQkJCWNhbWVyYVRhcmdldCA9IG5ldyBUSFJFRS5WZWN0b3IzKCAwLCAxNTAsIDAgKTsKCgkJCQkvLyBTQ0VORQoKCQkJCXNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7CgkJCQlzY2VuZS5mb2cgPSBuZXcgVEhSRUUuRm9nKCAweDAwMDAwMCwgMjUwLCAxNDAwICk7CgoJCQkJLy8gTElHSFRTCgoJCQkJdmFyIGRpckxpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoIDB4ZmZmZmZmLCAwLjEyNSApOwoJCQkJZGlyTGlnaHQucG9zaXRpb24uc2V0KCAwLCAwLCAxICkubm9ybWFsaXplKCk7CgkJCQlzY2VuZS5hZGQoIGRpckxpZ2h0ICk7CgoJCQkJdmFyIHBvaW50TGlnaHQgPSBuZXcgVEhSRUUuUG9pbnRMaWdodCggMHhmZmZmZmYsIDEuNSApOwoJCQkJcG9pbnRMaWdodC5wb3NpdGlvbi5zZXQoIDAsIDEwMCwgOTAgKTsKCQkJCXNjZW5lLmFkZCggcG9pbnRMaWdodCApOwoKCQkJCS8vdGV4dCA9IGNhcGl0YWxpemUoIGZvbnQgKSArICIgIiArIGNhcGl0YWxpemUoIHdlaWdodCApOwoJCQkJLy90ZXh0ID0gImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSI7CgkJCQkvL3RleHQgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IjsKCgkJCQkvLyBHZXQgdGV4dCBmcm9tIGhhc2gKCgkJCQl2YXIgaGFzaCA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2guc3Vic3RyKCAxICk7CgoJCQkJaWYgKCBoYXNoLmxlbmd0aCAhPT0gMCApIHsKCgkJCQkJdmFyIGNvbG9yaGFzaCAgPSBoYXNoLnN1YnN0cmluZyggMCwgNiApOwoJCQkJCXZhciBmb250aGFzaCAgID0gaGFzaC5zdWJzdHJpbmcoIDYsIDcgKTsKCQkJCQl2YXIgd2VpZ2h0aGFzaCA9IGhhc2guc3Vic3RyaW5nKCA3LCA4ICk7CgkJCQkJdmFyIHBwaGFzaCAJICAgPSBoYXNoLnN1YnN0cmluZyggOCwgOSApOwoJCQkJCXZhciBiZXZlbGhhc2ggID0gaGFzaC5zdWJzdHJpbmcoIDksIDEwICk7CgkJCQkJdmFyIHRleHRoYXNoICAgPSBoYXNoLnN1YnN0cmluZyggMTAgKTsKCgkJCQkJaGV4ID0gY29sb3JoYXNoOwoJCQkJCXBvaW50TGlnaHQuY29sb3Iuc2V0SGV4KCBwYXJzZUludCggY29sb3JoYXNoLCAxNiApICk7CgoJCQkJCWZvbnQgPSByZXZlcnNlRm9udE1hcFsgcGFyc2VJbnQoIGZvbnRoYXNoICkgXTsKCQkJCQl3ZWlnaHQgPSByZXZlcnNlV2VpZ2h0TWFwWyBwYXJzZUludCggd2VpZ2h0aGFzaCApIF07CgoJCQkJCXBvc3Rwcm9jZXNzaW5nLmVuYWJsZWQgPSBwYXJzZUludCggcHBoYXNoICk7CgkJCQkJYmV2ZWxFbmFibGVkID0gcGFyc2VJbnQoIGJldmVsaGFzaCApOwoKCQkJCQl0ZXh0ID0gZGVjb2RlVVJJKCB0ZXh0aGFzaCApOwoKCQkJCQl1cGRhdGVQZXJtYWxpbmsoKTsKCgkJCQl9IGVsc2UgewoKCQkJCQlwb2ludExpZ2h0LmNvbG9yLnNldEhTTCggTWF0aC5yYW5kb20oKSwgMSwgMC41ICk7CgkJCQkJaGV4ID0gZGVjaW1hbFRvSGV4KCBwb2ludExpZ2h0LmNvbG9yLmdldEhleCgpICk7CgoJCQkJfQoKCQkJCW1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hGYWNlTWF0ZXJpYWwoIFsgCgkJCQkJbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKCB7IGNvbG9yOiAweGZmZmZmZiwgc2hhZGluZzogVEhSRUUuRmxhdFNoYWRpbmcgfSApLCAvLyBmcm9udAoJCQkJCW5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCggeyBjb2xvcjogMHhmZmZmZmYsIHNoYWRpbmc6IFRIUkVFLlNtb290aFNoYWRpbmcgfSApIC8vIHNpZGUKCQkJCV0gKTsKCgkJCQlncm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOwoJCQkJZ3JvdXAucG9zaXRpb24ueSA9IDEwMDsKCgkJCQlzY2VuZS5hZGQoIGdyb3VwICk7CgoJCQkJY3JlYXRlVGV4dCgpOwoKCQkJCXZhciBwbGFuZSA9IG5ldyBUSFJFRS5NZXNoKAoJCQkJCW5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KCAxMDAwMCwgMTAwMDAgKSwKCQkJCQluZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHsgY29sb3I6IDB4ZmZmZmZmLCBvcGFjaXR5OiAwLjUsIHRyYW5zcGFyZW50OiB0cnVlIH0gKQoJCQkJKTsKCQkJCXBsYW5lLnBvc2l0aW9uLnkgPSAxMDA7CgkJCQlwbGFuZS5yb3RhdGlvbi54ID0gLSBNYXRoLlBJIC8gMjsKCQkJCXNjZW5lLmFkZCggcGxhbmUgKTsKCgkJCQkvLyBSRU5ERVJFUgoKCQkJCXJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoIHsgYW50aWFsaWFzOiB0cnVlIH0gKTsKCQkJCXJlbmRlcmVyLnNldFNpemUoIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgKTsKCgkJCQlyZW5kZXJlci5zZXRDbGVhckNvbG9yKCBzY2VuZS5mb2cuY29sb3IsIDEgKTsKCgkJCQljb250YWluZXIuYXBwZW5kQ2hpbGQoIHJlbmRlcmVyLmRvbUVsZW1lbnQgKTsKCgkJCQkvLyBTVEFUUwoKCQkJCXN0YXRzID0gbmV3IFN0YXRzKCk7CgkJCQlzdGF0cy5kb21FbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKCQkJCXN0YXRzLmRvbUVsZW1lbnQuc3R5bGUudG9wID0gJzBweCc7CgkJCQkvL2NvbnRhaW5lci5hcHBlbmRDaGlsZCggc3RhdHMuZG9tRWxlbWVudCApOwoKCQkJCS8vIEVWRU5UUwoKCQkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBvbkRvY3VtZW50TW91c2VEb3duLCBmYWxzZSApOwoJCQkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoc3RhcnQnLCBvbkRvY3VtZW50VG91Y2hTdGFydCwgZmFsc2UgKTsKCQkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaG1vdmUnLCBvbkRvY3VtZW50VG91Y2hNb3ZlLCBmYWxzZSApOwoJCQkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2tleXByZXNzJywgb25Eb2N1bWVudEtleVByZXNzLCBmYWxzZSApOwoJCQkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBvbkRvY3VtZW50S2V5RG93biwgZmFsc2UgKTsKCgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggImNvbG9yIiApLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uKCkgewoKCQkJCQlwb2ludExpZ2h0LmNvbG9yLnNldEhTTCggTWF0aC5yYW5kb20oKSwgMSwgMC41ICk7CgkJCQkJaGV4ID0gZGVjaW1hbFRvSGV4KCBwb2ludExpZ2h0LmNvbG9yLmdldEhleCgpICk7CgoJCQkJCXVwZGF0ZVBlcm1hbGluaygpOwoKCQkJCX0sIGZhbHNlICk7CgoJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICJmb250IiApLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uKCkgewoKCQkJCQlpZiAoIGZvbnQgPT0gImhlbHZldGlrZXIiICkgewoKCQkJCQkJZm9udCA9ICJvcHRpbWVyIjsKCgkJCQkJfSBlbHNlIGlmICggZm9udCA9PSAib3B0aW1lciIgKSB7CgoJCQkJCQlmb250ID0gImdlbnRpbGlzIjsKCgkJCQkJfSBlbHNlIGlmICggZm9udCA9PSAiZ2VudGlsaXMiICkgewoKCQkJCQkJZm9udCA9ICJkcm9pZCBzYW5zIjsKCgkJCQkJfSBlbHNlIGlmICggZm9udCA9PSAiZHJvaWQgc2FucyIgKSB7CgoJCQkJCQlmb250ID0gImRyb2lkIHNlcmlmIjsKCgkJCQkJfSBlbHNlIHsKCgkJCQkJCWZvbnQgPSAiaGVsdmV0aWtlciI7CgoJCQkJCX0KCgkJCQkJcmVmcmVzaFRleHQoKTsKCgkJCQl9LCBmYWxzZSApOwoKCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAid2VpZ2h0IiApLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uKCkgewoKCQkJCQlpZiAoIHdlaWdodCA9PSAiYm9sZCIgKSB7CgoJCQkJCQl3ZWlnaHQgPSAibm9ybWFsIjsKCgkJCQkJfSBlbHNlIHsKCgkJCQkJCXdlaWdodCA9ICJib2xkIjsKCgkJCQkJfQoKCQkJCQlyZWZyZXNoVGV4dCgpOwoKCQkJCX0sIGZhbHNlICk7CgoJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICJiZXZlbCIgKS5hZGRFdmVudExpc3RlbmVyKCAnY2xpY2snLCBmdW5jdGlvbigpIHsKCgkJCQkJYmV2ZWxFbmFibGVkID0gIWJldmVsRW5hYmxlZDsKCgkJCQkJcmVmcmVzaFRleHQoKTsKCgkJCQl9LCBmYWxzZSApOwoKCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAicG9zdHByb2Nlc3NpbmciICkuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgZnVuY3Rpb24oKSB7CgoJCQkJCXBvc3Rwcm9jZXNzaW5nLmVuYWJsZWQgPSAhcG9zdHByb2Nlc3NpbmcuZW5hYmxlZDsKCQkJCQl1cGRhdGVQZXJtYWxpbmsoKTsKCgkJCQl9LCBmYWxzZSApOwoKCgkJCQkvLyBQT1NUUFJPQ0VTU0lORwoKCQkJCXJlbmRlcmVyLmF1dG9DbGVhciA9IGZhbHNlOwoKCQkJCXZhciByZW5kZXJNb2RlbCA9IG5ldyBUSFJFRS5SZW5kZXJQYXNzKCBzY2VuZSwgY2FtZXJhICk7CgkJCQl2YXIgZWZmZWN0Qmxvb20gPSBuZXcgVEhSRUUuQmxvb21QYXNzKCAwLjI1ICk7CgkJCQl2YXIgZWZmZWN0RmlsbSA9IG5ldyBUSFJFRS5GaWxtUGFzcyggMC41LCAwLjEyNSwgMjA0OCwgZmFsc2UgKTsKCgkJCQllZmZlY3RGWEFBID0gbmV3IFRIUkVFLlNoYWRlclBhc3MoIFRIUkVFLkZYQUFTaGFkZXIgKTsKCgkJCQl2YXIgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCB8fCAyOwoJCQkJdmFyIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCB8fCAyOwoKCQkJCWVmZmVjdEZYQUEudW5pZm9ybXNbICdyZXNvbHV0aW9uJyBdLnZhbHVlLnNldCggMSAvIHdpZHRoLCAxIC8gaGVpZ2h0ICk7CgoJCQkJZWZmZWN0RmlsbS5yZW5kZXJUb1NjcmVlbiA9IHRydWU7CgoJCQkJY29tcG9zZXIgPSBuZXcgVEhSRUUuRWZmZWN0Q29tcG9zZXIoIHJlbmRlcmVyICk7CgoJCQkJY29tcG9zZXIuYWRkUGFzcyggcmVuZGVyTW9kZWwgKTsKCQkJCWNvbXBvc2VyLmFkZFBhc3MoIGVmZmVjdEZYQUEgKTsKCQkJCWNvbXBvc2VyLmFkZFBhc3MoIGVmZmVjdEJsb29tICk7CgkJCQljb21wb3Nlci5hZGRQYXNzKCBlZmZlY3RGaWxtICk7CgoJCQkJLy8KCgkJCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3Jlc2l6ZScsIG9uV2luZG93UmVzaXplLCBmYWxzZSApOwoKCQkJfQoKCQkJZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoKSB7CgoJCQkJd2luZG93SGFsZlggPSB3aW5kb3cuaW5uZXJXaWR0aCAvIDI7CgkJCQl3aW5kb3dIYWxmWSA9IHdpbmRvdy5pbm5lckhlaWdodCAvIDI7CgoJCQkJY2FtZXJhLmFzcGVjdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0OwoJCQkJY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKCgkJCQlyZW5kZXJlci5zZXRTaXplKCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0ICk7CgoJCQkJY29tcG9zZXIucmVzZXQoKTsKCgkJCQllZmZlY3RGWEFBLnVuaWZvcm1zWyAncmVzb2x1dGlvbicgXS52YWx1ZS5zZXQoIDEgLyB3aW5kb3cuaW5uZXJXaWR0aCwgMSAvIHdpbmRvdy5pbm5lckhlaWdodCApOwoKCQkJfQoKCQkJLy8KCgkJCWZ1bmN0aW9uIGJvb2xUb051bSggYiApIHsKCgkJCQlyZXR1cm4gYiA/IDEgOiAwOwoKCQkJfQoKCQkJZnVuY3Rpb24gdXBkYXRlUGVybWFsaW5rKCkgewoKCQkJCXZhciBsaW5rID0gaGV4ICsgZm9udE1hcFsgZm9udCBdICsgd2VpZ2h0TWFwWyB3ZWlnaHQgXSArIGJvb2xUb051bSggcG9zdHByb2Nlc3NpbmcuZW5hYmxlZCApICsgYm9vbFRvTnVtKCBiZXZlbEVuYWJsZWQgKSArICIjIiArIGVuY29kZVVSSSggdGV4dCApOwoKCQkJCXBlcm1hbGluay5ocmVmID0gIiMiICsgbGluazsKCQkJCXdpbmRvdy5sb2NhdGlvbi5oYXNoID0gbGluazsKCgkJCX0KCgkJCWZ1bmN0aW9uIG9uRG9jdW1lbnRLZXlEb3duKCBldmVudCApIHsKCgkJCQlpZiAoIGZpcnN0TGV0dGVyICkgewoKCQkJCQlmaXJzdExldHRlciA9IGZhbHNlOwoJCQkJCXRleHQgPSAiIjsKCgkJCQl9CgoJCQkJdmFyIGtleUNvZGUgPSBldmVudC5rZXlDb2RlOwoKCQkJCS8vIGJhY2tzcGFjZQoKCQkJCWlmICgga2V5Q29kZSA9PSA4ICkgewoKCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCQl0ZXh0ID0gdGV4dC5zdWJzdHJpbmcoIDAsIHRleHQubGVuZ3RoIC0gMSApOwoJCQkJCXJlZnJlc2hUZXh0KCk7CgoJCQkJCXJldHVybiBmYWxzZTsKCgkJCQl9CgoJCQl9CgoJCQlmdW5jdGlvbiBvbkRvY3VtZW50S2V5UHJlc3MoIGV2ZW50ICkgewoKCQkJCXZhciBrZXlDb2RlID0gZXZlbnQud2hpY2g7CgoJCQkJLy8gYmFja3NwYWNlCgoJCQkJaWYgKCBrZXlDb2RlID09IDggKSB7CgoJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgoJCQkJfSBlbHNlIHsKCgkJCQkJdmFyIGNoID0gU3RyaW5nLmZyb21DaGFyQ29kZSgga2V5Q29kZSApOwoJCQkJCXRleHQgKz0gY2g7CgoJCQkJCXJlZnJlc2hUZXh0KCk7CgoJCQkJfQoKCQkJfQoKCQkJZnVuY3Rpb24gY3JlYXRlVGV4dCgpIHsKCgkJCQl0ZXh0R2VvID0gbmV3IFRIUkVFLlRleHRHZW9tZXRyeSggdGV4dCwgewoKCQkJCQlzaXplOiBzaXplLAoJCQkJCWhlaWdodDogaGVpZ2h0LAoJCQkJCWN1cnZlU2VnbWVudHM6IGN1cnZlU2VnbWVudHMsCgoJCQkJCWZvbnQ6IGZvbnQsCgkJCQkJd2VpZ2h0OiB3ZWlnaHQsCgkJCQkJc3R5bGU6IHN0eWxlLAoKCQkJCQliZXZlbFRoaWNrbmVzczogYmV2ZWxUaGlja25lc3MsCgkJCQkJYmV2ZWxTaXplOiBiZXZlbFNpemUsCgkJCQkJYmV2ZWxFbmFibGVkOiBiZXZlbEVuYWJsZWQsCgoJCQkJCW1hdGVyaWFsOiAwLAoJCQkJCWV4dHJ1ZGVNYXRlcmlhbDogMQoKCQkJCX0pOwoKCQkJCXRleHRHZW8uY29tcHV0ZUJvdW5kaW5nQm94KCk7CgkJCQl0ZXh0R2VvLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7CgoJCQkJLy8gImZpeCIgc2lkZSBub3JtYWxzIGJ5IHJlbW92aW5nIHotY29tcG9uZW50IG9mIG5vcm1hbHMgZm9yIHNpZGUgZmFjZXMKCQkJCS8vICh0aGlzIGRvZXNuJ3Qgd29yayB3ZWxsIGZvciBiZXZlbGVkIGdlb21ldHJ5IGFzIHRoZW4gd2UgbG9zZSBuaWNlIGN1cnZhdHVyZSBhcm91bmQgei1heGlzKQoKCQkJCWlmICggISBiZXZlbEVuYWJsZWQgKSB7CgoJCQkJCXZhciB0cmlhbmdsZUFyZWFIZXVyaXN0aWNzID0gMC4xICogKCBoZWlnaHQgKiBzaXplICk7CgoJCQkJCWZvciAoIHZhciBpID0gMDsgaSA8IHRleHRHZW8uZmFjZXMubGVuZ3RoOyBpICsrICkgewoKCQkJCQkJdmFyIGZhY2UgPSB0ZXh0R2VvLmZhY2VzWyBpIF07CgoJCQkJCQlpZiAoIGZhY2UubWF0ZXJpYWxJbmRleCA9PSAxICkgewoKCQkJCQkJCWZvciAoIHZhciBqID0gMDsgaiA8IGZhY2UudmVydGV4Tm9ybWFscy5sZW5ndGg7IGogKysgKSB7CgoJCQkJCQkJCWZhY2UudmVydGV4Tm9ybWFsc1sgaiBdLnogPSAwOwoJCQkJCQkJCWZhY2UudmVydGV4Tm9ybWFsc1sgaiBdLm5vcm1hbGl6ZSgpOwoKCQkJCQkJCX0KCgkJCQkJCQl2YXIgdmEgPSB0ZXh0R2VvLnZlcnRpY2VzWyBmYWNlLmEgXTsKCQkJCQkJCXZhciB2YiA9IHRleHRHZW8udmVydGljZXNbIGZhY2UuYiBdOwoJCQkJCQkJdmFyIHZjID0gdGV4dEdlby52ZXJ0aWNlc1sgZmFjZS5jIF07CgoJCQkJCQkJdmFyIHMgPSBUSFJFRS5HZW9tZXRyeVV0aWxzLnRyaWFuZ2xlQXJlYSggdmEsIHZiLCB2YyApOwoKCQkJCQkJCWlmICggcyA+IHRyaWFuZ2xlQXJlYUhldXJpc3RpY3MgKSB7CgoJCQkJCQkJCWZvciAoIHZhciBqID0gMDsgaiA8IGZhY2UudmVydGV4Tm9ybWFscy5sZW5ndGg7IGogKysgKSB7CgoJCQkJCQkJCQlmYWNlLnZlcnRleE5vcm1hbHNbIGogXS5jb3B5KCBmYWNlLm5vcm1hbCApOwoKCQkJCQkJCQl9CgoJCQkJCQkJfQoKCQkJCQkJfQoKCQkJCQl9CgoJCQkJfQoKCQkJCXZhciBjZW50ZXJPZmZzZXQgPSAtMC41ICogKCB0ZXh0R2VvLmJvdW5kaW5nQm94Lm1heC54IC0gdGV4dEdlby5ib3VuZGluZ0JveC5taW4ueCApOwoKCQkJCXRleHRNZXNoMSA9IG5ldyBUSFJFRS5NZXNoKCB0ZXh0R2VvLCBtYXRlcmlhbCApOwoKCQkJCXRleHRNZXNoMS5wb3NpdGlvbi54ID0gY2VudGVyT2Zmc2V0OwoJCQkJdGV4dE1lc2gxLnBvc2l0aW9uLnkgPSBob3ZlcjsKCQkJCXRleHRNZXNoMS5wb3NpdGlvbi56ID0gMDsKCgkJCQl0ZXh0TWVzaDEucm90YXRpb24ueCA9IDA7CgkJCQl0ZXh0TWVzaDEucm90YXRpb24ueSA9IE1hdGguUEkgKiAyOwoKCQkJCWdyb3VwLmFkZCggdGV4dE1lc2gxICk7CgoJCQkJaWYgKCBtaXJyb3IgKSB7CgoJCQkJCXRleHRNZXNoMiA9IG5ldyBUSFJFRS5NZXNoKCB0ZXh0R2VvLCBtYXRlcmlhbCApOwoKCQkJCQl0ZXh0TWVzaDIucG9zaXRpb24ueCA9IGNlbnRlck9mZnNldDsKCQkJCQl0ZXh0TWVzaDIucG9zaXRpb24ueSA9IC1ob3ZlcjsKCQkJCQl0ZXh0TWVzaDIucG9zaXRpb24ueiA9IGhlaWdodDsKCgkJCQkJdGV4dE1lc2gyLnJvdGF0aW9uLnggPSBNYXRoLlBJOwoJCQkJCXRleHRNZXNoMi5yb3RhdGlvbi55ID0gTWF0aC5QSSAqIDI7CgoJCQkJCWdyb3VwLmFkZCggdGV4dE1lc2gyICk7CgoJCQkJfQoKCQkJfQoKCQkJZnVuY3Rpb24gcmVmcmVzaFRleHQoKSB7CgoJCQkJdXBkYXRlUGVybWFsaW5rKCk7CgoJCQkJZ3JvdXAucmVtb3ZlKCB0ZXh0TWVzaDEgKTsKCQkJCWlmICggbWlycm9yICkgZ3JvdXAucmVtb3ZlKCB0ZXh0TWVzaDIgKTsKCgkJCQlpZiAoICF0ZXh0ICkgcmV0dXJuOwoKCQkJCWNyZWF0ZVRleHQoKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIG9uRG9jdW1lbnRNb3VzZURvd24oIGV2ZW50ICkgewoKCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgoJCQkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIG9uRG9jdW1lbnRNb3VzZU1vdmUsIGZhbHNlICk7CgkJCQlkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uRG9jdW1lbnRNb3VzZVVwLCBmYWxzZSApOwoJCQkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlb3V0Jywgb25Eb2N1bWVudE1vdXNlT3V0LCBmYWxzZSApOwoKCQkJCW1vdXNlWE9uTW91c2VEb3duID0gZXZlbnQuY2xpZW50WCAtIHdpbmRvd0hhbGZYOwoJCQkJdGFyZ2V0Um90YXRpb25Pbk1vdXNlRG93biA9IHRhcmdldFJvdGF0aW9uOwoKCQkJfQoKCQkJZnVuY3Rpb24gb25Eb2N1bWVudE1vdXNlTW92ZSggZXZlbnQgKSB7CgoJCQkJbW91c2VYID0gZXZlbnQuY2xpZW50WCAtIHdpbmRvd0hhbGZYOwoKCQkJCXRhcmdldFJvdGF0aW9uID0gdGFyZ2V0Um90YXRpb25Pbk1vdXNlRG93biArICggbW91c2VYIC0gbW91c2VYT25Nb3VzZURvd24gKSAqIDAuMDI7CgoJCQl9CgoJCQlmdW5jdGlvbiBvbkRvY3VtZW50TW91c2VVcCggZXZlbnQgKSB7CgoJCQkJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIG9uRG9jdW1lbnRNb3VzZU1vdmUsIGZhbHNlICk7CgkJCQlkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uRG9jdW1lbnRNb3VzZVVwLCBmYWxzZSApOwoJCQkJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlb3V0Jywgb25Eb2N1bWVudE1vdXNlT3V0LCBmYWxzZSApOwoKCQkJfQoKCQkJZnVuY3Rpb24gb25Eb2N1bWVudE1vdXNlT3V0KCBldmVudCApIHsKCgkJCQlkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Eb2N1bWVudE1vdXNlTW92ZSwgZmFsc2UgKTsKCQkJCWRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZXVwJywgb25Eb2N1bWVudE1vdXNlVXAsIGZhbHNlICk7CgkJCQlkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2VvdXQnLCBvbkRvY3VtZW50TW91c2VPdXQsIGZhbHNlICk7CgoJCQl9CgoJCQlmdW5jdGlvbiBvbkRvY3VtZW50VG91Y2hTdGFydCggZXZlbnQgKSB7CgoJCQkJaWYgKCBldmVudC50b3VjaGVzLmxlbmd0aCA9PSAxICkgewoKCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCQltb3VzZVhPbk1vdXNlRG93biA9IGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWCAtIHdpbmRvd0hhbGZYOwoJCQkJCXRhcmdldFJvdGF0aW9uT25Nb3VzZURvd24gPSB0YXJnZXRSb3RhdGlvbjsKCgkJCQl9CgoJCQl9CgoJCQlmdW5jdGlvbiBvbkRvY3VtZW50VG91Y2hNb3ZlKCBldmVudCApIHsKCgkJCQlpZiAoIGV2ZW50LnRvdWNoZXMubGVuZ3RoID09IDEgKSB7CgoJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgoJCQkJCW1vdXNlWCA9IGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWCAtIHdpbmRvd0hhbGZYOwoJCQkJCXRhcmdldFJvdGF0aW9uID0gdGFyZ2V0Um90YXRpb25Pbk1vdXNlRG93biArICggbW91c2VYIC0gbW91c2VYT25Nb3VzZURvd24gKSAqIDAuMDU7CgoJCQkJfQoKCQkJfQoKCQkJLy8KCgkJCWZ1bmN0aW9uIGFuaW1hdGUoKSB7CgoJCQkJcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBhbmltYXRlICk7CgoJCQkJcmVuZGVyKCk7CgkJCQlzdGF0cy51cGRhdGUoKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIHJlbmRlcigpIHsKCgkJCQlncm91cC5yb3RhdGlvbi55ICs9ICggdGFyZ2V0Um90YXRpb24gLSBncm91cC5yb3RhdGlvbi55ICkgKiAwLjA1OwoKCQkJCWNhbWVyYS5sb29rQXQoIGNhbWVyYVRhcmdldCApOwoKCQkJCXJlbmRlcmVyLmNsZWFyKCk7CgoJCQkJaWYgKCBwb3N0cHJvY2Vzc2luZy5lbmFibGVkICkgewoKCQkJCQljb21wb3Nlci5yZW5kZXIoIDAuMDUgKTsKCgkJCQl9IGVsc2UgewoKCQkJCQlyZW5kZXJlci5yZW5kZXIoIHNjZW5lLCBjYW1lcmEgKTsKCgkJCQl9CgoJCQl9CgoJCTwvc2NyaXB0PgoKCTwvYm9keT4KPC9odG1sPgo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 15:37:55 GMT",
                    "Content-Length": "15308",
                    "Date": "Sat, 08 Nov 2014 15:38:03 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}