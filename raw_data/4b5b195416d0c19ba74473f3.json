{
    "url": "http://localhost:9999/ariya/phantomjs/src/qt/qtwebkit/Tools/TestResultServer/static-dashboards/ui.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>window.location.pathname</b> and written to <b>window.location</b> via the following statements:<ul><li>var pathName = window.location.pathname;</li><li>pathName = pathName.substring(0, pathName.lastIndexOf('/') + 1);</li><li>window.location = pathName + fileName + window.location.hash;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/ariya/phantomjs/src/qt/qtwebkit/Tools/TestResultServer/static-dashboards/ui.js",
                "path": "/ariya/phantomjs/src/qt/qtwebkit/Tools/TestResultServer/static-dashboards/ui.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9hcml5YS9waGFudG9tanMvc3JjL3F0L3F0d2Via2l0L1Rvb2xzL1Rlc3RSZXN1bHRTZXJ2ZXIvc3RhdGljLWRhc2hib2FyZHMvdWkuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODE1OA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAyMTo1MToxNCBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMjE6NTA6MDAgR01UDQoNCi8vIENvcHlyaWdodCAoQykgMjAxMyBHb29nbGUgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLwovLyBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKLy8gbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZQovLyBtZXQ6Ci8vCi8vICAgICAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodAovLyBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuCi8vICAgICAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlCi8vIGNvcHlyaWdodCBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIKLy8gaW4gdGhlIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZQovLyBkaXN0cmlidXRpb24uCi8vICAgICAgICAgKiBOZWl0aGVyIHRoZSBuYW1lIG9mIEdvb2dsZSBJbmMuIG5vciB0aGUgbmFtZXMgb2YgaXRzCi8vIGNvbnRyaWJ1dG9ycyBtYXkgYmUgdXNlZCB0byBlbmRvcnNlIG9yIHByb21vdGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tCi8vIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uCi8vCi8vIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMKLy8gIkFTIElTIiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QKLy8gTElNSVRFRCBUTywgVEhFIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SCi8vIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUCi8vIE9XTkVSIE9SIENPTlRSSUJVVE9SUyBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLAovLyBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyAoSU5DTFVESU5HLCBCVVQgTk9UCi8vIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MgT0YgVVNFLAovLyBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORCBPTiBBTlkKLy8gVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVAovLyAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UKLy8gT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS4KCnZhciB1aSA9IHVpIHx8IHt9OwoKKGZ1bmN0aW9uKCkgewoKdWkucG9wdXAgPSB7fTsKCnVpLnBvcHVwLmhpZGUgPSBmdW5jdGlvbigpCnsKICAgIHZhciBwb3B1cCA9ICQoJ3BvcHVwJyk7CiAgICBpZiAocG9wdXApIHsKICAgICAgICBwb3B1cC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHBvcHVwKTsKICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB1aS5wb3B1cC5faGFuZGxlTW91c2VEb3duLCBmYWxzZSk7CiAgICB9Cn0KCnVpLnBvcHVwLnNob3cgPSBmdW5jdGlvbih0YXJnZXQsIGh0bWwpCnsKICAgIHZhciBwb3B1cCA9ICQoJ3BvcHVwJyk7CiAgICBpZiAoIXBvcHVwKSB7CiAgICAgICAgcG9wdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBwb3B1cC5pZCA9ICdwb3B1cCc7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwb3B1cCk7CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdWkucG9wdXAuX2hhbmRsZU1vdXNlRG93biwgZmFsc2UpOwogICAgfQoKICAgIC8vIFNldCBodG1sIGZpcnN0IHNvIHRoYXQgd2UgY2FuIGdldCBhY2N1cmF0ZSBzaXplIG1ldHJpY3Mgb24gdGhlIHBvcHVwLgogICAgcG9wdXAuaW5uZXJIVE1MID0gaHRtbDsKCiAgICB2YXIgdGFyZ2V0UmVjdCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCiAgICB2YXIgeCA9IE1hdGgubWluKHRhcmdldFJlY3QubGVmdCAtIDEwLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggLSBwb3B1cC5vZmZzZXRXaWR0aCk7CiAgICB4ID0gTWF0aC5tYXgoMCwgeCk7CiAgICBwb3B1cC5zdHlsZS5sZWZ0ID0geCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCArICdweCc7CgogICAgdmFyIHkgPSB0YXJnZXRSZWN0LnRvcCArIHRhcmdldFJlY3QuaGVpZ2h0OwogICAgaWYgKHkgKyBwb3B1cC5vZmZzZXRIZWlnaHQgPiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KQogICAgICAgIHkgPSB0YXJnZXRSZWN0LnRvcCAtIHBvcHVwLm9mZnNldEhlaWdodDsKICAgIHkgPSBNYXRoLm1heCgwLCB5KTsKICAgIHBvcHVwLnN0eWxlLnRvcCA9IHkgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCArICdweCc7Cn0KCnVpLnBvcHVwLl9oYW5kbGVNb3VzZURvd24gPSBmdW5jdGlvbihlKSB7CiAgICAvLyBDbGVhciB0aGUgb3BlbiBwb3B1cCwgdW5sZXNzIHRoZSBjbGljayB3YXMgaW5zaWRlIHRoZSBwb3B1cC4KICAgIHZhciBwb3B1cCA9ICQoJ3BvcHVwJyk7CiAgICBpZiAocG9wdXAgJiYgZS50YXJnZXQgIT0gcG9wdXAgJiYgIShwb3B1cC5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihlLnRhcmdldCkgJiAxNikpIAogICAgICAgIHVpLnBvcHVwLmhpZGUoKTsgICAgCn0KCnVpLmh0bWwgPSB7fTsKCnVpLmh0bWwuY2hlY2tib3ggPSBmdW5jdGlvbihxdWVyeVBhcmFtZXRlciwgbGFiZWwsIGlzQ2hlY2tlZCwgb3B0X2V4dHJhSmF2YVNjcmlwdCkKewogICAgdmFyIGpzID0gb3B0X2V4dHJhSmF2YVNjcmlwdCB8fCAnJzsKICAgIHJldHVybiAnPGxhYmVsIHN0eWxlPSJwYWRkaW5nLWxlZnQ6IDJlbSI+JyArCiAgICAgICAgJzxpbnB1dCB0eXBlPSJjaGVja2JveCIgb25jaGFuZ2U9ImdfaGlzdG9yeS50b2dnbGVRdWVyeVBhcmFtZXRlcihcJycgKyBxdWVyeVBhcmFtZXRlciArICdcJyk7JyArIGpzICsgJyIgJyArCiAgICAgICAgICAgIChpc0NoZWNrZWQgPyAnY2hlY2tlZCcgOiAnJykgKyAnPicgKyBsYWJlbCArCiAgICAgICAgJzwvbGFiZWw+ICc7Cn0KCnVpLmh0bWwuc2VsZWN0ID0gZnVuY3Rpb24obGFiZWwsIHF1ZXJ5UGFyYW1ldGVyLCBvcHRpb25zKQp7CiAgICB2YXIgaHRtbCA9ICc8bGFiZWwgc3R5bGU9InBhZGRpbmctbGVmdDogMmVtIj4nICsgbGFiZWwgKyAnOiAnICsKICAgICAgICAnPHNlbGVjdCBvbmNoYW5nZT0iZ19oaXN0b3J5LnNldFF1ZXJ5UGFyYW1ldGVyKFwnJyArIHF1ZXJ5UGFyYW1ldGVyICsgJ1wnLCB0aGlzW3RoaXMuc2VsZWN0ZWRJbmRleF0udmFsdWUpIj4nOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3B0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciB2YWx1ZSA9IG9wdGlvbnNbaV07CiAgICAgICAgaHRtbCArPSAnPG9wdGlvbiB2YWx1ZT0iJyArIHZhbHVlICsgJyIgJyArCiAgICAgICAgICAgIChnX2hpc3RvcnkucXVlcnlQYXJhbWV0ZXJWYWx1ZShxdWVyeVBhcmFtZXRlcikgPT0gdmFsdWUgPyAnc2VsZWN0ZWQnIDogJycpICsKICAgICAgICAgICAgJz4nICsgdmFsdWUgKyAnPC9vcHRpb24+JwogICAgfQogICAgaHRtbCArPSAnPC9zZWxlY3Q+PC9sYWJlbD4gJzsKICAgIHJldHVybiBodG1sOwp9CgovLyBSZXR1cm5zIHRoZSBIVE1MIGZvciB0aGUgc2VsZWN0IGVsZW1lbnQgdG8gc3dpdGNoIHRvIGRpZmZlcmVudCB0ZXN0VHlwZXMuCnVpLmh0bWwudGVzdFR5cGVTd2l0Y2hlciA9IGZ1bmN0aW9uKG9wdF9ub0J1aWxkZXJNZW51LCBvcHRfZXh0cmFIdG1sLCBvcHRfaW5jbHVkZU5vbmVCdWlsZGVyKQp7CiAgICB2YXIgaHRtbCA9ICc8ZGl2IHN0eWxlPSJib3JkZXItYm90dG9tOjFweCBkYXNoZWQiPic7CiAgICBodG1sICs9ICcnICsKICAgICAgICB1aS5odG1sLl9kYXNoYm9hcmRMaW5rKCdTdGF0cycsICdhZ2dyZWdhdGVfcmVzdWx0cy5odG1sJykgKwogICAgICAgIHVpLmh0bWwuX2Rhc2hib2FyZExpbmsoJ1RpbWVsaW5lJywgJ3RpbWVsaW5lX2V4cGxvcmVyLmh0bWwnKSArCiAgICAgICAgdWkuaHRtbC5fZGFzaGJvYXJkTGluaygnUmVzdWx0cycsICdmbGFraW5lc3NfZGFzaGJvYXJkLmh0bWwnKSArCiAgICAgICAgdWkuaHRtbC5fZGFzaGJvYXJkTGluaygnVHJlZW1hcCcsICd0cmVlbWFwLmh0bWwnKTsKCiAgICBodG1sICs9IHVpLmh0bWwuc2VsZWN0KCdUZXN0IHR5cGUnLCAndGVzdFR5cGUnLCBURVNUX1RZUEVTKTsKCiAgICBpZiAoIW9wdF9ub0J1aWxkZXJNZW51KSB7CiAgICAgICAgdmFyIGJ1aWxkZXJzRm9yTWVudSA9IE9iamVjdC5rZXlzKGN1cnJlbnRCdWlsZGVycygpKTsKICAgICAgICBpZiAob3B0X2luY2x1ZGVOb25lQnVpbGRlcikKICAgICAgICAgICAgYnVpbGRlcnNGb3JNZW51LnVuc2hpZnQoJy0tLS0tLS0tLS0tLS0tJyk7CiAgICAgICAgaHRtbCArPSB1aS5odG1sLnNlbGVjdCgnQnVpbGRlcicsICdidWlsZGVyJywgYnVpbGRlcnNGb3JNZW51KTsKICAgIH0KCiAgICBodG1sICs9IHVpLmh0bWwuc2VsZWN0KCdHcm91cCcsICdncm91cCcsCiAgICAgICAgT2JqZWN0LmtleXMoY3VycmVudEJ1aWxkZXJHcm91cENhdGVnb3J5KCkpKTsKCiAgICBpZiAoIWhpc3RvcnkuaXNUcmVlTWFwKCkpCiAgICAgICAgaHRtbCArPSB1aS5odG1sLmNoZWNrYm94KCdzaG93QWxsUnVucycsICdTaG93IGFsbCBydW5zJywgZ19oaXN0b3J5LmNyb3NzRGFzaGJvYXJkU3RhdGUuc2hvd0FsbFJ1bnMpOwoKICAgIGlmIChvcHRfZXh0cmFIdG1sKQogICAgICAgIGh0bWwgKz0gb3B0X2V4dHJhSHRtbDsKICAgIHJldHVybiBodG1sICsgJzwvZGl2Pic7Cn0KCnVpLmh0bWwuX2xvYWREYXNoYm9hcmQgPSBmdW5jdGlvbihmaWxlTmFtZSkKewogICAgdmFyIHBhdGhOYW1lID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lOwogICAgcGF0aE5hbWUgPSBwYXRoTmFtZS5zdWJzdHJpbmcoMCwgcGF0aE5hbWUubGFzdEluZGV4T2YoJy8nKSArIDEpOwogICAgd2luZG93LmxvY2F0aW9uID0gcGF0aE5hbWUgKyBmaWxlTmFtZSArIHdpbmRvdy5sb2NhdGlvbi5oYXNoOwp9Cgp1aS5odG1sLl90b3BMaW5rID0gZnVuY3Rpb24oaHRtbCwgb25DbGljaywgaXNTZWxlY3RlZCkKewogICAgdmFyIGNzc1RleHQgPSBpc1NlbGVjdGVkID8gJ2ZvbnQtd2VpZ2h0OiBib2xkOycgOiAnY29sb3I6Ymx1ZTt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lO2N1cnNvcjpwb2ludGVyOyc7CiAgICBjc3NUZXh0ICs9ICdtYXJnaW46IDAgNXB4Oyc7CiAgICByZXR1cm4gJzxzcGFuIHN0eWxlPSInICsgY3NzVGV4dCArICciIG9uY2xpY2s9IicgKyBvbkNsaWNrICsgJyI+JyArIGh0bWwgKyAnPC9zcGFuPic7Cn0KCnVpLmh0bWwuX2Rhc2hib2FyZExpbmsgPSBmdW5jdGlvbihodG1sLCBmaWxlTmFtZSkKewogICAgdmFyIHBhdGhOYW1lID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lOwogICAgdmFyIGN1cnJlbnRGaWxlTmFtZSA9IHBhdGhOYW1lLnN1YnN0cmluZyhwYXRoTmFtZS5sYXN0SW5kZXhPZignLycpICsgMSk7CiAgICB2YXIgaXNTZWxlY3RlZCA9IGN1cnJlbnRGaWxlTmFtZSA9PSBmaWxlTmFtZTsKICAgIHZhciBvbkNsaWNrID0gJ3VpLmh0bWwuX2xvYWREYXNoYm9hcmQoXCcnICsgZmlsZU5hbWUgKyAnXCcpJzsKICAgIHJldHVybiB1aS5odG1sLl90b3BMaW5rKGh0bWwsIG9uQ2xpY2ssIGlzU2VsZWN0ZWQpOwp9Cgp1aS5odG1sLl9yZXZpc2lvbkxpbmsgPSBmdW5jdGlvbihyZXN1bHRzLCBpbmRleCwga2V5LCBzaW5nbGVVcmxUZW1wbGF0ZSwgcmFuZ2VVcmxUZW1wbGF0ZSkKewogICAgdmFyIGN1cnJlbnRSZXZpc2lvbiA9IHBhcnNlSW50KHJlc3VsdHNba2V5XVtpbmRleF0sIDEwKTsKICAgIHZhciBwcmV2aW91c1JldmlzaW9uID0gcGFyc2VJbnQocmVzdWx0c1trZXldW2luZGV4ICsgMV0sIDEwKTsKCiAgICBmdW5jdGlvbiBzaW5nbGVVcmwoKQogICAgewogICAgICAgIHJldHVybiBzaW5nbGVVcmxUZW1wbGF0ZS5yZXBsYWNlKCc8cmV2PicsIGN1cnJlbnRSZXZpc2lvbik7CiAgICB9CgogICAgZnVuY3Rpb24gcmFuZ2VVcmwoKQogICAgewogICAgICAgIHJldHVybiByYW5nZVVybFRlbXBsYXRlLnJlcGxhY2UoJzxyZXYxPicsIGN1cnJlbnRSZXZpc2lvbikucmVwbGFjZSgnPHJldjI+JywgcHJldmlvdXNSZXZpc2lvbiArIDEpOwogICAgfQoKICAgIGlmIChjdXJyZW50UmV2aXNpb24gPT0gcHJldmlvdXNSZXZpc2lvbikKICAgICAgICByZXR1cm4gJ0F0IDxhIGhyZWY9IicgKyBzaW5nbGVVcmwoKSArICciPnInICsgY3VycmVudFJldmlzaW9uICAgICsgJzwvYT4nOwogICAgZWxzZSBpZiAoY3VycmVudFJldmlzaW9uIC0gcHJldmlvdXNSZXZpc2lvbiA9PSAxKQogICAgICAgIHJldHVybiAnPGEgaHJlZj0iJyArIHNpbmdsZVVybCgpICsgJyI+cicgKyBjdXJyZW50UmV2aXNpb24gICAgKyAnPC9hPic7CiAgICBlbHNlCiAgICAgICAgcmV0dXJuICc8YSBocmVmPSInICsgcmFuZ2VVcmwoKSArICciPnInICsgKHByZXZpb3VzUmV2aXNpb24gKyAxKSArICcgdG8gcicgKyBjdXJyZW50UmV2aXNpb24gKyAnPC9hPic7Cn0KCnVpLmh0bWwuY2hyb21pdW1SZXZpc2lvbkxpbmsgPSBmdW5jdGlvbihyZXN1bHRzLCBpbmRleCkKewogICAgcmV0dXJuIHVpLmh0bWwuX3JldmlzaW9uTGluaygKICAgICAgICByZXN1bHRzLAogICAgICAgIGluZGV4LAogICAgICAgIENIUk9NRV9SRVZJU0lPTlNfS0VZLAogICAgICAgICdodHRwOi8vc3JjLmNocm9taXVtLm9yZy92aWV3dmMvY2hyb21lP3ZpZXc9cmV2JnJldmlzaW9uPTxyZXY+JywKICAgICAgICAnaHR0cDovL2J1aWxkLmNocm9taXVtLm9yZy9mL2Nocm9taXVtL3BlcmYvZGFzaGJvYXJkL3VpL2NoYW5nZWxvZy5odG1sP3VybD0vdHJ1bmsvc3JjJnJhbmdlPTxyZXYyPjo8cmV2MT4mbW9kZT1odG1sJyk7Cn0KCnVpLmh0bWwud2ViS2l0UmV2aXNpb25MaW5rID0gZnVuY3Rpb24ocmVzdWx0cywgaW5kZXgpCnsKICAgIHJldHVybiB1aS5odG1sLl9yZXZpc2lvbkxpbmsoCiAgICAgICAgcmVzdWx0cywKICAgICAgICBpbmRleCwKICAgICAgICBXRUJLSVRfUkVWSVNJT05TX0tFWSwKICAgICAgICAnaHR0cDovL3RyYWMud2Via2l0Lm9yZy9jaGFuZ2VzZXQvPHJldj4nLAogICAgICAgICdodHRwOi8vdHJhYy53ZWJraXQub3JnL2xvZy90cnVuay8/cmV2PTxyZXYxPiZzdG9wX3Jldj08cmV2Mj4mbGltaXQ9MTAwJnZlcmJvc2U9b24nKTsKfQoKCnVpLkVycm9ycyA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5fbWVzc2FnZXMgPSAnJzsKICAgIC8vIEVsZW1lbnQgdG8gZGlzcGxheSB0aGUgZXJyb3JzIHdpdGhpbi4KICAgIHRoaXMuX2NvbnRhaW5lckVsZW1lbnQgPSBudWxsOwp9Cgp1aS5FcnJvcnMucHJvdG90eXBlID0gewogICAgc2hvdzogZnVuY3Rpb24oKQogICAgewogICAgICAgIGlmICghdGhpcy5fY29udGFpbmVyRWxlbWVudCkgewogICAgICAgICAgICB0aGlzLl9jb250YWluZXJFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnSDInKTsKICAgICAgICAgICAgdGhpcy5fY29udGFpbmVyRWxlbWVudC5zdHlsZS5jb2xvciA9ICdyZWQnOwogICAgICAgICAgICB0aGlzLl9jb250YWluZXJFbGVtZW50LmlkID0gJ2Vycm9ycyc7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5fY29udGFpbmVyRWxlbWVudCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9jb250YWluZXJFbGVtZW50LmlubmVySFRNTCA9IHRoaXMuX21lc3NhZ2VzOwogICAgfSwKICAgIC8vIFJlY29yZCBhIG5ldyBlcnJvciBtZXNzYWdlLgogICAgYWRkRXJyb3I6IGZ1bmN0aW9uKG1lc3NhZ2UpCiAgICB7CiAgICAgICAgdGhpcy5fbWVzc2FnZXMgKz0gbWVzc2FnZSArICc8YnI+JzsKICAgIH0KfQoKfSkoKTs=",
                "body": "Ly8gQ29weXJpZ2h0IChDKSAyMDEzIEdvb2dsZSBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vCi8vIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAovLyBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlCi8vIG1ldDoKLy8KLy8gICAgICAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0Ci8vIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4KLy8gICAgICAgICAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUKLy8gY29weXJpZ2h0IG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lcgovLyBpbiB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlCi8vIGRpc3RyaWJ1dGlvbi4KLy8gICAgICAgICAqIE5laXRoZXIgdGhlIG5hbWUgb2YgR29vZ2xlIEluYy4gbm9yIHRoZSBuYW1lcyBvZiBpdHMKLy8gY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20KLy8gdGhpcyBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi4KLy8KLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQU5EIENPTlRSSUJVVE9SUwovLyAiQVMgSVMiIEFORCBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVAovLyBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IKLy8gQSBQQVJUSUNVTEFSIFBVUlBPU0UgQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBDT1BZUklHSFQKLy8gT1dORVIgT1IgQ09OVFJJQlVUT1JTIEJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsCi8vIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QKLy8gTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsCi8vIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWQovLyBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUCi8vIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRQovLyBPRiBUSElTIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLgoKdmFyIHVpID0gdWkgfHwge307CgooZnVuY3Rpb24oKSB7Cgp1aS5wb3B1cCA9IHt9OwoKdWkucG9wdXAuaGlkZSA9IGZ1bmN0aW9uKCkKewogICAgdmFyIHBvcHVwID0gJCgncG9wdXAnKTsKICAgIGlmIChwb3B1cCkgewogICAgICAgIHBvcHVwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocG9wdXApOwogICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHVpLnBvcHVwLl9oYW5kbGVNb3VzZURvd24sIGZhbHNlKTsKICAgIH0KfQoKdWkucG9wdXAuc2hvdyA9IGZ1bmN0aW9uKHRhcmdldCwgaHRtbCkKewogICAgdmFyIHBvcHVwID0gJCgncG9wdXAnKTsKICAgIGlmICghcG9wdXApIHsKICAgICAgICBwb3B1cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIHBvcHVwLmlkID0gJ3BvcHVwJzsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBvcHVwKTsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB1aS5wb3B1cC5faGFuZGxlTW91c2VEb3duLCBmYWxzZSk7CiAgICB9CgogICAgLy8gU2V0IGh0bWwgZmlyc3Qgc28gdGhhdCB3ZSBjYW4gZ2V0IGFjY3VyYXRlIHNpemUgbWV0cmljcyBvbiB0aGUgcG9wdXAuCiAgICBwb3B1cC5pbm5lckhUTUwgPSBodG1sOwoKICAgIHZhciB0YXJnZXRSZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoKICAgIHZhciB4ID0gTWF0aC5taW4odGFyZ2V0UmVjdC5sZWZ0IC0gMTAsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCAtIHBvcHVwLm9mZnNldFdpZHRoKTsKICAgIHggPSBNYXRoLm1heCgwLCB4KTsKICAgIHBvcHVwLnN0eWxlLmxlZnQgPSB4ICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0ICsgJ3B4JzsKCiAgICB2YXIgeSA9IHRhcmdldFJlY3QudG9wICsgdGFyZ2V0UmVjdC5oZWlnaHQ7CiAgICBpZiAoeSArIHBvcHVwLm9mZnNldEhlaWdodCA+IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpCiAgICAgICAgeSA9IHRhcmdldFJlY3QudG9wIC0gcG9wdXAub2Zmc2V0SGVpZ2h0OwogICAgeSA9IE1hdGgubWF4KDAsIHkpOwogICAgcG9wdXAuc3R5bGUudG9wID0geSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wICsgJ3B4JzsKfQoKdWkucG9wdXAuX2hhbmRsZU1vdXNlRG93biA9IGZ1bmN0aW9uKGUpIHsKICAgIC8vIENsZWFyIHRoZSBvcGVuIHBvcHVwLCB1bmxlc3MgdGhlIGNsaWNrIHdhcyBpbnNpZGUgdGhlIHBvcHVwLgogICAgdmFyIHBvcHVwID0gJCgncG9wdXAnKTsKICAgIGlmIChwb3B1cCAmJiBlLnRhcmdldCAhPSBwb3B1cCAmJiAhKHBvcHVwLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUudGFyZ2V0KSAmIDE2KSkgCiAgICAgICAgdWkucG9wdXAuaGlkZSgpOyAgICAKfQoKdWkuaHRtbCA9IHt9OwoKdWkuaHRtbC5jaGVja2JveCA9IGZ1bmN0aW9uKHF1ZXJ5UGFyYW1ldGVyLCBsYWJlbCwgaXNDaGVja2VkLCBvcHRfZXh0cmFKYXZhU2NyaXB0KQp7CiAgICB2YXIganMgPSBvcHRfZXh0cmFKYXZhU2NyaXB0IHx8ICcnOwogICAgcmV0dXJuICc8bGFiZWwgc3R5bGU9InBhZGRpbmctbGVmdDogMmVtIj4nICsKICAgICAgICAnPGlucHV0IHR5cGU9ImNoZWNrYm94IiBvbmNoYW5nZT0iZ19oaXN0b3J5LnRvZ2dsZVF1ZXJ5UGFyYW1ldGVyKFwnJyArIHF1ZXJ5UGFyYW1ldGVyICsgJ1wnKTsnICsganMgKyAnIiAnICsKICAgICAgICAgICAgKGlzQ2hlY2tlZCA/ICdjaGVja2VkJyA6ICcnKSArICc+JyArIGxhYmVsICsKICAgICAgICAnPC9sYWJlbD4gJzsKfQoKdWkuaHRtbC5zZWxlY3QgPSBmdW5jdGlvbihsYWJlbCwgcXVlcnlQYXJhbWV0ZXIsIG9wdGlvbnMpCnsKICAgIHZhciBodG1sID0gJzxsYWJlbCBzdHlsZT0icGFkZGluZy1sZWZ0OiAyZW0iPicgKyBsYWJlbCArICc6ICcgKwogICAgICAgICc8c2VsZWN0IG9uY2hhbmdlPSJnX2hpc3Rvcnkuc2V0UXVlcnlQYXJhbWV0ZXIoXCcnICsgcXVlcnlQYXJhbWV0ZXIgKyAnXCcsIHRoaXNbdGhpcy5zZWxlY3RlZEluZGV4XS52YWx1ZSkiPic7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHRpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHZhbHVlID0gb3B0aW9uc1tpXTsKICAgICAgICBodG1sICs9ICc8b3B0aW9uIHZhbHVlPSInICsgdmFsdWUgKyAnIiAnICsKICAgICAgICAgICAgKGdfaGlzdG9yeS5xdWVyeVBhcmFtZXRlclZhbHVlKHF1ZXJ5UGFyYW1ldGVyKSA9PSB2YWx1ZSA/ICdzZWxlY3RlZCcgOiAnJykgKwogICAgICAgICAgICAnPicgKyB2YWx1ZSArICc8L29wdGlvbj4nCiAgICB9CiAgICBodG1sICs9ICc8L3NlbGVjdD48L2xhYmVsPiAnOwogICAgcmV0dXJuIGh0bWw7Cn0KCi8vIFJldHVybnMgdGhlIEhUTUwgZm9yIHRoZSBzZWxlY3QgZWxlbWVudCB0byBzd2l0Y2ggdG8gZGlmZmVyZW50IHRlc3RUeXBlcy4KdWkuaHRtbC50ZXN0VHlwZVN3aXRjaGVyID0gZnVuY3Rpb24ob3B0X25vQnVpbGRlck1lbnUsIG9wdF9leHRyYUh0bWwsIG9wdF9pbmNsdWRlTm9uZUJ1aWxkZXIpCnsKICAgIHZhciBodG1sID0gJzxkaXYgc3R5bGU9ImJvcmRlci1ib3R0b206MXB4IGRhc2hlZCI+JzsKICAgIGh0bWwgKz0gJycgKwogICAgICAgIHVpLmh0bWwuX2Rhc2hib2FyZExpbmsoJ1N0YXRzJywgJ2FnZ3JlZ2F0ZV9yZXN1bHRzLmh0bWwnKSArCiAgICAgICAgdWkuaHRtbC5fZGFzaGJvYXJkTGluaygnVGltZWxpbmUnLCAndGltZWxpbmVfZXhwbG9yZXIuaHRtbCcpICsKICAgICAgICB1aS5odG1sLl9kYXNoYm9hcmRMaW5rKCdSZXN1bHRzJywgJ2ZsYWtpbmVzc19kYXNoYm9hcmQuaHRtbCcpICsKICAgICAgICB1aS5odG1sLl9kYXNoYm9hcmRMaW5rKCdUcmVlbWFwJywgJ3RyZWVtYXAuaHRtbCcpOwoKICAgIGh0bWwgKz0gdWkuaHRtbC5zZWxlY3QoJ1Rlc3QgdHlwZScsICd0ZXN0VHlwZScsIFRFU1RfVFlQRVMpOwoKICAgIGlmICghb3B0X25vQnVpbGRlck1lbnUpIHsKICAgICAgICB2YXIgYnVpbGRlcnNGb3JNZW51ID0gT2JqZWN0LmtleXMoY3VycmVudEJ1aWxkZXJzKCkpOwogICAgICAgIGlmIChvcHRfaW5jbHVkZU5vbmVCdWlsZGVyKQogICAgICAgICAgICBidWlsZGVyc0Zvck1lbnUudW5zaGlmdCgnLS0tLS0tLS0tLS0tLS0nKTsKICAgICAgICBodG1sICs9IHVpLmh0bWwuc2VsZWN0KCdCdWlsZGVyJywgJ2J1aWxkZXInLCBidWlsZGVyc0Zvck1lbnUpOwogICAgfQoKICAgIGh0bWwgKz0gdWkuaHRtbC5zZWxlY3QoJ0dyb3VwJywgJ2dyb3VwJywKICAgICAgICBPYmplY3Qua2V5cyhjdXJyZW50QnVpbGRlckdyb3VwQ2F0ZWdvcnkoKSkpOwoKICAgIGlmICghaGlzdG9yeS5pc1RyZWVNYXAoKSkKICAgICAgICBodG1sICs9IHVpLmh0bWwuY2hlY2tib3goJ3Nob3dBbGxSdW5zJywgJ1Nob3cgYWxsIHJ1bnMnLCBnX2hpc3RvcnkuY3Jvc3NEYXNoYm9hcmRTdGF0ZS5zaG93QWxsUnVucyk7CgogICAgaWYgKG9wdF9leHRyYUh0bWwpCiAgICAgICAgaHRtbCArPSBvcHRfZXh0cmFIdG1sOwogICAgcmV0dXJuIGh0bWwgKyAnPC9kaXY+JzsKfQoKdWkuaHRtbC5fbG9hZERhc2hib2FyZCA9IGZ1bmN0aW9uKGZpbGVOYW1lKQp7CiAgICB2YXIgcGF0aE5hbWUgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7CiAgICBwYXRoTmFtZSA9IHBhdGhOYW1lLnN1YnN0cmluZygwLCBwYXRoTmFtZS5sYXN0SW5kZXhPZignLycpICsgMSk7CiAgICB3aW5kb3cubG9jYXRpb24gPSBwYXRoTmFtZSArIGZpbGVOYW1lICsgd2luZG93LmxvY2F0aW9uLmhhc2g7Cn0KCnVpLmh0bWwuX3RvcExpbmsgPSBmdW5jdGlvbihodG1sLCBvbkNsaWNrLCBpc1NlbGVjdGVkKQp7CiAgICB2YXIgY3NzVGV4dCA9IGlzU2VsZWN0ZWQgPyAnZm9udC13ZWlnaHQ6IGJvbGQ7JyA6ICdjb2xvcjpibHVlO3RleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7Y3Vyc29yOnBvaW50ZXI7JzsKICAgIGNzc1RleHQgKz0gJ21hcmdpbjogMCA1cHg7JzsKICAgIHJldHVybiAnPHNwYW4gc3R5bGU9IicgKyBjc3NUZXh0ICsgJyIgb25jbGljaz0iJyArIG9uQ2xpY2sgKyAnIj4nICsgaHRtbCArICc8L3NwYW4+JzsKfQoKdWkuaHRtbC5fZGFzaGJvYXJkTGluayA9IGZ1bmN0aW9uKGh0bWwsIGZpbGVOYW1lKQp7CiAgICB2YXIgcGF0aE5hbWUgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7CiAgICB2YXIgY3VycmVudEZpbGVOYW1lID0gcGF0aE5hbWUuc3Vic3RyaW5nKHBhdGhOYW1lLmxhc3RJbmRleE9mKCcvJykgKyAxKTsKICAgIHZhciBpc1NlbGVjdGVkID0gY3VycmVudEZpbGVOYW1lID09IGZpbGVOYW1lOwogICAgdmFyIG9uQ2xpY2sgPSAndWkuaHRtbC5fbG9hZERhc2hib2FyZChcJycgKyBmaWxlTmFtZSArICdcJyknOwogICAgcmV0dXJuIHVpLmh0bWwuX3RvcExpbmsoaHRtbCwgb25DbGljaywgaXNTZWxlY3RlZCk7Cn0KCnVpLmh0bWwuX3JldmlzaW9uTGluayA9IGZ1bmN0aW9uKHJlc3VsdHMsIGluZGV4LCBrZXksIHNpbmdsZVVybFRlbXBsYXRlLCByYW5nZVVybFRlbXBsYXRlKQp7CiAgICB2YXIgY3VycmVudFJldmlzaW9uID0gcGFyc2VJbnQocmVzdWx0c1trZXldW2luZGV4XSwgMTApOwogICAgdmFyIHByZXZpb3VzUmV2aXNpb24gPSBwYXJzZUludChyZXN1bHRzW2tleV1baW5kZXggKyAxXSwgMTApOwoKICAgIGZ1bmN0aW9uIHNpbmdsZVVybCgpCiAgICB7CiAgICAgICAgcmV0dXJuIHNpbmdsZVVybFRlbXBsYXRlLnJlcGxhY2UoJzxyZXY+JywgY3VycmVudFJldmlzaW9uKTsKICAgIH0KCiAgICBmdW5jdGlvbiByYW5nZVVybCgpCiAgICB7CiAgICAgICAgcmV0dXJuIHJhbmdlVXJsVGVtcGxhdGUucmVwbGFjZSgnPHJldjE+JywgY3VycmVudFJldmlzaW9uKS5yZXBsYWNlKCc8cmV2Mj4nLCBwcmV2aW91c1JldmlzaW9uICsgMSk7CiAgICB9CgogICAgaWYgKGN1cnJlbnRSZXZpc2lvbiA9PSBwcmV2aW91c1JldmlzaW9uKQogICAgICAgIHJldHVybiAnQXQgPGEgaHJlZj0iJyArIHNpbmdsZVVybCgpICsgJyI+cicgKyBjdXJyZW50UmV2aXNpb24gICAgKyAnPC9hPic7CiAgICBlbHNlIGlmIChjdXJyZW50UmV2aXNpb24gLSBwcmV2aW91c1JldmlzaW9uID09IDEpCiAgICAgICAgcmV0dXJuICc8YSBocmVmPSInICsgc2luZ2xlVXJsKCkgKyAnIj5yJyArIGN1cnJlbnRSZXZpc2lvbiAgICArICc8L2E+JzsKICAgIGVsc2UKICAgICAgICByZXR1cm4gJzxhIGhyZWY9IicgKyByYW5nZVVybCgpICsgJyI+cicgKyAocHJldmlvdXNSZXZpc2lvbiArIDEpICsgJyB0byByJyArIGN1cnJlbnRSZXZpc2lvbiArICc8L2E+JzsKfQoKdWkuaHRtbC5jaHJvbWl1bVJldmlzaW9uTGluayA9IGZ1bmN0aW9uKHJlc3VsdHMsIGluZGV4KQp7CiAgICByZXR1cm4gdWkuaHRtbC5fcmV2aXNpb25MaW5rKAogICAgICAgIHJlc3VsdHMsCiAgICAgICAgaW5kZXgsCiAgICAgICAgQ0hST01FX1JFVklTSU9OU19LRVksCiAgICAgICAgJ2h0dHA6Ly9zcmMuY2hyb21pdW0ub3JnL3ZpZXd2Yy9jaHJvbWU/dmlldz1yZXYmcmV2aXNpb249PHJldj4nLAogICAgICAgICdodHRwOi8vYnVpbGQuY2hyb21pdW0ub3JnL2YvY2hyb21pdW0vcGVyZi9kYXNoYm9hcmQvdWkvY2hhbmdlbG9nLmh0bWw/dXJsPS90cnVuay9zcmMmcmFuZ2U9PHJldjI+OjxyZXYxPiZtb2RlPWh0bWwnKTsKfQoKdWkuaHRtbC53ZWJLaXRSZXZpc2lvbkxpbmsgPSBmdW5jdGlvbihyZXN1bHRzLCBpbmRleCkKewogICAgcmV0dXJuIHVpLmh0bWwuX3JldmlzaW9uTGluaygKICAgICAgICByZXN1bHRzLAogICAgICAgIGluZGV4LAogICAgICAgIFdFQktJVF9SRVZJU0lPTlNfS0VZLAogICAgICAgICdodHRwOi8vdHJhYy53ZWJraXQub3JnL2NoYW5nZXNldC88cmV2PicsCiAgICAgICAgJ2h0dHA6Ly90cmFjLndlYmtpdC5vcmcvbG9nL3RydW5rLz9yZXY9PHJldjE+JnN0b3BfcmV2PTxyZXYyPiZsaW1pdD0xMDAmdmVyYm9zZT1vbicpOwp9CgoKdWkuRXJyb3JzID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9tZXNzYWdlcyA9ICcnOwogICAgLy8gRWxlbWVudCB0byBkaXNwbGF5IHRoZSBlcnJvcnMgd2l0aGluLgogICAgdGhpcy5fY29udGFpbmVyRWxlbWVudCA9IG51bGw7Cn0KCnVpLkVycm9ycy5wcm90b3R5cGUgPSB7CiAgICBzaG93OiBmdW5jdGlvbigpCiAgICB7CiAgICAgICAgaWYgKCF0aGlzLl9jb250YWluZXJFbGVtZW50KSB7CiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdIMicpOwogICAgICAgICAgICB0aGlzLl9jb250YWluZXJFbGVtZW50LnN0eWxlLmNvbG9yID0gJ3JlZCc7CiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lckVsZW1lbnQuaWQgPSAnZXJyb3JzJzsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLl9jb250YWluZXJFbGVtZW50KTsKICAgICAgICB9CgogICAgICAgIHRoaXMuX2NvbnRhaW5lckVsZW1lbnQuaW5uZXJIVE1MID0gdGhpcy5fbWVzc2FnZXM7CiAgICB9LAogICAgLy8gUmVjb3JkIGEgbmV3IGVycm9yIG1lc3NhZ2UuCiAgICBhZGRFcnJvcjogZnVuY3Rpb24obWVzc2FnZSkKICAgIHsKICAgICAgICB0aGlzLl9tZXNzYWdlcyArPSBtZXNzYWdlICsgJzxicj4nOwogICAgfQp9Cgp9KSgpOw==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 21:50:00 GMT",
                    "Content-Length": "8158",
                    "Date": "Fri, 07 Nov 2014 21:51:14 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}