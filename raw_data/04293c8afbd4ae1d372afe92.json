{
    "url": "http://localhost:9999/atelierspierrot/gentleface-sprites/demo/assets/scripts.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>window.location.hash</b> and written to <b>$()</b> via the following statements:<ul><li>var _hash = window.location.hash;</li><li>var hash = $('#'+_hash.replace('#', ''));</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/atelierspierrot/gentleface-sprites/demo/assets/scripts.js",
                "path": "/atelierspierrot/gentleface-sprites/demo/assets/scripts.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9hdGVsaWVyc3BpZXJyb3QvZ2VudGxlZmFjZS1zcHJpdGVzL2RlbW8vYXNzZXRzL3NjcmlwdHMuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNzgzMA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAxMDo0Nzo1MSBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMTA6NDc6NTAgR01UDQoNCi8qIFNjcmlwdHMgZm9yIGRlbW8gKi8KCi8vIEF2b2lkIGBjb25zb2xlYCBlcnJvcnMgaW4gYnJvd3NlcnMgdGhhdCBsYWNrIGEgY29uc29sZS4KKGZ1bmN0aW9uKCkgewogICAgdmFyIG1ldGhvZDsKICAgIHZhciBub29wID0gZnVuY3Rpb24gKCkge307CiAgICB2YXIgbWV0aG9kcyA9IFsKICAgICAgICAnYXNzZXJ0JywgJ2NsZWFyJywgJ2NvdW50JywgJ2RlYnVnJywgJ2RpcicsICdkaXJ4bWwnLCAnZXJyb3InLAogICAgICAgICdleGNlcHRpb24nLCAnZ3JvdXAnLCAnZ3JvdXBDb2xsYXBzZWQnLCAnZ3JvdXBFbmQnLCAnaW5mbycsICdsb2cnLAogICAgICAgICdtYXJrVGltZWxpbmUnLCAncHJvZmlsZScsICdwcm9maWxlRW5kJywgJ3RhYmxlJywgJ3RpbWUnLCAndGltZUVuZCcsCiAgICAgICAgJ3RpbWVTdGFtcCcsICd0cmFjZScsICd3YXJuJwogICAgXTsKICAgIHZhciBsZW5ndGggPSBtZXRob2RzLmxlbmd0aDsKICAgIHZhciBjb25zb2xlID0gKHdpbmRvdy5jb25zb2xlID0gd2luZG93LmNvbnNvbGUgfHwge30pOwoKICAgIHdoaWxlIChsZW5ndGgtLSkgewogICAgICAgIG1ldGhvZCA9IG1ldGhvZHNbbGVuZ3RoXTsKCiAgICAgICAgLy8gT25seSBzdHViIHVuZGVmaW5lZCBtZXRob2RzLgogICAgICAgIGlmICghY29uc29sZVttZXRob2RdKSB7CiAgICAgICAgICAgIGNvbnNvbGVbbWV0aG9kXSA9IG5vb3A7CiAgICAgICAgfQogICAgfQp9KCkpOwoKLy8gUGxhY2UgYW55IGpRdWVyeS9oZWxwZXIgcGx1Z2lucyBpbiBoZXJlLgoKZnVuY3Rpb24gaW5pdEhhbmRsZXIoIF9uYW1lLCBvcGVuZWQgKXsKICAgIHZhciBlbHRfaGFuZGxlciA9ICQoJyMnK19uYW1lKydfaGFuZGxlcicpLAogICAgICAgIGVsdF9ibG9jayA9ICQoJyMnK19uYW1lKTsKICAgIGlmIChvcGVuZWQ9PXVuZGVmaW5lZCB8fCBvcGVuZWQ9PWZhbHNlKSB7CiAgICAgICAgZWx0X2Jsb2NrLmhpZGUoKTsKICAgIH0gZWxzZSB7CiAgICAgICAgZWx0X2hhbmRsZXIuYWRkQ2xhc3MoJ2Rvd24nKTsKICAgIH0KICAgIGVsdF9oYW5kbGVyLmNsaWNrKGZ1bmN0aW9uKCl7IAogICAgICAgIGVsdF9ibG9jay50b2dnbGUoJ3Nsb3cnKTsKICAgICAgICBlbHRfaGFuZGxlci50b2dnbGVDbGFzcygnZG93bicpOwogICAgfSk7Cn0KCmZ1bmN0aW9uIGdldE5ld0xpKCBzdHIgKXsKICAgIHJldHVybiAkKCc8bGkgLz4nKS5odG1sKHN0cik7Cn0KCmZ1bmN0aW9uIGdldE5ld0EoIGhyZWYsIHN0ciApewogICAgcmV0dXJuICQoJzxhIC8+JywgeydocmVmJzpocmVmfSkuaHRtbChzdHIpOwp9CgpmdW5jdGlvbiBnZXROZXdJbmZvSXRlbSggc3RyLCB0aXRsZSwgaHJlZiApewogICAgdmFyIHN0cm9uZyA9ICQoJzxzdHJvbmcgLz4nKS5odG1sKCBocmVmIT09dW5kZWZpbmVkID8gZ2V0TmV3QShocmVmLCBzdHIpIDogc3RyICk7CiAgICByZXR1cm4gZ2V0TmV3TGkoIHRpdGxlKycgOiAnICkuYXBwZW5kKHN0cm9uZyk7Cn0KCmZ1bmN0aW9uIGdldFBsdWdpbk1hbmlmZXN0KCB1cmwsIGNhbGxiYWNrICkgewogICAgJC5hamF4KHVybCwgewogICAgICAgIGVycm9yOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3IpIHsKICAgICAgICAgICAgYWRkTWVzc2FnZSgnQUpBWCBlcnJvciEgWycrdGV4dFN0YXR1cysoZXJyb3IgPyAnIDogJytlcnJvciA6ICcnKSsnXScpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7IGNhbGxiYWNrLmFwcGx5KHRoaXMsIFtkYXRhXSk7IH0KICAgIH0pOwp9CgpmdW5jdGlvbiBnZXRHaXRIdWJDb21taXRzKCBnaXRodWIsIGNhbGxiYWNrICkgewogICAgJC5hamF4KGdpdGh1YisnY29tbWl0cycsIHsKICAgICAgICBtZXRob2Q6ICdHRVQnLAogICAgICAgIGNyb3NzRG9tYWluOiB0cnVlLAogICAgICAgIGRhdGE6IHsgcGFnZTogMSwgcGVyX3BhZ2U6IDUgfSwKICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgIGVycm9yOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3IpIHsKICAgICAgICAgICAgYWRkTWVzc2FnZSgnQUpBWCBlcnJvciEgWycrdGV4dFN0YXR1cysoZXJyb3IgPyAnIDogJytlcnJvciA6ICcnKSsnXScpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhLCB0ZXh0U3RhdHVzLCBqcVhIUikgeyAKICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoPjEgfHwgZGF0YVswXSE9PXVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodGhpcywgW2RhdGFdKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHRoaXMsIFtudWxsXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9KTsKfQoKZnVuY3Rpb24gZ2V0R2l0SHViQnVncyggZ2l0aHViLCBjYWxsYmFjayApIHsKICAgICQuYWpheChnaXRodWIrJ2lzc3VlcycsIHsKICAgICAgICBtZXRob2Q6ICdHRVQnLAogICAgICAgIGNyb3NzRG9tYWluOiB0cnVlLAogICAgICAgIGRhdGE6IHsgcGFnZTogMSwgcGVyX3BhZ2U6IDUgfSwKICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgIGVycm9yOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3IpIHsKICAgICAgICAgICAgYWRkTWVzc2FnZSgnQUpBWCBlcnJvciEgWycrdGV4dFN0YXR1cysoZXJyb3IgPyAnIDogJytlcnJvciA6ICcnKSsnXScpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhLCB0ZXh0U3RhdHVzLCBqcVhIUikgewogICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGg+MSB8fCBkYXRhWzBdIT09dW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseSh0aGlzLCBbZGF0YV0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodGhpcywgW251bGxdKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwp9CgpmdW5jdGlvbiBnZXRVcmxGaWxlbmFtZUFuZFF1ZXJ5KCB1cmwgKXsKICAgIHZhciBmaWxlbmFtZSwgcW0gPSB1cmwubGFzdEluZGV4T2YoJyMnKTsKICAgIGlmIChxbSE9PS0xKSB7IGZpbGVuYW1lID0gdXJsLnN1YnN0cigwLHFtKTsgfQogICAgZWxzZSB7IGZpbGVuYW1lID0gdXJsOyB9CiAgICByZXR1cm4gZmlsZW5hbWUuc3Vic3RyaW5nKGZpbGVuYW1lLmxhc3RJbmRleE9mKCcvJykrMSk7Cn0KCmZ1bmN0aW9uIGdldFVybEZpbGVuYW1lKCB1cmwgKXsKICAgIHZhciBmaWxlbmFtZSwgcW0gPSB1cmwubGFzdEluZGV4T2YoJz8nKTsKICAgIGlmIChxbSE9PS0xKSB7IGZpbGVuYW1lID0gdXJsLnN1YnN0cigwLHFtKTsgfQogICAgZWxzZSB7IGZpbGVuYW1lID0gdXJsOyB9CiAgICByZXR1cm4gZmlsZW5hbWUuc3Vic3RyaW5nKGZpbGVuYW1lLmxhc3RJbmRleE9mKCcvJykrMSk7Cn0KCmZ1bmN0aW9uIGFjdGl2YXRlTWVudUl0ZW0oKSB7CiAgICB2YXIgX2RvbmUgPSBmYWxzZSwKICAgICAgICBxdWVyeSA9IGdldFVybEZpbGVuYW1lQW5kUXVlcnkoIHdpbmRvdy5sb2NhdGlvbi5ocmVmICk7CiAgICAkKCduYXYgbGknKS5lYWNoKGZ1bmN0aW9uKGksbyl7CiAgICAgICAgdmFyIGF0YWcgPSAkKG8pLmZpbmQoJ2EnKS5maXJzdCgpOwogICAgICAgIGlmIChhdGFnKSB7CiAgICAgICAgICAgIGF0YWcuYmluZCgnY2xpY2snLCBmdW5jdGlvbigpewogICAgICAgICAgICAgICAgJCgnbmF2IGxpJykuZWFjaChmdW5jdGlvbihqLHApewogICAgICAgICAgICAgICAgICAgIHZhciBuYXRhZyA9ICQocCkuZmluZCgnYScpLmZpcnN0KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5hdGFnICYmIG5hdGFnLmhhc0NsYXNzKCdhY3RpdmUnKSkgeyBuYXRhZy5yZW1vdmVDbGFzcygnYWN0aXZlJyk7IH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7CiAgICAgICAgICAgICAgICB1cGRhdGVCYWNrbGlua3MoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChhdGFnLmF0dHIoJ2hyZWYnKT09PXF1ZXJ5KSB7CiAgICAgICAgICAgICAgICBhdGFnLmFkZENsYXNzKCdhY3RpdmUnKTsKICAgICAgICAgICAgICAgIF9kb25lID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwogICAgaWYgKCFfZG9uZSkgewogICAgICAgIHZhciBwYWdlID0gZ2V0VXJsRmlsZW5hbWUoIHdpbmRvdy5sb2NhdGlvbi5ocmVmICk7CiAgICAgICAgJCgnbmF2IGxpJykuZWFjaChmdW5jdGlvbihpLG8pewogICAgICAgICAgICB2YXIgYXRhZyA9ICQobykuZmluZCgnYScpLmZpcnN0KCk7CiAgICAgICAgICAgIGlmIChhdGFnICYmIGF0YWcuYXR0cignaHJlZicpPT09cGFnZSkgeyBhdGFnLmFkZENsYXNzKCdhY3RpdmUnKTsgfQogICAgICAgIH0pOwogICAgfQp9CgpmdW5jdGlvbiBnZXRUb0hhc2goKXsKICAgIHZhciBfaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOwogICAgaWYgKF9oYXNoIT09dW5kZWZpbmVkKSB7CiAgICAgICAgdmFyIGhhc2ggPSAkKCcjJytfaGFzaC5yZXBsYWNlKCcjJywgJycpKTsKICAgICAgICBpZiAoaGFzaC5sZW5ndGgpIHsKICAgICAgICAgICAgdmFyIHBveiA9IGhhc2gucG9zaXRpb24oKTsKICAgICAgICAgICAgJCgiaHRtbDpub3QoOmFuaW1hdGVkKSxib2R5Om5vdCg6YW5pbWF0ZWQpIikuYW5pbWF0ZSh7IHNjcm9sbFRvcDogcG96LnRvcCB9KTsKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIHVwZGF0ZUJhY2tsaW5rcygpIHsKICAgICQoJyNzaG9ydF9tZW51JykuaHRtbCggJCgnI25hdmlnYXRpb25fbWVudScpLmh0bWwoKSApOwp9CgpmdW5jdGlvbiBpbml0QmFja2xpbmtzKCl7CiAgICAkKCcjc2hvcnRfbmF2aWdhdGlvbicpLmhpZGUoKTsKICAgICQoJyNzaG9ydF9tZW51JykuaGlkZSgpOwogICAgJCgnI3Nob3J0X21lbnVfaGFuZGxlcicpLmJpbmQoJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCl7CiAgICAgICAgdmFyIHNob3J0X21lbnUgPSAkKCcjc2hvcnRfbWVudScpLAogICAgICAgICAgICBzaG9ydF9tZW51X2xuID0gJCgnI3Nob3J0X21lbnUnKS5odG1sKCkubGVuZ3RoOwogICAgICAgIHVwZGF0ZUJhY2tsaW5rcygpOwogICAgICAgICQoJyNzaG9ydF9tZW51JykuZmFkZUluKCdzbG93JywgZnVuY3Rpb24oKXsKICAgICAgICAgICAgJCgnI3Nob3J0X25hdmlnYXRpb24nKS5iaW5kKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24oKXsgJCgnI3Nob3J0X21lbnUnKS5mYWRlT3V0KCdzbG93Jyk7IH0pOwogICAgICAgIH0pOwogICAgfSk7CiAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCl7CiAgICAgICAgdmFyIG5hdiA9ICQoJ25hdicpLAogICAgICAgICAgICBuYXZfcG96ID0gbmF2LnBvc2l0aW9uKCk7CiAgICAgICAgaWYgKChuYXZfcG96LnRvcCskKCduYXYnKS5oZWlnaHQoKSkgPCAkKHdpbmRvdykuc2Nyb2xsVG9wKCkpIHsKICAgICAgICAgICAgJCgnI3Nob3J0X25hdmlnYXRpb24nKS5mYWRlSW4oJ3Nsb3cnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkKCcjc2hvcnRfbmF2aWdhdGlvbicpLmZhZGVPdXQoJ3Nsb3cnKTsKICAgICAgICB9CiAgICB9KTsKfQoKZnVuY3Rpb24gYWRkQ1NTVmFsaWRhdG9yTGluayggY3NzX2ZpbGVuYW1lICl7CiAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWYsCiAgICAgICAgY3NzZmlsZSA9IHVybC5yZXBsYWNlKC8oLiopXC8uKihcLmh0bWwkKS9pLCAnJDEvJytjc3NfZmlsZW5hbWUpOwogICAgJCgnI2Zvb3RlciBhI2Nzc192YWxpZGF0aW9uJykuYXR0cignaHJlZicsICdodHRwOi8vamlnc2F3LnczLm9yZy9jc3MtdmFsaWRhdG9yL3ZhbGlkYXRvcj91cmk9JytlbmNvZGVVUklDb21wb25lbnQoY3NzZmlsZSkpOwp9CgpmdW5jdGlvbiBhZGRIVE1MVmFsaWRhdG9yTGluayggdXJsICl7CiAgICBpZiAodXJsPT09dW5kZWZpbmVkIHx8IHVybD09PW51bGwpIHsgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOyB9CiAgICAkKCcjZm9vdGVyIGEjaHRtbF92YWxpZGF0aW9uJykuYXR0cignaHJlZicsICdodHRwOi8vaHRtbDUudmFsaWRhdG9yLm51Lz9zaG93aW1hZ2VyZXBvcnQ9eWVzJnNob3dzb3VyY2U9eWVzJmRvYz0nK2VuY29kZVVSSUNvbXBvbmVudCh1cmwpKTsKfQoKdmFyIEZvb3ROb3Rlc1N0YWNrID0gW107CmZ1bmN0aW9uIGJ1aWxkRm9vdE5vdGVzKCl7CiAgICB2YXIgYmxfc3VwID0gJCgnPHN1cCAvPicpLAogICAgICAgIGJsX2FfaGRsciA9ICQoJzxhIC8+JywgeyAnY2xhc3MnOidmb290bm90ZV9saW5rJywgJ3RpdGxlJzonU2VlIGZvb3Rub3RlJyB9KSwKICAgICAgICBibF9hX2JhY2sgPSAkKCc8YSAvPicsIHsgJ2NsYXNzJzonZm9vdG5vdGVfbGluaycsICd0aXRsZSc6J0JhY2sgaW4gY29udGVudCcgfSkuaHRtbCgnJiM4NjE3OycpLAogICAgICAgIGJsX25vdGUgPSAkKCc8bGkgLz4nKTsKICAgICQoJy5ub3RlJykuZWFjaChmdW5jdGlvbihpLG8pewogICAgICAgIHZhciByZWYgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtbm90ZXJlZicpLCBoZGxyX2lkLCBub3RlX2lkOwogICAgICAgIGlmICgkLmluQXJyYXkocmVmLCBGb290Tm90ZXNTdGFjaykhPT0tMSkgewogICAgICAgICAgICB2YXIgaiA9IHBhcnNlSW50KCQuaW5BcnJheShyZWYsIEZvb3ROb3Rlc1N0YWNrKSsxKTsKICAgICAgICAgICAgaGRscl9pZCA9ICdub3RlXycraisnX2ludGV4dCc7CiAgICAgICAgICAgIG5vdGVfaWQgPSAnbm90ZV8nK2o7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICB2YXIgaiA9IHBhcnNlSW50KEZvb3ROb3Rlc1N0YWNrLmxlbmd0aCsxKSwKICAgICAgICAgICAgICAgIG5vdGVfY3R0ID0gJCh0aGlzKS5odG1sKCksCiAgICAgICAgICAgICAgICBub3RlX2l0ZW0gPSBibF9ub3RlLmNsb25lKCksCiAgICAgICAgICAgICAgICBub3RlX2JhY2sgPSBibF9hX2JhY2suY2xvbmUoKTsKICAgICAgICAgICAgaGRscl9pZCA9ICdub3RlXycraisnX2ludGV4dCc7CiAgICAgICAgICAgIG5vdGVfaWQgPSAnbm90ZV8nK2o7CiAgICAgICAgICAgIG5vdGVfYmFjay5hdHRyKCdocmVmJywgJyMnK2hkbHJfaWQpOwogICAgICAgICAgICBub3RlX2l0ZW0uYXR0cignaWQnLCBub3RlX2lkKTsKICAgICAgICAgICAgbm90ZV9pdGVtLmh0bWwobm90ZV9jdHQrJyZuYnNwOycpOwogICAgICAgICAgICBub3RlX2l0ZW0uYXBwZW5kKG5vdGVfYmFjayk7CiAgICAgICAgICAgICQoJyNmb290bm90ZXNfbGlzdCcpLmFwcGVuZChub3RlX2l0ZW0pOwogICAgICAgICAgICBGb290Tm90ZXNTdGFjay5wdXNoKHJlZiB8fCBqKTsKICAgICAgICB9CiAgICAgICAgdmFyIG5vdGVfaGRsciA9IGJsX2FfaGRsci5jbG9uZSgpLAogICAgICAgICAgICBub3RlX3N1cCA9IGJsX3N1cC5jbG9uZSgpOwogICAgICAgIG5vdGVfaGRsci5hdHRyKCdocmVmJywgJyMnK25vdGVfaWQpOwogICAgICAgIG5vdGVfaGRsci5hdHRyKCdpZCcsIGhkbHJfaWQpOwogICAgICAgIG5vdGVfaGRsci5odG1sKGopOwogICAgICAgIG5vdGVfc3VwLmFwcGVuZChub3RlX2hkbHIpOwogICAgICAgICQodGhpcykucmVwbGFjZVdpdGgobm90ZV9zdXApOwogICAgfSk7Cn0KCmZ1bmN0aW9uIGFkZE1lc3NhZ2UoIHN0ciApewogICAgdmFyIG1zZyA9ICQoJzxzcGFuIC8+JykuaHRtbChzdHIpLAogICAgICAgIG1zZ2JveCA9ICQoJyNtZXNzYWdlX2JveCcpOwogICAgbXNnYm94LmFwcGVuZChtc2cpOwogICAgaWYgKCFtc2dib3guaXMoJzp2aXNpYmxlJykpIHsgbXNnYm94LnNob3coMTAwMCk7IH0KICAgIG1zZ2JveC5kZWxheSg1MDAwKS5oaWRlKDEwMDApOwp9Cg==",
                "body": "LyogU2NyaXB0cyBmb3IgZGVtbyAqLwoKLy8gQXZvaWQgYGNvbnNvbGVgIGVycm9ycyBpbiBicm93c2VycyB0aGF0IGxhY2sgYSBjb25zb2xlLgooZnVuY3Rpb24oKSB7CiAgICB2YXIgbWV0aG9kOwogICAgdmFyIG5vb3AgPSBmdW5jdGlvbiAoKSB7fTsKICAgIHZhciBtZXRob2RzID0gWwogICAgICAgICdhc3NlcnQnLCAnY2xlYXInLCAnY291bnQnLCAnZGVidWcnLCAnZGlyJywgJ2RpcnhtbCcsICdlcnJvcicsCiAgICAgICAgJ2V4Y2VwdGlvbicsICdncm91cCcsICdncm91cENvbGxhcHNlZCcsICdncm91cEVuZCcsICdpbmZvJywgJ2xvZycsCiAgICAgICAgJ21hcmtUaW1lbGluZScsICdwcm9maWxlJywgJ3Byb2ZpbGVFbmQnLCAndGFibGUnLCAndGltZScsICd0aW1lRW5kJywKICAgICAgICAndGltZVN0YW1wJywgJ3RyYWNlJywgJ3dhcm4nCiAgICBdOwogICAgdmFyIGxlbmd0aCA9IG1ldGhvZHMubGVuZ3RoOwogICAgdmFyIGNvbnNvbGUgPSAod2luZG93LmNvbnNvbGUgPSB3aW5kb3cuY29uc29sZSB8fCB7fSk7CgogICAgd2hpbGUgKGxlbmd0aC0tKSB7CiAgICAgICAgbWV0aG9kID0gbWV0aG9kc1tsZW5ndGhdOwoKICAgICAgICAvLyBPbmx5IHN0dWIgdW5kZWZpbmVkIG1ldGhvZHMuCiAgICAgICAgaWYgKCFjb25zb2xlW21ldGhvZF0pIHsKICAgICAgICAgICAgY29uc29sZVttZXRob2RdID0gbm9vcDsKICAgICAgICB9CiAgICB9Cn0oKSk7CgovLyBQbGFjZSBhbnkgalF1ZXJ5L2hlbHBlciBwbHVnaW5zIGluIGhlcmUuCgpmdW5jdGlvbiBpbml0SGFuZGxlciggX25hbWUsIG9wZW5lZCApewogICAgdmFyIGVsdF9oYW5kbGVyID0gJCgnIycrX25hbWUrJ19oYW5kbGVyJyksCiAgICAgICAgZWx0X2Jsb2NrID0gJCgnIycrX25hbWUpOwogICAgaWYgKG9wZW5lZD09dW5kZWZpbmVkIHx8IG9wZW5lZD09ZmFsc2UpIHsKICAgICAgICBlbHRfYmxvY2suaGlkZSgpOwogICAgfSBlbHNlIHsKICAgICAgICBlbHRfaGFuZGxlci5hZGRDbGFzcygnZG93bicpOwogICAgfQogICAgZWx0X2hhbmRsZXIuY2xpY2soZnVuY3Rpb24oKXsgCiAgICAgICAgZWx0X2Jsb2NrLnRvZ2dsZSgnc2xvdycpOwogICAgICAgIGVsdF9oYW5kbGVyLnRvZ2dsZUNsYXNzKCdkb3duJyk7CiAgICB9KTsKfQoKZnVuY3Rpb24gZ2V0TmV3TGkoIHN0ciApewogICAgcmV0dXJuICQoJzxsaSAvPicpLmh0bWwoc3RyKTsKfQoKZnVuY3Rpb24gZ2V0TmV3QSggaHJlZiwgc3RyICl7CiAgICByZXR1cm4gJCgnPGEgLz4nLCB7J2hyZWYnOmhyZWZ9KS5odG1sKHN0cik7Cn0KCmZ1bmN0aW9uIGdldE5ld0luZm9JdGVtKCBzdHIsIHRpdGxlLCBocmVmICl7CiAgICB2YXIgc3Ryb25nID0gJCgnPHN0cm9uZyAvPicpLmh0bWwoIGhyZWYhPT11bmRlZmluZWQgPyBnZXROZXdBKGhyZWYsIHN0cikgOiBzdHIgKTsKICAgIHJldHVybiBnZXROZXdMaSggdGl0bGUrJyA6ICcgKS5hcHBlbmQoc3Ryb25nKTsKfQoKZnVuY3Rpb24gZ2V0UGx1Z2luTWFuaWZlc3QoIHVybCwgY2FsbGJhY2sgKSB7CiAgICAkLmFqYXgodXJsLCB7CiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvcikgewogICAgICAgICAgICBhZGRNZXNzYWdlKCdBSkFYIGVycm9yISBbJyt0ZXh0U3RhdHVzKyhlcnJvciA/ICcgOiAnK2Vycm9yIDogJycpKyddJyk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9LAogICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsgY2FsbGJhY2suYXBwbHkodGhpcywgW2RhdGFdKTsgfQogICAgfSk7Cn0KCmZ1bmN0aW9uIGdldEdpdEh1YkNvbW1pdHMoIGdpdGh1YiwgY2FsbGJhY2sgKSB7CiAgICAkLmFqYXgoZ2l0aHViKydjb21taXRzJywgewogICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgY3Jvc3NEb21haW46IHRydWUsCiAgICAgICAgZGF0YTogeyBwYWdlOiAxLCBwZXJfcGFnZTogNSB9LAogICAgICAgIGRhdGFUeXBlOiAnanNvbicsCiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvcikgewogICAgICAgICAgICBhZGRNZXNzYWdlKCdBSkFYIGVycm9yISBbJyt0ZXh0U3RhdHVzKyhlcnJvciA/ICcgOiAnK2Vycm9yIDogJycpKyddJyk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9LAogICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIGpxWEhSKSB7IAogICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGg+MSB8fCBkYXRhWzBdIT09dW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseSh0aGlzLCBbZGF0YV0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodGhpcywgW251bGxdKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwp9CgpmdW5jdGlvbiBnZXRHaXRIdWJCdWdzKCBnaXRodWIsIGNhbGxiYWNrICkgewogICAgJC5hamF4KGdpdGh1YisnaXNzdWVzJywgewogICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgY3Jvc3NEb21haW46IHRydWUsCiAgICAgICAgZGF0YTogeyBwYWdlOiAxLCBwZXJfcGFnZTogNSB9LAogICAgICAgIGRhdGFUeXBlOiAnanNvbicsCiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvcikgewogICAgICAgICAgICBhZGRNZXNzYWdlKCdBSkFYIGVycm9yISBbJyt0ZXh0U3RhdHVzKyhlcnJvciA/ICcgOiAnK2Vycm9yIDogJycpKyddJyk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9LAogICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIGpxWEhSKSB7CiAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aD4xIHx8IGRhdGFbMF0hPT11bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHRoaXMsIFtkYXRhXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseSh0aGlzLCBbbnVsbF0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSk7Cn0KCmZ1bmN0aW9uIGdldFVybEZpbGVuYW1lQW5kUXVlcnkoIHVybCApewogICAgdmFyIGZpbGVuYW1lLCBxbSA9IHVybC5sYXN0SW5kZXhPZignIycpOwogICAgaWYgKHFtIT09LTEpIHsgZmlsZW5hbWUgPSB1cmwuc3Vic3RyKDAscW0pOyB9CiAgICBlbHNlIHsgZmlsZW5hbWUgPSB1cmw7IH0KICAgIHJldHVybiBmaWxlbmFtZS5zdWJzdHJpbmcoZmlsZW5hbWUubGFzdEluZGV4T2YoJy8nKSsxKTsKfQoKZnVuY3Rpb24gZ2V0VXJsRmlsZW5hbWUoIHVybCApewogICAgdmFyIGZpbGVuYW1lLCBxbSA9IHVybC5sYXN0SW5kZXhPZignPycpOwogICAgaWYgKHFtIT09LTEpIHsgZmlsZW5hbWUgPSB1cmwuc3Vic3RyKDAscW0pOyB9CiAgICBlbHNlIHsgZmlsZW5hbWUgPSB1cmw7IH0KICAgIHJldHVybiBmaWxlbmFtZS5zdWJzdHJpbmcoZmlsZW5hbWUubGFzdEluZGV4T2YoJy8nKSsxKTsKfQoKZnVuY3Rpb24gYWN0aXZhdGVNZW51SXRlbSgpIHsKICAgIHZhciBfZG9uZSA9IGZhbHNlLAogICAgICAgIHF1ZXJ5ID0gZ2V0VXJsRmlsZW5hbWVBbmRRdWVyeSggd2luZG93LmxvY2F0aW9uLmhyZWYgKTsKICAgICQoJ25hdiBsaScpLmVhY2goZnVuY3Rpb24oaSxvKXsKICAgICAgICB2YXIgYXRhZyA9ICQobykuZmluZCgnYScpLmZpcnN0KCk7CiAgICAgICAgaWYgKGF0YWcpIHsKICAgICAgICAgICAgYXRhZy5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAkKCduYXYgbGknKS5lYWNoKGZ1bmN0aW9uKGoscCl7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5hdGFnID0gJChwKS5maW5kKCdhJykuZmlyc3QoKTsKICAgICAgICAgICAgICAgICAgICBpZiAobmF0YWcgJiYgbmF0YWcuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7IG5hdGFnLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTsgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTsKICAgICAgICAgICAgICAgIHVwZGF0ZUJhY2tsaW5rcygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKGF0YWcuYXR0cignaHJlZicpPT09cXVlcnkpIHsKICAgICAgICAgICAgICAgIGF0YWcuYWRkQ2xhc3MoJ2FjdGl2ZScpOwogICAgICAgICAgICAgICAgX2RvbmUgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSk7CiAgICBpZiAoIV9kb25lKSB7CiAgICAgICAgdmFyIHBhZ2UgPSBnZXRVcmxGaWxlbmFtZSggd2luZG93LmxvY2F0aW9uLmhyZWYgKTsKICAgICAgICAkKCduYXYgbGknKS5lYWNoKGZ1bmN0aW9uKGksbyl7CiAgICAgICAgICAgIHZhciBhdGFnID0gJChvKS5maW5kKCdhJykuZmlyc3QoKTsKICAgICAgICAgICAgaWYgKGF0YWcgJiYgYXRhZy5hdHRyKCdocmVmJyk9PT1wYWdlKSB7IGF0YWcuYWRkQ2xhc3MoJ2FjdGl2ZScpOyB9CiAgICAgICAgfSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGdldFRvSGFzaCgpewogICAgdmFyIF9oYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2g7CiAgICBpZiAoX2hhc2ghPT11bmRlZmluZWQpIHsKICAgICAgICB2YXIgaGFzaCA9ICQoJyMnK19oYXNoLnJlcGxhY2UoJyMnLCAnJykpOwogICAgICAgIGlmIChoYXNoLmxlbmd0aCkgewogICAgICAgICAgICB2YXIgcG96ID0gaGFzaC5wb3NpdGlvbigpOwogICAgICAgICAgICAkKCJodG1sOm5vdCg6YW5pbWF0ZWQpLGJvZHk6bm90KDphbmltYXRlZCkiKS5hbmltYXRlKHsgc2Nyb2xsVG9wOiBwb3oudG9wIH0pOwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gdXBkYXRlQmFja2xpbmtzKCkgewogICAgJCgnI3Nob3J0X21lbnUnKS5odG1sKCAkKCcjbmF2aWdhdGlvbl9tZW51JykuaHRtbCgpICk7Cn0KCmZ1bmN0aW9uIGluaXRCYWNrbGlua3MoKXsKICAgICQoJyNzaG9ydF9uYXZpZ2F0aW9uJykuaGlkZSgpOwogICAgJCgnI3Nob3J0X21lbnUnKS5oaWRlKCk7CiAgICAkKCcjc2hvcnRfbWVudV9oYW5kbGVyJykuYmluZCgnbW91c2VvdmVyJywgZnVuY3Rpb24oKXsKICAgICAgICB2YXIgc2hvcnRfbWVudSA9ICQoJyNzaG9ydF9tZW51JyksCiAgICAgICAgICAgIHNob3J0X21lbnVfbG4gPSAkKCcjc2hvcnRfbWVudScpLmh0bWwoKS5sZW5ndGg7CiAgICAgICAgdXBkYXRlQmFja2xpbmtzKCk7CiAgICAgICAgJCgnI3Nob3J0X21lbnUnKS5mYWRlSW4oJ3Nsb3cnLCBmdW5jdGlvbigpewogICAgICAgICAgICAkKCcjc2hvcnRfbmF2aWdhdGlvbicpLmJpbmQoJ21vdXNlbGVhdmUnLCBmdW5jdGlvbigpeyAkKCcjc2hvcnRfbWVudScpLmZhZGVPdXQoJ3Nsb3cnKTsgfSk7CiAgICAgICAgfSk7CiAgICB9KTsKICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKXsKICAgICAgICB2YXIgbmF2ID0gJCgnbmF2JyksCiAgICAgICAgICAgIG5hdl9wb3ogPSBuYXYucG9zaXRpb24oKTsKICAgICAgICBpZiAoKG5hdl9wb3oudG9wKyQoJ25hdicpLmhlaWdodCgpKSA8ICQod2luZG93KS5zY3JvbGxUb3AoKSkgewogICAgICAgICAgICAkKCcjc2hvcnRfbmF2aWdhdGlvbicpLmZhZGVJbignc2xvdycpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICQoJyNzaG9ydF9uYXZpZ2F0aW9uJykuZmFkZU91dCgnc2xvdycpOwogICAgICAgIH0KICAgIH0pOwp9CgpmdW5jdGlvbiBhZGRDU1NWYWxpZGF0b3JMaW5rKCBjc3NfZmlsZW5hbWUgKXsKICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZiwKICAgICAgICBjc3NmaWxlID0gdXJsLnJlcGxhY2UoLyguKilcLy4qKFwuaHRtbCQpL2ksICckMS8nK2Nzc19maWxlbmFtZSk7CiAgICAkKCcjZm9vdGVyIGEjY3NzX3ZhbGlkYXRpb24nKS5hdHRyKCdocmVmJywgJ2h0dHA6Ly9qaWdzYXcudzMub3JnL2Nzcy12YWxpZGF0b3IvdmFsaWRhdG9yP3VyaT0nK2VuY29kZVVSSUNvbXBvbmVudChjc3NmaWxlKSk7Cn0KCmZ1bmN0aW9uIGFkZEhUTUxWYWxpZGF0b3JMaW5rKCB1cmwgKXsKICAgIGlmICh1cmw9PT11bmRlZmluZWQgfHwgdXJsPT09bnVsbCkgeyB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7IH0KICAgICQoJyNmb290ZXIgYSNodG1sX3ZhbGlkYXRpb24nKS5hdHRyKCdocmVmJywgJ2h0dHA6Ly9odG1sNS52YWxpZGF0b3IubnUvP3Nob3dpbWFnZXJlcG9ydD15ZXMmc2hvd3NvdXJjZT15ZXMmZG9jPScrZW5jb2RlVVJJQ29tcG9uZW50KHVybCkpOwp9Cgp2YXIgRm9vdE5vdGVzU3RhY2sgPSBbXTsKZnVuY3Rpb24gYnVpbGRGb290Tm90ZXMoKXsKICAgIHZhciBibF9zdXAgPSAkKCc8c3VwIC8+JyksCiAgICAgICAgYmxfYV9oZGxyID0gJCgnPGEgLz4nLCB7ICdjbGFzcyc6J2Zvb3Rub3RlX2xpbmsnLCAndGl0bGUnOidTZWUgZm9vdG5vdGUnIH0pLAogICAgICAgIGJsX2FfYmFjayA9ICQoJzxhIC8+JywgeyAnY2xhc3MnOidmb290bm90ZV9saW5rJywgJ3RpdGxlJzonQmFjayBpbiBjb250ZW50JyB9KS5odG1sKCcmIzg2MTc7JyksCiAgICAgICAgYmxfbm90ZSA9ICQoJzxsaSAvPicpOwogICAgJCgnLm5vdGUnKS5lYWNoKGZ1bmN0aW9uKGksbyl7CiAgICAgICAgdmFyIHJlZiA9ICQodGhpcykuYXR0cignZGF0YS1ub3RlcmVmJyksIGhkbHJfaWQsIG5vdGVfaWQ7CiAgICAgICAgaWYgKCQuaW5BcnJheShyZWYsIEZvb3ROb3Rlc1N0YWNrKSE9PS0xKSB7CiAgICAgICAgICAgIHZhciBqID0gcGFyc2VJbnQoJC5pbkFycmF5KHJlZiwgRm9vdE5vdGVzU3RhY2spKzEpOwogICAgICAgICAgICBoZGxyX2lkID0gJ25vdGVfJytqKydfaW50ZXh0JzsKICAgICAgICAgICAgbm90ZV9pZCA9ICdub3RlXycrajsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHZhciBqID0gcGFyc2VJbnQoRm9vdE5vdGVzU3RhY2subGVuZ3RoKzEpLAogICAgICAgICAgICAgICAgbm90ZV9jdHQgPSAkKHRoaXMpLmh0bWwoKSwKICAgICAgICAgICAgICAgIG5vdGVfaXRlbSA9IGJsX25vdGUuY2xvbmUoKSwKICAgICAgICAgICAgICAgIG5vdGVfYmFjayA9IGJsX2FfYmFjay5jbG9uZSgpOwogICAgICAgICAgICBoZGxyX2lkID0gJ25vdGVfJytqKydfaW50ZXh0JzsKICAgICAgICAgICAgbm90ZV9pZCA9ICdub3RlXycrajsKICAgICAgICAgICAgbm90ZV9iYWNrLmF0dHIoJ2hyZWYnLCAnIycraGRscl9pZCk7CiAgICAgICAgICAgIG5vdGVfaXRlbS5hdHRyKCdpZCcsIG5vdGVfaWQpOwogICAgICAgICAgICBub3RlX2l0ZW0uaHRtbChub3RlX2N0dCsnJm5ic3A7Jyk7CiAgICAgICAgICAgIG5vdGVfaXRlbS5hcHBlbmQobm90ZV9iYWNrKTsKICAgICAgICAgICAgJCgnI2Zvb3Rub3Rlc19saXN0JykuYXBwZW5kKG5vdGVfaXRlbSk7CiAgICAgICAgICAgIEZvb3ROb3Rlc1N0YWNrLnB1c2gocmVmIHx8IGopOwogICAgICAgIH0KICAgICAgICB2YXIgbm90ZV9oZGxyID0gYmxfYV9oZGxyLmNsb25lKCksCiAgICAgICAgICAgIG5vdGVfc3VwID0gYmxfc3VwLmNsb25lKCk7CiAgICAgICAgbm90ZV9oZGxyLmF0dHIoJ2hyZWYnLCAnIycrbm90ZV9pZCk7CiAgICAgICAgbm90ZV9oZGxyLmF0dHIoJ2lkJywgaGRscl9pZCk7CiAgICAgICAgbm90ZV9oZGxyLmh0bWwoaik7CiAgICAgICAgbm90ZV9zdXAuYXBwZW5kKG5vdGVfaGRscik7CiAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChub3RlX3N1cCk7CiAgICB9KTsKfQoKZnVuY3Rpb24gYWRkTWVzc2FnZSggc3RyICl7CiAgICB2YXIgbXNnID0gJCgnPHNwYW4gLz4nKS5odG1sKHN0ciksCiAgICAgICAgbXNnYm94ID0gJCgnI21lc3NhZ2VfYm94Jyk7CiAgICBtc2dib3guYXBwZW5kKG1zZyk7CiAgICBpZiAoIW1zZ2JveC5pcygnOnZpc2libGUnKSkgeyBtc2dib3guc2hvdygxMDAwKTsgfQogICAgbXNnYm94LmRlbGF5KDUwMDApLmhpZGUoMTAwMCk7Cn0K",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 10:47:50 GMT",
                    "Content-Length": "7830",
                    "Date": "Thu, 06 Nov 2014 10:47:51 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}