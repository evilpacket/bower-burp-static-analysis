{
    "url": "http://localhost:9999/bitovi/canjs.com/can.route.pushstate.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>window.location.hash</b> and written to <b>window.history.pushState()</b> via the following statements:<ul><li>path += window.location.hash;</li><li>window.history.pushState(null, null, can.route._call(\"root\") + path);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/bitovi/canjs.com/can.route.pushstate.js",
                "path": "/bitovi/canjs.com/can.route.pushstate.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9iaXRvdmkvY2FuanMuY29tL2Nhbi5yb3V0ZS5wdXNoc3RhdGUuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjcyMw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAxNDozNzoyNiBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMTQ6Mzc6MjEgR01UDQoNCi8qIQogKiBDYW5KUyAtIDIuMS4zCiAqIGh0dHA6Ly9jYW5qcy51cy8KICogQ29weXJpZ2h0IChjKSAyMDE0IEJpdG92aQogKiBNb24sIDI1IEF1ZyAyMDE0IDIxOjUxOjM4IEdNVAogKiBMaWNlbnNlZCBNSVQKICogSW5jbHVkZXM6IGNhbi9yb3V0ZS9wdXNoc3RhdGUKICogRG93bmxvYWQgZnJvbTogaHR0cDovL2NhbmpzLmNvbQogKi8KKGZ1bmN0aW9uKHVuZGVmaW5lZCkgewoKICAgIC8vICMjIHJvdXRlL3B1c2hzdGF0ZS9wdXNoc3RhdGUuanMKICAgIHZhciBfX20xID0gKGZ1bmN0aW9uKGNhbikgewogICAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgICAgLy8gSW5pdGlhbGl6ZSBwbHVnaW4gb25seSBpZiBicm93c2VyIHN1cHBvcnRzIHB1c2hzdGF0ZS4KICAgICAgICBpZiAod2luZG93Lmhpc3RvcnkgJiYgaGlzdG9yeS5wdXNoU3RhdGUpIHsKCiAgICAgICAgICAgIC8vIFJlZ2lzdGVycyBpdHNlbGYgd2l0aGluIGBjYW4ucm91dGUuYmluZGluZ3NgLgogICAgICAgICAgICBjYW4ucm91dGUuYmluZGluZ3MucHVzaHN0YXRlID0gewoKCiAgICAgICAgICAgICAgICAvLyBTdGFydCBvZiBgbG9jYXRpb24ucGF0aG5hbWVgIGlzIHRoZSByb290LgogICAgICAgICAgICAgICAgLy8gKENhbiBiZSBjb25maWd1cmVkIHZpYSBgY2FuLnJvdXRlLmJpbmRpbmdzLnB1c2hzdGF0ZS5yb290YCkKICAgICAgICAgICAgICAgIHJvb3Q6ICIvIiwKICAgICAgICAgICAgICAgIC8vIGRvbid0IGdyZWVkaWx5IG1hdGNoIHNsYXNoZXMgaW4gcm91dGluZyBydWxlcwogICAgICAgICAgICAgICAgbWF0Y2hTbGFzaGVzOiBmYWxzZSwKICAgICAgICAgICAgICAgIHBhcmFtc01hdGNoZXI6IC9eXD8oPzpbXj1dKz1bXiZdKiYpKltePV0rPVteJl0qLywKICAgICAgICAgICAgICAgIHF1ZXJ5U2VwYXJhdG9yOiAnPycsCgogICAgICAgICAgICAgICAgLy8gIyMgYmluZAoKICAgICAgICAgICAgICAgIC8vIEludGVyY2VwdHMgY2xpY2tzIG9uIGA8YT5gIGVsZW1lbnRzIGFuZCByZXdyaXRlcyBvcmlnaW5hbCBgaGlzdG9yeWAgbWV0aG9kcy4KICAgICAgICAgICAgICAgIGJpbmQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIC8vIEludGVyY2VwdCByb3V0YWJsZSBsaW5rcy4KICAgICAgICAgICAgICAgICAgICBjYW4uZGVsZWdhdGUuY2FsbChjYW4uJChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLCAnYScsICdjbGljaycsIGFuY2hvckNsaWNrSGFuZGxlcik7CgogICAgICAgICAgICAgICAgICAgIC8vIFJld3JpdGVzIG9yaWdpbmFsIGBwdXNoU3RhdGVgL2ByZXBsYWNlU3RhdGVgIG1ldGhvZHMgb24gYGhpc3RvcnlgIGFuZCBrZWVwcyBwb2ludGVyIHRvIG9yaWdpbmFsIG1ldGhvZHMKICAgICAgICAgICAgICAgICAgICBjYW4uZWFjaChtZXRob2RzVG9PdmVyd3JpdGUsIGZ1bmN0aW9uKG1ldGhvZCkgewogICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbE1ldGhvZHNbbWV0aG9kXSA9IHdpbmRvdy5oaXN0b3J5W21ldGhvZF07CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5W21ldGhvZF0gPSBmdW5jdGlvbihzdGF0ZSwgdGl0bGUsIHVybCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXZvaWQgZG91YmxlZCBoaXN0b3J5IHN0YXRlcyAod2l0aCBwdXNoU3RhdGUpLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFic29sdXRlID0gdXJsLmluZGV4T2YoImh0dHAiKSA9PT0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWFyY2hIYXNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaCArIHdpbmRvdy5sb2NhdGlvbi5oYXNoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdXJsIGRpZmZlcnMgZnJvbSBjdXJyZW50IGNhbGwgb3JpZ2luYWwgaGlzdG95IG1ldGhvZCBhbmQgdXBkYXRlIGBjYW4ucm91dGVgIHN0YXRlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCghYWJzb2x1dGUgJiYgdXJsICE9PSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgKyBzZWFyY2hIYXNoKSB8fCAoYWJzb2x1dGUgJiYgdXJsICE9PSB3aW5kb3cubG9jYXRpb24uaHJlZiArIHNlYXJjaEhhc2gpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxNZXRob2RzW21ldGhvZF0uYXBwbHkod2luZG93Lmhpc3RvcnksIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuLnJvdXRlLnNldFN0YXRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIC8vIEJpbmQgdG8gYHBvcHN0YXRlYCBldmVudCwgZmlyZXMgb24gYmFjay9mb3J3YXJkLgogICAgICAgICAgICAgICAgICAgIGNhbi5iaW5kLmNhbGwod2luZG93LCAncG9wc3RhdGUnLCBjYW4ucm91dGUuc2V0U3RhdGUpOwogICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICAvLyAjIyB1bmJpbmQKCiAgICAgICAgICAgICAgICAvLyBVbmJpbmRzIGFuZCByZXN0b3JlcyBvcmlnaW5hbCBgaGlzdG9yeWAgbWV0aG9kcwogICAgICAgICAgICAgICAgdW5iaW5kOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBjYW4udW5kZWxlZ2F0ZS5jYWxsKGNhbi4kKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCksICdjbGljaycsICdhJywgYW5jaG9yQ2xpY2tIYW5kbGVyKTsKCiAgICAgICAgICAgICAgICAgICAgY2FuLmVhY2gobWV0aG9kc1RvT3ZlcndyaXRlLCBmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lmhpc3RvcnlbbWV0aG9kXSA9IG9yaWdpbmFsTWV0aG9kc1ttZXRob2RdOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGNhbi51bmJpbmQuY2FsbCh3aW5kb3csICdwb3BzdGF0ZScsIGNhbi5yb3V0ZS5zZXRTdGF0ZSk7CiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgIC8vICMjIG1hdGNoaW5nUGFydE9mVVJMCgogICAgICAgICAgICAgICAgLy8gUmV0dXJucyBtYXRjaGluZyBwYXJ0IG9mIHVybCB3aXRob3V0IHJvb3QuCiAgICAgICAgICAgICAgICBtYXRjaGluZ1BhcnRPZlVSTDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJvb3QgPSBjbGVhblJvb3QoKSwKICAgICAgICAgICAgICAgICAgICAgICAgbG9jID0gKGxvY2F0aW9uLnBhdGhuYW1lICsgbG9jYXRpb24uc2VhcmNoKSwKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBsb2MuaW5kZXhPZihyb290KTsKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYy5zdWJzdHIoaW5kZXggKyByb290Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgIC8vICMjIHNldFVSTAoKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZXMgVVJMIGJ5IGNhbGxpbmcgYHB1c2hTdGF0ZWAuCiAgICAgICAgICAgICAgICBzZXRVUkw6IGZ1bmN0aW9uKHBhdGgpIHsKICAgICAgICAgICAgICAgICAgICAvLyBLZWVwcyBoYXNoIGlmIG5vdCBpbiBwYXRoLgogICAgICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlSGFzaCAmJiBwYXRoLmluZGV4T2YoIiMiKSA9PT0gLTEgJiYgd2luZG93LmxvY2F0aW9uLmhhc2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCArPSB3aW5kb3cubG9jYXRpb24uaGFzaDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIGNhbi5yb3V0ZS5fY2FsbCgicm9vdCIpICsgcGF0aCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgogICAgICAgICAgICAvLyAjIyBhbmNob3JDbGlja0hhbmRsZXIKCiAgICAgICAgICAgIC8vIEhhbmRsZXIgZnVuY3Rpb24gZm9yIGBjbGlja2AgZXZlbnRzLgogICAgICAgICAgICB2YXIgYW5jaG9yQ2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgaWYgKCEoZS5pc0RlZmF1bHRQcmV2ZW50ZWQgPyBlLmlzRGVmYXVsdFByZXZlbnRlZCgpIDogZS5kZWZhdWx0UHJldmVudGVkID09PSB0cnVlKSkgewogICAgICAgICAgICAgICAgICAgIC8vIFlVSSBjYWxscyBiYWNrIGV2ZW50cyB0cmlnZ2VyZWQgd2l0aCB0aGlzIGFzIGEgd3JhcHBlZCBvYmplY3QuCiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLl9ub2RlIHx8IHRoaXM7CiAgICAgICAgICAgICAgICAgICAgLy8gRml4IGZvciBJRSBzaG93aW5nIGJsYW5rIGhvc3QsIGJ1dCBibGFuayBob3N0IG1lYW5zIGN1cnJlbnQgaG9zdC4KICAgICAgICAgICAgICAgICAgICB2YXIgbGlua3NIb3N0ID0gbm9kZS5ob3N0IHx8IHdpbmRvdy5sb2NhdGlvbi5ob3N0OwoKICAgICAgICAgICAgICAgICAgICAvLyBJZiBsaW5rIGlzIHdpdGhpbiB0aGUgc2FtZSBkb21haW4gYW5kIGRlc2NlbmRhbnQgb2YgYHJvb3RgCiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ob3N0ID09PSBsaW5rc0hvc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJvb3QgPSBjbGVhblJvb3QoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUucGF0aG5hbWUuaW5kZXhPZihyb290KSA9PT0gMCkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZXMgcm9vdCBmcm9tIHVybC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSAobm9kZS5wYXRobmFtZSArIG5vZGUuc2VhcmNoKS5zdWJzdHIocm9vdC5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgYSByb3V0ZSBtYXRjaGVzIHVwZGF0ZSB0aGUgZGF0YS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJQYXJhbXMgPSBjYW4ucm91dGUuZGVwYXJhbSh1cmwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1clBhcmFtcy5oYXNPd25Qcm9wZXJ0eSgncm91dGUnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1ha2VzIGl0IHBvc3NpYmxlIHRvIGhhdmUgYSBsaW5rIHdpdGggYSBoYXNoLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGVIYXNoID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgbm9kZS5ocmVmKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGVzdCBpZiB5b3UgY2FuIHByZXZlbnREZWZhdWx0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3VyIHRlc3RzIGNhbid0IGNhbGwgLmNsaWNrKCkgYi9jIHRoaXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmcmVlemVzIHBoYW50b20uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICAvLyAjIyBjbGVhblJvb3QKCiAgICAgICAgICAgICAgICAvLyBBbHdheXMgcmV0dXJucyBjbGVhbiByb290LCB3aXRob3V0IGRvbWFpbi4KICAgICAgICAgICAgICAgIGNsZWFuUm9vdCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBkb21haW4gPSBsb2NhdGlvbi5wcm90b2NvbCArICIvLyIgKyBsb2NhdGlvbi5ob3N0LAogICAgICAgICAgICAgICAgICAgICAgICByb290ID0gY2FuLnJvdXRlLl9jYWxsKCJyb290IiksCiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gcm9vdC5pbmRleE9mKGRvbWFpbik7CiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByb290LnN1YnN0cihkb21haW4ubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvb3Q7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgLy8gT3JpZ2luYWwgbWV0aG9kcyBvbiBgaGlzdG9yeWAgdGhhdCB3aWxsIGJlIG92ZXJ3cml0dGVuCiAgICAgICAgICAgICAgICBtZXRob2RzVG9PdmVyd3JpdGUgPSBbJ3B1c2hTdGF0ZScsICdyZXBsYWNlU3RhdGUnXSwKICAgICAgICAgICAgICAgIC8vIEEgcGxhY2UgdG8gc3RvcmUgcG9pbnRlcnMgdG8gb3JpZ2luYWwgYGhpc3RvcnlgIG1ldGhvZHMuCiAgICAgICAgICAgICAgICBvcmlnaW5hbE1ldGhvZHMgPSB7fSwKICAgICAgICAgICAgICAgIC8vIFVzZWQgdG8gdGVsbCBzZXRVUkwgdG8gaW5jbHVkZSB0aGUgaGFzaCBiZWNhdXNlIHdlIGNsaWNrZWQgb24gYSBsaW5rLgogICAgICAgICAgICAgICAgaW5jbHVkZUhhc2ggPSBmYWxzZTsKCiAgICAgICAgICAgIC8vIEVuYWJsZXMgcGx1Z2luLCBieSBkZWZhdWx0IGBoYXNoY2hhbmdlYCBiaW5kaW5nIGlzIHVzZWQuCiAgICAgICAgICAgIGNhbi5yb3V0ZS5kZWZhdWx0QmluZGluZyA9ICJwdXNoc3RhdGUiOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGNhbjsKICAgIH0pKHdpbmRvdy5jYW4sIHVuZGVmaW5lZCk7Cgp9KSgpOw==",
                "body": "LyohCiAqIENhbkpTIC0gMi4xLjMKICogaHR0cDovL2NhbmpzLnVzLwogKiBDb3B5cmlnaHQgKGMpIDIwMTQgQml0b3ZpCiAqIE1vbiwgMjUgQXVnIDIwMTQgMjE6NTE6MzggR01UCiAqIExpY2Vuc2VkIE1JVAogKiBJbmNsdWRlczogY2FuL3JvdXRlL3B1c2hzdGF0ZQogKiBEb3dubG9hZCBmcm9tOiBodHRwOi8vY2FuanMuY29tCiAqLwooZnVuY3Rpb24odW5kZWZpbmVkKSB7CgogICAgLy8gIyMgcm91dGUvcHVzaHN0YXRlL3B1c2hzdGF0ZS5qcwogICAgdmFyIF9fbTEgPSAoZnVuY3Rpb24oY2FuKSB7CiAgICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgICAvLyBJbml0aWFsaXplIHBsdWdpbiBvbmx5IGlmIGJyb3dzZXIgc3VwcG9ydHMgcHVzaHN0YXRlLgogICAgICAgIGlmICh3aW5kb3cuaGlzdG9yeSAmJiBoaXN0b3J5LnB1c2hTdGF0ZSkgewoKICAgICAgICAgICAgLy8gUmVnaXN0ZXJzIGl0c2VsZiB3aXRoaW4gYGNhbi5yb3V0ZS5iaW5kaW5nc2AuCiAgICAgICAgICAgIGNhbi5yb3V0ZS5iaW5kaW5ncy5wdXNoc3RhdGUgPSB7CgoKICAgICAgICAgICAgICAgIC8vIFN0YXJ0IG9mIGBsb2NhdGlvbi5wYXRobmFtZWAgaXMgdGhlIHJvb3QuCiAgICAgICAgICAgICAgICAvLyAoQ2FuIGJlIGNvbmZpZ3VyZWQgdmlhIGBjYW4ucm91dGUuYmluZGluZ3MucHVzaHN0YXRlLnJvb3RgKQogICAgICAgICAgICAgICAgcm9vdDogIi8iLAogICAgICAgICAgICAgICAgLy8gZG9uJ3QgZ3JlZWRpbHkgbWF0Y2ggc2xhc2hlcyBpbiByb3V0aW5nIHJ1bGVzCiAgICAgICAgICAgICAgICBtYXRjaFNsYXNoZXM6IGZhbHNlLAogICAgICAgICAgICAgICAgcGFyYW1zTWF0Y2hlcjogL15cPyg/OltePV0rPVteJl0qJikqW149XSs9W14mXSovLAogICAgICAgICAgICAgICAgcXVlcnlTZXBhcmF0b3I6ICc/JywKCiAgICAgICAgICAgICAgICAvLyAjIyBiaW5kCgogICAgICAgICAgICAgICAgLy8gSW50ZXJjZXB0cyBjbGlja3Mgb24gYDxhPmAgZWxlbWVudHMgYW5kIHJld3JpdGVzIG9yaWdpbmFsIGBoaXN0b3J5YCBtZXRob2RzLgogICAgICAgICAgICAgICAgYmluZDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gSW50ZXJjZXB0IHJvdXRhYmxlIGxpbmtzLgogICAgICAgICAgICAgICAgICAgIGNhbi5kZWxlZ2F0ZS5jYWxsKGNhbi4kKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCksICdhJywgJ2NsaWNrJywgYW5jaG9yQ2xpY2tIYW5kbGVyKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gUmV3cml0ZXMgb3JpZ2luYWwgYHB1c2hTdGF0ZWAvYHJlcGxhY2VTdGF0ZWAgbWV0aG9kcyBvbiBgaGlzdG9yeWAgYW5kIGtlZXBzIHBvaW50ZXIgdG8gb3JpZ2luYWwgbWV0aG9kcwogICAgICAgICAgICAgICAgICAgIGNhbi5lYWNoKG1ldGhvZHNUb092ZXJ3cml0ZSwgZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsTWV0aG9kc1ttZXRob2RdID0gd2luZG93Lmhpc3RvcnlbbWV0aG9kXTsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lmhpc3RvcnlbbWV0aG9kXSA9IGZ1bmN0aW9uKHN0YXRlLCB0aXRsZSwgdXJsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBdm9pZCBkb3VibGVkIGhpc3Rvcnkgc3RhdGVzICh3aXRoIHB1c2hTdGF0ZSkuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWJzb2x1dGUgPSB1cmwuaW5kZXhPZigiaHR0cCIpID09PSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaEhhc2ggPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoICsgd2luZG93LmxvY2F0aW9uLmhhc2g7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB1cmwgZGlmZmVycyBmcm9tIGN1cnJlbnQgY2FsbCBvcmlnaW5hbCBoaXN0b3kgbWV0aG9kIGFuZCB1cGRhdGUgYGNhbi5yb3V0ZWAgc3RhdGUuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKCFhYnNvbHV0ZSAmJiB1cmwgIT09IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSArIHNlYXJjaEhhc2gpIHx8IChhYnNvbHV0ZSAmJiB1cmwgIT09IHdpbmRvdy5sb2NhdGlvbi5ocmVmICsgc2VhcmNoSGFzaCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbE1ldGhvZHNbbWV0aG9kXS5hcHBseSh3aW5kb3cuaGlzdG9yeSwgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW4ucm91dGUuc2V0U3RhdGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgLy8gQmluZCB0byBgcG9wc3RhdGVgIGV2ZW50LCBmaXJlcyBvbiBiYWNrL2ZvcndhcmQuCiAgICAgICAgICAgICAgICAgICAgY2FuLmJpbmQuY2FsbCh3aW5kb3csICdwb3BzdGF0ZScsIGNhbi5yb3V0ZS5zZXRTdGF0ZSk7CiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgIC8vICMjIHVuYmluZAoKICAgICAgICAgICAgICAgIC8vIFVuYmluZHMgYW5kIHJlc3RvcmVzIG9yaWdpbmFsIGBoaXN0b3J5YCBtZXRob2RzCiAgICAgICAgICAgICAgICB1bmJpbmQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGNhbi51bmRlbGVnYXRlLmNhbGwoY2FuLiQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSwgJ2NsaWNrJywgJ2EnLCBhbmNob3JDbGlja0hhbmRsZXIpOwoKICAgICAgICAgICAgICAgICAgICBjYW4uZWFjaChtZXRob2RzVG9PdmVyd3JpdGUsIGZ1bmN0aW9uKG1ldGhvZCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeVttZXRob2RdID0gb3JpZ2luYWxNZXRob2RzW21ldGhvZF07CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgY2FuLnVuYmluZC5jYWxsKHdpbmRvdywgJ3BvcHN0YXRlJywgY2FuLnJvdXRlLnNldFN0YXRlKTsKICAgICAgICAgICAgICAgIH0sCgogICAgICAgICAgICAgICAgLy8gIyMgbWF0Y2hpbmdQYXJ0T2ZVUkwKCiAgICAgICAgICAgICAgICAvLyBSZXR1cm5zIG1hdGNoaW5nIHBhcnQgb2YgdXJsIHdpdGhvdXQgcm9vdC4KICAgICAgICAgICAgICAgIG1hdGNoaW5nUGFydE9mVVJMOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcm9vdCA9IGNsZWFuUm9vdCgpLAogICAgICAgICAgICAgICAgICAgICAgICBsb2MgPSAobG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5zZWFyY2gpLAogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGxvYy5pbmRleE9mKHJvb3QpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jLnN1YnN0cihpbmRleCArIHJvb3QubGVuZ3RoKTsKICAgICAgICAgICAgICAgIH0sCgogICAgICAgICAgICAgICAgLy8gIyMgc2V0VVJMCgogICAgICAgICAgICAgICAgLy8gVXBkYXRlcyBVUkwgYnkgY2FsbGluZyBgcHVzaFN0YXRlYC4KICAgICAgICAgICAgICAgIHNldFVSTDogZnVuY3Rpb24ocGF0aCkgewogICAgICAgICAgICAgICAgICAgIC8vIEtlZXBzIGhhc2ggaWYgbm90IGluIHBhdGguCiAgICAgICAgICAgICAgICAgICAgaWYgKGluY2x1ZGVIYXNoICYmIHBhdGguaW5kZXhPZigiIyIpID09PSAtMSAmJiB3aW5kb3cubG9jYXRpb24uaGFzaCkgewogICAgICAgICAgICAgICAgICAgICAgICBwYXRoICs9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgY2FuLnJvdXRlLl9jYWxsKCJyb290IikgKyBwYXRoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIC8vICMjIGFuY2hvckNsaWNrSGFuZGxlcgoKICAgICAgICAgICAgLy8gSGFuZGxlciBmdW5jdGlvbiBmb3IgYGNsaWNrYCBldmVudHMuCiAgICAgICAgICAgIHZhciBhbmNob3JDbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICBpZiAoIShlLmlzRGVmYXVsdFByZXZlbnRlZCA/IGUuaXNEZWZhdWx0UHJldmVudGVkKCkgOiBlLmRlZmF1bHRQcmV2ZW50ZWQgPT09IHRydWUpKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gWVVJIGNhbGxzIGJhY2sgZXZlbnRzIHRyaWdnZXJlZCB3aXRoIHRoaXMgYXMgYSB3cmFwcGVkIG9iamVjdC4KICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMuX25vZGUgfHwgdGhpczsKICAgICAgICAgICAgICAgICAgICAvLyBGaXggZm9yIElFIHNob3dpbmcgYmxhbmsgaG9zdCwgYnV0IGJsYW5rIGhvc3QgbWVhbnMgY3VycmVudCBob3N0LgogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rc0hvc3QgPSBub2RlLmhvc3QgfHwgd2luZG93LmxvY2F0aW9uLmhvc3Q7CgogICAgICAgICAgICAgICAgICAgIC8vIElmIGxpbmsgaXMgd2l0aGluIHRoZSBzYW1lIGRvbWFpbiBhbmQgZGVzY2VuZGFudCBvZiBgcm9vdGAKICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhvc3QgPT09IGxpbmtzSG9zdCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9vdCA9IGNsZWFuUm9vdCgpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5wYXRobmFtZS5pbmRleE9mKHJvb3QpID09PSAwKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlcyByb290IGZyb20gdXJsLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IChub2RlLnBhdGhuYW1lICsgbm9kZS5zZWFyY2gpLnN1YnN0cihyb290Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBhIHJvdXRlIG1hdGNoZXMgdXBkYXRlIHRoZSBkYXRhLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1clBhcmFtcyA9IGNhbi5yb3V0ZS5kZXBhcmFtKHVybCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VyUGFyYW1zLmhhc093blByb3BlcnR5KCdyb3V0ZScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFrZXMgaXQgcG9zc2libGUgdG8gaGF2ZSBhIGxpbmsgd2l0aCBhIGhhc2guCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZUhhc2ggPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBub2RlLmhyZWYpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUZXN0IGlmIHlvdSBjYW4gcHJldmVudERlZmF1bHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvdXIgdGVzdHMgY2FuJ3QgY2FsbCAuY2xpY2soKSBiL2MgdGhpcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZyZWV6ZXMgcGhhbnRvbS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgIC8vICMjIGNsZWFuUm9vdAoKICAgICAgICAgICAgICAgIC8vIEFsd2F5cyByZXR1cm5zIGNsZWFuIHJvb3QsIHdpdGhvdXQgZG9tYWluLgogICAgICAgICAgICAgICAgY2xlYW5Sb290ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRvbWFpbiA9IGxvY2F0aW9uLnByb3RvY29sICsgIi8vIiArIGxvY2F0aW9uLmhvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QgPSBjYW4ucm91dGUuX2NhbGwoInJvb3QiKSwKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSByb290LmluZGV4T2YoZG9tYWluKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvb3Quc3Vic3RyKGRvbWFpbi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm9vdDsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAvLyBPcmlnaW5hbCBtZXRob2RzIG9uIGBoaXN0b3J5YCB0aGF0IHdpbGwgYmUgb3ZlcndyaXR0ZW4KICAgICAgICAgICAgICAgIG1ldGhvZHNUb092ZXJ3cml0ZSA9IFsncHVzaFN0YXRlJywgJ3JlcGxhY2VTdGF0ZSddLAogICAgICAgICAgICAgICAgLy8gQSBwbGFjZSB0byBzdG9yZSBwb2ludGVycyB0byBvcmlnaW5hbCBgaGlzdG9yeWAgbWV0aG9kcy4KICAgICAgICAgICAgICAgIG9yaWdpbmFsTWV0aG9kcyA9IHt9LAogICAgICAgICAgICAgICAgLy8gVXNlZCB0byB0ZWxsIHNldFVSTCB0byBpbmNsdWRlIHRoZSBoYXNoIGJlY2F1c2Ugd2UgY2xpY2tlZCBvbiBhIGxpbmsuCiAgICAgICAgICAgICAgICBpbmNsdWRlSGFzaCA9IGZhbHNlOwoKICAgICAgICAgICAgLy8gRW5hYmxlcyBwbHVnaW4sIGJ5IGRlZmF1bHQgYGhhc2hjaGFuZ2VgIGJpbmRpbmcgaXMgdXNlZC4KICAgICAgICAgICAgY2FuLnJvdXRlLmRlZmF1bHRCaW5kaW5nID0gInB1c2hzdGF0ZSI7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY2FuOwogICAgfSkod2luZG93LmNhbiwgdW5kZWZpbmVkKTsKCn0pKCk7",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 14:37:21 GMT",
                    "Content-Length": "6723",
                    "Date": "Thu, 06 Nov 2014 14:37:26 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}