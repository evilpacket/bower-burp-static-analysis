{
    "url": "http://localhost:9999/jkphl/TYPO3-ext-squeezr/Resources/Private/Squeezr/squeezr/plugins/minify/min/builder/_index.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>location.hash</b> and written to <b>the 'text()' function of JQuery</b> via the following statements:<ul><li>var i = 0, found = location.hash.substr(1).split(','), l = found.length;</li><li>$p.append($('&lt;a href=#&gt;&lt;/a&gt;').text(found[i])[0]);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/jkphl/TYPO3-ext-squeezr/Resources/Private/Squeezr/squeezr/plugins/minify/min/builder/_index.js",
                "path": "/jkphl/TYPO3-ext-squeezr/Resources/Private/Squeezr/squeezr/plugins/minify/min/builder/_index.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9qa3BobC9UWVBPMy1leHQtc3F1ZWV6ci9SZXNvdXJjZXMvUHJpdmF0ZS9TcXVlZXpyL3NxdWVlenIvcGx1Z2lucy9taW5pZnkvbWluL2J1aWxkZXIvX2luZGV4LmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogOTExMw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAwNToyNDo0OSBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMDU6MjQ6NDkgR01UDQoNCi8qIQogKiBNaW5pZnkgVVJJIEJ1aWxkZXIKICovCnZhciBNVUIgPSB7CiAgICBfdWlkIDogMCwKICAgIF9taW5Sb290IDogJy9taW4vPycsCiAgICBjaGVja1Jld3JpdGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHRlc3RVcmkgPSBsb2NhdGlvbi5wYXRobmFtZS5yZXBsYWNlKC9cL1teXC9dKiQvLCAnL3Jld3JpdGVUZXN0LmpzJykuc3Vic3RyKDEpOwogICAgICAgIGZ1bmN0aW9uIGZhaWwoKSB7CiAgICAgICAgICAgICQoJyNtaW5SZXdyaXRlRmFpbGVkJylbMF0uY2xhc3NOYW1lID0gJ3RvcE5vdGUnOwogICAgICAgIH0KICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmwgOiAnLi4vZj0nICsgdGVzdFVyaSArICcmJyArIChuZXcgRGF0ZSgpKS5nZXRUaW1lKCksCiAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgaWYgKGRhdGEgPT09ICcxJykgewogICAgICAgICAgICAgICAgICAgIE1VQi5fbWluUm9vdCA9ICcvbWluLyc7CiAgICAgICAgICAgICAgICAgICAgJCgnc3Bhbi5taW5Sb290JykuaHRtbCgnL21pbi8nKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgIGZhaWwoKTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVycm9yIDogZmFpbAogICAgICAgIH0pOwogICAgfSwKICAgIC8qKgogICAgICogR2V0IG1hcmt1cCBmb3IgbmV3IHNvdXJjZSBMSSBlbGVtZW50CiAgICAgKi8KICAgIG5ld0xpIDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAnPGxpIGlkPSJsaScgKyBNVUIuX3VpZCArICciPmh0dHA6Ly8nICsgbG9jYXRpb24uaG9zdCArICcvPGlucHV0IHR5cGU9dGV4dCBzaXplPTIwPicgKwogICAgICAgICcgPGJ1dHRvbiB0aXRsZT0iUmVtb3ZlIj54PC9idXR0b24+IDxidXR0b24gdGl0bGU9IkluY2x1ZGUgRWFybGllciI+JnVhcnI7PC9idXR0b24+JyArCiAgICAgICAgJyA8YnV0dG9uIHRpdGxlPSJJbmNsdWRlIExhdGVyIj4mZGFycjs8L2J1dHRvbj4gPHNwYW4+PC9zcGFuPjwvbGk+JzsKICAgIH0sCiAgICAvKioKICAgICAqIEFkZCBuZXcgZW1wdHkgc291cmNlIExJIGFuZCBhdHRhY2ggaGFuZGxlcnMgdG8gYnV0dG9ucwogICAgICovCiAgICBhZGRMaSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjc291cmNlcycpLmFwcGVuZChNVUIubmV3TGkoKSk7CiAgICAgICAgdmFyIGxpID0gJCgnI2xpJyArIE1VQi5fdWlkKVswXTsKICAgICAgICAkKCdidXR0b25bdGl0bGU9UmVtb3ZlXScsIGxpKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICQoJyNyZXN1bHRzJykuaGlkZSgpOwogICAgICAgICAgICB2YXIgaGFkVmFsdWUgPSAhISQoJ2lucHV0JywgbGkpWzBdLnZhbHVlOwogICAgICAgICAgICAkKGxpKS5yZW1vdmUoKTsKICAgICAgICB9KTsKICAgICAgICAkKCdidXR0b25bdGl0bGUkPUVhcmxpZXJdJywgbGkpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgJChsaSkucHJldignbGknKS5maW5kKCdpbnB1dCcpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgJCgnI3Jlc3VsdHMnKS5oaWRlKCk7CiAgICAgICAgICAgICAgICAvLyB0aGlzID0gcHJldmlvdXMgbGkgaW5wdXQKICAgICAgICAgICAgICAgIHZhciB0bXAgPSB0aGlzLnZhbHVlOwogICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9ICQoJ2lucHV0JywgbGkpLnZhbCgpOwogICAgICAgICAgICAgICAgJCgnaW5wdXQnLCBsaSkudmFsKHRtcCk7CiAgICAgICAgICAgICAgICBNVUIudXBkYXRlQWxsVGVzdExpbmtzKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgICQoJ2J1dHRvblt0aXRsZSQ9TGF0ZXJdJywgbGkpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgJChsaSkubmV4dCgnbGknKS5maW5kKCdpbnB1dCcpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgJCgnI3Jlc3VsdHMnKS5oaWRlKCk7CiAgICAgICAgICAgICAgICAvLyB0aGlzID0gbmV4dCBsaSBpbnB1dAogICAgICAgICAgICAgICAgdmFyIHRtcCA9IHRoaXMudmFsdWU7CiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gJCgnaW5wdXQnLCBsaSkudmFsKCk7CiAgICAgICAgICAgICAgICAkKCdpbnB1dCcsIGxpKS52YWwodG1wKTsKICAgICAgICAgICAgICAgIE1VQi51cGRhdGVBbGxUZXN0TGlua3MoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgKytNVUIuX3VpZDsKICAgIH0sCiAgICAvKioKICAgICAqIEluIHRoZSBjb250ZXh0IG9mIGEgc291cmNlIExJIGVsZW1lbnQsIHRoaXMgd2lsbCBhbmFseXplIHRoZSBVUkkgaW4KICAgICAqIHRoZSBJTlBVVCBhbmQgY2hlY2sgdGhlIFVSTCBvbiB0aGUgc2l0ZS4KICAgICAqLwogICAgbGlVcGRhdGVUZXN0TGluayA6IGZ1bmN0aW9uICgpIHsgLy8gY2FsbCBpbiBjb250ZXh0IG9mIGxpIGVsZW1lbnQKICAgICAgICBpZiAoISAkKCdpbnB1dCcsIHRoaXMpWzBdLnZhbHVlKSAKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIHZhciBsaSA9IHRoaXM7CiAgICAgICAgJCgnc3BhbicsIHRoaXMpLmh0bWwoJycpOwogICAgICAgIHZhciB1cmwgPSAnaHR0cDovLycgKyBsb2NhdGlvbi5ob3N0ICsgJy8nICsKICAgICAgICAgICAgICAgICQoJ2lucHV0JywgdGhpcylbMF0udmFsdWUucmVwbGFjZSgvXlwvLywgJycpOwogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybCA6IHVybCwKICAgICAgICAgICAgY29tcGxldGUgOiBmdW5jdGlvbiAoeGhyLCBzdGF0KSB7CiAgICAgICAgICAgICAgICBpZiAoJ3N1Y2Nlc3MnID09PSBzdGF0KQogICAgICAgICAgICAgICAgICAgICQoJ3NwYW4nLCBsaSkuaHRtbCgnJiN4MjcxMzsnKTsKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICQoJ3NwYW4nLCBsaSkuaHRtbCgnPGJ1dHRvbj48Yj40MDQhIDwvYj4gcmVjaGVjazwvYnV0dG9uPicpCiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCdidXR0b24nKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNVUIubGlVcGRhdGVUZXN0TGluay5jYWxsKGxpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRhdGFUeXBlIDogJ3RleHQnCiAgICAgICAgfSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBDaGVjayBhbGwgc291cmNlIFVSTHMKICAgICAqLwogICAgdXBkYXRlQWxsVGVzdExpbmtzIDogZnVuY3Rpb24gKCkgewogICAgICAgICQoJyNzb3VyY2VzIGxpJykuZWFjaChNVUIubGlVcGRhdGVUZXN0TGluayk7CiAgICB9LAogICAgLyoqCiAgICAgKiBJbiBhIGdpdmVuIGFycmF5IG9mIHN0cmluZ3MsIGZpbmQgdGhlIGNoYXJhY3RlciB0aGV5IGFsbCBoYXZlIGF0CiAgICAgKiBhIHBhcnRpY3VsYXIgaW5kZXgKICAgICAqIEBwYXJhbSBBcnJheSBhcnIgYXJyYXkgb2Ygc3RyaW5ncwogICAgICogQHBhcmFtIE51bWJlciBwb3MgaW5kZXggdG8gY2hlY2sKICAgICAqIEByZXR1cm4gbWl4ZWQgYSBjb21tb24gY2hhciBvciAnJyBpZiBhbnkgZG8gbm90IG1hdGNoCiAgICAgKi8KICAgIGdldENvbW1vbkNoYXJBdFBvcyA6IGZ1bmN0aW9uIChhcnIsIHBvcykgewogICAgICAgIHZhciBpLAogICAgICAgICAgICBsID0gYXJyLmxlbmd0aCwKICAgICAgICAgICAgYyA9IGFyclswXS5jaGFyQXQocG9zKTsKICAgICAgICBpZiAoYyA9PT0gJycgfHwgbCA9PT0gMSkKICAgICAgICAgICAgcmV0dXJuIGM7CiAgICAgICAgZm9yIChpID0gMTsgaSA8IGw7ICsraSkKICAgICAgICAgICAgaWYgKGFycltpXS5jaGFyQXQocG9zKSAhPT0gYykKICAgICAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICByZXR1cm4gYzsKICAgIH0sCiAgICAvKioKICAgICAqIEdldCB0aGUgc2hvcnRlc3QgVVJJIHRvIG1pbmlmeSB0aGUgc2V0IG9mIHNvdXJjZSBmaWxlcwogICAgICogQHBhcmFtIEFycmF5IHNvdXJjZXMgVVJJcwogICAgICovCiAgICBnZXRCZXN0VXJpIDogZnVuY3Rpb24gKHNvdXJjZXMpIHsKICAgICAgICB2YXIgcG9zID0gMCwKICAgICAgICAgICAgYmFzZSA9ICcnLAogICAgICAgICAgICBjOwogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIGMgPSBNVUIuZ2V0Q29tbW9uQ2hhckF0UG9zKHNvdXJjZXMsIHBvcyk7CiAgICAgICAgICAgIGlmIChjID09PSAnJykKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBiYXNlICs9IGM7CiAgICAgICAgICAgICsrcG9zOwogICAgICAgIH0KICAgICAgICBiYXNlID0gYmFzZS5yZXBsYWNlKC9bXlwvXSskLywgJycpOwogICAgICAgIHZhciB1cmkgPSBNVUIuX21pblJvb3QgKyAnZj0nICsgc291cmNlcy5qb2luKCcsJyk7CiAgICAgICAgaWYgKGJhc2UuY2hhckF0KGJhc2UubGVuZ3RoIC0gMSkgPT09ICcvJykgewogICAgICAgICAgICAvLyB3ZSBoYXZlIGEgYmFzZSBkaXIhCiAgICAgICAgICAgIHZhciBiYXNlZFNvdXJjZXMgPSBzb3VyY2VzLAogICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgIGwgPSBzb3VyY2VzLmxlbmd0aDsKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGw7ICsraSkgewogICAgICAgICAgICAgICAgYmFzZWRTb3VyY2VzW2ldID0gc291cmNlc1tpXS5zdWJzdHIoYmFzZS5sZW5ndGgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJhc2UgPSBiYXNlLnN1YnN0cigwLCBiYXNlLmxlbmd0aCAtIDEpOwogICAgICAgICAgICB2YXIgYlVyaSA9IE1VQi5fbWluUm9vdCArICdiPScgKyBiYXNlICsgJyZmPScgKyBiYXNlZFNvdXJjZXMuam9pbignLCcpOwogICAgICAgICAgICAvL3dpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUubG9nKFt1cmksIGJVcmldKTsKICAgICAgICAgICAgdXJpID0gdXJpLmxlbmd0aCA8IGJVcmkubGVuZ3RoID8gdXJpIDogYlVyaTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVyaTsKICAgIH0sCiAgICAvKioKICAgICAqIENyZWF0ZSB0aGUgTWluaWZ5IFVSSSBmb3IgdGhlIHNvdXJjZXMKICAgICAqLwogICAgdXBkYXRlIDogZnVuY3Rpb24gKCkgewogICAgICAgIE1VQi51cGRhdGVBbGxUZXN0TGlua3MoKTsKICAgICAgICB2YXIgc291cmNlcyA9IFtdLAogICAgICAgICAgICBleHQgPSBmYWxzZSwKICAgICAgICAgICAgZmFpbCA9IGZhbHNlLAogICAgICAgICAgICBtYXJrdXA7CiAgICAgICAgJCgnI3NvdXJjZXMgaW5wdXQnKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIG0sIHZhbDsKICAgICAgICAgICAgaWYgKCEgZmFpbCAmJiB0aGlzLnZhbHVlICYmIChtID0gdGhpcy52YWx1ZS5tYXRjaCgvXC4oY3NzfGpzKSQvKSkpIHsKICAgICAgICAgICAgICAgIHZhciB0aGlzRXh0ID0gbVsxXTsKICAgICAgICAgICAgICAgIGlmIChleHQgPT09IGZhbHNlKQogICAgICAgICAgICAgICAgICAgIGV4dCA9IHRoaXNFeHQ7IAogICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpc0V4dCAhPT0gZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgZmFpbCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFsZXJ0KCdleHRlbnNpb25zIG11c3QgbWF0Y2ghJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZS5yZXBsYWNlKC9eXC8vLCAnJyk7CiAgICAgICAgICAgICAgICBpZiAoLTEgIT09ICQuaW5BcnJheSh0aGlzLnZhbHVlLCBzb3VyY2VzKSkgewogICAgICAgICAgICAgICAgICAgIGZhaWwgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBhbGVydCgnZHVwbGljYXRlIGZpbGUhJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzb3VyY2VzLnB1c2godGhpcy52YWx1ZSk7CiAgICAgICAgICAgIH0gCiAgICAgICAgfSk7CiAgICAgICAgaWYgKGZhaWwgfHwgISBzb3VyY2VzLmxlbmd0aCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICQoJyNncm91cENvbmZpZycpLnZhbCgiICAgICdrZXlOYW1lJyA9PiBhcnJheSgnLy8iICsgc291cmNlcy5qb2luKCInLCAnLy8iKSArICInKSwiKTsKICAgICAgICB2YXIgdXJpID0gTVVCLmdldEJlc3RVcmkoc291cmNlcyksCiAgICAgICAgICAgIHVyaUggPSB1cmkucmVwbGFjZSgvPC8sICcmbHQ7JykucmVwbGFjZSgvPi8sICcmZ3Q7JykucmVwbGFjZSgvJi8sICcmYW1wOycpOwogICAgICAgICQoJyN1cmlBJykuaHRtbCh1cmlIKVswXS5ocmVmID0gdXJpOwogICAgICAgIGlmIChleHQgPT09ICdqcycpIHsKICAgICAgICAgICAgbWFya3VwID0gJzxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9IicgKyB1cmlIICsgJyI+PC9zY3JpcHQ+JzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtYXJrdXAgPSAnPGxpbmsgdHlwZT0idGV4dC9jc3MiIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iJyArIHVyaUggKyAnIiAvPic7CiAgICAgICAgfQogICAgICAgICQoJyN1cmlIdG1sJykudmFsKG1hcmt1cCk7CiAgICAgICAgJCgnI3Jlc3VsdHMnKS5zaG93KCk7CiAgICB9LAogICAgLyoqCiAgICAgKiBIYW5kbGVyIGZvciB0aGUgIkFkZCBmaWxlICsiIGJ1dHRvbgogICAgICovCiAgICBhZGRCdXR0b25DbGljayA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjcmVzdWx0cycpLmhpZGUoKTsKICAgICAgICBNVUIuYWRkTGkoKTsKICAgICAgICBNVUIudXBkYXRlQWxsVGVzdExpbmtzKCk7CiAgICAgICAgJCgnI3VwZGF0ZScpLnNob3coKS5jbGljayhNVUIudXBkYXRlKTsKICAgICAgICAkKCcjc291cmNlcyBsaTpsYXN0IGlucHV0JylbMF0uZm9jdXMoKTsKICAgIH0sCiAgICAvKioKICAgICAqIFJ1bnMgb24gRE9NcmVhZHkKICAgICAqLwogICAgaW5pdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjanNEaWRudExvYWQnKS5yZW1vdmUoKTsKICAgICAgICAkKCcjYXBwJykuc2hvdygpOwogICAgICAgICQoJyNzb3VyY2VzJykuaHRtbCgnJyk7CiAgICAgICAgJCgnI2FkZCBidXR0b24nKS5jbGljayhNVUIuYWRkQnV0dG9uQ2xpY2spOwogICAgICAgIC8vIG1ha2UgZWFzaWVyIHRvIGNvcHkgdGV4dCBvdXQgb2YKICAgICAgICAkKCcjdXJpSHRtbCwgI2dyb3VwQ29uZmlnLCAjc3ltbGlua09wdCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdGhpcy5zZWxlY3QoKTsKICAgICAgICB9KS5mb2N1cyhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRoaXMuc2VsZWN0KCk7CiAgICAgICAgfSk7CiAgICAgICAgJCgnYS5leHQnKS5hdHRyKHt0YXJnZXQ6J19ibGFuayd9KTsKICAgICAgICBpZiAobG9jYXRpb24uaGFzaCkgewogICAgICAgICAgICAvLyBtYWtlIGxpbmtzIG91dCBvZiBVUklzIGZyb20gYm9va21hcmtsZXQKICAgICAgICAgICAgJCgnI2dldEJtJykuaGlkZSgpOwogICAgICAgICAgICB2YXIgaSA9IDAsIGZvdW5kID0gbG9jYXRpb24uaGFzaC5zdWJzdHIoMSkuc3BsaXQoJywnKSwgbCA9IGZvdW5kLmxlbmd0aDsKICAgICAgICAgICAgJCgnI2JtVXJpcycpLmh0bWwoJzxwPjxzdHJvbmc+Rm91bmQgYnkgYm9va21hcmtsZXQ6PC9zdHJvbmc+IC88L3A+Jyk7CiAgICAgICAgICAgIHZhciAkcCA9ICQoJyNibVVyaXMgcCcpOwogICAgICAgICAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICAgICAgJHAuYXBwZW5kKCQoJzxhIGhyZWY9Iz48L2E+JykudGV4dChmb3VuZFtpXSlbMF0pOwogICAgICAgICAgICAgICAgaWYgKGkgPCAobCAtIDEpKSB7CiAgICAgICAgICAgICAgICAgICAgJHAuYXBwZW5kKCcsIC8nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkKCcjYm1VcmlzIGEnKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBNVUIuYWRkQnV0dG9uQ2xpY2soKTsKICAgICAgICAgICAgICAgICQoJyNzb3VyY2VzIGxpOmxhc3QgaW5wdXQnKS52YWwodGhpcy5pbm5lckhUTUwpOwogICAgICAgICAgICAgICAgTVVCLmxpVXBkYXRlVGVzdExpbmsuY2FsbCgkKCcjc291cmNlcyBsaTpsYXN0JylbMF0pOwogICAgICAgICAgICAgICAgJCgnI3Jlc3VsdHMnKS5oaWRlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0pLmF0dHIoe3RpdGxlOidBZGQgZmlsZSArJ30pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIHNldHVwIGJvb2ttYXJrbGV0IDEKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybCA6ICcuLi8/Zj0nICsgbG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgvXC9bXlwvXSokLywgJy9ibS5qcycpLnN1YnN0cigxKSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbiAoY29kZSkgewogICAgICAgICAgICAgICAgICAgICQoJyNibScpWzBdLmhyZWYgPSBjb2RlCiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclQlVJTERFUl9VUkwlJywgbG9jYXRpb24uaHJlZikKICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xuL2csICcgJyk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZGF0YVR5cGUgOiAndGV4dCcKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmICgkLmJyb3dzZXIubXNpZSkgewogICAgICAgICAgICAgICAgJCgnI2dldEJtIHA6bGFzdCcpLmFwcGVuZCgnIFNvcnJ5LCBub3Qgc3VwcG9ydGVkIGluIE1TSUUhJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgTVVCLmFkZEJ1dHRvbkNsaWNrKCk7CiAgICAgICAgfQogICAgICAgIC8vIHNldHVwIGJvb2ttYXJrbGV0IDIKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmwgOiAnLi4vP2Y9JyArIGxvY2F0aW9uLnBhdGhuYW1lLnJlcGxhY2UoL1wvW15cL10qJC8sICcvYm0yLmpzJykuc3Vic3RyKDEpLAogICAgICAgICAgICBzdWNjZXNzIDogZnVuY3Rpb24gKGNvZGUpIHsKICAgICAgICAgICAgICAgICQoJyNibTInKVswXS5ocmVmID0gY29kZS5yZXBsYWNlKC9cbi9nLCAnICcpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBkYXRhVHlwZSA6ICd0ZXh0JwogICAgICAgIH0pOwogICAgICAgIE1VQi5jaGVja1Jld3JpdGUoKTsKICAgIH0KfTsKJChNVUIuaW5pdCk7",
                "body": "LyohCiAqIE1pbmlmeSBVUkkgQnVpbGRlcgogKi8KdmFyIE1VQiA9IHsKICAgIF91aWQgOiAwLAogICAgX21pblJvb3QgOiAnL21pbi8/JywKICAgIGNoZWNrUmV3cml0ZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgdGVzdFVyaSA9IGxvY2F0aW9uLnBhdGhuYW1lLnJlcGxhY2UoL1wvW15cL10qJC8sICcvcmV3cml0ZVRlc3QuanMnKS5zdWJzdHIoMSk7CiAgICAgICAgZnVuY3Rpb24gZmFpbCgpIHsKICAgICAgICAgICAgJCgnI21pblJld3JpdGVGYWlsZWQnKVswXS5jbGFzc05hbWUgPSAndG9wTm90ZSc7CiAgICAgICAgfQogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybCA6ICcuLi9mPScgKyB0ZXN0VXJpICsgJyYnICsgKG5ldyBEYXRlKCkpLmdldFRpbWUoKSwKICAgICAgICAgICAgc3VjY2VzcyA6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICBpZiAoZGF0YSA9PT0gJzEnKSB7CiAgICAgICAgICAgICAgICAgICAgTVVCLl9taW5Sb290ID0gJy9taW4vJzsKICAgICAgICAgICAgICAgICAgICAkKCdzcGFuLm1pblJvb3QnKS5odG1sKCcvbWluLycpOwogICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgZmFpbCgpOyAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXJyb3IgOiBmYWlsCiAgICAgICAgfSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBHZXQgbWFya3VwIGZvciBuZXcgc291cmNlIExJIGVsZW1lbnQKICAgICAqLwogICAgbmV3TGkgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuICc8bGkgaWQ9ImxpJyArIE1VQi5fdWlkICsgJyI+aHR0cDovLycgKyBsb2NhdGlvbi5ob3N0ICsgJy88aW5wdXQgdHlwZT10ZXh0IHNpemU9MjA+JyArCiAgICAgICAgJyA8YnV0dG9uIHRpdGxlPSJSZW1vdmUiPng8L2J1dHRvbj4gPGJ1dHRvbiB0aXRsZT0iSW5jbHVkZSBFYXJsaWVyIj4mdWFycjs8L2J1dHRvbj4nICsKICAgICAgICAnIDxidXR0b24gdGl0bGU9IkluY2x1ZGUgTGF0ZXIiPiZkYXJyOzwvYnV0dG9uPiA8c3Bhbj48L3NwYW4+PC9saT4nOwogICAgfSwKICAgIC8qKgogICAgICogQWRkIG5ldyBlbXB0eSBzb3VyY2UgTEkgYW5kIGF0dGFjaCBoYW5kbGVycyB0byBidXR0b25zCiAgICAgKi8KICAgIGFkZExpIDogZnVuY3Rpb24gKCkgewogICAgICAgICQoJyNzb3VyY2VzJykuYXBwZW5kKE1VQi5uZXdMaSgpKTsKICAgICAgICB2YXIgbGkgPSAkKCcjbGknICsgTVVCLl91aWQpWzBdOwogICAgICAgICQoJ2J1dHRvblt0aXRsZT1SZW1vdmVdJywgbGkpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgJCgnI3Jlc3VsdHMnKS5oaWRlKCk7CiAgICAgICAgICAgIHZhciBoYWRWYWx1ZSA9ICEhJCgnaW5wdXQnLCBsaSlbMF0udmFsdWU7CiAgICAgICAgICAgICQobGkpLnJlbW92ZSgpOwogICAgICAgIH0pOwogICAgICAgICQoJ2J1dHRvblt0aXRsZSQ9RWFybGllcl0nLCBsaSkuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAkKGxpKS5wcmV2KCdsaScpLmZpbmQoJ2lucHV0JykuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAkKCcjcmVzdWx0cycpLmhpZGUoKTsKICAgICAgICAgICAgICAgIC8vIHRoaXMgPSBwcmV2aW91cyBsaSBpbnB1dAogICAgICAgICAgICAgICAgdmFyIHRtcCA9IHRoaXMudmFsdWU7CiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gJCgnaW5wdXQnLCBsaSkudmFsKCk7CiAgICAgICAgICAgICAgICAkKCdpbnB1dCcsIGxpKS52YWwodG1wKTsKICAgICAgICAgICAgICAgIE1VQi51cGRhdGVBbGxUZXN0TGlua3MoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgJCgnYnV0dG9uW3RpdGxlJD1MYXRlcl0nLCBsaSkuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAkKGxpKS5uZXh0KCdsaScpLmZpbmQoJ2lucHV0JykuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAkKCcjcmVzdWx0cycpLmhpZGUoKTsKICAgICAgICAgICAgICAgIC8vIHRoaXMgPSBuZXh0IGxpIGlucHV0CiAgICAgICAgICAgICAgICB2YXIgdG1wID0gdGhpcy52YWx1ZTsKICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSAkKCdpbnB1dCcsIGxpKS52YWwoKTsKICAgICAgICAgICAgICAgICQoJ2lucHV0JywgbGkpLnZhbCh0bXApOwogICAgICAgICAgICAgICAgTVVCLnVwZGF0ZUFsbFRlc3RMaW5rcygpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICArK01VQi5fdWlkOwogICAgfSwKICAgIC8qKgogICAgICogSW4gdGhlIGNvbnRleHQgb2YgYSBzb3VyY2UgTEkgZWxlbWVudCwgdGhpcyB3aWxsIGFuYWx5emUgdGhlIFVSSSBpbgogICAgICogdGhlIElOUFVUIGFuZCBjaGVjayB0aGUgVVJMIG9uIHRoZSBzaXRlLgogICAgICovCiAgICBsaVVwZGF0ZVRlc3RMaW5rIDogZnVuY3Rpb24gKCkgeyAvLyBjYWxsIGluIGNvbnRleHQgb2YgbGkgZWxlbWVudAogICAgICAgIGlmICghICQoJ2lucHV0JywgdGhpcylbMF0udmFsdWUpIAogICAgICAgICAgICByZXR1cm47CiAgICAgICAgdmFyIGxpID0gdGhpczsKICAgICAgICAkKCdzcGFuJywgdGhpcykuaHRtbCgnJyk7CiAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vJyArIGxvY2F0aW9uLmhvc3QgKyAnLycgKwogICAgICAgICAgICAgICAgJCgnaW5wdXQnLCB0aGlzKVswXS52YWx1ZS5yZXBsYWNlKC9eXC8vLCAnJyk7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdXJsIDogdXJsLAogICAgICAgICAgICBjb21wbGV0ZSA6IGZ1bmN0aW9uICh4aHIsIHN0YXQpIHsKICAgICAgICAgICAgICAgIGlmICgnc3VjY2VzcycgPT09IHN0YXQpCiAgICAgICAgICAgICAgICAgICAgJCgnc3BhbicsIGxpKS5odG1sKCcmI3gyNzEzOycpOwogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnc3BhbicsIGxpKS5odG1sKCc8YnV0dG9uPjxiPjQwNCEgPC9iPiByZWNoZWNrPC9idXR0b24+JykKICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2J1dHRvbicpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1VQi5saVVwZGF0ZVRlc3RMaW5rLmNhbGwobGkpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgZGF0YVR5cGUgOiAndGV4dCcKICAgICAgICB9KTsKICAgIH0sCiAgICAvKioKICAgICAqIENoZWNrIGFsbCBzb3VyY2UgVVJMcwogICAgICovCiAgICB1cGRhdGVBbGxUZXN0TGlua3MgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgJCgnI3NvdXJjZXMgbGknKS5lYWNoKE1VQi5saVVwZGF0ZVRlc3RMaW5rKTsKICAgIH0sCiAgICAvKioKICAgICAqIEluIGEgZ2l2ZW4gYXJyYXkgb2Ygc3RyaW5ncywgZmluZCB0aGUgY2hhcmFjdGVyIHRoZXkgYWxsIGhhdmUgYXQKICAgICAqIGEgcGFydGljdWxhciBpbmRleAogICAgICogQHBhcmFtIEFycmF5IGFyciBhcnJheSBvZiBzdHJpbmdzCiAgICAgKiBAcGFyYW0gTnVtYmVyIHBvcyBpbmRleCB0byBjaGVjawogICAgICogQHJldHVybiBtaXhlZCBhIGNvbW1vbiBjaGFyIG9yICcnIGlmIGFueSBkbyBub3QgbWF0Y2gKICAgICAqLwogICAgZ2V0Q29tbW9uQ2hhckF0UG9zIDogZnVuY3Rpb24gKGFyciwgcG9zKSB7CiAgICAgICAgdmFyIGksCiAgICAgICAgICAgIGwgPSBhcnIubGVuZ3RoLAogICAgICAgICAgICBjID0gYXJyWzBdLmNoYXJBdChwb3MpOwogICAgICAgIGlmIChjID09PSAnJyB8fCBsID09PSAxKQogICAgICAgICAgICByZXR1cm4gYzsKICAgICAgICBmb3IgKGkgPSAxOyBpIDwgbDsgKytpKQogICAgICAgICAgICBpZiAoYXJyW2ldLmNoYXJBdChwb3MpICE9PSBjKQogICAgICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIHJldHVybiBjOwogICAgfSwKICAgIC8qKgogICAgICogR2V0IHRoZSBzaG9ydGVzdCBVUkkgdG8gbWluaWZ5IHRoZSBzZXQgb2Ygc291cmNlIGZpbGVzCiAgICAgKiBAcGFyYW0gQXJyYXkgc291cmNlcyBVUklzCiAgICAgKi8KICAgIGdldEJlc3RVcmkgOiBmdW5jdGlvbiAoc291cmNlcykgewogICAgICAgIHZhciBwb3MgPSAwLAogICAgICAgICAgICBiYXNlID0gJycsCiAgICAgICAgICAgIGM7CiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgYyA9IE1VQi5nZXRDb21tb25DaGFyQXRQb3Moc291cmNlcywgcG9zKTsKICAgICAgICAgICAgaWYgKGMgPT09ICcnKQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGJhc2UgKz0gYzsKICAgICAgICAgICAgKytwb3M7CiAgICAgICAgfQogICAgICAgIGJhc2UgPSBiYXNlLnJlcGxhY2UoL1teXC9dKyQvLCAnJyk7CiAgICAgICAgdmFyIHVyaSA9IE1VQi5fbWluUm9vdCArICdmPScgKyBzb3VyY2VzLmpvaW4oJywnKTsKICAgICAgICBpZiAoYmFzZS5jaGFyQXQoYmFzZS5sZW5ndGggLSAxKSA9PT0gJy8nKSB7CiAgICAgICAgICAgIC8vIHdlIGhhdmUgYSBiYXNlIGRpciEKICAgICAgICAgICAgdmFyIGJhc2VkU291cmNlcyA9IHNvdXJjZXMsCiAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgbCA9IHNvdXJjZXMubGVuZ3RoOwogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbDsgKytpKSB7CiAgICAgICAgICAgICAgICBiYXNlZFNvdXJjZXNbaV0gPSBzb3VyY2VzW2ldLnN1YnN0cihiYXNlLmxlbmd0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmFzZSA9IGJhc2Uuc3Vic3RyKDAsIGJhc2UubGVuZ3RoIC0gMSk7CiAgICAgICAgICAgIHZhciBiVXJpID0gTVVCLl9taW5Sb290ICsgJ2I9JyArIGJhc2UgKyAnJmY9JyArIGJhc2VkU291cmNlcy5qb2luKCcsJyk7CiAgICAgICAgICAgIC8vd2luZG93LmNvbnNvbGUgJiYgY29uc29sZS5sb2coW3VyaSwgYlVyaV0pOwogICAgICAgICAgICB1cmkgPSB1cmkubGVuZ3RoIDwgYlVyaS5sZW5ndGggPyB1cmkgOiBiVXJpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdXJpOwogICAgfSwKICAgIC8qKgogICAgICogQ3JlYXRlIHRoZSBNaW5pZnkgVVJJIGZvciB0aGUgc291cmNlcwogICAgICovCiAgICB1cGRhdGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgTVVCLnVwZGF0ZUFsbFRlc3RMaW5rcygpOwogICAgICAgIHZhciBzb3VyY2VzID0gW10sCiAgICAgICAgICAgIGV4dCA9IGZhbHNlLAogICAgICAgICAgICBmYWlsID0gZmFsc2UsCiAgICAgICAgICAgIG1hcmt1cDsKICAgICAgICAkKCcjc291cmNlcyBpbnB1dCcpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgbSwgdmFsOwogICAgICAgICAgICBpZiAoISBmYWlsICYmIHRoaXMudmFsdWUgJiYgKG0gPSB0aGlzLnZhbHVlLm1hdGNoKC9cLihjc3N8anMpJC8pKSkgewogICAgICAgICAgICAgICAgdmFyIHRoaXNFeHQgPSBtWzFdOwogICAgICAgICAgICAgICAgaWYgKGV4dCA9PT0gZmFsc2UpCiAgICAgICAgICAgICAgICAgICAgZXh0ID0gdGhpc0V4dDsgCiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzRXh0ICE9PSBleHQpIHsKICAgICAgICAgICAgICAgICAgICBmYWlsID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWxlcnQoJ2V4dGVuc2lvbnMgbXVzdCBtYXRjaCEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnJlcGxhY2UoL15cLy8sICcnKTsKICAgICAgICAgICAgICAgIGlmICgtMSAhPT0gJC5pbkFycmF5KHRoaXMudmFsdWUsIHNvdXJjZXMpKSB7CiAgICAgICAgICAgICAgICAgICAgZmFpbCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFsZXJ0KCdkdXBsaWNhdGUgZmlsZSEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNvdXJjZXMucHVzaCh0aGlzLnZhbHVlKTsKICAgICAgICAgICAgfSAKICAgICAgICB9KTsKICAgICAgICBpZiAoZmFpbCB8fCAhIHNvdXJjZXMubGVuZ3RoKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgJCgnI2dyb3VwQ29uZmlnJykudmFsKCIgICAgJ2tleU5hbWUnID0+IGFycmF5KCcvLyIgKyBzb3VyY2VzLmpvaW4oIicsICcvLyIpICsgIicpLCIpOwogICAgICAgIHZhciB1cmkgPSBNVUIuZ2V0QmVzdFVyaShzb3VyY2VzKSwKICAgICAgICAgICAgdXJpSCA9IHVyaS5yZXBsYWNlKC88LywgJyZsdDsnKS5yZXBsYWNlKC8+LywgJyZndDsnKS5yZXBsYWNlKC8mLywgJyZhbXA7Jyk7CiAgICAgICAgJCgnI3VyaUEnKS5odG1sKHVyaUgpWzBdLmhyZWYgPSB1cmk7CiAgICAgICAgaWYgKGV4dCA9PT0gJ2pzJykgewogICAgICAgICAgICBtYXJrdXAgPSAnPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iJyArIHVyaUggKyAnIj48L3NjcmlwdD4nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1hcmt1cCA9ICc8bGluayB0eXBlPSJ0ZXh0L2NzcyIgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSInICsgdXJpSCArICciIC8+JzsKICAgICAgICB9CiAgICAgICAgJCgnI3VyaUh0bWwnKS52YWwobWFya3VwKTsKICAgICAgICAkKCcjcmVzdWx0cycpLnNob3coKTsKICAgIH0sCiAgICAvKioKICAgICAqIEhhbmRsZXIgZm9yIHRoZSAiQWRkIGZpbGUgKyIgYnV0dG9uCiAgICAgKi8KICAgIGFkZEJ1dHRvbkNsaWNrIDogZnVuY3Rpb24gKCkgewogICAgICAgICQoJyNyZXN1bHRzJykuaGlkZSgpOwogICAgICAgIE1VQi5hZGRMaSgpOwogICAgICAgIE1VQi51cGRhdGVBbGxUZXN0TGlua3MoKTsKICAgICAgICAkKCcjdXBkYXRlJykuc2hvdygpLmNsaWNrKE1VQi51cGRhdGUpOwogICAgICAgICQoJyNzb3VyY2VzIGxpOmxhc3QgaW5wdXQnKVswXS5mb2N1cygpOwogICAgfSwKICAgIC8qKgogICAgICogUnVucyBvbiBET01yZWFkeQogICAgICovCiAgICBpbml0IDogZnVuY3Rpb24gKCkgewogICAgICAgICQoJyNqc0RpZG50TG9hZCcpLnJlbW92ZSgpOwogICAgICAgICQoJyNhcHAnKS5zaG93KCk7CiAgICAgICAgJCgnI3NvdXJjZXMnKS5odG1sKCcnKTsKICAgICAgICAkKCcjYWRkIGJ1dHRvbicpLmNsaWNrKE1VQi5hZGRCdXR0b25DbGljayk7CiAgICAgICAgLy8gbWFrZSBlYXNpZXIgdG8gY29weSB0ZXh0IG91dCBvZgogICAgICAgICQoJyN1cmlIdG1sLCAjZ3JvdXBDb25maWcsICNzeW1saW5rT3B0JykuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICB0aGlzLnNlbGVjdCgpOwogICAgICAgIH0pLmZvY3VzKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdGhpcy5zZWxlY3QoKTsKICAgICAgICB9KTsKICAgICAgICAkKCdhLmV4dCcpLmF0dHIoe3RhcmdldDonX2JsYW5rJ30pOwogICAgICAgIGlmIChsb2NhdGlvbi5oYXNoKSB7CiAgICAgICAgICAgIC8vIG1ha2UgbGlua3Mgb3V0IG9mIFVSSXMgZnJvbSBib29rbWFya2xldAogICAgICAgICAgICAkKCcjZ2V0Qm0nKS5oaWRlKCk7CiAgICAgICAgICAgIHZhciBpID0gMCwgZm91bmQgPSBsb2NhdGlvbi5oYXNoLnN1YnN0cigxKS5zcGxpdCgnLCcpLCBsID0gZm91bmQubGVuZ3RoOwogICAgICAgICAgICAkKCcjYm1VcmlzJykuaHRtbCgnPHA+PHN0cm9uZz5Gb3VuZCBieSBib29rbWFya2xldDo8L3N0cm9uZz4gLzwvcD4nKTsKICAgICAgICAgICAgdmFyICRwID0gJCgnI2JtVXJpcyBwJyk7CiAgICAgICAgICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICAgICAgICAkcC5hcHBlbmQoJCgnPGEgaHJlZj0jPjwvYT4nKS50ZXh0KGZvdW5kW2ldKVswXSk7CiAgICAgICAgICAgICAgICBpZiAoaSA8IChsIC0gMSkpIHsKICAgICAgICAgICAgICAgICAgICAkcC5hcHBlbmQoJywgLycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICQoJyNibVVyaXMgYScpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIE1VQi5hZGRCdXR0b25DbGljaygpOwogICAgICAgICAgICAgICAgJCgnI3NvdXJjZXMgbGk6bGFzdCBpbnB1dCcpLnZhbCh0aGlzLmlubmVySFRNTCk7CiAgICAgICAgICAgICAgICBNVUIubGlVcGRhdGVUZXN0TGluay5jYWxsKCQoJyNzb3VyY2VzIGxpOmxhc3QnKVswXSk7CiAgICAgICAgICAgICAgICAkKCcjcmVzdWx0cycpLmhpZGUoKTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfSkuYXR0cih7dGl0bGU6J0FkZCBmaWxlICsnfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gc2V0dXAgYm9va21hcmtsZXQgMQogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdXJsIDogJy4uLz9mPScgKyBsb2NhdGlvbi5wYXRobmFtZS5yZXBsYWNlKC9cL1teXC9dKiQvLCAnL2JtLmpzJykuc3Vic3RyKDEpLAogICAgICAgICAgICAgICAgc3VjY2VzcyA6IGZ1bmN0aW9uIChjb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI2JtJylbMF0uaHJlZiA9IGNvZGUKICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJyVCVUlMREVSX1VSTCUnLCBsb2NhdGlvbi5ocmVmKQogICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXG4vZywgJyAnKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBkYXRhVHlwZSA6ICd0ZXh0JwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKCQuYnJvd3Nlci5tc2llKSB7CiAgICAgICAgICAgICAgICAkKCcjZ2V0Qm0gcDpsYXN0JykuYXBwZW5kKCcgU29ycnksIG5vdCBzdXBwb3J0ZWQgaW4gTVNJRSEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBNVUIuYWRkQnV0dG9uQ2xpY2soKTsKICAgICAgICB9CiAgICAgICAgLy8gc2V0dXAgYm9va21hcmtsZXQgMgogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybCA6ICcuLi8/Zj0nICsgbG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgvXC9bXlwvXSokLywgJy9ibTIuanMnKS5zdWJzdHIoMSksCiAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbiAoY29kZSkgewogICAgICAgICAgICAgICAgJCgnI2JtMicpWzBdLmhyZWYgPSBjb2RlLnJlcGxhY2UoL1xuL2csICcgJyk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRhdGFUeXBlIDogJ3RleHQnCiAgICAgICAgfSk7CiAgICAgICAgTVVCLmNoZWNrUmV3cml0ZSgpOwogICAgfQp9OwokKE1VQi5pbml0KTs=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 05:24:49 GMT",
                    "Content-Length": "9113",
                    "Date": "Sat, 08 Nov 2014 05:24:49 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}