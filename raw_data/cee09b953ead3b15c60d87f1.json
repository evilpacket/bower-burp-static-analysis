{
    "url": "http://localhost:9999/benvanik/WebGL-Inspector/core/extensions/chrome/contentscript.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>the 'baseURI' property of a DOM element</b> and written to <b>the 'href' property of a DOM element</b> via the following statements:<ul><li>return safari.extension.baseURI;</li><li>var pathRoot = getExtensionURL();</li><li>var cssurl = pathRoot + \"gli.all.css\";</li><li>insertStylesheet(cssurl);</li><li>link.href = url;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/benvanik/WebGL-Inspector/core/extensions/chrome/contentscript.js",
                "path": "/benvanik/WebGL-Inspector/core/extensions/chrome/contentscript.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9iZW52YW5pay9XZWJHTC1JbnNwZWN0b3IvY29yZS9leHRlbnNpb25zL2Nocm9tZS9jb250ZW50c2NyaXB0LmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNzkwNg0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogU3VuLCAwOSBOb3YgMjAxNCAwMjoyNDozNiBHTVQNCkxhc3QtTW9kaWZpZWQ6IFN1biwgMDkgTm92IDIwMTQgMDI6MjQ6MzUgR01UDQoNCi8vdmFyIGRlYnVnTW9kZSA9IHRydWU7DQppZiAoIXdpbmRvd1siZGVidWdNb2RlIl0pIHsNCiAgICB3aW5kb3dbImRlYnVnTW9kZSJdID0gZmFsc2U7DQp9DQp2YXIgaGFzSW5qZWN0ZWQgPSBmYWxzZTsNCnZhciBzZXNzaW9uS2V5ID0gIldlYkdMSW5zcGVjdG9yRW5hYmxlZCIgKyAoZGVidWdNb2RlID8gIkRlYnVnIiA6ICIiKTsNCg0KZnVuY3Rpb24gZ2V0RXh0ZW5zaW9uVVJMKCkgew0KICAgIGlmICh3aW5kb3dbImNocm9tZSJdKSB7DQogICAgICAgIHJldHVybiBjaHJvbWUuZXh0ZW5zaW9uLmdldFVSTCgiIik7DQogICAgfSBlbHNlIGlmICh3aW5kb3dbInNhZmFyaSJdKSB7DQogICAgICAgIHJldHVybiBzYWZhcmkuZXh0ZW5zaW9uLmJhc2VVUkk7DQogICAgfQ0KfTsNCg0KZnVuY3Rpb24gbm90aWZ5UHJlc2VudCgpIHsNCiAgICBpZiAod2luZG93WyJjaHJvbWUiXSkgew0KICAgICAgICBjaHJvbWUuZXh0ZW5zaW9uLnNlbmRSZXF1ZXN0KHsgcHJlc2VudDogdHJ1ZSB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHsgfSk7DQogICAgfSBlbHNlIGlmICh3aW5kb3dbInNhZmFyaSJdKSB7DQogICAgICAgIHNhZmFyaS5zZWxmLnRhYi5kaXNwYXRjaE1lc3NhZ2UoIm5vdGlmeVByZXNlbnQiLCB7IHByZXNlbnQ6IHRydWUgfSk7DQogICAgfQ0KfTsNCg0KZnVuY3Rpb24gbm90aWZ5RW5hYmxlZChwcmVzZW50KSB7DQogICAgaWYgKHdpbmRvd1siY2hyb21lIl0pIHsNCiAgICAgICAgY2hyb21lLmV4dGVuc2lvbi5zZW5kUmVxdWVzdCh7IHByZXNlbnQ6IHByZXNlbnQgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7IH0pOw0KICAgIH0gZWxzZSBpZiAod2luZG93WyJzYWZhcmkiXSkgew0KICAgICAgICBzYWZhcmkuc2VsZi50YWIuZGlzcGF0Y2hNZXNzYWdlKCJtZXNzYWdlIiwgeyBwcmVzZW50OiBwcmVzZW50IH0pOw0KICAgIH0NCn07DQoNCmZ1bmN0aW9uIGxpc3RlbkZvck1lc3NhZ2UoY2FsbGJhY2spIHsNCiAgICBpZiAod2luZG93WyJjaHJvbWUiXSkgew0KICAgICAgICBjaHJvbWUuZXh0ZW5zaW9uLm9uUmVxdWVzdC5hZGRMaXN0ZW5lcihjYWxsYmFjayk7DQogICAgfSBlbHNlIGlmICh3aW5kb3dbInNhZmFyaSJdKSB7DQogICAgICAgIHNhZmFyaS5zZWxmLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBjYWxsYmFjayk7DQogICAgfQ0KfTsNCg0KZnVuY3Rpb24gaW5zZXJ0SGVhZGVyTm9kZShub2RlKSB7DQogICAgdmFyIHRhcmdldHMgPSBbZG9jdW1lbnQuYm9keSwgZG9jdW1lbnQuaGVhZCwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50XTsNCiAgICBmb3IgKHZhciBuID0gMDsgbiA8IHRhcmdldHMubGVuZ3RoOyBuKyspIHsNCiAgICAgICAgdmFyIHRhcmdldCA9IHRhcmdldHNbbl07DQogICAgICAgIGlmICh0YXJnZXQpIHsNCiAgICAgICAgICAgIGlmICh0YXJnZXQuZmlyc3RFbGVtZW50Q2hpbGQpIHsNCiAgICAgICAgICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKG5vZGUsIHRhcmdldC5maXJzdEVsZW1lbnRDaGlsZCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KfTsNCg0KZnVuY3Rpb24gaW5zZXJ0U3R5bGVzaGVldCh1cmwpIHsNCiAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpbmsiKTsNCiAgICBsaW5rLnJlbCA9ICJzdHlsZXNoZWV0IjsNCiAgICBsaW5rLmhyZWYgPSB1cmw7DQogICAgaW5zZXJ0SGVhZGVyTm9kZShsaW5rKTsNCiAgICByZXR1cm4gbGluazsNCn07DQoNCmZ1bmN0aW9uIGluc2VydFNjcmlwdCh1cmwpIHsNCiAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7DQogICAgc2NyaXB0LnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjsNCg0KICAgIC8vIFBsYWNlIHRoZSBlbnRpcmUgaW5zcGVjdG9yIGludG8gYSA8c2NyaXB0PiB0YWcgaW5zdGVhZCBvZiByZWZlcmVuY2luZw0KICAgIC8vIHRoZSBVUkwgLSB0aGlzIGVuYWJsZXMgc3luY2hyb25vdXMgbG9hZGluZyBhbmQgaW5zcGVjdGlvbiBvZiBjb2RlDQogICAgLy8gY3JlYXRpbmcgY29udGV4dHMgYmVmb3JlIGRvbSByZWFkeS4NCiAgICAvLyBJdCdzIG5hc3R5LCB0aG91Z2gsIGFzIGRldiB0b29scyBzaG93cyBpdCBhcyBhbm90aGVyIHNjcmlwdCBncm91cCBvbg0KICAgIC8vIHRoZSBtYWluIHBhZ2UuDQogICAgLy8gc2NyaXB0LnNyYyA9IHVybDsNCiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7DQogICAgeGhyLm9wZW4oJ0dFVCcsIHVybCwgZmFsc2UpOw0KICAgIHhoci5zZW5kKCcnKTsNCiAgICBzY3JpcHQudGV4dCA9IHhoci5yZXNwb25zZVRleHQ7DQoNCiAgICBpbnNlcnRIZWFkZXJOb2RlKHNjcmlwdCk7DQogICAgcmV0dXJuIHNjcmlwdDsNCn07DQoNCg0KLy8gSWYgd2UncmUgcmVsb2FkaW5nIGFmdGVyIGVuYWJsaW5nIHRoZSBpbnNwZWN0b3IsIGxvYWQgaW1tZWRpYXRlbHkNCmlmIChzZXNzaW9uU3RvcmFnZVtzZXNzaW9uS2V5XSA9PSAieWVzIikgew0KICAgIGhhc0luamVjdGVkID0gdHJ1ZTsNCg0KICAgIHZhciBwYXRoUm9vdCA9IGdldEV4dGVuc2lvblVSTCgpOw0KDQogICAgaWYgKGRlYnVnTW9kZSkgew0KICAgICAgICAvLyBXZSBoYXZlIHRoZSBsb2FkZXIuanMgZmlsZSByZWFkeSB0byBoZWxwIG91dA0KICAgICAgICBnbGlsb2FkZXIucGF0aFJvb3QgPSBwYXRoUm9vdDsNCiAgICAgICAgZ2xpbG9hZGVyLmxvYWQoWyJsb2FkZXIiLCAiaG9zdCIsICJyZXBsYXkiLCAidWkiXSwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgLy8gPw0KICAgICAgICB9KTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB2YXIganN1cmwgPSBwYXRoUm9vdCArICJnbGkuYWxsLmpzIjsNCiAgICAgICAgdmFyIGNzc3VybCA9IHBhdGhSb290ICsgImdsaS5hbGwuY3NzIjsNCg0KICAgICAgICBpbnNlcnRTdHlsZXNoZWV0KGNzc3VybCk7DQogICAgICAgIGluc2VydFNjcmlwdChqc3VybCk7DQogICAgfQ0KDQogICAgbm90aWZ5UHJlc2VudCgpOw0KfQ0KDQovLyBPbmNlIHRoZSBET00gaXMgcmVhZHksIGJpbmQgdG8gdGhlIGNvbnRlbnQgZXZlbnQNCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBmdW5jdGlvbiAoKSB7DQogICAgbGlzdGVuRm9yTWVzc2FnZShmdW5jdGlvbiAobXNnKSB7DQogICAgICAgIGlmIChzZXNzaW9uU3RvcmFnZVtzZXNzaW9uS2V5XSA9PSAieWVzIikgew0KICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Vbc2Vzc2lvbktleV0gPSAibm8iOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Vbc2Vzc2lvbktleV0gPSAieWVzIg0KICAgICAgICB9DQogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsNCiAgICB9KTsNCg0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIldlYkdMRW5hYmxlZEV2ZW50IiwgZnVuY3Rpb24gKCkgew0KICAgICAgICBub3RpZnlFbmFibGVkKHRydWUpOw0KICAgIH0sIGZhbHNlKTsNCg0KICAgIC8vIFNldHVwIG1lc3NhZ2UgcGFzc2luZyBmb3IgcGF0aCByb290IGludGVyY2hhbmdlDQogICAgaWYgKHNlc3Npb25TdG9yYWdlW3Nlc3Npb25LZXldID09ICJ5ZXMiKSB7DQogICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIl9fd2ViZ2xwYXRocm9vdCIpKSB7DQogICAgICAgICAgICB2YXIgcGF0aEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsNCiAgICAgICAgICAgIHBhdGhFbGVtZW50LmlkID0gIl9fd2ViZ2xwYXRocm9vdCI7DQogICAgICAgICAgICBwYXRoRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwYXRoRWxlbWVudCk7DQogICAgICAgIH0NCg0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciByZWFkeUV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkV2ZW50Iik7DQogICAgICAgICAgICByZWFkeUV2ZW50LmluaXRFdmVudCgiV2ViR0xJbnNwZWN0b3JSZWFkeUV2ZW50IiwgdHJ1ZSwgdHJ1ZSk7DQogICAgICAgICAgICB2YXIgcGF0aEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiX193ZWJnbHBhdGhyb290Iik7DQogICAgICAgICAgICBwYXRoRWxlbWVudC5pbm5lclRleHQgPSBnZXRFeHRlbnNpb25VUkwoKTsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuZGlzcGF0Y2hFdmVudChyZWFkeUV2ZW50KTsNCiAgICAgICAgfSwgMCk7DQogICAgfQ0KfSwgZmFsc2UpOw0KDQovLyBBbHdheXMgc3RhcnQgYWJzZW50DQpub3RpZnlFbmFibGVkKGZhbHNlKTsNCg0KLy8gLS0tLS0tLS0tIE5PVEU6IFRISVMgRlVOQ1RJT04gSVMgSU5KRUNURUQgSU5UTyBUSEUgUEFHRSBESVJFQ1RMWSAtLS0tLS0tLS0NCi8vIFRoaXMgcmVsaWVzIG9uIHVzIGJlaW5nIGV4ZWN1dGVkIGJlZm9yZSB0aGUgZG9tIGlzIHJlYWR5IHNvIHRoYXQgd2UgY2FuIG92ZXJ3cml0ZSBhbnkgY2FsbHMNCi8vIHRvIGNhbnZhcy5nZXRDb250ZXh0LiBXaGVuIGEgY2FsbCBpcyBtYWRlLCB3ZSBmaXJlIG9mZiBhbiBldmVudCB0aGF0IGlzIGhhbmRsZWQgaW4gb3VyIGV4dGVuc2lvbg0KLy8gYWJvdmUgKGFzIGNocm9tZS5leHRlbnNpb24uKiBpcyBub3QgYXZhaWxhYmxlIGZyb20gdGhlIHBhZ2UpLg0KZnVuY3Rpb24gbWFpbigpIHsNCiAgICAvLyBDcmVhdGUgZW5hYmxlZCBldmVudA0KICAgIGZ1bmN0aW9uIGZpcmVFbmFibGVkRXZlbnQoKSB7DQogICAgICAgIC8vIElmIGdsaSBleGlzdHMsIHRoZW4gd2UgYXJlIGFscmVhZHkgcHJlc2VudCBhbmQgc2hvdWxkbid0IGRvIGFueXRoaW5nDQogICAgICAgIGlmICghd2luZG93LmdsaSkgew0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGVuYWJsZWRFdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCJFdmVudCIpOw0KICAgICAgICAgICAgICAgIGVuYWJsZWRFdmVudC5pbml0RXZlbnQoIldlYkdMRW5hYmxlZEV2ZW50IiwgdHJ1ZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChlbmFibGVkRXZlbnQpOw0KICAgICAgICAgICAgfSwgMCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJXZWJHTCBJbnNwZWN0b3IgYWxyZWFkeSBlbWJlZGRlZCBvbiB0aGUgcGFnZSAtIGRpc2FibGluZyBleHRlbnNpb24iKTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICAvLyBHcmFiIHRoZSBwYXRoIHJvb3QgZnJvbSB0aGUgZXh0ZW5zaW9uDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiV2ViR0xJbnNwZWN0b3JSZWFkeUV2ZW50IiwgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgdmFyIHBhdGhFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIl9fd2ViZ2xwYXRocm9vdCIpOw0KICAgICAgICBpZiAod2luZG93WyJnbGlsb2FkZXIiXSkgew0KICAgICAgICAgICAgZ2xpbG9hZGVyLnBhdGhSb290ID0gcGF0aEVsZW1lbnQuaW5uZXJUZXh0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gVE9ETzogbW9yZT8NCiAgICAgICAgICAgIHdpbmRvdy5nbGlDc3NVcmwgPSBwYXRoRWxlbWVudC5pbm5lclRleHQgKyAiZ2xpLmFsbC5jc3MiOw0KICAgICAgICB9DQogICAgfSwgZmFsc2UpOw0KDQogICAgLy8gUmV3cml0ZSBnZXRDb250ZXh0IHRvIHNub29wIGZvciB3ZWJnbA0KICAgIHZhciBvcmlnaW5hbEdldENvbnRleHQgPSBIVE1MQ2FudmFzRWxlbWVudC5wcm90b3R5cGUuZ2V0Q29udGV4dDsNCiAgICBpZiAoIUhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZS5nZXRDb250ZXh0UmF3KSB7DQogICAgICAgIEhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZS5nZXRDb250ZXh0UmF3ID0gb3JpZ2luYWxHZXRDb250ZXh0Ow0KICAgIH0NCiAgICBIVE1MQ2FudmFzRWxlbWVudC5wcm90b3R5cGUuZ2V0Q29udGV4dCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIGlnbm9yZUNhbnZhcyA9IHRoaXMuaW50ZXJuYWxJbnNwZWN0b3JTdXJmYWNlOw0KICAgICAgICBpZiAoaWdub3JlQ2FudmFzKSB7DQogICAgICAgICAgICByZXR1cm4gb3JpZ2luYWxHZXRDb250ZXh0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgcmVzdWx0ID0gb3JpZ2luYWxHZXRDb250ZXh0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7DQogICAgICAgIGlmIChyZXN1bHQgPT0gbnVsbCkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgY29udGV4dE5hbWVzID0gWyJtb3otd2ViZ2wiLCAid2Via2l0LTNkIiwgImV4cGVyaW1lbnRhbC13ZWJnbCIsICJ3ZWJnbCIsICIzZCJdOw0KICAgICAgICB2YXIgcmVxdWVzdGluZ1dlYkdMID0gY29udGV4dE5hbWVzLmluZGV4T2YoYXJndW1lbnRzWzBdKSAhPSAtMTsNCiAgICAgICAgaWYgKHJlcXVlc3RpbmdXZWJHTCkgew0KICAgICAgICAgICAgLy8gUGFnZSBpcyByZXF1ZXN0aW5nIGEgV2ViR0wgY29udGV4dCENCiAgICAgICAgICAgIGZpcmVFbmFibGVkRXZlbnQodGhpcyk7DQoNCiAgICAgICAgICAgIC8vIElmIHdlIGFyZSBpbmplY3RlZCwgaW5zcGVjdCB0aGlzIGNvbnRleHQNCiAgICAgICAgICAgIGlmICh3aW5kb3cuZ2xpKSB7DQogICAgICAgICAgICAgICAgaWYgKGdsaS5ob3N0Lmluc3BlY3RDb250ZXh0KSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IHB1bGwgb3B0aW9ucyBmcm9tIGV4dGVuc2lvbg0KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBnbGkuaG9zdC5pbnNwZWN0Q29udGV4dCh0aGlzLCByZXN1bHQpOw0KICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBleGVjdXRlIGluIGEgdGltZW91dCBzbyB0aGF0IGlmIHRoZSBkb20gaXMgbm90IHlldA0KICAgICAgICAgICAgICAgICAgICAvLyBsb2FkZWQgdGhpcyB3b24ndCBlcnJvciBvdXQuDQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3RVSSA9IG5ldyBnbGkuaG9zdC5Ib3N0VUkocmVzdWx0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0VUkgPSBob3N0VUk7IC8vIGp1c3Qgc28gd2UgY2FuIGFjY2VzcyBpdCBsYXRlciBmb3IgZGVidWdnaW5nDQogICAgICAgICAgICAgICAgICAgIH0sIDApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfTsNCn0NCg0KLy8gVE9ETzogYmV0dGVyIGNvbnRlbnQgdHlwZSBjaGVja3MgKGlmIHBvc3NpYmxlPykNCnZhciBsaWtlbHlIVE1MID0gdHJ1ZTsNCmlmIChkb2N1bWVudC54bWxWZXJzaW9uKSB7DQogICAgbGlrZWx5SFRNTCA9IGZhbHNlOw0KfQ0KDQppZiAobGlrZWx5SFRNTCkgew0KICAgIHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsNCiAgICBzY3JpcHQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJygnICsgbWFpbiArICcpKCk7JykpOw0KICAgIGlmIChkb2N1bWVudC5ib2R5IHx8IGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSB7DQogICAgICAgIC8vIE5PVEU6IG9ubHkgdmFsaWQgaHRtbCBkb2N1bWVudHMgZ2V0IGJvZHkvaGVhZCwgc28gdGhpcyBpcyBhIG5pY2Ugd2F5IHRvIG5vdCBpbmplY3Qgb24gdGhlbQ0KICAgICAgICAoZG9jdW1lbnQuYm9keSB8fCBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuYXBwZW5kQ2hpbGQoc2NyaXB0KTsNCiAgICB9DQp9DQo=",
                "body": "Ly92YXIgZGVidWdNb2RlID0gdHJ1ZTsNCmlmICghd2luZG93WyJkZWJ1Z01vZGUiXSkgew0KICAgIHdpbmRvd1siZGVidWdNb2RlIl0gPSBmYWxzZTsNCn0NCnZhciBoYXNJbmplY3RlZCA9IGZhbHNlOw0KdmFyIHNlc3Npb25LZXkgPSAiV2ViR0xJbnNwZWN0b3JFbmFibGVkIiArIChkZWJ1Z01vZGUgPyAiRGVidWciIDogIiIpOw0KDQpmdW5jdGlvbiBnZXRFeHRlbnNpb25VUkwoKSB7DQogICAgaWYgKHdpbmRvd1siY2hyb21lIl0pIHsNCiAgICAgICAgcmV0dXJuIGNocm9tZS5leHRlbnNpb24uZ2V0VVJMKCIiKTsNCiAgICB9IGVsc2UgaWYgKHdpbmRvd1sic2FmYXJpIl0pIHsNCiAgICAgICAgcmV0dXJuIHNhZmFyaS5leHRlbnNpb24uYmFzZVVSSTsNCiAgICB9DQp9Ow0KDQpmdW5jdGlvbiBub3RpZnlQcmVzZW50KCkgew0KICAgIGlmICh3aW5kb3dbImNocm9tZSJdKSB7DQogICAgICAgIGNocm9tZS5leHRlbnNpb24uc2VuZFJlcXVlc3QoeyBwcmVzZW50OiB0cnVlIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkgeyB9KTsNCiAgICB9IGVsc2UgaWYgKHdpbmRvd1sic2FmYXJpIl0pIHsNCiAgICAgICAgc2FmYXJpLnNlbGYudGFiLmRpc3BhdGNoTWVzc2FnZSgibm90aWZ5UHJlc2VudCIsIHsgcHJlc2VudDogdHJ1ZSB9KTsNCiAgICB9DQp9Ow0KDQpmdW5jdGlvbiBub3RpZnlFbmFibGVkKHByZXNlbnQpIHsNCiAgICBpZiAod2luZG93WyJjaHJvbWUiXSkgew0KICAgICAgICBjaHJvbWUuZXh0ZW5zaW9uLnNlbmRSZXF1ZXN0KHsgcHJlc2VudDogcHJlc2VudCB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHsgfSk7DQogICAgfSBlbHNlIGlmICh3aW5kb3dbInNhZmFyaSJdKSB7DQogICAgICAgIHNhZmFyaS5zZWxmLnRhYi5kaXNwYXRjaE1lc3NhZ2UoIm1lc3NhZ2UiLCB7IHByZXNlbnQ6IHByZXNlbnQgfSk7DQogICAgfQ0KfTsNCg0KZnVuY3Rpb24gbGlzdGVuRm9yTWVzc2FnZShjYWxsYmFjaykgew0KICAgIGlmICh3aW5kb3dbImNocm9tZSJdKSB7DQogICAgICAgIGNocm9tZS5leHRlbnNpb24ub25SZXF1ZXN0LmFkZExpc3RlbmVyKGNhbGxiYWNrKTsNCiAgICB9IGVsc2UgaWYgKHdpbmRvd1sic2FmYXJpIl0pIHsNCiAgICAgICAgc2FmYXJpLnNlbGYuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGNhbGxiYWNrKTsNCiAgICB9DQp9Ow0KDQpmdW5jdGlvbiBpbnNlcnRIZWFkZXJOb2RlKG5vZGUpIHsNCiAgICB2YXIgdGFyZ2V0cyA9IFtkb2N1bWVudC5ib2R5LCBkb2N1bWVudC5oZWFkLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRdOw0KICAgIGZvciAodmFyIG4gPSAwOyBuIDwgdGFyZ2V0cy5sZW5ndGg7IG4rKykgew0KICAgICAgICB2YXIgdGFyZ2V0ID0gdGFyZ2V0c1tuXTsNCiAgICAgICAgaWYgKHRhcmdldCkgew0KICAgICAgICAgICAgaWYgKHRhcmdldC5maXJzdEVsZW1lbnRDaGlsZCkgew0KICAgICAgICAgICAgICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgdGFyZ2V0LmZpcnN0RWxlbWVudENoaWxkKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGFyZ2V0LmFwcGVuZENoaWxkKG5vZGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICB9DQp9Ow0KDQpmdW5jdGlvbiBpbnNlcnRTdHlsZXNoZWV0KHVybCkgew0KICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGluayIpOw0KICAgIGxpbmsucmVsID0gInN0eWxlc2hlZXQiOw0KICAgIGxpbmsuaHJlZiA9IHVybDsNCiAgICBpbnNlcnRIZWFkZXJOb2RlKGxpbmspOw0KICAgIHJldHVybiBsaW5rOw0KfTsNCg0KZnVuY3Rpb24gaW5zZXJ0U2NyaXB0KHVybCkgew0KICAgIHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsNCiAgICBzY3JpcHQudHlwZSA9ICJ0ZXh0L2phdmFzY3JpcHQiOw0KDQogICAgLy8gUGxhY2UgdGhlIGVudGlyZSBpbnNwZWN0b3IgaW50byBhIDxzY3JpcHQ+IHRhZyBpbnN0ZWFkIG9mIHJlZmVyZW5jaW5nDQogICAgLy8gdGhlIFVSTCAtIHRoaXMgZW5hYmxlcyBzeW5jaHJvbm91cyBsb2FkaW5nIGFuZCBpbnNwZWN0aW9uIG9mIGNvZGUNCiAgICAvLyBjcmVhdGluZyBjb250ZXh0cyBiZWZvcmUgZG9tIHJlYWR5Lg0KICAgIC8vIEl0J3MgbmFzdHksIHRob3VnaCwgYXMgZGV2IHRvb2xzIHNob3dzIGl0IGFzIGFub3RoZXIgc2NyaXB0IGdyb3VwIG9uDQogICAgLy8gdGhlIG1haW4gcGFnZS4NCiAgICAvLyBzY3JpcHQuc3JjID0gdXJsOw0KICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCiAgICB4aHIub3BlbignR0VUJywgdXJsLCBmYWxzZSk7DQogICAgeGhyLnNlbmQoJycpOw0KICAgIHNjcmlwdC50ZXh0ID0geGhyLnJlc3BvbnNlVGV4dDsNCg0KICAgIGluc2VydEhlYWRlck5vZGUoc2NyaXB0KTsNCiAgICByZXR1cm4gc2NyaXB0Ow0KfTsNCg0KDQovLyBJZiB3ZSdyZSByZWxvYWRpbmcgYWZ0ZXIgZW5hYmxpbmcgdGhlIGluc3BlY3RvciwgbG9hZCBpbW1lZGlhdGVseQ0KaWYgKHNlc3Npb25TdG9yYWdlW3Nlc3Npb25LZXldID09ICJ5ZXMiKSB7DQogICAgaGFzSW5qZWN0ZWQgPSB0cnVlOw0KDQogICAgdmFyIHBhdGhSb290ID0gZ2V0RXh0ZW5zaW9uVVJMKCk7DQoNCiAgICBpZiAoZGVidWdNb2RlKSB7DQogICAgICAgIC8vIFdlIGhhdmUgdGhlIGxvYWRlci5qcyBmaWxlIHJlYWR5IHRvIGhlbHAgb3V0DQogICAgICAgIGdsaWxvYWRlci5wYXRoUm9vdCA9IHBhdGhSb290Ow0KICAgICAgICBnbGlsb2FkZXIubG9hZChbImxvYWRlciIsICJob3N0IiwgInJlcGxheSIsICJ1aSJdLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAvLyA/DQogICAgICAgIH0pOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHZhciBqc3VybCA9IHBhdGhSb290ICsgImdsaS5hbGwuanMiOw0KICAgICAgICB2YXIgY3NzdXJsID0gcGF0aFJvb3QgKyAiZ2xpLmFsbC5jc3MiOw0KDQogICAgICAgIGluc2VydFN0eWxlc2hlZXQoY3NzdXJsKTsNCiAgICAgICAgaW5zZXJ0U2NyaXB0KGpzdXJsKTsNCiAgICB9DQoNCiAgICBub3RpZnlQcmVzZW50KCk7DQp9DQoNCi8vIE9uY2UgdGhlIERPTSBpcyByZWFkeSwgYmluZCB0byB0aGUgY29udGVudCBldmVudA0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGZ1bmN0aW9uICgpIHsNCiAgICBsaXN0ZW5Gb3JNZXNzYWdlKGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlW3Nlc3Npb25LZXldID09ICJ5ZXMiKSB7DQogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZVtzZXNzaW9uS2V5XSA9ICJubyI7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZVtzZXNzaW9uS2V5XSA9ICJ5ZXMiDQogICAgICAgIH0NCiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOw0KICAgIH0pOw0KDQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiV2ViR0xFbmFibGVkRXZlbnQiLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIG5vdGlmeUVuYWJsZWQodHJ1ZSk7DQogICAgfSwgZmFsc2UpOw0KDQogICAgLy8gU2V0dXAgbWVzc2FnZSBwYXNzaW5nIGZvciBwYXRoIHJvb3QgaW50ZXJjaGFuZ2UNCiAgICBpZiAoc2Vzc2lvblN0b3JhZ2Vbc2Vzc2lvbktleV0gPT0gInllcyIpIHsNCiAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiX193ZWJnbHBhdGhyb290IikpIHsNCiAgICAgICAgICAgIHZhciBwYXRoRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOw0KICAgICAgICAgICAgcGF0aEVsZW1lbnQuaWQgPSAiX193ZWJnbHBhdGhyb290IjsNCiAgICAgICAgICAgIHBhdGhFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBhdGhFbGVtZW50KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHJlYWR5RXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgiRXZlbnQiKTsNCiAgICAgICAgICAgIHJlYWR5RXZlbnQuaW5pdEV2ZW50KCJXZWJHTEluc3BlY3RvclJlYWR5RXZlbnQiLCB0cnVlLCB0cnVlKTsNCiAgICAgICAgICAgIHZhciBwYXRoRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJfX3dlYmdscGF0aHJvb3QiKTsNCiAgICAgICAgICAgIHBhdGhFbGVtZW50LmlubmVyVGV4dCA9IGdldEV4dGVuc2lvblVSTCgpOw0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5kaXNwYXRjaEV2ZW50KHJlYWR5RXZlbnQpOw0KICAgICAgICB9LCAwKTsNCiAgICB9DQp9LCBmYWxzZSk7DQoNCi8vIEFsd2F5cyBzdGFydCBhYnNlbnQNCm5vdGlmeUVuYWJsZWQoZmFsc2UpOw0KDQovLyAtLS0tLS0tLS0gTk9URTogVEhJUyBGVU5DVElPTiBJUyBJTkpFQ1RFRCBJTlRPIFRIRSBQQUdFIERJUkVDVExZIC0tLS0tLS0tLQ0KLy8gVGhpcyByZWxpZXMgb24gdXMgYmVpbmcgZXhlY3V0ZWQgYmVmb3JlIHRoZSBkb20gaXMgcmVhZHkgc28gdGhhdCB3ZSBjYW4gb3ZlcndyaXRlIGFueSBjYWxscw0KLy8gdG8gY2FudmFzLmdldENvbnRleHQuIFdoZW4gYSBjYWxsIGlzIG1hZGUsIHdlIGZpcmUgb2ZmIGFuIGV2ZW50IHRoYXQgaXMgaGFuZGxlZCBpbiBvdXIgZXh0ZW5zaW9uDQovLyBhYm92ZSAoYXMgY2hyb21lLmV4dGVuc2lvbi4qIGlzIG5vdCBhdmFpbGFibGUgZnJvbSB0aGUgcGFnZSkuDQpmdW5jdGlvbiBtYWluKCkgew0KICAgIC8vIENyZWF0ZSBlbmFibGVkIGV2ZW50DQogICAgZnVuY3Rpb24gZmlyZUVuYWJsZWRFdmVudCgpIHsNCiAgICAgICAgLy8gSWYgZ2xpIGV4aXN0cywgdGhlbiB3ZSBhcmUgYWxyZWFkeSBwcmVzZW50IGFuZCBzaG91bGRuJ3QgZG8gYW55dGhpbmcNCiAgICAgICAgaWYgKCF3aW5kb3cuZ2xpKSB7DQogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB2YXIgZW5hYmxlZEV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkV2ZW50Iik7DQogICAgICAgICAgICAgICAgZW5hYmxlZEV2ZW50LmluaXRFdmVudCgiV2ViR0xFbmFibGVkRXZlbnQiLCB0cnVlLCB0cnVlKTsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGVuYWJsZWRFdmVudCk7DQogICAgICAgICAgICB9LCAwKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIldlYkdMIEluc3BlY3RvciBhbHJlYWR5IGVtYmVkZGVkIG9uIHRoZSBwYWdlIC0gZGlzYWJsaW5nIGV4dGVuc2lvbiIpOw0KICAgICAgICB9DQogICAgfTsNCg0KICAgIC8vIEdyYWIgdGhlIHBhdGggcm9vdCBmcm9tIHRoZSBleHRlbnNpb24NCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJXZWJHTEluc3BlY3RvclJlYWR5RXZlbnQiLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICB2YXIgcGF0aEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiX193ZWJnbHBhdGhyb290Iik7DQogICAgICAgIGlmICh3aW5kb3dbImdsaWxvYWRlciJdKSB7DQogICAgICAgICAgICBnbGlsb2FkZXIucGF0aFJvb3QgPSBwYXRoRWxlbWVudC5pbm5lclRleHQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBUT0RPOiBtb3JlPw0KICAgICAgICAgICAgd2luZG93LmdsaUNzc1VybCA9IHBhdGhFbGVtZW50LmlubmVyVGV4dCArICJnbGkuYWxsLmNzcyI7DQogICAgICAgIH0NCiAgICB9LCBmYWxzZSk7DQoNCiAgICAvLyBSZXdyaXRlIGdldENvbnRleHQgdG8gc25vb3AgZm9yIHdlYmdsDQogICAgdmFyIG9yaWdpbmFsR2V0Q29udGV4dCA9IEhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZS5nZXRDb250ZXh0Ow0KICAgIGlmICghSFRNTENhbnZhc0VsZW1lbnQucHJvdG90eXBlLmdldENvbnRleHRSYXcpIHsNCiAgICAgICAgSFRNTENhbnZhc0VsZW1lbnQucHJvdG90eXBlLmdldENvbnRleHRSYXcgPSBvcmlnaW5hbEdldENvbnRleHQ7DQogICAgfQ0KICAgIEhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZS5nZXRDb250ZXh0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgaWdub3JlQ2FudmFzID0gdGhpcy5pbnRlcm5hbEluc3BlY3RvclN1cmZhY2U7DQogICAgICAgIGlmIChpZ25vcmVDYW52YXMpIHsNCiAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbEdldENvbnRleHQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHZhciByZXN1bHQgPSBvcmlnaW5hbEdldENvbnRleHQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsNCiAgICAgICAgaWYgKHJlc3VsdCA9PSBudWxsKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHZhciBjb250ZXh0TmFtZXMgPSBbIm1vei13ZWJnbCIsICJ3ZWJraXQtM2QiLCAiZXhwZXJpbWVudGFsLXdlYmdsIiwgIndlYmdsIiwgIjNkIl07DQogICAgICAgIHZhciByZXF1ZXN0aW5nV2ViR0wgPSBjb250ZXh0TmFtZXMuaW5kZXhPZihhcmd1bWVudHNbMF0pICE9IC0xOw0KICAgICAgICBpZiAocmVxdWVzdGluZ1dlYkdMKSB7DQogICAgICAgICAgICAvLyBQYWdlIGlzIHJlcXVlc3RpbmcgYSBXZWJHTCBjb250ZXh0IQ0KICAgICAgICAgICAgZmlyZUVuYWJsZWRFdmVudCh0aGlzKTsNCg0KICAgICAgICAgICAgLy8gSWYgd2UgYXJlIGluamVjdGVkLCBpbnNwZWN0IHRoaXMgY29udGV4dA0KICAgICAgICAgICAgaWYgKHdpbmRvdy5nbGkpIHsNCiAgICAgICAgICAgICAgICBpZiAoZ2xpLmhvc3QuaW5zcGVjdENvbnRleHQpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogcHVsbCBvcHRpb25zIGZyb20gZXh0ZW5zaW9uDQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGdsaS5ob3N0Lmluc3BlY3RDb250ZXh0KHRoaXMsIHJlc3VsdCk7DQogICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IGV4ZWN1dGUgaW4gYSB0aW1lb3V0IHNvIHRoYXQgaWYgdGhlIGRvbSBpcyBub3QgeWV0DQogICAgICAgICAgICAgICAgICAgIC8vIGxvYWRlZCB0aGlzIHdvbid0IGVycm9yIG91dC4NCiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdFVJID0gbmV3IGdsaS5ob3N0Lkhvc3RVSShyZXN1bHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3RVSSA9IGhvc3RVSTsgLy8ganVzdCBzbyB3ZSBjYW4gYWNjZXNzIGl0IGxhdGVyIGZvciBkZWJ1Z2dpbmcNCiAgICAgICAgICAgICAgICAgICAgfSwgMCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHJlc3VsdDsNCiAgICB9Ow0KfQ0KDQovLyBUT0RPOiBiZXR0ZXIgY29udGVudCB0eXBlIGNoZWNrcyAoaWYgcG9zc2libGU/KQ0KdmFyIGxpa2VseUhUTUwgPSB0cnVlOw0KaWYgKGRvY3VtZW50LnhtbFZlcnNpb24pIHsNCiAgICBsaWtlbHlIVE1MID0gZmFsc2U7DQp9DQoNCmlmIChsaWtlbHlIVE1MKSB7DQogICAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOw0KICAgIHNjcmlwdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnKCcgKyBtYWluICsgJykoKTsnKSk7DQogICAgaWYgKGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpIHsNCiAgICAgICAgLy8gTk9URTogb25seSB2YWxpZCBodG1sIGRvY3VtZW50cyBnZXQgYm9keS9oZWFkLCBzbyB0aGlzIGlzIGEgbmljZSB3YXkgdG8gbm90IGluamVjdCBvbiB0aGVtDQogICAgICAgIChkb2N1bWVudC5ib2R5IHx8IGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hcHBlbmRDaGlsZChzY3JpcHQpOw0KICAgIH0NCn0NCg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sun, 09 Nov 2014 02:24:35 GMT",
                    "Content-Length": "7906",
                    "Date": "Sun, 09 Nov 2014 02:24:36 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}