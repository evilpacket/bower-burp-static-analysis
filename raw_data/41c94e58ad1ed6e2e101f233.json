{
    "url": "http://localhost:9999/jkphl/TYPO3-ext-squeezr/Resources/Private/Squeezr/squeezr/plugins/minify/min/builder/index.php",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>location.pathname</b> and written to <b>document.write()</b> via the following statements:<ul><li>var src = \"../?f=\" + location.pathname.replace(/\\/[^\\/]*$/, '/_index.js').substr(1);</li><li>document.write('&lt;\\script src=\"' + src + '\"&gt;&lt;\\/script&gt;');</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/jkphl/TYPO3-ext-squeezr/Resources/Private/Squeezr/squeezr/plugins/minify/min/builder/index.php",
                "path": "/jkphl/TYPO3-ext-squeezr/Resources/Private/Squeezr/squeezr/plugins/minify/min/builder/index.php",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9qa3BobC9UWVBPMy1leHQtc3F1ZWV6ci9SZXNvdXJjZXMvUHJpdmF0ZS9TcXVlZXpyL3NxdWVlenIvcGx1Z2lucy9taW5pZnkvbWluL2J1aWxkZXIvaW5kZXgucGhwIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogOTkwNA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD11dGYtOA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAwNToyNDo0OSBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMDU6MjQ6NDkgR01UDQoNCjw/cGhwIAoKaWYgKHBocHZlcnNpb24oKSA8IDUpIHsKICAgIGV4aXQoJ01pbmlmeSByZXF1aXJlcyBQSFA1IG9yIGdyZWF0ZXIuJyk7Cn0KCi8vIGNoZWNrIGZvciBhdXRvLWVuY29kaW5nCiRlbmNvZGVPdXRwdXQgPSAoZnVuY3Rpb25fZXhpc3RzKCdnemRlZmxhdGUnKQogICAgICAgICAgICAgICAgICYmICFpbmlfZ2V0KCd6bGliLm91dHB1dF9jb21wcmVzc2lvbicpKTsKCi8vIHJlY29tbWVuZCAkbWluX3N5bWxpbmtzIHNldHRpbmcgZm9yIEFwYWNoZSBVc2VyRGlyCiRzeW1saW5rT3B0aW9uID0gJyc7CmlmICgwID09PSBzdHJwb3MoJF9TRVJWRVJbIlNFUlZFUl9TT0ZUV0FSRSJdLCAnQXBhY2hlLycpCiAgICAmJiBwcmVnX21hdGNoKCdAXi9cXH4oXFx3KykvQCcsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSkKKSB7CiAgICAkdXNlckRpciA9IERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkbVsxXSAuIERJUkVDVE9SWV9TRVBBUkFUT1I7CiAgICBpZiAoZmFsc2UgIT09IHN0cnBvcyhfX0ZJTEVfXywgJHVzZXJEaXIpKSB7CiAgICAgICAgJHNtID0gYXJyYXkoKTsKICAgICAgICAkc21bIi8vfnskbVsxXX0iXSA9IGRpcm5hbWUoZGlybmFtZShfX0ZJTEVfXykpOwogICAgICAgICRhcnJheSA9IHN0cl9yZXBsYWNlKCdhcnJheSAoJywgJ2FycmF5KCcsIHZhcl9leHBvcnQoJHNtLCAxKSk7CiAgICAgICAgJHN5bWxpbmtPcHRpb24gPSAiXCRtaW5fc3ltbGlua3MgPSAkYXJyYXk7IjsKICAgIH0KfQoKcmVxdWlyZSBkaXJuYW1lKF9fRklMRV9fKSAuICcvLi4vY29uZmlnLnBocCc7CgppZiAoISAkbWluX2VuYWJsZUJ1aWxkZXIpIHsKICAgIGhlYWRlcignTG9jYXRpb246IC8nKTsKICAgIGV4aXQoKTsKfQoKJHNldEluY2x1ZGVTdWNjZXNzID0gc2V0X2luY2x1ZGVfcGF0aChkaXJuYW1lKF9fRklMRV9fKSAuICcvLi4vbGliJyAuIFBBVEhfU0VQQVJBVE9SIC4gZ2V0X2luY2x1ZGVfcGF0aCgpKTsKLy8gd2UgZG8gaXQgdGhpcyB3YXkgYmVjYXVzZSB3ZSB3YW50IHRoZSBidWlsZGVyIHRvIHdvcmsgYWZ0ZXIgdGhlIHVzZXIgY29ycmVjdHMKLy8gaW5jbHVkZV9wYXRoLiAoc2V0X2luY2x1ZGVfcGF0aCByZXR1cm5pbmcgRkFMU0UgaXMgT0spLgp0cnkgewogICAgcmVxdWlyZV9vbmNlICdNaW5pZnkvQ2FjaGUvRmlsZS5waHAnOwp9IGNhdGNoIChFeGNlcHRpb24gJGUpIHsKICAgIGlmICghICRzZXRJbmNsdWRlU3VjY2VzcykgewogICAgICAgIGVjaG8gIk1pbmlmeTogc2V0X2luY2x1ZGVfcGF0aCgpIGZhaWxlZC4gWW91IG1heSBuZWVkIHRvIHNldCB5b3VyIGluY2x1ZGVfcGF0aCAiCiAgICAgICAgICAgIC4ib3V0c2lkZSBvZiBQSFAgY29kZSwgZS5nLiwgaW4gcGhwLmluaS4iOyAgICAKICAgIH0gZWxzZSB7CiAgICAgICAgZWNobyAkZS0+Z2V0TWVzc2FnZSgpOwogICAgfQogICAgZXhpdCgpOwp9CnJlcXVpcmUgJ01pbmlmeS5waHAnOwoKJGNhY2hlUGF0aENvZGUgPSAnJzsKaWYgKCEgaXNzZXQoJG1pbl9jYWNoZVBhdGgpICYmICEgZnVuY3Rpb25fZXhpc3RzKCdzeXNfZ2V0X3RlbXBfZGlyJykpIHsKICAgICRkZXRlY3RlZFRtcCA9IE1pbmlmeV9DYWNoZV9GaWxlOjp0bXAoKTsKICAgICRjYWNoZVBhdGhDb2RlID0gIlwkbWluX2NhY2hlUGF0aCA9ICIgLiB2YXJfZXhwb3J0KCRkZXRlY3RlZFRtcCwgMSkgLiAnOyc7Cn0KCm9iX3N0YXJ0KCk7Cj8+CjwhRE9DVFlQRSBodG1sPgo8dGl0bGU+TWluaWZ5IFVSSSBCdWlsZGVyPC90aXRsZT4KPG1ldGEgbmFtZT0iUk9CT1RTIiBjb250ZW50PSJOT0lOREVYLCBOT0ZPTExPVyI+CjxzdHlsZT4KYm9keSB7bWFyZ2luOjFlbSA2MHB4O30KaDEsIGgyLCBoMyB7bWFyZ2luLWxlZnQ6LTI1cHg7IHBvc2l0aW9uOnJlbGF0aXZlO30KaDEge21hcmdpbi10b3A6MDt9CiNzb3VyY2VzIHttYXJnaW46MDsgcGFkZGluZzowO30KI3NvdXJjZXMgbGkge21hcmdpbjowIDAgMCA0MHB4fQojc291cmNlcyBsaSBpbnB1dCB7bWFyZ2luLWxlZnQ6MnB4fQojYWRkIHttYXJnaW46NXB4IDAgMWVtIDQwcHh9Ci5oaWRlIHtkaXNwbGF5Om5vbmV9CiN1cmlUYWJsZSB7Ym9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlO30KI3VyaVRhYmxlIHRkLCAjdXJpVGFibGUgdGgge3BhZGRpbmctdG9wOjEwcHg7fQojdXJpVGFibGUgdGgge3BhZGRpbmctcmlnaHQ6MTBweDt9CiNncm91cENvbmZpZyB7Zm9udC1mYW1pbHk6bW9ub3NwYWNlO30KYiB7Y29sb3I6I2MwMH0KLnRvcE5vdGUge2JhY2tncm91bmQ6ICNmZjk7IGRpc3BsYXk6aW5saW5lLWJsb2NrOyBwYWRkaW5nOi41ZW0gLjZlbTsgbWFyZ2luOjAgMCAxZW07fQoudG9wV2FybmluZyB7YmFja2dyb3VuZDojYzAwOyBjb2xvcjojZmZmOyBwYWRkaW5nOi41ZW0gLjZlbTsgbWFyZ2luOjAgMCAxZW07fQoudG9wV2FybmluZyBhIHtjb2xvcjojZmZmO30KI2pzRGlkbnRMb2FkIHtkaXNwbGF5Om5vbmU7fQo8L3N0eWxlPgo8Ym9keT4KPD9waHAgaWYgKCRzeW1saW5rT3B0aW9uKTogPz4KICAgIDxkaXYgY2xhc3M9dG9wTm90ZT48c3Ryb25nPk5vdGU6PC9zdHJvbmc+IEl0IGxvb2tzIGxpa2UgeW91J3JlIHJ1bm5pbmcgTWluaWZ5IGluIGEgdXNlcgogZGlyZWN0b3J5LiBZb3UgbWF5IG5lZWQgdGhlIGZvbGxvd2luZyBvcHRpb24gaW4gL21pbi9jb25maWcucGhwIHRvIGhhdmUgVVJJcwogY29ycmVjdGx5IHJld3JpdHRlbiBpbiBDU1Mgb3V0cHV0OgogPGJyPjx0ZXh0YXJlYSBpZD1zeW1saW5rT3B0IHJvd3M9MyBjb2xzPTgwIHJlYWRvbmx5Pjw/cGhwIGVjaG8gaHRtbHNwZWNpYWxjaGFycygkc3ltbGlua09wdGlvbik7ID8+PC90ZXh0YXJlYT4KPC9kaXY+Cjw/cGhwIGVuZGlmOyA/PgoKPHAgY2xhc3M9dG9wV2FybmluZyBpZD1qc0RpZG50TG9hZD48c3Ryb25nPlVoIE9oLjwvc3Ryb25nPiBNaW5pZnkgd2FzIHVuYWJsZSB0bwogICAgc2VydmUgSmF2YXNjcmlwdCBmb3IgdGhpcyBhcHAuIFRvIHRyb3VibGVzaG9vdCB0aGlzLAogICAgPGEgaHJlZj0iaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL21pbmlmeS93aWtpL0RlYnVnZ2luZyI+ZW5hYmxlIEZpcmVQSFAgZGVidWdnaW5nPC9hPgogICAgYW5kIHJlcXVlc3QgdGhlIDxhIGlkPWJ1aWxkZXJTY3JpcHRTcmMgaHJlZj0jPk1pbmlmeSBVUkw8L2E+IGRpcmVjdGx5LiBIb3BlZnVsbHkgdGhlCiAgICBGaXJlUEhQIGNvbnNvbGUgd2lsbCByZXBvcnQgdGhlIGNhdXNlIG9mIHRoZSBlcnJvci4KPC9wPgoKPD9waHAgaWYgKCRjYWNoZVBhdGhDb2RlKTogPz4KPHAgY2xhc3M9dG9wTm90ZT48c3Ryb25nPk5vdGU6PC9zdHJvbmc+IDxjb2RlPjw/cGhwIGVjaG8KICAgIGh0bWxzcGVjaWFsY2hhcnMoJGRldGVjdGVkVG1wKTsgPz48L2NvZGU+IHdhcyBkaXNjb3ZlcmVkIGFzIGEgdXNhYmxlIHRlbXAgZGlyZWN0b3J5Ljxicj5UbwogICAgc2xpZ2h0bHkgaW1wcm92ZSBwZXJmb3JtYW5jZSB5b3UgY2FuIGhhcmRjb2RlIHRoaXMgaW4gL21pbi9jb25maWcucGhwOgogICAgPGNvZGU+PD9waHAgZWNobyBodG1sc3BlY2lhbGNoYXJzKCRjYWNoZVBhdGhDb2RlKTsgPz48L2NvZGU+PC9wPgo8P3BocCBlbmRJZjsgPz4KCjxwIGlkPW1pblJld3JpdGVGYWlsZWQgY2xhc3M9ImhpZGUiPjxzdHJvbmc+Tm90ZTo8L3N0cm9uZz4gWW91ciB3ZWJzZXJ2ZXIgZG9lcyBub3Qgc2VlbSB0bwogc3VwcG9ydCBtb2RfcmV3cml0ZSAodXNlZCBpbiAvbWluLy5odGFjY2VzcykuIFlvdXIgTWluaWZ5IFVSSXMgd2lsbCBjb250YWluICI/Iiwgd2hpY2ggCjxhIGhyZWY9Imh0dHA6Ly93d3cuc3RldmVzb3VkZXJzLmNvbS9ibG9nLzIwMDgvMDgvMjMvcmV2dmluZy1maWxlbmFtZXMtZG9udC11c2UtcXVlcnlzdHJpbmcvIgo+bWF5IHJlZHVjZSB0aGUgYmVuZWZpdCBvZiBwcm94eSBjYWNoZSBzZXJ2ZXJzPC9hPi48L3A+Cgo8aDE+TWluaWZ5IFVSSSBCdWlsZGVyPC9oMT4KCjxub3NjcmlwdD48cCBjbGFzcz0idG9wTm90ZSI+SmF2YXNjcmlwdCBhbmQgYSBicm93c2VyIHN1cHBvcnRlZCBieSBqUXVlcnkgMS4yLjYgaXMgcmVxdWlyZWQKZm9yIHRoaXMgYXBwbGljYXRpb24uPC9wPjwvbm9zY3JpcHQ+Cgo8ZGl2IGlkPWFwcCBjbGFzcz1oaWRlPgoKPHA+Q3JlYXRlIGEgbGlzdCBvZiBKYXZhc2NyaXB0IG9yIENTUyBmaWxlcyAob3IgMSBpcyBmaW5lKSB5b3UnZCBsaWtlIHRvIGNvbWJpbmUKYW5kIGNsaWNrIFtVcGRhdGVdLjwvcD4KCjxvbCBpZD1zb3VyY2VzPjxsaT48L2xpPjwvb2w+CjxkaXYgaWQ9YWRkPjxidXR0b24+QWRkIGZpbGUgKzwvYnV0dG9uPjwvZGl2PgoKPGRpdiBpZD1ibVVyaXM+PC9kaXY+Cgo8cD48YnV0dG9uIGlkPXVwZGF0ZSBjbGFzcz1oaWRlPlVwZGF0ZTwvYnV0dG9uPjwvcD4KCjxkaXYgaWQ9cmVzdWx0cyBjbGFzcz1oaWRlPgoKPGgyPk1pbmlmeSBVUkk8L2gyPgo8cD5QbGFjZSB0aGlzIFVSSSBpbiB5b3VyIEhUTUwgdG8gc2VydmUgdGhlIGZpbGVzIGFib3ZlIGNvbWJpbmVkLCBtaW5pZmllZCwgY29tcHJlc3NlZCBhbmQKd2l0aCBjYWNoZSBoZWFkZXJzLjwvcD4KPHRhYmxlIGlkPXVyaVRhYmxlPgogICAgPHRyPjx0aD5VUkk8L3RoPjx0ZD48YSBpZD11cmlBIGNsYXNzPWV4dD4vbWluPC9hPiA8c21hbGw+KG9wZW5zIGluIG5ldyB3aW5kb3cpPC9zbWFsbD48L3RkPjwvdHI+CiAgICA8dHI+PHRoPkhUTUw8L3RoPjx0ZD48aW5wdXQgaWQ9dXJpSHRtbCB0eXBlPXRleHQgc2l6ZT0xMDAgcmVhZG9ubHk+PC90ZD48L3RyPgo8L3RhYmxlPgoKPGgyPkhvdyB0byBzZXJ2ZSB0aGVzZSBmaWxlcyBhcyBhIGdyb3VwPC9oMj4KPHA+Rm9yIHRoZSBiZXN0IHBlcmZvcm1hbmNlIHlvdSBjYW4gc2VydmUgdGhlc2UgZmlsZXMgYXMgYSBwcmUtZGVmaW5lZCBncm91cCB3aXRoIGEgVVJJCmxpa2U6IDxjb2RlPjxzcGFuIGNsYXNzPW1pblJvb3Q+L21pbi8/PC9zcGFuPmc9a2V5TmFtZTwvY29kZT48L3A+CjxwPlRvIGRvIHRoaXMsIGFkZCBhIGxpbmUgbGlrZSB0aGlzIHRvIC9taW4vZ3JvdXBzQ29uZmlnLnBocDo8L3A+Cgo8cHJlPjxjb2RlPnJldHVybiBhcnJheSgKICAgIDxzcGFuIHN0eWxlPSJjb2xvcjojNjY2Ij4uLi4geW91ciBleGlzdGluZyBncm91cHMgaGVyZSAuLi48L3NwYW4+CjxpbnB1dCBpZD1ncm91cENvbmZpZyBzaXplPTEwMCB0eXBlPXRleHQgcmVhZG9ubHk+Cik7PC9jb2RlPjwvcHJlPgoKPHA+PGVtPk1ha2Ugc3VyZSB0byByZXBsYWNlIDxjb2RlPmtleU5hbWU8L2NvZGU+IHdpdGggYSB1bmlxdWUga2V5IGZvciB0aGlzIGdyb3VwLjwvZW0+PC9wPgo8L2Rpdj4KCjxkaXYgaWQ9Z2V0Qm0+CjxoMz5GaW5kIFVSSXMgb24gYSBQYWdlPC9oMz4KPHA+WW91IGNhbiB1c2UgdGhlIGJvb2ttYXJrbGV0IGJlbG93IHRvIGZldGNoIGFsbCBDU1MgJmFtcDsgSmF2YXNjcmlwdCBVUklzIGZyb20gYSBwYWdlCm9uIHlvdXIgc2l0ZS4gV2hlbiB5b3UgYWN0aXZlIGl0LCB0aGlzIHBhZ2Ugd2lsbCBvcGVuIGluIGEgbmV3IHdpbmRvdyB3aXRoIGEgbGlzdCBvZgphdmFpbGFibGUgVVJJcyB0byBhZGQuPC9wPgoKPHA+PGEgaWQ9Ym0+Q3JlYXRlIE1pbmlmeSBVUklzPC9hPiA8c21hbGw+KHJpZ2h0LWNsaWNrLCBhZGQgdG8gYm9va21hcmtzKTwvc21hbGw+PC9wPgo8L2Rpdj4KCjxoMz5Db21iaW5pbmcgQ1NTIGZpbGVzIHRoYXQgY29udGFpbiA8Y29kZT5AaW1wb3J0PC9jb2RlPjwvaDM+CjxwPklmIHlvdXIgQ1NTIGZpbGVzIGNvbnRhaW4gPGNvZGU+QGltcG9ydDwvY29kZT4gZGVjbGFyYXRpb25zLCBNaW5pZnkgd2lsbCBub3QgCnJlbW92ZSB0aGVtLiBUaGVyZWZvcmUsIHlvdSB3aWxsIHdhbnQgdG8gcmVtb3ZlIHRob3NlIHRoYXQgcG9pbnQgdG8gZmlsZXMgYWxyZWFkeQppbiB5b3VyIGxpc3QsIGFuZCBtb3ZlIGFueSBvdGhlcnMgdG8gdGhlIHRvcCBvZiB0aGUgZmlyc3QgZmlsZSBpbiB5b3VyIGxpc3QgCihpbXBvcnRzIGJlbG93IGFueSBzdHlsZXMgd2lsbCBiZSBpZ25vcmVkIGJ5IGJyb3dzZXJzIGFzIGludmFsaWQpLjwvcD4KPHA+SWYgeW91IGRlc2lyZSwgeW91IGNhbiB1c2UgTWluaWZ5IFVSSXMgaW4gaW1wb3J0cyBhbmQgdGhleSB3aWxsIG5vdCBiZSB0b3VjaGVkCmJ5IE1pbmlmeS4gRS5nLiA8Y29kZT5AaW1wb3J0ICI8c3BhbiBjbGFzcz1taW5Sb290Pi9taW4vPzwvc3Bhbj5nPWNzczIiOzwvY29kZT48L3A+Cgo8aDM+RGVidWcgTW9kZTwvaDM+CjxwPldoZW4gL21pbi9jb25maWcucGhwIGhhcyA8Y29kZT4kbWluX2FsbG93RGVidWdGbGFnID0gPHN0cm9uZz50cnVlPC9zdHJvbmc+OzwvY29kZT4KIHlvdSBjYW4gZ2V0IGRlYnVnIG91dHB1dCBieSBhcHBlbmRpbmcgPGNvZGU+JmFtcDtkZWJ1ZzwvY29kZT4gdG8gYSBNaW5pZnkgVVJMLCBvcgogYnkgc2VuZGluZyB0aGUgY29va2llIDxjb2RlPm1pbkRlYnVnPSZsdDttYXRjaCZndDs8L2NvZGU+LCB3aGVyZSA8Y29kZT4mbHQ7bWF0Y2gmZ3Q7PC9jb2RlPgogc2hvdWxkIGJlIGEgc3RyaW5nIGluIHRoZSBNaW5pZnkgVVJJcyB5b3UnZCBsaWtlIHRvIGRlYnVnLiBUaGlzIGJvb2ttYXJrbGV0IHdpbGwgYWxsb3cgeW91IHRvCiBzZXQgdGhpcyBjb29raWUuPC9wPgo8cD48YSBpZD1ibTI+TWluaWZ5IERlYnVnPC9hPiA8c21hbGw+KHJpZ2h0LWNsaWNrLCBhZGQgdG8gYm9va21hcmtzKTwvc21hbGw+PC9wPgoKPC9kaXY+PCEtLSAjYXBwIC0tPgoKPGhyPgo8cD5OZWVkIGhlbHA/IENoZWNrIHRoZSA8YSBocmVmPSJodHRwOi8vY29kZS5nb29nbGUuY29tL3AvbWluaWZ5L3cvbGlzdD9jYW49MyI+d2lraTwvYT4sCiBvciBwb3N0IHRvIHRoZSA8YSBjbGFzcz1leHQgaHJlZj0iaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL21pbmlmeSI+ZGlzY3Vzc2lvbgogbGlzdDwvYT4uPC9wPgogPHA+PHNtYWxsPlBvd2VyZWQgYnkgTWluaWZ5IDw/cGhwIGVjaG8gTWluaWZ5OjpWRVJTSU9OOyA/Pjwvc21hbGw+PC9wPgoKPHNjcmlwdCBzcmM9Ii8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuNi4zL2pxdWVyeS5taW4uanMiPjwvc2NyaXB0Pgo8c2NyaXB0PndpbmRvdy5qUXVlcnkgfHwgZG9jdW1lbnQud3JpdGUoJzxzY3JpcHQgc3JjPSJqcXVlcnktMS42LjMubWluLmpzIj48XC9zY3JpcHQ+Jyk8L3NjcmlwdD4KPHNjcmlwdD4KKGZ1bmN0aW9uICgpIHsKICAgIC8vIHdvcmthcm91bmQgcmVxdWlyZWQgdG8gdGVzdCB3aGVuIC9taW4gaXNuJ3QgY2hpbGQgb2Ygd2ViIHJvb3QKICAgIHZhciBzcmMgPSAiLi4vP2Y9IiArIGxvY2F0aW9uLnBhdGhuYW1lLnJlcGxhY2UoL1wvW15cL10qJC8sICcvX2luZGV4LmpzJykuc3Vic3RyKDEpOwogICAgLy8gbG9hZCBzY3JpcHQgaW1tZWRpYXRlbHkKICAgIGRvY3VtZW50LndyaXRlKCc8XHNjcmlwdCBzcmM9IicgKyBzcmMgKyAnIj48XC9zY3JpcHQ+Jyk7CiAgICAkKGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjYnVpbGRlclNjcmlwdFNyYycpWzBdLmhyZWYgPSBzcmM7CiAgICAgICAgLy8gZ2l2ZSBNaW5pZnkgYSBmZXcgc2Vjb25kcyB0byBzZXJ2ZSBfaW5kZXguanMgYmVmb3JlIHNob3dpbmcgc2NhcnkgcmVkIHdhcm5pbmcKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKCEgd2luZG93Lk1VQikgewogICAgICAgICAgICAgICAgLy8gTWluaWZ5IGRpZG4ndCBsb2FkCiAgICAgICAgICAgICAgICAkKCcjanNEaWRudExvYWQnKS5jc3Moe2Rpc3BsYXk6J2Jsb2NrJ30pOwogICAgICAgICAgICB9CiAgICAgICAgfSwgMzAwMCk7CgogICAgICAgIC8vIGRldGVjdGlvbiBvZiBkb3VibGUgb3V0cHV0IGVuY29kaW5nCiAgICAgICAgdmFyIG1zZyA9ICc8XHAgY2xhc3M9dG9wV2FybmluZz48XHN0cm9uZz5XYXJuaW5nOjxcL3N0cm9uZz4gJzsKICAgICAgICB2YXIgdXJsID0gJ29jQ2hlY2sucGhwPycgKyAobmV3IERhdGUoKSkuZ2V0VGltZSgpOwogICAgICAgICQuZ2V0KHVybCwgZnVuY3Rpb24gKG9jU3RhdHVzKSB7CiAgICAgICAgICAgICQuZ2V0KHVybCArICcmaGVsbG89MScsIGZ1bmN0aW9uIChvY0hlbGxvKSB7CiAgICAgICAgICAgICAgICBpZiAob2NIZWxsbyAhPSAnV29ybGQhJykgewogICAgICAgICAgICAgICAgICAgIG1zZyArPSAnSXQgYXBwZWFycyBvdXRwdXQgaXMgYmVpbmcgYXV0b21hdGljYWxseSBjb21wcmVzc2VkLCBpbnRlcmZlcmluZyAnCiAgICAgICAgICAgICAgICAgICAgICAgICArICcgd2l0aCBNaW5pZnlcJ3Mgb3duIGNvbXByZXNzaW9uLiAnOwogICAgICAgICAgICAgICAgICAgIGlmIChvY1N0YXR1cyA9PSAnMScpCiAgICAgICAgICAgICAgICAgICAgICAgIG1zZyArPSAnVGhlIG9wdGlvbiAiemxpYi5vdXRwdXRfY29tcHJlc3Npb24iIGlzIGVuYWJsZWQgaW4geW91ciBQSFAgY29uZmlndXJhdGlvbi4gJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgJ01pbmlmeSBzZXQgdGhpcyB0byAiMCIsIGJ1dCBpdCBoYWQgbm8gZWZmZWN0LiBUaGlzIG9wdGlvbiBtdXN0IGJlIGRpc2FibGVkICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICdpbiBwaHAuaW5pIG9yIC5odGFjY2Vzcy4nOwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgbXNnICs9ICdUaGUgb3B0aW9uICJ6bGliLm91dHB1dF9jb21wcmVzc2lvbiIgaXMgZGlzYWJsZWQgaW4geW91ciBQSFAgY29uZmlndXJhdGlvbiAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAnc28gdGhpcyBiZWhhdmlvciBpcyBsaWtlbHkgZHVlIHRvIGEgc2VydmVyIG9wdGlvbi4nOwogICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQuYm9keSkucHJlcGVuZChtc2cgKyAnPFwvcD4nKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgIGlmIChvY1N0YXR1cyA9PSAnMScpCiAgICAgICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQuYm9keSkucHJlcGVuZCgnPFxwIGNsYXNzPXRvcE5vdGU+PFxzdHJvbmc+Tm90ZTo8L1xzdHJvbmc+IFRoZSBvcHRpb24gJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAnInpsaWIub3V0cHV0X2NvbXByZXNzaW9uIiBpcyBlbmFibGVkIGluIHlvdXIgUEhQIGNvbmZpZ3VyYXRpb24sIGJ1dCBoYXMgYmVlbiAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArICdzdWNjZXNzZnVsbHkgZGlzYWJsZWQgdmlhIGluaV9zZXQoKS4gSWYgeW91IGV4cGVyaWVuY2UgbWFuZ2xlZCBvdXRwdXQgeW91ICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgJ21heSB3YW50IHRvIGNvbnNpZGVyIGRpc2FibGluZyB0aGlzIG9wdGlvbiBpbiB5b3VyIFBIUCBjb25maWd1cmF0aW9uLjxcL3A+JwogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0pOwp9KSgpOwo8L3NjcmlwdD4KPC9ib2R5Pgo8P3BocAokY29udGVudCA9IG9iX2dldF9jbGVhbigpOwoKLy8gc2V0dXAgTWluaWZ5Ck1pbmlmeTo6c2V0Q2FjaGUoCiAgICBpc3NldCgkbWluX2NhY2hlUGF0aCkgPyAkbWluX2NhY2hlUGF0aCA6ICcnCiAgICAsJG1pbl9jYWNoZUZpbGVMb2NraW5nCik7Ck1pbmlmeTo6JHVwbG9hZGVySG91cnNCZWhpbmQgPSAkbWluX3VwbG9hZGVySG91cnNCZWhpbmQ7CgpNaW5pZnk6OnNlcnZlKCdQYWdlJywgYXJyYXkoCiAgICAnY29udGVudCcgPT4gJGNvbnRlbnQKICAgICwnaWQnID0+IF9fRklMRV9fCiAgICAsJ2xhc3RNb2RpZmllZFRpbWUnID0+IG1heCgKICAgICAgICAvLyByZWdlbmVyYXRlIGNhY2hlIGlmIGFueSBvZiB0aGVzZSBjaGFuZ2UKICAgICAgICBmaWxlbXRpbWUoX19GSUxFX18pCiAgICAgICAgLGZpbGVtdGltZShkaXJuYW1lKF9fRklMRV9fKSAuICcvLi4vY29uZmlnLnBocCcpCiAgICAgICAgLGZpbGVtdGltZShkaXJuYW1lKF9fRklMRV9fKSAuICcvLi4vbGliL01pbmlmeS5waHAnKQogICAgKQogICAgLCdtaW5pZnlBbGwnID0+IHRydWUKICAgICwnZW5jb2RlT3V0cHV0JyA9PiAkZW5jb2RlT3V0cHV0CikpOwo=",
                "body": "PD9waHAgCgppZiAocGhwdmVyc2lvbigpIDwgNSkgewogICAgZXhpdCgnTWluaWZ5IHJlcXVpcmVzIFBIUDUgb3IgZ3JlYXRlci4nKTsKfQoKLy8gY2hlY2sgZm9yIGF1dG8tZW5jb2RpbmcKJGVuY29kZU91dHB1dCA9IChmdW5jdGlvbl9leGlzdHMoJ2d6ZGVmbGF0ZScpCiAgICAgICAgICAgICAgICAgJiYgIWluaV9nZXQoJ3psaWIub3V0cHV0X2NvbXByZXNzaW9uJykpOwoKLy8gcmVjb21tZW5kICRtaW5fc3ltbGlua3Mgc2V0dGluZyBmb3IgQXBhY2hlIFVzZXJEaXIKJHN5bWxpbmtPcHRpb24gPSAnJzsKaWYgKDAgPT09IHN0cnBvcygkX1NFUlZFUlsiU0VSVkVSX1NPRlRXQVJFIl0sICdBcGFjaGUvJykKICAgICYmIHByZWdfbWF0Y2goJ0BeL1xcfihcXHcrKS9AJywgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10sICRtKQopIHsKICAgICR1c2VyRGlyID0gRElSRUNUT1JZX1NFUEFSQVRPUiAuICRtWzFdIC4gRElSRUNUT1JZX1NFUEFSQVRPUjsKICAgIGlmIChmYWxzZSAhPT0gc3RycG9zKF9fRklMRV9fLCAkdXNlckRpcikpIHsKICAgICAgICAkc20gPSBhcnJheSgpOwogICAgICAgICRzbVsiLy9+eyRtWzFdfSJdID0gZGlybmFtZShkaXJuYW1lKF9fRklMRV9fKSk7CiAgICAgICAgJGFycmF5ID0gc3RyX3JlcGxhY2UoJ2FycmF5ICgnLCAnYXJyYXkoJywgdmFyX2V4cG9ydCgkc20sIDEpKTsKICAgICAgICAkc3ltbGlua09wdGlvbiA9ICJcJG1pbl9zeW1saW5rcyA9ICRhcnJheTsiOwogICAgfQp9CgpyZXF1aXJlIGRpcm5hbWUoX19GSUxFX18pIC4gJy8uLi9jb25maWcucGhwJzsKCmlmICghICRtaW5fZW5hYmxlQnVpbGRlcikgewogICAgaGVhZGVyKCdMb2NhdGlvbjogLycpOwogICAgZXhpdCgpOwp9Cgokc2V0SW5jbHVkZVN1Y2Nlc3MgPSBzZXRfaW5jbHVkZV9wYXRoKGRpcm5hbWUoX19GSUxFX18pIC4gJy8uLi9saWInIC4gUEFUSF9TRVBBUkFUT1IgLiBnZXRfaW5jbHVkZV9wYXRoKCkpOwovLyB3ZSBkbyBpdCB0aGlzIHdheSBiZWNhdXNlIHdlIHdhbnQgdGhlIGJ1aWxkZXIgdG8gd29yayBhZnRlciB0aGUgdXNlciBjb3JyZWN0cwovLyBpbmNsdWRlX3BhdGguIChzZXRfaW5jbHVkZV9wYXRoIHJldHVybmluZyBGQUxTRSBpcyBPSykuCnRyeSB7CiAgICByZXF1aXJlX29uY2UgJ01pbmlmeS9DYWNoZS9GaWxlLnBocCc7Cn0gY2F0Y2ggKEV4Y2VwdGlvbiAkZSkgewogICAgaWYgKCEgJHNldEluY2x1ZGVTdWNjZXNzKSB7CiAgICAgICAgZWNobyAiTWluaWZ5OiBzZXRfaW5jbHVkZV9wYXRoKCkgZmFpbGVkLiBZb3UgbWF5IG5lZWQgdG8gc2V0IHlvdXIgaW5jbHVkZV9wYXRoICIKICAgICAgICAgICAgLiJvdXRzaWRlIG9mIFBIUCBjb2RlLCBlLmcuLCBpbiBwaHAuaW5pLiI7ICAgIAogICAgfSBlbHNlIHsKICAgICAgICBlY2hvICRlLT5nZXRNZXNzYWdlKCk7CiAgICB9CiAgICBleGl0KCk7Cn0KcmVxdWlyZSAnTWluaWZ5LnBocCc7CgokY2FjaGVQYXRoQ29kZSA9ICcnOwppZiAoISBpc3NldCgkbWluX2NhY2hlUGF0aCkgJiYgISBmdW5jdGlvbl9leGlzdHMoJ3N5c19nZXRfdGVtcF9kaXInKSkgewogICAgJGRldGVjdGVkVG1wID0gTWluaWZ5X0NhY2hlX0ZpbGU6OnRtcCgpOwogICAgJGNhY2hlUGF0aENvZGUgPSAiXCRtaW5fY2FjaGVQYXRoID0gIiAuIHZhcl9leHBvcnQoJGRldGVjdGVkVG1wLCAxKSAuICc7JzsKfQoKb2Jfc3RhcnQoKTsKPz4KPCFET0NUWVBFIGh0bWw+Cjx0aXRsZT5NaW5pZnkgVVJJIEJ1aWxkZXI8L3RpdGxlPgo8bWV0YSBuYW1lPSJST0JPVFMiIGNvbnRlbnQ9Ik5PSU5ERVgsIE5PRk9MTE9XIj4KPHN0eWxlPgpib2R5IHttYXJnaW46MWVtIDYwcHg7fQpoMSwgaDIsIGgzIHttYXJnaW4tbGVmdDotMjVweDsgcG9zaXRpb246cmVsYXRpdmU7fQpoMSB7bWFyZ2luLXRvcDowO30KI3NvdXJjZXMge21hcmdpbjowOyBwYWRkaW5nOjA7fQojc291cmNlcyBsaSB7bWFyZ2luOjAgMCAwIDQwcHh9CiNzb3VyY2VzIGxpIGlucHV0IHttYXJnaW4tbGVmdDoycHh9CiNhZGQge21hcmdpbjo1cHggMCAxZW0gNDBweH0KLmhpZGUge2Rpc3BsYXk6bm9uZX0KI3VyaVRhYmxlIHtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7fQojdXJpVGFibGUgdGQsICN1cmlUYWJsZSB0aCB7cGFkZGluZy10b3A6MTBweDt9CiN1cmlUYWJsZSB0aCB7cGFkZGluZy1yaWdodDoxMHB4O30KI2dyb3VwQ29uZmlnIHtmb250LWZhbWlseTptb25vc3BhY2U7fQpiIHtjb2xvcjojYzAwfQoudG9wTm90ZSB7YmFja2dyb3VuZDogI2ZmOTsgZGlzcGxheTppbmxpbmUtYmxvY2s7IHBhZGRpbmc6LjVlbSAuNmVtOyBtYXJnaW46MCAwIDFlbTt9Ci50b3BXYXJuaW5nIHtiYWNrZ3JvdW5kOiNjMDA7IGNvbG9yOiNmZmY7IHBhZGRpbmc6LjVlbSAuNmVtOyBtYXJnaW46MCAwIDFlbTt9Ci50b3BXYXJuaW5nIGEge2NvbG9yOiNmZmY7fQojanNEaWRudExvYWQge2Rpc3BsYXk6bm9uZTt9Cjwvc3R5bGU+Cjxib2R5Pgo8P3BocCBpZiAoJHN5bWxpbmtPcHRpb24pOiA/PgogICAgPGRpdiBjbGFzcz10b3BOb3RlPjxzdHJvbmc+Tm90ZTo8L3N0cm9uZz4gSXQgbG9va3MgbGlrZSB5b3UncmUgcnVubmluZyBNaW5pZnkgaW4gYSB1c2VyCiBkaXJlY3RvcnkuIFlvdSBtYXkgbmVlZCB0aGUgZm9sbG93aW5nIG9wdGlvbiBpbiAvbWluL2NvbmZpZy5waHAgdG8gaGF2ZSBVUklzCiBjb3JyZWN0bHkgcmV3cml0dGVuIGluIENTUyBvdXRwdXQ6CiA8YnI+PHRleHRhcmVhIGlkPXN5bWxpbmtPcHQgcm93cz0zIGNvbHM9ODAgcmVhZG9ubHk+PD9waHAgZWNobyBodG1sc3BlY2lhbGNoYXJzKCRzeW1saW5rT3B0aW9uKTsgPz48L3RleHRhcmVhPgo8L2Rpdj4KPD9waHAgZW5kaWY7ID8+Cgo8cCBjbGFzcz10b3BXYXJuaW5nIGlkPWpzRGlkbnRMb2FkPjxzdHJvbmc+VWggT2guPC9zdHJvbmc+IE1pbmlmeSB3YXMgdW5hYmxlIHRvCiAgICBzZXJ2ZSBKYXZhc2NyaXB0IGZvciB0aGlzIGFwcC4gVG8gdHJvdWJsZXNob290IHRoaXMsCiAgICA8YSBocmVmPSJodHRwOi8vY29kZS5nb29nbGUuY29tL3AvbWluaWZ5L3dpa2kvRGVidWdnaW5nIj5lbmFibGUgRmlyZVBIUCBkZWJ1Z2dpbmc8L2E+CiAgICBhbmQgcmVxdWVzdCB0aGUgPGEgaWQ9YnVpbGRlclNjcmlwdFNyYyBocmVmPSM+TWluaWZ5IFVSTDwvYT4gZGlyZWN0bHkuIEhvcGVmdWxseSB0aGUKICAgIEZpcmVQSFAgY29uc29sZSB3aWxsIHJlcG9ydCB0aGUgY2F1c2Ugb2YgdGhlIGVycm9yLgo8L3A+Cgo8P3BocCBpZiAoJGNhY2hlUGF0aENvZGUpOiA/Pgo8cCBjbGFzcz10b3BOb3RlPjxzdHJvbmc+Tm90ZTo8L3N0cm9uZz4gPGNvZGU+PD9waHAgZWNobwogICAgaHRtbHNwZWNpYWxjaGFycygkZGV0ZWN0ZWRUbXApOyA/PjwvY29kZT4gd2FzIGRpc2NvdmVyZWQgYXMgYSB1c2FibGUgdGVtcCBkaXJlY3RvcnkuPGJyPlRvCiAgICBzbGlnaHRseSBpbXByb3ZlIHBlcmZvcm1hbmNlIHlvdSBjYW4gaGFyZGNvZGUgdGhpcyBpbiAvbWluL2NvbmZpZy5waHA6CiAgICA8Y29kZT48P3BocCBlY2hvIGh0bWxzcGVjaWFsY2hhcnMoJGNhY2hlUGF0aENvZGUpOyA/PjwvY29kZT48L3A+Cjw/cGhwIGVuZElmOyA/PgoKPHAgaWQ9bWluUmV3cml0ZUZhaWxlZCBjbGFzcz0iaGlkZSI+PHN0cm9uZz5Ob3RlOjwvc3Ryb25nPiBZb3VyIHdlYnNlcnZlciBkb2VzIG5vdCBzZWVtIHRvCiBzdXBwb3J0IG1vZF9yZXdyaXRlICh1c2VkIGluIC9taW4vLmh0YWNjZXNzKS4gWW91ciBNaW5pZnkgVVJJcyB3aWxsIGNvbnRhaW4gIj8iLCB3aGljaCAKPGEgaHJlZj0iaHR0cDovL3d3dy5zdGV2ZXNvdWRlcnMuY29tL2Jsb2cvMjAwOC8wOC8yMy9yZXZ2aW5nLWZpbGVuYW1lcy1kb250LXVzZS1xdWVyeXN0cmluZy8iCj5tYXkgcmVkdWNlIHRoZSBiZW5lZml0IG9mIHByb3h5IGNhY2hlIHNlcnZlcnM8L2E+LjwvcD4KCjxoMT5NaW5pZnkgVVJJIEJ1aWxkZXI8L2gxPgoKPG5vc2NyaXB0PjxwIGNsYXNzPSJ0b3BOb3RlIj5KYXZhc2NyaXB0IGFuZCBhIGJyb3dzZXIgc3VwcG9ydGVkIGJ5IGpRdWVyeSAxLjIuNiBpcyByZXF1aXJlZApmb3IgdGhpcyBhcHBsaWNhdGlvbi48L3A+PC9ub3NjcmlwdD4KCjxkaXYgaWQ9YXBwIGNsYXNzPWhpZGU+Cgo8cD5DcmVhdGUgYSBsaXN0IG9mIEphdmFzY3JpcHQgb3IgQ1NTIGZpbGVzIChvciAxIGlzIGZpbmUpIHlvdSdkIGxpa2UgdG8gY29tYmluZQphbmQgY2xpY2sgW1VwZGF0ZV0uPC9wPgoKPG9sIGlkPXNvdXJjZXM+PGxpPjwvbGk+PC9vbD4KPGRpdiBpZD1hZGQ+PGJ1dHRvbj5BZGQgZmlsZSArPC9idXR0b24+PC9kaXY+Cgo8ZGl2IGlkPWJtVXJpcz48L2Rpdj4KCjxwPjxidXR0b24gaWQ9dXBkYXRlIGNsYXNzPWhpZGU+VXBkYXRlPC9idXR0b24+PC9wPgoKPGRpdiBpZD1yZXN1bHRzIGNsYXNzPWhpZGU+Cgo8aDI+TWluaWZ5IFVSSTwvaDI+CjxwPlBsYWNlIHRoaXMgVVJJIGluIHlvdXIgSFRNTCB0byBzZXJ2ZSB0aGUgZmlsZXMgYWJvdmUgY29tYmluZWQsIG1pbmlmaWVkLCBjb21wcmVzc2VkIGFuZAp3aXRoIGNhY2hlIGhlYWRlcnMuPC9wPgo8dGFibGUgaWQ9dXJpVGFibGU+CiAgICA8dHI+PHRoPlVSSTwvdGg+PHRkPjxhIGlkPXVyaUEgY2xhc3M9ZXh0Pi9taW48L2E+IDxzbWFsbD4ob3BlbnMgaW4gbmV3IHdpbmRvdyk8L3NtYWxsPjwvdGQ+PC90cj4KICAgIDx0cj48dGg+SFRNTDwvdGg+PHRkPjxpbnB1dCBpZD11cmlIdG1sIHR5cGU9dGV4dCBzaXplPTEwMCByZWFkb25seT48L3RkPjwvdHI+CjwvdGFibGU+Cgo8aDI+SG93IHRvIHNlcnZlIHRoZXNlIGZpbGVzIGFzIGEgZ3JvdXA8L2gyPgo8cD5Gb3IgdGhlIGJlc3QgcGVyZm9ybWFuY2UgeW91IGNhbiBzZXJ2ZSB0aGVzZSBmaWxlcyBhcyBhIHByZS1kZWZpbmVkIGdyb3VwIHdpdGggYSBVUkkKbGlrZTogPGNvZGU+PHNwYW4gY2xhc3M9bWluUm9vdD4vbWluLz88L3NwYW4+Zz1rZXlOYW1lPC9jb2RlPjwvcD4KPHA+VG8gZG8gdGhpcywgYWRkIGEgbGluZSBsaWtlIHRoaXMgdG8gL21pbi9ncm91cHNDb25maWcucGhwOjwvcD4KCjxwcmU+PGNvZGU+cmV0dXJuIGFycmF5KAogICAgPHNwYW4gc3R5bGU9ImNvbG9yOiM2NjYiPi4uLiB5b3VyIGV4aXN0aW5nIGdyb3VwcyBoZXJlIC4uLjwvc3Bhbj4KPGlucHV0IGlkPWdyb3VwQ29uZmlnIHNpemU9MTAwIHR5cGU9dGV4dCByZWFkb25seT4KKTs8L2NvZGU+PC9wcmU+Cgo8cD48ZW0+TWFrZSBzdXJlIHRvIHJlcGxhY2UgPGNvZGU+a2V5TmFtZTwvY29kZT4gd2l0aCBhIHVuaXF1ZSBrZXkgZm9yIHRoaXMgZ3JvdXAuPC9lbT48L3A+CjwvZGl2PgoKPGRpdiBpZD1nZXRCbT4KPGgzPkZpbmQgVVJJcyBvbiBhIFBhZ2U8L2gzPgo8cD5Zb3UgY2FuIHVzZSB0aGUgYm9va21hcmtsZXQgYmVsb3cgdG8gZmV0Y2ggYWxsIENTUyAmYW1wOyBKYXZhc2NyaXB0IFVSSXMgZnJvbSBhIHBhZ2UKb24geW91ciBzaXRlLiBXaGVuIHlvdSBhY3RpdmUgaXQsIHRoaXMgcGFnZSB3aWxsIG9wZW4gaW4gYSBuZXcgd2luZG93IHdpdGggYSBsaXN0IG9mCmF2YWlsYWJsZSBVUklzIHRvIGFkZC48L3A+Cgo8cD48YSBpZD1ibT5DcmVhdGUgTWluaWZ5IFVSSXM8L2E+IDxzbWFsbD4ocmlnaHQtY2xpY2ssIGFkZCB0byBib29rbWFya3MpPC9zbWFsbD48L3A+CjwvZGl2PgoKPGgzPkNvbWJpbmluZyBDU1MgZmlsZXMgdGhhdCBjb250YWluIDxjb2RlPkBpbXBvcnQ8L2NvZGU+PC9oMz4KPHA+SWYgeW91ciBDU1MgZmlsZXMgY29udGFpbiA8Y29kZT5AaW1wb3J0PC9jb2RlPiBkZWNsYXJhdGlvbnMsIE1pbmlmeSB3aWxsIG5vdCAKcmVtb3ZlIHRoZW0uIFRoZXJlZm9yZSwgeW91IHdpbGwgd2FudCB0byByZW1vdmUgdGhvc2UgdGhhdCBwb2ludCB0byBmaWxlcyBhbHJlYWR5CmluIHlvdXIgbGlzdCwgYW5kIG1vdmUgYW55IG90aGVycyB0byB0aGUgdG9wIG9mIHRoZSBmaXJzdCBmaWxlIGluIHlvdXIgbGlzdCAKKGltcG9ydHMgYmVsb3cgYW55IHN0eWxlcyB3aWxsIGJlIGlnbm9yZWQgYnkgYnJvd3NlcnMgYXMgaW52YWxpZCkuPC9wPgo8cD5JZiB5b3UgZGVzaXJlLCB5b3UgY2FuIHVzZSBNaW5pZnkgVVJJcyBpbiBpbXBvcnRzIGFuZCB0aGV5IHdpbGwgbm90IGJlIHRvdWNoZWQKYnkgTWluaWZ5LiBFLmcuIDxjb2RlPkBpbXBvcnQgIjxzcGFuIGNsYXNzPW1pblJvb3Q+L21pbi8/PC9zcGFuPmc9Y3NzMiI7PC9jb2RlPjwvcD4KCjxoMz5EZWJ1ZyBNb2RlPC9oMz4KPHA+V2hlbiAvbWluL2NvbmZpZy5waHAgaGFzIDxjb2RlPiRtaW5fYWxsb3dEZWJ1Z0ZsYWcgPSA8c3Ryb25nPnRydWU8L3N0cm9uZz47PC9jb2RlPgogeW91IGNhbiBnZXQgZGVidWcgb3V0cHV0IGJ5IGFwcGVuZGluZyA8Y29kZT4mYW1wO2RlYnVnPC9jb2RlPiB0byBhIE1pbmlmeSBVUkwsIG9yCiBieSBzZW5kaW5nIHRoZSBjb29raWUgPGNvZGU+bWluRGVidWc9Jmx0O21hdGNoJmd0OzwvY29kZT4sIHdoZXJlIDxjb2RlPiZsdDttYXRjaCZndDs8L2NvZGU+CiBzaG91bGQgYmUgYSBzdHJpbmcgaW4gdGhlIE1pbmlmeSBVUklzIHlvdSdkIGxpa2UgdG8gZGVidWcuIFRoaXMgYm9va21hcmtsZXQgd2lsbCBhbGxvdyB5b3UgdG8KIHNldCB0aGlzIGNvb2tpZS48L3A+CjxwPjxhIGlkPWJtMj5NaW5pZnkgRGVidWc8L2E+IDxzbWFsbD4ocmlnaHQtY2xpY2ssIGFkZCB0byBib29rbWFya3MpPC9zbWFsbD48L3A+Cgo8L2Rpdj48IS0tICNhcHAgLS0+Cgo8aHI+CjxwPk5lZWQgaGVscD8gQ2hlY2sgdGhlIDxhIGhyZWY9Imh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9taW5pZnkvdy9saXN0P2Nhbj0zIj53aWtpPC9hPiwKIG9yIHBvc3QgdG8gdGhlIDxhIGNsYXNzPWV4dCBocmVmPSJodHRwOi8vZ3JvdXBzLmdvb2dsZS5jb20vZ3JvdXAvbWluaWZ5Ij5kaXNjdXNzaW9uCiBsaXN0PC9hPi48L3A+CiA8cD48c21hbGw+UG93ZXJlZCBieSBNaW5pZnkgPD9waHAgZWNobyBNaW5pZnk6OlZFUlNJT047ID8+PC9zbWFsbD48L3A+Cgo8c2NyaXB0IHNyYz0iLy9hamF4Lmdvb2dsZWFwaXMuY29tL2FqYXgvbGlicy9qcXVlcnkvMS42LjMvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQ+d2luZG93LmpRdWVyeSB8fCBkb2N1bWVudC53cml0ZSgnPHNjcmlwdCBzcmM9ImpxdWVyeS0xLjYuMy5taW4uanMiPjxcL3NjcmlwdD4nKTwvc2NyaXB0Pgo8c2NyaXB0PgooZnVuY3Rpb24gKCkgewogICAgLy8gd29ya2Fyb3VuZCByZXF1aXJlZCB0byB0ZXN0IHdoZW4gL21pbiBpc24ndCBjaGlsZCBvZiB3ZWIgcm9vdAogICAgdmFyIHNyYyA9ICIuLi8/Zj0iICsgbG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgvXC9bXlwvXSokLywgJy9faW5kZXguanMnKS5zdWJzdHIoMSk7CiAgICAvLyBsb2FkIHNjcmlwdCBpbW1lZGlhdGVseQogICAgZG9jdW1lbnQud3JpdGUoJzxcc2NyaXB0IHNyYz0iJyArIHNyYyArICciPjxcL3NjcmlwdD4nKTsKICAgICQoZnVuY3Rpb24gKCkgewogICAgICAgICQoJyNidWlsZGVyU2NyaXB0U3JjJylbMF0uaHJlZiA9IHNyYzsKICAgICAgICAvLyBnaXZlIE1pbmlmeSBhIGZldyBzZWNvbmRzIHRvIHNlcnZlIF9pbmRleC5qcyBiZWZvcmUgc2hvd2luZyBzY2FyeSByZWQgd2FybmluZwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoISB3aW5kb3cuTVVCKSB7CiAgICAgICAgICAgICAgICAvLyBNaW5pZnkgZGlkbid0IGxvYWQKICAgICAgICAgICAgICAgICQoJyNqc0RpZG50TG9hZCcpLmNzcyh7ZGlzcGxheTonYmxvY2snfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzMDAwKTsKCiAgICAgICAgLy8gZGV0ZWN0aW9uIG9mIGRvdWJsZSBvdXRwdXQgZW5jb2RpbmcKICAgICAgICB2YXIgbXNnID0gJzxccCBjbGFzcz10b3BXYXJuaW5nPjxcc3Ryb25nPldhcm5pbmc6PFwvc3Ryb25nPiAnOwogICAgICAgIHZhciB1cmwgPSAnb2NDaGVjay5waHA/JyArIChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7CiAgICAgICAgJC5nZXQodXJsLCBmdW5jdGlvbiAob2NTdGF0dXMpIHsKICAgICAgICAgICAgJC5nZXQodXJsICsgJyZoZWxsbz0xJywgZnVuY3Rpb24gKG9jSGVsbG8pIHsKICAgICAgICAgICAgICAgIGlmIChvY0hlbGxvICE9ICdXb3JsZCEnKSB7CiAgICAgICAgICAgICAgICAgICAgbXNnICs9ICdJdCBhcHBlYXJzIG91dHB1dCBpcyBiZWluZyBhdXRvbWF0aWNhbGx5IGNvbXByZXNzZWQsIGludGVyZmVyaW5nICcKICAgICAgICAgICAgICAgICAgICAgICAgICsgJyB3aXRoIE1pbmlmeVwncyBvd24gY29tcHJlc3Npb24uICc7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9jU3RhdHVzID09ICcxJykKICAgICAgICAgICAgICAgICAgICAgICAgbXNnICs9ICdUaGUgb3B0aW9uICJ6bGliLm91dHB1dF9jb21wcmVzc2lvbiIgaXMgZW5hYmxlZCBpbiB5b3VyIFBIUCBjb25maWd1cmF0aW9uLiAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAnTWluaWZ5IHNldCB0aGlzIHRvICIwIiwgYnV0IGl0IGhhZCBubyBlZmZlY3QuIFRoaXMgb3B0aW9uIG11c3QgYmUgZGlzYWJsZWQgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgJ2luIHBocC5pbmkgb3IgLmh0YWNjZXNzLic7CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBtc2cgKz0gJ1RoZSBvcHRpb24gInpsaWIub3V0cHV0X2NvbXByZXNzaW9uIiBpcyBkaXNhYmxlZCBpbiB5b3VyIFBIUCBjb25maWd1cmF0aW9uICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICdzbyB0aGlzIGJlaGF2aW9yIGlzIGxpa2VseSBkdWUgdG8gYSBzZXJ2ZXIgb3B0aW9uLic7CiAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5KS5wcmVwZW5kKG1zZyArICc8XC9wPicpOwogICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgaWYgKG9jU3RhdHVzID09ICcxJykKICAgICAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5KS5wcmVwZW5kKCc8XHAgY2xhc3M9dG9wTm90ZT48XHN0cm9uZz5Ob3RlOjwvXHN0cm9uZz4gVGhlIG9wdGlvbiAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArICciemxpYi5vdXRwdXRfY29tcHJlc3Npb24iIGlzIGVuYWJsZWQgaW4geW91ciBQSFAgY29uZmlndXJhdGlvbiwgYnV0IGhhcyBiZWVuICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgJ3N1Y2Nlc3NmdWxseSBkaXNhYmxlZCB2aWEgaW5pX3NldCgpLiBJZiB5b3UgZXhwZXJpZW5jZSBtYW5nbGVkIG91dHB1dCB5b3UgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAnbWF5IHdhbnQgdG8gY29uc2lkZXIgZGlzYWJsaW5nIHRoaXMgb3B0aW9uIGluIHlvdXIgUEhQIGNvbmZpZ3VyYXRpb24uPFwvcD4nCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfSk7Cn0pKCk7Cjwvc2NyaXB0Pgo8L2JvZHk+Cjw/cGhwCiRjb250ZW50ID0gb2JfZ2V0X2NsZWFuKCk7CgovLyBzZXR1cCBNaW5pZnkKTWluaWZ5OjpzZXRDYWNoZSgKICAgIGlzc2V0KCRtaW5fY2FjaGVQYXRoKSA/ICRtaW5fY2FjaGVQYXRoIDogJycKICAgICwkbWluX2NhY2hlRmlsZUxvY2tpbmcKKTsKTWluaWZ5OjokdXBsb2FkZXJIb3Vyc0JlaGluZCA9ICRtaW5fdXBsb2FkZXJIb3Vyc0JlaGluZDsKCk1pbmlmeTo6c2VydmUoJ1BhZ2UnLCBhcnJheSgKICAgICdjb250ZW50JyA9PiAkY29udGVudAogICAgLCdpZCcgPT4gX19GSUxFX18KICAgICwnbGFzdE1vZGlmaWVkVGltZScgPT4gbWF4KAogICAgICAgIC8vIHJlZ2VuZXJhdGUgY2FjaGUgaWYgYW55IG9mIHRoZXNlIGNoYW5nZQogICAgICAgIGZpbGVtdGltZShfX0ZJTEVfXykKICAgICAgICAsZmlsZW10aW1lKGRpcm5hbWUoX19GSUxFX18pIC4gJy8uLi9jb25maWcucGhwJykKICAgICAgICAsZmlsZW10aW1lKGRpcm5hbWUoX19GSUxFX18pIC4gJy8uLi9saWIvTWluaWZ5LnBocCcpCiAgICApCiAgICAsJ21pbmlmeUFsbCcgPT4gdHJ1ZQogICAgLCdlbmNvZGVPdXRwdXQnID0+ICRlbmNvZGVPdXRwdXQKKSk7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 05:24:49 GMT",
                    "Content-Length": "9904",
                    "Date": "Sat, 08 Nov 2014 05:24:49 GMT",
                    "Content-Type": "text/plain; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "text",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}