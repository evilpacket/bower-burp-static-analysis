{
    "url": "http://localhost:9999/Prinzhorn/skrollr-menu/src/skrollr.menu.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>window.location.hash</b> and written to <b>the 'href' property of a DOM element</b> via the following statement:<ul><li>link.href = window.location.hash;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/Prinzhorn/skrollr-menu/src/skrollr.menu.js",
                "path": "/Prinzhorn/skrollr-menu/src/skrollr.menu.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9Qcmluemhvcm4vc2tyb2xsci1tZW51L3NyYy9za3JvbGxyLm1lbnUuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNTg4Nw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAwNDo0ODozMyBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMDQ6NDg6MzMgR01UDQoNCiAvKiEKICogUGx1Z2luIGZvciBza3JvbGxyLgogKiBUaGlzIHBsdWdpbiBtYWtlcyBoYXNobGlua3Mgc2Nyb2xsIG5pY2VseSB0byB0aGVpciB0YXJnZXQgcG9zaXRpb24uCiAqCiAqIEFsZXhhbmRlciBQcmluemhvcm4gLSBodHRwczovL2dpdGh1Yi5jb20vUHJpbnpob3JuL3Nrcm9sbHIKICoKICogRnJlZSB0byB1c2UgdW5kZXIgdGVybXMgb2YgTUlUIGxpY2Vuc2UKICovCihmdW5jdGlvbihkb2N1bWVudCwgd2luZG93KSB7CgkndXNlIHN0cmljdCc7CgoJdmFyIERFRkFVTFRfRFVSQVRJT04gPSA1MDA7Cgl2YXIgREVGQVVMVF9FQVNJTkcgPSAnc3FydCc7Cgl2YXIgREVGQVVMVF9TQ0FMRSA9IDE7CgoJdmFyIE1FTlVfVE9QX0FUVFIgPSAnZGF0YS1tZW51LXRvcCc7Cgl2YXIgTUVOVV9PRkZTRVRfQVRUUiA9ICdkYXRhLW1lbnUtb2Zmc2V0JzsKCXZhciBNRU5VX0RVUkFUSU9OX0FUVFIgPSAnZGF0YS1tZW51LWR1cmF0aW9uJzsKCgl2YXIgc2tyb2xsciA9IHdpbmRvdy5za3JvbGxyOwoJdmFyIGhpc3RvcnkgPSB3aW5kb3cuaGlzdG9yeTsKCXZhciBzdXBwb3J0c0hpc3RvcnkgPSAhIWhpc3RvcnkucHVzaFN0YXRlOwoKCS8qCgkJU2luY2Ugd2UgYXJlIHVzaW5nIGV2ZW50IGJ1YmJsaW5nLCB0aGUgZWxlbWVudCB0aGF0IGhhcyBiZWVuIGNsaWNrZWQKCQltaWdodCBub3QgYWN1dGFsbHkgYmUgdGhlIGxpbmsgYnV0IGEgY2hpbGQuCgkqLwoJdmFyIGZpbmRQYXJlbnRMaW5rID0gZnVuY3Rpb24oZWxlbWVudCkgewoJCS8vV2UgcmVhY2hlZCB0aGUgdG9wLCBubyBsaW5rIGZvdW5kLgoJCWlmKGVsZW1lbnQgPT09IGRvY3VtZW50KSB7CgkJCXJldHVybiBmYWxzZTsKCQl9CgoJCS8vWWF5LCBpdCdzIGEgbGluayEKCQlpZihlbGVtZW50LnRhZ05hbWUudG9VcHBlckNhc2UoKSA9PT0gJ0EnKSB7CgkJCXJldHVybiBlbGVtZW50OwoJCX0KCgkJLy9NYXliZSB0aGUgcGFyZW50IGlzIGEgbGluay4KCQlyZXR1cm4gZmluZFBhcmVudExpbmsoZWxlbWVudC5wYXJlbnROb2RlKTsKCX07CgoJLyoKCQlIYW5kbGUgdGhlIGNsaWNrIGV2ZW50IG9uIHRoZSBkb2N1bWVudC4KCSovCgl2YXIgaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbihlKSB7CgkJLy9Pbmx5IGhhbmRsZSBsZWZ0IGNsaWNrLgoJCWlmKGUud2hpY2ggIT09IDEgJiYgZS5idXR0b24gIT09IDApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIGxpbmsgPSBmaW5kUGFyZW50TGluayhlLnRhcmdldCk7CgoJCS8vVGhlIGNsaWNrIGRpZCBub3QgaGFwcGVuIGluc2lkZSBhIGxpbmsuCgkJaWYoIWxpbmspIHsKCQkJcmV0dXJuOwoJCX0KCgkJaWYoaGFuZGxlTGluayhsaW5rKSkgewoJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJfQoJfTsKCgkvKgoJCUhhbmRsZXMgdGhlIGNsaWNrIG9uIGEgbGluay4gTWF5IGJlIGNhbGxlZCB3aXRob3V0IGFuIGFjdHVhbCBjbGljayBldmVudC4KCQlXaGVuIHRoZSBmYWtlIGZsYWcgaXMgc2V0LCB0aGUgbGluayB3b24ndCBjaGFuZ2UgdGhlIHVybCBhbmQgdGhlIHBvc2l0aW9uIHdvbid0IGJlIGFuaW1hdGVkLgoJKi8KCXZhciBoYW5kbGVMaW5rID0gZnVuY3Rpb24obGluaywgZmFrZSkgewoJCXZhciBoYXNoOwoKCQkvL1doZW4gY29tcGxleExpbmtzIGlzIGVuYWJsZWQsIHdlIGFsc28gYWNjZXB0IGxpbmtzIHdoaWNoIGRvIG5vdCBqdXN0IGNvbnRhaW4gYSBzaW1wbGUgaGFzaC4KCQlpZihfY29tcGxleExpbmtzKSB7CgkJCS8vVGhlIGxpbmsgcG9pbnRzIHRvIHNvbWV0aGluZyBjb21wbGV0ZWx5IGRpZmZlcmVudC4KCQkJaWYobGluay5ob3N0bmFtZSAhPT0gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCgkJCS8vVGhlIGxpbmsgZG9lcyBub3QgbGluayB0byB0aGUgc2FtZSBwYWdlL3BhdGguCgkJCWlmKGxpbmsucGF0aG5hbWUgIT09IGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCgkJCWhhc2ggPSBsaW5rLmhhc2g7CgkJfSBlbHNlIHsKCQkJLy9Eb24ndCB1c2UgdGhlIGhyZWYgcHJvcGVydHkgKGxpbmsuaHJlZikgYmVjYXVzZSBpdCBjb250YWlucyB0aGUgYWJzb2x1dGUgdXJsLgoJCQloYXNoID0gbGluay5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTsKCQl9CgoJCS8vTm90IGEgaGFzaCBsaW5rLgoJCWlmKCEvXiMvLnRlc3QoaGFzaCkpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJLy9Ob3cgZ2V0IHRoZSB0YXJnZXRUb3AgdG8gc2Nyb2xsIHRvLgoJCXZhciB0YXJnZXRUb3A7CgoJCXZhciBtZW51VG9wOwoKCQkvL0lmIHRoZXJlJ3MgYSBoYW5kbGVMaW5rIGZ1bmN0aW9uLCBpdCBvdmVycmlkZXMgdGhlIGFjdHVhbCBhbmNob3Igb2Zmc2V0LgoJCWlmKF9oYW5kbGVMaW5rKSB7CgkJCW1lbnVUb3AgPSBfaGFuZGxlTGluayhsaW5rKTsKCQl9CgkJLy9JZiB0aGVyZSdzIGEgZGF0YS1tZW51LXRvcCBhdHRyaWJ1dGUgYW5kIG5vIGhhbmRsZUxpbmsgZnVuY3Rpb24sIGl0IG92ZXJyaWRlcyB0aGUgYWN0dWFsIGFuY2hvciBvZmZzZXQuCgkJZWxzZSB7CgkJCW1lbnVUb3AgPSBsaW5rLmdldEF0dHJpYnV0ZShNRU5VX1RPUF9BVFRSKTsKCQl9CgoJCWlmKG1lbnVUb3AgIT09IG51bGwpIHsKCQkJLy9JcyBpdCBhIHBlcmNlbnRhZ2Ugb2Zmc2V0PwoJCQlpZigvcCQvLnRlc3QobWVudVRvcCkpIHsKCQkJCXRhcmdldFRvcCA9IChtZW51VG9wLnNsaWNlKDAsIC0xKSAvIDEwMCkgKiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0OwoJCQl9IGVsc2UgewoJCQkJdGFyZ2V0VG9wID0gK21lbnVUb3AgKiBfc2NhbGU7CgkJCX0KCQl9IGVsc2UgewoJCQl2YXIgc2Nyb2xsVGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaGFzaC5zdWJzdHIoMSkpOwoKCQkJLy9JZ25vcmUgdGhlIGNsaWNrIGlmIG5vIHRhcmdldCBpcyBmb3VuZC4KCQkJaWYoIXNjcm9sbFRhcmdldCkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgoJCQl0YXJnZXRUb3AgPSBfc2tyb2xsckluc3RhbmNlLnJlbGF0aXZlVG9BYnNvbHV0ZShzY3JvbGxUYXJnZXQsICd0b3AnLCAndG9wJyk7CgoJCQl2YXIgbWVudU9mZnNldCA9IHNjcm9sbFRhcmdldC5nZXRBdHRyaWJ1dGUoTUVOVV9PRkZTRVRfQVRUUik7CgoJCQlpZihtZW51T2Zmc2V0ICE9PSBudWxsKSB7CgkJCQl0YXJnZXRUb3AgKz0gK21lbnVPZmZzZXQ7CgkJCX0KCQl9CgoJCWlmKHN1cHBvcnRzSGlzdG9yeSAmJiAhZmFrZSkgewoJCQloaXN0b3J5LnB1c2hTdGF0ZSh7dG9wOiB0YXJnZXRUb3B9LCAnJywgaGFzaCk7CgkJfQoKCQl2YXIgbWVudUR1cmF0aW9uID0gcGFyc2VJbnQobGluay5nZXRBdHRyaWJ1dGUoTUVOVV9EVVJBVElPTl9BVFRSKSwgMTApOwoJCXZhciBhbmltYXRpb25EdXJhdGlvbiA9IF9kdXJhdGlvbihfc2tyb2xsckluc3RhbmNlLmdldFNjcm9sbFRvcCgpLCB0YXJnZXRUb3ApOwoKCQlpZighaXNOYU4obWVudUR1cmF0aW9uKSkgewoJCQlhbmltYXRpb25EdXJhdGlvbiA9IG1lbnVEdXJhdGlvbjsKCQl9CgoJCS8vTm93IGZpbmFsbHkgc2Nyb2xsIHRoZXJlLgoJCWlmKF9hbmltYXRlICYmICFmYWtlKSB7CgkJCV9za3JvbGxySW5zdGFuY2UuYW5pbWF0ZVRvKHRhcmdldFRvcCwgewoJCQkJZHVyYXRpb246IGFuaW1hdGlvbkR1cmF0aW9uLAoJCQkJZWFzaW5nOiBfZWFzaW5nCgkJCX0pOwoJCX0gZWxzZSB7CgkJCWRlZmVyKGZ1bmN0aW9uKCkgewoJCQkJX3Nrcm9sbHJJbnN0YW5jZS5zZXRTY3JvbGxUb3AodGFyZ2V0VG9wKTsKCQkJfSk7CgkJfQoKCQlyZXR1cm4gdHJ1ZTsKCX07CgoJdmFyIGp1bXBTdHJhaWdodFRvSGFzaCA9IGZ1bmN0aW9uKCkgewoJCWlmKHdpbmRvdy5sb2NhdGlvbi5oYXNoICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IpIHsKCQkJdmFyIGxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhW2hyZWY9IicgKyB3aW5kb3cubG9jYXRpb24uaGFzaCArICciXScpOwoKCQkJaWYoIWxpbmspIHsKCQkJCS8vIE5vIGxpbmsgZm91bmQgb24gcGFnZSwgc28gd2UgY3JlYXRlIG9uZSBhbmQgdGhlbiBhY3RpdmF0ZSBpdAoJCQkJbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKCQkJCWxpbmsuaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOwoJCQl9CgoJCQloYW5kbGVMaW5rKGxpbmssIHRydWUpOwoJCX0KCX07CgoJdmFyIGRlZmVyID0gZnVuY3Rpb24oZm4pIHsKCQl3aW5kb3cuc2V0VGltZW91dChmbiwgMSk7Cgl9OwoKCS8qCgkJR2xvYmFsIG1lbnUgZnVuY3Rpb24gYWNjZXNzaWJsZSB0aHJvdWdoIHdpbmRvdy5za3JvbGxyLm1lbnUuaW5pdC4KCSovCglza3JvbGxyLm1lbnUgPSB7fTsKCXNrcm9sbHIubWVudS5pbml0ID0gZnVuY3Rpb24oc2tyb2xsckluc3RhbmNlLCBvcHRpb25zKSB7CgkJX3Nrcm9sbHJJbnN0YW5jZSA9IHNrcm9sbHJJbnN0YW5jZTsKCgkJb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgoJCV9lYXNpbmcgPSBvcHRpb25zLmVhc2luZyB8fCBERUZBVUxUX0VBU0lORzsKCQlfYW5pbWF0ZSA9IG9wdGlvbnMuYW5pbWF0ZSAhPT0gZmFsc2U7CgkJX2R1cmF0aW9uID0gb3B0aW9ucy5kdXJhdGlvbiB8fCBERUZBVUxUX0RVUkFUSU9OOwoJCV9oYW5kbGVMaW5rID0gb3B0aW9ucy5oYW5kbGVMaW5rOwoJCV9zY2FsZSA9IG9wdGlvbnMuc2NhbGUgfHwgREVGQVVMVF9TQ0FMRTsKCQlfY29tcGxleExpbmtzID0gb3B0aW9ucy5jb21wbGV4TGlua3MgPT09IHRydWU7CgoJCWlmKHR5cGVvZiBfZHVyYXRpb24gPT09ICdudW1iZXInKSB7CgkJCV9kdXJhdGlvbiA9IChmdW5jdGlvbihkdXJhdGlvbikgewoJCQkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCQkJCXJldHVybiBkdXJhdGlvbjsKCQkJCX07CgkJCX0oX2R1cmF0aW9uKSk7CgkJfQoKCQkvL1VzZSBldmVudCBidWJibGluZyBhbmQgYXR0YWNoIGEgc2luZ2xlIGxpc3RlbmVyIHRvIHRoZSBkb2N1bWVudC4KCQlza3JvbGxyLmFkZEV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCBoYW5kbGVDbGljayk7CgoJCWlmKHN1cHBvcnRzSGlzdG9yeSkgewoJCQlza3JvbGxyLmFkZEV2ZW50KHdpbmRvdywgJ3BvcHN0YXRlJywgZnVuY3Rpb24oZSkgewoJCQkJdmFyIHN0YXRlID0gZS5zdGF0ZSB8fCB7fTsKCQkJCXZhciB0b3AgPSBzdGF0ZS50b3AgfHwgMDsKCgkJCQlkZWZlcihmdW5jdGlvbigpIHsKCQkJCQlfc2tyb2xsckluc3RhbmNlLnNldFNjcm9sbFRvcCh0b3ApOwoJCQkJfSk7CgkJCX0sIGZhbHNlKTsKCQl9CgoJCWp1bXBTdHJhaWdodFRvSGFzaCgpOwoJfTsKCgkvL0V4cG9zZSB0aGUgaGFuZGxlTGluayBmdW5jdGlvbiB0byBiZSBhYmxlIHRvIHByb2dyYW1tYXRpY2FsbHkgdHJpZ2dlciBjbGlja3MuCglza3JvbGxyLm1lbnUuY2xpY2sgPSBmdW5jdGlvbihsaW5rKSB7CgkJLy9XZSdyZSBub3QgYXNzaWduaW5nIGl0IGRpcmVjdGx5IHRvIGBjbGlja2AgYmVjYXVzZSBvZiB0aGUgc2Vjb25kICgicHJpdmF0ZSIpIHBhcmFtZXRlci4KCQloYW5kbGVMaW5rKGxpbmspOwoJfTsKCgkvL1ByaXZhdGUgcmVmZXJlbmNlIHRvIHRoZSBpbml0aWFsaXplZCBza3JvbGxyLgoJdmFyIF9za3JvbGxySW5zdGFuY2U7CgoJdmFyIF9lYXNpbmc7Cgl2YXIgX2R1cmF0aW9uOwoJdmFyIF9hbmltYXRlOwoJdmFyIF9oYW5kbGVMaW5rOwoJdmFyIF9zY2FsZTsKCXZhciBfY29tcGxleExpbmtzOwoKCS8vSW4gY2FzZSB0aGUgcGFnZSB3YXMgb3BlbmVkIHdpdGggYSBoYXNoLCBwcmV2ZW50IGp1bXBpbmcgdG8gaXQuCgkvL2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzY1OTA3Mi9qcXVlcnktZGlzYWJsZS1hbmNob3ItanVtcC13aGVuLWxvYWRpbmctYS1wYWdlCglkZWZlcihmdW5jdGlvbigpIHsKCQlpZih3aW5kb3cubG9jYXRpb24uaGFzaCkgewoJCQl3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7CgkJfQoJfSk7Cn0oZG9jdW1lbnQsIHdpbmRvdykpOwo=",
                "body": "IC8qIQogKiBQbHVnaW4gZm9yIHNrcm9sbHIuCiAqIFRoaXMgcGx1Z2luIG1ha2VzIGhhc2hsaW5rcyBzY3JvbGwgbmljZWx5IHRvIHRoZWlyIHRhcmdldCBwb3NpdGlvbi4KICoKICogQWxleGFuZGVyIFByaW56aG9ybiAtIGh0dHBzOi8vZ2l0aHViLmNvbS9Qcmluemhvcm4vc2tyb2xscgogKgogKiBGcmVlIHRvIHVzZSB1bmRlciB0ZXJtcyBvZiBNSVQgbGljZW5zZQogKi8KKGZ1bmN0aW9uKGRvY3VtZW50LCB3aW5kb3cpIHsKCSd1c2Ugc3RyaWN0JzsKCgl2YXIgREVGQVVMVF9EVVJBVElPTiA9IDUwMDsKCXZhciBERUZBVUxUX0VBU0lORyA9ICdzcXJ0JzsKCXZhciBERUZBVUxUX1NDQUxFID0gMTsKCgl2YXIgTUVOVV9UT1BfQVRUUiA9ICdkYXRhLW1lbnUtdG9wJzsKCXZhciBNRU5VX09GRlNFVF9BVFRSID0gJ2RhdGEtbWVudS1vZmZzZXQnOwoJdmFyIE1FTlVfRFVSQVRJT05fQVRUUiA9ICdkYXRhLW1lbnUtZHVyYXRpb24nOwoKCXZhciBza3JvbGxyID0gd2luZG93LnNrcm9sbHI7Cgl2YXIgaGlzdG9yeSA9IHdpbmRvdy5oaXN0b3J5OwoJdmFyIHN1cHBvcnRzSGlzdG9yeSA9ICEhaGlzdG9yeS5wdXNoU3RhdGU7CgoJLyoKCQlTaW5jZSB3ZSBhcmUgdXNpbmcgZXZlbnQgYnViYmxpbmcsIHRoZSBlbGVtZW50IHRoYXQgaGFzIGJlZW4gY2xpY2tlZAoJCW1pZ2h0IG5vdCBhY3V0YWxseSBiZSB0aGUgbGluayBidXQgYSBjaGlsZC4KCSovCgl2YXIgZmluZFBhcmVudExpbmsgPSBmdW5jdGlvbihlbGVtZW50KSB7CgkJLy9XZSByZWFjaGVkIHRoZSB0b3AsIG5vIGxpbmsgZm91bmQuCgkJaWYoZWxlbWVudCA9PT0gZG9jdW1lbnQpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJLy9ZYXksIGl0J3MgYSBsaW5rIQoJCWlmKGVsZW1lbnQudGFnTmFtZS50b1VwcGVyQ2FzZSgpID09PSAnQScpIHsKCQkJcmV0dXJuIGVsZW1lbnQ7CgkJfQoKCQkvL01heWJlIHRoZSBwYXJlbnQgaXMgYSBsaW5rLgoJCXJldHVybiBmaW5kUGFyZW50TGluayhlbGVtZW50LnBhcmVudE5vZGUpOwoJfTsKCgkvKgoJCUhhbmRsZSB0aGUgY2xpY2sgZXZlbnQgb24gdGhlIGRvY3VtZW50LgoJKi8KCXZhciBoYW5kbGVDbGljayA9IGZ1bmN0aW9uKGUpIHsKCQkvL09ubHkgaGFuZGxlIGxlZnQgY2xpY2suCgkJaWYoZS53aGljaCAhPT0gMSAmJiBlLmJ1dHRvbiAhPT0gMCkgewoJCQlyZXR1cm47CgkJfQoKCQl2YXIgbGluayA9IGZpbmRQYXJlbnRMaW5rKGUudGFyZ2V0KTsKCgkJLy9UaGUgY2xpY2sgZGlkIG5vdCBoYXBwZW4gaW5zaWRlIGEgbGluay4KCQlpZighbGluaykgewoJCQlyZXR1cm47CgkJfQoKCQlpZihoYW5kbGVMaW5rKGxpbmspKSB7CgkJCWUucHJldmVudERlZmF1bHQoKTsKCQl9Cgl9OwoKCS8qCgkJSGFuZGxlcyB0aGUgY2xpY2sgb24gYSBsaW5rLiBNYXkgYmUgY2FsbGVkIHdpdGhvdXQgYW4gYWN0dWFsIGNsaWNrIGV2ZW50LgoJCVdoZW4gdGhlIGZha2UgZmxhZyBpcyBzZXQsIHRoZSBsaW5rIHdvbid0IGNoYW5nZSB0aGUgdXJsIGFuZCB0aGUgcG9zaXRpb24gd29uJ3QgYmUgYW5pbWF0ZWQuCgkqLwoJdmFyIGhhbmRsZUxpbmsgPSBmdW5jdGlvbihsaW5rLCBmYWtlKSB7CgkJdmFyIGhhc2g7CgoJCS8vV2hlbiBjb21wbGV4TGlua3MgaXMgZW5hYmxlZCwgd2UgYWxzbyBhY2NlcHQgbGlua3Mgd2hpY2ggZG8gbm90IGp1c3QgY29udGFpbiBhIHNpbXBsZSBoYXNoLgoJCWlmKF9jb21wbGV4TGlua3MpIHsKCQkJLy9UaGUgbGluayBwb2ludHMgdG8gc29tZXRoaW5nIGNvbXBsZXRlbHkgZGlmZmVyZW50LgoJCQlpZihsaW5rLmhvc3RuYW1lICE9PSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUpIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoKCQkJLy9UaGUgbGluayBkb2VzIG5vdCBsaW5rIHRvIHRoZSBzYW1lIHBhZ2UvcGF0aC4KCQkJaWYobGluay5wYXRobmFtZSAhPT0gZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUpIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoKCQkJaGFzaCA9IGxpbmsuaGFzaDsKCQl9IGVsc2UgewoJCQkvL0Rvbid0IHVzZSB0aGUgaHJlZiBwcm9wZXJ0eSAobGluay5ocmVmKSBiZWNhdXNlIGl0IGNvbnRhaW5zIHRoZSBhYnNvbHV0ZSB1cmwuCgkJCWhhc2ggPSBsaW5rLmdldEF0dHJpYnV0ZSgnaHJlZicpOwoJCX0KCgkJLy9Ob3QgYSBoYXNoIGxpbmsuCgkJaWYoIS9eIy8udGVzdChoYXNoKSkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQkvL05vdyBnZXQgdGhlIHRhcmdldFRvcCB0byBzY3JvbGwgdG8uCgkJdmFyIHRhcmdldFRvcDsKCgkJdmFyIG1lbnVUb3A7CgoJCS8vSWYgdGhlcmUncyBhIGhhbmRsZUxpbmsgZnVuY3Rpb24sIGl0IG92ZXJyaWRlcyB0aGUgYWN0dWFsIGFuY2hvciBvZmZzZXQuCgkJaWYoX2hhbmRsZUxpbmspIHsKCQkJbWVudVRvcCA9IF9oYW5kbGVMaW5rKGxpbmspOwoJCX0KCQkvL0lmIHRoZXJlJ3MgYSBkYXRhLW1lbnUtdG9wIGF0dHJpYnV0ZSBhbmQgbm8gaGFuZGxlTGluayBmdW5jdGlvbiwgaXQgb3ZlcnJpZGVzIHRoZSBhY3R1YWwgYW5jaG9yIG9mZnNldC4KCQllbHNlIHsKCQkJbWVudVRvcCA9IGxpbmsuZ2V0QXR0cmlidXRlKE1FTlVfVE9QX0FUVFIpOwoJCX0KCgkJaWYobWVudVRvcCAhPT0gbnVsbCkgewoJCQkvL0lzIGl0IGEgcGVyY2VudGFnZSBvZmZzZXQ/CgkJCWlmKC9wJC8udGVzdChtZW51VG9wKSkgewoJCQkJdGFyZ2V0VG9wID0gKG1lbnVUb3Auc2xpY2UoMCwgLTEpIC8gMTAwKSAqIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7CgkJCX0gZWxzZSB7CgkJCQl0YXJnZXRUb3AgPSArbWVudVRvcCAqIF9zY2FsZTsKCQkJfQoJCX0gZWxzZSB7CgkJCXZhciBzY3JvbGxUYXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChoYXNoLnN1YnN0cigxKSk7CgoJCQkvL0lnbm9yZSB0aGUgY2xpY2sgaWYgbm8gdGFyZ2V0IGlzIGZvdW5kLgoJCQlpZighc2Nyb2xsVGFyZ2V0KSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCgkJCXRhcmdldFRvcCA9IF9za3JvbGxySW5zdGFuY2UucmVsYXRpdmVUb0Fic29sdXRlKHNjcm9sbFRhcmdldCwgJ3RvcCcsICd0b3AnKTsKCgkJCXZhciBtZW51T2Zmc2V0ID0gc2Nyb2xsVGFyZ2V0LmdldEF0dHJpYnV0ZShNRU5VX09GRlNFVF9BVFRSKTsKCgkJCWlmKG1lbnVPZmZzZXQgIT09IG51bGwpIHsKCQkJCXRhcmdldFRvcCArPSArbWVudU9mZnNldDsKCQkJfQoJCX0KCgkJaWYoc3VwcG9ydHNIaXN0b3J5ICYmICFmYWtlKSB7CgkJCWhpc3RvcnkucHVzaFN0YXRlKHt0b3A6IHRhcmdldFRvcH0sICcnLCBoYXNoKTsKCQl9CgoJCXZhciBtZW51RHVyYXRpb24gPSBwYXJzZUludChsaW5rLmdldEF0dHJpYnV0ZShNRU5VX0RVUkFUSU9OX0FUVFIpLCAxMCk7CgkJdmFyIGFuaW1hdGlvbkR1cmF0aW9uID0gX2R1cmF0aW9uKF9za3JvbGxySW5zdGFuY2UuZ2V0U2Nyb2xsVG9wKCksIHRhcmdldFRvcCk7CgoJCWlmKCFpc05hTihtZW51RHVyYXRpb24pKSB7CgkJCWFuaW1hdGlvbkR1cmF0aW9uID0gbWVudUR1cmF0aW9uOwoJCX0KCgkJLy9Ob3cgZmluYWxseSBzY3JvbGwgdGhlcmUuCgkJaWYoX2FuaW1hdGUgJiYgIWZha2UpIHsKCQkJX3Nrcm9sbHJJbnN0YW5jZS5hbmltYXRlVG8odGFyZ2V0VG9wLCB7CgkJCQlkdXJhdGlvbjogYW5pbWF0aW9uRHVyYXRpb24sCgkJCQllYXNpbmc6IF9lYXNpbmcKCQkJfSk7CgkJfSBlbHNlIHsKCQkJZGVmZXIoZnVuY3Rpb24oKSB7CgkJCQlfc2tyb2xsckluc3RhbmNlLnNldFNjcm9sbFRvcCh0YXJnZXRUb3ApOwoJCQl9KTsKCQl9CgoJCXJldHVybiB0cnVlOwoJfTsKCgl2YXIganVtcFN0cmFpZ2h0VG9IYXNoID0gZnVuY3Rpb24oKSB7CgkJaWYod2luZG93LmxvY2F0aW9uLmhhc2ggJiYgZG9jdW1lbnQucXVlcnlTZWxlY3RvcikgewoJCQl2YXIgbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2FbaHJlZj0iJyArIHdpbmRvdy5sb2NhdGlvbi5oYXNoICsgJyJdJyk7CgoJCQlpZighbGluaykgewoJCQkJLy8gTm8gbGluayBmb3VuZCBvbiBwYWdlLCBzbyB3ZSBjcmVhdGUgb25lIGFuZCB0aGVuIGFjdGl2YXRlIGl0CgkJCQlsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwoJCQkJbGluay5ocmVmID0gd2luZG93LmxvY2F0aW9uLmhhc2g7CgkJCX0KCgkJCWhhbmRsZUxpbmsobGluaywgdHJ1ZSk7CgkJfQoJfTsKCgl2YXIgZGVmZXIgPSBmdW5jdGlvbihmbikgewoJCXdpbmRvdy5zZXRUaW1lb3V0KGZuLCAxKTsKCX07CgoJLyoKCQlHbG9iYWwgbWVudSBmdW5jdGlvbiBhY2Nlc3NpYmxlIHRocm91Z2ggd2luZG93LnNrcm9sbHIubWVudS5pbml0LgoJKi8KCXNrcm9sbHIubWVudSA9IHt9OwoJc2tyb2xsci5tZW51LmluaXQgPSBmdW5jdGlvbihza3JvbGxySW5zdGFuY2UsIG9wdGlvbnMpIHsKCQlfc2tyb2xsckluc3RhbmNlID0gc2tyb2xsckluc3RhbmNlOwoKCQlvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCgkJX2Vhc2luZyA9IG9wdGlvbnMuZWFzaW5nIHx8IERFRkFVTFRfRUFTSU5HOwoJCV9hbmltYXRlID0gb3B0aW9ucy5hbmltYXRlICE9PSBmYWxzZTsKCQlfZHVyYXRpb24gPSBvcHRpb25zLmR1cmF0aW9uIHx8IERFRkFVTFRfRFVSQVRJT047CgkJX2hhbmRsZUxpbmsgPSBvcHRpb25zLmhhbmRsZUxpbms7CgkJX3NjYWxlID0gb3B0aW9ucy5zY2FsZSB8fCBERUZBVUxUX1NDQUxFOwoJCV9jb21wbGV4TGlua3MgPSBvcHRpb25zLmNvbXBsZXhMaW5rcyA9PT0gdHJ1ZTsKCgkJaWYodHlwZW9mIF9kdXJhdGlvbiA9PT0gJ251bWJlcicpIHsKCQkJX2R1cmF0aW9uID0gKGZ1bmN0aW9uKGR1cmF0aW9uKSB7CgkJCQlyZXR1cm4gZnVuY3Rpb24oKSB7CgkJCQkJcmV0dXJuIGR1cmF0aW9uOwoJCQkJfTsKCQkJfShfZHVyYXRpb24pKTsKCQl9CgoJCS8vVXNlIGV2ZW50IGJ1YmJsaW5nIGFuZCBhdHRhY2ggYSBzaW5nbGUgbGlzdGVuZXIgdG8gdGhlIGRvY3VtZW50LgoJCXNrcm9sbHIuYWRkRXZlbnQoZG9jdW1lbnQsICdjbGljaycsIGhhbmRsZUNsaWNrKTsKCgkJaWYoc3VwcG9ydHNIaXN0b3J5KSB7CgkJCXNrcm9sbHIuYWRkRXZlbnQod2luZG93LCAncG9wc3RhdGUnLCBmdW5jdGlvbihlKSB7CgkJCQl2YXIgc3RhdGUgPSBlLnN0YXRlIHx8IHt9OwoJCQkJdmFyIHRvcCA9IHN0YXRlLnRvcCB8fCAwOwoKCQkJCWRlZmVyKGZ1bmN0aW9uKCkgewoJCQkJCV9za3JvbGxySW5zdGFuY2Uuc2V0U2Nyb2xsVG9wKHRvcCk7CgkJCQl9KTsKCQkJfSwgZmFsc2UpOwoJCX0KCgkJanVtcFN0cmFpZ2h0VG9IYXNoKCk7Cgl9OwoKCS8vRXhwb3NlIHRoZSBoYW5kbGVMaW5rIGZ1bmN0aW9uIHRvIGJlIGFibGUgdG8gcHJvZ3JhbW1hdGljYWxseSB0cmlnZ2VyIGNsaWNrcy4KCXNrcm9sbHIubWVudS5jbGljayA9IGZ1bmN0aW9uKGxpbmspIHsKCQkvL1dlJ3JlIG5vdCBhc3NpZ25pbmcgaXQgZGlyZWN0bHkgdG8gYGNsaWNrYCBiZWNhdXNlIG9mIHRoZSBzZWNvbmQgKCJwcml2YXRlIikgcGFyYW1ldGVyLgoJCWhhbmRsZUxpbmsobGluayk7Cgl9OwoKCS8vUHJpdmF0ZSByZWZlcmVuY2UgdG8gdGhlIGluaXRpYWxpemVkIHNrcm9sbHIuCgl2YXIgX3Nrcm9sbHJJbnN0YW5jZTsKCgl2YXIgX2Vhc2luZzsKCXZhciBfZHVyYXRpb247Cgl2YXIgX2FuaW1hdGU7Cgl2YXIgX2hhbmRsZUxpbms7Cgl2YXIgX3NjYWxlOwoJdmFyIF9jb21wbGV4TGlua3M7CgoJLy9JbiBjYXNlIHRoZSBwYWdlIHdhcyBvcGVuZWQgd2l0aCBhIGhhc2gsIHByZXZlbnQganVtcGluZyB0byBpdC4KCS8vaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zNjU5MDcyL2pxdWVyeS1kaXNhYmxlLWFuY2hvci1qdW1wLXdoZW4tbG9hZGluZy1hLXBhZ2UKCWRlZmVyKGZ1bmN0aW9uKCkgewoJCWlmKHdpbmRvdy5sb2NhdGlvbi5oYXNoKSB7CgkJCXdpbmRvdy5zY3JvbGxUbygwLCAwKTsKCQl9Cgl9KTsKfShkb2N1bWVudCwgd2luZG93KSk7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 04:48:33 GMT",
                    "Content-Length": "5887",
                    "Date": "Sat, 08 Nov 2014 04:48:33 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}