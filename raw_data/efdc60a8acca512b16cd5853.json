{
    "url": "http://localhost:9999/simogeo/Filemanager/scripts/CodeMirror/demo/theme.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>document.location.search</b> and written to <b>the 'value' property of a DOM element</b> via the following statements:<ul><li>var choice = document.location.search &amp;&amp;                decodeURIComponent(document.location.search.slice(1));</li><li>input.value = choice;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/simogeo/Filemanager/scripts/CodeMirror/demo/theme.html",
                "path": "/simogeo/Filemanager/scripts/CodeMirror/demo/theme.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9zaW1vZ2VvL0ZpbGVtYW5hZ2VyL3NjcmlwdHMvQ29kZU1pcnJvci9kZW1vL3RoZW1lLmh0bWwgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNDMyMw0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04DQpEYXRlOiBGcmksIDA3IE5vdiAyMDE0IDAwOjE1OjQ0IEdNVA0KTGFzdC1Nb2RpZmllZDogRnJpLCAwNyBOb3YgMjAxNCAwMDoxNTo0MSBHTVQNCg0KPCFkb2N0eXBlIGh0bWw+Cgo8dGl0bGU+Q29kZU1pcnJvcjogVGhlbWUgRGVtbzwvdGl0bGU+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+CjxsaW5rIHJlbD1zdHlsZXNoZWV0IGhyZWY9Ii4uL2RvYy9kb2NzLmNzcyI+Cgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2xpYi9jb2RlbWlycm9yLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvMzAyNC1kYXkuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS8zMDI0LW5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvYW1iaWFuY2UuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9iYXNlMTYtZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2Jhc2UxNi1saWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2JsYWNrYm9hcmQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9jb2JhbHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9lY2xpcHNlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvZWxlZ2FudC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2VybGFuZy1kYXJrLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbGVzc2VyLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tYm8uY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tZG4tbGlrZS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL21pZG5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbW9ub2thaS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL25lYXQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9uaWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9wYXN0ZWwtb24tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3J1YnlibHVlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvc29sYXJpemVkLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdGhlLW1hdHJpeC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3RvbW9ycm93LW5pZ2h0LWVpZ2h0aWVzLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdHdpbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS92aWJyYW50LWluay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3hxLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS94cS1saWdodC5jc3MiPgo8c2NyaXB0IHNyYz0iLi4vbGliL2NvZGVtaXJyb3IuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vbW9kZS9qYXZhc2NyaXB0L2phdmFzY3JpcHQuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vYWRkb24vc2VsZWN0aW9uL2FjdGl2ZS1saW5lLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Ii4uL2FkZG9uL2VkaXQvbWF0Y2hicmFja2V0cy5qcyI+PC9zY3JpcHQ+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgIC5Db2RlTWlycm9yIHtib3JkZXI6IDFweCBzb2xpZCBibGFjazsgZm9udC1zaXplOjEzcHh9CiAgICA8L3N0eWxlPgo8ZGl2IGlkPW5hdj4KICA8YSBocmVmPSJodHRwOi8vY29kZW1pcnJvci5uZXQiPjxpbWcgaWQ9bG9nbyBzcmM9Ii4uL2RvYy9sb2dvLnBuZyI+PC9hPgoKICA8dWw+CiAgICA8bGk+PGEgaHJlZj0iLi4vaW5kZXguaHRtbCI+SG9tZTwvYT4KICAgIDxsaT48YSBocmVmPSIuLi9kb2MvbWFudWFsLmh0bWwiPk1hbnVhbDwvYT4KICAgIDxsaT48YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vbWFyaWpuaC9jb2RlbWlycm9yIj5Db2RlPC9hPgogIDwvdWw+CiAgPHVsPgogICAgPGxpPjxhIGNsYXNzPWFjdGl2ZSBocmVmPSIjIj5UaGVtZTwvYT4KICA8L3VsPgo8L2Rpdj4KCjxhcnRpY2xlPgo8aDI+VGhlbWUgRGVtbzwvaDI+Cjxmb3JtPjx0ZXh0YXJlYSBpZD0iY29kZSIgbmFtZT0iY29kZSI+CmZ1bmN0aW9uIGZpbmRTZXF1ZW5jZShnb2FsKSB7CiAgZnVuY3Rpb24gZmluZChzdGFydCwgaGlzdG9yeSkgewogICAgaWYgKHN0YXJ0ID09IGdvYWwpCiAgICAgIHJldHVybiBoaXN0b3J5OwogICAgZWxzZSBpZiAoc3RhcnQgPiBnb2FsKQogICAgICByZXR1cm4gbnVsbDsKICAgIGVsc2UKICAgICAgcmV0dXJuIGZpbmQoc3RhcnQgKyA1LCAiKCIgKyBoaXN0b3J5ICsgIiArIDUpIikgfHwKICAgICAgICAgICAgIGZpbmQoc3RhcnQgKiAzLCAiKCIgKyBoaXN0b3J5ICsgIiAqIDMpIik7CiAgfQogIHJldHVybiBmaW5kKDEsICIxIik7Cn08L3RleHRhcmVhPjwvZm9ybT4KCjxwPlNlbGVjdCBhIHRoZW1lOiA8c2VsZWN0IG9uY2hhbmdlPSJzZWxlY3RUaGVtZSgpIiBpZD1zZWxlY3Q+CiAgICA8b3B0aW9uIHNlbGVjdGVkPmRlZmF1bHQ8L29wdGlvbj4KICAgIDxvcHRpb24+MzAyNC1kYXk8L29wdGlvbj4KICAgIDxvcHRpb24+MzAyNC1uaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj5hbWJpYW5jZTwvb3B0aW9uPgogICAgPG9wdGlvbj5iYXNlMTYtZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5iYXNlMTYtbGlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+YmxhY2tib2FyZDwvb3B0aW9uPgogICAgPG9wdGlvbj5jb2JhbHQ8L29wdGlvbj4KICAgIDxvcHRpb24+ZWNsaXBzZTwvb3B0aW9uPgogICAgPG9wdGlvbj5lbGVnYW50PC9vcHRpb24+CiAgICA8b3B0aW9uPmVybGFuZy1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPmxlc3Nlci1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPm1ibzwvb3B0aW9uPgogICAgPG9wdGlvbj5tZG4tbGlrZTwvb3B0aW9uPgogICAgPG9wdGlvbj5taWRuaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj5tb25va2FpPC9vcHRpb24+CiAgICA8b3B0aW9uPm5lYXQ8L29wdGlvbj4KICAgIDxvcHRpb24+bmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+cGFyYWlzby1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPnBhcmFpc28tbGlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+cGFzdGVsLW9uLWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+cnVieWJsdWU8L29wdGlvbj4KICAgIDxvcHRpb24+c29sYXJpemVkIGRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+c29sYXJpemVkIGxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPnRoZS1tYXRyaXg8L29wdGlvbj4KICAgIDxvcHRpb24+dG9tb3Jyb3ctbmlnaHQtZWlnaHRpZXM8L29wdGlvbj4KICAgIDxvcHRpb24+dHdpbGlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+dmlicmFudC1pbms8L29wdGlvbj4KICAgIDxvcHRpb24+eHEtZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj54cS1saWdodDwvb3B0aW9uPgo8L3NlbGVjdD4KPC9wPgoKPHNjcmlwdD4KICB2YXIgZWRpdG9yID0gQ29kZU1pcnJvci5mcm9tVGV4dEFyZWEoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvZGUiKSwgewogICAgbGluZU51bWJlcnM6IHRydWUsCiAgICBzdHlsZUFjdGl2ZUxpbmU6IHRydWUsCiAgICBtYXRjaEJyYWNrZXRzOiB0cnVlCiAgfSk7CiAgdmFyIGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNlbGVjdCIpOwogIGZ1bmN0aW9uIHNlbGVjdFRoZW1lKCkgewogICAgdmFyIHRoZW1lID0gaW5wdXQub3B0aW9uc1tpbnB1dC5zZWxlY3RlZEluZGV4XS5pbm5lckhUTUw7CiAgICBlZGl0b3Iuc2V0T3B0aW9uKCJ0aGVtZSIsIHRoZW1lKTsKICB9CiAgdmFyIGNob2ljZSA9IGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaCAmJgogICAgICAgICAgICAgICBkZWNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQubG9jYXRpb24uc2VhcmNoLnNsaWNlKDEpKTsKICBpZiAoY2hvaWNlKSB7CiAgICBpbnB1dC52YWx1ZSA9IGNob2ljZTsKICAgIGVkaXRvci5zZXRPcHRpb24oInRoZW1lIiwgY2hvaWNlKTsKICB9Cjwvc2NyaXB0PgogIDwvYXJ0aWNsZT4K",
                "body": "PCFkb2N0eXBlIGh0bWw+Cgo8dGl0bGU+Q29kZU1pcnJvcjogVGhlbWUgRGVtbzwvdGl0bGU+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+CjxsaW5rIHJlbD1zdHlsZXNoZWV0IGhyZWY9Ii4uL2RvYy9kb2NzLmNzcyI+Cgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2xpYi9jb2RlbWlycm9yLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvMzAyNC1kYXkuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS8zMDI0LW5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvYW1iaWFuY2UuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9iYXNlMTYtZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2Jhc2UxNi1saWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2JsYWNrYm9hcmQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9jb2JhbHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9lY2xpcHNlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvZWxlZ2FudC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL2VybGFuZy1kYXJrLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbGVzc2VyLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tYm8uY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9tZG4tbGlrZS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL21pZG5pZ2h0LmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvbW9ub2thaS5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL25lYXQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9uaWdodC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3BhcmFpc28tbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS9wYXN0ZWwtb24tZGFyay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3J1YnlibHVlLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvc29sYXJpemVkLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdGhlLW1hdHJpeC5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3RvbW9ycm93LW5pZ2h0LWVpZ2h0aWVzLmNzcyI+CjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vdGhlbWUvdHdpbGlnaHQuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS92aWJyYW50LWluay5jc3MiPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL3RoZW1lL3hxLWRhcmsuY3NzIj4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi90aGVtZS94cS1saWdodC5jc3MiPgo8c2NyaXB0IHNyYz0iLi4vbGliL2NvZGVtaXJyb3IuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vbW9kZS9qYXZhc2NyaXB0L2phdmFzY3JpcHQuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iLi4vYWRkb24vc2VsZWN0aW9uL2FjdGl2ZS1saW5lLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Ii4uL2FkZG9uL2VkaXQvbWF0Y2hicmFja2V0cy5qcyI+PC9zY3JpcHQ+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgIC5Db2RlTWlycm9yIHtib3JkZXI6IDFweCBzb2xpZCBibGFjazsgZm9udC1zaXplOjEzcHh9CiAgICA8L3N0eWxlPgo8ZGl2IGlkPW5hdj4KICA8YSBocmVmPSJodHRwOi8vY29kZW1pcnJvci5uZXQiPjxpbWcgaWQ9bG9nbyBzcmM9Ii4uL2RvYy9sb2dvLnBuZyI+PC9hPgoKICA8dWw+CiAgICA8bGk+PGEgaHJlZj0iLi4vaW5kZXguaHRtbCI+SG9tZTwvYT4KICAgIDxsaT48YSBocmVmPSIuLi9kb2MvbWFudWFsLmh0bWwiPk1hbnVhbDwvYT4KICAgIDxsaT48YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vbWFyaWpuaC9jb2RlbWlycm9yIj5Db2RlPC9hPgogIDwvdWw+CiAgPHVsPgogICAgPGxpPjxhIGNsYXNzPWFjdGl2ZSBocmVmPSIjIj5UaGVtZTwvYT4KICA8L3VsPgo8L2Rpdj4KCjxhcnRpY2xlPgo8aDI+VGhlbWUgRGVtbzwvaDI+Cjxmb3JtPjx0ZXh0YXJlYSBpZD0iY29kZSIgbmFtZT0iY29kZSI+CmZ1bmN0aW9uIGZpbmRTZXF1ZW5jZShnb2FsKSB7CiAgZnVuY3Rpb24gZmluZChzdGFydCwgaGlzdG9yeSkgewogICAgaWYgKHN0YXJ0ID09IGdvYWwpCiAgICAgIHJldHVybiBoaXN0b3J5OwogICAgZWxzZSBpZiAoc3RhcnQgPiBnb2FsKQogICAgICByZXR1cm4gbnVsbDsKICAgIGVsc2UKICAgICAgcmV0dXJuIGZpbmQoc3RhcnQgKyA1LCAiKCIgKyBoaXN0b3J5ICsgIiArIDUpIikgfHwKICAgICAgICAgICAgIGZpbmQoc3RhcnQgKiAzLCAiKCIgKyBoaXN0b3J5ICsgIiAqIDMpIik7CiAgfQogIHJldHVybiBmaW5kKDEsICIxIik7Cn08L3RleHRhcmVhPjwvZm9ybT4KCjxwPlNlbGVjdCBhIHRoZW1lOiA8c2VsZWN0IG9uY2hhbmdlPSJzZWxlY3RUaGVtZSgpIiBpZD1zZWxlY3Q+CiAgICA8b3B0aW9uIHNlbGVjdGVkPmRlZmF1bHQ8L29wdGlvbj4KICAgIDxvcHRpb24+MzAyNC1kYXk8L29wdGlvbj4KICAgIDxvcHRpb24+MzAyNC1uaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj5hbWJpYW5jZTwvb3B0aW9uPgogICAgPG9wdGlvbj5iYXNlMTYtZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj5iYXNlMTYtbGlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+YmxhY2tib2FyZDwvb3B0aW9uPgogICAgPG9wdGlvbj5jb2JhbHQ8L29wdGlvbj4KICAgIDxvcHRpb24+ZWNsaXBzZTwvb3B0aW9uPgogICAgPG9wdGlvbj5lbGVnYW50PC9vcHRpb24+CiAgICA8b3B0aW9uPmVybGFuZy1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPmxlc3Nlci1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPm1ibzwvb3B0aW9uPgogICAgPG9wdGlvbj5tZG4tbGlrZTwvb3B0aW9uPgogICAgPG9wdGlvbj5taWRuaWdodDwvb3B0aW9uPgogICAgPG9wdGlvbj5tb25va2FpPC9vcHRpb24+CiAgICA8b3B0aW9uPm5lYXQ8L29wdGlvbj4KICAgIDxvcHRpb24+bmlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+cGFyYWlzby1kYXJrPC9vcHRpb24+CiAgICA8b3B0aW9uPnBhcmFpc28tbGlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+cGFzdGVsLW9uLWRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+cnVieWJsdWU8L29wdGlvbj4KICAgIDxvcHRpb24+c29sYXJpemVkIGRhcms8L29wdGlvbj4KICAgIDxvcHRpb24+c29sYXJpemVkIGxpZ2h0PC9vcHRpb24+CiAgICA8b3B0aW9uPnRoZS1tYXRyaXg8L29wdGlvbj4KICAgIDxvcHRpb24+dG9tb3Jyb3ctbmlnaHQtZWlnaHRpZXM8L29wdGlvbj4KICAgIDxvcHRpb24+dHdpbGlnaHQ8L29wdGlvbj4KICAgIDxvcHRpb24+dmlicmFudC1pbms8L29wdGlvbj4KICAgIDxvcHRpb24+eHEtZGFyazwvb3B0aW9uPgogICAgPG9wdGlvbj54cS1saWdodDwvb3B0aW9uPgo8L3NlbGVjdD4KPC9wPgoKPHNjcmlwdD4KICB2YXIgZWRpdG9yID0gQ29kZU1pcnJvci5mcm9tVGV4dEFyZWEoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvZGUiKSwgewogICAgbGluZU51bWJlcnM6IHRydWUsCiAgICBzdHlsZUFjdGl2ZUxpbmU6IHRydWUsCiAgICBtYXRjaEJyYWNrZXRzOiB0cnVlCiAgfSk7CiAgdmFyIGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNlbGVjdCIpOwogIGZ1bmN0aW9uIHNlbGVjdFRoZW1lKCkgewogICAgdmFyIHRoZW1lID0gaW5wdXQub3B0aW9uc1tpbnB1dC5zZWxlY3RlZEluZGV4XS5pbm5lckhUTUw7CiAgICBlZGl0b3Iuc2V0T3B0aW9uKCJ0aGVtZSIsIHRoZW1lKTsKICB9CiAgdmFyIGNob2ljZSA9IGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaCAmJgogICAgICAgICAgICAgICBkZWNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQubG9jYXRpb24uc2VhcmNoLnNsaWNlKDEpKTsKICBpZiAoY2hvaWNlKSB7CiAgICBpbnB1dC52YWx1ZSA9IGNob2ljZTsKICAgIGVkaXRvci5zZXRPcHRpb24oInRoZW1lIiwgY2hvaWNlKTsKICB9Cjwvc2NyaXB0PgogIDwvYXJ0aWNsZT4K",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 00:15:41 GMT",
                    "Content-Length": "4323",
                    "Date": "Fri, 07 Nov 2014 00:15:44 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}