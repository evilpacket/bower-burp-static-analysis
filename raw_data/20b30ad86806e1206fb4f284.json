{
    "url": "http://localhost:9999/ibm-js/dapp/tests/unit/jqm/transitionVisibility/Test.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>location.href</b> and written to <b>history.pushState()</b> via the following statement:<ul><li>history.pushState(null, null, location.href.replace(/#/, ''));</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/ibm-js/dapp/tests/unit/jqm/transitionVisibility/Test.js",
                "path": "/ibm-js/dapp/tests/unit/jqm/transitionVisibility/Test.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9pYm0tanMvZGFwcC90ZXN0cy91bml0L2pxbS90cmFuc2l0aW9uVmlzaWJpbGl0eS9UZXN0LmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogNjExMg0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAyMDowMDozNCBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMjA6MDA6MzMgR01UDQoNCnJlcXVpcmUoWyJqcXVlcnkiXSwKCWZ1bmN0aW9uICgkKSB7CgkJLy8gdGhpcyBtdXN0IGJlIHNldHVwIGFmdGVyIGpxdWVyeSBpcyBsb2FkZWQsIGJ1dCBiZWZvcmUganF1ZXJ5Lm1vYmlsZSBpcyBsb2FkZWQKCQkkKGRvY3VtZW50KS5iaW5kKCJtb2JpbGVpbml0IiwgZnVuY3Rpb24gKCkgewoJCQkvLyBpZiB0aGlzIGlzIHNldCBmYWxzZSB0aGUgYXBwIG11c3QgY2FsbCAkLm1vYmlsZS5pbml0aWFsaXplUGFnZSgpOwoJCQkkLm1vYmlsZS5hdXRvSW5pdGlhbGl6ZVBhZ2UgPSBmYWxzZTsKCgkJCS8vIFByZXZlbnRzIGFsbCBhbmNob3IgY2xpY2sgaGFuZGxpbmcKCQkJJC5tb2JpbGUubGlua0JpbmRpbmdFbmFibGVkID0gZmFsc2U7CgoJCQkvLyBEaXNhYmxpbmcgdGhpcyB3aWxsIHByZXZlbnQgalF1ZXJ5IE1vYmlsZSBmcm9tIGhhbmRsaW5nIGhhc2ggY2hhbmdlcwoJCQkvLyBpZiBlbmFibGVkIEhpc3RvcnkgY29udHJvbGxlciBzaG91bGQgbm90IGJlIHVzZWQuCgkJCSQubW9iaWxlLmhhc2hMaXN0ZW5pbmdFbmFibGVkID0gZmFsc2U7CgoJCQkvLyBrZWVwIGFsbCBwcmV2aW91c2x5LXZpc2l0ZWQgcGFnZXMgaW4gdGhlIERPTQoJCQkkLm1vYmlsZS5wYWdlLnByb3RvdHlwZS5vcHRpb25zLmRvbUNhY2hlID0gdHJ1ZTsKCgkJCS8vIHRoZSBoYXNoIGluIHRoZSBsb2NhdGlvbiBiYXIgc2hvdWxkIG5vdCBiZSB1cGRhdGVkIGJ5IGpxdWVyeS5tb2JpbGUKCQkJJC5tb2JpbGUuY2hhbmdlUGFnZS5kZWZhdWx0cy5jaGFuZ2VIYXNoID0gZmFsc2U7CgkJfSk7Cgl9KTsKCi8vIGpzaGludCBxdW90bWFyazpmYWxzZQpkZWZpbmUoWwoJImludGVybiFvYmplY3QiLAoJImludGVybi9jaGFpIWFzc2VydCIsCgkiZGFwcC9BcHBsaWNhdGlvbiIsCgkiZG9qby9EZWZlcnJlZCIsCgkicmVxdWlyZWpzLXRleHQvdGV4dCFkYXBwL3Rlc3RzL3VuaXQvanFtL3RyYW5zaXRpb25WaXNpYmlsaXR5L2FwcC5qc29uIiwKCSJqcXVlcnkiLAoJImpxdWVyeS5tb2JpbGUiLAoJImRlbGl0ZWZ1bC9MaW5lYXJMYXlvdXQiLAoJImRlbGl0ZWZ1bC9WaWV3U3RhY2siCl0sIGZ1bmN0aW9uIChyZWdpc3RlclN1aXRlLCBhc3NlcnQsIEFwcGxpY2F0aW9uLCBEZWZlcnJlZCwganFtVHJhbnNpdGlvblZpc2liaWxpdHljb25maWcsICQpIHsKCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vCgkvLyBmb3IganFtVHJhbnNpdGlvblZpc2liaWxpdHlTdWl0ZQoJdmFyIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5Q29udGFpbmVyMywKCQl0ZXN0QXBwLAoJCWpxbVRyYW5zaXRpb25WaXNpYmlsaXR5Tm9kZTM7CgoJdmFyIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5SHRtbENvbnRlbnQzID0KCQknPGRpdiBpZD0ibWFpbiI+PC9kaXY+PC9kaXY+JzsKCS8vCSc8ZGl2IGlkPSJtYWluIj48ZGl2IGlkPSJkdW1teVBhZ2UiIGRhdGEtcm9sZT0icGFnZSI+PC9kaXY+PC9kaXY+JzsKCgl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlTdWl0ZSA9IHsKCQluYW1lOiAianFtVHJhbnNpdGlvblZpc2liaWxpdHlTdWl0ZSBkYXBwIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5OiB0ZXN0IGFwcCB0cmFuc2l0aW9ucyIsCgkJc2V0dXA6IGZ1bmN0aW9uICgpIHsKCQkJZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUh0bWxDb250ZW50MzsKCgkJCS8vIGRvbid0IGZvcmdldCB0byB0cmlnZ2VyIGpxdWVyeS5tb2JpbGUgbWFudWFsbHkKCQkJaWYgKCQubW9iaWxlLmF1dG9Jbml0aWFsaXplUGFnZSA9PT0gZmFsc2UpIHsKCQkJCSQubW9iaWxlLmluaXRpYWxpemVQYWdlKCk7CgkJCX0KCgkJCWpxbVRyYW5zaXRpb25WaXNpYmlsaXR5Tm9kZTMgPSAkKCIjbWFpbiIpOwoJCX0sCgkJImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5U3VpdGUgZGFwcCBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eSB0ZXN0IGluaXRpYWwgbGF5b3V0IjogZnVuY3Rpb24gKCkgewoJCQl0aGlzLnRpbWVvdXQgPSAyMDAwMDsKCgkJCXZhciBhcHBTdGFydGVkRGVmID0gbmV3IEFwcGxpY2F0aW9uKEpTT04ucGFyc2Uoc3RyaXBDb21tZW50cyhqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eWNvbmZpZykpLAoJCQkJanFtVHJhbnNpdGlvblZpc2liaWxpdHlDb250YWluZXIzKTsKCQkJcmV0dXJuIGFwcFN0YXJ0ZWREZWYudGhlbihmdW5jdGlvbiAoYXBwKSB7CgkJCQkvLyB3ZSBhcmUgcmVhZHkgdG8gdGVzdAoJCQkJdGVzdEFwcCA9IGFwcDsKCgkJCQkvL3ZhciBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxWCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIik7CgkJCQl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSA9ICQoIiNqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIik7CgkJCQl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMUFjdGl2ZVRlc3QgPQoJCQkJCSQoIiNqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIikuaGFzQ2xhc3MoInVpLXBhZ2UtYWN0aXZlIik7CgkJCQkvLyBjaGVjayB0aGUgRE9NIHN0YXRlIHRvIHNlZSBpZiB3ZSBhcmUgaW4gdGhlIGV4cGVjdGVkIHN0YXRlCgkJCQlhc3NlcnQuaXNOb3ROdWxsKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5Tm9kZTMsICJyb290IGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5Tm9kZTMgbXVzdCBiZSBoZXJlIik7CgkJCQlhc3NlcnQuaXNOb3ROdWxsKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEsICJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIHZpZXcgaGVyZSIpOwoJCQkJLy9hc3NlcnQuaXNOb3ROdWxsKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTFWaXNUZXN0LAoJCQkJLy8gImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEgdmlldyBzaG91bGQgYmUgdmlzaWJsZSIpOwoJCQkJLy92YXIgbiA9IGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTFYLnN0eWxlLmRpc3BsYXk7CgkJCQlhc3NlcnQuaXNUcnVlKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTFBY3RpdmVUZXN0LAoJCQkJCSJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIHZpZXcgc2hvdWxkIGJlIGFjdGl2ZSIpOwoKCQkJfSk7CgkJfSwKCQkiVGVzdCBkaXNwbGF5VmlldyAoYnkgdmlldyBuYW1lKSAiOiBmdW5jdGlvbiAoKSB7CgkJCXRoaXMudGltZW91dCA9IDIwMDAwOwoJCQl2YXIgZGlzcGxheURlZmVycmVkID0gbmV3IERlZmVycmVkKCk7CgoJCQl0ZXN0QXBwLnNob3dPckhpZGVWaWV3cygnanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMicsIHsKCQkJCWRpc3BsYXlEZWZlcnJlZDogZGlzcGxheURlZmVycmVkCgkJCX0pOwoJCQlyZXR1cm4gZGlzcGxheURlZmVycmVkLnRoZW4oZnVuY3Rpb24gKCkgewoJCQkJdmFyIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTIgPSAkKCIjanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMiIpOwoJCQkJdmFyIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTJBY3RpdmVUZXN0ID0KCQkJCQkkKCIjanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMiIpLmhhc0NsYXNzKCJ1aS1wYWdlLWFjdGl2ZSIpOwoJCQkJdmFyIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEgPSAkKCIjanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSIpOwoJCQkJdmFyIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTFBY3RpdmVUZXN0ID0KCQkJCQkkKCIjanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSIpLmhhc0NsYXNzKCJ1aS1wYWdlLWFjdGl2ZSIpOwoJCQkJLy8gY2hlY2sgdGhlIERPTSBzdGF0ZSB0byBzZWUgaWYgd2UgYXJlIGluIHRoZSBleHBlY3RlZCBzdGF0ZQoJCQkJdmFyIHBOb2RlID0ganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMlswXS5wYXJlbnROb2RlOwoJCQkJdmFyIGFjdGl2ZU5vZGUgPSAkKHBOb2RlKS5wYWdlY29udGFpbmVyKCJnZXRBY3RpdmVQYWdlIik7CgkJCQlhc3NlcnQuaXNOb3ROdWxsKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTIsICJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyIHZpZXcgaGVyZSIpOwoJCQkJYXNzZXJ0LmlzVHJ1ZShqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyQWN0aXZlVGVzdCwKCQkJCQkianFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSB2aWV3IHNob3VsZCBiZSBhY3RpdmUiKTsKCQkJCS8vYXNzZXJ0LmlzVHJ1ZShqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyWzBdLnN0eWxlLmRpc3BsYXkgIT09ICJub25lIiwKCQkJCS8vICJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyIHZpZXcgc2hvdWxkIGJlIHZpc2libGUiKTsKCQkJCWFzc2VydC5zdHJpY3RFcXVhbChqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyWzBdLmlkLCBhY3RpdmVOb2RlWzBdLmlkLAoJCQkJCSJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyIHNob3VsZCBiZSB0aGUgYWN0aXZlIHBhZ2UiKTsKCQkJCS8vYXNzZXJ0LmlzTm90TnVsbChqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyVmlzVGVzdCwKCQkJCS8vICJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyIHZpZXcgc2hvdWxkIGJlIHZpc2libGUiKTsKCQkJCWFzc2VydC5pc05vdE51bGwoanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSwgImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEgdmlldyBoZXJlIik7CgkJCQlhc3NlcnQuaXNGYWxzZShqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxQWN0aXZlVGVzdCwKCQkJCQkianFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSB2aWV3IHNob3VsZCBub3QgYmUgYWN0aXZlIik7CgkJCQkvLwl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMlggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgianFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMiIpOwoJCQkJLy8JdmFyIG4gPSBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyWC5zdHlsZS5kaXNwbGF5OwoJCQkJLy8JdGhpcyB0ZXN0IGlzIGZhaWxpbmcsIG5vdCBzdXJlIHdoeSBpdCBpcyBub3Qgc2hvd2luZyBhcyBkaXNwbGF5IG5vbmUuCgkJCQkvLwlhc3NlcnQuaXNUcnVlKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTFbMF0uc3R5bGUuZGlzcGxheSA9PT0gIm5vbmUiLAoJCQkJLy8gImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEgdmlldyBzaG91bGQgYmUgaGlkZGVuIik7CgkJCQkvL2Fzc2VydC5pc05vdE51bGwoanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMVZpc1Rlc3QsCgkJCQkvLyAianFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSB2aWV3IHNob3VsZCBiZSBoaWRkZW4iKTsKCQkJfSk7CgkJfSwKCQl0ZWFyZG93bjogZnVuY3Rpb24gKCkgewoJCQkvLyBjYWxsIHVubG9hZEFwcCB0byBjbGVhbnVwIGFuZCBlbmQgdGhlIHRlc3QKCQkJdmFyIG1haW5Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1haW4iKTsKCQkJbWFpbk5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChtYWluTm9kZSk7CgkJCXRlc3RBcHAudW5sb2FkQXBwKCk7CgkJCS8vIHRoaXMgaXMgdG8gcmVzZXQgdGhlIHVybCBzbyB0aGF0IGEgYnJvd3NlciByZWZyZXNoIGNhbiByZXJ1biB0aGUgdGVzdHMKCQkJbG9jYXRpb24uaGFzaCA9ICI/Y29uZmlnPXRlc3RzL2ludGVybi5icm93c2VyIjsKCQkJaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgbG9jYXRpb24uaHJlZi5yZXBsYWNlKC8jLywgJycpKTsKCQl9Cgl9OwoKCXJlZ2lzdGVyU3VpdGUoanFtVHJhbnNpdGlvblZpc2liaWxpdHlTdWl0ZSk7CgoJLy8gc3RyaXAgb3V0IHNpbmdsZSBsaW5lIGNvbW1lbnRzIGZyb20gdGhlIGpzb24gY29uZmlnCglmdW5jdGlvbiBzdHJpcENvbW1lbnRzKGpzb25EYXRhKSB7CgkJanNvbkRhdGEgPSBqc29uRGF0YS5yZXBsYWNlKC9cL1wqLio/XCpcLy9nLCAiIik7CgkJanNvbkRhdGEgPSBqc29uRGF0YS5yZXBsYWNlKC9cL1wvLiovZywgIiIpOwoJCXJldHVybiBqc29uRGF0YTsKCX0KCn0pOwo=",
                "body": "cmVxdWlyZShbImpxdWVyeSJdLAoJZnVuY3Rpb24gKCQpIHsKCQkvLyB0aGlzIG11c3QgYmUgc2V0dXAgYWZ0ZXIganF1ZXJ5IGlzIGxvYWRlZCwgYnV0IGJlZm9yZSBqcXVlcnkubW9iaWxlIGlzIGxvYWRlZAoJCSQoZG9jdW1lbnQpLmJpbmQoIm1vYmlsZWluaXQiLCBmdW5jdGlvbiAoKSB7CgkJCS8vIGlmIHRoaXMgaXMgc2V0IGZhbHNlIHRoZSBhcHAgbXVzdCBjYWxsICQubW9iaWxlLmluaXRpYWxpemVQYWdlKCk7CgkJCSQubW9iaWxlLmF1dG9Jbml0aWFsaXplUGFnZSA9IGZhbHNlOwoKCQkJLy8gUHJldmVudHMgYWxsIGFuY2hvciBjbGljayBoYW5kbGluZwoJCQkkLm1vYmlsZS5saW5rQmluZGluZ0VuYWJsZWQgPSBmYWxzZTsKCgkJCS8vIERpc2FibGluZyB0aGlzIHdpbGwgcHJldmVudCBqUXVlcnkgTW9iaWxlIGZyb20gaGFuZGxpbmcgaGFzaCBjaGFuZ2VzCgkJCS8vIGlmIGVuYWJsZWQgSGlzdG9yeSBjb250cm9sbGVyIHNob3VsZCBub3QgYmUgdXNlZC4KCQkJJC5tb2JpbGUuaGFzaExpc3RlbmluZ0VuYWJsZWQgPSBmYWxzZTsKCgkJCS8vIGtlZXAgYWxsIHByZXZpb3VzbHktdmlzaXRlZCBwYWdlcyBpbiB0aGUgRE9NCgkJCSQubW9iaWxlLnBhZ2UucHJvdG90eXBlLm9wdGlvbnMuZG9tQ2FjaGUgPSB0cnVlOwoKCQkJLy8gdGhlIGhhc2ggaW4gdGhlIGxvY2F0aW9uIGJhciBzaG91bGQgbm90IGJlIHVwZGF0ZWQgYnkganF1ZXJ5Lm1vYmlsZQoJCQkkLm1vYmlsZS5jaGFuZ2VQYWdlLmRlZmF1bHRzLmNoYW5nZUhhc2ggPSBmYWxzZTsKCQl9KTsKCX0pOwoKLy8ganNoaW50IHF1b3RtYXJrOmZhbHNlCmRlZmluZShbCgkiaW50ZXJuIW9iamVjdCIsCgkiaW50ZXJuL2NoYWkhYXNzZXJ0IiwKCSJkYXBwL0FwcGxpY2F0aW9uIiwKCSJkb2pvL0RlZmVycmVkIiwKCSJyZXF1aXJlanMtdGV4dC90ZXh0IWRhcHAvdGVzdHMvdW5pdC9qcW0vdHJhbnNpdGlvblZpc2liaWxpdHkvYXBwLmpzb24iLAoJImpxdWVyeSIsCgkianF1ZXJ5Lm1vYmlsZSIsCgkiZGVsaXRlZnVsL0xpbmVhckxheW91dCIsCgkiZGVsaXRlZnVsL1ZpZXdTdGFjayIKXSwgZnVuY3Rpb24gKHJlZ2lzdGVyU3VpdGUsIGFzc2VydCwgQXBwbGljYXRpb24sIERlZmVycmVkLCBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eWNvbmZpZywgJCkgewoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy8KCS8vIGZvciBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eVN1aXRlCgl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlDb250YWluZXIzLAoJCXRlc3RBcHAsCgkJanFtVHJhbnNpdGlvblZpc2liaWxpdHlOb2RlMzsKCgl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlIdG1sQ29udGVudDMgPQoJCSc8ZGl2IGlkPSJtYWluIj48L2Rpdj48L2Rpdj4nOwoJLy8JJzxkaXYgaWQ9Im1haW4iPjxkaXYgaWQ9ImR1bW15UGFnZSIgZGF0YS1yb2xlPSJwYWdlIj48L2Rpdj48L2Rpdj4nOwoKCXZhciBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eVN1aXRlID0gewoJCW5hbWU6ICJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eVN1aXRlIGRhcHAganFtVHJhbnNpdGlvblZpc2liaWxpdHk6IHRlc3QgYXBwIHRyYW5zaXRpb25zIiwKCQlzZXR1cDogZnVuY3Rpb24gKCkgewoJCQlkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9IGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5SHRtbENvbnRlbnQzOwoKCQkJLy8gZG9uJ3QgZm9yZ2V0IHRvIHRyaWdnZXIganF1ZXJ5Lm1vYmlsZSBtYW51YWxseQoJCQlpZiAoJC5tb2JpbGUuYXV0b0luaXRpYWxpemVQYWdlID09PSBmYWxzZSkgewoJCQkJJC5tb2JpbGUuaW5pdGlhbGl6ZVBhZ2UoKTsKCQkJfQoKCQkJanFtVHJhbnNpdGlvblZpc2liaWxpdHlOb2RlMyA9ICQoIiNtYWluIik7CgkJfSwKCQkianFtVHJhbnNpdGlvblZpc2liaWxpdHlTdWl0ZSBkYXBwIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5IHRlc3QgaW5pdGlhbCBsYXlvdXQiOiBmdW5jdGlvbiAoKSB7CgkJCXRoaXMudGltZW91dCA9IDIwMDAwOwoKCQkJdmFyIGFwcFN0YXJ0ZWREZWYgPSBuZXcgQXBwbGljYXRpb24oSlNPTi5wYXJzZShzdHJpcENvbW1lbnRzKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5Y29uZmlnKSksCgkJCQlqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUNvbnRhaW5lcjMpOwoJCQlyZXR1cm4gYXBwU3RhcnRlZERlZi50aGVuKGZ1bmN0aW9uIChhcHApIHsKCQkJCS8vIHdlIGFyZSByZWFkeSB0byB0ZXN0CgkJCQl0ZXN0QXBwID0gYXBwOwoKCQkJCS8vdmFyIGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTFYID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEiKTsKCQkJCXZhciBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxID0gJCgiI2pxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEiKTsKCQkJCXZhciBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxQWN0aXZlVGVzdCA9CgkJCQkJJCgiI2pxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEiKS5oYXNDbGFzcygidWktcGFnZS1hY3RpdmUiKTsKCQkJCS8vIGNoZWNrIHRoZSBET00gc3RhdGUgdG8gc2VlIGlmIHdlIGFyZSBpbiB0aGUgZXhwZWN0ZWQgc3RhdGUKCQkJCWFzc2VydC5pc05vdE51bGwoanFtVHJhbnNpdGlvblZpc2liaWxpdHlOb2RlMywgInJvb3QganFtVHJhbnNpdGlvblZpc2liaWxpdHlOb2RlMyBtdXN0IGJlIGhlcmUiKTsKCQkJCWFzc2VydC5pc05vdE51bGwoanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSwgImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEgdmlldyBoZXJlIik7CgkJCQkvL2Fzc2VydC5pc05vdE51bGwoanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMVZpc1Rlc3QsCgkJCQkvLyAianFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSB2aWV3IHNob3VsZCBiZSB2aXNpYmxlIik7CgkJCQkvL3ZhciBuID0ganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMVguc3R5bGUuZGlzcGxheTsKCQkJCWFzc2VydC5pc1RydWUoanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMUFjdGl2ZVRlc3QsCgkJCQkJImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTEgdmlldyBzaG91bGQgYmUgYWN0aXZlIik7CgoJCQl9KTsKCQl9LAoJCSJUZXN0IGRpc3BsYXlWaWV3IChieSB2aWV3IG5hbWUpICI6IGZ1bmN0aW9uICgpIHsKCQkJdGhpcy50aW1lb3V0ID0gMjAwMDA7CgkJCXZhciBkaXNwbGF5RGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTsKCgkJCXRlc3RBcHAuc2hvd09ySGlkZVZpZXdzKCdqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyJywgewoJCQkJZGlzcGxheURlZmVycmVkOiBkaXNwbGF5RGVmZXJyZWQKCQkJfSk7CgkJCXJldHVybiBkaXNwbGF5RGVmZXJyZWQudGhlbihmdW5jdGlvbiAoKSB7CgkJCQl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMiA9ICQoIiNqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyIik7CgkJCQl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMkFjdGl2ZVRlc3QgPQoJCQkJCSQoIiNqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyIikuaGFzQ2xhc3MoInVpLXBhZ2UtYWN0aXZlIik7CgkJCQl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSA9ICQoIiNqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIik7CgkJCQl2YXIganFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMUFjdGl2ZVRlc3QgPQoJCQkJCSQoIiNqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIikuaGFzQ2xhc3MoInVpLXBhZ2UtYWN0aXZlIik7CgkJCQkvLyBjaGVjayB0aGUgRE9NIHN0YXRlIHRvIHNlZSBpZiB3ZSBhcmUgaW4gdGhlIGV4cGVjdGVkIHN0YXRlCgkJCQl2YXIgcE5vZGUgPSBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyWzBdLnBhcmVudE5vZGU7CgkJCQl2YXIgYWN0aXZlTm9kZSA9ICQocE5vZGUpLnBhZ2Vjb250YWluZXIoImdldEFjdGl2ZVBhZ2UiKTsKCQkJCWFzc2VydC5pc05vdE51bGwoanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMiwgImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTIgdmlldyBoZXJlIik7CgkJCQlhc3NlcnQuaXNUcnVlKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTJBY3RpdmVUZXN0LAoJCQkJCSJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIHZpZXcgc2hvdWxkIGJlIGFjdGl2ZSIpOwoJCQkJLy9hc3NlcnQuaXNUcnVlKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTJbMF0uc3R5bGUuZGlzcGxheSAhPT0gIm5vbmUiLAoJCQkJLy8gImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTIgdmlldyBzaG91bGQgYmUgdmlzaWJsZSIpOwoJCQkJYXNzZXJ0LnN0cmljdEVxdWFsKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTJbMF0uaWQsIGFjdGl2ZU5vZGVbMF0uaWQsCgkJCQkJImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTIgc2hvdWxkIGJlIHRoZSBhY3RpdmUgcGFnZSIpOwoJCQkJLy9hc3NlcnQuaXNOb3ROdWxsKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTJWaXNUZXN0LAoJCQkJLy8gImpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTIgdmlldyBzaG91bGQgYmUgdmlzaWJsZSIpOwoJCQkJYXNzZXJ0LmlzTm90TnVsbChqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxLCAianFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSB2aWV3IGhlcmUiKTsKCQkJCWFzc2VydC5pc0ZhbHNlKGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTFBY3RpdmVUZXN0LAoJCQkJCSJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIHZpZXcgc2hvdWxkIG5vdCBiZSBhY3RpdmUiKTsKCQkJCS8vCXZhciBqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyWCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUyIik7CgkJCQkvLwl2YXIgbiA9IGpxbVRyYW5zaXRpb25WaXNpYmlsaXR5QXBwSG9tZTJYLnN0eWxlLmRpc3BsYXk7CgkJCQkvLwl0aGlzIHRlc3QgaXMgZmFpbGluZywgbm90IHN1cmUgd2h5IGl0IGlzIG5vdCBzaG93aW5nIGFzIGRpc3BsYXkgbm9uZS4KCQkJCS8vCWFzc2VydC5pc1RydWUoanFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMVswXS5zdHlsZS5kaXNwbGF5ID09PSAibm9uZSIsCgkJCQkvLyAianFtVHJhbnNpdGlvblZpc2liaWxpdHlBcHBIb21lMSB2aWV3IHNob3VsZCBiZSBoaWRkZW4iKTsKCQkJCS8vYXNzZXJ0LmlzTm90TnVsbChqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxVmlzVGVzdCwKCQkJCS8vICJqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eUFwcEhvbWUxIHZpZXcgc2hvdWxkIGJlIGhpZGRlbiIpOwoJCQl9KTsKCQl9LAoJCXRlYXJkb3duOiBmdW5jdGlvbiAoKSB7CgkJCS8vIGNhbGwgdW5sb2FkQXBwIHRvIGNsZWFudXAgYW5kIGVuZCB0aGUgdGVzdAoJCQl2YXIgbWFpbk5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWFpbiIpOwoJCQltYWluTm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG1haW5Ob2RlKTsKCQkJdGVzdEFwcC51bmxvYWRBcHAoKTsKCQkJLy8gdGhpcyBpcyB0byByZXNldCB0aGUgdXJsIHNvIHRoYXQgYSBicm93c2VyIHJlZnJlc2ggY2FuIHJlcnVuIHRoZSB0ZXN0cwoJCQlsb2NhdGlvbi5oYXNoID0gIj9jb25maWc9dGVzdHMvaW50ZXJuLmJyb3dzZXIiOwoJCQloaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBsb2NhdGlvbi5ocmVmLnJlcGxhY2UoLyMvLCAnJykpOwoJCX0KCX07CgoJcmVnaXN0ZXJTdWl0ZShqcW1UcmFuc2l0aW9uVmlzaWJpbGl0eVN1aXRlKTsKCgkvLyBzdHJpcCBvdXQgc2luZ2xlIGxpbmUgY29tbWVudHMgZnJvbSB0aGUganNvbiBjb25maWcKCWZ1bmN0aW9uIHN0cmlwQ29tbWVudHMoanNvbkRhdGEpIHsKCQlqc29uRGF0YSA9IGpzb25EYXRhLnJlcGxhY2UoL1wvXCouKj9cKlwvL2csICIiKTsKCQlqc29uRGF0YSA9IGpzb25EYXRhLnJlcGxhY2UoL1wvXC8uKi9nLCAiIik7CgkJcmV0dXJuIGpzb25EYXRhOwoJfQoKfSk7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 20:00:33 GMT",
                    "Content-Length": "6112",
                    "Date": "Thu, 06 Nov 2014 20:00:34 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}