{
    "url": "http://localhost:9999/janpaepke/ScrollMagic/docs/jquery.scrollmagic.debug.js.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>window.location.hash</b> and written to <b>$()</b> via the following statement:<ul><li>$(\"dt h4.member-collapsed[id='\" + window.location.hash.substring(1).replace(\":\", \"\\\\:\") +\"']\").trigger(\"click\", skipAni);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/janpaepke/ScrollMagic/docs/jquery.scrollmagic.debug.js.html",
                "path": "/janpaepke/ScrollMagic/docs/jquery.scrollmagic.debug.js.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9qYW5wYWVwa2UvU2Nyb2xsTWFnaWMvZG9jcy9qcXVlcnkuc2Nyb2xsbWFnaWMuZGVidWcuanMuaHRtbCBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTUxNjANCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAwNDowODo1NiBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMDQ6MDg6NTUgR01UDQoNCjwhRE9DVFlQRSBodG1sPgoKPGh0bWwgbGFuZz0iZW4iPgo8aGVhZD4KCTxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KCTx0aXRsZT5TY3JvbGxNYWdpYyBTb3VyY2U6IGpxdWVyeS5zY3JvbGxtYWdpYy5kZWJ1Zy5qczwvdGl0bGU+CgkKICA8c2NyaXB0IHNyYz0ic2NyaXB0cy9wcmV0dGlmeS9wcmV0dGlmeS5qcyI+IDwvc2NyaXB0PgogIDxzY3JpcHQgc3JjPSJzY3JpcHRzL3ByZXR0aWZ5L2xhbmctY3NzLmpzIj4gPC9zY3JpcHQ+Cgk8IS0tW2lmIGx0IElFIDldPgoJPHNjcmlwdCBzcmM9Ii8vaHRtbDVzaGl2Lmdvb2dsZWNvZGUuY29tL3N2bi90cnVuay9odG1sNS5qcyI+PC9zY3JpcHQ+Cgk8IVtlbmRpZl0tLT4KCTxsaW5rIHR5cGU9InRleHQvY3NzIiByZWw9InN0eWxlc2hlZXQiIGhyZWY9InN0eWxlcy9zdW5saWdodC5kZWZhdWx0LmNzcyI+Cgk8bGluayB0eXBlPSJ0ZXh0L2NzcyIgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJzdHlsZXMvcHJldHRpZnktdG9tb3Jyb3cuY3NzIj4KCTxsaW5rIHJlbD0ic2hvcnRjdXQgaWNvbiIgaHJlZj0iLi4vaW1nL2Zhdmljb24uaWNvIiB0eXBlPSJpbWFnZS94LWljb24iPgoKCQoJPGxpbmsgdHlwZT0idGV4dC9jc3MiIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0ic3R5bGVzL3NpdGUuY29zbW8uY3NzIj4KCQo8L2hlYWQ+Cgo8Ym9keT4KPGRpdiBjbGFzcz0iY29udGFpbmVyLWZsdWlkIj4KCTxkaXYgY2xhc3M9Im5hdmJhciBuYXZiYXItZml4ZWQtdG9wIG5hdmJhci1pbnZlcnNlIj4KCQk8ZGl2IGNsYXNzPSJuYXZiYXItaW5uZXIiPgoJCQk8YSBjbGFzcz0iYnJhbmQiIGhyZWY9ImluZGV4Lmh0bWwiPlNjcm9sbE1hZ2ljPC9hPgoJCQk8dWwgY2xhc3M9Im5hdiI+CgkJCQkKCQkJCTxsaSBjbGFzcz0iZHJvcGRvd24iPgoJCQkJCTxhIGhyZWY9ImNsYXNzZXMubGlzdC5odG1sIiBjbGFzcz0iZHJvcGRvd24tdG9nZ2xlIiBkYXRhLXRvZ2dsZT0iZHJvcGRvd24iPkNsYXNzZXM8YgoJCQkJCQljbGFzcz0iY2FyZXQiPjwvYj48L2E+CgoJCQkJCTx1bCBjbGFzcz0iZHJvcGRvd24tbWVudSAiPgoJCQkJCQkKCQkJCQkJPGxpPgoJCQkJCQkJPGEgaHJlZj0iU2Nyb2xsTWFnaWMuaHRtbCI+U2Nyb2xsTWFnaWM8L2E+CgkJCQkJCTwvbGk+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxTY2VuZS5odG1sIj5TY3JvbGxTY2VuZTwvYT4KCQkJCQkJPC9saT4KCQkJCQkJCgoJCQkJCTwvdWw+CgkJCQk8L2xpPgoJCQkJCgkJCQk8bGkgY2xhc3M9ImRyb3Bkb3duIj4KCQkJCQk8YSBocmVmPSJldmVudHMubGlzdC5odG1sIiBjbGFzcz0iZHJvcGRvd24tdG9nZ2xlIiBkYXRhLXRvZ2dsZT0iZHJvcGRvd24iPkV2ZW50czxiCgkJCQkJCWNsYXNzPSJjYXJldCI+PC9iPjwvYT4KCgkJCQkJPHVsIGNsYXNzPSJkcm9wZG93bi1tZW51ICI+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxTY2VuZS5odG1sI2V2ZW50OmNoYW5nZSI+Y2hhbmdlPC9hPgoJCQkJCQk8L2xpPgoJCQkJCQkKCQkJCQkJPGxpPgoJCQkJCQkJPGEgaHJlZj0iU2Nyb2xsU2NlbmUuaHRtbCNldmVudDpkZXN0cm95Ij5kZXN0cm95PC9hPgoJCQkJCQk8L2xpPgoJCQkJCQkKCQkJCQkJPGxpPgoJCQkJCQkJPGEgaHJlZj0iU2Nyb2xsU2NlbmUuaHRtbCNldmVudDplbmQiPmVuZDwvYT4KCQkJCQkJPC9saT4KCQkJCQkJCgkJCQkJCTxsaT4KCQkJCQkJCTxhIGhyZWY9IlNjcm9sbFNjZW5lLmh0bWwjZXZlbnQ6ZW50ZXIiPmVudGVyPC9hPgoJCQkJCQk8L2xpPgoJCQkJCQkKCQkJCQkJPGxpPgoJCQkJCQkJPGEgaHJlZj0iU2Nyb2xsU2NlbmUuaHRtbCNldmVudDpsZWF2ZSI+bGVhdmU8L2E+CgkJCQkJCTwvbGk+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxTY2VuZS5odG1sI2V2ZW50OnByb2dyZXNzIj5wcm9ncmVzczwvYT4KCQkJCQkJPC9saT4KCQkJCQkJCgkJCQkJCTxsaT4KCQkJCQkJCTxhIGhyZWY9IlNjcm9sbFNjZW5lLmh0bWwjZXZlbnQ6c2hpZnQiPnNoaWZ0PC9hPgoJCQkJCQk8L2xpPgoJCQkJCQkKCQkJCQkJPGxpPgoJCQkJCQkJPGEgaHJlZj0iU2Nyb2xsU2NlbmUuaHRtbCNldmVudDpzdGFydCI+c3RhcnQ8L2E+CgkJCQkJCTwvbGk+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxTY2VuZS5odG1sI2V2ZW50OnVwZGF0ZSI+dXBkYXRlPC9hPgoJCQkJCQk8L2xpPgoJCQkJCQkKCgkJCQkJPC91bD4KCQkJCTwvbGk+CgkJCQkKCQkJPC91bD4KCQk8L2Rpdj4KCTwvZGl2PgoKCTxkaXYgY2xhc3M9InJvdy1mbHVpZCI+CgoJCQoJCQk8ZGl2IGNsYXNzPSJzcGFuMTIiPgoJCQkJCgkJCQk8ZGl2IGlkPSJtYWluIj4KCQkJCQkKCgoJCTxoMSBjbGFzcz0icGFnZS10aXRsZSI+U291cmNlOiBqcXVlcnkuc2Nyb2xsbWFnaWMuZGVidWcuanM8L2gxPgogICAgCiAgICA8c2VjdGlvbj4KICAgICAgICA8YXJ0aWNsZT4KICAgICAgICAgICAgPHByZSBjbGFzcz0ic3VubGlnaHQtaGlnaGxpZ2h0LWphdmFzY3JpcHQgbGluZW51bXMiPi8qDQpTY3JvbGxNYWdpYyB2MS4yLjMNClRoZSBqUXVlcnkgcGx1Z2luIGZvciBkb2luZyBtYWdpY2FsIHNjcm9sbCBpbnRlcmFjdGlvbnMuDQooYykgMjAxNCBKYW4gUGFlcGtlIChAamFucGFlcGtlKQ0KTGljZW5zZSAmYW1wOyBJbmZvOiBodHRwOi8vamFucGFlcGtlLmdpdGh1Yi5pby9TY3JvbGxNYWdpYw0KCQ0KSW5zcGlyZWQgYnkgYW5kIHBhcnRpYWxseSBiYXNlZCBvbiBTVVBFUlNDUk9MTE9SQU1BIGJ5IEpvaG4gUG9sYWNlayAoQGpvaG5wb2xhY2VrKQ0KaHR0cDovL2pvaG5wb2xhY2VrLmdpdGh1Yi5jb20vc3VwZXJzY3JvbGxvcmFtYS8NCg0KUG93ZXJlZCBieSB0aGUgR3JlZW5zb2NrIFR3ZWVuaW5nIFBsYXRmb3JtIChHU0FQKTogaHR0cDovL3d3dy5ncmVlbnNvY2suY29tL2pzDQpHcmVlbnNvY2sgTGljZW5zZSBpbmZvIGF0IGh0dHA6Ly93d3cuZ3JlZW5zb2NrLmNvbS9saWNlbnNpbmcvDQoqLwovKg0KCUBvdmVydmlldyBEZWJ1ZyBFeHRlbnNpb24gZm9yIFNjcm9sbE1hZ2ljLg0KCUB2ZXJzaW9uCTEuMi4zDQoJQGxpY2Vuc2UJRHVhbCBsaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZSBhbmQgR1BMLg0KCUBhdXRob3IJCUphbiBQYWVwa2UgLSBlLW1haWxAamFucGFlcGtlLmRlDQoqLw0KKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7DQogICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJmFtcDsmYW1wOyBkZWZpbmUuYW1kKSB7DQogICAgICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS4NCiAgICAgICAgZGVmaW5lKFsnU2Nyb2xsU2NlbmUnLCAnanF1ZXJ5J10sIGZhY3RvcnkpOw0KICAgIH0gZWxzZSB7DQogICAgCQkvLyBubyBicm93c2VyIGdsb2JhbCBuZWVkZWQsIGp1c3QgZXhlY3V0ZQ0KICAgICAgICBmYWN0b3J5KHJvb3QuU2Nyb2xsU2NlbmUsIHJvb3QualF1ZXJ5KTsNCiAgICB9DQp9KHRoaXMsIGZ1bmN0aW9uKFNjcm9sbFNjZW5lLCAkKSB7DQoJLyoqDQoJICogQWRkIEluZGljYXRvcnMgZm9yIGEgU2Nyb2xsU2NlbmUuICANCgkgKiBfX1JFUVVJUkVTX18gU2Nyb2xsTWFnaWMgRGVidWcgRXh0ZW5zaW9uOiBganF1ZXJ5LnNjcm9sbG1hZ2ljLmRlYnVnLmpzYCAgDQoJICogVGhlIGluZGljYXRvcnMgY2FuIG9ubHkgYmUgYWRkZWQgX0FGVEVSXyB0aGUgc2NlbmUgaGFzIGJlZW4gYWRkZWQgdG8gYSBjb250cm9sbGVyLg0KCSAqIEBwdWJsaWMNCg0KCSAqIEBleGFtcGxlDQoJICogLy8gYWRkIGJhc2ljIGluZGljYXRvcnMNCgkgKiBzY2VuZS5hZGRJbmRpY2F0b3JzKCkNCgkgKg0KCSAqIC8vIHBhc3Npbmcgb3B0aW9ucw0KCSAqIHNjZW5lLmFkZEluZGljYXRvcnMoe3ppbmRleDogMTAwLCBjb2xvckVuZDogIiNGRkZGRkYifSk7DQoJICoNCgkgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gQW4gb2JqZWN0IGNvbnRhaW5pbmcgb25lIG9yIG1vcmUgb3B0aW9ucyBmb3IgdGhlIGluZGljYXRvcnMuDQoJICogQHBhcmFtIHsoc3RyaW5nfG9iamVjdCl9IFtvcHRpb25zLnBhcmVudD11bmRlZmluZWRdIC0gQSBzZWxlY3RvciwgRE9NIE9iamVjdCBvciBhIGpRdWVyeSBvYmplY3QgdGhhdCB0aGUgaW5kaWNhdG9ycyBzaG91bGQgYmUgYWRkZWQgdG8uICANCgkgCQkJCQkJCQkJCQkJCQkgSWYgdW5kZWZpbmVkLCB0aGUgc2NlbmUncyBjb250YWluZXIgd2lsbCBiZSB1c2VkLg0KCSAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy56aW5kZXg9LTFdIC0gQ1NTIHppbmRleCBmb3IgdGhlIGluZGljYXRvciBjb250YWluZXIuDQoJICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmluZGVudD0wXSAtIEFkZGl0aW9uYWwgcG9zaXRpb24gb2Zmc2V0IGZvciB0aGUgaW5kaWNhdG9ycyAodXNlZnVsLCB3aGVuIGhhdmluZyBtdWx0aXBsZSBzY2VuZXMgc3RhcnRpbmcgYXQgdGhlIHNhbWUgdGltZSkuDQoJICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnN1ZmZpeD0iIl0gLSBUaGlzIHN0cmluZyB3aWxsIGJlIGF0dGFjaGVkIHRvIHRoZSBzdGFydCBhbmQgZW5kIGluZGljYXRvciAodXNlZnVsIGZvciBpZGVudGlmaWNhdGlvbiB3aGVuIHdvcmtpbmcgd2l0aCBtdWx0aXBsZSBzY2VuZXMpLg0KCSAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5jb2xvclRyaWdnZXI9Ymx1ZV0gLSBDU1MgY29sb3IgZGVmaW5pdGlvbiBmb3IgdGhlIHRyaWdnZXIgaW5kaWNhdG9yLg0KCSAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5jb2xvclN0YXJ0PWdyZWVuXSAtIENTUyBjb2xvciBkZWZpbml0aW9uIGZvciB0aGUgc3RhcnQgaW5kaWNhdG9yLg0KCSAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5jb2xvckVuZD1yZWRdIC0gQ1NTIGNvbG9yIGRlZmluaXRpb24gZm9yIHRoZSBlbmQgaW5kaWNhdG9yLg0KCSovDQoJU2Nyb2xsU2NlbmUucHJvdG90eXBlLmFkZEluZGljYXRvcnMgPSBmdW5jdGlvbihvcHQpIHsNCgkJdmFyDQoJCQlERUZBVUxUX09QVElPTlMgPSB7DQoJCQkJcGFyZW50OiB1bmRlZmluZWQsDQoJCQkJemluZGV4OiAtMSwNCgkJCQlpbmRlbnQ6IDAsDQoJCQkJc3VmZml4OiAiIiwNCgkJCQljb2xvclRyaWdnZXI6ICJibHVlIiwNCgkJCQljb2xvclN0YXJ0OiAiZ3JlZW4iLA0KCQkJCWNvbG9yRW5kOiAicmVkIg0KCQkJfTsNCg0KDQoJCXZhcg0KCQkJc2NlbmUgPSB0aGlzLA0KCQkJb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBERUZBVUxUX09QVElPTlMsIG9wdCksDQoJCQljb250cm9sbGVyID0gdGhpcy5wYXJlbnQoKTsNCgkJaWYgKGNvbnRyb2xsZXIpIHsNCgkJCXZhcg0KCQkJCWNQYXJhbXMgPSBjb250cm9sbGVyLmluZm8oKSwNCgkJCQlzdWZmaXggPSAob3B0aW9ucy5sYWJlbFN1ZmZpeCA9PT0gIiIpID8gIiIgOiAiICIgKyBvcHRpb25zLnN1ZmZpeCwNCgkJCQkkY29udGFpbmVyID0gJChvcHRpb25zLnBhcmVudCkubGVuZ3RoID4gMCA/DQoJCQkJCQkgICQob3B0aW9ucy5wYXJlbnQpDQoJCQkJCQk6IGNQYXJhbXMuaXNEb2N1bWVudCA/ICQoImJvZHkiKSA6IGNQYXJhbXMuY29udGFpbmVyLCAvLyBjaGVjayBpZiB3aW5kb3cgZWxlbWVudCAodGhlbiB1c2UgYm9keSkNCgkJCQkkd3JhcCA9ICQoIiZsdDtkaXY+Jmx0Oy9kaXY+IikNCgkJCQkJCS5hZGRDbGFzcygiU2Nyb2xsU2NlbmVJbmRpY2F0b3JzIikNCgkJCQkJCS5kYXRhKCJvcHRpb25zIiwgb3B0aW9ucykNCgkJCQkJCS5jc3Moew0KCQkJCQkJCXBvc2l0aW9uOiAiYWJzb2x1dGUiLA0KCQkJCQkJCXRvcDogMCwNCgkJCQkJCQlsZWZ0OiAwLA0KCQkJCQkJCXdpZHRoOiAiMTAwJSIsDQoJCQkJCQkJaGVpZ2h0OiAiMTAwJSIsDQoJCQkJCQkJInRleHQtYWxpZ24iOiAiY2VudGVyIiwNCgkJCQkJCQkiei1pbmRleCI6IG9wdGlvbnMuemluZGV4LA0KCQkJCQkJCSJwb2ludGVyLWV2ZW50cyI6ICJub25lIiwNCgkJCQkJCQkiZm9udC1zaXplIjogMTANCgkJCQkJCX0pLA0KCQkJCSR0cmlnZ2VySG9vayA9ICQoIiZsdDtkaXY+dHJpZ2dlciZsdDsvZGl2PiIpDQoJCQkJCQkJCS5jc3Moew0KCQkJCQkJCQkJcG9zaXRpb246ICJmaXhlZCIsDQoJCQkJCQkJCQlvdmVyZmxvdzogInZpc2libGUiLA0KCQkJCQkJCQkJY29sb3I6IG9wdGlvbnMuY29sb3JUcmlnZ2VyDQoJCQkJCQkJCX0pDQoJCQkJCQkJCS5hZGRDbGFzcygiaG9vayIpOw0KCQkJCSRzdGFydCA9ICQoIiZsdDtkaXY+c3RhcnQiICsgc3VmZml4ICsgIiZsdDsvZGl2PiIpDQoJCQkJCQkJCS5jc3Moew0KCQkJCQkJCQkJcG9zaXRpb246ICJhYnNvbHV0ZSIsDQoJCQkJCQkJCQlvdmVyZmxvdzogInZpc2libGUiLA0KCQkJCQkJCQkJY29sb3I6IG9wdGlvbnMuY29sb3JTdGFydA0KCQkJCQkJCQl9KQ0KCQkJCQkJCQkuYWRkQ2xhc3MoInN0YXJ0Iik7DQoJCQkJJGVuZCA9ICQoIiZsdDtkaXY+ZW5kIiArIHN1ZmZpeCArICImbHQ7L2Rpdj4iKQ0KCQkJCQkJCQkuY3NzKHsNCgkJCQkJCQkJCXBvc2l0aW9uOiAiYWJzb2x1dGUiLA0KCQkJCQkJCQkJb3ZlcmZsb3c6ICJ2aXNpYmxlIiwNCgkJCQkJCQkJCWNvbG9yOiBvcHRpb25zLmNvbG9yRW5kDQoJCQkJCQkJCX0pDQoJCQkJCQkJCS5hZGRDbGFzcygiZW5kIik7DQoNCgkJCWlmICgkY29udGFpbmVyLmNzcygicG9zaXRpb24iKSA9PSAic3RhdGljIikgew0KCQkJCSRjb250YWluZXIuY3NzKCJwb3NpdGlvbiIsICJyZWxhdGl2ZSIpOyAvLyBwb3NpdGlvbmluZyBuZWVkZWQgZm9yIGNvcnJlY3QgZGlzcGxheSBvZiBpbmRpY2F0b3JzDQoJCQl9DQoNCgkJCXNjZW5lLmluZGljYXRvcnMgPSAkd3JhcA0KCQkJCSAgICAJCQkuYXBwZW5kKCR0cmlnZ2VySG9vaykNCgkJCQkgICAgCQkJLmFwcGVuZCgkc3RhcnQpDQoJCQkJICAgIAkJCS5hcHBlbmQoJGVuZCkNCgkJCQkgICAgCQkJLmFwcGVuZFRvKCRjb250YWluZXIpOw0KDQoJCQlzY2VuZS51cGRhdGVJbmRpY2F0b3JzKCk7DQoJCQl2YXIgY2FsbFVwZGF0ZSA9IGZ1bmN0aW9uIChlKSB7DQoJCQkJaWYgKChlLnR5cGUgPT0gInNjcm9sbCIgfHwgZS50eXBlID09ICJyZXNpemUiKSAmYW1wOyZhbXA7ICFjUGFyYW1zLmlzRG9jdW1lbnQpIHsNCgkJCQkJc2NlbmUudXBkYXRlSW5kaWNhdG9ycyh0cnVlKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQlzY2VuZS51cGRhdGVJbmRpY2F0b3JzKCk7DQoJCQkJfQ0KCQkJfTsNCgkJCXNjZW5lLm9uKCJjaGFuZ2UuZGVidWciLCBjYWxsVXBkYXRlKTsNCgkJCWNQYXJhbXMuY29udGFpbmVyLm9uKCJyZXNpemUgc2Nyb2xsIiwgY2FsbFVwZGF0ZSk7DQoJCQlpZiAoIWNQYXJhbXMuaXNEb2N1bWVudCkgew0KCQkJCSQod2luZG93KS5vbigic2Nyb2xsIHJlc2l6ZSIsIGNhbGxVcGRhdGUpOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJY29uc29sZS5sb2coIkVSUk9SOiBQbGVhc2UgYWRkIFNjZW5lIHRvIGNvbnRyb2xsZXIgYmVmb3JlIGFkZGluZyBpbmRpY2F0b3JzLiIpOw0KCQl9DQoJCXJldHVybiBzY2VuZTsNCgl9Ow0KCVNjcm9sbFNjZW5lLnByb3RvdHlwZS51cGRhdGVJbmRpY2F0b3JzID0gZnVuY3Rpb24odHJpZ2dlck9ubHkpIHsNCgkJdmFyDQoJCQlzY2VuZSA9IHRoaXMsDQoJCQljb250cm9sbGVyID0gc2NlbmUucGFyZW50KCksDQoJCQlpbmRpY2F0b3JzID0gc2NlbmUuaW5kaWNhdG9ycywNCgkJCW9wdGlvbnMgPSBpbmRpY2F0b3JzLmRhdGEoIm9wdGlvbnMiKTsNCgkJaWYgKGluZGljYXRvcnMgJmFtcDsmYW1wOyBjb250cm9sbGVyKSB7DQoJCQl2YXINCgkJCQljUGFyYW1zID0gY29udHJvbGxlci5pbmZvKCksDQoJCQkJJHRyaWdnZXJIb29rID0gaW5kaWNhdG9ycy5jaGlsZHJlbigiLmhvb2siKSwNCgkJCQkkc3RhcnQgPSBpbmRpY2F0b3JzLmNoaWxkcmVuKCIuc3RhcnQiKSwNCgkJCQkkZW5kID0gaW5kaWNhdG9ycy5jaGlsZHJlbigiLmVuZCIpLA0KCQkJCXBhcmVudE9mZnNldCA9IGNQYXJhbXMuY29udGFpbmVyLm9mZnNldCgpIHx8IHt0b3A6IDAsIGxlZnQ6IDB9LA0KCQkJCXBhcmVudFBvcyA9IGNQYXJhbXMudmVydGljYWwgPyBwYXJlbnRPZmZzZXQudG9wIDogcGFyZW50T2Zmc2V0LmxlZnQsDQoJCQkJaG9va1BvcyA9IChjUGFyYW1zLnNpemUgKiBzY2VuZS50cmlnZ2VySG9vaygpKSArIHBhcmVudFBvcywNCgkJCQlkaXJlY3Rpb24gPSBjUGFyYW1zLnZlcnRpY2FsID8gInYiIDogImgiOw0KDQoJCQlpZiAoY1BhcmFtcy5pc0RvY3VtZW50KSB7IC8vIGFjY291bnQgZm9yIHBvc3NpYmxlIGJvZHkgcG9zaXRpb25pbmcNCgkJCQl2YXIgYm9keU9mZnNldCA9IGluZGljYXRvcnMub2Zmc2V0UGFyZW50KCkuaXMoImJvZHkiKSA/ICQoImJvZHkiKS5vZmZzZXQoKSA6IHBhcmVudE9mZnNldDsNCgkJCQlpbmRpY2F0b3JzLmNzcyh7DQoJCQkJCXRvcDogLWJvZHlPZmZzZXQudG9wLA0KCQkJCQlsZWZ0OiAtYm9keU9mZnNldC5sZWZ0DQoJCQkJfSk7DQoJCQl9IGVsc2Ugew0KCQkJCWhvb2tQb3MgLT0gIGNQYXJhbXMudmVydGljYWwgPyAkKGRvY3VtZW50KS5zY3JvbGxUb3AoKSA6ICQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKTsNCgkJCX0NCg0KCQkJJHRyaWdnZXJIb29rDQoJCQkJLmF0dHIoImRhdGEtaG9vayIsIGhvb2tQb3MpDQoJCQkJLmF0dHIoImRhdGEtZGlyZWN0aW9uIiwgZGlyZWN0aW9uKQ0KCQkJCS5kYXRhKCJwYXJlbnQiLCBjUGFyYW1zLmNvbnRhaW5lcik7DQoNCgkJCSRvdGhlcmhvb2sgPSAkKCIuU2Nyb2xsU2NlbmVJbmRpY2F0b3JzIC5ob29rW2RhdGEtaG9vaz1cIiIrIGhvb2tQb3MgKyJcIl1bZGF0YS1kaXJlY3Rpb249IitkaXJlY3Rpb24rIl06dmlzaWJsZSIpLm5vdCgkdHJpZ2dlckhvb2spOw0KCQkJaWYgKCRvdGhlcmhvb2subGVuZ3RoID4gMCAmYW1wOyZhbXA7ICRvdGhlcmhvb2suZGF0YSgicGFyZW50IikgPT0gY1BhcmFtcy5jb250YWluZXIpIHsNCgkJCQkkdHJpZ2dlckhvb2suaGlkZSgpOw0KCQkJfSBlbHNlIHsNCgkJCQkkdHJpZ2dlckhvb2suc2hvdygpOw0KCQkJCXZhciBmbGlwID0gaG9va1BvcyA+IGNQYXJhbXMuc2l6ZSowLjg7IC8vIHB1dCBuYW1lIGFib3ZlIGxpbmU/CQ0KCQkJCWlmIChjUGFyYW1zLnZlcnRpY2FsKSB7DQoJCQkJCS8vIHRyaWdnZXJIb29rDQoJCQkJCSR0cmlnZ2VySG9vay5jc3Moew0KCQkJCQkJdG9wOiBmbGlwID8gaG9va1BvcyAtICR0cmlnZ2VySG9vay5oZWlnaHQoKSAtIDIgOiBob29rUG9zLA0KCQkJCQkJbGVmdDogKGNQYXJhbXMuaXNEb2N1bWVudCA/IGNQYXJhbXMuY29udGFpbmVyLndpZHRoKCkgOiBwYXJlbnRPZmZzZXQubGVmdCArIGNQYXJhbXMuY29udGFpbmVyLndpZHRoKCkgLSAkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkpIC0gNzAgLSBvcHRpb25zLmluZGVudCwNCgkJCQkJCXdpZHRoOiA0MCwNCgkJCQkJCWhlaWdodDogImF1dG8iLA0KCQkJCQkJcGFkZGluZzogIjAgOHB4IDJweCA4cHgiLA0KCQkJCQkJImJvcmRlci10b3AiOiBmbGlwID8gIm5vbmUiIDogIjFweCBzb2xpZCBibHVlIiwNCgkJCQkJCSJib3JkZXItYm90dG9tIjogZmxpcCA/ICIxcHggc29saWQgYmx1ZSIgOiAibm9uZSIsDQoJCQkJCQkiYm9yZGVyLWxlZnQiOiAibm9uZSIsDQoJCQkJCQkiYm9yZGVyLXJpZ2h0IjogIm5vbmUiDQoJCQkJCX0pOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSR0cmlnZ2VySG9vay5jc3Moew0KCQkJCQkJdG9wOiAoY1BhcmFtcy5pc0RvY3VtZW50ID8gY1BhcmFtcy5jb250YWluZXIuaGVpZ2h0KCkgOiBwYXJlbnRPZmZzZXQudG9wICsgY1BhcmFtcy5jb250YWluZXIuaGVpZ2h0KCkgLSAkKGRvY3VtZW50KS5zY3JvbGxUb3AoKSkgLSA0MCAtIG9wdGlvbnMuaW5kZW50LA0KCQkJCQkJbGVmdDogZmxpcCA/IGhvb2tQb3MgLSAkdHJpZ2dlckhvb2sud2lkdGgoKSAtIDk6IGhvb2tQb3MsDQoJCQkJCQl3aWR0aDogImF1dG8iLA0KCQkJCQkJaGVpZ2h0OiAyMCwNCgkJCQkJCXBhZGRpbmc6ICI1cHggNXB4IDAgNXB4IiwNCgkJCQkJCSJib3JkZXItdG9wIjogIm5vbmUiLA0KCQkJCQkJImJvcmRlci1ib3R0b20iOiAibm9uZSIsDQoJCQkJCQkiYm9yZGVyLWxlZnQiOiBmbGlwID8gIm5vbmUiIDogIjFweCBzb2xpZCBibHVlIiwNCgkJCQkJCSJib3JkZXItcmlnaHQiOiBmbGlwID8gIjFweCBzb2xpZCBibHVlIiA6ICJub25lIg0KCQkJCQl9KTsNCgkJCQl9DQoJCQl9DQoJCQkNCgkJCWlmICghdHJpZ2dlck9ubHkpIHsNCgkJCQl2YXINCgkJCQkJc3RhcnRQb3MgPSBzY2VuZS50cmlnZ2VyUG9zaXRpb24oKSwNCgkJCQkJZW5kUG9zID0gc3RhcnRQb3MgKyBzY2VuZS5kdXJhdGlvbigpLA0KCQkJCQlyZXNldENTUyA9IHsNCgkJCQkJCSJib3JkZXIiOiAibm9uZSIsDQoJCQkJCQl0b3A6ICJhdXRvIiwNCgkJCQkJCWJvdHRvbTogImF1dG8iLA0KCQkJCQkJbGVmdDogImF1dG8iLA0KCQkJCQkJcmlnaHQ6ICJhdXRvIg0KCQkJCQl9Ow0KCQkJCQ0KCQkJCSRzdGFydC5jc3MocmVzZXRDU1MpOw0KCQkJCSRlbmQuY3NzKHJlc2V0Q1NTKTsNCg0KCQkJCWlmIChzY2VuZS5kdXJhdGlvbigpID09PSAwKSB7DQoJCQkJCSRlbmQuaGlkZSgpOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSRlbmQuc2hvdygpOw0KCQkJCX0NCgkJCQlpZiAoY1BhcmFtcy52ZXJ0aWNhbCkgew0KCQkJCQkvLyBzdGFydA0KCQkJCQkkc3RhcnQuY3NzKHsNCgkJCQkJCXRvcDogc3RhcnRQb3MsDQoJCQkJCQlyaWdodDogNzEtY1BhcmFtcy5jb250YWluZXIuc2Nyb2xsTGVmdCgpICsgb3B0aW9ucy5pbmRlbnQsDQoJCQkJCQkiYm9yZGVyLXRvcCI6ICIxcHggc29saWQgZ3JlZW4iLA0KCQkJCQkJcGFkZGluZzogIjAgOHB4IDAgOHB4Ig0KCQkJCQl9KTsNCgkJCQkJLy8gZW5kDQoJCQkJCSRlbmQuY3NzKHsNCgkJCQkJCXRvcDogZW5kUG9zLA0KCQkJCQkJcmlnaHQ6IDcxLWNQYXJhbXMuY29udGFpbmVyLnNjcm9sbExlZnQoKSArIG9wdGlvbnMuaW5kZW50LA0KCQkJCQkJImJvcmRlci10b3AiOiAiMXB4IHNvbGlkIHJlZCIsDQoJCQkJCQlwYWRkaW5nOiAiMCA4cHggMCA4cHgiDQoJCQkJCX0pOw0KCQkJCX0gZWxzZSB7DQoJCQkJCS8vIHN0YXJ0DQoJCQkJCSRzdGFydC5jc3Moew0KCQkJCQkJbGVmdDogc3RhcnRQb3MsDQoJCQkJCQlib3R0b206IDQwLWNQYXJhbXMuY29udGFpbmVyLnNjcm9sbFRvcCgpICsgb3B0aW9ucy5pbmRlbnQsDQoJCQkJCQkiYm9yZGVyLWxlZnQiOiAiMXB4IHNvbGlkIGdyZWVuIiwNCgkJCQkJCXBhZGRpbmc6ICIwIDhweCAwIDhweCINCgkJCQkJfSk7DQoJCQkJCS8vIGVuZA0KCQkJCQkkZW5kLmNzcyh7DQoJCQkJCQlsZWZ0OiBlbmRQb3MsDQoJCQkJCQlib3R0b206IDQwLWNQYXJhbXMuY29udGFpbmVyLnNjcm9sbFRvcCgpICsgb3B0aW9ucy5pbmRlbnQsDQoJCQkJCQkiYm9yZGVyLWxlZnQiOiAiMXB4IHNvbGlkIHJlZCIsDQoJCQkJCQlwYWRkaW5nOiAiMCA4cHggMCA4cHgiDQoJCQkJCX0pOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCX07DQp9KSk7PC9wcmU+CiAgICAgICAgPC9hcnRpY2xlPgogICAgPC9zZWN0aW9uPgoKCgoKCgkJCQk8L2Rpdj4KCgkJCQk8ZGl2IGNsYXNzPSJjbGVhcmZpeCI+PC9kaXY+CgkJCQk8Zm9vdGVyPgoJCQkJCQoJCQkJCQoJCTxzcGFuIGNsYXNzPSJjb3B5cmlnaHQiPgoJCcKpIEphbiBQYWVwa2UgMjAxNAoJCTwvc3Bhbj4KCQkJCQk8YnIgLz4KCQkJCQkKCQk8c3BhbiBjbGFzcz0ianNkb2MtbWVzc2FnZSI+CgkJRG9jdW1lbnRhdGlvbiBnZW5lcmF0ZWQgYnkgPGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL2pzZG9jMy9qc2RvYyIgdGFyZ2V0PSJfYmxhbmsiPkpTRG9jIDMuMy4wLWFscGhhOTwvYT4KCQl1c2luZyBhIGN1c3RvbWl6ZWQgdmVyc2lvbiBvZiB0aGUgPGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL3RlcnJ5d2Vpc3MvZG9jc3RyYXAiIHRhcmdldD0iX2JsYW5rIj5Eb2NTdHJhcCB0ZW1wbGF0ZTwvYT4uCgkJPC9zcGFuPgoJCQkJPC9mb290ZXI+CgkJCTwvZGl2PgoKCQkJCgkJCTxiciBjbGVhcj0iYm90aCI+CgkJPC9kaXY+CgoJPC9kaXY+Cgk8c2NyaXB0IHNyYz0ic2NyaXB0cy9zdW5saWdodC5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHNyYz0ic2NyaXB0cy9zdW5saWdodC5qYXZhc2NyaXB0LmpzIj48L3NjcmlwdD4KCTxzY3JpcHQgc3JjPSJzY3JpcHRzL3N1bmxpZ2h0LXBsdWdpbi5kb2NsaW5rcy5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHNyYz0ic2NyaXB0cy9zdW5saWdodC1wbHVnaW4ubGluZW51bWJlcnMuanMiPjwvc2NyaXB0PgoJPHNjcmlwdCBzcmM9InNjcmlwdHMvc3VubGlnaHQtcGx1Z2luLm1lbnUuanMiPjwvc2NyaXB0PgoJPHNjcmlwdCBzcmM9InNjcmlwdHMvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHNyYz0ic2NyaXB0cy9qcXVlcnkuc2Nyb2xsVG8uanMiPjwvc2NyaXB0PgoJPHNjcmlwdCBzcmM9InNjcmlwdHMvanF1ZXJ5LmxvY2FsU2Nyb2xsLmpzIj48L3NjcmlwdD4KCTxzY3JpcHQgc3JjPSJzY3JpcHRzL2Jvb3RzdHJhcC1kcm9wZG93bi5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHNyYz0ic2NyaXB0cy90b2MuanMiPjwvc2NyaXB0PgoKCTxzY3JpcHQ+IHByZXR0eVByaW50KCk7IDwvc2NyaXB0PgoJPHNjcmlwdD4gIFN1bmxpZ2h0LmhpZ2hsaWdodEFsbCh7bGluZU51bWJlcnM6dHJ1ZSwgIHNob3dNZW51OiB0cnVlLCBlbmFibGVEb2NsaW5rcyA6dHJ1ZX0pOyA8L3NjcmlwdD4KCgk8c2NyaXB0PgoJCWZ1bmN0aW9uIG9wZW5EZWVwbGlua2VkRWxlbWVudCAoc2tpcEFuaSkgewoJCQkkKCJkdCBoNC5tZW1iZXItY29sbGFwc2VkW2lkPSciICsgd2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLnJlcGxhY2UoIjoiLCAiXFw6IikgKyInXSIpLnRyaWdnZXIoImNsaWNrIiwgc2tpcEFuaSk7CgkJfQoJCSQoIGZ1bmN0aW9uICgpIHsKCQkJJCggIiN0b2MiICkudG9jKCB7CgkJCSAgICBhbmNob3JOYW1lICA6IGZ1bmN0aW9uKGksIGhlYWRpbmcsIHByZWZpeCkgewoJCQkJCXJldHVybiAkKGhlYWRpbmcpLmF0dHIoImlkIikgfHwgKCBwcmVmaXggKyBpICk7CgkJCQl9LAoJCQkJc2VsZWN0b3JzICAgOiAiaDE6dmlzaWJsZSxoMjp2aXNpYmxlLGgzOnZpc2libGUsaDQ6dmlzaWJsZSIsCgkJCQlvblNjcm9sbEZpbmlzaCA6IG9wZW5EZWVwbGlua2VkRWxlbWVudCwKCQkJCWhpZ2hsaWdodE9mZnNldCA6IDEwLAoJCQkJc2Nyb2xsT2Zmc2V0OiA2MAoJCQl9ICk7CgkJCSQoICIjdG9jPnVsIiApLmFkZENsYXNzKCAibmF2IG5hdi1waWxscyBuYXYtc3RhY2tlZCIgKTsKCQkJJCggIiNtYWluIHNwYW5baWRePSd0b2MnXSIgKS5hZGRDbGFzcyggInRvYy1zaGltIiApOwoKCQl9ICk7Cgk8L3NjcmlwdD4KCgkKCTxzY3JpcHQ+CgkJJCggZnVuY3Rpb24gKCkgewoJCQkvLyAkKCcjbWFpbicpLmxvY2FsU2Nyb2xsKHsKCQkJLy8gCW9mZnNldDogeyB0b3A6IDU2IH0gLy9vZmZzZXQgYnkgdGhlIGhlaWdodCBvZiB5b3VyIGhlYWRlciAoZ2l2ZSBvciB0YWtlIGEgZmV3IHB4LCBzZWUgd2hhdCB3b3JrcyBmb3IgeW91KQoJCQkvLyB9KTsKCQkJLy8gd29ya2Fyb3VuZCBmb3IgYW5jaG9ycyBiZWxvdyBoZWFkZXIuLi4KCQkJd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewoJCQkJJChkb2N1bWVudCkuc2Nyb2xsVG9wKCQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpLTYwKTsKCQkJfSwgMSkKCQkJCgkJCXZhciBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLnJlcGxhY2UoIjoiLCAiXFw6Iik7CgkJCSQoICJkdCBoNC5uYW1lIiApLmVhY2goIGZ1bmN0aW9uICgpIHsKCQkJCXZhciAkdGhpcyA9ICQoIHRoaXMgKTsKCQkJCXZhciBpY29uID0gJCggIjxpLz4iICkuYWRkQ2xhc3MoICJpY29uLXBsdXMtc2lnbiIgKS5hZGRDbGFzcyggInB1bGwtcmlnaHQiICkuYWRkQ2xhc3MoICJpY29uLXdoaXRlIiApOwoJCQkJdmFyIGR0ID0gJHRoaXMucGFyZW50cyggImR0IiApOwoJCQkJdmFyIGNoaWxkcmVuID0gZHQubmV4dCggImRkIiApOwoKCQkJCSR0aGlzLmFwcGVuZCggaWNvbiApLmNzcygge2N1cnNvciA6ICJwb2ludGVyIn0gKTsKCQkJCSR0aGlzLmFkZENsYXNzKCAibWVtYmVyLWNvbGxhcHNlZCIgKS5hZGRDbGFzcyggIm1lbWJlciIgKTsKCQkJCWlmIChoYXNoICE9ICR0aGlzLmF0dHIoImlkIikpIHsKCQkJCQljaGlsZHJlbi5oaWRlKCk7CgkJCQl9CgkJCQkkdGhpcy50b2dnbGUoIGZ1bmN0aW9uIChlLCBza2lwQW5pKSB7CgkJCQkJdmFyIHNjcm9sbFBvcyA9ICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpOwoJCQkJCXdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJCh0aGlzKS5hdHRyKCJpZCIpOwoJCQkJCSQoZG9jdW1lbnQpLnNjcm9sbFRvcChzY3JvbGxQb3MpOwoJCQkJCWljb24uYWRkQ2xhc3MoICJpY29uLW1pbnVzLXNpZ24iICkucmVtb3ZlQ2xhc3MoICJpY29uLXBsdXMtc2lnbiIgKS5yZW1vdmVDbGFzcyggImljb24td2hpdGUiICk7CgkJCQkJJHRoaXMuYWRkQ2xhc3MoICJtZW1iZXItb3BlbiIgKS5yZW1vdmVDbGFzcyggIm1lbWJlci1jb2xsYXBzZWQiICk7CgkJCQkJY2hpbGRyZW4uc2xpZGVEb3duKHNraXBBbmkgPyAwIDogdW5kZWZpbmVkKTsKCQkJCX0sIGZ1bmN0aW9uICgpIHsKCQkJCQlpY29uLmFkZENsYXNzKCAiaWNvbi1wbHVzLXNpZ24iICkucmVtb3ZlQ2xhc3MoICJpY29uLW1pbnVzLXNpZ24iICkuYWRkQ2xhc3MoICJpY29uLXdoaXRlIiApOwoJCQkJCSR0aGlzLmFkZENsYXNzKCAibWVtYmVyLWNvbGxhcHNlZCIgKS5yZW1vdmVDbGFzcyggIm1lbWJlci1vcGVuIiApOwoJCQkJCWNoaWxkcmVuLnNsaWRlVXAoKTsKCQkJCX0gKTsKCQkJfSApOwoJCQkvLyBvcGVuIGlmIGRlZXBsaW5rZWQKCQkJaWYgKGhhc2gubGVuZ3RoID4gMCkKCQkJCW9wZW5EZWVwbGlua2VkRWxlbWVudCh0cnVlKTsKCQl9ICk7Cgk8L3NjcmlwdD4KCQoKCTxzY3JpcHQ+CgkJKGZ1bmN0aW9uKGkscyxvLGcscixhLG0pe2lbJ0dvb2dsZUFuYWx5dGljc09iamVjdCddPXI7aVtyXT1pW3JdfHxmdW5jdGlvbigpewoJCShpW3JdLnE9aVtyXS5xfHxbXSkucHVzaChhcmd1bWVudHMpfSxpW3JdLmw9MSpuZXcgRGF0ZSgpO2E9cy5jcmVhdGVFbGVtZW50KG8pLAoJCW09cy5nZXRFbGVtZW50c0J5VGFnTmFtZShvKVswXTthLmFzeW5jPTE7YS5zcmM9ZzttLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsbSkKCQl9KSh3aW5kb3csZG9jdW1lbnQsJ3NjcmlwdCcsJy8vd3d3Lmdvb2dsZS1hbmFseXRpY3MuY29tL2FuYWx5dGljcy5qcycsJ2dhJyk7CgkJZ2EoJ2NyZWF0ZScsICdVQS0zNzUyNDM0NC0zJywgJ2phbnBhZXBrZS5naXRodWIuaW8nKTsKCQlnYSgnc2VuZCcsICdwYWdldmlldycpOwoJPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=",
                "body": "PCFET0NUWVBFIGh0bWw+Cgo8aHRtbCBsYW5nPSJlbiI+CjxoZWFkPgoJPG1ldGEgY2hhcnNldD0idXRmLTgiPgoJPHRpdGxlPlNjcm9sbE1hZ2ljIFNvdXJjZToganF1ZXJ5LnNjcm9sbG1hZ2ljLmRlYnVnLmpzPC90aXRsZT4KCQogIDxzY3JpcHQgc3JjPSJzY3JpcHRzL3ByZXR0aWZ5L3ByZXR0aWZ5LmpzIj4gPC9zY3JpcHQ+CiAgPHNjcmlwdCBzcmM9InNjcmlwdHMvcHJldHRpZnkvbGFuZy1jc3MuanMiPiA8L3NjcmlwdD4KCTwhLS1baWYgbHQgSUUgOV0+Cgk8c2NyaXB0IHNyYz0iLy9odG1sNXNoaXYuZ29vZ2xlY29kZS5jb20vc3ZuL3RydW5rL2h0bWw1LmpzIj48L3NjcmlwdD4KCTwhW2VuZGlmXS0tPgoJPGxpbmsgdHlwZT0idGV4dC9jc3MiIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0ic3R5bGVzL3N1bmxpZ2h0LmRlZmF1bHQuY3NzIj4KCTxsaW5rIHR5cGU9InRleHQvY3NzIiByZWw9InN0eWxlc2hlZXQiIGhyZWY9InN0eWxlcy9wcmV0dGlmeS10b21vcnJvdy5jc3MiPgoJPGxpbmsgcmVsPSJzaG9ydGN1dCBpY29uIiBocmVmPSIuLi9pbWcvZmF2aWNvbi5pY28iIHR5cGU9ImltYWdlL3gtaWNvbiI+CgoJCgk8bGluayB0eXBlPSJ0ZXh0L2NzcyIgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJzdHlsZXMvc2l0ZS5jb3Ntby5jc3MiPgoJCjwvaGVhZD4KCjxib2R5Pgo8ZGl2IGNsYXNzPSJjb250YWluZXItZmx1aWQiPgoJPGRpdiBjbGFzcz0ibmF2YmFyIG5hdmJhci1maXhlZC10b3AgbmF2YmFyLWludmVyc2UiPgoJCTxkaXYgY2xhc3M9Im5hdmJhci1pbm5lciI+CgkJCTxhIGNsYXNzPSJicmFuZCIgaHJlZj0iaW5kZXguaHRtbCI+U2Nyb2xsTWFnaWM8L2E+CgkJCTx1bCBjbGFzcz0ibmF2Ij4KCQkJCQoJCQkJPGxpIGNsYXNzPSJkcm9wZG93biI+CgkJCQkJPGEgaHJlZj0iY2xhc3Nlcy5saXN0Lmh0bWwiIGNsYXNzPSJkcm9wZG93bi10b2dnbGUiIGRhdGEtdG9nZ2xlPSJkcm9wZG93biI+Q2xhc3NlczxiCgkJCQkJCWNsYXNzPSJjYXJldCI+PC9iPjwvYT4KCgkJCQkJPHVsIGNsYXNzPSJkcm9wZG93bi1tZW51ICI+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxNYWdpYy5odG1sIj5TY3JvbGxNYWdpYzwvYT4KCQkJCQkJPC9saT4KCQkJCQkJCgkJCQkJCTxsaT4KCQkJCQkJCTxhIGhyZWY9IlNjcm9sbFNjZW5lLmh0bWwiPlNjcm9sbFNjZW5lPC9hPgoJCQkJCQk8L2xpPgoJCQkJCQkKCgkJCQkJPC91bD4KCQkJCTwvbGk+CgkJCQkKCQkJCTxsaSBjbGFzcz0iZHJvcGRvd24iPgoJCQkJCTxhIGhyZWY9ImV2ZW50cy5saXN0Lmh0bWwiIGNsYXNzPSJkcm9wZG93bi10b2dnbGUiIGRhdGEtdG9nZ2xlPSJkcm9wZG93biI+RXZlbnRzPGIKCQkJCQkJY2xhc3M9ImNhcmV0Ij48L2I+PC9hPgoKCQkJCQk8dWwgY2xhc3M9ImRyb3Bkb3duLW1lbnUgIj4KCQkJCQkJCgkJCQkJCTxsaT4KCQkJCQkJCTxhIGhyZWY9IlNjcm9sbFNjZW5lLmh0bWwjZXZlbnQ6Y2hhbmdlIj5jaGFuZ2U8L2E+CgkJCQkJCTwvbGk+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxTY2VuZS5odG1sI2V2ZW50OmRlc3Ryb3kiPmRlc3Ryb3k8L2E+CgkJCQkJCTwvbGk+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxTY2VuZS5odG1sI2V2ZW50OmVuZCI+ZW5kPC9hPgoJCQkJCQk8L2xpPgoJCQkJCQkKCQkJCQkJPGxpPgoJCQkJCQkJPGEgaHJlZj0iU2Nyb2xsU2NlbmUuaHRtbCNldmVudDplbnRlciI+ZW50ZXI8L2E+CgkJCQkJCTwvbGk+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxTY2VuZS5odG1sI2V2ZW50OmxlYXZlIj5sZWF2ZTwvYT4KCQkJCQkJPC9saT4KCQkJCQkJCgkJCQkJCTxsaT4KCQkJCQkJCTxhIGhyZWY9IlNjcm9sbFNjZW5lLmh0bWwjZXZlbnQ6cHJvZ3Jlc3MiPnByb2dyZXNzPC9hPgoJCQkJCQk8L2xpPgoJCQkJCQkKCQkJCQkJPGxpPgoJCQkJCQkJPGEgaHJlZj0iU2Nyb2xsU2NlbmUuaHRtbCNldmVudDpzaGlmdCI+c2hpZnQ8L2E+CgkJCQkJCTwvbGk+CgkJCQkJCQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSJTY3JvbGxTY2VuZS5odG1sI2V2ZW50OnN0YXJ0Ij5zdGFydDwvYT4KCQkJCQkJPC9saT4KCQkJCQkJCgkJCQkJCTxsaT4KCQkJCQkJCTxhIGhyZWY9IlNjcm9sbFNjZW5lLmh0bWwjZXZlbnQ6dXBkYXRlIj51cGRhdGU8L2E+CgkJCQkJCTwvbGk+CgkJCQkJCQoKCQkJCQk8L3VsPgoJCQkJPC9saT4KCQkJCQoJCQk8L3VsPgoJCTwvZGl2PgoJPC9kaXY+CgoJPGRpdiBjbGFzcz0icm93LWZsdWlkIj4KCgkJCgkJCTxkaXYgY2xhc3M9InNwYW4xMiI+CgkJCQkKCQkJCTxkaXYgaWQ9Im1haW4iPgoJCQkJCQoKCgkJPGgxIGNsYXNzPSJwYWdlLXRpdGxlIj5Tb3VyY2U6IGpxdWVyeS5zY3JvbGxtYWdpYy5kZWJ1Zy5qczwvaDE+CiAgICAKICAgIDxzZWN0aW9uPgogICAgICAgIDxhcnRpY2xlPgogICAgICAgICAgICA8cHJlIGNsYXNzPSJzdW5saWdodC1oaWdobGlnaHQtamF2YXNjcmlwdCBsaW5lbnVtcyI+LyoNClNjcm9sbE1hZ2ljIHYxLjIuMw0KVGhlIGpRdWVyeSBwbHVnaW4gZm9yIGRvaW5nIG1hZ2ljYWwgc2Nyb2xsIGludGVyYWN0aW9ucy4NCihjKSAyMDE0IEphbiBQYWVwa2UgKEBqYW5wYWVwa2UpDQpMaWNlbnNlICZhbXA7IEluZm86IGh0dHA6Ly9qYW5wYWVwa2UuZ2l0aHViLmlvL1Njcm9sbE1hZ2ljDQoJDQpJbnNwaXJlZCBieSBhbmQgcGFydGlhbGx5IGJhc2VkIG9uIFNVUEVSU0NST0xMT1JBTUEgYnkgSm9obiBQb2xhY2VrIChAam9obnBvbGFjZWspDQpodHRwOi8vam9obnBvbGFjZWsuZ2l0aHViLmNvbS9zdXBlcnNjcm9sbG9yYW1hLw0KDQpQb3dlcmVkIGJ5IHRoZSBHcmVlbnNvY2sgVHdlZW5pbmcgUGxhdGZvcm0gKEdTQVApOiBodHRwOi8vd3d3LmdyZWVuc29jay5jb20vanMNCkdyZWVuc29jayBMaWNlbnNlIGluZm8gYXQgaHR0cDovL3d3dy5ncmVlbnNvY2suY29tL2xpY2Vuc2luZy8NCiovCi8qDQoJQG92ZXJ2aWV3IERlYnVnIEV4dGVuc2lvbiBmb3IgU2Nyb2xsTWFnaWMuDQoJQHZlcnNpb24JMS4yLjMNCglAbGljZW5zZQlEdWFsIGxpY2Vuc2VkIHVuZGVyIE1JVCBsaWNlbnNlIGFuZCBHUEwuDQoJQGF1dGhvcgkJSmFuIFBhZXBrZSAtIGUtbWFpbEBqYW5wYWVwa2UuZGUNCiovDQooZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHsNCiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmYW1wOyZhbXA7IGRlZmluZS5hbWQpIHsNCiAgICAgICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLg0KICAgICAgICBkZWZpbmUoWydTY3JvbGxTY2VuZScsICdqcXVlcnknXSwgZmFjdG9yeSk7DQogICAgfSBlbHNlIHsNCiAgICAJCS8vIG5vIGJyb3dzZXIgZ2xvYmFsIG5lZWRlZCwganVzdCBleGVjdXRlDQogICAgICAgIGZhY3Rvcnkocm9vdC5TY3JvbGxTY2VuZSwgcm9vdC5qUXVlcnkpOw0KICAgIH0NCn0odGhpcywgZnVuY3Rpb24oU2Nyb2xsU2NlbmUsICQpIHsNCgkvKioNCgkgKiBBZGQgSW5kaWNhdG9ycyBmb3IgYSBTY3JvbGxTY2VuZS4gIA0KCSAqIF9fUkVRVUlSRVNfXyBTY3JvbGxNYWdpYyBEZWJ1ZyBFeHRlbnNpb246IGBqcXVlcnkuc2Nyb2xsbWFnaWMuZGVidWcuanNgICANCgkgKiBUaGUgaW5kaWNhdG9ycyBjYW4gb25seSBiZSBhZGRlZCBfQUZURVJfIHRoZSBzY2VuZSBoYXMgYmVlbiBhZGRlZCB0byBhIGNvbnRyb2xsZXIuDQoJICogQHB1YmxpYw0KDQoJICogQGV4YW1wbGUNCgkgKiAvLyBhZGQgYmFzaWMgaW5kaWNhdG9ycw0KCSAqIHNjZW5lLmFkZEluZGljYXRvcnMoKQ0KCSAqDQoJICogLy8gcGFzc2luZyBvcHRpb25zDQoJICogc2NlbmUuYWRkSW5kaWNhdG9ycyh7emluZGV4OiAxMDAsIGNvbG9yRW5kOiAiI0ZGRkZGRiJ9KTsNCgkgKg0KCSAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBBbiBvYmplY3QgY29udGFpbmluZyBvbmUgb3IgbW9yZSBvcHRpb25zIGZvciB0aGUgaW5kaWNhdG9ycy4NCgkgKiBAcGFyYW0geyhzdHJpbmd8b2JqZWN0KX0gW29wdGlvbnMucGFyZW50PXVuZGVmaW5lZF0gLSBBIHNlbGVjdG9yLCBET00gT2JqZWN0IG9yIGEgalF1ZXJ5IG9iamVjdCB0aGF0IHRoZSBpbmRpY2F0b3JzIHNob3VsZCBiZSBhZGRlZCB0by4gIA0KCSAJCQkJCQkJCQkJCQkJCSBJZiB1bmRlZmluZWQsIHRoZSBzY2VuZSdzIGNvbnRhaW5lciB3aWxsIGJlIHVzZWQuDQoJICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnppbmRleD0tMV0gLSBDU1MgemluZGV4IGZvciB0aGUgaW5kaWNhdG9yIGNvbnRhaW5lci4NCgkgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuaW5kZW50PTBdIC0gQWRkaXRpb25hbCBwb3NpdGlvbiBvZmZzZXQgZm9yIHRoZSBpbmRpY2F0b3JzICh1c2VmdWwsIHdoZW4gaGF2aW5nIG11bHRpcGxlIHNjZW5lcyBzdGFydGluZyBhdCB0aGUgc2FtZSB0aW1lKS4NCgkgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuc3VmZml4PSIiXSAtIFRoaXMgc3RyaW5nIHdpbGwgYmUgYXR0YWNoZWQgdG8gdGhlIHN0YXJ0IGFuZCBlbmQgaW5kaWNhdG9yICh1c2VmdWwgZm9yIGlkZW50aWZpY2F0aW9uIHdoZW4gd29ya2luZyB3aXRoIG11bHRpcGxlIHNjZW5lcykuDQoJICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmNvbG9yVHJpZ2dlcj1ibHVlXSAtIENTUyBjb2xvciBkZWZpbml0aW9uIGZvciB0aGUgdHJpZ2dlciBpbmRpY2F0b3IuDQoJICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmNvbG9yU3RhcnQ9Z3JlZW5dIC0gQ1NTIGNvbG9yIGRlZmluaXRpb24gZm9yIHRoZSBzdGFydCBpbmRpY2F0b3IuDQoJICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmNvbG9yRW5kPXJlZF0gLSBDU1MgY29sb3IgZGVmaW5pdGlvbiBmb3IgdGhlIGVuZCBpbmRpY2F0b3IuDQoJKi8NCglTY3JvbGxTY2VuZS5wcm90b3R5cGUuYWRkSW5kaWNhdG9ycyA9IGZ1bmN0aW9uKG9wdCkgew0KCQl2YXINCgkJCURFRkFVTFRfT1BUSU9OUyA9IHsNCgkJCQlwYXJlbnQ6IHVuZGVmaW5lZCwNCgkJCQl6aW5kZXg6IC0xLA0KCQkJCWluZGVudDogMCwNCgkJCQlzdWZmaXg6ICIiLA0KCQkJCWNvbG9yVHJpZ2dlcjogImJsdWUiLA0KCQkJCWNvbG9yU3RhcnQ6ICJncmVlbiIsDQoJCQkJY29sb3JFbmQ6ICJyZWQiDQoJCQl9Ow0KDQoNCgkJdmFyDQoJCQlzY2VuZSA9IHRoaXMsDQoJCQlvcHRpb25zID0gJC5leHRlbmQoe30sIERFRkFVTFRfT1BUSU9OUywgb3B0KSwNCgkJCWNvbnRyb2xsZXIgPSB0aGlzLnBhcmVudCgpOw0KCQlpZiAoY29udHJvbGxlcikgew0KCQkJdmFyDQoJCQkJY1BhcmFtcyA9IGNvbnRyb2xsZXIuaW5mbygpLA0KCQkJCXN1ZmZpeCA9IChvcHRpb25zLmxhYmVsU3VmZml4ID09PSAiIikgPyAiIiA6ICIgIiArIG9wdGlvbnMuc3VmZml4LA0KCQkJCSRjb250YWluZXIgPSAkKG9wdGlvbnMucGFyZW50KS5sZW5ndGggPiAwID8NCgkJCQkJCSAgJChvcHRpb25zLnBhcmVudCkNCgkJCQkJCTogY1BhcmFtcy5pc0RvY3VtZW50ID8gJCgiYm9keSIpIDogY1BhcmFtcy5jb250YWluZXIsIC8vIGNoZWNrIGlmIHdpbmRvdyBlbGVtZW50ICh0aGVuIHVzZSBib2R5KQ0KCQkJCSR3cmFwID0gJCgiJmx0O2Rpdj4mbHQ7L2Rpdj4iKQ0KCQkJCQkJLmFkZENsYXNzKCJTY3JvbGxTY2VuZUluZGljYXRvcnMiKQ0KCQkJCQkJLmRhdGEoIm9wdGlvbnMiLCBvcHRpb25zKQ0KCQkJCQkJLmNzcyh7DQoJCQkJCQkJcG9zaXRpb246ICJhYnNvbHV0ZSIsDQoJCQkJCQkJdG9wOiAwLA0KCQkJCQkJCWxlZnQ6IDAsDQoJCQkJCQkJd2lkdGg6ICIxMDAlIiwNCgkJCQkJCQloZWlnaHQ6ICIxMDAlIiwNCgkJCQkJCQkidGV4dC1hbGlnbiI6ICJjZW50ZXIiLA0KCQkJCQkJCSJ6LWluZGV4Ijogb3B0aW9ucy56aW5kZXgsDQoJCQkJCQkJInBvaW50ZXItZXZlbnRzIjogIm5vbmUiLA0KCQkJCQkJCSJmb250LXNpemUiOiAxMA0KCQkJCQkJfSksDQoJCQkJJHRyaWdnZXJIb29rID0gJCgiJmx0O2Rpdj50cmlnZ2VyJmx0Oy9kaXY+IikNCgkJCQkJCQkJLmNzcyh7DQoJCQkJCQkJCQlwb3NpdGlvbjogImZpeGVkIiwNCgkJCQkJCQkJCW92ZXJmbG93OiAidmlzaWJsZSIsDQoJCQkJCQkJCQljb2xvcjogb3B0aW9ucy5jb2xvclRyaWdnZXINCgkJCQkJCQkJfSkNCgkJCQkJCQkJLmFkZENsYXNzKCJob29rIik7DQoJCQkJJHN0YXJ0ID0gJCgiJmx0O2Rpdj5zdGFydCIgKyBzdWZmaXggKyAiJmx0Oy9kaXY+IikNCgkJCQkJCQkJLmNzcyh7DQoJCQkJCQkJCQlwb3NpdGlvbjogImFic29sdXRlIiwNCgkJCQkJCQkJCW92ZXJmbG93OiAidmlzaWJsZSIsDQoJCQkJCQkJCQljb2xvcjogb3B0aW9ucy5jb2xvclN0YXJ0DQoJCQkJCQkJCX0pDQoJCQkJCQkJCS5hZGRDbGFzcygic3RhcnQiKTsNCgkJCQkkZW5kID0gJCgiJmx0O2Rpdj5lbmQiICsgc3VmZml4ICsgIiZsdDsvZGl2PiIpDQoJCQkJCQkJCS5jc3Moew0KCQkJCQkJCQkJcG9zaXRpb246ICJhYnNvbHV0ZSIsDQoJCQkJCQkJCQlvdmVyZmxvdzogInZpc2libGUiLA0KCQkJCQkJCQkJY29sb3I6IG9wdGlvbnMuY29sb3JFbmQNCgkJCQkJCQkJfSkNCgkJCQkJCQkJLmFkZENsYXNzKCJlbmQiKTsNCg0KCQkJaWYgKCRjb250YWluZXIuY3NzKCJwb3NpdGlvbiIpID09ICJzdGF0aWMiKSB7DQoJCQkJJGNvbnRhaW5lci5jc3MoInBvc2l0aW9uIiwgInJlbGF0aXZlIik7IC8vIHBvc2l0aW9uaW5nIG5lZWRlZCBmb3IgY29ycmVjdCBkaXNwbGF5IG9mIGluZGljYXRvcnMNCgkJCX0NCg0KCQkJc2NlbmUuaW5kaWNhdG9ycyA9ICR3cmFwDQoJCQkJICAgIAkJCS5hcHBlbmQoJHRyaWdnZXJIb29rKQ0KCQkJCSAgICAJCQkuYXBwZW5kKCRzdGFydCkNCgkJCQkgICAgCQkJLmFwcGVuZCgkZW5kKQ0KCQkJCSAgICAJCQkuYXBwZW5kVG8oJGNvbnRhaW5lcik7DQoNCgkJCXNjZW5lLnVwZGF0ZUluZGljYXRvcnMoKTsNCgkJCXZhciBjYWxsVXBkYXRlID0gZnVuY3Rpb24gKGUpIHsNCgkJCQlpZiAoKGUudHlwZSA9PSAic2Nyb2xsIiB8fCBlLnR5cGUgPT0gInJlc2l6ZSIpICZhbXA7JmFtcDsgIWNQYXJhbXMuaXNEb2N1bWVudCkgew0KCQkJCQlzY2VuZS51cGRhdGVJbmRpY2F0b3JzKHRydWUpOw0KCQkJCX0gZWxzZSB7DQoJCQkJCXNjZW5lLnVwZGF0ZUluZGljYXRvcnMoKTsNCgkJCQl9DQoJCQl9Ow0KCQkJc2NlbmUub24oImNoYW5nZS5kZWJ1ZyIsIGNhbGxVcGRhdGUpOw0KCQkJY1BhcmFtcy5jb250YWluZXIub24oInJlc2l6ZSBzY3JvbGwiLCBjYWxsVXBkYXRlKTsNCgkJCWlmICghY1BhcmFtcy5pc0RvY3VtZW50KSB7DQoJCQkJJCh3aW5kb3cpLm9uKCJzY3JvbGwgcmVzaXplIiwgY2FsbFVwZGF0ZSk7DQoJCQl9DQoJCX0gZWxzZSB7DQoJCQljb25zb2xlLmxvZygiRVJST1I6IFBsZWFzZSBhZGQgU2NlbmUgdG8gY29udHJvbGxlciBiZWZvcmUgYWRkaW5nIGluZGljYXRvcnMuIik7DQoJCX0NCgkJcmV0dXJuIHNjZW5lOw0KCX07DQoJU2Nyb2xsU2NlbmUucHJvdG90eXBlLnVwZGF0ZUluZGljYXRvcnMgPSBmdW5jdGlvbih0cmlnZ2VyT25seSkgew0KCQl2YXINCgkJCXNjZW5lID0gdGhpcywNCgkJCWNvbnRyb2xsZXIgPSBzY2VuZS5wYXJlbnQoKSwNCgkJCWluZGljYXRvcnMgPSBzY2VuZS5pbmRpY2F0b3JzLA0KCQkJb3B0aW9ucyA9IGluZGljYXRvcnMuZGF0YSgib3B0aW9ucyIpOw0KCQlpZiAoaW5kaWNhdG9ycyAmYW1wOyZhbXA7IGNvbnRyb2xsZXIpIHsNCgkJCXZhcg0KCQkJCWNQYXJhbXMgPSBjb250cm9sbGVyLmluZm8oKSwNCgkJCQkkdHJpZ2dlckhvb2sgPSBpbmRpY2F0b3JzLmNoaWxkcmVuKCIuaG9vayIpLA0KCQkJCSRzdGFydCA9IGluZGljYXRvcnMuY2hpbGRyZW4oIi5zdGFydCIpLA0KCQkJCSRlbmQgPSBpbmRpY2F0b3JzLmNoaWxkcmVuKCIuZW5kIiksDQoJCQkJcGFyZW50T2Zmc2V0ID0gY1BhcmFtcy5jb250YWluZXIub2Zmc2V0KCkgfHwge3RvcDogMCwgbGVmdDogMH0sDQoJCQkJcGFyZW50UG9zID0gY1BhcmFtcy52ZXJ0aWNhbCA/IHBhcmVudE9mZnNldC50b3AgOiBwYXJlbnRPZmZzZXQubGVmdCwNCgkJCQlob29rUG9zID0gKGNQYXJhbXMuc2l6ZSAqIHNjZW5lLnRyaWdnZXJIb29rKCkpICsgcGFyZW50UG9zLA0KCQkJCWRpcmVjdGlvbiA9IGNQYXJhbXMudmVydGljYWwgPyAidiIgOiAiaCI7DQoNCgkJCWlmIChjUGFyYW1zLmlzRG9jdW1lbnQpIHsgLy8gYWNjb3VudCBmb3IgcG9zc2libGUgYm9keSBwb3NpdGlvbmluZw0KCQkJCXZhciBib2R5T2Zmc2V0ID0gaW5kaWNhdG9ycy5vZmZzZXRQYXJlbnQoKS5pcygiYm9keSIpID8gJCgiYm9keSIpLm9mZnNldCgpIDogcGFyZW50T2Zmc2V0Ow0KCQkJCWluZGljYXRvcnMuY3NzKHsNCgkJCQkJdG9wOiAtYm9keU9mZnNldC50b3AsDQoJCQkJCWxlZnQ6IC1ib2R5T2Zmc2V0LmxlZnQNCgkJCQl9KTsNCgkJCX0gZWxzZSB7DQoJCQkJaG9va1BvcyAtPSAgY1BhcmFtcy52ZXJ0aWNhbCA/ICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpIDogJChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpOw0KCQkJfQ0KDQoJCQkkdHJpZ2dlckhvb2sNCgkJCQkuYXR0cigiZGF0YS1ob29rIiwgaG9va1BvcykNCgkJCQkuYXR0cigiZGF0YS1kaXJlY3Rpb24iLCBkaXJlY3Rpb24pDQoJCQkJLmRhdGEoInBhcmVudCIsIGNQYXJhbXMuY29udGFpbmVyKTsNCg0KCQkJJG90aGVyaG9vayA9ICQoIi5TY3JvbGxTY2VuZUluZGljYXRvcnMgLmhvb2tbZGF0YS1ob29rPVwiIisgaG9va1BvcyArIlwiXVtkYXRhLWRpcmVjdGlvbj0iK2RpcmVjdGlvbisiXTp2aXNpYmxlIikubm90KCR0cmlnZ2VySG9vayk7DQoJCQlpZiAoJG90aGVyaG9vay5sZW5ndGggPiAwICZhbXA7JmFtcDsgJG90aGVyaG9vay5kYXRhKCJwYXJlbnQiKSA9PSBjUGFyYW1zLmNvbnRhaW5lcikgew0KCQkJCSR0cmlnZ2VySG9vay5oaWRlKCk7DQoJCQl9IGVsc2Ugew0KCQkJCSR0cmlnZ2VySG9vay5zaG93KCk7DQoJCQkJdmFyIGZsaXAgPSBob29rUG9zID4gY1BhcmFtcy5zaXplKjAuODsgLy8gcHV0IG5hbWUgYWJvdmUgbGluZT8JDQoJCQkJaWYgKGNQYXJhbXMudmVydGljYWwpIHsNCgkJCQkJLy8gdHJpZ2dlckhvb2sNCgkJCQkJJHRyaWdnZXJIb29rLmNzcyh7DQoJCQkJCQl0b3A6IGZsaXAgPyBob29rUG9zIC0gJHRyaWdnZXJIb29rLmhlaWdodCgpIC0gMiA6IGhvb2tQb3MsDQoJCQkJCQlsZWZ0OiAoY1BhcmFtcy5pc0RvY3VtZW50ID8gY1BhcmFtcy5jb250YWluZXIud2lkdGgoKSA6IHBhcmVudE9mZnNldC5sZWZ0ICsgY1BhcmFtcy5jb250YWluZXIud2lkdGgoKSAtICQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKSkgLSA3MCAtIG9wdGlvbnMuaW5kZW50LA0KCQkJCQkJd2lkdGg6IDQwLA0KCQkJCQkJaGVpZ2h0OiAiYXV0byIsDQoJCQkJCQlwYWRkaW5nOiAiMCA4cHggMnB4IDhweCIsDQoJCQkJCQkiYm9yZGVyLXRvcCI6IGZsaXAgPyAibm9uZSIgOiAiMXB4IHNvbGlkIGJsdWUiLA0KCQkJCQkJImJvcmRlci1ib3R0b20iOiBmbGlwID8gIjFweCBzb2xpZCBibHVlIiA6ICJub25lIiwNCgkJCQkJCSJib3JkZXItbGVmdCI6ICJub25lIiwNCgkJCQkJCSJib3JkZXItcmlnaHQiOiAibm9uZSINCgkJCQkJfSk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJJHRyaWdnZXJIb29rLmNzcyh7DQoJCQkJCQl0b3A6IChjUGFyYW1zLmlzRG9jdW1lbnQgPyBjUGFyYW1zLmNvbnRhaW5lci5oZWlnaHQoKSA6IHBhcmVudE9mZnNldC50b3AgKyBjUGFyYW1zLmNvbnRhaW5lci5oZWlnaHQoKSAtICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpKSAtIDQwIC0gb3B0aW9ucy5pbmRlbnQsDQoJCQkJCQlsZWZ0OiBmbGlwID8gaG9va1BvcyAtICR0cmlnZ2VySG9vay53aWR0aCgpIC0gOTogaG9va1BvcywNCgkJCQkJCXdpZHRoOiAiYXV0byIsDQoJCQkJCQloZWlnaHQ6IDIwLA0KCQkJCQkJcGFkZGluZzogIjVweCA1cHggMCA1cHgiLA0KCQkJCQkJImJvcmRlci10b3AiOiAibm9uZSIsDQoJCQkJCQkiYm9yZGVyLWJvdHRvbSI6ICJub25lIiwNCgkJCQkJCSJib3JkZXItbGVmdCI6IGZsaXAgPyAibm9uZSIgOiAiMXB4IHNvbGlkIGJsdWUiLA0KCQkJCQkJImJvcmRlci1yaWdodCI6IGZsaXAgPyAiMXB4IHNvbGlkIGJsdWUiIDogIm5vbmUiDQoJCQkJCX0pOw0KCQkJCX0NCgkJCX0NCgkJCQ0KCQkJaWYgKCF0cmlnZ2VyT25seSkgew0KCQkJCXZhcg0KCQkJCQlzdGFydFBvcyA9IHNjZW5lLnRyaWdnZXJQb3NpdGlvbigpLA0KCQkJCQllbmRQb3MgPSBzdGFydFBvcyArIHNjZW5lLmR1cmF0aW9uKCksDQoJCQkJCXJlc2V0Q1NTID0gew0KCQkJCQkJImJvcmRlciI6ICJub25lIiwNCgkJCQkJCXRvcDogImF1dG8iLA0KCQkJCQkJYm90dG9tOiAiYXV0byIsDQoJCQkJCQlsZWZ0OiAiYXV0byIsDQoJCQkJCQlyaWdodDogImF1dG8iDQoJCQkJCX07DQoJCQkJDQoJCQkJJHN0YXJ0LmNzcyhyZXNldENTUyk7DQoJCQkJJGVuZC5jc3MocmVzZXRDU1MpOw0KDQoJCQkJaWYgKHNjZW5lLmR1cmF0aW9uKCkgPT09IDApIHsNCgkJCQkJJGVuZC5oaWRlKCk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJJGVuZC5zaG93KCk7DQoJCQkJfQ0KCQkJCWlmIChjUGFyYW1zLnZlcnRpY2FsKSB7DQoJCQkJCS8vIHN0YXJ0DQoJCQkJCSRzdGFydC5jc3Moew0KCQkJCQkJdG9wOiBzdGFydFBvcywNCgkJCQkJCXJpZ2h0OiA3MS1jUGFyYW1zLmNvbnRhaW5lci5zY3JvbGxMZWZ0KCkgKyBvcHRpb25zLmluZGVudCwNCgkJCQkJCSJib3JkZXItdG9wIjogIjFweCBzb2xpZCBncmVlbiIsDQoJCQkJCQlwYWRkaW5nOiAiMCA4cHggMCA4cHgiDQoJCQkJCX0pOw0KCQkJCQkvLyBlbmQNCgkJCQkJJGVuZC5jc3Moew0KCQkJCQkJdG9wOiBlbmRQb3MsDQoJCQkJCQlyaWdodDogNzEtY1BhcmFtcy5jb250YWluZXIuc2Nyb2xsTGVmdCgpICsgb3B0aW9ucy5pbmRlbnQsDQoJCQkJCQkiYm9yZGVyLXRvcCI6ICIxcHggc29saWQgcmVkIiwNCgkJCQkJCXBhZGRpbmc6ICIwIDhweCAwIDhweCINCgkJCQkJfSk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJLy8gc3RhcnQNCgkJCQkJJHN0YXJ0LmNzcyh7DQoJCQkJCQlsZWZ0OiBzdGFydFBvcywNCgkJCQkJCWJvdHRvbTogNDAtY1BhcmFtcy5jb250YWluZXIuc2Nyb2xsVG9wKCkgKyBvcHRpb25zLmluZGVudCwNCgkJCQkJCSJib3JkZXItbGVmdCI6ICIxcHggc29saWQgZ3JlZW4iLA0KCQkJCQkJcGFkZGluZzogIjAgOHB4IDAgOHB4Ig0KCQkJCQl9KTsNCgkJCQkJLy8gZW5kDQoJCQkJCSRlbmQuY3NzKHsNCgkJCQkJCWxlZnQ6IGVuZFBvcywNCgkJCQkJCWJvdHRvbTogNDAtY1BhcmFtcy5jb250YWluZXIuc2Nyb2xsVG9wKCkgKyBvcHRpb25zLmluZGVudCwNCgkJCQkJCSJib3JkZXItbGVmdCI6ICIxcHggc29saWQgcmVkIiwNCgkJCQkJCXBhZGRpbmc6ICIwIDhweCAwIDhweCINCgkJCQkJfSk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfTsNCn0pKTs8L3ByZT4KICAgICAgICA8L2FydGljbGU+CiAgICA8L3NlY3Rpb24+CgoKCgoKCQkJCTwvZGl2PgoKCQkJCTxkaXYgY2xhc3M9ImNsZWFyZml4Ij48L2Rpdj4KCQkJCTxmb290ZXI+CgkJCQkJCgkJCQkJCgkJPHNwYW4gY2xhc3M9ImNvcHlyaWdodCI+CgkJwqkgSmFuIFBhZXBrZSAyMDE0CgkJPC9zcGFuPgoJCQkJCTxiciAvPgoJCQkJCQoJCTxzcGFuIGNsYXNzPSJqc2RvYy1tZXNzYWdlIj4KCQlEb2N1bWVudGF0aW9uIGdlbmVyYXRlZCBieSA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vanNkb2MzL2pzZG9jIiB0YXJnZXQ9Il9ibGFuayI+SlNEb2MgMy4zLjAtYWxwaGE5PC9hPgoJCXVzaW5nIGEgY3VzdG9taXplZCB2ZXJzaW9uIG9mIHRoZSA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vdGVycnl3ZWlzcy9kb2NzdHJhcCIgdGFyZ2V0PSJfYmxhbmsiPkRvY1N0cmFwIHRlbXBsYXRlPC9hPi4KCQk8L3NwYW4+CgkJCQk8L2Zvb3Rlcj4KCQkJPC9kaXY+CgoJCQkKCQkJPGJyIGNsZWFyPSJib3RoIj4KCQk8L2Rpdj4KCgk8L2Rpdj4KCTxzY3JpcHQgc3JjPSJzY3JpcHRzL3N1bmxpZ2h0LmpzIj48L3NjcmlwdD4KCTxzY3JpcHQgc3JjPSJzY3JpcHRzL3N1bmxpZ2h0LmphdmFzY3JpcHQuanMiPjwvc2NyaXB0PgoJPHNjcmlwdCBzcmM9InNjcmlwdHMvc3VubGlnaHQtcGx1Z2luLmRvY2xpbmtzLmpzIj48L3NjcmlwdD4KCTxzY3JpcHQgc3JjPSJzY3JpcHRzL3N1bmxpZ2h0LXBsdWdpbi5saW5lbnVtYmVycy5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHNyYz0ic2NyaXB0cy9zdW5saWdodC1wbHVnaW4ubWVudS5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHNyYz0ic2NyaXB0cy9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4KCTxzY3JpcHQgc3JjPSJzY3JpcHRzL2pxdWVyeS5zY3JvbGxUby5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHNyYz0ic2NyaXB0cy9qcXVlcnkubG9jYWxTY3JvbGwuanMiPjwvc2NyaXB0PgoJPHNjcmlwdCBzcmM9InNjcmlwdHMvYm9vdHN0cmFwLWRyb3Bkb3duLmpzIj48L3NjcmlwdD4KCTxzY3JpcHQgc3JjPSJzY3JpcHRzL3RvYy5qcyI+PC9zY3JpcHQ+CgoJPHNjcmlwdD4gcHJldHR5UHJpbnQoKTsgPC9zY3JpcHQ+Cgk8c2NyaXB0PiAgU3VubGlnaHQuaGlnaGxpZ2h0QWxsKHtsaW5lTnVtYmVyczp0cnVlLCAgc2hvd01lbnU6IHRydWUsIGVuYWJsZURvY2xpbmtzIDp0cnVlfSk7IDwvc2NyaXB0PgoKCTxzY3JpcHQ+CgkJZnVuY3Rpb24gb3BlbkRlZXBsaW5rZWRFbGVtZW50IChza2lwQW5pKSB7CgkJCSQoImR0IGg0Lm1lbWJlci1jb2xsYXBzZWRbaWQ9JyIgKyB3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSkucmVwbGFjZSgiOiIsICJcXDoiKSArIiddIikudHJpZ2dlcigiY2xpY2siLCBza2lwQW5pKTsKCQl9CgkJJCggZnVuY3Rpb24gKCkgewoJCQkkKCAiI3RvYyIgKS50b2MoIHsKCQkJICAgIGFuY2hvck5hbWUgIDogZnVuY3Rpb24oaSwgaGVhZGluZywgcHJlZml4KSB7CgkJCQkJcmV0dXJuICQoaGVhZGluZykuYXR0cigiaWQiKSB8fCAoIHByZWZpeCArIGkgKTsKCQkJCX0sCgkJCQlzZWxlY3RvcnMgICA6ICJoMTp2aXNpYmxlLGgyOnZpc2libGUsaDM6dmlzaWJsZSxoNDp2aXNpYmxlIiwKCQkJCW9uU2Nyb2xsRmluaXNoIDogb3BlbkRlZXBsaW5rZWRFbGVtZW50LAoJCQkJaGlnaGxpZ2h0T2Zmc2V0IDogMTAsCgkJCQlzY3JvbGxPZmZzZXQ6IDYwCgkJCX0gKTsKCQkJJCggIiN0b2M+dWwiICkuYWRkQ2xhc3MoICJuYXYgbmF2LXBpbGxzIG5hdi1zdGFja2VkIiApOwoJCQkkKCAiI21haW4gc3BhbltpZF49J3RvYyddIiApLmFkZENsYXNzKCAidG9jLXNoaW0iICk7CgoJCX0gKTsKCTwvc2NyaXB0PgoKCQoJPHNjcmlwdD4KCQkkKCBmdW5jdGlvbiAoKSB7CgkJCS8vICQoJyNtYWluJykubG9jYWxTY3JvbGwoewoJCQkvLyAJb2Zmc2V0OiB7IHRvcDogNTYgfSAvL29mZnNldCBieSB0aGUgaGVpZ2h0IG9mIHlvdXIgaGVhZGVyIChnaXZlIG9yIHRha2UgYSBmZXcgcHgsIHNlZSB3aGF0IHdvcmtzIGZvciB5b3UpCgkJCS8vIH0pOwoJCQkvLyB3b3JrYXJvdW5kIGZvciBhbmNob3JzIGJlbG93IGhlYWRlci4uLgoJCQl3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CgkJCQkkKGRvY3VtZW50KS5zY3JvbGxUb3AoJChkb2N1bWVudCkuc2Nyb2xsVG9wKCktNjApOwoJCQl9LCAxKQoJCQkKCQkJdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSkucmVwbGFjZSgiOiIsICJcXDoiKTsKCQkJJCggImR0IGg0Lm5hbWUiICkuZWFjaCggZnVuY3Rpb24gKCkgewoJCQkJdmFyICR0aGlzID0gJCggdGhpcyApOwoJCQkJdmFyIGljb24gPSAkKCAiPGkvPiIgKS5hZGRDbGFzcyggImljb24tcGx1cy1zaWduIiApLmFkZENsYXNzKCAicHVsbC1yaWdodCIgKS5hZGRDbGFzcyggImljb24td2hpdGUiICk7CgkJCQl2YXIgZHQgPSAkdGhpcy5wYXJlbnRzKCAiZHQiICk7CgkJCQl2YXIgY2hpbGRyZW4gPSBkdC5uZXh0KCAiZGQiICk7CgoJCQkJJHRoaXMuYXBwZW5kKCBpY29uICkuY3NzKCB7Y3Vyc29yIDogInBvaW50ZXIifSApOwoJCQkJJHRoaXMuYWRkQ2xhc3MoICJtZW1iZXItY29sbGFwc2VkIiApLmFkZENsYXNzKCAibWVtYmVyIiApOwoJCQkJaWYgKGhhc2ggIT0gJHRoaXMuYXR0cigiaWQiKSkgewoJCQkJCWNoaWxkcmVuLmhpZGUoKTsKCQkJCX0KCQkJCSR0aGlzLnRvZ2dsZSggZnVuY3Rpb24gKGUsIHNraXBBbmkpIHsKCQkJCQl2YXIgc2Nyb2xsUG9zID0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCk7CgkJCQkJd2luZG93LmxvY2F0aW9uLmhhc2ggPSAkKHRoaXMpLmF0dHIoImlkIik7CgkJCQkJJChkb2N1bWVudCkuc2Nyb2xsVG9wKHNjcm9sbFBvcyk7CgkJCQkJaWNvbi5hZGRDbGFzcyggImljb24tbWludXMtc2lnbiIgKS5yZW1vdmVDbGFzcyggImljb24tcGx1cy1zaWduIiApLnJlbW92ZUNsYXNzKCAiaWNvbi13aGl0ZSIgKTsKCQkJCQkkdGhpcy5hZGRDbGFzcyggIm1lbWJlci1vcGVuIiApLnJlbW92ZUNsYXNzKCAibWVtYmVyLWNvbGxhcHNlZCIgKTsKCQkJCQljaGlsZHJlbi5zbGlkZURvd24oc2tpcEFuaSA/IDAgOiB1bmRlZmluZWQpOwoJCQkJfSwgZnVuY3Rpb24gKCkgewoJCQkJCWljb24uYWRkQ2xhc3MoICJpY29uLXBsdXMtc2lnbiIgKS5yZW1vdmVDbGFzcyggImljb24tbWludXMtc2lnbiIgKS5hZGRDbGFzcyggImljb24td2hpdGUiICk7CgkJCQkJJHRoaXMuYWRkQ2xhc3MoICJtZW1iZXItY29sbGFwc2VkIiApLnJlbW92ZUNsYXNzKCAibWVtYmVyLW9wZW4iICk7CgkJCQkJY2hpbGRyZW4uc2xpZGVVcCgpOwoJCQkJfSApOwoJCQl9ICk7CgkJCS8vIG9wZW4gaWYgZGVlcGxpbmtlZAoJCQlpZiAoaGFzaC5sZW5ndGggPiAwKQoJCQkJb3BlbkRlZXBsaW5rZWRFbGVtZW50KHRydWUpOwoJCX0gKTsKCTwvc2NyaXB0PgoJCgoJPHNjcmlwdD4KCQkoZnVuY3Rpb24oaSxzLG8sZyxyLGEsbSl7aVsnR29vZ2xlQW5hbHl0aWNzT2JqZWN0J109cjtpW3JdPWlbcl18fGZ1bmN0aW9uKCl7CgkJKGlbcl0ucT1pW3JdLnF8fFtdKS5wdXNoKGFyZ3VtZW50cyl9LGlbcl0ubD0xKm5ldyBEYXRlKCk7YT1zLmNyZWF0ZUVsZW1lbnQobyksCgkJbT1zLmdldEVsZW1lbnRzQnlUYWdOYW1lKG8pWzBdO2EuYXN5bmM9MTthLnNyYz1nO20ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSxtKQoJCX0pKHdpbmRvdyxkb2N1bWVudCwnc2NyaXB0JywnLy93d3cuZ29vZ2xlLWFuYWx5dGljcy5jb20vYW5hbHl0aWNzLmpzJywnZ2EnKTsKCQlnYSgnY3JlYXRlJywgJ1VBLTM3NTI0MzQ0LTMnLCAnamFucGFlcGtlLmdpdGh1Yi5pbycpOwoJCWdhKCdzZW5kJywgJ3BhZ2V2aWV3Jyk7Cgk8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 04:08:55 GMT",
                    "Content-Length": "15160",
                    "Date": "Sat, 08 Nov 2014 04:08:56 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}