{
    "url": "http://localhost:9999/OceanInternet/jquery-mobile-build/js/jquery.mobile.support.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>location.pathname</b> and written to <b>the 'href' property of a DOM element</b> via the following statement:<ul><li>base[ 0 ].href = href || location.pathname;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/OceanInternet/jquery-mobile-build/js/jquery.mobile.support.js",
                "path": "/OceanInternet/jquery-mobile-build/js/jquery.mobile.support.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9PY2VhbkludGVybmV0L2pxdWVyeS1tb2JpbGUtYnVpbGQvanMvanF1ZXJ5Lm1vYmlsZS5zdXBwb3J0LmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODgyNA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAwNjo0NzozMSBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMDY6NDc6MjkgR01UDQoNCi8vPj5leGNsdWRlU3RhcnQoImpxbUJ1aWxkRXhjbHVkZSIsIHByYWdtYXMuanFtQnVpbGRFeGNsdWRlKTsKLy8+PmRlc2NyaXB0aW9uOiBBc3NvcnRlZCB0ZXN0cyB0byBxdWFsaWZ5IGJyb3dzZXJzIGJ5IGRldGVjdGluZyBmZWF0dXJlcwovLz4+bGFiZWw6IFN1cHBvcnQgVGVzdHMKLy8+Pmdyb3VwOiBDb3JlCmRlZmluZSggWyAgImpxdWVyeSIsICIuL2pxdWVyeS5tb2JpbGUuY29yZSIsICIuL2pxdWVyeS5tb2JpbGUubWVkaWEiLCAiLi9qcXVlcnkubW9iaWxlLnN1cHBvcnQudG91Y2giLCAiLi9qcXVlcnkubW9iaWxlLnN1cHBvcnQub3JpZW50YXRpb24iIF0sIGZ1bmN0aW9uKCBqUXVlcnkgKSB7Ci8vPj5leGNsdWRlRW5kKCJqcW1CdWlsZEV4Y2x1ZGUiKTsKKGZ1bmN0aW9uKCAkLCB1bmRlZmluZWQgKSB7CgovLyB0aHggTW9kZXJuaXpyCmZ1bmN0aW9uIHByb3BFeGlzdHMoIHByb3AgKSB7Cgl2YXIgdWNfcHJvcCA9IHByb3AuY2hhckF0KCAwICkudG9VcHBlckNhc2UoKSArIHByb3Auc3Vic3RyKCAxICksCgkJcHJvcHMgPSAoIHByb3AgKyAiICIgKyB2ZW5kb3JzLmpvaW4oIHVjX3Byb3AgKyAiICIgKSArIHVjX3Byb3AgKS5zcGxpdCggIiAiICksCgkJdjsKCglmb3IgKCB2IGluIHByb3BzICkgewoJCWlmICggZmJDU1NbIHByb3BzWyB2IF0gXSAhPT0gdW5kZWZpbmVkICkgewoJCQlyZXR1cm4gdHJ1ZTsKCQl9Cgl9Cn0KCnZhciBmYWtlQm9keSA9ICQoICI8Ym9keT4iICkucHJlcGVuZFRvKCAiaHRtbCIgKSwKCWZiQ1NTID0gZmFrZUJvZHlbIDAgXS5zdHlsZSwKCXZlbmRvcnMgPSBbICJXZWJraXQiLCAiTW96IiwgIk8iIF0sCgl3ZWJvcyA9ICJwYWxtR2V0UmVzb3VyY2UiIGluIHdpbmRvdywgLy9vbmx5IHVzZWQgdG8gcnVsZSBvdXQgc2Nyb2xsVG9wCglvcGVyYW1pbmkgPSB3aW5kb3cub3BlcmFtaW5pICYmICh7fSkudG9TdHJpbmcuY2FsbCggd2luZG93Lm9wZXJhbWluaSApID09PSAiW29iamVjdCBPcGVyYU1pbmldIiwKCWJiID0gd2luZG93LmJsYWNrYmVycnkgJiYgIXByb3BFeGlzdHMoICItd2Via2l0LXRyYW5zZm9ybSIgKSwgLy9vbmx5IHVzZWQgdG8gcnVsZSBvdXQgYm94IHNoYWRvdywgYXMgaXQncyBmaWxsZWQgb3BhcXVlIG9uIEJCIDUgYW5kIGxvd2VyCglub2tpYUxURTdfMzsKCi8vIGlubGluZSBTVkcgc3VwcG9ydCB0ZXN0CmZ1bmN0aW9uIGlubGluZVNWRygpIHsKCS8vIFRoYW5rcyBNb2Rlcm5penIgJiBFcmlrIERhaGxzdHJvbQoJdmFyIHcgPSB3aW5kb3csCgkJc3ZnID0gISF3LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyAmJiAhIXcuZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCAiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCAic3ZnIiApLmNyZWF0ZVNWR1JlY3QgJiYgISggdy5vcGVyYSAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoICJDaHJvbWUiICkgPT09IC0xICksCgkJc3VwcG9ydCA9IGZ1bmN0aW9uKCBkYXRhICkgewoJCQlpZiAoICEoIGRhdGEgJiYgc3ZnICkgKSB7CgkJCQkkKCAiaHRtbCIgKS5hZGRDbGFzcyggInVpLW5vc3ZnIiApOwoJCQl9CgkJfSwKCQlpbWcgPSBuZXcgdy5JbWFnZSgpOwoKCWltZy5vbmVycm9yID0gZnVuY3Rpb24oKSB7CgkJc3VwcG9ydCggZmFsc2UgKTsKCX07CglpbWcub25sb2FkID0gZnVuY3Rpb24oKSB7CgkJc3VwcG9ydCggaW1nLndpZHRoID09PSAxICYmIGltZy5oZWlnaHQgPT09IDEgKTsKCX07CglpbWcuc3JjID0gImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQUFBQUFQLy8veXdBQUFBQUFRQUJBQUFDQVV3QU93PT0iOwp9CgpmdW5jdGlvbiB0cmFuc2Zvcm0zZFRlc3QoKSB7Cgl2YXIgbXFQcm9wID0gInRyYW5zZm9ybS0zZCIsCgkJLy8gQmVjYXVzZSB0aGUgYHRyYW5zbGF0ZTNkYCB0ZXN0IGJlbG93IHRocm93cyBmYWxzZSBwb3NpdGl2ZXMgaW4gQW5kcm9pZDoKCQlyZXQgPSAkLm1vYmlsZS5tZWRpYSggIigtIiArIHZlbmRvcnMuam9pbiggIi0iICsgbXFQcm9wICsgIiksKC0iICkgKyAiLSIgKyBtcVByb3AgKyAiKSwoIiArIG1xUHJvcCArICIpIiApLAoJCWVsLCB0cmFuc2Zvcm1zLCB0OwoKCWlmICggcmV0ICkgewoJCXJldHVybiAhIXJldDsKCX0KCgllbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7Cgl0cmFuc2Zvcm1zID0gewoJCS8vIFdl4oCZcmUgb21pdHRpbmcgT3BlcmEgZm9yIHRoZSB0aW1lIGJlaW5nOyBNUyB1c2VzIHVucHJlZml4ZWQuCgkJIk1velRyYW5zZm9ybSI6ICItbW96LXRyYW5zZm9ybSIsCgkJInRyYW5zZm9ybSI6ICJ0cmFuc2Zvcm0iCgl9OwoKCWZha2VCb2R5LmFwcGVuZCggZWwgKTsKCglmb3IgKCB0IGluIHRyYW5zZm9ybXMgKSB7CgkJaWYgKCBlbC5zdHlsZVsgdCBdICE9PSB1bmRlZmluZWQgKSB7CgkJCWVsLnN0eWxlWyB0IF0gPSAidHJhbnNsYXRlM2QoIDEwMHB4LCAxcHgsIDFweCApIjsKCQkJcmV0ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGVsICkuZ2V0UHJvcGVydHlWYWx1ZSggdHJhbnNmb3Jtc1sgdCBdICk7CgkJfQoJfQoJcmV0dXJuICggISFyZXQgJiYgcmV0ICE9PSAibm9uZSIgKTsKfQoKLy8gVGVzdCBmb3IgZHluYW1pYy11cGRhdGluZyBiYXNlIHRhZyBzdXBwb3J0ICggYWxsb3dzIHVzIHRvIGF2b2lkIGhyZWYsc3JjIGF0dHIgcmV3cml0aW5nICkKZnVuY3Rpb24gYmFzZVRhZ1Rlc3QoKSB7Cgl2YXIgZmF1eEJhc2UgPSBsb2NhdGlvbi5wcm90b2NvbCArICIvLyIgKyBsb2NhdGlvbi5ob3N0ICsgbG9jYXRpb24ucGF0aG5hbWUgKyAidWktZGlyLyIsCgkJYmFzZSA9ICQoICJoZWFkIGJhc2UiICksCgkJZmF1eEVsZSA9IG51bGwsCgkJaHJlZiA9ICIiLAoJCWxpbmssIHJlYmFzZTsKCglpZiAoICFiYXNlLmxlbmd0aCApIHsKCQliYXNlID0gZmF1eEVsZSA9ICQoICI8YmFzZT4iLCB7ICJocmVmIjogZmF1eEJhc2UgfSkuYXBwZW5kVG8oICJoZWFkIiApOwoJfSBlbHNlIHsKCQlocmVmID0gYmFzZS5hdHRyKCAiaHJlZiIgKTsKCX0KCglsaW5rID0gJCggIjxhIGhyZWY9J3Rlc3R1cmwnIC8+IiApLnByZXBlbmRUbyggZmFrZUJvZHkgKTsKCXJlYmFzZSA9IGxpbmtbIDAgXS5ocmVmOwoJYmFzZVsgMCBdLmhyZWYgPSBocmVmIHx8IGxvY2F0aW9uLnBhdGhuYW1lOwoKCWlmICggZmF1eEVsZSApIHsKCQlmYXV4RWxlLnJlbW92ZSgpOwoJfQoJcmV0dXJuIHJlYmFzZS5pbmRleE9mKCBmYXV4QmFzZSApID09PSAwOwp9CgovLyBUaGFua3MgTW9kZXJuaXpyCmZ1bmN0aW9uIGNzc1BvaW50ZXJFdmVudHNUZXN0KCkgewoJdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAieCIgKSwKCQlkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsCgkJZ2V0Q29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlLAoJCXN1cHBvcnRzOwoKCWlmICggISggInBvaW50ZXJFdmVudHMiIGluIGVsZW1lbnQuc3R5bGUgKSApIHsKCQlyZXR1cm4gZmFsc2U7Cgl9CgoJZWxlbWVudC5zdHlsZS5wb2ludGVyRXZlbnRzID0gImF1dG8iOwoJZWxlbWVudC5zdHlsZS5wb2ludGVyRXZlbnRzID0gIngiOwoJZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKCBlbGVtZW50ICk7CglzdXBwb3J0cyA9IGdldENvbXB1dGVkU3R5bGUgJiYKCWdldENvbXB1dGVkU3R5bGUoIGVsZW1lbnQsICIiICkucG9pbnRlckV2ZW50cyA9PT0gImF1dG8iOwoJZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKCBlbGVtZW50ICk7CglyZXR1cm4gISFzdXBwb3J0czsKfQoKZnVuY3Rpb24gYm91bmRpbmdSZWN0KCkgewoJdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CglyZXR1cm4gdHlwZW9mIGRpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QgIT09ICJ1bmRlZmluZWQiOwp9CgovLyBub24tVUEtYmFzZWQgSUUgdmVyc2lvbiBjaGVjayBieSBKYW1lcyBQYWRvbHNleSwgbW9kaWZpZWQgYnkgamRhbHRvbiAtIGZyb20gaHR0cDovL2dpc3QuZ2l0aHViLmNvbS81Mjc2ODMKLy8gYWxsb3dzIGZvciBpbmNsdXNpb24gb2YgSUUgNissIGluY2x1ZGluZyBXaW5kb3dzIE1vYmlsZSA3CiQuZXh0ZW5kKCAkLm1vYmlsZSwgeyBicm93c2VyOiB7fSB9ICk7CiQubW9iaWxlLmJyb3dzZXIub2xkSUUgPSAoZnVuY3Rpb24oKSB7Cgl2YXIgdiA9IDMsCgkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSwKCQlhID0gZGl2LmFsbCB8fCBbXTsKCglkbyB7CgkJZGl2LmlubmVySFRNTCA9ICI8IS0tW2lmIGd0IElFICIgKyAoICsrdiApICsgIl0+PGJyPjwhW2VuZGlmXS0tPiI7Cgl9IHdoaWxlKCBhWzBdICk7CgoJcmV0dXJuIHYgPiA0ID8gdiA6ICF2Owp9KSgpOwoKZnVuY3Rpb24gZml4ZWRQb3NpdGlvbigpIHsKCXZhciB3ID0gd2luZG93LAoJCXVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudCwKCQlwbGF0Zm9ybSA9IG5hdmlnYXRvci5wbGF0Zm9ybSwKCQkvLyBSZW5kZXJpbmcgZW5naW5lIGlzIFdlYmtpdCwgYW5kIGNhcHR1cmUgbWFqb3IgdmVyc2lvbgoJCXdrbWF0Y2ggPSB1YS5tYXRjaCggL0FwcGxlV2ViS2l0XC8oWzAtOV0rKS8gKSwKCQl3a3ZlcnNpb24gPSAhIXdrbWF0Y2ggJiYgd2ttYXRjaFsgMSBdLAoJCWZmbWF0Y2ggPSB1YS5tYXRjaCggL0Zlbm5lY1wvKFswLTldKykvICksCgkJZmZ2ZXJzaW9uID0gISFmZm1hdGNoICYmIGZmbWF0Y2hbIDEgXSwKCQlvcGVyYW1tb2JpbGVtYXRjaCA9IHVhLm1hdGNoKCAvT3BlcmEgTW9iaVwvKFswLTldKykvICksCgkJb212ZXJzaW9uID0gISFvcGVyYW1tb2JpbGVtYXRjaCAmJiBvcGVyYW1tb2JpbGVtYXRjaFsgMSBdOwoKCWlmICgKCQkvLyBpT1MgNC4zIGFuZCBvbGRlciA6IFBsYXRmb3JtIGlzIGlQaG9uZS9QYWQvVG91Y2ggYW5kIFdlYmtpdCB2ZXJzaW9uIGlzIGxlc3MgdGhhbiA1MzQgKGlvczUpCgkJKCAoIHBsYXRmb3JtLmluZGV4T2YoICJpUGhvbmUiICkgPiAtMSB8fCBwbGF0Zm9ybS5pbmRleE9mKCAiaVBhZCIgKSA+IC0xICB8fCBwbGF0Zm9ybS5pbmRleE9mKCAiaVBvZCIgKSA+IC0xICkgJiYgd2t2ZXJzaW9uICYmIHdrdmVyc2lvbiA8IDUzNCApIHx8CgkJLy8gT3BlcmEgTWluaQoJCSggdy5vcGVyYW1pbmkgJiYgKHt9KS50b1N0cmluZy5jYWxsKCB3Lm9wZXJhbWluaSApID09PSAiW29iamVjdCBPcGVyYU1pbmldIiApIHx8CgkJKCBvcGVyYW1tb2JpbGVtYXRjaCAmJiBvbXZlcnNpb24gPCA3NDU4ICkJfHwKCQkvL0FuZHJvaWQgbHRlIDIuMTogUGxhdGZvcm0gaXMgQW5kcm9pZCBhbmQgV2Via2l0IHZlcnNpb24gaXMgbGVzcyB0aGFuIDUzMyAoQW5kcm9pZCAyLjIpCgkJKCB1YS5pbmRleE9mKCAiQW5kcm9pZCIgKSA+IC0xICYmIHdrdmVyc2lvbiAmJiB3a3ZlcnNpb24gPCA1MzMgKSB8fAoJCS8vIEZpcmVmb3ggTW9iaWxlIGJlZm9yZSA2LjAgLQoJCSggZmZ2ZXJzaW9uICYmIGZmdmVyc2lvbiA8IDYgKSB8fAoJCS8vIFdlYk9TIGxlc3MgdGhhbiAzCgkJKCAicGFsbUdldFJlc291cmNlIiBpbiB3aW5kb3cgJiYgd2t2ZXJzaW9uICYmIHdrdmVyc2lvbiA8IDUzNCApCXx8CgkJLy8gTWVlR28KCQkoIHVhLmluZGV4T2YoICJNZWVHbyIgKSA+IC0xICYmIHVhLmluZGV4T2YoICJOb2tpYUJyb3dzZXIvOC41LjAiICkgPiAtMSApICkgewoJCXJldHVybiBmYWxzZTsKCX0KCglyZXR1cm4gdHJ1ZTsKfQoKJC5leHRlbmQoICQuc3VwcG9ydCwgewoJLy8gTm90ZSwgQ2hyb21lIGZvciBpT1MgaGFzIGFuIGV4dHJlbWVseSBxdWlya3kgaW1wbGVtZW50YXRpb24gb2YgcG9wc3RhdGUuCgkvLyBXZSd2ZSBjaG9zZW4gdG8gdGFrZSB0aGUgc2hvcnRlc3QgcGF0aCB0byBhIGJ1ZyBmaXggaGVyZSBmb3IgaXNzdWUgIzU0MjYKCS8vIFNlZSB0aGUgZm9sbG93aW5nIGxpbmsgZm9yIGluZm9ybWF0aW9uIGFib3V0IHRoZSByZWdleCBjaG9zZW4KCS8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL2Nocm9tZS9tb2JpbGUvZG9jcy91c2VyLWFnZW50I2Nocm9tZV9mb3JfaW9zX3VzZXItYWdlbnQKCXB1c2hTdGF0ZTogInB1c2hTdGF0ZSIgaW4gaGlzdG9yeSAmJgoJCSJyZXBsYWNlU3RhdGUiIGluIGhpc3RvcnkgJiYKCQkvLyBXaGVuIHJ1bm5pbmcgaW5zaWRlIGEgRkYgaWZyYW1lLCBjYWxsaW5nIHJlcGxhY2VTdGF0ZSBjYXVzZXMgYW4gZXJyb3IKCQkhKCB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCAiRmlyZWZveCIgKSA+PSAwICYmIHdpbmRvdy50b3AgIT09IHdpbmRvdyApICYmCgkJKCB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goL0NyaU9TLykgPT09IC0xICksCgoJbWVkaWFxdWVyeTogJC5tb2JpbGUubWVkaWEoICJvbmx5IGFsbCIgKSwKCWNzc1BzZXVkb0VsZW1lbnQ6ICEhcHJvcEV4aXN0cyggImNvbnRlbnQiICksCgl0b3VjaE92ZXJmbG93OiAhIXByb3BFeGlzdHMoICJvdmVyZmxvd1Njcm9sbGluZyIgKSwKCWNzc1RyYW5zZm9ybTNkOiB0cmFuc2Zvcm0zZFRlc3QoKSwKCWJveFNoYWRvdzogISFwcm9wRXhpc3RzKCAiYm94U2hhZG93IiApICYmICFiYiwKCWZpeGVkUG9zaXRpb246IGZpeGVkUG9zaXRpb24oKSwKCXNjcm9sbFRvcDogKCJwYWdlWE9mZnNldCIgaW4gd2luZG93IHx8CgkJInNjcm9sbFRvcCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IHx8CgkJInNjcm9sbFRvcCIgaW4gZmFrZUJvZHlbIDAgXSkgJiYgIXdlYm9zICYmICFvcGVyYW1pbmksCgoJZHluYW1pY0Jhc2VUYWc6IGJhc2VUYWdUZXN0KCksCgljc3NQb2ludGVyRXZlbnRzOiBjc3NQb2ludGVyRXZlbnRzVGVzdCgpLAoJYm91bmRpbmdSZWN0OiBib3VuZGluZ1JlY3QoKSwKCWlubGluZVNWRzogaW5saW5lU1ZHCn0pOwoKZmFrZUJvZHkucmVtb3ZlKCk7CgovLyAkLm1vYmlsZS5hamF4QmxhY2tsaXN0IGlzIHVzZWQgdG8gb3ZlcnJpZGUgYWpheEVuYWJsZWQgb24gcGxhdGZvcm1zIHRoYXQgaGF2ZSBrbm93biBjb25mbGljdHMgd2l0aCBoYXNoIGhpc3RvcnkgdXBkYXRlcyAoQkI1LCBTeW1iaWFuKQovLyBvciB0aGF0IGdlbmVyYWxseSB3b3JrIGJldHRlciBicm93c2luZyBpbiByZWd1bGFyIGh0dHAgZm9yIGZ1bGwgcGFnZSByZWZyZXNoZXMgKE9wZXJhIE1pbmkpCi8vIE5vdGU6IFRoaXMgZGV0ZWN0aW9uIGJlbG93IGlzIHVzZWQgYXMgYSBsYXN0IHJlc29ydC4KLy8gV2UgcmVjb21tZW5kIG9ubHkgdXNpbmcgdGhlc2UgZGV0ZWN0aW9uIG1ldGhvZHMgd2hlbiBhbGwgb3RoZXIgbW9yZSByZWxpYWJsZS9mb3J3YXJkLWxvb2tpbmcgYXBwcm9hY2hlcyBhcmUgbm90IHBvc3NpYmxlCm5va2lhTFRFN18zID0gKGZ1bmN0aW9uKCkgewoKCXZhciB1YSA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50OwoKCS8vVGhlIGZvbGxvd2luZyBpcyBhbiBhdHRlbXB0IHRvIG1hdGNoIE5va2lhIGJyb3dzZXJzIHRoYXQgYXJlIHJ1bm5pbmcgU3ltYmlhbi9zNjAsIHdpdGggd2Via2l0LCB2ZXJzaW9uIDcuMyBvciBvbGRlcgoJcmV0dXJuIHVhLmluZGV4T2YoICJOb2tpYSIgKSA+IC0xICYmCgkJCSggdWEuaW5kZXhPZiggIlN5bWJpYW4vMyIgKSA+IC0xIHx8IHVhLmluZGV4T2YoICJTZXJpZXM2MC81IiApID4gLTEgKSAmJgoJCQl1YS5pbmRleE9mKCAiQXBwbGVXZWJLaXQiICkgPiAtMSAmJgoJCQl1YS5tYXRjaCggLyhCcm93c2VyTkd8Tm9raWFCcm93c2VyKVwvN1wuWzAtM10vICk7Cn0pKCk7CgovLyBTdXBwb3J0IGNvbmRpdGlvbnMgdGhhdCBtdXN0IGJlIG1ldCBpbiBvcmRlciB0byBwcm9jZWVkCi8vIGRlZmF1bHQgZW5oYW5jZWQgcXVhbGlmaWNhdGlvbnMgYXJlIG1lZGlhIHF1ZXJ5IHN1cHBvcnQgT1IgSUUgNysKCiQubW9iaWxlLmdyYWRlQSA9IGZ1bmN0aW9uKCkgewoJcmV0dXJuICggKCAkLnN1cHBvcnQubWVkaWFxdWVyeSAmJiAkLnN1cHBvcnQuY3NzUHNldWRvRWxlbWVudCApIHx8ICQubW9iaWxlLmJyb3dzZXIub2xkSUUgJiYgJC5tb2JpbGUuYnJvd3Nlci5vbGRJRSA+PSA4ICkgJiYgKCAkLnN1cHBvcnQuYm91bmRpbmdSZWN0IHx8ICQuZm4uanF1ZXJ5Lm1hdGNoKC8xXC5bMC03K11cLlswLTkrXT8vKSAhPT0gbnVsbCApOwp9OwoKJC5tb2JpbGUuYWpheEJsYWNrbGlzdCA9CgkJCS8vIEJsYWNrQmVycnkgYnJvd3NlcnMsIHByZS13ZWJraXQKCQkJd2luZG93LmJsYWNrYmVycnkgJiYgIXdpbmRvdy5XZWJLaXRQb2ludCB8fAoJCQkvLyBPcGVyYSBNaW5pCgkJCW9wZXJhbWluaSB8fAoJCQkvLyBTeW1iaWFuIHdlYmtpdHMgcHJlIDcuMwoJCQlub2tpYUxURTdfMzsKCi8vIExhc3RseSwgdGhpcyB3b3JrYXJvdW5kIGlzIHRoZSBvbmx5IHdheSB3ZSd2ZSBmb3VuZCBzbyBmYXIgdG8gZ2V0IHByZSA3LjMgU3ltYmlhbiB3ZWJraXQgZGV2aWNlcwovLyB0byByZW5kZXIgdGhlIHN0eWxlc2hlZXRzIHdoZW4gdGhleSdyZSByZWZlcmVuY2VkIGJlZm9yZSB0aGlzIHNjcmlwdCwgYXMgd2UnZCByZWNvbW1lbmQgZG9pbmcuCi8vIFRoaXMgc2ltcGx5IHJlYXBwZW5kcyB0aGUgQ1NTIGluIHBsYWNlLCB3aGljaCBmb3Igc29tZSByZWFzb24gbWFrZXMgaXQgYXBwbHkKaWYgKCBub2tpYUxURTdfMyApIHsKCSQoZnVuY3Rpb24oKSB7CgkJJCggImhlYWQgbGlua1tyZWw9J3N0eWxlc2hlZXQnXSIgKS5hdHRyKCAicmVsIiwgImFsdGVybmF0ZSBzdHlsZXNoZWV0IiApLmF0dHIoICJyZWwiLCAic3R5bGVzaGVldCIgKTsKCX0pOwp9CgovLyBGb3IgcnVsaW5nIG91dCBzaGFkb3dzIHZpYSBjc3MKaWYgKCAhJC5zdXBwb3J0LmJveFNoYWRvdyApIHsKCSQoICJodG1sIiApLmFkZENsYXNzKCAidWktbm9ib3hzaGFkb3ciICk7Cn0KCn0pKCBqUXVlcnkgKTsKLy8+PmV4Y2x1ZGVTdGFydCgianFtQnVpbGRFeGNsdWRlIiwgcHJhZ21hcy5qcW1CdWlsZEV4Y2x1ZGUpOwp9KTsKLy8+PmV4Y2x1ZGVFbmQoImpxbUJ1aWxkRXhjbHVkZSIpOwo=",
                "body": "Ly8+PmV4Y2x1ZGVTdGFydCgianFtQnVpbGRFeGNsdWRlIiwgcHJhZ21hcy5qcW1CdWlsZEV4Y2x1ZGUpOwovLz4+ZGVzY3JpcHRpb246IEFzc29ydGVkIHRlc3RzIHRvIHF1YWxpZnkgYnJvd3NlcnMgYnkgZGV0ZWN0aW5nIGZlYXR1cmVzCi8vPj5sYWJlbDogU3VwcG9ydCBUZXN0cwovLz4+Z3JvdXA6IENvcmUKZGVmaW5lKCBbICAianF1ZXJ5IiwgIi4vanF1ZXJ5Lm1vYmlsZS5jb3JlIiwgIi4vanF1ZXJ5Lm1vYmlsZS5tZWRpYSIsICIuL2pxdWVyeS5tb2JpbGUuc3VwcG9ydC50b3VjaCIsICIuL2pxdWVyeS5tb2JpbGUuc3VwcG9ydC5vcmllbnRhdGlvbiIgXSwgZnVuY3Rpb24oIGpRdWVyeSApIHsKLy8+PmV4Y2x1ZGVFbmQoImpxbUJ1aWxkRXhjbHVkZSIpOwooZnVuY3Rpb24oICQsIHVuZGVmaW5lZCApIHsKCi8vIHRoeCBNb2Rlcm5penIKZnVuY3Rpb24gcHJvcEV4aXN0cyggcHJvcCApIHsKCXZhciB1Y19wcm9wID0gcHJvcC5jaGFyQXQoIDAgKS50b1VwcGVyQ2FzZSgpICsgcHJvcC5zdWJzdHIoIDEgKSwKCQlwcm9wcyA9ICggcHJvcCArICIgIiArIHZlbmRvcnMuam9pbiggdWNfcHJvcCArICIgIiApICsgdWNfcHJvcCApLnNwbGl0KCAiICIgKSwKCQl2OwoKCWZvciAoIHYgaW4gcHJvcHMgKSB7CgkJaWYgKCBmYkNTU1sgcHJvcHNbIHYgXSBdICE9PSB1bmRlZmluZWQgKSB7CgkJCXJldHVybiB0cnVlOwoJCX0KCX0KfQoKdmFyIGZha2VCb2R5ID0gJCggIjxib2R5PiIgKS5wcmVwZW5kVG8oICJodG1sIiApLAoJZmJDU1MgPSBmYWtlQm9keVsgMCBdLnN0eWxlLAoJdmVuZG9ycyA9IFsgIldlYmtpdCIsICJNb3oiLCAiTyIgXSwKCXdlYm9zID0gInBhbG1HZXRSZXNvdXJjZSIgaW4gd2luZG93LCAvL29ubHkgdXNlZCB0byBydWxlIG91dCBzY3JvbGxUb3AKCW9wZXJhbWluaSA9IHdpbmRvdy5vcGVyYW1pbmkgJiYgKHt9KS50b1N0cmluZy5jYWxsKCB3aW5kb3cub3BlcmFtaW5pICkgPT09ICJbb2JqZWN0IE9wZXJhTWluaV0iLAoJYmIgPSB3aW5kb3cuYmxhY2tiZXJyeSAmJiAhcHJvcEV4aXN0cyggIi13ZWJraXQtdHJhbnNmb3JtIiApLCAvL29ubHkgdXNlZCB0byBydWxlIG91dCBib3ggc2hhZG93LCBhcyBpdCdzIGZpbGxlZCBvcGFxdWUgb24gQkIgNSBhbmQgbG93ZXIKCW5va2lhTFRFN18zOwoKLy8gaW5saW5lIFNWRyBzdXBwb3J0IHRlc3QKZnVuY3Rpb24gaW5saW5lU1ZHKCkgewoJLy8gVGhhbmtzIE1vZGVybml6ciAmIEVyaWsgRGFobHN0cm9tCgl2YXIgdyA9IHdpbmRvdywKCQlzdmcgPSAhIXcuZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TICYmICEhdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJzdmciICkuY3JlYXRlU1ZHUmVjdCAmJiAhKCB3Lm9wZXJhICYmIG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZiggIkNocm9tZSIgKSA9PT0gLTEgKSwKCQlzdXBwb3J0ID0gZnVuY3Rpb24oIGRhdGEgKSB7CgkJCWlmICggISggZGF0YSAmJiBzdmcgKSApIHsKCQkJCSQoICJodG1sIiApLmFkZENsYXNzKCAidWktbm9zdmciICk7CgkJCX0KCQl9LAoJCWltZyA9IG5ldyB3LkltYWdlKCk7CgoJaW1nLm9uZXJyb3IgPSBmdW5jdGlvbigpIHsKCQlzdXBwb3J0KCBmYWxzZSApOwoJfTsKCWltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKCQlzdXBwb3J0KCBpbWcud2lkdGggPT09IDEgJiYgaW1nLmhlaWdodCA9PT0gMSApOwoJfTsKCWltZy5zcmMgPSAiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoQVFBQkFJQUFBQUFBQVAvLy95d0FBQUFBQVFBQkFBQUNBVXdBT3c9PSI7Cn0KCmZ1bmN0aW9uIHRyYW5zZm9ybTNkVGVzdCgpIHsKCXZhciBtcVByb3AgPSAidHJhbnNmb3JtLTNkIiwKCQkvLyBCZWNhdXNlIHRoZSBgdHJhbnNsYXRlM2RgIHRlc3QgYmVsb3cgdGhyb3dzIGZhbHNlIHBvc2l0aXZlcyBpbiBBbmRyb2lkOgoJCXJldCA9ICQubW9iaWxlLm1lZGlhKCAiKC0iICsgdmVuZG9ycy5qb2luKCAiLSIgKyBtcVByb3AgKyAiKSwoLSIgKSArICItIiArIG1xUHJvcCArICIpLCgiICsgbXFQcm9wICsgIikiICksCgkJZWwsIHRyYW5zZm9ybXMsIHQ7CgoJaWYgKCByZXQgKSB7CgkJcmV0dXJuICEhcmV0OwoJfQoKCWVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCXRyYW5zZm9ybXMgPSB7CgkJLy8gV2XigJlyZSBvbWl0dGluZyBPcGVyYSBmb3IgdGhlIHRpbWUgYmVpbmc7IE1TIHVzZXMgdW5wcmVmaXhlZC4KCQkiTW96VHJhbnNmb3JtIjogIi1tb3otdHJhbnNmb3JtIiwKCQkidHJhbnNmb3JtIjogInRyYW5zZm9ybSIKCX07CgoJZmFrZUJvZHkuYXBwZW5kKCBlbCApOwoKCWZvciAoIHQgaW4gdHJhbnNmb3JtcyApIHsKCQlpZiAoIGVsLnN0eWxlWyB0IF0gIT09IHVuZGVmaW5lZCApIHsKCQkJZWwuc3R5bGVbIHQgXSA9ICJ0cmFuc2xhdGUzZCggMTAwcHgsIDFweCwgMXB4ICkiOwoJCQlyZXQgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggZWwgKS5nZXRQcm9wZXJ0eVZhbHVlKCB0cmFuc2Zvcm1zWyB0IF0gKTsKCQl9Cgl9CglyZXR1cm4gKCAhIXJldCAmJiByZXQgIT09ICJub25lIiApOwp9CgovLyBUZXN0IGZvciBkeW5hbWljLXVwZGF0aW5nIGJhc2UgdGFnIHN1cHBvcnQgKCBhbGxvd3MgdXMgdG8gYXZvaWQgaHJlZixzcmMgYXR0ciByZXdyaXRpbmcgKQpmdW5jdGlvbiBiYXNlVGFnVGVzdCgpIHsKCXZhciBmYXV4QmFzZSA9IGxvY2F0aW9uLnByb3RvY29sICsgIi8vIiArIGxvY2F0aW9uLmhvc3QgKyBsb2NhdGlvbi5wYXRobmFtZSArICJ1aS1kaXIvIiwKCQliYXNlID0gJCggImhlYWQgYmFzZSIgKSwKCQlmYXV4RWxlID0gbnVsbCwKCQlocmVmID0gIiIsCgkJbGluaywgcmViYXNlOwoKCWlmICggIWJhc2UubGVuZ3RoICkgewoJCWJhc2UgPSBmYXV4RWxlID0gJCggIjxiYXNlPiIsIHsgImhyZWYiOiBmYXV4QmFzZSB9KS5hcHBlbmRUbyggImhlYWQiICk7Cgl9IGVsc2UgewoJCWhyZWYgPSBiYXNlLmF0dHIoICJocmVmIiApOwoJfQoKCWxpbmsgPSAkKCAiPGEgaHJlZj0ndGVzdHVybCcgLz4iICkucHJlcGVuZFRvKCBmYWtlQm9keSApOwoJcmViYXNlID0gbGlua1sgMCBdLmhyZWY7CgliYXNlWyAwIF0uaHJlZiA9IGhyZWYgfHwgbG9jYXRpb24ucGF0aG5hbWU7CgoJaWYgKCBmYXV4RWxlICkgewoJCWZhdXhFbGUucmVtb3ZlKCk7Cgl9CglyZXR1cm4gcmViYXNlLmluZGV4T2YoIGZhdXhCYXNlICkgPT09IDA7Cn0KCi8vIFRoYW5rcyBNb2Rlcm5penIKZnVuY3Rpb24gY3NzUG9pbnRlckV2ZW50c1Rlc3QoKSB7Cgl2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJ4IiApLAoJCWRvY3VtZW50RWxlbWVudCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwKCQlnZXRDb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUsCgkJc3VwcG9ydHM7CgoJaWYgKCAhKCAicG9pbnRlckV2ZW50cyIgaW4gZWxlbWVudC5zdHlsZSApICkgewoJCXJldHVybiBmYWxzZTsKCX0KCgllbGVtZW50LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAiYXV0byI7CgllbGVtZW50LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAieCI7Cglkb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoIGVsZW1lbnQgKTsKCXN1cHBvcnRzID0gZ2V0Q29tcHV0ZWRTdHlsZSAmJgoJZ2V0Q29tcHV0ZWRTdHlsZSggZWxlbWVudCwgIiIgKS5wb2ludGVyRXZlbnRzID09PSAiYXV0byI7Cglkb2N1bWVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoIGVsZW1lbnQgKTsKCXJldHVybiAhIXN1cHBvcnRzOwp9CgpmdW5jdGlvbiBib3VuZGluZ1JlY3QoKSB7Cgl2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCXJldHVybiB0eXBlb2YgZGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCAhPT0gInVuZGVmaW5lZCI7Cn0KCi8vIG5vbi1VQS1iYXNlZCBJRSB2ZXJzaW9uIGNoZWNrIGJ5IEphbWVzIFBhZG9sc2V5LCBtb2RpZmllZCBieSBqZGFsdG9uIC0gZnJvbSBodHRwOi8vZ2lzdC5naXRodWIuY29tLzUyNzY4MwovLyBhbGxvd3MgZm9yIGluY2x1c2lvbiBvZiBJRSA2KywgaW5jbHVkaW5nIFdpbmRvd3MgTW9iaWxlIDcKJC5leHRlbmQoICQubW9iaWxlLCB7IGJyb3dzZXI6IHt9IH0gKTsKJC5tb2JpbGUuYnJvd3Nlci5vbGRJRSA9IChmdW5jdGlvbigpIHsKCXZhciB2ID0gMywKCQlkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApLAoJCWEgPSBkaXYuYWxsIHx8IFtdOwoKCWRvIHsKCQlkaXYuaW5uZXJIVE1MID0gIjwhLS1baWYgZ3QgSUUgIiArICggKyt2ICkgKyAiXT48YnI+PCFbZW5kaWZdLS0+IjsKCX0gd2hpbGUoIGFbMF0gKTsKCglyZXR1cm4gdiA+IDQgPyB2IDogIXY7Cn0pKCk7CgpmdW5jdGlvbiBmaXhlZFBvc2l0aW9uKCkgewoJdmFyIHcgPSB3aW5kb3csCgkJdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50LAoJCXBsYXRmb3JtID0gbmF2aWdhdG9yLnBsYXRmb3JtLAoJCS8vIFJlbmRlcmluZyBlbmdpbmUgaXMgV2Via2l0LCBhbmQgY2FwdHVyZSBtYWpvciB2ZXJzaW9uCgkJd2ttYXRjaCA9IHVhLm1hdGNoKCAvQXBwbGVXZWJLaXRcLyhbMC05XSspLyApLAoJCXdrdmVyc2lvbiA9ICEhd2ttYXRjaCAmJiB3a21hdGNoWyAxIF0sCgkJZmZtYXRjaCA9IHVhLm1hdGNoKCAvRmVubmVjXC8oWzAtOV0rKS8gKSwKCQlmZnZlcnNpb24gPSAhIWZmbWF0Y2ggJiYgZmZtYXRjaFsgMSBdLAoJCW9wZXJhbW1vYmlsZW1hdGNoID0gdWEubWF0Y2goIC9PcGVyYSBNb2JpXC8oWzAtOV0rKS8gKSwKCQlvbXZlcnNpb24gPSAhIW9wZXJhbW1vYmlsZW1hdGNoICYmIG9wZXJhbW1vYmlsZW1hdGNoWyAxIF07CgoJaWYgKAoJCS8vIGlPUyA0LjMgYW5kIG9sZGVyIDogUGxhdGZvcm0gaXMgaVBob25lL1BhZC9Ub3VjaCBhbmQgV2Via2l0IHZlcnNpb24gaXMgbGVzcyB0aGFuIDUzNCAoaW9zNSkKCQkoICggcGxhdGZvcm0uaW5kZXhPZiggImlQaG9uZSIgKSA+IC0xIHx8IHBsYXRmb3JtLmluZGV4T2YoICJpUGFkIiApID4gLTEgIHx8IHBsYXRmb3JtLmluZGV4T2YoICJpUG9kIiApID4gLTEgKSAmJiB3a3ZlcnNpb24gJiYgd2t2ZXJzaW9uIDwgNTM0ICkgfHwKCQkvLyBPcGVyYSBNaW5pCgkJKCB3Lm9wZXJhbWluaSAmJiAoe30pLnRvU3RyaW5nLmNhbGwoIHcub3BlcmFtaW5pICkgPT09ICJbb2JqZWN0IE9wZXJhTWluaV0iICkgfHwKCQkoIG9wZXJhbW1vYmlsZW1hdGNoICYmIG9tdmVyc2lvbiA8IDc0NTggKQl8fAoJCS8vQW5kcm9pZCBsdGUgMi4xOiBQbGF0Zm9ybSBpcyBBbmRyb2lkIGFuZCBXZWJraXQgdmVyc2lvbiBpcyBsZXNzIHRoYW4gNTMzIChBbmRyb2lkIDIuMikKCQkoIHVhLmluZGV4T2YoICJBbmRyb2lkIiApID4gLTEgJiYgd2t2ZXJzaW9uICYmIHdrdmVyc2lvbiA8IDUzMyApIHx8CgkJLy8gRmlyZWZveCBNb2JpbGUgYmVmb3JlIDYuMCAtCgkJKCBmZnZlcnNpb24gJiYgZmZ2ZXJzaW9uIDwgNiApIHx8CgkJLy8gV2ViT1MgbGVzcyB0aGFuIDMKCQkoICJwYWxtR2V0UmVzb3VyY2UiIGluIHdpbmRvdyAmJiB3a3ZlcnNpb24gJiYgd2t2ZXJzaW9uIDwgNTM0ICkJfHwKCQkvLyBNZWVHbwoJCSggdWEuaW5kZXhPZiggIk1lZUdvIiApID4gLTEgJiYgdWEuaW5kZXhPZiggIk5va2lhQnJvd3Nlci84LjUuMCIgKSA+IC0xICkgKSB7CgkJcmV0dXJuIGZhbHNlOwoJfQoKCXJldHVybiB0cnVlOwp9CgokLmV4dGVuZCggJC5zdXBwb3J0LCB7CgkvLyBOb3RlLCBDaHJvbWUgZm9yIGlPUyBoYXMgYW4gZXh0cmVtZWx5IHF1aXJreSBpbXBsZW1lbnRhdGlvbiBvZiBwb3BzdGF0ZS4KCS8vIFdlJ3ZlIGNob3NlbiB0byB0YWtlIHRoZSBzaG9ydGVzdCBwYXRoIHRvIGEgYnVnIGZpeCBoZXJlIGZvciBpc3N1ZSAjNTQyNgoJLy8gU2VlIHRoZSBmb2xsb3dpbmcgbGluayBmb3IgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHJlZ2V4IGNob3NlbgoJLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vY2hyb21lL21vYmlsZS9kb2NzL3VzZXItYWdlbnQjY2hyb21lX2Zvcl9pb3NfdXNlci1hZ2VudAoJcHVzaFN0YXRlOiAicHVzaFN0YXRlIiBpbiBoaXN0b3J5ICYmCgkJInJlcGxhY2VTdGF0ZSIgaW4gaGlzdG9yeSAmJgoJCS8vIFdoZW4gcnVubmluZyBpbnNpZGUgYSBGRiBpZnJhbWUsIGNhbGxpbmcgcmVwbGFjZVN0YXRlIGNhdXNlcyBhbiBlcnJvcgoJCSEoIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoICJGaXJlZm94IiApID49IDAgJiYgd2luZG93LnRvcCAhPT0gd2luZG93ICkgJiYKCQkoIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnNlYXJjaCgvQ3JpT1MvKSA9PT0gLTEgKSwKCgltZWRpYXF1ZXJ5OiAkLm1vYmlsZS5tZWRpYSggIm9ubHkgYWxsIiApLAoJY3NzUHNldWRvRWxlbWVudDogISFwcm9wRXhpc3RzKCAiY29udGVudCIgKSwKCXRvdWNoT3ZlcmZsb3c6ICEhcHJvcEV4aXN0cyggIm92ZXJmbG93U2Nyb2xsaW5nIiApLAoJY3NzVHJhbnNmb3JtM2Q6IHRyYW5zZm9ybTNkVGVzdCgpLAoJYm94U2hhZG93OiAhIXByb3BFeGlzdHMoICJib3hTaGFkb3ciICkgJiYgIWJiLAoJZml4ZWRQb3NpdGlvbjogZml4ZWRQb3NpdGlvbigpLAoJc2Nyb2xsVG9wOiAoInBhZ2VYT2Zmc2V0IiBpbiB3aW5kb3cgfHwKCQkic2Nyb2xsVG9wIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgfHwKCQkic2Nyb2xsVG9wIiBpbiBmYWtlQm9keVsgMCBdKSAmJiAhd2Vib3MgJiYgIW9wZXJhbWluaSwKCglkeW5hbWljQmFzZVRhZzogYmFzZVRhZ1Rlc3QoKSwKCWNzc1BvaW50ZXJFdmVudHM6IGNzc1BvaW50ZXJFdmVudHNUZXN0KCksCglib3VuZGluZ1JlY3Q6IGJvdW5kaW5nUmVjdCgpLAoJaW5saW5lU1ZHOiBpbmxpbmVTVkcKfSk7CgpmYWtlQm9keS5yZW1vdmUoKTsKCi8vICQubW9iaWxlLmFqYXhCbGFja2xpc3QgaXMgdXNlZCB0byBvdmVycmlkZSBhamF4RW5hYmxlZCBvbiBwbGF0Zm9ybXMgdGhhdCBoYXZlIGtub3duIGNvbmZsaWN0cyB3aXRoIGhhc2ggaGlzdG9yeSB1cGRhdGVzIChCQjUsIFN5bWJpYW4pCi8vIG9yIHRoYXQgZ2VuZXJhbGx5IHdvcmsgYmV0dGVyIGJyb3dzaW5nIGluIHJlZ3VsYXIgaHR0cCBmb3IgZnVsbCBwYWdlIHJlZnJlc2hlcyAoT3BlcmEgTWluaSkKLy8gTm90ZTogVGhpcyBkZXRlY3Rpb24gYmVsb3cgaXMgdXNlZCBhcyBhIGxhc3QgcmVzb3J0LgovLyBXZSByZWNvbW1lbmQgb25seSB1c2luZyB0aGVzZSBkZXRlY3Rpb24gbWV0aG9kcyB3aGVuIGFsbCBvdGhlciBtb3JlIHJlbGlhYmxlL2ZvcndhcmQtbG9va2luZyBhcHByb2FjaGVzIGFyZSBub3QgcG9zc2libGUKbm9raWFMVEU3XzMgPSAoZnVuY3Rpb24oKSB7CgoJdmFyIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ7CgoJLy9UaGUgZm9sbG93aW5nIGlzIGFuIGF0dGVtcHQgdG8gbWF0Y2ggTm9raWEgYnJvd3NlcnMgdGhhdCBhcmUgcnVubmluZyBTeW1iaWFuL3M2MCwgd2l0aCB3ZWJraXQsIHZlcnNpb24gNy4zIG9yIG9sZGVyCglyZXR1cm4gdWEuaW5kZXhPZiggIk5va2lhIiApID4gLTEgJiYKCQkJKCB1YS5pbmRleE9mKCAiU3ltYmlhbi8zIiApID4gLTEgfHwgdWEuaW5kZXhPZiggIlNlcmllczYwLzUiICkgPiAtMSApICYmCgkJCXVhLmluZGV4T2YoICJBcHBsZVdlYktpdCIgKSA+IC0xICYmCgkJCXVhLm1hdGNoKCAvKEJyb3dzZXJOR3xOb2tpYUJyb3dzZXIpXC83XC5bMC0zXS8gKTsKfSkoKTsKCi8vIFN1cHBvcnQgY29uZGl0aW9ucyB0aGF0IG11c3QgYmUgbWV0IGluIG9yZGVyIHRvIHByb2NlZWQKLy8gZGVmYXVsdCBlbmhhbmNlZCBxdWFsaWZpY2F0aW9ucyBhcmUgbWVkaWEgcXVlcnkgc3VwcG9ydCBPUiBJRSA3KwoKJC5tb2JpbGUuZ3JhZGVBID0gZnVuY3Rpb24oKSB7CglyZXR1cm4gKCAoICQuc3VwcG9ydC5tZWRpYXF1ZXJ5ICYmICQuc3VwcG9ydC5jc3NQc2V1ZG9FbGVtZW50ICkgfHwgJC5tb2JpbGUuYnJvd3Nlci5vbGRJRSAmJiAkLm1vYmlsZS5icm93c2VyLm9sZElFID49IDggKSAmJiAoICQuc3VwcG9ydC5ib3VuZGluZ1JlY3QgfHwgJC5mbi5qcXVlcnkubWF0Y2goLzFcLlswLTcrXVwuWzAtOStdPy8pICE9PSBudWxsICk7Cn07CgokLm1vYmlsZS5hamF4QmxhY2tsaXN0ID0KCQkJLy8gQmxhY2tCZXJyeSBicm93c2VycywgcHJlLXdlYmtpdAoJCQl3aW5kb3cuYmxhY2tiZXJyeSAmJiAhd2luZG93LldlYktpdFBvaW50IHx8CgkJCS8vIE9wZXJhIE1pbmkKCQkJb3BlcmFtaW5pIHx8CgkJCS8vIFN5bWJpYW4gd2Via2l0cyBwcmUgNy4zCgkJCW5va2lhTFRFN18zOwoKLy8gTGFzdGx5LCB0aGlzIHdvcmthcm91bmQgaXMgdGhlIG9ubHkgd2F5IHdlJ3ZlIGZvdW5kIHNvIGZhciB0byBnZXQgcHJlIDcuMyBTeW1iaWFuIHdlYmtpdCBkZXZpY2VzCi8vIHRvIHJlbmRlciB0aGUgc3R5bGVzaGVldHMgd2hlbiB0aGV5J3JlIHJlZmVyZW5jZWQgYmVmb3JlIHRoaXMgc2NyaXB0LCBhcyB3ZSdkIHJlY29tbWVuZCBkb2luZy4KLy8gVGhpcyBzaW1wbHkgcmVhcHBlbmRzIHRoZSBDU1MgaW4gcGxhY2UsIHdoaWNoIGZvciBzb21lIHJlYXNvbiBtYWtlcyBpdCBhcHBseQppZiAoIG5va2lhTFRFN18zICkgewoJJChmdW5jdGlvbigpIHsKCQkkKCAiaGVhZCBsaW5rW3JlbD0nc3R5bGVzaGVldCddIiApLmF0dHIoICJyZWwiLCAiYWx0ZXJuYXRlIHN0eWxlc2hlZXQiICkuYXR0ciggInJlbCIsICJzdHlsZXNoZWV0IiApOwoJfSk7Cn0KCi8vIEZvciBydWxpbmcgb3V0IHNoYWRvd3MgdmlhIGNzcwppZiAoICEkLnN1cHBvcnQuYm94U2hhZG93ICkgewoJJCggImh0bWwiICkuYWRkQ2xhc3MoICJ1aS1ub2JveHNoYWRvdyIgKTsKfQoKfSkoIGpRdWVyeSApOwovLz4+ZXhjbHVkZVN0YXJ0KCJqcW1CdWlsZEV4Y2x1ZGUiLCBwcmFnbWFzLmpxbUJ1aWxkRXhjbHVkZSk7Cn0pOwovLz4+ZXhjbHVkZUVuZCgianFtQnVpbGRFeGNsdWRlIik7Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 06:47:29 GMT",
                    "Content-Length": "8824",
                    "Date": "Fri, 07 Nov 2014 06:47:31 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}