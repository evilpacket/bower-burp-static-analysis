{
    "url": "http://localhost:9999/andrzejdus/parallaxer.js/custom_components/closure-library-20130212-95c19e7f0f5f/closure/goog/testing/testrunner.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>window.location.search</b> and written to <b>the 'href' property of a DOM element</b> via the following statements:<ul><li>var search = window.location.search;</li><li>newSearch = search + '&amp;' + newSearch;</li><li>newSearch= search.substr(0 , oldTests.index) + newSearch+ search.substr(oldTests.index+ oldTests[0 ] .length);</li><li>href = href.split('#')[0].split('?')[0] + newSearch + hash;</li><li>a.href = href;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/andrzejdus/parallaxer.js/custom_components/closure-library-20130212-95c19e7f0f5f/closure/goog/testing/testrunner.js",
                "path": "/andrzejdus/parallaxer.js/custom_components/closure-library-20130212-95c19e7f0f5f/closure/goog/testing/testrunner.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9hbmRyemVqZHVzL3BhcmFsbGF4ZXIuanMvY3VzdG9tX2NvbXBvbmVudHMvY2xvc3VyZS1saWJyYXJ5LTIwMTMwMjEyLTk1YzE5ZTdmMGY1Zi9jbG9zdXJlL2dvb2cvdGVzdGluZy90ZXN0cnVubmVyLmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTE0OTQNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkRhdGU6IEZyaSwgMDcgTm92IDIwMTQgMjE6Mzk6MTIgR01UDQpMYXN0LU1vZGlmaWVkOiBGcmksIDA3IE5vdiAyMDE0IDIxOjM5OjA4IEdNVA0KDQovLyBDb3B5cmlnaHQgMjAwNyBUaGUgQ2xvc3VyZSBMaWJyYXJ5IEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi8vCi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwovLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAovLwovLyAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAovLwovLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUy1JUyIgQkFTSVMsCi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgovLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgVGhlIHRlc3QgcnVubmVyIGlzIGEgc2luZ2xldG9uIG9iamVjdCB0aGF0IGlzIHVzZWQgdG8gZXhlY3V0ZQogKiBhIGdvb2cudGVzdGluZy5UZXN0Q2FzZXMsIGRpc3BsYXkgdGhlIHJlc3VsdHMsIGFuZCBleHBvc2UgdGhlIHJlc3VsdHMgdG8KICogU2VsZW5pdW0gZm9yIGF1dG9tYXRpb24uICBJZiBhIFRlc3RDYXNlIGhhc24ndCBiZWVuIHJlZ2lzdGVyZWQgd2l0aCB0aGUKICogcnVubmVyIGJ5IHRoZSB0aW1lIHdpbmRvdy5vbmxvYWQgb2NjdXJzLCB0aGUgdGVzdFJ1bm5lciB3aWxsIHRyeSB0byBhdXRvLQogKiBkaXNjb3ZlciBKc1VuaXQgc3R5bGUgdGVzdCBwYWdlcy4KICoKICogVGhlIGhvb2tzIGZvciBzZWxlbml1bSBhcmUgOi0KICogIC0gQm9vbGVhbiBHX3Rlc3RSdW5uZXIuaXNGaW5pc2hlZCgpCiAqICAtIEJvb2xlYW4gR190ZXN0UnVubmVyLmlzU3VjY2VzcygpCiAqICAtIFN0cmluZyBHX3Rlc3RSdW5uZXIuZ2V0UmVwb3J0KCkKICogIC0gbnVtYmVyIEdfdGVzdFJ1bm5lci5nZXRSdW5UaW1lKCkKICoKICogVGVzdGluZyBjb2RlIHNob3VsZCBub3QgaGF2ZSBkZXBlbmRlbmNpZXMgb3V0c2lkZSBvZiBnb29nLnRlc3Rpbmcgc28gYXMgdG8KICogcmVkdWNlIHRoZSBjaGFuY2Ugb2YgbWFza2luZyBtaXNzaW5nIGRlcGVuZGVuY2llcy4KICoKICovCgpnb29nLnByb3ZpZGUoJ2dvb2cudGVzdGluZy5UZXN0UnVubmVyJyk7Cgpnb29nLnJlcXVpcmUoJ2dvb2cudGVzdGluZy5UZXN0Q2FzZScpOwoKCgovKioKICogQ29uc3RydWN0IGEgdGVzdCBydW5uZXIuCiAqCiAqIE5PVEUodXNlcik6IFRoaXMgaXMgY3VycmVudGx5IHByZXR0eSB3ZWlyZCwgSSdtIGVzc2VudGlhbGx5IHRyeWluZyB0bwogKiBjcmVhdGUgYSB3cmFwcGVyIHRoYXQgdGhlIFNlbGVuaXVtIHRlc3QgY2FuIGhvb2sgaW50byB0byBxdWVyeSB0aGUgc3RhdGUgb2YKICogdGhlIHJ1bm5pbmcgdGVzdCBjYXNlLCB3aGlsZSBtYWtpbmcgZ29vZy50ZXN0aW5nLlRlc3RDYXNlIGdlbmVyYWwuCiAqCiAqIEBjb25zdHJ1Y3RvcgogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIgPSBmdW5jdGlvbigpIHsKICAvKioKICAgKiBFcnJvcnMgdGhhdCBvY2N1cnJlZCBpbiB0aGUgd2luZG93LgogICAqIEB0eXBlIHtBcnJheS48c3RyaW5nPn0KICAgKi8KICB0aGlzLmVycm9ycyA9IFtdOwp9OwoKCi8qKgogKiBSZWZlcmVuY2UgdG8gdGhlIGFjdGl2ZSB0ZXN0IGNhc2UuCiAqIEB0eXBlIHtnb29nLnRlc3RpbmcuVGVzdENhc2U/fQogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLnRlc3RDYXNlID0gbnVsbDsKCgovKioKICogV2hldGhlciB0aGUgdGVzdCBydW5uZXIgaGFzIGJlZW4gaW5pdGlhbGl6ZWQgeWV0LgogKiBAdHlwZSB7Ym9vbGVhbn0KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5pbml0aWFsaXplZCA9IGZhbHNlOwoKCi8qKgogKiBFbGVtZW50IGNyZWF0ZWQgaW4gdGhlIGRvY3VtZW50IHRvIGFkZCB0ZXN0IHJlc3VsdHMgdG8uCiAqIEB0eXBlIHtFbGVtZW50fQogKiBAcHJpdmF0ZQogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLmxvZ0VsXyA9IG51bGw7CgoKLyoqCiAqIEZ1bmN0aW9uIHRvIHVzZSB3aGVuIGZpbHRlcmluZyBlcnJvcnMuCiAqIEB0eXBlIHsoZnVuY3Rpb24oc3RyaW5nKSk/fQogKiBAcHJpdmF0ZQogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLmVycm9yRmlsdGVyXyA9IG51bGw7CgoKLyoqCiAqIFdoZXRoZXIgYW4gZW1wdHkgdGVzdCBjYXNlIGNvdW50cyBhcyBhbiBlcnJvci4KICogQHR5cGUge2Jvb2xlYW59CiAqIEBwcml2YXRlCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuc3RyaWN0XyA9IHRydWU7CgoKLyoqCiAqIEluaXRpYWxpemVzIHRoZSB0ZXN0IHJ1bm5lci4KICogQHBhcmFtIHtnb29nLnRlc3RpbmcuVGVzdENhc2V9IHRlc3RDYXNlIFRoZSB0ZXN0IGNhc2UgdG8gaW5pdGlhbGl6ZSB3aXRoLgogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbih0ZXN0Q2FzZSkgewogIGlmICh0aGlzLnRlc3RDYXNlICYmIHRoaXMudGVzdENhc2UucnVubmluZykgewogICAgdGhyb3cgRXJyb3IoJ1RoZSB0ZXN0IHJ1bm5lciBpcyBhbHJlYWR5IHdhaXRpbmcgZm9yIGEgdGVzdCB0byBjb21wbGV0ZScpOwogIH0KICB0aGlzLnRlc3RDYXNlID0gdGVzdENhc2U7CiAgdGVzdENhc2Uuc2V0VGVzdFJ1bm5lcih0aGlzKTsKICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTsKfTsKCgovKioKICogQnkgZGVmYXVsdCwgdGhlIHRlc3QgcnVubmVyIGlzIHN0cmljdCwgYW5kIGZhaWxzIGlmIGl0IHJ1bnMgYW4gZW1wdHkKICogdGVzdCBjYXNlLgogKiBAcGFyYW0ge2Jvb2xlYW59IHN0cmljdCBXaGV0aGVyIHRoZSB0ZXN0IHJ1bm5lciBzaG91bGQgZmFpbCBvbiBhbiBlbXB0eQogKiAgICAgdGVzdCBjYXNlLgogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLnNldFN0cmljdCA9IGZ1bmN0aW9uKHN0cmljdCkgewogIHRoaXMuc3RyaWN0XyA9IHN0cmljdDsKfTsKCgovKioKICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGUgdGVzdCBydW5uZXIgc2hvdWxkIGZhaWwgb24gYW4gZW1wdHkKICogICAgIHRlc3QgY2FzZS4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5pc1N0cmljdCA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLnN0cmljdF87Cn07CgoKLyoqCiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdGVzdCBydW5uZXIgaXMgaW5pdGlhbGl6ZWQuCiAqIFVzZWQgYnkgU2VsZW5pdW0gSG9va3MuCiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHRlc3QgcnVubmVyIGlzIGFjdGl2ZS4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5pc0luaXRpYWxpemVkID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMuaW5pdGlhbGl6ZWQ7Cn07CgoKLyoqCiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdGVzdCBydW5uZXIgaXMgZmluaXNoZWQuCiAqIFVzZWQgYnkgU2VsZW5pdW0gSG9va3MuCiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHRlc3QgcnVubmVyIGlzIGFjdGl2ZS4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5pc0ZpbmlzaGVkID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMuZXJyb3JzLmxlbmd0aCA+IDAgfHwKICAgICAgdGhpcy5pbml0aWFsaXplZCAmJiAhIXRoaXMudGVzdENhc2UgJiYgdGhpcy50ZXN0Q2FzZS5zdGFydGVkICYmCiAgICAgICF0aGlzLnRlc3RDYXNlLnJ1bm5pbmc7Cn07CgoKLyoqCiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdGVzdCBjYXNlIGRpZG4ndCBmYWlsLgogKiBVc2VkIGJ5IFNlbGVuaXVtIEhvb2tzLgogKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSBjdXJyZW50IHRlc3QgcmV0dXJuZWQgc3VjY2Vzc2Z1bGx5LgogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLmlzU3VjY2VzcyA9IGZ1bmN0aW9uKCkgewogIHJldHVybiAhdGhpcy5oYXNFcnJvcnMoKSAmJiAhIXRoaXMudGVzdENhc2UgJiYgdGhpcy50ZXN0Q2FzZS5pc1N1Y2Nlc3MoKTsKfTsKCgovKioKICogUmV0dXJucyB0cnVlIGlmIHRoZSB0ZXN0IGNhc2UgcnVubmVyIGhhcyBlcnJvcnMgdGhhdCB3ZXJlIGNhdWdodCBvdXRzaWRlIG9mCiAqIHRoZSB0ZXN0IGNhc2UuCiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlcmUgd2VyZSBKUyBlcnJvcnMuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuaGFzRXJyb3JzID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMuZXJyb3JzLmxlbmd0aCA+IDA7Cn07CgoKLyoqCiAqIExvZ3MgYW4gZXJyb3IgdGhhdCBvY2N1cnJlZC4gIFVzZWQgaW4gdGhlIGNhc2Ugb2YgZW52aXJvbm1lbnQgc2V0dGluZyB1cAogKiBhbiBvbmVycm9yIGhhbmRsZXIuCiAqIEBwYXJhbSB7c3RyaW5nfSBtc2cgRXJyb3IgbWVzc2FnZS4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5sb2dFcnJvciA9IGZ1bmN0aW9uKG1zZykgewogIGlmICghdGhpcy5lcnJvckZpbHRlcl8gfHwgdGhpcy5lcnJvckZpbHRlcl8uY2FsbChudWxsLCBtc2cpKSB7CiAgICB0aGlzLmVycm9ycy5wdXNoKG1zZyk7CiAgfQp9OwoKCi8qKgogKiBMb2cgZmFpbHVyZSBpbiBjdXJyZW50IHJ1bm5pbmcgdGVzdC4KICogQHBhcmFtIHtFcnJvcn0gZXggRXhjZXB0aW9uLgogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLmxvZ1Rlc3RGYWlsdXJlID0gZnVuY3Rpb24oZXgpIHsKICB2YXIgdGVzdE5hbWUgPSAvKiogQHR5cGUge3N0cmluZ30gKi8gKGdvb2cudGVzdGluZy5UZXN0Q2FzZS5jdXJyZW50VGVzdE5hbWUpOwogIGlmICh0aGlzLnRlc3RDYXNlKSB7CiAgICB0aGlzLnRlc3RDYXNlLmxvZ0Vycm9yKHRlc3ROYW1lLCBleCk7CiAgfSBlbHNlIHsKICAgIC8vIE5PVEU6IERvIG5vdCBmb3JnZXQgdG8gbG9nIHRoZSBvcmlnaW5hbCBleGNlcHRpb24gcmFpc2VkLgogICAgdGhyb3cgbmV3IEVycm9yKCdUZXN0IHJ1bm5lciBub3QgaW5pdGlhbGl6ZWQgd2l0aCBhIHRlc3QgY2FzZS4gT3JpZ2luYWwgJyArCiAgICAgICAgICAgICAgICAgICAgJ2V4Y2VwdGlvbjogJyArIGV4Lm1lc3NhZ2UpOwogIH0KfTsKCgovKioKICogU2V0cyBhIGZ1bmN0aW9uIHRvIHVzZSBhcyBhIGZpbHRlciBmb3IgZXJyb3JzLgogKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZyl9IGZuIEZpbHRlciBmdW5jdGlvbi4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5zZXRFcnJvckZpbHRlciA9IGZ1bmN0aW9uKGZuKSB7CiAgdGhpcy5lcnJvckZpbHRlcl8gPSBmbjsKfTsKCgovKioKICogUmV0dXJucyBhIHJlcG9ydCBvZiB0aGUgdGVzdCBjYXNlIHRoYXQgcmFuLgogKiBVc2VkIGJ5IFNlbGVuaXVtIEhvb2tzLgogKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfdmVyYm9zZSBJZiB0cnVlIHJlc3VsdHMgd2lsbCBpbmNsdWRlIGRhdGEgYWJvdXQgYWxsCiAqICAgICB0ZXN0cywgbm90IGp1c3Qgd2hhdCBmYWlsZWQuCiAqIEByZXR1cm4ge3N0cmluZ30gQSByZXBvcnQgc3VtbWFyeSBvZiB0aGUgdGVzdC4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5nZXRSZXBvcnQgPSBmdW5jdGlvbihvcHRfdmVyYm9zZSkgewogIHZhciByZXBvcnQgPSBbXTsKICBpZiAodGhpcy50ZXN0Q2FzZSkgewogICAgcmVwb3J0LnB1c2godGhpcy50ZXN0Q2FzZS5nZXRSZXBvcnQob3B0X3ZlcmJvc2UpKTsKICB9CiAgaWYgKHRoaXMuZXJyb3JzLmxlbmd0aCA+IDApIHsKICAgIHJlcG9ydC5wdXNoKCdKYXZhU2NyaXB0IGVycm9ycyBkZXRlY3RlZCBieSB0ZXN0IHJ1bm5lcjonKTsKICAgIHJlcG9ydC5wdXNoLmFwcGx5KHJlcG9ydCwgdGhpcy5lcnJvcnMpOwogICAgcmVwb3J0LnB1c2goJ1xuJyk7CiAgfQogIHJldHVybiByZXBvcnQuam9pbignXG4nKTsKfTsKCgovKioKICogUmV0dXJucyB0aGUgYW1vdW50IG9mIHRpbWUgaXQgdG9vayBmb3IgdGhlIHRlc3QgdG8gcnVuLgogKiBVc2VkIGJ5IFNlbGVuaXVtIEhvb2tzLgogKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBydW4gdGltZSwgaW4gbWlsbGlzZWNvbmRzLgogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLmdldFJ1blRpbWUgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gdGhpcy50ZXN0Q2FzZSA/IHRoaXMudGVzdENhc2UuZ2V0UnVuVGltZSgpIDogMDsKfTsKCgovKioKICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHNjcmlwdCBmaWxlcyB0aGF0IHdlcmUgbG9hZGVkIGluIG9yZGVyIHRvIHJ1biB0aGUgdGVzdC4KICogQHJldHVybiB7bnVtYmVyfSBUaGUgbnVtYmVyIG9mIHNjcmlwdCBmaWxlcy4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5nZXROdW1GaWxlc0xvYWRlZCA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLnRlc3RDYXNlID8gdGhpcy50ZXN0Q2FzZS5nZXROdW1GaWxlc0xvYWRlZCgpIDogMDsKfTsKCgovKioKICogRXhlY3V0ZXMgYSB0ZXN0IGNhc2UgYW5kIHByaW50cyB0aGUgcmVzdWx0cyB0byB0aGUgd2luZG93LgogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLmV4ZWN1dGUgPSBmdW5jdGlvbigpIHsKICBpZiAoIXRoaXMudGVzdENhc2UpIHsKICAgIHRocm93IEVycm9yKCdUaGUgdGVzdCBydW5uZXIgbXVzdCBiZSBpbml0aWFsaXplZCB3aXRoIGEgdGVzdCBjYXNlIGJlZm9yZSAnICsKICAgICAgICAgICAgICAgICdleGVjdXRlIGNhbiBiZSBjYWxsZWQuJyk7CiAgfQogIHRoaXMudGVzdENhc2Uuc2V0Q29tcGxldGVkQ2FsbGJhY2soZ29vZy5iaW5kKHRoaXMub25Db21wbGV0ZV8sIHRoaXMpKTsKICB0aGlzLnRlc3RDYXNlLnJ1blRlc3RzKCk7Cn07CgoKLyoqCiAqIFdyaXRlcyB0aGUgcmVzdWx0cyB0byB0aGUgZG9jdW1lbnQgd2hlbiB0aGUgdGVzdCBjYXNlIGNvbXBsZXRlcy4KICogQHByaXZhdGUKICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlXyA9IGZ1bmN0aW9uKCkgewogIHZhciBsb2cgPSB0aGlzLnRlc3RDYXNlLmdldFJlcG9ydCh0cnVlKTsKICBpZiAodGhpcy5lcnJvcnMubGVuZ3RoID4gMCkgewogICAgbG9nICs9ICdcbicgKyB0aGlzLmVycm9ycy5qb2luKCdcbicpOwogIH0KCiAgaWYgKCF0aGlzLmxvZ0VsXykgewogICAgdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3N1cmVUZXN0UnVubmVyTG9nJyk7CiAgICBpZiAoZWwgPT0gbnVsbCkgewogICAgICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsKTsKICAgIH0KICAgIHRoaXMubG9nRWxfID0gZWw7CiAgfQoKICAvLyBSZW1vdmUgYWxsIGNoaWxkcmVuIGZyb20gdGhlIGxvZyBlbGVtZW50LgogIHZhciBsb2dFbCA9IHRoaXMubG9nRWxfOwogIHdoaWxlIChsb2dFbC5maXJzdENoaWxkKSB7CiAgICBsb2dFbC5yZW1vdmVDaGlsZChsb2dFbC5maXJzdENoaWxkKTsKICB9CgogIC8vIEhpZ2hsaWdodCB0aGUgcGFnZSB0byBpbmRpY2F0ZSB0aGUgb3ZlcmFsbCBvdXRjb21lLgogIHRoaXMud3JpdGVMb2cobG9nKTsKCiAgdmFyIHJ1bkFnYWluTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICBydW5BZ2Fpbkxpbmsuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgcnVuQWdhaW5MaW5rLnN0eWxlLmZvbnRTaXplID0gJ3NtYWxsJzsKICBydW5BZ2FpbkxpbmsuaHJlZiA9ICcnOwogIHJ1bkFnYWluTGluay5vbmNsaWNrID0gZ29vZy5iaW5kKGZ1bmN0aW9uKCkgewogICAgdGhpcy5leGVjdXRlKCk7CiAgICByZXR1cm4gZmFsc2U7CiAgfSwgdGhpcyk7CiAgcnVuQWdhaW5MaW5rLmlubmVySFRNTCA9ICdSdW4gYWdhaW4gd2l0aG91dCByZWxvYWRpbmcnOwogIGxvZ0VsLmFwcGVuZENoaWxkKHJ1bkFnYWluTGluayk7Cn07CgoKLyoqCiAqIFdyaXRlcyBhIG5pY2VseSBmb3JtYXR0ZWQgbG9nIG91dCB0byB0aGUgZG9jdW1lbnQuCiAqIEBwYXJhbSB7c3RyaW5nfSBsb2cgVGhlIHN0cmluZyB0byB3cml0ZS4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS53cml0ZUxvZyA9IGZ1bmN0aW9uKGxvZykgewogIHZhciBsaW5lcyA9IGxvZy5zcGxpdCgnXG4nKTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgbGluZSA9IGxpbmVzW2ldOwogICAgdmFyIGNvbG9yOwogICAgdmFyIGlzRmFpbE9yRXJyb3IgPSAvRkFJTEVELy50ZXN0KGxpbmUpIHx8IC9FUlJPUi8udGVzdChsaW5lKTsKICAgIGlmICgvUEFTU0VELy50ZXN0KGxpbmUpKSB7CiAgICAgIGNvbG9yID0gJ2RhcmtncmVlbic7CiAgICB9IGVsc2UgaWYgKGlzRmFpbE9yRXJyb3IpIHsKICAgICAgY29sb3IgPSAnZGFya3JlZCc7CiAgICB9IGVsc2UgewogICAgICBjb2xvciA9ICcjMzMzJzsKICAgIH0KICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIGlmIChsaW5lLnN1YnN0cigwLCAyKSA9PSAnPiAnKSB7CiAgICAgIC8vIFRoZSBzdGFjayB0cmFjZSBtYXkgY29udGFpbiBsaW5rcyBzbyBpdCBoYXMgdG8gYmUgaW50ZXJwcmV0ZWQgYXMgSFRNTC4KICAgICAgZGl2LmlubmVySFRNTCA9IGxpbmU7CiAgICB9IGVsc2UgewogICAgICBkaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobGluZSkpOwogICAgfQoKICAgIGlmIChpc0ZhaWxPckVycm9yKSB7CiAgICAgIHZhciB0ZXN0TmFtZU1hdGNoID0gLyhcUyspIChcW1teXF1dKl0gKT86IChGQUlMRUR8RVJST1IpLy5leGVjKGxpbmUpOwogICAgICBpZiAodGVzdE5hbWVNYXRjaCkgewogICAgICAgIC8vIEJ1aWxkIGEgVVJMIHRvIHJ1biB0aGUgdGVzdCBpbmRpdmlkdWFsbHkuICBJZiB0aGlzIHRlc3Qgd2FzIGFscmVhZHkKICAgICAgICAvLyBwYXJ0IG9mIGFub3RoZXIgc3Vic2V0IHRlc3QsIHdlIG5lZWQgdG8gb3ZlcndyaXRlIHRoZSBvbGQgcnVuVGVzdHMKICAgICAgICAvLyBxdWVyeSBwYXJhbWV0ZXIuICBXZSBhbHNvIG5lZWQgdG8gZG8gdGhpcyB3aXRob3V0IGJyaW5naW5nIGluIGFueQogICAgICAgIC8vIGV4dHJhIGRlcGVuZGVuY2llcywgb3RoZXJ3aXNlIHdlIGNvdWxkIG1hc2sgbWlzc2luZyBkZXBlbmRlbmN5IGJ1Z3MuCiAgICAgICAgdmFyIG5ld1NlYXJjaCA9ICdydW5UZXN0cz0nICsgdGVzdE5hbWVNYXRjaFsxXTsKICAgICAgICB2YXIgc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDsKICAgICAgICBpZiAoc2VhcmNoKSB7CiAgICAgICAgICB2YXIgb2xkVGVzdHMgPSAvcnVuVGVzdHM9KFteJl0qKS8uZXhlYyhzZWFyY2gpOwogICAgICAgICAgaWYgKG9sZFRlc3RzKSB7CiAgICAgICAgICAgIG5ld1NlYXJjaCA9IHNlYXJjaC5zdWJzdHIoMCwgb2xkVGVzdHMuaW5kZXgpICsKICAgICAgICAgICAgICAgICAgICAgICAgbmV3U2VhcmNoICsKICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoLnN1YnN0cihvbGRUZXN0cy5pbmRleCArIG9sZFRlc3RzWzBdLmxlbmd0aCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdTZWFyY2ggPSBzZWFyY2ggKyAnJicgKyBuZXdTZWFyY2g7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5ld1NlYXJjaCA9ICc/JyArIG5ld1NlYXJjaDsKICAgICAgICB9CiAgICAgICAgdmFyIGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsKICAgICAgICB2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOwogICAgICAgIGlmIChoYXNoICYmIGhhc2guY2hhckF0KDApICE9ICcjJykgewogICAgICAgICAgaGFzaCA9ICcjJyArIGhhc2g7CiAgICAgICAgfQogICAgICAgIGhyZWYgPSBocmVmLnNwbGl0KCcjJylbMF0uc3BsaXQoJz8nKVswXSArIG5ld1NlYXJjaCArIGhhc2g7CgogICAgICAgIC8vIEFkZCB0aGUgbGluay4KICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0EnKTsKICAgICAgICBhLmlubmVySFRNTCA9ICcocnVuIGluZGl2aWR1YWxseSknOwogICAgICAgIGEuc3R5bGUuZm9udFNpemUgPSAnMC44ZW0nOwogICAgICAgIGEuaHJlZiA9IGhyZWY7CiAgICAgICAgZGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcgJykpOwogICAgICAgIGRpdi5hcHBlbmRDaGlsZChhKTsKICAgICAgfQogICAgfQoKICAgIGRpdi5zdHlsZS5jb2xvciA9IGNvbG9yOwogICAgZGl2LnN0eWxlLmZvbnQgPSAnbm9ybWFsIDEwMCUgbW9ub3NwYWNlJzsKICAgIGlmIChpID09IDApIHsKICAgICAgLy8gSGlnaGxpZ2h0IHRoZSBmaXJzdCBsaW5lIGFzIGEgaGVhZGVyIHRoYXQgaW5kaWNhdGVzIHRoZSB0ZXN0IG91dGNvbWUuCiAgICAgIGRpdi5zdHlsZS5wYWRkaW5nID0gJzIwcHgnOwogICAgICBkaXYuc3R5bGUubWFyZ2luQm90dG9tID0gJzEwcHgnOwogICAgICBpZiAoaXNGYWlsT3JFcnJvcikgewogICAgICAgIGRpdi5zdHlsZS5ib3JkZXIgPSAnNXB4IHNvbGlkICcgKyBjb2xvcjsKICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNmZmVlZWUnOwogICAgICB9IGVsc2UgewogICAgICAgIGRpdi5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIGJsYWNrJzsKICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNlZWZmZWUnOwogICAgICB9CiAgICB9CgogICAgdHJ5IHsKICAgICAgZGl2LnN0eWxlLndoaXRlU3BhY2UgPSAncHJlLXdyYXAnOwogICAgfSBjYXRjaCAoZSkgewogICAgICAvLyBOT1RFKGJyZW5uZW1hbik6IElFIHJhaXNlcyBhbiBleGNlcHRpb24gd2hlbiBhc3NpZ25pbmcgdG8gcHJlLXdyYXAuCiAgICAgIC8vIFRoYW5rZnVsbHksIGl0IGRvZXNuJ3QgY29sbGFwc2Ugd2hpdGVzcGFjZSB3aGVuIHVzaW5nIG1vbm9zcGFjZSBmb250cywKICAgICAgLy8gc28gaXQgd2lsbCBkaXNwbGF5IGNvcnJlY3RseSBpZiB3ZSBpZ25vcmUgdGhlIGV4Y2VwdGlvbi4KICAgIH0KCiAgICBpZiAoaSA8IDIpIHsKICAgICAgZGl2LnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7CiAgICB9CiAgICB0aGlzLmxvZ0VsXy5hcHBlbmRDaGlsZChkaXYpOwogIH0KfTsKCgovKioKICogTG9ncyBhIG1lc3NhZ2UgdG8gdGhlIGN1cnJlbnQgdGVzdCBjYXNlLgogKiBAcGFyYW0ge3N0cmluZ30gcyBUaGUgdGV4dCB0byBvdXRwdXQgdG8gdGhlIGxvZy4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbihzKSB7CiAgaWYgKHRoaXMudGVzdENhc2UpIHsKICAgIHRoaXMudGVzdENhc2UubG9nKHMpOwogIH0KfTsK",
                "body": "Ly8gQ29weXJpZ2h0IDIwMDcgVGhlIENsb3N1cmUgTGlicmFyeSBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgovLwovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgovLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLy8KLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKLy8KLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQovLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMtSVMiIEJBU0lTLAovLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAovLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCi8qKgogKiBAZmlsZW92ZXJ2aWV3IFRoZSB0ZXN0IHJ1bm5lciBpcyBhIHNpbmdsZXRvbiBvYmplY3QgdGhhdCBpcyB1c2VkIHRvIGV4ZWN1dGUKICogYSBnb29nLnRlc3RpbmcuVGVzdENhc2VzLCBkaXNwbGF5IHRoZSByZXN1bHRzLCBhbmQgZXhwb3NlIHRoZSByZXN1bHRzIHRvCiAqIFNlbGVuaXVtIGZvciBhdXRvbWF0aW9uLiAgSWYgYSBUZXN0Q2FzZSBoYXNuJ3QgYmVlbiByZWdpc3RlcmVkIHdpdGggdGhlCiAqIHJ1bm5lciBieSB0aGUgdGltZSB3aW5kb3cub25sb2FkIG9jY3VycywgdGhlIHRlc3RSdW5uZXIgd2lsbCB0cnkgdG8gYXV0by0KICogZGlzY292ZXIgSnNVbml0IHN0eWxlIHRlc3QgcGFnZXMuCiAqCiAqIFRoZSBob29rcyBmb3Igc2VsZW5pdW0gYXJlIDotCiAqICAtIEJvb2xlYW4gR190ZXN0UnVubmVyLmlzRmluaXNoZWQoKQogKiAgLSBCb29sZWFuIEdfdGVzdFJ1bm5lci5pc1N1Y2Nlc3MoKQogKiAgLSBTdHJpbmcgR190ZXN0UnVubmVyLmdldFJlcG9ydCgpCiAqICAtIG51bWJlciBHX3Rlc3RSdW5uZXIuZ2V0UnVuVGltZSgpCiAqCiAqIFRlc3RpbmcgY29kZSBzaG91bGQgbm90IGhhdmUgZGVwZW5kZW5jaWVzIG91dHNpZGUgb2YgZ29vZy50ZXN0aW5nIHNvIGFzIHRvCiAqIHJlZHVjZSB0aGUgY2hhbmNlIG9mIG1hc2tpbmcgbWlzc2luZyBkZXBlbmRlbmNpZXMuCiAqCiAqLwoKZ29vZy5wcm92aWRlKCdnb29nLnRlc3RpbmcuVGVzdFJ1bm5lcicpOwoKZ29vZy5yZXF1aXJlKCdnb29nLnRlc3RpbmcuVGVzdENhc2UnKTsKCgoKLyoqCiAqIENvbnN0cnVjdCBhIHRlc3QgcnVubmVyLgogKgogKiBOT1RFKHVzZXIpOiBUaGlzIGlzIGN1cnJlbnRseSBwcmV0dHkgd2VpcmQsIEknbSBlc3NlbnRpYWxseSB0cnlpbmcgdG8KICogY3JlYXRlIGEgd3JhcHBlciB0aGF0IHRoZSBTZWxlbml1bSB0ZXN0IGNhbiBob29rIGludG8gdG8gcXVlcnkgdGhlIHN0YXRlIG9mCiAqIHRoZSBydW5uaW5nIHRlc3QgY2FzZSwgd2hpbGUgbWFraW5nIGdvb2cudGVzdGluZy5UZXN0Q2FzZSBnZW5lcmFsLgogKgogKiBAY29uc3RydWN0b3IKICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyID0gZnVuY3Rpb24oKSB7CiAgLyoqCiAgICogRXJyb3JzIHRoYXQgb2NjdXJyZWQgaW4gdGhlIHdpbmRvdy4KICAgKiBAdHlwZSB7QXJyYXkuPHN0cmluZz59CiAgICovCiAgdGhpcy5lcnJvcnMgPSBbXTsKfTsKCgovKioKICogUmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUgdGVzdCBjYXNlLgogKiBAdHlwZSB7Z29vZy50ZXN0aW5nLlRlc3RDYXNlP30KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS50ZXN0Q2FzZSA9IG51bGw7CgoKLyoqCiAqIFdoZXRoZXIgdGhlIHRlc3QgcnVubmVyIGhhcyBiZWVuIGluaXRpYWxpemVkIHlldC4KICogQHR5cGUge2Jvb2xlYW59CiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuaW5pdGlhbGl6ZWQgPSBmYWxzZTsKCgovKioKICogRWxlbWVudCBjcmVhdGVkIGluIHRoZSBkb2N1bWVudCB0byBhZGQgdGVzdCByZXN1bHRzIHRvLgogKiBAdHlwZSB7RWxlbWVudH0KICogQHByaXZhdGUKICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5sb2dFbF8gPSBudWxsOwoKCi8qKgogKiBGdW5jdGlvbiB0byB1c2Ugd2hlbiBmaWx0ZXJpbmcgZXJyb3JzLgogKiBAdHlwZSB7KGZ1bmN0aW9uKHN0cmluZykpP30KICogQHByaXZhdGUKICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5lcnJvckZpbHRlcl8gPSBudWxsOwoKCi8qKgogKiBXaGV0aGVyIGFuIGVtcHR5IHRlc3QgY2FzZSBjb3VudHMgYXMgYW4gZXJyb3IuCiAqIEB0eXBlIHtib29sZWFufQogKiBAcHJpdmF0ZQogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLnN0cmljdF8gPSB0cnVlOwoKCi8qKgogKiBJbml0aWFsaXplcyB0aGUgdGVzdCBydW5uZXIuCiAqIEBwYXJhbSB7Z29vZy50ZXN0aW5nLlRlc3RDYXNlfSB0ZXN0Q2FzZSBUaGUgdGVzdCBjYXNlIHRvIGluaXRpYWxpemUgd2l0aC4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24odGVzdENhc2UpIHsKICBpZiAodGhpcy50ZXN0Q2FzZSAmJiB0aGlzLnRlc3RDYXNlLnJ1bm5pbmcpIHsKICAgIHRocm93IEVycm9yKCdUaGUgdGVzdCBydW5uZXIgaXMgYWxyZWFkeSB3YWl0aW5nIGZvciBhIHRlc3QgdG8gY29tcGxldGUnKTsKICB9CiAgdGhpcy50ZXN0Q2FzZSA9IHRlc3RDYXNlOwogIHRlc3RDYXNlLnNldFRlc3RSdW5uZXIodGhpcyk7CiAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7Cn07CgoKLyoqCiAqIEJ5IGRlZmF1bHQsIHRoZSB0ZXN0IHJ1bm5lciBpcyBzdHJpY3QsIGFuZCBmYWlscyBpZiBpdCBydW5zIGFuIGVtcHR5CiAqIHRlc3QgY2FzZS4KICogQHBhcmFtIHtib29sZWFufSBzdHJpY3QgV2hldGhlciB0aGUgdGVzdCBydW5uZXIgc2hvdWxkIGZhaWwgb24gYW4gZW1wdHkKICogICAgIHRlc3QgY2FzZS4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5zZXRTdHJpY3QgPSBmdW5jdGlvbihzdHJpY3QpIHsKICB0aGlzLnN0cmljdF8gPSBzdHJpY3Q7Cn07CgoKLyoqCiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHRlc3QgcnVubmVyIHNob3VsZCBmYWlsIG9uIGFuIGVtcHR5CiAqICAgICB0ZXN0IGNhc2UuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuaXNTdHJpY3QgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gdGhpcy5zdHJpY3RfOwp9OwoKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgdGhlIHRlc3QgcnVubmVyIGlzIGluaXRpYWxpemVkLgogKiBVc2VkIGJ5IFNlbGVuaXVtIEhvb2tzLgogKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSB0ZXN0IHJ1bm5lciBpcyBhY3RpdmUuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuaXNJbml0aWFsaXplZCA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLmluaXRpYWxpemVkOwp9OwoKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgdGhlIHRlc3QgcnVubmVyIGlzIGZpbmlzaGVkLgogKiBVc2VkIGJ5IFNlbGVuaXVtIEhvb2tzLgogKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSB0ZXN0IHJ1bm5lciBpcyBhY3RpdmUuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuaXNGaW5pc2hlZCA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLmVycm9ycy5sZW5ndGggPiAwIHx8CiAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgJiYgISF0aGlzLnRlc3RDYXNlICYmIHRoaXMudGVzdENhc2Uuc3RhcnRlZCAmJgogICAgICAhdGhpcy50ZXN0Q2FzZS5ydW5uaW5nOwp9OwoKCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgdGhlIHRlc3QgY2FzZSBkaWRuJ3QgZmFpbC4KICogVXNlZCBieSBTZWxlbml1bSBIb29rcy4KICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGUgY3VycmVudCB0ZXN0IHJldHVybmVkIHN1Y2Nlc3NmdWxseS4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5pc1N1Y2Nlc3MgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gIXRoaXMuaGFzRXJyb3JzKCkgJiYgISF0aGlzLnRlc3RDYXNlICYmIHRoaXMudGVzdENhc2UuaXNTdWNjZXNzKCk7Cn07CgoKLyoqCiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdGVzdCBjYXNlIHJ1bm5lciBoYXMgZXJyb3JzIHRoYXQgd2VyZSBjYXVnaHQgb3V0c2lkZSBvZgogKiB0aGUgdGVzdCBjYXNlLgogKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZXJlIHdlcmUgSlMgZXJyb3JzLgogKi8KZ29vZy50ZXN0aW5nLlRlc3RSdW5uZXIucHJvdG90eXBlLmhhc0Vycm9ycyA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLmVycm9ycy5sZW5ndGggPiAwOwp9OwoKCi8qKgogKiBMb2dzIGFuIGVycm9yIHRoYXQgb2NjdXJyZWQuICBVc2VkIGluIHRoZSBjYXNlIG9mIGVudmlyb25tZW50IHNldHRpbmcgdXAKICogYW4gb25lcnJvciBoYW5kbGVyLgogKiBAcGFyYW0ge3N0cmluZ30gbXNnIEVycm9yIG1lc3NhZ2UuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUubG9nRXJyb3IgPSBmdW5jdGlvbihtc2cpIHsKICBpZiAoIXRoaXMuZXJyb3JGaWx0ZXJfIHx8IHRoaXMuZXJyb3JGaWx0ZXJfLmNhbGwobnVsbCwgbXNnKSkgewogICAgdGhpcy5lcnJvcnMucHVzaChtc2cpOwogIH0KfTsKCgovKioKICogTG9nIGZhaWx1cmUgaW4gY3VycmVudCBydW5uaW5nIHRlc3QuCiAqIEBwYXJhbSB7RXJyb3J9IGV4IEV4Y2VwdGlvbi4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5sb2dUZXN0RmFpbHVyZSA9IGZ1bmN0aW9uKGV4KSB7CiAgdmFyIHRlc3ROYW1lID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChnb29nLnRlc3RpbmcuVGVzdENhc2UuY3VycmVudFRlc3ROYW1lKTsKICBpZiAodGhpcy50ZXN0Q2FzZSkgewogICAgdGhpcy50ZXN0Q2FzZS5sb2dFcnJvcih0ZXN0TmFtZSwgZXgpOwogIH0gZWxzZSB7CiAgICAvLyBOT1RFOiBEbyBub3QgZm9yZ2V0IHRvIGxvZyB0aGUgb3JpZ2luYWwgZXhjZXB0aW9uIHJhaXNlZC4KICAgIHRocm93IG5ldyBFcnJvcignVGVzdCBydW5uZXIgbm90IGluaXRpYWxpemVkIHdpdGggYSB0ZXN0IGNhc2UuIE9yaWdpbmFsICcgKwogICAgICAgICAgICAgICAgICAgICdleGNlcHRpb246ICcgKyBleC5tZXNzYWdlKTsKICB9Cn07CgoKLyoqCiAqIFNldHMgYSBmdW5jdGlvbiB0byB1c2UgYXMgYSBmaWx0ZXIgZm9yIGVycm9ycy4KICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcpfSBmbiBGaWx0ZXIgZnVuY3Rpb24uCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuc2V0RXJyb3JGaWx0ZXIgPSBmdW5jdGlvbihmbikgewogIHRoaXMuZXJyb3JGaWx0ZXJfID0gZm47Cn07CgoKLyoqCiAqIFJldHVybnMgYSByZXBvcnQgb2YgdGhlIHRlc3QgY2FzZSB0aGF0IHJhbi4KICogVXNlZCBieSBTZWxlbml1bSBIb29rcy4KICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3ZlcmJvc2UgSWYgdHJ1ZSByZXN1bHRzIHdpbGwgaW5jbHVkZSBkYXRhIGFib3V0IGFsbAogKiAgICAgdGVzdHMsIG5vdCBqdXN0IHdoYXQgZmFpbGVkLgogKiBAcmV0dXJuIHtzdHJpbmd9IEEgcmVwb3J0IHN1bW1hcnkgb2YgdGhlIHRlc3QuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuZ2V0UmVwb3J0ID0gZnVuY3Rpb24ob3B0X3ZlcmJvc2UpIHsKICB2YXIgcmVwb3J0ID0gW107CiAgaWYgKHRoaXMudGVzdENhc2UpIHsKICAgIHJlcG9ydC5wdXNoKHRoaXMudGVzdENhc2UuZ2V0UmVwb3J0KG9wdF92ZXJib3NlKSk7CiAgfQogIGlmICh0aGlzLmVycm9ycy5sZW5ndGggPiAwKSB7CiAgICByZXBvcnQucHVzaCgnSmF2YVNjcmlwdCBlcnJvcnMgZGV0ZWN0ZWQgYnkgdGVzdCBydW5uZXI6Jyk7CiAgICByZXBvcnQucHVzaC5hcHBseShyZXBvcnQsIHRoaXMuZXJyb3JzKTsKICAgIHJlcG9ydC5wdXNoKCdcbicpOwogIH0KICByZXR1cm4gcmVwb3J0LmpvaW4oJ1xuJyk7Cn07CgoKLyoqCiAqIFJldHVybnMgdGhlIGFtb3VudCBvZiB0aW1lIGl0IHRvb2sgZm9yIHRoZSB0ZXN0IHRvIHJ1bi4KICogVXNlZCBieSBTZWxlbml1bSBIb29rcy4KICogQHJldHVybiB7bnVtYmVyfSBUaGUgcnVuIHRpbWUsIGluIG1pbGxpc2Vjb25kcy4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5nZXRSdW5UaW1lID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMudGVzdENhc2UgPyB0aGlzLnRlc3RDYXNlLmdldFJ1blRpbWUoKSA6IDA7Cn07CgoKLyoqCiAqIFJldHVybnMgdGhlIG51bWJlciBvZiBzY3JpcHQgZmlsZXMgdGhhdCB3ZXJlIGxvYWRlZCBpbiBvcmRlciB0byBydW4gdGhlIHRlc3QuCiAqIEByZXR1cm4ge251bWJlcn0gVGhlIG51bWJlciBvZiBzY3JpcHQgZmlsZXMuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUuZ2V0TnVtRmlsZXNMb2FkZWQgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gdGhpcy50ZXN0Q2FzZSA/IHRoaXMudGVzdENhc2UuZ2V0TnVtRmlsZXNMb2FkZWQoKSA6IDA7Cn07CgoKLyoqCiAqIEV4ZWN1dGVzIGEgdGVzdCBjYXNlIGFuZCBwcmludHMgdGhlIHJlc3VsdHMgdG8gdGhlIHdpbmRvdy4KICovCmdvb2cudGVzdGluZy5UZXN0UnVubmVyLnByb3RvdHlwZS5leGVjdXRlID0gZnVuY3Rpb24oKSB7CiAgaWYgKCF0aGlzLnRlc3RDYXNlKSB7CiAgICB0aHJvdyBFcnJvcignVGhlIHRlc3QgcnVubmVyIG11c3QgYmUgaW5pdGlhbGl6ZWQgd2l0aCBhIHRlc3QgY2FzZSBiZWZvcmUgJyArCiAgICAgICAgICAgICAgICAnZXhlY3V0ZSBjYW4gYmUgY2FsbGVkLicpOwogIH0KICB0aGlzLnRlc3RDYXNlLnNldENvbXBsZXRlZENhbGxiYWNrKGdvb2cuYmluZCh0aGlzLm9uQ29tcGxldGVfLCB0aGlzKSk7CiAgdGhpcy50ZXN0Q2FzZS5ydW5UZXN0cygpOwp9OwoKCi8qKgogKiBXcml0ZXMgdGhlIHJlc3VsdHMgdG8gdGhlIGRvY3VtZW50IHdoZW4gdGhlIHRlc3QgY2FzZSBjb21wbGV0ZXMuCiAqIEBwcml2YXRlCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUub25Db21wbGV0ZV8gPSBmdW5jdGlvbigpIHsKICB2YXIgbG9nID0gdGhpcy50ZXN0Q2FzZS5nZXRSZXBvcnQodHJ1ZSk7CiAgaWYgKHRoaXMuZXJyb3JzLmxlbmd0aCA+IDApIHsKICAgIGxvZyArPSAnXG4nICsgdGhpcy5lcnJvcnMuam9pbignXG4nKTsKICB9CgogIGlmICghdGhpcy5sb2dFbF8pIHsKICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zdXJlVGVzdFJ1bm5lckxvZycpOwogICAgaWYgKGVsID09IG51bGwpIHsKICAgICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7CiAgICB9CiAgICB0aGlzLmxvZ0VsXyA9IGVsOwogIH0KCiAgLy8gUmVtb3ZlIGFsbCBjaGlsZHJlbiBmcm9tIHRoZSBsb2cgZWxlbWVudC4KICB2YXIgbG9nRWwgPSB0aGlzLmxvZ0VsXzsKICB3aGlsZSAobG9nRWwuZmlyc3RDaGlsZCkgewogICAgbG9nRWwucmVtb3ZlQ2hpbGQobG9nRWwuZmlyc3RDaGlsZCk7CiAgfQoKICAvLyBIaWdobGlnaHQgdGhlIHBhZ2UgdG8gaW5kaWNhdGUgdGhlIG92ZXJhbGwgb3V0Y29tZS4KICB0aGlzLndyaXRlTG9nKGxvZyk7CgogIHZhciBydW5BZ2FpbkxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgcnVuQWdhaW5MaW5rLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogIHJ1bkFnYWluTGluay5zdHlsZS5mb250U2l6ZSA9ICdzbWFsbCc7CiAgcnVuQWdhaW5MaW5rLmhyZWYgPSAnJzsKICBydW5BZ2Fpbkxpbmsub25jbGljayA9IGdvb2cuYmluZChmdW5jdGlvbigpIHsKICAgIHRoaXMuZXhlY3V0ZSgpOwogICAgcmV0dXJuIGZhbHNlOwogIH0sIHRoaXMpOwogIHJ1bkFnYWluTGluay5pbm5lckhUTUwgPSAnUnVuIGFnYWluIHdpdGhvdXQgcmVsb2FkaW5nJzsKICBsb2dFbC5hcHBlbmRDaGlsZChydW5BZ2FpbkxpbmspOwp9OwoKCi8qKgogKiBXcml0ZXMgYSBuaWNlbHkgZm9ybWF0dGVkIGxvZyBvdXQgdG8gdGhlIGRvY3VtZW50LgogKiBAcGFyYW0ge3N0cmluZ30gbG9nIFRoZSBzdHJpbmcgdG8gd3JpdGUuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUud3JpdGVMb2cgPSBmdW5jdGlvbihsb2cpIHsKICB2YXIgbGluZXMgPSBsb2cuc3BsaXQoJ1xuJyk7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGxpbmUgPSBsaW5lc1tpXTsKICAgIHZhciBjb2xvcjsKICAgIHZhciBpc0ZhaWxPckVycm9yID0gL0ZBSUxFRC8udGVzdChsaW5lKSB8fCAvRVJST1IvLnRlc3QobGluZSk7CiAgICBpZiAoL1BBU1NFRC8udGVzdChsaW5lKSkgewogICAgICBjb2xvciA9ICdkYXJrZ3JlZW4nOwogICAgfSBlbHNlIGlmIChpc0ZhaWxPckVycm9yKSB7CiAgICAgIGNvbG9yID0gJ2RhcmtyZWQnOwogICAgfSBlbHNlIHsKICAgICAgY29sb3IgPSAnIzMzMyc7CiAgICB9CiAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBpZiAobGluZS5zdWJzdHIoMCwgMikgPT0gJz4gJykgewogICAgICAvLyBUaGUgc3RhY2sgdHJhY2UgbWF5IGNvbnRhaW4gbGlua3Mgc28gaXQgaGFzIHRvIGJlIGludGVycHJldGVkIGFzIEhUTUwuCiAgICAgIGRpdi5pbm5lckhUTUwgPSBsaW5lOwogICAgfSBlbHNlIHsKICAgICAgZGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGxpbmUpKTsKICAgIH0KCiAgICBpZiAoaXNGYWlsT3JFcnJvcikgewogICAgICB2YXIgdGVzdE5hbWVNYXRjaCA9IC8oXFMrKSAoXFtbXlxdXSpdICk/OiAoRkFJTEVEfEVSUk9SKS8uZXhlYyhsaW5lKTsKICAgICAgaWYgKHRlc3ROYW1lTWF0Y2gpIHsKICAgICAgICAvLyBCdWlsZCBhIFVSTCB0byBydW4gdGhlIHRlc3QgaW5kaXZpZHVhbGx5LiAgSWYgdGhpcyB0ZXN0IHdhcyBhbHJlYWR5CiAgICAgICAgLy8gcGFydCBvZiBhbm90aGVyIHN1YnNldCB0ZXN0LCB3ZSBuZWVkIHRvIG92ZXJ3cml0ZSB0aGUgb2xkIHJ1blRlc3RzCiAgICAgICAgLy8gcXVlcnkgcGFyYW1ldGVyLiAgV2UgYWxzbyBuZWVkIHRvIGRvIHRoaXMgd2l0aG91dCBicmluZ2luZyBpbiBhbnkKICAgICAgICAvLyBleHRyYSBkZXBlbmRlbmNpZXMsIG90aGVyd2lzZSB3ZSBjb3VsZCBtYXNrIG1pc3NpbmcgZGVwZW5kZW5jeSBidWdzLgogICAgICAgIHZhciBuZXdTZWFyY2ggPSAncnVuVGVzdHM9JyArIHRlc3ROYW1lTWF0Y2hbMV07CiAgICAgICAgdmFyIHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7CiAgICAgICAgaWYgKHNlYXJjaCkgewogICAgICAgICAgdmFyIG9sZFRlc3RzID0gL3J1blRlc3RzPShbXiZdKikvLmV4ZWMoc2VhcmNoKTsKICAgICAgICAgIGlmIChvbGRUZXN0cykgewogICAgICAgICAgICBuZXdTZWFyY2ggPSBzZWFyY2guc3Vic3RyKDAsIG9sZFRlc3RzLmluZGV4KSArCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1NlYXJjaCArCiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaC5zdWJzdHIob2xkVGVzdHMuaW5kZXggKyBvbGRUZXN0c1swXS5sZW5ndGgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3U2VhcmNoID0gc2VhcmNoICsgJyYnICsgbmV3U2VhcmNoOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuZXdTZWFyY2ggPSAnPycgKyBuZXdTZWFyY2g7CiAgICAgICAgfQogICAgICAgIHZhciBocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaDsKICAgICAgICBpZiAoaGFzaCAmJiBoYXNoLmNoYXJBdCgwKSAhPSAnIycpIHsKICAgICAgICAgIGhhc2ggPSAnIycgKyBoYXNoOwogICAgICAgIH0KICAgICAgICBocmVmID0gaHJlZi5zcGxpdCgnIycpWzBdLnNwbGl0KCc/JylbMF0gKyBuZXdTZWFyY2ggKyBoYXNoOwoKICAgICAgICAvLyBBZGQgdGhlIGxpbmsuCiAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdBJyk7CiAgICAgICAgYS5pbm5lckhUTUwgPSAnKHJ1biBpbmRpdmlkdWFsbHkpJzsKICAgICAgICBhLnN0eWxlLmZvbnRTaXplID0gJzAuOGVtJzsKICAgICAgICBhLmhyZWYgPSBocmVmOwogICAgICAgIGRpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnICcpKTsKICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoYSk7CiAgICAgIH0KICAgIH0KCiAgICBkaXYuc3R5bGUuY29sb3IgPSBjb2xvcjsKICAgIGRpdi5zdHlsZS5mb250ID0gJ25vcm1hbCAxMDAlIG1vbm9zcGFjZSc7CiAgICBpZiAoaSA9PSAwKSB7CiAgICAgIC8vIEhpZ2hsaWdodCB0aGUgZmlyc3QgbGluZSBhcyBhIGhlYWRlciB0aGF0IGluZGljYXRlcyB0aGUgdGVzdCBvdXRjb21lLgogICAgICBkaXYuc3R5bGUucGFkZGluZyA9ICcyMHB4JzsKICAgICAgZGl2LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxMHB4JzsKICAgICAgaWYgKGlzRmFpbE9yRXJyb3IpIHsKICAgICAgICBkaXYuc3R5bGUuYm9yZGVyID0gJzVweCBzb2xpZCAnICsgY29sb3I7CiAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZmZlZWVlJzsKICAgICAgfSBlbHNlIHsKICAgICAgICBkaXYuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCBibGFjayc7CiAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZWVmZmVlJzsKICAgICAgfQogICAgfQoKICAgIHRyeSB7CiAgICAgIGRpdi5zdHlsZS53aGl0ZVNwYWNlID0gJ3ByZS13cmFwJzsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgLy8gTk9URShicmVubmVtYW4pOiBJRSByYWlzZXMgYW4gZXhjZXB0aW9uIHdoZW4gYXNzaWduaW5nIHRvIHByZS13cmFwLgogICAgICAvLyBUaGFua2Z1bGx5LCBpdCBkb2Vzbid0IGNvbGxhcHNlIHdoaXRlc3BhY2Ugd2hlbiB1c2luZyBtb25vc3BhY2UgZm9udHMsCiAgICAgIC8vIHNvIGl0IHdpbGwgZGlzcGxheSBjb3JyZWN0bHkgaWYgd2UgaWdub3JlIHRoZSBleGNlcHRpb24uCiAgICB9CgogICAgaWYgKGkgPCAyKSB7CiAgICAgIGRpdi5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnOwogICAgfQogICAgdGhpcy5sb2dFbF8uYXBwZW5kQ2hpbGQoZGl2KTsKICB9Cn07CgoKLyoqCiAqIExvZ3MgYSBtZXNzYWdlIHRvIHRoZSBjdXJyZW50IHRlc3QgY2FzZS4KICogQHBhcmFtIHtzdHJpbmd9IHMgVGhlIHRleHQgdG8gb3V0cHV0IHRvIHRoZSBsb2cuCiAqLwpnb29nLnRlc3RpbmcuVGVzdFJ1bm5lci5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24ocykgewogIGlmICh0aGlzLnRlc3RDYXNlKSB7CiAgICB0aGlzLnRlc3RDYXNlLmxvZyhzKTsKICB9Cn07Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 21:39:08 GMT",
                    "Content-Length": "11494",
                    "Date": "Fri, 07 Nov 2014 21:39:12 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}