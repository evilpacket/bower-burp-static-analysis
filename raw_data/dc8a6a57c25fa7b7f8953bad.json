{
    "url": "http://localhost:9999/mountainmoon/bolero/tentacle.user.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>location.href</b> and written to <b>the 'source' property of a DOM element</b> via the following statement:<ul><li>img.src = location.href;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/mountainmoon/bolero/tentacle.user.js",
                "path": "/mountainmoon/bolero/tentacle.user.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9tb3VudGFpbm1vb24vYm9sZXJvL3RlbnRhY2xlLnVzZXIuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODE3NQ0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAxMjo1NzoyMyBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMTI6NTc6MjAgR01UDQoNCi8vID09VXNlclNjcmlwdD09DQovLyBAbmFtZSBCbHVlQ3Jhd2xlcg0KLy8gQG5hbWVzcGFjZSBodHRwOi8vdXNlLmkuRS55b3VyLmhvbWVwYWdlLw0KLy8gQHZlcnNpb24gMC4xDQovLyBAZGVzY3JpcHRpb24gZW50ZXIgc29tZXRoaW5nIHVzZWZ1bA0KLy8gQG1hdGNoIGh0dHA6Ly8qLyoNCi8vIEBtYXRjaCBodHRwczovLyovKg0KLy8gQGNvcHlyaWdodCAyMDE0KywgR29kLWxpa2UNCi8vID09L1VzZXJTY3JpcHQ9PQ0KDQooZnVuY3Rpb24oKSB7DQoNCmlmICh0b3AgPT09IHdpbmRvdyAmJiAhfmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKCd0ZW50YWNsZT10b3AnKSkNCiAgICByZXR1cm47DQoNCnZhciBSRUdFWFBfUkUgPSAvXlwvLitcLyg/IS4qKFtpbWddKS4qXDEuKiQpW2ltZ117MCwzfSQvLA0KICAgIEZVTkNUSU9OX1JFID0gL15mdW5jdGlvblxzKj9cKFtcc1xTXSo/XClccyo/XHtbXHNcU10qP31ccyokLywNCiAgICBVUkxfQVJHVU1FTlRfUkUgPSAvPShodHRwcz8lM0ElMkYlMkYuKz8pKCZ8JCkvLA0KICAgIElNQUdFX1RZUEVfUkUgPSAvXi4rXC4oXHcrKSQvLA0KICAgIElNQUdFX1RZUEVTID0gWydqcGcnLCAnanBlZycsICdwbmcnXSwNCg0KICAgIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLA0KICAgIGZldGNoVHlwZXMgPSBbJ2ltZycsICdzdHInLCAnZG9tJ107DQoNCnZhciBfbG9nID0gY29uc29sZS5sb2csIGxvZzsNCmNvbnNvbGUubG9nID0gZnVuY3Rpb24oKSB7DQogICAgdmFyIGFyZ3M7DQogICAgaWYgKGFyZ3VtZW50c1swXSAhPSAndGVudGFjbGUnKSB7DQogICAgICAgIHJldHVybg0KICAgIH0NCiAgICBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOw0KICAgIGFyZ3MudW5zaGlmdCgnIyNMT0cjIzogZnJhbWUsICcgKyBsb2NhdGlvbi5vcmlnaW4gKyAnOiAnKTsNCiAgICBfbG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3MpDQp9DQpsb2cgPSBjb25zb2xlLmxvZy5iaW5kKG51bGwsICd0ZW50YWNsZScpOw0KDQp3aW5kb3cucGFyZW50ICE9PSB3aW5kb3cgJiYgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7DQogICAgdHlwZTogJ2ZyYW1lJywNCiAgICBmZXRjaFR5cGU6IHdpbmRvdy5uYW1lLA0KICAgIHVybDogbG9jYXRpb25bd2luZG93Lm5hbWUgPT0gJ3N0cicgPyAnb3JpZ2luJyA6ICdocmVmJ10NCn0sICcqJyk7DQoNCndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAvKioNCiAgICAgKiBldmVudC5kYXRhIDoNCiAgICAgKiB7DQogICAgICogICB0eXBlOiBpbWFnZUxvYWQsZmV0Y2gNCiAgICAgKiAgIHBhdHRlcm46IFtzdHJpbmcgfCBSZWdFeHAtbGlrZSBzdHJpbmcgfCBGdW5jdGlvbiB8IFtdIF0gc2VlIGRldGFpbCBpbiBmZXRjaGVyDQogICAgICogICBldmVudElkOiBzZWUgaWZyYW1lRmV0Y2hlciwNCiAgICAgKiAgIHVybDogdGhlIHRhcmdldCBwYWdlIHVybCAsIHR5cGUgbXVzdCBiZSBmZXRjaCBpZiBpdCdzIHZhbGlkDQogICAgICogICBhdXRoOiB0aGUgcGFnZSBpbiBpZnJhbWUgbWF5IGhhdmUgc29tZSBzdWItaWZyYW1lLCBzbyBwcmV2ZW50IGl0LiAoYW5kIGFsc28gd2luZG93IGNhbiBwb3N0bWVzc2FnZSB0byBpdHNlbGYpDQogICAgICogfQ0KICAgICAqLw0KICAgIHZhciBkYXRhID0gZXZlbnQuZGF0YSwNCiAgICAgICAgdXJsID0gZGF0YS51cmwgfHwgbG9jYXRpb24uaHJlZiwNCiAgICAgICAgdHlwZSA9IGRhdGEudHlwZSwNCiAgICAgICAgcHJvbWlzZTsNCg0KICAgIGlmICghZmV0Y2hUeXBlcy5zb21lKGZ1bmN0aW9uKF90eXBlKSB7DQogICAgICAgIHJldHVybiBfdHlwZSA9PSB0eXBlDQogICAgfSkgfHwgIWNoZWNrQXV0aChkYXRhLmF1dGgpKQ0KICAgICAgICByZXR1cm47DQogICAgc3dpdGNoICh0eXBlKSB7DQogICAgICAgIGNhc2UgJ2ltZyc6DQogICAgICAgICAgICBwcm9taXNlID0gaGFuZGxlSW1hZ2UoKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdzdHInOg0KICAgICAgICAgICAgcHJvbWlzZSA9IGhhbmRsZVBhZ2UodXJsLCBkYXRhLnBhdHRlcm4pOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2RvbSc6DQogICAgICAgICAgICBwcm9taXNlID0gaGFuZGxlRE9NKGRhdGEucGF0dGVybik7DQogICAgICAgICAgICBicmVhazsNCiAgICB9DQogICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkgew0KICAgICAgICBldmVudC5zb3VyY2UucG9zdE1lc3NhZ2Uoew0KICAgICAgICAgICAgdXJsOiB1cmwsDQogICAgICAgICAgICByZXN1bHQ6IHJlc3VsdCwNCiAgICAgICAgICAgIHR5cGU6IHR5cGVvZiByZXN1bHQgPT0gJ3N0cmluZycgJiYgdHlwZSAhPSAnaW1nJyA/ICdyZWRpcmVjdCcgOiB0eXBlLA0KICAgICAgICAgICAgdGFyZ2V0SWQ6IGRhdGEudGFyZ2V0SWQNCiAgICAgICAgfSwgZXZlbnQub3JpZ2luID09PSAnbnVsbCcgPyAnKicgOiBldmVudC5vcmlnaW4pDQogICAgfSkNCn0pDQoNCi8qKg0KICog6K+35rGC6LWE5rqQ57G75Z6L5Li64oCcc3Ry4oCd77yM5LuleGhy5b2i5byP6K+35rGC572R6aG177yM5bm2cGF0dGVybuS7pXN0cmluZ+W9ouW8j+ino+aekOe9kemhteW5tui/lOWbnui1hOa6kA0KICogQHBhcmFtIHVybA0KICogQHBhcmFtIHBhdHRlcm4gLSBzZWUgZmV0Y2hlciNoYW5kbGVQYXR0ZXJuDQogKiBAcmV0dXJucyB7UHJvbWlzZX0gLSByZXNvbHZlIHdpdGggZmV0Y2hlZCByZXN1bHQgb3INCiAqIGEgcmVkaXJlY3QgdXJsIGlmIGRpZmZlcmVudCBvcmlnaW4gcmVkaXJlY3QgaGFwcGVuZWQNCiAqLw0KZnVuY3Rpb24gaGFuZGxlUGFnZSh1cmwsIHBhdHRlcm4pIHsNCiAgICB2YXIgaXNSZWRpcmVjdDsNCiAgICByZXR1cm4gZ2V0UGFnZSh1cmwpLnRoZW4oZnVuY3Rpb24oaHRtbCkgew0KICAgICAgICBpc1JlZGlyZWN0ID0gdHlwZW9mIGh0bWwgPT0gJ29iamVjdCc7DQogICAgICAgIHJldHVybiBpc1JlZGlyZWN0ID8gaHRtbCA6IHBhcnNlRG9jKHBhdHRlcm4sIGh0bWwpOw0KICAgICAgICAvL3BhcnNlRG9jIHJldHVybnMgYSBwcm9taXNlLCBzbyB0aGUgbWVyZ2UgY2FsbGJhY2sgd291bGQgYmUgZmlyZWQgdGlsbCB0aGUgcHJvbWlzZSByZXNvbHZlZA0KICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0cykgew0KICAgICAgICByZXR1cm4gaXNSZWRpcmVjdCA/IHJlc3VsdHMucmVkaXJlY3QgOiBtZXJnZShyZXN1bHRzKTsNCiAgICB9KQ0KfQ0KDQpmdW5jdGlvbiBoYW5kbGVET00ocGF0dGVybikgew0KDQp9DQoNCmZ1bmN0aW9uIGhhbmRsZUltYWdlKCkgew0KICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKSwNCiAgICAgICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyksDQogICAgICAgIGltZyA9IG5ldyBJbWFnZSgpLA0KICAgICAgICB0eXBlOw0KDQogICAgaWYgKElNQUdFX1RZUEVfUkUudGVzdChsb2NhdGlvbi5ocmVmKSkgew0KICAgICAgICB0eXBlID0gUmVnRXhwLiQxOw0KICAgICAgICBpZiAofklNQUdFX1RZUEVTLmluZGV4T2YodHlwZSkpIHsNCiAgICAgICAgICAgIGlmICh0eXBlID09ICdqcGcnKQ0KICAgICAgICAgICAgICAgIHR5cGUgPSAnanBlZyc7DQogICAgICAgICAgICB0eXBlID0gJ2ltYWdlLycgKyB0eXBlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdHlwZSA9ICdpbWFnZS9qcGVnJzsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlaikgew0KICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXMoZ2V0RGF0YVVybCgpKQ0KICAgICAgICB9Ow0KICAgICAgICBpbWcub25lcnJvciA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmVqKEVycm9yKGltZy5zcmMgKyAnIGxvYWQgZmFpbGVkJykpOw0KICAgICAgICB9Ow0KICAgICAgICBpbWcuc3JjID0gbG9jYXRpb24uaHJlZjsNCiAgICB9KTsNCg0KICAgIGZ1bmN0aW9uIGdldERhdGFVcmwoKSB7DQogICAgICAgIGNhbnZhcy53aWR0aCA9IGltZy5uYXR1cmFsV2lkdGg7DQogICAgICAgIGNhbnZhcy5oZWlnaHQgPSBpbWcubmF0dXJhbEhlaWdodDsNCiAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIDApOw0KICAgICAgICByZXR1cm4ge2RhdGFVcmw6IGNhbnZhcy50b0RhdGFVUkwodHlwZSl9DQogICAgfQ0KfQ0KDQovKioNCiAqIOacrOadpeaYr+S9nOS4uue8k+WtmOS7juWtl+espuS4suaehOmAoOWHuueahOato+WImeeUqOeahO+8jOS9huaXoueEtuato+WImeiDvemAmui/h3Bvc3RNZXNzYWdl5p2l5Lyg77yM6YKj5Ly85LmO5rKh5b+F6KaB5YaN55So6L+Z5Liq5LqGDQogKiDlhbblrp7ov5nkuKrmnoTpgKDmraPliJnnmoTmlrnlvI/mnInor68o6YCa6L+H5a2X56ym5Liy5p6E6YCg5q2j5YiZ5LiN6IO95YyF5ZCr5L2c5Li65a2X6Z2i5q2j5YiZ5qCH6K+G55qEYC9gLOW5tuS4lGlnbeS5n+S4jeiDveWMheWQq+OAgikNCiAqLw0KdmFyIGdldFJFID0gKGZ1bmN0aW9uKCkgew0KICAgIHZhciBjYWNoZSA9IFtdOw0KICAgIHJldHVybiBmdW5jdGlvbihyZVN0cikgew0KICAgICAgICBpZiAodHlwZW9mIHJlU3RyICE9ICdzdHJpbmcnIHx8ICFSRUdFWFBfUkUudGVzdChyZVN0cikpDQogICAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IoJ3JlU3RyIG11c3QgYmUgYSBSZWdFeHAtbGlrZSBzdHJpbmcnKTsNCiAgICAgICAgcmV0dXJuIGNhY2hlW3JlU3RyXSA9IGNhY2hlW3JlU3RyXSB8fCBuZXcgUmVnRXhwKHJlU3RyKTsNCiAgICB9DQp9KCkpOw0KDQovKioNCiAqDQogKiBAcGFyYW0gcGF0dGVybiAtIFtbcmVnZXhwLCB7a2V5MTogaW5kZXgxLCBrZXkyOiBpbmRleDJ9XSB8IGZ1bmN0aW9uLXN0eWxlLXN0cmluZywuLl0NCiAqIEBwYXJhbSBkb2MNCiAqIEByZXR1cm5zIHsqfFByb21pc2V9DQogKi8NCmZ1bmN0aW9uIHBhcnNlRG9jKHBhdHRlcm4sIGRvYykgew0KICAgIHZhciBkb2NTdHJpbmcgPSB0eXBlb2YgZG9jID09ICdzdHJpbmcnID8gZG9jIDogZG9jLm91dGVySFRNTCwNCiAgICAgICAgcmVzdWx0cyA9IFtdOw0KICAgIHBhdHRlcm4uZm9yRWFjaChmdW5jdGlvbihwKSB7DQogICAgICAgIGlmICh0eXBlb2YgcCA9PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgaWYgKEZVTkNUSU9OX1JFLnRlc3QocCkpDQogICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKGV2YWwoJygnICsgcCArICcpJykoZG9jKSk7DQogICAgICAgIH0gZWxzZSBpZiAocCBpbnN0YW5jZW9mIEFycmF5KSB7DQogICAgICAgICAgICBpZiAoIShwWzBdIGluc3RhbmNlb2YgUmVnRXhwKSkNCiAgICAgICAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IocFswXSArICcgc2hvdWxkIGJlIGEgUmVnRXhwJykNCiAgICAgICAgICAgIGRvY1N0cmluZy5yZXBsYWNlKHBbMF0sIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcFsxXSkgew0KICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IGFyZ3VtZW50c1twWzFdW2tleV1dOw0KICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2gocmVzdWx0KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2UgdGhyb3cgRXJyb3IoJ3doYXQgaGFwcGVuZWQnKQ0KICAgIH0pOw0KICAgIC8vVE9ETzogaWYgZXZlcnkgcmVzdWx0IGNvcnJlc3BvbmRzIHRvIGl0J3MgcGF0dGVybiwgYW5hbHlzZSB3b3VsZCBiZSBtb3JlIGVhc3kuDQogICAgLy90aGUgcHJvbWlzZSByZXR1cm5lZCBieSBhbGwoZnVuYykgd291bGQgYmUgcmVzb2x2ZWQgdGlsbCBhbGwgcHJvbWlzZXMgaW4gcmVzdWx0cyBhcmUgcmVzb2x2ZWQNCiAgICByZXR1cm4gUHJvbWlzZS5hbGwocmVzdWx0cykNCn0NCg0KLyoqDQogKiDlkIjlubbkuKpwYXR0ZXJu5Lqn55Sf55qE57uT5p6c5Yiw5LiA5Liq5oC757uT5p6cDQogKiBAcGFyYW0gcmVzdWx0cyAtIFt7aW1nOlsnMScsICcyJ10sIGxpbms6IFsnMScsICcyJ119LCB7aW1nOiAnMSd9LCB7bGluazogJzEnfV0NCiAqIEByZXR1cm5zIHtPYmplY3R9DQogKi8NCmZ1bmN0aW9uIG1lcmdlKHJlc3VsdHMpIHsNCiAgICB2YXIgcmV0ID0ge307DQogICAgcmVzdWx0cyAmJiByZXN1bHRzLmZvckVhY2goZnVuY3Rpb24oY3VyKSB7DQogICAgICAgIHZhciBrZXksIHR5cGU7DQogICAgICAgIGlmIChjdXIpIHsNCiAgICAgICAgICAgIGZvciAoa2V5IGluIGN1cikgew0KICAgICAgICAgICAgICAgIGlmICghcmV0W2tleV0pDQogICAgICAgICAgICAgICAgICAgIHJldFtrZXldID0gW107DQogICAgICAgICAgICAgICAgLy9pZiB1c2UgcHVzaC5hcHBseSwgdGhlIGFjdHVhbCBsZW5ndGggbWF5IGV4Y2VlZCB0aGUgbGltaXQgb2YgYXJndW1lbnRzJyBsZW5ndGgNCiAgICAgICAgICAgICAgICB0eXBlID0gdHlwZW9mIGN1cltrZXldOw0KICAgICAgICAgICAgICAgIGlmICh0eXBlID09ICdzdHJpbmcnKQ0KICAgICAgICAgICAgICAgICAgICByZXRba2V5XS5wdXNoKGN1cltrZXldKTsNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHJldFtrZXldID0gcmV0W2tleV0uY29uY2F0KGN1cltrZXldKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgZm9yICh2YXIga2V5IGluIHJldCkgew0KICAgICAgICB2YXIgdmFsdWVzID0gcmV0W2tleV0uc29ydCgpLCBwcmV2Ow0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgdmFyIGN1ciA9IHZhbHVlc1tpXTsNCiAgICAgICAgICAgIGlmICghY3VyIHx8IHByZXYgPT0gY3VyKSB2YWx1ZXMuc3BsaWNlKGktLSwgMSk7DQogICAgICAgICAgICBlbHNlIHByZXYgPSBjdXI7DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuIHJldDsNCn0NCg0KZnVuY3Rpb24gY2hlY2tBdXRoKGF1dGgpIHsNCiAgICAvL1RPRE86IHRvIGJlIGNvbXBsZXRlZA0KICAgIHJldHVybiB0cnVlDQp9DQoNCi8qKg0KICog5Yip55SoeGhy6K+35rGCdXJs5oyH5a6a55qE572R6aG177yM6L+U5Zue5LiA5LiqUHJvbWlzZSAocmVzb2x2ZSB3aXRoIHhoci5yZXNwb25zZSkNCiAqIEBwYXJhbSB1cmwNCiAqIEByZXR1cm5zIHtQcm9taXNlfQ0KICovDQpmdW5jdGlvbiBnZXRQYWdlKHVybCkgew0KICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlaikgew0KICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7DQogICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0KSB7DQogICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMpIHsNCiAgICAgICAgICAgICAgICAgICAgcmVzKHhoci5yZXNwb25zZSB8fCAnJyk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gc3VwcG9zZSBpdCdzIGEgZGlmZmVyZW50IG9yaWdpbiByZWRpcmVjdCByZXNwb25zZQ0KICAgICAgICAgICAgICAgICAgICBpZiAoVVJMX0FSR1VNRU5UX1JFLnRlc3QodXJsKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHtyZWRpcmVjdDogZGVjb2RlVVJJQ29tcG9uZW50KFJlZ0V4cC4kMSl9KTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZygnZmV0Y2ggZmFpbGVkJywgdXJsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcygnJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLyppZiAoKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPCAzMDApIHx8IHhoci5zdGF0dXMgPT0gMzA0KSB7DQogICAgICAgICAgICAgICAgIHJlcyh4aHIucmVzcG9uc2UpDQogICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgIGxvZygnZmV0Y2ggZmFpbGVkJywgdXJsKTsNCiAgICAgICAgICAgICAgICAgbG9nKHhocik7DQogICAgICAgICAgICAgICAgIHJlaih4aHIpOw0KICAgICAgICAgICAgICAgICB9Ki8NCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCiAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7DQogICAgICAgIHhoci5zZW5kKCkNCiAgICB9KQ0KfQ0KDQp9KSgpOw==",
                "body": "Ly8gPT1Vc2VyU2NyaXB0PT0NCi8vIEBuYW1lIEJsdWVDcmF3bGVyDQovLyBAbmFtZXNwYWNlIGh0dHA6Ly91c2UuaS5FLnlvdXIuaG9tZXBhZ2UvDQovLyBAdmVyc2lvbiAwLjENCi8vIEBkZXNjcmlwdGlvbiBlbnRlciBzb21ldGhpbmcgdXNlZnVsDQovLyBAbWF0Y2ggaHR0cDovLyovKg0KLy8gQG1hdGNoIGh0dHBzOi8vKi8qDQovLyBAY29weXJpZ2h0IDIwMTQrLCBHb2QtbGlrZQ0KLy8gPT0vVXNlclNjcmlwdD09DQoNCihmdW5jdGlvbigpIHsNCg0KaWYgKHRvcCA9PT0gd2luZG93ICYmICF+bG9jYXRpb24uc2VhcmNoLmluZGV4T2YoJ3RlbnRhY2xlPXRvcCcpKQ0KICAgIHJldHVybjsNCg0KdmFyIFJFR0VYUF9SRSA9IC9eXC8uK1wvKD8hLiooW2ltZ10pLipcMS4qJClbaW1nXXswLDN9JC8sDQogICAgRlVOQ1RJT05fUkUgPSAvXmZ1bmN0aW9uXHMqP1woW1xzXFNdKj9cKVxzKj9ce1tcc1xTXSo/fVxzKiQvLA0KICAgIFVSTF9BUkdVTUVOVF9SRSA9IC89KGh0dHBzPyUzQSUyRiUyRi4rPykoJnwkKS8sDQogICAgSU1BR0VfVFlQRV9SRSA9IC9eLitcLihcdyspJC8sDQogICAgSU1BR0VfVFlQRVMgPSBbJ2pwZycsICdqcGVnJywgJ3BuZyddLA0KDQogICAgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UsDQogICAgZmV0Y2hUeXBlcyA9IFsnaW1nJywgJ3N0cicsICdkb20nXTsNCg0KdmFyIF9sb2cgPSBjb25zb2xlLmxvZywgbG9nOw0KY29uc29sZS5sb2cgPSBmdW5jdGlvbigpIHsNCiAgICB2YXIgYXJnczsNCiAgICBpZiAoYXJndW1lbnRzWzBdICE9ICd0ZW50YWNsZScpIHsNCiAgICAgICAgcmV0dXJuDQogICAgfQ0KICAgIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7DQogICAgYXJncy51bnNoaWZ0KCcjI0xPRyMjOiBmcmFtZSwgJyArIGxvY2F0aW9uLm9yaWdpbiArICc6ICcpOw0KICAgIF9sb2cuYXBwbHkoY29uc29sZSwgYXJncykNCn0NCmxvZyA9IGNvbnNvbGUubG9nLmJpbmQobnVsbCwgJ3RlbnRhY2xlJyk7DQoNCndpbmRvdy5wYXJlbnQgIT09IHdpbmRvdyAmJiB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHsNCiAgICB0eXBlOiAnZnJhbWUnLA0KICAgIGZldGNoVHlwZTogd2luZG93Lm5hbWUsDQogICAgdXJsOiBsb2NhdGlvblt3aW5kb3cubmFtZSA9PSAnc3RyJyA/ICdvcmlnaW4nIDogJ2hyZWYnXQ0KfSwgJyonKTsNCg0Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbihldmVudCkgew0KICAgIC8qKg0KICAgICAqIGV2ZW50LmRhdGEgOg0KICAgICAqIHsNCiAgICAgKiAgIHR5cGU6IGltYWdlTG9hZCxmZXRjaA0KICAgICAqICAgcGF0dGVybjogW3N0cmluZyB8IFJlZ0V4cC1saWtlIHN0cmluZyB8IEZ1bmN0aW9uIHwgW10gXSBzZWUgZGV0YWlsIGluIGZldGNoZXINCiAgICAgKiAgIGV2ZW50SWQ6IHNlZSBpZnJhbWVGZXRjaGVyLA0KICAgICAqICAgdXJsOiB0aGUgdGFyZ2V0IHBhZ2UgdXJsICwgdHlwZSBtdXN0IGJlIGZldGNoIGlmIGl0J3MgdmFsaWQNCiAgICAgKiAgIGF1dGg6IHRoZSBwYWdlIGluIGlmcmFtZSBtYXkgaGF2ZSBzb21lIHN1Yi1pZnJhbWUsIHNvIHByZXZlbnQgaXQuIChhbmQgYWxzbyB3aW5kb3cgY2FuIHBvc3RtZXNzYWdlIHRvIGl0c2VsZikNCiAgICAgKiB9DQogICAgICovDQogICAgdmFyIGRhdGEgPSBldmVudC5kYXRhLA0KICAgICAgICB1cmwgPSBkYXRhLnVybCB8fCBsb2NhdGlvbi5ocmVmLA0KICAgICAgICB0eXBlID0gZGF0YS50eXBlLA0KICAgICAgICBwcm9taXNlOw0KDQogICAgaWYgKCFmZXRjaFR5cGVzLnNvbWUoZnVuY3Rpb24oX3R5cGUpIHsNCiAgICAgICAgcmV0dXJuIF90eXBlID09IHR5cGUNCiAgICB9KSB8fCAhY2hlY2tBdXRoKGRhdGEuYXV0aCkpDQogICAgICAgIHJldHVybjsNCiAgICBzd2l0Y2ggKHR5cGUpIHsNCiAgICAgICAgY2FzZSAnaW1nJzoNCiAgICAgICAgICAgIHByb21pc2UgPSBoYW5kbGVJbWFnZSgpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ3N0cic6DQogICAgICAgICAgICBwcm9taXNlID0gaGFuZGxlUGFnZSh1cmwsIGRhdGEucGF0dGVybik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnZG9tJzoNCiAgICAgICAgICAgIHByb21pc2UgPSBoYW5kbGVET00oZGF0YS5wYXR0ZXJuKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgIH0NCiAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7DQogICAgICAgIGV2ZW50LnNvdXJjZS5wb3N0TWVzc2FnZSh7DQogICAgICAgICAgICB1cmw6IHVybCwNCiAgICAgICAgICAgIHJlc3VsdDogcmVzdWx0LA0KICAgICAgICAgICAgdHlwZTogdHlwZW9mIHJlc3VsdCA9PSAnc3RyaW5nJyAmJiB0eXBlICE9ICdpbWcnID8gJ3JlZGlyZWN0JyA6IHR5cGUsDQogICAgICAgICAgICB0YXJnZXRJZDogZGF0YS50YXJnZXRJZA0KICAgICAgICB9LCBldmVudC5vcmlnaW4gPT09ICdudWxsJyA/ICcqJyA6IGV2ZW50Lm9yaWdpbikNCiAgICB9KQ0KfSkNCg0KLyoqDQogKiDor7fmsYLotYTmupDnsbvlnovkuLrigJxzdHLigJ3vvIzku6V4aHLlvaLlvI/or7fmsYLnvZHpobXvvIzlubZwYXR0ZXJu5Lulc3RyaW5n5b2i5byP6Kej5p6Q572R6aG15bm26L+U5Zue6LWE5rqQDQogKiBAcGFyYW0gdXJsDQogKiBAcGFyYW0gcGF0dGVybiAtIHNlZSBmZXRjaGVyI2hhbmRsZVBhdHRlcm4NCiAqIEByZXR1cm5zIHtQcm9taXNlfSAtIHJlc29sdmUgd2l0aCBmZXRjaGVkIHJlc3VsdCBvcg0KICogYSByZWRpcmVjdCB1cmwgaWYgZGlmZmVyZW50IG9yaWdpbiByZWRpcmVjdCBoYXBwZW5lZA0KICovDQpmdW5jdGlvbiBoYW5kbGVQYWdlKHVybCwgcGF0dGVybikgew0KICAgIHZhciBpc1JlZGlyZWN0Ow0KICAgIHJldHVybiBnZXRQYWdlKHVybCkudGhlbihmdW5jdGlvbihodG1sKSB7DQogICAgICAgIGlzUmVkaXJlY3QgPSB0eXBlb2YgaHRtbCA9PSAnb2JqZWN0JzsNCiAgICAgICAgcmV0dXJuIGlzUmVkaXJlY3QgPyBodG1sIDogcGFyc2VEb2MocGF0dGVybiwgaHRtbCk7DQogICAgICAgIC8vcGFyc2VEb2MgcmV0dXJucyBhIHByb21pc2UsIHNvIHRoZSBtZXJnZSBjYWxsYmFjayB3b3VsZCBiZSBmaXJlZCB0aWxsIHRoZSBwcm9taXNlIHJlc29sdmVkDQogICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHRzKSB7DQogICAgICAgIHJldHVybiBpc1JlZGlyZWN0ID8gcmVzdWx0cy5yZWRpcmVjdCA6IG1lcmdlKHJlc3VsdHMpOw0KICAgIH0pDQp9DQoNCmZ1bmN0aW9uIGhhbmRsZURPTShwYXR0ZXJuKSB7DQoNCn0NCg0KZnVuY3Rpb24gaGFuZGxlSW1hZ2UoKSB7DQogICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpLA0KICAgICAgICBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSwNCiAgICAgICAgaW1nID0gbmV3IEltYWdlKCksDQogICAgICAgIHR5cGU7DQoNCiAgICBpZiAoSU1BR0VfVFlQRV9SRS50ZXN0KGxvY2F0aW9uLmhyZWYpKSB7DQogICAgICAgIHR5cGUgPSBSZWdFeHAuJDE7DQogICAgICAgIGlmICh+SU1BR0VfVFlQRVMuaW5kZXhPZih0eXBlKSkgew0KICAgICAgICAgICAgaWYgKHR5cGUgPT0gJ2pwZycpDQogICAgICAgICAgICAgICAgdHlwZSA9ICdqcGVnJzsNCiAgICAgICAgICAgIHR5cGUgPSAnaW1hZ2UvJyArIHR5cGU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0eXBlID0gJ2ltYWdlL2pwZWcnOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKSB7DQogICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJlcyhnZXREYXRhVXJsKCkpDQogICAgICAgIH07DQogICAgICAgIGltZy5vbmVycm9yID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZWooRXJyb3IoaW1nLnNyYyArICcgbG9hZCBmYWlsZWQnKSk7DQogICAgICAgIH07DQogICAgICAgIGltZy5zcmMgPSBsb2NhdGlvbi5ocmVmOw0KICAgIH0pOw0KDQogICAgZnVuY3Rpb24gZ2V0RGF0YVVybCgpIHsNCiAgICAgICAgY2FudmFzLndpZHRoID0gaW1nLm5hdHVyYWxXaWR0aDsNCiAgICAgICAgY2FudmFzLmhlaWdodCA9IGltZy5uYXR1cmFsSGVpZ2h0Ow0KICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgMCwgMCk7DQogICAgICAgIHJldHVybiB7ZGF0YVVybDogY2FudmFzLnRvRGF0YVVSTCh0eXBlKX0NCiAgICB9DQp9DQoNCi8qKg0KICog5pys5p2l5piv5L2c5Li657yT5a2Y5LuO5a2X56ym5Liy5p6E6YCg5Ye655qE5q2j5YiZ55So55qE77yM5L2G5pei54S25q2j5YiZ6IO96YCa6L+HcG9zdE1lc3NhZ2XmnaXkvKDvvIzpgqPkvLzkuY7msqHlv4XopoHlho3nlKjov5nkuKrkuoYNCiAqIOWFtuWunui/meS4quaehOmAoOato+WImeeahOaWueW8j+acieivryjpgJrov4flrZfnrKbkuLLmnoTpgKDmraPliJnkuI3og73ljIXlkKvkvZzkuLrlrZfpnaLmraPliJnmoIfor4bnmoRgL2As5bm25LiUaWdt5Lmf5LiN6IO95YyF5ZCr44CCKQ0KICovDQp2YXIgZ2V0UkUgPSAoZnVuY3Rpb24oKSB7DQogICAgdmFyIGNhY2hlID0gW107DQogICAgcmV0dXJuIGZ1bmN0aW9uKHJlU3RyKSB7DQogICAgICAgIGlmICh0eXBlb2YgcmVTdHIgIT0gJ3N0cmluZycgfHwgIVJFR0VYUF9SRS50ZXN0KHJlU3RyKSkNCiAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcigncmVTdHIgbXVzdCBiZSBhIFJlZ0V4cC1saWtlIHN0cmluZycpOw0KICAgICAgICByZXR1cm4gY2FjaGVbcmVTdHJdID0gY2FjaGVbcmVTdHJdIHx8IG5ldyBSZWdFeHAocmVTdHIpOw0KICAgIH0NCn0oKSk7DQoNCi8qKg0KICoNCiAqIEBwYXJhbSBwYXR0ZXJuIC0gW1tyZWdleHAsIHtrZXkxOiBpbmRleDEsIGtleTI6IGluZGV4Mn1dIHwgZnVuY3Rpb24tc3R5bGUtc3RyaW5nLC4uXQ0KICogQHBhcmFtIGRvYw0KICogQHJldHVybnMgeyp8UHJvbWlzZX0NCiAqLw0KZnVuY3Rpb24gcGFyc2VEb2MocGF0dGVybiwgZG9jKSB7DQogICAgdmFyIGRvY1N0cmluZyA9IHR5cGVvZiBkb2MgPT0gJ3N0cmluZycgPyBkb2MgOiBkb2Mub3V0ZXJIVE1MLA0KICAgICAgICByZXN1bHRzID0gW107DQogICAgcGF0dGVybi5mb3JFYWNoKGZ1bmN0aW9uKHApIHsNCiAgICAgICAgaWYgKHR5cGVvZiBwID09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICBpZiAoRlVOQ1RJT05fUkUudGVzdChwKSkNCiAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goZXZhbCgnKCcgKyBwICsgJyknKShkb2MpKTsNCiAgICAgICAgfSBlbHNlIGlmIChwIGluc3RhbmNlb2YgQXJyYXkpIHsNCiAgICAgICAgICAgIGlmICghKHBbMF0gaW5zdGFuY2VvZiBSZWdFeHApKQ0KICAgICAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcihwWzBdICsgJyBzaG91bGQgYmUgYSBSZWdFeHAnKQ0KICAgICAgICAgICAgZG9jU3RyaW5nLnJlcGxhY2UocFswXSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9Ow0KICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwWzFdKSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gYXJndW1lbnRzW3BbMV1ba2V5XV07DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB0aHJvdyBFcnJvcignd2hhdCBoYXBwZW5lZCcpDQogICAgfSk7DQogICAgLy9UT0RPOiBpZiBldmVyeSByZXN1bHQgY29ycmVzcG9uZHMgdG8gaXQncyBwYXR0ZXJuLCBhbmFseXNlIHdvdWxkIGJlIG1vcmUgZWFzeS4NCiAgICAvL3RoZSBwcm9taXNlIHJldHVybmVkIGJ5IGFsbChmdW5jKSB3b3VsZCBiZSByZXNvbHZlZCB0aWxsIGFsbCBwcm9taXNlcyBpbiByZXN1bHRzIGFyZSByZXNvbHZlZA0KICAgIHJldHVybiBQcm9taXNlLmFsbChyZXN1bHRzKQ0KfQ0KDQovKioNCiAqIOWQiOW5tuS4qnBhdHRlcm7kuqfnlJ/nmoTnu5PmnpzliLDkuIDkuKrmgLvnu5PmnpwNCiAqIEBwYXJhbSByZXN1bHRzIC0gW3tpbWc6WycxJywgJzInXSwgbGluazogWycxJywgJzInXX0sIHtpbWc6ICcxJ30sIHtsaW5rOiAnMSd9XQ0KICogQHJldHVybnMge09iamVjdH0NCiAqLw0KZnVuY3Rpb24gbWVyZ2UocmVzdWx0cykgew0KICAgIHZhciByZXQgPSB7fTsNCiAgICByZXN1bHRzICYmIHJlc3VsdHMuZm9yRWFjaChmdW5jdGlvbihjdXIpIHsNCiAgICAgICAgdmFyIGtleSwgdHlwZTsNCiAgICAgICAgaWYgKGN1cikgew0KICAgICAgICAgICAgZm9yIChrZXkgaW4gY3VyKSB7DQogICAgICAgICAgICAgICAgaWYgKCFyZXRba2V5XSkNCiAgICAgICAgICAgICAgICAgICAgcmV0W2tleV0gPSBbXTsNCiAgICAgICAgICAgICAgICAvL2lmIHVzZSBwdXNoLmFwcGx5LCB0aGUgYWN0dWFsIGxlbmd0aCBtYXkgZXhjZWVkIHRoZSBsaW1pdCBvZiBhcmd1bWVudHMnIGxlbmd0aA0KICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlb2YgY3VyW2tleV07DQogICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gJ3N0cmluZycpDQogICAgICAgICAgICAgICAgICAgIHJldFtrZXldLnB1c2goY3VyW2tleV0pOw0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgcmV0W2tleV0gPSByZXRba2V5XS5jb25jYXQoY3VyW2tleV0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSk7DQoNCiAgICBmb3IgKHZhciBrZXkgaW4gcmV0KSB7DQogICAgICAgIHZhciB2YWx1ZXMgPSByZXRba2V5XS5zb3J0KCksIHByZXY7DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgY3VyID0gdmFsdWVzW2ldOw0KICAgICAgICAgICAgaWYgKCFjdXIgfHwgcHJldiA9PSBjdXIpIHZhbHVlcy5zcGxpY2UoaS0tLCAxKTsNCiAgICAgICAgICAgIGVsc2UgcHJldiA9IGN1cjsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gcmV0Ow0KfQ0KDQpmdW5jdGlvbiBjaGVja0F1dGgoYXV0aCkgew0KICAgIC8vVE9ETzogdG8gYmUgY29tcGxldGVkDQogICAgcmV0dXJuIHRydWUNCn0NCg0KLyoqDQogKiDliKnnlKh4aHLor7fmsYJ1cmzmjIflrprnmoTnvZHpobXvvIzov5Tlm57kuIDkuKpQcm9taXNlIChyZXNvbHZlIHdpdGggeGhyLnJlc3BvbnNlKQ0KICogQHBhcmFtIHVybA0KICogQHJldHVybnMge1Byb21pc2V9DQogKi8NCmZ1bmN0aW9uIGdldFBhZ2UodXJsKSB7DQogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKSB7DQogICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCiAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09IDQpIHsNCiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cykgew0KICAgICAgICAgICAgICAgICAgICByZXMoeGhyLnJlc3BvbnNlIHx8ICcnKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvLyBzdXBwb3NlIGl0J3MgYSBkaWZmZXJlbnQgb3JpZ2luIHJlZGlyZWN0IHJlc3BvbnNlDQogICAgICAgICAgICAgICAgICAgIGlmIChVUkxfQVJHVU1FTlRfUkUudGVzdCh1cmwpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXMoe3JlZGlyZWN0OiBkZWNvZGVVUklDb21wb25lbnQoUmVnRXhwLiQxKX0pOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgbG9nKCdmZXRjaCBmYWlsZWQnLCB1cmwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzKCcnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvKmlmICgoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8IDMwMCkgfHwgeGhyLnN0YXR1cyA9PSAzMDQpIHsNCiAgICAgICAgICAgICAgICAgcmVzKHhoci5yZXNwb25zZSkNCiAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgbG9nKCdmZXRjaCBmYWlsZWQnLCB1cmwpOw0KICAgICAgICAgICAgICAgICBsb2coeGhyKTsNCiAgICAgICAgICAgICAgICAgcmVqKHhocik7DQogICAgICAgICAgICAgICAgIH0qLw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KICAgICAgICB4aHIub3BlbignR0VUJywgdXJsKTsNCiAgICAgICAgeGhyLnNlbmQoKQ0KICAgIH0pDQp9DQoNCn0pKCk7",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 12:57:20 GMT",
                    "Content-Length": "8175",
                    "Date": "Thu, 06 Nov 2014 12:57:23 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}