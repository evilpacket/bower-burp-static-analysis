{
    "url": "http://localhost:9999/jdorn/json-editor/demo.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>window.location.href</b> and written to <b>the 'value' property of a DOM element</b> via the following statement:<ul><li>document.getElementById('show_errors').value = (window.location.href.match(/[?&amp;]show_errors=([^&amp;]+)/)||[])[1] || 'interaction';</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/jdorn/json-editor/demo.html",
                "path": "/jdorn/json-editor/demo.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9qZG9ybi9qc29uLWVkaXRvci9kZW1vLmh0bWwgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTY4MDUNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAwNzo0MTozMCBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMDc6NDE6MzAgR01UDQoNCjwhRE9DVFlQRSBodG1sPgo8aHRtbD4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCIgLz4KICAgIDx0aXRsZT5KU09OIEVkaXRvciBFeGFtcGxlPC90aXRsZT4KCiAgICA8IS0tIHBsYWNlaG9sZGVycyBmb3IgdGhlIHRoZW1lIHN3aXRjaGVyIC0tPgogICAgPGxpbmsgcmVsPSdzdHlsZXNoZWV0JyBpZD0ndGhlbWVfc3R5bGVzaGVldCc+CiAgICA8bGluayByZWw9J3N0eWxlc2hlZXQnIGlkPSdpY29uX3N0eWxlc2hlZXQnPgoKICAgIDxzdHlsZT5bY2xhc3MqPSJmb3VuZGljb24tIl0ge2ZvbnQtZmFtaWx5OiBHZW5lcmFsRm91bmRpY29ucztmb250LXN0eWxlOiBub3JtYWw7fTwvc3R5bGU+CiAgICA8c2NyaXB0IHNyYz0nZGlzdC9qc29uZWRpdG9yLmpzJz48L3NjcmlwdD4KICAgIDwhLS0gVGhpcyBsaWJyYXJ5IGlzIHVzZWQgdG8gcHJvdmlkZSBkaXJlY3QgbGlua3MgdG8gdGhlIGRlbW8uICBJdCBpcyBub3QgcmVxdWlyZWQgZm9yIEpTT04gRWRpdG9yIC0tPgogICAgPHNjcmlwdCBzcmM9J2h0dHBzOi8vY2RuLnJhd2dpdC5jb20vcGllcm94eS9sei1zdHJpbmcvbWFzdGVyL2xpYnMvcmVsZWFzZS9sei1zdHJpbmctMS4zLjMtbWluLmpzJz48L3NjcmlwdD4KPC9oZWFkPgo8Ym9keT4KPGRpdiBjbGFzcz0nY29udGFpbmVyJz4KICAgIDxkaXYgY2xhc3M9J3Jvdyc+CiAgICAgICAgPGRpdiBjbGFzcz0nc3BhbjggY29sLW1kLTggY29sdW1ucyBlaWdodCBsYXJnZS04Jz4KICAgICAgICAgICAgPGgyPkVkaXRvcjwvaDI+CiAgICAgICAgICAgIDxwPkJlbG93IGlzIHRoZSBlZGl0b3IgZ2VuZXJhdGVkIGZyb20gdGhlIEpTT04gU2NoZW1hLjwvcD4KCiAgICAgICAgICAgIDxkaXYgaWQ9J2VkaXRvcic+PC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0nc3BhbjQgY29sLW1kLTQgY29sdW1ucyBmb3VyIGxhcmdlLTQnPgogICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgPGEgaHJlZj0nIycgaWQ9J2RpcmVjdF9saW5rJz5EaXJlY3QgTGluazwvYT4gKHByZXNlcnZlcyBzY2hlbWEsIHZhbHVlLCBhbmQgb3B0aW9ucykKICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICA8aDI+SlNPTiBPdXRwdXQ8L2gyPgogICAgICAgICAgICA8cD5Zb3UgY2FuIGFsc28gbWFrZSBjaGFuZ2VzIHRvIHRoZSBKU09OIGhlcmUgYW5kIHNldCB0aGUgdmFsdWUgaW4gdGhlIGVkaXRvciBieSBjbGlja2luZyA8YnV0dG9uIGNsYXNzPSdidG4gYnRuLXByaW1hcnknIGlkPSdzZXR2YWx1ZSc+VXBkYXRlIEZvcm08L2J1dHRvbj48L3A+CiAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0nb3V0cHV0JyBzdHlsZT0nd2lkdGg6IDEwMCU7IGhlaWdodDogMzAwcHg7IGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7JyBjbGFzcz0nZm9ybS1jb250cm9sJz48L3RleHRhcmVhPgoKICAgICAgICAgICAgPGgyPk9wdGlvbnM8L2gyPgogICAgICAgICAgICA8ZGl2IGlkPSdvcHRpb25zX2hvbGRlcic+CiAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5DU1MgRnJhbWV3b3JrPC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSd0aGVtZV9zd2l0Y2hlcicgY2xhc3M9J2Zvcm0tY29udHJvbCc+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2h0bWwnPk5vbmU8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nanF1ZXJ5dWknPmpRdWVyeSBVSTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdib290c3RyYXAyJz5Cb290c3RyYXAgMjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdib290c3RyYXAzJz5Cb290c3RyYXAgMzwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdmb3VuZGF0aW9uMyc+Rm91bmRhdGlvbiAzPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2ZvdW5kYXRpb240Jz5Gb3VuZGF0aW9uIDQ8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZm91bmRhdGlvbjUnPkZvdW5kYXRpb24gNTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5JY29uIExpYnJhcnk8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9J2ljb25fc3dpdGNoZXInIGNsYXNzPSdmb3JtLWNvbnRyb2wnPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPScnPk5vbmU8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nanF1ZXJ5dWknPmpRdWVyeSBVSTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdib290c3RyYXAyJz5Cb290c3RyYXAgMiBHbHlwaGljb25zPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Jvb3RzdHJhcDMnPkJvb3RzdHJhcCAzIEdseXBoaWNvbnM8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZm91bmRhdGlvbjInPkZvdW5kaWNvbnMgMjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdmb3VuZGF0aW9uMyc+Rm91bmRpY29ucyAzPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2ZvbnRhd2Vzb21lMyc+Rm9udEF3ZXNvbWUgMzwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdmb250YXdlc29tZTQnPkZvbnRBd2Vzb21lIDQ8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+T2JqZWN0IExheW91dDwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0nb2JqZWN0X2xheW91dCcgY2xhc3M9J2Zvcm0tY29udHJvbCc+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J25vcm1hbCc+bm9ybWFsPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2dyaWQnPmdyaWQ8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICAgICAgICA8bGFiZWw+U2hvdyBFcnJvcnM8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9J3Nob3dfZXJyb3JzJyBjbGFzcz0nZm9ybS1jb250cm9sJz4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0naW50ZXJhY3Rpb24nPk9uIEludGVyYWN0aW9uPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2NoYW5nZSc+T24gRmllbGQgQ2hhbmdlPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Fsd2F5cyc+QWx3YXlzPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J25ldmVyJz5OZXZlcjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5Cb29sZWFuIG9wdGlvbnM8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgbXVsdGlwbGUgc2l6ZT05IGlkPSdib29sZWFuX29wdGlvbnMnIHN0eWxlPSd3aWR0aDogMTAwJTsnIGNsYXNzPSdmb3JtLWNvbnRyb2wnPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdyZXF1aXJlZF9ieV9kZWZhdWx0Jz5PYmplY3QgcHJvcGVydGllcyByZXF1aXJlZCBieSBkZWZhdWx0PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J25vX2FkZGl0aW9uYWxfcHJvcGVydGllcyc+Tm8gYWRkaXRpb25hbCBvYmplY3QgcHJvcGVydGllczwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdhamF4Jz5BbGxvdyBsb2FkaW5nIHNjaGVtYXMgdmlhIEFqYXg8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZGlzYWJsZV9lZGl0X2pzb24nPkRpc2FibGUgIkVkaXQgSlNPTiIgYnV0dG9uczwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdkaXNhYmxlX2NvbGxhcHNlJz5EaXNhYmxlIGNvbGxhcHNlIGJ1dHRvbnM8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZGlzYWJsZV9wcm9wZXJ0aWVzJz5EaXNhYmxlIHByb3BlcnRpZXMgYnV0dG9uczwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdkaXNhYmxlX2FycmF5X2FkZCc+RGlzYWJsZSBhcnJheSBhZGQgYnV0dG9uczwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdkaXNhYmxlX2FycmF5X3Jlb3JkZXInPkRpc2FibGUgYXJyYXkgbW92ZSBidXR0b25zPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Rpc2FibGVfYXJyYXlfZGVsZXRlJz5EaXNhYmxlIGFycmF5IGRlbGV0ZSBidXR0b25zPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICA8aDI+VmFsaWRhdGlvbjwvaDI+CiAgICAgICAgICAgIDxwPlRoaXMgd2lsbCB1cGRhdGUgd2hlbmV2ZXIgdGhlIGZvcm0gY2hhbmdlcyB0byBzaG93IHZhbGlkYXRpb24gZXJyb3JzIGlmIHRoZXJlIGFyZSBhbnkuPC9wPgogICAgICAgICAgICA8dGV4dGFyZWEgaWQ9J3ZhbGlkYXRlJyBzdHlsZT0nd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwcHg7IGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7JyByZWFkb25seSBkaXNhYmxlZCBjbGFzcz0nZm9ybS1jb250cm9sJz48L3RleHRhcmVhPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9J3Jvdyc+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9J3NwYW4xMiBjb2wtbWQtMTIgY29sdW1ucyB0d2VsdmUgbGFyZ2UtMTInPgogICAgICAgICAgICAgICAgPGgyPlNjaGVtYTwvaDI+CiAgICAgICAgICAgICAgICA8cD5Zb3UgY2FuIGNoYW5nZSB0aGUgc2NoZW1hIGFuZCBzZWUgaG93IHRoZSBnZW5lcmF0ZWQgZm9ybSBsb29rcy4gIEFmdGVyIHlvdSBtYWtlIGNoYW5nZXMsIGNsaWNrIDxidXR0b24gY2xhc3M9J2J0biBidG4tcHJpbWFyeScgaWQ9J3NldHNjaGVtYSc+VXBkYXRlIFNjaGVtYTwvYnV0dG9uPjwvcD4KCiAgICAgICAgICAgICAgICA8dGV4dGFyZWEgaWQ9J3NjaGVtYScgc3R5bGU9J3dpZHRoOiAxMDAlOyBoZWlnaHQ6IDQ1MHB4OyBmb250LWZhbWlseTogbW9ub3NwYWNlOycgY2xhc3M9J2Zvcm0tY29udHJvbCc+PC90ZXh0YXJlYT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ncm93Jz4KICAgICAgICAgICAgPGRpdiBjbGFzcz0nc3BhbjEyIGNvbC1tZC0xMiBjb2x1bW5zIHR3ZWx2ZSBsYXJnZS0xMic+CiAgICAgICAgICAgICAgICA8aDI+Q29kZTwvaDI+CiAgICAgIDxwcmU+PGNvZGU+Ly8gU2V0IGRlZmF1bHQgb3B0aW9ucwpKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnMudGhlbWUgPSAnYm9vdHN0cmFwMic7CgovLyBJbml0aWFsaXplIHRoZSBlZGl0b3IKdmFyIGVkaXRvciA9IG5ldyBKU09ORWRpdG9yKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlZGl0b3JfaG9sZGVyIiksewogIHNjaGVtYTogewogICAgICB0eXBlOiAib2JqZWN0IiwKICAgICAgcHJvcGVydGllczogewogICAgICAgICAgbmFtZTogeyAidHlwZSI6ICJzdHJpbmciIH0KICAgICAgfQogIH0KfSk7CgovLyBTZXQgdGhlIHZhbHVlCmVkaXRvci5zZXRWYWx1ZSh7CiAgICBuYW1lOiAiSm9obiBTbWl0aCIKfSk7CgovLyBHZXQgdGhlIHZhbHVlCnZhciBkYXRhID0gZWRpdG9yLmdldFZhbHVlKCk7CmNvbnNvbGUubG9nKGRhdGEubmFtZSk7IC8vICJKb2huIFNtaXRoIgoKLy8gVmFsaWRhdGUKdmFyIGVycm9ycyA9IGVkaXRvci52YWxpZGF0ZSgpOwppZihlcnJvcnMubGVuZ3RoKSB7CiAgLy8gTm90IHZhbGlkCn0KCi8vIExpc3RlbiBmb3IgY2hhbmdlcwplZGl0b3Iub24oImNoYW5nZSIsICBmdW5jdGlvbigpIHsKICAvLyBEbyBzb21ldGhpbmcuLi4KfSk7PC9jb2RlPjwvcHJlPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L2Rpdj4KPHNjcmlwdD4KKGZ1bmN0aW9uKCkgewogICAgdmFyIHNjaGVtYTsKICAgIGlmKHdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKCdbPyZdc2NoZW1hPShbXiZdKyknKSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNjaGVtYSA9IEpTT04ucGFyc2UoTFpTdHJpbmcuZGVjb21wcmVzc0Zyb21CYXNlNjQod2luZG93LmxvY2F0aW9uLmhyZWYubWF0Y2goJ1s/Jl1zY2hlbWE9KFteJl0rKScpWzFdKSk7CiAgICAgICAgfQogICAgICAgIGNhdGNoKGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ2ludmFsaWQgc3RhcnRpbmcgc2NoZW1hJyk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIERlZmF1bHQgc3RhcnRpbmcgc2NoZW1hCiAgICBpZighc2NoZW1hKSB7CiAgICAgICAgc2NoZW1hID0gewogICAgICAgICAgICB0aXRsZTogIlBlcnNvbiIsCiAgICAgICAgICAgIHR5cGU6ICJvYmplY3QiLAogICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICJGaXJzdCBhbmQgTGFzdCBuYW1lIiwKICAgICAgICAgICAgICAgICAgICBtaW5MZW5ndGg6IDQsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogIkplcmVteSBEb3JuIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGFnZTogewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJpbnRlZ2VyIiwKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiAyNSwKICAgICAgICAgICAgICAgICAgICBtaW5pbXVtOiAxOCwKICAgICAgICAgICAgICAgICAgICBtYXhpbXVtOiA5OQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGZhdm9yaXRlX2NvbG9yOiB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiAiY29sb3IiLAogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiZmF2b3JpdGUgY29sb3IiLAogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICIjZmZhNTAwIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGdlbmRlcjogewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciLAogICAgICAgICAgICAgICAgICAgIGVudW06IFsibWFsZSIsICJmZW1hbGUiXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGxvY2F0aW9uOiB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogIm9iamVjdCIsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJMb2NhdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczogewogICAgICAgICAgICAgICAgICAgICAgICBjaXR5OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICJTYW4gRnJhbmNpc2NvIgogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiAiQ0EiCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGNpdHlzdGF0ZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogIlRoaXMgaXMgZ2VuZXJhdGVkIGF1dG9tYXRpY2FsbHkgZnJvbSB0aGUgcHJldmlvdXMgdHdvIGZpZWxkcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogInt7Y2l0eX19LCB7e3N0YXRlfX0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F0Y2g6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaXR5OiAnbG9jYXRpb24uY2l0eScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGU6ICdsb2NhdGlvbi5zdGF0ZScKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBwZXRzOiB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogImFycmF5IiwKICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6ICJ0YWJsZSIsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJQZXRzIiwKICAgICAgICAgICAgICAgICAgICB1bmlxdWVJdGVtczogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBpdGVtczogewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAib2JqZWN0IiwKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJQZXQiLAogICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bTogWyJjYXQiLCJkb2ciLCJiaXJkIiwicmVwdGlsZSIsIm90aGVyIl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogImRvZyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInN0cmluZyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiZG9nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJXYWx0ZXIiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gRGl2cy90ZXh0YXJlYXMgb24gdGhlIHBhZ2UKICAgIHZhciAkc2NoZW1hID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjaGVtYScpOwogICAgdmFyICRvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3V0cHV0Jyk7CiAgICB2YXIgJGVkaXRvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0b3InKTsKICAgIHZhciAkdmFsaWRhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmFsaWRhdGUnKTsKCiAgICAvLyBCdXR0b25zCiAgICB2YXIgJHNldF9zY2hlbWFfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHNjaGVtYScpOwogICAgdmFyICRzZXRfdmFsdWVfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHZhbHVlJyk7CgogICAgdmFyIGpzb25lZGl0b3I7CgogICAgdmFyIHVwZGF0ZURpcmVjdExpbmsgPSBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvXD8uKi8sJycpOwoKICAgICAgICB1cmwgKz0gJz9zY2hlbWE9JytMWlN0cmluZy5jb21wcmVzc1RvQmFzZTY0KEpTT04uc3RyaW5naWZ5KHNjaGVtYSkpOwogICAgICAgIHVybCArPSAnJnZhbHVlPScrTFpTdHJpbmcuY29tcHJlc3NUb0Jhc2U2NChKU09OLnN0cmluZ2lmeShqc29uZWRpdG9yLmdldFZhbHVlKCkpKTsKCiAgICAgICAgZm9yKHZhciBpIGluIEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucykgewogICAgICAgICAgICBpZighSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zLmhhc093blByb3BlcnR5KGkpKSBjb250aW51ZTsKICAgICAgICAgICAgaWYoSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zW2ldPT09ZmFsc2UpIGNvbnRpbnVlOwogICAgICAgICAgICBlbHNlIGlmKEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9uc1tpXT09PXRydWUpIHsKICAgICAgICAgICAgICAgIHVybCArPSAnJicraTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHVybCArPSAnJicraSsnPScrSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zW2ldOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlyZWN0X2xpbmsnKS5ocmVmID0gdXJsOwogICAgfTsKCiAgICB2YXIgcmVsb2FkID0gZnVuY3Rpb24oa2VlcF92YWx1ZSkgewogICAgICAgIHZhciBzdGFydHZhbCA9IChqc29uZWRpdG9yICYmIGtlZXBfdmFsdWUpPyBqc29uZWRpdG9yLmdldFZhbHVlKCkgOiB3aW5kb3cuc3RhcnR2YWw7CiAgICAgICAgd2luZG93LnN0YXJ0dmFsID0gdW5kZWZpbmVkOwoKICAgICAgICBpZihqc29uZWRpdG9yKSBqc29uZWRpdG9yLmRlc3Ryb3koKTsKICAgICAgICBqc29uZWRpdG9yID0gbmV3IEpTT05FZGl0b3IoJGVkaXRvcix7CiAgICAgICAgICAgIHNjaGVtYTogc2NoZW1hLAogICAgICAgICAgICBzdGFydHZhbDogc3RhcnR2YWwKICAgICAgICB9KTsKICAgICAgICB3aW5kb3cuanNvbmVkaXRvciA9IGpzb25lZGl0b3I7CgogICAgICAgIC8vIFdoZW4gdGhlIHZhbHVlIG9mIHRoZSBlZGl0b3IgY2hhbmdlcywgdXBkYXRlIHRoZSBKU09OIG91dHB1dCBhbmQgdmFsaWRhdGlvbiBtZXNzYWdlCiAgICAgICAganNvbmVkaXRvci5vbignY2hhbmdlJyxmdW5jdGlvbigpIHsKICAgICAgICAgICAgdmFyIGpzb24gPSBqc29uZWRpdG9yLmdldFZhbHVlKCk7CgogICAgICAgICAgICAkb3V0cHV0LnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoanNvbixudWxsLDIpOwoKICAgICAgICAgICAgdmFyIHZhbGlkYXRpb25fZXJyb3JzID0ganNvbmVkaXRvci52YWxpZGF0ZSgpOwogICAgICAgICAgICAvLyBTaG93IHZhbGlkYXRpb24gZXJyb3JzIGlmIHRoZXJlIGFyZSBhbnkKICAgICAgICAgICAgaWYodmFsaWRhdGlvbl9lcnJvcnMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAkdmFsaWRhdGUudmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2YWxpZGF0aW9uX2Vycm9ycyxudWxsLDIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJHZhbGlkYXRlLnZhbHVlID0gJ3ZhbGlkJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdXBkYXRlRGlyZWN0TGluaygpOwogICAgICAgIH0pOwogICAgfTsKCiAgICAvLyBTdGFydCB0aGUgc2NoZW1hIGFuZCBvdXRwdXQgdGV4dGFyZWFzIHdpdGggaW5pdGlhbCB2YWx1ZXMKICAgICRzY2hlbWEudmFsdWUgPSBKU09OLnN0cmluZ2lmeShzY2hlbWEsbnVsbCwyKTsKICAgICRvdXRwdXQudmFsdWUgPSAnJzsKCiAgICAvLyBXaGVuIHRoZSAndXBkYXRlIGZvcm0nIGJ1dHRvbiBpcyBjbGlja2VkLCBzZXQgdGhlIGVkaXRvcidzIHZhbHVlCiAgICAkc2V0X3ZhbHVlX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKSB7CiAgICAgICAganNvbmVkaXRvci5zZXRWYWx1ZShKU09OLnBhcnNlKCRvdXRwdXQudmFsdWUpKTsKICAgIH0pOwoKICAgIC8vIFVwZGF0ZSB0aGUgc2NoZW1hIHdoZW4gdGhlIGJ1dHRvbiBpcyBjbGlja2VkCiAgICAkc2V0X3NjaGVtYV9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNjaGVtYSA9IEpTT04ucGFyc2UoJHNjaGVtYS52YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGNhdGNoKGUpIHsKICAgICAgICAgICAgYWxlcnQoJ0ludmFsaWQgU2NoZW1hOiAnK2UubWVzc2FnZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHJlbG9hZCgpOwogICAgfSk7CgogICAgLy8gU2V0IHRoZSB0aGVtZSBieSBsb2FkaW5nIHRoZSByaWdodCBzdHlsZXNoZWV0cwogICAgdmFyIHNldFRoZW1lID0gZnVuY3Rpb24odGhlbWUsbm9fcmVsb2FkKSB7CiAgICAgICAgdGhlbWUgPSB0aGVtZSB8fCAnJzsKCiAgICAgICAgdmFyIG1hcHBpbmcgPSB7CiAgICAgICAgICAgIGh0bWw6ICcnLAogICAgICAgICAgICBib290c3RyYXAyOiAnLy9uZXRkbmEuYm9vdHN0cmFwY2RuLmNvbS90d2l0dGVyLWJvb3RzdHJhcC8yLjMuMi9jc3MvYm9vdHN0cmFwLWNvbWJpbmVkLm1pbi5jc3MnLAogICAgICAgICAgICBib290c3RyYXAzOiAnLy9uZXRkbmEuYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4wLjMvY3NzL2Jvb3RzdHJhcC5taW4uY3NzJywKICAgICAgICAgICAgZm91bmRhdGlvbjM6ICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb3VuZGF0aW9uLzMuMi41L3N0eWxlc2hlZXRzL2ZvdW5kYXRpb24uY3NzJywKICAgICAgICAgICAgZm91bmRhdGlvbjQ6ICcvL2Nkbi5qc2RlbGl2ci5uZXQvZm91bmRhdGlvbi80LjMuMi9jc3MvZm91bmRhdGlvbi5taW4uY3NzJywKICAgICAgICAgICAgZm91bmRhdGlvbjU6ICcvL2Nkbi5qc2RlbGl2ci5uZXQvZm91bmRhdGlvbi81LjAuMi9jc3MvZm91bmRhdGlvbi5taW4uY3NzJywKICAgICAgICAgICAganF1ZXJ5dWk6ICcvL2NvZGUuanF1ZXJ5LmNvbS91aS8xLjEwLjMvdGhlbWVzL3NvdXRoLXN0cmVldC9qcXVlcnktdWkuY3NzJwogICAgICAgIH07CgogICAgICAgIGlmKHR5cGVvZiBtYXBwaW5nW3RoZW1lXSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgdGhlbWUgPSAnYm9vdHN0cmFwMyc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZV9zd2l0Y2hlcicpLnZhbHVlID0gdGhlbWU7CiAgICAgICAgfQoKICAgICAgICBKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnMudGhlbWUgPSB0aGVtZTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lX3N0eWxlc2hlZXQnKS5ocmVmID0gbWFwcGluZ1t0aGVtZV07CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lX3N3aXRjaGVyJykudmFsdWUgPSBKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnMudGhlbWU7CgogICAgICAgIGlmKCFub19yZWxvYWQpIHJlbG9hZCh0cnVlKTsKICAgIH07CgogICAgLy8gU2V0IHRoZSBpY29udGhlbWUKICAgIC8vIFNldCB0aGUgdGhlbWUgYnkgbG9hZGluZyB0aGUgcmlnaHQgc3R5bGVzaGVldHMKICAgIHZhciBzZXRJY29ubGliID0gZnVuY3Rpb24oaWNvbmxpYixub19yZWxvYWQpIHsKICAgICAgICBpY29ubGliID0gaWNvbmxpYiB8fCAnJzsKICAgICAgICB2YXIgbWFwcGluZyA9IHsKICAgICAgICAgICAgZm91bmRhdGlvbjI6ICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb3VuZGljb25zLzIuMC9zdHlsZXNoZWV0cy9nZW5lcmFsX2ZvdW5kaWNvbnMuY3NzJywKICAgICAgICAgICAgZm91bmRhdGlvbjM6ICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb3VuZGljb25zLzMuMC4wL2ZvdW5kYXRpb24taWNvbnMuY3NzJywKICAgICAgICAgICAgZm9udGF3ZXNvbWUzOiAnLy9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzMuMi4xL2Nzcy9mb250LWF3ZXNvbWUuY3NzJywKICAgICAgICAgICAgZm9udGF3ZXNvbWU0OiAnLy9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzQuMC4zL2Nzcy9mb250LWF3ZXNvbWUuY3NzJwogICAgICAgIH07CgogICAgICAgIEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucy5pY29ubGliID0gaWNvbmxpYjsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb25fc3R5bGVzaGVldCcpLmhyZWYgPSBtYXBwaW5nW2ljb25saWJdIHx8ICcnOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uX3N3aXRjaGVyJykudmFsdWUgPSBKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnMuaWNvbmxpYjsKCiAgICAgICAgaWYoIW5vX3JlbG9hZCkgcmVsb2FkKHRydWUpOwogICAgfTsKCiAgICB2YXIgcmVmcmVzaEJvb2xlYW5PcHRpb25zID0gZnVuY3Rpb24obm9fcmVsb2FkKSB7CiAgICAgICAgdmFyIGJvb2xlYW5fb3B0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib29sZWFuX29wdGlvbnMnKS5jaGlsZHJlbjsKICAgICAgICBmb3IodmFyIGk9MDsgaTxib29sZWFuX29wdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zW2Jvb2xlYW5fb3B0aW9uc1tpXS52YWx1ZV0gPSBib29sZWFuX29wdGlvbnNbaV0uc2VsZWN0ZWQ7CiAgICAgICAgfQogICAgICAgIGlmKCFub19yZWxvYWQpIHJlbG9hZCh0cnVlKTsKICAgIH07CgogICAgLy8gQ2hhbmdlIGxpc3RlbmVycyBmb3Igb3B0aW9ucwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lX3N3aXRjaGVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJyxmdW5jdGlvbigpIHsKICAgICAgICBzZXRUaGVtZSh0aGlzLnZhbHVlKTsKICAgIH0pOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb25fc3dpdGNoZXInKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLGZ1bmN0aW9uKCkgewogICAgICAgIHNldEljb25saWIodGhpcy52YWx1ZSk7CiAgICB9KTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvYmplY3RfbGF5b3V0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJyxmdW5jdGlvbigpIHsKICAgICAgIEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucy5vYmplY3RfbGF5b3V0ID0gdGhpcy52YWx1ZTsKICAgICAgICByZWxvYWQodHJ1ZSk7CiAgICB9KTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93X2Vycm9ycycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsZnVuY3Rpb24oKSB7CiAgICAgICBKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnMuc2hvd19lcnJvcnMgPSB0aGlzLnZhbHVlOwogICAgICAgIHJlbG9hZCh0cnVlKTsKICAgIH0pOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jvb2xlYW5fb3B0aW9ucycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsZnVuY3Rpb24oKSB7CiAgICAgICAgcmVmcmVzaEJvb2xlYW5PcHRpb25zKCk7CiAgICB9KTsKICAgIAogICAgLy8gR2V0IHN0YXJ0aW5nIHZhbHVlIGZyb20gdXJsCiAgICBpZih3aW5kb3cubG9jYXRpb24uaHJlZi5tYXRjaCgnWz8mXXZhbHVlPShbXiZdKyknKSkgewogICAgICB3aW5kb3cuc3RhcnR2YWwgPSBKU09OLnBhcnNlKExaU3RyaW5nLmRlY29tcHJlc3NGcm9tQmFzZTY0KHdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKCdbPyZddmFsdWU9KFteJl0rKScpWzFdKSk7CiAgICB9CiAKICAgIC8vIFNldCBvcHRpb25zIGZyb20gZGlyZWN0IGxpbmsKICAgIHNldFRoZW1lKCh3aW5kb3cubG9jYXRpb24uaHJlZi5tYXRjaCgvWz8mXXRoZW1lPShbXiZdKykvKXx8W10pWzFdIHx8ICdib290c3RyYXAyJywgdHJ1ZSk7CiAgICAKICAgIHNldEljb25saWIoKHdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKC9bPyZdaWNvbmxpYj0oW14mXSopLyl8fFtudWxsLCdmb250YXdlc29tZTQnXSlbMV0sIHRydWUpOwogICAgCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb2JqZWN0X2xheW91dCcpLnZhbHVlID0gKHdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKC9bPyZdb2JqZWN0X2xheW91dD0oW14mXSspLyl8fFtdKVsxXSB8fCAnbm9ybWFsJzsKICAgIEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucy5vYmplY3RfbGF5b3V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29iamVjdF9sYXlvdXQnKS52YWx1ZTsKICAgIAogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dfZXJyb3JzJykudmFsdWUgPSAod2luZG93LmxvY2F0aW9uLmhyZWYubWF0Y2goL1s/Jl1zaG93X2Vycm9ycz0oW14mXSspLyl8fFtdKVsxXSB8fCAnaW50ZXJhY3Rpb24nOwogICAgSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zLnNob3dfZXJyb3JzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dfZXJyb3JzJykudmFsdWU7CiAgICAKICAgIHZhciBib29sZWFuX29wdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9vbGVhbl9vcHRpb25zJykuY2hpbGRyZW47CiAgICBmb3IodmFyIGk9MDsgaTxib29sZWFuX29wdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZih3aW5kb3cubG9jYXRpb24uaHJlZi5tYXRjaChuZXcgUmVnRXhwKCdbPyZdJytib29sZWFuX29wdGlvbnNbaV0uZ2V0QXR0cmlidXRlKCd2YWx1ZScpKycoWyY9XXwkKScpKSkgewogICAgICAgICAgICBib29sZWFuX29wdGlvbnNbaV0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgIH0KICAgIH0KICAgIHJlZnJlc2hCb29sZWFuT3B0aW9ucyh0cnVlKTsKICAgIAogICAgcmVsb2FkKCk7Cn0pKCk7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K",
                "body": "PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgPHRpdGxlPkpTT04gRWRpdG9yIEV4YW1wbGU8L3RpdGxlPgoKICAgIDwhLS0gcGxhY2Vob2xkZXJzIGZvciB0aGUgdGhlbWUgc3dpdGNoZXIgLS0+CiAgICA8bGluayByZWw9J3N0eWxlc2hlZXQnIGlkPSd0aGVtZV9zdHlsZXNoZWV0Jz4KICAgIDxsaW5rIHJlbD0nc3R5bGVzaGVldCcgaWQ9J2ljb25fc3R5bGVzaGVldCc+CgogICAgPHN0eWxlPltjbGFzcyo9ImZvdW5kaWNvbi0iXSB7Zm9udC1mYW1pbHk6IEdlbmVyYWxGb3VuZGljb25zO2ZvbnQtc3R5bGU6IG5vcm1hbDt9PC9zdHlsZT4KICAgIDxzY3JpcHQgc3JjPSdkaXN0L2pzb25lZGl0b3IuanMnPjwvc2NyaXB0PgogICAgPCEtLSBUaGlzIGxpYnJhcnkgaXMgdXNlZCB0byBwcm92aWRlIGRpcmVjdCBsaW5rcyB0byB0aGUgZGVtby4gIEl0IGlzIG5vdCByZXF1aXJlZCBmb3IgSlNPTiBFZGl0b3IgLS0+CiAgICA8c2NyaXB0IHNyYz0naHR0cHM6Ly9jZG4ucmF3Z2l0LmNvbS9waWVyb3h5L2x6LXN0cmluZy9tYXN0ZXIvbGlicy9yZWxlYXNlL2x6LXN0cmluZy0xLjMuMy1taW4uanMnPjwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5Pgo8ZGl2IGNsYXNzPSdjb250YWluZXInPgogICAgPGRpdiBjbGFzcz0ncm93Jz4KICAgICAgICA8ZGl2IGNsYXNzPSdzcGFuOCBjb2wtbWQtOCBjb2x1bW5zIGVpZ2h0IGxhcmdlLTgnPgogICAgICAgICAgICA8aDI+RWRpdG9yPC9oMj4KICAgICAgICAgICAgPHA+QmVsb3cgaXMgdGhlIGVkaXRvciBnZW5lcmF0ZWQgZnJvbSB0aGUgSlNPTiBTY2hlbWEuPC9wPgoKICAgICAgICAgICAgPGRpdiBpZD0nZWRpdG9yJz48L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSdzcGFuNCBjb2wtbWQtNCBjb2x1bW5zIGZvdXIgbGFyZ2UtNCc+CiAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICA8YSBocmVmPScjJyBpZD0nZGlyZWN0X2xpbmsnPkRpcmVjdCBMaW5rPC9hPiAocHJlc2VydmVzIHNjaGVtYSwgdmFsdWUsIGFuZCBvcHRpb25zKQogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxoMj5KU09OIE91dHB1dDwvaDI+CiAgICAgICAgICAgIDxwPllvdSBjYW4gYWxzbyBtYWtlIGNoYW5nZXMgdG8gdGhlIEpTT04gaGVyZSBhbmQgc2V0IHRoZSB2YWx1ZSBpbiB0aGUgZWRpdG9yIGJ5IGNsaWNraW5nIDxidXR0b24gY2xhc3M9J2J0biBidG4tcHJpbWFyeScgaWQ9J3NldHZhbHVlJz5VcGRhdGUgRm9ybTwvYnV0dG9uPjwvcD4KICAgICAgICAgICAgPHRleHRhcmVhIGlkPSdvdXRwdXQnIHN0eWxlPSd3aWR0aDogMTAwJTsgaGVpZ2h0OiAzMDBweDsgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsnIGNsYXNzPSdmb3JtLWNvbnRyb2wnPjwvdGV4dGFyZWE+CgogICAgICAgICAgICA8aDI+T3B0aW9uczwvaDI+CiAgICAgICAgICAgIDxkaXYgaWQ9J29wdGlvbnNfaG9sZGVyJz4KICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkNTUyBGcmFtZXdvcms8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9J3RoZW1lX3N3aXRjaGVyJyBjbGFzcz0nZm9ybS1jb250cm9sJz4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0naHRtbCc+Tm9uZTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdqcXVlcnl1aSc+alF1ZXJ5IFVJPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Jvb3RzdHJhcDInPkJvb3RzdHJhcCAyPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Jvb3RzdHJhcDMnPkJvb3RzdHJhcCAzPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2ZvdW5kYXRpb24zJz5Gb3VuZGF0aW9uIDM8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZm91bmRhdGlvbjQnPkZvdW5kYXRpb24gNDwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdmb3VuZGF0aW9uNSc+Rm91bmRhdGlvbiA1PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkljb24gTGlicmFyeTwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0naWNvbl9zd2l0Y2hlcicgY2xhc3M9J2Zvcm0tY29udHJvbCc+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Jyc+Tm9uZTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdqcXVlcnl1aSc+alF1ZXJ5IFVJPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Jvb3RzdHJhcDInPkJvb3RzdHJhcCAyIEdseXBoaWNvbnM8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nYm9vdHN0cmFwMyc+Qm9vdHN0cmFwIDMgR2x5cGhpY29uczwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdmb3VuZGF0aW9uMic+Rm91bmRpY29ucyAyPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2ZvdW5kYXRpb24zJz5Gb3VuZGljb25zIDM8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZm9udGF3ZXNvbWUzJz5Gb250QXdlc29tZSAzPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2ZvbnRhd2Vzb21lNCc+Rm9udEF3ZXNvbWUgNDwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5PYmplY3QgTGF5b3V0PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSdvYmplY3RfbGF5b3V0JyBjbGFzcz0nZm9ybS1jb250cm9sJz4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nbm9ybWFsJz5ub3JtYWw8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZ3JpZCc+Z3JpZDwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgIDxsYWJlbD5TaG93IEVycm9yczwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0nc2hvd19lcnJvcnMnIGNsYXNzPSdmb3JtLWNvbnRyb2wnPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdpbnRlcmFjdGlvbic+T24gSW50ZXJhY3Rpb248L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nY2hhbmdlJz5PbiBGaWVsZCBDaGFuZ2U8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nYWx3YXlzJz5BbHdheXM8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nbmV2ZXInPk5ldmVyPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkJvb2xlYW4gb3B0aW9uczwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBtdWx0aXBsZSBzaXplPTkgaWQ9J2Jvb2xlYW5fb3B0aW9ucycgc3R5bGU9J3dpZHRoOiAxMDAlOycgY2xhc3M9J2Zvcm0tY29udHJvbCc+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J3JlcXVpcmVkX2J5X2RlZmF1bHQnPk9iamVjdCBwcm9wZXJ0aWVzIHJlcXVpcmVkIGJ5IGRlZmF1bHQ8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nbm9fYWRkaXRpb25hbF9wcm9wZXJ0aWVzJz5ObyBhZGRpdGlvbmFsIG9iamVjdCBwcm9wZXJ0aWVzPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2FqYXgnPkFsbG93IGxvYWRpbmcgc2NoZW1hcyB2aWEgQWpheDwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdkaXNhYmxlX2VkaXRfanNvbic+RGlzYWJsZSAiRWRpdCBKU09OIiBidXR0b25zPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Rpc2FibGVfY29sbGFwc2UnPkRpc2FibGUgY29sbGFwc2UgYnV0dG9uczwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdkaXNhYmxlX3Byb3BlcnRpZXMnPkRpc2FibGUgcHJvcGVydGllcyBidXR0b25zPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Rpc2FibGVfYXJyYXlfYWRkJz5EaXNhYmxlIGFycmF5IGFkZCBidXR0b25zPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Rpc2FibGVfYXJyYXlfcmVvcmRlcic+RGlzYWJsZSBhcnJheSBtb3ZlIGJ1dHRvbnM8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZGlzYWJsZV9hcnJheV9kZWxldGUnPkRpc2FibGUgYXJyYXkgZGVsZXRlIGJ1dHRvbnM8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxoMj5WYWxpZGF0aW9uPC9oMj4KICAgICAgICAgICAgPHA+VGhpcyB3aWxsIHVwZGF0ZSB3aGVuZXZlciB0aGUgZm9ybSBjaGFuZ2VzIHRvIHNob3cgdmFsaWRhdGlvbiBlcnJvcnMgaWYgdGhlcmUgYXJlIGFueS48L3A+CiAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0ndmFsaWRhdGUnIHN0eWxlPSd3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDBweDsgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsnIHJlYWRvbmx5IGRpc2FibGVkIGNsYXNzPSdmb3JtLWNvbnRyb2wnPjwvdGV4dGFyZWE+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ncm93Jz4KICAgICAgICAgICAgPGRpdiBjbGFzcz0nc3BhbjEyIGNvbC1tZC0xMiBjb2x1bW5zIHR3ZWx2ZSBsYXJnZS0xMic+CiAgICAgICAgICAgICAgICA8aDI+U2NoZW1hPC9oMj4KICAgICAgICAgICAgICAgIDxwPllvdSBjYW4gY2hhbmdlIHRoZSBzY2hlbWEgYW5kIHNlZSBob3cgdGhlIGdlbmVyYXRlZCBmb3JtIGxvb2tzLiAgQWZ0ZXIgeW91IG1ha2UgY2hhbmdlcywgY2xpY2sgPGJ1dHRvbiBjbGFzcz0nYnRuIGJ0bi1wcmltYXJ5JyBpZD0nc2V0c2NoZW1hJz5VcGRhdGUgU2NoZW1hPC9idXR0b24+PC9wPgoKICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBpZD0nc2NoZW1hJyBzdHlsZT0nd2lkdGg6IDEwMCU7IGhlaWdodDogNDUwcHg7IGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7JyBjbGFzcz0nZm9ybS1jb250cm9sJz48L3RleHRhcmVhPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSdyb3cnPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSdzcGFuMTIgY29sLW1kLTEyIGNvbHVtbnMgdHdlbHZlIGxhcmdlLTEyJz4KICAgICAgICAgICAgICAgIDxoMj5Db2RlPC9oMj4KICAgICAgPHByZT48Y29kZT4vLyBTZXQgZGVmYXVsdCBvcHRpb25zCkpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucy50aGVtZSA9ICdib290c3RyYXAyJzsKCi8vIEluaXRpYWxpemUgdGhlIGVkaXRvcgp2YXIgZWRpdG9yID0gbmV3IEpTT05FZGl0b3IoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVkaXRvcl9ob2xkZXIiKSx7CiAgc2NoZW1hOiB7CiAgICAgIHR5cGU6ICJvYmplY3QiLAogICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICBuYW1lOiB7ICJ0eXBlIjogInN0cmluZyIgfQogICAgICB9CiAgfQp9KTsKCi8vIFNldCB0aGUgdmFsdWUKZWRpdG9yLnNldFZhbHVlKHsKICAgIG5hbWU6ICJKb2huIFNtaXRoIgp9KTsKCi8vIEdldCB0aGUgdmFsdWUKdmFyIGRhdGEgPSBlZGl0b3IuZ2V0VmFsdWUoKTsKY29uc29sZS5sb2coZGF0YS5uYW1lKTsgLy8gIkpvaG4gU21pdGgiCgovLyBWYWxpZGF0ZQp2YXIgZXJyb3JzID0gZWRpdG9yLnZhbGlkYXRlKCk7CmlmKGVycm9ycy5sZW5ndGgpIHsKICAvLyBOb3QgdmFsaWQKfQoKLy8gTGlzdGVuIGZvciBjaGFuZ2VzCmVkaXRvci5vbigiY2hhbmdlIiwgIGZ1bmN0aW9uKCkgewogIC8vIERvIHNvbWV0aGluZy4uLgp9KTs8L2NvZGU+PC9wcmU+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CjwvZGl2Pgo8c2NyaXB0PgooZnVuY3Rpb24oKSB7CiAgICB2YXIgc2NoZW1hOwogICAgaWYod2luZG93LmxvY2F0aW9uLmhyZWYubWF0Y2goJ1s/Jl1zY2hlbWE9KFteJl0rKScpKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2NoZW1hID0gSlNPTi5wYXJzZShMWlN0cmluZy5kZWNvbXByZXNzRnJvbUJhc2U2NCh3aW5kb3cubG9jYXRpb24uaHJlZi5tYXRjaCgnWz8mXXNjaGVtYT0oW14mXSspJylbMV0pKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2goZSkgewogICAgICAgICAgICBjb25zb2xlLmxvZygnaW52YWxpZCBzdGFydGluZyBzY2hlbWEnKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gRGVmYXVsdCBzdGFydGluZyBzY2hlbWEKICAgIGlmKCFzY2hlbWEpIHsKICAgICAgICBzY2hlbWEgPSB7CiAgICAgICAgICAgIHRpdGxlOiAiUGVyc29uIiwKICAgICAgICAgICAgdHlwZTogIm9iamVjdCIsCiAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogIkZpcnN0IGFuZCBMYXN0IG5hbWUiLAogICAgICAgICAgICAgICAgICAgIG1pbkxlbmd0aDogNCwKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiAiSmVyZW15IERvcm4iCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYWdlOiB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogImludGVnZXIiLAogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDI1LAogICAgICAgICAgICAgICAgICAgIG1pbmltdW06IDE4LAogICAgICAgICAgICAgICAgICAgIG1heGltdW06IDk5CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZmF2b3JpdGVfY29sb3I6IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6ICJjb2xvciIsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJmYXZvcml0ZSBjb2xvciIsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogIiNmZmE1MDAiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZ2VuZGVyOiB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgZW51bTogWyJtYWxlIiwgImZlbWFsZSJdCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbG9jYXRpb246IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAib2JqZWN0IiwKICAgICAgICAgICAgICAgICAgICB0aXRsZTogIkxvY2F0aW9uIiwKICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogIlNhbiBGcmFuY2lzY28iCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICJDQSIKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgY2l0eXN0YXRlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAiVGhpcyBpcyBnZW5lcmF0ZWQgYXV0b21hdGljYWxseSBmcm9tIHRoZSBwcmV2aW91cyB0d28gZmllbGRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAie3tjaXR5fX0sIHt7c3RhdGV9fSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXRjaDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6ICdsb2NhdGlvbi5jaXR5JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogJ2xvY2F0aW9uLnN0YXRlJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHBldHM6IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiYXJyYXkiLAogICAgICAgICAgICAgICAgICAgIGZvcm1hdDogInRhYmxlIiwKICAgICAgICAgICAgICAgICAgICB0aXRsZTogIlBldHMiLAogICAgICAgICAgICAgICAgICAgIHVuaXF1ZUl0ZW1zOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJvYmplY3QiLAogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIlBldCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtOiBbImNhdCIsImRvZyIsImJpcmQiLCJyZXB0aWxlIiwib3RoZXIiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiAiZG9nIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJkb2ciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogIldhbHRlciIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBEaXZzL3RleHRhcmVhcyBvbiB0aGUgcGFnZQogICAgdmFyICRzY2hlbWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NoZW1hJyk7CiAgICB2YXIgJG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdXRwdXQnKTsKICAgIHZhciAkZWRpdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRvcicpOwogICAgdmFyICR2YWxpZGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YWxpZGF0ZScpOwoKICAgIC8vIEJ1dHRvbnMKICAgIHZhciAkc2V0X3NjaGVtYV9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0c2NoZW1hJyk7CiAgICB2YXIgJHNldF92YWx1ZV9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dmFsdWUnKTsKCiAgICB2YXIganNvbmVkaXRvcjsKCiAgICB2YXIgdXBkYXRlRGlyZWN0TGluayA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5yZXBsYWNlKC9cPy4qLywnJyk7CgogICAgICAgIHVybCArPSAnP3NjaGVtYT0nK0xaU3RyaW5nLmNvbXByZXNzVG9CYXNlNjQoSlNPTi5zdHJpbmdpZnkoc2NoZW1hKSk7CiAgICAgICAgdXJsICs9ICcmdmFsdWU9JytMWlN0cmluZy5jb21wcmVzc1RvQmFzZTY0KEpTT04uc3RyaW5naWZ5KGpzb25lZGl0b3IuZ2V0VmFsdWUoKSkpOwoKICAgICAgICBmb3IodmFyIGkgaW4gSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zKSB7CiAgICAgICAgICAgIGlmKCFKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnMuaGFzT3duUHJvcGVydHkoaSkpIGNvbnRpbnVlOwogICAgICAgICAgICBpZihKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnNbaV09PT1mYWxzZSkgY29udGludWU7CiAgICAgICAgICAgIGVsc2UgaWYoSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zW2ldPT09dHJ1ZSkgewogICAgICAgICAgICAgICAgdXJsICs9ICcmJytpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdXJsICs9ICcmJytpKyc9JytKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnNbaV07CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJlY3RfbGluaycpLmhyZWYgPSB1cmw7CiAgICB9OwoKICAgIHZhciByZWxvYWQgPSBmdW5jdGlvbihrZWVwX3ZhbHVlKSB7CiAgICAgICAgdmFyIHN0YXJ0dmFsID0gKGpzb25lZGl0b3IgJiYga2VlcF92YWx1ZSk/IGpzb25lZGl0b3IuZ2V0VmFsdWUoKSA6IHdpbmRvdy5zdGFydHZhbDsKICAgICAgICB3aW5kb3cuc3RhcnR2YWwgPSB1bmRlZmluZWQ7CgogICAgICAgIGlmKGpzb25lZGl0b3IpIGpzb25lZGl0b3IuZGVzdHJveSgpOwogICAgICAgIGpzb25lZGl0b3IgPSBuZXcgSlNPTkVkaXRvcigkZWRpdG9yLHsKICAgICAgICAgICAgc2NoZW1hOiBzY2hlbWEsCiAgICAgICAgICAgIHN0YXJ0dmFsOiBzdGFydHZhbAogICAgICAgIH0pOwogICAgICAgIHdpbmRvdy5qc29uZWRpdG9yID0ganNvbmVkaXRvcjsKCiAgICAgICAgLy8gV2hlbiB0aGUgdmFsdWUgb2YgdGhlIGVkaXRvciBjaGFuZ2VzLCB1cGRhdGUgdGhlIEpTT04gb3V0cHV0IGFuZCB2YWxpZGF0aW9uIG1lc3NhZ2UKICAgICAgICBqc29uZWRpdG9yLm9uKCdjaGFuZ2UnLGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIganNvbiA9IGpzb25lZGl0b3IuZ2V0VmFsdWUoKTsKCiAgICAgICAgICAgICRvdXRwdXQudmFsdWUgPSBKU09OLnN0cmluZ2lmeShqc29uLG51bGwsMik7CgogICAgICAgICAgICB2YXIgdmFsaWRhdGlvbl9lcnJvcnMgPSBqc29uZWRpdG9yLnZhbGlkYXRlKCk7CiAgICAgICAgICAgIC8vIFNob3cgdmFsaWRhdGlvbiBlcnJvcnMgaWYgdGhlcmUgYXJlIGFueQogICAgICAgICAgICBpZih2YWxpZGF0aW9uX2Vycm9ycy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICR2YWxpZGF0ZS52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHZhbGlkYXRpb25fZXJyb3JzLG51bGwsMik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkdmFsaWRhdGUudmFsdWUgPSAndmFsaWQnOwogICAgICAgICAgICB9CgogICAgICAgICAgICB1cGRhdGVEaXJlY3RMaW5rKCk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIC8vIFN0YXJ0IHRoZSBzY2hlbWEgYW5kIG91dHB1dCB0ZXh0YXJlYXMgd2l0aCBpbml0aWFsIHZhbHVlcwogICAgJHNjaGVtYS52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHNjaGVtYSxudWxsLDIpOwogICAgJG91dHB1dC52YWx1ZSA9ICcnOwoKICAgIC8vIFdoZW4gdGhlICd1cGRhdGUgZm9ybScgYnV0dG9uIGlzIGNsaWNrZWQsIHNldCB0aGUgZWRpdG9yJ3MgdmFsdWUKICAgICRzZXRfdmFsdWVfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbigpIHsKICAgICAgICBqc29uZWRpdG9yLnNldFZhbHVlKEpTT04ucGFyc2UoJG91dHB1dC52YWx1ZSkpOwogICAgfSk7CgogICAgLy8gVXBkYXRlIHRoZSBzY2hlbWEgd2hlbiB0aGUgYnV0dG9uIGlzIGNsaWNrZWQKICAgICRzZXRfc2NoZW1hX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2NoZW1hID0gSlNPTi5wYXJzZSgkc2NoZW1hLnZhbHVlKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2goZSkgewogICAgICAgICAgICBhbGVydCgnSW52YWxpZCBTY2hlbWE6ICcrZS5tZXNzYWdlKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcmVsb2FkKCk7CiAgICB9KTsKCiAgICAvLyBTZXQgdGhlIHRoZW1lIGJ5IGxvYWRpbmcgdGhlIHJpZ2h0IHN0eWxlc2hlZXRzCiAgICB2YXIgc2V0VGhlbWUgPSBmdW5jdGlvbih0aGVtZSxub19yZWxvYWQpIHsKICAgICAgICB0aGVtZSA9IHRoZW1lIHx8ICcnOwoKICAgICAgICB2YXIgbWFwcGluZyA9IHsKICAgICAgICAgICAgaHRtbDogJycsCiAgICAgICAgICAgIGJvb3RzdHJhcDI6ICcvL25ldGRuYS5ib290c3RyYXBjZG4uY29tL3R3aXR0ZXItYm9vdHN0cmFwLzIuMy4yL2Nzcy9ib290c3RyYXAtY29tYmluZWQubWluLmNzcycsCiAgICAgICAgICAgIGJvb3RzdHJhcDM6ICcvL25ldGRuYS5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjAuMy9jc3MvYm9vdHN0cmFwLm1pbi5jc3MnLAogICAgICAgICAgICBmb3VuZGF0aW9uMzogJy8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2ZvdW5kYXRpb24vMy4yLjUvc3R5bGVzaGVldHMvZm91bmRhdGlvbi5jc3MnLAogICAgICAgICAgICBmb3VuZGF0aW9uNDogJy8vY2RuLmpzZGVsaXZyLm5ldC9mb3VuZGF0aW9uLzQuMy4yL2Nzcy9mb3VuZGF0aW9uLm1pbi5jc3MnLAogICAgICAgICAgICBmb3VuZGF0aW9uNTogJy8vY2RuLmpzZGVsaXZyLm5ldC9mb3VuZGF0aW9uLzUuMC4yL2Nzcy9mb3VuZGF0aW9uLm1pbi5jc3MnLAogICAgICAgICAgICBqcXVlcnl1aTogJy8vY29kZS5qcXVlcnkuY29tL3VpLzEuMTAuMy90aGVtZXMvc291dGgtc3RyZWV0L2pxdWVyeS11aS5jc3MnCiAgICAgICAgfTsKCiAgICAgICAgaWYodHlwZW9mIG1hcHBpbmdbdGhlbWVdID09PSAndW5kZWZpbmVkJykgewogICAgICAgICAgICB0aGVtZSA9ICdib290c3RyYXAzJzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lX3N3aXRjaGVyJykudmFsdWUgPSB0aGVtZTsKICAgICAgICB9CgogICAgICAgIEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucy50aGVtZSA9IHRoZW1lOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWVfc3R5bGVzaGVldCcpLmhyZWYgPSBtYXBwaW5nW3RoZW1lXTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWVfc3dpdGNoZXInKS52YWx1ZSA9IEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucy50aGVtZTsKCiAgICAgICAgaWYoIW5vX3JlbG9hZCkgcmVsb2FkKHRydWUpOwogICAgfTsKCiAgICAvLyBTZXQgdGhlIGljb250aGVtZQogICAgLy8gU2V0IHRoZSB0aGVtZSBieSBsb2FkaW5nIHRoZSByaWdodCBzdHlsZXNoZWV0cwogICAgdmFyIHNldEljb25saWIgPSBmdW5jdGlvbihpY29ubGliLG5vX3JlbG9hZCkgewogICAgICAgIGljb25saWIgPSBpY29ubGliIHx8ICcnOwogICAgICAgIHZhciBtYXBwaW5nID0gewogICAgICAgICAgICBmb3VuZGF0aW9uMjogJy8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2ZvdW5kaWNvbnMvMi4wL3N0eWxlc2hlZXRzL2dlbmVyYWxfZm91bmRpY29ucy5jc3MnLAogICAgICAgICAgICBmb3VuZGF0aW9uMzogJy8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2ZvdW5kaWNvbnMvMy4wLjAvZm91bmRhdGlvbi1pY29ucy5jc3MnLAogICAgICAgICAgICBmb250YXdlc29tZTM6ICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb250LWF3ZXNvbWUvMy4yLjEvY3NzL2ZvbnQtYXdlc29tZS5jc3MnLAogICAgICAgICAgICBmb250YXdlc29tZTQ6ICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb250LWF3ZXNvbWUvNC4wLjMvY3NzL2ZvbnQtYXdlc29tZS5jc3MnCiAgICAgICAgfTsKCiAgICAgICAgSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zLmljb25saWIgPSBpY29ubGliOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWNvbl9zdHlsZXNoZWV0JykuaHJlZiA9IG1hcHBpbmdbaWNvbmxpYl0gfHwgJyc7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb25fc3dpdGNoZXInKS52YWx1ZSA9IEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucy5pY29ubGliOwoKICAgICAgICBpZighbm9fcmVsb2FkKSByZWxvYWQodHJ1ZSk7CiAgICB9OwoKICAgIHZhciByZWZyZXNoQm9vbGVhbk9wdGlvbnMgPSBmdW5jdGlvbihub19yZWxvYWQpIHsKICAgICAgICB2YXIgYm9vbGVhbl9vcHRpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jvb2xlYW5fb3B0aW9ucycpLmNoaWxkcmVuOwogICAgICAgIGZvcih2YXIgaT0wOyBpPGJvb2xlYW5fb3B0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnNbYm9vbGVhbl9vcHRpb25zW2ldLnZhbHVlXSA9IGJvb2xlYW5fb3B0aW9uc1tpXS5zZWxlY3RlZDsKICAgICAgICB9CiAgICAgICAgaWYoIW5vX3JlbG9hZCkgcmVsb2FkKHRydWUpOwogICAgfTsKCiAgICAvLyBDaGFuZ2UgbGlzdGVuZXJzIGZvciBvcHRpb25zCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWVfc3dpdGNoZXInKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLGZ1bmN0aW9uKCkgewogICAgICAgIHNldFRoZW1lKHRoaXMudmFsdWUpOwogICAgfSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWNvbl9zd2l0Y2hlcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsZnVuY3Rpb24oKSB7CiAgICAgICAgc2V0SWNvbmxpYih0aGlzLnZhbHVlKTsKICAgIH0pOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29iamVjdF9sYXlvdXQnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLGZ1bmN0aW9uKCkgewogICAgICAgSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zLm9iamVjdF9sYXlvdXQgPSB0aGlzLnZhbHVlOwogICAgICAgIHJlbG9hZCh0cnVlKTsKICAgIH0pOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dfZXJyb3JzJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJyxmdW5jdGlvbigpIHsKICAgICAgIEpTT05FZGl0b3IuZGVmYXVsdHMub3B0aW9ucy5zaG93X2Vycm9ycyA9IHRoaXMudmFsdWU7CiAgICAgICAgcmVsb2FkKHRydWUpOwogICAgfSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9vbGVhbl9vcHRpb25zJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJyxmdW5jdGlvbigpIHsKICAgICAgICByZWZyZXNoQm9vbGVhbk9wdGlvbnMoKTsKICAgIH0pOwogICAgCiAgICAvLyBHZXQgc3RhcnRpbmcgdmFsdWUgZnJvbSB1cmwKICAgIGlmKHdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKCdbPyZddmFsdWU9KFteJl0rKScpKSB7CiAgICAgIHdpbmRvdy5zdGFydHZhbCA9IEpTT04ucGFyc2UoTFpTdHJpbmcuZGVjb21wcmVzc0Zyb21CYXNlNjQod2luZG93LmxvY2F0aW9uLmhyZWYubWF0Y2goJ1s/Jl12YWx1ZT0oW14mXSspJylbMV0pKTsKICAgIH0KIAogICAgLy8gU2V0IG9wdGlvbnMgZnJvbSBkaXJlY3QgbGluawogICAgc2V0VGhlbWUoKHdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKC9bPyZddGhlbWU9KFteJl0rKS8pfHxbXSlbMV0gfHwgJ2Jvb3RzdHJhcDInLCB0cnVlKTsKICAgIAogICAgc2V0SWNvbmxpYigod2luZG93LmxvY2F0aW9uLmhyZWYubWF0Y2goL1s/Jl1pY29ubGliPShbXiZdKikvKXx8W251bGwsJ2ZvbnRhd2Vzb21lNCddKVsxXSwgdHJ1ZSk7CiAgICAKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvYmplY3RfbGF5b3V0JykudmFsdWUgPSAod2luZG93LmxvY2F0aW9uLmhyZWYubWF0Y2goL1s/Jl1vYmplY3RfbGF5b3V0PShbXiZdKykvKXx8W10pWzFdIHx8ICdub3JtYWwnOwogICAgSlNPTkVkaXRvci5kZWZhdWx0cy5vcHRpb25zLm9iamVjdF9sYXlvdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb2JqZWN0X2xheW91dCcpLnZhbHVlOwogICAgCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd19lcnJvcnMnKS52YWx1ZSA9ICh3aW5kb3cubG9jYXRpb24uaHJlZi5tYXRjaCgvWz8mXXNob3dfZXJyb3JzPShbXiZdKykvKXx8W10pWzFdIHx8ICdpbnRlcmFjdGlvbic7CiAgICBKU09ORWRpdG9yLmRlZmF1bHRzLm9wdGlvbnMuc2hvd19lcnJvcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd19lcnJvcnMnKS52YWx1ZTsKICAgIAogICAgdmFyIGJvb2xlYW5fb3B0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib29sZWFuX29wdGlvbnMnKS5jaGlsZHJlbjsKICAgIGZvcih2YXIgaT0wOyBpPGJvb2xlYW5fb3B0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmKHdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKG5ldyBSZWdFeHAoJ1s/Jl0nK2Jvb2xlYW5fb3B0aW9uc1tpXS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykrJyhbJj1dfCQpJykpKSB7CiAgICAgICAgICAgIGJvb2xlYW5fb3B0aW9uc1tpXS5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgfQogICAgfQogICAgcmVmcmVzaEJvb2xlYW5PcHRpb25zKHRydWUpOwogICAgCiAgICByZWxvYWQoKTsKfSkoKTsKPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 07:41:30 GMT",
                    "Content-Length": "16805",
                    "Date": "Fri, 07 Nov 2014 07:41:30 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}