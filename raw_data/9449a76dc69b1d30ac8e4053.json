{
    "url": "http://localhost:9999/mrdoob/three.js/examples/css3d_youtube.html",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "DOM data manipulation (DOM-based)",
    "issueType": 5247488,
    "severity": "Information",
    "confidence": "Firm",
    "issueBackground": "DOM-based DOM data manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a data field within the DOM that is used within the visible UI or client-side application logic. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the appearance or behavior of the client-side UI. An attacker may be able to leverage this to perform virtual defacement of the application, or possibly to induce the user to perform unintended actions.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based DOM data manipulation vulnerabilities is not to dynamically write to DOM data fields any data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from being stored. In general, this is best achieved by using a whitelist of permitted values.",
    "issueDetail": "The application may be vulnerable to DOM-based DOM data manipulation. Data is read from <b>window.location.hash</b> and written to <b>the 'value' property of a DOM element</b> via the following statement:<ul><li>query.value = window.location.hash.substr( 1 );</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/mrdoob/three.js/examples/css3d_youtube.html",
                "path": "/mrdoob/three.js/examples/css3d_youtube.html",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9tcmRvb2IvdGhyZWUuanMvZXhhbXBsZXMvY3NzM2RfeW91dHViZS5odG1sIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTAyMzENCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAxNTozNzo1NiBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMTU6Mzc6NTQgR01UDQoNCjwhRE9DVFlQRSBodG1sPgo8aHRtbD4KCTxoZWFkPgoJCTxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KCQk8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCB1c2VyLXNjYWxhYmxlPW5vLCBtaW5pbXVtLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAiPgoJCTx0aXRsZT50aHJlZS5qcyBjc3MzZCAtIHlvdXR1YmU8L3RpdGxlPgoJCTxzdHlsZT4KCQkJaHRtbCwgYm9keSB7CgkJCQloZWlnaHQ6IDEwMCU7CgkJCX0KCgkJCWJvZHkgewoJCQkJYmFja2dyb3VuZC1jb2xvcjogIzAwMDAwMDsKCQkJCW1hcmdpbjogMDsKCQkJCWZvbnQtZmFtaWx5OiBBcmlhbDsKCQkJCW92ZXJmbG93OiBoaWRkZW47CgkJCX0KCgkJCSNzZWFyY2ggewoJCQkJcG9zaXRpb246IGFic29sdXRlOwoJCQkJYm90dG9tOiAzMHB4OwoJCQkJd2lkdGg6IDEwMCU7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCgkJCSNzZWFyY2ggaW5wdXQgewoJCQkJY29sb3I6ICNmZmZmZmY7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKCQkJCWJvcmRlcjogMXB4IHNvbGlkICMwMDgwZmY7CgkJCQlwYWRkaW5nOiAxMHB4OwoJCQkJZm9udC1zaXplOiAyMHB4OwoJCQkJdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKCQkJCS13ZWJraXQtYm9yZGVyLXJhZGl1czogMHB4OyAvKiB3b3JrYXJvdW5kIGZvciBpb3Mgc2FmYXJpICovCgkJCX0KCgkJCSNzZWFyY2ggYnV0dG9uIHsKCQkJCWNvbG9yOiAjMDA4MGZmOwoJCQkJYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CgkJCQlib3JkZXI6IDFweCBzb2xpZCAjMDA4MGZmOwoJCQkJcGFkZGluZzogMTBweDsKCQkJCWZvbnQtc2l6ZTogMjBweDsKCQkJCXRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CgkJCQljdXJzb3I6IHBvaW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJPC9oZWFkPgoJPGJvZHk+CgkJPHNjcmlwdCBzcmM9Ii4uL2J1aWxkL3RocmVlLm1pbi5qcyI+PC9zY3JpcHQ+CgoJCTxzY3JpcHQgc3JjPSJqcy9saWJzL3R3ZWVuLm1pbi5qcyI+PC9zY3JpcHQ+CgkJPHNjcmlwdCBzcmM9ImpzL3JlbmRlcmVycy9DU1MzRFJlbmRlcmVyLmpzIj48L3NjcmlwdD4KCgkJPGRpdiBpZD0iY29udGFpbmVyIj48L2Rpdj4KCQk8ZGl2IGlkPSJzZWFyY2giPjxpbnB1dCBpZD0icXVlcnkiIHR5cGU9InRleHQiIHZhbHVlPSJjYXRzIj48YnV0dG9uIGlkPSJidXR0b24iPnNlYXJjaDwvYnV0dG9uPjwvZGl2PgoKCQk8c2NyaXB0PgoJCQl2YXIgY2FtZXJhLCBzY2VuZSwgcmVuZGVyZXI7CgkJCXZhciBwbGF5ZXI7CgoJCQl2YXIgYXV0byA9IHRydWU7CgoJCQl2YXIgRWxlbWVudCA9IGZ1bmN0aW9uICggZW50cnkgKSB7CgoJCQkJdmFyIGRvbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7CgkJCQlkb20uc3R5bGUud2lkdGggPSAnNDgwcHgnOwoJCQkJZG9tLnN0eWxlLmhlaWdodCA9ICczNjBweCc7CgoJCQkJdmFyIGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2ltZycgKTsKCQkJCWltYWdlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKCQkJCWltYWdlLnN0eWxlLndpZHRoID0gJzQ4MHB4JzsKCQkJCWltYWdlLnN0eWxlLmhlaWdodCA9ICczNjBweCc7CgkJCQlpbWFnZS5zcmMgPSBlbnRyeS5tZWRpYSRncm91cC5tZWRpYSR0aHVtYm5haWxbIDIgXS51cmw7CgkJCQlkb20uYXBwZW5kQ2hpbGQoIGltYWdlICk7CgoJCQkJdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdpbWcnICk7CgkJCQlidXR0b24uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOwoJCQkJYnV0dG9uLnN0eWxlLmxlZnQgPSAoICggNDgwIC0gODYgKSAvIDIgKSArICdweCc7CgkJCQlidXR0b24uc3R5bGUudG9wID0gKCAoIDM2MCAtIDYxICkgLyAyICkgKyAncHgnOwoJCQkJYnV0dG9uLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsKCQkJCWJ1dHRvbi5zdHlsZS5XZWJraXRGaWx0ZXIgPSAnZ3JheXNjYWxlKCknOwoJCQkJYnV0dG9uLnNyYyA9ICdkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUZZQUFBQTlDQVlBQUFBM1paNXVBQUFBQVhOU1IwSUFyczRjNlFBQUFBWmlTMGRFQVA4QS93RC9vTDJua3dBQUFBbHdTRmx6QUFBTEV3QUFDeE1CQUpxY0dBQUFBQWQwU1UxRkI5d0xCUTB1TWJzbkxaSUFBQWJYU1VSQlZIamE3Wnh2YkJ2bEhjYy96L21hZjRQR2c5RnRiYVplUzJJMWlVZ1AxcTdRRW1GcG14QjdBWXhYay9hQ3ZFVGFDL1p5MnFTcGs3YXBML1lDVGJDeW9VMHVVQUdkUnY4dVZDb3J6c1FHU1J1NHRGb2FoYll4cEVrS2F5dkhhUkludm50K2U1SEV6YjkyY2V6NGJIUmZ5Uy91ZlBiZDgvSDN2cy92Wjk5WmthYytlckI1T3hoaEFHMW9TNG15WnA1UllWRmk1L1BlU3BTRndycmQ4NEk0UURMSDkzUkFrc3VzandNODlQSDVEZ29nbGN2R1oreW1wOFJRVHl0UmxpQ1dVc3JpeXl3aENUaWlKS0ZRQ2FVbVh0alJmWGswYjdCbnY3MjExdlVxMnhTcURhVnNBb0dJSTBqTURFM0Y3Z1Q1dG1BL3RKdWUwcWlZZ25CQWN6a3prelNRdG9lZDNxTXJCdnQreTdabmxUSmlBYjZWR0ZpM1BYcXU3OEQvQmZ0K3k3Wm5oUUJxYmhQVlVyZ0x3UDZyc1hHemErSUVwMy91c1dDNjJIc3VYUGgwYnAwNWY0Tk1TR0tnd2hLd3lsWGhUSWdYZ0I4dWNlenA1c2gyTUp5QVVSN08xY3I2N3F4cnM0NzFrRFpGNE5XOHNsYnBOdUJYQzhDS05teFJBWno4TEt1aVM4QnFKQm9ZTm05RkYyUnMrN2I2eDhDSUIxd0tJUjM5UWQvRkRuT215RlUyZ1YwTGxiUTJNQVBXMDJJcDVVUEFWbFhCNDQvRHhrMHp5OE5EY09ZTURBK1hjU2NtVmpaanRXRDdVUkZVNzl6SnpwLy9ndHJhV2dCR1IwY1pHQmhnc0xNVDNueWpMQUdMWUdmQmltaGJLTDVqdjdGblR4WXFRRzF0TGJadEU0bEU2TisxaTVIang1bit4N3ZsQlZqa0ZsaXRsQzh0N05jYm01WmRYMU5UZzIzYk5EYzMwLy9NTTN3V2o1UCs2Nkh5QUR6TFV2MXR5NWJOMmxBSlA0Nmg5YlhYdVcvWHJoVnQyOS9mVDE5N085NlJ3MGlKQXphMFdLWW5Za2taZEFhUlNJUklKTUxsSjUrazcrMjNtVHgrdkdRQmk0aGxhZ2lMK0ZOcXJXYXZXN2R1NVZ2UFAwLy9FMCtRYUc5bjRzUUpaR2lvdE5JQXdxYUE3Uk5YUklUVmZLaW1hZExVMUlSbFdmUkdvd3lkZXBmTXlaUG8wZ0ZzbTU0bWpQS0xiSDR2cjZtcFljZU9IVFEwTkhEdTBUMWNPM2FNcVhkT3d1U2t6MWxBMk5RaXRuLzdMOHdIV2x0YlMydHJLNE9XUlg4MFNyTDlIYWJpY2Y4QUM3YXBmZXhrUmFDUStWNVhWMGRkWFIzOTlmVmMyck9ic1RjUGtUbC8zcGN6MGRSSTJEK3d3bHBNbkEwTkRXemF0SWxQR2hzWlBIV0sxRnVIMERkdUZITm9ZVk9EN2RmM0wzcU53QUpVVjFmVDB0SkNmWDA5Wng5NGdLdXhBMHgxZGhWdjh0SWlQa2FCUmtTdjdmY1IxVlcwZnY5N0ROVGZ6NWxmLzVaMHZLTW9Zek5tY3M2dmh4VHRZVmtXait6OUpjYkdqVVVabTYrTzFTTG9JczZlVmNrVWpLWW94cGg5am9LMXk5akZ1dHJaeWVubmZrSm1iS3dvKy9PNTNKSTF6OWpwVklyZTJLczR2MytwcUdQek53cTBSbXU5aGk3dG91czMrN2h4b2Evb1l6TzFmNFpGYTFrVHNEZXZET0c4K0FjdUhqN3EyOWpNU2RkektrT0dMMjJ0bHNJNjl1YlFFTTZMKzMwRkNqRGxhY2VzTUZUU3J6U1lpUUt2QUVDSHVYajRHRDB2dlZ3U1gyMVZHQ281TzNtSmoyQlg3OWpwMUJpOXJ4Mms5OVdEWk1adVVrb3l0WGdPR05GeUFqdWRHdU96MCsvUnRlOTNKUWNVSUsxMXdoU3Rrbjc5TXVOcGplZDVPUUc5ZVBRRVBmdi9WSkpBNTFTSlNwaWZ1eTVmTTgyU2o0TGUxOStnWi84ckpRMTBUdGRjRi9NZWpMaGZUWUtuUFR6UHZiMUR4OFlZZk8rZjlMejhaOGFIcjFJdXVnY2pibjdpcHJuZnFQYmxBRWE2dXJudndlMUxaL25oRVQ0Lyt6SG4vdmdYeGtmS0IraWNMcmxwekV0cE43R2x3cDhEK00vQlEzeXpkVGRmalRSa2dRNzgvU1RuWDRsUnpycVVkaE1LNEdkMzNTdnJsSC9YRm14NGFNYTFYM3pVUTdrckk4SyttOWVWQ1RDdWRYSzlFZkx0SjVxcjNlVVBkRTdqV2lkaDdvcHVFVWVMUkFtVXYwU2NMTmdKVHlkcWxCRkFLWUFtUEozSWdwMFVIQjFjMEYwUVRRcTNIRHVRbVhZMmhrSUJsUUpvSURQdHdMd2I2SDY4N203WllKZ0JtVHgwUTNzY3lLVFVyY2tMbUJLSkM4RUVsbzlTNG1YdjdNeUMvVUo3Unphb1VOUlV3VjEwcTlWMXJiT2RqWEdyL3BxTVhSTXZvTE5LL1ZkN3VGcU9MQUhiRGFNajRzWmNDY3FEWE9XS2NFVXlzWCtUL25RSldBRFBZMjlDdThrQVZXNUthRGZwZWV5ZHYyNUJqVFdJTzNxdkNsVlZvS0pmQ1JxR0ZlbXl6bkFkNzdrUEpOMXhXN0FBVjhUdHVBdkRBdXoxQWR3N252NEpjYmttWHR1SFhuckpmOElzMnhWY0VmZm9lbFE0S2ZyaGRVcFJIUUJlQVBTNmFDNUxKcG55M0I5MXl0UmJ5MjEzeDlycUVhb2VreEI3SzFEUlNoVHpIVnlCb2xJcGFsQjhtVXUwbEdqR1ppK0RTb2xtQW8wbnhESTYvZE51eVAxL3QrWnJOMVdiQlN3eG1OOUFXQ2dzRWJHVlV1RWFGS0ZGOEFIdVhyVHNkN3hNaVRBMSszUC9oR2ptRjVqanM4c2V3Z1FDUWdKRlFrUWNoVW9xVFh5YXRITW5vRG1CWFltK3c3cnRJVUxoUmZCQnNiaWJLNW51VGtRY3BWUVNJUUVrQUFSSkdsbzVDaEx6eTZkYzlUOVM4d3UrSHpEYkJRQUFBQUJKUlU1RXJrSmdnZz09JzsKCQkJCWRvbS5hcHBlbmRDaGlsZCggYnV0dG9uICk7CgoJCQkJdmFyIGJsb2NrZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApOwoJCQkJYmxvY2tlci5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7CgkJCQlibG9ja2VyLnN0eWxlLndpZHRoID0gJzQ4MHB4JzsKCQkJCWJsb2NrZXIuc3R5bGUuaGVpZ2h0ID0gJzM2MHB4JzsKCQkJCWJsb2NrZXIuc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKDAsMCwwLDAuNSknOwoJCQkJYmxvY2tlci5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7CgkJCQlkb20uYXBwZW5kQ2hpbGQoIGJsb2NrZXIgKTsKCgkJCQl2YXIgb2JqZWN0ID0gbmV3IFRIUkVFLkNTUzNET2JqZWN0KCBkb20gKTsKCQkJCW9iamVjdC5wb3NpdGlvbi54ID0gTWF0aC5yYW5kb20oKSAqIDQwMDAgLSAyMDAwOwoJCQkJLy8gb2JqZWN0LnBvc2l0aW9uLnkgPSBNYXRoLnJhbmRvbSgpICogMjAwMCAtIDEwMDA7CgkJCQlvYmplY3QucG9zaXRpb24ueSA9IDMwMDA7CgkJCQlvYmplY3QucG9zaXRpb24ueiA9IE1hdGgucmFuZG9tKCkgKiAtIDUwMDA7CgoJCQkJLy8KCgkJCQlpbWFnZS5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsIGZ1bmN0aW9uICggZXZlbnQgKSB7CgoJCQkJCWJ1dHRvbi5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOwoKCQkJCQluZXcgVFdFRU4uVHdlZW4oIG9iamVjdC5wb3NpdGlvbiApCgkJCQkJCS50byggeyB5OiBNYXRoLnJhbmRvbSgpICogMjAwMCAtIDEwMDAgfSwgMjAwMCApCgkJCQkJCS5lYXNpbmcoIFRXRUVOLkVhc2luZy5FeHBvbmVudGlhbC5PdXQgKQoJCQkJCQkuc3RhcnQoKTsKCgkJCQl9LCBmYWxzZSApOwoKCQkJCWRvbS5hZGRFdmVudExpc3RlbmVyKCAnbW91c2VvdmVyJywgZnVuY3Rpb24gKCkgewoKCQkJCQlidXR0b24uc3R5bGUuV2Via2l0RmlsdGVyID0gJyc7CgkJCQkJYmxvY2tlci5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEoMCwwLDAsMCknOwoKCQkJCX0sIGZhbHNlICk7CgoJCQkJZG9tLmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHsKCgkJCQkJYnV0dG9uLnN0eWxlLldlYmtpdEZpbHRlciA9ICdncmF5c2NhbGUoKSc7CgkJCQkJYmxvY2tlci5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEoMCwwLDAsMC43NSknOwoKCQkJCX0sIGZhbHNlICk7CgoJCQkJZG9tLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uICggZXZlbnQgKSB7CgoJCQkJCWV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwoKCQkJCQlhdXRvID0gZmFsc2U7CgoJCQkJCWlmICggcGxheWVyICE9PSB1bmRlZmluZWQgKSB7CgoJCQkJCQlwbGF5ZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggcGxheWVyICk7CgkJCQkJCXBsYXllciA9IHVuZGVmaW5lZDsKCgkJCQkJfQoKCQkJCQlwbGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnaWZyYW1lJyApOwoJCQkJCXBsYXllci5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7CgkJCQkJcGxheWVyLnN0eWxlLndpZHRoID0gJzQ4MHB4JzsKCQkJCQlwbGF5ZXIuc3R5bGUuaGVpZ2h0ID0gJzM2MHB4JzsKCQkJCQlwbGF5ZXIuc3R5bGUuYm9yZGVyID0gJzBweCc7CgkJCQkJcGxheWVyLnNyYyA9ICdodHRwOi8vd3d3LnlvdXR1YmUuY29tL2VtYmVkLycgKyBlbnRyeS5pZC4kdC5zcGxpdCggJzonICkucG9wKCkgKyAnP3JlbD0wJmF1dG9wbGF5PTEmY29udHJvbHM9MSZzaG93aW5mbz0wJzsKCQkJCQl0aGlzLmFwcGVuZENoaWxkKCBwbGF5ZXIgKTsKCgkJCQkJLy8KCgkJCQkJdmFyIHByZXYgPSBvYmplY3QucG9zaXRpb24ueiArIDQwMDsKCgkJCQkJbmV3IFRXRUVOLlR3ZWVuKCBjYW1lcmEucG9zaXRpb24gKQoJCQkJCQkudG8oIHsgeDogb2JqZWN0LnBvc2l0aW9uLngsIHk6IG9iamVjdC5wb3NpdGlvbi55IC0gMjUgfSwgMTUwMCApCgkJCQkJCS5lYXNpbmcoIFRXRUVOLkVhc2luZy5FeHBvbmVudGlhbC5PdXQgKQoJCQkJCQkuc3RhcnQoKTsKCgkJCQkJbmV3IFRXRUVOLlR3ZWVuKCB7IHZhbHVlOiBwcmV2IH0gKQoJCQkJCQkudG8oIHsgdmFsdWU6IDAgIH0sIDIwMDAgKQoJCQkJCQkub25VcGRhdGUoIGZ1bmN0aW9uICgpIHsKCgkJCQkJCQltb3ZlKCB0aGlzLnZhbHVlIC0gcHJldiApOwoJCQkJCQkJcHJldiA9IHRoaXMudmFsdWU7CgoJCQkJCQl9ICkKCQkJCQkJLmVhc2luZyggVFdFRU4uRWFzaW5nLkV4cG9uZW50aWFsLk91dCApCgkJCQkJCS5zdGFydCgpOwoKCQkJCX0sIGZhbHNlICk7CgoJCQkJcmV0dXJuIG9iamVjdDsKCgkJCX07CgoJCQlpbml0KCk7CgkJCWFuaW1hdGUoKTsKCgkJCWZ1bmN0aW9uIGluaXQoKSB7CgoJCQkJY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA3NSwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDEsIDUwMDAgKTsKCQkJCWNhbWVyYS5wb3NpdGlvbi55ID0gLSAyNTsKCgkJCQlzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOwoKCQkJCXJlbmRlcmVyID0gbmV3IFRIUkVFLkNTUzNEUmVuZGVyZXIoKTsKCQkJCXJlbmRlcmVyLnNldFNpemUoIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgKTsKCQkJCXJlbmRlcmVyLmRvbUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOwoJCQkJcmVuZGVyZXIuZG9tRWxlbWVudC5zdHlsZS50b3AgPSAwOwoJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICdjb250YWluZXInICkuYXBwZW5kQ2hpbGQoIHJlbmRlcmVyLmRvbUVsZW1lbnQgKTsKCgkJCQkvLwoKCQkJCXZhciBxdWVyeSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAncXVlcnknICk7CgkJCQlxdWVyeS5hZGRFdmVudExpc3RlbmVyKCAna2V5dXAnLCBmdW5jdGlvbiAoIGV2ZW50ICkgewoKCQkJCQlpZiAoIGV2ZW50LmtleUNvZGUgPT09IDEzICkgewoKCQkJCQkJc2VhcmNoKCBxdWVyeS52YWx1ZSApOwoKCQkJCQl9CgoJCQkJfSwgZmFsc2UgKTsKCgkJCQl2YXIgYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICdidXR0b24nICk7CgkJCQlidXR0b24uYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgZnVuY3Rpb24gKCBldmVudCApIHsKCgkJCQkJc2VhcmNoKCBxdWVyeS52YWx1ZSApOwoKCQkJCX0sIGZhbHNlICk7CgoJCQkJaWYgKCB3aW5kb3cubG9jYXRpb24uaGFzaC5sZW5ndGggPiAwICkgewoKCQkJCQlxdWVyeS52YWx1ZSA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0ciggMSApOwoKCQkJCX0KCgkJCQlzZWFyY2goIHF1ZXJ5LnZhbHVlICk7CgoJCQkJZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCAnbW91c2V3aGVlbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTsKCgkJCQlkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsIGZ1bmN0aW9uICggZXZlbnQgKSB7CgoJCQkJCWF1dG8gPSB0cnVlOwoKCQkJCQlpZiAoIHBsYXllciAhPT0gdW5kZWZpbmVkICkgewoKCQkJCQkJcGxheWVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIHBsYXllciApOwoJCQkJCQlwbGF5ZXIgPSB1bmRlZmluZWQ7CgoJCQkJCX0KCgkJCQkJbmV3IFRXRUVOLlR3ZWVuKCBjYW1lcmEucG9zaXRpb24gKQoJCQkJCQkJLnRvKCB7IHg6IDAsIHk6IC0gMjUgfSwgMTUwMCApCgkJCQkJCQkuZWFzaW5nKCBUV0VFTi5FYXNpbmcuRXhwb25lbnRpYWwuT3V0ICkKCQkJCQkJCS5zdGFydCgpOwoKCQkJCX0sIGZhbHNlICk7CgoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdyZXNpemUnLCBvbldpbmRvd1Jlc2l6ZSwgZmFsc2UgKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIHNlYXJjaCggcXVlcnkgKSB7CgoJCQkJd2luZG93LmxvY2F0aW9uLmhhc2ggPSBxdWVyeTsKCgkJCQlmb3IgKCB2YXIgaSA9IDAsIGwgPSBzY2VuZS5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpICsrICkgewoKCQkJCQkoIGZ1bmN0aW9uICgpIHsKCgkJCQkJCXZhciBvYmplY3QgPSBzY2VuZS5jaGlsZHJlblsgaSBdOwoJCQkJCQl2YXIgZGVsYXkgPSBpICogMTU7CgoJCQkJCQluZXcgVFdFRU4uVHdlZW4oIG9iamVjdC5wb3NpdGlvbiApCgkJCQkJCQkudG8oIHsgeTogLSAyMDAwIH0sIDEwMDAgKQoJCQkJCQkJLmRlbGF5KCBkZWxheSApCgkJCQkJCQkuZWFzaW5nKCBUV0VFTi5FYXNpbmcuRXhwb25lbnRpYWwuSW4gKQoJCQkJCQkJLm9uQ29tcGxldGUoIGZ1bmN0aW9uICgpIHsKCgkJCQkJCQkJc2NlbmUucmVtb3ZlKCBvYmplY3QgKTsKCgkJCQkJCQl9ICkKCQkJCQkJCS5zdGFydCgpOwoKCQkJCQl9ICkoKTsKCgkJCQl9CgoJCQkJdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKCQkJCXJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lciggJ2xvYWQnLCBvbkRhdGEsIGZhbHNlICk7CgkJCQlyZXF1ZXN0Lm9wZW4oICdHRVQnLCAnaHR0cHM6Ly9nZGF0YS55b3V0dWJlLmNvbS9mZWVkcy9hcGkvdmlkZW9zP3Y9MiZhbHQ9anNvbiZtYXgtcmVzdWx0cz01MCZxPScgKyBxdWVyeSwgdHJ1ZSApOwoJCQkJcmVxdWVzdC5zZW5kKCBudWxsICk7CgoJCQl9CgkJCQoJCQlmdW5jdGlvbiBvbkRhdGEoIGV2ZW50ICkgewoKCQkJCXZhciBkYXRhID0gSlNPTi5wYXJzZSggZXZlbnQudGFyZ2V0LnJlc3BvbnNlVGV4dCApOwoJCQkJdmFyIGVudHJpZXMgPSBkYXRhLmZlZWQuZW50cnk7CgoJCQkJLy8gY29uc29sZS5sb2coIGVudHJpZXMgKTsKCgkJCQlmb3IgKCB2YXIgaSA9IDA7IGkgPCBlbnRyaWVzLmxlbmd0aDsgaSArKyApIHsKCgkJCQkJKCBmdW5jdGlvbiAoIGRhdGEsIHRpbWUgKSB7CgoJCQkJCQlzZXRUaW1lb3V0KCBmdW5jdGlvbiAoKSB7CgoJCQkJCQkJc2NlbmUuYWRkKCBuZXcgRWxlbWVudCggZGF0YSApICk7CgoJCQkJCQl9LCB0aW1lICk7CgoJCQkJCX0gKSggZW50cmllc1sgaSBdLCBpICogMTUgKTsKCQkJCQoJCQkJfQoKCQkJfQoKCQkJZnVuY3Rpb24gbW92ZSggZGVsdGEgKSB7CgoJCQkJZm9yICggdmFyIGkgPSAwOyBpIDwgc2NlbmUuY2hpbGRyZW4ubGVuZ3RoOyBpICsrICkgewoKCQkJCQl2YXIgb2JqZWN0ID0gc2NlbmUuY2hpbGRyZW5bIGkgXTsKCgkJCQkJb2JqZWN0LnBvc2l0aW9uLnogKz0gZGVsdGE7CgoJCQkJCWlmICggb2JqZWN0LnBvc2l0aW9uLnogPiAwICkgewoKCQkJCQkJb2JqZWN0LnBvc2l0aW9uLnogLT0gNTAwMDsKCgkJCQkJfSBlbHNlIGlmICggb2JqZWN0LnBvc2l0aW9uLnogPCAtIDUwMDAgKSB7CgoJCQkJCQlvYmplY3QucG9zaXRpb24ueiArPSA1MDAwOwoKCQkJCQl9CgoJCQkJfQoKCQkJfQoKCQkJZnVuY3Rpb24gb25Nb3VzZVdoZWVsKCBldmVudCApIHsKCgkJCQltb3ZlKCBldmVudC53aGVlbERlbHRhICk7CgoJCQl9CgoJCQlmdW5jdGlvbiBvbldpbmRvd1Jlc2l6ZSgpIHsKCgkJCQljYW1lcmEuYXNwZWN0ID0gd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQ7CgkJCQljYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpOwoKCQkJCXJlbmRlcmVyLnNldFNpemUoIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIGFuaW1hdGUoKSB7CgoJCQkJcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBhbmltYXRlICk7CgoJCQkJVFdFRU4udXBkYXRlKCk7CgoJCQkJaWYgKCBhdXRvID09PSB0cnVlICkgewoKCQkJCQltb3ZlKCAxICk7CgoJCQkJfQoKCQkJCXJlbmRlcmVyLnJlbmRlciggc2NlbmUsIGNhbWVyYSApOwoKCQkJfQoKCQk8L3NjcmlwdD4KCTwvYm9keT4KPC9odG1sPgo=",
                "body": "PCFET0NUWVBFIGh0bWw+CjxodG1sPgoJPGhlYWQ+CgkJPG1ldGEgY2hhcnNldD0idXRmLTgiPgoJCTxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIHVzZXItc2NhbGFibGU9bm8sIG1pbmltdW0tc2NhbGU9MS4wLCBtYXhpbXVtLXNjYWxlPTEuMCI+CgkJPHRpdGxlPnRocmVlLmpzIGNzczNkIC0geW91dHViZTwvdGl0bGU+CgkJPHN0eWxlPgoJCQlodG1sLCBib2R5IHsKCQkJCWhlaWdodDogMTAwJTsKCQkJfQoKCQkJYm9keSB7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiAjMDAwMDAwOwoJCQkJbWFyZ2luOiAwOwoJCQkJZm9udC1mYW1pbHk6IEFyaWFsOwoJCQkJb3ZlcmZsb3c6IGhpZGRlbjsKCQkJfQoKCQkJI3NlYXJjaCB7CgkJCQlwb3NpdGlvbjogYWJzb2x1dGU7CgkJCQlib3R0b206IDMwcHg7CgkJCQl3aWR0aDogMTAwJTsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoKCQkJI3NlYXJjaCBpbnB1dCB7CgkJCQljb2xvcjogI2ZmZmZmZjsKCQkJCWJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OwoJCQkJYm9yZGVyOiAxcHggc29saWQgIzAwODBmZjsKCQkJCXBhZGRpbmc6IDEwcHg7CgkJCQlmb250LXNpemU6IDIwcHg7CgkJCQl0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwoJCQkJLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAwcHg7IC8qIHdvcmthcm91bmQgZm9yIGlvcyBzYWZhcmkgKi8KCQkJfQoKCQkJI3NlYXJjaCBidXR0b24gewoJCQkJY29sb3I6ICMwMDgwZmY7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKCQkJCWJvcmRlcjogMXB4IHNvbGlkICMwMDgwZmY7CgkJCQlwYWRkaW5nOiAxMHB4OwoJCQkJZm9udC1zaXplOiAyMHB4OwoJCQkJdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJfQoJCTwvc3R5bGU+Cgk8L2hlYWQ+Cgk8Ym9keT4KCQk8c2NyaXB0IHNyYz0iLi4vYnVpbGQvdGhyZWUubWluLmpzIj48L3NjcmlwdD4KCgkJPHNjcmlwdCBzcmM9ImpzL2xpYnMvdHdlZW4ubWluLmpzIj48L3NjcmlwdD4KCQk8c2NyaXB0IHNyYz0ianMvcmVuZGVyZXJzL0NTUzNEUmVuZGVyZXIuanMiPjwvc2NyaXB0PgoKCQk8ZGl2IGlkPSJjb250YWluZXIiPjwvZGl2PgoJCTxkaXYgaWQ9InNlYXJjaCI+PGlucHV0IGlkPSJxdWVyeSIgdHlwZT0idGV4dCIgdmFsdWU9ImNhdHMiPjxidXR0b24gaWQ9ImJ1dHRvbiI+c2VhcmNoPC9idXR0b24+PC9kaXY+CgoJCTxzY3JpcHQ+CgkJCXZhciBjYW1lcmEsIHNjZW5lLCByZW5kZXJlcjsKCQkJdmFyIHBsYXllcjsKCgkJCXZhciBhdXRvID0gdHJ1ZTsKCgkJCXZhciBFbGVtZW50ID0gZnVuY3Rpb24gKCBlbnRyeSApIHsKCgkJCQl2YXIgZG9tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTsKCQkJCWRvbS5zdHlsZS53aWR0aCA9ICc0ODBweCc7CgkJCQlkb20uc3R5bGUuaGVpZ2h0ID0gJzM2MHB4JzsKCgkJCQl2YXIgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnaW1nJyApOwoJCQkJaW1hZ2Uuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOwoJCQkJaW1hZ2Uuc3R5bGUud2lkdGggPSAnNDgwcHgnOwoJCQkJaW1hZ2Uuc3R5bGUuaGVpZ2h0ID0gJzM2MHB4JzsKCQkJCWltYWdlLnNyYyA9IGVudHJ5Lm1lZGlhJGdyb3VwLm1lZGlhJHRodW1ibmFpbFsgMiBdLnVybDsKCQkJCWRvbS5hcHBlbmRDaGlsZCggaW1hZ2UgKTsKCgkJCQl2YXIgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2ltZycgKTsKCQkJCWJ1dHRvbi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7CgkJCQlidXR0b24uc3R5bGUubGVmdCA9ICggKCA0ODAgLSA4NiApIC8gMiApICsgJ3B4JzsKCQkJCWJ1dHRvbi5zdHlsZS50b3AgPSAoICggMzYwIC0gNjEgKSAvIDIgKSArICdweCc7CgkJCQlidXR0b24uc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOwoJCQkJYnV0dG9uLnN0eWxlLldlYmtpdEZpbHRlciA9ICdncmF5c2NhbGUoKSc7CgkJCQlidXR0b24uc3JjID0gJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRllBQUFBOUNBWUFBQUEzWlo1dUFBQUFBWE5TUjBJQXJzNGM2UUFBQUFaaVMwZEVBUDhBL3dEL29MMm5rd0FBQUFsd1NGbHpBQUFMRXdBQUN4TUJBSnFjR0FBQUFBZDBTVTFGQjl3TEJRMHVNYnNuTFpJQUFBYlhTVVJCVkhqYTdaeHZiQnZsSGNjL3ovbWFmNFBHZzlGdGJhWmVTMkkxaVVnUDFxN1FFbUZwbXhCN0FZeFhrL2FDdkVUYUMvWnkycVNwazdhcEwvWUNUYkN5b1UwdVVBR2RSdjh1VkNvcnpzUUdTUnU0dEZvYWhiWXhwRWtLYXl2SGFSSW52bnQrZTVIRXpiOTJjZXo0YkhSZnlTL3VmUGJkOC9IM3ZzL3ZaOTlaa2FjK2VyQjVPeGhoQUcxb1M0bXlacDVSWVZGaTUvUGVTcFNGd3JyZDg0STRRRExIOTNSQWtzdXNqd004OVBINURnb2dsY3ZHWit5bXA4UlFUeXRSbGlDV1Vzcml5eXdoQ1RpaUpLRlFDYVVtWHRqUmZYazBiN0JudjcyMTF2VXEyeFNxRGFWc0FvR0lJMGpNREUzRjdnVDV0bUEvdEp1ZTBxaVlnbkJBY3premt6U1F0b2VkM3FNckJ2dCt5N1pubFRKaUFiNlZHRmkzUFhxdTc4RC9CZnQreTdabmhRQnFiaFBWVXJnTHdQNnJzWEd6YStJRXAzL3VzV0M2MkhzdVhQaDBicDA1ZjROTVNHS2d3aEt3eWxYaFRJZ1hnQjh1Y2V6cDVzaDJNSnlBVVI3TzFjcjY3cXhyczQ3MWtEWkY0Tlc4c2xicE51QlhDOENLTm14UkFaejhMS3VpUzhCcUpCb1lObTlGRjJScys3YjZ4OENJQjF3S0lSMzlRZC9GRG5PbXlGVTJnVjBMbGJRMk1BUFcwMklwNVVQQVZsWEI0NC9EeGswenk4TkRjT1lNREErWGNTY21WalpqdFdEN1VSRlU3OXpKenAvL2d0cmFXZ0JHUjBjWkdCaGdzTE1UM255akxBR0xZR2ZCaW1oYktMNWp2N0ZuVHhZcVFHMXRMYlp0RTRsRTZOKzFpNUhqeDVuK3g3dmxCVmprRmxpdGxDOHQ3TmNibTVaZFgxTlRnMjNiTkRjMzAvL01NM3dXajVQKzY2SHlBRHpMVXYxdHk1Yk4ybEFKUDQ2aDliWFh1Vy9YcmhWdDI5L2ZUMTk3Tzk2UncwaUpBemEwV0tZbllra1pkQWFSU0lSSUpNTGxKNStrNysyM21UeCt2R1FCaTRobGFnaUwrRk5xcldhdlc3ZHU1VnZQUDAvL0UwK1FhRzluNHNRSlpHaW90TklBd3FhQTdSTlhSSVRWZktpbWFkTFUxSVJsV2ZSR293eWRlcGZNeVpQbzBnRnNtNTRtalBLTGJINHZyNm1wWWNlT0hUUTBOSER1MFQxY08zYU1xWGRPd3VTa3oxbEEyTlFpdG4vN0w4d0hXbHRiUzJ0cks0T1dSWDgwU3JMOUhhYmljZjhBQzdhcGZleGtSYUNRK1Y1WFYwZGRYUjM5OWZWYzJyT2JzVGNQa1RsLzNwY3owZFJJMkQrd3dscE1uQTBORFd6YXRJbFBHaHNaUEhXSzFGdUgwRGR1RkhOb1lWT0Q3ZGYzTDNxTndBSlVWMWZUMHRKQ2ZYMDlaeDk0Z0t1eEEweDFkaFZ2OHRJaVBrYUJSa1N2N2ZjUjFWVzBmdjk3RE5UZno1bGYvNVowdktNb1l6Tm1jczZ2aHhUdFlWa1dqK3o5SmNiR2pVVVptNitPMVNMb0lzNmVWY2tVaktZb3hwaDlqb0sxeTlqRnV0clp5ZW5uZmtKbWJLd28rL081M0pJMXo5anBWSXJlMktzNHYzK3BxR1B6TndxMFJtdTloaTd0b3VzMys3aHhvYS9vWXpPMWY0WkZhMWtUc0RldkRPRzgrQWN1SGo3cTI5ak1TZGR6S2tPR0wyMnRsc0k2OXViUUVNNkwrMzBGQ2pEbGFjZXNNRlRTcnpTWWlRS3ZBRUNIdVhqNEdEMHZ2VndTWDIxVkdDbzVPM21KajJCWDc5anAxQmk5cngyazk5V0RaTVp1VWtveXRYZ09HTkZ5QWp1ZEd1T3owKy9SdGU5M0pRY1VJSzExd2hTdGtuNzlNdU5wamVkNU9RRzllUFFFUGZ2L1ZKSkE1MVNKU3BpZnV5NWZNODJTajRMZTE5K2daLzhySlExMFR0ZGNGL01lakxoZlRZS25QVHpQdmIxRHg4WVlmTytmOUx6OFo4YUhyMUl1dWdjamJuN2lwcm5mcVBibEFFYTZ1cm52d2UxTFovbmhFVDQvK3pIbi92Z1h4a2ZLQitpY0xybHB6RXRwTjdHbHdwOEQrTS9CUTN5emRUZGZqVFJrZ1E3OC9TVG5YNGxSenJxVWRoTUs0R2QzM1N2cmxIL1hGbXg0YU1hMVgzelVRN2tySThLK205ZVZDVEN1ZFhLOUVmTHRKNXFyM2VVUGRFN2pXaWRoN29wdUVVZUxSQW1VdjBTY0xOZ0pUeWRxbEJGQUtZQW1QSjNJZ3AwVUhCMWMwRjBRVFFxM0hEdVFtWFkyaGtJQmxRSm9JRFB0d0x3YjZINjg3bTdaWUpnQm1UeDBRM3NjeUtUVXJja0xtQktKQzhFRWxvOVM0bVh2N015Qy9VSjdSemFvVU5SVXdWMTBxOVYxcmJPZGpYR3IvcHFNWFJNdm9MTksvVmQ3dUZxT0xBSGJEYU1qNHNaY0NjcURYT1dLY0VVeXNYK1QvblFKV0FEUFkyOUN1OGtBVlc1S2FEZnBlZXlkdjI1QmpUV0lPM3F2Q2xWVm9LSmZDUnFHRmVteXpuQWQ3N2tQSk4xeFc3QUFWOFR0dUF2REF1ejFBZHc3bnY0SmNia21YdHVIWG5ySmY4SXMyeFZjRWZmb2VsUTRLZnJoZFVwUkhRQmVBUFM2YUM1TEpwbnkzQjkxeXRSYnkyMTN4OXJxRWFvZWt4QjdLMURSU2hUekhWeUJvbElwYWxCOG1VdTBsR2pHWmkrRFNvbG1BbzBueERJNi9kTnV5UDEvdCtack4xV2JCU3d4bU45QVdDZ3NFYkdWVXVFYUZLRkY4QUh1WHJUc2Q3eE1pVEExKzNQL2hHam1GNWpqczhzZXdnUUNRZ0pGUWtRY2hVb3FUWHlhdEhNbm9EbUJYWW0rdzdydElVTGhSZkJCc2JpYks1bnVUa1FjcFZRU0lRRWtBQVJKR2xvNUNoTHp5NmRjOVQ5Uzh3dStIekRiQlFBQUFBQkpSVTVFcmtKZ2dnPT0nOwoJCQkJZG9tLmFwcGVuZENoaWxkKCBidXR0b24gKTsKCgkJCQl2YXIgYmxvY2tlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7CgkJCQlibG9ja2VyLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKCQkJCWJsb2NrZXIuc3R5bGUud2lkdGggPSAnNDgwcHgnOwoJCQkJYmxvY2tlci5zdHlsZS5oZWlnaHQgPSAnMzYwcHgnOwoJCQkJYmxvY2tlci5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEoMCwwLDAsMC41KSc7CgkJCQlibG9ja2VyLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJzsKCQkJCWRvbS5hcHBlbmRDaGlsZCggYmxvY2tlciApOwoKCQkJCXZhciBvYmplY3QgPSBuZXcgVEhSRUUuQ1NTM0RPYmplY3QoIGRvbSApOwoJCQkJb2JqZWN0LnBvc2l0aW9uLnggPSBNYXRoLnJhbmRvbSgpICogNDAwMCAtIDIwMDA7CgkJCQkvLyBvYmplY3QucG9zaXRpb24ueSA9IE1hdGgucmFuZG9tKCkgKiAyMDAwIC0gMTAwMDsKCQkJCW9iamVjdC5wb3NpdGlvbi55ID0gMzAwMDsKCQkJCW9iamVjdC5wb3NpdGlvbi56ID0gTWF0aC5yYW5kb20oKSAqIC0gNTAwMDsKCgkJCQkvLwoKCQkJCWltYWdlLmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgZnVuY3Rpb24gKCBldmVudCApIHsKCgkJCQkJYnV0dG9uLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7CgoJCQkJCW5ldyBUV0VFTi5Ud2Vlbiggb2JqZWN0LnBvc2l0aW9uICkKCQkJCQkJLnRvKCB7IHk6IE1hdGgucmFuZG9tKCkgKiAyMDAwIC0gMTAwMCB9LCAyMDAwICkKCQkJCQkJLmVhc2luZyggVFdFRU4uRWFzaW5nLkV4cG9uZW50aWFsLk91dCApCgkJCQkJCS5zdGFydCgpOwoKCQkJCX0sIGZhbHNlICk7CgoJCQkJZG9tLmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZW92ZXInLCBmdW5jdGlvbiAoKSB7CgoJCQkJCWJ1dHRvbi5zdHlsZS5XZWJraXRGaWx0ZXIgPSAnJzsKCQkJCQlibG9ja2VyLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSgwLDAsMCwwKSc7CgoJCQkJfSwgZmFsc2UgKTsKCgkJCQlkb20uYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlb3V0JywgZnVuY3Rpb24gKCkgewoKCQkJCQlidXR0b24uc3R5bGUuV2Via2l0RmlsdGVyID0gJ2dyYXlzY2FsZSgpJzsKCQkJCQlibG9ja2VyLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSgwLDAsMCwwLjc1KSc7CgoJCQkJfSwgZmFsc2UgKTsKCgkJCQlkb20uYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgZnVuY3Rpb24gKCBldmVudCApIHsKCgkJCQkJZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CgoJCQkJCWF1dG8gPSBmYWxzZTsKCgkJCQkJaWYgKCBwbGF5ZXIgIT09IHVuZGVmaW5lZCApIHsKCgkJCQkJCXBsYXllci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBwbGF5ZXIgKTsKCQkJCQkJcGxheWVyID0gdW5kZWZpbmVkOwoKCQkJCQl9CgoJCQkJCXBsYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdpZnJhbWUnICk7CgkJCQkJcGxheWVyLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKCQkJCQlwbGF5ZXIuc3R5bGUud2lkdGggPSAnNDgwcHgnOwoJCQkJCXBsYXllci5zdHlsZS5oZWlnaHQgPSAnMzYwcHgnOwoJCQkJCXBsYXllci5zdHlsZS5ib3JkZXIgPSAnMHB4JzsKCQkJCQlwbGF5ZXIuc3JjID0gJ2h0dHA6Ly93d3cueW91dHViZS5jb20vZW1iZWQvJyArIGVudHJ5LmlkLiR0LnNwbGl0KCAnOicgKS5wb3AoKSArICc/cmVsPTAmYXV0b3BsYXk9MSZjb250cm9scz0xJnNob3dpbmZvPTAnOwoJCQkJCXRoaXMuYXBwZW5kQ2hpbGQoIHBsYXllciApOwoKCQkJCQkvLwoKCQkJCQl2YXIgcHJldiA9IG9iamVjdC5wb3NpdGlvbi56ICsgNDAwOwoKCQkJCQluZXcgVFdFRU4uVHdlZW4oIGNhbWVyYS5wb3NpdGlvbiApCgkJCQkJCS50byggeyB4OiBvYmplY3QucG9zaXRpb24ueCwgeTogb2JqZWN0LnBvc2l0aW9uLnkgLSAyNSB9LCAxNTAwICkKCQkJCQkJLmVhc2luZyggVFdFRU4uRWFzaW5nLkV4cG9uZW50aWFsLk91dCApCgkJCQkJCS5zdGFydCgpOwoKCQkJCQluZXcgVFdFRU4uVHdlZW4oIHsgdmFsdWU6IHByZXYgfSApCgkJCQkJCS50byggeyB2YWx1ZTogMCAgfSwgMjAwMCApCgkJCQkJCS5vblVwZGF0ZSggZnVuY3Rpb24gKCkgewoKCQkJCQkJCW1vdmUoIHRoaXMudmFsdWUgLSBwcmV2ICk7CgkJCQkJCQlwcmV2ID0gdGhpcy52YWx1ZTsKCgkJCQkJCX0gKQoJCQkJCQkuZWFzaW5nKCBUV0VFTi5FYXNpbmcuRXhwb25lbnRpYWwuT3V0ICkKCQkJCQkJLnN0YXJ0KCk7CgoJCQkJfSwgZmFsc2UgKTsKCgkJCQlyZXR1cm4gb2JqZWN0OwoKCQkJfTsKCgkJCWluaXQoKTsKCQkJYW5pbWF0ZSgpOwoKCQkJZnVuY3Rpb24gaW5pdCgpIHsKCgkJCQljYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoIDc1LCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMSwgNTAwMCApOwoJCQkJY2FtZXJhLnBvc2l0aW9uLnkgPSAtIDI1OwoKCQkJCXNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7CgoJCQkJcmVuZGVyZXIgPSBuZXcgVEhSRUUuQ1NTM0RSZW5kZXJlcigpOwoJCQkJcmVuZGVyZXIuc2V0U2l6ZSggd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCApOwoJCQkJcmVuZGVyZXIuZG9tRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7CgkJCQlyZW5kZXJlci5kb21FbGVtZW50LnN0eWxlLnRvcCA9IDA7CgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ2NvbnRhaW5lcicgKS5hcHBlbmRDaGlsZCggcmVuZGVyZXIuZG9tRWxlbWVudCApOwoKCQkJCS8vCgoJCQkJdmFyIHF1ZXJ5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoICdxdWVyeScgKTsKCQkJCXF1ZXJ5LmFkZEV2ZW50TGlzdGVuZXIoICdrZXl1cCcsIGZ1bmN0aW9uICggZXZlbnQgKSB7CgoJCQkJCWlmICggZXZlbnQua2V5Q29kZSA9PT0gMTMgKSB7CgoJCQkJCQlzZWFyY2goIHF1ZXJ5LnZhbHVlICk7CgoJCQkJCX0KCgkJCQl9LCBmYWxzZSApOwoKCQkJCXZhciBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ2J1dHRvbicgKTsKCQkJCWJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCAnY2xpY2snLCBmdW5jdGlvbiAoIGV2ZW50ICkgewoKCQkJCQlzZWFyY2goIHF1ZXJ5LnZhbHVlICk7CgoJCQkJfSwgZmFsc2UgKTsKCgkJCQlpZiAoIHdpbmRvdy5sb2NhdGlvbi5oYXNoLmxlbmd0aCA+IDAgKSB7CgoJCQkJCXF1ZXJ5LnZhbHVlID0gd2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyKCAxICk7CgoJCQkJfQoKCQkJCXNlYXJjaCggcXVlcnkudmFsdWUgKTsKCgkJCQlkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZXdoZWVsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSApOwoKCQkJCWRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgZnVuY3Rpb24gKCBldmVudCApIHsKCgkJCQkJYXV0byA9IHRydWU7CgoJCQkJCWlmICggcGxheWVyICE9PSB1bmRlZmluZWQgKSB7CgoJCQkJCQlwbGF5ZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggcGxheWVyICk7CgkJCQkJCXBsYXllciA9IHVuZGVmaW5lZDsKCgkJCQkJfQoKCQkJCQluZXcgVFdFRU4uVHdlZW4oIGNhbWVyYS5wb3NpdGlvbiApCgkJCQkJCQkudG8oIHsgeDogMCwgeTogLSAyNSB9LCAxNTAwICkKCQkJCQkJCS5lYXNpbmcoIFRXRUVOLkVhc2luZy5FeHBvbmVudGlhbC5PdXQgKQoJCQkJCQkJLnN0YXJ0KCk7CgoJCQkJfSwgZmFsc2UgKTsKCgkJCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3Jlc2l6ZScsIG9uV2luZG93UmVzaXplLCBmYWxzZSApOwoKCQkJfQoKCQkJZnVuY3Rpb24gc2VhcmNoKCBxdWVyeSApIHsKCgkJCQl3aW5kb3cubG9jYXRpb24uaGFzaCA9IHF1ZXJ5OwoKCQkJCWZvciAoIHZhciBpID0gMCwgbCA9IHNjZW5lLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGw7IGkgKysgKSB7CgoJCQkJCSggZnVuY3Rpb24gKCkgewoKCQkJCQkJdmFyIG9iamVjdCA9IHNjZW5lLmNoaWxkcmVuWyBpIF07CgkJCQkJCXZhciBkZWxheSA9IGkgKiAxNTsKCgkJCQkJCW5ldyBUV0VFTi5Ud2Vlbiggb2JqZWN0LnBvc2l0aW9uICkKCQkJCQkJCS50byggeyB5OiAtIDIwMDAgfSwgMTAwMCApCgkJCQkJCQkuZGVsYXkoIGRlbGF5ICkKCQkJCQkJCS5lYXNpbmcoIFRXRUVOLkVhc2luZy5FeHBvbmVudGlhbC5JbiApCgkJCQkJCQkub25Db21wbGV0ZSggZnVuY3Rpb24gKCkgewoKCQkJCQkJCQlzY2VuZS5yZW1vdmUoIG9iamVjdCApOwoKCQkJCQkJCX0gKQoJCQkJCQkJLnN0YXJ0KCk7CgoJCQkJCX0gKSgpOwoKCQkJCX0KCgkJCQl2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwoJCQkJcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCAnbG9hZCcsIG9uRGF0YSwgZmFsc2UgKTsKCQkJCXJlcXVlc3Qub3BlbiggJ0dFVCcsICdodHRwczovL2dkYXRhLnlvdXR1YmUuY29tL2ZlZWRzL2FwaS92aWRlb3M/dj0yJmFsdD1qc29uJm1heC1yZXN1bHRzPTUwJnE9JyArIHF1ZXJ5LCB0cnVlICk7CgkJCQlyZXF1ZXN0LnNlbmQoIG51bGwgKTsKCgkJCX0KCQkJCgkJCWZ1bmN0aW9uIG9uRGF0YSggZXZlbnQgKSB7CgoJCQkJdmFyIGRhdGEgPSBKU09OLnBhcnNlKCBldmVudC50YXJnZXQucmVzcG9uc2VUZXh0ICk7CgkJCQl2YXIgZW50cmllcyA9IGRhdGEuZmVlZC5lbnRyeTsKCgkJCQkvLyBjb25zb2xlLmxvZyggZW50cmllcyApOwoKCQkJCWZvciAoIHZhciBpID0gMDsgaSA8IGVudHJpZXMubGVuZ3RoOyBpICsrICkgewoKCQkJCQkoIGZ1bmN0aW9uICggZGF0YSwgdGltZSApIHsKCgkJCQkJCXNldFRpbWVvdXQoIGZ1bmN0aW9uICgpIHsKCgkJCQkJCQlzY2VuZS5hZGQoIG5ldyBFbGVtZW50KCBkYXRhICkgKTsKCgkJCQkJCX0sIHRpbWUgKTsKCgkJCQkJfSApKCBlbnRyaWVzWyBpIF0sIGkgKiAxNSApOwoJCQkJCgkJCQl9CgoJCQl9CgoJCQlmdW5jdGlvbiBtb3ZlKCBkZWx0YSApIHsKCgkJCQlmb3IgKCB2YXIgaSA9IDA7IGkgPCBzY2VuZS5jaGlsZHJlbi5sZW5ndGg7IGkgKysgKSB7CgoJCQkJCXZhciBvYmplY3QgPSBzY2VuZS5jaGlsZHJlblsgaSBdOwoKCQkJCQlvYmplY3QucG9zaXRpb24ueiArPSBkZWx0YTsKCgkJCQkJaWYgKCBvYmplY3QucG9zaXRpb24ueiA+IDAgKSB7CgoJCQkJCQlvYmplY3QucG9zaXRpb24ueiAtPSA1MDAwOwoKCQkJCQl9IGVsc2UgaWYgKCBvYmplY3QucG9zaXRpb24ueiA8IC0gNTAwMCApIHsKCgkJCQkJCW9iamVjdC5wb3NpdGlvbi56ICs9IDUwMDA7CgoJCQkJCX0KCgkJCQl9CgoJCQl9CgoJCQlmdW5jdGlvbiBvbk1vdXNlV2hlZWwoIGV2ZW50ICkgewoKCQkJCW1vdmUoIGV2ZW50LndoZWVsRGVsdGEgKTsKCgkJCX0KCgkJCWZ1bmN0aW9uIG9uV2luZG93UmVzaXplKCkgewoKCQkJCWNhbWVyYS5hc3BlY3QgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodDsKCQkJCWNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7CgoJCQkJcmVuZGVyZXIuc2V0U2l6ZSggd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCApOwoKCQkJfQoKCQkJZnVuY3Rpb24gYW5pbWF0ZSgpIHsKCgkJCQlyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIGFuaW1hdGUgKTsKCgkJCQlUV0VFTi51cGRhdGUoKTsKCgkJCQlpZiAoIGF1dG8gPT09IHRydWUgKSB7CgoJCQkJCW1vdmUoIDEgKTsKCgkJCQl9CgoJCQkJcmVuZGVyZXIucmVuZGVyKCBzY2VuZSwgY2FtZXJhICk7CgoJCQl9CgoJCTwvc2NyaXB0PgoJPC9ib2R5Pgo8L2h0bWw+Cg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 15:37:54 GMT",
                    "Content-Length": "10231",
                    "Date": "Sat, 08 Nov 2014 15:37:56 GMT",
                    "Content-Type": "text/html; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "HTML",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}