{
    "url": "http://localhost:9999/cern-it-sdc-id/webfts/js/dropboxHelper.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Cross-site scripting (DOM-based)",
    "issueType": 2097936,
    "severity": "High",
    "confidence": "Firm",
    "issueBackground": "DOM-based cross-site scripting vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.<br><br>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.<br><br>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities. ",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data into the HTML document that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.",
    "issueDetail": "The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>location</b> and written to <b>$()</b> via the following statement:<ul><li>$(location).attr('href',urlAuth);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/cern-it-sdc-id/webfts/js/dropboxHelper.js",
                "path": "/cern-it-sdc-id/webfts/js/dropboxHelper.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9jZXJuLWl0LXNkYy1pZC93ZWJmdHMvanMvZHJvcGJveEhlbHBlci5qcyBIVFRQLzEuMQ0KSG9zdDogbG9jYWxob3N0Ojk5OTkNCg0K",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTA0MjgNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkRhdGU6IFN1biwgMDkgTm92IDIwMTQgMDI6MjQ6MjAgR01UDQpMYXN0LU1vZGlmaWVkOiBTdW4sIDA5IE5vdiAyMDE0IDAyOjI0OjIwIEdNVA0KDQpmdW5jdGlvbiBEcm9wYm94KCl7IAoJdGhpcy5kcm9wYm94RW5kcG9pbnQgPSAiaHR0cHM6Ly93d3cuZHJvcGJveC5jb20vMSI7CgkvKnRoaXMuZHJvcGJveEFwaSA9ICJodHRwczovL2FwaS5kcm9wYm94LmNvbS8xIjsKCXRoaXMuZHJvcGJveEFwaUNvbnRlbnQgPSAiaHR0cHM6Ly9hcGktY29udGVudC5kcm9wYm94LmNvbS8xIjsqLwoKCXRoaXMuZ2V0Q1NBY2Nlc3MgPSBmdW5jdGlvbihsb2dpbkRpdiwgY29udGVudERpdiwgcGF0aCwgY29udGFpbmVyLCBjb250YWluZXJUYWJsZSwgaW5kaWNhdG9yLCBzdGF0ZVRleHQsIGZpbHRlciwgZW5kcG9pbnRJbnB1dCwgQ1NOYW1lKXsKCQkvL1N0ZXAgMTogY2hlY2sgaWYgdGhlIHVzZXIgaGFzIGFza2VkIGZvciBhY2Nlc3MKCQl2YXIgdXJsRSA9IHNlc3Npb25TdG9yYWdlLmZ0c1Jlc3RFbmRwb2ludCArICIvY3MvYWNjZXNzX3JlcXVlc3QvZHJvcGJveCI7CgkJJC5zdXBwb3J0LmNvcnMgPSB0cnVlOwoJCSQuYWpheCh7CgkJCXVybCA6IHVybEUsCgkJCXR5cGUgOiAiR0VUIiwKCQkJZGF0YVR5cGUgOiAnanNvbicsCgkJCXhockZpZWxkcyA6IHsKCQkJCXdpdGhDcmVkZW50aWFscyA6IHRydWUKCQkJfSwKCQkJc3VjY2VzcyA6IGZ1bmN0aW9uKGRhdGExLCBzdGF0dXMpIHsJCQkJCgkJCQkvL0NoZWNrIGlmIHVzZXIgaGFzIGFscmVhZHkgYWNjZXNzCgkJCQl2YXIgdXJsRSA9IHNlc3Npb25TdG9yYWdlLmZ0c1Jlc3RFbmRwb2ludCArICIvY3MvcmVnaXN0ZXJlZC9kcm9wYm94IjsKCQkJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkJCSQuYWpheCh7CgkJCQkJdXJsIDogdXJsRSwKCQkJCQl0eXBlIDogIkdFVCIsCgkJCQkJZGF0YVR5cGUgOiAnanNvbicsCgkJCQkJeGhyRmllbGRzIDogewoJCQkJCQl3aXRoQ3JlZGVudGlhbHMgOiB0cnVlCgkJCQkJfSwKCQkJCQlzdWNjZXNzIDogZnVuY3Rpb24oZGF0YTEsIHN0YXR1cykgewoJCQkJCQlpZiAoZGF0YTEgPT0gbnVsbCB8fCBkYXRhMSAhPSB0cnVlKXsKCQkJCQkJCS8vUmVxdWVzdCB0b2tlbnMgcmVxdWVzdGVkLCBidXQgbm90IGFjY2VzcyB0b2tlbnMgeWV0CgkJCQkJCQluZXcgRHJvcGJveCgpLmdldEFjY2Vzc1Rva2Vucyhsb2dpbkRpdiwgY29udGVudERpdiwgcGF0aCwgY29udGFpbmVyLCBjb250YWluZXJUYWJsZSwgaW5kaWNhdG9yLCBzdGF0ZVRleHQsIGZpbHRlciwgZW5kcG9pbnRJbnB1dCwgQ1NOYW1lKTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCW5ldyBEcm9wYm94KCkuZ2V0Q29udGVudChsb2dpbkRpdiwgY29udGVudERpdiwgcGF0aCwgY29udGFpbmVyLCBjb250YWluZXJUYWJsZSwgaW5kaWNhdG9yLCBzdGF0ZVRleHQsIGZpbHRlciwgZW5kcG9pbnRJbnB1dCwgQ1NOYW1lKTsKCQkJCQkJfQoJCQkJCX0sCgkJCQkJZXJyb3IgOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHsKCQkJCQkJc2hvd0Vycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgIkVycm9yIGNoZWNraW5nIGlmIHRoZSB1c2VyIGhhcyBhY2Nlc3MgZ3JhbnRlZC4gIik7CgkJCQkJfQoJCQkJfSk7CQkJCQoJCQl9LAoJCQllcnJvciA6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgewoJCQkJaWYgKGpxWEhSLnN0YXR1cyA9PSAiNDA0Iil7CgkJCQkJbmV3IERyb3Bib3goKS5nZXRSZXF1ZXN0VG9rZW5zKCk7CgkJCQl9ZWxzZSB7CgkJCQkJc2hvd0Vycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgIkVycm9yIGNoZWNraW5nIGlmIERyb3Bib3ggaXMgc3VwcG9ydGVkLiAiKTsKCQkJCX0JCgkJCX0KCQl9KTsKCX07CgkKCXRoaXMuZ2V0UmVxdWVzdFRva2VucyA9IGZ1bmN0aW9uICgpewkJCgkJdmFyIHVybEVuZHAgPSBzZXNzaW9uU3RvcmFnZS5mdHNSZXN0RW5kcG9pbnQgKyAiL2NzL2FjY2Vzc19yZXF1ZXN0L2Ryb3Bib3gvcmVxdWVzdCI7CgkJdmFyIGVwID0gdGhpcy5kcm9wYm94RW5kcG9pbnQ7CgkJJC5zdXBwb3J0LmNvcnMgPSB0cnVlOwoJCSQuYWpheCh7CgkJCXVybCA6IHVybEVuZHAsCgkJCXR5cGUgOiAiR0VUIiwKCQkJLy9kYXRhVHlwZSA6ICdqc29uJywKCQkJeGhyRmllbGRzIDogewoJCQkJd2l0aENyZWRlbnRpYWxzIDogdHJ1ZQoJCQl9LAoJCQlzdWNjZXNzIDogZnVuY3Rpb24oZGF0YTEsIHN0YXR1cykgewkJCQkKCQkJCXZhciB1cmxBdXRoID0gZXAgKyAiL29hdXRoL2F1dGhvcml6ZT9vYXV0aF90b2tlbj0iICsgZGF0YTEuc3BsaXQoJyYnKVsxXS5zcGxpdCgnPScpWzFdICsgIiZvYXV0aF9jYWxsYmFjaz0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LlVSTCsiP3NlcnZpY2U9ZHJvcGJveCIpOwoJCQkJY29uc29sZS5sb2codXJsQXV0aCk7CgkJCQkkKGxvY2F0aW9uKS5hdHRyKCdocmVmJyx1cmxBdXRoKTsKCQkJfSwKCQkJZXJyb3IgOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHsKCQkJCXNob3dFcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24sICJFcnJvciBvYnRhaW5pbmcgcmVxdWVzdCB0b2tlbnMuICIpOwoJCQl9CgkJfSk7Cgl9OwoJCgl0aGlzLmdldEFjY2Vzc1Rva2VucyA9IGZ1bmN0aW9uIChsb2dpbkRpdiwgY29udGVudERpdiwgcGF0aCwgY29udGFpbmVyLCBjb250YWluZXJUYWJsZSwgaW5kaWNhdG9yLCBzdGF0ZVRleHQsIGZpbHRlciwgZW5kcG9pbnRJbnB1dCwgQ1NOYW1lKXsJCQoJCXZhciB1cmxFbmRwID0gc2Vzc2lvblN0b3JhZ2UuZnRzUmVzdEVuZHBvaW50ICsgIi9jcy9hY2Nlc3NfZ3JhbnQvZHJvcGJveCI7CgkJJC5zdXBwb3J0LmNvcnMgPSB0cnVlOwoJCSQuYWpheCh7CgkJCXVybCA6IHVybEVuZHAsCgkJCS8vZGF0YVR5cGUgOiAndGV4dCcsCgkJCXR5cGUgOiAiR0VUIiwKCQkJLy9kYXRhVHlwZSA6ICdqc29uJywKCQkJeGhyRmllbGRzIDogewoJCQkJd2l0aENyZWRlbnRpYWxzIDogdHJ1ZQoJCQl9LAoJCQlzdWNjZXNzIDogZnVuY3Rpb24oZGF0YTEsIHN0YXR1cykgewkJCQkKCQkJCWNvbnNvbGUubG9nKCJUb2tlbnMgb2J0YWluZWQgc3VjY2Vzc2Z1bHkiKTsJCgkJCQluZXcgRHJvcGJveCgpLmdldENvbnRlbnQobG9naW5EaXYsIGNvbnRlbnREaXYsIHBhdGgsIGNvbnRhaW5lciwgY29udGFpbmVyVGFibGUsIGluZGljYXRvciwgc3RhdGVUZXh0LCBmaWx0ZXIsIGVuZHBvaW50SW5wdXQsIENTTmFtZSk7CgkJCX0sCgkJCWVycm9yIDogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CgkJCQlzaG93RXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duLCAiRXJyb3Igb2J0YWluaW5nIHJlcXVlc3QgdG9rZW5zLiAiKTsKCQkJfQoJCX0pOwoJfTsKCQoJdGhpcy5nZXRDb250ZW50ID0gZnVuY3Rpb24gKGxvZ2luRGl2LCBjb250ZW50RGl2LCBwYXRoLCBjb250YWluZXIsIGNvbnRhaW5lclRhYmxlLCBpbmRpY2F0b3IsIHN0YXRlVGV4dCwgZmlsdGVyLCBlbmRwb2ludElucHV0LCBDU05hbWUpewkJCQoJCXZhciB1cmxFbmRwID0gc2Vzc2lvblN0b3JhZ2UuZnRzUmVzdEVuZHBvaW50ICsgIi9jcy9yZW1vdGVfY29udGVudC9kcm9wYm94P3N1cmw9IiArIHBhdGg7IC8vKyAiL21ldGFkYXRhL2Ryb3Bib3giICsgcGF0aCArICI/bGlzdD10cnVlIjsKCQkvKmlmIChwYXRoID09ICIvIikKCQkJdXJsRW5kcCArPSAibnVsbCI7CgkJZWxzZQoJCQl1cmxFbmRwICs9IGVuY29kZVVSSUNvbXBvbmVudChwYXRoKTsqLwoJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkkLmFqYXgoewoJCQl1cmwgOiB1cmxFbmRwLAoJCQl0eXBlIDogIkdFVCIsCgkJCWRhdGFUeXBlIDogJ2pzb24nLAoJCQlwcm9jZXNzRGF0YSA6IGZhbHNlLAoJCQl4aHJGaWVsZHMgOiB7CgkJCQl3aXRoQ3JlZGVudGlhbHMgOiB0cnVlCgkJCX0sCgkJCXN1Y2Nlc3MgOiBmdW5jdGlvbihkYXRhMSwgc3RhdHVzKSB7CQkJCQkJCQkKCQkJCWxvYWRDU0ZvbGRlcihsb2dpbkRpdiwgY29udGVudERpdiwgZGF0YTEsIHBhdGgsIGNvbnRhaW5lciwgY29udGFpbmVyVGFibGUsIGluZGljYXRvciwgc3RhdGVUZXh0LCBmaWx0ZXIsIGVuZHBvaW50SW5wdXQsIENTTmFtZSk7CQkJCQoJCQl9LAoJCQllcnJvciA6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgewoJCQkJc2hvd0Vycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgIkVycm9yIGNvbm5lY3RpbmcgdG8gRHJvcGJveCB0byBsb2FkIGZpbGVzLiAiKTsKCQkJfQoJCX0pOwoJfTsKCQoJLy90aGlzLnN1Ym1pdCA9IGZ1bmN0aW9uIChmaWxlTGlzdCwgdXJsTGlzdCwgZGVzdEZvbGRlcil7CQkKCS8vCXJ1bkRhdGFUcmFuc2ZlcigkKCcjZGVsZWdhdGlvbl9pZCcpLnZhbCgpLCBnZXRDU0RhdGFUcmFuc2ZlcihkZXN0Rm9sZGVyLCBzZWxlY3RlZEZpbGVzLCAiZHJvcGJveCIpKTsKCS8vfTsKCS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgovKgkKCXRoaXMuZ2V0QXV0aFJlcXVlc3QgPSBmdW5jdGlvbigpewoJCXZhciBlcCA9IHRoaXMuZHJvcGJveEVuZHBvaW50OwoJCXZhciBjYiA9IHRoaXMuY2FsbGJhY2tVcmw7CgkJdmFyIHVybEVuZHAgPSBlcCArICcvb2F1dGgvcmVxdWVzdF90b2tlbic7CgkJJC5zdXBwb3J0LmNvcnMgPSB0cnVlOwoJCSQuYWpheCh7CgkJCXVybCA6IHVybEVuZHAsCgkJCWhlYWRlcnMgOiB7ICdBdXRob3JpemF0aW9uJyA6ICdPQXV0aCBvYXV0aF92ZXJzaW9uPSIxLjAiLCBvYXV0aF9zaWduYXR1cmVfbWV0aG9kPSJQTEFJTlRFWFQiLCBvYXV0aF9jb25zdW1lcl9rZXk9IicgKyB0aGlzLmFwcF9rZXkgKyAnIiwgb2F1dGhfc2lnbmF0dXJlPSInICsgdGhpcy5hcHBfc2VjcmV0ICsgJyInIH0sCQoJCQl0eXBlIDogIlBPU1QiLAoJCQlzdWNjZXNzIDogZnVuY3Rpb24oZGF0YTEsIHN0YXR1cykgewoJCQkJLy9jb25zb2xlLmxvZygiQ29ubmVjdGVkOiAiICsgZGF0YTEpOwoJCQkJLy9UT0RPOiByZXF1ZXN0X3NlY3JldF90b2tlbiwgY2FsbGVkIHJzdCwgc2hvdWxkIG5vdCBiZSBoZXJlLiBTaG91bGQgYmUga2VwdCBzZWNyZXQhISEhISEhISEhISEhISEhISEhISEhISEhISEgT25seSBmb3IgdGVzdGluZy4KCQkJCXZhciB1cmxBdXRoID0gZXAgKyAiL29hdXRoL2F1dGhvcml6ZT9vYXV0aF90b2tlbj0iICsgZGF0YTEuc3BsaXQoJyYnKVsxXS5zcGxpdCgnPScpWzFdICsgIiZvYXV0aF9jYWxsYmFjaz0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGNiICsgIj9zZXJ2aWNlPWRyb3Bib3gmcnN0PSIgKyBkYXRhMS5zcGxpdCgnJicpWzBdLnNwbGl0KCc9JylbMV0pOwoJCQkJY29uc29sZS5sb2coInJlcXVlc3Rfc2VjcmV0X3Rva2VuPSIgKyBkYXRhMS5zcGxpdCgnJicpWzBdLnNwbGl0KCc9JylbMV0pOwoJCQkJY29uc29sZS5sb2codXJsQXV0aCk7CgkJCQkkKGxvY2F0aW9uKS5hdHRyKCdocmVmJyx1cmxBdXRoKTsKCQkJfSwKCQkJZXJyb3IgOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHsKCQkJCXNob3dFcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24sICJFcnJvciBjb25uZWN0aW5nIHRvIERyb3Bib3ggdG8gb2J0YWluIGF1dGggdG9rZW5zLiAiKTsKCQkJfQoJCX0pOwoJfTsKCgl0aGlzLmdldEFjY2Vzc1JlcXVlc3QgPSBmdW5jdGlvbiAob2F1dGhfdG9rZW4sIHJlcXVlc3Rfc2VjcmV0X3Rva2VuKXsKCQl2YXIgY2IgPSB0aGlzLmNhbGxiYWNrVXJsOwoJCXZhciB1cmxFbmRwID0gdGhpcy5kcm9wYm94RW5kcG9pbnQgKyAnL29hdXRoL2FjY2Vzc190b2tlbic7CgkJJC5zdXBwb3J0LmNvcnMgPSB0cnVlOwoJCSQuYWpheCh7CgkJCXVybCA6IHVybEVuZHAsCgkJCWhlYWRlcnMgOiB7ICdBdXRob3JpemF0aW9uJyA6ICdPQXV0aCBvYXV0aF92ZXJzaW9uPSIxLjAiLCBvYXV0aF9zaWduYXR1cmVfbWV0aG9kPSJQTEFJTlRFWFQiLCBvYXV0aF9jb25zdW1lcl9rZXk9IicgKyB0aGlzLmFwcF9rZXkgKyAnIiwgb2F1dGhfdG9rZW49IicgKyBvYXV0aF90b2tlbiArICciLCBvYXV0aF9zaWduYXR1cmU9IicgKyB0aGlzLmFwcF9zZWNyZXQgKyByZXF1ZXN0X3NlY3JldF90b2tlbiArICciJ30sCQkKCQkJdHlwZSA6ICJQT1NUIiwKCQkJc3VjY2VzcyA6IGZ1bmN0aW9uKGRhdGExLCBzdGF0dXMpIHsKCQkJCWNvbnNvbGUubG9nKGRhdGExKTsKCQkJCXZhciB1cmxBdXRoID0gY2IgKyAiP3NlcnZpY2U9ZHJvcGJveCYiICsgZGF0YTE7CgkJCQljb25zb2xlLmxvZyh1cmxBdXRoKTsKCQkJCSQobG9jYXRpb24pLmF0dHIoJ2hyZWYnLHVybEF1dGgpOwoJCQl9LAoJCQllcnJvciA6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgewoJCQkJc2hvd0Vycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgIkVycm9yIGNvbm5lY3RpbmcgdG8gRHJvcGJveCB0byBvYnRhaW4gYWNjZXNzIHRva2Vucy4gIik7CgkJCX0KCQl9KTsKCX07CgkKCXRoaXMuZ2V0TWV0YWRhdGEgPSBmdW5jdGlvbiAob2F1dGhfdG9rZW4sIG9hdXRoX3Rva2VuX3NlY3JldCwgcGF0aCwgY29udGFpbmVyLCBjb250YWluZXJUYWJsZSwgaW5kaWNhdG9yLCBzdGF0ZVRleHQsIGZpbHRlciwgZW5kcG9pbnRJbnB1dCl7CQkKCQl2YXIgdXJsRW5kcCA9IHRoaXMuZHJvcGJveEFwaSArICcvbWV0YWRhdGEvZHJvcGJveCcgKyBwYXRoICsgIj9saXN0PXRydWUiOwoJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkkLmFqYXgoewoJCQl1cmwgOiB1cmxFbmRwLAoJCQkvL2RhdGFUeXBlIDogJ2pzb24nLAoJCQloZWFkZXJzIDogeyAnQXV0aG9yaXphdGlvbicgOiAnT0F1dGggb2F1dGhfdmVyc2lvbj0iMS4wIiwgb2F1dGhfc2lnbmF0dXJlX21ldGhvZD0iUExBSU5URVhUIiwgb2F1dGhfY29uc3VtZXJfa2V5PSInICsgdGhpcy5hcHBfa2V5ICsgJyIsIG9hdXRoX3Rva2VuPSInICsgb2F1dGhfdG9rZW4gKyAnIiwgb2F1dGhfc2lnbmF0dXJlPSInICsgdGhpcy5hcHBfc2VjcmV0ICsgb2F1dGhfdG9rZW5fc2VjcmV0ICsgJyInfSwJCQoJCQl0eXBlIDogIkdFVCIsCgkJCWRhdGFUeXBlIDogJ2pzb24nLAoJCQlzdWNjZXNzIDogZnVuY3Rpb24oZGF0YTEsIHN0YXR1cykgewkJCQkKCQkJCS8vY29uc29sZS5sb2coIlN1Y2VzcyBsb2FkZWQgY29udGVudDogIiArIGRhdGExKTsJCQkJCgkJCQkvL3JldHVybiBkYXRhMTsKCQkJCWxvYWRDU0ZvbGRlcihkYXRhMSwgcGF0aCwgY29udGFpbmVyLCBjb250YWluZXJUYWJsZSwgaW5kaWNhdG9yLCBzdGF0ZVRleHQsIGZpbHRlciwgZW5kcG9pbnRJbnB1dCk7CgkJCX0sCgkJCWVycm9yIDogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CgkJCQlzaG93RXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duLCAiRXJyb3IgY29ubmVjdGluZyB0byBEcm9wYm94IHRvIGxvYWQgZmlsZXMuICIpOwoJCQl9CgkJfSk7Cgl9OwoJCgl0aGlzLmdldFNoYXJlTGlua0FuZFN1Ym1pdCA9IGZ1bmN0aW9uIChvYXV0aF90b2tlbiwgb2F1dGhfdG9rZW5fc2VjcmV0LCBmaWxlTGlzdCwgdXJsTGlzdCwgZGVzdEZvbGRlcil7CQkKCQkvL3ZhciB1cmxFbmRwID0gdGhpcy5kcm9wYm94QXBpICsgJy9zaGFyZXMvZHJvcGJveCcgKyBmaWxlTGlzdFswXSArICI/c2hvcnRfdXJsPXRydWUiOwoJCXZhciB1cmxFbmRwID0gdGhpcy5kcm9wYm94QXBpICsgJy9tZWRpYS9kcm9wYm94JyArIGZpbGVMaXN0WzBdIDsKCQkkLnN1cHBvcnQuY29ycyA9IHRydWU7CgkJJC5hamF4KHsKCQkJdXJsIDogdXJsRW5kcCwKCQkJZGF0YVR5cGUgOiAnanNvbicsCgkJCWhlYWRlcnMgOiB7ICdBdXRob3JpemF0aW9uJyA6ICdPQXV0aCBvYXV0aF92ZXJzaW9uPSIxLjAiLCBvYXV0aF9zaWduYXR1cmVfbWV0aG9kPSJQTEFJTlRFWFQiLCBvYXV0aF9jb25zdW1lcl9rZXk9IicgKyB0aGlzLmFwcF9rZXkgKyAnIiwgb2F1dGhfdG9rZW49IicgKyBvYXV0aF90b2tlbiArICciLCBvYXV0aF9zaWduYXR1cmU9IicgKyB0aGlzLmFwcF9zZWNyZXQgKyBvYXV0aF90b2tlbl9zZWNyZXQgKyAnIid9LAkJCgkJCXR5cGUgOiAiUE9TVCIsCQkJCgkJCXN1Y2Nlc3MgOiBmdW5jdGlvbihkYXRhMSwgc3RhdHVzKSB7CQkJCQoJCQkJZmlsZUxpc3Quc3BsaWNlKDAsIDEpOwoJCQkJdXJsTGlzdC5wdXNoKGRhdGExKTsKCQkJCXZhciBmYWN0b3J5ID0gbmV3IENTRmFjdG9yeSgpOwoJCSAgICAJdmFyIGNzID0gZmFjdG9yeS5jcmVhdGVDUygiZHJvcGJveCIpOwkJCQkKCQkJCWlmIChmaWxlTGlzdC5sZW5ndGggPT0gMCl7CgkJCQkJLy9BbGwgdXJscyBvYnRhaW5lZC4gU3VibWl0IQoJCQkJCXZhciBzZWxlY3RlZEZpbGVzID0gW107CgkJCQkJZm9yICh2YXIgaT0wOyBpPHVybExpc3QubGVuZ3RoOyBpKyspewoJCQkJCQlzZWxlY3RlZEZpbGVzLnB1c2godXJsTGlzdFtpXS51cmwpOwoJCQkJCX0KCQkJCQkvL1RPRE86IHNhY2FyIGVsIGRpcmVjdG9yaW8gZGUgb3J0aWdlbiB5IGJvcnJhciBkaWNobyBkaXJlY3RvcmlvIGRlbCBwYXRoIGRlIGxvcyBmaWxlcwoJCQkJCXZhciBteURhdGEgPSBnZXRDU0RhdGFUcmFuc2ZlcihkZXN0Rm9sZGVyLCBzZWxlY3RlZEZpbGVzKTsKCQkJCQlydW5EYXRhVHJhbnNmZXIoJCgnI2RlbGVnYXRpb25faWQnKS52YWwoKSwgbXlEYXRhKTsKCQkJCX0gZWxzZSB7CgkJCQkJY3MuZ2V0U2hhcmVMaW5rQW5kU3VibWl0KG9hdXRoX3Rva2VuLCBvYXV0aF90b2tlbl9zZWNyZXQsIGZpbGVMaXN0LCB1cmxMaXN0LCBkZXN0Rm9sZGVyKTsKCQkJCX0JCgkJCX0sCgkJCWVycm9yIDogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CgkJCQlzaG93RXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duLCAiRXJyb3IgY29ubmVjdGluZyB0byBEcm9wYm94IHRvIGxvYWQgZmlsZXMuICIpOwoJCQl9CgkJfSk7Cgl9OwoJCgl0aGlzLnVwbG9hZEZpbGUgPSBmdW5jdGlvbiAob2F1dGhfdG9rZW4sIG9hdXRoX3Rva2VuX3NlY3JldCwgZmlsZSwgZmlsZU5hbWUsIGRlc3RGb2xkZXIsIG92ZXJ3cml0ZSl7CQkKCQkvL3ZhciB1cmxFbmRwID0gdGhpcy5kcm9wYm94QXBpICsgJy9zaGFyZXMvZHJvcGJveCcgKyBmaWxlTGlzdFswXSArICI/c2hvcnRfdXJsPXRydWUiOwoJCXZhciB1cmxFbmRwID0gdGhpcy5kcm9wYm94QXBpQ29udGVudCArICcvZmlsZXNfcHV0L2Ryb3Bib3gnICsgZGVzdEZvbGRlciArIGZpbGVOYW1lICsiP292ZXJ3cml0ZT0iICsgb3ZlcndyaXRlOwoJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkkLmFqYXgoewoJCQl1cmwgOiB1cmxFbmRwLAoJCQlkYXRhVHlwZSA6ICdqc29uJywKCQkJZGF0YTogZmlsZSwKCQkJaGVhZGVycyA6IHsgJ0F1dGhvcml6YXRpb24nIDogJ09BdXRoIG9hdXRoX3ZlcnNpb249IjEuMCIsIG9hdXRoX3NpZ25hdHVyZV9tZXRob2Q9IlBMQUlOVEVYVCIsIG9hdXRoX2NvbnN1bWVyX2tleT0iJyArIHRoaXMuYXBwX2tleSArICciLCBvYXV0aF90b2tlbj0iJyArIG9hdXRoX3Rva2VuICsgJyIsIG9hdXRoX3NpZ25hdHVyZT0iJyArIHRoaXMuYXBwX3NlY3JldCArIG9hdXRoX3Rva2VuX3NlY3JldCArICciJ30sCQkKCQkJdHlwZSA6ICJQVVQiLAkJCQoJCQlzdWNjZXNzIDogZnVuY3Rpb24oZGF0YTEsIHN0YXR1cykgewkJCQkKLy8JCQkJZmlsZUxpc3Quc3BsaWNlKDAsIDEpOwovLwkJCQl1cmxMaXN0LnB1c2goZGF0YTEpOwovLwkJCQl2YXIgZmFjdG9yeSA9IG5ldyBDU0ZhY3RvcnkoKTsKLy8JCSAgICAJdmFyIGNzID0gZmFjdG9yeS5jcmVhdGVDUygiZHJvcGJveCIpOwkJCQkKLy8JCQkJaWYgKGZpbGVMaXN0Lmxlbmd0aCA9PSAwKXsKLy8JCQkJCS8vQWxsIHVybHMgb2J0YWluZWQuIFN1Ym1pdCEKLy8JCQkJCXZhciBzZWxlY3RlZEZpbGVzID0gW107Ci8vCQkJCQlmb3IgKHZhciBpPTA7IGk8dXJsTGlzdC5sZW5ndGg7IGkrKyl7Ci8vCQkJCQkJc2VsZWN0ZWRGaWxlcy5wdXNoKHVybExpc3RbaV0udXJsKTsKLy8JCQkJCX0KLy8JCQkJCS8vVE9ETzogc2FjYXIgZWwgZGlyZWN0b3JpbyBkZSBvcnRpZ2VuIHkgYm9ycmFyIGRpY2hvIGRpcmVjdG9yaW8gZGVsIHBhdGggZGUgbG9zIGZpbGVzCi8vCQkJCQl2YXIgbXlEYXRhID0gZ2V0Q1NEYXRhVHJhbnNmZXIoZGVzdEZvbGRlciwgc2VsZWN0ZWRGaWxlcyk7Ci8vCQkJCQlydW5EYXRhVHJhbnNmZXIoJCgnI2RlbGVnYXRpb25faWQnKS52YWwoKSwgbXlEYXRhKTsKLy8JCQkJfSBlbHNlIHsKLy8JCQkJCWNzLmdldFNoYXJlTGlua0FuZFN1Ym1pdChvYXV0aF90b2tlbiwgb2F1dGhfdG9rZW5fc2VjcmV0LCBmaWxlTGlzdCwgdXJsTGlzdCwgZGVzdEZvbGRlcik7Ci8vCQkJCX0JCgkJCQkKCQkJfSwKCQkJZXJyb3IgOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHsKCQkJCXNob3dFcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24sICJFcnJvciBjb25uZWN0aW5nIHRvIERyb3Bib3ggdG8gbG9hZCBmaWxlcy4gIik7CgkJCX0KCQl9KTsKCX07Ki8KfQo=",
                "body": "ZnVuY3Rpb24gRHJvcGJveCgpeyAKCXRoaXMuZHJvcGJveEVuZHBvaW50ID0gImh0dHBzOi8vd3d3LmRyb3Bib3guY29tLzEiOwoJLyp0aGlzLmRyb3Bib3hBcGkgPSAiaHR0cHM6Ly9hcGkuZHJvcGJveC5jb20vMSI7Cgl0aGlzLmRyb3Bib3hBcGlDb250ZW50ID0gImh0dHBzOi8vYXBpLWNvbnRlbnQuZHJvcGJveC5jb20vMSI7Ki8KCgl0aGlzLmdldENTQWNjZXNzID0gZnVuY3Rpb24obG9naW5EaXYsIGNvbnRlbnREaXYsIHBhdGgsIGNvbnRhaW5lciwgY29udGFpbmVyVGFibGUsIGluZGljYXRvciwgc3RhdGVUZXh0LCBmaWx0ZXIsIGVuZHBvaW50SW5wdXQsIENTTmFtZSl7CgkJLy9TdGVwIDE6IGNoZWNrIGlmIHRoZSB1c2VyIGhhcyBhc2tlZCBmb3IgYWNjZXNzCgkJdmFyIHVybEUgPSBzZXNzaW9uU3RvcmFnZS5mdHNSZXN0RW5kcG9pbnQgKyAiL2NzL2FjY2Vzc19yZXF1ZXN0L2Ryb3Bib3giOwoJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkkLmFqYXgoewoJCQl1cmwgOiB1cmxFLAoJCQl0eXBlIDogIkdFVCIsCgkJCWRhdGFUeXBlIDogJ2pzb24nLAoJCQl4aHJGaWVsZHMgOiB7CgkJCQl3aXRoQ3JlZGVudGlhbHMgOiB0cnVlCgkJCX0sCgkJCXN1Y2Nlc3MgOiBmdW5jdGlvbihkYXRhMSwgc3RhdHVzKSB7CQkJCQoJCQkJLy9DaGVjayBpZiB1c2VyIGhhcyBhbHJlYWR5IGFjY2VzcwoJCQkJdmFyIHVybEUgPSBzZXNzaW9uU3RvcmFnZS5mdHNSZXN0RW5kcG9pbnQgKyAiL2NzL3JlZ2lzdGVyZWQvZHJvcGJveCI7CgkJCQkkLnN1cHBvcnQuY29ycyA9IHRydWU7CgkJCQkkLmFqYXgoewoJCQkJCXVybCA6IHVybEUsCgkJCQkJdHlwZSA6ICJHRVQiLAoJCQkJCWRhdGFUeXBlIDogJ2pzb24nLAoJCQkJCXhockZpZWxkcyA6IHsKCQkJCQkJd2l0aENyZWRlbnRpYWxzIDogdHJ1ZQoJCQkJCX0sCgkJCQkJc3VjY2VzcyA6IGZ1bmN0aW9uKGRhdGExLCBzdGF0dXMpIHsKCQkJCQkJaWYgKGRhdGExID09IG51bGwgfHwgZGF0YTEgIT0gdHJ1ZSl7CgkJCQkJCQkvL1JlcXVlc3QgdG9rZW5zIHJlcXVlc3RlZCwgYnV0IG5vdCBhY2Nlc3MgdG9rZW5zIHlldAoJCQkJCQkJbmV3IERyb3Bib3goKS5nZXRBY2Nlc3NUb2tlbnMobG9naW5EaXYsIGNvbnRlbnREaXYsIHBhdGgsIGNvbnRhaW5lciwgY29udGFpbmVyVGFibGUsIGluZGljYXRvciwgc3RhdGVUZXh0LCBmaWx0ZXIsIGVuZHBvaW50SW5wdXQsIENTTmFtZSk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQluZXcgRHJvcGJveCgpLmdldENvbnRlbnQobG9naW5EaXYsIGNvbnRlbnREaXYsIHBhdGgsIGNvbnRhaW5lciwgY29udGFpbmVyVGFibGUsIGluZGljYXRvciwgc3RhdGVUZXh0LCBmaWx0ZXIsIGVuZHBvaW50SW5wdXQsIENTTmFtZSk7CgkJCQkJCX0KCQkJCQl9LAoJCQkJCWVycm9yIDogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CgkJCQkJCXNob3dFcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24sICJFcnJvciBjaGVja2luZyBpZiB0aGUgdXNlciBoYXMgYWNjZXNzIGdyYW50ZWQuICIpOwoJCQkJCX0KCQkJCX0pOwkJCQkKCQkJfSwKCQkJZXJyb3IgOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHsKCQkJCWlmIChqcVhIUi5zdGF0dXMgPT0gIjQwNCIpewoJCQkJCW5ldyBEcm9wYm94KCkuZ2V0UmVxdWVzdFRva2VucygpOwoJCQkJfWVsc2UgewoJCQkJCXNob3dFcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24sICJFcnJvciBjaGVja2luZyBpZiBEcm9wYm94IGlzIHN1cHBvcnRlZC4gIik7CgkJCQl9CQoJCQl9CgkJfSk7Cgl9OwoJCgl0aGlzLmdldFJlcXVlc3RUb2tlbnMgPSBmdW5jdGlvbiAoKXsJCQoJCXZhciB1cmxFbmRwID0gc2Vzc2lvblN0b3JhZ2UuZnRzUmVzdEVuZHBvaW50ICsgIi9jcy9hY2Nlc3NfcmVxdWVzdC9kcm9wYm94L3JlcXVlc3QiOwoJCXZhciBlcCA9IHRoaXMuZHJvcGJveEVuZHBvaW50OwoJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkkLmFqYXgoewoJCQl1cmwgOiB1cmxFbmRwLAoJCQl0eXBlIDogIkdFVCIsCgkJCS8vZGF0YVR5cGUgOiAnanNvbicsCgkJCXhockZpZWxkcyA6IHsKCQkJCXdpdGhDcmVkZW50aWFscyA6IHRydWUKCQkJfSwKCQkJc3VjY2VzcyA6IGZ1bmN0aW9uKGRhdGExLCBzdGF0dXMpIHsJCQkJCgkJCQl2YXIgdXJsQXV0aCA9IGVwICsgIi9vYXV0aC9hdXRob3JpemU/b2F1dGhfdG9rZW49IiArIGRhdGExLnNwbGl0KCcmJylbMV0uc3BsaXQoJz0nKVsxXSArICImb2F1dGhfY2FsbGJhY2s9IiArIGVuY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5VUkwrIj9zZXJ2aWNlPWRyb3Bib3giKTsKCQkJCWNvbnNvbGUubG9nKHVybEF1dGgpOwoJCQkJJChsb2NhdGlvbikuYXR0cignaHJlZicsdXJsQXV0aCk7CgkJCX0sCgkJCWVycm9yIDogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CgkJCQlzaG93RXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duLCAiRXJyb3Igb2J0YWluaW5nIHJlcXVlc3QgdG9rZW5zLiAiKTsKCQkJfQoJCX0pOwoJfTsKCQoJdGhpcy5nZXRBY2Nlc3NUb2tlbnMgPSBmdW5jdGlvbiAobG9naW5EaXYsIGNvbnRlbnREaXYsIHBhdGgsIGNvbnRhaW5lciwgY29udGFpbmVyVGFibGUsIGluZGljYXRvciwgc3RhdGVUZXh0LCBmaWx0ZXIsIGVuZHBvaW50SW5wdXQsIENTTmFtZSl7CQkKCQl2YXIgdXJsRW5kcCA9IHNlc3Npb25TdG9yYWdlLmZ0c1Jlc3RFbmRwb2ludCArICIvY3MvYWNjZXNzX2dyYW50L2Ryb3Bib3giOwoJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkkLmFqYXgoewoJCQl1cmwgOiB1cmxFbmRwLAoJCQkvL2RhdGFUeXBlIDogJ3RleHQnLAoJCQl0eXBlIDogIkdFVCIsCgkJCS8vZGF0YVR5cGUgOiAnanNvbicsCgkJCXhockZpZWxkcyA6IHsKCQkJCXdpdGhDcmVkZW50aWFscyA6IHRydWUKCQkJfSwKCQkJc3VjY2VzcyA6IGZ1bmN0aW9uKGRhdGExLCBzdGF0dXMpIHsJCQkJCgkJCQljb25zb2xlLmxvZygiVG9rZW5zIG9idGFpbmVkIHN1Y2Nlc3NmdWx5Iik7CQoJCQkJbmV3IERyb3Bib3goKS5nZXRDb250ZW50KGxvZ2luRGl2LCBjb250ZW50RGl2LCBwYXRoLCBjb250YWluZXIsIGNvbnRhaW5lclRhYmxlLCBpbmRpY2F0b3IsIHN0YXRlVGV4dCwgZmlsdGVyLCBlbmRwb2ludElucHV0LCBDU05hbWUpOwoJCQl9LAoJCQllcnJvciA6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgewoJCQkJc2hvd0Vycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgIkVycm9yIG9idGFpbmluZyByZXF1ZXN0IHRva2Vucy4gIik7CgkJCX0KCQl9KTsKCX07CgkKCXRoaXMuZ2V0Q29udGVudCA9IGZ1bmN0aW9uIChsb2dpbkRpdiwgY29udGVudERpdiwgcGF0aCwgY29udGFpbmVyLCBjb250YWluZXJUYWJsZSwgaW5kaWNhdG9yLCBzdGF0ZVRleHQsIGZpbHRlciwgZW5kcG9pbnRJbnB1dCwgQ1NOYW1lKXsJCQkKCQl2YXIgdXJsRW5kcCA9IHNlc3Npb25TdG9yYWdlLmZ0c1Jlc3RFbmRwb2ludCArICIvY3MvcmVtb3RlX2NvbnRlbnQvZHJvcGJveD9zdXJsPSIgKyBwYXRoOyAvLysgIi9tZXRhZGF0YS9kcm9wYm94IiArIHBhdGggKyAiP2xpc3Q9dHJ1ZSI7CgkJLyppZiAocGF0aCA9PSAiLyIpCgkJCXVybEVuZHAgKz0gIm51bGwiOwoJCWVsc2UKCQkJdXJsRW5kcCArPSBlbmNvZGVVUklDb21wb25lbnQocGF0aCk7Ki8KCQkkLnN1cHBvcnQuY29ycyA9IHRydWU7CgkJJC5hamF4KHsKCQkJdXJsIDogdXJsRW5kcCwKCQkJdHlwZSA6ICJHRVQiLAoJCQlkYXRhVHlwZSA6ICdqc29uJywKCQkJcHJvY2Vzc0RhdGEgOiBmYWxzZSwKCQkJeGhyRmllbGRzIDogewoJCQkJd2l0aENyZWRlbnRpYWxzIDogdHJ1ZQoJCQl9LAoJCQlzdWNjZXNzIDogZnVuY3Rpb24oZGF0YTEsIHN0YXR1cykgewkJCQkJCQkJCgkJCQlsb2FkQ1NGb2xkZXIobG9naW5EaXYsIGNvbnRlbnREaXYsIGRhdGExLCBwYXRoLCBjb250YWluZXIsIGNvbnRhaW5lclRhYmxlLCBpbmRpY2F0b3IsIHN0YXRlVGV4dCwgZmlsdGVyLCBlbmRwb2ludElucHV0LCBDU05hbWUpOwkJCQkKCQkJfSwKCQkJZXJyb3IgOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHsKCQkJCXNob3dFcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24sICJFcnJvciBjb25uZWN0aW5nIHRvIERyb3Bib3ggdG8gbG9hZCBmaWxlcy4gIik7CgkJCX0KCQl9KTsKCX07CgkKCS8vdGhpcy5zdWJtaXQgPSBmdW5jdGlvbiAoZmlsZUxpc3QsIHVybExpc3QsIGRlc3RGb2xkZXIpewkJCgkvLwlydW5EYXRhVHJhbnNmZXIoJCgnI2RlbGVnYXRpb25faWQnKS52YWwoKSwgZ2V0Q1NEYXRhVHJhbnNmZXIoZGVzdEZvbGRlciwgc2VsZWN0ZWRGaWxlcywgImRyb3Bib3giKSk7CgkvL307CgkvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIKLyoJCgl0aGlzLmdldEF1dGhSZXF1ZXN0ID0gZnVuY3Rpb24oKXsKCQl2YXIgZXAgPSB0aGlzLmRyb3Bib3hFbmRwb2ludDsKCQl2YXIgY2IgPSB0aGlzLmNhbGxiYWNrVXJsOwoJCXZhciB1cmxFbmRwID0gZXAgKyAnL29hdXRoL3JlcXVlc3RfdG9rZW4nOwoJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkkLmFqYXgoewoJCQl1cmwgOiB1cmxFbmRwLAoJCQloZWFkZXJzIDogeyAnQXV0aG9yaXphdGlvbicgOiAnT0F1dGggb2F1dGhfdmVyc2lvbj0iMS4wIiwgb2F1dGhfc2lnbmF0dXJlX21ldGhvZD0iUExBSU5URVhUIiwgb2F1dGhfY29uc3VtZXJfa2V5PSInICsgdGhpcy5hcHBfa2V5ICsgJyIsIG9hdXRoX3NpZ25hdHVyZT0iJyArIHRoaXMuYXBwX3NlY3JldCArICciJyB9LAkKCQkJdHlwZSA6ICJQT1NUIiwKCQkJc3VjY2VzcyA6IGZ1bmN0aW9uKGRhdGExLCBzdGF0dXMpIHsKCQkJCS8vY29uc29sZS5sb2coIkNvbm5lY3RlZDogIiArIGRhdGExKTsKCQkJCS8vVE9ETzogcmVxdWVzdF9zZWNyZXRfdG9rZW4sIGNhbGxlZCByc3QsIHNob3VsZCBub3QgYmUgaGVyZS4gU2hvdWxkIGJlIGtlcHQgc2VjcmV0ISEhISEhISEhISEhISEhISEhISEhISEhISEhIE9ubHkgZm9yIHRlc3RpbmcuCgkJCQl2YXIgdXJsQXV0aCA9IGVwICsgIi9vYXV0aC9hdXRob3JpemU/b2F1dGhfdG9rZW49IiArIGRhdGExLnNwbGl0KCcmJylbMV0uc3BsaXQoJz0nKVsxXSArICImb2F1dGhfY2FsbGJhY2s9IiArIGVuY29kZVVSSUNvbXBvbmVudChjYiArICI/c2VydmljZT1kcm9wYm94JnJzdD0iICsgZGF0YTEuc3BsaXQoJyYnKVswXS5zcGxpdCgnPScpWzFdKTsKCQkJCWNvbnNvbGUubG9nKCJyZXF1ZXN0X3NlY3JldF90b2tlbj0iICsgZGF0YTEuc3BsaXQoJyYnKVswXS5zcGxpdCgnPScpWzFdKTsKCQkJCWNvbnNvbGUubG9nKHVybEF1dGgpOwoJCQkJJChsb2NhdGlvbikuYXR0cignaHJlZicsdXJsQXV0aCk7CgkJCX0sCgkJCWVycm9yIDogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CgkJCQlzaG93RXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duLCAiRXJyb3IgY29ubmVjdGluZyB0byBEcm9wYm94IHRvIG9idGFpbiBhdXRoIHRva2Vucy4gIik7CgkJCX0KCQl9KTsKCX07CgoJdGhpcy5nZXRBY2Nlc3NSZXF1ZXN0ID0gZnVuY3Rpb24gKG9hdXRoX3Rva2VuLCByZXF1ZXN0X3NlY3JldF90b2tlbil7CgkJdmFyIGNiID0gdGhpcy5jYWxsYmFja1VybDsKCQl2YXIgdXJsRW5kcCA9IHRoaXMuZHJvcGJveEVuZHBvaW50ICsgJy9vYXV0aC9hY2Nlc3NfdG9rZW4nOwoJCSQuc3VwcG9ydC5jb3JzID0gdHJ1ZTsKCQkkLmFqYXgoewoJCQl1cmwgOiB1cmxFbmRwLAoJCQloZWFkZXJzIDogeyAnQXV0aG9yaXphdGlvbicgOiAnT0F1dGggb2F1dGhfdmVyc2lvbj0iMS4wIiwgb2F1dGhfc2lnbmF0dXJlX21ldGhvZD0iUExBSU5URVhUIiwgb2F1dGhfY29uc3VtZXJfa2V5PSInICsgdGhpcy5hcHBfa2V5ICsgJyIsIG9hdXRoX3Rva2VuPSInICsgb2F1dGhfdG9rZW4gKyAnIiwgb2F1dGhfc2lnbmF0dXJlPSInICsgdGhpcy5hcHBfc2VjcmV0ICsgcmVxdWVzdF9zZWNyZXRfdG9rZW4gKyAnIid9LAkJCgkJCXR5cGUgOiAiUE9TVCIsCgkJCXN1Y2Nlc3MgOiBmdW5jdGlvbihkYXRhMSwgc3RhdHVzKSB7CgkJCQljb25zb2xlLmxvZyhkYXRhMSk7CgkJCQl2YXIgdXJsQXV0aCA9IGNiICsgIj9zZXJ2aWNlPWRyb3Bib3gmIiArIGRhdGExOwoJCQkJY29uc29sZS5sb2codXJsQXV0aCk7CgkJCQkkKGxvY2F0aW9uKS5hdHRyKCdocmVmJyx1cmxBdXRoKTsKCQkJfSwKCQkJZXJyb3IgOiBmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHsKCQkJCXNob3dFcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24sICJFcnJvciBjb25uZWN0aW5nIHRvIERyb3Bib3ggdG8gb2J0YWluIGFjY2VzcyB0b2tlbnMuICIpOwoJCQl9CgkJfSk7Cgl9OwoJCgl0aGlzLmdldE1ldGFkYXRhID0gZnVuY3Rpb24gKG9hdXRoX3Rva2VuLCBvYXV0aF90b2tlbl9zZWNyZXQsIHBhdGgsIGNvbnRhaW5lciwgY29udGFpbmVyVGFibGUsIGluZGljYXRvciwgc3RhdGVUZXh0LCBmaWx0ZXIsIGVuZHBvaW50SW5wdXQpewkJCgkJdmFyIHVybEVuZHAgPSB0aGlzLmRyb3Bib3hBcGkgKyAnL21ldGFkYXRhL2Ryb3Bib3gnICsgcGF0aCArICI/bGlzdD10cnVlIjsKCQkkLnN1cHBvcnQuY29ycyA9IHRydWU7CgkJJC5hamF4KHsKCQkJdXJsIDogdXJsRW5kcCwKCQkJLy9kYXRhVHlwZSA6ICdqc29uJywKCQkJaGVhZGVycyA6IHsgJ0F1dGhvcml6YXRpb24nIDogJ09BdXRoIG9hdXRoX3ZlcnNpb249IjEuMCIsIG9hdXRoX3NpZ25hdHVyZV9tZXRob2Q9IlBMQUlOVEVYVCIsIG9hdXRoX2NvbnN1bWVyX2tleT0iJyArIHRoaXMuYXBwX2tleSArICciLCBvYXV0aF90b2tlbj0iJyArIG9hdXRoX3Rva2VuICsgJyIsIG9hdXRoX3NpZ25hdHVyZT0iJyArIHRoaXMuYXBwX3NlY3JldCArIG9hdXRoX3Rva2VuX3NlY3JldCArICciJ30sCQkKCQkJdHlwZSA6ICJHRVQiLAoJCQlkYXRhVHlwZSA6ICdqc29uJywKCQkJc3VjY2VzcyA6IGZ1bmN0aW9uKGRhdGExLCBzdGF0dXMpIHsJCQkJCgkJCQkvL2NvbnNvbGUubG9nKCJTdWNlc3MgbG9hZGVkIGNvbnRlbnQ6ICIgKyBkYXRhMSk7CQkJCQoJCQkJLy9yZXR1cm4gZGF0YTE7CgkJCQlsb2FkQ1NGb2xkZXIoZGF0YTEsIHBhdGgsIGNvbnRhaW5lciwgY29udGFpbmVyVGFibGUsIGluZGljYXRvciwgc3RhdGVUZXh0LCBmaWx0ZXIsIGVuZHBvaW50SW5wdXQpOwoJCQl9LAoJCQllcnJvciA6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgewoJCQkJc2hvd0Vycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgIkVycm9yIGNvbm5lY3RpbmcgdG8gRHJvcGJveCB0byBsb2FkIGZpbGVzLiAiKTsKCQkJfQoJCX0pOwoJfTsKCQoJdGhpcy5nZXRTaGFyZUxpbmtBbmRTdWJtaXQgPSBmdW5jdGlvbiAob2F1dGhfdG9rZW4sIG9hdXRoX3Rva2VuX3NlY3JldCwgZmlsZUxpc3QsIHVybExpc3QsIGRlc3RGb2xkZXIpewkJCgkJLy92YXIgdXJsRW5kcCA9IHRoaXMuZHJvcGJveEFwaSArICcvc2hhcmVzL2Ryb3Bib3gnICsgZmlsZUxpc3RbMF0gKyAiP3Nob3J0X3VybD10cnVlIjsKCQl2YXIgdXJsRW5kcCA9IHRoaXMuZHJvcGJveEFwaSArICcvbWVkaWEvZHJvcGJveCcgKyBmaWxlTGlzdFswXSA7CgkJJC5zdXBwb3J0LmNvcnMgPSB0cnVlOwoJCSQuYWpheCh7CgkJCXVybCA6IHVybEVuZHAsCgkJCWRhdGFUeXBlIDogJ2pzb24nLAoJCQloZWFkZXJzIDogeyAnQXV0aG9yaXphdGlvbicgOiAnT0F1dGggb2F1dGhfdmVyc2lvbj0iMS4wIiwgb2F1dGhfc2lnbmF0dXJlX21ldGhvZD0iUExBSU5URVhUIiwgb2F1dGhfY29uc3VtZXJfa2V5PSInICsgdGhpcy5hcHBfa2V5ICsgJyIsIG9hdXRoX3Rva2VuPSInICsgb2F1dGhfdG9rZW4gKyAnIiwgb2F1dGhfc2lnbmF0dXJlPSInICsgdGhpcy5hcHBfc2VjcmV0ICsgb2F1dGhfdG9rZW5fc2VjcmV0ICsgJyInfSwJCQoJCQl0eXBlIDogIlBPU1QiLAkJCQoJCQlzdWNjZXNzIDogZnVuY3Rpb24oZGF0YTEsIHN0YXR1cykgewkJCQkKCQkJCWZpbGVMaXN0LnNwbGljZSgwLCAxKTsKCQkJCXVybExpc3QucHVzaChkYXRhMSk7CgkJCQl2YXIgZmFjdG9yeSA9IG5ldyBDU0ZhY3RvcnkoKTsKCQkgICAgCXZhciBjcyA9IGZhY3RvcnkuY3JlYXRlQ1MoImRyb3Bib3giKTsJCQkJCgkJCQlpZiAoZmlsZUxpc3QubGVuZ3RoID09IDApewoJCQkJCS8vQWxsIHVybHMgb2J0YWluZWQuIFN1Ym1pdCEKCQkJCQl2YXIgc2VsZWN0ZWRGaWxlcyA9IFtdOwoJCQkJCWZvciAodmFyIGk9MDsgaTx1cmxMaXN0Lmxlbmd0aDsgaSsrKXsKCQkJCQkJc2VsZWN0ZWRGaWxlcy5wdXNoKHVybExpc3RbaV0udXJsKTsKCQkJCQl9CgkJCQkJLy9UT0RPOiBzYWNhciBlbCBkaXJlY3RvcmlvIGRlIG9ydGlnZW4geSBib3JyYXIgZGljaG8gZGlyZWN0b3JpbyBkZWwgcGF0aCBkZSBsb3MgZmlsZXMKCQkJCQl2YXIgbXlEYXRhID0gZ2V0Q1NEYXRhVHJhbnNmZXIoZGVzdEZvbGRlciwgc2VsZWN0ZWRGaWxlcyk7CgkJCQkJcnVuRGF0YVRyYW5zZmVyKCQoJyNkZWxlZ2F0aW9uX2lkJykudmFsKCksIG15RGF0YSk7CgkJCQl9IGVsc2UgewoJCQkJCWNzLmdldFNoYXJlTGlua0FuZFN1Ym1pdChvYXV0aF90b2tlbiwgb2F1dGhfdG9rZW5fc2VjcmV0LCBmaWxlTGlzdCwgdXJsTGlzdCwgZGVzdEZvbGRlcik7CgkJCQl9CQoJCQl9LAoJCQllcnJvciA6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgewoJCQkJc2hvd0Vycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93biwgIkVycm9yIGNvbm5lY3RpbmcgdG8gRHJvcGJveCB0byBsb2FkIGZpbGVzLiAiKTsKCQkJfQoJCX0pOwoJfTsKCQoJdGhpcy51cGxvYWRGaWxlID0gZnVuY3Rpb24gKG9hdXRoX3Rva2VuLCBvYXV0aF90b2tlbl9zZWNyZXQsIGZpbGUsIGZpbGVOYW1lLCBkZXN0Rm9sZGVyLCBvdmVyd3JpdGUpewkJCgkJLy92YXIgdXJsRW5kcCA9IHRoaXMuZHJvcGJveEFwaSArICcvc2hhcmVzL2Ryb3Bib3gnICsgZmlsZUxpc3RbMF0gKyAiP3Nob3J0X3VybD10cnVlIjsKCQl2YXIgdXJsRW5kcCA9IHRoaXMuZHJvcGJveEFwaUNvbnRlbnQgKyAnL2ZpbGVzX3B1dC9kcm9wYm94JyArIGRlc3RGb2xkZXIgKyBmaWxlTmFtZSArIj9vdmVyd3JpdGU9IiArIG92ZXJ3cml0ZTsKCQkkLnN1cHBvcnQuY29ycyA9IHRydWU7CgkJJC5hamF4KHsKCQkJdXJsIDogdXJsRW5kcCwKCQkJZGF0YVR5cGUgOiAnanNvbicsCgkJCWRhdGE6IGZpbGUsCgkJCWhlYWRlcnMgOiB7ICdBdXRob3JpemF0aW9uJyA6ICdPQXV0aCBvYXV0aF92ZXJzaW9uPSIxLjAiLCBvYXV0aF9zaWduYXR1cmVfbWV0aG9kPSJQTEFJTlRFWFQiLCBvYXV0aF9jb25zdW1lcl9rZXk9IicgKyB0aGlzLmFwcF9rZXkgKyAnIiwgb2F1dGhfdG9rZW49IicgKyBvYXV0aF90b2tlbiArICciLCBvYXV0aF9zaWduYXR1cmU9IicgKyB0aGlzLmFwcF9zZWNyZXQgKyBvYXV0aF90b2tlbl9zZWNyZXQgKyAnIid9LAkJCgkJCXR5cGUgOiAiUFVUIiwJCQkKCQkJc3VjY2VzcyA6IGZ1bmN0aW9uKGRhdGExLCBzdGF0dXMpIHsJCQkJCi8vCQkJCWZpbGVMaXN0LnNwbGljZSgwLCAxKTsKLy8JCQkJdXJsTGlzdC5wdXNoKGRhdGExKTsKLy8JCQkJdmFyIGZhY3RvcnkgPSBuZXcgQ1NGYWN0b3J5KCk7Ci8vCQkgICAgCXZhciBjcyA9IGZhY3RvcnkuY3JlYXRlQ1MoImRyb3Bib3giKTsJCQkJCi8vCQkJCWlmIChmaWxlTGlzdC5sZW5ndGggPT0gMCl7Ci8vCQkJCQkvL0FsbCB1cmxzIG9idGFpbmVkLiBTdWJtaXQhCi8vCQkJCQl2YXIgc2VsZWN0ZWRGaWxlcyA9IFtdOwovLwkJCQkJZm9yICh2YXIgaT0wOyBpPHVybExpc3QubGVuZ3RoOyBpKyspewovLwkJCQkJCXNlbGVjdGVkRmlsZXMucHVzaCh1cmxMaXN0W2ldLnVybCk7Ci8vCQkJCQl9Ci8vCQkJCQkvL1RPRE86IHNhY2FyIGVsIGRpcmVjdG9yaW8gZGUgb3J0aWdlbiB5IGJvcnJhciBkaWNobyBkaXJlY3RvcmlvIGRlbCBwYXRoIGRlIGxvcyBmaWxlcwovLwkJCQkJdmFyIG15RGF0YSA9IGdldENTRGF0YVRyYW5zZmVyKGRlc3RGb2xkZXIsIHNlbGVjdGVkRmlsZXMpOwovLwkJCQkJcnVuRGF0YVRyYW5zZmVyKCQoJyNkZWxlZ2F0aW9uX2lkJykudmFsKCksIG15RGF0YSk7Ci8vCQkJCX0gZWxzZSB7Ci8vCQkJCQljcy5nZXRTaGFyZUxpbmtBbmRTdWJtaXQob2F1dGhfdG9rZW4sIG9hdXRoX3Rva2VuX3NlY3JldCwgZmlsZUxpc3QsIHVybExpc3QsIGRlc3RGb2xkZXIpOwovLwkJCQl9CQoJCQkJCgkJCX0sCgkJCWVycm9yIDogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CgkJCQlzaG93RXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duLCAiRXJyb3IgY29ubmVjdGluZyB0byBEcm9wYm94IHRvIGxvYWQgZmlsZXMuICIpOwoJCQl9CgkJfSk7Cgl9OyovCn0K",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sun, 09 Nov 2014 02:24:20 GMT",
                    "Content-Length": "10428",
                    "Date": "Sun, 09 Nov 2014 02:24:20 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}