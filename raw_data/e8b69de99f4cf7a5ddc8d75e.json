{
    "url": "http://localhost:9999/danielfm/jshamcrest/test/integration/qunit/assets/testrunner.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>location.href</b> and written to <b>location.href</b> via the following statement:<ul><li>location.href=location.href.match(/^(.+?)(\\?.*)?$/)[1]+\"?\"+encodeURIComponent(h.trim(o.text()))</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/danielfm/jshamcrest/test/integration/qunit/assets/testrunner.js",
                "path": "/danielfm/jshamcrest/test/integration/qunit/assets/testrunner.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9kYW5pZWxmbS9qc2hhbWNyZXN0L3Rlc3QvaW50ZWdyYXRpb24vcXVuaXQvYXNzZXRzL3Rlc3RydW5uZXIuanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogOTkwMA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogRnJpLCAwNyBOb3YgMjAxNCAwNzozNTo0MyBHTVQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMDcgTm92IDIwMTQgMDc6MzU6NDIgR01UDQoNCihmdW5jdGlvbihoKXtmdW5jdGlvbiBwKGEpe2QucXVldWUucHVzaChhKTtkLmJsb2NraW5nfHxxKCl9ZnVuY3Rpb24gcSgpe2Zvcig7ZC5xdWV1ZS5sZW5ndGgmJiFkLmJsb2NraW5nOylkLnF1ZXVlLnNoaWZ0KCkoKX1mdW5jdGlvbiB1KGEpe2QuYmxvY2tpbmc9dHJ1ZTtpZihhKWQudGltZW91dD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7UVVuaXQub2soZmFsc2UsIlRlc3QgdGltZWQgb3V0Iik7dygpfSxhKX1mdW5jdGlvbiB3KCl7c2V0VGltZW91dChmdW5jdGlvbigpe2QudGltZW91dCYmY2xlYXJUaW1lb3V0KGQudGltZW91dCk7ZC5ibG9ja2luZz1mYWxzZTtxKCl9LDEzKX1mdW5jdGlvbiB2KGEpe3ZhciBnPWQuZmlsdGVycy5sZW5ndGgsaz1mYWxzZTtpZighZylyZXR1cm4gdHJ1ZTtmb3IoO2ctLTspe3ZhciBpPWQuZmlsdGVyc1tnXSxsPWkuY2hhckF0KDApPT0iISI7aWYobClpPWkuc2xpY2UoMSk7aWYoYS5pbmRleE9mKGkpIT0tMSlyZXR1cm4hbDtpZihsKWs9dHJ1ZX1yZXR1cm4ga30KZnVuY3Rpb24gYigpe2QuYmxvY2tpbmc9ZmFsc2U7dmFyIGE9K25ldyBEYXRlO2QuZml4dHVyZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWFpbiIpLmlubmVySFRNTDtkLmFqYXhTZXR0aW5ncz1oLmFqYXhTZXR0aW5ncztwKGZ1bmN0aW9uKCl7aCgnPHAgaWQ9InRlc3RyZXN1bHQiIGNsYXNzPSJyZXN1bHQiLz4nKS5odG1sKFsiVGVzdHMgY29tcGxldGVkIGluICIsK25ldyBEYXRlLWEsJyBtaWxsaXNlY29uZHMuPGJyLz48c3BhbiBjbGFzcz0iYmFkIj4nLGQuc3RhdHMuYmFkLCc8L3NwYW4+IHRlc3RzIG9mIDxzcGFuIGNsYXNzPSJhbGwiPicsZC5zdGF0cy5hbGwsIjwvc3Bhbj4gZmFpbGVkLiJdLmpvaW4oIiIpKS5hcHBlbmRUbygiYm9keSIpO2goIiNiYW5uZXIiKS5hZGRDbGFzcyhkLnN0YXRzLmJhZD8iZmFpbCI6InBhc3MiKTtRVW5pdC5kb25lKGQuc3RhdHMuYmFkLGQuc3RhdHMuYWxsKX0pfWZ1bmN0aW9uIGUoKXtzPVtdO2lmKEQpZm9yKHZhciBhIGluIHdpbmRvdylzLnB1c2goYSl9CmZ1bmN0aW9uIG0oKXt2YXIgYT1zO2UoKTtpZihzLmxlbmd0aD5hLmxlbmd0aCl7eihmYWxzZSwiSW50cm9kdWNlZCBnbG9iYWwgdmFyaWFibGUocyk6ICIrcihhLHMpLmpvaW4oIiwgIikpO2QuZXhwZWN0ZWQrK319ZnVuY3Rpb24gcihhLGcpe3JldHVybiBoLmdyZXAoZyxmdW5jdGlvbihrKXtyZXR1cm4gaC5pbkFycmF5KGssYSk9PS0xfSl9ZnVuY3Rpb24gdChhLGcpe2lmKGQuY3VycmVudE1vZHVsZSlhPWQuY3VycmVudE1vZHVsZSsiIG1vZHVsZTogIithO3ZhciBrPWguZXh0ZW5kKHtzZXR1cDpmdW5jdGlvbigpe30sdGVhcmRvd246ZnVuY3Rpb24oKXt9fSxkLm1vZHVsZUxpZmVjeWNsZSk7aWYodihhKSl7cChmdW5jdGlvbigpe2QuYXNzZXJ0aW9ucz1bXTtkLmV4cGVjdGVkPW51bGw7dHJ5e3N8fGUoKTtrLnNldHVwKCl9Y2F0Y2goaSl7UVVuaXQub2soZmFsc2UsIlNldHVwIGZhaWxlZCBvbiAiK2ErIjogIitpLm1lc3NhZ2UpfX0pO3AoZnVuY3Rpb24oKXt0cnl7ZygpfWNhdGNoKGkpe2lmKHR5cGVvZiBjb25zb2xlIT0KInVuZGVmaW5lZCImJmNvbnNvbGUuZXJyb3ImJmNvbnNvbGUud2Fybil7Y29uc29sZS5lcnJvcigiVGVzdCAiK2ErIiBkaWVkLCBleGNlcHRpb24gYW5kIHRlc3QgZm9sbG93cyIpO2NvbnNvbGUuZXJyb3IoaSk7Y29uc29sZS53YXJuKGcudG9TdHJpbmcoKSl9UVVuaXQub2soZmFsc2UsIkRpZWQgb24gdGVzdCAjIisoZC5hc3NlcnRpb25zLmxlbmd0aCsxKSsiOiAiK2kubWVzc2FnZSk7ZSgpfX0pO3AoZnVuY3Rpb24oKXt0cnl7bSgpO2sudGVhcmRvd24oKX1jYXRjaChpKXtRVW5pdC5vayhmYWxzZSwiVGVhcmRvd24gZmFpbGVkIG9uICIrYSsiOiAiK2kubWVzc2FnZSl9fSk7cChmdW5jdGlvbigpe3RyeXtBKCl9Y2F0Y2goaSl7aWYodHlwZW9mIGNvbnNvbGUhPSJ1bmRlZmluZWQiJiZjb25zb2xlLmVycm9yJiZjb25zb2xlLndhcm4pe2NvbnNvbGUuZXJyb3IoInJlc2V0KCkgZmFpbGVkLCBmb2xsb3dpbmcgVGVzdCAiK2ErIiwgZXhjZXB0aW9uIGFuZCByZXNldCBmbiBmb2xsb3dzIik7CmNvbnNvbGUuZXJyb3IoaSk7Y29uc29sZS53YXJuKEEudG9TdHJpbmcoKSl9fWQuZXhwZWN0ZWQmJmQuZXhwZWN0ZWQhPWQuYXNzZXJ0aW9ucy5sZW5ndGgmJlFVbml0Lm9rKGZhbHNlLCJFeHBlY3RlZCAiK2QuZXhwZWN0ZWQrIiBhc3NlcnRpb25zLCBidXQgIitkLmFzc2VydGlvbnMubGVuZ3RoKyIgd2VyZSBydW4iKTt2YXIgbD0wLGY9MCxjPWgoIjxvbC8+IikuaGlkZSgpO2Quc3RhdHMuYWxsKz1kLmFzc2VydGlvbnMubGVuZ3RoO2Zvcih2YXIgaj0wO2o8ZC5hc3NlcnRpb25zLmxlbmd0aDtqKyspe3ZhciBuPWQuYXNzZXJ0aW9uc1tqXTtoKCI8bGkvPiIpLmFkZENsYXNzKG4ucmVzdWx0PyJwYXNzIjoiZmFpbCIpLnRleHQobi5tZXNzYWdlfHwiKG5vIG1lc3NhZ2UpIikuYXBwZW5kVG8oYyk7bi5yZXN1bHQ/bCsrOmYrK31kLnN0YXRzLmJhZCs9ZjtsPWgoIjxzdHJvbmcvPiIpLmh0bWwoYSsiIDxiIHN0eWxlPSdjb2xvcjpibGFjazsnPig8YiBjbGFzcz0nZmFpbCc+IitmKyI8L2I+LCA8YiBjbGFzcz0ncGFzcyc+IisKbCsiPC9iPiwgIitkLmFzc2VydGlvbnMubGVuZ3RoKyIpPC9iPiIpLmNsaWNrKGZ1bmN0aW9uKCl7aCh0aGlzKS5uZXh0KCkudG9nZ2xlKCl9KS5kYmxjbGljayhmdW5jdGlvbihvKXtvPWgoby50YXJnZXQpLmZpbHRlcigic3Ryb25nIikuY2xvbmUoKTtpZihvLmxlbmd0aCl7by5jaGlsZHJlbigpLnJlbW92ZSgpO2xvY2F0aW9uLmhyZWY9bG9jYXRpb24uaHJlZi5tYXRjaCgvXiguKz8pKFw/LiopPyQvKVsxXSsiPyIrZW5jb2RlVVJJQ29tcG9uZW50KGgudHJpbShvLnRleHQoKSkpfX0pO2goIjxsaS8+IikuYWRkQ2xhc3MoZj8iZmFpbCI6InBhc3MiKS5hcHBlbmQobCkuYXBwZW5kKGMpLmFwcGVuZFRvKCIjdGVzdHMiKTtpZihmKXtoKCIjZmlsdGVyLXBhc3MiKS5hdHRyKCJkaXNhYmxlZCIsbnVsbCk7aCgiI2ZpbHRlci1taXNzaW5nIikuYXR0cigiZGlzYWJsZWQiLG51bGwpfX0pfX1mdW5jdGlvbiB4KGEsZyl7ZC5jdXJyZW50TW9kdWxlPWE7ZC5tb2R1bGVMaWZlY3ljbGU9Z31mdW5jdGlvbiB5KGEpe2QuZXhwZWN0ZWQ9CmF9ZnVuY3Rpb24gQSgpe2goIiNtYWluIikuaHRtbChkLmZpeHR1cmUpO2guZXZlbnQuZ2xvYmFsPXt9O2guYWpheFNldHRpbmdzPWguZXh0ZW5kKHt9LGQuYWpheFNldHRpbmdzKX1mdW5jdGlvbiB6KGEsZyl7UVVuaXQubG9nKGEsZyk7ZC5hc3NlcnRpb25zLnB1c2goe3Jlc3VsdDohIWEsbWVzc2FnZTpnfSl9ZnVuY3Rpb24gRShhLGcsayl7ZnVuY3Rpb24gaShjKXt2YXIgaj1bXTtpZihjJiZjLmxlbmd0aClmb3IodmFyIG49MDtuPGMubGVuZ3RoO24rKyl7dmFyIG89Y1tuXS5ub2RlTmFtZTtpZihvKXtvPW8udG9Mb3dlckNhc2UoKTtpZihjW25dLmlkKW8rPSIjIitjW25dLmlkfWVsc2Ugbz1jW25dO2oucHVzaChvKX1yZXR1cm4iWyAiK2ouam9pbigiLCAiKSsiIF0ifXZhciBsPXRydWU7aWYoYSYmZyYmYS5sZW5ndGghPXVuZGVmaW5lZCYmYS5sZW5ndGg9PWcubGVuZ3RoKWZvcih2YXIgZj0wO2Y8YS5sZW5ndGg7ZisrKXtpZihhW2ZdIT1nW2ZdKWw9ZmFsc2V9ZWxzZSBsPWZhbHNlOwpRVW5pdC5vayhsLCFsP2srIiBleHBlY3RlZDogIitpKGcpKyIgcmVzdWx0OiAiK2koYSk6ayl9ZnVuY3Rpb24gSyhhLGcsayl7dmFyIGk9dHJ1ZTtpZihhJiZnKXtmb3IodmFyIGwgaW4gYSlpZihhW2xdIT1nW2xdKWk9ZmFsc2U7Zm9yKGwgaW4gZylpZihhW2xdIT1nW2xdKWk9ZmFsc2V9ZWxzZSBpPWZhbHNlO1FVbml0Lm9rKGksayl9ZnVuY3Rpb24gQigpe2Zvcih2YXIgYT1bXSxnPTA7Zzxhcmd1bWVudHMubGVuZ3RoO2crKylhLnB1c2goZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYXJndW1lbnRzW2ddKSk7cmV0dXJuIGF9ZnVuY3Rpb24gTChhLGcsayl7Zm9yKHZhciBpPWgoZyksbD0iIixmPTA7ZjxpLmxlbmd0aDtmKyspbCs9KGwmJiIsIikrJyInK2lbZl0uaWQrJyInO0UoaSxCLmFwcGx5KEIsayksYSsiICgiK2crIikiKX1mdW5jdGlvbiBNKGEpe3JldHVybiBhKygvXD8vLnRlc3QoYSk/IiYiOiI/IikrKG5ldyBEYXRlKS5nZXRUaW1lKCkrIiIrcGFyc2VJbnQoTWF0aC5yYW5kb20oKSoKMUU1KX1mdW5jdGlvbiBOKGEsZyxrKXtGKGc9PWEsYSxnLGspfWZ1bmN0aW9uIEYoYSxnLGssaSl7aT1pfHwoYT8ib2theSI6ImZhaWxlZCIpO1FVbml0Lm9rKGEsYT9pKyI6ICIrazppKyIsIGV4cGVjdGVkOiAiK2pzRHVtcC5wYXJzZShrKSsiIHJlc3VsdDogIitqc0R1bXAucGFyc2UoZykpfWZ1bmN0aW9uIE8oYSxnLGspe2lmKGguYnJvd3Nlci5tb3ppbGxhfHxoLmJyb3dzZXIub3BlcmEpe2s9ZG9jdW1lbnQuY3JlYXRlRXZlbnQoIk1vdXNlRXZlbnRzIik7ay5pbml0TW91c2VFdmVudChnLHRydWUsdHJ1ZSxhLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcsMCwwLDAsMCwwLGZhbHNlLGZhbHNlLGZhbHNlLGZhbHNlLDAsbnVsbCk7YS5kaXNwYXRjaEV2ZW50KGspfWVsc2UgaC5icm93c2VyLm1zaWUmJmEuZmlyZUV2ZW50KCJvbiIrZyl9dmFyIEk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGYpe2lmKHR5cGVvZiBmPT09InN0cmluZyIpcmV0dXJuInN0cmluZyI7ZWxzZSBpZih0eXBlb2YgZj09PQoiYm9vbGVhbiIpcmV0dXJuImJvb2xlYW4iO2Vsc2UgaWYodHlwZW9mIGY9PT0ibnVtYmVyIilyZXR1cm4gaXNOYU4oZik/Im5hbiI6Im51bWJlciI7ZWxzZSBpZih0eXBlb2YgZj09PSJ1bmRlZmluZWQiKXJldHVybiJ1bmRlZmluZWQiO2Vsc2UgaWYoZj09PW51bGwpcmV0dXJuIm51bGwiO2Vsc2UgaWYoZiBpbnN0YW5jZW9mIEFycmF5KXJldHVybiJhcnJheSI7ZWxzZSBpZihmIGluc3RhbmNlb2YgRGF0ZSlyZXR1cm4iZGF0ZSI7ZWxzZSBpZihmIGluc3RhbmNlb2YgUmVnRXhwKXJldHVybiJyZWdleHAiO2Vsc2UgaWYodHlwZW9mIGY9PT0ib2JqZWN0IilyZXR1cm4ib2JqZWN0IjtlbHNlIGlmKGYgaW5zdGFuY2VvZiBGdW5jdGlvbilyZXR1cm4iZnVuY3Rpb24ifWZ1bmN0aW9uIGcoZixjLGope2lmKGY9YShmKSlyZXR1cm4gYShjW2ZdKT09PSJmdW5jdGlvbiI/Y1tmXS5hcHBseShjLGopOmNbZl19dmFyIGssaT1bXSxsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZihjLGope3JldHVybiBqPT09CmN9cmV0dXJue3N0cmluZzpmLCJib29sZWFuIjpmLG51bWJlcjpmLCJudWxsIjpmLHVuZGVmaW5lZDpmLG5hbjpmdW5jdGlvbihjKXtyZXR1cm4gaXNOYU4oYyl9LGRhdGU6ZnVuY3Rpb24oYyxqKXtyZXR1cm4gYShjKT09PSJkYXRlIiYmai52YWx1ZU9mKCk9PT1jLnZhbHVlT2YoKX0scmVnZXhwOmZ1bmN0aW9uKGMsail7cmV0dXJuIGEoYyk9PT0icmVnZXhwIiYmai5zb3VyY2U9PT1jLnNvdXJjZSYmai5nbG9iYWw9PT1jLmdsb2JhbCYmai5pZ25vcmVDYXNlPT09Yy5pZ25vcmVDYXNlJiZqLm11bHRpbGluZT09PWMubXVsdGlsaW5lfSwiZnVuY3Rpb24iOmZ1bmN0aW9uKCl7dmFyIGM9aVtpLmxlbmd0aC0xXTtyZXR1cm4gYyE9PU9iamVjdCYmdHlwZW9mIGMhPT0idW5kZWZpbmVkIn0sYXJyYXk6ZnVuY3Rpb24oYyxqKXt2YXIgbixvO2lmKGEoYykhPT0iYXJyYXkiKXJldHVybiBmYWxzZTtvPWoubGVuZ3RoO2lmKG8hPT1jLmxlbmd0aClyZXR1cm4gZmFsc2U7Zm9yKG49MDtuPG87bisrKWlmKCFrKGpbbl0sCmNbbl0pKXJldHVybiBmYWxzZTtyZXR1cm4gdHJ1ZX0sb2JqZWN0OmZ1bmN0aW9uKGMsail7dmFyIG4sbz10cnVlLEc9W10sSD1bXTtpZihqLmNvbnN0cnVjdG9yIT09Yy5jb25zdHJ1Y3RvcilyZXR1cm4gZmFsc2U7aS5wdXNoKGouY29uc3RydWN0b3IpO2ZvcihuIGluIGope0cucHVzaChuKTtrKGpbbl0sY1tuXSl8fChvPWZhbHNlKX1pLnBvcCgpO2ZvcihuIGluIGMpSC5wdXNoKG4pO3JldHVybiBvJiZrKEcuc29ydCgpLEguc29ydCgpKX19fSgpO3JldHVybiBrPWZ1bmN0aW9uKCl7dmFyIGY9QXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGFyZ3VtZW50cyk7aWYoZi5sZW5ndGg8MilyZXR1cm4gdHJ1ZTtyZXR1cm4gZnVuY3Rpb24oYyxqKXtyZXR1cm4gYz09PWo/dHJ1ZTp0eXBlb2YgYyE9PXR5cGVvZiBqfHxjPT09bnVsbHx8aj09PW51bGx8fHR5cGVvZiBjPT09InVuZGVmaW5lZCJ8fHR5cGVvZiBqPT09InVuZGVmaW5lZCI/ZmFsc2U6ZyhjLGwsW2osY10pfShmWzBdLGZbMV0pJiYKYXJndW1lbnRzLmNhbGxlZS5hcHBseSh0aGlzLGYuc3BsaWNlKDEsZi5sZW5ndGgtMSkpfX0oKSxDPWgubWFwKGxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKS5zcGxpdCgiJiIpLGRlY29kZVVSSUNvbXBvbmVudCksSj1oLmluQXJyYXkoIm5vZ2xvYmFscyIsQyksRD1KIT09LTE7RCYmQy5zcGxpY2UoSiwxKTt2YXIgZD17c3RhdHM6e2FsbDowLGJhZDowfSxxdWV1ZTpbXSxibG9ja2luZzp0cnVlLGZpbHRlcnM6Qyxpc0xvY2FsOndpbmRvdy5sb2NhdGlvbi5wcm90b2NvbD09ImZpbGU6In07aC5leHRlbmQod2luZG93LHt0ZXN0OnQsbW9kdWxlOngsZXhwZWN0Onksb2s6eixlcXVhbHM6TixzdGFydDp3LHN0b3A6dSxyZXNldDpBLGlzTG9jYWw6ZC5pc0xvY2FsLHNhbWU6ZnVuY3Rpb24oYSxnLGspe0YoSShhLGcpLGEsZyxrKX0sUVVuaXQ6e2VxdWl2Okksb2s6eixkb25lOmZ1bmN0aW9uKCl7fSxsb2c6ZnVuY3Rpb24oKXt9fSxpc1NldDpFLGlzT2JqOkssY29tcGFyZTpmdW5jdGlvbigpe3Rocm93ImNvbXBhcmUgaXMgZGVwcmVjYXRlZCAtIHVzZSBzYW1lKCkgaW5zdGVhZCI7Cn0sY29tcGFyZTI6ZnVuY3Rpb24oKXt0aHJvdyJjb21wYXJlMiBpcyBkZXByZWNhdGVkIC0gdXNlIHNhbWUoKSBpbnN0ZWFkIjt9LHNlcmlhbEFycmF5OmZ1bmN0aW9uKCl7dGhyb3cic2VyaWFsQXJyYXkgaXMgZGVwcmVjYXRlZCAtIHVzZSBqc0R1bXAucGFyc2UoKSBpbnN0ZWFkIjt9LHE6Qix0OkwsdXJsOk0sdHJpZ2dlckV2ZW50Ok99KTtoKHdpbmRvdykubG9hZChmdW5jdGlvbigpe2goIiN1c2VyQWdlbnQiKS5odG1sKG5hdmlnYXRvci51c2VyQWdlbnQpO3ZhciBhPWgoJzxkaXYgY2xhc3M9InRlc3RydW5uZXItdG9vbGJhciI+PGxhYmVsIGZvcj0iZmlsdGVyLXBhc3MiPkhpZGUgcGFzc2VkIHRlc3RzPC9sYWJlbD48L2Rpdj4nKS5pbnNlcnRBZnRlcigiI3VzZXJBZ2VudCIpO2goJzxpbnB1dCB0eXBlPSJjaGVja2JveCIgaWQ9ImZpbHRlci1wYXNzIiAvPicpLmF0dHIoImRpc2FibGVkIix0cnVlKS5wcmVwZW5kVG8oYSkuY2xpY2soZnVuY3Rpb24oKXtoKCJsaS5wYXNzIilbdGhpcy5jaGVja2VkPwoiaGlkZSI6InNob3ciXSgpfSk7aCgnPGlucHV0IHR5cGU9ImNoZWNrYm94IiBpZD0iZmlsdGVyLW1pc3NpbmciPicpLmF0dHIoImRpc2FibGVkIix0cnVlKS5hcHBlbmRUbyhhKS5jbGljayhmdW5jdGlvbigpe2goImxpLmZhaWw6Y29udGFpbnMoJ21pc3NpbmcgdGVzdCAtIHVudGVzdGVkIGNvZGUgaXMgYnJva2VuIGNvZGUnKSIpLnBhcmVudCgib2wiKS5wYXJlbnQoImxpLmZhaWwiKVt0aGlzLmNoZWNrZWQ/ImhpZGUiOiJzaG93Il0oKX0pO2goIiNmaWx0ZXItbWlzc2luZyIpLmFmdGVyKCc8bGFiZWwgZm9yPSJmaWx0ZXItbWlzc2luZyI+SGlkZSBtaXNzaW5nIHRlc3RzICh1bnRlc3RlZCBjb2RlIGlzIGJyb2tlbiBjb2RlKTwvbGFiZWw+Jyk7YigpfSk7dmFyIHN9KShqUXVlcnkpOwooZnVuY3Rpb24oKXtmdW5jdGlvbiBoKGIpe3JldHVybiciJytiLnRvU3RyaW5nKCkucmVwbGFjZSgvIi9nLCdcXCInKSsnIid9ZnVuY3Rpb24gcChiKXtyZXR1cm4gYisiIn1mdW5jdGlvbiBxKGIsZSxtKXt2YXIgcj12LnNlcGFyYXRvcigpLHQ9di5pbmRlbnQoKTtpbm5lcj12LmluZGVudCgxKTtpZihlLmpvaW4pZT1lLmpvaW4oIiwiK3IraW5uZXIpO2lmKCFlKXJldHVybiBiK207cmV0dXJuW2IsaW5uZXIrZSx0K21dLmpvaW4ocil9ZnVuY3Rpb24gdShiKXt2YXIgZT1iLmxlbmd0aCxtPUFycmF5KGUpO2Zvcih0aGlzLnVwKCk7ZS0tOyltW2VdPXRoaXMucGFyc2UoYltlXSk7dGhpcy5kb3duKCk7cmV0dXJuIHEoIlsiLG0sIl0iKX12YXIgdz0vXmZ1bmN0aW9uIChcdyspLyx2PXdpbmRvdy5qc0R1bXA9e3BhcnNlOmZ1bmN0aW9uKGIsZSl7dmFyIG09dGhpcy5wYXJzZXJzW2V8fHRoaXMudHlwZU9mKGIpXTtlPXR5cGVvZiBtO3JldHVybiBlPT0iZnVuY3Rpb24iP20uY2FsbCh0aGlzLApiKTplPT0ic3RyaW5nIj9tOnRoaXMucGFyc2Vycy5lcnJvcn0sdHlwZU9mOmZ1bmN0aW9uKGIpe3ZhciBlPXR5cGVvZiBiLG09ImZ1bmN0aW9uIjtyZXR1cm4gZSE9Im9iamVjdCImJmUhPW0/ZTohYj8ibnVsbCI6Yi5leGVjPyJyZWdleHAiOmIuZ2V0SG91cnM/ImRhdGUiOmIuc2Nyb2xsQnk/IndpbmRvdyI6Yi5ub2RlTmFtZT09IiNkb2N1bWVudCI/ImRvY3VtZW50IjpiLm5vZGVOYW1lPyJub2RlIjpiLml0ZW0/Im5vZGVsaXN0IjpiLmNhbGxlZT8iYXJndW1lbnRzIjpiLmNhbGx8fGIuY29uc3RydWN0b3IhPUFycmF5JiYoYisiIikuaW5kZXhPZihtKSE9LTE/bToibGVuZ3RoImluIGI/ImFycmF5IjplfSxzZXBhcmF0b3I6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tdWx0aWxpbmU/dGhpcy5IVE1MPyI8YnIgLz4iOiJcbiI6dGhpcy5IVE1MPyImbmJzcDsiOiIgIn0saW5kZW50OmZ1bmN0aW9uKGIpe2lmKCF0aGlzLm11bHRpbGluZSlyZXR1cm4iIjt2YXIgZT10aGlzLmluZGVudENoYXI7CmlmKHRoaXMuSFRNTCllPWUucmVwbGFjZSgvXHQvZywiICAgIikucmVwbGFjZSgvIC9nLCImbmJzcDsiKTtyZXR1cm4gQXJyYXkodGhpcy5fZGVwdGhfKyhifHwwKSkuam9pbihlKX0sdXA6ZnVuY3Rpb24oYil7dGhpcy5fZGVwdGhfKz1ifHwxfSxkb3duOmZ1bmN0aW9uKGIpe3RoaXMuX2RlcHRoXy09Ynx8MX0sc2V0UGFyc2VyOmZ1bmN0aW9uKGIsZSl7dGhpcy5wYXJzZXJzW2JdPWV9LHF1b3RlOmgsbGl0ZXJhbDpwLGpvaW46cSxfZGVwdGhfOjEscGFyc2Vyczp7d2luZG93OiJbV2luZG93XSIsZG9jdW1lbnQ6IltEb2N1bWVudF0iLGVycm9yOiJbRVJST1JdIix1bmtub3duOiJbVW5rbm93bl0iLCJudWxsIjoibnVsbCIsdW5kZWZpbmVkOiJ1bmRlZmluZWQiLCJmdW5jdGlvbiI6ZnVuY3Rpb24oYil7dmFyIGU9ImZ1bmN0aW9uIixtPSJuYW1lImluIGI/Yi5uYW1lOih3LmV4ZWMoYil8fFtdKVsxXTtpZihtKWUrPSIgIittO2UrPSIoIjtlPVtlLHRoaXMucGFyc2UoYiwiZnVuY3Rpb25BcmdzIiksCiIpeyJdLmpvaW4oIiIpO3JldHVybiBxKGUsdGhpcy5wYXJzZShiLCJmdW5jdGlvbkNvZGUiKSwifSIpfSxhcnJheTp1LG5vZGVsaXN0OnUsYXJndW1lbnRzOnUsb2JqZWN0OmZ1bmN0aW9uKGIpe3ZhciBlPVtdO3RoaXMudXAoKTtmb3IodmFyIG0gaW4gYillLnB1c2godGhpcy5wYXJzZShtLCJrZXkiKSsiOiAiK3RoaXMucGFyc2UoYlttXSkpO3RoaXMuZG93bigpO3JldHVybiBxKCJ7IixlLCJ9Iil9LG5vZGU6ZnVuY3Rpb24oYil7dmFyIGU9dGhpcy5IVE1MPyImbHQ7IjoiPCIsbT10aGlzLkhUTUw/IiZndDsiOiI+IixyPWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSx0PWUrcjtmb3IodmFyIHggaW4gdGhpcy5ET01BdHRycyl7dmFyIHk9Ylt0aGlzLkRPTUF0dHJzW3hdXTtpZih5KXQrPSIgIit4KyI9Iit0aGlzLnBhcnNlKHksImF0dHJpYnV0ZSIpfXJldHVybiB0K20rZSsiLyIrcittfSxmdW5jdGlvbkFyZ3M6ZnVuY3Rpb24oYil7Yj1iLmxlbmd0aDtpZighYilyZXR1cm4iIjtmb3IodmFyIGU9CkFycmF5KGIpO2ItLTspZVtiXT1TdHJpbmcuZnJvbUNoYXJDb2RlKDk3K2IpO3JldHVybiIgIitlLmpvaW4oIiwgIikrIiAifSxrZXk6aCxmdW5jdGlvbkNvZGU6Iltjb2RlXSIsYXR0cmlidXRlOmgsc3RyaW5nOmgsZGF0ZTpoLHJlZ2V4cDpwLG51bWJlcjpwLCJib29sZWFuIjpwfSxET01BdHRyczp7aWQ6ImlkIixuYW1lOiJuYW1lIiwiY2xhc3MiOiJjbGFzc05hbWUifSxIVE1MOmZhbHNlLGluZGVudENoYXI6IiAgICIsbXVsdGlsaW5lOnRydWV9fSkoKTsKCg==",
                "body": "KGZ1bmN0aW9uKGgpe2Z1bmN0aW9uIHAoYSl7ZC5xdWV1ZS5wdXNoKGEpO2QuYmxvY2tpbmd8fHEoKX1mdW5jdGlvbiBxKCl7Zm9yKDtkLnF1ZXVlLmxlbmd0aCYmIWQuYmxvY2tpbmc7KWQucXVldWUuc2hpZnQoKSgpfWZ1bmN0aW9uIHUoYSl7ZC5ibG9ja2luZz10cnVlO2lmKGEpZC50aW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtRVW5pdC5vayhmYWxzZSwiVGVzdCB0aW1lZCBvdXQiKTt3KCl9LGEpfWZ1bmN0aW9uIHcoKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZC50aW1lb3V0JiZjbGVhclRpbWVvdXQoZC50aW1lb3V0KTtkLmJsb2NraW5nPWZhbHNlO3EoKX0sMTMpfWZ1bmN0aW9uIHYoYSl7dmFyIGc9ZC5maWx0ZXJzLmxlbmd0aCxrPWZhbHNlO2lmKCFnKXJldHVybiB0cnVlO2Zvcig7Zy0tOyl7dmFyIGk9ZC5maWx0ZXJzW2ddLGw9aS5jaGFyQXQoMCk9PSIhIjtpZihsKWk9aS5zbGljZSgxKTtpZihhLmluZGV4T2YoaSkhPS0xKXJldHVybiFsO2lmKGwpaz10cnVlfXJldHVybiBrfQpmdW5jdGlvbiBiKCl7ZC5ibG9ja2luZz1mYWxzZTt2YXIgYT0rbmV3IERhdGU7ZC5maXh0dXJlPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYWluIikuaW5uZXJIVE1MO2QuYWpheFNldHRpbmdzPWguYWpheFNldHRpbmdzO3AoZnVuY3Rpb24oKXtoKCc8cCBpZD0idGVzdHJlc3VsdCIgY2xhc3M9InJlc3VsdCIvPicpLmh0bWwoWyJUZXN0cyBjb21wbGV0ZWQgaW4gIiwrbmV3IERhdGUtYSwnIG1pbGxpc2Vjb25kcy48YnIvPjxzcGFuIGNsYXNzPSJiYWQiPicsZC5zdGF0cy5iYWQsJzwvc3Bhbj4gdGVzdHMgb2YgPHNwYW4gY2xhc3M9ImFsbCI+JyxkLnN0YXRzLmFsbCwiPC9zcGFuPiBmYWlsZWQuIl0uam9pbigiIikpLmFwcGVuZFRvKCJib2R5Iik7aCgiI2Jhbm5lciIpLmFkZENsYXNzKGQuc3RhdHMuYmFkPyJmYWlsIjoicGFzcyIpO1FVbml0LmRvbmUoZC5zdGF0cy5iYWQsZC5zdGF0cy5hbGwpfSl9ZnVuY3Rpb24gZSgpe3M9W107aWYoRClmb3IodmFyIGEgaW4gd2luZG93KXMucHVzaChhKX0KZnVuY3Rpb24gbSgpe3ZhciBhPXM7ZSgpO2lmKHMubGVuZ3RoPmEubGVuZ3RoKXt6KGZhbHNlLCJJbnRyb2R1Y2VkIGdsb2JhbCB2YXJpYWJsZShzKTogIityKGEscykuam9pbigiLCAiKSk7ZC5leHBlY3RlZCsrfX1mdW5jdGlvbiByKGEsZyl7cmV0dXJuIGguZ3JlcChnLGZ1bmN0aW9uKGspe3JldHVybiBoLmluQXJyYXkoayxhKT09LTF9KX1mdW5jdGlvbiB0KGEsZyl7aWYoZC5jdXJyZW50TW9kdWxlKWE9ZC5jdXJyZW50TW9kdWxlKyIgbW9kdWxlOiAiK2E7dmFyIGs9aC5leHRlbmQoe3NldHVwOmZ1bmN0aW9uKCl7fSx0ZWFyZG93bjpmdW5jdGlvbigpe319LGQubW9kdWxlTGlmZWN5Y2xlKTtpZih2KGEpKXtwKGZ1bmN0aW9uKCl7ZC5hc3NlcnRpb25zPVtdO2QuZXhwZWN0ZWQ9bnVsbDt0cnl7c3x8ZSgpO2suc2V0dXAoKX1jYXRjaChpKXtRVW5pdC5vayhmYWxzZSwiU2V0dXAgZmFpbGVkIG9uICIrYSsiOiAiK2kubWVzc2FnZSl9fSk7cChmdW5jdGlvbigpe3RyeXtnKCl9Y2F0Y2goaSl7aWYodHlwZW9mIGNvbnNvbGUhPQoidW5kZWZpbmVkIiYmY29uc29sZS5lcnJvciYmY29uc29sZS53YXJuKXtjb25zb2xlLmVycm9yKCJUZXN0ICIrYSsiIGRpZWQsIGV4Y2VwdGlvbiBhbmQgdGVzdCBmb2xsb3dzIik7Y29uc29sZS5lcnJvcihpKTtjb25zb2xlLndhcm4oZy50b1N0cmluZygpKX1RVW5pdC5vayhmYWxzZSwiRGllZCBvbiB0ZXN0ICMiKyhkLmFzc2VydGlvbnMubGVuZ3RoKzEpKyI6ICIraS5tZXNzYWdlKTtlKCl9fSk7cChmdW5jdGlvbigpe3RyeXttKCk7ay50ZWFyZG93bigpfWNhdGNoKGkpe1FVbml0Lm9rKGZhbHNlLCJUZWFyZG93biBmYWlsZWQgb24gIithKyI6ICIraS5tZXNzYWdlKX19KTtwKGZ1bmN0aW9uKCl7dHJ5e0EoKX1jYXRjaChpKXtpZih0eXBlb2YgY29uc29sZSE9InVuZGVmaW5lZCImJmNvbnNvbGUuZXJyb3ImJmNvbnNvbGUud2Fybil7Y29uc29sZS5lcnJvcigicmVzZXQoKSBmYWlsZWQsIGZvbGxvd2luZyBUZXN0ICIrYSsiLCBleGNlcHRpb24gYW5kIHJlc2V0IGZuIGZvbGxvd3MiKTsKY29uc29sZS5lcnJvcihpKTtjb25zb2xlLndhcm4oQS50b1N0cmluZygpKX19ZC5leHBlY3RlZCYmZC5leHBlY3RlZCE9ZC5hc3NlcnRpb25zLmxlbmd0aCYmUVVuaXQub2soZmFsc2UsIkV4cGVjdGVkICIrZC5leHBlY3RlZCsiIGFzc2VydGlvbnMsIGJ1dCAiK2QuYXNzZXJ0aW9ucy5sZW5ndGgrIiB3ZXJlIHJ1biIpO3ZhciBsPTAsZj0wLGM9aCgiPG9sLz4iKS5oaWRlKCk7ZC5zdGF0cy5hbGwrPWQuYXNzZXJ0aW9ucy5sZW5ndGg7Zm9yKHZhciBqPTA7ajxkLmFzc2VydGlvbnMubGVuZ3RoO2orKyl7dmFyIG49ZC5hc3NlcnRpb25zW2pdO2goIjxsaS8+IikuYWRkQ2xhc3Mobi5yZXN1bHQ/InBhc3MiOiJmYWlsIikudGV4dChuLm1lc3NhZ2V8fCIobm8gbWVzc2FnZSkiKS5hcHBlbmRUbyhjKTtuLnJlc3VsdD9sKys6ZisrfWQuc3RhdHMuYmFkKz1mO2w9aCgiPHN0cm9uZy8+IikuaHRtbChhKyIgPGIgc3R5bGU9J2NvbG9yOmJsYWNrOyc+KDxiIGNsYXNzPSdmYWlsJz4iK2YrIjwvYj4sIDxiIGNsYXNzPSdwYXNzJz4iKwpsKyI8L2I+LCAiK2QuYXNzZXJ0aW9ucy5sZW5ndGgrIik8L2I+IikuY2xpY2soZnVuY3Rpb24oKXtoKHRoaXMpLm5leHQoKS50b2dnbGUoKX0pLmRibGNsaWNrKGZ1bmN0aW9uKG8pe289aChvLnRhcmdldCkuZmlsdGVyKCJzdHJvbmciKS5jbG9uZSgpO2lmKG8ubGVuZ3RoKXtvLmNoaWxkcmVuKCkucmVtb3ZlKCk7bG9jYXRpb24uaHJlZj1sb2NhdGlvbi5ocmVmLm1hdGNoKC9eKC4rPykoXD8uKik/JC8pWzFdKyI/IitlbmNvZGVVUklDb21wb25lbnQoaC50cmltKG8udGV4dCgpKSl9fSk7aCgiPGxpLz4iKS5hZGRDbGFzcyhmPyJmYWlsIjoicGFzcyIpLmFwcGVuZChsKS5hcHBlbmQoYykuYXBwZW5kVG8oIiN0ZXN0cyIpO2lmKGYpe2goIiNmaWx0ZXItcGFzcyIpLmF0dHIoImRpc2FibGVkIixudWxsKTtoKCIjZmlsdGVyLW1pc3NpbmciKS5hdHRyKCJkaXNhYmxlZCIsbnVsbCl9fSl9fWZ1bmN0aW9uIHgoYSxnKXtkLmN1cnJlbnRNb2R1bGU9YTtkLm1vZHVsZUxpZmVjeWNsZT1nfWZ1bmN0aW9uIHkoYSl7ZC5leHBlY3RlZD0KYX1mdW5jdGlvbiBBKCl7aCgiI21haW4iKS5odG1sKGQuZml4dHVyZSk7aC5ldmVudC5nbG9iYWw9e307aC5hamF4U2V0dGluZ3M9aC5leHRlbmQoe30sZC5hamF4U2V0dGluZ3MpfWZ1bmN0aW9uIHooYSxnKXtRVW5pdC5sb2coYSxnKTtkLmFzc2VydGlvbnMucHVzaCh7cmVzdWx0OiEhYSxtZXNzYWdlOmd9KX1mdW5jdGlvbiBFKGEsZyxrKXtmdW5jdGlvbiBpKGMpe3ZhciBqPVtdO2lmKGMmJmMubGVuZ3RoKWZvcih2YXIgbj0wO248Yy5sZW5ndGg7bisrKXt2YXIgbz1jW25dLm5vZGVOYW1lO2lmKG8pe289by50b0xvd2VyQ2FzZSgpO2lmKGNbbl0uaWQpbys9IiMiK2Nbbl0uaWR9ZWxzZSBvPWNbbl07ai5wdXNoKG8pfXJldHVybiJbICIrai5qb2luKCIsICIpKyIgXSJ9dmFyIGw9dHJ1ZTtpZihhJiZnJiZhLmxlbmd0aCE9dW5kZWZpbmVkJiZhLmxlbmd0aD09Zy5sZW5ndGgpZm9yKHZhciBmPTA7ZjxhLmxlbmd0aDtmKyspe2lmKGFbZl0hPWdbZl0pbD1mYWxzZX1lbHNlIGw9ZmFsc2U7ClFVbml0Lm9rKGwsIWw/aysiIGV4cGVjdGVkOiAiK2koZykrIiByZXN1bHQ6ICIraShhKTprKX1mdW5jdGlvbiBLKGEsZyxrKXt2YXIgaT10cnVlO2lmKGEmJmcpe2Zvcih2YXIgbCBpbiBhKWlmKGFbbF0hPWdbbF0paT1mYWxzZTtmb3IobCBpbiBnKWlmKGFbbF0hPWdbbF0paT1mYWxzZX1lbHNlIGk9ZmFsc2U7UVVuaXQub2soaSxrKX1mdW5jdGlvbiBCKCl7Zm9yKHZhciBhPVtdLGc9MDtnPGFyZ3VtZW50cy5sZW5ndGg7ZysrKWEucHVzaChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhcmd1bWVudHNbZ10pKTtyZXR1cm4gYX1mdW5jdGlvbiBMKGEsZyxrKXtmb3IodmFyIGk9aChnKSxsPSIiLGY9MDtmPGkubGVuZ3RoO2YrKylsKz0obCYmIiwiKSsnIicraVtmXS5pZCsnIic7RShpLEIuYXBwbHkoQixrKSxhKyIgKCIrZysiKSIpfWZ1bmN0aW9uIE0oYSl7cmV0dXJuIGErKC9cPy8udGVzdChhKT8iJiI6Ij8iKSsobmV3IERhdGUpLmdldFRpbWUoKSsiIitwYXJzZUludChNYXRoLnJhbmRvbSgpKgoxRTUpfWZ1bmN0aW9uIE4oYSxnLGspe0YoZz09YSxhLGcsayl9ZnVuY3Rpb24gRihhLGcsayxpKXtpPWl8fChhPyJva2F5IjoiZmFpbGVkIik7UVVuaXQub2soYSxhP2krIjogIitrOmkrIiwgZXhwZWN0ZWQ6ICIranNEdW1wLnBhcnNlKGspKyIgcmVzdWx0OiAiK2pzRHVtcC5wYXJzZShnKSl9ZnVuY3Rpb24gTyhhLGcsayl7aWYoaC5icm93c2VyLm1vemlsbGF8fGguYnJvd3Nlci5vcGVyYSl7az1kb2N1bWVudC5jcmVhdGVFdmVudCgiTW91c2VFdmVudHMiKTtrLmluaXRNb3VzZUV2ZW50KGcsdHJ1ZSx0cnVlLGEub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldywwLDAsMCwwLDAsZmFsc2UsZmFsc2UsZmFsc2UsZmFsc2UsMCxudWxsKTthLmRpc3BhdGNoRXZlbnQoayl9ZWxzZSBoLmJyb3dzZXIubXNpZSYmYS5maXJlRXZlbnQoIm9uIitnKX12YXIgST1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoZil7aWYodHlwZW9mIGY9PT0ic3RyaW5nIilyZXR1cm4ic3RyaW5nIjtlbHNlIGlmKHR5cGVvZiBmPT09CiJib29sZWFuIilyZXR1cm4iYm9vbGVhbiI7ZWxzZSBpZih0eXBlb2YgZj09PSJudW1iZXIiKXJldHVybiBpc05hTihmKT8ibmFuIjoibnVtYmVyIjtlbHNlIGlmKHR5cGVvZiBmPT09InVuZGVmaW5lZCIpcmV0dXJuInVuZGVmaW5lZCI7ZWxzZSBpZihmPT09bnVsbClyZXR1cm4ibnVsbCI7ZWxzZSBpZihmIGluc3RhbmNlb2YgQXJyYXkpcmV0dXJuImFycmF5IjtlbHNlIGlmKGYgaW5zdGFuY2VvZiBEYXRlKXJldHVybiJkYXRlIjtlbHNlIGlmKGYgaW5zdGFuY2VvZiBSZWdFeHApcmV0dXJuInJlZ2V4cCI7ZWxzZSBpZih0eXBlb2YgZj09PSJvYmplY3QiKXJldHVybiJvYmplY3QiO2Vsc2UgaWYoZiBpbnN0YW5jZW9mIEZ1bmN0aW9uKXJldHVybiJmdW5jdGlvbiJ9ZnVuY3Rpb24gZyhmLGMsail7aWYoZj1hKGYpKXJldHVybiBhKGNbZl0pPT09ImZ1bmN0aW9uIj9jW2ZdLmFwcGx5KGMsaik6Y1tmXX12YXIgayxpPVtdLGw9ZnVuY3Rpb24oKXtmdW5jdGlvbiBmKGMsail7cmV0dXJuIGo9PT0KY31yZXR1cm57c3RyaW5nOmYsImJvb2xlYW4iOmYsbnVtYmVyOmYsIm51bGwiOmYsdW5kZWZpbmVkOmYsbmFuOmZ1bmN0aW9uKGMpe3JldHVybiBpc05hTihjKX0sZGF0ZTpmdW5jdGlvbihjLGope3JldHVybiBhKGMpPT09ImRhdGUiJiZqLnZhbHVlT2YoKT09PWMudmFsdWVPZigpfSxyZWdleHA6ZnVuY3Rpb24oYyxqKXtyZXR1cm4gYShjKT09PSJyZWdleHAiJiZqLnNvdXJjZT09PWMuc291cmNlJiZqLmdsb2JhbD09PWMuZ2xvYmFsJiZqLmlnbm9yZUNhc2U9PT1jLmlnbm9yZUNhc2UmJmoubXVsdGlsaW5lPT09Yy5tdWx0aWxpbmV9LCJmdW5jdGlvbiI6ZnVuY3Rpb24oKXt2YXIgYz1pW2kubGVuZ3RoLTFdO3JldHVybiBjIT09T2JqZWN0JiZ0eXBlb2YgYyE9PSJ1bmRlZmluZWQifSxhcnJheTpmdW5jdGlvbihjLGope3ZhciBuLG87aWYoYShjKSE9PSJhcnJheSIpcmV0dXJuIGZhbHNlO289ai5sZW5ndGg7aWYobyE9PWMubGVuZ3RoKXJldHVybiBmYWxzZTtmb3Iobj0wO248bztuKyspaWYoIWsoaltuXSwKY1tuXSkpcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlfSxvYmplY3Q6ZnVuY3Rpb24oYyxqKXt2YXIgbixvPXRydWUsRz1bXSxIPVtdO2lmKGouY29uc3RydWN0b3IhPT1jLmNvbnN0cnVjdG9yKXJldHVybiBmYWxzZTtpLnB1c2goai5jb25zdHJ1Y3Rvcik7Zm9yKG4gaW4gail7Ry5wdXNoKG4pO2soaltuXSxjW25dKXx8KG89ZmFsc2UpfWkucG9wKCk7Zm9yKG4gaW4gYylILnB1c2gobik7cmV0dXJuIG8mJmsoRy5zb3J0KCksSC5zb3J0KCkpfX19KCk7cmV0dXJuIGs9ZnVuY3Rpb24oKXt2YXIgZj1BcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKTtpZihmLmxlbmd0aDwyKXJldHVybiB0cnVlO3JldHVybiBmdW5jdGlvbihjLGope3JldHVybiBjPT09aj90cnVlOnR5cGVvZiBjIT09dHlwZW9mIGp8fGM9PT1udWxsfHxqPT09bnVsbHx8dHlwZW9mIGM9PT0idW5kZWZpbmVkInx8dHlwZW9mIGo9PT0idW5kZWZpbmVkIj9mYWxzZTpnKGMsbCxbaixjXSl9KGZbMF0sZlsxXSkmJgphcmd1bWVudHMuY2FsbGVlLmFwcGx5KHRoaXMsZi5zcGxpY2UoMSxmLmxlbmd0aC0xKSl9fSgpLEM9aC5tYXAobG9jYXRpb24uc2VhcmNoLnNsaWNlKDEpLnNwbGl0KCImIiksZGVjb2RlVVJJQ29tcG9uZW50KSxKPWguaW5BcnJheSgibm9nbG9iYWxzIixDKSxEPUohPT0tMTtEJiZDLnNwbGljZShKLDEpO3ZhciBkPXtzdGF0czp7YWxsOjAsYmFkOjB9LHF1ZXVlOltdLGJsb2NraW5nOnRydWUsZmlsdGVyczpDLGlzTG9jYWw6d2luZG93LmxvY2F0aW9uLnByb3RvY29sPT0iZmlsZToifTtoLmV4dGVuZCh3aW5kb3cse3Rlc3Q6dCxtb2R1bGU6eCxleHBlY3Q6eSxvazp6LGVxdWFsczpOLHN0YXJ0Oncsc3RvcDp1LHJlc2V0OkEsaXNMb2NhbDpkLmlzTG9jYWwsc2FtZTpmdW5jdGlvbihhLGcsayl7RihJKGEsZyksYSxnLGspfSxRVW5pdDp7ZXF1aXY6SSxvazp6LGRvbmU6ZnVuY3Rpb24oKXt9LGxvZzpmdW5jdGlvbigpe319LGlzU2V0OkUsaXNPYmo6Syxjb21wYXJlOmZ1bmN0aW9uKCl7dGhyb3ciY29tcGFyZSBpcyBkZXByZWNhdGVkIC0gdXNlIHNhbWUoKSBpbnN0ZWFkIjsKfSxjb21wYXJlMjpmdW5jdGlvbigpe3Rocm93ImNvbXBhcmUyIGlzIGRlcHJlY2F0ZWQgLSB1c2Ugc2FtZSgpIGluc3RlYWQiO30sc2VyaWFsQXJyYXk6ZnVuY3Rpb24oKXt0aHJvdyJzZXJpYWxBcnJheSBpcyBkZXByZWNhdGVkIC0gdXNlIGpzRHVtcC5wYXJzZSgpIGluc3RlYWQiO30scTpCLHQ6TCx1cmw6TSx0cmlnZ2VyRXZlbnQ6T30pO2god2luZG93KS5sb2FkKGZ1bmN0aW9uKCl7aCgiI3VzZXJBZ2VudCIpLmh0bWwobmF2aWdhdG9yLnVzZXJBZ2VudCk7dmFyIGE9aCgnPGRpdiBjbGFzcz0idGVzdHJ1bm5lci10b29sYmFyIj48bGFiZWwgZm9yPSJmaWx0ZXItcGFzcyI+SGlkZSBwYXNzZWQgdGVzdHM8L2xhYmVsPjwvZGl2PicpLmluc2VydEFmdGVyKCIjdXNlckFnZW50Iik7aCgnPGlucHV0IHR5cGU9ImNoZWNrYm94IiBpZD0iZmlsdGVyLXBhc3MiIC8+JykuYXR0cigiZGlzYWJsZWQiLHRydWUpLnByZXBlbmRUbyhhKS5jbGljayhmdW5jdGlvbigpe2goImxpLnBhc3MiKVt0aGlzLmNoZWNrZWQ/CiJoaWRlIjoic2hvdyJdKCl9KTtoKCc8aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJmaWx0ZXItbWlzc2luZyI+JykuYXR0cigiZGlzYWJsZWQiLHRydWUpLmFwcGVuZFRvKGEpLmNsaWNrKGZ1bmN0aW9uKCl7aCgibGkuZmFpbDpjb250YWlucygnbWlzc2luZyB0ZXN0IC0gdW50ZXN0ZWQgY29kZSBpcyBicm9rZW4gY29kZScpIikucGFyZW50KCJvbCIpLnBhcmVudCgibGkuZmFpbCIpW3RoaXMuY2hlY2tlZD8iaGlkZSI6InNob3ciXSgpfSk7aCgiI2ZpbHRlci1taXNzaW5nIikuYWZ0ZXIoJzxsYWJlbCBmb3I9ImZpbHRlci1taXNzaW5nIj5IaWRlIG1pc3NpbmcgdGVzdHMgKHVudGVzdGVkIGNvZGUgaXMgYnJva2VuIGNvZGUpPC9sYWJlbD4nKTtiKCl9KTt2YXIgc30pKGpRdWVyeSk7CihmdW5jdGlvbigpe2Z1bmN0aW9uIGgoYil7cmV0dXJuJyInK2IudG9TdHJpbmcoKS5yZXBsYWNlKC8iL2csJ1xcIicpKyciJ31mdW5jdGlvbiBwKGIpe3JldHVybiBiKyIifWZ1bmN0aW9uIHEoYixlLG0pe3ZhciByPXYuc2VwYXJhdG9yKCksdD12LmluZGVudCgpO2lubmVyPXYuaW5kZW50KDEpO2lmKGUuam9pbillPWUuam9pbigiLCIrcitpbm5lcik7aWYoIWUpcmV0dXJuIGIrbTtyZXR1cm5bYixpbm5lcitlLHQrbV0uam9pbihyKX1mdW5jdGlvbiB1KGIpe3ZhciBlPWIubGVuZ3RoLG09QXJyYXkoZSk7Zm9yKHRoaXMudXAoKTtlLS07KW1bZV09dGhpcy5wYXJzZShiW2VdKTt0aGlzLmRvd24oKTtyZXR1cm4gcSgiWyIsbSwiXSIpfXZhciB3PS9eZnVuY3Rpb24gKFx3KykvLHY9d2luZG93LmpzRHVtcD17cGFyc2U6ZnVuY3Rpb24oYixlKXt2YXIgbT10aGlzLnBhcnNlcnNbZXx8dGhpcy50eXBlT2YoYildO2U9dHlwZW9mIG07cmV0dXJuIGU9PSJmdW5jdGlvbiI/bS5jYWxsKHRoaXMsCmIpOmU9PSJzdHJpbmciP206dGhpcy5wYXJzZXJzLmVycm9yfSx0eXBlT2Y6ZnVuY3Rpb24oYil7dmFyIGU9dHlwZW9mIGIsbT0iZnVuY3Rpb24iO3JldHVybiBlIT0ib2JqZWN0IiYmZSE9bT9lOiFiPyJudWxsIjpiLmV4ZWM/InJlZ2V4cCI6Yi5nZXRIb3Vycz8iZGF0ZSI6Yi5zY3JvbGxCeT8id2luZG93IjpiLm5vZGVOYW1lPT0iI2RvY3VtZW50Ij8iZG9jdW1lbnQiOmIubm9kZU5hbWU/Im5vZGUiOmIuaXRlbT8ibm9kZWxpc3QiOmIuY2FsbGVlPyJhcmd1bWVudHMiOmIuY2FsbHx8Yi5jb25zdHJ1Y3RvciE9QXJyYXkmJihiKyIiKS5pbmRleE9mKG0pIT0tMT9tOiJsZW5ndGgiaW4gYj8iYXJyYXkiOmV9LHNlcGFyYXRvcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLm11bHRpbGluZT90aGlzLkhUTUw/IjxiciAvPiI6IlxuIjp0aGlzLkhUTUw/IiZuYnNwOyI6IiAifSxpbmRlbnQ6ZnVuY3Rpb24oYil7aWYoIXRoaXMubXVsdGlsaW5lKXJldHVybiIiO3ZhciBlPXRoaXMuaW5kZW50Q2hhcjsKaWYodGhpcy5IVE1MKWU9ZS5yZXBsYWNlKC9cdC9nLCIgICAiKS5yZXBsYWNlKC8gL2csIiZuYnNwOyIpO3JldHVybiBBcnJheSh0aGlzLl9kZXB0aF8rKGJ8fDApKS5qb2luKGUpfSx1cDpmdW5jdGlvbihiKXt0aGlzLl9kZXB0aF8rPWJ8fDF9LGRvd246ZnVuY3Rpb24oYil7dGhpcy5fZGVwdGhfLT1ifHwxfSxzZXRQYXJzZXI6ZnVuY3Rpb24oYixlKXt0aGlzLnBhcnNlcnNbYl09ZX0scXVvdGU6aCxsaXRlcmFsOnAsam9pbjpxLF9kZXB0aF86MSxwYXJzZXJzOnt3aW5kb3c6IltXaW5kb3ddIixkb2N1bWVudDoiW0RvY3VtZW50XSIsZXJyb3I6IltFUlJPUl0iLHVua25vd246IltVbmtub3duXSIsIm51bGwiOiJudWxsIix1bmRlZmluZWQ6InVuZGVmaW5lZCIsImZ1bmN0aW9uIjpmdW5jdGlvbihiKXt2YXIgZT0iZnVuY3Rpb24iLG09Im5hbWUiaW4gYj9iLm5hbWU6KHcuZXhlYyhiKXx8W10pWzFdO2lmKG0pZSs9IiAiK207ZSs9IigiO2U9W2UsdGhpcy5wYXJzZShiLCJmdW5jdGlvbkFyZ3MiKSwKIil7Il0uam9pbigiIik7cmV0dXJuIHEoZSx0aGlzLnBhcnNlKGIsImZ1bmN0aW9uQ29kZSIpLCJ9Iil9LGFycmF5OnUsbm9kZWxpc3Q6dSxhcmd1bWVudHM6dSxvYmplY3Q6ZnVuY3Rpb24oYil7dmFyIGU9W107dGhpcy51cCgpO2Zvcih2YXIgbSBpbiBiKWUucHVzaCh0aGlzLnBhcnNlKG0sImtleSIpKyI6ICIrdGhpcy5wYXJzZShiW21dKSk7dGhpcy5kb3duKCk7cmV0dXJuIHEoInsiLGUsIn0iKX0sbm9kZTpmdW5jdGlvbihiKXt2YXIgZT10aGlzLkhUTUw/IiZsdDsiOiI8IixtPXRoaXMuSFRNTD8iJmd0OyI6Ij4iLHI9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLHQ9ZStyO2Zvcih2YXIgeCBpbiB0aGlzLkRPTUF0dHJzKXt2YXIgeT1iW3RoaXMuRE9NQXR0cnNbeF1dO2lmKHkpdCs9IiAiK3grIj0iK3RoaXMucGFyc2UoeSwiYXR0cmlidXRlIil9cmV0dXJuIHQrbStlKyIvIityK219LGZ1bmN0aW9uQXJnczpmdW5jdGlvbihiKXtiPWIubGVuZ3RoO2lmKCFiKXJldHVybiIiO2Zvcih2YXIgZT0KQXJyYXkoYik7Yi0tOyllW2JdPVN0cmluZy5mcm9tQ2hhckNvZGUoOTcrYik7cmV0dXJuIiAiK2Uuam9pbigiLCAiKSsiICJ9LGtleTpoLGZ1bmN0aW9uQ29kZToiW2NvZGVdIixhdHRyaWJ1dGU6aCxzdHJpbmc6aCxkYXRlOmgscmVnZXhwOnAsbnVtYmVyOnAsImJvb2xlYW4iOnB9LERPTUF0dHJzOntpZDoiaWQiLG5hbWU6Im5hbWUiLCJjbGFzcyI6ImNsYXNzTmFtZSJ9LEhUTUw6ZmFsc2UsaW5kZW50Q2hhcjoiICAgIixtdWx0aWxpbmU6dHJ1ZX19KSgpOwoK",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Fri, 07 Nov 2014 07:35:42 GMT",
                    "Content-Length": "9900",
                    "Date": "Fri, 07 Nov 2014 07:35:43 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}