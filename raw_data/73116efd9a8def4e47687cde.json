{
    "url": "http://localhost:9999/CodeCatalyst/SWFService/dist/service/doc/asdoc.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>window.location.search</b> and written to <b>window.location.replace()</b> via the following statements:<ul><li>localRef += (\"#\" + window.location.search.substring(1));</li><li>window.location.replace(baseRef + \"index.html?\" + localRef);</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/CodeCatalyst/SWFService/dist/service/doc/asdoc.js",
                "path": "/CodeCatalyst/SWFService/dist/service/doc/asdoc.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9Db2RlQ2F0YWx5c3QvU1dGU2VydmljZS9kaXN0L3NlcnZpY2UvZG9jL2FzZG9jLmpzIEhUVFAvMS4xDQpIb3N0OiBsb2NhbGhvc3Q6OTk5OQ0KDQo=",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMTQ5NjgNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkRhdGU6IFNhdCwgMDggTm92IDIwMTQgMTU6MTA6MjAgR01UDQpMYXN0LU1vZGlmaWVkOiBTYXQsIDA4IE5vdiAyMDE0IDE1OjEwOjE5IEdNVA0KDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8NCi8vICBBRE9CRSBTWVNURU1TIElOQ09SUE9SQVRFRA0KLy8gIENvcHlyaWdodCAyMDA2LTIwMDggQWRvYmUgU3lzdGVtcyBJbmNvcnBvcmF0ZWQNCi8vICBBbGwgUmlnaHRzIFJlc2VydmVkLg0KLy8NCi8vICBOT1RJQ0U6IEFkb2JlIHBlcm1pdHMgeW91IHRvIHVzZSwgbW9kaWZ5LCBhbmQgZGlzdHJpYnV0ZSB0aGlzIGZpbGUNCi8vICBpbiBhY2NvcmRhbmNlIHdpdGggdGhlIHRlcm1zIG9mIHRoZSBsaWNlbnNlIGFncmVlbWVudCBhY2NvbXBhbnlpbmcgaXQuDQovLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCnZhciBFQ0xJUFNFX0ZSQU1FX05BTUUgPSAiQ29udGVudFZpZXdGcmFtZSI7DQp2YXIgZWNsaXBzZUJ1aWxkID0gZmFsc2U7DQp2YXIgbGl2ZURvY3NCYXNlVXJsID0gImh0dHA6Ly9saXZlZG9jcy5hZG9iZS5jb20vZmxleC8zIjsNCnZhciBsaXZlRG9jc0Jvb2tOYW1lID0gImxhbmdyZWYiOw0KZnVuY3Rpb24gZmluZE9iamVjdChvYmpJZCkgew0KICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCkNCiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9iaklkKTsNCiAgICBpZiAoZG9jdW1lbnQuYWxsKQ0KICAgICAgICByZXR1cm4gZG9jdW1lbnQuYWxsW29iaklkXTsNCn0NCmZ1bmN0aW9uIGlzRWNsaXBzZSgpIHsNCiAgICByZXR1cm4gZWNsaXBzZUJ1aWxkOw0KLy8gIHJldHVybiAod2luZG93Lm5hbWUgPT0gRUNMSVBTRV9GUkFNRV9OQU1FKSB8fCAocGFyZW50Lm5hbWUgPT0gRUNMSVBTRV9GUkFNRV9OQU1FKSB8fCAocGFyZW50LnBhcmVudC5uYW1lID09IEVDTElQU0VfRlJBTUVfTkFNRSk7DQp9DQpmdW5jdGlvbiBjb25maWdQYWdlKCkgew0KICAgIHNldFJvd0NvbG9yc0luaXRpYWwodHJ1ZSwgIlByb3BlcnR5Iik7DQogICAgc2V0Um93Q29sb3JzSW5pdGlhbCh0cnVlLCAiTWV0aG9kIik7DQogICAgc2V0Um93Q29sb3JzSW5pdGlhbCh0cnVlLCAiUHJvdGVjdGVkTWV0aG9kIik7ICAgDQogICAgc2V0Um93Q29sb3JzSW5pdGlhbCh0cnVlLCAiRXZlbnQiKTsNCiAgICBzZXRSb3dDb2xvcnNJbml0aWFsKHRydWUsICJTdHlsZSIpOw0KICAgIA0KICAgIHNldFJvd0NvbG9yc0luaXRpYWwodHJ1ZSwgIlNraW5QYXJ0Iik7DQogICAgc2V0Um93Q29sb3JzSW5pdGlhbCh0cnVlLCAiU2tpblN0YXRlIik7DQogICAgDQogICAgc2V0Um93Q29sb3JzSW5pdGlhbCh0cnVlLCAiQ29uc3RhbnQiKTsNCiAgICBpZiAoaXNFY2xpcHNlKCkpIHsNCiAgICAgICAgaWYgKHdpbmRvdy5uYW1lICE9ICJjbGFzc0ZyYW1lIikNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGxvY2FsUmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZignPycpICE9IC0xID8gd2luZG93LmxvY2F0aW9uLmhyZWYuc3Vic3RyaW5nKDAsIHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJz8nKSkgOiB3aW5kb3cubG9jYXRpb24uaHJlZjsNCiAgICAgICAgICAgIGxvY2FsUmVmID0gbG9jYWxSZWYuc3Vic3RyaW5nKGxvY2FsUmVmLmluZGV4T2YoImxhbmdyZWYvIikgKyA4KTsNCiAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uc2VhcmNoICE9ICIiKQ0KICAgICAgICAgICAgICAgIGxvY2FsUmVmICs9ICgiIyIgKyB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKSk7DQogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShiYXNlUmVmICsgImluZGV4Lmh0bWw/IiArIGxvY2FsUmVmKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIHNldFN0eWxlKCIuZWNsaXBzZUJvZHkiLCAiZGlzcGxheSIsICJibG9jayIpOw0KLy8gICAgICAgICAgdmFyIGlzSUUgID0gKG5hdmlnYXRvci5hcHBWZXJzaW9uLmluZGV4T2YoIk1TSUUiKSAhPSAtMSkgPyB0cnVlIDogZmFsc2U7DQovLyAgICAgICAgICBpZiAoaXNJRSA9PSBmYWxzZSAmJiB3aW5kb3cubG9jYXRpb24uaGFzaCAhPSAiIikNCiAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaGFzaCAhPSAiIikNCiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaD13aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSk7DQogICAgICAgIH0NCiAgICB9DQogICAgZWxzZSBpZiAod2luZG93ID09IHRvcCkgeyAvLyBubyBmcmFtZXMNCiAgICAgICAgZmluZE9iamVjdCgidGl0bGVUYWJsZSIpLnN0eWxlLmRpc3BsYXkgPSAiIjsNCiAgICB9DQogICAgZWxzZSB7IC8vIGZyYW1lcw0KICAgICAgICBmaW5kT2JqZWN0KCJ0aXRsZVRhYmxlIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICB9DQogICAgc2hvd1RpdGxlKGFzZG9jVGl0bGUpOw0KfQ0KZnVuY3Rpb24gbG9hZEZyYW1lcyhjbGFzc0ZyYW1lVVJMLCBjbGFzc0xpc3RGcmFtZVVSTCkgew0KICAgIHZhciBjbGFzc0xpc3RGcmFtZSA9IGZpbmRPYmplY3QoImNsYXNzTGlzdEZyYW1lIik7DQogICAgaWYoY2xhc3NMaXN0RnJhbWUgIT0gbnVsbCAmJiBjbGFzc0xpc3RGcmFtZUNvbnRlbnQhPScnKQ0KICAgICAgICBjbGFzc0xpc3RGcmFtZS5kb2N1bWVudC5sb2NhdGlvbi5ocmVmPWNsYXNzTGlzdEZyYW1lQ29udGVudDsNCiAgICBpZiAoaXNFY2xpcHNlKCkpIHsNCiAgICAgICAgdmFyIGNvbnRlbnRWaWV3RnJhbWUgPSBmaW5kT2JqZWN0KEVDTElQU0VfRlJBTUVfTkFNRSk7DQogICAgICAgIGlmIChjb250ZW50Vmlld0ZyYW1lICE9IG51bGwgJiYgY2xhc3NGcmFtZVVSTCAhPSAnJykNCiAgICAgICAgICAgIGNvbnRlbnRWaWV3RnJhbWUuZG9jdW1lbnQubG9jYXRpb24uaHJlZj1jbGFzc0ZyYW1lVVJMOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgdmFyIGNsYXNzRnJhbWUgPSBmaW5kT2JqZWN0KCJjbGFzc0ZyYW1lIik7DQogICAgICAgIGlmKGNsYXNzRnJhbWUgIT0gbnVsbCAmJiBjbGFzc0ZyYW1lQ29udGVudCE9JycpDQogICAgICAgICAgICBjbGFzc0ZyYW1lLmRvY3VtZW50LmxvY2F0aW9uLmhyZWY9Y2xhc3NGcmFtZUNvbnRlbnQ7DQogICAgfQ0KfQ0KZnVuY3Rpb24gc2hvd1RpdGxlKHRpdGxlKSB7DQogICAgaWYgKCFpc0VjbGlwc2UoKSkNCiAgICAgICAgdG9wLmRvY3VtZW50LnRpdGxlID0gdGl0bGU7DQp9DQpmdW5jdGlvbiBsb2FkQ2xhc3NMaXN0RnJhbWUoY2xhc3NMaXN0RnJhbWVVUkwpIHsNCiAgICBpZiAocGFyZW50LmZyYW1lc1siY2xhc3NMaXN0RnJhbWUiXSAhPSBudWxsKSB7DQogICAgICAgIHBhcmVudC5mcmFtZXNbImNsYXNzTGlzdEZyYW1lIl0ubG9jYXRpb24gPSBjbGFzc0xpc3RGcmFtZVVSTDsNCiAgICB9DQogICAgZWxzZSBpZiAocGFyZW50LmZyYW1lc1sicGFja2FnZUZyYW1lIl0gIT0gbnVsbCkgew0KICAgICAgICBpZiAocGFyZW50LmZyYW1lc1sicGFja2FnZUZyYW1lIl0uZnJhbWVzWyJjbGFzc0xpc3RGcmFtZSJdICE9IG51bGwpIHsNCiAgICAgICAgICAgIHBhcmVudC5mcmFtZXNbInBhY2thZ2VGcmFtZSJdLmZyYW1lc1siY2xhc3NMaXN0RnJhbWUiXS5sb2NhdGlvbiA9IGNsYXNzTGlzdEZyYW1lVVJMOw0KICAgICAgICB9DQogICAgfQ0KfQ0KZnVuY3Rpb24gZ290b0xpdmVEb2NzKHByaW1hcnlVUkwsIHNlY29uZGFyeVVSTCwgbG9jYWxlKSB7DQogICAgICAgIGlmIChsb2NhbGUgPT0gImVuLXVzIikgew0KICAgICAgICAgICAgIGxvY2FsZSA9ICIiOw0KICAgICAgICB9IA0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgbG9jYWxlID0gIl8iICsgbG9jYWxlLnN1YnN0cmluZygzKTsNCiAgICAgICAgfQ0KICAgIHZhciB1cmwgPSBsaXZlRG9jc0Jhc2VVcmwgKyBsb2NhbGUgKyAiLyIgKyBsaXZlRG9jc0Jvb2tOYW1lICsgIi9pbmRleC5odG1sPyIgKyBwcmltYXJ5VVJMOw0KICAgIGlmIChzZWNvbmRhcnlVUkwgIT0gbnVsbCAmJiBzZWNvbmRhcnlVUkwgIT0gIiIpDQogICAgICAgIHVybCArPSAoIiYiICsgc2Vjb25kYXJ5VVJMKTsNCiAgICB3aW5kb3cub3Blbih1cmwsICJtbV9saXZlZG9jcyIsICJtZW51YmFyPTEsdG9vbGJhcj0xLHN0YXR1cz0xLHNjcm9sbGJhcnM9MSxyZXNpemFibGU9eWVzIik7DQp9DQpmdW5jdGlvbiBmaW5kVGl0bGVUYWJsZU9iamVjdChpZCkNCnsNCiAgICBpZiAoaXNFY2xpcHNlKCkpDQogICAgICAgIHJldHVybiBwYXJlbnQudGl0bGViYXIuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOw0KICAgIGVsc2UgaWYgKHRvcC50aXRsZWJhcikNCiAgICAgICAgcmV0dXJuIHRvcC50aXRsZWJhci5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7DQogICAgZWxzZQ0KICAgICAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOw0KfQ0KZnVuY3Rpb24gdGl0bGVCYXJfc2V0U3ViVGl0bGUodGl0bGUpDQp7DQogICAgaWYgKGlzRWNsaXBzZSgpIHx8IHRvcC50aXRsZWJhcikNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInN1YlRpdGxlIikuY2hpbGROb2Rlcy5pdGVtKDApLmRhdGEgPSB0aXRsZTsNCn0NCmZ1bmN0aW9uIHRpdGxlQmFyX3NldFN1Yk5hdihzaG93Q29uc3RhbnRzLHNob3dQcm9wZXJ0aWVzLHNob3dTdHlsZXMsc2hvd1NraW5QYXJ0LHNob3dTa2luU3RhdGUsc2hvd0VmZmVjdHMsc2hvd0V2ZW50cyxzaG93Q29uc3RydWN0b3Isc2hvd01ldGhvZHMsc2hvd0V4YW1wbGVzLA0KICAgICAgICAgICAgICAgIHNob3dQYWNrYWdlQ29uc3RhbnRzLHNob3dQYWNrYWdlUHJvcGVydGllcyxzaG93UGFja2FnZUZ1bmN0aW9ucyxzaG93SW50ZXJmYWNlcyxzaG93Q2xhc3NlcyxzaG93UGFja2FnZVVzZSkNCnsNCiAgICBpZiAoaXNFY2xpcHNlKCkgfHwgdG9wLnRpdGxlYmFyKQ0KICAgIHsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInByb3BlcnRpZXNMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dQcm9wZXJ0aWVzID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJwcm9wZXJ0aWVzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93UHJvcGVydGllcyAmJiAoc2hvd1BhY2thZ2VQcm9wZXJ0aWVzIHx8IHNob3dDb25zdHJ1Y3RvciB8fCBzaG93TWV0aG9kcyB8fCBzaG93UGFja2FnZUZ1bmN0aW9ucyB8fCBzaG93RXZlbnRzIHx8IHNob3dTdHlsZXMgfHwgc2hvd1NraW5QYXJ0IHx8IHNob3dTa2luU3RhdGUgfHwgc2hvd0VmZmVjdHMgfHwgc2hvd0NvbnN0YW50cyB8fCBzaG93UGFja2FnZUNvbnN0YW50cyB8fCBzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgicGFja2FnZVByb3BlcnRpZXNMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dQYWNrYWdlUHJvcGVydGllcyA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgicGFja2FnZVByb3BlcnRpZXNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dQYWNrYWdlUHJvcGVydGllcyAmJiAoc2hvd0NvbnN0cnVjdG9yIHx8IHNob3dNZXRob2RzIHx8IHNob3dQYWNrYWdlRnVuY3Rpb25zIHx8IHNob3dFdmVudHMgfHwgc2hvd1N0eWxlcyB8fCBzaG93U2tpblBhcnQgfHwgc2hvd1NraW5TdGF0ZSB8fCBzaG93Q29uc3RhbnRzIHx8IHNob3dFZmZlY3RzIHx8IHNob3dQYWNrYWdlQ29uc3RhbnRzIHx8IHNob3dJbnRlcmZhY2VzIHx8IHNob3dDbGFzc2VzIHx8IHNob3dQYWNrYWdlVXNlIHx8IHNob3dFeGFtcGxlcykpID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJjb25zdHJ1Y3RvckxpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd0NvbnN0cnVjdG9yID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJjb25zdHJ1Y3RvckJhciIpLnN0eWxlLmRpc3BsYXkgPSAoc2hvd0NvbnN0cnVjdG9yICYmIChzaG93TWV0aG9kcyB8fCBzaG93UGFja2FnZUZ1bmN0aW9ucyB8fCBzaG93RXZlbnRzIHx8IHNob3dTdHlsZXMgfHwgc2hvd1NraW5QYXJ0IHx8IHNob3dTa2luU3RhdGUgfHwgc2hvd0VmZmVjdHMgfHwgc2hvd0NvbnN0YW50cyB8fCBzaG93UGFja2FnZUNvbnN0YW50cyB8fCBzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgibWV0aG9kc0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd01ldGhvZHMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoIm1ldGhvZHNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dNZXRob2RzICYmIChzaG93UGFja2FnZUZ1bmN0aW9ucyB8fCBzaG93RXZlbnRzIHx8IHNob3dTdHlsZXMgfHwgc2hvd1NraW5QYXJ0IHx8IHNob3dTa2luU3RhdGUgfHwgc2hvd0VmZmVjdHMgfHwgc2hvd0NvbnN0YW50cyB8fCBzaG93UGFja2FnZUNvbnN0YW50cyB8fCBzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgicGFja2FnZUZ1bmN0aW9uc0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd1BhY2thZ2VGdW5jdGlvbnMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInBhY2thZ2VGdW5jdGlvbnNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dQYWNrYWdlRnVuY3Rpb25zICYmIChzaG93RXZlbnRzIHx8IHNob3dTdHlsZXMgfHwgc2hvd1NraW5QYXJ0IHx8IHNob3dTa2luU3RhdGUgfHwgc2hvd0VmZmVjdHMgfHwgc2hvd0NvbnN0YW50cyB8fCBzaG93UGFja2FnZUNvbnN0YW50cyB8fCBzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiZXZlbnRzTGluayIpLnN0eWxlLmRpc3BsYXkgPSBzaG93RXZlbnRzID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJldmVudHNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dFdmVudHMgJiYgKHNob3dTdHlsZXMgfHwgc2hvd1NraW5QYXJ0IHx8IHNob3dTa2luU3RhdGUgfHwgc2hvd0VmZmVjdHMgfHwgc2hvd0NvbnN0YW50cyB8fCBzaG93UGFja2FnZUNvbnN0YW50cyB8fCBzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgic3R5bGVzTGluayIpLnN0eWxlLmRpc3BsYXkgPSBzaG93U3R5bGVzID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJzdHlsZXNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dTdHlsZXMgJiYgKHNob3dTa2luUGFydCB8fCBzaG93U2tpblN0YXRlIHx8IHNob3dFZmZlY3RzIHx8IHNob3dDb25zdGFudHMgfHwgc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgDQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJTa2luUGFydExpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd1NraW5QYXJ0ID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJTa2luUGFydEJhciIpLnN0eWxlLmRpc3BsYXkgPSAoc2hvd1NraW5QYXJ0ICYmIChzaG93U2tpblN0YXRlIHx8IHNob3dFZmZlY3RzIHx8IHNob3dDb25zdGFudHMgfHwgc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgDQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJTa2luU3RhdGVMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dTa2luU3RhdGUgPyAiaW5saW5lIiA6ICJub25lIjsNCglmaW5kVGl0bGVUYWJsZU9iamVjdCgiU2tpblN0YXRlQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93U2tpblN0YXRlICYmIChzaG93RWZmZWN0cyB8fCBzaG93Q29uc3RhbnRzIHx8IHNob3dQYWNrYWdlQ29uc3RhbnRzIHx8IHNob3dJbnRlcmZhY2VzIHx8IHNob3dDbGFzc2VzIHx8IHNob3dQYWNrYWdlVXNlIHx8IHNob3dFeGFtcGxlcykpID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgICAgICAgICAgDQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJlZmZlY3RzTGluayIpLnN0eWxlLmRpc3BsYXkgPSBzaG93RWZmZWN0cyA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiZWZmZWN0c0JhciIpLnN0eWxlLmRpc3BsYXkgPSAoc2hvd0VmZmVjdHMgJiYgKHNob3dDb25zdGFudHMgfHwgc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImNvbnN0YW50c0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd0NvbnN0YW50cyA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiY29uc3RhbnRzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93Q29uc3RhbnRzICYmIChzaG93UGFja2FnZUNvbnN0YW50cyB8fCBzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgicGFja2FnZUNvbnN0YW50c0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd1BhY2thZ2VDb25zdGFudHMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInBhY2thZ2VDb25zdGFudHNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dQYWNrYWdlQ29uc3RhbnRzICYmIChzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiaW50ZXJmYWNlc0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd0ludGVyZmFjZXMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImludGVyZmFjZXNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dJbnRlcmZhY2VzICYmIChzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiY2xhc3Nlc0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd0NsYXNzZXMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImNsYXNzZXNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dDbGFzc2VzICYmIChzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgicGFja2FnZVVzZUxpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd1BhY2thZ2VVc2UgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInBhY2thZ2VVc2VCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dQYWNrYWdlVXNlICYmIHNob3dFeGFtcGxlcykgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImV4YW1wbGVzTGluayIpLnN0eWxlLmRpc3BsYXkgPSBzaG93RXhhbXBsZXMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICB9DQp9DQpmdW5jdGlvbiB0aXRsZUJhcl9nb3RvQ2xhc3NGcmFtZUFuY2hvcihhbmNob3IpDQp7DQogICAgaWYgKGlzRWNsaXBzZSgpKQ0KICAgICAgICBwYXJlbnQuY2xhc3NGcmFtZS5sb2NhdGlvbiA9IHBhcmVudC5jbGFzc0ZyYW1lLmxvY2F0aW9uLnRvU3RyaW5nKCkuc3BsaXQoJyMnKVswXSArICIjIiArIGFuY2hvcjsNCiAgICBlbHNlDQogICAgICAgIHRvcC5jbGFzc0ZyYW1lLmxvY2F0aW9uID0gdG9wLmNsYXNzRnJhbWUubG9jYXRpb24udG9TdHJpbmcoKS5zcGxpdCgnIycpWzBdICsgIiMiICsgYW5jaG9yOw0KfQ0KZnVuY3Rpb24gc2V0TVhNTE9ubHkoKSANCnsNCiAgICBpZiAoZ2V0Q29va2llKCJzaG93TVhNTCIpID09ICJmYWxzZSIpDQogICAgew0KICAgICAgICB0b2dnbGVNWE1MT25seSgpOw0KICAgIH0NCn0NCmZ1bmN0aW9uIHRvZ2dsZU1YTUxPbmx5KCkgDQp7DQogICAgdmFyIG14bWxEaXYgPSBmaW5kT2JqZWN0KCJteG1sU3ludGF4Iik7DQogICAgdmFyIG14bWxTaG93TGluayA9IGZpbmRPYmplY3QoInNob3dNeG1sTGluayIpOw0KICAgIHZhciBteG1sSGlkZUxpbmsgPSBmaW5kT2JqZWN0KCJoaWRlTXhtbExpbmsiKTsNCiAgICBpZiAobXhtbERpdiAmJiBteG1sU2hvd0xpbmsgJiYgbXhtbEhpZGVMaW5rKQ0KICAgIHsNCiAgICAgICAgaWYgKG14bWxEaXYuc3R5bGUuZGlzcGxheSA9PSAibm9uZSIpDQogICAgICAgIHsNCiAgICAgICAgICAgIG14bWxEaXYuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7DQogICAgICAgICAgICBteG1sU2hvd0xpbmsuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgICAgICAgIG14bWxIaWRlTGluay5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7DQogICAgICAgICAgICBzZXRDb29raWUoInNob3dNWE1MIiwidHJ1ZSIsIG5ldyBEYXRlKDMwMDAsMSwxLDEsMSksICIvIiwgZG9jdW1lbnQubG9jYXRpb24uZG9tYWluKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIG14bWxEaXYuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgICAgICAgIG14bWxTaG93TGluay5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7DQogICAgICAgICAgICBteG1sSGlkZUxpbmsuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgICAgICAgIHNldENvb2tpZSgic2hvd01YTUwiLCJmYWxzZSIsIG5ldyBEYXRlKDMwMDAsMSwxLDEsMSksICIvIiwgZG9jdW1lbnQubG9jYXRpb24uZG9tYWluKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCmZ1bmN0aW9uIHNob3dIaWRlSW5oZXJpdGVkKCkNCnsgICANCiAgICBzZXRJbmhlcml0ZWRWaXNpYmxlKGdldENvb2tpZSgic2hvd0luaGVyaXRlZENvbnN0YW50IikgPT0gInRydWUiLCAiQ29uc3RhbnQiKTsNCiAgICBzZXRJbmhlcml0ZWRWaXNpYmxlKGdldENvb2tpZSgic2hvd0luaGVyaXRlZFByb3RlY3RlZENvbnN0YW50IikgPT0gInRydWUiLCAiUHJvdGVjdGVkQ29uc3RhbnQiKTsNCiAgICBzZXRJbmhlcml0ZWRWaXNpYmxlKGdldENvb2tpZSgic2hvd0luaGVyaXRlZFByb3BlcnR5IikgPT0gInRydWUiLCAiUHJvcGVydHkiKTsNCiAgICBzZXRJbmhlcml0ZWRWaXNpYmxlKGdldENvb2tpZSgic2hvd0luaGVyaXRlZFByb3RlY3RlZFByb3BlcnR5IikgPT0gInRydWUiLCAiUHJvdGVjdGVkUHJvcGVydHkiKTsNCiAgICBzZXRJbmhlcml0ZWRWaXNpYmxlKGdldENvb2tpZSgic2hvd0luaGVyaXRlZE1ldGhvZCIpID09ICJ0cnVlIiwgIk1ldGhvZCIpOw0KICAgIHNldEluaGVyaXRlZFZpc2libGUoZ2V0Q29va2llKCJzaG93SW5oZXJpdGVkUHJvdGVjdGVkTWV0aG9kIikgPT0gInRydWUiLCAiUHJvdGVjdGVkTWV0aG9kIik7DQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRFdmVudCIpID09ICJ0cnVlIiwgIkV2ZW50Iik7DQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRTdHlsZSIpID09ICJ0cnVlIiwgIlN0eWxlIik7DQogICAgDQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRTa2luUGFydCIpID09ICJ0cnVlIiwgIlNraW5QYXJ0Iik7DQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRTa2luU3RhdGUiKSA9PSAidHJ1ZSIsICJTa2luU3RhdGUiKTsNCiAgICANCiAgICBzZXRJbmhlcml0ZWRWaXNpYmxlKGdldENvb2tpZSgic2hvd0luaGVyaXRlZEVmZmVjdCIpID09ICJ0cnVlIiwgIkVmZmVjdCIpOw0KfQ0KZnVuY3Rpb24gc2V0SW5oZXJpdGVkVmlzaWJsZShzaG93LCBzZWxlY3RvclRleHQpDQp7DQogICAgaWYgKGRvY3VtZW50LnN0eWxlU2hlZXRzWzBdLmNzc1J1bGVzICE9IHVuZGVmaW5lZCkNCiAgICB7DQogICAgICAgIHZhciBydWxlcyA9IGRvY3VtZW50LnN0eWxlU2hlZXRzWzBdLmNzc1J1bGVzOw0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAocnVsZXNbaV0uc2VsZWN0b3JUZXh0ID09ICIuaGlkZUluaGVyaXRlZCIgKyBzZWxlY3RvclRleHQpDQogICAgICAgICAgICAgICAgcnVsZXNbaV0uc3R5bGUuZGlzcGxheSA9IHNob3cgPyAiIiA6ICJub25lIjsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChydWxlc1tpXS5zZWxlY3RvclRleHQgPT0gIi5zaG93SW5oZXJpdGVkIiArIHNlbGVjdG9yVGV4dCkNCiAgICAgICAgICAgICAgICBydWxlc1tpXS5zdHlsZS5kaXNwbGF5ID0gc2hvdyA/ICJub25lIiA6ICIiOw0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UNCiAgICB7DQogICAgICAgIGRvY3VtZW50LnN0eWxlU2hlZXRzWzBdLmFkZFJ1bGUoIi5oaWRlSW5oZXJpdGVkIiArIHNlbGVjdG9yVGV4dCwgc2hvdyA/ICJkaXNwbGF5OmlubGluZSIgOiAiZGlzcGxheTpub25lIik7DQogICAgICAgIGRvY3VtZW50LnN0eWxlU2hlZXRzWzBdLmFkZFJ1bGUoIi5zaG93SW5oZXJpdGVkIiArIHNlbGVjdG9yVGV4dCwgc2hvdyA/ICJkaXNwbGF5Om5vbmUiIDogImRpc3BsYXk6aW5saW5lIik7DQogICAgfQ0KICAgIHNldENvb2tpZSgic2hvd0luaGVyaXRlZCIgKyBzZWxlY3RvclRleHQsIHNob3cgPyAidHJ1ZSIgOiAiZmFsc2UiLCBuZXcgRGF0ZSgzMDAwLDEsMSwxLDEpLCAiLyIsIGRvY3VtZW50LmxvY2F0aW9uLmRvbWFpbik7DQogICAgc2V0Um93Q29sb3JzKHNob3csIHNlbGVjdG9yVGV4dCk7DQp9DQpmdW5jdGlvbiBzZXRSb3dDb2xvcnMoc2hvdywgc2VsZWN0b3JUZXh0KQ0Kew0KICAgIHZhciByb3dDb2xvciA9ICIjRjJGMkYyIjsNCiAgICB2YXIgdGFibGUgPSBmaW5kT2JqZWN0KCJzdW1tYXJ5VGFibGUiICsgc2VsZWN0b3JUZXh0KTsNCiAgICBpZiAodGFibGUgIT0gbnVsbCkNCiAgICB7DQogICAgICAgIHZhciByb3dOdW0gPSAwOw0KICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRhYmxlLnJvd3MubGVuZ3RoOyBpKyspDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICh0YWJsZS5yb3dzW2ldLmNsYXNzTmFtZS5pbmRleE9mKCJoaWRlSW5oZXJpdGVkIikgPT0gLTEgfHwgc2hvdykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByb3dOdW0rKzsNCiAgICAgICAgICAgICAgICB0YWJsZS5yb3dzW2ldLmJnQ29sb3IgPSAocm93TnVtICUgMiA9PSAwKSA/IHJvd0NvbG9yIDogIiNGRkZGRkYiOw0KICAgICAgICAgICAgfSAgICAgICAgICAgDQogICAgICAgIH0NCiAgICB9DQp9DQpmdW5jdGlvbiBzZXRSb3dDb2xvcnNJbml0aWFsKHNob3csIHNlbGVjdG9yVGV4dCkNCnsNCiAgICB2YXIgcm93Q29sb3IgPSAiI0YyRjJGMiI7DQogICAgdmFyIHRhYmxlID0gZmluZE9iamVjdCgic3VtbWFyeVRhYmxlIiArIHNlbGVjdG9yVGV4dCk7DQogICAgaWYgKHRhYmxlICE9IG51bGwpDQogICAgew0KICAgICAgICB2YXIgcm93TnVtID0gMDsNCiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0YWJsZS5yb3dzLmxlbmd0aDsgaSsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAodGFibGUucm93c1tpXS5jbGFzc05hbWUuaW5kZXhPZigiaGlkZUluaGVyaXRlZCIpID09IC0xICYmIHNob3cpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcm93TnVtKys7DQogICAgICAgICAgICAgICAgdGFibGUucm93c1tpXS5iZ0NvbG9yID0gKHJvd051bSAlIDIgPT0gMCkgPyByb3dDb2xvciA6ICIjRkZGRkZGIjsNCiAgICAgICAgICAgIH0gICAgICAgICAgIA0KICAgICAgICB9DQogICAgfQ0KfQ0KZnVuY3Rpb24gc2V0U3R5bGUoc2VsZWN0b3JUZXh0LCBzdHlsZU5hbWUsIG5ld1ZhbHVlKQ0Kew0KICAgIGlmIChkb2N1bWVudC5zdHlsZVNoZWV0c1swXS5jc3NSdWxlcyAhPSB1bmRlZmluZWQpDQogICAgew0KICAgICAgICB2YXIgcnVsZXMgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1swXS5jc3NSdWxlczsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydWxlcy5sZW5ndGg7IGkrKykNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKHJ1bGVzW2ldLnNlbGVjdG9yVGV4dCA9PSBzZWxlY3RvclRleHQpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcnVsZXNbaV0uc3R5bGVbc3R5bGVOYW1lXSA9IG5ld1ZhbHVlOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UNCiAgICB7DQogICAgICAgIGRvY3VtZW50LnN0eWxlU2hlZXRzWzBdLmFkZFJ1bGUoc2VsZWN0b3JUZXh0LCBzdHlsZU5hbWUgKyAiOiIgKyBuZXdWYWx1ZSk7DQogICAgfQ0KfQ0K",
                "body": "Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vDQovLyAgQURPQkUgU1lTVEVNUyBJTkNPUlBPUkFURUQNCi8vICBDb3B5cmlnaHQgMjAwNi0yMDA4IEFkb2JlIFN5c3RlbXMgSW5jb3Jwb3JhdGVkDQovLyAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4NCi8vDQovLyAgTk9USUNFOiBBZG9iZSBwZXJtaXRzIHlvdSB0byB1c2UsIG1vZGlmeSwgYW5kIGRpc3RyaWJ1dGUgdGhpcyBmaWxlDQovLyAgaW4gYWNjb3JkYW5jZSB3aXRoIHRoZSB0ZXJtcyBvZiB0aGUgbGljZW5zZSBhZ3JlZW1lbnQgYWNjb21wYW55aW5nIGl0Lg0KLy8NCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQp2YXIgRUNMSVBTRV9GUkFNRV9OQU1FID0gIkNvbnRlbnRWaWV3RnJhbWUiOw0KdmFyIGVjbGlwc2VCdWlsZCA9IGZhbHNlOw0KdmFyIGxpdmVEb2NzQmFzZVVybCA9ICJodHRwOi8vbGl2ZWRvY3MuYWRvYmUuY29tL2ZsZXgvMyI7DQp2YXIgbGl2ZURvY3NCb29rTmFtZSA9ICJsYW5ncmVmIjsNCmZ1bmN0aW9uIGZpbmRPYmplY3Qob2JqSWQpIHsNCiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQpDQogICAgICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvYmpJZCk7DQogICAgaWYgKGRvY3VtZW50LmFsbCkNCiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmFsbFtvYmpJZF07DQp9DQpmdW5jdGlvbiBpc0VjbGlwc2UoKSB7DQogICAgcmV0dXJuIGVjbGlwc2VCdWlsZDsNCi8vICByZXR1cm4gKHdpbmRvdy5uYW1lID09IEVDTElQU0VfRlJBTUVfTkFNRSkgfHwgKHBhcmVudC5uYW1lID09IEVDTElQU0VfRlJBTUVfTkFNRSkgfHwgKHBhcmVudC5wYXJlbnQubmFtZSA9PSBFQ0xJUFNFX0ZSQU1FX05BTUUpOw0KfQ0KZnVuY3Rpb24gY29uZmlnUGFnZSgpIHsNCiAgICBzZXRSb3dDb2xvcnNJbml0aWFsKHRydWUsICJQcm9wZXJ0eSIpOw0KICAgIHNldFJvd0NvbG9yc0luaXRpYWwodHJ1ZSwgIk1ldGhvZCIpOw0KICAgIHNldFJvd0NvbG9yc0luaXRpYWwodHJ1ZSwgIlByb3RlY3RlZE1ldGhvZCIpOyAgIA0KICAgIHNldFJvd0NvbG9yc0luaXRpYWwodHJ1ZSwgIkV2ZW50Iik7DQogICAgc2V0Um93Q29sb3JzSW5pdGlhbCh0cnVlLCAiU3R5bGUiKTsNCiAgICANCiAgICBzZXRSb3dDb2xvcnNJbml0aWFsKHRydWUsICJTa2luUGFydCIpOw0KICAgIHNldFJvd0NvbG9yc0luaXRpYWwodHJ1ZSwgIlNraW5TdGF0ZSIpOw0KICAgIA0KICAgIHNldFJvd0NvbG9yc0luaXRpYWwodHJ1ZSwgIkNvbnN0YW50Iik7DQogICAgaWYgKGlzRWNsaXBzZSgpKSB7DQogICAgICAgIGlmICh3aW5kb3cubmFtZSAhPSAiY2xhc3NGcmFtZSIpDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciBsb2NhbFJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJz8nKSAhPSAtMSA/IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnN1YnN0cmluZygwLCB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCc/JykpIDogd2luZG93LmxvY2F0aW9uLmhyZWY7DQogICAgICAgICAgICBsb2NhbFJlZiA9IGxvY2FsUmVmLnN1YnN0cmluZyhsb2NhbFJlZi5pbmRleE9mKCJsYW5ncmVmLyIpICsgOCk7DQogICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnNlYXJjaCAhPSAiIikNCiAgICAgICAgICAgICAgICBsb2NhbFJlZiArPSAoIiMiICsgd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSkpOw0KICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UoYmFzZVJlZiArICJpbmRleC5odG1sPyIgKyBsb2NhbFJlZik7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgZWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBzZXRTdHlsZSgiLmVjbGlwc2VCb2R5IiwgImRpc3BsYXkiLCAiYmxvY2siKTsNCi8vICAgICAgICAgIHZhciBpc0lFICA9IChuYXZpZ2F0b3IuYXBwVmVyc2lvbi5pbmRleE9mKCJNU0lFIikgIT0gLTEpID8gdHJ1ZSA6IGZhbHNlOw0KLy8gICAgICAgICAgaWYgKGlzSUUgPT0gZmFsc2UgJiYgd2luZG93LmxvY2F0aW9uLmhhc2ggIT0gIiIpDQogICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhhc2ggIT0gIiIpDQogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2g9d2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UgaWYgKHdpbmRvdyA9PSB0b3ApIHsgLy8gbm8gZnJhbWVzDQogICAgICAgIGZpbmRPYmplY3QoInRpdGxlVGFibGUiKS5zdHlsZS5kaXNwbGF5ID0gIiI7DQogICAgfQ0KICAgIGVsc2UgeyAvLyBmcmFtZXMNCiAgICAgICAgZmluZE9iamVjdCgidGl0bGVUYWJsZSIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgfQ0KICAgIHNob3dUaXRsZShhc2RvY1RpdGxlKTsNCn0NCmZ1bmN0aW9uIGxvYWRGcmFtZXMoY2xhc3NGcmFtZVVSTCwgY2xhc3NMaXN0RnJhbWVVUkwpIHsNCiAgICB2YXIgY2xhc3NMaXN0RnJhbWUgPSBmaW5kT2JqZWN0KCJjbGFzc0xpc3RGcmFtZSIpOw0KICAgIGlmKGNsYXNzTGlzdEZyYW1lICE9IG51bGwgJiYgY2xhc3NMaXN0RnJhbWVDb250ZW50IT0nJykNCiAgICAgICAgY2xhc3NMaXN0RnJhbWUuZG9jdW1lbnQubG9jYXRpb24uaHJlZj1jbGFzc0xpc3RGcmFtZUNvbnRlbnQ7DQogICAgaWYgKGlzRWNsaXBzZSgpKSB7DQogICAgICAgIHZhciBjb250ZW50Vmlld0ZyYW1lID0gZmluZE9iamVjdChFQ0xJUFNFX0ZSQU1FX05BTUUpOw0KICAgICAgICBpZiAoY29udGVudFZpZXdGcmFtZSAhPSBudWxsICYmIGNsYXNzRnJhbWVVUkwgIT0gJycpDQogICAgICAgICAgICBjb250ZW50Vmlld0ZyYW1lLmRvY3VtZW50LmxvY2F0aW9uLmhyZWY9Y2xhc3NGcmFtZVVSTDsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICAgIHZhciBjbGFzc0ZyYW1lID0gZmluZE9iamVjdCgiY2xhc3NGcmFtZSIpOw0KICAgICAgICBpZihjbGFzc0ZyYW1lICE9IG51bGwgJiYgY2xhc3NGcmFtZUNvbnRlbnQhPScnKQ0KICAgICAgICAgICAgY2xhc3NGcmFtZS5kb2N1bWVudC5sb2NhdGlvbi5ocmVmPWNsYXNzRnJhbWVDb250ZW50Ow0KICAgIH0NCn0NCmZ1bmN0aW9uIHNob3dUaXRsZSh0aXRsZSkgew0KICAgIGlmICghaXNFY2xpcHNlKCkpDQogICAgICAgIHRvcC5kb2N1bWVudC50aXRsZSA9IHRpdGxlOw0KfQ0KZnVuY3Rpb24gbG9hZENsYXNzTGlzdEZyYW1lKGNsYXNzTGlzdEZyYW1lVVJMKSB7DQogICAgaWYgKHBhcmVudC5mcmFtZXNbImNsYXNzTGlzdEZyYW1lIl0gIT0gbnVsbCkgew0KICAgICAgICBwYXJlbnQuZnJhbWVzWyJjbGFzc0xpc3RGcmFtZSJdLmxvY2F0aW9uID0gY2xhc3NMaXN0RnJhbWVVUkw7DQogICAgfQ0KICAgIGVsc2UgaWYgKHBhcmVudC5mcmFtZXNbInBhY2thZ2VGcmFtZSJdICE9IG51bGwpIHsNCiAgICAgICAgaWYgKHBhcmVudC5mcmFtZXNbInBhY2thZ2VGcmFtZSJdLmZyYW1lc1siY2xhc3NMaXN0RnJhbWUiXSAhPSBudWxsKSB7DQogICAgICAgICAgICBwYXJlbnQuZnJhbWVzWyJwYWNrYWdlRnJhbWUiXS5mcmFtZXNbImNsYXNzTGlzdEZyYW1lIl0ubG9jYXRpb24gPSBjbGFzc0xpc3RGcmFtZVVSTDsNCiAgICAgICAgfQ0KICAgIH0NCn0NCmZ1bmN0aW9uIGdvdG9MaXZlRG9jcyhwcmltYXJ5VVJMLCBzZWNvbmRhcnlVUkwsIGxvY2FsZSkgew0KICAgICAgICBpZiAobG9jYWxlID09ICJlbi11cyIpIHsNCiAgICAgICAgICAgICBsb2NhbGUgPSAiIjsNCiAgICAgICAgfSANCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgIGxvY2FsZSA9ICJfIiArIGxvY2FsZS5zdWJzdHJpbmcoMyk7DQogICAgICAgIH0NCiAgICB2YXIgdXJsID0gbGl2ZURvY3NCYXNlVXJsICsgbG9jYWxlICsgIi8iICsgbGl2ZURvY3NCb29rTmFtZSArICIvaW5kZXguaHRtbD8iICsgcHJpbWFyeVVSTDsNCiAgICBpZiAoc2Vjb25kYXJ5VVJMICE9IG51bGwgJiYgc2Vjb25kYXJ5VVJMICE9ICIiKQ0KICAgICAgICB1cmwgKz0gKCImIiArIHNlY29uZGFyeVVSTCk7DQogICAgd2luZG93Lm9wZW4odXJsLCAibW1fbGl2ZWRvY3MiLCAibWVudWJhcj0xLHRvb2xiYXI9MSxzdGF0dXM9MSxzY3JvbGxiYXJzPTEscmVzaXphYmxlPXllcyIpOw0KfQ0KZnVuY3Rpb24gZmluZFRpdGxlVGFibGVPYmplY3QoaWQpDQp7DQogICAgaWYgKGlzRWNsaXBzZSgpKQ0KICAgICAgICByZXR1cm4gcGFyZW50LnRpdGxlYmFyLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCiAgICBlbHNlIGlmICh0b3AudGl0bGViYXIpDQogICAgICAgIHJldHVybiB0b3AudGl0bGViYXIuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOw0KICAgIGVsc2UNCiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCn0NCmZ1bmN0aW9uIHRpdGxlQmFyX3NldFN1YlRpdGxlKHRpdGxlKQ0Kew0KICAgIGlmIChpc0VjbGlwc2UoKSB8fCB0b3AudGl0bGViYXIpDQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJzdWJUaXRsZSIpLmNoaWxkTm9kZXMuaXRlbSgwKS5kYXRhID0gdGl0bGU7DQp9DQpmdW5jdGlvbiB0aXRsZUJhcl9zZXRTdWJOYXYoc2hvd0NvbnN0YW50cyxzaG93UHJvcGVydGllcyxzaG93U3R5bGVzLHNob3dTa2luUGFydCxzaG93U2tpblN0YXRlLHNob3dFZmZlY3RzLHNob3dFdmVudHMsc2hvd0NvbnN0cnVjdG9yLHNob3dNZXRob2RzLHNob3dFeGFtcGxlcywNCiAgICAgICAgICAgICAgICBzaG93UGFja2FnZUNvbnN0YW50cyxzaG93UGFja2FnZVByb3BlcnRpZXMsc2hvd1BhY2thZ2VGdW5jdGlvbnMsc2hvd0ludGVyZmFjZXMsc2hvd0NsYXNzZXMsc2hvd1BhY2thZ2VVc2UpDQp7DQogICAgaWYgKGlzRWNsaXBzZSgpIHx8IHRvcC50aXRsZWJhcikNCiAgICB7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJwcm9wZXJ0aWVzTGluayIpLnN0eWxlLmRpc3BsYXkgPSBzaG93UHJvcGVydGllcyA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgicHJvcGVydGllc0JhciIpLnN0eWxlLmRpc3BsYXkgPSAoc2hvd1Byb3BlcnRpZXMgJiYgKHNob3dQYWNrYWdlUHJvcGVydGllcyB8fCBzaG93Q29uc3RydWN0b3IgfHwgc2hvd01ldGhvZHMgfHwgc2hvd1BhY2thZ2VGdW5jdGlvbnMgfHwgc2hvd0V2ZW50cyB8fCBzaG93U3R5bGVzIHx8IHNob3dTa2luUGFydCB8fCBzaG93U2tpblN0YXRlIHx8IHNob3dFZmZlY3RzIHx8IHNob3dDb25zdGFudHMgfHwgc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInBhY2thZ2VQcm9wZXJ0aWVzTGluayIpLnN0eWxlLmRpc3BsYXkgPSBzaG93UGFja2FnZVByb3BlcnRpZXMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInBhY2thZ2VQcm9wZXJ0aWVzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93UGFja2FnZVByb3BlcnRpZXMgJiYgKHNob3dDb25zdHJ1Y3RvciB8fCBzaG93TWV0aG9kcyB8fCBzaG93UGFja2FnZUZ1bmN0aW9ucyB8fCBzaG93RXZlbnRzIHx8IHNob3dTdHlsZXMgfHwgc2hvd1NraW5QYXJ0IHx8IHNob3dTa2luU3RhdGUgfHwgc2hvd0NvbnN0YW50cyB8fCBzaG93RWZmZWN0cyB8fCBzaG93UGFja2FnZUNvbnN0YW50cyB8fCBzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiY29uc3RydWN0b3JMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dDb25zdHJ1Y3RvciA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiY29uc3RydWN0b3JCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dDb25zdHJ1Y3RvciAmJiAoc2hvd01ldGhvZHMgfHwgc2hvd1BhY2thZ2VGdW5jdGlvbnMgfHwgc2hvd0V2ZW50cyB8fCBzaG93U3R5bGVzIHx8IHNob3dTa2luUGFydCB8fCBzaG93U2tpblN0YXRlIHx8IHNob3dFZmZlY3RzIHx8IHNob3dDb25zdGFudHMgfHwgc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoIm1ldGhvZHNMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dNZXRob2RzID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJtZXRob2RzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93TWV0aG9kcyAmJiAoc2hvd1BhY2thZ2VGdW5jdGlvbnMgfHwgc2hvd0V2ZW50cyB8fCBzaG93U3R5bGVzIHx8IHNob3dTa2luUGFydCB8fCBzaG93U2tpblN0YXRlIHx8IHNob3dFZmZlY3RzIHx8IHNob3dDb25zdGFudHMgfHwgc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInBhY2thZ2VGdW5jdGlvbnNMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dQYWNrYWdlRnVuY3Rpb25zID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJwYWNrYWdlRnVuY3Rpb25zQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93UGFja2FnZUZ1bmN0aW9ucyAmJiAoc2hvd0V2ZW50cyB8fCBzaG93U3R5bGVzIHx8IHNob3dTa2luUGFydCB8fCBzaG93U2tpblN0YXRlIHx8IHNob3dFZmZlY3RzIHx8IHNob3dDb25zdGFudHMgfHwgc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImV2ZW50c0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd0V2ZW50cyA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiZXZlbnRzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93RXZlbnRzICYmIChzaG93U3R5bGVzIHx8IHNob3dTa2luUGFydCB8fCBzaG93U2tpblN0YXRlIHx8IHNob3dFZmZlY3RzIHx8IHNob3dDb25zdGFudHMgfHwgc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInN0eWxlc0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd1N0eWxlcyA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgic3R5bGVzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93U3R5bGVzICYmIChzaG93U2tpblBhcnQgfHwgc2hvd1NraW5TdGF0ZSB8fCBzaG93RWZmZWN0cyB8fCBzaG93Q29uc3RhbnRzIHx8IHNob3dQYWNrYWdlQ29uc3RhbnRzIHx8IHNob3dJbnRlcmZhY2VzIHx8IHNob3dDbGFzc2VzIHx8IHNob3dQYWNrYWdlVXNlIHx8IHNob3dFeGFtcGxlcykpID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIA0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiU2tpblBhcnRMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dTa2luUGFydCA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiU2tpblBhcnRCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dTa2luUGFydCAmJiAoc2hvd1NraW5TdGF0ZSB8fCBzaG93RWZmZWN0cyB8fCBzaG93Q29uc3RhbnRzIHx8IHNob3dQYWNrYWdlQ29uc3RhbnRzIHx8IHNob3dJbnRlcmZhY2VzIHx8IHNob3dDbGFzc2VzIHx8IHNob3dQYWNrYWdlVXNlIHx8IHNob3dFeGFtcGxlcykpID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIA0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiU2tpblN0YXRlTGluayIpLnN0eWxlLmRpc3BsYXkgPSBzaG93U2tpblN0YXRlID8gImlubGluZSIgOiAibm9uZSI7DQoJZmluZFRpdGxlVGFibGVPYmplY3QoIlNraW5TdGF0ZUJhciIpLnN0eWxlLmRpc3BsYXkgPSAoc2hvd1NraW5TdGF0ZSAmJiAoc2hvd0VmZmVjdHMgfHwgc2hvd0NvbnN0YW50cyB8fCBzaG93UGFja2FnZUNvbnN0YW50cyB8fCBzaG93SW50ZXJmYWNlcyB8fCBzaG93Q2xhc3NlcyB8fCBzaG93UGFja2FnZVVzZSB8fCBzaG93RXhhbXBsZXMpKSA/ICJpbmxpbmUiIDogIm5vbmUiOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICBmaW5kVGl0bGVUYWJsZU9iamVjdCgiZWZmZWN0c0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd0VmZmVjdHMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImVmZmVjdHNCYXIiKS5zdHlsZS5kaXNwbGF5ID0gKHNob3dFZmZlY3RzICYmIChzaG93Q29uc3RhbnRzIHx8IHNob3dQYWNrYWdlQ29uc3RhbnRzIHx8IHNob3dJbnRlcmZhY2VzIHx8IHNob3dDbGFzc2VzIHx8IHNob3dQYWNrYWdlVXNlIHx8IHNob3dFeGFtcGxlcykpID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJjb25zdGFudHNMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dDb25zdGFudHMgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImNvbnN0YW50c0JhciIpLnN0eWxlLmRpc3BsYXkgPSAoc2hvd0NvbnN0YW50cyAmJiAoc2hvd1BhY2thZ2VDb25zdGFudHMgfHwgc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInBhY2thZ2VDb25zdGFudHNMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dQYWNrYWdlQ29uc3RhbnRzID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJwYWNrYWdlQ29uc3RhbnRzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93UGFja2FnZUNvbnN0YW50cyAmJiAoc2hvd0ludGVyZmFjZXMgfHwgc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImludGVyZmFjZXNMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dJbnRlcmZhY2VzID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJpbnRlcmZhY2VzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93SW50ZXJmYWNlcyAmJiAoc2hvd0NsYXNzZXMgfHwgc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoImNsYXNzZXNMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dDbGFzc2VzID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJjbGFzc2VzQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93Q2xhc3NlcyAmJiAoc2hvd1BhY2thZ2VVc2UgfHwgc2hvd0V4YW1wbGVzKSkgPyAiaW5saW5lIiA6ICJub25lIjsNCiAgICAgICAgZmluZFRpdGxlVGFibGVPYmplY3QoInBhY2thZ2VVc2VMaW5rIikuc3R5bGUuZGlzcGxheSA9IHNob3dQYWNrYWdlVXNlID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJwYWNrYWdlVXNlQmFyIikuc3R5bGUuZGlzcGxheSA9IChzaG93UGFja2FnZVVzZSAmJiBzaG93RXhhbXBsZXMpID8gImlubGluZSIgOiAibm9uZSI7DQogICAgICAgIGZpbmRUaXRsZVRhYmxlT2JqZWN0KCJleGFtcGxlc0xpbmsiKS5zdHlsZS5kaXNwbGF5ID0gc2hvd0V4YW1wbGVzID8gImlubGluZSIgOiAibm9uZSI7DQogICAgfQ0KfQ0KZnVuY3Rpb24gdGl0bGVCYXJfZ290b0NsYXNzRnJhbWVBbmNob3IoYW5jaG9yKQ0Kew0KICAgIGlmIChpc0VjbGlwc2UoKSkNCiAgICAgICAgcGFyZW50LmNsYXNzRnJhbWUubG9jYXRpb24gPSBwYXJlbnQuY2xhc3NGcmFtZS5sb2NhdGlvbi50b1N0cmluZygpLnNwbGl0KCcjJylbMF0gKyAiIyIgKyBhbmNob3I7DQogICAgZWxzZQ0KICAgICAgICB0b3AuY2xhc3NGcmFtZS5sb2NhdGlvbiA9IHRvcC5jbGFzc0ZyYW1lLmxvY2F0aW9uLnRvU3RyaW5nKCkuc3BsaXQoJyMnKVswXSArICIjIiArIGFuY2hvcjsNCn0NCmZ1bmN0aW9uIHNldE1YTUxPbmx5KCkgDQp7DQogICAgaWYgKGdldENvb2tpZSgic2hvd01YTUwiKSA9PSAiZmFsc2UiKQ0KICAgIHsNCiAgICAgICAgdG9nZ2xlTVhNTE9ubHkoKTsNCiAgICB9DQp9DQpmdW5jdGlvbiB0b2dnbGVNWE1MT25seSgpIA0Kew0KICAgIHZhciBteG1sRGl2ID0gZmluZE9iamVjdCgibXhtbFN5bnRheCIpOw0KICAgIHZhciBteG1sU2hvd0xpbmsgPSBmaW5kT2JqZWN0KCJzaG93TXhtbExpbmsiKTsNCiAgICB2YXIgbXhtbEhpZGVMaW5rID0gZmluZE9iamVjdCgiaGlkZU14bWxMaW5rIik7DQogICAgaWYgKG14bWxEaXYgJiYgbXhtbFNob3dMaW5rICYmIG14bWxIaWRlTGluaykNCiAgICB7DQogICAgICAgIGlmIChteG1sRGl2LnN0eWxlLmRpc3BsYXkgPT0gIm5vbmUiKQ0KICAgICAgICB7DQogICAgICAgICAgICBteG1sRGl2LnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOw0KICAgICAgICAgICAgbXhtbFNob3dMaW5rLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICAgICAgICBteG1sSGlkZUxpbmsuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUiOw0KICAgICAgICAgICAgc2V0Q29va2llKCJzaG93TVhNTCIsInRydWUiLCBuZXcgRGF0ZSgzMDAwLDEsMSwxLDEpLCAiLyIsIGRvY3VtZW50LmxvY2F0aW9uLmRvbWFpbik7DQogICAgICAgIH0NCiAgICAgICAgZWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBteG1sRGl2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICAgICAgICBteG1sU2hvd0xpbmsuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUiOw0KICAgICAgICAgICAgbXhtbEhpZGVMaW5rLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICAgICAgICBzZXRDb29raWUoInNob3dNWE1MIiwiZmFsc2UiLCBuZXcgRGF0ZSgzMDAwLDEsMSwxLDEpLCAiLyIsIGRvY3VtZW50LmxvY2F0aW9uLmRvbWFpbik7DQogICAgICAgIH0NCiAgICB9DQp9DQpmdW5jdGlvbiBzaG93SGlkZUluaGVyaXRlZCgpDQp7ICAgDQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRDb25zdGFudCIpID09ICJ0cnVlIiwgIkNvbnN0YW50Iik7DQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRQcm90ZWN0ZWRDb25zdGFudCIpID09ICJ0cnVlIiwgIlByb3RlY3RlZENvbnN0YW50Iik7DQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRQcm9wZXJ0eSIpID09ICJ0cnVlIiwgIlByb3BlcnR5Iik7DQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRQcm90ZWN0ZWRQcm9wZXJ0eSIpID09ICJ0cnVlIiwgIlByb3RlY3RlZFByb3BlcnR5Iik7DQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRNZXRob2QiKSA9PSAidHJ1ZSIsICJNZXRob2QiKTsNCiAgICBzZXRJbmhlcml0ZWRWaXNpYmxlKGdldENvb2tpZSgic2hvd0luaGVyaXRlZFByb3RlY3RlZE1ldGhvZCIpID09ICJ0cnVlIiwgIlByb3RlY3RlZE1ldGhvZCIpOw0KICAgIHNldEluaGVyaXRlZFZpc2libGUoZ2V0Q29va2llKCJzaG93SW5oZXJpdGVkRXZlbnQiKSA9PSAidHJ1ZSIsICJFdmVudCIpOw0KICAgIHNldEluaGVyaXRlZFZpc2libGUoZ2V0Q29va2llKCJzaG93SW5oZXJpdGVkU3R5bGUiKSA9PSAidHJ1ZSIsICJTdHlsZSIpOw0KICAgIA0KICAgIHNldEluaGVyaXRlZFZpc2libGUoZ2V0Q29va2llKCJzaG93SW5oZXJpdGVkU2tpblBhcnQiKSA9PSAidHJ1ZSIsICJTa2luUGFydCIpOw0KICAgIHNldEluaGVyaXRlZFZpc2libGUoZ2V0Q29va2llKCJzaG93SW5oZXJpdGVkU2tpblN0YXRlIikgPT0gInRydWUiLCAiU2tpblN0YXRlIik7DQogICAgDQogICAgc2V0SW5oZXJpdGVkVmlzaWJsZShnZXRDb29raWUoInNob3dJbmhlcml0ZWRFZmZlY3QiKSA9PSAidHJ1ZSIsICJFZmZlY3QiKTsNCn0NCmZ1bmN0aW9uIHNldEluaGVyaXRlZFZpc2libGUoc2hvdywgc2VsZWN0b3JUZXh0KQ0Kew0KICAgIGlmIChkb2N1bWVudC5zdHlsZVNoZWV0c1swXS5jc3NSdWxlcyAhPSB1bmRlZmluZWQpDQogICAgew0KICAgICAgICB2YXIgcnVsZXMgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1swXS5jc3NSdWxlczsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydWxlcy5sZW5ndGg7IGkrKykNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKHJ1bGVzW2ldLnNlbGVjdG9yVGV4dCA9PSAiLmhpZGVJbmhlcml0ZWQiICsgc2VsZWN0b3JUZXh0KQ0KICAgICAgICAgICAgICAgIHJ1bGVzW2ldLnN0eWxlLmRpc3BsYXkgPSBzaG93ID8gIiIgOiAibm9uZSI7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAocnVsZXNbaV0uc2VsZWN0b3JUZXh0ID09ICIuc2hvd0luaGVyaXRlZCIgKyBzZWxlY3RvclRleHQpDQogICAgICAgICAgICAgICAgcnVsZXNbaV0uc3R5bGUuZGlzcGxheSA9IHNob3cgPyAibm9uZSIgOiAiIjsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBlbHNlDQogICAgew0KICAgICAgICBkb2N1bWVudC5zdHlsZVNoZWV0c1swXS5hZGRSdWxlKCIuaGlkZUluaGVyaXRlZCIgKyBzZWxlY3RvclRleHQsIHNob3cgPyAiZGlzcGxheTppbmxpbmUiIDogImRpc3BsYXk6bm9uZSIpOw0KICAgICAgICBkb2N1bWVudC5zdHlsZVNoZWV0c1swXS5hZGRSdWxlKCIuc2hvd0luaGVyaXRlZCIgKyBzZWxlY3RvclRleHQsIHNob3cgPyAiZGlzcGxheTpub25lIiA6ICJkaXNwbGF5OmlubGluZSIpOw0KICAgIH0NCiAgICBzZXRDb29raWUoInNob3dJbmhlcml0ZWQiICsgc2VsZWN0b3JUZXh0LCBzaG93ID8gInRydWUiIDogImZhbHNlIiwgbmV3IERhdGUoMzAwMCwxLDEsMSwxKSwgIi8iLCBkb2N1bWVudC5sb2NhdGlvbi5kb21haW4pOw0KICAgIHNldFJvd0NvbG9ycyhzaG93LCBzZWxlY3RvclRleHQpOw0KfQ0KZnVuY3Rpb24gc2V0Um93Q29sb3JzKHNob3csIHNlbGVjdG9yVGV4dCkNCnsNCiAgICB2YXIgcm93Q29sb3IgPSAiI0YyRjJGMiI7DQogICAgdmFyIHRhYmxlID0gZmluZE9iamVjdCgic3VtbWFyeVRhYmxlIiArIHNlbGVjdG9yVGV4dCk7DQogICAgaWYgKHRhYmxlICE9IG51bGwpDQogICAgew0KICAgICAgICB2YXIgcm93TnVtID0gMDsNCiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0YWJsZS5yb3dzLmxlbmd0aDsgaSsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAodGFibGUucm93c1tpXS5jbGFzc05hbWUuaW5kZXhPZigiaGlkZUluaGVyaXRlZCIpID09IC0xIHx8IHNob3cpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcm93TnVtKys7DQogICAgICAgICAgICAgICAgdGFibGUucm93c1tpXS5iZ0NvbG9yID0gKHJvd051bSAlIDIgPT0gMCkgPyByb3dDb2xvciA6ICIjRkZGRkZGIjsNCiAgICAgICAgICAgIH0gICAgICAgICAgIA0KICAgICAgICB9DQogICAgfQ0KfQ0KZnVuY3Rpb24gc2V0Um93Q29sb3JzSW5pdGlhbChzaG93LCBzZWxlY3RvclRleHQpDQp7DQogICAgdmFyIHJvd0NvbG9yID0gIiNGMkYyRjIiOw0KICAgIHZhciB0YWJsZSA9IGZpbmRPYmplY3QoInN1bW1hcnlUYWJsZSIgKyBzZWxlY3RvclRleHQpOw0KICAgIGlmICh0YWJsZSAhPSBudWxsKQ0KICAgIHsNCiAgICAgICAgdmFyIHJvd051bSA9IDA7DQogICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGFibGUucm93cy5sZW5ndGg7IGkrKykNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKHRhYmxlLnJvd3NbaV0uY2xhc3NOYW1lLmluZGV4T2YoImhpZGVJbmhlcml0ZWQiKSA9PSAtMSAmJiBzaG93KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJvd051bSsrOw0KICAgICAgICAgICAgICAgIHRhYmxlLnJvd3NbaV0uYmdDb2xvciA9IChyb3dOdW0gJSAyID09IDApID8gcm93Q29sb3IgOiAiI0ZGRkZGRiI7DQogICAgICAgICAgICB9ICAgICAgICAgICANCiAgICAgICAgfQ0KICAgIH0NCn0NCmZ1bmN0aW9uIHNldFN0eWxlKHNlbGVjdG9yVGV4dCwgc3R5bGVOYW1lLCBuZXdWYWx1ZSkNCnsNCiAgICBpZiAoZG9jdW1lbnQuc3R5bGVTaGVldHNbMF0uY3NzUnVsZXMgIT0gdW5kZWZpbmVkKQ0KICAgIHsNCiAgICAgICAgdmFyIHJ1bGVzID0gZG9jdW1lbnQuc3R5bGVTaGVldHNbMF0uY3NzUnVsZXM7DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcnVsZXMubGVuZ3RoOyBpKyspDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChydWxlc1tpXS5zZWxlY3RvclRleHQgPT0gc2VsZWN0b3JUZXh0KQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJ1bGVzW2ldLnN0eWxlW3N0eWxlTmFtZV0gPSBuZXdWYWx1ZTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBlbHNlDQogICAgew0KICAgICAgICBkb2N1bWVudC5zdHlsZVNoZWV0c1swXS5hZGRSdWxlKHNlbGVjdG9yVGV4dCwgc3R5bGVOYW1lICsgIjoiICsgbmV3VmFsdWUpOw0KICAgIH0NCn0NCg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 15:10:19 GMT",
                    "Content-Length": "14968",
                    "Date": "Sat, 08 Nov 2014 15:10:20 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}