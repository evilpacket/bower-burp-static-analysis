{
    "url": "http://localhost:9999/rogeriopradoj/browser-update/update.php",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>window.location.hash</b> and written to <b>the 'source' property of a DOM element</b> via the following statement:<ul><li>i.src= \"/count.ph... ...d=\" + Math.random() </li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/rogeriopradoj/browser-update/update.php",
                "path": "/rogeriopradoj/browser-update/update.php",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9yb2dlcmlvcHJhZG9qL2Jyb3dzZXItdXBkYXRlL3VwZGF0ZS5waHAgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODM0MQ0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD11dGYtOA0KRGF0ZTogU2F0LCAwOCBOb3YgMjAxNCAwMzozNTo0NyBHTVQNCkxhc3QtTW9kaWZpZWQ6IFNhdCwgMDggTm92IDIwMTQgMDM6MzU6NDcgR01UDQoNCjw/cGhwCmlmIChpc3NldCgkX0dFVFsnbGFuZyddKSkgewoJJGxsID0gJF9HRVRbJ2xhbmcnXTsKfQplbHNlIHsKCSRsbGwgPSAkX1NFUlZFUlsnSFRUUF9BQ0NFUFRfTEFOR1VBR0UnXTsKCSRsbGwgPSBleHBsb2RlICgiLCIsICRsbGwpOwoJJGxsbCA9IGV4cGxvZGUgKCI7IiwgJGxsbFswXSk7CgkkbGwgPSB0cmltKHN0cnRvbG93ZXIoc3Vic3RyKCRsbGxbMF0sMCw1KSkpOwoJaWYoc3RybGVuKCRsbCk9PTUpIHsKCQkkbGwgPSBzdWJzdHIoJGxsLCAzLCAyKTsKCX0KfQoKLyoKaWYgKCRsbD09ImRlIiAmJiByYW5kKDEsIDMpPT0zKSB7CiAgICBpbmNsdWRlKCJ1cGRhdGUyLnBocCIpOwogICAgZXhpdDsKfQoqLwoKcmVxdWlyZV9vbmNlKCJsaWIvaW5pdC5waHAiKTsKcmVxdWlyZV9vbmNlKCJsaWIvbGFuZy5waHAiKTsKaW5jbHVkZSgiaGVhZGVyLnBocCIpOwoKJHVhPXN0cnRvbG93ZXIoJF9TRVJWRVJbJ0hUVFBfVVNFUl9BR0VOVCddKTsKZnVuY3Rpb24gaGFzKCR0KSB7CglnbG9iYWwgJHVhOwkKCXJldHVybiAhKHN0cnBvcygkdWEsJHQpPT09ZmFsc2UpOwp9CgovL25vdCBjb21wbGV0ZSBsaXN0IGJ1dCA5OSUgb2Ygc3lzdGVtcyBzaGFyZSB3aGVyZSBpZTkgaXMgbm90IGF2YWlsYWJsZQokbm9faWUgPSBoYXMoIndpbmRvd3MgbnQgNCIpIHx8IGhhcygid2luZG93cyBudCA1IikgfHwgaGFzKCJtYWMgb3MiKSB8fCBoYXMoImxpbnV4Iik7CiRub19zYSA9IGhhcygibGludXgiKTsKCgokdV9zYT1zcHJpbnRmKCJodHRwOi8vd3d3LmFwcGxlLmNvbS8lcy9zYWZhcmkvIiwkbGwpOwokdV9mZj0iaHR0cDovL3d3dy5tb3ppbGxhLmNvbS9maXJlZm94LyI7CiR1X29wPSJodHRwOi8vd3d3Lm9wZXJhLmNvbS9icm93c2VyLyI7CiR1X2NoPXNwcmludGYoImh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9jaHJvbWU/aGw9JXMiLCRsbCk7CiR1X2llPXNwcmludGYoImh0dHA6Ly93aW5kb3dzLm1pY3Jvc29mdC5jb20vJXMvaW50ZXJuZXQtZXhwbG9yZXIvZG93bmxvYWRzL2llIixzdHJfcmVwbGFjZSgiXyIsIi0iLCRkZXRlY3RlZF9sYW5nKSk7Cj8+CgoKCTxkaXYgY2xhc3M9InJpZ2h0Ij4KCQkJPGgyPjw/cGhwIGVjaG8gVF8oJ0ZyZWUgd2ViYnJvd3NlcnMnKTsgPz48L2gyPgoJCQk8cD48P3BocCBlY2hvIFRfKCdUaGVzZSBicm93c2VycyBhcmUgdGhlIG5ld2VzdCB2ZXJzaW9ucyBvZiB0aGUgbW9zdCB1c2VkIGZyZWUgd2ViIGJyb3dzZXJzLicpOyA/PjwvcD4KCQkJPHA+PD9waHAgZWNobyBUXygnSnVzdCBjaG9vc2UgYSBicm93c2VyIHRvIGRvd25sb2FkIGZyb20gdGhlIG9yaWdpbmFsIHZlbmRvclwncyB3ZWJzaXRlOicpOyA/PjwvcD4KCQkJPHVsIGNsYXNzPSJicm93c2VycyI+CgkJCQk8bGkgY2xhc3M9ImZmIj4KCQkJCQk8aDM+PGEgaHJlZj0iPD9waHAgZWNobyAkdV9mZjs/PiIgdGFyZ2V0PSJfYmxhbmsiIG9ubW91c2Vkb3duPSJjb3VudEJyb3dzZXIoJ2YnKSI+RmlyZWZveCAxMzwvYT48L2gzPgoJCQkJCTxkaXY+PD9waHAgZWNobyBUXygnV2lkZWx5LXVzZWQgb3Blbi1zb3VyY2UgYnJvd3NlciwgaGlnaGx5IGV4dGVuZGFibGUgYW5kIGN1c3RvbWl6YWJsZScpOyA/PjwvZGl2PgoJCQkJCTxhIGhyZWY9Ijw/cGhwIGVjaG8gJHVfZmY7Pz4iIHRhcmdldD0iX2JsYW5rIiBvbm1vdXNlZG93bj0iY291bnRCcm93c2VyKCdmJykiPjw/cGhwIGVjaG8gVF8oJ0Rvd25sb2FkJyk7ID8+PC9hPgoJCQkJPC9saT4KCQkJCTxsaSBjbGFzcz0ib3AiPgoJCQkJCTxoMz48YSBocmVmPSI8P3BocCBlY2hvICR1X29wOz8+IiB0YXJnZXQ9Il9ibGFuayIgb25tb3VzZWRvd249ImNvdW50QnJvd3NlcignbycpIj5PcGVyYTwvYT48L2gzPgoJCQkJCTxkaXY+PD9waHAgZWNobyBUXygnQnJvd3NlciB3aXRoIG1hbnkgZmVhdHVyZXMnKTsgPz48L2Rpdj4KCQkJCQk8YSBocmVmPSI8P3BocCBlY2hvICR1X29wOz8+IiB0YXJnZXQ9Il9ibGFuayIgb25tb3VzZWRvd249ImNvdW50QnJvd3NlcignbycpIj48P3BocCBlY2hvIFRfKCdEb3dubG9hZCcpOyA/PjwvYT4KCQkJCTwvbGk+CgkJCQk8bGkgY2xhc3M9ImNoIj4KCQkJCQk8aDM+PGEgaHJlZj0iPD9waHAgZWNobyAkdV9jaDs/PiIgdGFyZ2V0PSJfYmxhbmsiIG9ubW91c2Vkb3duPSJjb3VudEJyb3dzZXIoJ2MnKSI+R29vZ2xlIENocm9tZTwvYT48L2gzPgoJCQkJCTxkaXY+PD9waHAgZWNobyBUXygnR29vZ2xlXCdzIGJyb3dzZXIgd2l0aCBjb21wYWN0IGludGVyZmFjZS4nKTsgPz4gPD9waHAgZWNobyBUXygnQXV0b21hdGljYWxseSBhbHdheXMgdXAgdG8gZGF0ZSEnKTsgPz48L2Rpdj4KCQkJCQk8YSBocmVmPSI8P3BocCBlY2hvICR1X2NoOz8+IiB0YXJnZXQ9Il9ibGFuayIgb25tb3VzZWRvd249ImNvdW50QnJvd3NlcignYycpIj48P3BocCBlY2hvIFRfKCdEb3dubG9hZCcpOyA/PjwvYT4KCQkJCTwvbGk+CgkJCQk8P3BocCBpZiAoJG5vX3NhKSB7Pz4KCQkJCTxsaSBjbGFzcz0ic2Egbm90YXZhaWxhYmxlIj4KCQkJCQk8aDM+U2FmYXJpIDUuMTwvaDM+CgkJCQkJPGRpdj4KCQkJCQk8P3BocCBlY2hvIFRfKCdOb3QgYXZhaWxhYmxlIGZvciB5b3VyIFN5c3RlbS4nKTs/PiAKCQkJCQk8P3BocCBlY2hvIFRfKCdQbGVhc2UgY2hvb3NlIGFub3RoZXIgYnJvd3Nlci4nKTs/PgoJCQkJCTwvZGl2PgoJCQkJPC9saT4KCQkJCTw/cGhwIH0gZWxzZSB7Pz4JCQkJCgkJCQk8bGkgY2xhc3M9InNhIj4KCQkJCQk8aDM+PGEgaHJlZj0iPD9waHAgZWNobyAkdV9zYTs/PiIgdGFyZ2V0PSJfYmxhbmsiIG9ubW91c2Vkb3duPSJjb3VudEJyb3dzZXIoJ3MnKSI+U2FmYXJpPC9hPjwvaDM+CgkJCQkJPGRpdj48P3BocCBlY2hvIFRfKCdBcHBsZVwncyBmYXN0IGJyb3dzZXInKTsgPz48L2Rpdj4KCQkJCQk8YSBocmVmPSI8P3BocCBlY2hvICR1X3NhOz8+IiB0YXJnZXQ9Il9ibGFuayIgb25tb3VzZWRvd249ImNvdW50QnJvd3NlcigncycpIj48P3BocCBlY2hvIFRfKCdEb3dubG9hZCcpOyA/PjwvYT4KCQkJCTwvbGk+CQkJCQoJCQkJPD9waHAgfSBpZiAoJG5vX2llKSB7Pz4KCQkJCTxsaSBjbGFzcz0iaWUgbm90YXZhaWxhYmxlIj4KCQkJCQk8aDM+SW50ZXJuZXQgRXhwbG9yZXIgOTwvaDM+CgkJCQkJPGRpdj4KCQkJCQk8P3BocCBlY2hvIFRfKCdOb3QgYXZhaWxhYmxlIGZvciB5b3VyIFN5c3RlbS4nKTs/PiAKCQkJCQk8P3BocCBlY2hvIFRfKCdPbmx5IGZvciBXaW5kb3dzIFZpc3RhIG9yIDcuJyk7Pz4gCgkJCQkJPD9waHAgZWNobyBUXygnUGxlYXNlIGNob29zZSBhbm90aGVyIGJyb3dzZXIuJyk7ID8+CgkJCQkJPC9kaXY+CgkJCQk8L2xpPgoJCQkJPD9waHAgfSBlbHNlIHs/PgoJCQkJPGxpIGNsYXNzPSJpZSI+CgkJCQkJPGgzPjxhIGhyZWY9Ijw/cGhwIGVjaG8gJHVfaWU7Pz4iIHRhcmdldD0iX2JsYW5rIiBvbm1vdXNlZG93bj0iY291bnRCcm93c2VyKCdpJykiPkludGVybmV0IEV4cGxvcmVyIDk8L2E+PC9oMz4KCQkJCQk8ZGl2Pjw/cGhwIGVjaG8gVF8oJ1dpbmRvd3MgYnVpbHQtaW4gYnJvd3NlcicpOyA/PjwvZGl2PgoJCQkJCTxhIGhyZWY9Ijw/cGhwIGVjaG8gJHVfaWU7Pz4iIHRhcmdldD0iX2JsYW5rIiBvbm1vdXNlZG93bj0iY291bnRCcm93c2VyKCdpJykiPjw/cGhwIGVjaG8gVF8oJ0Rvd25sb2FkJyk7ID8+PC9hPgoJCQkJPC9saT4KCQkJCTw/cGhwIH0/PgoJCQk8L3VsPgoJCQk8cD4KICAgICAgICAgICAgICAgIDw/cGhwIGVjaG8gVF8oJ0FsbCBicm93c2VycyBoYXZlIHRoZSBzYW1lIGJhc2ljIGZlYXR1cmVzIGFuZCBlYXN5IGludGVyZmFjZS4nKTsgPz4KICAgICAgICAgICAgICAgIDwhLS1XZSByZWNvbW1lbmQgYWxsIGJyb3dzZXJzIGJ1dCBJbnRlcm5ldCBFeHBsb3JlciBkdWUgdG8gaXRzIHNtYWxsCiAgICAgICAgICAgICAgICBmZWF0dXJlIHNldCBhbmQgcG9vciB3ZWJzdGFuZGFyZHMgc3VwcG9ydC4tLT4KICAgICAgICAgICAgPC9wPgoJPC9kaXY+Cgk8ZGl2IGNsYXNzPSJsZWZ0Ij4KCgkJPGRpdiBjbGFzcz0ibWVzc2FnZSI+CgkJCTxwPjw/cGhwIGVjaG8gVF8oJ1RoZSBicm93c2VyIHlvdSBhcmUgdXNpbmcgaXMgb3V0IG9mIGRhdGUuIEl0IGhhcyBrbm93biA8Yj5zZWN1cml0eSBmbGF3cyBhbmQgZGlzYWR2YW50YWdlczwvYj4gYW5kIGEgPGI+bGltaXRlZCBmZWF0dXJlIHNldDwvYj4uIFlvdSB3aWxsIG5vdCBzZWUgYWxsIHRoZSBmZWF0dXJlcyBvZiBzb21lIHdlYnNpdGVzLicpOyA/PiA8L3A+CgkJPC9kaXY+CgoJCTxkaXY+CgkJCTxwPjw/cGhwIGVjaG8gVF8oJ1N3aXRjaGluZyB0byBhIG5ld2VyIGJyb3dzZXIgY291bGQgZ2l2ZSB5b3UgYSBsb3Qgb2YgYWR2YW50YWdlczonKTsgPz48L3A+CgkJCTx1bCBjbGFzcz0iYWR2YW50YWdlcyI+CgkJCQk8bGkgY2xhc3M9InNlY3VyaXR5Ij4KCQkJCQk8aDM+PD9waHAgZWNobyBUXygnU2VjdXJpdHknKTsgPz48L2gzPgoJCQkJCTxkaXY+PD9waHAgZWNobyBUXygnTmV3ZXIgYnJvd3NlcnMgcHJvdGVjdCB5b3UgYmV0dGVyIGFnYWluc3Qgc2NhbXMsIHZpcnVzZXMsIHRyb2phbnMsIHBoaXNoaW5nIGFuZCBvdGhlciB0aHJlYXRzLiBUaGV5IGFsc28gZml4IHNlY3VyaXR5IGhvbGVzIGluIHlvdXIgY3VycmVudCBicm93c2VyIScpOyA/PjwvZGl2PgoJCQkJPC9saT4KCQkJCTxsaSBjbGFzcz0ic3BlZWQiPgoJCQkJCTxoMz48P3BocCBlY2hvIFRfKCdTcGVlZCcpOyA/PjwvaDM+CgkJCQkJPGRpdj48P3BocCBlY2hvIFRfKCdFdmVyeSBuZXcgYnJvd3NlciBnZW5lcmF0aW9uIGltcHJvdmVzIHNwZWVkJyk7ID8+PC9kaXY+CgkJCQk8L2xpPgoJCQkJPGxpIGNsYXNzPSJjb21wYXRpYmlsaXR5Ij4KCQkJCQk8aDM+PD9waHAgZWNobyBUXygnQ29tcGF0aWJpbGl0eScpOyA/PjwvaDM+CgkJCQkJPGRpdj48P3BocCBlY2hvIFRfKCdXZWJzaXRlcyB1c2luZyBuZXcgdGVjaG5vbG9neSB3aWxsIGJlIGRpc3BsYXllZCBtb3JlIGNvcnJlY3RseScpOyA/PjwvZGl2PgoJCQkJPC9saT4KCQkJCTxsaSBjbGFzcz0iY29tZm9ydCI+CgkJCQkJPGgzPjw/cGhwIGVjaG8gVF8oJ0NvbWZvcnQgJmFtcDsgYmV0dGVyIGV4cGVyaWVuY2UnKTsgPz48L2gzPgoJCQkJCTxkaXY+PD9waHAgZWNobyBUXygnV2l0aCBuZXcgZmVhdHVyZXMsIGV4dGVuc2lvbnMgYW5kIGJldHRlciBjdXN0b21pc2FiaWxpdHksIHlvdSB3aWxsIGhhdmUgYSBtb3JlIGNvbWZvcnRhYmxlIHdlYi1leHBlcmllbmNlJyk7ID8+PC9kaXY+CgkJCQk8L2xpPgoJCQk8L3VsPgoJCTwvZGl2PgoJCQoJCTxwPjw/cGhwIGVjaG8gVF8oJ1VwZGF0aW5nIGlzIGVhc3ksIHRha2VzIGp1c3QgYSBmZXcgbWludXRlcyBhbmQgaXMgdG90YWxseSBmcmVlLicpOyA/PjwvcD4KCQoJCQoJCQoJCTxkaXY+CgkJCTxoMj48P3BocCBlY2hvIFRfKCdXaHkgdGhpcyB3ZWJzaXRlPycpOyA/PjwvaDI+CgkJCTxwPgoJCQkJPD9waHAgZWNobyBUXygnVGhpcyB3ZWJzaXRlIGlzIGFuIGluaXRpYXRpdmUgYnkgd2ViZGVzaWduZXJzLCB3ZWJtYXN0ZXJzIGFuZCBibG9nZ2VycyB3aG8gd2FudCB0byBicmluZyB0aGUgd2ViIGZ1cnRoZXIgYW5kIGhlbHAgdGhlaXIgdmlzaXRvcnMuJyk7ID8+CgkJCTwvcD4KCQkJPHA+CgkJCQk8P3BocCBlY2hvIFRfKCdPdXRkYXRlZCBicm93c2VycyBhcmUgYSA8Yj5zZWN1cml0eSB0aHJlYXQ8L2I+IGFuZCBhcmUgPGI+YmxvY2tpbmcgdGhlIGFkdmFuY2VtZW50IG9mIHRoZSB3ZWI8L2I+IGJlY2F1c2Ugb2YgdGhlaXIgbGltaXRlZCBmZWF0dXJlcyBhbmQgbWFueSA8Yj5idWdzPC9iPi4nKTsgPz4KCQkJPC9wPgoJCTwvZGl2PgoKCQk8aDI+PD9waHAgZWNobyBUXygnIklcJ20gbm90IGFibGUgdG8gdXBkYXRlIG15IGJyb3dzZXIiJyk7ID8+PC9oMj4KICAgICAgICAgICAgICAgIDxwPjw/cGhwIGVjaG8gVF8oJ0lmIHlvdSBhcmUgb24gYSBjb21wdXRlciwgdGhhdCBpcyBtYWludGFpbmVkIGJ5IGEgYWRtaW4gYW5kIHlvdSBjYW5ub3QgaW5zdGFsbCBhIG5ldyBicm93c2VyLCBhc2sgeW91ciBhZG1pbiBhYm91dCBpdC4nKTsgPz48L3A+CgkJPHA+PD9waHAgZWNobyBUXygnSWYgeW91IGNhblwndCBjaGFuZ2UgeW91ciBicm93c2VyIGJlY2F1c2Ugb2YgY29tcGF0aWJpbGl0eSBpc3N1ZXMsIHRoaW5rIGFib3V0IGluc3RhbGxpbmcgYSBzZWNvbmQgYnJvd3NlciBmb3IgYnJvd3NpbmcgYW5kIGtlZXAgdGhlIG9sZCBvbmUgZm9yIHRoZSBjb21wYXRpYmlsaXR5LicpOyA/PjwvcD4KCTwvZGl2PgoKCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KdmFyIGN2PTE7CnZhciBzZWNvbmQ9ZmFsc2U7CgpmdW5jdGlvbiBjb3VudEJyb3dzZXIodG8pIHsKICAgICAgICB2YXIgZj1nZXRCcm93c2VyKCk7CiAgICAgICAgaWYgKChmLm49PSJmIiAmJiBmLnY+PTMuNikgfHwKICAgICAgICAgICAgKGYubj09Im8iICYmIGYudj49MTAuNSkgfHwKICAgICAgICAgICAgKGYubj09InMiICYmIGYudj49NSkgfHwKICAgICAgICAgICAgKGYubj09ImkiICYmIGYudj49OCkpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB2YXIgcz0iIjsKICAgICAgICBpZiAoc2Vjb25kKQogICAgICAgICAgICBzPSImc2Vjb25kPTEiOwogICAgICAgIHZhciBpPW5ldyBJbWFnZSgpOwogICAgICAgIGkuc3JjPSIvY291bnQucGhwP2N2PSIrY3YrIiZ0dj0iK3dpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cigxLCAzKSsiJnJlZj0iK2VzY2FwZSgoZG9jdW1lbnQucmVmZXJyZXJ8fCIiKS5zdWJzdHJpbmcoMCwzNSkpKyImZnJvbT0iK2YubisiJmZyb212PSIrZi52KyImdG89Iit0byArIHMgKyAiJnJuZD0iK01hdGgucmFuZG9tKCk7CiAgICAgICAgc2Vjb25kPXRydWU7CiAgICAgICAgLy9jb25zb2xlLmxvZyhpLnNyYywgZik7Cn0KZnVuY3Rpb24gZ2V0QnJvd3NlcigpIHsKICAgIHZhciBuLHYsdCx1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7CiAgICB2YXIgbmFtZXM9e2k6J0ludGVybmV0IEV4cGxvcmVyJyxmOidGaXJlZm94JyxvOidPcGVyYScsczonQXBwbGUgU2FmYXJpJyxuOidOZXRzY2FwZSBOYXZpZ2F0b3InLCBjOiJDaHJvbWUiLCB4OiJPdGhlciJ9OwogICAgaWYgKC9NU0lFIChcZCtcLlxkKyk7Ly50ZXN0KHVhKSkJCQkJCW49ImkiOwogICAgZWxzZSBpZiAoL0Fyb3JhLihcZCtcLlxkKykvLnRlc3QodWEpKSAgICAgICAgICAgICAgIG49IngiOwogICAgZWxzZSBpZiAoL0Nocm9tZS4oXGQrXC5cZCspLy50ZXN0KHVhKSkgICAgICAgICAgICAgIG49ImMiOwogICAgZWxzZSBpZiAoL0ZpcmVmb3guKFxkK1wuXGQrKS8udGVzdCh1YSkpCQkJCW49ImYiOwogICAgZWxzZSBpZiAoL1ZlcnNpb24uKFxkKy5cZCspLnswLDEwfVNhZmFyaS8udGVzdCh1YSkpCW49InMiOwogICAgZWxzZSBpZiAoL1NhZmFyaS4oXGQrKS8udGVzdCh1YSkpCQkJCQluPSJzbyI7CiAgICBlbHNlIGlmICgvT3BlcmEuKlZlcnNpb24uKFxkK1wuXGQrKS8udGVzdCh1YSkpCQkJbj0ibyI7CiAgICBlbHNlIGlmICgvT3BlcmEuKFxkK1wuXGQrKS8udGVzdCh1YSkpCQkJCW49Im8iOwogICAgZWxzZSBpZiAoL05ldHNjYXBlLihcZCspLy50ZXN0KHVhKSkJCQkJCW49Im4iOwogICAgZWxzZSByZXR1cm4ge246IngiLHY6MCx0Om5hbWVzW25dfTsKCiAgICB2PW5ldyBOdW1iZXIoUmVnRXhwLiQxKTsKICAgIGlmIChuPT0ic28iKSB7CiAgICAgICAgdj0oKHY8MTAwKSAmJiAxLjApIHx8ICgodjwxMzApICYmIDEuMikgfHwgKCh2PDMyMCkgJiYgMS4zKSB8fCAoKHY8NTIwKSAmJiAyLjApIHx8ICgodjw1MjQpICYmIDMuMCkgfHwgKCh2PDUyNikgJiYgMy4yKSB8fDQuMDsKICAgICAgICBuPSJzIjsKICAgIH0KICAgIGlmIChuPT0iaSIgJiYgdj09NyAmJiB3aW5kb3cuWERvbWFpblJlcXVlc3QpIHsKICAgICAgICB2PTg7CiAgICB9CiAgICByZXR1cm4ge246bix2OnYsdDpuYW1lc1tuXSsiICIrdn0KfQoKCgpmdW5jdGlvbiBjb3VudFZpZXcoKSB7CiAgICAgICAgdmFyIGY9Z2V0QnJvd3NlcigpOwogICAgICAgIGlmICgoZi5uPT0iZiIgJiYgZi52Pj0zLjYpIHx8CiAgICAgICAgICAgIChmLm49PSJvIiAmJiBmLnY+PTEwLjUpIHx8CiAgICAgICAgICAgIChmLm49PSJzIiAmJiBmLnY+PTUpIHx8CiAgICAgICAgICAgIChmLm49PSJpIiAmJiBmLnY+PTgpKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgdmFyIGk9bmV3IEltYWdlKCk7CiAgICAgICAgaS5zcmM9Ii9jb3VudGNob2ljZS5waHA/Y3Y9IitjdisiJnR2PSIrd2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyKDEsIDMpKyImcmVmPSIrZXNjYXBlKChkb2N1bWVudC5yZWZlcnJlcnx8IiIpLnN1YnN0cmluZygwLDM1KSkrIiZmcm9tPSIrZi5uKyImZnJvbXY9IitmLnYrICImcm5kPSIrTWF0aC5yYW5kb20oKTsKfQoKY291bnRWaWV3KCk7Cgo8L3NjcmlwdD4KCgo8P3BocCBpbmNsdWRlKCJmb290ZXIucGhwIik7Pz4=",
                "body": "PD9waHAKaWYgKGlzc2V0KCRfR0VUWydsYW5nJ10pKSB7CgkkbGwgPSAkX0dFVFsnbGFuZyddOwp9CmVsc2UgewoJJGxsbCA9ICRfU0VSVkVSWydIVFRQX0FDQ0VQVF9MQU5HVUFHRSddOwoJJGxsbCA9IGV4cGxvZGUgKCIsIiwgJGxsbCk7CgkkbGxsID0gZXhwbG9kZSAoIjsiLCAkbGxsWzBdKTsKCSRsbCA9IHRyaW0oc3RydG9sb3dlcihzdWJzdHIoJGxsbFswXSwwLDUpKSk7CglpZihzdHJsZW4oJGxsKT09NSkgewoJCSRsbCA9IHN1YnN0cigkbGwsIDMsIDIpOwoJfQp9CgovKgppZiAoJGxsPT0iZGUiICYmIHJhbmQoMSwgMyk9PTMpIHsKICAgIGluY2x1ZGUoInVwZGF0ZTIucGhwIik7CiAgICBleGl0Owp9CiovCgpyZXF1aXJlX29uY2UoImxpYi9pbml0LnBocCIpOwpyZXF1aXJlX29uY2UoImxpYi9sYW5nLnBocCIpOwppbmNsdWRlKCJoZWFkZXIucGhwIik7CgokdWE9c3RydG9sb3dlcigkX1NFUlZFUlsnSFRUUF9VU0VSX0FHRU5UJ10pOwpmdW5jdGlvbiBoYXMoJHQpIHsKCWdsb2JhbCAkdWE7CQoJcmV0dXJuICEoc3RycG9zKCR1YSwkdCk9PT1mYWxzZSk7Cn0KCi8vbm90IGNvbXBsZXRlIGxpc3QgYnV0IDk5JSBvZiBzeXN0ZW1zIHNoYXJlIHdoZXJlIGllOSBpcyBub3QgYXZhaWxhYmxlCiRub19pZSA9IGhhcygid2luZG93cyBudCA0IikgfHwgaGFzKCJ3aW5kb3dzIG50IDUiKSB8fCBoYXMoIm1hYyBvcyIpIHx8IGhhcygibGludXgiKTsKJG5vX3NhID0gaGFzKCJsaW51eCIpOwoKCiR1X3NhPXNwcmludGYoImh0dHA6Ly93d3cuYXBwbGUuY29tLyVzL3NhZmFyaS8iLCRsbCk7CiR1X2ZmPSJodHRwOi8vd3d3Lm1vemlsbGEuY29tL2ZpcmVmb3gvIjsKJHVfb3A9Imh0dHA6Ly93d3cub3BlcmEuY29tL2Jyb3dzZXIvIjsKJHVfY2g9c3ByaW50ZigiaHR0cDovL3d3dy5nb29nbGUuY29tL2Nocm9tZT9obD0lcyIsJGxsKTsKJHVfaWU9c3ByaW50ZigiaHR0cDovL3dpbmRvd3MubWljcm9zb2Z0LmNvbS8lcy9pbnRlcm5ldC1leHBsb3Jlci9kb3dubG9hZHMvaWUiLHN0cl9yZXBsYWNlKCJfIiwiLSIsJGRldGVjdGVkX2xhbmcpKTsKPz4KCgoJPGRpdiBjbGFzcz0icmlnaHQiPgoJCQk8aDI+PD9waHAgZWNobyBUXygnRnJlZSB3ZWJicm93c2VycycpOyA/PjwvaDI+CgkJCTxwPjw/cGhwIGVjaG8gVF8oJ1RoZXNlIGJyb3dzZXJzIGFyZSB0aGUgbmV3ZXN0IHZlcnNpb25zIG9mIHRoZSBtb3N0IHVzZWQgZnJlZSB3ZWIgYnJvd3NlcnMuJyk7ID8+PC9wPgoJCQk8cD48P3BocCBlY2hvIFRfKCdKdXN0IGNob29zZSBhIGJyb3dzZXIgdG8gZG93bmxvYWQgZnJvbSB0aGUgb3JpZ2luYWwgdmVuZG9yXCdzIHdlYnNpdGU6Jyk7ID8+PC9wPgoJCQk8dWwgY2xhc3M9ImJyb3dzZXJzIj4KCQkJCTxsaSBjbGFzcz0iZmYiPgoJCQkJCTxoMz48YSBocmVmPSI8P3BocCBlY2hvICR1X2ZmOz8+IiB0YXJnZXQ9Il9ibGFuayIgb25tb3VzZWRvd249ImNvdW50QnJvd3NlcignZicpIj5GaXJlZm94IDEzPC9hPjwvaDM+CgkJCQkJPGRpdj48P3BocCBlY2hvIFRfKCdXaWRlbHktdXNlZCBvcGVuLXNvdXJjZSBicm93c2VyLCBoaWdobHkgZXh0ZW5kYWJsZSBhbmQgY3VzdG9taXphYmxlJyk7ID8+PC9kaXY+CgkJCQkJPGEgaHJlZj0iPD9waHAgZWNobyAkdV9mZjs/PiIgdGFyZ2V0PSJfYmxhbmsiIG9ubW91c2Vkb3duPSJjb3VudEJyb3dzZXIoJ2YnKSI+PD9waHAgZWNobyBUXygnRG93bmxvYWQnKTsgPz48L2E+CgkJCQk8L2xpPgoJCQkJPGxpIGNsYXNzPSJvcCI+CgkJCQkJPGgzPjxhIGhyZWY9Ijw/cGhwIGVjaG8gJHVfb3A7Pz4iIHRhcmdldD0iX2JsYW5rIiBvbm1vdXNlZG93bj0iY291bnRCcm93c2VyKCdvJykiPk9wZXJhPC9hPjwvaDM+CgkJCQkJPGRpdj48P3BocCBlY2hvIFRfKCdCcm93c2VyIHdpdGggbWFueSBmZWF0dXJlcycpOyA/PjwvZGl2PgoJCQkJCTxhIGhyZWY9Ijw/cGhwIGVjaG8gJHVfb3A7Pz4iIHRhcmdldD0iX2JsYW5rIiBvbm1vdXNlZG93bj0iY291bnRCcm93c2VyKCdvJykiPjw/cGhwIGVjaG8gVF8oJ0Rvd25sb2FkJyk7ID8+PC9hPgoJCQkJPC9saT4KCQkJCTxsaSBjbGFzcz0iY2giPgoJCQkJCTxoMz48YSBocmVmPSI8P3BocCBlY2hvICR1X2NoOz8+IiB0YXJnZXQ9Il9ibGFuayIgb25tb3VzZWRvd249ImNvdW50QnJvd3NlcignYycpIj5Hb29nbGUgQ2hyb21lPC9hPjwvaDM+CgkJCQkJPGRpdj48P3BocCBlY2hvIFRfKCdHb29nbGVcJ3MgYnJvd3NlciB3aXRoIGNvbXBhY3QgaW50ZXJmYWNlLicpOyA/PiA8P3BocCBlY2hvIFRfKCdBdXRvbWF0aWNhbGx5IGFsd2F5cyB1cCB0byBkYXRlIScpOyA/PjwvZGl2PgoJCQkJCTxhIGhyZWY9Ijw/cGhwIGVjaG8gJHVfY2g7Pz4iIHRhcmdldD0iX2JsYW5rIiBvbm1vdXNlZG93bj0iY291bnRCcm93c2VyKCdjJykiPjw/cGhwIGVjaG8gVF8oJ0Rvd25sb2FkJyk7ID8+PC9hPgoJCQkJPC9saT4KCQkJCTw/cGhwIGlmICgkbm9fc2EpIHs/PgoJCQkJPGxpIGNsYXNzPSJzYSBub3RhdmFpbGFibGUiPgoJCQkJCTxoMz5TYWZhcmkgNS4xPC9oMz4KCQkJCQk8ZGl2PgoJCQkJCTw/cGhwIGVjaG8gVF8oJ05vdCBhdmFpbGFibGUgZm9yIHlvdXIgU3lzdGVtLicpOz8+IAoJCQkJCTw/cGhwIGVjaG8gVF8oJ1BsZWFzZSBjaG9vc2UgYW5vdGhlciBicm93c2VyLicpOz8+CgkJCQkJPC9kaXY+CgkJCQk8L2xpPgoJCQkJPD9waHAgfSBlbHNlIHs/PgkJCQkKCQkJCTxsaSBjbGFzcz0ic2EiPgoJCQkJCTxoMz48YSBocmVmPSI8P3BocCBlY2hvICR1X3NhOz8+IiB0YXJnZXQ9Il9ibGFuayIgb25tb3VzZWRvd249ImNvdW50QnJvd3NlcigncycpIj5TYWZhcmk8L2E+PC9oMz4KCQkJCQk8ZGl2Pjw/cGhwIGVjaG8gVF8oJ0FwcGxlXCdzIGZhc3QgYnJvd3NlcicpOyA/PjwvZGl2PgoJCQkJCTxhIGhyZWY9Ijw/cGhwIGVjaG8gJHVfc2E7Pz4iIHRhcmdldD0iX2JsYW5rIiBvbm1vdXNlZG93bj0iY291bnRCcm93c2VyKCdzJykiPjw/cGhwIGVjaG8gVF8oJ0Rvd25sb2FkJyk7ID8+PC9hPgoJCQkJPC9saT4JCQkJCgkJCQk8P3BocCB9IGlmICgkbm9faWUpIHs/PgoJCQkJPGxpIGNsYXNzPSJpZSBub3RhdmFpbGFibGUiPgoJCQkJCTxoMz5JbnRlcm5ldCBFeHBsb3JlciA5PC9oMz4KCQkJCQk8ZGl2PgoJCQkJCTw/cGhwIGVjaG8gVF8oJ05vdCBhdmFpbGFibGUgZm9yIHlvdXIgU3lzdGVtLicpOz8+IAoJCQkJCTw/cGhwIGVjaG8gVF8oJ09ubHkgZm9yIFdpbmRvd3MgVmlzdGEgb3IgNy4nKTs/PiAKCQkJCQk8P3BocCBlY2hvIFRfKCdQbGVhc2UgY2hvb3NlIGFub3RoZXIgYnJvd3Nlci4nKTsgPz4KCQkJCQk8L2Rpdj4KCQkJCTwvbGk+CgkJCQk8P3BocCB9IGVsc2Ugez8+CgkJCQk8bGkgY2xhc3M9ImllIj4KCQkJCQk8aDM+PGEgaHJlZj0iPD9waHAgZWNobyAkdV9pZTs/PiIgdGFyZ2V0PSJfYmxhbmsiIG9ubW91c2Vkb3duPSJjb3VudEJyb3dzZXIoJ2knKSI+SW50ZXJuZXQgRXhwbG9yZXIgOTwvYT48L2gzPgoJCQkJCTxkaXY+PD9waHAgZWNobyBUXygnV2luZG93cyBidWlsdC1pbiBicm93c2VyJyk7ID8+PC9kaXY+CgkJCQkJPGEgaHJlZj0iPD9waHAgZWNobyAkdV9pZTs/PiIgdGFyZ2V0PSJfYmxhbmsiIG9ubW91c2Vkb3duPSJjb3VudEJyb3dzZXIoJ2knKSI+PD9waHAgZWNobyBUXygnRG93bmxvYWQnKTsgPz48L2E+CgkJCQk8L2xpPgoJCQkJPD9waHAgfT8+CgkJCTwvdWw+CgkJCTxwPgogICAgICAgICAgICAgICAgPD9waHAgZWNobyBUXygnQWxsIGJyb3dzZXJzIGhhdmUgdGhlIHNhbWUgYmFzaWMgZmVhdHVyZXMgYW5kIGVhc3kgaW50ZXJmYWNlLicpOyA/PgogICAgICAgICAgICAgICAgPCEtLVdlIHJlY29tbWVuZCBhbGwgYnJvd3NlcnMgYnV0IEludGVybmV0IEV4cGxvcmVyIGR1ZSB0byBpdHMgc21hbGwKICAgICAgICAgICAgICAgIGZlYXR1cmUgc2V0IGFuZCBwb29yIHdlYnN0YW5kYXJkcyBzdXBwb3J0Li0tPgogICAgICAgICAgICA8L3A+Cgk8L2Rpdj4KCTxkaXYgY2xhc3M9ImxlZnQiPgoKCQk8ZGl2IGNsYXNzPSJtZXNzYWdlIj4KCQkJPHA+PD9waHAgZWNobyBUXygnVGhlIGJyb3dzZXIgeW91IGFyZSB1c2luZyBpcyBvdXQgb2YgZGF0ZS4gSXQgaGFzIGtub3duIDxiPnNlY3VyaXR5IGZsYXdzIGFuZCBkaXNhZHZhbnRhZ2VzPC9iPiBhbmQgYSA8Yj5saW1pdGVkIGZlYXR1cmUgc2V0PC9iPi4gWW91IHdpbGwgbm90IHNlZSBhbGwgdGhlIGZlYXR1cmVzIG9mIHNvbWUgd2Vic2l0ZXMuJyk7ID8+IDwvcD4KCQk8L2Rpdj4KCgkJPGRpdj4KCQkJPHA+PD9waHAgZWNobyBUXygnU3dpdGNoaW5nIHRvIGEgbmV3ZXIgYnJvd3NlciBjb3VsZCBnaXZlIHlvdSBhIGxvdCBvZiBhZHZhbnRhZ2VzOicpOyA/PjwvcD4KCQkJPHVsIGNsYXNzPSJhZHZhbnRhZ2VzIj4KCQkJCTxsaSBjbGFzcz0ic2VjdXJpdHkiPgoJCQkJCTxoMz48P3BocCBlY2hvIFRfKCdTZWN1cml0eScpOyA/PjwvaDM+CgkJCQkJPGRpdj48P3BocCBlY2hvIFRfKCdOZXdlciBicm93c2VycyBwcm90ZWN0IHlvdSBiZXR0ZXIgYWdhaW5zdCBzY2FtcywgdmlydXNlcywgdHJvamFucywgcGhpc2hpbmcgYW5kIG90aGVyIHRocmVhdHMuIFRoZXkgYWxzbyBmaXggc2VjdXJpdHkgaG9sZXMgaW4geW91ciBjdXJyZW50IGJyb3dzZXIhJyk7ID8+PC9kaXY+CgkJCQk8L2xpPgoJCQkJPGxpIGNsYXNzPSJzcGVlZCI+CgkJCQkJPGgzPjw/cGhwIGVjaG8gVF8oJ1NwZWVkJyk7ID8+PC9oMz4KCQkJCQk8ZGl2Pjw/cGhwIGVjaG8gVF8oJ0V2ZXJ5IG5ldyBicm93c2VyIGdlbmVyYXRpb24gaW1wcm92ZXMgc3BlZWQnKTsgPz48L2Rpdj4KCQkJCTwvbGk+CgkJCQk8bGkgY2xhc3M9ImNvbXBhdGliaWxpdHkiPgoJCQkJCTxoMz48P3BocCBlY2hvIFRfKCdDb21wYXRpYmlsaXR5Jyk7ID8+PC9oMz4KCQkJCQk8ZGl2Pjw/cGhwIGVjaG8gVF8oJ1dlYnNpdGVzIHVzaW5nIG5ldyB0ZWNobm9sb2d5IHdpbGwgYmUgZGlzcGxheWVkIG1vcmUgY29ycmVjdGx5Jyk7ID8+PC9kaXY+CgkJCQk8L2xpPgoJCQkJPGxpIGNsYXNzPSJjb21mb3J0Ij4KCQkJCQk8aDM+PD9waHAgZWNobyBUXygnQ29tZm9ydCAmYW1wOyBiZXR0ZXIgZXhwZXJpZW5jZScpOyA/PjwvaDM+CgkJCQkJPGRpdj48P3BocCBlY2hvIFRfKCdXaXRoIG5ldyBmZWF0dXJlcywgZXh0ZW5zaW9ucyBhbmQgYmV0dGVyIGN1c3RvbWlzYWJpbGl0eSwgeW91IHdpbGwgaGF2ZSBhIG1vcmUgY29tZm9ydGFibGUgd2ViLWV4cGVyaWVuY2UnKTsgPz48L2Rpdj4KCQkJCTwvbGk+CgkJCTwvdWw+CgkJPC9kaXY+CgkJCgkJPHA+PD9waHAgZWNobyBUXygnVXBkYXRpbmcgaXMgZWFzeSwgdGFrZXMganVzdCBhIGZldyBtaW51dGVzIGFuZCBpcyB0b3RhbGx5IGZyZWUuJyk7ID8+PC9wPgoJCgkJCgkJCgkJPGRpdj4KCQkJPGgyPjw/cGhwIGVjaG8gVF8oJ1doeSB0aGlzIHdlYnNpdGU/Jyk7ID8+PC9oMj4KCQkJPHA+CgkJCQk8P3BocCBlY2hvIFRfKCdUaGlzIHdlYnNpdGUgaXMgYW4gaW5pdGlhdGl2ZSBieSB3ZWJkZXNpZ25lcnMsIHdlYm1hc3RlcnMgYW5kIGJsb2dnZXJzIHdobyB3YW50IHRvIGJyaW5nIHRoZSB3ZWIgZnVydGhlciBhbmQgaGVscCB0aGVpciB2aXNpdG9ycy4nKTsgPz4KCQkJPC9wPgoJCQk8cD4KCQkJCTw/cGhwIGVjaG8gVF8oJ091dGRhdGVkIGJyb3dzZXJzIGFyZSBhIDxiPnNlY3VyaXR5IHRocmVhdDwvYj4gYW5kIGFyZSA8Yj5ibG9ja2luZyB0aGUgYWR2YW5jZW1lbnQgb2YgdGhlIHdlYjwvYj4gYmVjYXVzZSBvZiB0aGVpciBsaW1pdGVkIGZlYXR1cmVzIGFuZCBtYW55IDxiPmJ1Z3M8L2I+LicpOyA/PgoJCQk8L3A+CgkJPC9kaXY+CgoJCTxoMj48P3BocCBlY2hvIFRfKCciSVwnbSBub3QgYWJsZSB0byB1cGRhdGUgbXkgYnJvd3NlciInKTsgPz48L2gyPgogICAgICAgICAgICAgICAgPHA+PD9waHAgZWNobyBUXygnSWYgeW91IGFyZSBvbiBhIGNvbXB1dGVyLCB0aGF0IGlzIG1haW50YWluZWQgYnkgYSBhZG1pbiBhbmQgeW91IGNhbm5vdCBpbnN0YWxsIGEgbmV3IGJyb3dzZXIsIGFzayB5b3VyIGFkbWluIGFib3V0IGl0LicpOyA/PjwvcD4KCQk8cD48P3BocCBlY2hvIFRfKCdJZiB5b3UgY2FuXCd0IGNoYW5nZSB5b3VyIGJyb3dzZXIgYmVjYXVzZSBvZiBjb21wYXRpYmlsaXR5IGlzc3VlcywgdGhpbmsgYWJvdXQgaW5zdGFsbGluZyBhIHNlY29uZCBicm93c2VyIGZvciBicm93c2luZyBhbmQga2VlcCB0aGUgb2xkIG9uZSBmb3IgdGhlIGNvbXBhdGliaWxpdHkuJyk7ID8+PC9wPgoJPC9kaXY+CgoKPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgp2YXIgY3Y9MTsKdmFyIHNlY29uZD1mYWxzZTsKCmZ1bmN0aW9uIGNvdW50QnJvd3Nlcih0bykgewogICAgICAgIHZhciBmPWdldEJyb3dzZXIoKTsKICAgICAgICBpZiAoKGYubj09ImYiICYmIGYudj49My42KSB8fAogICAgICAgICAgICAoZi5uPT0ibyIgJiYgZi52Pj0xMC41KSB8fAogICAgICAgICAgICAoZi5uPT0icyIgJiYgZi52Pj01KSB8fAogICAgICAgICAgICAoZi5uPT0iaSIgJiYgZi52Pj04KSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIHZhciBzPSIiOwogICAgICAgIGlmIChzZWNvbmQpCiAgICAgICAgICAgIHM9IiZzZWNvbmQ9MSI7CiAgICAgICAgdmFyIGk9bmV3IEltYWdlKCk7CiAgICAgICAgaS5zcmM9Ii9jb3VudC5waHA/Y3Y9IitjdisiJnR2PSIrd2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyKDEsIDMpKyImcmVmPSIrZXNjYXBlKChkb2N1bWVudC5yZWZlcnJlcnx8IiIpLnN1YnN0cmluZygwLDM1KSkrIiZmcm9tPSIrZi5uKyImZnJvbXY9IitmLnYrIiZ0bz0iK3RvICsgcyArICImcm5kPSIrTWF0aC5yYW5kb20oKTsKICAgICAgICBzZWNvbmQ9dHJ1ZTsKICAgICAgICAvL2NvbnNvbGUubG9nKGkuc3JjLCBmKTsKfQpmdW5jdGlvbiBnZXRCcm93c2VyKCkgewogICAgdmFyIG4sdix0LHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudDsKICAgIHZhciBuYW1lcz17aTonSW50ZXJuZXQgRXhwbG9yZXInLGY6J0ZpcmVmb3gnLG86J09wZXJhJyxzOidBcHBsZSBTYWZhcmknLG46J05ldHNjYXBlIE5hdmlnYXRvcicsIGM6IkNocm9tZSIsIHg6Ik90aGVyIn07CiAgICBpZiAoL01TSUUgKFxkK1wuXGQrKTsvLnRlc3QodWEpKQkJCQkJbj0iaSI7CiAgICBlbHNlIGlmICgvQXJvcmEuKFxkK1wuXGQrKS8udGVzdCh1YSkpICAgICAgICAgICAgICAgbj0ieCI7CiAgICBlbHNlIGlmICgvQ2hyb21lLihcZCtcLlxkKykvLnRlc3QodWEpKSAgICAgICAgICAgICAgbj0iYyI7CiAgICBlbHNlIGlmICgvRmlyZWZveC4oXGQrXC5cZCspLy50ZXN0KHVhKSkJCQkJbj0iZiI7CiAgICBlbHNlIGlmICgvVmVyc2lvbi4oXGQrLlxkKykuezAsMTB9U2FmYXJpLy50ZXN0KHVhKSkJbj0icyI7CiAgICBlbHNlIGlmICgvU2FmYXJpLihcZCspLy50ZXN0KHVhKSkJCQkJCW49InNvIjsKICAgIGVsc2UgaWYgKC9PcGVyYS4qVmVyc2lvbi4oXGQrXC5cZCspLy50ZXN0KHVhKSkJCQluPSJvIjsKICAgIGVsc2UgaWYgKC9PcGVyYS4oXGQrXC5cZCspLy50ZXN0KHVhKSkJCQkJbj0ibyI7CiAgICBlbHNlIGlmICgvTmV0c2NhcGUuKFxkKykvLnRlc3QodWEpKQkJCQkJbj0ibiI7CiAgICBlbHNlIHJldHVybiB7bjoieCIsdjowLHQ6bmFtZXNbbl19OwoKICAgIHY9bmV3IE51bWJlcihSZWdFeHAuJDEpOwogICAgaWYgKG49PSJzbyIpIHsKICAgICAgICB2PSgodjwxMDApICYmIDEuMCkgfHwgKCh2PDEzMCkgJiYgMS4yKSB8fCAoKHY8MzIwKSAmJiAxLjMpIHx8ICgodjw1MjApICYmIDIuMCkgfHwgKCh2PDUyNCkgJiYgMy4wKSB8fCAoKHY8NTI2KSAmJiAzLjIpIHx8NC4wOwogICAgICAgIG49InMiOwogICAgfQogICAgaWYgKG49PSJpIiAmJiB2PT03ICYmIHdpbmRvdy5YRG9tYWluUmVxdWVzdCkgewogICAgICAgIHY9ODsKICAgIH0KICAgIHJldHVybiB7bjpuLHY6dix0Om5hbWVzW25dKyIgIit2fQp9CgoKCmZ1bmN0aW9uIGNvdW50VmlldygpIHsKICAgICAgICB2YXIgZj1nZXRCcm93c2VyKCk7CiAgICAgICAgaWYgKChmLm49PSJmIiAmJiBmLnY+PTMuNikgfHwKICAgICAgICAgICAgKGYubj09Im8iICYmIGYudj49MTAuNSkgfHwKICAgICAgICAgICAgKGYubj09InMiICYmIGYudj49NSkgfHwKICAgICAgICAgICAgKGYubj09ImkiICYmIGYudj49OCkpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB2YXIgaT1uZXcgSW1hZ2UoKTsKICAgICAgICBpLnNyYz0iL2NvdW50Y2hvaWNlLnBocD9jdj0iK2N2KyImdHY9Iit3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHIoMSwgMykrIiZyZWY9Iitlc2NhcGUoKGRvY3VtZW50LnJlZmVycmVyfHwiIikuc3Vic3RyaW5nKDAsMzUpKSsiJmZyb209IitmLm4rIiZmcm9tdj0iK2YudisgIiZybmQ9IitNYXRoLnJhbmRvbSgpOwp9Cgpjb3VudFZpZXcoKTsKCjwvc2NyaXB0PgoKCjw/cGhwIGluY2x1ZGUoImZvb3Rlci5waHAiKTs/Pg==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Sat, 08 Nov 2014 03:35:47 GMT",
                    "Content-Length": "8341",
                    "Date": "Sat, 08 Nov 2014 03:35:47 GMT",
                    "Content-Type": "text/plain; charset=utf-8"
                },
                "cookies": [],
                "mimeType": "text",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}