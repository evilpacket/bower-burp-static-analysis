{
    "url": "http://localhost:9999/WiserTogether/chiropractor/lib/Backbone.CrossDomain.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Link manipulation (DOM-based)",
    "issueType": 5246976,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based link manipulation vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will modify the target of links within the response. An attacker may be able to leverage this to perform various attacks, including:<ul><li>Causing the user to redirect to an arbitrary external URL, to facilitate a phishing attack.</li><li>Causing the user to submit sensitive form data to a server controlled by the attacker.</li><li>Causing the user to perform an unintended action within the application, by changing the file or query string associated with a link.</li><li>Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits, since browser anti-XSS defenses typically do not operate on on-site links.</li></ul>",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based link manipulation vulnerabilities is not to dynamically set the target URLs of links or forms using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a link target. In general, this is best achieved by using a whitelist of URLs that are permitted link targets, and strictly validating the target against this list before setting the link target.",
    "issueDetail": "The application may be vulnerable to DOM-based link manipulation. Data is read from <b>document.URL</b> and written to <b>the 'href' property of a DOM element</b> via the following statement:<ul><li>thisDomainParser.href = document.URL;</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/WiserTogether/chiropractor/lib/Backbone.CrossDomain.js",
                "path": "/WiserTogether/chiropractor/lib/Backbone.CrossDomain.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9XaXNlclRvZ2V0aGVyL2NoaXJvcHJhY3Rvci9saWIvQmFja2JvbmUuQ3Jvc3NEb21haW4uanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogODE5NA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KRGF0ZTogVGh1LCAwNiBOb3YgMjAxNCAxNTowNzozNyBHTVQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMDYgTm92IDIwMTQgMTU6MDc6MzUgR01UDQoNCi8vIEJhY2tib25lLkNyb3NzRG9tYWluTW9kZWwgMC4xLjAKLy8KLy8gKGMpIDIwMTMgVmljdG9yIFF1aW5uCi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4KCihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkgewogICBpZiAodHlwZW9mIGRlZmluZSA9PT0gImZ1bmN0aW9uIiAmJiBkZWZpbmUuYW1kKSB7CiAgICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS4KICAgICAgZGVmaW5lKFsidW5kZXJzY29yZSIsImJhY2tib25lIl0sIGZ1bmN0aW9uKF8sIEJhY2tib25lKSB7CiAgICAgICAgLy8gVXNlIGdsb2JhbCB2YXJpYWJsZXMgaWYgdGhlIGxvY2FscyBhcmUgdW5kZWZpbmVkLgogICAgICAgIHJldHVybiBmYWN0b3J5KF8gfHwgcm9vdC5fLCBCYWNrYm9uZSB8fCByb290LkJhY2tib25lKTsKICAgICAgfSk7CiAgIH0gZWxzZSB7CiAgICAgIC8vIFJlcXVpcmVKUyBpc24ndCBiZWluZyB1c2VkLiBBc3N1bWUgdW5kZXJzY29yZSBhbmQgYmFja2JvbmUgYXJlIGxvYWRlZCBpbiA8c2NyaXB0PiB0YWdzCiAgICAgIGZhY3RvcnkoXywgQmFja2JvbmUpOwogICB9Cn0odGhpcywgZnVuY3Rpb24oXywgQmFja2JvbmUpIHsKCiAgICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHRoZSByZXF1ZXN0IHVybCBnaXZlbiBtb2RlbCBhbmQgb3B0aW9ucyBvYmplY3RzCiAgICBmdW5jdGlvbiByZXF1ZXN0VXJsKG1vZGVsLCBvcHRpb25zKSB7CiAgICAgICAgdmFyIHJlcXVlc3RVcmwgPSBudWxsOwogICAgICAgIC8vIEZpcnN0IHRyeSB0aGUgb3B0aW9ucyBvYmplY3QKICAgICAgICB0cnkgewogICAgICAgICAgICByZXF1ZXN0VXJsID0gb3B0aW9ucy51cmw7CiAgICAgICAgfSBjYXRjaCh4KSB7fQoKICAgICAgICAvLyBUaGVuIHRyeSB0aGUgbW9kZWwncyB1cmwKICAgICAgICBpZiAoIXJlcXVlc3RVcmwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJlcXVlc3RVcmwgPSBfLnJlc3VsdChtb2RlbCwgJ3VybCcpOwogICAgICAgICAgICB9IGNhdGNoKHgpIHt9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVxdWVzdFVybDsKICAgIH0KCiAgICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHdoZXRoZXIgcHJvdG9jb2xzIGRpZmZlci4KICAgIGZ1bmN0aW9uIHByb3RvY29sc0RpZmZlcih0aGlzUHJvdG9jb2wsIHJlcXVlc3RQcm90b2NvbCkgewogICAgICAgIGlmICh0aGlzUHJvdG9jb2wgPT09ICc6JyB8fCByZXF1ZXN0UHJvdG9jb2wgPT09ICI6IikgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBlbHNlIGlmICh0aGlzUHJvdG9jb2wgPT09IHJlcXVlc3RQcm90b2NvbCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvLyBNYXAgZnJvbSBDUlVEIHRvIEhUVFAgZm9yIG91ciBkZWZhdWx0IGBCYWNrYm9uZS5zeW5jYCBpbXBsZW1lbnRhdGlvbi4KCiAgICB2YXIgbWV0aG9kTWFwID0gewogICAgICAgICdjcmVhdGUnOiAnUE9TVCcsCiAgICAgICAgJ3VwZGF0ZSc6ICdQVVQnLAogICAgICAgICdwYXRjaCc6ICAnUEFUQ0gnLAogICAgICAgICdkZWxldGUnOiAnREVMRVRFJywKICAgICAgICAncmVhZCc6ICAgJ0dFVCcKICAgIH07CgogICAgQmFja2JvbmUudmFuaWxsYVN5bmMgPSBCYWNrYm9uZS5zeW5jOwoKICAgIC8vIE92ZXJyaWRlICdCYWNrYm9uZS5zeW5jJyB0byBkZWZhdWx0IHRvIENyb3NzRG9tYWluTW9kZWwgc3luYy4KICAgIC8vIHRoZSBvcmlnaW5hbCAnQmFja2JvbmUuc3luYycgaXMgc3RpbGwgYXZhaWxhYmxlIGluICdCYWNrYm9uZS52YW5pbGxhU3luYycKICAgIEJhY2tib25lLnN5bmMgPSBmdW5jdGlvbihtZXRob2QsIG1vZGVsLCBvcHRpb25zKSB7CgogICAgICAgIC8vIFNlZSBpZiB3ZSBuZWVkIHRvIHVzZSB0aGUgWERvbWFpblJlcXVlc3Qgb2JqZWN0IGZvciBJRS4gSWYgdGhlIHJlcXVlc3QgaXMgb24gdGhlCiAgICAgICAgLy8gc2FtZSBkb21haW4sIHdlIGNhbiBmYWxsIGJhY2sgb24gdGhlIG5vcm1hbCBCYWNrYm9uZS5hamF4IGhhbmRsaW5nLgogICAgICAgIHZhciB1c2VYRG9tYWluUmVxdWVzdCA9IGZhbHNlOwoKICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vamxvbmcvMjQyODU2MQogICAgICAgIHZhciB0aGlzRG9tYWluUGFyc2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIHRoaXNEb21haW5QYXJzZXIuaHJlZiA9IGRvY3VtZW50LlVSTDsKCiAgICAgICAgdmFyIHJlcXVlc3REb21haW5QYXJzZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgcmVxdWVzdERvbWFpblBhcnNlci5ocmVmID0gcmVxdWVzdFVybChtb2RlbCwgb3B0aW9ucyk7CgogICAgICAgIGlmIChyZXF1ZXN0RG9tYWluUGFyc2VyLmhvc3QgIT09ICIiICYmICh0aGlzRG9tYWluUGFyc2VyLmhvc3QgIT09IHJlcXVlc3REb21haW5QYXJzZXIuaG9zdCkpIHsKICAgICAgICAgICAgdXNlWERvbWFpblJlcXVlc3QgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgLy8gT25seSB1c2UgdGhpcyBpZiBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBDT1JTIG5hdGl2ZWx5LiBUaGlzIHNob3VsZAogICAgICAgIC8vIGNhdGNoIElFNy84LzkgYnV0IGtlZXAgSUUxMCB1c2luZyB0aGUgYnVpbHQgaW4gWE1MSHR0cFJlcXVlc3Qgd2hpY2gKICAgICAgICAvLyBJRTEwIGZpbmFsbHkgc3VwcG9ydHMgZm9yIENPUlMuCiAgICAgICAgaWYgKHVzZVhEb21haW5SZXF1ZXN0ICYmICFCYWNrYm9uZS4kLnN1cHBvcnQuY29ycykgewoKICAgICAgICAgICAgLy8gU2VlIHRoaXMgYXJ0aWNsZSBmb3IgbW9yZSBkZXRhaWxzIG9uIGFsbCB0aGUgc2lsbHkgbnVhbmNlczogaHR0cDovL3ZxLmlvLzE0REoxVHYKCiAgICAgICAgICAgIC8vIEJhc2ljYWxseSBCYWNrYm9uZS5zeW5jIHJld3JpdHRlbiB0byB1c2UgWERvbWFpblJlcXVlc3Qgb2JqZWN0CiAgICAgICAgICAgIHZhciB0eXBlID0gbWV0aG9kTWFwW21ldGhvZF07CgogICAgICAgICAgICAvLyBEZWZhdWx0IG9wdGlvbnMsIHVubGVzcyBzcGVjaWZpZWQuCiAgICAgICAgICAgIF8uZGVmYXVsdHMob3B0aW9ucyB8fCAob3B0aW9ucyA9IHt9KSwgewogICAgICAgICAgICAgICAgZW11bGF0ZUhUVFA6IEJhY2tib25lLmVtdWxhdGVIVFRQLAogICAgICAgICAgICAgICAgZW11bGF0ZUpTT046IEJhY2tib25lLmVtdWxhdGVKU09OCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gWERvbWFpblJlcXVlc3Qgb25seSB3b3JrcyB3aXRoIFBPU1QuIFNvIERFTEVURS9QVVQvUEFUQ0ggY2FuJ3Qgd29yayBoZXJlLgoKICAgICAgICAgICAgLy8gTm90ZTogQ29uc2Npb3VzIGRlY2lzaW9uIHRvIHRocm93IGVycm9yIHJhdGhlciB0aGFuIHRyeSB0byBtdW5nZSB0aGUgcmVxdWVzdCBhbmQKICAgICAgICAgICAgLy8gZG8gc29tZXRoaW5nIGxpa2UgZm9yY2UgIm9wdGlvbnMuZW11bGF0ZUhUVFAgPSB0cnVlIiBiZWNhdXNlIHdlIHdhbnQgZGV2ZWxvcGVycwogICAgICAgICAgICAvLyB0byBub3RpY2UgdGhleSdyZSB0cnlpbmcgdG8gZG8gc29tZXRoaW5nIGlsbGVnYWwgd2l0aCB0aGlzIHJlcXVlc3QgYW5kIGl0IG1heQogICAgICAgICAgICAvLyByZXF1aXJlIHNlcnZlci1zaWRlIGNoYW5nZXMgZm9yIGNvbXBhdGliaWxpdHkuCiAgICAgICAgICAgIGlmICghb3B0aW9ucy5lbXVsYXRlSFRUUCAmJiAobWV0aG9kID09PSAndXBkYXRlJyB8fCBtZXRob2QgPT09ICdwYXRjaCcgfHwgbWV0aG9kID09PSAnZGVsZXRlJykpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQmFja2JvbmUuQ3Jvc3NEb21haW4gY2Fubm90IHVzZSBQVVQsIFBBVENILCBERUxFVEUgd2l0aCBYRG9tYWluUmVxdWVzdCAoSUUpIGFuZCBlbXVsYXRlSFRUUD1mYWxzZScpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEZWZhdWx0IEpTT04tcmVxdWVzdCBvcHRpb25zLgogICAgICAgICAgICB2YXIgcGFyYW1zID0ge3R5cGU6IHR5cGUsIGRhdGFUeXBlOiAnanNvbicsIHVybDogcmVxdWVzdFVybChtb2RlbCwgb3B0aW9ucyl9OwoKICAgICAgICAgICAgLy8gRW5zdXJlIHRoYXQgd2UgaGF2ZSBhIFVSTC4KICAgICAgICAgICAgaWYgKCFwYXJhbXMudXJsKSB0aHJvdyBuZXcgRXJyb3IoJ05vIFVSTCEnKTsKCiAgICAgICAgICAgIC8vIENoZWNrIGlmIHByb3RvY29scyBkaWZmZXIsIGlmIHNvIHRyeSB0aGUgcmVxdWVzdCB3aXRoIHRoZSBjdXJyZW50IGRvbWFpbiBwcm90b2NvbAogICAgICAgICAgICBpZiAocHJvdG9jb2xzRGlmZmVyKHRoaXNEb21haW5QYXJzZXIucHJvdG9jb2wsIHJlcXVlc3REb21haW5QYXJzZXIucHJvdG9jb2wpKSB7CiAgICAgICAgICAgICAgICBwYXJhbXMudXJsID0gcGFyYW1zLnVybC5yZXBsYWNlKG5ldyBSZWdFeHAocmVxdWVzdERvbWFpblBhcnNlci5wcm90b2NvbCksIHRoaXNEb21haW5QYXJzZXIucHJvdG9jb2wpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBUT0RPOiBYRG9tYWluUmVxdWVzdCBvbmx5IGFjY2VwdHMgdGV4dC9wbGFpbiBDb250ZW50LVR5cGUgaGVhZGVyCgogICAgICAgICAgICAvLyBUT0RPOiBYRG9tYWluUmVxdWVzdCBkb2Vzbid0IGxpa2Ugb3RoZXIgaGVhZGVycwoKICAgICAgICAgICAgLy8gRW5zdXJlIHRoYXQgd2UgaGF2ZSB0aGUgYXBwcm9wcmlhdGUgcmVxdWVzdCBkYXRhLgogICAgICAgICAgICBpZiAob3B0aW9ucy5kYXRhID09IG51bGwgJiYgbW9kZWwgJiYgKG1ldGhvZCA9PT0gJ2NyZWF0ZScgfHwgbWV0aG9kID09PSAndXBkYXRlJyB8fCBtZXRob2QgPT09ICdwYXRjaCcpKSB7CiAgICAgICAgICAgICAgICBwYXJhbXMuZGF0YSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMuYXR0cnMgfHwgbW9kZWwudG9KU09OKG9wdGlvbnMpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRm9yIG9sZGVyIHNlcnZlcnMsIGVtdWxhdGUgSlNPTiBieSBlbmNvZGluZyB0aGUgcmVxdWVzdCBpbnRvIGFuIEhUTUwtZm9ybS4KICAgICAgICAgICAgaWYgKG9wdGlvbnMuZW11bGF0ZUpTT04pIHsKICAgICAgICAgICAgICAgIHBhcmFtcy5kYXRhID0gcGFyYW1zLmRhdGEgPyB7bW9kZWw6IHBhcmFtcy5kYXRhfSA6IHt9OwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBGb3Igb2xkZXIgc2VydmVycywgZW11bGF0ZSBIVFRQIGJ5IG1pbWlja2luZyB0aGUgSFRUUCBtZXRob2Qgd2l0aCBgX21ldGhvZGAKICAgICAgICAgICAgLy8gQW5kIGFuIGBYLUhUVFAtTWV0aG9kLU92ZXJyaWRlYCBoZWFkZXIuCgogICAgICAgICAgICBpZiAob3B0aW9ucy5lbXVsYXRlSFRUUCAmJiAodHlwZSA9PT0gJ1BVVCcgfHwgdHlwZSA9PT0gJ0RFTEVURScgfHwgdHlwZSA9PT0gJ1BBVENIJykpIHsKICAgICAgICAgICAgICAgIHBhcmFtcy50eXBlID0gJ1BPU1QnOwogICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZW11bGF0ZUpTT04pIHBhcmFtcy5kYXRhLl9tZXRob2QgPSB0eXBlOwogICAgICAgICAgICAgICAgdmFyIGJlZm9yZVNlbmQgPSBvcHRpb25zLmJlZm9yZVNlbmQ7CiAgICAgICAgICAgICAgICBvcHRpb25zLmJlZm9yZVNlbmQgPSBmdW5jdGlvbih4aHIpIHsKICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignWC1IVFRQLU1ldGhvZC1PdmVycmlkZScsIHR5cGUpOwogICAgICAgICAgICAgICAgICAgIGlmIChiZWZvcmVTZW5kKSByZXR1cm4gYmVmb3JlU2VuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRG9uJ3QgcHJvY2VzcyBkYXRhIG9uIGEgbm9uLUdFVCByZXF1ZXN0LgogICAgICAgICAgICBpZiAocGFyYW1zLnR5cGUgIT09ICdHRVQnICYmICFvcHRpb25zLmVtdWxhdGVKU09OKSB7CiAgICAgICAgICAgICAgICBwYXJhbXMucHJvY2Vzc0RhdGEgPSBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gTmVlZCB0byBzZW5kIHRoaXMgYWxvbmcgYXMga2V5L3ZhbHVlIHBhaXJzLCBjYW4ndCBzZW5kIEpTT04gYmxvYgogICAgICAgICAgICBpZiAocGFyYW1zLnR5cGUgPT09ICdQT1NUJykgewogICAgICAgICAgICAgICAgcGFyYW1zLmRhdGEgPSBCYWNrYm9uZS4kLnBhcmFtKEJhY2tib25lLiQucGFyc2VKU09OKHBhcmFtcy5kYXRhKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciB4ZHIgPSBvcHRpb25zLnhociA9IG5ldyBYRG9tYWluUmVxdWVzdCgpLAogICAgICAgICAgICAgICAgc3VjY2VzcyA9IG9wdGlvbnMuc3VjY2VzcywKICAgICAgICAgICAgICAgIGVycm9yID0gb3B0aW9ucy5lcnJvcjsKCiAgICAgICAgICAgIC8vIEF0dGFjaCBkZWZlcnJlZHMsIGJ1dCBvbmx5IGlmICQgaXMgalF1ZXJ5IChpZiB3ZSBkb24ndCBkbyB0aGlzIGNoZWNrLAogICAgICAgICAgICAvLyB3ZSdsbCBicmVhayBzdXBwb3J0IGZvciBaZXB0byBvciBvdGhlciBsaWJyYXJpZXMgd2l0aG91dCBwcm9taXNlIHN1cHBvcnQKICAgICAgICAgICAgaWYgKEJhY2tib25lLiQuZm4uanF1ZXJ5KSB7CiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSBCYWNrYm9uZS4kLkRlZmVycmVkKCksCiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVEZWZlcnJlZCA9IEJhY2tib25lLiQuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpOwogICAgICAgICAgICAgICAgZGVmZXJyZWQucHJvbWlzZSh4ZHIpLmNvbXBsZXRlID0gY29tcGxldGVEZWZlcnJlZC5hZGQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHhkci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307CgogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSh4ZHIpKTsKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2xvYWQnKTsKICAgICAgICAgICAgICAgIGlmICh4ZHIucmVzcG9uc2VUZXh0KSB7CgogICAgICAgICAgICAgICAgICAgIG9iaiA9IEJhY2tib25lLiQucGFyc2VKU09OKHhkci5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cob2JqLmF0dHJpYnV0ZXMubm90ZXMudmFsdWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG9iaikgewogICAgICAgICAgICAgICAgICAgIGlmKGRlZmVycmVkKSBkZWZlcnJlZC5yZXNvbHZlV2l0aCh0aGlzLCBbc3VjY2VzcywgJ3N1Y2Nlc3MnLCB4ZHJdKTsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzKG9iaik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHhkci5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3IobW9kZWwsIHhkciwgb3B0aW9ucyk7CiAgICAgICAgICAgICAgICAgICBpZihkZWZlcnJlZCkgZGVmZXJyZWQucmVqZWN0V2l0aCh0aGlzLCBbeGRyLCAnZXJyb3InLCBlcnJvcl0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbW9kZWwudHJpZ2dlcignZXJyb3InLCBtb2RlbCwgeGRyLCBvcHRpb25zKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIC8vIE1ha2UgdGhlIHJlcXVlc3QgdXNpbmcgWERvbWFpblJlcXVlc3QKICAgICAgICAgICAgeGRyLm9wZW4ocGFyYW1zLnR5cGUsIHBhcmFtcy51cmwpOwoKICAgICAgICAgICAgLy8gTXVzdCBkZWNsYXJlIHRoZXNlIGV2ZW4gaWYgZW1wdHkgb3IgSUUgd2lsbCBhYm9ydCByYW5kb21seTogaHR0cDovL3ZxLmlvLzEyYm5oeWUKICAgICAgICAgICAgeGRyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICAgICAgeGRyLm9udGltZW91dCA9IGZ1bmN0aW9uICgpIHt9OwoKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB4ZHIuc2VuZChwYXJhbXMuZGF0YSk7CiAgICAgICAgICAgIH0sIDApOwoKICAgICAgICAgICAgbW9kZWwudHJpZ2dlcigncmVxdWVzdCcsIG1vZGVsLCB4ZHIsIG9wdGlvbnMpOwogICAgICAgICAgICByZXR1cm4geGRyOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIEJhY2tib25lLnZhbmlsbGFTeW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gQmFja2JvbmU7Cn0pKTs=",
                "body": "Ly8gQmFja2JvbmUuQ3Jvc3NEb21haW5Nb2RlbCAwLjEuMAovLwovLyAoYykgMjAxMyBWaWN0b3IgUXVpbm4KLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLgoKKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7CiAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAiZnVuY3Rpb24iICYmIGRlZmluZS5hbWQpIHsKICAgICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLgogICAgICBkZWZpbmUoWyJ1bmRlcnNjb3JlIiwiYmFja2JvbmUiXSwgZnVuY3Rpb24oXywgQmFja2JvbmUpIHsKICAgICAgICAvLyBVc2UgZ2xvYmFsIHZhcmlhYmxlcyBpZiB0aGUgbG9jYWxzIGFyZSB1bmRlZmluZWQuCiAgICAgICAgcmV0dXJuIGZhY3RvcnkoXyB8fCByb290Ll8sIEJhY2tib25lIHx8IHJvb3QuQmFja2JvbmUpOwogICAgICB9KTsKICAgfSBlbHNlIHsKICAgICAgLy8gUmVxdWlyZUpTIGlzbid0IGJlaW5nIHVzZWQuIEFzc3VtZSB1bmRlcnNjb3JlIGFuZCBiYWNrYm9uZSBhcmUgbG9hZGVkIGluIDxzY3JpcHQ+IHRhZ3MKICAgICAgZmFjdG9yeShfLCBCYWNrYm9uZSk7CiAgIH0KfSh0aGlzLCBmdW5jdGlvbihfLCBCYWNrYm9uZSkgewoKICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgdGhlIHJlcXVlc3QgdXJsIGdpdmVuIG1vZGVsIGFuZCBvcHRpb25zIG9iamVjdHMKICAgIGZ1bmN0aW9uIHJlcXVlc3RVcmwobW9kZWwsIG9wdGlvbnMpIHsKICAgICAgICB2YXIgcmVxdWVzdFVybCA9IG51bGw7CiAgICAgICAgLy8gRmlyc3QgdHJ5IHRoZSBvcHRpb25zIG9iamVjdAogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJlcXVlc3RVcmwgPSBvcHRpb25zLnVybDsKICAgICAgICB9IGNhdGNoKHgpIHt9CgogICAgICAgIC8vIFRoZW4gdHJ5IHRoZSBtb2RlbCdzIHVybAogICAgICAgIGlmICghcmVxdWVzdFVybCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmVxdWVzdFVybCA9IF8ucmVzdWx0KG1vZGVsLCAndXJsJyk7CiAgICAgICAgICAgIH0gY2F0Y2goeCkge30KICAgICAgICB9CgogICAgICAgIHJldHVybiByZXF1ZXN0VXJsOwogICAgfQoKICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgd2hldGhlciBwcm90b2NvbHMgZGlmZmVyLgogICAgZnVuY3Rpb24gcHJvdG9jb2xzRGlmZmVyKHRoaXNQcm90b2NvbCwgcmVxdWVzdFByb3RvY29sKSB7CiAgICAgICAgaWYgKHRoaXNQcm90b2NvbCA9PT0gJzonIHx8IHJlcXVlc3RQcm90b2NvbCA9PT0gIjoiKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGVsc2UgaWYgKHRoaXNQcm90b2NvbCA9PT0gcmVxdWVzdFByb3RvY29sKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIE1hcCBmcm9tIENSVUQgdG8gSFRUUCBmb3Igb3VyIGRlZmF1bHQgYEJhY2tib25lLnN5bmNgIGltcGxlbWVudGF0aW9uLgoKICAgIHZhciBtZXRob2RNYXAgPSB7CiAgICAgICAgJ2NyZWF0ZSc6ICdQT1NUJywKICAgICAgICAndXBkYXRlJzogJ1BVVCcsCiAgICAgICAgJ3BhdGNoJzogICdQQVRDSCcsCiAgICAgICAgJ2RlbGV0ZSc6ICdERUxFVEUnLAogICAgICAgICdyZWFkJzogICAnR0VUJwogICAgfTsKCiAgICBCYWNrYm9uZS52YW5pbGxhU3luYyA9IEJhY2tib25lLnN5bmM7CgogICAgLy8gT3ZlcnJpZGUgJ0JhY2tib25lLnN5bmMnIHRvIGRlZmF1bHQgdG8gQ3Jvc3NEb21haW5Nb2RlbCBzeW5jLgogICAgLy8gdGhlIG9yaWdpbmFsICdCYWNrYm9uZS5zeW5jJyBpcyBzdGlsbCBhdmFpbGFibGUgaW4gJ0JhY2tib25lLnZhbmlsbGFTeW5jJwogICAgQmFja2JvbmUuc3luYyA9IGZ1bmN0aW9uKG1ldGhvZCwgbW9kZWwsIG9wdGlvbnMpIHsKCiAgICAgICAgLy8gU2VlIGlmIHdlIG5lZWQgdG8gdXNlIHRoZSBYRG9tYWluUmVxdWVzdCBvYmplY3QgZm9yIElFLiBJZiB0aGUgcmVxdWVzdCBpcyBvbiB0aGUKICAgICAgICAvLyBzYW1lIGRvbWFpbiwgd2UgY2FuIGZhbGwgYmFjayBvbiB0aGUgbm9ybWFsIEJhY2tib25lLmFqYXggaGFuZGxpbmcuCiAgICAgICAgdmFyIHVzZVhEb21haW5SZXF1ZXN0ID0gZmFsc2U7CgogICAgICAgIC8vIFNlZSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9qbG9uZy8yNDI4NTYxCiAgICAgICAgdmFyIHRoaXNEb21haW5QYXJzZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgdGhpc0RvbWFpblBhcnNlci5ocmVmID0gZG9jdW1lbnQuVVJMOwoKICAgICAgICB2YXIgcmVxdWVzdERvbWFpblBhcnNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICByZXF1ZXN0RG9tYWluUGFyc2VyLmhyZWYgPSByZXF1ZXN0VXJsKG1vZGVsLCBvcHRpb25zKTsKCiAgICAgICAgaWYgKHJlcXVlc3REb21haW5QYXJzZXIuaG9zdCAhPT0gIiIgJiYgKHRoaXNEb21haW5QYXJzZXIuaG9zdCAhPT0gcmVxdWVzdERvbWFpblBhcnNlci5ob3N0KSkgewogICAgICAgICAgICB1c2VYRG9tYWluUmVxdWVzdCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBPbmx5IHVzZSB0aGlzIGlmIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IENPUlMgbmF0aXZlbHkuIFRoaXMgc2hvdWxkCiAgICAgICAgLy8gY2F0Y2ggSUU3LzgvOSBidXQga2VlcCBJRTEwIHVzaW5nIHRoZSBidWlsdCBpbiBYTUxIdHRwUmVxdWVzdCB3aGljaAogICAgICAgIC8vIElFMTAgZmluYWxseSBzdXBwb3J0cyBmb3IgQ09SUy4KICAgICAgICBpZiAodXNlWERvbWFpblJlcXVlc3QgJiYgIUJhY2tib25lLiQuc3VwcG9ydC5jb3JzKSB7CgogICAgICAgICAgICAvLyBTZWUgdGhpcyBhcnRpY2xlIGZvciBtb3JlIGRldGFpbHMgb24gYWxsIHRoZSBzaWxseSBudWFuY2VzOiBodHRwOi8vdnEuaW8vMTRESjFUdgoKICAgICAgICAgICAgLy8gQmFzaWNhbGx5IEJhY2tib25lLnN5bmMgcmV3cml0dGVuIHRvIHVzZSBYRG9tYWluUmVxdWVzdCBvYmplY3QKICAgICAgICAgICAgdmFyIHR5cGUgPSBtZXRob2RNYXBbbWV0aG9kXTsKCiAgICAgICAgICAgIC8vIERlZmF1bHQgb3B0aW9ucywgdW5sZXNzIHNwZWNpZmllZC4KICAgICAgICAgICAgXy5kZWZhdWx0cyhvcHRpb25zIHx8IChvcHRpb25zID0ge30pLCB7CiAgICAgICAgICAgICAgICBlbXVsYXRlSFRUUDogQmFja2JvbmUuZW11bGF0ZUhUVFAsCiAgICAgICAgICAgICAgICBlbXVsYXRlSlNPTjogQmFja2JvbmUuZW11bGF0ZUpTT04KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBYRG9tYWluUmVxdWVzdCBvbmx5IHdvcmtzIHdpdGggUE9TVC4gU28gREVMRVRFL1BVVC9QQVRDSCBjYW4ndCB3b3JrIGhlcmUuCgogICAgICAgICAgICAvLyBOb3RlOiBDb25zY2lvdXMgZGVjaXNpb24gdG8gdGhyb3cgZXJyb3IgcmF0aGVyIHRoYW4gdHJ5IHRvIG11bmdlIHRoZSByZXF1ZXN0IGFuZAogICAgICAgICAgICAvLyBkbyBzb21ldGhpbmcgbGlrZSBmb3JjZSAib3B0aW9ucy5lbXVsYXRlSFRUUCA9IHRydWUiIGJlY2F1c2Ugd2Ugd2FudCBkZXZlbG9wZXJzCiAgICAgICAgICAgIC8vIHRvIG5vdGljZSB0aGV5J3JlIHRyeWluZyB0byBkbyBzb21ldGhpbmcgaWxsZWdhbCB3aXRoIHRoaXMgcmVxdWVzdCBhbmQgaXQgbWF5CiAgICAgICAgICAgIC8vIHJlcXVpcmUgc2VydmVyLXNpZGUgY2hhbmdlcyBmb3IgY29tcGF0aWJpbGl0eS4KICAgICAgICAgICAgaWYgKCFvcHRpb25zLmVtdWxhdGVIVFRQICYmIChtZXRob2QgPT09ICd1cGRhdGUnIHx8IG1ldGhvZCA9PT0gJ3BhdGNoJyB8fCBtZXRob2QgPT09ICdkZWxldGUnKSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCYWNrYm9uZS5Dcm9zc0RvbWFpbiBjYW5ub3QgdXNlIFBVVCwgUEFUQ0gsIERFTEVURSB3aXRoIFhEb21haW5SZXF1ZXN0IChJRSkgYW5kIGVtdWxhdGVIVFRQPWZhbHNlJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIERlZmF1bHQgSlNPTi1yZXF1ZXN0IG9wdGlvbnMuCiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7dHlwZTogdHlwZSwgZGF0YVR5cGU6ICdqc29uJywgdXJsOiByZXF1ZXN0VXJsKG1vZGVsLCBvcHRpb25zKX07CgogICAgICAgICAgICAvLyBFbnN1cmUgdGhhdCB3ZSBoYXZlIGEgVVJMLgogICAgICAgICAgICBpZiAoIXBhcmFtcy51cmwpIHRocm93IG5ldyBFcnJvcignTm8gVVJMIScpOwoKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgcHJvdG9jb2xzIGRpZmZlciwgaWYgc28gdHJ5IHRoZSByZXF1ZXN0IHdpdGggdGhlIGN1cnJlbnQgZG9tYWluIHByb3RvY29sCiAgICAgICAgICAgIGlmIChwcm90b2NvbHNEaWZmZXIodGhpc0RvbWFpblBhcnNlci5wcm90b2NvbCwgcmVxdWVzdERvbWFpblBhcnNlci5wcm90b2NvbCkpIHsKICAgICAgICAgICAgICAgIHBhcmFtcy51cmwgPSBwYXJhbXMudXJsLnJlcGxhY2UobmV3IFJlZ0V4cChyZXF1ZXN0RG9tYWluUGFyc2VyLnByb3RvY29sKSwgdGhpc0RvbWFpblBhcnNlci5wcm90b2NvbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFRPRE86IFhEb21haW5SZXF1ZXN0IG9ubHkgYWNjZXB0cyB0ZXh0L3BsYWluIENvbnRlbnQtVHlwZSBoZWFkZXIKCiAgICAgICAgICAgIC8vIFRPRE86IFhEb21haW5SZXF1ZXN0IGRvZXNuJ3QgbGlrZSBvdGhlciBoZWFkZXJzCgogICAgICAgICAgICAvLyBFbnN1cmUgdGhhdCB3ZSBoYXZlIHRoZSBhcHByb3ByaWF0ZSByZXF1ZXN0IGRhdGEuCiAgICAgICAgICAgIGlmIChvcHRpb25zLmRhdGEgPT0gbnVsbCAmJiBtb2RlbCAmJiAobWV0aG9kID09PSAnY3JlYXRlJyB8fCBtZXRob2QgPT09ICd1cGRhdGUnIHx8IG1ldGhvZCA9PT0gJ3BhdGNoJykpIHsKICAgICAgICAgICAgICAgIHBhcmFtcy5kYXRhID0gSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5hdHRycyB8fCBtb2RlbC50b0pTT04ob3B0aW9ucykpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBGb3Igb2xkZXIgc2VydmVycywgZW11bGF0ZSBKU09OIGJ5IGVuY29kaW5nIHRoZSByZXF1ZXN0IGludG8gYW4gSFRNTC1mb3JtLgogICAgICAgICAgICBpZiAob3B0aW9ucy5lbXVsYXRlSlNPTikgewogICAgICAgICAgICAgICAgcGFyYW1zLmRhdGEgPSBwYXJhbXMuZGF0YSA/IHttb2RlbDogcGFyYW1zLmRhdGF9IDoge307CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIEZvciBvbGRlciBzZXJ2ZXJzLCBlbXVsYXRlIEhUVFAgYnkgbWltaWNraW5nIHRoZSBIVFRQIG1ldGhvZCB3aXRoIGBfbWV0aG9kYAogICAgICAgICAgICAvLyBBbmQgYW4gYFgtSFRUUC1NZXRob2QtT3ZlcnJpZGVgIGhlYWRlci4KCiAgICAgICAgICAgIGlmIChvcHRpb25zLmVtdWxhdGVIVFRQICYmICh0eXBlID09PSAnUFVUJyB8fCB0eXBlID09PSAnREVMRVRFJyB8fCB0eXBlID09PSAnUEFUQ0gnKSkgewogICAgICAgICAgICAgICAgcGFyYW1zLnR5cGUgPSAnUE9TVCc7CiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5lbXVsYXRlSlNPTikgcGFyYW1zLmRhdGEuX21ldGhvZCA9IHR5cGU7CiAgICAgICAgICAgICAgICB2YXIgYmVmb3JlU2VuZCA9IG9wdGlvbnMuYmVmb3JlU2VuZDsKICAgICAgICAgICAgICAgIG9wdGlvbnMuYmVmb3JlU2VuZCA9IGZ1bmN0aW9uKHhocikgewogICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdYLUhUVFAtTWV0aG9kLU92ZXJyaWRlJywgdHlwZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJlZm9yZVNlbmQpIHJldHVybiBiZWZvcmVTZW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEb24ndCBwcm9jZXNzIGRhdGEgb24gYSBub24tR0VUIHJlcXVlc3QuCiAgICAgICAgICAgIGlmIChwYXJhbXMudHlwZSAhPT0gJ0dFVCcgJiYgIW9wdGlvbnMuZW11bGF0ZUpTT04pIHsKICAgICAgICAgICAgICAgIHBhcmFtcy5wcm9jZXNzRGF0YSA9IGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBOZWVkIHRvIHNlbmQgdGhpcyBhbG9uZyBhcyBrZXkvdmFsdWUgcGFpcnMsIGNhbid0IHNlbmQgSlNPTiBibG9iCiAgICAgICAgICAgIGlmIChwYXJhbXMudHlwZSA9PT0gJ1BPU1QnKSB7CiAgICAgICAgICAgICAgICBwYXJhbXMuZGF0YSA9IEJhY2tib25lLiQucGFyYW0oQmFja2JvbmUuJC5wYXJzZUpTT04ocGFyYW1zLmRhdGEpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHhkciA9IG9wdGlvbnMueGhyID0gbmV3IFhEb21haW5SZXF1ZXN0KCksCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gb3B0aW9ucy5zdWNjZXNzLAogICAgICAgICAgICAgICAgZXJyb3IgPSBvcHRpb25zLmVycm9yOwoKICAgICAgICAgICAgLy8gQXR0YWNoIGRlZmVycmVkcywgYnV0IG9ubHkgaWYgJCBpcyBqUXVlcnkgKGlmIHdlIGRvbid0IGRvIHRoaXMgY2hlY2ssCiAgICAgICAgICAgIC8vIHdlJ2xsIGJyZWFrIHN1cHBvcnQgZm9yIFplcHRvIG9yIG90aGVyIGxpYnJhcmllcyB3aXRob3V0IHByb21pc2Ugc3VwcG9ydAogICAgICAgICAgICBpZiAoQmFja2JvbmUuJC5mbi5qcXVlcnkpIHsKICAgICAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IEJhY2tib25lLiQuRGVmZXJyZWQoKSwKICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZURlZmVycmVkID0gQmFja2JvbmUuJC5DYWxsYmFja3MoIm9uY2UgbWVtb3J5Iik7CiAgICAgICAgICAgICAgICBkZWZlcnJlZC5wcm9taXNlKHhkcikuY29tcGxldGUgPSBjb21wbGV0ZURlZmVycmVkLmFkZDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgeGRyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTsKCiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHhkcikpOwogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbG9hZCcpOwogICAgICAgICAgICAgICAgaWYgKHhkci5yZXNwb25zZVRleHQpIHsKCiAgICAgICAgICAgICAgICAgICAgb2JqID0gQmFja2JvbmUuJC5wYXJzZUpTT04oeGRyLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhvYmouYXR0cmlidXRlcy5ub3Rlcy52YWx1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAob2JqKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoZGVmZXJyZWQpIGRlZmVycmVkLnJlc29sdmVXaXRoKHRoaXMsIFtzdWNjZXNzLCAnc3VjY2VzcycsIHhkcl0pOwogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3Mob2JqKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgeGRyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICBlcnJvcihtb2RlbCwgeGRyLCBvcHRpb25zKTsKICAgICAgICAgICAgICAgICAgIGlmKGRlZmVycmVkKSBkZWZlcnJlZC5yZWplY3RXaXRoKHRoaXMsIFt4ZHIsICdlcnJvcicsIGVycm9yXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBtb2RlbC50cmlnZ2VyKCdlcnJvcicsIG1vZGVsLCB4ZHIsIG9wdGlvbnMpOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgLy8gTWFrZSB0aGUgcmVxdWVzdCB1c2luZyBYRG9tYWluUmVxdWVzdAogICAgICAgICAgICB4ZHIub3BlbihwYXJhbXMudHlwZSwgcGFyYW1zLnVybCk7CgogICAgICAgICAgICAvLyBNdXN0IGRlY2xhcmUgdGhlc2UgZXZlbiBpZiBlbXB0eSBvciBJRSB3aWxsIGFib3J0IHJhbmRvbWx5OiBodHRwOi8vdnEuaW8vMTJibmh5ZQogICAgICAgICAgICB4ZHIub25wcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgICAgICB4ZHIub250aW1lb3V0ID0gZnVuY3Rpb24gKCkge307CgogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHhkci5zZW5kKHBhcmFtcy5kYXRhKTsKICAgICAgICAgICAgfSwgMCk7CgogICAgICAgICAgICBtb2RlbC50cmlnZ2VyKCdyZXF1ZXN0JywgbW9kZWwsIHhkciwgb3B0aW9ucyk7CiAgICAgICAgICAgIHJldHVybiB4ZHI7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICByZXR1cm4gQmFja2JvbmUudmFuaWxsYVN5bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9CiAgICB9OwoKICAgIHJldHVybiBCYWNrYm9uZTsKfSkpOw==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 15:07:35 GMT",
                    "Content-Length": "8194",
                    "Date": "Thu, 06 Nov 2014 15:07:37 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}