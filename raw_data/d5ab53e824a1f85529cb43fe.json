{
    "url": "http://localhost:9999/pajtai/backbone-state-machine/app/components/backbone/backbone-min.js",
    "host": "localhost",
    "port": 9999,
    "protocol": "http",
    "name": "Open redirection (DOM-based)",
    "issueType": 5243152,
    "severity": "Low",
    "confidence": "Firm",
    "issueBackground": "DOM-based open redirection vulnerabilities arise when a client-side script within an application's response reads data from a controllable part of the DOM (for example, the URL), and writes this data into the target of a redirection in an unsafe way. An attacker may be able to use the vulnerability to construct a URL which, if visited by another application user, will cause a redirection to an arbitrary external domain. This behavior can be leveraged to facilitate phishing attacks against users of the application. The ability to use an authentic application URL, targeting the correct domain with a valid SSL certificate (if SSL is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.<br><br><b>Note:</b> If an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack, by using a URL with the javascript: pseudo-protocol to execute arbitrary script code when the URL is processed by the browser.",
    "remediationBackground": "Static analysis of code to identify vulnerabilities of this kind may lead to false positives that are not actually exploitable. You should review the highlighted code and related execution paths to determine whether the application is indeed vulnerable, or whether mitigations are in place that would prevent exploitation.<br><br>The most effective way to avoid DOM-based open redirection vulnerabilities is not to dynamically set redirection targets using data that originated from any untrusted source. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing an arbitrary URL as a redirection target. In general, this is best achieved by using a whitelist of URLs that are permitted redirection targets, and strictly validating the target against this list before performing the redirection.",
    "issueDetail": "The application may be vulnerable to DOM-based open redirection. Data is read from <b>location.href</b> and written to <b>location.replace()</b> via the following statements:<ul><li>var href=location.href.replace(/(javascript:|#).*$/,\"\");</li><li>location.replace(href+\"#\"+fragment)</li></ul>",
    "requestResponses": [
        {
            "request": {
                "host": "localhost",
                "port": 9999,
                "protocol": "http",
                "url": "http://localhost:9999/pajtai/backbone-state-machine/app/components/backbone/backbone-min.js",
                "path": "/pajtai/backbone-state-machine/app/components/backbone/backbone-min.js",
                "httpVersion": "HTTP/1.1",
                "method": "GET",
                "headers": {
                    "Host": "localhost:9999"
                },
                "body": "",
                "raw": "R0VUIC9wYWp0YWkvYmFja2JvbmUtc3RhdGUtbWFjaGluZS9hcHAvY29tcG9uZW50cy9iYWNrYm9uZS9iYWNrYm9uZS1taW4uanMgSFRUUC8xLjENCkhvc3Q6IGxvY2FsaG9zdDo5OTk5DQoNCg==",
                "inScope": true,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "request"
            },
            "response": {
                "statusCode": 200,
                "raw": "SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LUxlbmd0aDogMjU4ODgNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkRhdGU6IFRodSwgMDYgTm92IDIwMTQgMTE6NDI6MDAgR01UDQpMYXN0LU1vZGlmaWVkOiBUaHUsIDA2IE5vdiAyMDE0IDExOjQxOjU3IEdNVA0KDQooZnVuY3Rpb24oKXt2YXIgcm9vdD10aGlzO3ZhciBwcmV2aW91c0JhY2tib25lPXJvb3QuQmFja2JvbmU7dmFyIGFycmF5PVtdO3ZhciBwdXNoPWFycmF5LnB1c2g7dmFyIHNsaWNlPWFycmF5LnNsaWNlO3ZhciBzcGxpY2U9YXJyYXkuc3BsaWNlO3ZhciBCYWNrYm9uZTtpZih0eXBlb2YgZXhwb3J0cyE9PSJ1bmRlZmluZWQiKXtCYWNrYm9uZT1leHBvcnRzfWVsc2V7QmFja2JvbmU9cm9vdC5CYWNrYm9uZT17fX1CYWNrYm9uZS5WRVJTSU9OPSIxLjAuMCI7dmFyIF89cm9vdC5fO2lmKCFfJiZ0eXBlb2YgcmVxdWlyZSE9PSJ1bmRlZmluZWQiKV89cmVxdWlyZSgidW5kZXJzY29yZSIpO0JhY2tib25lLiQ9cm9vdC5qUXVlcnl8fHJvb3QuWmVwdG98fHJvb3QuZW5kZXJ8fHJvb3QuJDtCYWNrYm9uZS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cm9vdC5CYWNrYm9uZT1wcmV2aW91c0JhY2tib25lO3JldHVybiB0aGlzfTtCYWNrYm9uZS5lbXVsYXRlSFRUUD1mYWxzZTtCYWNrYm9uZS5lbXVsYXRlSlNPTj1mYWxzZTt2YXIgRXZlbnRzPUJhY2tib25lLkV2ZW50cz17b246ZnVuY3Rpb24obmFtZSxjYWxsYmFjayxjb250ZXh0KXtpZighZXZlbnRzQXBpKHRoaXMsIm9uIixuYW1lLFtjYWxsYmFjayxjb250ZXh0XSl8fCFjYWxsYmFjaylyZXR1cm4gdGhpczt0aGlzLl9ldmVudHN8fCh0aGlzLl9ldmVudHM9e30pO3ZhciBldmVudHM9dGhpcy5fZXZlbnRzW25hbWVdfHwodGhpcy5fZXZlbnRzW25hbWVdPVtdKTtldmVudHMucHVzaCh7Y2FsbGJhY2s6Y2FsbGJhY2ssY29udGV4dDpjb250ZXh0LGN0eDpjb250ZXh0fHx0aGlzfSk7cmV0dXJuIHRoaXN9LG9uY2U6ZnVuY3Rpb24obmFtZSxjYWxsYmFjayxjb250ZXh0KXtpZighZXZlbnRzQXBpKHRoaXMsIm9uY2UiLG5hbWUsW2NhbGxiYWNrLGNvbnRleHRdKXx8IWNhbGxiYWNrKXJldHVybiB0aGlzO3ZhciBzZWxmPXRoaXM7dmFyIG9uY2U9Xy5vbmNlKGZ1bmN0aW9uKCl7c2VsZi5vZmYobmFtZSxvbmNlKTtjYWxsYmFjay5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KTtvbmNlLl9jYWxsYmFjaz1jYWxsYmFjaztyZXR1cm4gdGhpcy5vbihuYW1lLG9uY2UsY29udGV4dCl9LG9mZjpmdW5jdGlvbihuYW1lLGNhbGxiYWNrLGNvbnRleHQpe3ZhciByZXRhaW4sZXYsZXZlbnRzLG5hbWVzLGksbCxqLGs7aWYoIXRoaXMuX2V2ZW50c3x8IWV2ZW50c0FwaSh0aGlzLCJvZmYiLG5hbWUsW2NhbGxiYWNrLGNvbnRleHRdKSlyZXR1cm4gdGhpcztpZighbmFtZSYmIWNhbGxiYWNrJiYhY29udGV4dCl7dGhpcy5fZXZlbnRzPXt9O3JldHVybiB0aGlzfW5hbWVzPW5hbWU/W25hbWVdOl8ua2V5cyh0aGlzLl9ldmVudHMpO2ZvcihpPTAsbD1uYW1lcy5sZW5ndGg7aTxsO2krKyl7bmFtZT1uYW1lc1tpXTtpZihldmVudHM9dGhpcy5fZXZlbnRzW25hbWVdKXt0aGlzLl9ldmVudHNbbmFtZV09cmV0YWluPVtdO2lmKGNhbGxiYWNrfHxjb250ZXh0KXtmb3Ioaj0wLGs9ZXZlbnRzLmxlbmd0aDtqPGs7aisrKXtldj1ldmVudHNbal07aWYoY2FsbGJhY2smJmNhbGxiYWNrIT09ZXYuY2FsbGJhY2smJmNhbGxiYWNrIT09ZXYuY2FsbGJhY2suX2NhbGxiYWNrfHxjb250ZXh0JiZjb250ZXh0IT09ZXYuY29udGV4dCl7cmV0YWluLnB1c2goZXYpfX19aWYoIXJldGFpbi5sZW5ndGgpZGVsZXRlIHRoaXMuX2V2ZW50c1tuYW1lXX19cmV0dXJuIHRoaXN9LHRyaWdnZXI6ZnVuY3Rpb24obmFtZSl7aWYoIXRoaXMuX2V2ZW50cylyZXR1cm4gdGhpczt2YXIgYXJncz1zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtpZighZXZlbnRzQXBpKHRoaXMsInRyaWdnZXIiLG5hbWUsYXJncykpcmV0dXJuIHRoaXM7dmFyIGV2ZW50cz10aGlzLl9ldmVudHNbbmFtZV07dmFyIGFsbEV2ZW50cz10aGlzLl9ldmVudHMuYWxsO2lmKGV2ZW50cyl0cmlnZ2VyRXZlbnRzKGV2ZW50cyxhcmdzKTtpZihhbGxFdmVudHMpdHJpZ2dlckV2ZW50cyhhbGxFdmVudHMsYXJndW1lbnRzKTtyZXR1cm4gdGhpc30sc3RvcExpc3RlbmluZzpmdW5jdGlvbihvYmosbmFtZSxjYWxsYmFjayl7dmFyIGxpc3RlbmVycz10aGlzLl9saXN0ZW5lcnM7aWYoIWxpc3RlbmVycylyZXR1cm4gdGhpczt2YXIgZGVsZXRlTGlzdGVuZXI9IW5hbWUmJiFjYWxsYmFjaztpZih0eXBlb2YgbmFtZT09PSJvYmplY3QiKWNhbGxiYWNrPXRoaXM7aWYob2JqKShsaXN0ZW5lcnM9e30pW29iai5fbGlzdGVuZXJJZF09b2JqO2Zvcih2YXIgaWQgaW4gbGlzdGVuZXJzKXtsaXN0ZW5lcnNbaWRdLm9mZihuYW1lLGNhbGxiYWNrLHRoaXMpO2lmKGRlbGV0ZUxpc3RlbmVyKWRlbGV0ZSB0aGlzLl9saXN0ZW5lcnNbaWRdfXJldHVybiB0aGlzfX07dmFyIGV2ZW50U3BsaXR0ZXI9L1xzKy87dmFyIGV2ZW50c0FwaT1mdW5jdGlvbihvYmosYWN0aW9uLG5hbWUscmVzdCl7aWYoIW5hbWUpcmV0dXJuIHRydWU7aWYodHlwZW9mIG5hbWU9PT0ib2JqZWN0Iil7Zm9yKHZhciBrZXkgaW4gbmFtZSl7b2JqW2FjdGlvbl0uYXBwbHkob2JqLFtrZXksbmFtZVtrZXldXS5jb25jYXQocmVzdCkpfXJldHVybiBmYWxzZX1pZihldmVudFNwbGl0dGVyLnRlc3QobmFtZSkpe3ZhciBuYW1lcz1uYW1lLnNwbGl0KGV2ZW50U3BsaXR0ZXIpO2Zvcih2YXIgaT0wLGw9bmFtZXMubGVuZ3RoO2k8bDtpKyspe29ialthY3Rpb25dLmFwcGx5KG9iaixbbmFtZXNbaV1dLmNvbmNhdChyZXN0KSl9cmV0dXJuIGZhbHNlfXJldHVybiB0cnVlfTt2YXIgdHJpZ2dlckV2ZW50cz1mdW5jdGlvbihldmVudHMsYXJncyl7dmFyIGV2LGk9LTEsbD1ldmVudHMubGVuZ3RoLGExPWFyZ3NbMF0sYTI9YXJnc1sxXSxhMz1hcmdzWzJdO3N3aXRjaChhcmdzLmxlbmd0aCl7Y2FzZSAwOndoaWxlKCsraTxsKShldj1ldmVudHNbaV0pLmNhbGxiYWNrLmNhbGwoZXYuY3R4KTtyZXR1cm47Y2FzZSAxOndoaWxlKCsraTxsKShldj1ldmVudHNbaV0pLmNhbGxiYWNrLmNhbGwoZXYuY3R4LGExKTtyZXR1cm47Y2FzZSAyOndoaWxlKCsraTxsKShldj1ldmVudHNbaV0pLmNhbGxiYWNrLmNhbGwoZXYuY3R4LGExLGEyKTtyZXR1cm47Y2FzZSAzOndoaWxlKCsraTxsKShldj1ldmVudHNbaV0pLmNhbGxiYWNrLmNhbGwoZXYuY3R4LGExLGEyLGEzKTtyZXR1cm47ZGVmYXVsdDp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5hcHBseShldi5jdHgsYXJncyl9fTt2YXIgbGlzdGVuTWV0aG9kcz17bGlzdGVuVG86Im9uIixsaXN0ZW5Ub09uY2U6Im9uY2UifTtfLmVhY2gobGlzdGVuTWV0aG9kcyxmdW5jdGlvbihpbXBsZW1lbnRhdGlvbixtZXRob2Qpe0V2ZW50c1ttZXRob2RdPWZ1bmN0aW9uKG9iaixuYW1lLGNhbGxiYWNrKXt2YXIgbGlzdGVuZXJzPXRoaXMuX2xpc3RlbmVyc3x8KHRoaXMuX2xpc3RlbmVycz17fSk7dmFyIGlkPW9iai5fbGlzdGVuZXJJZHx8KG9iai5fbGlzdGVuZXJJZD1fLnVuaXF1ZUlkKCJsIikpO2xpc3RlbmVyc1tpZF09b2JqO2lmKHR5cGVvZiBuYW1lPT09Im9iamVjdCIpY2FsbGJhY2s9dGhpcztvYmpbaW1wbGVtZW50YXRpb25dKG5hbWUsY2FsbGJhY2ssdGhpcyk7cmV0dXJuIHRoaXN9fSk7RXZlbnRzLmJpbmQ9RXZlbnRzLm9uO0V2ZW50cy51bmJpbmQ9RXZlbnRzLm9mZjtfLmV4dGVuZChCYWNrYm9uZSxFdmVudHMpO3ZhciBNb2RlbD1CYWNrYm9uZS5Nb2RlbD1mdW5jdGlvbihhdHRyaWJ1dGVzLG9wdGlvbnMpe3ZhciBkZWZhdWx0czt2YXIgYXR0cnM9YXR0cmlidXRlc3x8e307b3B0aW9uc3x8KG9wdGlvbnM9e30pO3RoaXMuY2lkPV8udW5pcXVlSWQoImMiKTt0aGlzLmF0dHJpYnV0ZXM9e307Xy5leHRlbmQodGhpcyxfLnBpY2sob3B0aW9ucyxtb2RlbE9wdGlvbnMpKTtpZihvcHRpb25zLnBhcnNlKWF0dHJzPXRoaXMucGFyc2UoYXR0cnMsb3B0aW9ucyl8fHt9O2lmKGRlZmF1bHRzPV8ucmVzdWx0KHRoaXMsImRlZmF1bHRzIikpe2F0dHJzPV8uZGVmYXVsdHMoe30sYXR0cnMsZGVmYXVsdHMpfXRoaXMuc2V0KGF0dHJzLG9wdGlvbnMpO3RoaXMuY2hhbmdlZD17fTt0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTt2YXIgbW9kZWxPcHRpb25zPVsidXJsIiwidXJsUm9vdCIsImNvbGxlY3Rpb24iXTtfLmV4dGVuZChNb2RlbC5wcm90b3R5cGUsRXZlbnRzLHtjaGFuZ2VkOm51bGwsdmFsaWRhdGlvbkVycm9yOm51bGwsaWRBdHRyaWJ1dGU6ImlkIixpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSx0b0pTT046ZnVuY3Rpb24ob3B0aW9ucyl7cmV0dXJuIF8uY2xvbmUodGhpcy5hdHRyaWJ1dGVzKX0sc3luYzpmdW5jdGlvbigpe3JldHVybiBCYWNrYm9uZS5zeW5jLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZ2V0OmZ1bmN0aW9uKGF0dHIpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cl19LGVzY2FwZTpmdW5jdGlvbihhdHRyKXtyZXR1cm4gXy5lc2NhcGUodGhpcy5nZXQoYXR0cikpfSxoYXM6ZnVuY3Rpb24oYXR0cil7cmV0dXJuIHRoaXMuZ2V0KGF0dHIpIT1udWxsfSxzZXQ6ZnVuY3Rpb24oa2V5LHZhbCxvcHRpb25zKXt2YXIgYXR0cixhdHRycyx1bnNldCxjaGFuZ2VzLHNpbGVudCxjaGFuZ2luZyxwcmV2LGN1cnJlbnQ7aWYoa2V5PT1udWxsKXJldHVybiB0aGlzO2lmKHR5cGVvZiBrZXk9PT0ib2JqZWN0Iil7YXR0cnM9a2V5O29wdGlvbnM9dmFsfWVsc2V7KGF0dHJzPXt9KVtrZXldPXZhbH1vcHRpb25zfHwob3B0aW9ucz17fSk7aWYoIXRoaXMuX3ZhbGlkYXRlKGF0dHJzLG9wdGlvbnMpKXJldHVybiBmYWxzZTt1bnNldD1vcHRpb25zLnVuc2V0O3NpbGVudD1vcHRpb25zLnNpbGVudDtjaGFuZ2VzPVtdO2NoYW5naW5nPXRoaXMuX2NoYW5naW5nO3RoaXMuX2NoYW5naW5nPXRydWU7aWYoIWNoYW5naW5nKXt0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM9Xy5jbG9uZSh0aGlzLmF0dHJpYnV0ZXMpO3RoaXMuY2hhbmdlZD17fX1jdXJyZW50PXRoaXMuYXR0cmlidXRlcyxwcmV2PXRoaXMuX3ByZXZpb3VzQXR0cmlidXRlcztpZih0aGlzLmlkQXR0cmlidXRlIGluIGF0dHJzKXRoaXMuaWQ9YXR0cnNbdGhpcy5pZEF0dHJpYnV0ZV07Zm9yKGF0dHIgaW4gYXR0cnMpe3ZhbD1hdHRyc1thdHRyXTtpZighXy5pc0VxdWFsKGN1cnJlbnRbYXR0cl0sdmFsKSljaGFuZ2VzLnB1c2goYXR0cik7aWYoIV8uaXNFcXVhbChwcmV2W2F0dHJdLHZhbCkpe3RoaXMuY2hhbmdlZFthdHRyXT12YWx9ZWxzZXtkZWxldGUgdGhpcy5jaGFuZ2VkW2F0dHJdfXVuc2V0P2RlbGV0ZSBjdXJyZW50W2F0dHJdOmN1cnJlbnRbYXR0cl09dmFsfWlmKCFzaWxlbnQpe2lmKGNoYW5nZXMubGVuZ3RoKXRoaXMuX3BlbmRpbmc9dHJ1ZTtmb3IodmFyIGk9MCxsPWNoYW5nZXMubGVuZ3RoO2k8bDtpKyspe3RoaXMudHJpZ2dlcigiY2hhbmdlOiIrY2hhbmdlc1tpXSx0aGlzLGN1cnJlbnRbY2hhbmdlc1tpXV0sb3B0aW9ucyl9fWlmKGNoYW5naW5nKXJldHVybiB0aGlzO2lmKCFzaWxlbnQpe3doaWxlKHRoaXMuX3BlbmRpbmcpe3RoaXMuX3BlbmRpbmc9ZmFsc2U7dGhpcy50cmlnZ2VyKCJjaGFuZ2UiLHRoaXMsb3B0aW9ucyl9fXRoaXMuX3BlbmRpbmc9ZmFsc2U7dGhpcy5fY2hhbmdpbmc9ZmFsc2U7cmV0dXJuIHRoaXN9LHVuc2V0OmZ1bmN0aW9uKGF0dHIsb3B0aW9ucyl7cmV0dXJuIHRoaXMuc2V0KGF0dHIsdm9pZCAwLF8uZXh0ZW5kKHt9LG9wdGlvbnMse3Vuc2V0OnRydWV9KSl9LGNsZWFyOmZ1bmN0aW9uKG9wdGlvbnMpe3ZhciBhdHRycz17fTtmb3IodmFyIGtleSBpbiB0aGlzLmF0dHJpYnV0ZXMpYXR0cnNba2V5XT12b2lkIDA7cmV0dXJuIHRoaXMuc2V0KGF0dHJzLF8uZXh0ZW5kKHt9LG9wdGlvbnMse3Vuc2V0OnRydWV9KSl9LGhhc0NoYW5nZWQ6ZnVuY3Rpb24oYXR0cil7aWYoYXR0cj09bnVsbClyZXR1cm4hXy5pc0VtcHR5KHRoaXMuY2hhbmdlZCk7cmV0dXJuIF8uaGFzKHRoaXMuY2hhbmdlZCxhdHRyKX0sY2hhbmdlZEF0dHJpYnV0ZXM6ZnVuY3Rpb24oZGlmZil7aWYoIWRpZmYpcmV0dXJuIHRoaXMuaGFzQ2hhbmdlZCgpP18uY2xvbmUodGhpcy5jaGFuZ2VkKTpmYWxzZTt2YXIgdmFsLGNoYW5nZWQ9ZmFsc2U7dmFyIG9sZD10aGlzLl9jaGFuZ2luZz90aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM6dGhpcy5hdHRyaWJ1dGVzO2Zvcih2YXIgYXR0ciBpbiBkaWZmKXtpZihfLmlzRXF1YWwob2xkW2F0dHJdLHZhbD1kaWZmW2F0dHJdKSljb250aW51ZTsoY2hhbmdlZHx8KGNoYW5nZWQ9e30pKVthdHRyXT12YWx9cmV0dXJuIGNoYW5nZWR9LHByZXZpb3VzOmZ1bmN0aW9uKGF0dHIpe2lmKGF0dHI9PW51bGx8fCF0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXMpcmV0dXJuIG51bGw7cmV0dXJuIHRoaXMuX3ByZXZpb3VzQXR0cmlidXRlc1thdHRyXX0scHJldmlvdXNBdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7cmV0dXJuIF8uY2xvbmUodGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzKX0sZmV0Y2g6ZnVuY3Rpb24ob3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307aWYob3B0aW9ucy5wYXJzZT09PXZvaWQgMClvcHRpb25zLnBhcnNlPXRydWU7dmFyIG1vZGVsPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihyZXNwKXtpZighbW9kZWwuc2V0KG1vZGVsLnBhcnNlKHJlc3Asb3B0aW9ucyksb3B0aW9ucykpcmV0dXJuIGZhbHNlO2lmKHN1Y2Nlc3Mpc3VjY2Vzcyhtb2RlbCxyZXNwLG9wdGlvbnMpO21vZGVsLnRyaWdnZXIoInN5bmMiLG1vZGVsLHJlc3Asb3B0aW9ucyl9O3dyYXBFcnJvcih0aGlzLG9wdGlvbnMpO3JldHVybiB0aGlzLnN5bmMoInJlYWQiLHRoaXMsb3B0aW9ucyl9LHNhdmU6ZnVuY3Rpb24oa2V5LHZhbCxvcHRpb25zKXt2YXIgYXR0cnMsbWV0aG9kLHhocixhdHRyaWJ1dGVzPXRoaXMuYXR0cmlidXRlcztpZihrZXk9PW51bGx8fHR5cGVvZiBrZXk9PT0ib2JqZWN0Iil7YXR0cnM9a2V5O29wdGlvbnM9dmFsfWVsc2V7KGF0dHJzPXt9KVtrZXldPXZhbH1pZihhdHRycyYmKCFvcHRpb25zfHwhb3B0aW9ucy53YWl0KSYmIXRoaXMuc2V0KGF0dHJzLG9wdGlvbnMpKXJldHVybiBmYWxzZTtvcHRpb25zPV8uZXh0ZW5kKHt2YWxpZGF0ZTp0cnVlfSxvcHRpb25zKTtpZighdGhpcy5fdmFsaWRhdGUoYXR0cnMsb3B0aW9ucykpcmV0dXJuIGZhbHNlO2lmKGF0dHJzJiZvcHRpb25zLndhaXQpe3RoaXMuYXR0cmlidXRlcz1fLmV4dGVuZCh7fSxhdHRyaWJ1dGVzLGF0dHJzKX1pZihvcHRpb25zLnBhcnNlPT09dm9pZCAwKW9wdGlvbnMucGFyc2U9dHJ1ZTt2YXIgbW9kZWw9dGhpczt2YXIgc3VjY2Vzcz1vcHRpb25zLnN1Y2Nlc3M7b3B0aW9ucy5zdWNjZXNzPWZ1bmN0aW9uKHJlc3Ape21vZGVsLmF0dHJpYnV0ZXM9YXR0cmlidXRlczt2YXIgc2VydmVyQXR0cnM9bW9kZWwucGFyc2UocmVzcCxvcHRpb25zKTtpZihvcHRpb25zLndhaXQpc2VydmVyQXR0cnM9Xy5leHRlbmQoYXR0cnN8fHt9LHNlcnZlckF0dHJzKTtpZihfLmlzT2JqZWN0KHNlcnZlckF0dHJzKSYmIW1vZGVsLnNldChzZXJ2ZXJBdHRycyxvcHRpb25zKSl7cmV0dXJuIGZhbHNlfWlmKHN1Y2Nlc3Mpc3VjY2Vzcyhtb2RlbCxyZXNwLG9wdGlvbnMpO21vZGVsLnRyaWdnZXIoInN5bmMiLG1vZGVsLHJlc3Asb3B0aW9ucyl9O3dyYXBFcnJvcih0aGlzLG9wdGlvbnMpO21ldGhvZD10aGlzLmlzTmV3KCk/ImNyZWF0ZSI6b3B0aW9ucy5wYXRjaD8icGF0Y2giOiJ1cGRhdGUiO2lmKG1ldGhvZD09PSJwYXRjaCIpb3B0aW9ucy5hdHRycz1hdHRyczt4aHI9dGhpcy5zeW5jKG1ldGhvZCx0aGlzLG9wdGlvbnMpO2lmKGF0dHJzJiZvcHRpb25zLndhaXQpdGhpcy5hdHRyaWJ1dGVzPWF0dHJpYnV0ZXM7cmV0dXJuIHhocn0sZGVzdHJveTpmdW5jdGlvbihvcHRpb25zKXtvcHRpb25zPW9wdGlvbnM/Xy5jbG9uZShvcHRpb25zKTp7fTt2YXIgbW9kZWw9dGhpczt2YXIgc3VjY2Vzcz1vcHRpb25zLnN1Y2Nlc3M7dmFyIGRlc3Ryb3k9ZnVuY3Rpb24oKXttb2RlbC50cmlnZ2VyKCJkZXN0cm95Iixtb2RlbCxtb2RlbC5jb2xsZWN0aW9uLG9wdGlvbnMpfTtvcHRpb25zLnN1Y2Nlc3M9ZnVuY3Rpb24ocmVzcCl7aWYob3B0aW9ucy53YWl0fHxtb2RlbC5pc05ldygpKWRlc3Ryb3koKTtpZihzdWNjZXNzKXN1Y2Nlc3MobW9kZWwscmVzcCxvcHRpb25zKTtpZighbW9kZWwuaXNOZXcoKSltb2RlbC50cmlnZ2VyKCJzeW5jIixtb2RlbCxyZXNwLG9wdGlvbnMpfTtpZih0aGlzLmlzTmV3KCkpe29wdGlvbnMuc3VjY2VzcygpO3JldHVybiBmYWxzZX13cmFwRXJyb3IodGhpcyxvcHRpb25zKTt2YXIgeGhyPXRoaXMuc3luYygiZGVsZXRlIix0aGlzLG9wdGlvbnMpO2lmKCFvcHRpb25zLndhaXQpZGVzdHJveSgpO3JldHVybiB4aHJ9LHVybDpmdW5jdGlvbigpe3ZhciBiYXNlPV8ucmVzdWx0KHRoaXMsInVybFJvb3QiKXx8Xy5yZXN1bHQodGhpcy5jb2xsZWN0aW9uLCJ1cmwiKXx8dXJsRXJyb3IoKTtpZih0aGlzLmlzTmV3KCkpcmV0dXJuIGJhc2U7cmV0dXJuIGJhc2UrKGJhc2UuY2hhckF0KGJhc2UubGVuZ3RoLTEpPT09Ii8iPyIiOiIvIikrZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuaWQpfSxwYXJzZTpmdW5jdGlvbihyZXNwLG9wdGlvbnMpe3JldHVybiByZXNwfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLmF0dHJpYnV0ZXMpfSxpc05ldzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlkPT1udWxsfSxpc1ZhbGlkOmZ1bmN0aW9uKG9wdGlvbnMpe3JldHVybiB0aGlzLl92YWxpZGF0ZSh7fSxfLmV4dGVuZChvcHRpb25zfHx7fSx7dmFsaWRhdGU6dHJ1ZX0pKX0sX3ZhbGlkYXRlOmZ1bmN0aW9uKGF0dHJzLG9wdGlvbnMpe2lmKCFvcHRpb25zLnZhbGlkYXRlfHwhdGhpcy52YWxpZGF0ZSlyZXR1cm4gdHJ1ZTthdHRycz1fLmV4dGVuZCh7fSx0aGlzLmF0dHJpYnV0ZXMsYXR0cnMpO3ZhciBlcnJvcj10aGlzLnZhbGlkYXRpb25FcnJvcj10aGlzLnZhbGlkYXRlKGF0dHJzLG9wdGlvbnMpfHxudWxsO2lmKCFlcnJvcilyZXR1cm4gdHJ1ZTt0aGlzLnRyaWdnZXIoImludmFsaWQiLHRoaXMsZXJyb3IsXy5leHRlbmQob3B0aW9uc3x8e30se3ZhbGlkYXRpb25FcnJvcjplcnJvcn0pKTtyZXR1cm4gZmFsc2V9fSk7dmFyIG1vZGVsTWV0aG9kcz1bImtleXMiLCJ2YWx1ZXMiLCJwYWlycyIsImludmVydCIsInBpY2siLCJvbWl0Il07Xy5lYWNoKG1vZGVsTWV0aG9kcyxmdW5jdGlvbihtZXRob2Qpe01vZGVsLnByb3RvdHlwZVttZXRob2RdPWZ1bmN0aW9uKCl7dmFyIGFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMpO2FyZ3MudW5zaGlmdCh0aGlzLmF0dHJpYnV0ZXMpO3JldHVybiBfW21ldGhvZF0uYXBwbHkoXyxhcmdzKX19KTt2YXIgQ29sbGVjdGlvbj1CYWNrYm9uZS5Db2xsZWN0aW9uPWZ1bmN0aW9uKG1vZGVscyxvcHRpb25zKXtvcHRpb25zfHwob3B0aW9ucz17fSk7aWYob3B0aW9ucy51cmwpdGhpcy51cmw9b3B0aW9ucy51cmw7aWYob3B0aW9ucy5tb2RlbCl0aGlzLm1vZGVsPW9wdGlvbnMubW9kZWw7aWYob3B0aW9ucy5jb21wYXJhdG9yIT09dm9pZCAwKXRoaXMuY29tcGFyYXRvcj1vcHRpb25zLmNvbXBhcmF0b3I7dGhpcy5fcmVzZXQoKTt0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKG1vZGVscyl0aGlzLnJlc2V0KG1vZGVscyxfLmV4dGVuZCh7c2lsZW50OnRydWV9LG9wdGlvbnMpKX07dmFyIHNldE9wdGlvbnM9e2FkZDp0cnVlLHJlbW92ZTp0cnVlLG1lcmdlOnRydWV9O3ZhciBhZGRPcHRpb25zPXthZGQ6dHJ1ZSxtZXJnZTpmYWxzZSxyZW1vdmU6ZmFsc2V9O18uZXh0ZW5kKENvbGxlY3Rpb24ucHJvdG90eXBlLEV2ZW50cyx7bW9kZWw6TW9kZWwsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sdG9KU09OOmZ1bmN0aW9uKG9wdGlvbnMpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbihtb2RlbCl7cmV0dXJuIG1vZGVsLnRvSlNPTihvcHRpb25zKX0pfSxzeW5jOmZ1bmN0aW9uKCl7cmV0dXJuIEJhY2tib25lLnN5bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxhZGQ6ZnVuY3Rpb24obW9kZWxzLG9wdGlvbnMpe3JldHVybiB0aGlzLnNldChtb2RlbHMsXy5kZWZhdWx0cyhvcHRpb25zfHx7fSxhZGRPcHRpb25zKSl9LHJlbW92ZTpmdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7bW9kZWxzPV8uaXNBcnJheShtb2RlbHMpP21vZGVscy5zbGljZSgpOlttb2RlbHNdO29wdGlvbnN8fChvcHRpb25zPXt9KTt2YXIgaSxsLGluZGV4LG1vZGVsO2ZvcihpPTAsbD1tb2RlbHMubGVuZ3RoO2k8bDtpKyspe21vZGVsPXRoaXMuZ2V0KG1vZGVsc1tpXSk7aWYoIW1vZGVsKWNvbnRpbnVlO2RlbGV0ZSB0aGlzLl9ieUlkW21vZGVsLmlkXTtkZWxldGUgdGhpcy5fYnlJZFttb2RlbC5jaWRdO2luZGV4PXRoaXMuaW5kZXhPZihtb2RlbCk7dGhpcy5tb2RlbHMuc3BsaWNlKGluZGV4LDEpO3RoaXMubGVuZ3RoLS07aWYoIW9wdGlvbnMuc2lsZW50KXtvcHRpb25zLmluZGV4PWluZGV4O21vZGVsLnRyaWdnZXIoInJlbW92ZSIsbW9kZWwsdGhpcyxvcHRpb25zKX10aGlzLl9yZW1vdmVSZWZlcmVuY2UobW9kZWwpfXJldHVybiB0aGlzfSxzZXQ6ZnVuY3Rpb24obW9kZWxzLG9wdGlvbnMpe29wdGlvbnM9Xy5kZWZhdWx0cyhvcHRpb25zfHx7fSxzZXRPcHRpb25zKTtpZihvcHRpb25zLnBhcnNlKW1vZGVscz10aGlzLnBhcnNlKG1vZGVscyxvcHRpb25zKTtpZighXy5pc0FycmF5KG1vZGVscykpbW9kZWxzPW1vZGVscz9bbW9kZWxzXTpbXTt2YXIgaSxsLG1vZGVsLGF0dHJzLGV4aXN0aW5nLHNvcnQ7dmFyIGF0PW9wdGlvbnMuYXQ7dmFyIHNvcnRhYmxlPXRoaXMuY29tcGFyYXRvciYmYXQ9PW51bGwmJm9wdGlvbnMuc29ydCE9PWZhbHNlO3ZhciBzb3J0QXR0cj1fLmlzU3RyaW5nKHRoaXMuY29tcGFyYXRvcik/dGhpcy5jb21wYXJhdG9yOm51bGw7dmFyIHRvQWRkPVtdLHRvUmVtb3ZlPVtdLG1vZGVsTWFwPXt9O2ZvcihpPTAsbD1tb2RlbHMubGVuZ3RoO2k8bDtpKyspe2lmKCEobW9kZWw9dGhpcy5fcHJlcGFyZU1vZGVsKG1vZGVsc1tpXSxvcHRpb25zKSkpY29udGludWU7aWYoZXhpc3Rpbmc9dGhpcy5nZXQobW9kZWwpKXtpZihvcHRpb25zLnJlbW92ZSltb2RlbE1hcFtleGlzdGluZy5jaWRdPXRydWU7aWYob3B0aW9ucy5tZXJnZSl7ZXhpc3Rpbmcuc2V0KG1vZGVsLmF0dHJpYnV0ZXMsb3B0aW9ucyk7aWYoc29ydGFibGUmJiFzb3J0JiZleGlzdGluZy5oYXNDaGFuZ2VkKHNvcnRBdHRyKSlzb3J0PXRydWV9fWVsc2UgaWYob3B0aW9ucy5hZGQpe3RvQWRkLnB1c2gobW9kZWwpO21vZGVsLm9uKCJhbGwiLHRoaXMuX29uTW9kZWxFdmVudCx0aGlzKTt0aGlzLl9ieUlkW21vZGVsLmNpZF09bW9kZWw7aWYobW9kZWwuaWQhPW51bGwpdGhpcy5fYnlJZFttb2RlbC5pZF09bW9kZWx9fWlmKG9wdGlvbnMucmVtb3ZlKXtmb3IoaT0wLGw9dGhpcy5sZW5ndGg7aTxsOysraSl7aWYoIW1vZGVsTWFwWyhtb2RlbD10aGlzLm1vZGVsc1tpXSkuY2lkXSl0b1JlbW92ZS5wdXNoKG1vZGVsKX1pZih0b1JlbW92ZS5sZW5ndGgpdGhpcy5yZW1vdmUodG9SZW1vdmUsb3B0aW9ucyl9aWYodG9BZGQubGVuZ3RoKXtpZihzb3J0YWJsZSlzb3J0PXRydWU7dGhpcy5sZW5ndGgrPXRvQWRkLmxlbmd0aDtpZihhdCE9bnVsbCl7c3BsaWNlLmFwcGx5KHRoaXMubW9kZWxzLFthdCwwXS5jb25jYXQodG9BZGQpKX1lbHNle3B1c2guYXBwbHkodGhpcy5tb2RlbHMsdG9BZGQpfX1pZihzb3J0KXRoaXMuc29ydCh7c2lsZW50OnRydWV9KTtpZihvcHRpb25zLnNpbGVudClyZXR1cm4gdGhpcztmb3IoaT0wLGw9dG9BZGQubGVuZ3RoO2k8bDtpKyspeyhtb2RlbD10b0FkZFtpXSkudHJpZ2dlcigiYWRkIixtb2RlbCx0aGlzLG9wdGlvbnMpfWlmKHNvcnQpdGhpcy50cmlnZ2VyKCJzb3J0Iix0aGlzLG9wdGlvbnMpO3JldHVybiB0aGlzfSxyZXNldDpmdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7b3B0aW9uc3x8KG9wdGlvbnM9e30pO2Zvcih2YXIgaT0wLGw9dGhpcy5tb2RlbHMubGVuZ3RoO2k8bDtpKyspe3RoaXMuX3JlbW92ZVJlZmVyZW5jZSh0aGlzLm1vZGVsc1tpXSl9b3B0aW9ucy5wcmV2aW91c01vZGVscz10aGlzLm1vZGVsczt0aGlzLl9yZXNldCgpO3RoaXMuYWRkKG1vZGVscyxfLmV4dGVuZCh7c2lsZW50OnRydWV9LG9wdGlvbnMpKTtpZighb3B0aW9ucy5zaWxlbnQpdGhpcy50cmlnZ2VyKCJyZXNldCIsdGhpcyxvcHRpb25zKTtyZXR1cm4gdGhpc30scHVzaDpmdW5jdGlvbihtb2RlbCxvcHRpb25zKXttb2RlbD10aGlzLl9wcmVwYXJlTW9kZWwobW9kZWwsb3B0aW9ucyk7dGhpcy5hZGQobW9kZWwsXy5leHRlbmQoe2F0OnRoaXMubGVuZ3RofSxvcHRpb25zKSk7cmV0dXJuIG1vZGVsfSxwb3A6ZnVuY3Rpb24ob3B0aW9ucyl7dmFyIG1vZGVsPXRoaXMuYXQodGhpcy5sZW5ndGgtMSk7dGhpcy5yZW1vdmUobW9kZWwsb3B0aW9ucyk7cmV0dXJuIG1vZGVsfSx1bnNoaWZ0OmZ1bmN0aW9uKG1vZGVsLG9wdGlvbnMpe21vZGVsPXRoaXMuX3ByZXBhcmVNb2RlbChtb2RlbCxvcHRpb25zKTt0aGlzLmFkZChtb2RlbCxfLmV4dGVuZCh7YXQ6MH0sb3B0aW9ucykpO3JldHVybiBtb2RlbH0sc2hpZnQ6ZnVuY3Rpb24ob3B0aW9ucyl7dmFyIG1vZGVsPXRoaXMuYXQoMCk7dGhpcy5yZW1vdmUobW9kZWwsb3B0aW9ucyk7cmV0dXJuIG1vZGVsfSxzbGljZTpmdW5jdGlvbihiZWdpbixlbmQpe3JldHVybiB0aGlzLm1vZGVscy5zbGljZShiZWdpbixlbmQpfSxnZXQ6ZnVuY3Rpb24ob2JqKXtpZihvYmo9PW51bGwpcmV0dXJuIHZvaWQgMDtyZXR1cm4gdGhpcy5fYnlJZFtvYmouaWQhPW51bGw/b2JqLmlkOm9iai5jaWR8fG9ial19LGF0OmZ1bmN0aW9uKGluZGV4KXtyZXR1cm4gdGhpcy5tb2RlbHNbaW5kZXhdfSx3aGVyZTpmdW5jdGlvbihhdHRycyxmaXJzdCl7aWYoXy5pc0VtcHR5KGF0dHJzKSlyZXR1cm4gZmlyc3Q/dm9pZCAwOltdO3JldHVybiB0aGlzW2ZpcnN0PyJmaW5kIjoiZmlsdGVyIl0oZnVuY3Rpb24obW9kZWwpe2Zvcih2YXIga2V5IGluIGF0dHJzKXtpZihhdHRyc1trZXldIT09bW9kZWwuZ2V0KGtleSkpcmV0dXJuIGZhbHNlfXJldHVybiB0cnVlfSl9LGZpbmRXaGVyZTpmdW5jdGlvbihhdHRycyl7cmV0dXJuIHRoaXMud2hlcmUoYXR0cnMsdHJ1ZSl9LHNvcnQ6ZnVuY3Rpb24ob3B0aW9ucyl7aWYoIXRoaXMuY29tcGFyYXRvcil0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBzb3J0IGEgc2V0IHdpdGhvdXQgYSBjb21wYXJhdG9yIik7b3B0aW9uc3x8KG9wdGlvbnM9e30pO2lmKF8uaXNTdHJpbmcodGhpcy5jb21wYXJhdG9yKXx8dGhpcy5jb21wYXJhdG9yLmxlbmd0aD09PTEpe3RoaXMubW9kZWxzPXRoaXMuc29ydEJ5KHRoaXMuY29tcGFyYXRvcix0aGlzKX1lbHNle3RoaXMubW9kZWxzLnNvcnQoXy5iaW5kKHRoaXMuY29tcGFyYXRvcix0aGlzKSl9aWYoIW9wdGlvbnMuc2lsZW50KXRoaXMudHJpZ2dlcigic29ydCIsdGhpcyxvcHRpb25zKTtyZXR1cm4gdGhpc30sc29ydGVkSW5kZXg6ZnVuY3Rpb24obW9kZWwsdmFsdWUsY29udGV4dCl7dmFsdWV8fCh2YWx1ZT10aGlzLmNvbXBhcmF0b3IpO3ZhciBpdGVyYXRvcj1fLmlzRnVuY3Rpb24odmFsdWUpP3ZhbHVlOmZ1bmN0aW9uKG1vZGVsKXtyZXR1cm4gbW9kZWwuZ2V0KHZhbHVlKX07cmV0dXJuIF8uc29ydGVkSW5kZXgodGhpcy5tb2RlbHMsbW9kZWwsaXRlcmF0b3IsY29udGV4dCl9LHBsdWNrOmZ1bmN0aW9uKGF0dHIpe3JldHVybiBfLmludm9rZSh0aGlzLm1vZGVscywiZ2V0IixhdHRyKX0sZmV0Y2g6ZnVuY3Rpb24ob3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307aWYob3B0aW9ucy5wYXJzZT09PXZvaWQgMClvcHRpb25zLnBhcnNlPXRydWU7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO3ZhciBjb2xsZWN0aW9uPXRoaXM7b3B0aW9ucy5zdWNjZXNzPWZ1bmN0aW9uKHJlc3Ape3ZhciBtZXRob2Q9b3B0aW9ucy5yZXNldD8icmVzZXQiOiJzZXQiO2NvbGxlY3Rpb25bbWV0aG9kXShyZXNwLG9wdGlvbnMpO2lmKHN1Y2Nlc3Mpc3VjY2Vzcyhjb2xsZWN0aW9uLHJlc3Asb3B0aW9ucyk7Y29sbGVjdGlvbi50cmlnZ2VyKCJzeW5jIixjb2xsZWN0aW9uLHJlc3Asb3B0aW9ucyl9O3dyYXBFcnJvcih0aGlzLG9wdGlvbnMpO3JldHVybiB0aGlzLnN5bmMoInJlYWQiLHRoaXMsb3B0aW9ucyl9LGNyZWF0ZTpmdW5jdGlvbihtb2RlbCxvcHRpb25zKXtvcHRpb25zPW9wdGlvbnM/Xy5jbG9uZShvcHRpb25zKTp7fTtpZighKG1vZGVsPXRoaXMuX3ByZXBhcmVNb2RlbChtb2RlbCxvcHRpb25zKSkpcmV0dXJuIGZhbHNlO2lmKCFvcHRpb25zLndhaXQpdGhpcy5hZGQobW9kZWwsb3B0aW9ucyk7dmFyIGNvbGxlY3Rpb249dGhpczt2YXIgc3VjY2Vzcz1vcHRpb25zLnN1Y2Nlc3M7b3B0aW9ucy5zdWNjZXNzPWZ1bmN0aW9uKHJlc3Ape2lmKG9wdGlvbnMud2FpdCljb2xsZWN0aW9uLmFkZChtb2RlbCxvcHRpb25zKTtpZihzdWNjZXNzKXN1Y2Nlc3MobW9kZWwscmVzcCxvcHRpb25zKX07bW9kZWwuc2F2ZShudWxsLG9wdGlvbnMpO3JldHVybiBtb2RlbH0scGFyc2U6ZnVuY3Rpb24ocmVzcCxvcHRpb25zKXtyZXR1cm4gcmVzcH0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5tb2RlbHMpfSxfcmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLmxlbmd0aD0wO3RoaXMubW9kZWxzPVtdO3RoaXMuX2J5SWQ9e319LF9wcmVwYXJlTW9kZWw6ZnVuY3Rpb24oYXR0cnMsb3B0aW9ucyl7aWYoYXR0cnMgaW5zdGFuY2VvZiBNb2RlbCl7aWYoIWF0dHJzLmNvbGxlY3Rpb24pYXR0cnMuY29sbGVjdGlvbj10aGlzO3JldHVybiBhdHRyc31vcHRpb25zfHwob3B0aW9ucz17fSk7b3B0aW9ucy5jb2xsZWN0aW9uPXRoaXM7dmFyIG1vZGVsPW5ldyB0aGlzLm1vZGVsKGF0dHJzLG9wdGlvbnMpO2lmKCFtb2RlbC5fdmFsaWRhdGUoYXR0cnMsb3B0aW9ucykpe3RoaXMudHJpZ2dlcigiaW52YWxpZCIsdGhpcyxhdHRycyxvcHRpb25zKTtyZXR1cm4gZmFsc2V9cmV0dXJuIG1vZGVsfSxfcmVtb3ZlUmVmZXJlbmNlOmZ1bmN0aW9uKG1vZGVsKXtpZih0aGlzPT09bW9kZWwuY29sbGVjdGlvbilkZWxldGUgbW9kZWwuY29sbGVjdGlvbjttb2RlbC5vZmYoImFsbCIsdGhpcy5fb25Nb2RlbEV2ZW50LHRoaXMpfSxfb25Nb2RlbEV2ZW50OmZ1bmN0aW9uKGV2ZW50LG1vZGVsLGNvbGxlY3Rpb24sb3B0aW9ucyl7aWYoKGV2ZW50PT09ImFkZCJ8fGV2ZW50PT09InJlbW92ZSIpJiZjb2xsZWN0aW9uIT09dGhpcylyZXR1cm47aWYoZXZlbnQ9PT0iZGVzdHJveSIpdGhpcy5yZW1vdmUobW9kZWwsb3B0aW9ucyk7aWYobW9kZWwmJmV2ZW50PT09ImNoYW5nZToiK21vZGVsLmlkQXR0cmlidXRlKXtkZWxldGUgdGhpcy5fYnlJZFttb2RlbC5wcmV2aW91cyhtb2RlbC5pZEF0dHJpYnV0ZSldO2lmKG1vZGVsLmlkIT1udWxsKXRoaXMuX2J5SWRbbW9kZWwuaWRdPW1vZGVsfXRoaXMudHJpZ2dlci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSk7dmFyIG1ldGhvZHM9WyJmb3JFYWNoIiwiZWFjaCIsIm1hcCIsImNvbGxlY3QiLCJyZWR1Y2UiLCJmb2xkbCIsImluamVjdCIsInJlZHVjZVJpZ2h0IiwiZm9sZHIiLCJmaW5kIiwiZGV0ZWN0IiwiZmlsdGVyIiwic2VsZWN0IiwicmVqZWN0IiwiZXZlcnkiLCJhbGwiLCJzb21lIiwiYW55IiwiaW5jbHVkZSIsImNvbnRhaW5zIiwiaW52b2tlIiwibWF4IiwibWluIiwidG9BcnJheSIsInNpemUiLCJmaXJzdCIsImhlYWQiLCJ0YWtlIiwiaW5pdGlhbCIsInJlc3QiLCJ0YWlsIiwiZHJvcCIsImxhc3QiLCJ3aXRob3V0IiwiaW5kZXhPZiIsInNodWZmbGUiLCJsYXN0SW5kZXhPZiIsImlzRW1wdHkiLCJjaGFpbiJdO18uZWFjaChtZXRob2RzLGZ1bmN0aW9uKG1ldGhvZCl7Q29sbGVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXT1mdW5jdGlvbigpe3ZhciBhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzKTthcmdzLnVuc2hpZnQodGhpcy5tb2RlbHMpO3JldHVybiBfW21ldGhvZF0uYXBwbHkoXyxhcmdzKX19KTt2YXIgYXR0cmlidXRlTWV0aG9kcz1bImdyb3VwQnkiLCJjb3VudEJ5Iiwic29ydEJ5Il07Xy5lYWNoKGF0dHJpYnV0ZU1ldGhvZHMsZnVuY3Rpb24obWV0aG9kKXtDb2xsZWN0aW9uLnByb3RvdHlwZVttZXRob2RdPWZ1bmN0aW9uKHZhbHVlLGNvbnRleHQpe3ZhciBpdGVyYXRvcj1fLmlzRnVuY3Rpb24odmFsdWUpP3ZhbHVlOmZ1bmN0aW9uKG1vZGVsKXtyZXR1cm4gbW9kZWwuZ2V0KHZhbHVlKX07cmV0dXJuIF9bbWV0aG9kXSh0aGlzLm1vZGVscyxpdGVyYXRvcixjb250ZXh0KX19KTt2YXIgVmlldz1CYWNrYm9uZS5WaWV3PWZ1bmN0aW9uKG9wdGlvbnMpe3RoaXMuY2lkPV8udW5pcXVlSWQoInZpZXciKTt0aGlzLl9jb25maWd1cmUob3B0aW9uc3x8e30pO3RoaXMuX2Vuc3VyZUVsZW1lbnQoKTt0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuZGVsZWdhdGVFdmVudHMoKX07dmFyIGRlbGVnYXRlRXZlbnRTcGxpdHRlcj0vXihcUyspXHMqKC4qKSQvO3ZhciB2aWV3T3B0aW9ucz1bIm1vZGVsIiwiY29sbGVjdGlvbiIsImVsIiwiaWQiLCJhdHRyaWJ1dGVzIiwiY2xhc3NOYW1lIiwidGFnTmFtZSIsImV2ZW50cyJdO18uZXh0ZW5kKFZpZXcucHJvdG90eXBlLEV2ZW50cyx7dGFnTmFtZToiZGl2IiwkOmZ1bmN0aW9uKHNlbGVjdG9yKXtyZXR1cm4gdGhpcy4kZWwuZmluZChzZWxlY3Rvcil9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt9LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXt0aGlzLiRlbC5yZW1vdmUoKTt0aGlzLnN0b3BMaXN0ZW5pbmcoKTtyZXR1cm4gdGhpc30sc2V0RWxlbWVudDpmdW5jdGlvbihlbGVtZW50LGRlbGVnYXRlKXtpZih0aGlzLiRlbCl0aGlzLnVuZGVsZWdhdGVFdmVudHMoKTt0aGlzLiRlbD1lbGVtZW50IGluc3RhbmNlb2YgQmFja2JvbmUuJD9lbGVtZW50OkJhY2tib25lLiQoZWxlbWVudCk7dGhpcy5lbD10aGlzLiRlbFswXTtpZihkZWxlZ2F0ZSE9PWZhbHNlKXRoaXMuZGVsZWdhdGVFdmVudHMoKTtyZXR1cm4gdGhpc30sZGVsZWdhdGVFdmVudHM6ZnVuY3Rpb24oZXZlbnRzKXtpZighKGV2ZW50c3x8KGV2ZW50cz1fLnJlc3VsdCh0aGlzLCJldmVudHMiKSkpKXJldHVybiB0aGlzO3RoaXMudW5kZWxlZ2F0ZUV2ZW50cygpO2Zvcih2YXIga2V5IGluIGV2ZW50cyl7dmFyIG1ldGhvZD1ldmVudHNba2V5XTtpZighXy5pc0Z1bmN0aW9uKG1ldGhvZCkpbWV0aG9kPXRoaXNbZXZlbnRzW2tleV1dO2lmKCFtZXRob2QpY29udGludWU7dmFyIG1hdGNoPWtleS5tYXRjaChkZWxlZ2F0ZUV2ZW50U3BsaXR0ZXIpO3ZhciBldmVudE5hbWU9bWF0Y2hbMV0sc2VsZWN0b3I9bWF0Y2hbMl07bWV0aG9kPV8uYmluZChtZXRob2QsdGhpcyk7ZXZlbnROYW1lKz0iLmRlbGVnYXRlRXZlbnRzIit0aGlzLmNpZDtpZihzZWxlY3Rvcj09PSIiKXt0aGlzLiRlbC5vbihldmVudE5hbWUsbWV0aG9kKX1lbHNle3RoaXMuJGVsLm9uKGV2ZW50TmFtZSxzZWxlY3RvcixtZXRob2QpfX1yZXR1cm4gdGhpc30sdW5kZWxlZ2F0ZUV2ZW50czpmdW5jdGlvbigpe3RoaXMuJGVsLm9mZigiLmRlbGVnYXRlRXZlbnRzIit0aGlzLmNpZCk7cmV0dXJuIHRoaXN9LF9jb25maWd1cmU6ZnVuY3Rpb24ob3B0aW9ucyl7aWYodGhpcy5vcHRpb25zKW9wdGlvbnM9Xy5leHRlbmQoe30sXy5yZXN1bHQodGhpcywib3B0aW9ucyIpLG9wdGlvbnMpO18uZXh0ZW5kKHRoaXMsXy5waWNrKG9wdGlvbnMsdmlld09wdGlvbnMpKTt0aGlzLm9wdGlvbnM9b3B0aW9uc30sX2Vuc3VyZUVsZW1lbnQ6ZnVuY3Rpb24oKXtpZighdGhpcy5lbCl7dmFyIGF0dHJzPV8uZXh0ZW5kKHt9LF8ucmVzdWx0KHRoaXMsImF0dHJpYnV0ZXMiKSk7aWYodGhpcy5pZClhdHRycy5pZD1fLnJlc3VsdCh0aGlzLCJpZCIpO2lmKHRoaXMuY2xhc3NOYW1lKWF0dHJzWyJjbGFzcyJdPV8ucmVzdWx0KHRoaXMsImNsYXNzTmFtZSIpO3ZhciAkZWw9QmFja2JvbmUuJCgiPCIrXy5yZXN1bHQodGhpcywidGFnTmFtZSIpKyI+IikuYXR0cihhdHRycyk7dGhpcy5zZXRFbGVtZW50KCRlbCxmYWxzZSl9ZWxzZXt0aGlzLnNldEVsZW1lbnQoXy5yZXN1bHQodGhpcywiZWwiKSxmYWxzZSl9fX0pO0JhY2tib25lLnN5bmM9ZnVuY3Rpb24obWV0aG9kLG1vZGVsLG9wdGlvbnMpe3ZhciB0eXBlPW1ldGhvZE1hcFttZXRob2RdO18uZGVmYXVsdHMob3B0aW9uc3x8KG9wdGlvbnM9e30pLHtlbXVsYXRlSFRUUDpCYWNrYm9uZS5lbXVsYXRlSFRUUCxlbXVsYXRlSlNPTjpCYWNrYm9uZS5lbXVsYXRlSlNPTn0pO3ZhciBwYXJhbXM9e3R5cGU6dHlwZSxkYXRhVHlwZToianNvbiJ9O2lmKCFvcHRpb25zLnVybCl7cGFyYW1zLnVybD1fLnJlc3VsdChtb2RlbCwidXJsIil8fHVybEVycm9yKCl9aWYob3B0aW9ucy5kYXRhPT1udWxsJiZtb2RlbCYmKG1ldGhvZD09PSJjcmVhdGUifHxtZXRob2Q9PT0idXBkYXRlInx8bWV0aG9kPT09InBhdGNoIikpe3BhcmFtcy5jb250ZW50VHlwZT0iYXBwbGljYXRpb24vanNvbiI7cGFyYW1zLmRhdGE9SlNPTi5zdHJpbmdpZnkob3B0aW9ucy5hdHRyc3x8bW9kZWwudG9KU09OKG9wdGlvbnMpKX1pZihvcHRpb25zLmVtdWxhdGVKU09OKXtwYXJhbXMuY29udGVudFR5cGU9ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCI7cGFyYW1zLmRhdGE9cGFyYW1zLmRhdGE/e21vZGVsOnBhcmFtcy5kYXRhfTp7fX1pZihvcHRpb25zLmVtdWxhdGVIVFRQJiYodHlwZT09PSJQVVQifHx0eXBlPT09IkRFTEVURSJ8fHR5cGU9PT0iUEFUQ0giKSl7cGFyYW1zLnR5cGU9IlBPU1QiO2lmKG9wdGlvbnMuZW11bGF0ZUpTT04pcGFyYW1zLmRhdGEuX21ldGhvZD10eXBlO3ZhciBiZWZvcmVTZW5kPW9wdGlvbnMuYmVmb3JlU2VuZDtvcHRpb25zLmJlZm9yZVNlbmQ9ZnVuY3Rpb24oeGhyKXt4aHIuc2V0UmVxdWVzdEhlYWRlcigiWC1IVFRQLU1ldGhvZC1PdmVycmlkZSIsdHlwZSk7aWYoYmVmb3JlU2VuZClyZXR1cm4gYmVmb3JlU2VuZC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fWlmKHBhcmFtcy50eXBlIT09IkdFVCImJiFvcHRpb25zLmVtdWxhdGVKU09OKXtwYXJhbXMucHJvY2Vzc0RhdGE9ZmFsc2V9aWYocGFyYW1zLnR5cGU9PT0iUEFUQ0giJiZ3aW5kb3cuQWN0aXZlWE9iamVjdCYmISh3aW5kb3cuZXh0ZXJuYWwmJndpbmRvdy5leHRlcm5hbC5tc0FjdGl2ZVhGaWx0ZXJpbmdFbmFibGVkKSl7cGFyYW1zLnhocj1mdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKX19dmFyIHhocj1vcHRpb25zLnhocj1CYWNrYm9uZS5hamF4KF8uZXh0ZW5kKHBhcmFtcyxvcHRpb25zKSk7bW9kZWwudHJpZ2dlcigicmVxdWVzdCIsbW9kZWwseGhyLG9wdGlvbnMpO3JldHVybiB4aHJ9O3ZhciBtZXRob2RNYXA9e2NyZWF0ZToiUE9TVCIsdXBkYXRlOiJQVVQiLHBhdGNoOiJQQVRDSCIsImRlbGV0ZSI6IkRFTEVURSIscmVhZDoiR0VUIn07QmFja2JvbmUuYWpheD1mdW5jdGlvbigpe3JldHVybiBCYWNrYm9uZS4kLmFqYXguYXBwbHkoQmFja2JvbmUuJCxhcmd1bWVudHMpfTt2YXIgUm91dGVyPUJhY2tib25lLlJvdXRlcj1mdW5jdGlvbihvcHRpb25zKXtvcHRpb25zfHwob3B0aW9ucz17fSk7aWYob3B0aW9ucy5yb3V0ZXMpdGhpcy5yb3V0ZXM9b3B0aW9ucy5yb3V0ZXM7dGhpcy5fYmluZFJvdXRlcygpO3RoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O3ZhciBvcHRpb25hbFBhcmFtPS9cKCguKj8pXCkvZzt2YXIgbmFtZWRQYXJhbT0vKFwoXD8pPzpcdysvZzt2YXIgc3BsYXRQYXJhbT0vXCpcdysvZzt2YXIgZXNjYXBlUmVnRXhwPS9bXC17fVxbXF0rPy4sXFxcXiR8I1xzXS9nO18uZXh0ZW5kKFJvdXRlci5wcm90b3R5cGUsRXZlbnRzLHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSxyb3V0ZTpmdW5jdGlvbihyb3V0ZSxuYW1lLGNhbGxiYWNrKXtpZighXy5pc1JlZ0V4cChyb3V0ZSkpcm91dGU9dGhpcy5fcm91dGVUb1JlZ0V4cChyb3V0ZSk7aWYoXy5pc0Z1bmN0aW9uKG5hbWUpKXtjYWxsYmFjaz1uYW1lO25hbWU9IiJ9aWYoIWNhbGxiYWNrKWNhbGxiYWNrPXRoaXNbbmFtZV07dmFyIHJvdXRlcj10aGlzO0JhY2tib25lLmhpc3Rvcnkucm91dGUocm91dGUsZnVuY3Rpb24oZnJhZ21lbnQpe3ZhciBhcmdzPXJvdXRlci5fZXh0cmFjdFBhcmFtZXRlcnMocm91dGUsZnJhZ21lbnQpO2NhbGxiYWNrJiZjYWxsYmFjay5hcHBseShyb3V0ZXIsYXJncyk7cm91dGVyLnRyaWdnZXIuYXBwbHkocm91dGVyLFsicm91dGU6IituYW1lXS5jb25jYXQoYXJncykpO3JvdXRlci50cmlnZ2VyKCJyb3V0ZSIsbmFtZSxhcmdzKTtCYWNrYm9uZS5oaXN0b3J5LnRyaWdnZXIoInJvdXRlIixyb3V0ZXIsbmFtZSxhcmdzKX0pO3JldHVybiB0aGlzfSxuYXZpZ2F0ZTpmdW5jdGlvbihmcmFnbWVudCxvcHRpb25zKXtCYWNrYm9uZS5oaXN0b3J5Lm5hdmlnYXRlKGZyYWdtZW50LG9wdGlvbnMpO3JldHVybiB0aGlzfSxfYmluZFJvdXRlczpmdW5jdGlvbigpe2lmKCF0aGlzLnJvdXRlcylyZXR1cm47dGhpcy5yb3V0ZXM9Xy5yZXN1bHQodGhpcywicm91dGVzIik7dmFyIHJvdXRlLHJvdXRlcz1fLmtleXModGhpcy5yb3V0ZXMpO3doaWxlKChyb3V0ZT1yb3V0ZXMucG9wKCkpIT1udWxsKXt0aGlzLnJvdXRlKHJvdXRlLHRoaXMucm91dGVzW3JvdXRlXSl9fSxfcm91dGVUb1JlZ0V4cDpmdW5jdGlvbihyb3V0ZSl7cm91dGU9cm91dGUucmVwbGFjZShlc2NhcGVSZWdFeHAsIlxcJCYiKS5yZXBsYWNlKG9wdGlvbmFsUGFyYW0sIig/OiQxKT8iKS5yZXBsYWNlKG5hbWVkUGFyYW0sZnVuY3Rpb24obWF0Y2gsb3B0aW9uYWwpe3JldHVybiBvcHRpb25hbD9tYXRjaDoiKFteL10rKSJ9KS5yZXBsYWNlKHNwbGF0UGFyYW0sIiguKj8pIik7cmV0dXJuIG5ldyBSZWdFeHAoIl4iK3JvdXRlKyIkIil9LF9leHRyYWN0UGFyYW1ldGVyczpmdW5jdGlvbihyb3V0ZSxmcmFnbWVudCl7dmFyIHBhcmFtcz1yb3V0ZS5leGVjKGZyYWdtZW50KS5zbGljZSgxKTtyZXR1cm4gXy5tYXAocGFyYW1zLGZ1bmN0aW9uKHBhcmFtKXtyZXR1cm4gcGFyYW0/ZGVjb2RlVVJJQ29tcG9uZW50KHBhcmFtKTpudWxsfSl9fSk7dmFyIEhpc3Rvcnk9QmFja2JvbmUuSGlzdG9yeT1mdW5jdGlvbigpe3RoaXMuaGFuZGxlcnM9W107Xy5iaW5kQWxsKHRoaXMsImNoZWNrVXJsIik7aWYodHlwZW9mIHdpbmRvdyE9PSJ1bmRlZmluZWQiKXt0aGlzLmxvY2F0aW9uPXdpbmRvdy5sb2NhdGlvbjt0aGlzLmhpc3Rvcnk9d2luZG93Lmhpc3Rvcnl9fTt2YXIgcm91dGVTdHJpcHBlcj0vXlsjXC9dfFxzKyQvZzt2YXIgcm9vdFN0cmlwcGVyPS9eXC8rfFwvKyQvZzt2YXIgaXNFeHBsb3Jlcj0vbXNpZSBbXHcuXSsvO3ZhciB0cmFpbGluZ1NsYXNoPS9cLyQvO0hpc3Rvcnkuc3RhcnRlZD1mYWxzZTtfLmV4dGVuZChIaXN0b3J5LnByb3RvdHlwZSxFdmVudHMse2ludGVydmFsOjUwLGdldEhhc2g6ZnVuY3Rpb24od2luZG93KXt2YXIgbWF0Y2g9KHdpbmRvd3x8dGhpcykubG9jYXRpb24uaHJlZi5tYXRjaCgvIyguKikkLyk7cmV0dXJuIG1hdGNoP21hdGNoWzFdOiIifSxnZXRGcmFnbWVudDpmdW5jdGlvbihmcmFnbWVudCxmb3JjZVB1c2hTdGF0ZSl7aWYoZnJhZ21lbnQ9PW51bGwpe2lmKHRoaXMuX2hhc1B1c2hTdGF0ZXx8IXRoaXMuX3dhbnRzSGFzaENoYW5nZXx8Zm9yY2VQdXNoU3RhdGUpe2ZyYWdtZW50PXRoaXMubG9jYXRpb24ucGF0aG5hbWU7dmFyIHJvb3Q9dGhpcy5yb290LnJlcGxhY2UodHJhaWxpbmdTbGFzaCwiIik7aWYoIWZyYWdtZW50LmluZGV4T2Yocm9vdCkpZnJhZ21lbnQ9ZnJhZ21lbnQuc3Vic3RyKHJvb3QubGVuZ3RoKX1lbHNle2ZyYWdtZW50PXRoaXMuZ2V0SGFzaCgpfX1yZXR1cm4gZnJhZ21lbnQucmVwbGFjZShyb3V0ZVN0cmlwcGVyLCIiKX0sc3RhcnQ6ZnVuY3Rpb24ob3B0aW9ucyl7aWYoSGlzdG9yeS5zdGFydGVkKXRocm93IG5ldyBFcnJvcigiQmFja2JvbmUuaGlzdG9yeSBoYXMgYWxyZWFkeSBiZWVuIHN0YXJ0ZWQiKTtIaXN0b3J5LnN0YXJ0ZWQ9dHJ1ZTt0aGlzLm9wdGlvbnM9Xy5leHRlbmQoe30se3Jvb3Q6Ii8ifSx0aGlzLm9wdGlvbnMsb3B0aW9ucyk7dGhpcy5yb290PXRoaXMub3B0aW9ucy5yb290O3RoaXMuX3dhbnRzSGFzaENoYW5nZT10aGlzLm9wdGlvbnMuaGFzaENoYW5nZSE9PWZhbHNlO3RoaXMuX3dhbnRzUHVzaFN0YXRlPSEhdGhpcy5vcHRpb25zLnB1c2hTdGF0ZTt0aGlzLl9oYXNQdXNoU3RhdGU9ISEodGhpcy5vcHRpb25zLnB1c2hTdGF0ZSYmdGhpcy5oaXN0b3J5JiZ0aGlzLmhpc3RvcnkucHVzaFN0YXRlKTt2YXIgZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudCgpO3ZhciBkb2NNb2RlPWRvY3VtZW50LmRvY3VtZW50TW9kZTt2YXIgb2xkSUU9aXNFeHBsb3Jlci5leGVjKG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSkmJighZG9jTW9kZXx8ZG9jTW9kZTw9Nyk7dGhpcy5yb290PSgiLyIrdGhpcy5yb290KyIvIikucmVwbGFjZShyb290U3RyaXBwZXIsIi8iKTtpZihvbGRJRSYmdGhpcy5fd2FudHNIYXNoQ2hhbmdlKXt0aGlzLmlmcmFtZT1CYWNrYm9uZS4kKCc8aWZyYW1lIHNyYz0iamF2YXNjcmlwdDowIiB0YWJpbmRleD0iLTEiIC8+JykuaGlkZSgpLmFwcGVuZFRvKCJib2R5IilbMF0uY29udGVudFdpbmRvdzt0aGlzLm5hdmlnYXRlKGZyYWdtZW50KX1pZih0aGlzLl9oYXNQdXNoU3RhdGUpe0JhY2tib25lLiQod2luZG93KS5vbigicG9wc3RhdGUiLHRoaXMuY2hlY2tVcmwpfWVsc2UgaWYodGhpcy5fd2FudHNIYXNoQ2hhbmdlJiYib25oYXNoY2hhbmdlImluIHdpbmRvdyYmIW9sZElFKXtCYWNrYm9uZS4kKHdpbmRvdykub24oImhhc2hjaGFuZ2UiLHRoaXMuY2hlY2tVcmwpfWVsc2UgaWYodGhpcy5fd2FudHNIYXNoQ2hhbmdlKXt0aGlzLl9jaGVja1VybEludGVydmFsPXNldEludGVydmFsKHRoaXMuY2hlY2tVcmwsdGhpcy5pbnRlcnZhbCl9dGhpcy5mcmFnbWVudD1mcmFnbWVudDt2YXIgbG9jPXRoaXMubG9jYXRpb247dmFyIGF0Um9vdD1sb2MucGF0aG5hbWUucmVwbGFjZSgvW15cL10kLywiJCYvIik9PT10aGlzLnJvb3Q7aWYodGhpcy5fd2FudHNIYXNoQ2hhbmdlJiZ0aGlzLl93YW50c1B1c2hTdGF0ZSYmIXRoaXMuX2hhc1B1c2hTdGF0ZSYmIWF0Um9vdCl7dGhpcy5mcmFnbWVudD10aGlzLmdldEZyYWdtZW50KG51bGwsdHJ1ZSk7dGhpcy5sb2NhdGlvbi5yZXBsYWNlKHRoaXMucm9vdCt0aGlzLmxvY2F0aW9uLnNlYXJjaCsiIyIrdGhpcy5mcmFnbWVudCk7cmV0dXJuIHRydWV9ZWxzZSBpZih0aGlzLl93YW50c1B1c2hTdGF0ZSYmdGhpcy5faGFzUHVzaFN0YXRlJiZhdFJvb3QmJmxvYy5oYXNoKXt0aGlzLmZyYWdtZW50PXRoaXMuZ2V0SGFzaCgpLnJlcGxhY2Uocm91dGVTdHJpcHBlciwiIik7dGhpcy5oaXN0b3J5LnJlcGxhY2VTdGF0ZSh7fSxkb2N1bWVudC50aXRsZSx0aGlzLnJvb3QrdGhpcy5mcmFnbWVudCtsb2Muc2VhcmNoKX1pZighdGhpcy5vcHRpb25zLnNpbGVudClyZXR1cm4gdGhpcy5sb2FkVXJsKCl9LHN0b3A6ZnVuY3Rpb24oKXtCYWNrYm9uZS4kKHdpbmRvdykub2ZmKCJwb3BzdGF0ZSIsdGhpcy5jaGVja1VybCkub2ZmKCJoYXNoY2hhbmdlIix0aGlzLmNoZWNrVXJsKTtjbGVhckludGVydmFsKHRoaXMuX2NoZWNrVXJsSW50ZXJ2YWwpO0hpc3Rvcnkuc3RhcnRlZD1mYWxzZX0scm91dGU6ZnVuY3Rpb24ocm91dGUsY2FsbGJhY2spe3RoaXMuaGFuZGxlcnMudW5zaGlmdCh7cm91dGU6cm91dGUsY2FsbGJhY2s6Y2FsbGJhY2t9KX0sY2hlY2tVcmw6ZnVuY3Rpb24oZSl7dmFyIGN1cnJlbnQ9dGhpcy5nZXRGcmFnbWVudCgpO2lmKGN1cnJlbnQ9PT10aGlzLmZyYWdtZW50JiZ0aGlzLmlmcmFtZSl7Y3VycmVudD10aGlzLmdldEZyYWdtZW50KHRoaXMuZ2V0SGFzaCh0aGlzLmlmcmFtZSkpfWlmKGN1cnJlbnQ9PT10aGlzLmZyYWdtZW50KXJldHVybiBmYWxzZTtpZih0aGlzLmlmcmFtZSl0aGlzLm5hdmlnYXRlKGN1cnJlbnQpO3RoaXMubG9hZFVybCgpfHx0aGlzLmxvYWRVcmwodGhpcy5nZXRIYXNoKCkpfSxsb2FkVXJsOmZ1bmN0aW9uKGZyYWdtZW50T3ZlcnJpZGUpe3ZhciBmcmFnbWVudD10aGlzLmZyYWdtZW50PXRoaXMuZ2V0RnJhZ21lbnQoZnJhZ21lbnRPdmVycmlkZSk7dmFyIG1hdGNoZWQ9Xy5hbnkodGhpcy5oYW5kbGVycyxmdW5jdGlvbihoYW5kbGVyKXtpZihoYW5kbGVyLnJvdXRlLnRlc3QoZnJhZ21lbnQpKXtoYW5kbGVyLmNhbGxiYWNrKGZyYWdtZW50KTtyZXR1cm4gdHJ1ZX19KTtyZXR1cm4gbWF0Y2hlZH0sbmF2aWdhdGU6ZnVuY3Rpb24oZnJhZ21lbnQsb3B0aW9ucyl7aWYoIUhpc3Rvcnkuc3RhcnRlZClyZXR1cm4gZmFsc2U7aWYoIW9wdGlvbnN8fG9wdGlvbnM9PT10cnVlKW9wdGlvbnM9e3RyaWdnZXI6b3B0aW9uc307ZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudChmcmFnbWVudHx8IiIpO2lmKHRoaXMuZnJhZ21lbnQ9PT1mcmFnbWVudClyZXR1cm47dGhpcy5mcmFnbWVudD1mcmFnbWVudDt2YXIgdXJsPXRoaXMucm9vdCtmcmFnbWVudDtpZih0aGlzLl9oYXNQdXNoU3RhdGUpe3RoaXMuaGlzdG9yeVtvcHRpb25zLnJlcGxhY2U/InJlcGxhY2VTdGF0ZSI6InB1c2hTdGF0ZSJdKHt9LGRvY3VtZW50LnRpdGxlLHVybCl9ZWxzZSBpZih0aGlzLl93YW50c0hhc2hDaGFuZ2Upe3RoaXMuX3VwZGF0ZUhhc2godGhpcy5sb2NhdGlvbixmcmFnbWVudCxvcHRpb25zLnJlcGxhY2UpO2lmKHRoaXMuaWZyYW1lJiZmcmFnbWVudCE9PXRoaXMuZ2V0RnJhZ21lbnQodGhpcy5nZXRIYXNoKHRoaXMuaWZyYW1lKSkpe2lmKCFvcHRpb25zLnJlcGxhY2UpdGhpcy5pZnJhbWUuZG9jdW1lbnQub3BlbigpLmNsb3NlKCk7dGhpcy5fdXBkYXRlSGFzaCh0aGlzLmlmcmFtZS5sb2NhdGlvbixmcmFnbWVudCxvcHRpb25zLnJlcGxhY2UpfX1lbHNle3JldHVybiB0aGlzLmxvY2F0aW9uLmFzc2lnbih1cmwpfWlmKG9wdGlvbnMudHJpZ2dlcil0aGlzLmxvYWRVcmwoZnJhZ21lbnQpfSxfdXBkYXRlSGFzaDpmdW5jdGlvbihsb2NhdGlvbixmcmFnbWVudCxyZXBsYWNlKXtpZihyZXBsYWNlKXt2YXIgaHJlZj1sb2NhdGlvbi5ocmVmLnJlcGxhY2UoLyhqYXZhc2NyaXB0OnwjKS4qJC8sIiIpO2xvY2F0aW9uLnJlcGxhY2UoaHJlZisiIyIrZnJhZ21lbnQpfWVsc2V7bG9jYXRpb24uaGFzaD0iIyIrZnJhZ21lbnR9fX0pO0JhY2tib25lLmhpc3Rvcnk9bmV3IEhpc3Rvcnk7dmFyIGV4dGVuZD1mdW5jdGlvbihwcm90b1Byb3BzLHN0YXRpY1Byb3BzKXt2YXIgcGFyZW50PXRoaXM7dmFyIGNoaWxkO2lmKHByb3RvUHJvcHMmJl8uaGFzKHByb3RvUHJvcHMsImNvbnN0cnVjdG9yIikpe2NoaWxkPXByb3RvUHJvcHMuY29uc3RydWN0b3J9ZWxzZXtjaGlsZD1mdW5jdGlvbigpe3JldHVybiBwYXJlbnQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX1fLmV4dGVuZChjaGlsZCxwYXJlbnQsc3RhdGljUHJvcHMpO3ZhciBTdXJyb2dhdGU9ZnVuY3Rpb24oKXt0aGlzLmNvbnN0cnVjdG9yPWNoaWxkfTtTdXJyb2dhdGUucHJvdG90eXBlPXBhcmVudC5wcm90b3R5cGU7Y2hpbGQucHJvdG90eXBlPW5ldyBTdXJyb2dhdGU7aWYocHJvdG9Qcm9wcylfLmV4dGVuZChjaGlsZC5wcm90b3R5cGUscHJvdG9Qcm9wcyk7Y2hpbGQuX19zdXBlcl9fPXBhcmVudC5wcm90b3R5cGU7cmV0dXJuIGNoaWxkfTtNb2RlbC5leHRlbmQ9Q29sbGVjdGlvbi5leHRlbmQ9Um91dGVyLmV4dGVuZD1WaWV3LmV4dGVuZD1IaXN0b3J5LmV4dGVuZD1leHRlbmQ7dmFyIHVybEVycm9yPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCdBICJ1cmwiIHByb3BlcnR5IG9yIGZ1bmN0aW9uIG11c3QgYmUgc3BlY2lmaWVkJyl9O3ZhciB3cmFwRXJyb3I9ZnVuY3Rpb24obW9kZWwsb3B0aW9ucyl7dmFyIGVycm9yPW9wdGlvbnMuZXJyb3I7b3B0aW9ucy5lcnJvcj1mdW5jdGlvbihyZXNwKXtpZihlcnJvcillcnJvcihtb2RlbCxyZXNwLG9wdGlvbnMpO21vZGVsLnRyaWdnZXIoImVycm9yIixtb2RlbCxyZXNwLG9wdGlvbnMpfX19KS5jYWxsKHRoaXMpOwovKgovL0Agc291cmNlTWFwcGluZ1VSTD1iYWNrYm9uZS1taW4ubWFwCiov",
                "body": "KGZ1bmN0aW9uKCl7dmFyIHJvb3Q9dGhpczt2YXIgcHJldmlvdXNCYWNrYm9uZT1yb290LkJhY2tib25lO3ZhciBhcnJheT1bXTt2YXIgcHVzaD1hcnJheS5wdXNoO3ZhciBzbGljZT1hcnJheS5zbGljZTt2YXIgc3BsaWNlPWFycmF5LnNwbGljZTt2YXIgQmFja2JvbmU7aWYodHlwZW9mIGV4cG9ydHMhPT0idW5kZWZpbmVkIil7QmFja2JvbmU9ZXhwb3J0c31lbHNle0JhY2tib25lPXJvb3QuQmFja2JvbmU9e319QmFja2JvbmUuVkVSU0lPTj0iMS4wLjAiO3ZhciBfPXJvb3QuXztpZighXyYmdHlwZW9mIHJlcXVpcmUhPT0idW5kZWZpbmVkIilfPXJlcXVpcmUoInVuZGVyc2NvcmUiKTtCYWNrYm9uZS4kPXJvb3QualF1ZXJ5fHxyb290LlplcHRvfHxyb290LmVuZGVyfHxyb290LiQ7QmFja2JvbmUubm9Db25mbGljdD1mdW5jdGlvbigpe3Jvb3QuQmFja2JvbmU9cHJldmlvdXNCYWNrYm9uZTtyZXR1cm4gdGhpc307QmFja2JvbmUuZW11bGF0ZUhUVFA9ZmFsc2U7QmFja2JvbmUuZW11bGF0ZUpTT049ZmFsc2U7dmFyIEV2ZW50cz1CYWNrYm9uZS5FdmVudHM9e29uOmZ1bmN0aW9uKG5hbWUsY2FsbGJhY2ssY29udGV4dCl7aWYoIWV2ZW50c0FwaSh0aGlzLCJvbiIsbmFtZSxbY2FsbGJhY2ssY29udGV4dF0pfHwhY2FsbGJhY2spcmV0dXJuIHRoaXM7dGhpcy5fZXZlbnRzfHwodGhpcy5fZXZlbnRzPXt9KTt2YXIgZXZlbnRzPXRoaXMuX2V2ZW50c1tuYW1lXXx8KHRoaXMuX2V2ZW50c1tuYW1lXT1bXSk7ZXZlbnRzLnB1c2goe2NhbGxiYWNrOmNhbGxiYWNrLGNvbnRleHQ6Y29udGV4dCxjdHg6Y29udGV4dHx8dGhpc30pO3JldHVybiB0aGlzfSxvbmNlOmZ1bmN0aW9uKG5hbWUsY2FsbGJhY2ssY29udGV4dCl7aWYoIWV2ZW50c0FwaSh0aGlzLCJvbmNlIixuYW1lLFtjYWxsYmFjayxjb250ZXh0XSl8fCFjYWxsYmFjaylyZXR1cm4gdGhpczt2YXIgc2VsZj10aGlzO3ZhciBvbmNlPV8ub25jZShmdW5jdGlvbigpe3NlbGYub2ZmKG5hbWUsb25jZSk7Y2FsbGJhY2suYXBwbHkodGhpcyxhcmd1bWVudHMpfSk7b25jZS5fY2FsbGJhY2s9Y2FsbGJhY2s7cmV0dXJuIHRoaXMub24obmFtZSxvbmNlLGNvbnRleHQpfSxvZmY6ZnVuY3Rpb24obmFtZSxjYWxsYmFjayxjb250ZXh0KXt2YXIgcmV0YWluLGV2LGV2ZW50cyxuYW1lcyxpLGwsaixrO2lmKCF0aGlzLl9ldmVudHN8fCFldmVudHNBcGkodGhpcywib2ZmIixuYW1lLFtjYWxsYmFjayxjb250ZXh0XSkpcmV0dXJuIHRoaXM7aWYoIW5hbWUmJiFjYWxsYmFjayYmIWNvbnRleHQpe3RoaXMuX2V2ZW50cz17fTtyZXR1cm4gdGhpc31uYW1lcz1uYW1lP1tuYW1lXTpfLmtleXModGhpcy5fZXZlbnRzKTtmb3IoaT0wLGw9bmFtZXMubGVuZ3RoO2k8bDtpKyspe25hbWU9bmFtZXNbaV07aWYoZXZlbnRzPXRoaXMuX2V2ZW50c1tuYW1lXSl7dGhpcy5fZXZlbnRzW25hbWVdPXJldGFpbj1bXTtpZihjYWxsYmFja3x8Y29udGV4dCl7Zm9yKGo9MCxrPWV2ZW50cy5sZW5ndGg7ajxrO2orKyl7ZXY9ZXZlbnRzW2pdO2lmKGNhbGxiYWNrJiZjYWxsYmFjayE9PWV2LmNhbGxiYWNrJiZjYWxsYmFjayE9PWV2LmNhbGxiYWNrLl9jYWxsYmFja3x8Y29udGV4dCYmY29udGV4dCE9PWV2LmNvbnRleHQpe3JldGFpbi5wdXNoKGV2KX19fWlmKCFyZXRhaW4ubGVuZ3RoKWRlbGV0ZSB0aGlzLl9ldmVudHNbbmFtZV19fXJldHVybiB0aGlzfSx0cmlnZ2VyOmZ1bmN0aW9uKG5hbWUpe2lmKCF0aGlzLl9ldmVudHMpcmV0dXJuIHRoaXM7dmFyIGFyZ3M9c2xpY2UuY2FsbChhcmd1bWVudHMsMSk7aWYoIWV2ZW50c0FwaSh0aGlzLCJ0cmlnZ2VyIixuYW1lLGFyZ3MpKXJldHVybiB0aGlzO3ZhciBldmVudHM9dGhpcy5fZXZlbnRzW25hbWVdO3ZhciBhbGxFdmVudHM9dGhpcy5fZXZlbnRzLmFsbDtpZihldmVudHMpdHJpZ2dlckV2ZW50cyhldmVudHMsYXJncyk7aWYoYWxsRXZlbnRzKXRyaWdnZXJFdmVudHMoYWxsRXZlbnRzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXN9LHN0b3BMaXN0ZW5pbmc6ZnVuY3Rpb24ob2JqLG5hbWUsY2FsbGJhY2spe3ZhciBsaXN0ZW5lcnM9dGhpcy5fbGlzdGVuZXJzO2lmKCFsaXN0ZW5lcnMpcmV0dXJuIHRoaXM7dmFyIGRlbGV0ZUxpc3RlbmVyPSFuYW1lJiYhY2FsbGJhY2s7aWYodHlwZW9mIG5hbWU9PT0ib2JqZWN0IiljYWxsYmFjaz10aGlzO2lmKG9iaikobGlzdGVuZXJzPXt9KVtvYmouX2xpc3RlbmVySWRdPW9iajtmb3IodmFyIGlkIGluIGxpc3RlbmVycyl7bGlzdGVuZXJzW2lkXS5vZmYobmFtZSxjYWxsYmFjayx0aGlzKTtpZihkZWxldGVMaXN0ZW5lcilkZWxldGUgdGhpcy5fbGlzdGVuZXJzW2lkXX1yZXR1cm4gdGhpc319O3ZhciBldmVudFNwbGl0dGVyPS9ccysvO3ZhciBldmVudHNBcGk9ZnVuY3Rpb24ob2JqLGFjdGlvbixuYW1lLHJlc3Qpe2lmKCFuYW1lKXJldHVybiB0cnVlO2lmKHR5cGVvZiBuYW1lPT09Im9iamVjdCIpe2Zvcih2YXIga2V5IGluIG5hbWUpe29ialthY3Rpb25dLmFwcGx5KG9iaixba2V5LG5hbWVba2V5XV0uY29uY2F0KHJlc3QpKX1yZXR1cm4gZmFsc2V9aWYoZXZlbnRTcGxpdHRlci50ZXN0KG5hbWUpKXt2YXIgbmFtZXM9bmFtZS5zcGxpdChldmVudFNwbGl0dGVyKTtmb3IodmFyIGk9MCxsPW5hbWVzLmxlbmd0aDtpPGw7aSsrKXtvYmpbYWN0aW9uXS5hcHBseShvYmosW25hbWVzW2ldXS5jb25jYXQocmVzdCkpfXJldHVybiBmYWxzZX1yZXR1cm4gdHJ1ZX07dmFyIHRyaWdnZXJFdmVudHM9ZnVuY3Rpb24oZXZlbnRzLGFyZ3Mpe3ZhciBldixpPS0xLGw9ZXZlbnRzLmxlbmd0aCxhMT1hcmdzWzBdLGEyPWFyZ3NbMV0sYTM9YXJnc1syXTtzd2l0Y2goYXJncy5sZW5ndGgpe2Nhc2UgMDp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCk7cmV0dXJuO2Nhc2UgMTp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSk7cmV0dXJuO2Nhc2UgMjp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSxhMik7cmV0dXJuO2Nhc2UgMzp3aGlsZSgrK2k8bCkoZXY9ZXZlbnRzW2ldKS5jYWxsYmFjay5jYWxsKGV2LmN0eCxhMSxhMixhMyk7cmV0dXJuO2RlZmF1bHQ6d2hpbGUoKytpPGwpKGV2PWV2ZW50c1tpXSkuY2FsbGJhY2suYXBwbHkoZXYuY3R4LGFyZ3MpfX07dmFyIGxpc3Rlbk1ldGhvZHM9e2xpc3RlblRvOiJvbiIsbGlzdGVuVG9PbmNlOiJvbmNlIn07Xy5lYWNoKGxpc3Rlbk1ldGhvZHMsZnVuY3Rpb24oaW1wbGVtZW50YXRpb24sbWV0aG9kKXtFdmVudHNbbWV0aG9kXT1mdW5jdGlvbihvYmosbmFtZSxjYWxsYmFjayl7dmFyIGxpc3RlbmVycz10aGlzLl9saXN0ZW5lcnN8fCh0aGlzLl9saXN0ZW5lcnM9e30pO3ZhciBpZD1vYmouX2xpc3RlbmVySWR8fChvYmouX2xpc3RlbmVySWQ9Xy51bmlxdWVJZCgibCIpKTtsaXN0ZW5lcnNbaWRdPW9iajtpZih0eXBlb2YgbmFtZT09PSJvYmplY3QiKWNhbGxiYWNrPXRoaXM7b2JqW2ltcGxlbWVudGF0aW9uXShuYW1lLGNhbGxiYWNrLHRoaXMpO3JldHVybiB0aGlzfX0pO0V2ZW50cy5iaW5kPUV2ZW50cy5vbjtFdmVudHMudW5iaW5kPUV2ZW50cy5vZmY7Xy5leHRlbmQoQmFja2JvbmUsRXZlbnRzKTt2YXIgTW9kZWw9QmFja2JvbmUuTW9kZWw9ZnVuY3Rpb24oYXR0cmlidXRlcyxvcHRpb25zKXt2YXIgZGVmYXVsdHM7dmFyIGF0dHJzPWF0dHJpYnV0ZXN8fHt9O29wdGlvbnN8fChvcHRpb25zPXt9KTt0aGlzLmNpZD1fLnVuaXF1ZUlkKCJjIik7dGhpcy5hdHRyaWJ1dGVzPXt9O18uZXh0ZW5kKHRoaXMsXy5waWNrKG9wdGlvbnMsbW9kZWxPcHRpb25zKSk7aWYob3B0aW9ucy5wYXJzZSlhdHRycz10aGlzLnBhcnNlKGF0dHJzLG9wdGlvbnMpfHx7fTtpZihkZWZhdWx0cz1fLnJlc3VsdCh0aGlzLCJkZWZhdWx0cyIpKXthdHRycz1fLmRlZmF1bHRzKHt9LGF0dHJzLGRlZmF1bHRzKX10aGlzLnNldChhdHRycyxvcHRpb25zKTt0aGlzLmNoYW5nZWQ9e307dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07dmFyIG1vZGVsT3B0aW9ucz1bInVybCIsInVybFJvb3QiLCJjb2xsZWN0aW9uIl07Xy5leHRlbmQoTW9kZWwucHJvdG90eXBlLEV2ZW50cyx7Y2hhbmdlZDpudWxsLHZhbGlkYXRpb25FcnJvcjpudWxsLGlkQXR0cmlidXRlOiJpZCIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sdG9KU09OOmZ1bmN0aW9uKG9wdGlvbnMpe3JldHVybiBfLmNsb25lKHRoaXMuYXR0cmlidXRlcyl9LHN5bmM6ZnVuY3Rpb24oKXtyZXR1cm4gQmFja2JvbmUuc3luYy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGdldDpmdW5jdGlvbihhdHRyKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW2F0dHJdfSxlc2NhcGU6ZnVuY3Rpb24oYXR0cil7cmV0dXJuIF8uZXNjYXBlKHRoaXMuZ2V0KGF0dHIpKX0saGFzOmZ1bmN0aW9uKGF0dHIpe3JldHVybiB0aGlzLmdldChhdHRyKSE9bnVsbH0sc2V0OmZ1bmN0aW9uKGtleSx2YWwsb3B0aW9ucyl7dmFyIGF0dHIsYXR0cnMsdW5zZXQsY2hhbmdlcyxzaWxlbnQsY2hhbmdpbmcscHJldixjdXJyZW50O2lmKGtleT09bnVsbClyZXR1cm4gdGhpcztpZih0eXBlb2Yga2V5PT09Im9iamVjdCIpe2F0dHJzPWtleTtvcHRpb25zPXZhbH1lbHNleyhhdHRycz17fSlba2V5XT12YWx9b3B0aW9uc3x8KG9wdGlvbnM9e30pO2lmKCF0aGlzLl92YWxpZGF0ZShhdHRycyxvcHRpb25zKSlyZXR1cm4gZmFsc2U7dW5zZXQ9b3B0aW9ucy51bnNldDtzaWxlbnQ9b3B0aW9ucy5zaWxlbnQ7Y2hhbmdlcz1bXTtjaGFuZ2luZz10aGlzLl9jaGFuZ2luZzt0aGlzLl9jaGFuZ2luZz10cnVlO2lmKCFjaGFuZ2luZyl7dGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzPV8uY2xvbmUodGhpcy5hdHRyaWJ1dGVzKTt0aGlzLmNoYW5nZWQ9e319Y3VycmVudD10aGlzLmF0dHJpYnV0ZXMscHJldj10aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM7aWYodGhpcy5pZEF0dHJpYnV0ZSBpbiBhdHRycyl0aGlzLmlkPWF0dHJzW3RoaXMuaWRBdHRyaWJ1dGVdO2ZvcihhdHRyIGluIGF0dHJzKXt2YWw9YXR0cnNbYXR0cl07aWYoIV8uaXNFcXVhbChjdXJyZW50W2F0dHJdLHZhbCkpY2hhbmdlcy5wdXNoKGF0dHIpO2lmKCFfLmlzRXF1YWwocHJldlthdHRyXSx2YWwpKXt0aGlzLmNoYW5nZWRbYXR0cl09dmFsfWVsc2V7ZGVsZXRlIHRoaXMuY2hhbmdlZFthdHRyXX11bnNldD9kZWxldGUgY3VycmVudFthdHRyXTpjdXJyZW50W2F0dHJdPXZhbH1pZighc2lsZW50KXtpZihjaGFuZ2VzLmxlbmd0aCl0aGlzLl9wZW5kaW5nPXRydWU7Zm9yKHZhciBpPTAsbD1jaGFuZ2VzLmxlbmd0aDtpPGw7aSsrKXt0aGlzLnRyaWdnZXIoImNoYW5nZToiK2NoYW5nZXNbaV0sdGhpcyxjdXJyZW50W2NoYW5nZXNbaV1dLG9wdGlvbnMpfX1pZihjaGFuZ2luZylyZXR1cm4gdGhpcztpZighc2lsZW50KXt3aGlsZSh0aGlzLl9wZW5kaW5nKXt0aGlzLl9wZW5kaW5nPWZhbHNlO3RoaXMudHJpZ2dlcigiY2hhbmdlIix0aGlzLG9wdGlvbnMpfX10aGlzLl9wZW5kaW5nPWZhbHNlO3RoaXMuX2NoYW5naW5nPWZhbHNlO3JldHVybiB0aGlzfSx1bnNldDpmdW5jdGlvbihhdHRyLG9wdGlvbnMpe3JldHVybiB0aGlzLnNldChhdHRyLHZvaWQgMCxfLmV4dGVuZCh7fSxvcHRpb25zLHt1bnNldDp0cnVlfSkpfSxjbGVhcjpmdW5jdGlvbihvcHRpb25zKXt2YXIgYXR0cnM9e307Zm9yKHZhciBrZXkgaW4gdGhpcy5hdHRyaWJ1dGVzKWF0dHJzW2tleV09dm9pZCAwO3JldHVybiB0aGlzLnNldChhdHRycyxfLmV4dGVuZCh7fSxvcHRpb25zLHt1bnNldDp0cnVlfSkpfSxoYXNDaGFuZ2VkOmZ1bmN0aW9uKGF0dHIpe2lmKGF0dHI9PW51bGwpcmV0dXJuIV8uaXNFbXB0eSh0aGlzLmNoYW5nZWQpO3JldHVybiBfLmhhcyh0aGlzLmNoYW5nZWQsYXR0cil9LGNoYW5nZWRBdHRyaWJ1dGVzOmZ1bmN0aW9uKGRpZmYpe2lmKCFkaWZmKXJldHVybiB0aGlzLmhhc0NoYW5nZWQoKT9fLmNsb25lKHRoaXMuY2hhbmdlZCk6ZmFsc2U7dmFyIHZhbCxjaGFuZ2VkPWZhbHNlO3ZhciBvbGQ9dGhpcy5fY2hhbmdpbmc/dGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzOnRoaXMuYXR0cmlidXRlcztmb3IodmFyIGF0dHIgaW4gZGlmZil7aWYoXy5pc0VxdWFsKG9sZFthdHRyXSx2YWw9ZGlmZlthdHRyXSkpY29udGludWU7KGNoYW5nZWR8fChjaGFuZ2VkPXt9KSlbYXR0cl09dmFsfXJldHVybiBjaGFuZ2VkfSxwcmV2aW91czpmdW5jdGlvbihhdHRyKXtpZihhdHRyPT1udWxsfHwhdGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzKXJldHVybiBudWxsO3JldHVybiB0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXNbYXR0cl19LHByZXZpb3VzQXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybiBfLmNsb25lKHRoaXMuX3ByZXZpb3VzQXR0cmlidXRlcyl9LGZldGNoOmZ1bmN0aW9uKG9wdGlvbnMpe29wdGlvbnM9b3B0aW9ucz9fLmNsb25lKG9wdGlvbnMpOnt9O2lmKG9wdGlvbnMucGFyc2U9PT12b2lkIDApb3B0aW9ucy5wYXJzZT10cnVlO3ZhciBtb2RlbD10aGlzO3ZhciBzdWNjZXNzPW9wdGlvbnMuc3VjY2VzcztvcHRpb25zLnN1Y2Nlc3M9ZnVuY3Rpb24ocmVzcCl7aWYoIW1vZGVsLnNldChtb2RlbC5wYXJzZShyZXNwLG9wdGlvbnMpLG9wdGlvbnMpKXJldHVybiBmYWxzZTtpZihzdWNjZXNzKXN1Y2Nlc3MobW9kZWwscmVzcCxvcHRpb25zKTttb2RlbC50cmlnZ2VyKCJzeW5jIixtb2RlbCxyZXNwLG9wdGlvbnMpfTt3cmFwRXJyb3IodGhpcyxvcHRpb25zKTtyZXR1cm4gdGhpcy5zeW5jKCJyZWFkIix0aGlzLG9wdGlvbnMpfSxzYXZlOmZ1bmN0aW9uKGtleSx2YWwsb3B0aW9ucyl7dmFyIGF0dHJzLG1ldGhvZCx4aHIsYXR0cmlidXRlcz10aGlzLmF0dHJpYnV0ZXM7aWYoa2V5PT1udWxsfHx0eXBlb2Yga2V5PT09Im9iamVjdCIpe2F0dHJzPWtleTtvcHRpb25zPXZhbH1lbHNleyhhdHRycz17fSlba2V5XT12YWx9aWYoYXR0cnMmJighb3B0aW9uc3x8IW9wdGlvbnMud2FpdCkmJiF0aGlzLnNldChhdHRycyxvcHRpb25zKSlyZXR1cm4gZmFsc2U7b3B0aW9ucz1fLmV4dGVuZCh7dmFsaWRhdGU6dHJ1ZX0sb3B0aW9ucyk7aWYoIXRoaXMuX3ZhbGlkYXRlKGF0dHJzLG9wdGlvbnMpKXJldHVybiBmYWxzZTtpZihhdHRycyYmb3B0aW9ucy53YWl0KXt0aGlzLmF0dHJpYnV0ZXM9Xy5leHRlbmQoe30sYXR0cmlidXRlcyxhdHRycyl9aWYob3B0aW9ucy5wYXJzZT09PXZvaWQgMClvcHRpb25zLnBhcnNlPXRydWU7dmFyIG1vZGVsPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihyZXNwKXttb2RlbC5hdHRyaWJ1dGVzPWF0dHJpYnV0ZXM7dmFyIHNlcnZlckF0dHJzPW1vZGVsLnBhcnNlKHJlc3Asb3B0aW9ucyk7aWYob3B0aW9ucy53YWl0KXNlcnZlckF0dHJzPV8uZXh0ZW5kKGF0dHJzfHx7fSxzZXJ2ZXJBdHRycyk7aWYoXy5pc09iamVjdChzZXJ2ZXJBdHRycykmJiFtb2RlbC5zZXQoc2VydmVyQXR0cnMsb3B0aW9ucykpe3JldHVybiBmYWxzZX1pZihzdWNjZXNzKXN1Y2Nlc3MobW9kZWwscmVzcCxvcHRpb25zKTttb2RlbC50cmlnZ2VyKCJzeW5jIixtb2RlbCxyZXNwLG9wdGlvbnMpfTt3cmFwRXJyb3IodGhpcyxvcHRpb25zKTttZXRob2Q9dGhpcy5pc05ldygpPyJjcmVhdGUiOm9wdGlvbnMucGF0Y2g/InBhdGNoIjoidXBkYXRlIjtpZihtZXRob2Q9PT0icGF0Y2giKW9wdGlvbnMuYXR0cnM9YXR0cnM7eGhyPXRoaXMuc3luYyhtZXRob2QsdGhpcyxvcHRpb25zKTtpZihhdHRycyYmb3B0aW9ucy53YWl0KXRoaXMuYXR0cmlidXRlcz1hdHRyaWJ1dGVzO3JldHVybiB4aHJ9LGRlc3Ryb3k6ZnVuY3Rpb24ob3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307dmFyIG1vZGVsPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO3ZhciBkZXN0cm95PWZ1bmN0aW9uKCl7bW9kZWwudHJpZ2dlcigiZGVzdHJveSIsbW9kZWwsbW9kZWwuY29sbGVjdGlvbixvcHRpb25zKX07b3B0aW9ucy5zdWNjZXNzPWZ1bmN0aW9uKHJlc3Ape2lmKG9wdGlvbnMud2FpdHx8bW9kZWwuaXNOZXcoKSlkZXN0cm95KCk7aWYoc3VjY2VzcylzdWNjZXNzKG1vZGVsLHJlc3Asb3B0aW9ucyk7aWYoIW1vZGVsLmlzTmV3KCkpbW9kZWwudHJpZ2dlcigic3luYyIsbW9kZWwscmVzcCxvcHRpb25zKX07aWYodGhpcy5pc05ldygpKXtvcHRpb25zLnN1Y2Nlc3MoKTtyZXR1cm4gZmFsc2V9d3JhcEVycm9yKHRoaXMsb3B0aW9ucyk7dmFyIHhocj10aGlzLnN5bmMoImRlbGV0ZSIsdGhpcyxvcHRpb25zKTtpZighb3B0aW9ucy53YWl0KWRlc3Ryb3koKTtyZXR1cm4geGhyfSx1cmw6ZnVuY3Rpb24oKXt2YXIgYmFzZT1fLnJlc3VsdCh0aGlzLCJ1cmxSb290Iil8fF8ucmVzdWx0KHRoaXMuY29sbGVjdGlvbiwidXJsIil8fHVybEVycm9yKCk7aWYodGhpcy5pc05ldygpKXJldHVybiBiYXNlO3JldHVybiBiYXNlKyhiYXNlLmNoYXJBdChiYXNlLmxlbmd0aC0xKT09PSIvIj8iIjoiLyIpK2VuY29kZVVSSUNvbXBvbmVudCh0aGlzLmlkKX0scGFyc2U6ZnVuY3Rpb24ocmVzcCxvcHRpb25zKXtyZXR1cm4gcmVzcH0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5hdHRyaWJ1dGVzKX0saXNOZXc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pZD09bnVsbH0saXNWYWxpZDpmdW5jdGlvbihvcHRpb25zKXtyZXR1cm4gdGhpcy5fdmFsaWRhdGUoe30sXy5leHRlbmQob3B0aW9uc3x8e30se3ZhbGlkYXRlOnRydWV9KSl9LF92YWxpZGF0ZTpmdW5jdGlvbihhdHRycyxvcHRpb25zKXtpZighb3B0aW9ucy52YWxpZGF0ZXx8IXRoaXMudmFsaWRhdGUpcmV0dXJuIHRydWU7YXR0cnM9Xy5leHRlbmQoe30sdGhpcy5hdHRyaWJ1dGVzLGF0dHJzKTt2YXIgZXJyb3I9dGhpcy52YWxpZGF0aW9uRXJyb3I9dGhpcy52YWxpZGF0ZShhdHRycyxvcHRpb25zKXx8bnVsbDtpZighZXJyb3IpcmV0dXJuIHRydWU7dGhpcy50cmlnZ2VyKCJpbnZhbGlkIix0aGlzLGVycm9yLF8uZXh0ZW5kKG9wdGlvbnN8fHt9LHt2YWxpZGF0aW9uRXJyb3I6ZXJyb3J9KSk7cmV0dXJuIGZhbHNlfX0pO3ZhciBtb2RlbE1ldGhvZHM9WyJrZXlzIiwidmFsdWVzIiwicGFpcnMiLCJpbnZlcnQiLCJwaWNrIiwib21pdCJdO18uZWFjaChtb2RlbE1ldGhvZHMsZnVuY3Rpb24obWV0aG9kKXtNb2RlbC5wcm90b3R5cGVbbWV0aG9kXT1mdW5jdGlvbigpe3ZhciBhcmdzPXNsaWNlLmNhbGwoYXJndW1lbnRzKTthcmdzLnVuc2hpZnQodGhpcy5hdHRyaWJ1dGVzKTtyZXR1cm4gX1ttZXRob2RdLmFwcGx5KF8sYXJncyl9fSk7dmFyIENvbGxlY3Rpb249QmFja2JvbmUuQ29sbGVjdGlvbj1mdW5jdGlvbihtb2RlbHMsb3B0aW9ucyl7b3B0aW9uc3x8KG9wdGlvbnM9e30pO2lmKG9wdGlvbnMudXJsKXRoaXMudXJsPW9wdGlvbnMudXJsO2lmKG9wdGlvbnMubW9kZWwpdGhpcy5tb2RlbD1vcHRpb25zLm1vZGVsO2lmKG9wdGlvbnMuY29tcGFyYXRvciE9PXZvaWQgMCl0aGlzLmNvbXBhcmF0b3I9b3B0aW9ucy5jb21wYXJhdG9yO3RoaXMuX3Jlc2V0KCk7dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihtb2RlbHMpdGhpcy5yZXNldChtb2RlbHMsXy5leHRlbmQoe3NpbGVudDp0cnVlfSxvcHRpb25zKSl9O3ZhciBzZXRPcHRpb25zPXthZGQ6dHJ1ZSxyZW1vdmU6dHJ1ZSxtZXJnZTp0cnVlfTt2YXIgYWRkT3B0aW9ucz17YWRkOnRydWUsbWVyZ2U6ZmFsc2UscmVtb3ZlOmZhbHNlfTtfLmV4dGVuZChDb2xsZWN0aW9uLnByb3RvdHlwZSxFdmVudHMse21vZGVsOk1vZGVsLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt9LHRvSlNPTjpmdW5jdGlvbihvcHRpb25zKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24obW9kZWwpe3JldHVybiBtb2RlbC50b0pTT04ob3B0aW9ucyl9KX0sc3luYzpmdW5jdGlvbigpe3JldHVybiBCYWNrYm9uZS5zeW5jLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sYWRkOmZ1bmN0aW9uKG1vZGVscyxvcHRpb25zKXtyZXR1cm4gdGhpcy5zZXQobW9kZWxzLF8uZGVmYXVsdHMob3B0aW9uc3x8e30sYWRkT3B0aW9ucykpfSxyZW1vdmU6ZnVuY3Rpb24obW9kZWxzLG9wdGlvbnMpe21vZGVscz1fLmlzQXJyYXkobW9kZWxzKT9tb2RlbHMuc2xpY2UoKTpbbW9kZWxzXTtvcHRpb25zfHwob3B0aW9ucz17fSk7dmFyIGksbCxpbmRleCxtb2RlbDtmb3IoaT0wLGw9bW9kZWxzLmxlbmd0aDtpPGw7aSsrKXttb2RlbD10aGlzLmdldChtb2RlbHNbaV0pO2lmKCFtb2RlbCljb250aW51ZTtkZWxldGUgdGhpcy5fYnlJZFttb2RlbC5pZF07ZGVsZXRlIHRoaXMuX2J5SWRbbW9kZWwuY2lkXTtpbmRleD10aGlzLmluZGV4T2YobW9kZWwpO3RoaXMubW9kZWxzLnNwbGljZShpbmRleCwxKTt0aGlzLmxlbmd0aC0tO2lmKCFvcHRpb25zLnNpbGVudCl7b3B0aW9ucy5pbmRleD1pbmRleDttb2RlbC50cmlnZ2VyKCJyZW1vdmUiLG1vZGVsLHRoaXMsb3B0aW9ucyl9dGhpcy5fcmVtb3ZlUmVmZXJlbmNlKG1vZGVsKX1yZXR1cm4gdGhpc30sc2V0OmZ1bmN0aW9uKG1vZGVscyxvcHRpb25zKXtvcHRpb25zPV8uZGVmYXVsdHMob3B0aW9uc3x8e30sc2V0T3B0aW9ucyk7aWYob3B0aW9ucy5wYXJzZSltb2RlbHM9dGhpcy5wYXJzZShtb2RlbHMsb3B0aW9ucyk7aWYoIV8uaXNBcnJheShtb2RlbHMpKW1vZGVscz1tb2RlbHM/W21vZGVsc106W107dmFyIGksbCxtb2RlbCxhdHRycyxleGlzdGluZyxzb3J0O3ZhciBhdD1vcHRpb25zLmF0O3ZhciBzb3J0YWJsZT10aGlzLmNvbXBhcmF0b3ImJmF0PT1udWxsJiZvcHRpb25zLnNvcnQhPT1mYWxzZTt2YXIgc29ydEF0dHI9Xy5pc1N0cmluZyh0aGlzLmNvbXBhcmF0b3IpP3RoaXMuY29tcGFyYXRvcjpudWxsO3ZhciB0b0FkZD1bXSx0b1JlbW92ZT1bXSxtb2RlbE1hcD17fTtmb3IoaT0wLGw9bW9kZWxzLmxlbmd0aDtpPGw7aSsrKXtpZighKG1vZGVsPXRoaXMuX3ByZXBhcmVNb2RlbChtb2RlbHNbaV0sb3B0aW9ucykpKWNvbnRpbnVlO2lmKGV4aXN0aW5nPXRoaXMuZ2V0KG1vZGVsKSl7aWYob3B0aW9ucy5yZW1vdmUpbW9kZWxNYXBbZXhpc3RpbmcuY2lkXT10cnVlO2lmKG9wdGlvbnMubWVyZ2Upe2V4aXN0aW5nLnNldChtb2RlbC5hdHRyaWJ1dGVzLG9wdGlvbnMpO2lmKHNvcnRhYmxlJiYhc29ydCYmZXhpc3RpbmcuaGFzQ2hhbmdlZChzb3J0QXR0cikpc29ydD10cnVlfX1lbHNlIGlmKG9wdGlvbnMuYWRkKXt0b0FkZC5wdXNoKG1vZGVsKTttb2RlbC5vbigiYWxsIix0aGlzLl9vbk1vZGVsRXZlbnQsdGhpcyk7dGhpcy5fYnlJZFttb2RlbC5jaWRdPW1vZGVsO2lmKG1vZGVsLmlkIT1udWxsKXRoaXMuX2J5SWRbbW9kZWwuaWRdPW1vZGVsfX1pZihvcHRpb25zLnJlbW92ZSl7Zm9yKGk9MCxsPXRoaXMubGVuZ3RoO2k8bDsrK2kpe2lmKCFtb2RlbE1hcFsobW9kZWw9dGhpcy5tb2RlbHNbaV0pLmNpZF0pdG9SZW1vdmUucHVzaChtb2RlbCl9aWYodG9SZW1vdmUubGVuZ3RoKXRoaXMucmVtb3ZlKHRvUmVtb3ZlLG9wdGlvbnMpfWlmKHRvQWRkLmxlbmd0aCl7aWYoc29ydGFibGUpc29ydD10cnVlO3RoaXMubGVuZ3RoKz10b0FkZC5sZW5ndGg7aWYoYXQhPW51bGwpe3NwbGljZS5hcHBseSh0aGlzLm1vZGVscyxbYXQsMF0uY29uY2F0KHRvQWRkKSl9ZWxzZXtwdXNoLmFwcGx5KHRoaXMubW9kZWxzLHRvQWRkKX19aWYoc29ydCl0aGlzLnNvcnQoe3NpbGVudDp0cnVlfSk7aWYob3B0aW9ucy5zaWxlbnQpcmV0dXJuIHRoaXM7Zm9yKGk9MCxsPXRvQWRkLmxlbmd0aDtpPGw7aSsrKXsobW9kZWw9dG9BZGRbaV0pLnRyaWdnZXIoImFkZCIsbW9kZWwsdGhpcyxvcHRpb25zKX1pZihzb3J0KXRoaXMudHJpZ2dlcigic29ydCIsdGhpcyxvcHRpb25zKTtyZXR1cm4gdGhpc30scmVzZXQ6ZnVuY3Rpb24obW9kZWxzLG9wdGlvbnMpe29wdGlvbnN8fChvcHRpb25zPXt9KTtmb3IodmFyIGk9MCxsPXRoaXMubW9kZWxzLmxlbmd0aDtpPGw7aSsrKXt0aGlzLl9yZW1vdmVSZWZlcmVuY2UodGhpcy5tb2RlbHNbaV0pfW9wdGlvbnMucHJldmlvdXNNb2RlbHM9dGhpcy5tb2RlbHM7dGhpcy5fcmVzZXQoKTt0aGlzLmFkZChtb2RlbHMsXy5leHRlbmQoe3NpbGVudDp0cnVlfSxvcHRpb25zKSk7aWYoIW9wdGlvbnMuc2lsZW50KXRoaXMudHJpZ2dlcigicmVzZXQiLHRoaXMsb3B0aW9ucyk7cmV0dXJuIHRoaXN9LHB1c2g6ZnVuY3Rpb24obW9kZWwsb3B0aW9ucyl7bW9kZWw9dGhpcy5fcHJlcGFyZU1vZGVsKG1vZGVsLG9wdGlvbnMpO3RoaXMuYWRkKG1vZGVsLF8uZXh0ZW5kKHthdDp0aGlzLmxlbmd0aH0sb3B0aW9ucykpO3JldHVybiBtb2RlbH0scG9wOmZ1bmN0aW9uKG9wdGlvbnMpe3ZhciBtb2RlbD10aGlzLmF0KHRoaXMubGVuZ3RoLTEpO3RoaXMucmVtb3ZlKG1vZGVsLG9wdGlvbnMpO3JldHVybiBtb2RlbH0sdW5zaGlmdDpmdW5jdGlvbihtb2RlbCxvcHRpb25zKXttb2RlbD10aGlzLl9wcmVwYXJlTW9kZWwobW9kZWwsb3B0aW9ucyk7dGhpcy5hZGQobW9kZWwsXy5leHRlbmQoe2F0OjB9LG9wdGlvbnMpKTtyZXR1cm4gbW9kZWx9LHNoaWZ0OmZ1bmN0aW9uKG9wdGlvbnMpe3ZhciBtb2RlbD10aGlzLmF0KDApO3RoaXMucmVtb3ZlKG1vZGVsLG9wdGlvbnMpO3JldHVybiBtb2RlbH0sc2xpY2U6ZnVuY3Rpb24oYmVnaW4sZW5kKXtyZXR1cm4gdGhpcy5tb2RlbHMuc2xpY2UoYmVnaW4sZW5kKX0sZ2V0OmZ1bmN0aW9uKG9iail7aWYob2JqPT1udWxsKXJldHVybiB2b2lkIDA7cmV0dXJuIHRoaXMuX2J5SWRbb2JqLmlkIT1udWxsP29iai5pZDpvYmouY2lkfHxvYmpdfSxhdDpmdW5jdGlvbihpbmRleCl7cmV0dXJuIHRoaXMubW9kZWxzW2luZGV4XX0sd2hlcmU6ZnVuY3Rpb24oYXR0cnMsZmlyc3Qpe2lmKF8uaXNFbXB0eShhdHRycykpcmV0dXJuIGZpcnN0P3ZvaWQgMDpbXTtyZXR1cm4gdGhpc1tmaXJzdD8iZmluZCI6ImZpbHRlciJdKGZ1bmN0aW9uKG1vZGVsKXtmb3IodmFyIGtleSBpbiBhdHRycyl7aWYoYXR0cnNba2V5XSE9PW1vZGVsLmdldChrZXkpKXJldHVybiBmYWxzZX1yZXR1cm4gdHJ1ZX0pfSxmaW5kV2hlcmU6ZnVuY3Rpb24oYXR0cnMpe3JldHVybiB0aGlzLndoZXJlKGF0dHJzLHRydWUpfSxzb3J0OmZ1bmN0aW9uKG9wdGlvbnMpe2lmKCF0aGlzLmNvbXBhcmF0b3IpdGhyb3cgbmV3IEVycm9yKCJDYW5ub3Qgc29ydCBhIHNldCB3aXRob3V0IGEgY29tcGFyYXRvciIpO29wdGlvbnN8fChvcHRpb25zPXt9KTtpZihfLmlzU3RyaW5nKHRoaXMuY29tcGFyYXRvcil8fHRoaXMuY29tcGFyYXRvci5sZW5ndGg9PT0xKXt0aGlzLm1vZGVscz10aGlzLnNvcnRCeSh0aGlzLmNvbXBhcmF0b3IsdGhpcyl9ZWxzZXt0aGlzLm1vZGVscy5zb3J0KF8uYmluZCh0aGlzLmNvbXBhcmF0b3IsdGhpcykpfWlmKCFvcHRpb25zLnNpbGVudCl0aGlzLnRyaWdnZXIoInNvcnQiLHRoaXMsb3B0aW9ucyk7cmV0dXJuIHRoaXN9LHNvcnRlZEluZGV4OmZ1bmN0aW9uKG1vZGVsLHZhbHVlLGNvbnRleHQpe3ZhbHVlfHwodmFsdWU9dGhpcy5jb21wYXJhdG9yKTt2YXIgaXRlcmF0b3I9Xy5pc0Z1bmN0aW9uKHZhbHVlKT92YWx1ZTpmdW5jdGlvbihtb2RlbCl7cmV0dXJuIG1vZGVsLmdldCh2YWx1ZSl9O3JldHVybiBfLnNvcnRlZEluZGV4KHRoaXMubW9kZWxzLG1vZGVsLGl0ZXJhdG9yLGNvbnRleHQpfSxwbHVjazpmdW5jdGlvbihhdHRyKXtyZXR1cm4gXy5pbnZva2UodGhpcy5tb2RlbHMsImdldCIsYXR0cil9LGZldGNoOmZ1bmN0aW9uKG9wdGlvbnMpe29wdGlvbnM9b3B0aW9ucz9fLmNsb25lKG9wdGlvbnMpOnt9O2lmKG9wdGlvbnMucGFyc2U9PT12b2lkIDApb3B0aW9ucy5wYXJzZT10cnVlO3ZhciBzdWNjZXNzPW9wdGlvbnMuc3VjY2Vzczt2YXIgY29sbGVjdGlvbj10aGlzO29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihyZXNwKXt2YXIgbWV0aG9kPW9wdGlvbnMucmVzZXQ/InJlc2V0Ijoic2V0Ijtjb2xsZWN0aW9uW21ldGhvZF0ocmVzcCxvcHRpb25zKTtpZihzdWNjZXNzKXN1Y2Nlc3MoY29sbGVjdGlvbixyZXNwLG9wdGlvbnMpO2NvbGxlY3Rpb24udHJpZ2dlcigic3luYyIsY29sbGVjdGlvbixyZXNwLG9wdGlvbnMpfTt3cmFwRXJyb3IodGhpcyxvcHRpb25zKTtyZXR1cm4gdGhpcy5zeW5jKCJyZWFkIix0aGlzLG9wdGlvbnMpfSxjcmVhdGU6ZnVuY3Rpb24obW9kZWwsb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zP18uY2xvbmUob3B0aW9ucyk6e307aWYoIShtb2RlbD10aGlzLl9wcmVwYXJlTW9kZWwobW9kZWwsb3B0aW9ucykpKXJldHVybiBmYWxzZTtpZighb3B0aW9ucy53YWl0KXRoaXMuYWRkKG1vZGVsLG9wdGlvbnMpO3ZhciBjb2xsZWN0aW9uPXRoaXM7dmFyIHN1Y2Nlc3M9b3B0aW9ucy5zdWNjZXNzO29wdGlvbnMuc3VjY2Vzcz1mdW5jdGlvbihyZXNwKXtpZihvcHRpb25zLndhaXQpY29sbGVjdGlvbi5hZGQobW9kZWwsb3B0aW9ucyk7aWYoc3VjY2VzcylzdWNjZXNzKG1vZGVsLHJlc3Asb3B0aW9ucyl9O21vZGVsLnNhdmUobnVsbCxvcHRpb25zKTtyZXR1cm4gbW9kZWx9LHBhcnNlOmZ1bmN0aW9uKHJlc3Asb3B0aW9ucyl7cmV0dXJuIHJlc3B9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMubW9kZWxzKX0sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5sZW5ndGg9MDt0aGlzLm1vZGVscz1bXTt0aGlzLl9ieUlkPXt9fSxfcHJlcGFyZU1vZGVsOmZ1bmN0aW9uKGF0dHJzLG9wdGlvbnMpe2lmKGF0dHJzIGluc3RhbmNlb2YgTW9kZWwpe2lmKCFhdHRycy5jb2xsZWN0aW9uKWF0dHJzLmNvbGxlY3Rpb249dGhpcztyZXR1cm4gYXR0cnN9b3B0aW9uc3x8KG9wdGlvbnM9e30pO29wdGlvbnMuY29sbGVjdGlvbj10aGlzO3ZhciBtb2RlbD1uZXcgdGhpcy5tb2RlbChhdHRycyxvcHRpb25zKTtpZighbW9kZWwuX3ZhbGlkYXRlKGF0dHJzLG9wdGlvbnMpKXt0aGlzLnRyaWdnZXIoImludmFsaWQiLHRoaXMsYXR0cnMsb3B0aW9ucyk7cmV0dXJuIGZhbHNlfXJldHVybiBtb2RlbH0sX3JlbW92ZVJlZmVyZW5jZTpmdW5jdGlvbihtb2RlbCl7aWYodGhpcz09PW1vZGVsLmNvbGxlY3Rpb24pZGVsZXRlIG1vZGVsLmNvbGxlY3Rpb247bW9kZWwub2ZmKCJhbGwiLHRoaXMuX29uTW9kZWxFdmVudCx0aGlzKX0sX29uTW9kZWxFdmVudDpmdW5jdGlvbihldmVudCxtb2RlbCxjb2xsZWN0aW9uLG9wdGlvbnMpe2lmKChldmVudD09PSJhZGQifHxldmVudD09PSJyZW1vdmUiKSYmY29sbGVjdGlvbiE9PXRoaXMpcmV0dXJuO2lmKGV2ZW50PT09ImRlc3Ryb3kiKXRoaXMucmVtb3ZlKG1vZGVsLG9wdGlvbnMpO2lmKG1vZGVsJiZldmVudD09PSJjaGFuZ2U6Iittb2RlbC5pZEF0dHJpYnV0ZSl7ZGVsZXRlIHRoaXMuX2J5SWRbbW9kZWwucHJldmlvdXMobW9kZWwuaWRBdHRyaWJ1dGUpXTtpZihtb2RlbC5pZCE9bnVsbCl0aGlzLl9ieUlkW21vZGVsLmlkXT1tb2RlbH10aGlzLnRyaWdnZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pO3ZhciBtZXRob2RzPVsiZm9yRWFjaCIsImVhY2giLCJtYXAiLCJjb2xsZWN0IiwicmVkdWNlIiwiZm9sZGwiLCJpbmplY3QiLCJyZWR1Y2VSaWdodCIsImZvbGRyIiwiZmluZCIsImRldGVjdCIsImZpbHRlciIsInNlbGVjdCIsInJlamVjdCIsImV2ZXJ5IiwiYWxsIiwic29tZSIsImFueSIsImluY2x1ZGUiLCJjb250YWlucyIsImludm9rZSIsIm1heCIsIm1pbiIsInRvQXJyYXkiLCJzaXplIiwiZmlyc3QiLCJoZWFkIiwidGFrZSIsImluaXRpYWwiLCJyZXN0IiwidGFpbCIsImRyb3AiLCJsYXN0Iiwid2l0aG91dCIsImluZGV4T2YiLCJzaHVmZmxlIiwibGFzdEluZGV4T2YiLCJpc0VtcHR5IiwiY2hhaW4iXTtfLmVhY2gobWV0aG9kcyxmdW5jdGlvbihtZXRob2Qpe0NvbGxlY3Rpb24ucHJvdG90eXBlW21ldGhvZF09ZnVuY3Rpb24oKXt2YXIgYXJncz1zbGljZS5jYWxsKGFyZ3VtZW50cyk7YXJncy51bnNoaWZ0KHRoaXMubW9kZWxzKTtyZXR1cm4gX1ttZXRob2RdLmFwcGx5KF8sYXJncyl9fSk7dmFyIGF0dHJpYnV0ZU1ldGhvZHM9WyJncm91cEJ5IiwiY291bnRCeSIsInNvcnRCeSJdO18uZWFjaChhdHRyaWJ1dGVNZXRob2RzLGZ1bmN0aW9uKG1ldGhvZCl7Q29sbGVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXT1mdW5jdGlvbih2YWx1ZSxjb250ZXh0KXt2YXIgaXRlcmF0b3I9Xy5pc0Z1bmN0aW9uKHZhbHVlKT92YWx1ZTpmdW5jdGlvbihtb2RlbCl7cmV0dXJuIG1vZGVsLmdldCh2YWx1ZSl9O3JldHVybiBfW21ldGhvZF0odGhpcy5tb2RlbHMsaXRlcmF0b3IsY29udGV4dCl9fSk7dmFyIFZpZXc9QmFja2JvbmUuVmlldz1mdW5jdGlvbihvcHRpb25zKXt0aGlzLmNpZD1fLnVuaXF1ZUlkKCJ2aWV3Iik7dGhpcy5fY29uZmlndXJlKG9wdGlvbnN8fHt9KTt0aGlzLl9lbnN1cmVFbGVtZW50KCk7dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmRlbGVnYXRlRXZlbnRzKCl9O3ZhciBkZWxlZ2F0ZUV2ZW50U3BsaXR0ZXI9L14oXFMrKVxzKiguKikkLzt2YXIgdmlld09wdGlvbnM9WyJtb2RlbCIsImNvbGxlY3Rpb24iLCJlbCIsImlkIiwiYXR0cmlidXRlcyIsImNsYXNzTmFtZSIsInRhZ05hbWUiLCJldmVudHMiXTtfLmV4dGVuZChWaWV3LnByb3RvdHlwZSxFdmVudHMse3RhZ05hbWU6ImRpdiIsJDpmdW5jdGlvbihzZWxlY3Rvcil7cmV0dXJuIHRoaXMuJGVsLmZpbmQoc2VsZWN0b3IpfSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7dGhpcy4kZWwucmVtb3ZlKCk7dGhpcy5zdG9wTGlzdGVuaW5nKCk7cmV0dXJuIHRoaXN9LHNldEVsZW1lbnQ6ZnVuY3Rpb24oZWxlbWVudCxkZWxlZ2F0ZSl7aWYodGhpcy4kZWwpdGhpcy51bmRlbGVnYXRlRXZlbnRzKCk7dGhpcy4kZWw9ZWxlbWVudCBpbnN0YW5jZW9mIEJhY2tib25lLiQ/ZWxlbWVudDpCYWNrYm9uZS4kKGVsZW1lbnQpO3RoaXMuZWw9dGhpcy4kZWxbMF07aWYoZGVsZWdhdGUhPT1mYWxzZSl0aGlzLmRlbGVnYXRlRXZlbnRzKCk7cmV0dXJuIHRoaXN9LGRlbGVnYXRlRXZlbnRzOmZ1bmN0aW9uKGV2ZW50cyl7aWYoIShldmVudHN8fChldmVudHM9Xy5yZXN1bHQodGhpcywiZXZlbnRzIikpKSlyZXR1cm4gdGhpczt0aGlzLnVuZGVsZWdhdGVFdmVudHMoKTtmb3IodmFyIGtleSBpbiBldmVudHMpe3ZhciBtZXRob2Q9ZXZlbnRzW2tleV07aWYoIV8uaXNGdW5jdGlvbihtZXRob2QpKW1ldGhvZD10aGlzW2V2ZW50c1trZXldXTtpZighbWV0aG9kKWNvbnRpbnVlO3ZhciBtYXRjaD1rZXkubWF0Y2goZGVsZWdhdGVFdmVudFNwbGl0dGVyKTt2YXIgZXZlbnROYW1lPW1hdGNoWzFdLHNlbGVjdG9yPW1hdGNoWzJdO21ldGhvZD1fLmJpbmQobWV0aG9kLHRoaXMpO2V2ZW50TmFtZSs9Ii5kZWxlZ2F0ZUV2ZW50cyIrdGhpcy5jaWQ7aWYoc2VsZWN0b3I9PT0iIil7dGhpcy4kZWwub24oZXZlbnROYW1lLG1ldGhvZCl9ZWxzZXt0aGlzLiRlbC5vbihldmVudE5hbWUsc2VsZWN0b3IsbWV0aG9kKX19cmV0dXJuIHRoaXN9LHVuZGVsZWdhdGVFdmVudHM6ZnVuY3Rpb24oKXt0aGlzLiRlbC5vZmYoIi5kZWxlZ2F0ZUV2ZW50cyIrdGhpcy5jaWQpO3JldHVybiB0aGlzfSxfY29uZmlndXJlOmZ1bmN0aW9uKG9wdGlvbnMpe2lmKHRoaXMub3B0aW9ucylvcHRpb25zPV8uZXh0ZW5kKHt9LF8ucmVzdWx0KHRoaXMsIm9wdGlvbnMiKSxvcHRpb25zKTtfLmV4dGVuZCh0aGlzLF8ucGljayhvcHRpb25zLHZpZXdPcHRpb25zKSk7dGhpcy5vcHRpb25zPW9wdGlvbnN9LF9lbnN1cmVFbGVtZW50OmZ1bmN0aW9uKCl7aWYoIXRoaXMuZWwpe3ZhciBhdHRycz1fLmV4dGVuZCh7fSxfLnJlc3VsdCh0aGlzLCJhdHRyaWJ1dGVzIikpO2lmKHRoaXMuaWQpYXR0cnMuaWQ9Xy5yZXN1bHQodGhpcywiaWQiKTtpZih0aGlzLmNsYXNzTmFtZSlhdHRyc1siY2xhc3MiXT1fLnJlc3VsdCh0aGlzLCJjbGFzc05hbWUiKTt2YXIgJGVsPUJhY2tib25lLiQoIjwiK18ucmVzdWx0KHRoaXMsInRhZ05hbWUiKSsiPiIpLmF0dHIoYXR0cnMpO3RoaXMuc2V0RWxlbWVudCgkZWwsZmFsc2UpfWVsc2V7dGhpcy5zZXRFbGVtZW50KF8ucmVzdWx0KHRoaXMsImVsIiksZmFsc2UpfX19KTtCYWNrYm9uZS5zeW5jPWZ1bmN0aW9uKG1ldGhvZCxtb2RlbCxvcHRpb25zKXt2YXIgdHlwZT1tZXRob2RNYXBbbWV0aG9kXTtfLmRlZmF1bHRzKG9wdGlvbnN8fChvcHRpb25zPXt9KSx7ZW11bGF0ZUhUVFA6QmFja2JvbmUuZW11bGF0ZUhUVFAsZW11bGF0ZUpTT046QmFja2JvbmUuZW11bGF0ZUpTT059KTt2YXIgcGFyYW1zPXt0eXBlOnR5cGUsZGF0YVR5cGU6Impzb24ifTtpZighb3B0aW9ucy51cmwpe3BhcmFtcy51cmw9Xy5yZXN1bHQobW9kZWwsInVybCIpfHx1cmxFcnJvcigpfWlmKG9wdGlvbnMuZGF0YT09bnVsbCYmbW9kZWwmJihtZXRob2Q9PT0iY3JlYXRlInx8bWV0aG9kPT09InVwZGF0ZSJ8fG1ldGhvZD09PSJwYXRjaCIpKXtwYXJhbXMuY29udGVudFR5cGU9ImFwcGxpY2F0aW9uL2pzb24iO3BhcmFtcy5kYXRhPUpTT04uc3RyaW5naWZ5KG9wdGlvbnMuYXR0cnN8fG1vZGVsLnRvSlNPTihvcHRpb25zKSl9aWYob3B0aW9ucy5lbXVsYXRlSlNPTil7cGFyYW1zLmNvbnRlbnRUeXBlPSJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiO3BhcmFtcy5kYXRhPXBhcmFtcy5kYXRhP3ttb2RlbDpwYXJhbXMuZGF0YX06e319aWYob3B0aW9ucy5lbXVsYXRlSFRUUCYmKHR5cGU9PT0iUFVUInx8dHlwZT09PSJERUxFVEUifHx0eXBlPT09IlBBVENIIikpe3BhcmFtcy50eXBlPSJQT1NUIjtpZihvcHRpb25zLmVtdWxhdGVKU09OKXBhcmFtcy5kYXRhLl9tZXRob2Q9dHlwZTt2YXIgYmVmb3JlU2VuZD1vcHRpb25zLmJlZm9yZVNlbmQ7b3B0aW9ucy5iZWZvcmVTZW5kPWZ1bmN0aW9uKHhocil7eGhyLnNldFJlcXVlc3RIZWFkZXIoIlgtSFRUUC1NZXRob2QtT3ZlcnJpZGUiLHR5cGUpO2lmKGJlZm9yZVNlbmQpcmV0dXJuIGJlZm9yZVNlbmQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX1pZihwYXJhbXMudHlwZSE9PSJHRVQiJiYhb3B0aW9ucy5lbXVsYXRlSlNPTil7cGFyYW1zLnByb2Nlc3NEYXRhPWZhbHNlfWlmKHBhcmFtcy50eXBlPT09IlBBVENIIiYmd2luZG93LkFjdGl2ZVhPYmplY3QmJiEod2luZG93LmV4dGVybmFsJiZ3aW5kb3cuZXh0ZXJuYWwubXNBY3RpdmVYRmlsdGVyaW5nRW5hYmxlZCkpe3BhcmFtcy54aHI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIil9fXZhciB4aHI9b3B0aW9ucy54aHI9QmFja2JvbmUuYWpheChfLmV4dGVuZChwYXJhbXMsb3B0aW9ucykpO21vZGVsLnRyaWdnZXIoInJlcXVlc3QiLG1vZGVsLHhocixvcHRpb25zKTtyZXR1cm4geGhyfTt2YXIgbWV0aG9kTWFwPXtjcmVhdGU6IlBPU1QiLHVwZGF0ZToiUFVUIixwYXRjaDoiUEFUQ0giLCJkZWxldGUiOiJERUxFVEUiLHJlYWQ6IkdFVCJ9O0JhY2tib25lLmFqYXg9ZnVuY3Rpb24oKXtyZXR1cm4gQmFja2JvbmUuJC5hamF4LmFwcGx5KEJhY2tib25lLiQsYXJndW1lbnRzKX07dmFyIFJvdXRlcj1CYWNrYm9uZS5Sb3V0ZXI9ZnVuY3Rpb24ob3B0aW9ucyl7b3B0aW9uc3x8KG9wdGlvbnM9e30pO2lmKG9wdGlvbnMucm91dGVzKXRoaXMucm91dGVzPW9wdGlvbnMucm91dGVzO3RoaXMuX2JpbmRSb3V0ZXMoKTt0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTt2YXIgb3B0aW9uYWxQYXJhbT0vXCgoLio/KVwpL2c7dmFyIG5hbWVkUGFyYW09LyhcKFw/KT86XHcrL2c7dmFyIHNwbGF0UGFyYW09L1wqXHcrL2c7dmFyIGVzY2FwZVJlZ0V4cD0vW1wte31cW1xdKz8uLFxcXF4kfCNcc10vZztfLmV4dGVuZChSb3V0ZXIucHJvdG90eXBlLEV2ZW50cyx7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe30scm91dGU6ZnVuY3Rpb24ocm91dGUsbmFtZSxjYWxsYmFjayl7aWYoIV8uaXNSZWdFeHAocm91dGUpKXJvdXRlPXRoaXMuX3JvdXRlVG9SZWdFeHAocm91dGUpO2lmKF8uaXNGdW5jdGlvbihuYW1lKSl7Y2FsbGJhY2s9bmFtZTtuYW1lPSIifWlmKCFjYWxsYmFjayljYWxsYmFjaz10aGlzW25hbWVdO3ZhciByb3V0ZXI9dGhpcztCYWNrYm9uZS5oaXN0b3J5LnJvdXRlKHJvdXRlLGZ1bmN0aW9uKGZyYWdtZW50KXt2YXIgYXJncz1yb3V0ZXIuX2V4dHJhY3RQYXJhbWV0ZXJzKHJvdXRlLGZyYWdtZW50KTtjYWxsYmFjayYmY2FsbGJhY2suYXBwbHkocm91dGVyLGFyZ3MpO3JvdXRlci50cmlnZ2VyLmFwcGx5KHJvdXRlcixbInJvdXRlOiIrbmFtZV0uY29uY2F0KGFyZ3MpKTtyb3V0ZXIudHJpZ2dlcigicm91dGUiLG5hbWUsYXJncyk7QmFja2JvbmUuaGlzdG9yeS50cmlnZ2VyKCJyb3V0ZSIscm91dGVyLG5hbWUsYXJncyl9KTtyZXR1cm4gdGhpc30sbmF2aWdhdGU6ZnVuY3Rpb24oZnJhZ21lbnQsb3B0aW9ucyl7QmFja2JvbmUuaGlzdG9yeS5uYXZpZ2F0ZShmcmFnbWVudCxvcHRpb25zKTtyZXR1cm4gdGhpc30sX2JpbmRSb3V0ZXM6ZnVuY3Rpb24oKXtpZighdGhpcy5yb3V0ZXMpcmV0dXJuO3RoaXMucm91dGVzPV8ucmVzdWx0KHRoaXMsInJvdXRlcyIpO3ZhciByb3V0ZSxyb3V0ZXM9Xy5rZXlzKHRoaXMucm91dGVzKTt3aGlsZSgocm91dGU9cm91dGVzLnBvcCgpKSE9bnVsbCl7dGhpcy5yb3V0ZShyb3V0ZSx0aGlzLnJvdXRlc1tyb3V0ZV0pfX0sX3JvdXRlVG9SZWdFeHA6ZnVuY3Rpb24ocm91dGUpe3JvdXRlPXJvdXRlLnJlcGxhY2UoZXNjYXBlUmVnRXhwLCJcXCQmIikucmVwbGFjZShvcHRpb25hbFBhcmFtLCIoPzokMSk/IikucmVwbGFjZShuYW1lZFBhcmFtLGZ1bmN0aW9uKG1hdGNoLG9wdGlvbmFsKXtyZXR1cm4gb3B0aW9uYWw/bWF0Y2g6IihbXi9dKykifSkucmVwbGFjZShzcGxhdFBhcmFtLCIoLio/KSIpO3JldHVybiBuZXcgUmVnRXhwKCJeIityb3V0ZSsiJCIpfSxfZXh0cmFjdFBhcmFtZXRlcnM6ZnVuY3Rpb24ocm91dGUsZnJhZ21lbnQpe3ZhciBwYXJhbXM9cm91dGUuZXhlYyhmcmFnbWVudCkuc2xpY2UoMSk7cmV0dXJuIF8ubWFwKHBhcmFtcyxmdW5jdGlvbihwYXJhbSl7cmV0dXJuIHBhcmFtP2RlY29kZVVSSUNvbXBvbmVudChwYXJhbSk6bnVsbH0pfX0pO3ZhciBIaXN0b3J5PUJhY2tib25lLkhpc3Rvcnk9ZnVuY3Rpb24oKXt0aGlzLmhhbmRsZXJzPVtdO18uYmluZEFsbCh0aGlzLCJjaGVja1VybCIpO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7dGhpcy5sb2NhdGlvbj13aW5kb3cubG9jYXRpb247dGhpcy5oaXN0b3J5PXdpbmRvdy5oaXN0b3J5fX07dmFyIHJvdXRlU3RyaXBwZXI9L15bI1wvXXxccyskL2c7dmFyIHJvb3RTdHJpcHBlcj0vXlwvK3xcLyskL2c7dmFyIGlzRXhwbG9yZXI9L21zaWUgW1x3Ll0rLzt2YXIgdHJhaWxpbmdTbGFzaD0vXC8kLztIaXN0b3J5LnN0YXJ0ZWQ9ZmFsc2U7Xy5leHRlbmQoSGlzdG9yeS5wcm90b3R5cGUsRXZlbnRzLHtpbnRlcnZhbDo1MCxnZXRIYXNoOmZ1bmN0aW9uKHdpbmRvdyl7dmFyIG1hdGNoPSh3aW5kb3d8fHRoaXMpLmxvY2F0aW9uLmhyZWYubWF0Y2goLyMoLiopJC8pO3JldHVybiBtYXRjaD9tYXRjaFsxXToiIn0sZ2V0RnJhZ21lbnQ6ZnVuY3Rpb24oZnJhZ21lbnQsZm9yY2VQdXNoU3RhdGUpe2lmKGZyYWdtZW50PT1udWxsKXtpZih0aGlzLl9oYXNQdXNoU3RhdGV8fCF0aGlzLl93YW50c0hhc2hDaGFuZ2V8fGZvcmNlUHVzaFN0YXRlKXtmcmFnbWVudD10aGlzLmxvY2F0aW9uLnBhdGhuYW1lO3ZhciByb290PXRoaXMucm9vdC5yZXBsYWNlKHRyYWlsaW5nU2xhc2gsIiIpO2lmKCFmcmFnbWVudC5pbmRleE9mKHJvb3QpKWZyYWdtZW50PWZyYWdtZW50LnN1YnN0cihyb290Lmxlbmd0aCl9ZWxzZXtmcmFnbWVudD10aGlzLmdldEhhc2goKX19cmV0dXJuIGZyYWdtZW50LnJlcGxhY2Uocm91dGVTdHJpcHBlciwiIil9LHN0YXJ0OmZ1bmN0aW9uKG9wdGlvbnMpe2lmKEhpc3Rvcnkuc3RhcnRlZCl0aHJvdyBuZXcgRXJyb3IoIkJhY2tib25lLmhpc3RvcnkgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIik7SGlzdG9yeS5zdGFydGVkPXRydWU7dGhpcy5vcHRpb25zPV8uZXh0ZW5kKHt9LHtyb290OiIvIn0sdGhpcy5vcHRpb25zLG9wdGlvbnMpO3RoaXMucm9vdD10aGlzLm9wdGlvbnMucm9vdDt0aGlzLl93YW50c0hhc2hDaGFuZ2U9dGhpcy5vcHRpb25zLmhhc2hDaGFuZ2UhPT1mYWxzZTt0aGlzLl93YW50c1B1c2hTdGF0ZT0hIXRoaXMub3B0aW9ucy5wdXNoU3RhdGU7dGhpcy5faGFzUHVzaFN0YXRlPSEhKHRoaXMub3B0aW9ucy5wdXNoU3RhdGUmJnRoaXMuaGlzdG9yeSYmdGhpcy5oaXN0b3J5LnB1c2hTdGF0ZSk7dmFyIGZyYWdtZW50PXRoaXMuZ2V0RnJhZ21lbnQoKTt2YXIgZG9jTW9kZT1kb2N1bWVudC5kb2N1bWVudE1vZGU7dmFyIG9sZElFPWlzRXhwbG9yZXIuZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpJiYoIWRvY01vZGV8fGRvY01vZGU8PTcpO3RoaXMucm9vdD0oIi8iK3RoaXMucm9vdCsiLyIpLnJlcGxhY2Uocm9vdFN0cmlwcGVyLCIvIik7aWYob2xkSUUmJnRoaXMuX3dhbnRzSGFzaENoYW5nZSl7dGhpcy5pZnJhbWU9QmFja2JvbmUuJCgnPGlmcmFtZSBzcmM9ImphdmFzY3JpcHQ6MCIgdGFiaW5kZXg9Ii0xIiAvPicpLmhpZGUoKS5hcHBlbmRUbygiYm9keSIpWzBdLmNvbnRlbnRXaW5kb3c7dGhpcy5uYXZpZ2F0ZShmcmFnbWVudCl9aWYodGhpcy5faGFzUHVzaFN0YXRlKXtCYWNrYm9uZS4kKHdpbmRvdykub24oInBvcHN0YXRlIix0aGlzLmNoZWNrVXJsKX1lbHNlIGlmKHRoaXMuX3dhbnRzSGFzaENoYW5nZSYmIm9uaGFzaGNoYW5nZSJpbiB3aW5kb3cmJiFvbGRJRSl7QmFja2JvbmUuJCh3aW5kb3cpLm9uKCJoYXNoY2hhbmdlIix0aGlzLmNoZWNrVXJsKX1lbHNlIGlmKHRoaXMuX3dhbnRzSGFzaENoYW5nZSl7dGhpcy5fY2hlY2tVcmxJbnRlcnZhbD1zZXRJbnRlcnZhbCh0aGlzLmNoZWNrVXJsLHRoaXMuaW50ZXJ2YWwpfXRoaXMuZnJhZ21lbnQ9ZnJhZ21lbnQ7dmFyIGxvYz10aGlzLmxvY2F0aW9uO3ZhciBhdFJvb3Q9bG9jLnBhdGhuYW1lLnJlcGxhY2UoL1teXC9dJC8sIiQmLyIpPT09dGhpcy5yb290O2lmKHRoaXMuX3dhbnRzSGFzaENoYW5nZSYmdGhpcy5fd2FudHNQdXNoU3RhdGUmJiF0aGlzLl9oYXNQdXNoU3RhdGUmJiFhdFJvb3Qpe3RoaXMuZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudChudWxsLHRydWUpO3RoaXMubG9jYXRpb24ucmVwbGFjZSh0aGlzLnJvb3QrdGhpcy5sb2NhdGlvbi5zZWFyY2grIiMiK3RoaXMuZnJhZ21lbnQpO3JldHVybiB0cnVlfWVsc2UgaWYodGhpcy5fd2FudHNQdXNoU3RhdGUmJnRoaXMuX2hhc1B1c2hTdGF0ZSYmYXRSb290JiZsb2MuaGFzaCl7dGhpcy5mcmFnbWVudD10aGlzLmdldEhhc2goKS5yZXBsYWNlKHJvdXRlU3RyaXBwZXIsIiIpO3RoaXMuaGlzdG9yeS5yZXBsYWNlU3RhdGUoe30sZG9jdW1lbnQudGl0bGUsdGhpcy5yb290K3RoaXMuZnJhZ21lbnQrbG9jLnNlYXJjaCl9aWYoIXRoaXMub3B0aW9ucy5zaWxlbnQpcmV0dXJuIHRoaXMubG9hZFVybCgpfSxzdG9wOmZ1bmN0aW9uKCl7QmFja2JvbmUuJCh3aW5kb3cpLm9mZigicG9wc3RhdGUiLHRoaXMuY2hlY2tVcmwpLm9mZigiaGFzaGNoYW5nZSIsdGhpcy5jaGVja1VybCk7Y2xlYXJJbnRlcnZhbCh0aGlzLl9jaGVja1VybEludGVydmFsKTtIaXN0b3J5LnN0YXJ0ZWQ9ZmFsc2V9LHJvdXRlOmZ1bmN0aW9uKHJvdXRlLGNhbGxiYWNrKXt0aGlzLmhhbmRsZXJzLnVuc2hpZnQoe3JvdXRlOnJvdXRlLGNhbGxiYWNrOmNhbGxiYWNrfSl9LGNoZWNrVXJsOmZ1bmN0aW9uKGUpe3ZhciBjdXJyZW50PXRoaXMuZ2V0RnJhZ21lbnQoKTtpZihjdXJyZW50PT09dGhpcy5mcmFnbWVudCYmdGhpcy5pZnJhbWUpe2N1cnJlbnQ9dGhpcy5nZXRGcmFnbWVudCh0aGlzLmdldEhhc2godGhpcy5pZnJhbWUpKX1pZihjdXJyZW50PT09dGhpcy5mcmFnbWVudClyZXR1cm4gZmFsc2U7aWYodGhpcy5pZnJhbWUpdGhpcy5uYXZpZ2F0ZShjdXJyZW50KTt0aGlzLmxvYWRVcmwoKXx8dGhpcy5sb2FkVXJsKHRoaXMuZ2V0SGFzaCgpKX0sbG9hZFVybDpmdW5jdGlvbihmcmFnbWVudE92ZXJyaWRlKXt2YXIgZnJhZ21lbnQ9dGhpcy5mcmFnbWVudD10aGlzLmdldEZyYWdtZW50KGZyYWdtZW50T3ZlcnJpZGUpO3ZhciBtYXRjaGVkPV8uYW55KHRoaXMuaGFuZGxlcnMsZnVuY3Rpb24oaGFuZGxlcil7aWYoaGFuZGxlci5yb3V0ZS50ZXN0KGZyYWdtZW50KSl7aGFuZGxlci5jYWxsYmFjayhmcmFnbWVudCk7cmV0dXJuIHRydWV9fSk7cmV0dXJuIG1hdGNoZWR9LG5hdmlnYXRlOmZ1bmN0aW9uKGZyYWdtZW50LG9wdGlvbnMpe2lmKCFIaXN0b3J5LnN0YXJ0ZWQpcmV0dXJuIGZhbHNlO2lmKCFvcHRpb25zfHxvcHRpb25zPT09dHJ1ZSlvcHRpb25zPXt0cmlnZ2VyOm9wdGlvbnN9O2ZyYWdtZW50PXRoaXMuZ2V0RnJhZ21lbnQoZnJhZ21lbnR8fCIiKTtpZih0aGlzLmZyYWdtZW50PT09ZnJhZ21lbnQpcmV0dXJuO3RoaXMuZnJhZ21lbnQ9ZnJhZ21lbnQ7dmFyIHVybD10aGlzLnJvb3QrZnJhZ21lbnQ7aWYodGhpcy5faGFzUHVzaFN0YXRlKXt0aGlzLmhpc3Rvcnlbb3B0aW9ucy5yZXBsYWNlPyJyZXBsYWNlU3RhdGUiOiJwdXNoU3RhdGUiXSh7fSxkb2N1bWVudC50aXRsZSx1cmwpfWVsc2UgaWYodGhpcy5fd2FudHNIYXNoQ2hhbmdlKXt0aGlzLl91cGRhdGVIYXNoKHRoaXMubG9jYXRpb24sZnJhZ21lbnQsb3B0aW9ucy5yZXBsYWNlKTtpZih0aGlzLmlmcmFtZSYmZnJhZ21lbnQhPT10aGlzLmdldEZyYWdtZW50KHRoaXMuZ2V0SGFzaCh0aGlzLmlmcmFtZSkpKXtpZighb3B0aW9ucy5yZXBsYWNlKXRoaXMuaWZyYW1lLmRvY3VtZW50Lm9wZW4oKS5jbG9zZSgpO3RoaXMuX3VwZGF0ZUhhc2godGhpcy5pZnJhbWUubG9jYXRpb24sZnJhZ21lbnQsb3B0aW9ucy5yZXBsYWNlKX19ZWxzZXtyZXR1cm4gdGhpcy5sb2NhdGlvbi5hc3NpZ24odXJsKX1pZihvcHRpb25zLnRyaWdnZXIpdGhpcy5sb2FkVXJsKGZyYWdtZW50KX0sX3VwZGF0ZUhhc2g6ZnVuY3Rpb24obG9jYXRpb24sZnJhZ21lbnQscmVwbGFjZSl7aWYocmVwbGFjZSl7dmFyIGhyZWY9bG9jYXRpb24uaHJlZi5yZXBsYWNlKC8oamF2YXNjcmlwdDp8IykuKiQvLCIiKTtsb2NhdGlvbi5yZXBsYWNlKGhyZWYrIiMiK2ZyYWdtZW50KX1lbHNle2xvY2F0aW9uLmhhc2g9IiMiK2ZyYWdtZW50fX19KTtCYWNrYm9uZS5oaXN0b3J5PW5ldyBIaXN0b3J5O3ZhciBleHRlbmQ9ZnVuY3Rpb24ocHJvdG9Qcm9wcyxzdGF0aWNQcm9wcyl7dmFyIHBhcmVudD10aGlzO3ZhciBjaGlsZDtpZihwcm90b1Byb3BzJiZfLmhhcyhwcm90b1Byb3BzLCJjb25zdHJ1Y3RvciIpKXtjaGlsZD1wcm90b1Byb3BzLmNvbnN0cnVjdG9yfWVsc2V7Y2hpbGQ9ZnVuY3Rpb24oKXtyZXR1cm4gcGFyZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKX19Xy5leHRlbmQoY2hpbGQscGFyZW50LHN0YXRpY1Byb3BzKTt2YXIgU3Vycm9nYXRlPWZ1bmN0aW9uKCl7dGhpcy5jb25zdHJ1Y3Rvcj1jaGlsZH07U3Vycm9nYXRlLnByb3RvdHlwZT1wYXJlbnQucHJvdG90eXBlO2NoaWxkLnByb3RvdHlwZT1uZXcgU3Vycm9nYXRlO2lmKHByb3RvUHJvcHMpXy5leHRlbmQoY2hpbGQucHJvdG90eXBlLHByb3RvUHJvcHMpO2NoaWxkLl9fc3VwZXJfXz1wYXJlbnQucHJvdG90eXBlO3JldHVybiBjaGlsZH07TW9kZWwuZXh0ZW5kPUNvbGxlY3Rpb24uZXh0ZW5kPVJvdXRlci5leHRlbmQ9Vmlldy5leHRlbmQ9SGlzdG9yeS5leHRlbmQ9ZXh0ZW5kO3ZhciB1cmxFcnJvcj1mdW5jdGlvbigpe3Rocm93IG5ldyBFcnJvcignQSAidXJsIiBwcm9wZXJ0eSBvciBmdW5jdGlvbiBtdXN0IGJlIHNwZWNpZmllZCcpfTt2YXIgd3JhcEVycm9yPWZ1bmN0aW9uKG1vZGVsLG9wdGlvbnMpe3ZhciBlcnJvcj1vcHRpb25zLmVycm9yO29wdGlvbnMuZXJyb3I9ZnVuY3Rpb24ocmVzcCl7aWYoZXJyb3IpZXJyb3IobW9kZWwscmVzcCxvcHRpb25zKTttb2RlbC50cmlnZ2VyKCJlcnJvciIsbW9kZWwscmVzcCxvcHRpb25zKX19fSkuY2FsbCh0aGlzKTsKLyoKLy9AIHNvdXJjZU1hcHBpbmdVUkw9YmFja2JvbmUtbWluLm1hcAoqLw==",
                "headers": {
                    "Accept-Ranges": "bytes",
                    "Last-Modified": "Thu, 06 Nov 2014 11:41:57 GMT",
                    "Content-Length": "25888",
                    "Date": "Thu, 06 Nov 2014 11:42:00 GMT",
                    "Content-Type": "application/javascript"
                },
                "cookies": [],
                "mimeType": "script",
                "host": "localhost",
                "protocol": "http",
                "port": 9999,
                "inScope": false,
                "toolFlag": 16962,
                "referenceID": 0,
                "messageType": "response"
            },
            "messageType": "requestResponse"
        }
    ],
    "inScope": true,
    "messageType": "scanIssue"
}